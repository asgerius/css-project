[{"tags": ["c++", "casting"], "comments": [{"owner": {"reputation": 105, "user_id": 6119265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ec8901128e7e20f0c9896efe755364?s=128&d=identicon&r=PG&f=1", "display_name": "dgsomerton", "link": "https://stackoverflow.com/users/6119265/dgsomerton"}, "edited": false, "score": 0, "creation_date": 1523489084, "post_id": 49785792, "comment_id": 86586934, "body": "use a reinterpret_cast&lt;&gt;"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 3, "creation_date": 1523489177, "post_id": 49785792, "comment_id": 86586963, "body": "You need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1523489243, "post_id": 49785792, "comment_id": 86586993, "body": "You need to pass in as <code>void *</code> ."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1523489927, "post_id": 49785792, "comment_id": 86587152, "body": "I could not reproduce. I got a different compilation error: <a href=\"http://coliru.stacked-crooked.com/a/5edfd86eb45fb882\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/5edfd86eb45fb882</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 105, "user_id": 6119265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ec8901128e7e20f0c9896efe755364?s=128&d=identicon&r=PG&f=1", "display_name": "dgsomerton", "link": "https://stackoverflow.com/users/6119265/dgsomerton"}, "edited": false, "score": 1, "creation_date": 1523490254, "post_id": 49785792, "comment_id": 86587230, "body": "@dgsomerton <code>static_cast</code> is the appropriate cast, not <code>reinterpret_cast</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1523490389, "post_id": 49785792, "comment_id": 86587261, "body": "@user2079303: of course you did: &quot;<i>&#39;UserStatistics&#39; was not declared in this scope</i>&quot;, because you didn&#39;t declare <code>UserStatistics</code> before using it"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 3, "creation_date": 1523490599, "post_id": 49785792, "comment_id": 86587313, "body": "Also, you need to actually call the member function: <code>return func-&gt;numCurrUsers();</code>  The parentheses are not optional."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2869411"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1523490780, "post_id": 49785792, "comment_id": 86587358, "body": "@BenVoigt - yes. That pushed me forward. However, now I have a completely different issue, apparently that particular virtual method is private. Thanks for the catch!"}], "answers": [{"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1523490699, "last_edit_date": 1523490699, "creation_date": 1523489666, "answer_id": 49785853, "question_id": 49785792, "link": "https://stackoverflow.com/questions/49785792/c-casting-from-void/49785853#49785853", "title": "C++ Casting from void", "body": "<p>You use <code>dynamic_cast</code> only when you have a polymorphic implementation of classes. Normally, when a base class pointer holds the address of a derived class object, you can <code>dynamic_cast</code> the base pointer to get the address of derived class object.</p>\n\n<p>In your case, you need to use <code>static_cast</code> instead:</p>\n\n<pre><code> static_cast&lt;MyClass*&gt;(func1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1523490610, "creation_date": 1523490610, "answer_id": 49785964, "question_id": 49785792, "link": "https://stackoverflow.com/questions/49785792/c-casting-from-void/49785964#49785964", "title": "C++ Casting from void", "body": "<blockquote>\n  <p>But, when I try to call a method from MyClass (func) I get this error...</p>\n\n<pre><code>cannot convert 'MyClass::method' from type 'int (MyClass::)()' to type 'int'\n</code></pre>\n  \n  <p>My guess is that I am using the wrong method to cast the object. Is that what the error is telling me?</p>\n</blockquote>\n\n<p>No.  The error message is telling you that you are trying to return a pointer-to-method where an <code>int</code> is expected.  And that is because of this statement:</p>\n\n<blockquote>\n  <p>[UserStatistics] has some <strong>virtual methods (like numCurrUsers) that return int</strong>.</p>\n</blockquote>\n\n<p>That mean you need to <strong>call</strong> the method and return the value it returns, not return the method itself.</p>\n\n<p>That has nothing to do with the cast itself.  And yes, you are using the wrong cast.  You need to use <code>static_cast</code> instead of <code>dynamic_cast</code>.</p>\n\n<p>Try this:</p>\n\n<pre><code>int call_method(void *func1)\n{\n    UserStatistics* func = static_cast&lt;UserStatistics*&gt;(func1)\n    return func-&gt;numCurrUsers();\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2869411"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 49785964, "answer_count": 2, "score": -1, "last_activity_date": 1523490699, "creation_date": 1523489043, "last_edit_date": 1523489678, "question_id": 49785792, "link": "https://stackoverflow.com/questions/49785792/c-casting-from-void", "title": "C++ Casting from void", "body": "<p>I have a function that takes a void. I am passing in an object (call is MyClass). The function is used to call a method from MyClass and return its output. So, I am casting the object as itself (it was passed in as void)</p>\n\n<pre><code>MyClass* func = dynamic_cast&lt;MyClass*&gt;(func1)\n</code></pre>\n\n<p>But, when I try to call a method from MyClass (func) I get this error...</p>\n\n<pre><code>cannot convert 'MyClass::method' from type 'int (MyClass::)()' to type 'int'\n</code></pre>\n\n<p>My guess is that I am using the wrong method to cast the object. Is that what the error is telling me?</p>\n\n<p>Any documentation you can point me to would be greatly appreciated.</p>\n\n<p>EDIT\nThis is my actual function</p>\n\n<pre><code>int call_method(void *func1)\n{\n    UserStatistics* func = dynamic_cast&lt;UserStatistics*&gt;(func1)\n    return func-&gt;numCurrUsers;\n}\n</code></pre>\n\n<p>The only thing I know about the UserStatistics class is that it has some virtual methods (like numCurrUsers) that return int. I don't actually have access to the class itself, just documentation about how to access it.</p>\n"}, {"tags": ["c++", "gcc", "llvm"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1523489054, "post_id": 49785772, "comment_id": 86586926, "body": "Extremely related: <a href=\"https://stackoverflow.com/q/197675/1896169\">stackoverflow.com/q/197675/1896169</a>"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1523489392, "post_id": 49785772, "comment_id": 86587038, "body": "Probably related: <a href=\"https://stackoverflow.com/questions/3479330/how-is-malloc-implemented-internally\" title=\"how is malloc implemented internally\">stackoverflow.com/questions/3479330/&hellip;</a>"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1523489445, "post_id": 49785772, "comment_id": 86587057, "body": "@Justin: Half the story. There&#39;s also <code>delete basePtr</code>, which may call <code>Derived::~Derived</code>. In that case <code>::operator delete</code> will need <code>sizeof(Derived)</code>, not <code>sizeof(Base)</code>."}, {"owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1523490410, "post_id": 49785772, "comment_id": 86587264, "body": "@Justin so should I expect +4-8 bytes per object for heap manager expenses in real production implementation? That&#39;s twice the required amount for small object! How came that it is not optimized?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1523490499, "post_id": 49785772, "comment_id": 86587286, "body": "@MSalters The size information is probably just associated with the pointer, not the objects and sub-objects."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1523490509, "post_id": 49785772, "comment_id": 86587287, "body": "@FyodorMenshikov The answers to that question I linked are not entirely accurate. The best malloc/free implementations store the metadata separately. But yes, there will be somewhere around 4-8 bytes per allocation. Usually you don&#39;t want to allocate single small objects, but large arrays, or larger objects. For small objects, you often don&#39;t even need to heap-allocate and can simply pass them by value"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1523490739, "post_id": 49785772, "comment_id": 86587346, "body": "@FyodorMenshikov It&#39;s possible to optimize, e.g. by using different heaps for different object sizes. So in a heap for objects &lt; 256 bytes, only 1 byte would be needed for size info. But if you don&#39;t have dynamic allocation of lots of small objects, it might not be worth the added complexity."}, {"owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1523490769, "post_id": 49785772, "comment_id": 86587355, "body": "@Justin thank you! If you can add some references to implementations description or maybe specific source code parts, it could be full answer to my question."}, {"owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523490900, "post_id": 49785772, "comment_id": 86587384, "body": "@Barmar I understand that something like this is possible in theory, but my question is about parameters of real major implementations."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523491536, "post_id": 49785772, "comment_id": 86587539, "body": "Often when using C++, the compiler will create little glue structures for you.  These 4-12 bytes allocations can add up.  To combat this, often a Unit Heap Allocator is used.  Basically create a stack of a bunch of fixed sized allocations that has no explicit overhead per allocation.  The problem being that each block is a fixed size - say 64 bytes.  If you need less than the block size, you incur internal fragmentation.  The good news is this sort of allocator runs at O(1) time for alloc and free, where others often run at O(n) where n is the number current allocations."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523491827, "post_id": 49785772, "comment_id": 86587596, "body": "@FyodorMenshikov: &quot;<i>my question is about parameters of real major implementations</i>&quot; - then you should actually look at those implementations for yourself. Every implementation is different."}, {"owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523491838, "post_id": 49785772, "comment_id": 86587600, "body": "@MichaelDorgan I highly doubt that complexity of a production heap manager can be O(n) because they are created to manage millions of objects. As about Unit Heap Allocator, that&#39;s very valuable information. Could you reference some article or maybe specific source code?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523491974, "post_id": 49785772, "comment_id": 86587633, "body": "Typing an answer for you now.  And yes, O(n) is not unusual.  I&#39;ve fought the <code>malloc</code> battle many many times over the years when optimizing code.  A simple linked list type tracking system is not unusual."}, {"owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523492210, "post_id": 49785772, "comment_id": 86587689, "body": "@RemyLebeau I understand that implementations can differ, but maybe there are &quot;best practices&quot; among implementations? Maybe heap manager is not &quot;production ready&quot; unless it does this this and this?"}, {"owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523492533, "post_id": 49785772, "comment_id": 86587761, "body": "@MichaelDorgan in my opinion, O(n) per allocation is not compatible with such C++ STL data structures as std::set and std::map. They have guaranteed O(logN) time of element removal. Or is there special note in C++ standard that these structures can have worse complexity due to inadequate heap manager?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523492534, "post_id": 49785772, "comment_id": 86587762, "body": "@FyodorMenshikov if a memory manager is asked to allocate X bytes and it returns a pointer to X bytes, and then is asked to free the memory so it frees X bytes, it is production ready. There are no &quot;best practices&quot;. HOW it allocates and frees those X bytes, and HOW it keeps track of how many bytes were allocated, is completely up to the implementor to decide. There are certain <i>optimizations</i> to reduce overhead (multiple heaps, metadata headers in front of allocated blocks, etc), but those are not <i>required</i>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523492596, "post_id": 49785772, "comment_id": 86587773, "body": "@FyodorMenshikov <code>O(n)</code> complexities on additions and removals are related to how a container organizes, tracks, and traverses its data items, not how they are physically allocated in memory."}, {"owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523493080, "post_id": 49785772, "comment_id": 86587867, "body": "@RemyLebeau could you cite the C++ Standard where it says something like the complexity of insert method of std::map is O(logN) <i>plus</i> unspecified complexity of malloc? This kind of statements look very suspicious to me. Everywhere in the description of such data structures allocation is assumed O(1)."}], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "edited": false, "score": 0, "creation_date": 1523493674, "post_id": 49786221, "comment_id": 86587963, "body": "I understand your point that in some situations manual memory management has its benefits. I used one when I worked in gamedev. But my primary focus in this question is on PC (=enough resources) heap manager characteristics &quot;out of the box&quot;. What to expect from it?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "reply_to_user": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "edited": false, "score": 1, "creation_date": 1523493925, "post_id": 49786221, "comment_id": 86588002, "body": "<a href=\"https://softwareengineering.stackexchange.com/questions/193575/performance-overhead-of-standard-containers-and-boost\" title=\"performance overhead of standard containers and boost\">softwareengineering.stackexchange.com/questions/193575/&hellip;</a>  Look at the glibc malloc code.  Look at other allocators.  They all use the same tricks.  Some rely on the OS to hand them virtual memory chunks big enough for their purposes and let the OS handle fragmentation and physical mapping."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "reply_to_user": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "edited": false, "score": 0, "creation_date": 1523493990, "post_id": 49786221, "comment_id": 86588020, "body": "And <code>PC=enough resources</code> I have to admit made me giggle, though I understand your meaning."}], "tags": [], "owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "is_accepted": false, "score": 3, "last_activity_date": 1523493738, "last_edit_date": 1523493738, "creation_date": 1523492919, "answer_id": 49786221, "question_id": 49785772, "link": "https://stackoverflow.com/questions/49785772/how-c-heap-managers-track-the-size-of-allocated-objects/49786221#49786221", "title": "How C++ heap managers track the size of allocated objects?", "body": "<p>Heap allocators are not free.  There is the cost per block of allocation (both in size and perhaps search if using a find best algorithm), the cost of joining blocks upon free, and any lost size per block when the size requested is smaller than the block size returned.  There is also a cost in terms of memory fragmentation.  Consider placing a small 1 byte allocation in the middle of your heap.  At this point, you can no longer return a contiguous block larger than 1/2 the heap - half your heap is fragmented.  Good allocators fight all the above and try to maximize all benefits.</p>\n\n<p>Consider the following allocation system (used in many real world applications over a decade on numerous handheld game devices.)</p>\n\n<p>Create a primary heap where each allocation has a prev ptr, next ptr, size, and  possibly other info.  Round it to 16 bytes per entry.  Store this info before or after the actual memory pointer being returned - your choice as there are advantages to each.  Yes, you are allocating requested size + 16 bytes here.</p>\n\n<p>Now just keep a pointer to a free list and possibly a used list.</p>\n\n<p>Allocation is done by finding a block on the free list big enough for our use and splitting it into the size requested and the remainder (first fit), or by searching the whole list for as exact a match as possible (best fit).  Simple enough. </p>\n\n<p>Freeing is moving the current item back into the free list, joining areas adjacent to each other if possible.  You can see how this can go to O(n).</p>\n\n<p>For smaller allocations, get a single allocation (either from newly created heap, or from global memory) that will be your unit allocation zone.  Split this area up into \"block size\" chunk addresses and push these addresses onto a free stack.  Allocation is popping an address from this list.  Freeing is just pushing the allocation back to the list - both O(1). </p>\n\n<p>Then inside your malloc/new/etc, check size if it is within the unit size, allocate from the unit allocator, otherwise use the O(n) allocator.  My studies have shown that you can get 90-95% of allocations to fit within the unit allocator's block size without too much issue.  </p>\n\n<p>Also, you can allocate slabs of memory for memory pools and leave them allocated while using them over and over.  A few larger allocations are much cheaper to manage (Unix systems use this alot...)</p>\n\n<p>Advantages:</p>\n\n<ul>\n<li>All unit allocations have no external fragmentation.</li>\n<li>Small allocations run constant time.</li>\n<li>Larger allocation can be tailored to the exact size of the data requested.</li>\n</ul>\n\n<p>Disadvantages:</p>\n\n<ul>\n<li>You pay an internal fragmentation cost when you want memory smaller than the block requsted.</li>\n<li>Many, many allocations and frees outside your small block size will eventually fragment your memory.  This can lead to all sorts of unpleasantness.  This can be managed with OS help or with care on alloc/free order.</li>\n<li>Once you get 1000s of large allocations going, there is a CPU price.  Slabs / multiple heaps can be used to fix this as well.</li>\n</ul>\n\n<p>There are many, many schemes out there, but this one is simple and has been used in commercial apps for ages though, so I wanted to start here.</p>\n"}], "owner": {"reputation": 156, "user_id": 3283370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9PFDS.png?s=128&g=1", "display_name": "Fyodor Menshikov", "link": "https://stackoverflow.com/users/3283370/fyodor-menshikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523493738, "creation_date": 1523488920, "question_id": 49785772, "link": "https://stackoverflow.com/questions/49785772/how-c-heap-managers-track-the-size-of-allocated-objects", "title": "How C++ heap managers track the size of allocated objects?", "body": "<p>I want to estimate memory consumption in C++ when I allocate objects in the heap. I can start my calculation with sizeof(object) and round it up to the nearest multiple of the heap block (typically 8 bytes). But if the whole allocated block goes to the allocated object, how can the heap manager tell the size of the object when I ask it to delete the pointer?</p>\n\n<p>If the heap manager tracks the size of each object, does it mean that I should add ~4 bytes per allocated object in my calculation to the total memory consumption for heap manager internal expenses? Or does it store this information in much more compact form? What are extra costs (memory-wise) of heap memory allocation?</p>\n\n<p>I understand that my question is very implementation specific, but I appreciate any hints about the heap metadata storage of major implementations such as gcc (or maybe it is about libc).</p>\n"}, {"tags": ["c++", "c++11", "smart-pointers"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1523488077, "post_id": 49785614, "comment_id": 86586705, "body": "What&#39;s wrong with the way you did it back in the day?"}, {"owner": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1523488167, "post_id": 49785614, "comment_id": 86586718, "body": "Good question:) I was just under the impression that raw pointers were being discouraged."}, {"owner": {"reputation": 1493, "user_id": 9385966, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WtdbWV1QtcQ/AAAAAAAAAAI/AAAAAAAAE_4/Eod8Vj3X1-U/photo.jpg?sz=128", "display_name": "gflegar", "link": "https://stackoverflow.com/users/9385966/gflegar"}, "edited": false, "score": 2, "creation_date": 1523488275, "post_id": 49785614, "comment_id": 86586749, "body": "Raw pointers for memory management (not raw pointers in general) are being discouraged. This series of blogs is a good way to figure out smart pointers:  <a href=\"https://herbsutter.com/2013/05/29/gotw-89-solution-smart-pointers/\" rel=\"nofollow noreferrer\">herbsutter.com/2013/05/29/gotw-89-solution-smart-pointers</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523488419, "post_id": 49785614, "comment_id": 86586788, "body": "As long as the vector outlives the <code>B</code>&#39;s there is nothing wrong using a pointer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1523488586, "post_id": 49785614, "comment_id": 86586834, "body": "&quot;I don&#39;t want the A objects allocated all over the heap&quot; objects stored as values in a vector are always allocated on the heap."}, {"owner": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 0, "creation_date": 1523488950, "post_id": 49785614, "comment_id": 86586902, "body": "Yes I know - but not spread all over it:) Yikes - just realized the problems if elements are erased or the vector must reallocate to grow. Luckily that&#39;s not an issue for my particular case"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1523489136, "post_id": 49785614, "comment_id": 86586952, "body": "@Nathan And as long as the vector is not modified."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 4, "creation_date": 1523489837, "post_id": 49785614, "comment_id": 86587139, "body": "No, raw pointers are not discouraged. Manual memory management is discouraged, but that overlaps with raw pointers only in very superficial and uninteresting ways."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1523491983, "post_id": 49785614, "comment_id": 86587640, "body": "@Jesper &quot;<i>how would one do it today with smart pointers?</i>&quot; - smart pointers don&#39;t apply in the example you described. Simply declare a raw <code>A*</code> pointer, or an <code>A&amp;</code> reference, in class <code>B</code>, and point/refer it to the desired <code>A</code> object.  No smart pointer needed, since <code>B</code> does not manage the lifetime of the <code>A</code> object, the <code>vector</code> does. Just make sure the <code>B</code> object does not outlive the <code>A</code> object."}, {"owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "edited": false, "score": 2, "creation_date": 1523494860, "post_id": 49785614, "comment_id": 86588207, "body": "If You are using a vector, can&#39;t the index be stored instead of pointer/reference?"}, {"owner": {"reputation": 1096, "user_id": 4477125, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JYZmH.jpg?s=128&g=1", "display_name": "Lorence Hernandez", "link": "https://stackoverflow.com/users/4477125/lorence-hernandez"}, "edited": false, "score": 1, "creation_date": 1523495883, "post_id": 49785614, "comment_id": 86588422, "body": "but vector stores your data in the heap internally"}, {"owner": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 0, "creation_date": 1523516732, "post_id": 49785614, "comment_id": 86594991, "body": "Robert you&#39;re right I can:) Perhaps it can even perform faster than pointers under some circumstances than pointers because it needs less bits for the reference (more cache friendly). I&#39;m planning on testing if I&#39;ll be able to observe that with multithreading.  Lorence yes but in contiguous memory, and with less redirection (and less memory used because you save a pointer per object)"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1523521849, "post_id": 49785614, "comment_id": 86597815, "body": "@NeilButterworth the values in the vector are allocated wherever the allocator wants, which <i>by default</i> is the heap"}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 2, "creation_date": 1523525317, "post_id": 49785614, "comment_id": 86600142, "body": "If you want to store objects directly in the vector, then I urge you consider using <code>std::array</code>. If you want to store any reference to the object in vector, you must remember it will get invalidated upon resize. If you don&#39;t want to allow resizing/invalidation within the vector, then it&#39;s as good as <code>array</code> and this type will express those semantics verbosely."}, {"owner": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "reply_to_user": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1523526154, "post_id": 49785614, "comment_id": 86600712, "body": "@luk32 Thanks. This is exactly the semantics I want. The master array - the set of all tiles in a zone - will never grow or shrink after creation."}], "answers": [{"tags": [], "owner": {"reputation": 6824, "user_id": 3202093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004496564514/picture?type=large", "display_name": "sp2danny", "link": "https://stackoverflow.com/users/3202093/sp2danny"}, "is_accepted": false, "score": 3, "last_activity_date": 1523519710, "creation_date": 1523519710, "answer_id": 49790949, "question_id": 49785614, "link": "https://stackoverflow.com/questions/49785614/referencing-objects-in-vector-modern-c/49790949#49790949", "title": "Referencing objects in vector (Modern C++)", "body": "<p>The primary purpose of smart-pointers is to manage life-time.<br>\nAn observer (i.e. non owning pointer) can still be a raw pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1523524860, "post_id": 49792603, "comment_id": 86599830, "body": "None of the approaches will work if you invalidate iterators with <code>vector</code> storing objects directly within itself."}, {"owner": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 0, "creation_date": 1523526685, "post_id": 49792603, "comment_id": 86601059, "body": "Thanks. It&#39;s going to be either non-owning raw pointer or index then:) And probably std::array as suggested earlier. Did you mean to say that B should be guaranteed NOT to outlive A? And for the index I would use &quot;if (aIndex_ &gt;= 0...&quot;, since 0 is a valid tile right?"}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "reply_to_user": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 0, "creation_date": 1523526870, "post_id": 49792603, "comment_id": 86601201, "body": "@Jesper Yes, you are right, I&#39;ve fixed those two mistakes."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "reply_to_user": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 1, "creation_date": 1523527021, "post_id": 49792603, "comment_id": 86601316, "body": "@Jesper <code>std::array</code> is probably the right choice if you know the size at compile time."}, {"owner": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 0, "creation_date": 1523527481, "post_id": 49792603, "comment_id": 86601631, "body": "@ChrisDrew ah ok, vector it is then since size is fixed at runtime, not compile time."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 1, "creation_date": 1523812938, "post_id": 49792603, "comment_id": 86704205, "body": "@Jesper there used to be a proposal for <code>std::dyn_array</code> which had a constant size determined at runtime, but it seems to have been abandoned. I\u2019d look in Boost to see if it had something like that before deciding to use <code>vector</code>."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1523813475, "post_id": 49792603, "comment_id": 86704417, "body": "I didn\u2019t find anything in Boost, but it looks like <a href=\"https://abseil.io/about/\" rel=\"nofollow noreferrer\">Abseil</a> has a <code>FixedArray</code>."}], "tags": [], "owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "is_accepted": true, "score": 5, "last_activity_date": 1523812376, "last_edit_date": 1523812376, "creation_date": 1523524483, "answer_id": 49792603, "question_id": 49785614, "link": "https://stackoverflow.com/questions/49785614/referencing-objects-in-vector-modern-c/49792603#49792603", "title": "Referencing objects in vector (Modern C++)", "body": "<p>You have a few options, based on your requirements.</p>\n\n<h2>Non-owning raw-pointer <code>A*</code></h2>\n\n<p>There is nothing wrong with having a non-owning raw-pointer in modern C++. If <code>B</code> needs a nullable reference to <code>A</code> and the <code>A</code> can be guaranteed to outlive <code>B</code> then a raw-pointer is perfectly fine. One reason that the reference might need to be nullable is if you need to default construct <code>B</code> and then set the reference later:</p>\n\n<pre><code>class B {\n  A* a_ = nullptr;\npublic:\n  void setA(A&amp; a) { a_ = &amp;a; }\n};\n\nint main() {\n  std::vector&lt;A&gt; aVec(3);\n  B b;\n  b.setA(aVec[1]);\n}\n</code></pre>\n\n<h2>Reference <code>A&amp;</code></h2>\n\n<p>If the reference does not need to be nullable. If the reference is set in the constructor of <code>B</code> and never changes then you can use a reference <code>A&amp;</code>:</p>\n\n<pre><code>class B {\n  A&amp; a_;\npublic:\n  B(A&amp; a) : a_(a) {}\n};\n\nint main() {\n  std::vector&lt;A&gt; aVec (3);\n  B b(aVec[1]);\n}\n</code></pre>\n\n<h2><code>std::reference_wrapper&lt;A&gt;</code></h2>\n\n<p>One problem with using a reference is that you can't reseat the reference to point to a different <code>a</code> which means you can't have a <code>setA</code> member function and you can't have an assignment operator <code>B::operator=(const B&amp;)</code>. You could just use a non-owning raw-pointer and enforce that the raw-pointer should never be null. But the standard library now provides a convenience called <a href=\"http://en.cppreference.com/w/cpp/utility/functional/reference_wrapper\" rel=\"nofollow noreferrer\"><code>std::reference_wrapper</code></a> which can not be null like a reference but can be reseated like a pointer:</p>\n\n<pre><code>class B {\n  std::reference_wrapper&lt;A&gt; a_;\npublic:\n  B(A&amp; a) : a_(a) {}\n  void setA(A&amp; a) { a_ = a; }\n};\n\nint main() {\n  std::vector&lt;A&gt; aVec (3);\n\n  B b(aVec[1]);\n  B otherB(aVec[2]);\n\n  b = otherB;  // use auto-generated assignment operator\n  b.setA(aVec[0]);\n}\n</code></pre>\n\n<h2>index to an element in the <code>vector</code></h2>\n\n<p>One common case is where the <code>vector</code> of <code>A</code> is growing and so it might re-allocate and invalidate references, pointers and iterators. In this case you could store an index to an element in the <code>vector</code>. This index will not be invalidated when the <code>vector</code> grows and also you can check the index is within bounds of the vector and not dangling:</p>\n\n<pre><code>class B {\n  std::vector&lt;A&gt;&amp; aVec_;\n  int             aIndex_;\npublic:\n  B(std::vector&lt;A&gt;&amp; aVec, int aIndex) : aVec_(aVec), aIndex_(aIndex) {}\n\n  void useA() {\n    if (aIndex_ &gt;= 0 &amp;&amp; aIndex_ &lt; aVec_.size()) {\n      auto&amp; a = aVec_[aIndex_];\n      // use a ...\n    }\n  }\n};\n\nint main() {\n  std::vector&lt;A&gt; aVec (3);\n\n  B b(aVec, 1);\n  b.useA();\n}\n</code></pre>\n\n<p>If you are adding and removing from your <code>vector</code> of <code>A</code> then none of these approaches will work and you might need to reconsider your design.</p>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 0, "creation_date": 1523620607, "post_id": 49814164, "comment_id": 86647154, "body": "That is definitely something I would really like to do if my benchmarking suggests it&#39;s feasible performance-wide. If I can do this throughout an entire subsystem then it would be possible to save the entire state by using a custom allocator and just save the entire memory block - no need for traversing anything to hook up pointers correctly on deserializing."}, {"owner": {"reputation": 313, "user_id": 6483524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eeb6ee7ec0f01f1d68bb7a9f2ffa34f?s=128&d=identicon&r=PG&f=1", "display_name": "Tiger4Hire", "link": "https://stackoverflow.com/users/6483524/tiger4hire"}, "reply_to_user": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 0, "creation_date": 1523625011, "post_id": 49814164, "comment_id": 86650058, "body": "If your on Windows, try profiling an AMP version too. <a href=\"https://msdn.microsoft.com/en-us/library/hh265137.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/hh265137.aspx</a>. An index-oriented version of the code should be a doddle to convert. I&#39;d love to see the results."}, {"owner": {"reputation": 313, "user_id": 6483524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eeb6ee7ec0f01f1d68bb7a9f2ffa34f?s=128&d=identicon&r=PG&f=1", "display_name": "Tiger4Hire", "link": "https://stackoverflow.com/users/6483524/tiger4hire"}, "reply_to_user": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "edited": false, "score": 0, "creation_date": 1523625696, "post_id": 49814164, "comment_id": 86650536, "body": "<a href=\"https://stackoverflow.com/questions/8145449/how-come-my-array-index-is-faster-than-pointer\" title=\"how come my array index is faster than pointer\">stackoverflow.com/questions/8145449/&hellip;</a>"}], "tags": [], "owner": {"reputation": 313, "user_id": 6483524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eeb6ee7ec0f01f1d68bb7a9f2ffa34f?s=128&d=identicon&r=PG&f=1", "display_name": "Tiger4Hire", "link": "https://stackoverflow.com/users/6483524/tiger4hire"}, "is_accepted": false, "score": 1, "last_activity_date": 1523613273, "creation_date": 1523613273, "answer_id": 49814164, "question_id": 49785614, "link": "https://stackoverflow.com/questions/49785614/referencing-objects-in-vector-modern-c/49814164#49814164", "title": "Referencing objects in vector (Modern C++)", "body": "<p>The obvious answer is the simplest, store the index of the object, not the address.</p>\n"}], "owner": {"reputation": 191, "user_id": 8547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c82c699120fe3fd292d257a43b6376?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/8547956/jesper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 1, "accepted_answer_id": 49792603, "answer_count": 3, "score": 5, "last_activity_date": 1523812376, "creation_date": 1523487888, "last_edit_date": 1523523287, "question_id": 49785614, "link": "https://stackoverflow.com/questions/49785614/referencing-objects-in-vector-modern-c", "title": "Referencing objects in vector (Modern C++)", "body": "<p>I'm sorry if this is very simple but I haven't played with C++ for more than 15 years.\nConsider this simple example:\nA vector contains objects of type <code>A</code>. \nAn object of class <code>B</code> must reference an <code>A</code> object that resides in the vector. (Edit for clarification - class <code>B</code> must have a member that references the <code>A</code> instance)</p>\n\n<p>Back in the day you would just declare an <code>A*</code> and be done with it, but how would one do it today with smart pointers? I don't want to store shared or unique pointers in the vector, because I don't want the A objects allocated all over the heap. They have to be in the vector itself.</p>\n"}, {"tags": ["c++", "arduino"], "comments": [{"owner": {"reputation": 396, "user_id": 3203817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f81efff47d429c32515d29ee4f11a02?s=128&d=identicon&r=PG", "display_name": "Immac", "link": "https://stackoverflow.com/users/3203817/immac"}, "edited": false, "score": 1, "creation_date": 1523487980, "post_id": 49785570, "comment_id": 86586673, "body": "So, in more general terms you want to measure time, try looking for that on google first."}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 8731135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31403414a1f928e7ab619ff30e3a1b0c?s=128&d=identicon&r=PG&f=1", "display_name": "Baedsch", "link": "https://stackoverflow.com/users/8731135/baedsch"}, "is_accepted": true, "score": 4, "last_activity_date": 1523488676, "last_edit_date": 1523488676, "creation_date": 1523487913, "answer_id": 49785616, "question_id": 49785570, "link": "https://stackoverflow.com/questions/49785570/what-is-the-equivalent-of-millis-in-c/49785616#49785616", "title": "What is the equivalent of millis() in C++", "body": "<p>You should be able to do all you need using the std::chrono library (since c++11)</p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;iostream&gt; \nint main()\n{\n    auto start = std::chrono::system_clock::now();\n    do_sth();\n    auto end = std::chrono::system_clock::now();\n    std::cout &lt;&lt; \"do_sth() \"\n                  &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end - start).count()\n                  &lt;&lt; \"ms.\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9616606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def3fd119584664f498e29c28b49854a?s=128&d=identicon&r=PG&f=1", "display_name": "Cyborgshark", "link": "https://stackoverflow.com/users/9616606/cyborgshark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "accepted_answer_id": 49785616, "answer_count": 1, "score": -1, "last_activity_date": 1523488676, "creation_date": 1523487560, "last_edit_date": 1523487926, "question_id": 49785570, "link": "https://stackoverflow.com/questions/49785570/what-is-the-equivalent-of-millis-in-c", "title": "What is the equivalent of millis() in C++", "body": "<p>I'm trying to create a PID controller in C++ based on an Arduino code. The original code uses the function millis() to retrieve the number of milliseconds the arduino has ran. I was curious if there was an equivalent in C++.</p>\n\n<p>I appreciate any help, I am new to C++. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "edited": false, "score": 0, "creation_date": 1523487626, "post_id": 49785562, "comment_id": 86586580, "body": "Please somebody help, been racking my brain for hours over this!"}, {"owner": {"reputation": 1618, "user_id": 305043, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e3e44a7fa84d1449455aba670a48187?s=128&d=identicon&r=PG&f=1", "display_name": "PM.", "link": "https://stackoverflow.com/users/305043/pm"}, "edited": false, "score": 0, "creation_date": 1523493382, "post_id": 49785562, "comment_id": 86587912, "body": "why not get the values in two more variables and use two more <code>cout</code> statements? Or am I missing something?"}, {"owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "reply_to_user": {"reputation": 1618, "user_id": 305043, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e3e44a7fa84d1449455aba670a48187?s=128&d=identicon&r=PG&f=1", "display_name": "PM.", "link": "https://stackoverflow.com/users/305043/pm"}, "edited": false, "score": 0, "creation_date": 1523495052, "post_id": 49785562, "comment_id": 86588237, "body": "Gorans code throws up errors, it works if i nest it inside my loops(which looks all kinds of   wrong) and repeats the output 5times!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "edited": false, "score": 0, "creation_date": 1523489222, "post_id": 49785632, "comment_id": 86586984, "body": "thanks it kind of works, just displays the info 5 times on 5 different lines, i&#39;ll play around with it , i may have put it in the wrong place or something, thanks dude!"}, {"owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "edited": false, "score": 0, "creation_date": 1523495954, "post_id": 49785632, "comment_id": 86588433, "body": "it throws up errors when I use your code in place of mine Goran, it actually works if i nest it inside my for loop and comment out my cout line (but that looks odd and must be wrong) but it repeats the output 5 times on 5 seperate lines!"}, {"owner": {"reputation": 1493, "user_id": 9385966, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WtdbWV1QtcQ/AAAAAAAAAAI/AAAAAAAAE_4/Eod8Vj3X1-U/photo.jpg?sz=128", "display_name": "gflegar", "link": "https://stackoverflow.com/users/9385966/gflegar"}, "reply_to_user": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "edited": false, "score": 0, "creation_date": 1523522358, "post_id": 49785632, "comment_id": 86598104, "body": "Works fine for me, you have to remove your initial definition of <code>iBestSeller</code>. I&#39;ve updated my answer to contain the complete code."}, {"owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "edited": false, "score": 0, "creation_date": 1523566406, "post_id": 49785632, "comment_id": 86626164, "body": "Thankyou for helping me Goran, Ive put my finished program on here( quite proud of it)!!"}], "tags": [], "owner": {"reputation": 1493, "user_id": 9385966, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WtdbWV1QtcQ/AAAAAAAAAAI/AAAAAAAAE_4/Eod8Vj3X1-U/photo.jpg?sz=128", "display_name": "gflegar", "link": "https://stackoverflow.com/users/9385966/gflegar"}, "is_accepted": false, "score": 1, "last_activity_date": 1523522533, "last_edit_date": 1523522533, "creation_date": 1523487999, "answer_id": 49785632, "question_id": 49785562, "link": "https://stackoverflow.com/questions/49785562/how-to-display-more-information-from-a-structure-when-sorting-the-data-from-an-i/49785632#49785632", "title": "how to display more information from a structure when sorting the data from an interger within", "body": "<p>Something like this:</p>\n\n<pre><code>Stock iBestSeller{};\nfor (int iCount = 0; iCount &lt; 5; iCount++) {\n    if (stockRecords[iCount].iSold &gt; iBestSeller.iSold) {\n        iBestSeller = stockRecords[iCount];\n    }\n}\ncout &lt;&lt; \"biggest seller= \" &lt;&lt; iBestSeller.sName &lt;&lt; \" \"\n     &lt;&lt; iBestSeller.fPrice &lt;&lt; \" \" &lt;&lt; iBestSeller.iSold &lt;&lt; endl;\n</code></pre>\n\n<p>Complete code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n\nusing namespace std;\n\nstruct Stock {\n    string sName = \"\";\n    float fPrice = 0;\n    int iSold = 0;\n};\n\nint main()\n{\n    cout &lt;&lt; \"Hello, welcome to the program\";\n\n    //* &lt;- remove first '/' from here to enable user input\n    istringstream cin(\n        \"Stock1 10 15 \\n\"\n        \"Stock2 12  7 \\n\"\n        \"Stock3 13 17 \\n\"\n        \"Stock4 11  5 \\n\"\n        \"Stock5  3  7 \\n\"\n    );\n    // */\n    Stock stockRecords[5];\n    cout &lt;&lt; \"Please enter stock name, followed by price, and amount sold: \\n\";\n\n    for (int iCount = 0; iCount &lt; 5; iCount++)\n    {\n        cin &gt;&gt; stockRecords[iCount].sName\n            &gt;&gt; stockRecords[iCount].fPrice\n            &gt;&gt; stockRecords[iCount].iSold;\n    }\n\n    Stock iBestSeller{};\n    for (int iCount = 0; iCount &lt; 5; iCount++) {\n        if (stockRecords[iCount].iSold &gt; iBestSeller.iSold) {\n            iBestSeller = stockRecords[iCount];\n        }\n    }\n    cout &lt;&lt; \"biggest seller= \" &lt;&lt; iBestSeller.sName &lt;&lt; \" \"\n         &lt;&lt; iBestSeller.fPrice &lt;&lt; \" \" &lt;&lt; iBestSeller.iSold &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Prints out:</p>\n\n<pre><code>Hello, welcome to the programPlease enter stock name, followed by price, and amount sold: \nbiggest seller= Stock3 13 17\n</code></pre>\n\n<p>Live example: <a href=\"https://onlinegdb.com/SJIDo93oz\" rel=\"nofollow noreferrer\">https://onlinegdb.com/SJIDo93oz</a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "edited": false, "score": 0, "creation_date": 1523524668, "post_id": 49787621, "comment_id": 86599704, "body": "thats great, thankyou for helping, i also need to do same with the worse seller(amongst other things) would it work if it did same but just in reverse?"}, {"owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "reply_to_user": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "edited": false, "score": 0, "creation_date": 1523537500, "post_id": 49787621, "comment_id": 86608470, "body": "Exactly.  Simply changing the <code>&gt;</code> to <code>&lt;</code> will give you the worst seller.  If you want both, just create another instance of <code>Stock</code> (<code>iWorstSeller</code>?) and initialize it the same way you initialize <code>iBestSeller</code> and run the opposing test within the same loop. I have editted the last bit of code in the answer to reflect this."}, {"owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "edited": false, "score": 0, "creation_date": 1523566456, "post_id": 49787621, "comment_id": 86626192, "body": "Thanks alot Jason, much appreiciated!!"}], "tags": [], "owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "is_accepted": false, "score": 0, "last_activity_date": 1523537686, "last_edit_date": 1523537686, "creation_date": 1523504446, "answer_id": 49787621, "question_id": 49785562, "link": "https://stackoverflow.com/questions/49785562/how-to-display-more-information-from-a-structure-when-sorting-the-data-from-an-i/49787621#49787621", "title": "how to display more information from a structure when sorting the data from an interger within", "body": "<p>So a few things... You are printing out the result 5 times because it is in your loop:</p>\n\n<pre><code>for (int iCount = 0; iCount &lt; 5; iCount++)\n    {//loop start\n     if (stockRecords[iCount].iSold &gt; iBestSeller)\n    {\n         iBestSeller = stockRecords[iCount].iSold;\n    }\n     cout &lt;&lt; \"biggest seller= \" &lt;&lt; iBestSeller;\n} //loop end\n</code></pre>\n\n<p>Your input is super difficult to follow when inputting data. Add cout statements into the input loop:</p>\n\n<pre><code>for (int iCount = 0; iCount &lt; 5; iCount++)\n{\n    cout &lt;&lt; \"Please enter stock name: \";\n    cin &gt;&gt; stockRecords[iCount].sName;\n    cout &lt;&lt; \"Please enter the price for \" &lt;&lt; stockRecords[iCount].sName &lt;&lt; \": \";\n    cin &gt;&gt; stockRecords[iCount].fPrice;\n    cout &lt;&lt; \"Please the amount sold of \" &lt;&lt; stockRecords[iCount].sName &lt;&lt; \": \";\n    cin &gt;&gt; stockRecords[iCount].iSold;\n}\n</code></pre>\n\n<p>This input style is not very robust.  Relying on <code>cin</code> for integer input is going to get you in trouble.  Any non-integer input will produce unpredictable results.  You should be taking in all data as strings and converting to integers.  <a href=\"https://www.geeksforgeeks.org/converting-strings-numbers-cc/\" rel=\"nofollow noreferrer\">Here</a> is a useful link for ways to do it.</p>\n\n<p>Here, I have taken Goran's suggestion and incorporated into your code.  He was simply saying best seller should be of type Stock and set it equal to which ever structure had the greatest iSold. Also, I built this in Linux, so I commented out all your Windows stuff:</p>\n\n<pre><code>//#include \"stdafx.h\"\n#include &lt;iostream&gt;\n//#include &lt;conio.h&gt;\n#include &lt;string&gt;\n#include &lt;array&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nstruct Stock\n{\n    string sName = \"\";\n    float fPrice = 0;\n    int iSold = 0;\n};\n\nint main()\n{\n    //using a Stock type instead of int\n    Stock iBestSeller{};\n\n    cout &lt;&lt; \"Hello, welcome to the program\\n\";\n\n    Stock stockRecords[5];\n\n    //loop here for the input of 5 records\n     for (int iCount = 0; iCount &lt; 5; iCount++)\n    {\n        cout &lt;&lt; \"Please enter stock name: \";\n         cin &gt;&gt; stockRecords[iCount].sName;\n        cout &lt;&lt; \"Please enter the price for \" &lt;&lt; stockRecords[iCount].sName &lt;&lt; \": \";\n         cin &gt;&gt; stockRecords[iCount].fPrice;\n        cout &lt;&lt; \"Please the amount sold of \" &lt;&lt; stockRecords[iCount].sName &lt;&lt; \": \";\n         cin &gt;&gt; stockRecords[iCount].iSold;\n    }\n\n    //Good idea to initialize it before accessing iBestSeller.iSold\n    iBestSeller = stockRecords[0];\n\n    //This loop is only for determining the best seller\n    for (int iCount = 0; iCount &lt; 5; iCount++) {\n        if (stockRecords[iCount].iSold &gt; iBestSeller.iSold) {\n            iBestSeller = stockRecords[iCount];\n        }\n    }\n\n    //output the results 1 time\n    cout &lt;&lt; \"biggest seller= \" &lt;&lt; iBestSeller.sName &lt;&lt; \" \"\n     &lt;&lt; iBestSeller.fPrice &lt;&lt; \" \" &lt;&lt; iBestSeller.iSold &lt;&lt; endl;\n\n\n\n    //_getch();\n    return 0;\n}\n</code></pre>\n\n<p>For simplicity, I kept it all separated.  In reality, there is no reason that you cannot combine the loop for input and loop to determine the best seller:</p>\n\n<pre><code>for (int iCount = 0; iCount &lt; 5; iCount++)\n{\n    cout &lt;&lt; \"Please enter stock name: \";\n    cin &gt;&gt; stockRecords[iCount].sName;\n    cout &lt;&lt; \"Please enter the price for \" &lt;&lt; stockRecords[iCount].sName &lt;&lt; \": \";\n    cin &gt;&gt; stockRecords[iCount].fPrice;\n    cout &lt;&lt; \"Please the amount sold of \" &lt;&lt; stockRecords[iCount].sName &lt;&lt; \": \";\n    cin &gt;&gt; stockRecords[iCount].iSold;\n\n\n    if (iCount == 0)\n    {  // will now need brackets\n        iBestSeller = stockRecords[0];\n        iWorstSeller = stockRecords[0];   // added\n    }\n    else if (stockRecords[iCount].iSold &gt; iBestSeller.iSold)\n        iBestSeller = stockRecords[iCount];\n    //Added \n    else if (stockRecords[iCount].iSold &lt; iWorstSeller.iSold)\n        iWorstSeller = stockRecords[iCount];\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "is_accepted": false, "score": 0, "last_activity_date": 1523566266, "creation_date": 1523566266, "answer_id": 49805660, "question_id": 49785562, "link": "https://stackoverflow.com/questions/49785562/how-to-display-more-information-from-a-structure-when-sorting-the-data-from-an-i/49805660#49805660", "title": "how to display more information from a structure when sorting the data from an interger within", "body": "<p>Thankyou for your help everyone, I managed to finish my program, with the other extra features it needed, Im very greatful for your help, next I need to learn vectors and pointers, so I may be back!!!</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\n#include &lt;string&gt;\n#include &lt;array&gt;\n\n\nusing namespace std;\n\nstruct Stock//structure where items of stock and their price and amount sold are held\n{\n    string sName = \"\";\n    float fPrice = 0;\n    int iSold = 0;\n};\n\nint main()\n{\n\n    int iDiffSold = 0;// various varibles are named\n    float fTotalSales = 0, fOpCost = 0, fTax = 0, fProfit = 0, fSalesWarning = 0;\n\n\n    Stock iBestSeller{};// using stock types instead of ints\n    Stock iWorseSeller{};\n\n\n    cout &lt;&lt; \"-------------------------------------------------------------\" &lt;&lt; \"\\n\";//welcome mesage\n    cout &lt;&lt; \"|            Hello, Welcome to the Program.                 |\" &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"-------------------------------------------------------------\" &lt;&lt; \"\\n\";\n    Stock stockRecords[5];\n\n    //loop here for the input of 5 records\n    for (int iCount = 0; iCount &lt; 5; iCount++)\n    {\n        cout &lt;&lt; \"\\nPlease enter the name for the item of stock: \";\n        cin &gt;&gt; stockRecords[iCount].sName;\n        cout &lt;&lt; \"\\nPlease enter the price for \" &lt;&lt; stockRecords[iCount].sName &lt;&lt; \": \";\n        cin &gt;&gt; stockRecords[iCount].fPrice;\n        cout &lt;&lt; \"\\nPlease enter the amount sold of \" &lt;&lt; \nstockRecords[iCount].sName &lt;&lt; \": \";\n        cin &gt;&gt; stockRecords[iCount].iSold;\n    }\n\n    system(\"cls\");\n\n    // initialize iBestSeller\n    iBestSeller = stockRecords[0];\n\n    //This loop is for determining the best seller\n    for (int iCount = 0; iCount &lt; 5; iCount++) {\n        if (stockRecords[iCount].iSold &gt; iBestSeller.iSold) {\n            iBestSeller = stockRecords[iCount];\n        }\n    }\n\n    //output the best seller results\n    cout &lt;&lt; \"\\nbiggest seller= \" &lt;&lt; iBestSeller.sName &lt;&lt; \" it's selling price is \"\n    &lt;&lt; iBestSeller.fPrice &lt;&lt; \" and \" &lt;&lt; iBestSeller.iSold &lt;&lt; \" item were sold\" &lt;&lt; endl;\n\n    // initialize iWorseSeller\n   iWorseSeller = stockRecords[0];\n\n    //This loop is for determining the worse seller\n    for (int iCount = 0; iCount &lt; 5; iCount++) {\n        if (stockRecords[iCount].iSold &lt; iWorseSeller.iSold) {\n            iWorseSeller = stockRecords[iCount];\n        }\n    }\n\n    //output the worse seller results\n    cout &lt;&lt; \"\\nWorse seller= \" &lt;&lt; iWorseSeller.sName &lt;&lt; \" it's selling price is \"\n    &lt;&lt; iWorseSeller.fPrice &lt;&lt; \" and  \" &lt;&lt; iWorseSeller.iSold &lt;&lt; \" items were sold\" &lt;&lt; endl;\n\n\n    iDiffSold = iBestSeller.iSold - iWorseSeller.iSold;//this works out the difference between the most and least items sold\n\n    cout &lt;&lt; \"\\nThe difference between the amount of the most sold item and the least is \" &lt;&lt; iDiffSold &lt;&lt; \"\\n\" ;//outputs difference\n\n\n\n    for (int iCount = 0; iCount &lt; 5; iCount++) {\n\n        fTotalSales = fTotalSales + (stockRecords[iCount].iSold * stockRecords[iCount].fPrice);//this for loop finds the total price of all the items sold\n\n    }\n\n    cout &lt;&lt; \"\\nThe total price of all the items sold is: \" &lt;&lt; fTotalSales &lt;&lt; \"\\n\";//outputs total\n\n    fOpCost = fTotalSales / 2;//works out operational costs\n\n    cout &lt;&lt; \"\\nThe price of operational costs is: \" &lt;&lt; fOpCost &lt;&lt; \"\\n\";//outputs operational cost\n\n    fTax = fTotalSales * .2;//works out tax due\n\n    cout &lt;&lt; \"\\nThe tax you will owe for these sales will be: \" &lt;&lt; fTax &lt;&lt; \"\\n\";//outputs tax due\n\n    fProfit = fTotalSales - fOpCost - fTax;//works out profit\n\n    cout &lt;&lt; \"\\nThis will leave you a profit of: \" &lt;&lt; fProfit &lt;&lt; \"\\n\";//outputs profit\n\n    fSalesWarning = fTotalSales * .005;//this line and the loops below work out and output the five percent of sales warning(if one is due)\n\n    for (int iCount = 0; iCount &lt; 5; iCount++)\n    {\n        if (stockRecords[iCount].iSold * stockRecords[iCount].fPrice &lt;= fSalesWarning)\n        {\n            cout &lt;&lt; \"\\nWARNING! The item \" &lt;&lt; stockRecords[iCount].sName &lt;&lt; \" has sales that constitute 5% of sales or less\";\n        }\n    }\n      _getch();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8256414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155519018334375/picture?type=large", "display_name": "Daniel Park", "link": "https://stackoverflow.com/users/8256414/daniel-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1523566266, "creation_date": 1523487521, "question_id": 49785562, "link": "https://stackoverflow.com/questions/49785562/how-to-display-more-information-from-a-structure-when-sorting-the-data-from-an-i", "title": "how to display more information from a structure when sorting the data from an interger within", "body": "<pre><code>// C++a2.cpp : Defines the entry point for the console application.\n//\n#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\n#include &lt;string&gt;\n#include &lt;array&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n</code></pre>\n\n<p>Ive sussed out how to display the largest interger(from .iSold) but I need it to also display the name of the stock item(from .sName and its price (from.fPrice) from the items/varibles that i have stored in the struct stock? </p>\n\n<pre><code>struct Stock\n{\n string sName = \"\";\n float fPrice = 0;\n int iSold = 0;\n\n};\n\nint main()\n{\n     int iBestSeller = 0;\n     cout &lt;&lt; \"Hello, welcome to the program\";\n\n     Stock stockRecords[5];\n\n     cout &lt;&lt; \"Please enter stock name, followed by price, and amount sold: \\n\";\n\n     for (int iCount = 0; iCount &lt; 5; iCount++)\n    {\n\n         cin &gt;&gt; stockRecords[iCount].sName;\n         cin &gt;&gt; stockRecords[iCount].fPrice;\n         cin &gt;&gt; stockRecords[iCount].iSold;\n\n\n    }\n\n     for (int iCount = 0; iCount &lt; 5; iCount++)\n    {\n     if (stockRecords[iCount].iSold &gt; iBestSeller)\n    {\n         iBestSeller = stockRecords[iCount].iSold;\n    }\n     cout &lt;&lt; \"biggest seller= \" &lt;&lt; iBestSeller;//need to display the other information along with the best selling item, its name and price\n}\n\n\n\n\n\n    _getch();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "for-loop", "switch-statement"], "comments": [{"owner": {"reputation": 19688, "user_id": 3149020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001905387968/picture?type=large", "display_name": "Spencer Wieczorek", "link": "https://stackoverflow.com/users/3149020/spencer-wieczorek"}, "edited": false, "score": 0, "creation_date": 1523487478, "post_id": 49785519, "comment_id": 86586539, "body": "You want to add <code>break</code> at the end of each <code>case</code>. Otherwise it&#39;s not going to work as intended and hit every case until a <code>break</code> is found."}], "answers": [{"comments": [{"owner": {"reputation": 621, "user_id": 4408818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e5f51aedefde420afa4a8f7f71a173?s=128&d=identicon&r=PG&f=1", "display_name": "Ozymandias", "link": "https://stackoverflow.com/users/4408818/ozymandias"}, "edited": false, "score": 0, "creation_date": 1523487742, "post_id": 49785549, "comment_id": 86586607, "body": "So when x = 2, case 0 is also executed even thought the condition is not  satisfied?"}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 621, "user_id": 4408818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e5f51aedefde420afa4a8f7f71a173?s=128&d=identicon&r=PG&f=1", "display_name": "Ozymandias", "link": "https://stackoverflow.com/users/4408818/ozymandias"}, "edited": false, "score": 3, "creation_date": 1523487884, "post_id": 49785549, "comment_id": 86586645, "body": "In C, a <code>case</code> is not a condition that guards execution. It&#39;s more like a <code>goto</code> label."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 621, "user_id": 4408818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e5f51aedefde420afa4a8f7f71a173?s=128&d=identicon&r=PG&f=1", "display_name": "Ozymandias", "link": "https://stackoverflow.com/users/4408818/ozymandias"}, "edited": false, "score": 0, "creation_date": 1523518147, "post_id": 49785549, "comment_id": 86595755, "body": "@Ozymandias <code>case 0</code> is coded below <code>case 2</code>. Without a <code>break</code>, execution flow starting in <code>case 2</code> falls through to <code>case 0</code>. Swap the order of the cases, and you won&#39;t see <code>case 0</code> executed anymore when <code>x=2</code>, but you will see <code>case 2</code> executed when <code>x=0</code>"}], "tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": true, "score": 6, "last_activity_date": 1523487419, "creation_date": 1523487419, "answer_id": 49785549, "question_id": 49785519, "link": "https://stackoverflow.com/questions/49785519/why-does-this-code-print-0223/49785549#49785549", "title": "Why does this code print 0223?", "body": "<p>Case 2 doesn't get evaluated twice: it is evaluated exactly once. However, when you don't end a case with the <code>break</code> statement, instead of leaving the <code>switch</code>, execution continues to the next case.</p>\n\n<p>In other words, when <code>x</code> is 2, execution jumps to <code>case 2</code> and call <code>printf(\"%d\", x)</code> with x = 2. Then, execution falls through to case 0, and calls <code>printf(\"%d\", x)</code> with x still equal to 2. Then, execution falls through to the <code>default</code> case, where it hits a <code>break</code> statement and finally leaves the <code>switch</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 154, "user_id": 3926412, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/386ec047887b2fbf66561f8f1023379f?s=128&d=identicon&r=PG&f=1", "display_name": "Kolt Penny", "link": "https://stackoverflow.com/users/3926412/kolt-penny"}, "is_accepted": false, "score": 1, "last_activity_date": 1523487510, "creation_date": 1523487510, "answer_id": 49785561, "question_id": 49785519, "link": "https://stackoverflow.com/questions/49785519/why-does-this-code-print-0223/49785561#49785561", "title": "Why does this code print 0223?", "body": "<p>It doesn't. There's no break on those cases. That's why it prints case 2 then case 0.</p>\n"}], "owner": {"reputation": 621, "user_id": 4408818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e5f51aedefde420afa4a8f7f71a173?s=128&d=identicon&r=PG&f=1", "display_name": "Ozymandias", "link": "https://stackoverflow.com/users/4408818/ozymandias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49785549, "answer_count": 2, "score": -2, "last_activity_date": 1523487664, "creation_date": 1523487259, "last_edit_date": 1523487588, "question_id": 49785519, "link": "https://stackoverflow.com/questions/49785519/why-does-this-code-print-0223", "title": "Why does this code print 0223?", "body": "<p>Why does case 2 get evaluated twice in this for loop?</p>\n\n<pre><code>for (int x = 0; x &lt;4; x++)\n{\n    switch (x)\n    {\n        case 2: printf(\"%d\", x);\n        case 0: printf(\"%d\", x);\n        default: break;\n        case 3: printf(\"%d\", x);\n    }\n}\n</code></pre>\n\n<p>edit: I forgot to add that this is not a legitimate piece of code. Just something that came up in my friends job exam last week.</p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": true, "score": 1, "last_activity_date": 1523487429, "last_edit_date": 1523487429, "creation_date": 1523487215, "answer_id": 49785513, "question_id": 49785463, "link": "https://stackoverflow.com/questions/49785463/convert-unsigned-char-to-int-c/49785513#49785513", "title": "Convert unsigned char to int c++", "body": "<p>Better use <code>static_cast</code> like below:</p>\n\n<pre><code> m = static_cast&lt;int&gt;(p[i][0]);\n</code></pre>\n\n<p>Also try like below as well:-</p>\n\n<pre><code> m = (p[i][0]) - '0';\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9633044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c11ae6ae46ab60da92f70508060c478?s=128&d=identicon&r=PG&f=1", "display_name": "user399127", "link": "https://stackoverflow.com/users/9633044/user399127"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "accepted_answer_id": 49785513, "answer_count": 1, "score": 0, "last_activity_date": 1523487429, "creation_date": 1523486882, "question_id": 49785463, "link": "https://stackoverflow.com/questions/49785463/convert-unsigned-char-to-int-c", "title": "Convert unsigned char to int c++", "body": "<p>I currently have a small problem with my code:</p>\n\n<pre><code>unsigned a[100][100];\nvoid f(unsigned char l, unsigned char h, unsigned char n, unsigned char p[][4]){\n    int i,k,t,x,y,z,m,j;\n    char s;\n    for (i = 0;i&lt;h;i++) {\n        a[i][0] = '|';\n        a[i][l + 1] = '|';\n    }\n    for (i = 0;i&lt;l+2;i++) a[h][i] = '-';\n    for (i = 0;i&lt;h;i++)\n        for (int j = 1;j&lt;l+1;j++)\n            a[i][j] = '.';\n    for(i=0;i&lt;n;i++){\n        //read each piece\n        for(j=0;j&lt;4;j++)\n            cin&gt;&gt;p[i][j];\n            for(m=(int)p[i][0];m&lt;5;m++)\n                for(j=3;j&lt;5;j++)\n                    a[j][m]=p[i][3];\n    }\n}\n</code></pre>\n\n<p>It doesn't convert unsigned char p[i][0] to int in m.</p>\n"}, {"tags": ["c++", "dashboard", "virtual-reality", "steam", "openvr"], "comments": [{"owner": {"reputation": 1748, "user_id": 1443386, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ec92d7417c029c4f351a8f75733f4eea?s=128&d=identicon&r=PG", "display_name": "Daniel Tate", "link": "https://stackoverflow.com/users/1443386/daniel-tate"}, "edited": false, "score": 0, "creation_date": 1523486906, "post_id": 49785422, "comment_id": 86586372, "body": "You should ask a specific question to get a specific answer."}, {"owner": {"reputation": 124, "user_id": 7729208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5137cc699688eb40ac71e0953a727ff1?s=128&d=identicon&r=PG&f=1", "display_name": "lemessur", "link": "https://stackoverflow.com/users/7729208/lemessur"}, "reply_to_user": {"reputation": 1748, "user_id": 1443386, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ec92d7417c029c4f351a8f75733f4eea?s=128&d=identicon&r=PG", "display_name": "Daniel Tate", "link": "https://stackoverflow.com/users/1443386/daniel-tate"}, "edited": false, "score": 0, "creation_date": 1523487905, "post_id": 49785422, "comment_id": 86586648, "body": "I asked two very specific questions. can anyone verify I need a dev account to make dashboard overlays? and does the app need to be distributed through the steam store? Please read and understand the entire post before down-voting it."}, {"owner": {"reputation": 1748, "user_id": 1443386, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ec92d7417c029c4f351a8f75733f4eea?s=128&d=identicon&r=PG", "display_name": "Daniel Tate", "link": "https://stackoverflow.com/users/1443386/daniel-tate"}, "edited": false, "score": 0, "creation_date": 1523487935, "post_id": 49785422, "comment_id": 86586658, "body": "I didn&#39;t down vote anything."}], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 7729208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5137cc699688eb40ac71e0953a727ff1?s=128&d=identicon&r=PG&f=1", "display_name": "lemessur", "link": "https://stackoverflow.com/users/7729208/lemessur"}, "is_accepted": true, "score": 2, "last_activity_date": 1523567690, "creation_date": 1523567690, "answer_id": 49805978, "question_id": 49785422, "link": "https://stackoverflow.com/questions/49785422/how-to-create-and-distribute-steamvr-dashboard-overlays/49805978#49805978", "title": "How to create and distribute SteamVR dashboard overlays", "body": "<p>On further review it appears I was misinterpreting my own debug output and reading a bit too much into it because the conclusions sort of made sense in my mind.</p>\n\n<p>The CreateDashboardOverlay call was working fine. Later on in my code I was calling ShowOverlay, which of course is not allowed for dashboard overlays (They are shown by opening them via the SteamVR dashboard UI).</p>\n\n<p>My dashboard overlay is working fine after all.</p>\n\n<p>To summarize, the answer to both of my questions is no. No Steam developer status is needed to create a dashboard overlay and SteamVR dashboard overlay apps do not need to be distributed through any kind of official channel.</p>\n"}], "owner": {"reputation": 124, "user_id": 7729208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5137cc699688eb40ac71e0953a727ff1?s=128&d=identicon&r=PG&f=1", "display_name": "lemessur", "link": "https://stackoverflow.com/users/7729208/lemessur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 49805978, "answer_count": 1, "score": 2, "last_activity_date": 1523567690, "creation_date": 1523486592, "last_edit_date": 1523492092, "question_id": 49785422, "link": "https://stackoverflow.com/questions/49785422/how-to-create-and-distribute-steamvr-dashboard-overlays", "title": "How to create and distribute SteamVR dashboard overlays", "body": "<p>To be totally clear. This question is about SteamVR dashboard overlays specifically, not regular overlays.</p>\n\n<p>I have been playing around with the C++ SteamVR SDK and working on some overlay application prototypes lately. Something I have not managed to do so far is to get a dashboard overlay to show up. The error I get when I call CreateDashboardOverlay is VROverlayError_PermissionDenied. I'm guessing that this is because I need to be authenticated with a SteamVR developer account, which I don't currently have. Can anyone verify that? There doesn't seem to be any (public) documentation on this at all beyond what's in openvr.h and the openvr github docs page, which is somewhat sparse.</p>\n\n<p>I'm also guessing that any dashboard overlay application would need to be distributed through the official Steam store, but again I can't find anything official on that. I suspect that Valve would require this since otherwise any old malware that happens to be running on the system could easily create an official-looking dashboard overlay.</p>\n\n<p>Note again that I am referring specifically to dashboard overlays. I can get regular overlays to show up just fine.</p>\n\n<p>There are a few repos on github with implementations of steamvr overlays (<a href=\"https://github.com/Hotrian/OpenVRDesktopDisplayPortal\" rel=\"nofollow noreferrer\">https://github.com/Hotrian/OpenVRDesktopDisplayPortal</a> for example), but I have yet to find one that is actually creating a dashboard overlay.</p>\n\n<p>Any info or links to documentation I'm somehow missing would be greatly appreciated. I'm starting to think I might be missing something obvious.</p>\n\n<p>Thanks</p>\n\n<p>Edit for clarity:</p>\n\n<p>My questions are: Am I getting the permission denied error when calling CreateDashboardOverlay because I need to satisfy some kind of authentication requirement such as having a steam dev account? And do SteamVR dashboard overlay apps need to be distributed via an official channel?</p>\n"}, {"tags": ["c++", "c++11", "rcpp"], "comments": [{"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1523486559, "post_id": 49785379, "comment_id": 86586267, "body": "That&#39;s pretty long, but you don&#39;t really say what you <i>really</i> want to do.  Maybe discuss it over on the rcpp-devel list instead?   And Rcpp Modules is <i>one</i> way of interface C++ from R ..."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1523487425, "post_id": 49785379, "comment_id": 86586524, "body": "@DirkEddelbuettel: I think I described this: I need to wrap a type that can&#39;t be copied. I have a pointer to it, which is managed by a <code>unique_ptr</code>. I have some functions that use this object. I want to call these functions from within R. I can take this to the rcpp-devel list, if that is a better place to ask."}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1523487768, "post_id": 49785379, "comment_id": 86586612, "body": "There are some things that are <i>very</i> idiosyncratic to the <i>R</i> interface to C which is the one we have to eventually fiddle things into as well.  So <i>everything</i> has to become a <code>SEXP</code> type.  You may want to look into <code>Rcpp::XPtr</code>.  It is not the most documented area but there are some posts here too.  I have the feeling you can&#39;t quite do what you want to do the way you are planning to do it."}], "answers": [{"comments": [{"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1523556321, "post_id": 49803194, "comment_id": 86620969, "body": "That&#39;s nice. You probably want to make C++11 use explicit with the plugin, and maybe stick to <code>Rcpp.h</code> as recommended."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1523557203, "post_id": 49803194, "comment_id": 86621389, "body": "@DirkEddelbuettel: You&#39;re right, it also works with <code>Rcpp.h</code> at the top. Rcpp-common says to add the <code>wrap</code> and <code>as</code> overloads before including <code>Rcpp.h</code>, this is why I had <code>RcppCommon.h</code> at the top."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 4243, "user_id": 1051830, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/jyfok.png?s=128&g=1", "display_name": "crea7or", "link": "https://stackoverflow.com/users/1051830/crea7or"}, "edited": false, "score": 0, "creation_date": 1523557365, "post_id": 49803194, "comment_id": 86621484, "body": "@crea7or: Then I need to <code>delete</code> manually. And I don&#39;t know what R does internally, will it make multiple copies? If so, stuff might get <code>delete</code>d too early. The <code>wrap</code> function generated by Rcpp creates a new object, so that is at least one extra copy of the pointer, which I&#39;d have to make sure doesn&#39;t get deleted."}], "tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": true, "score": 4, "last_activity_date": 1523557032, "last_edit_date": 1523557032, "creation_date": 1523556079, "answer_id": 49803194, "question_id": 49785379, "link": "https://stackoverflow.com/questions/49785379/rcpp-requires-a-copy-constructor/49803194#49803194", "title": "Rcpp requires a copy constructor", "body": "<p>The simplest solution I've found so far is to extract the pointer from the <code>std::unique_ptr</code> and create a <code>std::shared_ptr</code> from it.  Rcpp will wrap this, as it can be copied.</p>\n\n<pre><code>#include &lt;Rcpp.h&gt;\n#include &lt;memory&gt;\n#include &lt;string&gt;\n\n// Stuff to wrap:\n\nusing PtrClass = std::unique_ptr&lt;std::string&gt;;\n\nPtrClass createClass() { return PtrClass{new std::string(\"boo\")}; }\n\n// ---\n\nusing ShPtrClass = std::shared_ptr&lt;PtrClass::element_type&gt;;\n\nclass PtrClassOwner {\npublic:\n    ShPtrClass shPtrClass;\n    PtrClassOwner(PtrClass ptr) : shPtrClass(ptr.release()) {}\n};\n\nPtrClassOwner createClassWrapper() { return PtrClassOwner{createClass()}; }\n\nstd::string getString(PtrClassOwner const&amp; ptr) {\n    return *(ptr.shPtrClass);\n}\n\nRCPP_EXPOSED_CLASS(PtrClassOwner);\n\nRCPP_MODULE(Class){\n    using namespace Rcpp;\n    class_&lt;PtrClassOwner&gt;(\"PtrClass\");\n    function(\"createClass\", &amp;createClassWrapper, \"createClass method\");\n    function(\"getString\", &amp;getString, \"getString method\");\n}\n</code></pre>\n"}], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 49803194, "answer_count": 1, "score": 2, "last_activity_date": 1523557032, "creation_date": 1523486242, "last_edit_date": 1523556142, "question_id": 49785379, "link": "https://stackoverflow.com/questions/49785379/rcpp-requires-a-copy-constructor", "title": "Rcpp requires a copy constructor", "body": "<p>I'm trying to export some C++11 functionality to R, using Rcpp. Some of these functions return their result using a <code>std::unique_ptr</code>. This stuff cannot be copied. The MCVE below uses <code>std::unique_ptr&lt;std::string&gt;</code> to illustrate the errors.</p>\n\n<p>I have created a class around the <code>unique_ptr</code>, in the hopes of making all of this possible, but to no avail. This is the <code>PtrClassOwner</code> below. The function <code>createClassWrapper</code> calls the original <code>createClass</code>, to stick the <code>unique_ptr</code> in a <code>PtrClassOwner</code> object.</p>\n\n<pre><code>#include &lt;RcppCommon.h&gt;\n#include &lt;memory&gt;\n#include &lt;string&gt;\n\n// Stuff to wrap:\n\nusing PtrClass = std::unique_ptr&lt;std::string&gt;;\n\nPtrClass createClass() { return PtrClass{new std::string(\"boo\")}; }\n\n// ---\n\nclass PtrClassOwner {\npublic:\n    PtrClass string;\n};\n\nPtrClassOwner createClassWrapper() { return PtrClassOwner{createClass()}; }\n\nRCPP_EXPOSED_WRAP(PtrClassOwner); // Rcpp-extending vignette says RCPP_EXPORT_WRAP, which doesn't exist.\nRCPP_EXPOSED_AS(PtrClassOwner);\n\n#include &lt;Rcpp.h&gt;\n\nRCPP_MODULE(Class){\n    using namespace Rcpp;\n\n    class_&lt;PtrClassOwner&gt;(\"PtrClass\");\n\n    function(\"createClass\", &amp;createClassWrapper);\n}\n</code></pre>\n\n<p>This the first error reported by GCC (v 5.4, on Linux):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>In file included from /home/cris/R/x86_64-pc-linux-gnu-library/3.2/Rcpp/include/RcppCommon.h:195:0,\n                 from rcpp_module.cpp:1:\n/home/cris/R/x86_64-pc-linux-gnu-library/3.2/Rcpp/include/Rcpp/internal/wrap.h: In instantiation of \u2018SEXPREC* Rcpp::internal::wrap_dispatch(const T&amp;, Rcpp::traits::wrap_type_module_object_tag) [with T = PtrClassOwner; SEXP = SEXPREC*]\u2019:\n/home/cris/R/x86_64-pc-linux-gnu-library/3.2/Rcpp/include/Rcpp/internal/wrap_end.h:30:38:   required from \u2018SEXPREC* Rcpp::wrap(const T&amp;) [with T = PtrClassOwner; SEXP = SEXPREC*]\u2019\n/home/cris/R/x86_64-pc-linux-gnu-library/3.2/Rcpp/include/Rcpp/internal/wrap_end.h:35:20:   required from \u2018SEXPREC* Rcpp::module_wrap_dispatch(const T&amp;, Rcpp::traits::normal_wrap_tag) [with T = PtrClassOwner; SEXP = SEXPREC*]\u2019\n/home/cris/R/x86_64-pc-linux-gnu-library/3.2/Rcpp/include/Rcpp/internal/wrap.h:922:40:   required from \u2018SEXPREC* Rcpp::module_wrap(const T&amp;) [with T = PtrClassOwner; SEXP = SEXPREC*]\u2019\n/home/cris/R/x86_64-pc-linux-gnu-library/3.2/Rcpp/include/Rcpp/module/Module_generated_CppFunction.h:34:50:   required from \u2018SEXPREC* Rcpp::CppFunction0&lt;RESULT_TYPE&gt;::operator()(SEXPREC**) [with RESULT_TYPE = PtrClassOwner; SEXP = SEXPREC*]\u2019\nrcpp_module.cpp:26:1:   required from here\n/home/cris/R/x86_64-pc-linux-gnu-library/3.2/Rcpp/include/Rcpp/internal/wrap.h:759:54: error: use of deleted function \u2018PtrClassOwner::PtrClassOwner(const PtrClassOwner&amp;)\u2019\n             return Rcpp::internal::make_new_object&lt;T&gt;(new T(object));\n                                                      ^\nrcpp_module.cpp:9:7: note: \u2018PtrClassOwner::PtrClassOwner(const PtrClassOwner&amp;)\u2019 is implicitly deleted because the default definition would be ill-formed:\n class PtrClassOwner {\n       ^\n</code></pre>\n\n<p>The problem seems to be that, to wrap the object into an R object, it needs to be copied. <a href=\"https://stackoverflow.com/questions/33507105/rcpp-and-move-semantic\">This other question</a> is from someone running into a similar issue, but there are no answers.</p>\n\n<p>I have created a similar interface to Python, where the Python object just contains a pointer to the C++ object. I find it strange that Rcpp tries to copy the object to wrap it.</p>\n\n<p>Is there a way around this issue? Is it possible to wrap only a pointer to the object in an R type, and somehow still properly manage its lifetime? I'm open to any solutions, I'm not set on using Rcpp, it just seemed the most straightforward method to export this functionality.</p>\n"}, {"tags": ["c++", "mysql"], "comments": [{"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1523485967, "post_id": 49785054, "comment_id": 86586100, "body": "Try removing <code>;</code> from query so it looks like <code>CALL STATISTICS()</code>"}, {"owner": {"reputation": 159, "user_id": 3296404, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/f9dwT.png?s=128&g=1", "display_name": "lotuspaperboy", "link": "https://stackoverflow.com/users/3296404/lotuspaperboy"}, "reply_to_user": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1523538173, "post_id": 49785054, "comment_id": 86608995, "body": "@KillzoneKid I tried removing the &#39;;&#39; from &#39;CALL STATISTICS();&#39; but I still go the same results. I also tried removing the &#39;;&#39; from the &#39;END;&#39; in my procedure but that didn&#39;t change the outcome either."}], "owner": {"reputation": 159, "user_id": 3296404, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/f9dwT.png?s=128&g=1", "display_name": "lotuspaperboy", "link": "https://stackoverflow.com/users/3296404/lotuspaperboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523544923, "creation_date": 1523484161, "last_edit_date": 1523544923, "question_id": 49785054, "link": "https://stackoverflow.com/questions/49785054/mysql-capi-commands-out-of-sync-you-cant-run-this-command-now", "title": "mysql capi &quot;Commands out of sync; you can&#39;t run this command now&quot;", "body": "<p>I have some C++ code which is calling a stored procedure using the C libmysqlcleint library. I stored the procedure onto my database by running the below SQL code via a query on the MySQL Workbench app.</p>\n\n<p>Whenever my C++ code tries to call the stored sql procedure more than once, the query fails with a \"Commands out of sync; you can't run this command now\" error. I've trimmed my code down to the simplest form which shows this error.</p>\n\n<p>Here is the stored SQL procedure I am trying to run:</p>\n\n<pre><code>DELIMITER $$\nCREATE PROCEDURE test()\nBEGIN\n    SET @statement = CONCAT(\"SELECT 1\"); \n    PREPARE command FROM @statement;\n    EXECUTE command;\n    DEALLOCATE PREPARE command;\nEND$$\nDELIMITER ;\n</code></pre>\n\n<p>And here is my C++ code which tries to repeatedly call this procedure:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;mysql/mysql.h&gt;\n\nint main() {\n    MYSQL sql;\n    mysql_init(&amp;sql);\n    mysql_real_connect(&amp;sql, \"localhost\", \"password\", \"my-db\", 0, NULL, 0); \n    for(int i=0; i&lt;5; ++i) {\n        if(mysql_query(&amp;sql, \"CALL test()\") == 0)  \n            std::cout &lt;&lt; \"OK\" &lt;&lt; std::endl;\n        else \n            std::cout &lt;&lt; mysql_error(&amp;sql) &lt;&lt; std::endl;\n    }\n    mysql_close(&amp;sql);\n    return 0;\n}\n</code></pre>\n\n<p>Which gives the following output:</p>\n\n<pre><code>OK\nCommands out of sync; you can't run this command now\nCommands out of sync; you can't run this command now\nCommands out of sync; you can't run this command now\nCommands out of sync; you can't run this command now\n</code></pre>\n\n<p>I've seen in <a href=\"https://stackoverflow.com/questions/6583020/mysql-stored-procedure-caused-commands-out-of-sync?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">other</a> articles that this issue can be caused by the database returning multiple results (I only get 1 result) or the user not calling mysql_store_results (I am). I can call the stored procedure multiple times when using the mysql client cli without any issues. In my actual, not simplified app I need to used stored procedures.</p>\n\n<p>What am I missing?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I changed the example code above to be even simpler while still showing the problem and I also update the background of the issue to give more information.</p>\n"}, {"tags": ["c++", "image", "image-processing"], "comments": [{"owner": {"reputation": 1493, "user_id": 9385966, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WtdbWV1QtcQ/AAAAAAAAAAI/AAAAAAAAE_4/Eod8Vj3X1-U/photo.jpg?sz=128", "display_name": "gflegar", "link": "https://stackoverflow.com/users/9385966/gflegar"}, "edited": false, "score": 0, "creation_date": 1523483938, "post_id": 49784984, "comment_id": 86585486, "body": "A &quot;picture&quot; is not a well-defined storage format. I suggest you start your research from here: <a href=\"https://en.wikipedia.org/wiki/Image_file_formats\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Image_file_formats</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1523484200, "post_id": 49784984, "comment_id": 86585551, "body": "The C++ standard language has no facilities for image processing.  I suggest you search <a href=\"https://softwarerecs.stackexchange.com\">Software Recommendations</a> for an image or picture library."}, {"owner": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "edited": false, "score": 0, "creation_date": 1523489543, "post_id": 49784984, "comment_id": 86587081, "body": "unless your image is a <a href=\"http://netpbm.sourceforge.net/doc/pam.html\" rel=\"nofollow noreferrer\">PAM format</a> then you can easily decode headers, read and modify pixel values using file functions. but for JPEG and other formats, good luck with the decoding."}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 4973198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUtCA.png?s=128&g=1", "display_name": "LiberiFatali", "link": "https://stackoverflow.com/users/4973198/liberifatali"}, "is_accepted": false, "score": 0, "last_activity_date": 1523508823, "creation_date": 1523508823, "answer_id": 49788247, "question_id": 49784984, "link": "https://stackoverflow.com/questions/49784984/how-to-read-the-x-and-y-and-rgb-from-a-picture-and-store-them-in-integers/49788247#49788247", "title": "how to read the x and y and RGB from a picture and store them in integers?", "body": "<p>Something similar to this</p>\n\n<pre><code>void PutPixel(unsigned char* rgb_data, int rgb_width, int rgb_height, int x, int y, unsigned char r, unsigned char g, unsigned char b)\n{    \n    rgb_data[y * rgb_width + x] = r;            // set Red\n    rgb_data[y * rgb_width + x + 1] = g;        // set Blue\n    rgb_data[y * rgb_width + x + 2] = b;        // set Green\n}\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 9510218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lcMVD.png?s=128&g=1", "display_name": "NekoLuka", "link": "https://stackoverflow.com/users/9510218/nekoluka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1523508823, "creation_date": 1523483696, "question_id": 49784984, "link": "https://stackoverflow.com/questions/49784984/how-to-read-the-x-and-y-and-rgb-from-a-picture-and-store-them-in-integers", "title": "how to read the x and y and RGB from a picture and store them in integers?", "body": "<p>I am trying to make a program that reads a picture, and puts the values in custom commands to set pixels. Something like this:</p>\n\n<pre><code>int main()\n{\n  PutPixel(x, y, r, g, b);\n}\n</code></pre>\n\n<p>and this with a whole list of pixels with positions.\nIf it is possible without including any external libraries.</p>\n"}, {"tags": ["python", "c++", "python-3.x", "numpy", "python-embedding"], "comments": [{"owner": {"reputation": 31791, "user_id": 529630, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2c2dd297abe572bd192b1f01322dec83?s=128&d=identicon&r=PG", "display_name": "Dunes", "link": "https://stackoverflow.com/users/529630/dunes"}, "edited": false, "score": 1, "creation_date": 1523918008, "post_id": 49784583, "comment_id": 86749919, "body": "How are you compiling your code? This sounds like the linker didn&#39;t know it needed to link the given symbol. On the command line, libraries should always be specified after the objects that use them. See <a href=\"https://stackoverflow.com/questions/11643666/python-importerror-undefined-symbol-for-custom-c-module\" title=\"python importerror undefined symbol for custom c module\">stackoverflow.com/questions/11643666/&hellip;</a>"}, {"owner": {"reputation": 257, "user_id": 8525442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef6e2079b81d1d9e34742522cfc004?s=128&d=identicon&r=PG&f=1", "display_name": "skincell", "link": "https://stackoverflow.com/users/8525442/skincell"}, "reply_to_user": {"reputation": 31791, "user_id": 529630, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2c2dd297abe572bd192b1f01322dec83?s=128&d=identicon&r=PG", "display_name": "Dunes", "link": "https://stackoverflow.com/users/529630/dunes"}, "edited": false, "score": 0, "creation_date": 1523992511, "post_id": 49784583, "comment_id": 86787726, "body": "@Dunes thanks for your input! To your question, I&#39;m not sure how numpy is compiled/the symbols linked in as per the numpy multiarray sub-question. My current theory is that the cpython multiarray .so expects the python3.5m.so to be loaded into memory somehow for the numpy import; however, for some reason it is not loaded into memory when using Py_Initialize() for the python embedding, but it is for my terminal pythonX.exe call. I&#39;ve found a work around for this problem as shown in an edit in the post above. I&#39;m not happy about it as it is a messy solution (needs logic for multiple machines)"}, {"owner": {"reputation": 31791, "user_id": 529630, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2c2dd297abe572bd192b1f01322dec83?s=128&d=identicon&r=PG", "display_name": "Dunes", "link": "https://stackoverflow.com/users/529630/dunes"}, "edited": false, "score": 0, "creation_date": 1524000371, "post_id": 49784583, "comment_id": 86791425, "body": "Could you provide a minimal example that demonstrates your problem? I&#39;m trying to reproduce your problem on my machine at it all just seems to work fine. I use <code>PyRun_SimpleString</code> to import numpy, create an array, do arithmetic with it and print out. I also tried directly import <code>numpy.core.multiarray</code>"}, {"owner": {"reputation": 13022, "user_id": 145567, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cd9509d25909d9affa75e56e84156fb7?s=128&d=identicon&r=PG", "display_name": "Dominic Bou-Samra", "link": "https://stackoverflow.com/users/145567/dominic-bou-samra"}, "edited": false, "score": 0, "creation_date": 1544144249, "post_id": 49784583, "comment_id": 94181941, "body": "Did you get to the bottom of this? I have same issue"}], "answers": [{"tags": [], "owner": {"reputation": 1171, "user_id": 567873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/563d705b690dc0199fd50d0c46ab96ae?s=128&d=identicon&r=PG", "display_name": "2power10", "link": "https://stackoverflow.com/users/567873/2power10"}, "is_accepted": true, "score": 5, "last_activity_date": 1557219376, "creation_date": 1557219376, "answer_id": 56018943, "question_id": 49784583, "link": "https://stackoverflow.com/questions/49784583/numpy-import-fails-on-multiarray-extension-library-when-called-from-embedded-pyt/56018943#56018943", "title": "Numpy import fails on multiarray extension library when called from embedded Python within a C++ application", "body": "<p><strong>Root Cause</strong></p>\n\n<p>This error occurs because <code>multiarray.cpython-35m-x86_64-linux-gnu.so</code> module in numpy depends on <code>libpythonx.x.so</code>, be it is not explicit link the <code>libpythonx.x.so</code>. So if you use <code>ldd -d multiarray.cpython-35m-x86_64-linux-gnu.so</code> you will not see the python in the list.</p>\n\n<p>Python doesn't have issue because python binary depends on <code>libpython.x.x.so</code>, so when numpy load <code>multiarray.cpython-35m-x86_64-linux-gnu.so</code> by using <code>dlopen</code>. <code>libdl.so</code> will try to resolve the undefined symbols by checking the dependent shared library of the main program which is python. It will find it in <code>libpython.x.x.so</code>.</p>\n\n<p><strong>Solution</strong></p>\n\n<p>After knowing the root cause the solution is very easy, just help <code>libdl.so</code> to be able to find <code>libpython.x.x.so</code>. There are at least two way to achieve that:</p>\n\n<ol>\n<li>Use <code>dlopen(\"libpythonx.x.so\", RTLD_GLOBAL)</code>. After open this so use <code>RTLD_GLOBAL</code> flag, it make symbol in libpythonx.x.so available for symbol resolution of subsequently loaded shared objects.</li>\n<li>In main program which embed python, add the <code>libpythonx.x.so</code> into its dependency library.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5579204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f54278af15097184393ac60db4b72dd?s=128&d=identicon&r=PG&f=1", "display_name": "kuberry", "link": "https://stackoverflow.com/users/5579204/kuberry"}, "is_accepted": false, "score": 0, "last_activity_date": 1613080740, "creation_date": 1613080740, "answer_id": 66163572, "question_id": 49784583, "link": "https://stackoverflow.com/questions/49784583/numpy-import-fails-on-multiarray-extension-library-when-called-from-embedded-pyt/66163572#66163572", "title": "Numpy import fails on multiarray extension library when called from embedded Python within a C++ application", "body": "<p>I had a similar error with linking an application against a libpython3.5m.a (archive, not dynamic). Once it loaded something like <code>multiarray.cpython-35m-x86_64-linux-gnu.so</code>, it would expect symbols like <code>PyFloat_Type</code> to exist.</p>\n<p>In diagnosing why Python could be called directly and it would work, but my application would not, I noticed that\n<code>readelf -s myapplication</code>\nhad a PyFloat_Type symbol in the <code>.symtab</code> table but not in the <code>.dynsym</code> table.</p>\n<p>However, <code>readelf -s /asb/path/to/python3</code> had a PyFloat_Type symbol in both tables.</p>\n<p>Adding:\n<code>target_link_options(myapplication PUBLIC &quot;LINKER:-export-dynamic&quot;)</code>\nin CMake ensured that the symbols needed were also available in the <code>.dynsym</code> table. After this, it the application worked correctly.</p>\n"}], "owner": {"reputation": 257, "user_id": 8525442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef6e2079b81d1d9e34742522cfc004?s=128&d=identicon&r=PG&f=1", "display_name": "skincell", "link": "https://stackoverflow.com/users/8525442/skincell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2202, "favorite_count": 5, "accepted_answer_id": 56018943, "answer_count": 2, "score": 12, "last_activity_date": 1613080740, "creation_date": 1523481298, "last_edit_date": 1523993733, "question_id": 49784583, "link": "https://stackoverflow.com/questions/49784583/numpy-import-fails-on-multiarray-extension-library-when-called-from-embedded-pyt", "title": "Numpy import fails on multiarray extension library when called from embedded Python within a C++ application", "body": "<p>I'm running a C++ application which tries to run python using the <a href=\"https://docs.python.org/3.5/extending/embedding.html\" rel=\"noreferrer\">https://docs.python.org/3.5/extending/embedding.html</a> function calls. This is the error that the application error message pipes are giving me.</p>\n\n<blockquote>\n  <p>class 'ImportError': \n  Importing the multiarray numpy extension module failed.  Most\n  likely you are trying to import a failed build of numpy.\n  If you're working with a numpy git repo, try <code>git clean -xdf</code> (removes all\n  files not under version control).  Otherwise reinstall numpy.</p>\n  \n  <p>Original error was: /usr/local/lib/python3.5/site-packages/numpy/core/multiarray.cpython-35m-x86_64-linux-gnu.so: undefined symbol: PyExc_UserWarning</p>\n</blockquote>\n\n<p>I'm quite puzzled as this only occurs when embedding Python in C++ as the import works when I use it through the interpreter. I'm more interested in an answer that adds to my understanding than a quick do this or do that fix. I list some system/problem information below, and some other questions that I'm considering posting about the same topic. Any guidance is appreciated!</p>\n\n<p>System/Problem information:</p>\n\n<ul>\n<li>Ubuntu 16.04, 64 bit</li>\n<li>Compiled Python 3.5.5 with enabled-shared</li>\n<li>numpy import works in the interpreter (python3.exe, and python3.5.exe)</li>\n<li>I have made sure that the  PySys_SetPath() sets the same sys.path as the output from the interpreter: <code>import sys</code>, <code>sys.path</code></li>\n<li>I can import other modules like PIL, and datetimeutil; however, numpy and pandas are not importable (pandas uses numpy or seems to)</li>\n<li>The embedded Python uses the following commands: <code>Py_Import_Import()</code>, <code>Py_Initialize()</code> (I made sure. It is only called once.), etc., but it does not get a global lock on the interpreter.</li>\n<li>The application is built with a CMake build system which compiles to MakeFiles for my system.</li>\n<li>Installed numpy-1.14.2 using pip 9.0.0 using the <code>pip3.5 install numpy</code> command</li>\n<li>The python script that causes this error has one line: <code>import numpy</code>...</li>\n<li>I do not have a .zip file that I'm importing files from.</li>\n<li>The .exe used by the Python embedded in the C++ is located at /usr/local/bin/python3 (used Py_GetProgramName() to determine this). This .exe is linked to the libpython3.5m.so.1.0, and the missing symbol lives in libpython3.5m.so.1.0 (ran nm) </li>\n<li><p>ldd on multiarray.cpython-35m-x86_64-linux-gnu.so shows:</p>\n\n<p><code>ldd multiarray.cpython-35m-x86_64-linux-gnu.so</code></p>\n\n<blockquote>\n  <p>linux-vdso.so.1 =>  (0x00007ffd9e36b000)</p>\n  \n  <p>libopenblasp-r0-39a31c03.2.18.so => /usr/local/lib/python3.5/site-packages/numpy/core/./../.libs/libopenblasp-r0-39a31c03.2.18.so (0x00007fdbe149b000)</p>\n  \n  <p>libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007fdbe1192000)</p>\n  \n  <p>libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fdbe0f75000)\n  libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fdbe0bab000)\n  /lib64/ld-linux-x86-64.so.2 (0x00007fdbe3ed5000)</p>\n  \n  <p>libgfortran-ed201abd.so.3.0.0 => /usr/local/lib/python3.5/site-packages/numpy/core/./../.libs/libgfortran-ed201abd.so.3.0.0 (0x00007fdbe08b1000)</p>\n</blockquote></li>\n</ul>\n\n<p>I could/might try reinstalling numpy through different means, but I'm having trouble tracking why that might work. </p>\n\n<p>At this point, I'm assuming some hole in my knowledge exists. I have looked at a lot of similar posts regarding not being able to import the multiarray component and numpy when embedding Python in C++; however, either none of them match my specific case or as I stated there exists a hole. Here are a list of sub-questions that I will probably be asking if no one sees anything in this setup that is obviously concerning. I'll probably update the questions with links when/if I ask them (After I polish them).</p>\n\n<ul>\n<li>How does the numpy multiarray.so link to the pythonX.X.so for symbol resolution? The ldd does not seem to suggest that it ever does. Asked this question at this <a href=\"https://stackoverflow.com/questions/49866263/how-are-basic-python-symbols-linked-to-numpy-extension-dynamic-libraries\">link</a></li>\n<li>CMake Question non-related issue resolved in this <a href=\"https://stackoverflow.com/questions/49805429/cmake-findpackagepythonlibs-does-cmake-give-a-preference-to-dynamic-or-static\">question</a> asked on 4/12/18 and answered on 4/16/18.</li>\n<li>Setting PYTHONPATH in .bashrc does not seem to update what Py_GetPath() returns, I had to add in the site-packages for imports through a different methodology to sys.path. It may only update the bash script environment variable which doesn't effect the C++. </li>\n</ul>\n\n<p>I'm not asking for an answer for the above question list at this point, rather I'm giving more clues to where my gap in knowledge may be.</p>\n\n<p>Thank you for taking time from your day to read this question. Any help is appreciated. </p>\n\n<h1><strong>Edit: 4/17/18:</strong></h1>\n\n<p>Well, I found a work around, and I'm currently using it. Dunes question started making me think more closely about undefined symbols and how it could be a linker/compiler error or that the numpy import always expects an environment with those symbols already loaded into memory. This got me trying to install different versions of numpy to see if any of the older versions made a difference. They did not, but it did make the error thrown to be slightly different. When I googled that, this <a href=\"https://stackoverflow.com/questions/29880931/importerror-and-pyexc-systemerror-while-embedding-python-script-within-c-for-pam\">question appeared</a>. The accepted answer gave me a work around by adding these two lines to the pythonInterface.cpp: </p>\n\n<ul>\n<li><code>#include &lt;dlfcn.h&gt;</code></li>\n<li><code>dlopen(\"libpython3.5m.so.1.0\", RTLD_LAZY | RTLD_GLOBAL)</code></li>\n</ul>\n\n<p>These commands add the shared library to be loaded in and available to the cpython.multiarray.so. </p>\n\n<p>This is not an ideal solution as pointing to a specific .so which may be different from machine to machine. It resolves the issue for now, but it also could lead to errors where mismatches of shared libraries can occur during the python call process if the linked library to the pythonInterface.so changes, and this line does not get updated. I believe a better answer can be achieved if this <a href=\"https://stackoverflow.com/questions/49866263/how-are-basic-python-symbols-linked-to-numpy-extension-dynamic-libraries?noredirect=1&amp;lq=1\">sub-question</a> is answered, so I'm currently holding out on submitting or accepting an answer until then. Thanks!</p>\n"}, {"tags": ["c++", "qt", "contextmenu", "qtablewidget"], "answers": [{"comments": [{"owner": {"reputation": 988, "user_id": 3784049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/3829afbc9c5452e4774c3f88483af208?s=128&d=identicon&r=PG&f=1", "display_name": "follmer", "link": "https://stackoverflow.com/users/3784049/follmer"}, "edited": false, "score": 0, "creation_date": 1523484342, "post_id": 49784899, "comment_id": 86585587, "body": "Thank you, this seems to be correct. One more question, is there a way to show this menu on <code>mousedown</code> rather than how it seems to be showing on <code>mouseup</code>?  Is there also a way to disable column highlighting when a column header is clicked?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 988, "user_id": 3784049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/3829afbc9c5452e4774c3f88483af208?s=128&d=identicon&r=PG&f=1", "display_name": "follmer", "link": "https://stackoverflow.com/users/3784049/follmer"}, "edited": false, "score": 0, "creation_date": 1523484536, "post_id": 49784899, "comment_id": 86585655, "body": "@Sej  let me see, I think I have a solution, I&#39;ll try it and I&#39;ll let you know."}, {"owner": {"reputation": 988, "user_id": 3784049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/3829afbc9c5452e4774c3f88483af208?s=128&d=identicon&r=PG&f=1", "display_name": "follmer", "link": "https://stackoverflow.com/users/3784049/follmer"}, "edited": false, "score": 0, "creation_date": 1523486925, "post_id": 49784899, "comment_id": 86586382, "body": "Hi, when attempting your updated code I&#39;m getting the errors: <code>error C2876: &#39;QHeaderView&#39;: not all overloads are accessible</code> which I looked up and can&#39;t see an issue with the code at all. Nothing is private and I even tried making the <code>protected</code> into <code>public</code> with no luck. I also get <code>error C2664: HeaderView::HeaderView</code>: cannot convert parameter 1 from <code>Qt::Orientation</code> to <code>const HeaderView &amp;</code>. Im going to keep trying to fix it though"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 988, "user_id": 3784049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/3829afbc9c5452e4774c3f88483af208?s=128&d=identicon&r=PG&f=1", "display_name": "follmer", "link": "https://stackoverflow.com/users/3784049/follmer"}, "edited": false, "score": 0, "creation_date": 1523487258, "post_id": 49784899, "comment_id": 86586473, "body": "@Sej enable C++11: <code>CONFIG += c++11</code>, you could share your code, maybe the error is elsewhere."}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 2, "last_activity_date": 1523485508, "last_edit_date": 1523485508, "creation_date": 1523483135, "answer_id": 49784899, "question_id": 49784570, "link": "https://stackoverflow.com/questions/49784570/qtablewidget-left-click-customcontextmenu/49784899#49784899", "title": "QTableWidget Left Click CustomContextMenu", "body": "<p>You have to use the <code>sectionClicked</code> signal of <code>QHeaderView</code>, so you must change the <code>customHeaderMenuRequested</code> argument from <code>QPoint</code> to <code>int</code>, this parameter will indicate the column pressed, to obtain the geometrical position <code>QCursor::pos()</code> is used:</p>\n\n<pre><code>MyClass::MyClass()\n{\n    ...\n    connect(m_table-&gt;horizontalHeader(), &amp;QHeaderView::sectionClicked, this, &amp;MainWindow::customHeaderMenuRequested);\n\n}\n\nvoid MyClass::customHeaderMenuRequested(int section)\n{\n    qDebug()&lt;&lt;section;\n    QMenu * menu = new QMenu(this);\n    QAction *actNone = new QAction(\"-\", this);\n    menu-&gt;addAction(actNone);\n    menu-&gt;popup(QCursor::pos());\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Update:</strong></p>\n\n<p>A better solution is to implement a customized <code>QHeaderView</code>:</p>\n\n<p><strong>headerview.h</strong></p>\n\n<pre><code>#ifndef HEADERVIEW_H\n#define HEADERVIEW_H\n\n#include &lt;QHeaderView&gt;\n#include &lt;QMouseEvent&gt;\n\nclass HeaderView : public QHeaderView\n{\n    Q_OBJECT\npublic:\n    using QHeaderView::QHeaderView;\nprotected:\n    void mousePressEvent(QMouseEvent *event){\n        if(event-&gt;buttons() == Qt::LeftButton)\n            emit customSignal(logicalIndexAt(event-&gt;pos()));\n        QHeaderView::mousePressEvent(event);\n    }\nsignals:\n    void customSignal(int section);\n};\n\n#endif // HEADERVIEW_H\n</code></pre>\n\n<hr>\n\n<pre><code>MyClass::MyClass()\n{\n    ...\n    HeaderView *horizontal_header = new HeaderView(Qt::Horizontal);\n    m_table-&gt;setHorizontalHeader(horizontal_header);\n    connect(horizontal_header, &amp;HeaderView::customSignal, this, &amp;MainWindow::customHeaderMenuRequested);\n\n}\n\nvoid MyClass::customHeaderMenuRequested(int section)\n{\n    qDebug()&lt;&lt;section;\n    QMenu * menu = new QMenu(this);\n    QAction *actNone = new QAction(\"-\", this);\n    menu-&gt;addAction(actNone);\n    menu-&gt;popup(QCursor::pos());\n}\n</code></pre>\n"}], "owner": {"reputation": 988, "user_id": 3784049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/3829afbc9c5452e4774c3f88483af208?s=128&d=identicon&r=PG&f=1", "display_name": "follmer", "link": "https://stackoverflow.com/users/3784049/follmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 49784899, "answer_count": 1, "score": 1, "last_activity_date": 1591919337, "creation_date": 1523481232, "last_edit_date": 1591919337, "question_id": 49784570, "link": "https://stackoverflow.com/questions/49784570/qtablewidget-left-click-customcontextmenu", "title": "QTableWidget Left Click CustomContextMenu", "body": "<p>I have a <code>QTableWidget</code> that currently has it's own custom context menu. Here is the code used to set it up:</p>\n\n<pre><code>MyClass::MyClass()\n{\n    m_table-&gt;horizontalHeader()-&gt;setContextMenuPolicy(Qt::CustomContextMenu);\n\n    connect(m_table-&gt;horizontalHeader(), SIGNAL(customContextMenuRequested(QPoint)), SLOT(customHeaderMenuRequested(QPoint)));\n}\n\nvoid MyClass::customHeaderMenuRequested(QPoint pos)\n{\n    int columnClicked = m_table-&gt;horizontalHeader()-&gt;logicalIndexAt(pos);\n\n    QMenu * menu = new QMenu(this);\n    actNone = new QAction(\"-\", this);\n    menu-&gt;addAction(actNone);\n    .\n    .\n    .\n    menu-&gt;popup(m_table-&gt;horizontalHeader()-&gt;viewport()-&gt;mapToGlobal(pos));\n}\n</code></pre>\n\n<p>This context menu occurs when a user <strong>right clicks</strong> the column header of the <code>QTableWidget</code>. </p>\n\n<p>I would like to replicate this behavior except that I want it to be a <strong>left click</strong> rather than a right click.</p>\n\n<p>I've tried adding <code>EventFilter</code>s and other things but nothing has worked.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "arrays", "class", "compiler-errors"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1523480455, "post_id": 49784365, "comment_id": 86584196, "body": "See this question: <a href=\"//stackoverflow.com/q/4981241\">no default constructor exists for class</a>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1523480545, "post_id": 49784365, "comment_id": 86584240, "body": "But to fix your issue, move <code>Hyogen koz;</code> to after where you get the input and change to <code>Hyogen koz(espressione);</code>"}, {"owner": {"reputation": 1, "user_id": 9580429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSa1j.jpg?s=128&g=1", "display_name": "shyonae", "link": "https://stackoverflow.com/users/9580429/shyonae"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1523480602, "post_id": 49784365, "comment_id": 86584264, "body": "It still gives an error, I tried :/ Edit: It worked, thank you so much!"}], "answers": [{"tags": [], "owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "is_accepted": false, "score": 0, "last_activity_date": 1523480891, "creation_date": 1523480891, "answer_id": 49784484, "question_id": 49784365, "link": "https://stackoverflow.com/questions/49784365/error-when-creating-a-class-object/49784484#49784484", "title": "Error when creating a class Object", "body": "<pre><code>int main()\n{\n    //Hyogen koz;        Move this\n    char *espressione;\n    espressione = new char[50];\n    cout&lt;&lt;\"Inserisci l'espressione: \";\n    cin&gt;&gt;espressione;\n    Hyogen koz(espressione);    // To here and add parameter\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/7J0nQn\" rel=\"nofollow noreferrer\">DEMO</a> (with some extraneous code removed).</p>\n"}, {"tags": [], "owner": {"reputation": 431, "user_id": 8731135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31403414a1f928e7ab619ff30e3a1b0c?s=128&d=identicon&r=PG&f=1", "display_name": "Baedsch", "link": "https://stackoverflow.com/users/8731135/baedsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1523480991, "creation_date": 1523480991, "answer_id": 49784510, "question_id": 49784365, "link": "https://stackoverflow.com/questions/49784365/error-when-creating-a-class-object/49784510#49784510", "title": "Error when creating a class Object", "body": "<pre><code>#include &lt;iostream&gt;\n#include \"Pila.h\"\n#include \"Functions.cpp\"\n#include &lt;cstring&gt;\nusing namespace std;\nint error = 0; \nclass Hyogen{\nprivate:\n    char *kozui;\n    int p_close;\n    int p_open;\n    int err_par, err_op, err_end, err_start; public:\n    Hyogen(char *a);\n    bool Verify();\n    char *Elaborate();\n    void Errors(); };\npublic:\n    Hyogen() {}\n//  ^^^^^^^^^^^   \n    Hyogen(char *a);\n    bool Verify();\n    char *Elaborate();\n\n    void Errors();\n};\n</code></pre>\n\n<p>as already answered in the comments, you need a default constructor</p>\n\n<pre><code>ClassName ( ) ;\nClassName() = default ;\n</code></pre>\n\n<p>are other options how to do it</p>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 6894418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a37dea9b93f747ed94921e8a61078d?s=128&d=identicon&r=PG&f=1", "display_name": "Vitaliy", "link": "https://stackoverflow.com/users/6894418/vitaliy"}, "is_accepted": false, "score": 1, "last_activity_date": 1523481990, "last_edit_date": 1523481990, "creation_date": 1523481206, "answer_id": 49784563, "question_id": 49784365, "link": "https://stackoverflow.com/questions/49784365/error-when-creating-a-class-object/49784563#49784563", "title": "Error when creating a class Object", "body": "<p>In the line:</p>\n\n<pre><code>Hyogen koz;\n</code></pre>\n\n<p>you create object of class with default constructor, which you do not have in the class definition. You have to define default constructor:</p>\n\n<pre><code>Hyogen() { };\n</code></pre>\n\n<p>Or using in C++11:</p>\n\n<pre><code>Hyogen() = default; \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9580429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSa1j.jpg?s=128&g=1", "display_name": "shyonae", "link": "https://stackoverflow.com/users/9580429/shyonae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1523481990, "creation_date": 1523480289, "last_edit_date": 1523480377, "question_id": 49784365, "link": "https://stackoverflow.com/questions/49784365/error-when-creating-a-class-object", "title": "Error when creating a class Object", "body": "<p>I'm trying to create an object but apparently it gives some sort of error with the constructor... what?\nMy code that looks like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"Pila.h\"\n#include \"Functions.cpp\"\n#include &lt;cstring&gt;\nusing namespace std;\nint error = 0;\nclass Hyogen{\nprivate:\n    char *kozui;\n    int p_close;\n    int p_open;\n    int err_par, err_op, err_end, err_start;\npublic:\n    Hyogen(char *a);\n    bool Verify();\n    char *Elaborate();\n    void Errors();\n};\n\nHyogen::Hyogen(char *a){\n    kozui = a;\n    err_par = 0;\n    err_op = 0;\n    err_end = 0;\n    err_start = 0;\n    p_close = 0;\n    p_open = 0;\n}\n\nbool Hyogen::Verify(){\n    for(int i=0;i&lt;strlen(kozui);i++){\n        if(i == strlen(kozui)){\n            if(error != 0){\n                cout&lt;&lt;\"uwu\";\n                return false;\n                break;}\n            else{\n                cout&lt;&lt;\"owo\";\n                return true;}\n            }\n\n        check_parentesis(kozui, p_close, p_open);\n\n        if(p_close &gt; p_open || p_open &gt; p_close){\n            error++;\n            err_par++;\n        }\n\n        if(i == 0)\n            if(check_start_various(kozui)){\n                error++;\n                err_start++;\n            }\n\n        if(check_operator(kozui)){\n\n            if(check_mul_div(kozui))\n                break;\n\n            if(check_doubleop(kozui)){\n                error++;\n                err_op++;\n            }\n        }\n\n        if(i == strlen(kozui))\n            if(check_end_various(kozui)){\n                err_end++;\n                error++;\n            }\n    }\n}\n\nint main()\n{\n    Hyogen koz;\n    char *espressione;\n    espressione = new char[50];\n    cout&lt;&lt;\"Inserisci l'espressione: \";\n    cin&gt;&gt;espressione;\n    return 0;\n}\n</code></pre>\n\n<p>The error I'm getting is the following:</p>\n\n<pre><code>main.cpp: In function \u2018int main()\u2019:\nmain.cpp:76:12: error: no matching function for call to \u2018Hyogen::Hyogen()\u2019\n     Hyogen koz;\n            ^~~\nmain.cpp:20:1: note: candidate: Hyogen::Hyogen(char*)\n Hyogen::Hyogen(char *a){\n ^~~~~~\nmain.cpp:20:1: note:   candidate expects 1 argument, 0 provided\nmain.cpp:7:7: note: candidate: constexpr Hyogen::Hyogen(const Hyogen&amp;)\n class Hyogen{\n       ^~~~~~\nmain.cpp:7:7: note:   candidate expects 1 argument, 0 provided\nmain.cpp:7:7: note: candidate: constexpr Hyogen::Hyogen(Hyogen&amp;&amp;)\nmain.cpp:7:7: note:   candidate expects 1 argument, 0 provided\n</code></pre>\n\n<p>What's happening? What do I have to do? It seems like I have to provide an argument when I create the object, but how? (I need to pass \"espressione\")</p>\n"}, {"tags": ["c++", "tfs", "tfsbuild"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1523480541, "post_id": 49784290, "comment_id": 86584238, "body": "It does not have to do with MFC/ATL redist at all (redists are necessary for end users). It has to do with missing MFC SDK (which is an optional component under the Desktop development with C++ workload in the Visual Studio)."}, {"owner": {"reputation": 1073, "user_id": 1278533, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/TRNiA.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1278533/sam"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1523481519, "post_id": 49784290, "comment_id": 86584585, "body": "@VTT Sorry... I misspoke.  You&#39;re right, it&#39;s the SDK, not the redist.  My question still stands though.  Is there a way to fix this without installing VS itself?"}, {"owner": {"reputation": 24666, "user_id": 7466674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d846790948d5cc43593fc778116f40d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Li-MSFT", "link": "https://stackoverflow.com/users/7466674/andy-li-msft"}, "edited": false, "score": 0, "creation_date": 1523520703, "post_id": 49784290, "comment_id": 86597182, "body": "@Sam Can you successfully build the project locally?"}, {"owner": {"reputation": 1073, "user_id": 1278533, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/TRNiA.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1278533/sam"}, "reply_to_user": {"reputation": 24666, "user_id": 7466674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d846790948d5cc43593fc778116f40d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Li-MSFT", "link": "https://stackoverflow.com/users/7466674/andy-li-msft"}, "edited": false, "score": 0, "creation_date": 1523555592, "post_id": 49784290, "comment_id": 86620600, "body": "@AndyLi-MSFT Yes, I can.  But I have VS2017 installed.  As noted above, I&#39;m certain this is related to having the MFC/ATL support option installed with VS.  As far as I know, that option doesn&#39;t exist on TFS 2018 install."}], "answers": [{"comments": [{"owner": {"reputation": 1073, "user_id": 1278533, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/TRNiA.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1278533/sam"}, "edited": false, "score": 0, "creation_date": 1523555521, "post_id": 49792007, "comment_id": 86620556, "body": "Yeah, I installed the build tools when I first set up the server.  I don&#39;t want to install VS because it&#39;s like 50GB and that seems like a waste for this one tiny issue."}, {"owner": {"reputation": 24666, "user_id": 7466674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d846790948d5cc43593fc778116f40d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Li-MSFT", "link": "https://stackoverflow.com/users/7466674/andy-li-msft"}, "reply_to_user": {"reputation": 1073, "user_id": 1278533, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/TRNiA.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1278533/sam"}, "edited": false, "score": 1, "creation_date": 1523613448, "post_id": 49792007, "comment_id": 86642669, "body": "@Sam Have you installed all the Components included by the <code>Microsoft.VisualStudio.Workload.VCTools</code>? (<a href=\"https://docs.microsoft.com/en-us/visualstudio/install/workload-component-id-vs-build-tools#visual-c-build-tools\" rel=\"nofollow noreferrer\">Visual C++ build tools</a>).  See the updated answer."}, {"owner": {"reputation": 1073, "user_id": 1278533, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/TRNiA.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1278533/sam"}, "edited": false, "score": 0, "creation_date": 1523652086, "post_id": 49792007, "comment_id": 86665473, "body": "I double-checked and that component wasn&#39;t installed.  This has solved my issue.  Thanks."}], "tags": [], "owner": {"reputation": 24666, "user_id": 7466674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d846790948d5cc43593fc778116f40d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Li-MSFT", "link": "https://stackoverflow.com/users/7466674/andy-li-msft"}, "is_accepted": true, "score": 0, "last_activity_date": 1523613445, "last_edit_date": 1523613445, "creation_date": 1523522863, "answer_id": 49792007, "question_id": 49784290, "link": "https://stackoverflow.com/questions/49784290/tfs-2018-build-fails-cannot-open-include-file-afxres-h/49792007#49792007", "title": "TFS 2018 build fails: cannot open include file &#39;afxres.h&#39;", "body": "<p>You need to at least install <a href=\"http://landinghub.visualstudio.com/visual-cpp-build-tools\" rel=\"nofollow noreferrer\">Build Tools for Visual Studio 2017</a> on your build server.</p>\n\n<blockquote>\n  <p><strong>Build Tools for Visual Studio 2017</strong></p>\n  \n  <p>These Build Tools allow you to build native and managed MSBuild-based\n  applications without requiring the Visual Studio IDE. There are\n  options to install the Visual C++ compilers and libraries, MFC, ATL,\n  and C++/CLI support, and .NET and .NET Core support.</p>\n</blockquote>\n\n<p>If that still not work, I'm afraid that you have to install the VS 2017 on the build server. (Note that do not miss the feature <code>Microsoft Foundation Classes for C++</code> .)</p>\n\n<hr>\n\n<p>UPDATE:</p>\n\n<p>Please double check if you missed the <strong>Microsoft.VisualStudio.Workload.VCTools</strong> workload on the build server. See <a href=\"https://docs.microsoft.com/en-us/visualstudio/install/workload-component-id-vs-build-tools#visual-c-build-tools\" rel=\"nofollow noreferrer\">Visual C++ build tools</a> for details.</p>\n\n<p>If missed , just try using below command to install it:</p>\n\n<pre><code>vs_buildtools.exe --add Microsoft.VisualStudio.Workload.VCTools\n</code></pre>\n"}], "owner": {"reputation": 1073, "user_id": 1278533, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/TRNiA.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1278533/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 0, "accepted_answer_id": 49792007, "answer_count": 1, "score": 0, "last_activity_date": 1523613445, "creation_date": 1523479978, "last_edit_date": 1523511781, "question_id": 49784290, "link": "https://stackoverflow.com/questions/49784290/tfs-2018-build-fails-cannot-open-include-file-afxres-h", "title": "TFS 2018 build fails: cannot open include file &#39;afxres.h&#39;", "body": "<p>We are testing a new new TFS 2018 SP1 server.  </p>\n\n<p>I was previously building a solution (4.5) which contains two unmanaged C++ projects originally written against the 2012 toolset.  </p>\n\n<p>Building that solution as-is on the new server worked fine.  However, we have decided to retarget to 4.7.1 for our next release.  </p>\n\n<p>After making all the changes in the projects including targeting the 4.7.1 framework and the 2017 toolset (141), these projects fail to build with the error in the title.  </p>\n\n<p>I know this has to do with the C++ MFC/ATL redist.  </p>\n\n<p>The build server does not have VS 2017 installed and I do not want to install it unless absolutely necessary.  </p>\n\n<p>I did install the VS 2017 C++ redists x86 and x64 but it did not correct this.</p>\n\n<p>Can anyone help me on that?</p>\n"}, {"tags": ["c++", "templates", "compiler-errors"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1523479016, "post_id": 49783997, "comment_id": 86583548, "body": "Template functions do not implicitly convert parameters.  Trying to find a dupe"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523479160, "post_id": 49783997, "comment_id": 86583615, "body": "@NathanOliver When I make the fix in my answer, there are no compilation errors."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1523479188, "post_id": 49783997, "comment_id": 86583627, "body": "@Barmar That is because it is no longer a template function."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1523479894, "post_id": 49783997, "comment_id": 86583945, "body": "@NathanOliver Except when <a href=\"http://coliru.stacked-crooked.com/a/00eebfb9e9d80317\" rel=\"nofollow noreferrer\">explicitly instantiated</a> (obviously)."}], "answers": [{"comments": [{"owner": {"reputation": 370, "user_id": 4359679, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-72o0vzuMxa4/AAAAAAAAAAI/AAAAAAAAAKA/vOOUcgY5TuI/photo.jpg?sz=128", "display_name": "Nikita Bobko", "link": "https://stackoverflow.com/users/4359679/nikita-bobko"}, "edited": false, "score": 0, "creation_date": 1523480020, "post_id": 49784090, "comment_id": 86583994, "body": "But what if i want to extract friend function realization out of class?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 370, "user_id": 4359679, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-72o0vzuMxa4/AAAAAAAAAAI/AAAAAAAAAKA/vOOUcgY5TuI/photo.jpg?sz=128", "display_name": "Nikita Bobko", "link": "https://stackoverflow.com/users/4359679/nikita-bobko"}, "edited": false, "score": 0, "creation_date": 1523480162, "post_id": 49784090, "comment_id": 86584052, "body": "Put the <code>friend</code> declaration in the class, and the implementation outside the class."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1523478981, "creation_date": 1523478981, "answer_id": 49784090, "question_id": 49783997, "link": "https://stackoverflow.com/questions/49783997/writing-binary-addition-operator-for-template-class-compilation-error/49784090#49784090", "title": "Writing binary addition operator for template class. Compilation error", "body": "<p>The <code>operator+</code> method should use <code>A&lt;T&gt;</code>, not its own template.</p>\n\n<pre><code>friend A&lt;T&gt; operator +(const A&lt;T&gt; &amp;a, const A&lt;T&gt; &amp;b) {\n    return A&lt;T&gt;(a.a + b.a);\n}\n</code></pre>\n"}], "owner": {"reputation": 370, "user_id": 4359679, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-72o0vzuMxa4/AAAAAAAAAAI/AAAAAAAAAKA/vOOUcgY5TuI/photo.jpg?sz=128", "display_name": "Nikita Bobko", "link": "https://stackoverflow.com/users/4359679/nikita-bobko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 49784090, "answer_count": 1, "score": 0, "last_activity_date": 1523479333, "creation_date": 1523478551, "question_id": 49783997, "link": "https://stackoverflow.com/questions/49783997/writing-binary-addition-operator-for-template-class-compilation-error", "title": "Writing binary addition operator for template class. Compilation error", "body": "<p>Cannot correctly code operator+ for template class using friend function.\nOnly one question: why compilation error? And how to fix it?</p>\n\n<pre><code>template &lt;typename T&gt;\nclass A {\n    T a;\npublic:\n    A(T a) : a(a) {\n\n    }\n\n    template&lt;typename K&gt;\n    friend A&lt;K&gt; operator +(const A&lt;K&gt; &amp;a, const A&lt;K&gt; &amp;b) {\n        return A&lt;K&gt;(a.a + b.a);\n    }\n};\n\nint main(int argc, const char **argv) {\n    A&lt;int&gt; a(1);\n    A&lt;int&gt; b(2);\n    a + b;          // no compilation error\n    (A&lt;int&gt;)1 + a;  // no compilation error\n    1 + a;          // compilation error\n    return 0;\n}\n</code></pre>\n\n<p>g++ outputs:</p>\n\n<pre><code>07-04.cpp: In function \u2018int main(int, const char**)\u2019:\n07-04.cpp:20:7: error: no match for \u2018operator+\u2019 (operand types are \u2018int\u2019 and \u2018A&lt;int&gt;\u2019)\n     1 + a;          // compilation error\n       ^\n07-04.cpp:10:17: note: candidate: template&lt;class K&gt; A&lt;K&gt; operator+(const A&lt;K&gt;&amp;, const A&lt;K&gt;&amp;)\n     friend A&lt;K&gt; operator +(const A&lt;K&gt; &amp;a, const A&lt;K&gt; &amp;b) {\n                 ^\n07-04.cpp:10:17: note:   template argument deduction/substitution failed:\n07-04.cpp:20:9: note:   mismatched types \u2018const A&lt;K&gt;\u2019 and \u2018int\u2019\n     1 + a;          // compilation error\n         ^\n</code></pre>\n"}, {"tags": ["c++", "arrays", "loops", "user-input", "c-strings"], "comments": [{"owner": {"reputation": 672, "user_id": 7868736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba3186dc762c3fc009d2d025a1d1643?s=128&d=identicon&r=PG&f=1", "display_name": "Tyger", "link": "https://stackoverflow.com/users/7868736/tyger"}, "edited": false, "score": 0, "creation_date": 1523477502, "post_id": 49783663, "comment_id": 86582799, "body": "<a href=\"https://stackoverflow.com/questions/18786575/using-getline-in-c\">stackoverflow.com/questions/18786575/using-getline-in-c</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523477544, "post_id": 49783663, "comment_id": 86582817, "body": "<code>name1</code> is not an array of strings, it&#39;s an array of <code>char</code>, which is just one string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523477600, "post_id": 49783663, "comment_id": 86582848, "body": "You can&#39;t use <code>==</code> to compare C strings, you have to use <code>strcmp()</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523477723, "post_id": 49783663, "comment_id": 86582897, "body": "It seems like you need to learn the basics of how C strings work. If you need an array of 50 strings, it should be <code>char name1[50][MAXNAMESIZE];</code>"}, {"owner": {"reputation": 21, "user_id": 9632648, "user_type": "registered", "profile_image": "https://graph.facebook.com/2227856837254969/picture?type=large", "display_name": "Holly Thorsted", "link": "https://stackoverflow.com/users/9632648/holly-thorsted"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523478009, "post_id": 49783663, "comment_id": 86583048, "body": "@Barmar yes that was my mistake I just fixed it. I just reread the directions and it says to set the max with CAPACITY but it doesnt tell me what that capacity should be equal to. Im working on the strcmp function now"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523478574, "post_id": 49783663, "comment_id": 86583350, "body": "Don&#39;t edit the question with these questions, it makes the answers invalid."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523482557, "post_id": 49783663, "comment_id": 86584976, "body": "Why did you change <code>char name1</code> to <code>string name</code>? Aren&#39;t you supposed to be using C strings, not <code>std::string</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523477625, "post_id": 49783745, "comment_id": 86582851, "body": "It sounds like his assignment requires him to use C strings, not <code>std::string</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1523478687, "post_id": 49783745, "comment_id": 86583407, "body": "It&#39;s an array of 50 names, not just one line."}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1523478896, "post_id": 49783745, "comment_id": 86583501, "body": "@Barmar, yes but since it is a task assignment, I only give the necessary tools to solve the problem. The rest consists of the particular exercise, what must be done by him."}], "tags": [], "owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "is_accepted": false, "score": 2, "last_activity_date": 1523479696, "last_edit_date": 1523479696, "creation_date": 1523477544, "answer_id": 49783745, "question_id": 49783663, "link": "https://stackoverflow.com/questions/49783663/loop-to-get-user-input-using-cstring-array-c/49783745#49783745", "title": "Loop to get user input using cstring array c++", "body": "<p>Declare <code>name1</code> variable as <code>std::string</code>, Then just use <code>std::cin</code>:</p>\n\n<pre><code>std::string name1;\nstd::cin &gt;&gt; name1;\n</code></pre>\n\n<p>But if you really need to get entire line you always can do:</p>\n\n<pre><code>std::string line;\nstd::getline(std::cin, line);\n</code></pre>\n\n<p>And then use the line.</p>\n\n<p>If your assignment really requires that you use cstrings you can:</p>\n\n<pre><code>char line[50];\nstd::cin.get(line, 50);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9632648, "user_type": "registered", "profile_image": "https://graph.facebook.com/2227856837254969/picture?type=large", "display_name": "Holly Thorsted", "link": "https://stackoverflow.com/users/9632648/holly-thorsted"}, "edited": false, "score": 0, "creation_date": 1523482261, "post_id": 49783986, "comment_id": 86584864, "body": "I used what you said but I still get an error saying &quot;No matching member function for call to &#39;getline&#39;&quot; and when I compile its a never ending loop telling me to please enter a name and doesnt say anything about the grade"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 21, "user_id": 9632648, "user_type": "registered", "profile_image": "https://graph.facebook.com/2227856837254969/picture?type=large", "display_name": "Holly Thorsted", "link": "https://stackoverflow.com/users/9632648/holly-thorsted"}, "edited": false, "score": 0, "creation_date": 1523482475, "post_id": 49783986, "comment_id": 86584934, "body": "I mistakenly copied your edited version of the question that changed <code>char</code> to <code>string</code>. It&#39;s fixed now."}, {"owner": {"reputation": 21, "user_id": 9632648, "user_type": "registered", "profile_image": "https://graph.facebook.com/2227856837254969/picture?type=large", "display_name": "Holly Thorsted", "link": "https://stackoverflow.com/users/9632648/holly-thorsted"}, "edited": false, "score": 0, "creation_date": 1523482772, "post_id": 49783986, "comment_id": 86585055, "body": "You were right the first time though, my professor wants us to create an array of string objects to represent the name. But still how come when it compiles its only a nonstop loop telling me to input the name but doesnt ever give me the option to enter it?"}, {"owner": {"reputation": 21, "user_id": 9632648, "user_type": "registered", "profile_image": "https://graph.facebook.com/2227856837254969/picture?type=large", "display_name": "Holly Thorsted", "link": "https://stackoverflow.com/users/9632648/holly-thorsted"}, "edited": false, "score": 0, "creation_date": 1523482839, "post_id": 49783986, "comment_id": 86585092, "body": "Sorry just figured out what I was doing wrong, I still left in my while loop"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1523482453, "last_edit_date": 1523482453, "creation_date": 1523478512, "answer_id": 49783986, "question_id": 49783663, "link": "https://stackoverflow.com/questions/49783663/loop-to-get-user-input-using-cstring-array-c/49783986#49783986", "title": "Loop to get user input using cstring array c++", "body": "<p>Several issues:</p>\n\n<ul>\n<li>For an array of C strings, you need <code>char name1[50][MAXNAMESIZE];</code>. You just declared a single string.</li>\n<li>When reading into a C string, <code>cin.getline()</code> requires a <code>length</code> parameter to specify the maximum number of characters to input, so it doesn't overflow the buffer.</li>\n<li>You don't need separate loops for the names and grades. Get the grade for each student immediately after getting their name.</li>\n<li>To compare C strings you have to use <code>strcmp()</code>, not <code>==</code>.</li>\n<li>When you mix <code>&gt;&gt;</code> and <code>getline()</code>, you need to call <code>cin.ignore()</code> after <code>&gt;&gt;</code> to skip past the newline. See <a href=\"https://stackoverflow.com/questions/10553597/cin-and-getline-skipping-input\">cin and getline skipping input</a></li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;cctype&gt;\n\nusing namespace std;\n\n#define MAXNAMESIZE 100\n\nint main() {\n\n    char name1[50][MAXNAMESIZE];\n    int grade[50];\n\n    for (int i = 0; i &lt; 50; i++) {\n\n        cout &lt;&lt; \"Please input a name (or 'quit' to quit): \";\n        cin.getline(name1[i], sizeof name1[i]);\n\n        if (strcmp(name1[i], \"quit\") == 0) {\n            break;\n        }\n        cout &lt;&lt; \"Please input this person's grade: \";\n        cin &gt;&gt; grade[i];\n        cin.ignore(numeric_limits&lt;streamsize&gt;::max(), '\\n');\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9632648, "user_type": "registered", "profile_image": "https://graph.facebook.com/2227856837254969/picture?type=large", "display_name": "Holly Thorsted", "link": "https://stackoverflow.com/users/9632648/holly-thorsted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1140, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1523482482, "creation_date": 1523477227, "last_edit_date": 1523482482, "question_id": 49783663, "link": "https://stackoverflow.com/questions/49783663/loop-to-get-user-input-using-cstring-array-c", "title": "Loop to get user input using cstring array c++", "body": "<p>I have an assignment that requires me to write a program that prompts the user to enter the name of a student and their grade and keeps looping until they enter \"quit\". </p>\n\n<p>But I can't figure out how to get the user input for the array to get the entire line (which is a first &amp; last name so I can't just do cin >> name1[i] since theres white space) but when I use cin.getline or just getline and compile it, I get an error message saying No member function matching getline. </p>\n\n<p>Also when I compile it without getline, its just a continuous loop and doesnt let me input any info for name or grade. I'm new to arrays and cstring so please try to dumb down where I'm messing up. Thank you.  </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;cctype&gt;\n\nusing namespace std;\n\nint main() {\n\n    const int CAPACITY = 50;\n    string name1[CAPACITY];\n    string grade[CAPACITY];\n    char quit[]= \"quit\";\n    int i;\n\n    //for loop to get names and grades from user until quit is entered\n    for (i = 0; i &lt; CAPACITY; i++) {\n        while (name1[i] != quit)\n            cout &lt;&lt; \"Please input a name (or 'quit' to quit): \";\n            getline(cin, name1[i]);\n\n    //break if name1[i] = quit \n    if (name1[i].compare(quit) == 0) {\n        break;\n    }\n\n    //continue loop if quit not entered and get the grade from that person\n    cout &lt;&lt; \"Please input this person's grade: \";\n    cin &gt;&gt; grade[i];\n    }\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "stl", "stdset"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1523477143, "post_id": 49783576, "comment_id": 86582601, "body": "I believe this is a good question, but there is a lot of text/information here. If you can trim it down a lot, it would be easier to understand and answer"}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 1, "creation_date": 1523477309, "post_id": 49783576, "comment_id": 86582693, "body": "&quot;I would like to avoid allocating that class if I can&quot;. That&#39;s <b>premature optimization</b>. I don&#39;t buy the argument of the class introducing memory overhead."}, {"owner": {"reputation": 2522, "user_id": 1332468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/47c408da0aac005a99e87161caf3b903?s=128&d=identicon&r=PG", "display_name": "srm", "link": "https://stackoverflow.com/users/1332468/srm"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1523477329, "post_id": 49783576, "comment_id": 86582705, "body": "@Justin I spec&#39;d out the problem at the start. The tail is just covering what I&#39;ve already tried to avoid rehashing those ideas."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1523477457, "post_id": 49783576, "comment_id": 86582781, "body": "@srm Yes. My suggestion is to trim down on both sections. It&#39;s usually a lot easier for readers to understand what you are saying if you make your questions more concise than what you have here."}, {"owner": {"reputation": 2522, "user_id": 1332468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/47c408da0aac005a99e87161caf3b903?s=128&d=identicon&r=PG", "display_name": "srm", "link": "https://stackoverflow.com/users/1332468/srm"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1523477466, "post_id": 49783576, "comment_id": 86582786, "body": "@Cheersandhth.-Alf It&#39;s not premature. Additional allocations have been a recurrent problem with this dataset. And I&#39;d still appreciate an answer to the question regardless."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1523480101, "post_id": 49783576, "comment_id": 86584031, "body": "I agree with @Justin, as explained somewhere on <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, you should write your question as if you were asking a busy colleague. And trust me, that busy colleague won&#39;t let you finish half of the first quarter of the start of your question."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1523480334, "post_id": 49783576, "comment_id": 86584134, "body": "<i>&quot;The void* need to be treated like value objects -- i.e., when I do mySet.insert(x), that should allocate a new pointer&quot;</i>: unclear! Do you want to allocate a new pointer, or a new pointee? If the latter, how to initialize the new allocated storage from the pointer? With the copy function, right?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1523481689, "post_id": 49783576, "comment_id": 86584655, "body": "Especially when you&#39;re working with <code>void*</code>, be <b>very careful</b> about the difference between a <b>pointer</b> and <b>what it points at</b>. For example, you certainly do <b>not</b> want to &quot;allocate a new pointer&quot; and copy <b>data</b> into it. You want to allocate <b>memory</b> and copy data into it."}, {"owner": {"reputation": 2522, "user_id": 1332468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/47c408da0aac005a99e87161caf3b903?s=128&d=identicon&r=PG", "display_name": "srm", "link": "https://stackoverflow.com/users/1332468/srm"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1523483114, "post_id": 49783576, "comment_id": 86585202, "body": "@YSC Given void *X, allocate a new block of memory then copy the contents pointed to by X into the new block."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1523517074, "post_id": 49783576, "comment_id": 86595160, "body": "Sounds like an XY problem. &quot;How do I use an allocator&quot; presumes that the allocator is the problem."}], "answers": [{"comments": [{"owner": {"reputation": 2522, "user_id": 1332468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/47c408da0aac005a99e87161caf3b903?s=128&d=identicon&r=PG", "display_name": "srm", "link": "https://stackoverflow.com/users/1332468/srm"}, "edited": false, "score": 0, "creation_date": 1523482973, "post_id": 49784793, "comment_id": 86585152, "body": "That&#39;s definitely an improvement over what I&#39;ve been looking at. Thanks."}], "tags": [], "owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "is_accepted": true, "score": 3, "last_activity_date": 1523483777, "last_edit_date": 1523483777, "creation_date": 1523482521, "answer_id": 49784793, "question_id": 49783576, "link": "https://stackoverflow.com/questions/49783576/can-replacing-the-stdallocator-allow-stdset-to-work-with-void-and-separate/49784793#49784793", "title": "Can replacing the std::allocator allow std::set to work with void* and separate copy/dealloc functions?", "body": "<p>No.  There is no part of the allocator concept that allows a \"copy\" function. That's a non-starter with the STL. Your only real hope is to allocate a wrapper class.  However, you can shrink the sizes if you're crafty, by making each instance have a pointer to a pseudo-type.</p>\n\n<pre><code>struct WrapperType {\n  using compare_t = int(void*,void*);\n    using copy_t    = void*(void*);\n    using free_t    = void(void*);\n\n    compare_t* _compare;\n    copy_t*    _copy;\n    free_t*    _free;\n};\nstruct Wrapper {\n    void*      _data;\n    WrapperType* _type;\n\n    explicit Wrapper(void* data, WrapperType* type) noexcept : _data(data), _type(type) {}\n    Wrapper(Wrapper&amp;&amp; other) noexcept : _data(other._data), _type(other._type) {}\n    Wrapper&amp; operator=(Wrapper&amp;&amp; other) noexcept \n    {reset(); _data=other.release(); _type=other._type; return *this;}\n    ~Wrapper() noexcept {reset();}\n    void reset() noexcept {_type._free(_data); _data=nullptr;}\n    void* release() noexcept {void* data=_data; _data=nullptr; return data;}\n    boolean operator&lt;(const Wrapper&amp;other) noexcept {\n        assert(_type==other._type);\n        return _type._compare(_data, other._data)&lt;0;\n    }\n};\n</code></pre>\n\n<p><code>noexcept</code> is wierdly helpful here, on the move constructor and move assignment operators. With those, the C++ library will usually use them. Otherwise, C++ library will usually prefer the copy versions.</p>\n"}, {"tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": false, "score": 1, "last_activity_date": 1523482920, "creation_date": 1523482920, "answer_id": 49784870, "question_id": 49783576, "link": "https://stackoverflow.com/questions/49783576/can-replacing-the-stdallocator-allow-stdset-to-work-with-void-and-separate/49784870#49784870", "title": "Can replacing the std::allocator allow std::set to work with void* and separate copy/dealloc functions?", "body": "<p>First - personally I've avoided custom allocators since they don't feel quite right to me. That's not really a good reason, and you may get an allocator-based answer to your question, but not from me. (See Andrei Alexandrescu's talk on this matter in CppCon 2015: <a href=\"https://www.youtube.com/watch?v=LIb3L4vKZ7U\" rel=\"nofollow noreferrer\">std::allocator is to allocation what std::vector is to vexation</a>).</p>\n\n<p>Second - if you're worried about memory overhead - you should really not be using <code>std::set</code>, which has lots of memory overhead. It's also pretty slow.</p>\n\n<p>But even ignoring that - you can avoid the overhead you mentioned by not keeping a copy of the functions with every set item instance. After all - they're the same for all objects; so you can do one of the following:</p>\n\n<ol>\n<li>Have static variables for the 3 pointers, and make sure to set them before the pointers are used. This should work if you can ensure you never use such objects with different functions at the same time.</li>\n<li>Have each instance hold a reference (= a single pointer) to another class, where that other class holds the 3 functions pointers. You'll need to manage the lifetime of that single common instance of the 3-pointer-holding class, but that shouldn't be too bad.</li>\n</ol>\n"}], "owner": {"reputation": 2522, "user_id": 1332468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/47c408da0aac005a99e87161caf3b903?s=128&d=identicon&r=PG", "display_name": "srm", "link": "https://stackoverflow.com/users/1332468/srm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 49784793, "answer_count": 2, "score": 0, "last_activity_date": 1523483777, "creation_date": 1523476882, "last_edit_date": 1523477590, "question_id": 49783576, "link": "https://stackoverflow.com/questions/49783576/can-replacing-the-stdallocator-allow-stdset-to-work-with-void-and-separate", "title": "Can replacing the std::allocator allow std::set to work with void* and separate copy/dealloc functions?", "body": "<p>I'm fighting a problem with some legacy code trying to talk to modern systems. Specifically, <strong>C++11</strong> versions of the STL (bonus points if your proposed solution works with C++03, negative points if solution only works with C++17, but I'm still interested in case I can use that as an argument for upgrading).</p>\n\n<p>My function gets passed an array of void* and three function pointers that are the functions for comparing, copying, and deallocating the data in each void pointers (the void pointers are all the same data type for any given call). In short, I have all the parts for making these void* look like objects, but they are not actually objects.</p>\n\n<p>In my function, I would like to use some libraries for std::set and std::map with this data (also some other libraries in our own code base, but set and map are good starting points). The void* need to be treated like value objects -- i.e., when I do mySet.insert(x), that should allocate a new pointer (I have a way to query for the size of the pointer) and then call the copy function to copy the contents of x into the set. </p>\n\n<p><strong>TL;DR: Anyone know a way to write a custom allocator that will work with std::set for a type whose copy/dealloc instructions are not embodied in a copy constructor?</strong> </p>\n\n<p>---------- end of question (remainder is stuff I've already tried) ---------</p>\n\n<p>Obviously, I could package the four things together into a class: </p>\n\n<pre><code>class BundleStuffTogether {\n    BundleStuffTogether(void *data, CompareFunc compare, CopyFunc copy, DeallocFunc dealloc);\n    // And create the rest of class accordingly, storing the values, \n    // and with destructor calling dealloc, copy constructor calling\n    // copy, etc.\n};\n</code></pre>\n\n<p>I would like to avoid allocating that class if I can. I don't want the memory overhead of every entry in the set needing 4x size (a lot of the pointers are to small amounts of data, so the relative size is large). </p>\n\n<p>I'm looking into just using std::set and filling in those two blanks creatively. I can pass the comparison function pointer as the comparison object for the set and map. That's easy. The harder part is the alloc, dealloc, and copy.</p>\n\n<p>I've been trying to write a custom allocator, and I actually got one working when I called it directly in tests, but when I plugged it into the std::set, things fell apart. I did create a class just to hold onto the void* in order to be able to do template specialization of the allocator (details below).</p>\n\n<p>My first trick was to create this class:</p>\n\n<pre><code>class Wrapper {\n     public: void *_ptr;\n};\n// which allows for this, given \"void *y\":\nWrapper *wrap = static_cast&lt;Wrapper*&gt;(&amp;y);\n</code></pre>\n\n<p>That gives me a specific type I can use for template specialization. Using that, I tried to create a successful type specialization of std::allocator for Wrapper. That worked for Wrapper by itself, but fell apart when I tried to give the custom specialization additional fields to store the functions -- allocators have to compare as equal. </p>\n\n<p>So then I <em>cloned</em> std::allocator and created my own MyAllocator template class -- exactly the same code as std::allocator -- and then created a template specialization for Wrapper. Then I gave BOTH the main template and my specialization the functions needed to manipulate the void*, so now they compare as equal.</p>\n\n<p>And that was successful as an allocator! I tested a number of variations using the allocators directly, and it worked. But it fell apart when I plugged it into std::set. The set doesn't allocate my class directly. It allocates nodes that contain my class... and node assumes that my class has a copy constructor. <em>sigh</em> I thought the contract with the std::set was that it would use the \"construct\" method to actually construct the Wrapper object in its own node, but that apparently isn't the case. </p>\n\n<p>So now I'm stuck. C++17 reports that it has even deprecated the \"construct\" and \"destroy\" methods that I was betting on, so going forward, it looks like there isn't a way to plug in a custom constructor at all.</p>\n\n<p><strong>Can anyone propose a solution other than the BundleStuffTogether solution I had at the start? My next best idea is to core out std::set itself and rewrite its internals, and I really don't want to go down that road if I can avoid it.</strong></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1523476786, "post_id": 49783463, "comment_id": 86582423, "body": "Have you tried to understand why?"}], "answers": [{"comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1523476661, "post_id": 49783474, "comment_id": 86582348, "body": "At best that&#39;s a poor answer. At worst it isn&#39;t one."}], "tags": [], "owner": {"reputation": 1806, "user_id": 4146351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2WTdU1bWVaQ/AAAAAAAAAAI/AAAAAAAABeg/yvJBsxf1slM/photo.jpg?sz=128", "display_name": "Eric Yang", "link": "https://stackoverflow.com/users/4146351/eric-yang"}, "is_accepted": false, "score": -2, "last_activity_date": 1523476502, "creation_date": 1523476502, "answer_id": 49783474, "question_id": 49783463, "link": "https://stackoverflow.com/questions/49783463/getting-the-substring-of-string-with-multiple-instances-of-the-same-delimiter/49783474#49783474", "title": "Getting the substring of string with multiple instances of the same delimiter", "body": "<p>cstring has strtok that does exactly what you want.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 9128168, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c3c3f0ac567fe9e828378af77c829de6?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/9128168/jon"}, "edited": false, "score": 1, "creation_date": 1523477651, "post_id": 49783599, "comment_id": 86582861, "body": "Oh man thats awesome, works great, thanks for the answer!"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523477993, "post_id": 49783599, "comment_id": 86583036, "body": "Such a loop would be much simpler using <code>std::istringstream</code> with <code>std::getline()</code>, eg: <code>istringstream iss(line); while (getline(iss, word, &#39;:&#39;)) { vecStrings.push_back(word); }</code>"}, {"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523478302, "post_id": 49783599, "comment_id": 86583200, "body": "@RemyLebeau: yes I saw the link in the comment section. Thanks for that."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1523478838, "post_id": 49783599, "comment_id": 86583467, "body": "So much code for a simple task :/"}], "tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": true, "score": 0, "last_activity_date": 1523518828, "last_edit_date": 1523518828, "creation_date": 1523476994, "answer_id": 49783599, "question_id": 49783463, "link": "https://stackoverflow.com/questions/49783463/getting-the-substring-of-string-with-multiple-instances-of-the-same-delimiter/49783599#49783599", "title": "Getting the substring of string with multiple instances of the same delimiter", "body": "<p>It is much easier with a simple <code>for</code> loop:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n    std::string line = \"Number:Description:Price:Weight\";\n\n    std::vector&lt;std::string&gt; vecStrings;\n    std::string word;\n    size_t count = 0;\n\n    for (auto const&amp; it : line)\n    {\n        if (it != ':') word += it;\n\n        if ((it == ':') || (count + 1 == line.size()))\n        {\n             vecStrings.emplace_back(word);\n             word.clear();\n        }\n        ++count;\n    }\n\n    for(const auto&amp; it: vecStrings) \n        std::cout &lt;&lt; it &lt;&lt; \"\\n\";\n\n    return 0;\n}\n</code></pre>\n\n<p>See live action: <a href=\"https://www.ideone.com/DiAvjO\" rel=\"nofollow noreferrer\">https://www.ideone.com/DiAvjO</a></p>\n\n<p><em>Update:</em> If you need something different, you can do the same thing with <code>std::for_each()</code> and a <code>lambda</code>:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n\nstd::for_each(std::begin(line), std::end(line), [&amp;](char &amp;letter)\n{\n    if (letter != ':') word += letter;\n    if ((letter == ':') || (count + 1 == line.size()))\n    {\n        vecStrings.emplace_back(word);\n        word.clear();\n    }\n    ++count;\n});\n</code></pre>\n\n<p>However, a much simpler solution to this would be to use <code>std::istringstream</code>. Thanks to RemyLebeau for pointing out this:</p>\n\n<pre><code>#include &lt;sstream&gt;\n\nstd::stringstream sstr(line);\nstd::string word;\n\nwhile (std::getline(sstr, word, ':'))\n{\n    vecStrings.emplace_back(word);\n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1523477872, "creation_date": 1523477872, "answer_id": 49783828, "question_id": 49783463, "link": "https://stackoverflow.com/questions/49783463/getting-the-substring-of-string-with-multiple-instances-of-the-same-delimiter/49783828#49783828", "title": "Getting the substring of string with multiple instances of the same delimiter", "body": "<p><code>std::string::find()</code> takes a starting index as an optional parameter:</p>\n\n<pre><code>string line = \"Number:Description:Price:Weight\";\nstring::size_type start, end;\nchar delimiter = ':';\n\nend = line.find(delimiter);\nstring number = line.substr(0, end);\n\nstart = end + 1;\nend = line.find(delimiter, start);\nstring desc = line.substr(start, end-start);\n\nstart = end + 1;\nend = line.find(delimiter, start);\nstring price = line.substr(start, end-start);\n\nstring weight = line.substr(end + 1);\n</code></pre>\n\n<p>Alternatively, you can split the string on delimiters by using <code>std::istringstream</code> with <code>std::getline()</code>:</p>\n\n<pre><code>string line = \"Number:Description:Price:Weight\";\nstring number, desc, price, weight;\nchar delimiter = ':';\n\nistringstream iss(line);\ngetline(iss, number, delimiter);\ngetline(iss, desc, delimiter);\ngetline(iss, price, delimiter);\ngetline(iss, weight);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 697, "user_id": 1160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431cd02524d6ee187fcd1b3d9658498c?s=128&d=identicon&r=PG", "display_name": "Maddy", "link": "https://stackoverflow.com/users/1160404/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1523481217, "creation_date": 1523481217, "answer_id": 49784566, "question_id": 49783463, "link": "https://stackoverflow.com/questions/49783463/getting-the-substring-of-string-with-multiple-instances-of-the-same-delimiter/49784566#49784566", "title": "Getting the substring of string with multiple instances of the same delimiter", "body": "<p>you can make use of strtok like below </p>\n\n<pre><code>#include &lt;string.h&gt;\nint main()\n{\n    char line[] = \"Number:Description:Price:Weight\";\n\n    char * token = std::strtok (line,\":\");\n\n    while (token != NULL)\n    {\n        cout &lt;&lt; token &lt;&lt; '\\n';\n        token = std::strtok(NULL, \":\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Make necessary changes as per your need </p>\n"}], "owner": {"reputation": 47, "user_id": 9128168, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c3c3f0ac567fe9e828378af77c829de6?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/9128168/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "closed_date": 1523483795, "accepted_answer_id": 49783599, "answer_count": 4, "score": 1, "last_activity_date": 1523518828, "creation_date": 1523476436, "question_id": 49783463, "link": "https://stackoverflow.com/questions/49783463/getting-the-substring-of-string-with-multiple-instances-of-the-same-delimiter", "closed_reason": "Duplicate", "title": "Getting the substring of string with multiple instances of the same delimiter", "body": "<p>I have a string of data that looks like </p>\n\n<pre><code>string line = \"Number:Description:Price:Weight\";\n</code></pre>\n\n<p>I want to separate the string into 4 different variables via the delimiter \":\". I was trying this via the substring method</p>\n\n<pre><code>char delimiter = ':';\nstring number = line.substr(0, line.find(delimiter));\n</code></pre>\n\n<p>It works fine for the first variable. However, I am unable to figure out how to iterate to the next instance of the \":\" for the other variables.</p>\n"}, {"tags": ["c++", "regex", "c++11", "text"], "comments": [{"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1523476707, "post_id": 49783452, "comment_id": 86582372, "body": "Compiles <a href=\"http://coliru.stacked-crooked.com/a/fdca6acb402d1e2c\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 1170, "user_id": 6745924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6mm6L.png?s=128&g=1", "display_name": "machetazo", "link": "https://stackoverflow.com/users/6745924/machetazo"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1523476783, "post_id": 49783452, "comment_id": 86582421, "body": "Im using c++11, it appears that that website uses c++14. Also, do you have any idea of why does it compile there and not on my machine?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1523476867, "post_id": 49783452, "comment_id": 86582463, "body": "What is the gcc version?"}, {"owner": {"reputation": 1170, "user_id": 6745924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6mm6L.png?s=128&g=1", "display_name": "machetazo", "link": "https://stackoverflow.com/users/6745924/machetazo"}, "edited": false, "score": 0, "creation_date": 1523476931, "post_id": 49783452, "comment_id": 86582489, "body": "<code>g++ --version</code> returns the following: <code>g++ (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609</code>"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1523477021, "post_id": 49783452, "comment_id": 86582539, "body": "How do you run the code?"}, {"owner": {"reputation": 1170, "user_id": 6745924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6mm6L.png?s=128&g=1", "display_name": "machetazo", "link": "https://stackoverflow.com/users/6745924/machetazo"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1523477212, "post_id": 49783452, "comment_id": 86582634, "body": "@wiktor-stribi\u017cew I have tried 2 methods. Firstly, I use the following command: <code>g++ -std=c++11 -Wall</code>. After getting so many errors, I used the CLion IDE to run the code. Both methods have failed to compile."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1523477322, "post_id": 49783452, "comment_id": 86582699, "body": "Well, I have no issues when using 1) <code>g++ -std=c++11 -Wall -o myprog &lt;FILE_PATH&gt;</code>, 2) <code>.&#47;myprog</code>"}, {"owner": {"reputation": 1170, "user_id": 6745924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6mm6L.png?s=128&g=1", "display_name": "machetazo", "link": "https://stackoverflow.com/users/6745924/machetazo"}, "edited": false, "score": 0, "creation_date": 1523477736, "post_id": 49783452, "comment_id": 86582903, "body": "That seems to work. What does <code>myprog</code> do? I&#39;m sorry for so many questions. I&#39;m just getting started with c++. I&#39;m still having trouble to adapt that code to my own purposes, but that belongs to another question. If you add an answer to <b>this question</b>, I&#39;ll accept it. Thank you for your help."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1523477841, "post_id": 49783452, "comment_id": 86582957, "body": "<code>myprog</code> is the program file name, <code>.&#47;myprog</code> will run the executable."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1523477997, "post_id": 49783452, "comment_id": 86583038, "body": "I found a duplicate for it, I will close. You may also use <code>g++ -std=c++11 -Wall -o myprog 1.cc &amp;&amp; .&#47;myprog</code> to compile the code and run with a one-liner."}], "owner": {"reputation": 1170, "user_id": 6745924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6mm6L.png?s=128&g=1", "display_name": "machetazo", "link": "https://stackoverflow.com/users/6745924/machetazo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "closed_date": 1523478003, "answer_count": 0, "score": 1, "last_activity_date": 1523477063, "creation_date": 1523476379, "last_edit_date": 1523477063, "question_id": 49783452, "link": "https://stackoverflow.com/questions/49783452/regex-parameter-type-mismatch-when-using-regex-search-function-in-c", "closed_reason": "Duplicate", "title": "regex - Parameter type mismatch when using regex_search function in C++", "body": "<p>I am trying to run the example code for the <code>regex_search</code> function found in <a href=\"http://www.cplusplus.com/reference/regex/regex_search/\" rel=\"nofollow noreferrer\">the docs</a>.</p>\n\n<p><strong>The code in their example is the following:</strong></p>\n\n<pre><code>// regex_search example\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;regex&gt;\n\nint main ()\n{\n  std::string s (\"this subject has a submarine as a subsequence\");\n  std::smatch m;\n  std::regex e (\"\\\\b(sub)([^ ]*)\");   // matches words beginning by \"sub\"\n\n  std::cout &lt;&lt; \"Target sequence: \" &lt;&lt; s &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"Regular expression: /\\\\b(sub)([^ ]*)/\" &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"The following matches and submatches were found:\" &lt;&lt; std::endl;\n\n  while (std::regex_search (s,m,e)) {\n    for (auto x:m) std::cout &lt;&lt; x &lt;&lt; \" \";\n    std::cout &lt;&lt; std::endl;\n    s = m.suffix().str();\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>When I try to run this code on my computer (I'm on Ubuntu 16.04 and using g++ compiler) I get the following warning on my IDE for the <code>m</code> parameter:\n<code>Parameter type mismatch: Class 'std::smatch' is not compatible with class 'std::match_results&lt;const char *, std::allocator&lt;std::sub_match&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt;&gt;::const_iterator&gt;&gt;&gt;'</code></p>\n\n<p>And this other one for the <code>s</code> parameter: <code>Parameter type mismatch: Types 'const char *' and 'std::string' are not compatible</code>.</p>\n\n<p><strong>When I try to compile the code I get:</strong></p>\n\n<pre><code>./src/launcher.cpp: In function \u2018int main()\u2019:\n./src/launcher.cpp:18:3: error: \u2018smatch\u2019 was not declared in this scope\n   smatch m;\n   ^\n./src/launcher.cpp:18:3: note: suggested alternatives:\nIn file included from /usr/include/c++/5/regex:61:0,\n                 from ./src/launcher.cpp:3:\n/usr/include/c++/5/bits/regex.h:1900:50: note:   \u2018std::__cxx11::smatch\u2019\n   typedef match_results&lt;string::const_iterator&gt;  smatch;\n                                                  ^\n/usr/include/c++/5/bits/regex.h:1900:50: note:   \u2018std::__cxx11::smatch\u2019\n./src/launcher.cpp:19:3: error: \u2018regex\u2019 was not declared in this scope\n   regex e (\"\\\\b(sub)([^ ]*)\");   // matches words beginning by \"sub\"\n   ^\n./src/launcher.cpp:19:3: note: suggested alternatives:\nIn file included from /usr/include/c++/5/regex:61:0,\n                 from ./src/launcher.cpp:3:\n/usr/include/c++/5/bits/regex.h:786:32: note:   \u2018std::__cxx11::regex\u2019\n   typedef basic_regex&lt;char&gt;    regex;\n                                ^\n/usr/include/c++/5/bits/regex.h:786:32: note:   \u2018std::__cxx11::regex\u2019\n./src/launcher.cpp:25:26: error: \u2018m\u2019 was not declared in this scope\n   while (regex_search (s,m,e)) {\n                          ^\n./src/launcher.cpp:25:28: error: \u2018e\u2019 was not declared in this scope\n   while (regex_search (s,m,e)) {\n                            ^\n./src/launcher.cpp:26:17: error: unable to deduce \u2018auto&amp;&amp;\u2019 from \u2018m\u2019\n     for (auto x:m) std::cout &lt;&lt; x &lt;&lt; \" \";\n                 ^\nMakefile:21: recipe for target 'launcher.o' failed\nmake: *** [launcher.o] Error 1\n</code></pre>\n\n<p>I solved the problem with the <code>s</code> parameter by converting it to a c-string using the <code>c_str()</code> function. Nevertheless, I haven't been able to fix the problem with the <code>m</code> parameter.</p>\n\n<p>I have tried to change the type of <code>m</code> to <code>match_results</code> (which is its template class) but errors persisted. I have also tried to change the type of <code>m</code> to the types suggested by the warning on my IDE, but problems persist.</p>\n\n<p>I understand that the problem is that the type of <code>m</code> is not the type that the function is expecting but I don't know how to solve it.</p>\n\n<p>Does anybody have any suggestions on how to solve this problem?</p>\n\n<p>My main goal is to adapt that code to extract a certain string that contains a certain substring, so if anyone has any suggestions on how to do that, I'll be very thankful aswell.</p>\n"}, {"tags": ["c++", "parsing", "yaml", "yaml-cpp"], "answers": [{"tags": [], "owner": {"reputation": 2928, "user_id": 1603365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/K4qJN.png?s=128&g=1", "display_name": "md5i", "link": "https://stackoverflow.com/users/1603365/md5i"}, "is_accepted": true, "score": 2, "last_activity_date": 1523482741, "creation_date": 1523482741, "answer_id": 49784837, "question_id": 49783422, "link": "https://stackoverflow.com/questions/49783422/how-to-get-specific-category-names-from-yaml-file/49784837#49784837", "title": "How to get specific category names from yaml file?", "body": "<p>Here, <code>node</code> is a YAML map.  When you iterate over a YAML map, you get back  <code>std::pair&lt;YAML::Node, YAML::Node&gt;</code>, which are key, value pairs.  So, you want:</p>\n\n<pre><code>for (auto n : node) {\n    YAML::Node &amp;key = p.first;\n    // Do something with the key here\n}\n</code></pre>\n\n<p>(In actuality, the value returned by dereferencing the iterators is a type that inherits both from <code>YAML::Node</code> and <code>std::pair&lt;YAML::Node, YAML::Node&gt;</code>, which is why your current code doesn't fail to compile.  But that is an implementation detail.)</p>\n"}], "owner": {"reputation": 29, "user_id": 9593815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c794d09ee4c88d6fa5da90fb992257e6?s=128&d=identicon&r=PG&f=1", "display_name": "Noel Bahdy", "link": "https://stackoverflow.com/users/9593815/noel-bahdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 49784837, "answer_count": 1, "score": 0, "last_activity_date": 1523482842, "creation_date": 1523476287, "last_edit_date": 1523482842, "question_id": 49783422, "link": "https://stackoverflow.com/questions/49783422/how-to-get-specific-category-names-from-yaml-file", "title": "How to get specific category names from yaml file?", "body": "<p>I am using c++ and have a <a href=\"http://yaml.org/\" rel=\"nofollow noreferrer\">yaml</a> file that looks like this:</p>\n\n<pre><code>Food:\n  Apple:\n    - Type: grannysmith\n  BellPepper:\n    - Type: Red\n    - Type: Green\n  Sandwich:\n    - Type: Ham\n</code></pre>\n\n<p>I need to parse it so that I get a string vector listing only the food names:<br>\n<code>output: \"Apple\", \"BellPepper\",\"Sandwich\"</code></p>\n\n<p>My code looks like this so far:</p>\n\n<pre><code>YAML::Node node = YAML::LoadFile(configYamlPath)[\"Food\"];    \nstd::vector&lt;std::string&gt; items;    \nfor (YAML::Node n : node){    \n    items.push_back(n.as&lt;std::string&gt;());    \n}    \n</code></pre>\n\n<p>How would I go about getting those specific keys?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1523476359, "post_id": 49783398, "comment_id": 86582168, "body": "You should look up the keyword break"}, {"owner": {"reputation": 41680, "user_id": 37843, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1eae44bed3fd091a94a20782cc235434?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/37843/alan"}, "edited": false, "score": 0, "creation_date": 1523478077, "post_id": 49783398, "comment_id": 86583085, "body": "Before shortening up the code, have you explored it&#39;s efficiency?"}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 3, "creation_date": 1523478164, "post_id": 49783398, "comment_id": 86583134, "body": "In the future, <a href=\"https://codereview.stackexchange.com/\">Code Review</a> is a good place to post questions like this - when you have working code but want to explore improvements to it."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1523483371, "post_id": 49783398, "comment_id": 86585294, "body": "But note that like here, code for review should include the necessary headers and <code>using</code> directives (though <code>using namespace std;</code> is discouraged, as it&#39;s a dangerous practice)."}, {"owner": {"reputation": 289239, "user_id": 704848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9be2c2958e208c8d9b629ac43c9c42?s=128&d=identicon&r=PG", "display_name": "EdChum", "link": "https://stackoverflow.com/users/704848/edchum"}, "edited": false, "score": 0, "creation_date": 1523492692, "post_id": 49783398, "comment_id": 86587791, "body": "I&#39;m voting to close this question as off-topic because it belongs on code review"}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1523476766, "creation_date": 1523476766, "answer_id": 49783548, "question_id": 49783398, "link": "https://stackoverflow.com/questions/49783398/how-can-i-make-my-word-lookup-cleaner-and-more-efficient/49783548#49783548", "title": "How can I make my word lookup cleaner and more efficient?", "body": "<p>Use the <code>std::find</code> operation on a vector.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\nusing namespace std;\n\nint main()\n{\n    vector&lt;string&gt; disliked = { \"damn\",\"stupid\",\"fat\" };\n    string word = \"\";\n\n    while (cin &gt;&gt; word) {\n        if ( std::find(disliked.begin(), disliked.end(), word) != disliked.end() )\n        {\n            cout &lt;&lt; \"Bleep \";\n        }\n        else\n        {\n            cout &lt;&lt; word;\n        }\n    }\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 9632480, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kirill", "link": "https://stackoverflow.com/users/9632480/kirill"}, "edited": false, "score": 0, "creation_date": 1523478824, "post_id": 49783647, "comment_id": 86583463, "body": "Thank you! helped alot, understood the vector part .but the .find != .end is hard to understand (did google , still cant understand)."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 23, "user_id": 9632480, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kirill", "link": "https://stackoverflow.com/users/9632480/kirill"}, "edited": false, "score": 1, "creation_date": 1523478977, "post_id": 49783647, "comment_id": 86583531, "body": "<a href=\"http://en.cppreference.com/w/cpp/container/set/find\" rel=\"nofollow noreferrer\"><code>std::set::find()</code></a> returns an iterator pointing to the found item. If it was not found, it returns the end iterator. Does that help?"}, {"owner": {"reputation": 23, "user_id": 9632480, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kirill", "link": "https://stackoverflow.com/users/9632480/kirill"}, "edited": false, "score": 0, "creation_date": 1523479367, "post_id": 49783647, "comment_id": 86583716, "body": "Yeah it actually cleared it all up :). Thank your for your huge help !"}], "tags": [], "owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "is_accepted": true, "score": 3, "last_activity_date": 1523478927, "last_edit_date": 1523478927, "creation_date": 1523477167, "answer_id": 49783647, "question_id": 49783398, "link": "https://stackoverflow.com/questions/49783398/how-can-i-make-my-word-lookup-cleaner-and-more-efficient/49783647#49783647", "title": "How can I make my word lookup cleaner and more efficient?", "body": "<p>Sort your vector and use <a href=\"http://en.cppreference.com/w/cpp/algorithm/binary_search\" rel=\"nofollow noreferrer\"><code>std::binary_search</code></a>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    std::vector&lt;std::string&gt; disliked = { \"damn\",\"stupid\",\"fat\" };\n    sort(std::begin(disliked), std::end(disliked));\n    std::string word = \"\";\n\n    while (std::cin &gt;&gt; word)\n    {\n        if ( binary_search(std::begin(disliked), std::end(disliked), word))\n        {\n            std::cout &lt;&lt; \"Bleep \";\n        }\n        else\n        {\n            std::cout &lt;&lt; word;\n        }\n    }\n}\n</code></pre>\n\n<p>or use <a href=\"http://en.cppreference.com/w/cpp/container/set\" rel=\"nofollow noreferrer\"><code>std::set</code></a> instead of vector:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;set&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    std::set&lt;std::string&gt; disliked = { \"damn\",\"stupid\",\"fat\" };\n    std::string word = \"\";\n\n    while (std::cin &gt;&gt; word)\n    {\n        if ( disliked.find(word) != std::end(disliked) )\n        {\n            std::cout &lt;&lt; \"Bleep \";\n        }\n        else\n        {\n            std::cout &lt;&lt; word;\n        }\n    }\n}\n</code></pre>\n\n<p>Both of these solutions have logarithmic complexity for the word lookup instead of linear.</p>\n"}], "owner": {"reputation": 23, "user_id": 9632480, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kirill", "link": "https://stackoverflow.com/users/9632480/kirill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "closed_date": 1523492692, "accepted_answer_id": 49783647, "answer_count": 2, "score": 1, "last_activity_date": 1523478927, "creation_date": 1523476210, "last_edit_date": 1523478037, "question_id": 49783398, "link": "https://stackoverflow.com/questions/49783398/how-can-i-make-my-word-lookup-cleaner-and-more-efficient", "closed_reason": "Needs more focus", "title": "How can I make my word lookup cleaner and more efficient?", "body": "<p>Write a program that \u201cbleeps\u201d out words that you don\u2019t like; that is, you read in words using cin and print them\nagain on cout. If a word is among a few you have defined, you write out BLEEP instead of that word. Start with\none \u201cdisliked word\u201d such as\nstring disliked = \u201cBroccoli\u201d;\nWhen that works, add a few more.</p>\n\n<p>So i was thinking on how i could create a code that would do that with a set of words using a vector, but all i could come up with was</p>\n\n<pre><code>int main()\n{\n    vector&lt;string&gt; disliked = { \"damn\",\"stupid\",\"fat\" };\n    string word = \"\";\n\n    while (cin &gt;&gt; word) {\n        bool bad = false;\n        for (string x : disliked) {\n            if (x == word)\n                bad = true;\n        }\n        if (bad)\n            cout &lt;&lt; \"Bleep\\n\";\n        else\n            cout &lt;&lt; word &lt;&lt; \"\\n\";\n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>i feel like that code can be shortened with taking out one of the if statements but i can't find a working way to do it.\noverall it seems like more code than it should be for this simple check, also could  the for part be done better? doing a whole loop of the whole vector seems to be too resource intensive in a case where the vector has lets say a 1000 words, maybe separating it by an if statement checking for a-d, f-j... etc, and then only running a for loop would be less heavy?</p>\n"}, {"tags": ["c++", "pointers", "struct", "parameters"], "comments": [{"owner": {"reputation": 607, "user_id": 8225336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/418c2e0a00933c6e12a63c1bca55ea27?s=128&d=identicon&r=PG&f=1", "display_name": "tangoal", "link": "https://stackoverflow.com/users/8225336/tangoal"}, "edited": false, "score": 1, "creation_date": 1523476075, "post_id": 49783181, "comment_id": 86582002, "body": "Did you initialize the photocell correctly? How is the phcellmethod specified? By the way, you don&#39;t need the pointer variable rsptr, you can just pass &amp;rs to the phcellmethod."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1523491429, "post_id": 49783181, "comment_id": 86587517, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 3, "user_id": 9632524, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1m7OfT40Uug/AAAAAAAAAAI/AAAAAAAANBs/QYg3O9b-BPw/photo.jpg?sz=128", "display_name": "cobalt300z", "link": "https://stackoverflow.com/users/9632524/cobalt300z"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1523536834, "post_id": 49783181, "comment_id": 86607924, "body": "@PasserBy I am unable to provide the complete source code. The photocell uses a proprietary DLL /LIB file that I cannot share/have access to."}, {"owner": {"reputation": 3, "user_id": 9632524, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1m7OfT40Uug/AAAAAAAAAAI/AAAAAAAANBs/QYg3O9b-BPw/photo.jpg?sz=128", "display_name": "cobalt300z", "link": "https://stackoverflow.com/users/9632524/cobalt300z"}, "reply_to_user": {"reputation": 607, "user_id": 8225336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/418c2e0a00933c6e12a63c1bca55ea27?s=128&d=identicon&r=PG&f=1", "display_name": "tangoal", "link": "https://stackoverflow.com/users/8225336/tangoal"}, "edited": false, "score": 0, "creation_date": 1523537112, "post_id": 49783181, "comment_id": 86608142, "body": "@tangoal farther up in the code I can successfully connect to the photocell. I changed the method declaration to accept a reference. It still does the same thing. the struct is filled with the initial read then all subsequent reads are not overwriting the phcell substruct."}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1523537575, "post_id": 49783181, "comment_id": 86608535, "body": "Nitpick maybe but this looks like C, not C++ (you may be compiling with a C++ computer like MSVC++ but the posted code and API do not leverage any C++ features)."}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1523537622, "post_id": 49783181, "comment_id": 86608570, "body": "... Except for the std::cout of course, haha. But the photocell API is still C."}, {"owner": {"reputation": 3, "user_id": 9632524, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1m7OfT40Uug/AAAAAAAAAAI/AAAAAAAANBs/QYg3O9b-BPw/photo.jpg?sz=128", "display_name": "cobalt300z", "link": "https://stackoverflow.com/users/9632524/cobalt300z"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1523540595, "post_id": 49783181, "comment_id": 86610922, "body": "@TypeIA You are correct. the API is in C."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9632524, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1m7OfT40Uug/AAAAAAAAAAI/AAAAAAAANBs/QYg3O9b-BPw/photo.jpg?sz=128", "display_name": "cobalt300z", "link": "https://stackoverflow.com/users/9632524/cobalt300z"}, "edited": false, "score": 0, "creation_date": 1523536753, "post_id": 49784697, "comment_id": 86607869, "body": "The dot method throws an error &quot; expression must be of class type&quot;  The other one compiles and executes but the values are not changing. The initial read is filling the struct but all other reads are being ignored. I verified this by starting the exe with the photocell detecting the ambient light, then a covered the photocell with my hand. The values should drop in value, but the initial values remain."}, {"owner": {"reputation": 1308, "user_id": 5689220, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FipQW.png?s=128&g=1", "display_name": "villapx", "link": "https://stackoverflow.com/users/5689220/villapx"}, "edited": false, "score": 1, "creation_date": 1523537567, "post_id": 49784697, "comment_id": 86608527, "body": "You&#39;d need to do <code>(*rsptr).phcell.GetWord()</code> in the first example"}, {"owner": {"reputation": 3, "user_id": 9632524, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1m7OfT40Uug/AAAAAAAAAAI/AAAAAAAANBs/QYg3O9b-BPw/photo.jpg?sz=128", "display_name": "cobalt300z", "link": "https://stackoverflow.com/users/9632524/cobalt300z"}, "edited": false, "score": 0, "creation_date": 1523540647, "post_id": 49784697, "comment_id": 86610966, "body": "I was able to get it working. I have to reconnect to the photocell every polling cycle. This API sucks."}], "tags": [], "owner": {"reputation": 431, "user_id": 8731135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31403414a1f928e7ab619ff30e3a1b0c?s=128&d=identicon&r=PG&f=1", "display_name": "Baedsch", "link": "https://stackoverflow.com/users/8731135/baedsch"}, "is_accepted": true, "score": 0, "last_activity_date": 1523538120, "last_edit_date": 1523538120, "creation_date": 1523481936, "answer_id": 49784697, "question_id": 49783181, "link": "https://stackoverflow.com/questions/49783181/out-parameter-with-struct-c/49784697#49784697", "title": "out parameter with struct c++", "body": "<pre><code>WORD brit = (*rsptr).phcell.GetWord();\n</code></pre>\n\n<p>or</p>\n\n<pre><code>WORD brit = rsptr-&gt;phcell.GetWord();\n</code></pre>\n\n<p>should be the syntax you want. Either, you dereference the pointer using <code>*</code> or use <code>-&gt;</code></p>\n"}], "owner": {"reputation": 3, "user_id": 9632524, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1m7OfT40Uug/AAAAAAAAAAI/AAAAAAAANBs/QYg3O9b-BPw/photo.jpg?sz=128", "display_name": "cobalt300z", "link": "https://stackoverflow.com/users/9632524/cobalt300z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 49784697, "answer_count": 1, "score": 0, "last_activity_date": 1523538120, "creation_date": 1523475417, "last_edit_date": 1523537270, "question_id": 49783181, "link": "https://stackoverflow.com/questions/49783181/out-parameter-with-struct-c", "title": "out parameter with struct c++", "body": "<p>I am trying to poll a photocell. the code executes as it should but the struct values aren't changing after the first call to the method  </p>\n\n<pre><code>int i = ConnectSendersByIP(ip);\n\nstd::cout &lt;&lt; \"Connected Senders: \" &lt;&lt; i &lt;&lt; std::endl;\n\nint j = ConnectReceivers();\n\nstd::cout &lt;&lt; \"Connected Receivers: \" &lt;&lt; j &lt;&lt; std::endl;\n\nWORD u = GetSenderId((byte)0);\n\n\nreceiverStatus_v1 * rsptr;\n\n\nwhile (true)\n{\n    std::cout &lt;&lt; \"Polling Photocell\" &lt;&lt; std::endl;\n\n    BOOL rd = GetReceiverDiagnostics_v1(u, (byte)0, 0, rsptr);\n\n    std::cout &lt;&lt; rd &lt;&lt; std::endl;\n\n    WORD brit = rsptr-&gt;bwEnviBritValue.GetWord();\n\n    WORD lum = GetLumAttenuation();\n\n    std::cout &lt;&lt; \"LUX: \" &lt;&lt; ((brit * lum) / 100) &lt;&lt; \" \\r\\n BRIT: \" &lt;&lt; brit &lt;&lt; \"\\r\\n LUM:\" &lt;&lt; lum &lt;&lt; std::endl;\n\n    Sleep(1000);\n}\n</code></pre>\n\n<p>Here is the method declaration in the header file</p>\n\n<pre><code>BOOL phcellmethod(WORD senderId, BYTE portIndex, WORD receiverIndex, _Out_ somestruct* pReceiverStatus);\n</code></pre>\n\n<p>in the somestruct struct there is another struct that stores the data from the photocell. </p>\n\n<pre><code>    struct anotherstruct\n{\n    BYTE hi;\n    BYTE lo;\n    WORD GetWord() const\n    {\n        return (hi &lt;&lt; 8) + lo;\n    }\n};\n</code></pre>\n\n<p>I am primarily a .NET programmer, i am a bit unfamiliar with pointers in c++. How can i call this method and have the data in the struct change in every cycle of the loop?</p>\n"}, {"tags": ["c++", "assembly", "optimization", "x86-64", "compiler-optimization"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 5, "creation_date": 1523473281, "post_id": 49782609, "comment_id": 86580540, "body": "One thing to note is that those functions have no side effects and return nothing, so the compiler could easily optimize it to nothing (<a href=\"https://godbolt.org/g/taqP9A\" rel=\"nofollow noreferrer\">gcc does at <code>-Og</code></a>). You should probably take the integer as an argument and return the result."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1523473325, "post_id": 49782609, "comment_id": 86580573, "body": "Are you building without optimization? If you enable it, are the result different? Performance measuring and benchmarking should always be done on optimized code."}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 5, "creation_date": 1523473396, "post_id": 49782609, "comment_id": 86580602, "body": "for such tests it is important to use at least -O2 optimization level together with being clear about -march, -mtune switches"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1523475320, "post_id": 49782609, "comment_id": 86581593, "body": "And counting instructions on architectures like x86 or ARM is pointless. More instructions could result in faster execution. Instead profile your code <b>iff</b> you have a performance problem and optimise hotspots."}, {"owner": {"reputation": 2976, "user_id": 2958774, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d2cf682c1744c34aecd5804b144b0d75?s=128&d=identicon&r=PG&f=1", "display_name": "Myria", "link": "https://stackoverflow.com/users/2958774/myria"}, "edited": false, "score": 1, "creation_date": 1523475352, "post_id": 49782609, "comment_id": 86581611, "body": "The lack of a size suffix on the <code>add</code> instruction just means that the size is implied by the operands.  It doesn&#39;t mean that overflow is undefined.  Overflow is always defined at the processor level."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1523476914, "post_id": 49782609, "comment_id": 86582485, "body": "@Olaf: It&#39;s not about <i>hand-written</i> asm, but it&#39;s very much about the assembly output of compilers.  People that know C++ and assembly are much better prepared to answer this question than just C++.  Unfortunately the question is based on such an incorrect experiment that it&#39;s just totally bogus.  There&#39;s no mixing of integers with pointers here to even give the compiler room to optimize anything, and is all about the anti-optimized <code>-O0</code> debug mode code."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1523477265, "post_id": 49782609, "comment_id": 86582662, "body": "@PeterCordes: That&#39;s what the machine-tags are for. There is no requirement the compiler outputs Assembly code at all. Nor does the CPU execute Assembly language."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1523478038, "post_id": 49782609, "comment_id": 86583065, "body": "@Olaf: The answer here is basically the same for other architectures, especially ones that have 32 and 64-bit operand sizes.  x86-64 is just one specific case.  For compilers that can output machine code directly, humans will still look at disassembly, or ask the compiler to produce asm instead of machine code (like with <code>clang -O3 -S</code> or whatever option MSVC has).  Other questions like this are correctly tagged <code>[assembly]</code>.  Having gold badges in [assembly], [c++], and [x86], I think I&#39;m qualified to judge when one or both are appropriate."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1523478544, "post_id": 49782609, "comment_id": 86583337, "body": "@PeterCordes: &quot;The answer here is basically the same for other architectures, especially ones that have 32 and 64-bit operand sizes.&quot; - That&#39;s not really correct. THere are some architectures which do have different performance for multi-word arithmetic. Namely for ARM there are different variants possible. I agree, though the question is very poorly researched and production code is rarely that straight. That&#39;s why the question is in fact off-topic. I can&#39;t&amp;won&#39;t judge about your expertise, but I know about mine well enough."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 2, "creation_date": 1523490228, "post_id": 49782609, "comment_id": 86587216, "body": "The first paragraph isn&#39;t an accurate summary of Chandler&#39;s explanation, so the question seems predicated on a misconception."}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1523499591, "post_id": 49783306, "comment_id": 86589195, "body": "they made it undefined because <a href=\"https://stackoverflow.com/q/18195715/995714\">they allow other signed formats</a>, not only 2&#39;s complement"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1523502157, "post_id": 49783306, "comment_id": 86589805, "body": "Note that in this case, the compiler is just doing a bad job.  It could have used scaled-index addressing modes for the load and store, and <code>inc %eax</code> instead of <code>inc %rax</code>, to correctly implement the exact behaviour of the C++ source.  <code>leaq 0(,%rax,4), %rcx</code> to set up for the next iterations is particularly braindead.  But yes, the extra requirement to wrap the index constrains the compiler in a way that makes it shoot itself in the foot here.  Notice that the <code>int</code> version is still using indexed addressing modes, but the index is 64-bit, and scaled up by 4 to a byte offset."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1523614967, "post_id": 49783306, "comment_id": 86643644, "body": "Suggestion: you could show the asm output for <code>gcc -O2 -fwrapv</code>, which makes signed integer overflow well-defined as wrapping."}], "tags": [], "owner": {"reputation": 2976, "user_id": 2958774, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d2cf682c1744c34aecd5804b144b0d75?s=128&d=identicon&r=PG&f=1", "display_name": "Myria", "link": "https://stackoverflow.com/users/2958774/myria"}, "is_accepted": true, "score": 3, "last_activity_date": 1523478213, "last_edit_date": 1523478213, "creation_date": 1523475866, "answer_id": 49783306, "question_id": 49782609, "link": "https://stackoverflow.com/questions/49782609/performance-difference-of-signed-and-unsigned-integers-of-non-native-length/49783306#49783306", "title": "Performance difference of signed and unsigned integers of non-native length", "body": "<p>There are two parts of this question: Chandler's point about optimizations based on overflow being undefined, and the differences you found in the assembly output.</p>\n\n<p>Chandler's point is that if overflow is undefined behavior, then the compiler can assume that it cannot happen.  Consider the following code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef int T;\nvoid CopyInts(int *dest, const int *src) {\n    T x = 0;\n    for (; src[x]; ++x) {\n        dest[x] = src[x];\n    }\n}\n</code></pre>\n\n<p>Here, the compiler can safely change the <code>for</code> loop to the following:</p>\n\n<pre><code>    while (*src) {\n        *dest++ = *src++;\n    }\n</code></pre>\n\n<p>That's because the compiler does not have to worry about the case that <code>x</code> overflows.  If the compiler has to worry about <code>x</code> overflowing, the source and destination pointers suddenly get 16 GB subtracted from them, so the simple transformation above will not work.</p>\n\n<p>At the assembly level, the above is (with GCC 7.3.0 for x86-64, <code>-O2</code>):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>_Z8CopyIntsPiPKii:\n  movl (%rsi), %edx\n  testl %edx, %edx\n  je .L1\n  xorl %eax, %eax\n.L3:\n  movl %edx, (%rdi,%rax)\n  addq $4, %rax\n  movl (%rsi,%rax), %edx\n  testl %edx, %edx\n  jne .L3\n.L1:\n  rep ret\n</code></pre>\n\n<p>If we change <code>T</code> to be <code>unsigned int</code>, we get this slower code instead:</p>\n\n<pre><code>_Z8CopyIntsPiPKij:\n  movl (%rsi), %eax\n  testl %eax, %eax\n  je .L1\n  xorl %edx, %edx\n  xorl %ecx, %ecx\n.L3:\n  movl %eax, (%rdi,%rcx)\n  leal 1(%rdx), %eax\n  movq %rax, %rdx\n  leaq 0(,%rax,4), %rcx\n  movl (%rsi,%rax,4), %eax\n  testl %eax, %eax\n  jne .L3\n.L1:\n  rep ret\n</code></pre>\n\n<p>Here, the compiler is keeping <code>x</code> as a separate variable so that overflow is handled properly.</p>\n\n<p>Instead of relying on signed overflow being undefined for performance, you can use a size type that is the same size as a pointer.  This means that such a variable could only overflow at the same time as a pointer, which is also undefined.  Hence, at least for x86-64, <code>size_t</code> would also work as <code>T</code> to get the better performance.</p>\n\n<p>Now for the second part of your question: the <code>add</code> instruction.  The suffixes on the <code>add</code> instruction are from the so-called \"AT&amp;T\" style of x86 assembly language.  In AT&amp;T assembly language, the parameters are backward from the way Intel writes instructions, and disambiguating instruction sizes is done by adding a suffix to the mnemonic instead of something like <code>dword ptr</code> in the Intel case.</p>\n\n<p>Example:</p>\n\n<p>Intel: <code>add dword ptr [eax], 1</code></p>\n\n<p>AT&amp;T: <code>addl $1, (%eax)</code></p>\n\n<p>These are the same instruction, just written differently.  The <code>l</code> takes the place of <code>dword ptr</code>.</p>\n\n<p>In the case where the suffix is missing from AT&amp;T instructions, it's because it's not required: the size is implicit from the operands.</p>\n\n<p><code>add $1, %eax</code></p>\n\n<p>The <code>l</code> suffix is unnecessary because the instruction is obviously 32-bit, because <code>eax</code> is.</p>\n\n<p>In short, it has nothing to do with overflow.  Overflow is always defined at the processor level.  On some architectures, such as when using the non-<code>u</code> instructions on MIPS, overflow throws an exception, but it's still <em>defined</em>.  C/C++ are the only major languages that make overflow unpredictable behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 1, "last_activity_date": 1523614925, "creation_date": 1523614925, "answer_id": 49814763, "question_id": 49782609, "link": "https://stackoverflow.com/questions/49782609/performance-difference-of-signed-and-unsigned-integers-of-non-native-length/49814763#49814763", "title": "Performance difference of signed and unsigned integers of non-native length", "body": "<blockquote>\n  <p>Either both add and addb/addw/addl/addq take the same number of cycles (latency) because the Intel Sandy Bridge CPU has hardware adders for all sizes or the 32-bit unit does the masking internally and therefore has a longer latency.</p>\n</blockquote>\n\n<p>First of all, it's a 64-bit adder because it supports qword <code>add</code> with the same performance.</p>\n\n<p>In hardware, masking bits doesn't take a whole extra clock cycle; one clock cycle is many <a href=\"https://en.wikipedia.org/wiki/Propagation_delay\" rel=\"nofollow noreferrer\">gate-delays</a> long.  An enable/disable control signal can zero the results from the high half (for 32-bit operand size), or stop carry-propagation at 16 or 8 bits (for smaller operand-sizes that leave the upper bits unmodified instead of zero-extending).</p>\n\n<p>So each execution port with an integer ALU execution unit probably uses the same adder transistors for all operand sizes, using control signals to modify its behaviour.  Maybe even using it for XOR as well (by blocking all the carry signals).</p>\n\n<hr>\n\n<p>I was going to write more about your misunderstanding of the optimization issue, but Myria already covered it.</p>\n\n<p>See also <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">What Every C Programmer Should Know About Undefined Behavior</a>, an LLVM blog post that explains some of the ways UB allows optimization, including specifically promoting a counter to 64-bit or optimizing it away into pointer increments, instead of implementing signed wrap-around like you'd get if signed integer overflow was strictly defined as wrapping.  (e.g. if you compile with <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Code-Gen-Options.html\" rel=\"nofollow noreferrer\"><code>gcc -fwrapv</code></a>, the opposite of <code>-fstrict-overflow</code>)</p>\n\n<hr>\n\n<p>Your un-optimized compiler output is pointless and doesn't tell us anything.  The x86 <code>add</code> instruction implements both unsigned and signed-2's-complement addition, <em>because those are both the same binary operation</em>.  The different code-gen at <code>-O0</code> is merely an artefact of compiler internals, not anything fundamental that would happen in real code (with <code>-O2</code> or <code>-O3</code>).</p>\n"}], "owner": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 1, "accepted_answer_id": 49783306, "answer_count": 2, "score": 0, "last_activity_date": 1523614925, "creation_date": 1523473126, "last_edit_date": 1523498629, "question_id": 49782609, "link": "https://stackoverflow.com/questions/49782609/performance-difference-of-signed-and-unsigned-integers-of-non-native-length", "title": "Performance difference of signed and unsigned integers of non-native length", "body": "<p>There is this talk, <a href=\"https://youtu.be/yG1OZ69H_-o?t=39m16s\" rel=\"nofollow noreferrer\">CppCon 2016: Chandler Carruth \u201cGarbage In, Garbage Out: Arguing about Undefined Behavior...\"</a>, where Mr. Carruth shows an example from the bzip code. They have used <code>uint32_t i1</code> as an index. On a 64-bit system the array access <code>block[i1]</code> will then do <code>*(block + i1)</code>. The issue is that <code>block</code> is a 64-bit pointer whereas <code>i1</code> is a 32-bit number. The addition might overflow and since unsigned integers have defined overflow behavior the compiler needs to add extra instructions to make sure that this is indeed fulfilled even on a 64-bit system.</p>\n\n<p>I would like to also show this with a simple example. So I have tried the <code>++i</code> code with various signed and unsigned integers. The following is my test code:</p>\n\n<pre><code>#include &lt;cstdint&gt;\n\nvoid test_int8() { int8_t i = 0; ++i; }\nvoid test_uint8() { uint8_t i = 0; ++i; }\n\nvoid test_int16() { int16_t i = 0; ++i; }\nvoid test_uint16() { uint16_t i = 0; ++i; }\n\nvoid test_int32() { int32_t i = 0; ++i; }\nvoid test_uint32() { uint32_t i = 0; ++i; }\n\nvoid test_int64() { int64_t i = 0; ++i; }\nvoid test_uint64() { uint64_t i = 0; ++i; } \n</code></pre>\n\n<p>With <code>g++ -c test.cpp</code> and <code>objdump -d test.o</code> I get assembly listings like\nthis:</p>\n\n<pre><code>000000000000004e &lt;_Z10test_int32v&gt;:\n  4e:   55                      push   %rbp\n  4f:   48 89 e5                mov    %rsp,%rbp\n  52:   c7 45 fc 00 00 00 00    movl   $0x0,-0x4(%rbp)\n  59:   83 45 fc 01             addl   $0x1,-0x4(%rbp)\n  5d:   90                      nop\n  5e:   5d                      pop    %rbp\n  5f:   c3                      retq   \n</code></pre>\n\n<p>To be honest: My knowledge of x86 assembly is rather limited, so my following\nconclusions and questions may be very naive.</p>\n\n<p>The first two instructions seem to be only from the call of a function, the\nlast three ones seem to be the return value. Removing only these lines, the\nfollowing kernels are left for the various data types:</p>\n\n<ul>\n<li><p><code>int8_t</code>:</p>\n\n<pre><code>   4:   c6 45 ff 00             movb   $0x0,-0x1(%rbp)\n   8:   0f b6 45 ff             movzbl -0x1(%rbp),%eax\n   c:   83 c0 01                add    $0x1,%eax\n   f:   88 45 ff                mov    %al,-0x1(%rbp)\n</code></pre></li>\n<li><p><code>uint8_t</code>:</p>\n\n<pre><code>  19:   c6 45 ff 00             movb   $0x0,-0x1(%rbp)\n  1d:   80 45 ff 01             addb   $0x1,-0x1(%rbp)\n</code></pre></li>\n<li><p><code>int16_t</code>:</p>\n\n<pre><code>  28:   66 c7 45 fe 00 00       movw   $0x0,-0x2(%rbp)\n  2e:   0f b7 45 fe             movzwl -0x2(%rbp),%eax\n  32:   83 c0 01                add    $0x1,%eax\n  35:   66 89 45 fe             mov    %ax,-0x2(%rbp)\n</code></pre></li>\n<li><p><code>uint16_t</code>:</p>\n\n<pre><code>  40:   66 c7 45 fe 00 00       movw   $0x0,-0x2(%rbp)\n  46:   66 83 45 fe 01          addw   $0x1,-0x2(%rbp)\n</code></pre></li>\n<li><p><code>int32_t</code>:</p>\n\n<pre><code>  52:   c7 45 fc 00 00 00 00    movl   $0x0,-0x4(%rbp)\n  59:   83 45 fc 01             addl   $0x1,-0x4(%rbp)\n</code></pre></li>\n<li><p><code>uint32_t</code>:</p>\n\n<pre><code>  64:   c7 45 fc 00 00 00 00    movl   $0x0,-0x4(%rbp)\n  6b:   83 45 fc 01             addl   $0x1,-0x4(%rbp)\n</code></pre></li>\n<li><p><code>int64_t</code>:</p>\n\n<pre><code>  76:   48 c7 45 f8 00 00 00    movq   $0x0,-0x8(%rbp)\n  7d:   00 \n  7e:   48 83 45 f8 01          addq   $0x1,-0x8(%rbp)\n</code></pre></li>\n<li><p><code>uint64_t</code>:</p>\n\n<pre><code>  8a:   48 c7 45 f8 00 00 00    movq   $0x0,-0x8(%rbp)\n  91:   00 \n  92:   48 83 45 f8 01          addq   $0x1,-0x8(%rbp)\n</code></pre></li>\n</ul>\n\n<p>Comparing the signed with the unsigned versions I would have expected from Mr.\nCarruth's talk that extra masking instructions are generated.</p>\n\n<p>But for <code>int8_t</code> we load a byte (<code>movb</code>) into <code>%rbp</code>, then load and zero-pad it\nto a long (<code>movzbl</code>) into the accumulator <code>%eax</code>. The addition (<code>add</code>) is\nperformed without any size specification because the overflow is not defined\nanyway. The unsigned version directly uses instructions for bytes.</p>\n\n<p>Either both <code>add</code> and <code>addb</code>/<code>addw</code>/<code>addl</code>/<code>addq</code> take the same number of\ncycles (latency) because the Intel Sandy Bridge CPU has hardware adders for all\nsizes or the 32-bit unit does the masking internally and therefore has a longer\nlatency.</p>\n\n<p>I have looked for a table with latencies and found the <a href=\"http://www.agner.org/optimize/instruction_tables.pdf\" rel=\"nofollow noreferrer\">one by\nagner.org</a>. There for\neach CPU (using Sandy Bridge here) there is only one entry for <code>ADD</code> but I do\nnot see entries for the other width variants. The <a href=\"https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf\" rel=\"nofollow noreferrer\">Intel 64 and IA-32 Architectures Optimization Reference Manual</a> also seems to list only a single <code>add</code> instruction.</p>\n\n<p>Does this mean that on x86 the <code>++i</code> of non-native length integers is actually\nfaster for unsigned types because there are less instructions?</p>\n"}, {"tags": ["c++", "pointers", "linked-list"], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523475749, "post_id": 49782556, "comment_id": 86581813, "body": "This won&#39;t satisfy the requirements given: &quot;<i>remove a card from the front of the linked_list, and return the card</i>&quot;.  If you just <code>return</code> the dereferenced pointer, you aren&#39;t removing the <code>card</code> from the list.  If you remove the <code>card</code> from the list, you still have to destroy it, so you can&#39;t dereference it and destroy it at the same time. You would have to make a <i>copy</i> of the <code>card</code>, destroy the <code>card</code> in the list, and then <code>return</code> the copy."}], "tags": [], "owner": {"reputation": 11522, "user_id": 120753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8mz8N.jpg?s=128&g=1", "display_name": "Babak Naffas", "link": "https://stackoverflow.com/users/120753/babak-naffas"}, "is_accepted": false, "score": 0, "last_activity_date": 1523472904, "creation_date": 1523472904, "answer_id": 49782556, "question_id": 49782513, "link": "https://stackoverflow.com/questions/49782513/how-to-add-and-return-a-node-in-front-of-the-linked-list/49782556#49782556", "title": "How to add and return a node in front of the linked list", "body": "<p>If you have the pointer variable, you can get the actual value referenced by the pointer dereferencing the pointer.</p>\n\n<p>try <code>return *start;</code></p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1523477030, "last_edit_date": 1523477030, "creation_date": 1523474651, "answer_id": 49783014, "question_id": 49782513, "link": "https://stackoverflow.com/questions/49782513/how-to-add-and-return-a-node-in-front-of-the-linked-list/49783014#49783014", "title": "How to add and return a node in front of the linked list", "body": "<p>Your <code>add()</code> looks fine, but your <code>deal()</code> is all wrong. It should look more like this instead:</p>\n\n<pre><code>card collection::deal()\n{\n    if (!start) throw std::runtime_error(\"deck is empty!\");\n    card *temp = start;\n    start = temp-&gt;next;\n    card theCard = *temp;\n    c.next = nullptr;\n    delete temp;\n    return theCard;\n}\n</code></pre>\n\n<p>You can simplify the code a bit by using some more creative coding, eg:</p>\n\n<pre><code>class card\n{\npublic:\n    int number;\n    int suit;\n    card * next;\n\n    static int uniquenumber;\n\n    card();\n    card(const card &amp;src, card *n = nullptr);\n    card&amp; operator=(const card &amp;rhs);\n\n    void showcard();\n};\n</code></pre>\n\n<p></p>\n\n<pre><code>#include &lt;memory&gt;\n\ncard::card()\n    : number(0), suit(0), next(nullptr)\n{\n}\n\ncard::card(const card &amp;src, card *n)\n    : number(src.number), suit(src.suit), next(n)\n{\n}\n\ncard&amp; card::operator=(const card &amp;rhs)\n{\n    if (&amp;rhs != this)\n    {\n        number = rhs.number;\n        suit = rhs.suit;\n        // don't copy 'next'!\n        next = nullptr;\n    }\n    return *this;\n}\n\nvoid collection::add(const card &amp;a)\n{\n    start = new card(a, start);\n}\n\ncard collection::deal()\n{\n    if (!start) throw std::runtime_error(\"deck is empty!\");\n    std::unique_ptr&lt;card&gt; temp(start);\n    start = start-&gt;next;\n    return *temp;\n}\n</code></pre>\n\n<p>But, that being said, from a design perspective, <code>card</code> really should not have a <code>next</code> member at all.  You should separate <code>card</code> from the implementation of the linked list (which would, in turn, allow you to change the implementation of the list at a later time without having to change <code>card</code> to match).  You want a list that <em>contains</em> card objects, not a list that <em>is</em> card objects.</p>\n\n<p>You should use <code>std::list</code> for that separation, eg:</p>\n\n<pre><code>#include &lt;list&gt;\n\nclass card\n{\npublic:\n    int number;\n    int suit;\n\n    static int uniquenumber;\n\n    card();\n    void showcard();\n};\n\nclass collection\n{\nprivate:\n    std::list&lt;card&gt; cards;\n\npublic:\n    void add(const card &amp;a);\n    card deal();\n};\n</code></pre>\n\n<p></p>\n\n<pre><code>void collection::add(const card &amp;a)\n{\n    cards.push_front(a);\n}\n\ncard collection::deal()\n{\n    if (cards.empty()) throw std::runtime_error(\"deck is empty!\");\n    card theCard = cards.front();\n    cards.pop_front();\n    return theCard;\n}\n</code></pre>\n\n<p>But, if you can't use <code>std::list</code>, then you can use something more like this:</p>\n\n<pre><code>class card\n{\npublic:\n    int number;\n    int suit;\n\n    static int uniquenumber;\n\n    card();\n    void showcard();\n};\n\nclass collection\n{\nprivate:\n    struct collectionItem\n    {\n        card theCard;\n        collectionItem *next;\n\n        collectionItem(const card &amp;a, collectionItem *n);\n    };\n\n    collectionItem *start;\n\npublic:\n    collection();\n    ~collection();\n\n    void add(const card &amp;a);\n    card deal();\n};\n</code></pre>\n\n<p></p>\n\n<pre><code>#include &lt;memory&gt;\n\ncollection::collection()\n    : start(nullptr)\n{\n}\n\ncollection::collectionItem::collectionItem(const card &amp;a, collectionItem *n)\n    : theCard(a), next(n)\n{\n}\n\ncollection::~collection()\n{\n    collectionItem *item = start;\n    while (item)\n        item = std::unique_ptr&lt;collectionItem&gt;(item)-&gt;next;\n}\n\nvoid collection::add(const card &amp;a)\n{\n    start = new collectionItem(a, start);\n}\n\ncard collection::deal()\n{\n    if (!start) throw std::runtime_error(\"deck is empty!\");\n    std::unique_ptr&lt;collectionItem&gt; temp(start);\n    start = temp-&gt;next;\n    return temp-&gt;theCard;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1523478412, "post_id": 49783231, "comment_id": 86583267, "body": "In the first rewrite of <code>add()</code>, why do you pass argument by non-const ref?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1523479427, "post_id": 49783231, "comment_id": 86583737, "body": "Thanks for the fix, Remy.  @bipll I didn&#39;t want to open up another can of worms explaining the whys and hows of something tangential. I felt like I already had too much going on, so I just left a comment with a key term an asker could look up if they were interested."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1523479773, "post_id": 49783231, "comment_id": 86583895, "body": "And on second thought, you&#39;re right @bipll . The explanation can go either way, so it&#39;s probably better that I use <code>const</code> and recommend they look up why on their own."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 2, "last_activity_date": 1523479716, "last_edit_date": 1523479716, "creation_date": 1523475601, "answer_id": 49783231, "question_id": 49782513, "link": "https://stackoverflow.com/questions/49782513/how-to-add-and-return-a-node-in-front-of-the-linked-list/49783231#49783231", "title": "How to add and return a node in front of the linked list", "body": "<h1>Adding</h1>\n\n<p>Time for a walk-through:</p>\n\n<pre><code>void collection::add(card a) // pass by value. a is a copy \n{\n    card *temp = new card(a); // makes a dynamically allocated copy of the copy.\n    temp-&gt;next = start; // looks right\n    start = temp; // looks right\n}\n</code></pre>\n\n<p>There is nothing explicitly wrong in this function, but if you want</p>\n\n<pre><code>myCollection.add(mycard);\n</code></pre>\n\n<p>and then expect to use <code>mycard</code> as though it is in <code>myCollection</code>, you are out of luck. A copy of <code>mycard</code> is in <code>mycollection</code>. We can make slight improvements to reduce the amount of copying, </p>\n\n<pre><code>void collection::add(const card &amp; a) // pass by reference. a is the source. One less copy\n                                     // Look up const correctness for more information \n                                     // on the use of const here \n{\n    card *temp = new card(a); // makes a dynamically allocated copy of the copy.\n    temp-&gt;next = start; \n    start = temp;\n}\n</code></pre>\n\n<p>but if you want <code>mycard</code> to be in the list rather than a copty of it, you need to do things very differently</p>\n\n<pre><code>void collection::add(card * a) // pass by reference via a pointer\n{\n    a-&gt;next = start;\n    start = a;\n}\n</code></pre>\n\n<p>and use it something like:</p>\n\n<pre><code>card * mycard = new card()\n// set members of *mycard. Or better, make a smarter constructor to set them for you\nmyCollection.add(mycard);\n</code></pre>\n\n<h1>Removal</h1>\n\n<pre><code>card collection::deal(){\n    card *temp = start-&gt;next; //temp points to the second item on the list\n    start-&gt;next = nullptr; // cur off start from the rest of the list\n    start = temp; // whups! Just lost the first item in the list\n    return start; // start is a pointer. The return type is not. Need to dereference\n}\n</code></pre>\n\n<p>Fix one: deference the pointer to return it. </p>\n\n<pre><code>card collection::deal(){\n    card *temp = start-&gt;next; \n    start-&gt;next = nullptr; \n    start = temp; \n    return *start; // returns a copy of the second card in the list\n}\n</code></pre>\n\n<p>Next fix: return the correct card</p>\n\n<pre><code>card collection::deal(){\n    card *temp = start; //temp points to the first item on the list\n    start = start-&gt;next; // advance start to second item on the list\n    temp-&gt;next = nullptr; // cut former first item off from from the list\n    return *temp; // returns a copy of the former first item. But what of temp?\n}\n</code></pre>\n\n<p>Next fix: <code>temp</code> was leaked. No one points to it and the memory was never freed.</p>\n\n<pre><code>card collection::deal(){\n    card *temp = start; \n    start = start-&gt;next; \n    temp-&gt;next = nullptr; \n    card rval(*temp); // copy former first node\n    delete temp; // free former first node\n    return rval; // return copy.\n}\n</code></pre>\n\n<p>You could also return a pointer to the item removed and leave freeing it to the caller. This is a bit dodgy.</p>\n\n<pre><code>card * collection::deal(){\n    card *temp = start; //temp points to the first item on the list\n    start = start-&gt;next; // advance start to second item on the list\n    temp-&gt;next = nullptr; // cut former first item off from from the list\n    return temp; // returns former first item \n}\n</code></pre>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\">Look into <code>std::unique_ptr</code></a> as a tool to ensure that returned <code>card</code> pointers are released by the caller.</p>\n\n<p>Another possibility is to separate the linked list from the <code>card</code> This way <code>collection</code>'s users only see <code>card</code>s and have no clue how the <code>card</code>s are stored inside <code>collection</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 6785651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--x_OlRVxw4s/AAAAAAAAAAI/AAAAAAAAA_M/BATnYLTNJQA/photo.jpg?sz=128", "display_name": "Jay C", "link": "https://stackoverflow.com/users/6785651/jay-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 49783231, "answer_count": 3, "score": 0, "last_activity_date": 1523479716, "creation_date": 1523472743, "last_edit_date": 1523472918, "question_id": 49782513, "link": "https://stackoverflow.com/questions/49782513/how-to-add-and-return-a-node-in-front-of-the-linked-list", "title": "How to add and return a node in front of the linked list", "body": "<p>While I'm using linked_list to make a small game. I have a class call card</p>\n\n<pre><code>class card\n{\npublic:\n    int number;\n    int suit;\n    static int uniquenumber;\n    card();\n    void showcard();\n    card * next;\n};\n</code></pre>\n\n<p>Then for the following linked_list structure, I want to add the card to the front of the linked_list.</p>\n\n<pre><code>void collection::add(card a)\n{\n    card *temp = new card(a);\n    temp-&gt;next = start;\n    start = temp;\n}\n</code></pre>\n\n<p>But I can't get the result I want. Also, there have another function need to remove a card from the front of the linked_list, and return the card. I have no idea how to return a node from linked_list.</p>\n\n<pre><code>card collection::deal(){\ncard *temp = start-&gt;next;\nstart-&gt;next = nullptr;\nstart = temp;\nreturn start;\n}\n</code></pre>\n\n<p>This way will just return me an error saying \"can't convert \"card *\" to \"card\" \"</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1523472436, "post_id": 49782406, "comment_id": 86580090, "body": "What is the question?  You already have the solution"}, {"owner": {"reputation": 31, "user_id": 6658255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37255c931fd0bdd78ac3e0dc6009c57?s=128&d=identicon&r=PG&f=1", "display_name": "Agent007", "link": "https://stackoverflow.com/users/6658255/agent007"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523472553, "post_id": 49782406, "comment_id": 86580161, "body": "int shelf::count_instances =0; Shouldn&#39;t this access be disallowed?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1523472556, "post_id": 49782406, "comment_id": 86580163, "body": "<i>&quot;Can someone help me understand?&quot;</i>  That&#39;s too broad a question.  Can you ask specifically about what you do not understand?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1523472608, "post_id": 49782406, "comment_id": 86580194, "body": "The first is the declaration that the variable will exist ... the second creates a version of it.  That&#39;s just what the syntax is."}, {"owner": {"reputation": 31, "user_id": 6658255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37255c931fd0bdd78ac3e0dc6009c57?s=128&d=identicon&r=PG&f=1", "display_name": "Agent007", "link": "https://stackoverflow.com/users/6658255/agent007"}, "edited": false, "score": 0, "creation_date": 1523472690, "post_id": 49782406, "comment_id": 86580252, "body": "oh, So the static private members can be accessed from outside the class?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1523472695, "post_id": 49782406, "comment_id": 86580255, "body": "You&#39;ve got it 100% right, there&#39;s nothing else to &quot;understand&quot; here :-) Make sure <code>int shelf::count_instances =0;</code> definition is in a CPP file, not in the header."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1523472737, "post_id": 49782406, "comment_id": 86580272, "body": "@Agent007 You are not accessing private member outside the class, you are providing its definition outside class header, as required by the standard."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1523472749, "post_id": 49782406, "comment_id": 86580279, "body": "As for counting instances of the class, your attempt fails to count copy-initialized instances."}, {"owner": {"reputation": 31, "user_id": 6658255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37255c931fd0bdd78ac3e0dc6009c57?s=128&d=identicon&r=PG&f=1", "display_name": "Agent007", "link": "https://stackoverflow.com/users/6658255/agent007"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1523472903, "post_id": 49782406, "comment_id": 86580347, "body": "@dasblinkenlight , That makes sense. Thanks!"}], "owner": {"reputation": 31, "user_id": 6658255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37255c931fd0bdd78ac3e0dc6009c57?s=128&d=identicon&r=PG&f=1", "display_name": "Agent007", "link": "https://stackoverflow.com/users/6658255/agent007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1523472588, "answer_count": 0, "score": 0, "last_activity_date": 1523472367, "creation_date": 1523472334, "last_edit_date": 1523472367, "question_id": 49782406, "link": "https://stackoverflow.com/questions/49782406/counting-number-of-class-instances-using-private-static-integer-variable-in-c", "closed_reason": "Duplicate", "title": "Counting number of Class Instances using &quot;private static integer variable&quot; in c++", "body": "<p>I tried to count the number of instances of a class using :</p>\n\n<pre><code>class shelf\n{\nprivate:\n    static int count_instances = 0 ;\n    book b1;\npublic :\nshelf() {\n    count_instances++;\n    cout &lt;&lt; \"this is the \"&lt;&lt;count_instances&lt;&lt;\" instance\"&lt;&lt;endl;\n}\n};\nmain (){\nshelf s1;\n}\n</code></pre>\n\n<p>but get the compilation error :\nISO c++ forbids in-class initialization of non-const static member. </p>\n\n<p>While the following arrangement seems to work</p>\n\n<pre><code>class shelf\n{\nprivate:\n    static int count_instances ;\n    book b1;\npublic :\nshelf() {\n    count_instances++;\n    cout &lt;&lt; \"this is the \"&lt;&lt;count_instances&lt;&lt;\" instance\"&lt;&lt;endl;\n}\n};\nint shelf::count_instances =0;\n\nmain (){\nshelf s1;\n}\n</code></pre>\n\n<p>Can someone help me understand? Also what is the right way to count the number of instances of a class</p>\n"}, {"tags": ["c++", "bash", "shell"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523472395, "post_id": 49782379, "comment_id": 86580058, "body": "I really don&#39;t see how C++ applies here unless you want to write a C++ program to do this."}, {"owner": {"reputation": 63, "user_id": 7985466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KMwGsSeCaEw/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclm8wnUIov6uGZxj2YlzLDgF_0TWA/photo.jpg?sz=128", "display_name": "\uc774\ud55c\ube48", "link": "https://stackoverflow.com/users/7985466/%ec%9d%b4%ed%95%9c%eb%b9%88"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523472763, "post_id": 49782379, "comment_id": 86580288, "body": "C: \\ Users \\ gksql \\ Desktop \\ PlateRec&gt;      PlateRecog_saveDigits_Location someimage1.jpg     C: \\ Users \\ gksql \\ Desktop \\ PlateRec&gt;      PlateRecog_saveDigits_Location someimage2.jpg     C: \\ Users \\ gksql \\ Desktop \\ PlateRec&gt;      PlateRecog_saveDigits_Location someimage3.jpg     C: \\ Users \\ gksql \\ Desktop \\ PlateRec&gt;      PlateRecog_saveDigits_Location someimage4.jpg  Someimage1, 2, 3, and 4 are all in one file. I&#39;ve heard that I can run it repeatedly using a dat file. Do I need the internal structure of the PlateRecog_saveDigits_Location file to run it repeatedly?"}], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 2780529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/djKtZ.png?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/2780529/jeremy"}, "is_accepted": true, "score": 0, "last_activity_date": 1523473692, "creation_date": 1523473692, "answer_id": 49782761, "question_id": 49782379, "link": "https://stackoverflow.com/questions/49782379/how-to-iterate-over-an-exe-file-that-takes-arguments-in-cmd/49782761#49782761", "title": "How to iterate over an exe file that takes arguments in cmd", "body": "<p>Post is tagged c++, bash, shell...</p>\n\n<p>looks like you want to loop through a list of files, calling the same executable if i understand correctly.  Here are some good posts to get you going.</p>\n\n<p><strong>Loop through files in directory c++:</strong>\n<a href=\"https://stackoverflow.com/questions/67273/how-do-you-iterate-through-every-file-directory-recursively-in-standard-c\">How do you iterate through every file/directory recursively in standard C++?</a></p>\n\n<p><strong>Launching an executable from within a c++ project:</strong>\n<a href=\"https://stackoverflow.com/questions/15435994/how-do-i-open-an-exe-from-another-c-exe\">How do I open an .exe from another C++ .exe?</a></p>\n\n<p><strong>Iterating through files in directory (bash):</strong>\n<a href=\"https://stackoverflow.com/questions/20796200/how-to-iterate-over-files-in-a-directory-with-bash\">How to iterate over files in a directory with Bash?</a></p>\n\n<p><strong>Iterating through files in directory (<em>power</em>shell):</strong>\n<a href=\"https://stackoverflow.com/questions/18847145/loop-through-files-in-a-directory-using-powershell\">Loop through files in a directory using PowerShell</a></p>\n"}], "owner": {"reputation": 63, "user_id": 7985466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KMwGsSeCaEw/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclm8wnUIov6uGZxj2YlzLDgF_0TWA/photo.jpg?sz=128", "display_name": "\uc774\ud55c\ube48", "link": "https://stackoverflow.com/users/7985466/%ec%9d%b4%ed%95%9c%eb%b9%88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 49782761, "answer_count": 1, "score": 0, "last_activity_date": 1523473692, "creation_date": 1523472265, "question_id": 49782379, "link": "https://stackoverflow.com/questions/49782379/how-to-iterate-over-an-exe-file-that-takes-arguments-in-cmd", "title": "How to iterate over an exe file that takes arguments in cmd", "body": "<p>There is a program that accepts images containing license plates as arguments.\nThis program extracts only the license plate itself, letter and number image from the image received as an argument.\nHow to use this program is as follows.</p>\n\n<pre><code>C:\\Users\\gksql\\Desktop\\PlateRec&gt;PlateRecog_saveDigits_Location someimage.jpg\n</code></pre>\n\n<p>This will create one image_Plate.jpg file that contains the license plate itself and several image_Digits_ (number) .jpg files that contain numbers or characters.\nThe problem is that the execution command itself is quite long, and there are at least a few thousand images.\nThat's why I want to run this PlateRecog_saveDigits_Location.exe file for all images containing license plates in any folder.\nAs a matter of fact, I can not change the source of the PlateRecog_saveDigits_Location file at this time.\nI want to know how to iterate through all the images in a window.</p>\n\n<p>Thank you for your wisdom.</p>\n"}, {"tags": ["c++", "algorithm", "numerical-methods"], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523472285, "post_id": 49782361, "comment_id": 86580012, "body": "Surprised that something like that wouldn&#39;t throw a warning."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523472374, "post_id": 49782361, "comment_id": 86580046, "body": "@MichaelDorgan indeed!  I couldn&#39;t compile the code due to a <code>static_assert</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523472421, "post_id": 49782361, "comment_id": 86580080, "body": "@MichaelDorgan it is not easy for compiler to issue a warning here. It is just a standard library template, and compiler will not have specific knowledge about it&#39;s limitations. Standard itself should have mandated <code>static_assert</code> on <code>is_integral</code> for the argument, but alas, it did not. I consider it a defect."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523472464, "post_id": 49782361, "comment_id": 86580110, "body": "Fair enough.  You&#39;ve got the real distribution as an alternative so good on you.  Overloading the real types to CT would be nice of the library people though."}], "tags": [], "owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "is_accepted": true, "score": 4, "last_activity_date": 1523472676, "last_edit_date": 1523472676, "creation_date": 1523472206, "answer_id": 49782361, "question_id": 49782284, "link": "https://stackoverflow.com/questions/49782284/imprecision-in-approximating-pi-using-monte-carlo-method/49782361#49782361", "title": "Imprecision in Approximating Pi using Monte Carlo Method", "body": "<p>The effect of <a href=\"http://en.cppreference.com/w/cpp/numeric/random/uniform_int_distribution\" rel=\"nofollow noreferrer\"><code>std::uniform_int_distribution&lt;double&gt;</code></a> is <strong>undefined behavior</strong>, because <code>double</code> is not an integer type.</p>\n\n<p>Change it to <a href=\"http://en.cppreference.com/w/cpp/numeric/random/uniform_real_distribution\" rel=\"nofollow noreferrer\"><code>std::uniform_real_distribution&lt;double&gt;</code></a>.</p>\n"}], "owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 49782361, "answer_count": 1, "score": 1, "last_activity_date": 1523474549, "creation_date": 1523471926, "last_edit_date": 1523474549, "question_id": 49782284, "link": "https://stackoverflow.com/questions/49782284/imprecision-in-approximating-pi-using-monte-carlo-method", "title": "Imprecision in Approximating Pi using Monte Carlo Method", "body": "<p>Area of the circle = Pi * R^2 and the Area of the square = 4 * R^2.\n             If we divide the area of the circle by the area of the square we get Pi / 4.</p>\n\n<p>Let's have a square and an inscribed circle in it. We generate points with random coordinates and then count their number in each of the areas.<br> \nThen Pi = 4 * (# points in Circle) / (# points in Square).</p>\n\n<p>Here is an attempt at approximating Pi with the above method: </p>\n\n<pre><code>#include &lt;iostream&gt;     /* std::cout */\n#include &lt;iomanip&gt;      /* std::setprecision */\n#include &lt;random&gt;       /* std::uniform_int_distribution; std::mt19937 */\n\n/* Check if point (x,y) is inside a circle with radius: r, at O(0,0). */\nbool isInside (double x, double y, double r) { return (x*x + y*y) &lt;= r*r; }\n\ndouble approximatePi (double s, int sample_size)\n{\n    std::mt19937 gen;                   /* Generate random number in [-s/2 : s/2]. */\n    std::uniform_int_distribution&lt;double&gt; dis(-s/2, s/2);\n\n    int count = 0;                      /* Number of points in the circle. */ \n    for (int i = 0; i &lt; sample_size; ++i)\n    {\n        double x = dis(gen); \n        double y = dis(gen);\n\n        if (isInside(x, y, s/2))        /* Radius of inscribed circle = side / 2. */\n        {\n            ++count;\n        }\n    }\n    /* Pi = 4 * (# points in Circle) / (# points in Square). */\n    return (double) 4 * count / sample_size;    \n}\n\nint main()\n{\n    double side = 10.0;                 /* Square side. */\n    int sample_size = 10000;            /* Number of tries. */\n\n    std::cout &lt;&lt;\"Pi ~ \"&lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; approximatePi(side, sample_size) &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Expected result: <code>Pi ~ 3.141592</code></p>\n\n<p>Actual result: <code>Pi ~ 2.611200</code></p>\n\n<p>Why am I not getting the expected result? What am I doing wrong? </p>\n"}, {"tags": ["c++", "algorithm", "performance"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1523471999, "post_id": 49782279, "comment_id": 86579858, "body": "FWIW, the overloads that took an in have been removed from C++ since C++11"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1523472050, "post_id": 49782279, "comment_id": 86579883, "body": "Honestly, look at assembly and see.  integer power should easily translate into vectorization.  Benchmark it."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 4, "creation_date": 1523472057, "post_id": 49782279, "comment_id": 86579889, "body": "&quot;how much faster&quot; is really hard to answer without the dataset and/or platform you wish to perform the operations on. In other words, you&#39;d need to benchmark it"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 7, "creation_date": 1523472251, "post_id": 49782279, "comment_id": 86579995, "body": "About 42 faster."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1523472285, "post_id": 49782279, "comment_id": 86580011, "body": "It can be.  The C++ library implementation that I use overloads it to a trivial for-loop that uses multiply-shift.  YMMV."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 4, "creation_date": 1523472432, "post_id": 49782279, "comment_id": 86580088, "body": "If you want to know which is faster, <i>measure it yourself</i>. <a href=\"https://ericlippert.com/2012/12/17/performance-rant/\" rel=\"nofollow noreferrer\">ericlippert.com/2012/12/17/performance-rant</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1523473218, "post_id": 49782279, "comment_id": 86580507, "body": "not sure what this question is aiming for, but with integer powers you can play funny tricks like <code>x^n = (x^n&#47;2 * x^n&#47;2)</code> for even <code>n</code> (and similar for odds) so you basically can reduce the number of multiplications required to something around log2(n). Not sure if there is anything similar for double powers. Anyhow afaik <code>pow</code> never was really meant to be used with integers"}, {"owner": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "edited": false, "score": 0, "creation_date": 1523473230, "post_id": 49782279, "comment_id": 86580511, "body": "For large exponents I would expect the same, for small ones the <code>int</code> one might be faster. Hard to know for sure, since <code>pow</code> is actually tricky to implement maintaining the precision and libraries have probably very different implementations."}, {"owner": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1523473803, "post_id": 49782279, "comment_id": 86580792, "body": "@user463035818. This operation cannot be used in general on <code>double</code>s, but library might use it in easy cases (for example, when exponent is small integer) to give fast response. In general the formula <code>a**b = exp(log(a)*b)</code> would be used."}], "answers": [{"comments": [{"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1523477405, "post_id": 49782963, "comment_id": 86582750, "body": "<a href=\"http://en.cppreference.com/w/cpp/numeric/math/pow\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/numeric/math/pow</a> (7) Since C++11, <i>&quot;If any argument has integral type, it is cast to double&quot;</i>."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1523477951, "post_id": 49782963, "comment_id": 86583014, "body": "@Bob__: I&#39;m certain that&#39;s a result equivalency not the actual implementation."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1523478334, "post_id": 49782963, "comment_id": 86583216, "body": "My interpretation (I may be wrong and library implementers may disagree) of that statement is that until C++11, they may have had different implementations, but since C++11, they should share the same, while the parameters are simply casted."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": -2, "last_activity_date": 1523474422, "creation_date": 1523474422, "answer_id": 49782963, "question_id": 49782279, "link": "https://stackoverflow.com/questions/49782279/is-stdpowdouble-int-faster-than-stdpowdouble-double-if-yes-how-m/49782963#49782963", "title": "Is `std::pow(double, int)` faster than `std::pow(double, double)`? if yes, how much faster?", "body": "<p>Expectation:</p>\n\n<p>std::pow(double, int) is the log-reducing for loop for log(n) runtime.</p>\n\n<p>std::pow(double x, double y) { exp(log(x) * y); }</p>\n\n<p>Should be pretty close.</p>\n"}], "owner": {"reputation": 15365, "user_id": 52074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd14249e07e1f1d6a949bffa569377ad?s=128&d=identicon&r=PG", "display_name": "Trevor Boyd Smith", "link": "https://stackoverflow.com/users/52074/trevor-boyd-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523474422, "creation_date": 1523471917, "question_id": 49782279, "link": "https://stackoverflow.com/questions/49782279/is-stdpowdouble-int-faster-than-stdpowdouble-double-if-yes-how-m", "title": "Is `std::pow(double, int)` faster than `std::pow(double, double)`? if yes, how much faster?", "body": "<p>I saw this old question about <code>std::pow</code>: <a href=\"https://stackoverflow.com/questions/2940367/what-is-more-efficient-using-pow-to-square-or-just-multiply-it-with-itself\">What is more efficient? Using pow to square or just multiply it with itself?</a></p>\n\n<p>The old question mentions <code>std::pow</code> has a variant that is <code>std::pow(double, int)</code> and some users said this version might be faster.</p>\n\n<p>Is <code>std::pow(double, int)</code> faster than <code>std::pow(double, double)</code>? if yes, how much faster?</p>\n\n<p>p.s. standard boilerplate disclaimer about \"I already know that premature optimization is evil, but I'm asking this optimization question for academic purposes or I've already identified that line/block of code as a bottleneck\"</p>\n"}, {"tags": ["c++", "batch-file", "compilation"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": -1, "last_activity_date": 1523471554, "creation_date": 1523471554, "answer_id": 49782193, "question_id": 49782131, "link": "https://stackoverflow.com/questions/49782131/is-it-possible-to-compile-c-with-batch-script-using-dev-console/49782193#49782193", "title": "Is it possible to compile c++ with batch script using dev console?", "body": "<p>Sure. It's <em>possible</em>. But in the long run you'll probably be a lot happier by using a <em>proper</em> build system, such as <a href=\"http://scons.org\" rel=\"nofollow noreferrer\">scons</a>, <a href=\"https://cmake.org\" rel=\"nofollow noreferrer\">cmake</a>/<a href=\"https://ninja-build.org\" rel=\"nofollow noreferrer\">ninja</a> or similar.</p>\n"}, {"tags": [], "owner": {"reputation": 118713, "user_id": 1012053, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDAXz.jpg?s=128&g=1", "display_name": "dbenham", "link": "https://stackoverflow.com/users/1012053/dbenham"}, "is_accepted": true, "score": 1, "last_activity_date": 1523480193, "last_edit_date": 1523480193, "creation_date": 1523479892, "answer_id": 49784262, "question_id": 49782131, "link": "https://stackoverflow.com/questions/49782131/is-it-possible-to-compile-c-with-batch-script-using-dev-console/49784262#49784262", "title": "Is it possible to compile c++ with batch script using dev console?", "body": "<p>You already have a batch script that is running within the console, so there is no need to use <code>%comspec% /k ...</code>, that just gets in the way.</p>\n\n<p>But you do need to use <code>call \"C:\\Program Files (x86)\\Microsoft Visual \nStudio\\2017\\Community\\VC\\Auxiliary\\Build\\vcvars64.bat\"</code> so that batch script can return to your batch script.</p>\n\n<p>You can then follow that command with <code>cl.exe test.cpp</code>, etc.</p>\n\n<p>Any time you want a batch script to execute another script and return, then you generally need the CALL command. (The other option is CMD /C, but that is normally not what you want)</p>\n\n<p>If you don't use CALL, then control is simply transferred to the new batch script, and it never returns.</p>\n"}], "owner": {"reputation": 41, "user_id": 9626434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cad0e63f22a3e7eae80e388b05404ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Joe", "link": "https://stackoverflow.com/users/9626434/jimmy-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 1, "accepted_answer_id": 49784262, "answer_count": 2, "score": 1, "last_activity_date": 1523480193, "creation_date": 1523471320, "question_id": 49782131, "link": "https://stackoverflow.com/questions/49782131/is-it-possible-to-compile-c-with-batch-script-using-dev-console", "title": "Is it possible to compile c++ with batch script using dev console?", "body": "<p>So what i want to do is have my bat file launch the dev console and compile my .cpp file</p>\n\n<pre><code>%comspec% /k \"C:\\Program Files (x86)\\Microsoft Visual \nStudio\\2017\\Community\\VC\\Auxiliary\\Build\\vcvars64.bat\"\n</code></pre>\n\n<p>this code launches the dev console but after this line i can't seem to add anything else to the bat file. For example if i were to type</p>\n\n<pre><code>cl test.cpp \n</code></pre>\n\n<p>under the line above the console does not compile my test.cpp but if i type it manually into the dev console it does compile it. So can i somehow make a batfile that launches the dev console and compiles my program?</p>\n\n<p>I'm using windows 10 and microsoft visual studio 2017</p>\n"}, {"tags": ["c++", "object", "vector", "iterator"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1523471314, "post_id": 49782090, "comment_id": 86579525, "body": "Your iterator is dangling. I think there&#39;s a duplicate somewhere..."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1523471332, "post_id": 49782090, "comment_id": 86579530, "body": "Trying to  find a dupe.  The issue is your getters return by value instead of by reference"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523471407, "post_id": 49782090, "comment_id": 86579575, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/23311165/iterator-got-by-applying-begin-on-getter-method-doesnt-allow-to-access-to-fir\" title=\"iterator got by applying begin on getter method doesnt allow to access to fir\">stackoverflow.com/questions/23311165/&hellip;</a>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1523471810, "post_id": 49782090, "comment_id": 86579750, "body": "You have the same issue with your previous question <a href=\"https://stackoverflow.com/questions/49762949/c-vectorerase-with-class-object-iterator-not-erasing-vector-member\">here</a>.  Do you understand what the implications are of returning a copy of an object and returning a reference to the existing object?  As I stated in the comments for that question, you are lucky your program didn&#39;t just crash due to using invalid iterators."}, {"owner": {"reputation": 133, "user_id": 8212645, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh5.googleusercontent.com/-4wgqbtCl2Wg/AAAAAAAAAAI/AAAAAAAAAJI/7jGEENDE2Qg/photo.jpg?sz=128", "display_name": "Stephen Burns", "link": "https://stackoverflow.com/users/8212645/stephen-burns"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1523472347, "post_id": 49782090, "comment_id": 86580036, "body": "@PaulMcKenzie would a valid fix be changing the function to `*vector&lt;Message&gt; getMessages() {Message * theseMessages = &amp;messages; return *theseMessages;}"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1523472424, "post_id": 49782090, "comment_id": 86580082, "body": "Change the return type to return a reference.  Seems as if you&#39;re still not quite understanding why you are getting the issue."}, {"owner": {"reputation": 133, "user_id": 8212645, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh5.googleusercontent.com/-4wgqbtCl2Wg/AAAAAAAAAAI/AAAAAAAAAJI/7jGEENDE2Qg/photo.jpg?sz=128", "display_name": "Stephen Burns", "link": "https://stackoverflow.com/users/8212645/stephen-burns"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1523472929, "post_id": 49782090, "comment_id": 86580362, "body": "@PaulMcKenzie I believe I get what you are saying, but I don&#39;t believe I understand the syntax. I think I need to create a pointer by calling that function and, rather than return a copy, just return the address. vector&lt;Message&gt;&amp; getMessages() {return messages;} Would this function?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1523472969, "post_id": 49782090, "comment_id": 86580385, "body": "There is no need for a pointer.  <a href=\"https://stackoverflow.com/questions/30041907/can-i-use-nested-loops-with-vectors-in-cpp/30042185#30042185\">See this answer</a>, as it describes exactly what the issue is with your code and the fix."}], "owner": {"reputation": 133, "user_id": 8212645, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh5.googleusercontent.com/-4wgqbtCl2Wg/AAAAAAAAAAI/AAAAAAAAAJI/7jGEENDE2Qg/photo.jpg?sz=128", "display_name": "Stephen Burns", "link": "https://stackoverflow.com/users/8212645/stephen-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523471163, "creation_date": 1523471163, "question_id": 49782090, "link": "https://stackoverflow.com/questions/49782090/c-iterator-showing-incorrect-values-but-directly-accessing-object-shows-corre", "title": "c++ iterator showing incorrect values, but directly accessing object shows correct values", "body": "<p>I'm trying to determine what's going wrong with my code, and I have absolutely no idea what the problem is. I have an iterator that is returning the incorrect values for the object in a vector, even though printing that object in GDB shows the correct fields. The code inside the loop is not relevant for this particular issue.\nThe three objects and functions I use in the below loop are </p>\n\n<pre><code>class User{\n  string password;\n  string username;\n\n  string getName() {return username}\n  string getPass() {return password}\n};\n\nclass Room{\n  vector&lt;User&gt; users;\n  vector&lt;Message&gt; messages;\n  string name;\n\n  vector&lt;User&gt; getUsers() {return users}\n  vector&lt;Message&gt; getMessages() {return messages}\n  string getName() {return name}\n};\n\nclass Message{\n  User sender;\n  string message;\n\n  User getSender() {return sender}\n  string getMessage() {return message}\n};\n</code></pre>\n\n<p>The code in my loop is</p>\n\n<pre><code>vector&lt;Room&gt;::iterator roomIt;\nvector&lt;Message&gt;::iterator messIt;\n\nfor(roomIt = rooms.begin(); roomIt &lt; rooms.end(); roomIt++) {\n  for (messIt = roomIt-&gt;getMessages().begin(); messIt &lt; roomIt-&gt;getMessages().end(); messIt++) {\n    .........\n  }\n}\n</code></pre>\n\n<p>In gdb, when I use <code>print roomIt-&gt;getMessages().begin()</code> I get </p>\n\n<pre><code>{sender = {password = \"robin\", username = \"batman\"}, message = \"hello\"}\n</code></pre>\n\n<p>However, when I use <code>print messIt</code> or <code>print *messIt</code> I get</p>\n\n<pre><code>{sender = {password = \"batman\", username = \"hello\"}, message = \"robin\"}\n</code></pre>\n\n<p>What could be causing this discrepancy? I'm completely lost as I can't see how printing the object is giving the correct output while setting messIt reference equal to that object alters the values. </p>\n"}, {"tags": ["c++", "caching", "mutex"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1523471095, "post_id": 49782011, "comment_id": 86579423, "body": "This question may be a better fit for <a href=\"https://codereview.stackexchange.com\">Code Review</a> with some small modifications"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1523519560, "post_id": 49782011, "comment_id": 86596535, "body": "Why does the <code>std::map</code> hold <code>std::weak_ptr</code> instead of <code>std::shared_ptr</code>? Seems to me that unless <code>load_widget()</code> returns a <code>std::shared_ptr</code>, there is potential here for the cached <code>std::weak_ptr</code>s to usually be null when the caller is done using the returned <code>std::shared_ptr</code>s. Not much of a good cache, now is it?"}, {"owner": {"reputation": 6556, "user_id": 874660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/45a7738c334183bff552bcf73c4dcd65?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/874660/ben"}, "edited": false, "score": 0, "creation_date": 1523537990, "post_id": 49782011, "comment_id": 86608859, "body": "If the <code>std::map</code> held <code>std::shared_ptr</code>s, then the refcount would never go to zero and so the objects would live forever. That&#39;s desirable behavior for some caches, but the idea here is that the cache is used so long as someone still has that entry to keep it alive. In the original implementation, you &quot;leak&quot; <code>std::weak_ptr</code>s in that they never get cleaned up. My change tries to fix that."}], "answers": [{"comments": [{"owner": {"reputation": 6556, "user_id": 874660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/45a7738c334183bff552bcf73c4dcd65?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/874660/ben"}, "edited": false, "score": 0, "creation_date": 1523491482, "post_id": 49784203, "comment_id": 86587529, "body": "Interesting. I really like your first part. That totally fixes the icky part of my solution, I think.  For the second part... interesting. It&#39;s kinda icky, but I think it&#39;s correct. It&#39;s icky in that you have two distinct <code>shared_ptr</code>s to the same object with their own reference counts, and you&#39;ve structured it such that instead of directly deleting the original copy, the &quot;outer&quot; <code>shared_ptr</code> does the <code>cache</code> bookkeeping. Interesting point that the same approach can be used with the <code>unique_ptr</code>."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1523482590, "last_edit_date": 1523482590, "creation_date": 1523479590, "answer_id": 49784203, "question_id": 49782011, "link": "https://stackoverflow.com/questions/49782011/herb-sutters-10-liner-with-cleanup/49784203#49784203", "title": "Herb Sutter&#39;s 10-liner with cleanup", "body": "<p>I believe there is a simpler way to guarantee that the deleter won't run while <code>hold</code> <em>holds the</em> lock: Declare <code>sp</code> before <code>hold</code>, so when we go out of scope, the mutex will be released before the deleter can run:</p>\n\n<pre><code>std::shared_ptr&lt;widget&gt; sp;\nstd::lock_guard&lt;std::mutex&gt; hold(m);\nauto&amp; weakCached = cache[id];\nsp = weakCached.lock();\n</code></pre>\n\n<p>It makes sense to reuse <code>weakCached</code> even without having to care about exception safety.</p>\n\n<hr>\n\n<blockquote>\n  <p>What if <code>load_widget(int id)</code> returns a <code>std::shared_ptr&lt;widget&gt;</code></p>\n</blockquote>\n\n<p>Here's an (wild?) idea:</p>\n\n<pre><code>std::shared_ptr&lt;widget&gt; it = load_widget(id);\nwidget* ptr = it.get();\nauto deleter = [&amp;,id,original=std::move(it)](widget*) {\n    std::lock_guard&lt;std::mutex&gt; hold(m);\n    cache.erase(id);\n};\nweakCached = sp = std::shared_ptr&lt;widget&gt;(ptr, std::move(deleter));\n</code></pre>\n\n<p>We keep a copy of the result from <code>load_widget</code> in the deleter. This causes our shared pointer to keep the original shared pointer alive. When our refcount is exhausted, our custom deleter doesn't do anything to the widget directly. The deleter is simply destroyed, and so the captured shared pointer is destroyed, and if it is the only owner, then the original custom deleter does its job.</p>\n\n<p>This approach has a caveat: If a copy of the original shared pointer is somehow available elsewhere, then its lifetime may be extended beyond the lifetime of our shared pointer, and so the cache may be purged prematurely. Whether this is the case, and whether this is a problem depend on the widget API in question.</p>\n\n<p>This approach can be used with your unique pointer case as well.</p>\n"}], "owner": {"reputation": 6556, "user_id": 874660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/45a7738c334183bff552bcf73c4dcd65?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/874660/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 3, "accepted_answer_id": 49784203, "answer_count": 1, "score": 3, "last_activity_date": 1523482590, "creation_date": 1523470857, "question_id": 49782011, "link": "https://stackoverflow.com/questions/49782011/herb-sutters-10-liner-with-cleanup", "title": "Herb Sutter&#39;s 10-liner with cleanup", "body": "<p>I've been adding data caching to my code and remembered \"Herb Sutter's favorite 10-liner.\":</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>shared_ptr&lt;widget&gt; get_widget(int id) {\n    static map&lt;int, weak_ptr&lt;widget&gt;&gt; cache;\n    static mutex m;\n\n    lock_guard&lt;mutex&gt; hold(m);\n    auto sp = cache[id].lock();\n    if (!sp) cache[id] = sp = load_widget(id);\n    return sp;\n}\n</code></pre>\n\n<p>The one criticism I've seen of this is that, depending on context, it may be a problem that nothing is ever removed from the cache.</p>\n\n<p>I was surprised I couldn't find the clean-up-after-itself solution anywhere. What do you think of this?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::shared_ptr&lt;widget&gt; get_widget(int id) {\n    static std::map&lt;int, std::weak_ptr&lt;widget&gt;&gt; cache;\n    static std::mutex m;\n\n    std::lock_guard&lt;std::mutex&gt; hold(m);\n    auto&amp; weakCached = cache[id]; // Keep a reference so we don't hae to call this non-nothrow function below.\n    auto sp = weakCached.lock();\n    if (!sp) {\n        std::unique_ptr&lt;widget&gt; it = load_widget(id);\n        // We have to be careful about the deleter not being\n        // called while in the mutex lock 'cause that'd be a \n        // double lock =&gt; deadlock.\n        // For that reason, we already have a \n        auto deleter = [&amp;,id,d=it.get_deleter()](widget* w) {\n            std::lock_guard&lt;std::mutex&gt; hold(m);\n            d(w);\n            cache.erase(id);\n        };\n        sp = std::shared_ptr&lt;widget&gt;(it.get(), deleter);\n        it.release(); // In the case that the above line throws, we won't hit this line and so won't leak.\n        weakCached = sp;\n    }\n    return sp;\n}\n</code></pre>\n\n<p>As the comment says, the part that gives me pause is the transfer of ownership to the <code>deleter</code> function. In particular, the fact that calling it locks the mutex, so it can't be called while the mutex is locked. I think this correctly guarantees that it won't be called inside the critical section, particularly because if <code>sp = std::shared_ptr&lt;widget&gt;(it.get(), deleter);</code> throws, then it's still owned by the <code>unique_ptr</code> and the following line lets it go.</p>\n\n<p>Bonus points: What if <code>load_widget(int id)</code> returns a <code>std::shared_ptr&lt;widget&gt;</code> which could already have a non-trivial deleter. Is there a way to inject this wrapper around it, or is that not possible?</p>\n"}, {"tags": ["c++", "c++11", "language-lawyer", "assignment-operator"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1523469534, "post_id": 49781571, "comment_id": 86578626, "body": "If you have a user-declared copy constructor the compiler will not create a default move constructor. Pretty sure the same applies to assignment."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1523469555, "post_id": 49781571, "comment_id": 86578636, "body": "These are the key 5 methods <a href=\"https://stackoverflow.com/questions/29465527/c-rule-of-5-copy-and-move-constructor-and-assignment-caveat-to-copy-or-move\">Rule of 5</a>"}, {"owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1523469615, "post_id": 49781571, "comment_id": 86578668, "body": "@user4581301 <i>maybe exclusively</i> here means, that any combination or even the only of mentioned operators may be present in actual implementation."}, {"owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1523469665, "post_id": 49781571, "comment_id": 86578698, "body": "@GemTaylor Irrelevant here. The question is about signatures of operators, not about an idioms."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1523469773, "post_id": 49781571, "comment_id": 86578764, "body": "Interesting point. Diving into the standard. It should be covered in <b>[class.copy]</b>. Back if I find anything interesting."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1523469992, "post_id": 49781571, "comment_id": 86578871, "body": "[agh! Too slow] That link shows the correct signatures for the 4 copy operations you need to = delete if you want to disable copying. You can get away with not setting the return type, but it is not good practice, and at some point you may get a compiler warning."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1523470069, "post_id": 49781571, "comment_id": 86578908, "body": "Only hard requirement I&#39;m seeing is <a href=\"https://timsong-cpp.github.io/cppwp/n3337/class.copy#17\" rel=\"nofollow noreferrer\">A user-declared copy assignment operator X::operator= is a non-static non-template member function of class X with exactly one parameter of type X, X&amp;, const X&amp;, volatile X&amp; or const volatile X&amp;.</a>. Absolutely nothing about the return type."}], "answers": [{"comments": [{"owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 1, "creation_date": 1523469507, "post_id": 49781655, "comment_id": 86578607, "body": "I particularly interested in correcteness of the use of <code>void</code> as result type."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 0, "creation_date": 1523469958, "post_id": 49781655, "comment_id": 86578850, "body": "@Orient: I recall there&#39;s a quirk with making them private, but the <code>void</code> return type is definitely fine."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1523470008, "post_id": 49781655, "comment_id": 86578880, "body": "Return types don&#39;t participate in overload resolution."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 2, "last_activity_date": 1523471216, "last_edit_date": 1523471216, "creation_date": 1523469468, "answer_id": 49781655, "question_id": 49781571, "link": "https://stackoverflow.com/questions/49781571/valid-signature-to-delete-copy-move-assignment-operator/49781655#49781655", "title": "Valid signature to delete copy/move assignment operator", "body": "<p>It's perfectly valid. If your class does not need/want/cannot work with those functions then making that explicit and deleting them is the right thing to do (and even though return types don't participate in overload resolution you may want to get them correct just to reduce confusion).</p>\n"}, {"comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1523517428, "post_id": 49783939, "comment_id": 86595353, "body": "IOW, return type <code>void</code> is even legal when you <i>define</i> the functions instead of deleting them."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1523478337, "creation_date": 1523478337, "answer_id": 49783939, "question_id": 49781571, "link": "https://stackoverflow.com/questions/49781571/valid-signature-to-delete-copy-move-assignment-operator/49783939#49783939", "title": "Valid signature to delete copy/move assignment operator", "body": "<p>From <a href=\"http://eel.is/c++draft/class.copy.assign#1.sentence-1\" rel=\"nofollow noreferrer\">[class.copy.assign]</a>:</p>\n\n<blockquote>\n  <p>A user-declared <em>copy</em> assignment operator <code>X\u200b::\u200boperator=</code> is a non-static non-template member function of class <code>X</code> with exactly one parameter of type <code>X</code>, <code>X&amp;</code>, <code>const X&amp;</code>, <code>volatile X&amp;</code> or <code>const volatile X&amp;</code>.</p>\n</blockquote>\n\n<p>and similarly for <a href=\"http://eel.is/c++draft/class.copy.assign#3.sentence-1\" rel=\"nofollow noreferrer\">move</a>:</p>\n\n<blockquote>\n  <p>A user-declared <em>move</em> assignment operator <code>X\u200b::\u200boperator=</code> is a non-static non-template member function of class <code>X</code> with exactly one parameter of type <code>X&amp;&amp;</code>, <code>const X&amp;&amp;</code>, <code>volatile X&amp;&amp;</code>, or <code>const volatile X&amp;&amp;</code>.</p>\n</blockquote>\n\n<p>There is no restriction here on the return type. Only on the parameter type. The version of these that the compiler generates <a href=\"http://eel.is/c++draft/class.copy.assign#6\" rel=\"nofollow noreferrer\">returns <code>X&amp;</code></a>, but that in no way obligates you to do the same thing. </p>\n\n<p>If you're deleting the assignment operator anyway, returning <code>void</code> is fine. Note that you do not need to delete both the copy and move assignment operators. If you delete the copy assignment, the <a href=\"http://eel.is/c++draft/class.copy.assign#4.1\" rel=\"nofollow noreferrer\">move won't be implicitly generated</a>. </p>\n\n<blockquote>\n  <p>Is there any interference in case of inheritance?</p>\n</blockquote>\n\n<p>No. The implicitly generated assignment operators would just be <a href=\"http://eel.is/c++draft/class.copy.assign#7.4\" rel=\"nofollow noreferrer\">defined as deleted</a> (and would return <code>X&amp;</code>, although that's orthogonal). If you declare one, then that's of course up to you to do whatever you want. </p>\n"}], "owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 49783939, "answer_count": 2, "score": 3, "last_activity_date": 1523478367, "creation_date": 1523469168, "last_edit_date": 1523478367, "question_id": 49781571, "link": "https://stackoverflow.com/questions/49781571/valid-signature-to-delete-copy-move-assignment-operator", "title": "Valid signature to delete copy/move assignment operator", "body": "<p>Is it valid to delete copy or move assignment operators (maybe exclusively) using the following signature (note the <code>void</code> as result type)?</p>\n\n<pre><code>struct A\n{\n    A() = default;\n    void operator = (const A &amp;) = delete;\n    void operator = (A &amp;) = delete;\n    void operator = (A &amp;&amp;) = delete;\n};\n</code></pre>\n\n<p>G++/clang++ accepts above code (practically it may be considered as shortening). Are there more strict requirements for signatures of assignment operators to make them explicitly deleted?</p>\n\n<p>Is there any interference in case of inheritance?</p>\n"}, {"tags": ["c++", "c++11", "templates"], "answers": [{"comments": [{"owner": {"reputation": 356, "user_id": 3791510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff26001571a0e175a481256fd7f67b1c?s=128&d=identicon&r=PG&f=1", "display_name": "marinier", "link": "https://stackoverflow.com/users/3791510/marinier"}, "edited": false, "score": 1, "creation_date": 1523536010, "post_id": 49781882, "comment_id": 86607302, "body": "I ended up using your first suggestion, which worked. Minor typo: <code>return specializedShouldDoIt(member);</code> -&gt; <code>return specializedShouldDoIt(val);</code>"}], "tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": true, "score": 1, "last_activity_date": 1523548731, "last_edit_date": 1523548731, "creation_date": 1523470341, "answer_id": 49781882, "question_id": 49781561, "link": "https://stackoverflow.com/questions/49781561/c-template-specialization-for-a-single-method-for-complex-types/49781882#49781882", "title": "C++ template specialization for a single method for complex types", "body": "<p>There are several options for doing this, and which one I would choose depends on how much I want this special behavior to be customizable. With what you showed here, I'd probably use an overloaded function:</p>\n\n<pre><code>template &lt;class T&gt;\nclass MyClass : public MyAbstractClass {\npublic:\n\n    bool shouldDoIt() {\n        if (state) return true;\n        return specializedShouldDoIt(val);\n    }\n\nprivate:\n    template &lt;class U&gt;\n    static bool specializedShouldDoIt(U&amp;) { return false; }\n\n    template &lt;class X&gt;\n    static bool specializedShouldDoIt(\n                        std::vector&lt;std::shared_ptr&lt;MyClass&lt;X&gt;&gt;&gt; &amp;val) {\n        // your loop is equivalent to std::any_of\n        return std::any_of(val.begin(), val.end(), [](auto &amp;member) {\n            return member-&gt;state;\n        });\n    }\n\n    template &lt;class X, class Y&gt;\n    static bool specializedShouldDoIt(\n                   std::unordered_map&lt;X, std::shared_ptr&lt;MyClass&lt;Y&gt;&gt;&gt; &amp;val) {\n        return std::any_of(val.begin(), val.end(), [](auto &amp;member) {\n            return member.second-&gt;state;\n        });\n    }\n};\n</code></pre>\n\n<hr>\n\n<p>The other alternative I might consider is having an external helper class, so that I could use partial specialization:</p>\n\n<pre><code>template &lt;class T&gt;\nstruct PerformShouldDoIt\n{\n    static bool shouldDoIt(bool state, T&amp;) { return state; }\n};\n\ntemplate &lt;class X&gt;\nstruct PerformShouldDoIt&lt;std::vector&lt;std::shared_ptr&lt;MyClass&lt;X&gt;&gt;&gt;&gt;\n{\n    static bool shouldDoIt(bool state,\n                           std::vector&lt;std::shared_ptr&lt;MyClass&lt;X&gt;&gt;&gt;&amp; val) {\n        return std::any_of(val.begin(), val.end(), [](auto &amp;member) {\n            return member-&gt;state;\n        });\n    }\n};\n\n// Similarly for whatever you wanted to specialize for\n\n...\n\ntemplate &lt;class T&gt;\nclass MyClass : public MyAbstractClass {\npublic:\n\n    bool shouldDoIt() {\n        return PerformShouldDoIt&lt;T&gt;::shouldDoIt(state, val);\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 356, "user_id": 3791510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff26001571a0e175a481256fd7f67b1c?s=128&d=identicon&r=PG&f=1", "display_name": "marinier", "link": "https://stackoverflow.com/users/3791510/marinier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 49781882, "answer_count": 1, "score": 2, "last_activity_date": 1523548731, "creation_date": 1523469127, "question_id": 49781561, "link": "https://stackoverflow.com/questions/49781561/c-template-specialization-for-a-single-method-for-complex-types", "title": "C++ template specialization for a single method for complex types", "body": "<p>I have an abstract class and subclass like this:</p>\n\n<pre><code>class MyAbstractClass {\npublic:\n    virtual bool shouldDoIt() = 0;\n}\n\ntemplate &lt;class T&gt; class MyClass : public MyAbstractClass {\npublic:\n\n    bool shouldDoIt() { return state; }\n\nprivate: // assume there are appropriate accessors for these private fields\n    bool state;\n    T val;\n}\n</code></pre>\n\n<p>This implementation of <code>shouldDoIt()</code> is fine for most types. But if <code>T</code> happens to be a <code>std::vector&lt;std::shared_ptr&lt;MyClass&lt;X&gt;&gt;&gt;</code>, where <code>X</code> can be any type, then I want the implementation to be something like this:</p>\n\n<pre><code>bool shouldDoIt() {\n    if(state) return true;\n    for(auto &amp;member : val) {\n        if(member-&gt;state) return true;\n    }\n    return false;\n}\n</code></pre>\n\n<p>Of if it's a <code>std::unordered_map&lt;X, std::shared_ptr&lt;MyClass&lt;Y&gt;&gt;</code>, where <code>X</code> and <code>Y</code> can be any types, I want this implementation:</p>\n\n<pre><code>bool shouldDoIt() {\n    if(state) return true;\n    for(auto &amp;member : val) {\n        if(member.second-&gt;state) return true;\n    }\n    return false;\n}\n</code></pre>\n\n<p>How can I specialize the implementation of shouldDoIt() for these types? I'm using Visual Studio 2015.</p>\n"}, {"tags": ["c++", "copy-elision", "return-value-optimization"], "comments": [{"owner": {"reputation": 656, "user_id": 1709144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd602829efb2e4eb1b5d4d6fd40db5e4?s=128&d=identicon&r=PG", "display_name": "jpfx1342", "link": "https://stackoverflow.com/users/1709144/jpfx1342"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1523469249, "post_id": 49781527, "comment_id": 86578468, "body": "That&#39;s more or less the conclusion I came to, but I don&#39;t understand the spec well enough to make a conclusive answer."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1523469857, "last_edit_date": 1523469857, "creation_date": 1523469277, "answer_id": 49781599, "question_id": 49781527, "link": "https://stackoverflow.com/questions/49781527/can-copy-elision-rvo-cause-a-copy-move-from-the-same-object/49781599#49781599", "title": "Can copy elision/RVO cause a copy/move from the same object", "body": "<blockquote>\n  <p>However, with copy elision/RVO, is it possible that the copy will happen from <code>obj</code> to <code>obj</code>?</p>\n</blockquote>\n\n<p>No to \"copy elision/RVO\".<br>\nYes to \"copy will happen from <code>obj</code> to <code>obj</code>\" but only as copy assignment.</p>\n\n<p>It is advised to check for self assignment in user defined copy assignment functions. When you do that, your code should work fine.</p>\n\n<pre><code>SomeObject&amp; operator=(SomeObject const&amp; rhs)\n{\n   // Do nothing for self assignment.\n   if ( this != &amp;rhs )\n   {\n      ...\n   }\n\n   return *this;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 656, "user_id": 1709144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd602829efb2e4eb1b5d4d6fd40db5e4?s=128&d=identicon&r=PG", "display_name": "jpfx1342", "link": "https://stackoverflow.com/users/1709144/jpfx1342"}, "edited": false, "score": 0, "creation_date": 1523469905, "post_id": 49781600, "comment_id": 86578826, "body": "But this would cause UB, because obj hadn&#39;t been initialized yet, right?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 656, "user_id": 1709144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd602829efb2e4eb1b5d4d6fd40db5e4?s=128&d=identicon&r=PG", "display_name": "jpfx1342", "link": "https://stackoverflow.com/users/1709144/jpfx1342"}, "edited": false, "score": 0, "creation_date": 1523470033, "post_id": 49781600, "comment_id": 86578897, "body": "@jpfx1342 Not if you call it with <code>true</code> as you will get a default object.  I have added about what happens when you call it with false."}, {"owner": {"reputation": 816, "user_id": 5352221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8451ba1b588ab60305b93c6fa2658c7?s=128&d=identicon&r=PG&f=1", "display_name": "AdvSphere", "link": "https://stackoverflow.com/users/5352221/advsphere"}, "edited": false, "score": 0, "creation_date": 1523483834, "post_id": 49781600, "comment_id": 86585447, "body": "To add to the answer, RVO cannot happen since the compiler does not know what instance will be returned, the function has two <code>return</code> expressions. Unless the function is constexpr and the <code>bool make_new</code> is known in compile time."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 4, "last_activity_date": 1523469976, "last_edit_date": 1523469976, "creation_date": 1523469280, "answer_id": 49781600, "question_id": 49781527, "link": "https://stackoverflow.com/questions/49781527/can-copy-elision-rvo-cause-a-copy-move-from-the-same-object/49781600#49781600", "title": "Can copy elision/RVO cause a copy/move from the same object", "body": "<blockquote>\n  <p>However, with copy elision/RVO, is it possible that the copy will happen from <code>obj</code> to <code>obj</code>?</p>\n</blockquote>\n\n<p>No.  Copy elison/RVO is used in the process of initializing a variable.  Since you already initialized <code>obj</code> using <code>SomeObject obj;</code> you wont get any optimization.  The copy assignment operator will be called and the <code>obj</code> from the call site will be assigned the value of the <code>obj</code> from the function.</p>\n\n<p>If you had</p>\n\n<pre><code>SomeObject obj = copy_maybe(true, obj);\n</code></pre>\n\n<p>Then yes, copy elison can (will in C++17) come into play.</p>\n\n<hr>\n\n<p>Do note that calling </p>\n\n<pre><code>SomeObject obj = copy_maybe(false, obj);\n</code></pre>\n\n<p>Will leave <code>obj</code> in an indeterminate state as it would be the same as</p>\n\n<pre><code>SomeObject obj = obj;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 656, "user_id": 1709144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd602829efb2e4eb1b5d4d6fd40db5e4?s=128&d=identicon&r=PG", "display_name": "jpfx1342", "link": "https://stackoverflow.com/users/1709144/jpfx1342"}, "edited": false, "score": 0, "creation_date": 1523472578, "post_id": 49781698, "comment_id": 86580177, "body": "Though I accepted the other answer, I think this one is valuable too, since it goes into more detail about the lifetime of objects."}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 2, "last_activity_date": 1523470281, "last_edit_date": 1523470281, "creation_date": 1523469620, "answer_id": 49781698, "question_id": 49781527, "link": "https://stackoverflow.com/questions/49781527/can-copy-elision-rvo-cause-a-copy-move-from-the-same-object/49781698#49781698", "title": "Can copy elision/RVO cause a copy/move from the same object", "body": "<p>Copy/move <em>assignments</em> can never be elided; elision only happens with the initialization of an object.</p>\n\n<p>However, there is a way to make elision apply to an existing object:</p>\n\n<pre><code>SomeObject obj;\nnew(&amp;obj) auto(copy_maybe(false, obj);\n</code></pre>\n\n<p>C++17 defines this in an interesting way. The placement <code>new</code> happens before the construction of the new object. The placement <code>new</code> call is said to \"obtain storage\" for that object.</p>\n\n<p>And the standard says that when you \"obtain storage\" for an object, the lifetime of any objects that are already in that storage are terminated (since their storage is being reused for a new object). Therefore, the object declared initially has its lifetime ended. But it's <em>destructor</em> doesn't get called; if your program relies on a destructor to be called before an object's lifetime is ended, then you have UB.</p>\n\n<p>But this provokes UB anyway. Why? Because <code>obj</code>'s lifetime ended <em>before</em> <code>copy_maybe</code> is called. So <code>copy_maybe</code> will get a reference to an object that no longer exists. And when <code>copy_maybe</code> accesses a reference to a non-existent object, you get UB.</p>\n\n<p>Similarly:</p>\n\n<pre><code>SomeObject obj = copy_maybe(false, obj);\n</code></pre>\n\n<p>This also provokes UB. The initialization of <code>obj</code> is non-vacuuous; therefore, its lifetime does not start until its initialization has been completed. And that happens in <code>copy_maybe</code>. But <code>copy_maybe</code> is being given a reference to an object that has not had its lifetime start. That's UB.</p>\n"}], "owner": {"reputation": 656, "user_id": 1709144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd602829efb2e4eb1b5d4d6fd40db5e4?s=128&d=identicon&r=PG", "display_name": "jpfx1342", "link": "https://stackoverflow.com/users/1709144/jpfx1342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 1, "accepted_answer_id": 49781600, "answer_count": 3, "score": 6, "last_activity_date": 1523470281, "creation_date": 1523468997, "question_id": 49781527, "link": "https://stackoverflow.com/questions/49781527/can-copy-elision-rvo-cause-a-copy-move-from-the-same-object", "title": "Can copy elision/RVO cause a copy/move from the same object", "body": "<p>Let's say I have a function that looks like this:</p>\n\n<pre><code>SomeObject copy_maybe(bool make_new, const SomeObject&amp; def)\n{\n    if (make_new)\n        return SomeObject();\n    else\n        return def;\n}\n</code></pre>\n\n<p>And I call it like this:</p>\n\n<pre><code>SomeObject obj;\nobj = copy_maybe(true, obj);\n</code></pre>\n\n<p>Without copy elision, this will clearly always result in a copy to <code>obj</code> from a temporary created in <code>copy_maybe</code>. However, with copy elision/RVO, is it possible that the copy will happen from <code>obj</code> to <code>obj</code>?</p>\n\n<p>More specifically, under these (or similar) conditions, is it possible in a copy operator (<code>void operator=(SomeObject const &amp;other)</code>) that <code>this</code> and <code>&amp;other</code> will be the same due to copy elision?</p>\n\n<p>I created a <a href=\"https://ideone.com/BxpA4T\" rel=\"noreferrer\">test</a> on Ideone, and it returns separate addresses, but I just want to make sure that this behavior is defined by the spec.</p>\n"}, {"tags": ["c++", "class", "constants"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 3477751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1401227548/picture?type=large", "display_name": "stuart194", "link": "https://stackoverflow.com/users/3477751/stuart194"}, "edited": false, "score": 0, "creation_date": 1523468592, "post_id": 49781382, "comment_id": 86578120, "body": "so the const here should be preventing me from changing what ps points to? but when I add <code>*ps = &#39;\\0&#39;;</code> I get no error?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 331, "user_id": 3477751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1401227548/picture?type=large", "display_name": "stuart194", "link": "https://stackoverflow.com/users/3477751/stuart194"}, "edited": false, "score": 0, "creation_date": 1523468643, "post_id": 49781382, "comment_id": 86578149, "body": "@stuart194 Yes, it is stopping you from changing the address that <code>ps</code> holds.  If you try <code>ps = nullptr</code> you will get an error.  <code>*ps = &#39;\\0&#39;</code> doesn&#39;t change what the pointer points to.  It changes the thing the pointer points to."}, {"owner": {"reputation": 331, "user_id": 3477751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1401227548/picture?type=large", "display_name": "stuart194", "link": "https://stackoverflow.com/users/3477751/stuart194"}, "edited": false, "score": 0, "creation_date": 1523468844, "post_id": 49781382, "comment_id": 86578260, "body": "So basically using const in these situations basically stops you from accidently moving where the point is pointing?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 331, "user_id": 3477751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1401227548/picture?type=large", "display_name": "stuart194", "link": "https://stackoverflow.com/users/3477751/stuart194"}, "edited": false, "score": 0, "creation_date": 1523468854, "post_id": 49781382, "comment_id": 86578267, "body": "@stuart194 -- always keep in mind that the <b>pointer</b> is not the same thing as <b>what it&#39;s pointing at</b>. <code>const char*</code> is a modifiable pointer that points at an unmodifiable <code>char</code>; <code>char *const</code> is an umodifiable pointer that points at a modifiable <code>char</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 331, "user_id": 3477751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1401227548/picture?type=large", "display_name": "stuart194", "link": "https://stackoverflow.com/users/3477751/stuart194"}, "edited": false, "score": 1, "creation_date": 1523468928, "post_id": 49781382, "comment_id": 86578301, "body": "@stuart194 It stops you from changing what the pointer points to, you cannot give it a different address to point to."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 8, "last_activity_date": 1523468444, "creation_date": 1523468444, "answer_id": 49781382, "question_id": 49781353, "link": "https://stackoverflow.com/questions/49781353/const-still-allowing-changes-under-operator-function-c/49781382#49781382", "title": "Const still allowing changes under operator function c++", "body": "<blockquote>\n  <p>It is my understanding that the use of <code>const</code> in the <code>operator+</code> function should stop me being able to change <code>ps</code> and <code>other</code> however I am able to change both of them still.</p>\n</blockquote>\n\n<p>And this is correct.  You cannot change <code>ps</code> or <code>other.ps</code>, however, that is not what you are doing.  What you are doing is changing the contents of what <code>ps</code> points to, which is not const.</p>\n\n<p>So, in <code>operator+</code> the type of <code>ps</code> is <code>char * const</code> (constant pointer to a char) and not <code>const char *</code> (pointer to a constant char)</p>\n"}], "owner": {"reputation": 331, "user_id": 3477751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1401227548/picture?type=large", "display_name": "stuart194", "link": "https://stackoverflow.com/users/3477751/stuart194"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 49781382, "answer_count": 1, "score": 2, "last_activity_date": 1523468444, "creation_date": 1523468317, "question_id": 49781353, "link": "https://stackoverflow.com/questions/49781353/const-still-allowing-changes-under-operator-function-c", "title": "Const still allowing changes under operator function c++", "body": "<p>I have the following code:</p>\n\n<pre><code>StringC StringC::operator+(const StringC&amp; other) const\n{\n    strcat(ps,other.ps);\n    return ps;\n};\n</code></pre>\n\n<p>with the relevant header as follows:</p>\n\n<pre><code>class StringC {\nprivate:\n    char* ps;\npublic:\n    StringC(char const *);\n    StringC&amp; operator=(const StringC&amp;);\n    StringC operator+(const StringC&amp; other) const;\n    void Print();\n</code></pre>\n\n<p>It is my understanding that the use of <code>const</code> in the <code>operator+</code> function should stop me being able to change <code>ps</code> and <code>other</code> however I am able to change both of them still.</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>void Class1::Method1() const\n{\n    Variable = Variable + 1;\n};\n\nvoid Class1::Method1(const int v)\n{\n    v = 0;\n    Variable = v + 1;\n};\n</code></pre>\n\n<p>And this errors as expected, I assume I am missing something in my use of const, but would have expected the first code to error when using <code>strcat</code>?</p>\n"}, {"tags": ["android", "c++", "android-studio", "cmake", "android-ndk"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1523467992, "post_id": 49781205, "comment_id": 86577817, "body": "I don&#39;t see any error message in the question post. Did I miss something?"}, {"owner": {"reputation": 1604, "user_id": 559449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24b577c3f9d48ba46f02631c541d0c61?s=128&d=identicon&r=PG", "display_name": "Luther", "link": "https://stackoverflow.com/users/559449/luther"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1523468391, "post_id": 49781205, "comment_id": 86578004, "body": "No, sorry: I didn&#39;t add them. They are linker errors from clang: it says nothing about not being able to find the library from inside Android Studio (as I said, Android Studio doesn&#39;t seem to report CMake errors which isn&#39;t very helpful). I&#39;ll update my post with the linker errors."}, {"owner": {"reputation": 958, "user_id": 4496512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb8bd9953c0539aab9ff5bfb8bff75f?s=128&d=identicon&r=PG&f=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/4496512/gerry"}, "edited": false, "score": 2, "creation_date": 1523473743, "post_id": 49781205, "comment_id": 86580764, "body": "if you going this path of adding pre-built libs, this example <a href=\"https://github.com/googlesamples/android-ndk/tree/master/hello-libs\" rel=\"nofollow noreferrer\">github.com/googlesamples/android-ndk/tree/master/hello-libs</a> might help: it shows how to link (with CMake ) for a prebuilt ( external ) lib. It depends on which way you want to go, eventually you might go to ndk-build path to trace your code etc."}, {"owner": {"reputation": 1452, "user_id": 6108601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/460384444e8882114b7d8631f7ac0aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Vygintas B", "link": "https://stackoverflow.com/users/6108601/vygintas-b"}, "edited": false, "score": 2, "creation_date": 1523509110, "post_id": 49781205, "comment_id": 86591556, "body": "after <code>add_library(bullet_lib STATIC IMPORTED)</code> you need to add location for lib files with <code>set_target_properties(lib PROPERTIES IMPORTED_LOCATION</code> and make target to include header files"}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 1, "creation_date": 1523545990, "post_id": 49781205, "comment_id": 86614967, "body": "You may find this useful: <a href=\"https://stackoverflow.com/a/43442227/192373\"><i>Force CMake in verbose mode via Gradle and the Android NDK</i></a>."}], "answers": [{"comments": [{"owner": {"reputation": 1604, "user_id": 559449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24b577c3f9d48ba46f02631c541d0c61?s=128&d=identicon&r=PG", "display_name": "Luther", "link": "https://stackoverflow.com/users/559449/luther"}, "edited": false, "score": 0, "creation_date": 1523698479, "post_id": 49805839, "comment_id": 86675111, "body": "Hi Alex,    Following your advice on another forum, I&#39;ve been using my older android.mk build files which previously worked using your suggestion below.  I haven&#39;t got this building yet (see <a href=\"https://stackoverflow.com/questions/49829995/linker-errors-with-external-ndk-library-that-needs-cpufeatures\" title=\"linker errors with external ndk library that needs cpufeatures\">stackoverflow.com/questions/49829995/&hellip;</a> for my current linker issues) but I&#39;m a lot closer. I&#39;ll try getting it to work with CMake as well.  Thanks for your help: I seem to have forgotten half of what I learned about android NDK development!"}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "reply_to_user": {"reputation": 1604, "user_id": 559449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24b577c3f9d48ba46f02631c541d0c61?s=128&d=identicon&r=PG", "display_name": "Luther", "link": "https://stackoverflow.com/users/559449/luther"}, "edited": false, "score": 0, "creation_date": 1523723293, "post_id": 49805839, "comment_id": 86682522, "body": "Well, if you can (almost) build <code>libanthracite-lib.so</code> with <b>ndk-build</b>, it&#39;s definitely easier to avoid separate modules, prebuilt libraries, <i>etc.</i> Much cleaner to use <b>ndk-build</b> for everything, with &#39;natural&#39; library dependencies."}], "tags": [], "owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "is_accepted": true, "score": 1, "last_activity_date": 1523647135, "last_edit_date": 1523647135, "creation_date": 1523567086, "answer_id": 49805839, "question_id": 49781205, "link": "https://stackoverflow.com/questions/49781205/linking-external-libraries-using-ndk-gradle-cmake-in-android-studio/49805839#49805839", "title": "Linking external libraries using NDK, Gradle &amp; CMake in Android Studio", "body": "<p>You must take care of ABI incompatibility. You are building <strong>libanthracite-lib.so</strong> for <strong>x86_64</strong>, so you need the same variant of <strong>libBullet.a</strong>. If you only need <strong>armeabi-v7a</strong>, you must specify this in <strong>build.gradle</strong>, e.g.</p>\n\n<pre><code>android {\n  externalNativeBuild {\n    cmake {\n      path 'CMakeLists.txt'\n    }\n  }\n  defaultConfig {\n     ndk {\n        abiFilters 'armeabi-v7a'\n    }\n    externalNativeBuild {\n      cmake {\n         arguments '-DCMAKE_VERBOSE_MAKEFILE=ON'\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>In your <code>E:\\prog\\anthracite\\gradle\\AnthracitePlayerAPI21\\app\\CMakeLists.txt</code></p>\n\n<pre><code>add_library(bullet_lib STATIC IMPORTED)\nset_target_properties(bullet_lib PROPERTIES IMPORTED_LOCATION\n ${LIBBASE}/bullet3/build3/Android/obj/local/${ANDROID_ABI}/libBullet.a)\ntarget_link_libraries(my_project_name bullet_lib android log EGL GLESv2) \n</code></pre>\n\n<p>The order of libraries in <code>target_link_libraries</code> may be important, so keep static libs on the left.</p>\n\n<p>I guess you build <strong>libBullet.a</strong> with <strong>ndk-build</strong>. You can create a separate library module (let's call in <strong>bullet_module</strong>) to your AS Project, even if it has no Java files, and point it to the <code>Android.mk</code>:</p>\n\n<pre><code>apply plugin: 'com.android.library'\n\nandroid {\n  compileSdkVersion 27\n\n  defaultConfig {\n    ndk {\n      abiFilters 'armeabi-v7a'\n    }\n    externalNativeBuild {\n      ndkBuild {\n        targets 'Bullet'\n      }\n    }\n  }\n  externalNativeBuild {\n    ndkBuild {\n      path \"${LIBBASE}/bullet3/build3/Android/jni/Android.mk\"\n    }\n  }\n}\n</code></pre>\n\n<p>Now you can change your <strong>CMakeLists.txt</strong> to look at results of  <strong>bullet_module</strong> build:</p>\n\n<pre><code>set_target_properties(bullet_lib PROPERTIES IMPORTED_LOCATION\n  &lt;path/to/bullet_module&gt;/build/intermediates/ndkBuild/debug/obj/local/${ANDROID_ABI}/libBullet.a)\n</code></pre>\n"}], "owner": {"reputation": 1604, "user_id": 559449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24b577c3f9d48ba46f02631c541d0c61?s=128&d=identicon&r=PG", "display_name": "Luther", "link": "https://stackoverflow.com/users/559449/luther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2631, "favorite_count": 0, "accepted_answer_id": 49805839, "answer_count": 1, "score": 2, "last_activity_date": 1523647135, "creation_date": 1523467771, "last_edit_date": 1523600640, "question_id": 49781205, "link": "https://stackoverflow.com/questions/49781205/linking-external-libraries-using-ndk-gradle-cmake-in-android-studio", "title": "Linking external libraries using NDK, Gradle &amp; CMake in Android Studio", "body": "<p>I've come back to Android development after a gap and my old ANT based build chain no longer seem to function (that's a separate issue) with the latest SDK, so I'm trying to do things the new way, which is based around gradle and CMake.</p>\n\n<p>I have a number of pre-built static and dynamic 3rd party libraries that my project needs but I've been unable to link these successfully.<br>\nFrom what I can gather, these need to be specified in the '<em>CMakeLists.txt</em>' file rather than the '<em>build.gradle</em>' files but I'm new to both systems, so please correct me if I'm wrong.</p>\n\n<p>Here's what I've tried so far:</p>\n\n<ul>\n<li><p>first, I try to resolve the location of bullet. I've tried variants where I omit the 'lib' the '.a' and the 'armeabi-v7a' (hoping it'd pick up the right CPU variant) but none have worked</p>\n\n<pre><code> find_library(bullet_lib libBullet.a HINTS ${LIBBASE}bullet3/build3/Android/obj/local/armeabi-v7a)\n</code></pre>\n\n<p>I'm not sure how this differs from the libraries included in <code>target_link_libraries</code></p>\n\n<pre><code>add_library(bullet_lib STATIC IMPORTED)\n</code></pre>\n\n<p>this finds the built-in libraries fine but I get linker errors for 'bullet' and other 3rd party libs</p>\n\n<pre><code>target_link_libraries(my_project_name android log EGL GLESv2 bullet_lib) \n</code></pre></li>\n</ul>\n\n<p><code>${LIBBASE}</code> is the base dir for the 3rd party libraries and seems to be OK but, here's another thing: CMake errors don't seem to appear in android studio! I can sort of work out where it's having problems by running <code>cmake .</code> in the folder that contains the '<em>CMakeLists.txt</em>' file but I'm not quite sure I'm calling that with the correct parameters: whatever Android Studio does with cmake and that file are a black box to me at this time.</p>\n\n<p>The only messages I can see in android studio are linker errors (it doesn't mention CMake errors about not finding the libraries, which is the cause of these linker errors:)</p>\n\n<pre><code>Build command failed.\nError while executing process E:\\prog\\Android\\cmake\\3.6.4111459\\bin\\cmake.exe with arguments {--build E:\\prog\\anthracite\\gradle\\AnthracitePlayerAPI21\\app\\.externalNativeBuild\\cmake\\debug\\x86_64 --target anthracite-lib}\n[1/1] Linking CXX shared library ..\\..\\..\\..\\build\\intermediates\\cmake\\debug\\obj\\x86_64\\libanthracite-lib.so\nFAILED: cmd.exe /C \"cd . &amp;&amp; E:\\prog\\Android\\ndk-bundle\\toolchains\\llvm\\prebuilt\\windows-x86_64\\bin\\clang++.exe  --target=x86_64-none-linux-android --gcc-toolchain=E:/prog/Android/ndk-bundle/toolchains/x86_64-4.9/prebuilt/windows-x86_64 --sysroot=E:/prog/Android/ndk-bundle/sysroot -fPIC -isystem E:/prog/Android/ndk-bundle/sysroot/usr/include/x86_64-linux-android -D__ANDROID_API__=21 -g -DANDROID -ffunction-sections -funwind-tables -fstack-protector-strong -no-canonical-prefixes -Wa,--noexecstack -Wformat -Werror=format-security  -std=c++11 -fexceptions -O0 -fno-limit-debug-info  -Wl,--exclude-libs,libgcc.a -Wl,--exclude-libs,libatomic.a --sysroot E:/prog/Android/ndk-bundle/platforms/android-21/arch-x86_64 -Wl,--build-id -Wl,--warn-shared-textrel -Wl,--fatal-warnings -Wl,--no-undefined -Wl,-z,noexecstack -Qunused-arguments -Wl,-z,relro -Wl,-z,now -shared -Wl,-soname,libanthracite-lib.so -o ..\\..\\..\\..\\build\\intermediates\\cmake\\debug\\obj\\x86_64\\libanthracite-lib.so @CMakeFiles/anthracite-lib.rsp  &amp;&amp; cd .\"\n\nE:\\prog\\anthracite\\src/CCmpPhysicsScene3D.cpp:237: error: undefined reference to 'btDbvtBroadphase::btDbvtBroadphase(btOverlappingPairCache*)'\nE:\\prog\\anthracite\\src/CCmpPhysicsScene3D.cpp:240: error: undefined reference to 'btDefaultCollisionConfiguration::btDefaultCollisionConfiguration(btDefaultCollisionConstructionInfo const&amp;)'\nE:\\prog\\anthracite\\src/CCmpPhysicsScene3D.cpp:242: error: undefined reference to 'btCollisionDispatcher::btCollisionDispatcher(btCollisionConfiguration*)'\nE:\\prog\\anthracite\\src/CCmpPhysicsScene3D.cpp:243: error: undefined reference to 'btSequentialImpulseConstraintSolver::btSequentialImpulseConstraintSolver()'\nE:\\prog\\anthracite\\src/CCmpPhysicsScene3D.cpp:246: error: undefined reference to 'btDefaultSoftBodySolver::btDefaultSoftBodySolver()'\nE:\\prog\\anthracite\\src/CCmpPhysicsScene3D.cpp:247: error: undefined reference to 'btSoftRigidDynamicsWorld::btSoftRigidDynamicsWorld(btDispatcher*, btBroadphaseInterface*, btConstraintSolver*, btCollisionConfiguration*, btSoftBodySolver*)'\nE:\\prog\\anthracite\\src/CCmpPhysicsScene3D.cpp:250: error: undefined reference to 'btDiscreteDynamicsWorld::btDiscreteDynamicsWorld(btDispatcher*, btBroadphaseInterface*, btConstraintSolver*, btCollisionConfiguration*)'\nE:\\prog\\anthracite\\src/CCmpPhysJointHinge.cpp:117: error: undefined reference to 'btHingeConstraint::btHingeConstraint(btRigidBody&amp;, btVector3 const&amp;, btVector3 const&amp;, bool)'\n\nclang++.exe: error: linker command failed with exit code 1 (use -v to see invocation)\nninja: build stopped: subcommand failed.\n</code></pre>\n\n<p>And running 'cmake .' from the command line gives:</p>\n\n<pre><code>-- Selecting Windows SDK version 10.0.16299.0 to target Windows 10.0.17133.\nCMake Warning at CMakeLists.txt:447 (message):\n  resolved libraries:\n\n\nCMake Warning at CMakeLists.txt:448 (message):\n  e:/prog/libs/bullet3/build3/Android/obj/local/armeabi-v7a\n\n\nCMake Warning at CMakeLists.txt:449 (message):\n  bullet_lib-NOTFOUND\n\n\n\n-- Configuring done\n-- Generating done\n-- Build files have been written to: E:/prog/anthracite/gradle/AnthracitePlayerAPI21/app\n</code></pre>\n\n<p>although, as I mentioned above, I'm not sure of the veracity of that output as the calling parameters to 'cmake' are likely to be quite different from inside Android Studio. (e.g it's defaulting to a windows build, so I'm not sure if it'd look for '.lib' libraries rather than '.a' or '.so')</p>\n\n<p>Also, I'm using these lines in my '<em>CMakeLists.txt</em>' file to report the status of the build:</p>\n\n<pre><code>message(WARNING \"resolved libraries:\")\nmessage(WARNING ${LIBBASE}bullet3/build3/Android/obj/local/armeabi-v7a)\nmessage(WARNING ${bullet_lib})\n</code></pre>\n\n<p>Anyway, I'm clearly missing something and I've not been able to find any clear guides regarding this. It seems a really simple and obvious thing to do (link a library) but it seems to be a massive pain. \nI'd be grateful for any pointers.</p>\n"}, {"tags": ["c++", "regex", "qt", "lookbehind", "qregularexpression"], "comments": [{"owner": {"reputation": 2064, "user_id": 3606329, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/027b912750dbb94c9c1ff89c9eb20f46?s=128&d=identicon&r=PG&f=1", "display_name": "user3606329", "link": "https://stackoverflow.com/users/3606329/user3606329"}, "edited": false, "score": 1, "creation_date": 1523467228, "post_id": 49780674, "comment_id": 86577416, "body": "Try <code>(?:(?&lt;=(&amp;lt;)|(&lt;))ref)</code>, Qt uses PCRE."}, {"owner": {"reputation": 1672, "user_id": 2158002, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/OiczH.jpg?s=128&g=1", "display_name": "Akiva", "link": "https://stackoverflow.com/users/2158002/akiva"}, "reply_to_user": {"reputation": 2064, "user_id": 3606329, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/027b912750dbb94c9c1ff89c9eb20f46?s=128&d=identicon&r=PG&f=1", "display_name": "user3606329", "link": "https://stackoverflow.com/users/3606329/user3606329"}, "edited": false, "score": 0, "creation_date": 1523467687, "post_id": 49780674, "comment_id": 86577670, "body": "@user3606329 works. What is <code>?:</code> doing here?"}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 1, "last_activity_date": 1523480086, "last_edit_date": 1523480086, "creation_date": 1523469325, "answer_id": 49781613, "question_id": 49780674, "link": "https://stackoverflow.com/questions/49780674/in-qregularexpression-what-is-the-optimal-way-to-get-around-the-lookbehind-ass/49781613#49781613", "title": "In QRegularExpression, what is the optimal way to get around the &quot;lookbehind assertion is not fixed length&quot; limitation?", "body": "<p>Since you are using the PCRE engine, the length of the pattern inside lookbehind is not fixed. Alternatives may be of different length BUT cannot have nested alternation groups even if their length is also known (fixed).</p>\n\n<p>Thus your <code>(?&lt;=(&amp;lt;|&lt;)ref)</code> can be written as <code>(?&lt;=&amp;lt;ref|&lt;ref)</code>. However, a more flexible solution here would be using <code>\\K</code>: <code>(?:&amp;lt;|&lt;)ref\\K</code>. Here, the nin-capturing group will match <code>&amp;lt;</code> or <code>&lt;</code> and then after matching <code>ref</code> all matched text will be cleared.</p>\n"}], "owner": {"reputation": 1672, "user_id": 2158002, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/OiczH.jpg?s=128&g=1", "display_name": "Akiva", "link": "https://stackoverflow.com/users/2158002/akiva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523480086, "creation_date": 1523465774, "question_id": 49780674, "link": "https://stackoverflow.com/questions/49780674/in-qregularexpression-what-is-the-optimal-way-to-get-around-the-lookbehind-ass", "title": "In QRegularExpression, what is the optimal way to get around the &quot;lookbehind assertion is not fixed length&quot; limitation?", "body": "<p>Take the following regular expression:</p>\n\n<pre><code>(?&lt;=(&amp;lt;|&lt;)ref)\n</code></pre>\n\n<p>This will fail the <code>QRegularExpression::isValid();</code> and <code>QRegularExpression::errorString();</code> will output </p>\n\n<blockquote>\n  <p>lookbehind assertion is not fixed length</p>\n</blockquote>\n\n<p>Now apparently not all Regular Expression engines have this limitation, but apparently this one does. </p>\n\n<p>Perhaps there is a Regex oriented workaround for this? And if not, what is the optimal and cleanest strategy in achieving this functionality with the Qt framework?</p>\n"}, {"tags": ["c++", "arrays", "recursion"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523465947, "post_id": 49780619, "comment_id": 86576778, "body": "Hint: Keep splitting the array until you only have two values.  Compare those and return the largest"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5447611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7i-L5gm9z8M/AAAAAAAAAAI/AAAAAAAAABg/2Rr5Tqp3KOc/photo.jpg?sz=128", "display_name": "RyanJohnTyler", "link": "https://stackoverflow.com/users/5447611/ryanjohntyler"}, "edited": false, "score": 0, "creation_date": 1523467335, "post_id": 49780857, "comment_id": 86577484, "body": "Thank you, this fixed it entirely. I was overthinking it hardcore"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 4, "last_activity_date": 1523466437, "creation_date": 1523466437, "answer_id": 49780857, "question_id": 49780619, "link": "https://stackoverflow.com/questions/49780619/how-to-find-max-in-an-array-using-recursion-and-dividing-in-half/49780857#49780857", "title": "How to find Max in an Array using Recursion and dividing in half?", "body": "<p>You are severely overthinking this problem. The process of finding the max recursively by divide-and-conquer strategy is embarrassingly simple:</p>\n\n<ul>\n<li>If there's nothing to divide because the range has a single item, return the item</li>\n<li>Otherwise divide the range in two, call for max on both halves, and return the larger of the two</li>\n</ul>\n\n<p>Here is how it looks in code:</p>\n\n<pre><code>int maxarray(const int a[], int first, int last) {\n    // Single-item range\n    if (first+1 == last) {\n        return a[first];\n    }\n    // Divide-and-conquer\n    int mid = first + (last - first) / 2;\n    int leftMax = maxarray(a, first, mid);\n    int rightMax = maxarray(a, mid, last);\n    return leftMax &gt; rightMax ? leftMax : rightMax;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/XcZOlW\" rel=\"nofollow noreferrer\">Demo.</a></p>\n\n<p>Note that despite the fact that we divide the range, the algorithm is still linear, because we solve both sub-problems in all cases. Another way to put it is that we must look at every single item in the range, regardless of the order.</p>\n"}], "owner": {"reputation": 85, "user_id": 5447611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7i-L5gm9z8M/AAAAAAAAAAI/AAAAAAAAABg/2Rr5Tqp3KOc/photo.jpg?sz=128", "display_name": "RyanJohnTyler", "link": "https://stackoverflow.com/users/5447611/ryanjohntyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 49780857, "answer_count": 1, "score": 1, "last_activity_date": 1523466437, "creation_date": 1523465636, "question_id": 49780619, "link": "https://stackoverflow.com/questions/49780619/how-to-find-max-in-an-array-using-recursion-and-dividing-in-half", "title": "How to find Max in an Array using Recursion and dividing in half?", "body": "<p>My professor wants us to use recursion to find a max in an array, specifically by dividing and conquer. By that I mean he wants us to split the array in half, work our way down the bottom half and then through the top half.</p>\n\n<p>However, I'm experiencing several problems with the code. First, I am confused as I'm not sure how to get the array to stop going through the bottom half? I am adding conditional checks to see if it's going through an infinite loop and yet it kinda ignores it. In addition it seems to be going outside the array when it shouldn't be able to in the first place. Then, using the sample code he gives, using flags it seems to skip in a 10 digit array, all the odd numbers.</p>\n\n<p>My code is right here </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\n\nint maxarray(const int anarray[], int first, int last)\n{\n    cout &lt;&lt; \"call\" &lt;&lt; endl;\n    cin.get();\n    int mid = first + (last - first) / 2;\n    int firstHalf,lastHalf = 0;\n    do{\n        cout &lt;&lt; firstHalf &lt;&lt; \" - \" &lt;&lt; mid &lt;&lt; endl;\n        cin.get();\n    firstHalf = maxarray(anarray, first, mid - 1);\n    }\n    while(mid!= first);\n\n    do{\n    lastHalf = maxarray(anarray, mid+1, last);\n    }\n    while(mid != last);\n    if(firstHalf &lt;= lastHalf)\n        return lastHalf;\n    else if(lastHalf &lt;= firstHalf)\n            return firstHalf;\n    else\n        return -1;\n\n\n    }\n\nint main()\n{\n    int arr[10] = {1,2,3,4,5,6,7,8,9,0};\n\n\n    for(int x=0;x&lt;10;x++){\n        cout &lt;&lt; arr[x] &lt;&lt; endl;}\n\n    cout &lt;&lt; maxarray(arr,0, 10);\n}\n</code></pre>\n\n<p>And using the output I get </p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n0\ncall\n\n0 - 5\n\ncall\n\n16777216 - 2\n\ncall\n\n16777216 - 0\n</code></pre>\n\n<p>It proceeds into an infinite loop after that last entry. I'm not sure what I'm doing wrong, and googling gets me simple answers but not in the way that he wants me to do it. My textbook just gives me pseudocode that doesn't help either. Conceptually, I understand how I'm supposed to work it but I'm having trouble applying it. I would send him a question but he just forwards me to StackOverflow and other websites for help. <a href=\"https://i.stack.imgur.com/aruAA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aruAA.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "linux", "arm", "memcpy", "neon"], "comments": [{"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1523548372, "post_id": 49780533, "comment_id": 86616619, "body": "Registers are passed from &#39;R0&#39;; I guess you have a &#39;this&#39; with C++.  Your neon assembler is probably wrong.  Use the input/output specifiers to tell the compile what you are doing and make this error proof and not need the (void) casts and &#39;noinline&#39;.  There is no telling what the compile is trying to do (given what compile options you set) as your assembler code give it no hints as to what is going on.  Also, you &#39;bx lr&#39; will negate any compile epilogue which maybe overflowing a stack for instance.  Try to get it to compile with input/output parameters and you will avoid frustration."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1523548493, "post_id": 49780533, "comment_id": 86616706, "body": "There is no direct effect that will cause fragmentation from the NEON code versus <code>memcpy()</code>.  It is some sort of interface error between the assembler and compiler.  Try objdump -S with <code>neonCopyRGBAtoRGBA</code> to see that the compile does around your inline assembler."}], "answers": [{"tags": [], "owner": {"reputation": 4932, "user_id": 1021504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dbd1ccace98a4e6473cc18c38dbb6d4?s=128&d=identicon&r=PG", "display_name": "Jake &#39;Alquimista&#39; LEE", "link": "https://stackoverflow.com/users/1021504/jake-alquimista-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1523471017, "last_edit_date": 1523471017, "creation_date": 1523470191, "answer_id": 49781850, "question_id": 49780533, "link": "https://stackoverflow.com/questions/49780533/eventual-arm-linux-memory-fragmentation-with-neon-copy-but-not-memcpy/49781850#49781850", "title": "Eventual ARM Linux Memory Fragmentation with NEON Copy but not memcpy", "body": "<p>The good news is that your function will run considerably faster, if you replace <code>vld4/vst4</code> with <code>vld1/vst1</code>.</p>\n\n<p>The bad news is that you have to report which registers you use and modify, including the <code>CPSR</code> and memory, and you shouldn't return from inline assembly. (<code>bx lr</code>).</p>\n\n<pre><code>__asm__ volatile(\n                \"mov r3, r3, lsr #3\\n\"           /* Divide number of pixels by 8 because we process them 8 at a time */\n                \"loopRGBACopy:\\n\"\n                \"vld1.8 {d0-d3}, [r1]!\\n\"        /* Load 8 pixels into d0 through d2. d0 = R[0-7], d1 = G[0-7], d2 = B[0-7], d3 = A[0-7] */\n                \"subs r3, r3, #1\\n\"              /* Decrement the loop counter */\n                \"vst1.8 {d0-d3}, [r2]!\\n\"        /* Store the RGBA into destination 8 pixels at a time */\n                \"bgt loopRGBACopy\\n\"\n                ::: \"r1\", \"r2\", \"r3\", \"d0\", \"d1\", \"d2\", \"d3\", \"cc\", \"memory\"\n                );\n</code></pre>\n\n<p><a href=\"http://www.ethernut.de/en/documents/arm-inline-asm.html\" rel=\"nofollow noreferrer\">http://www.ethernut.de/en/documents/arm-inline-asm.html</a></p>\n"}], "owner": {"reputation": 1274, "user_id": 688563, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7ba0fb451b240351c79a96cae6ea14ea?s=128&d=identicon&r=PG&f=1", "display_name": "PhilBot", "link": "https://stackoverflow.com/users/688563/philbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 49781850, "answer_count": 1, "score": -1, "last_activity_date": 1523471017, "creation_date": 1523465323, "question_id": 49780533, "link": "https://stackoverflow.com/questions/49780533/eventual-arm-linux-memory-fragmentation-with-neon-copy-but-not-memcpy", "title": "Eventual ARM Linux Memory Fragmentation with NEON Copy but not memcpy", "body": "<p>I am running Linux 4.4 on a BeagleBone X-15 ( ARM Cortex-A15 ) board. My application mmaps the output of the SGX GPU and needs to copy the DRM backing store. </p>\n\n<p>Both memcpy and my custom NEON copy code work... but the NEON code is much faster ( ~11ms vs. ~35ms ).</p>\n\n<p>I notice that, pretty consistently, after 12500 seconds, when I am using the NEON version of the copy, Linux kills the application for out of memory ( OOM ). When I run the application and change the one line from NEON copy to standard memcpy, it runs indefinitely ( 12 hours so far... ). But it is slower to copy.</p>\n\n<p>I've pasted the mmap, copy, and NEON copy code below. Is there something really wrong with my NEON copy? Thank you.</p>\n\n<p>NEON Copy:</p>\n\n<pre><code>/**\n* CompOpenGL neonCopyRGBAtoRGBA()\n* Purpose: neonCopyRGBAtoRGBA - Software NEON copy\n*\n* @param src - Source buffer\n* @param dst - Destination buffer\n* @param numpix - Number of pixels to convert\n*/\n__attribute__((noinline)) void CompOpenGL::neonCopyRGBAtoRGBA(unsigned char* src, unsigned char* dst, int numPix)\n{\n\n    (void)src;\n    (void)dst;\n    (void)numPix;\n\n    // This case takes RGBA -&gt; BGRA\n    __asm__ volatile(\n                \"mov r3, r3, lsr #3\\n\"           /* Divide number of pixels by 8 because we process them 8 at a time */\n                \"loopRGBACopy:\\n\"\n                \"vld4.8 {d0-d3}, [r1]!\\n\"        /* Load 8 pixels into d0 through d2. d0 = R[0-7], d1 = G[0-7], d2 = B[0-7], d3 = A[0-7] */\n                \"subs r3, r3, #1\\n\"              /* Decrement the loop counter */\n                \"vst4.8 {d0-d3}, [r2]!\\n\"        /* Store the RGBA into destination 8 pixels at a time */\n                \"bgt loopRGBACopy\\n\"\n                \"bx lr\\n\"\n                );\n\n}\n</code></pre>\n\n<p>Mmap and copy code here: </p>\n\n<pre><code>union gbm_bo_handle handleUnion = gbm_bo_get_handle(m_Fb-&gt;bo);\nstruct drm_omap_gem_info gemInfo;\nchar *gpuMmapFrame = NULL;\ngemInfo.handle = handleUnion.s32;\nint ret = drmCommandWriteRead(m_DRMController-&gt;m_Fd, DRM_OMAP_GEM_INFO,&amp;gemInfo, sizeof(gemInfo));\nif (ret) {\n    qDebug() &lt;&lt; \"Cannot set write/read\";\n}\nelse {\n    // Mmap the frame\n    gpuMmapFrame = (char *)mmap(0, gemInfo.size, PROT_READ | PROT_WRITE, MAP_SHARED,m_DRMController-&gt;m_Fd, gemInfo.offset);\n\n    if ( gpuMmapFrame != MAP_FAILED ) {\n\n        QElapsedTimer timer;\n        timer.restart();\n\n        //m_OGLController-&gt;neonCopyRGBAtoRGBA((uchar*)gpuMmapFrame,  (uchar*)m_cpyFrame,dmaBuf.width * dmaBuf.height);\n        memcpy(m_cpyFrame,gpuMmapFrame,dmaBuf.height * dmaBuf.width * 4);\n\n        qDebug() &lt;&lt; \"Copy Performance: \" &lt;&lt; timer.elapsed();\n</code></pre>\n"}, {"tags": ["c++", "cuda", "clang++"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 2, "creation_date": 1523466811, "post_id": 49780373, "comment_id": 86577194, "body": "It looks like clang is trying to compile for a GPU architecture which your CUDA version doesn&#39;t support"}], "answers": [{"tags": [], "owner": {"reputation": 5790, "user_id": 5407270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NsKU95wNnz8/AAAAAAAAAAI/AAAAAAAAAlI/JsEGfhwPOqU/photo.jpg?sz=128", "display_name": "Andriy Makukha", "link": "https://stackoverflow.com/users/5407270/andriy-makukha"}, "is_accepted": false, "score": 0, "last_activity_date": 1523768021, "creation_date": 1523768021, "answer_id": 49838603, "question_id": 49780373, "link": "https://stackoverflow.com/questions/49780373/how-to-use-clangs-cuda-compiler/49838603#49838603", "title": "How to use Clang&#39;s CUDA compiler?", "body": "<p>I tried to build the <a href=\"https://github.com/mozkomor/GrinGoldMiner\" rel=\"nofollow noreferrer\">GrinGoldMiner</a>'s Cudacka under Ubuntu 17.10, and all I had to do was:</p>\n\n<pre><code>make\n</code></pre>\n\n<p>This generated two commands on my machine (after some cleanup):</p>\n\n<pre><code>/usr/local/cuda-9.1/bin/nvcc -ccbin g++ -m64 -Xcompiler -fpermissive -gencode arch=compute_30,code=sm_30 -gencode arch=compute_35,code=sm_35 -gencode arch=compute_37,code=sm_37 -gencode arch=compute_50,code=sm_50 -gencode arch=compute_52,code=sm_52 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_70,code=compute_70 -o cudacka.o -c kernel.cu\n/usr/local/cuda-9.1/bin/nvcc -ccbin g++ -m64 -Xcompiler -fpermissive -gencode arch=compute_30,code=sm_30 -gencode arch=compute_35,code=sm_35 -gencode arch=compute_37,code=sm_37 -gencode arch=compute_50,code=sm_50 -gencode arch=compute_52,code=sm_52 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_70,code=compute_70 -o Cudacka.exe cudacka.o\n</code></pre>\n\n<p>And they finished successfully generating executable <code>Cudacka.exe</code>.</p>\n\n<p>If you are interested specifically in clang:</p>\n\n<p>When I tried to replace <code>g++</code> with <code>clang++-5.0</code>, I got this error:</p>\n\n<pre><code>nvcc fatal   : The version ('50000') of the host compiler ('clang') is not supported\n</code></pre>\n\n<p>If I use <code>-std=c++11 -ccbin clang++</code> instead of <code>-ccbin g++</code>, I get this error:</p>\n\n<pre><code>kernel.cu(397): error: explicit instantiation definition directive for __global__ functions with clang host compiler is not yet supported\n</code></pre>\n\n<p>So, I doubt that you can use clang to compile that code for Ubuntu. </p>\n"}, {"tags": [], "owner": {"reputation": 847, "user_id": 4762826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OLBC6.png?s=128&g=1", "display_name": "Hopobcn", "link": "https://stackoverflow.com/users/4762826/hopobcn"}, "is_accepted": true, "score": 7, "last_activity_date": 1560535420, "last_edit_date": 1560535420, "creation_date": 1524001570, "answer_id": 49887974, "question_id": 49780373, "link": "https://stackoverflow.com/questions/49780373/how-to-use-clangs-cuda-compiler/49887974#49887974", "title": "How to use Clang&#39;s CUDA compiler?", "body": "<p>It seems <code>clang++-5.0</code> does not support CUDA 9.X ...</p>\n\n<p><code>clang++</code> is able to compile CUDA kernels with CUDA 8.0:</p>\n\n<pre><code>$ clang++-5.0 -O0 -g --cuda-gpu-arch=sm_50 --cuda-path=/usr/local/cuda-8.0 -o t1 t1.cu -L/usr/local/cuda-8.0/lib64 -lcudart\n</code></pre>\n\n<p>But when using CUDA 9.X I get the same error as you:</p>\n\n<pre><code>$ clang++-5.0 --cuda-gpu-arch=sm_50 --cuda-path=/usr/local/cuda-9.0 -o t1 t1.cu -L/usr/local/cuda-9.0/lib64 -lcudart\nclang: error: cannot find libdevice for sm_50. Provide path to different CUDA installation via --cuda-path, or pass -nocudalib to build without linking with libdevice.\n</code></pre>\n\n<p>They added support for Volta (sm_70) and CUDA 9.0 in this commit: <a href=\"https://github.com/llvm-mirror/clang/commit/6d4cb407f117d080e04cf6b8ca200ee01c7b502f\" rel=\"noreferrer\">6d4cb40</a>. \nIn 2017, this was only available on <code>master</code> branch, and you would have confirmed it like this:</p>\n\n<pre><code>$ git clone https://github.com/llvm-mirror/clang.git \n$ cd clang/ \n$ git branch --contains 6d4cb40\n* master\n\n$ git checkout release_50\nBranch release_50 set up to track remote branch release_50 from origin.\nSwitched to a new branch 'release_50'\n$ git log | grep 6d4cb40\n$ (output was empty)\n</code></pre>\n\n<p>Note that clang (7.0.0, released September 2018) supports CUDA 7.0 through 9.2.</p>\n"}], "owner": {"reputation": 17430, "user_id": 309483, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d797538504a367f277d19bd8369e9a19?s=128&d=identicon&r=PG", "display_name": "Janus Troelsen", "link": "https://stackoverflow.com/users/309483/janus-troelsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3624, "favorite_count": 0, "accepted_answer_id": 49887974, "answer_count": 2, "score": 5, "last_activity_date": 1560535420, "creation_date": 1523464697, "question_id": 49780373, "link": "https://stackoverflow.com/questions/49780373/how-to-use-clangs-cuda-compiler", "title": "How to use Clang&#39;s CUDA compiler?", "body": "<p>I am on Ubuntu 17.10. I installed the CUDA 9.1 SDK from NVIDIA.</p>\n\n<p>This is what I tried:</p>\n\n<pre><code>~/GrinGoldMiner/src/Cudacka$ clang++-5.0 -Wl,--cuda-path=/usr/local/cuda-9.1 kernel.cu\nclang: error: cannot find libdevice for sm_20. Provide path to different CUDA installation via --cuda-path, or pass -nocudalib to build without linking with libdevice.\nclang: error: cannot find CUDA installation.  Provide its path via --cuda-path, or pass -nocudainc to build without CUDA includes.\nclang: error: cannot find CUDA installation.  Provide its path via --cuda-path, or pass -nocudainc to build without CUDA includes.\n</code></pre>\n\n<p>Obviously it doesn't work. It seems like the linker flags are not getting passed. How can I pass them correctly?</p>\n"}, {"tags": ["c++", "sorting", "vector", "int", "multimap"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1523464294, "post_id": 49780192, "comment_id": 86575903, "body": "You may provide custom comparator that use sum of elements, is that what you need?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1523464373, "post_id": 49780192, "comment_id": 86575952, "body": "This code actually gives you output?  It shouldn&#39;t since you never set <code>iter</code> to a valid iterator."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1523465242, "post_id": 49780192, "comment_id": 86576423, "body": "<a href=\"http://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\">std::sort</a> is a thing and, conveniently, it can take a custom comparison function."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1523468497, "post_id": 49780192, "comment_id": 86578070, "body": "You really ought to avoid <code>using namespace std</code> - it is a bad habit to get into, and <a href=\"/q/1452721\">can silently change the meaning of your program</a> when you&#39;re not expecting it.  Get used to using the namespace prefix (<code>std</code> is intentionally very short), or importing <i>just the names you need</i> into the <i>smallest reasonable scope</i>."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 5, "last_activity_date": 1523465417, "last_edit_date": 1523465417, "creation_date": 1523464469, "answer_id": 49780314, "question_id": 49780192, "link": "https://stackoverflow.com/questions/49780192/multimapvectorint-char-how-to-sort-it/49780314#49780314", "title": "multimap&lt;vector&lt;int&gt; &gt; ,char&gt; how to sort it?", "body": "<p>You will need to use a custom compare function/functor to help you with that.</p>\n\n<pre><code>struct Compare\n{\n   bool operator()(std::vector&lt;int&gt; const&amp; lhs, std::vector&lt;int&gt; const&amp; rhs) const\n   {\n      int sum1 = std::accumulate(lhs.begin(), lhs.end(), 0);\n      int sum2 = std::accumulate(rhs.begin(), rhs.end(), 0);\n      return (sum1 &gt; sum2); // Not sum1 &lt; sum2, if I understood your question\n   }\n};\n</code></pre>\n\n<p>and use:</p>\n\n<pre><code>typedef multimap&lt;vector&lt; int &gt;, char, Compare&gt; mmap;\n</code></pre>\n\n<p>You'll also have to fix the code that prints the contents of <code>foo</code>.</p>\n\n<pre><code>mmap::iterator iter = foo.begin();\nfor ( ; iter != foo.end(); ++iter )\n{\n   for ( size_t i = 0 ; i &lt; iter-&gt;first.size() ; ++i ) {\n      wcout &lt;&lt; iter-&gt;first[i] &lt;&lt; \" \" ;\n   }\n   wcout &lt;&lt; iter-&gt;second &lt;&lt; \" \" ;\n   wcout &lt;&lt; endl ;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "is_accepted": false, "score": 2, "last_activity_date": 1523464714, "creation_date": 1523464714, "answer_id": 49780381, "question_id": 49780192, "link": "https://stackoverflow.com/questions/49780192/multimapvectorint-char-how-to-sort-it/49780381#49780381", "title": "multimap&lt;vector&lt;int&gt; &gt; ,char&gt; how to sort it?", "body": "<p>You initialized iter in your inner for loop: </p>\n\n<p><code>for ( iter = foo.begin() ; iter != foo.end() ; ++iter )</code></p>\n\n<p>However, you try to access in the outer for loop where it points to nothing: </p>\n\n<p><code>for ( int i = 0 ; i &lt; iter-&gt;first.size() ; ++i )</code></p>\n"}], "owner": {"reputation": 27, "user_id": 9567388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "grace1997", "link": "https://stackoverflow.com/users/9567388/grace1997"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1523467142, "creation_date": 1523464023, "last_edit_date": 1523467142, "question_id": 49780192, "link": "https://stackoverflow.com/questions/49780192/multimapvectorint-char-how-to-sort-it", "title": "multimap&lt;vector&lt;int&gt; &gt; ,char&gt; how to sort it?", "body": "<p>Here's the code, it can compile, but it can't run, why?:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\n#include &lt;vector&gt;\nusing namespace std;\nint main() {\n    typedef multimap&lt;vector&lt; int &gt;, char&gt; mmap;\n\n    mmap foo;\n    vector&lt;int&gt; v;\n    v.push_back(15);\n    v.push_back(14);\n    foo.insert(pair&lt;vector&lt; int &gt;, char&gt; (v, 'b'));\n    v.clear();\n    v.push_back(15);\n    v.push_back(80);\n    foo.insert(pair&lt;vector&lt; int &gt;, char&gt; (v, 'c'));\n    v.clear();\n    v.push_back(9);\n    v.push_back(17);\n    foo.insert(pair&lt;vector&lt; int &gt;, char&gt; (v, 'a'));\n    v.clear();\n\n    mmap::iterator iter;\n\n    for (int i = 0; i &lt; iter-&gt;first.size(); ++i) {\n        wcout &lt;&lt; iter-&gt;first[i] &lt;&lt; \" \";\n        for (iter = foo.begin(); iter != foo.end(); ++iter) {\n            wcout &lt;&lt; iter-&gt;second &lt;&lt; \" \";\n        }\n        wcout &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<p>15 80 c</p>\n\n<p>15 14 b</p>\n\n<p>9 17 a</p>\n\n<p>I want to plus the integer,then sort it :\n(order the numbers from greatest to least</p>\n\n<p>80+15>15+14>9+17</p>\n\n<p>how to  do that?</p>\n"}, {"tags": ["c++", "qt", "file", "qtextstream"], "answers": [{"tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1523465069, "creation_date": 1523465069, "answer_id": 49780474, "question_id": 49779857, "link": "https://stackoverflow.com/questions/49779857/qtextstream-is-unable-to-write-to-file-including-t-with-openmode-qiodevicea/49780474#49780474", "title": "QTextStream is unable to write to file including &quot;\\t&quot; with openmode QIODevice::Append", "body": "<p>I can't reproduce. The following works perfectly on Windows, OS X and Linux, with Qt 5.9. Please fix your example to be <em>complete</em> and <em>reproducible</em>. E.g. take the code below, and make it fail.</p>\n\n<pre><code>// https://github.com/KubaO/stackoverflown/tree/master/questions/stream-49779857\n#include &lt;QtCore&gt;\n\nQByteArray readAll(const QString &amp;fileName) {\n   QFile f(fileName);\n   if (f.open(QIODevice::ReadOnly))\n      return f.readAll();\n   return {};\n}\n\nint main() {\n   auto tmp = QStandardPaths::writableLocation(QStandardPaths::TempLocation);\n   auto fileName = QStringLiteral(\"%1/com.stackoverflow.questions.49779857-result.txt\")\n         .arg(tmp);\n   QFile file(fileName);\n   file.remove();\n   if (!file.open(QIODevice::Append))\n      qFatal(\"Cannot open file!\");\n\n   QTextStream ts(&amp;file);\n   auto num = 1.0f, error = 2.0f;\n   ts &lt;&lt; \"num=\" &lt;&lt; num &lt;&lt; \"\\t\" &lt;&lt; \"error=\" &lt;&lt; error &lt;&lt; endl;\n   file.close();\n\n   Q_ASSERT(file.exists());\n   Q_ASSERT(readAll(fileName) == \"num=1\\terror=2\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 2756, "user_id": 957121, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/af5de311d35a52d7c5feaf9784e06a51?s=128&d=identicon&r=PG", "display_name": "user957121", "link": "https://stackoverflow.com/users/957121/user957121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523465069, "creation_date": 1523462929, "question_id": 49779857, "link": "https://stackoverflow.com/questions/49779857/qtextstream-is-unable-to-write-to-file-including-t-with-openmode-qiodevicea", "title": "QTextStream is unable to write to file including &quot;\\t&quot; with openmode QIODevice::Append", "body": "<p>I tried to save some info to the text file using QTextStream. The code is given below:</p>\n\n<pre><code>QFile fi(QString(\"result.txt\"));\nfi.remove();\nif(!fi.open(QIODevice::Append)) {\n    qDebug()&lt;&lt;\"Cannot open file!\";\n    return -1;\n}\n\nQTextStream ts(&amp;fi);\nfloat num = 1, error = 2;\nts&lt;&lt;\"num=\"&lt;&lt;num&lt;&lt;\"\\t\"&lt;&lt;\"error=\"&lt;&lt;error&lt;&lt;endl;\n</code></pre>\n\n<p>However, the code does not work. The file is created, but nothing is written, i.e., the file is empty.</p>\n\n<p>After some research, I found that I should change the open mode to  <strong>QIODevice::Text | QIODevice::Append</strong> to make the code work. Otherwise the \"\\t\" character must be removed. Does it mean that the QIODevice::Text is designed specifically for the special characters such as \"\\t\" to work in writing to files?</p>\n"}, {"tags": ["c++", "opengl", "shader", "glfw", "glew"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9631627, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FjgLC-bxH6E/AAAAAAAAAAI/AAAAAAAAAUs/1AFZurmEw2U/photo.jpg?sz=128", "display_name": "Folaranmi Ogunfemi", "link": "https://stackoverflow.com/users/9631627/folaranmi-ogunfemi"}, "edited": false, "score": 0, "creation_date": 1523463450, "post_id": 49779831, "comment_id": 86575350, "body": "I see,  I should have realized that this code was still running. Thank you. Much appreciated.  Now I will still need to create vertices for a sphere as opposed to the quad."}, {"owner": {"reputation": 378, "user_id": 9536611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3e89d805e62a01ae2f7b6fcb189d56?s=128&d=identicon&r=PG&f=1", "display_name": "platinum95", "link": "https://stackoverflow.com/users/9536611/platinum95"}, "reply_to_user": {"reputation": 11, "user_id": 9631627, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FjgLC-bxH6E/AAAAAAAAAAI/AAAAAAAAAUs/1AFZurmEw2U/photo.jpg?sz=128", "display_name": "Folaranmi Ogunfemi", "link": "https://stackoverflow.com/users/9631627/folaranmi-ogunfemi"}, "edited": false, "score": 0, "creation_date": 1523463660, "post_id": 49779831, "comment_id": 86575487, "body": "I&#39;d suggest starting with a cube rather than a sphere. A cube has 8 vertices that you can write out by hand, whereas a sphere will have hundreds of vertices that&#39;ll require a 3d modelling program to make and some form of file loader in your code."}, {"owner": {"reputation": 11, "user_id": 9631627, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FjgLC-bxH6E/AAAAAAAAAAI/AAAAAAAAAUs/1AFZurmEw2U/photo.jpg?sz=128", "display_name": "Folaranmi Ogunfemi", "link": "https://stackoverflow.com/users/9631627/folaranmi-ogunfemi"}, "edited": false, "score": 0, "creation_date": 1523464313, "post_id": 49779831, "comment_id": 86575915, "body": "@ platinum95. Thank you. I have been asked to create something that results in the following circular view. The video is less than 1 minute, but shows what my eventual end product should look like. <a href=\"https://youtu.be/8Yd76VTKulo\" rel=\"nofollow noreferrer\">youtu.be/8Yd76VTKulo</a>"}, {"owner": {"reputation": 378, "user_id": 9536611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3e89d805e62a01ae2f7b6fcb189d56?s=128&d=identicon&r=PG&f=1", "display_name": "platinum95", "link": "https://stackoverflow.com/users/9536611/platinum95"}, "reply_to_user": {"reputation": 11, "user_id": 9631627, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FjgLC-bxH6E/AAAAAAAAAAI/AAAAAAAAAUs/1AFZurmEw2U/photo.jpg?sz=128", "display_name": "Folaranmi Ogunfemi", "link": "https://stackoverflow.com/users/9631627/folaranmi-ogunfemi"}, "edited": false, "score": 0, "creation_date": 1523464561, "post_id": 49779831, "comment_id": 86576058, "body": "Fair enough, I thought you meant 3D objects which are a bit trickier, but that&#39;s probably something you could just generate the vertices for using basic trig."}], "tags": [], "owner": {"reputation": 378, "user_id": 9536611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3e89d805e62a01ae2f7b6fcb189d56?s=128&d=identicon&r=PG&f=1", "display_name": "platinum95", "link": "https://stackoverflow.com/users/9536611/platinum95"}, "is_accepted": false, "score": 1, "last_activity_date": 1523462848, "creation_date": 1523462848, "answer_id": 49779831, "question_id": 49779732, "link": "https://stackoverflow.com/questions/49779732/opengl-glfw-white-screen-w-loading-cursor-on-run/49779831#49779831", "title": "openGL GLFW White Screen w/ Loading Cursor on run", "body": "<p>You have this in your init function.</p>\n\n<pre><code>while (!glfwWindowShouldClose(w))\n{\n    //int width, height;\n//  glfwGetFramebufferSize(w, &amp;width, &amp;height); //move out of while??\n\n    // glViewport(0, 0, width, height); //remove??\n}\n</code></pre>\n\n<p>Your code is presumably hanging here.</p>\n"}], "owner": {"reputation": 11, "user_id": 9631627, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FjgLC-bxH6E/AAAAAAAAAAI/AAAAAAAAAUs/1AFZurmEw2U/photo.jpg?sz=128", "display_name": "Folaranmi Ogunfemi", "link": "https://stackoverflow.com/users/9631627/folaranmi-ogunfemi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1523462848, "creation_date": 1523462565, "question_id": 49779732, "link": "https://stackoverflow.com/questions/49779732/opengl-glfw-white-screen-w-loading-cursor-on-run", "title": "openGL GLFW White Screen w/ Loading Cursor on run", "body": "<p>ISSUE: When launched, GLWindow displays only a white screen and the cursor displays a loading circle, signifying that something is still being loaded. The window displays \"Not Responding\" shortly after that.</p>\n\n<p>I have tried downgrading to openGL 3.3 and have used glad to help with that, but the problem persists.</p>\n\n<p>Hello all,</p>\n\n<p>I've been working to create a sphere with alternating colors using a vertex shader.</p>\n\n<p>The code that I've shared below was slightly altered from code that was used to shade a quad, which worked fine. I expect that there will be issues with similar logic being used to shade a circle, or to build a sphere and shade that. I am NOT at that point yet however. Something is keeping my GL Window from displaying properly and I am hoping that someone can help me with my GLFW and glew logic to share why the window is failing to load. </p>\n\n<p>NOTE:I've edited this code to include comments for every step, which makes it seem much longer than it is. I would appreciate any help or insight.</p>\n\n<p>PRIMARY CLASS</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#define GLEW_STATIC\n    //always GLEW before GLFW\n#include \"GL/glew.h\"    \n#include \"GLFW/glfw3.h\"\n#include \"glm/glm.hpp\"\n\n#include \"ShaderProgram.h\"\n\n#ifndef M_PI\n# define M_PI 3.141592653\n#endif\n\n\n/////gLOBAL\nGLFWwindow* w = NULL;\nconst int wWidth = 800;\nconst int wHeight = 600;\n\nvoid key_callback(GLFWwindow *w, int key, int scancode, int action, int mode);\n//update colors based on average framerate\nvoid averageFPS(GLFWwindow* window);\n//screen resizing\nvoid glfw_onFramebufferSize(GLFWwindow* window, int width, int height);\nbool initOpenGL();\n\n\nstatic void error(int error, const char *desc)\n{\n    fputs(desc, stderr);\n}\n//setting up values for keys\n\n\nint main() {\n\n    if (!initOpenGL())  ///5IMPR\n    {\n        // An error occured\n        std::cerr &lt;&lt; \"GLFW not initialized\" &lt;&lt; std::endl;\n        return -1;\n    }\n\n    glfwSetErrorCallback(error);\n\n\n    GLfloat vertices[] = {\n        -0.5f,  0.5f, 0.0f,     \n        0.5f,  0.5f, 0.0f,      \n        -0.5f, 1.0f, 0.0f       \n    };\n\n    GLuint indices[] = {\n        0, 1, 2,  \n        0, 2, 3   \n    };\n\n    // 2. Set up buffers on the GPU\n    GLuint vbo, ibo, vao;                       \n\n    glGenBuffers(1, &amp;vbo);                  // Generate an empty vertex buffer on the GPU\n    glBindBuffer(GL_ARRAY_BUFFER, vbo);     // \"bind\" or set as the current buffer we are working with\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);  // copy the data from CPU to GPU\n\n    glGenVertexArrays(1, &amp;vao);             // Tell OpenGL to create new Vertex Array Object\n    glBindVertexArray(vao);                 // Make it the current one\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, NULL);   // Define a layout for the first vertex buffer \"0\"\n    glEnableVertexAttribArray(0);           // Enable the first attribute or attribute \"0\"\n\n                                            // Set up index buffer\n    glGenBuffers(1, &amp;ibo);  // Create buffer space on the GPU for the index buffer\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ibo);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);\n\n    glBindVertexArray(0);                   // unbind to make sure other code doesn't change it\n\n    ShaderProgram shaderProgram;        \n    shaderProgram.assignShaders(\"shaders/ColorShader.vert\", \"shaders/ColorShader.frag\"); \n\n            ////////SETUP RENDERING\n    while (!glfwWindowShouldClose(w))\n    {\n        averageFPS(w);\n\n            //process events\n        glfwPollEvents();           \n\n            // Clear the screen\n        glClear(GL_COLOR_BUFFER_BIT);   \n\n        shaderProgram.use();    \n\n        GLfloat time = (GLfloat)glfwGetTime();          \n        GLfloat blueSetting = (sin(time) / 2) + 0.5f;       \n        glm::vec2 pos;\n        pos.x = sin(time) / 2;\n        pos.y = cos(time) / 2;\n        shaderProgram.setUniform(\"vertColor\", glm::vec4(0.0f, 0.0f, blueSetting, 1.0f));    \n        shaderProgram.setUniform(\"posOffset\", pos);\n\n            /////COLOR OF CIRCLE OUTLINE\n        //glColor4f(0.0, 0.0, 1.0, 1.0); //RGBA\n\n            //PRIMARY BODY\n                    // Draw our line\n        glBegin(GL_LINE_LOOP);\n\n        //glColor3f(0,0,1);\n\n\n        static double iteration = 0;\n        // The x, y offset onto the screen -- this should later be centered\n        static const int offset = 150;\n\n        static const float radius = 50;\n\n\n        // Calculate our x, y cooredinates\n        double x1 = offset + radius + 100 * cos(1);\n        double y1 = offset + radius + 100 * sin(1);\n        static double wobble = 0.0;\n\n\n        // A = (\u03c0 * r\u00b2)\n        double a = M_PI * (100 * 2);    //area\n                                        // C = (2 * \u03c0 * r)\n        double c = 2 * M_PI * 100;  //circumference\n\n        static double b = 128;\n\n        for (double i = 0; i &lt; 2 * M_PI; i = i + ((2 * M_PI) / b))\n        {\n            double x = x1 + radius * cos(i);\n\n            double y = y1 + radius * sin(i);\n\n            glVertex2f(x, y);\n\n            glVertex2f(x, y);\n        }\n\n        iteration += 0.01;\n\n        ////PRIMARY BODY End\n\n        glBindVertexArray(vao);\n\n        glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);\n            //glDrawElements(GL_LINE_LOOP, 6, GL_UNSIGNED_INT, 0);\n        glBindVertexArray(0);\n        // Swap buffers and look for events\n\n        glfwSwapBuffers(w);\n\n\n    }\n        //clean up\n    glDeleteVertexArrays(1, &amp;vao);\n    glDeleteBuffers(1, &amp;vbo);\n    glDeleteBuffers(1, &amp;ibo);\n\n    //glfwDestroyWindow(w);\n    glfwTerminate();\n\n    return 0;\n    }\n\n\n            ///////START Initializing glfw glew etc\nbool initOpenGL(){\n\n    //this method will exit on these conditions\n    GLuint error = glfwInit();\n    if (!error)\n        return false;\n\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);\n    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\n\n    glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE);\n\n\n    w = glfwCreateWindow(wWidth, wHeight, \"Exercise\", NULL, NULL);\n\n    //Filling  Window\n\n    if (w== NULL)\n    {\n        std::cerr &lt;&lt; \"glfw window not created\" &lt;&lt; std::endl;\n        glfwTerminate();\n        return false;\n    }\n\n        //update context\n    glfwMakeContextCurrent(w);\n\n    // Initialize GLEWunifor\n    glewExperimental = GL_TRUE;\n    GLuint err = glewInit();\n    if (err != GLEW_OK)\n    {\n        std::cerr &lt;&lt; \"initialize GLEW Failed\" &lt;&lt; std::endl;\n        return false;\n    }\n\n        //setup key callbacks\n    glfwSetKeyCallback(w, key_callback);\n    glfwSetFramebufferSizeCallback(w, glfw_onFramebufferSize);\n\n    while (!glfwWindowShouldClose(w))\n    {\n        //int width, height;\n    //  glfwGetFramebufferSize(w, &amp;width, &amp;height); //move out of while??\n\n        // glViewport(0, 0, width, height); //remove??\n    }\n    glClearColor(0.23f, 0.38f, 0.47f, 1.0f);    ///5ADD\n\n                                                // Define the viewport dimensions\n    glViewport(0, 0, wWidth, wHeight);  //necessary?\n\n    return true;\n\n}\n\nvoid key_callback(GLFWwindow *w, int key, int scancode, int action, int mode)\n{\n    // See http://www.glfw.org/docs/latest/group__keys.html\n    if ((key == GLFW_KEY_ESCAPE || key == GLFW_KEY_Q) &amp;&amp; action == GLFW_PRESS)\n        glfwSetWindowShouldClose(w, GL_TRUE);\n\n    if (key == GLFW_KEY_W &amp;&amp; action == GLFW_PRESS)\n    {\n        bool showWires = false;\n        if (showWires)\n            glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);\n        else\n            glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);\n    }\n\n}\n\n    //whever window resizes, do this\nvoid glfw_onFramebufferSize(GLFWwindow* window, int width, int height)\n{\n    glViewport(0, 0, width, height);\n}\n\nvoid averageFPS(GLFWwindow* window) ///5ADDdown\n{\n    static double previousSeconds = 0.0;\n    static int frameCount = 0;\n    double passedSeconds;\n    double currentSeconds = glfwGetTime(); //seconds since GLFW started\n\n    passedSeconds = currentSeconds - previousSeconds;\n\n    // Limit time updates to 4 times per second\n    if (passedSeconds &gt; 0.25)\n    {\n        previousSeconds = currentSeconds;\n        double fps = (double)frameCount / passedSeconds;\n    //  double frameInMilSecs = 1000.0 / fps;\n         frameCount = 0;} \n    frameCount++;\n}\n</code></pre>\n\n<p>SHADER MANAGER/HANDLER CLASS</p>\n\n<pre><code>#include \"ShaderProgram.h\"\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n\n\nShaderProgram::ShaderProgram()\n    : mProgram(0){\n}\n\n\nShaderProgram::~ShaderProgram()\n{\n    glDeleteProgram(mProgram);\n}\n\nbool ShaderProgram::assignShaders(const char* vertFileName, const char* fragFileName)\n{\n    //Shaders output objects called programs that define their relationship and lead to .exe functionality\n\n    //assigning pointer to the shader\n\n        string vsString = readFile(vertFileName);\n        string fsString = readFile(fragFileName);\n\n    const GLchar* fsSourcePtr = fsString.c_str();\n    const GLchar* vsSourcePtr = vsString.c_str();\n\n    //creating vertex shader(vs) shader object\n    GLuint vs = glCreateShader(GL_VERTEX_SHADER);\n    GLuint fs = glCreateShader(GL_FRAGMENT_SHADER);\n\n    //assigning shader source using address. Replaces the source code in a shader object //@arg (shader, count Strings, pointer to const File ,size)\n    glShaderSource(vs, 1, &amp;vsSourcePtr, NULL);\n    glShaderSource(fs, 1, &amp;fsSourcePtr, NULL);\n\n    glCompileShader(vs);\n    glCompileShader(fs);\n\n    testProgramCompile();\n    testShaderCompile(vs);\n    testShaderCompile(fs);\n\n\n    //createProgram returns GLUint which is basically an unsigned int... we will use This Handler to create a program object\n    mProgram = glCreateProgram();\n    if (mProgram == 0)\n    {\n        std::cerr &lt;&lt; \"Shader cannot be created\" &lt;&lt; std::endl;\n        return false;\n    }\n    //assign the program object(mProgram) to the Shader\n    glAttachShader(mProgram, vs);\n    glAttachShader(mProgram, fs);\n\n    //this method accepts a GLuint \"program\" . If its an object of type GL_VERTEX_SHADER,\n    //itll create a .exe that runs on the programmable vertex processor. same goes for geometric and fragment shaders if they were included\n    //it will also bind all user defined uniform variables and attributes to the program \n    //The program can then be made part of a defined state by calling useProgram\n    glLinkProgram(mProgram);\n    testProgramCompile();\n    testShaderCompile(vs);\n    testShaderCompile(vs);\n\n    //cleaning up the elements we already used\n    glDeleteShader(vs);\n    glDeleteShader(fs);\n\n        //clear the identifier lookup map(in this case, there's only one)\n    mUniformIdentifiers.clear();\n\n    return true;\n}//end main\n\n    //Read the shaderFile. strngstream for reading multiple lines\nstring ShaderProgram:: readFile(const string&amp; filename) {\n\n    std::stringstream strgstream;\n    std::ifstream file;\n\n    try\n    {\n        file.open(filename, std::ios::in);\n\n        if (!file.fail())\n        {\n            strgstream &lt;&lt; file.rdbuf();\n        }\n\n        file.close();\n    }\n    catch (std::exception e)\n    {\n        std::cerr &lt;&lt; \"Error: File or File Name Issues\" &lt;&lt; std::endl;\n    }\n\n    return strgstream.str();\n}\n    //use the Program Object we created in this current state(color)\nvoid ShaderProgram::use()\n{\n    if (mProgram != 0)\n        glUseProgram(mProgram);\n}\n\nvoid ShaderProgram::testProgramCompile() {\n    int status = 0;\n\n    GLuint program = mProgram;\n\n        // ///CHECKING GL_LINK_STATUS to see if Program Link was successul. Link Status will return GL_TRUE if it was\n        glGetProgramiv( mProgram, GL_LINK_STATUS, &amp;status); //requesting the status\n        if (status == GL_FALSE)\n        {\n\n            std::cerr &lt;&lt; \"Linking Error with Program \" &lt;&lt; std::endl;\n        }\n\n}\nvoid ShaderProgram :: testShaderCompile(GLuint shader) {\n    int status = 0;\n\n\n    // ///CHECKING GL_LINK_STATUS to see if Program Link was successul. Link Status will return GL_TRUE if it was\n    glGetProgramiv(shader, GL_LINK_STATUS, &amp;status); //requesting the status\n    if (status == GL_FALSE)\n    {\n\n        std::cerr &lt;&lt; \"Linking Error with Shader \" &lt;&lt; std::endl;\n    }\n\n}\n////GETTERS AND SETTERS\n\nGLuint ShaderProgram::getProgram() const\n{\n    return mProgram;\n}\n\n\n\nvoid ShaderProgram::setUniform(const GLchar* name, const glm::vec2&amp; v)\n{\n    GLint address = getUniformIdentifier(name);\n    glUniform2f(address, v.x, v.y);\n}\n\nvoid ShaderProgram::setUniform(const GLchar* name, const glm::vec3&amp; v)\n{\n    GLint address = getUniformIdentifier(name);\n    glUniform3f(address, v.x, v.y, v.z);\n}\n\nvoid ShaderProgram:: setUniform(const GLchar* name, const glm::vec4&amp; v) {\n    GLint address = getUniformIdentifier(name);\n    glUniform4f(address, v.x, v.y, v.z, v.w);\n}\n\n//Maybe need to switch places with setUniform\nGLint ShaderProgram :: getUniformIdentifier(const GLchar* name) {\n\n    std::map&lt;std::string, GLint&gt;::iterator it;\n    it = mUniformIdentifiers.find(name);\n    //std::map&lt;std::string, GLint&gt;\n\n\n        // Only need to query the shader program IF it doesn't already exist.\n        if (it == mUniformIdentifiers.end())\n        {\n            // Find it and add it to the map\n            mUniformIdentifiers[name] = glGetUniformLocation(mProgram, name);\n        }\n\n        // Return it\n        return mUniformIdentifiers[name];\n    }\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "c++11", "for-loop", "simplify"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1523468671, "post_id": 49779678, "comment_id": 86578168, "body": "You could save yourself a lot of time by using a debugger.  Single step through your code, and view the values in variables."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1523468918, "post_id": 49779678, "comment_id": 86578295, "body": "BTW, the statement <code>z = z;</code> has no effect and the compiler probably optimized it away."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "edited": false, "score": 0, "creation_date": 1523462981, "post_id": 49779766, "comment_id": 86575097, "body": "I understand that part but what I do not know how to to is just to put 1 code inside the for loop to do all the calculation. The first 2 numbers are the same, then the second number needs to be +2, then the 3rd number x2 , then the 4th number +2 and 5th number is the same as 4th , once this gets completed it will restart to the point that needs to start doing the +2,x2 (This is what I do not know how to do it inside the loop for)"}, {"owner": {"reputation": 378, "user_id": 9536611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3e89d805e62a01ae2f7b6fcb189d56?s=128&d=identicon&r=PG&f=1", "display_name": "platinum95", "link": "https://stackoverflow.com/users/9536611/platinum95"}, "reply_to_user": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "edited": false, "score": 1, "creation_date": 1523463211, "post_id": 49779766, "comment_id": 86575214, "body": "I assume this is a homework problem or something along those lines, so this isn&#39;t really the place to get people to do it for you, but anyway a simple solution is just to solve that short equation in the above answer for num1, i.e. 2 + (4 * num1) = 200"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "edited": false, "score": 0, "creation_date": 1523463641, "post_id": 49779766, "comment_id": 86575472, "body": "@JoshSama you are printing 4 numbers 200 times. 4*200 = 800 numbers. So if you want to print 200 numbers how many times the loop should be executed? That&#39;s basic school maths."}, {"owner": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "edited": false, "score": 0, "creation_date": 1523464016, "post_id": 49779766, "comment_id": 86575724, "body": "My apologizes , my intention is not to get the full exercise completed by someone else , I&#39;m new on c++ and I&#39;ve built the code from scratch but I was looking for suggestions because my knowledge was not enough to figure out how to do a function inside the loop for,  appreciate your answer and I&#39;ll try to use your response to build the code I need. Thank you"}, {"owner": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1523466088, "post_id": 49779766, "comment_id": 86576845, "body": "@Michael , the code in the loop was to test how the final data will look , I know from the begging that it will have more than 200 . I was just looking for any idea how to do what does 4 code lines do by using any other stament"}], "tags": [], "owner": {"reputation": 378, "user_id": 9536611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3e89d805e62a01ae2f7b6fcb189d56?s=128&d=identicon&r=PG&f=1", "display_name": "platinum95", "link": "https://stackoverflow.com/users/9536611/platinum95"}, "is_accepted": false, "score": 5, "last_activity_date": 1523462660, "creation_date": 1523462660, "answer_id": 49779766, "question_id": 49779678, "link": "https://stackoverflow.com/questions/49779678/dynamic-numerical-series/49779766#49779766", "title": "Dynamic numerical series", "body": "<p>You're looping 200 times, and each time you loop, you're printing out 4 different numbers. You're also printing twice at the start so thats 2 + 4 * 200 = 802, which is where your 802 number output is coming from.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "edited": false, "score": 0, "creation_date": 1523472459, "post_id": 49781687, "comment_id": 86580106, "body": "I do appreciate the fact that you took the time to explain me a different way to understand what the loop for needs to accomplish. I&#39;m still trying to understand how this codes gets the second number 1 because z=-1 and then it increments on +2 which will be 1,3 . Do I always needs to use long when the iterations are that high on the loop for?"}, {"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "reply_to_user": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "edited": false, "score": 0, "creation_date": 1523472721, "post_id": 49781687, "comment_id": 86580264, "body": "@JoshSama: We have four possibilities when we do <code>i % 4</code>, we can have either  <code>1 or 2 or 3 or 0</code>. In which calculate value only for three cases and for case <code>i % 4 = 2</code> , we don&#39;t say anything and the value for z remains the same. To see how <code>i%4</code> works, just print it."}, {"owner": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "edited": false, "score": 0, "creation_date": 1523475734, "post_id": 49781687, "comment_id": 86581799, "body": "You&#39;re a genius , I do understand better how the duplicate values are being populated and the correct data type for my variables :)"}], "tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": true, "score": 1, "last_activity_date": 1523469964, "last_edit_date": 1523469964, "creation_date": 1523469581, "answer_id": 49781687, "question_id": 49779678, "link": "https://stackoverflow.com/questions/49779678/dynamic-numerical-series/49781687#49781687", "title": "Dynamic numerical series", "body": "<blockquote>\n  <p>I assume is because of the code inside the \"for\" loop but I've hours\n  thinking on how to reduce that code to the job and I cannot think\n  anything else. I'm getting frustrated and need your help.</p>\n</blockquote>\n\n<p>So you basically wanna simplify your code. Which can be done by noticing the repetitions.\nThere you can find only two types of change in the series; either a <code>+2</code> or <code>x2</code> with the previous element.</p>\n\n<p>In each iteration this can be achieved by:</p>\n\n<ol>\n<li>If  reminder <code>i%4 == 1</code> or <code>i%4 == 3</code>, need an increment of 2 (assuming <code>1 &lt;= i &lt;= MAX</code>)</li>\n<li>If reminder <code>i%4 == 0</code>, nothing but a multiplication of 2.</li>\n</ol>\n\n<p>When you do like so, you can simply neglect, printing of first two ones and other complications in the total numbers in the series.</p>\n\n<p>Also not that, you are trying to get 200 terms of this series, which increases in each step very fast and exceed the maximum limit of <code>int</code>. Therefore, <code>long long</code> is needed to be used instead.</p>\n\n<p>The updated code will look like this: </p>\n\n<pre><code>#include &lt;iostream&gt;\ntypedef long long int int64;\nint main()\n{\n    int size = 200;\n    int64 z = -1;\n\n    for (int i = 1; i &lt;= size; i++)\n    {\n        if ((i % 4 == 1) || (i % 4 == 3))   z += 2;\n        else if (i % 4 == 0)                z *= 2;\n        std::cout &lt;&lt; z &lt;&lt; \"\\n\";\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>See the Output here: <a href=\"https://www.ideone.com/JiWB8W\" rel=\"nofollow noreferrer\">https://www.ideone.com/JiWB8W</a></p>\n"}], "owner": {"reputation": 29, "user_id": 4776799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKj1gOqUP08/AAAAAAAAAAI/AAAAAAAAAEA/tO3k0qgIKnU/photo.jpg?sz=128", "display_name": "Josh Sama", "link": "https://stackoverflow.com/users/4776799/josh-sama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 49781687, "answer_count": 2, "score": 1, "last_activity_date": 1577603525, "creation_date": 1523462418, "last_edit_date": 1577603525, "question_id": 49779678, "link": "https://stackoverflow.com/questions/49779678/dynamic-numerical-series", "title": "Dynamic numerical series", "body": "<p>I am trying to create a program to print first <code>200</code> elements following a specific numerical series condition which is </p>\n\n<pre><code>1-1-3-6-8-8-10-20\n</code></pre>\n\n<p>But instead of showing, just <code>200</code> elements is showing <code>802</code>. I assume is because of the code inside the <code>for</code> loop. I have hours thinking on how to reduce that code to the job and I cannot think anything else. I am getting frustrated and need your help.</p>\n\n<p>The exercise is on the code comments</p>\n\n<pre><code>//Print the following numerical series 1-1-3-6-8-8-10-20  until 200\n\n#include &lt;stdafx.h&gt;\n#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\nusing namespace std;\n\nint main()\n{\n    int Num1=200, z = 0, x = 1, y = 1;\n\n    cout &lt;&lt; \"\\n\\n1,\";\n    cout &lt;&lt; \" 1,\";\n\n    for (int i = 1; i &lt;= Num1; i++)\n    {\n        z = y + 2;\n        cout &lt;&lt; \" \" &lt;&lt; z &lt;&lt; \",\"; //It will print 3\n        z = z * 2;\n        cout &lt;&lt; \" \" &lt;&lt; z &lt;&lt; \",\";//It will print 6\n        z = z + 2;\n        cout &lt;&lt; \" \" &lt;&lt; z &lt;&lt; \",\";//It will print 8\n        z = z;\n        cout &lt;&lt; \" \" &lt;&lt; z &lt;&lt; \",\";//It will print 8\n        y = z;\n    }\n    cout &lt;&lt; \"\\n\\n\";\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1523461782, "post_id": 49779391, "comment_id": 86574287, "body": "The only place you assign to <code>m_root</code> is in the constructor."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9611040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f5c616352f0f6cccd66f40bd1209457?s=128&d=identicon&r=PG&f=1", "display_name": "Hana", "link": "https://stackoverflow.com/users/9611040/hana"}, "edited": false, "score": 0, "creation_date": 1523462322, "post_id": 49779460, "comment_id": 86574664, "body": "@R Sahu so if I understand correctly, in C i would pass a Node** in order to do the change? And here I need to pass a reference? Thanks"}, {"owner": {"reputation": 39, "user_id": 9611040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f5c616352f0f6cccd66f40bd1209457?s=128&d=identicon&r=PG&f=1", "display_name": "Hana", "link": "https://stackoverflow.com/users/9611040/hana"}, "edited": false, "score": 0, "creation_date": 1523465600, "post_id": 49779460, "comment_id": 86576611, "body": "one more question. In the destructor I will call a recursive function to deallocate all nodes. The function is           void BST&lt;Data&gt;::FreeNodes(Node* _root)    in this case should I also pass a reference to the pointer? Since here I am only dealing with the pointer itself and not what it points to, I assume I can pass a pointer? Thanks"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 5, "last_activity_date": 1523461836, "creation_date": 1523461836, "answer_id": 49779460, "question_id": 49779391, "link": "https://stackoverflow.com/questions/49779391/pointer-data-member-not-initialized/49779460#49779460", "title": "pointer data member not initialized", "body": "<blockquote>\n  <p>While debugging I see that each time I call the insert function the m_root data member is NULL, although after the the first insert it is not supposed to be null. so something in my insert is not correct.</p>\n</blockquote>\n\n<p>The first argument of <code>RecInsert</code> needs to be a reference to a <code>Node*</code>. Otherwise, any changes to <code>_root</code> in the function is only a local change.</p>\n\n<p>Declaration</p>\n\n<pre><code>void RecInsert(Node*&amp; _root, Data _item);\n               //  ^^^\n</code></pre>\n\n<p>Definition</p>\n\n<pre><code>template &lt;typename Data&gt;\nvoid BST&lt;Data&gt;::RecInsert(Node*&amp; _root, Data _item)\n                          //  ^^^\n{\n   ...\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9611040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f5c616352f0f6cccd66f40bd1209457?s=128&d=identicon&r=PG&f=1", "display_name": "Hana", "link": "https://stackoverflow.com/users/9611040/hana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 49779460, "answer_count": 1, "score": 1, "last_activity_date": 1523462692, "creation_date": 1523461627, "last_edit_date": 1523462692, "question_id": 49779391, "link": "https://stackoverflow.com/questions/49779391/pointer-data-member-not-initialized", "title": "pointer data member not initialized", "body": "<p>I am trying to implement a binary search tree class.\nThis is the code (header):</p>\n\n<pre><code>template &lt;typename Data&gt;\nclass BST\n{\npublic:\n    BST();\n    void Insert(Data _item);\n    //~BST(); TODO\n\n    struct Node\n    {\n        Node()\n        {m_left = m_right = 0;}\n\n        Data m_data;\n        Node* m_left;\n        Node* m_right;\n    };\n\n    Node* m_root;\n\nprivate:\n    void RecInsert(Node* _root, Data _item);\n    Node* CreateNode(Data _item);\n};\n\n\ntemplate &lt;typename Data&gt;\nBST&lt;Data&gt;::BST()\n: m_root(0)\n{\n}\n\n\ntemplate &lt;typename Data&gt;\nvoid BST&lt;Data&gt;::Insert(Data _item)\n{\n    RecInsert(m_root, _item);\n}\n\ntemplate &lt;typename Data&gt;\nvoid BST&lt;Data&gt;::RecInsert(Node* _root, Data _item)\n{\n    if (NULL == _root)\n    {\n        _root = CreateNode(_item);\n        return;\n    }\n    if(_item &lt; _root-&gt;m_data)\n    {\n        RecInsert(_root-&gt;m_left, _item);\n    }\n    else\n    {\n        RecInsert(_root-&gt;m_right, _item);\n    }\n}\n\ntemplate &lt;typename Data&gt;\ntypename BST&lt;Data&gt;::Node* BST&lt;Data&gt;::CreateNode(Data _item)\n{\n    Node* newNode = new Node();\n    newNode-&gt;m_data = _item;\n    newNode-&gt;m_left = newNode-&gt;m_right = 0;\n    return newNode;\n}\n</code></pre>\n\n<p>So basically my class holds Node* which initialized to null in the constructors and each time I insert an element, a new node is allocated. But it seems like I am doing something wrong. This is my test:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"bst.h\"\n\nusing namespace std;\nint main()\n{\n    BST&lt;int&gt; tree;\n    tree.Insert(4);\n    tree.Insert(11);\n    tree.Insert(1);\n\n    cout &lt;&lt; tree.m_root-&gt;m_data &lt;&lt; \"\\t\"; //segmentation fault!!\n    cout &lt;&lt; tree.m_root-&gt;m_left-&gt;m_data &lt;&lt; \"\\t\";\n    cout &lt;&lt; tree.m_root-&gt;m_right-&gt;m_data &lt;&lt; \"\\t\";\n}\n</code></pre>\n\n<p>I get a segmentation fault (see comment in the code for location).\nWhile debugging I see that each time I call the insert function the m_root data member is NULL, although after the the first insert it is not supposed to be null. so something in my insert is not correct.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c++11", "macros"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1523461672, "post_id": 49779364, "comment_id": 86574200, "body": "whats wrong with <code>__PRETTY_FUNCTION__</code> ?"}, {"owner": {"reputation": 522, "user_id": 7810036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6512fa2b14b58946d77c37dc1c300d16?s=128&d=identicon&r=PG&f=1", "display_name": "Surcle", "link": "https://stackoverflow.com/users/7810036/surcle"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1523461779, "post_id": 49779364, "comment_id": 86574285, "body": "It is too verbose, and it&#39;s not what I want. Like I said by using Windows I&#39;ve exactly <code>Foo&lt;int&gt;::f(int)</code>. So, I thought that I could have the same in g++"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1523461897, "post_id": 49779364, "comment_id": 86574360, "body": "I&#39;d say the gcc output is better - it tells you what <code>T</code> is. Why wouldn&#39;t you want that information?"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 4, "creation_date": 1523462034, "post_id": 49779364, "comment_id": 86574457, "body": "This feels possibly like an XY problem. What, <i>in detail</i>, are you using this for, such that <code>Foo&lt;int&gt;::f(int)</code> is sufficient but <code>T Foo&lt;T&gt;::f(int) [with T = int]</code> is not?"}, {"owner": {"reputation": 522, "user_id": 7810036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6512fa2b14b58946d77c37dc1c300d16?s=128&d=identicon&r=PG&f=1", "display_name": "Surcle", "link": "https://stackoverflow.com/users/7810036/surcle"}, "edited": false, "score": 0, "creation_date": 1523462202, "post_id": 49779364, "comment_id": 86574559, "body": "I don&#39;t need the return value and other information before the function name. I can have what I want in Windows, so I thought to have it in Windows too."}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 2, "creation_date": 1523463204, "post_id": 49779364, "comment_id": 86575210, "body": "You could always do some transformation if you don\u2019t like what you get."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1523472526, "post_id": 49779364, "comment_id": 86580148, "body": "btw those arent really macros but predefined variables. <a href=\"https://godbolt.org/g/iwZbN7\" rel=\"nofollow noreferrer\">I was playing a bit around</a> and first was a bit surprised why they wont expand when running the preprocessor only."}], "owner": {"reputation": 522, "user_id": 7810036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6512fa2b14b58946d77c37dc1c300d16?s=128&d=identicon&r=PG&f=1", "display_name": "Surcle", "link": "https://stackoverflow.com/users/7810036/surcle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1523461574, "creation_date": 1523461574, "question_id": 49779364, "link": "https://stackoverflow.com/questions/49779364/c-get-function-name-through-macro", "title": "C++ - Get function name through macro", "body": "<p>I'm trying to get the name of the function by using C++ macros. I'm using g++ 4.9.2 and with the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate&lt;typename T&gt;\nclass Foo {\npublic:\n        Foo() { }\n\n        T f(int i) {\n                T r;\n                std::cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; std::endl;\n                std::cout &lt;&lt; __FUNCTION__ &lt;&lt; std::endl;\n                std::cout &lt;&lt; __func__ &lt;&lt; std::endl;\n\n                return r;\n        }\n};\n\nint main() {\n        Foo&lt;int&gt; f;\n        f.f(1);\n\n        return 0;\n}\n</code></pre>\n\n<p>I got:</p>\n\n<pre><code>T Foo&lt;T&gt;::f(int) [with T = int]\nf\nf\n</code></pre>\n\n<p>I'd like to have something like <code>Foo&lt;T&gt;::f(int)</code> or <code>Foo&lt;int&gt;::f(int)</code> which I have in Windows by using <code>__FUNCTION__</code>. I tried to use <code>BOOST_CURRENT_FUNCTION</code>, but looking at the code I read that it should set the variable to the value of <code>__func__</code>.</p>\n\n<p>Obviously, it could be very simple to create a function that performs what I want, but I'd like to have a macro already set to the proper value.</p>\n"}, {"tags": ["c++", "list"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 2, "creation_date": 1523461686, "post_id": 49779298, "comment_id": 86574209, "body": "<code>getShots()</code> is returning a copy of the list, not a reference to it."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1523461687, "post_id": 49779298, "comment_id": 86574210, "body": "Because C++ doesn&#39;t work like Java. Copying objects actually copies the object."}, {"owner": {"reputation": 20517, "user_id": 8344060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UbPk.png?s=128&g=1", "display_name": "kvantour", "link": "https://stackoverflow.com/users/8344060/kvantour"}, "edited": false, "score": 1, "creation_date": 1523461703, "post_id": 49779298, "comment_id": 86574221, "body": "Sorry, this is not how StackOverflow works. Questions of the form &quot;Here&#39;s a bunch of my code, please debug it for me&quot; are considered off-topic. Please visit the <a href=\"https://stackoverflow.com/help\">help center</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> for more information."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1523461752, "post_id": 49779298, "comment_id": 86574261, "body": "I&#39;m tempted to vote to close this as caused by a simple typographic error because you didn&#39;t iterate by reference and hence only modified a copy of the element in the loop. I don&#39;t consider this a sufficiently advanced problem to make for a useful question."}, {"owner": {"reputation": 538, "user_id": 9564168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arkady Godlin", "link": "https://stackoverflow.com/users/9564168/arkady-godlin"}, "edited": false, "score": 2, "creation_date": 1523461995, "post_id": 49779298, "comment_id": 86574428, "body": "you are also missing delete operands, no idea why you want to create objects with new and then pass the by value, guess you coming from java/C# learn how to work in c++ code."}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1523462662, "post_id": 49779298, "comment_id": 86574892, "body": "Yeah, we don&#39;t use <code>new</code> anymore. Library code like <code>std::list</code> hides all that minutia.  In future, please post your code all in one great blob, not in fragments, or separate .h and .cpp files. No &quot;Ikea code&quot;. :-) Read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 2, "creation_date": 1523462313, "post_id": 49779432, "comment_id": 86574651, "body": "... and don&#39;t use <code>new</code>."}], "tags": [], "owner": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "is_accepted": true, "score": 2, "last_activity_date": 1523461762, "creation_date": 1523461762, "answer_id": 49779432, "question_id": 49779298, "link": "https://stackoverflow.com/questions/49779298/c-list-is-not-keeping-its-elements/49779432#49779432", "title": "C++ - List is not keeping its elements", "body": "<p>In each of your <code>for</code> loops, you're accessing the <code>list</code> elements by <em>value</em>, so you're effectively making a copy of what's in the <code>list</code>, modifying that, and then destroying it.  Change your loops to look like this:</p>\n\n<pre><code>for (TestUnit &amp;unit : testUnits)\n{\n    if (unit.getName() == (*testShot).getName())\n    {\n        unit.addShot(*testShot);\n        nShots1 = unit.getShots().size();\n    }\n}\n</code></pre>\n\n<p>Since you're using C++11 or later, you could also use <code>auto</code> instead of explicit typing (e.g., <code>auto &amp;unit: testUnits</code>).</p>\n"}], "owner": {"reputation": 11, "user_id": 5189980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/96oG7.jpg?s=128&g=1", "display_name": "Zargothrax", "link": "https://stackoverflow.com/users/5189980/zargothrax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1523488538, "accepted_answer_id": 49779432, "answer_count": 1, "score": -1, "last_activity_date": 1523461762, "creation_date": 1523461361, "last_edit_date": 1523461762, "question_id": 49779298, "link": "https://stackoverflow.com/questions/49779298/c-list-is-not-keeping-its-elements", "closed_reason": "Not suitable for this site", "title": "C++ - List is not keeping its elements", "body": "<p>I have 2 classes; TestUnit and TestShot.\nTestUnit needs to hold a list of TestShots, however when I reference the list later on all the elements I've given it have disappeared!</p>\n\n<p><strong>TestUnit.h</strong></p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;list&gt;\n#include \"TestShot.h\"\n\nusing namespace std;\n\nclass TestUnit\n{\npublic:\n    TestUnit(string);\n    string getName(void);\n    void addShot(TestShot);\n    list&lt;TestShot&gt; getShots(void);\n\n    bool operator == (const TestUnit&amp; tu) const { return name == tu.name; }\n    bool operator != (const TestUnit&amp; tu) const { return !operator==(tu); }\n\nprivate:\n    string name;\n    list&lt;TestShot&gt; shots;\n};\n</code></pre>\n\n<p><strong>TestUnit.cpp</strong></p>\n\n<pre><code>#include \"TestUnit.h\"\n\nTestUnit::TestUnit(string name)\n{\n    this-&gt;name = name;\n}\n\nstring TestUnit::getName(void)\n{\n    return name;\n}\n\nvoid TestUnit::addShot(TestShot shot)\n{\n    shots.push_front(shot);\n}\n\nlist&lt;TestShot&gt; TestUnit::getShots(void)\n{\n    return shots;\n}\n</code></pre>\n\n<p><strong>TestShot.h</strong></p>\n\n<pre><code>#include &lt;string&gt;\n\nusing namespace std;\n\nclass TestShot\n{\npublic:\n    TestShot(string);\n    string getName(void);\n\nprivate:\n    string name;\n};\n</code></pre>\n\n<p><strong>TestShot.cpp</strong></p>\n\n<pre><code>#include \"TestShot.h\"\n\nTestShot::TestShot(string name)\n{\n    this-&gt;name = name;\n}\n\nstring TestShot::getName(void)\n{\n    return name;\n}\n</code></pre>\n\n<p><strong>MAIN</strong></p>\n\n<pre><code>#include &lt;string&gt;\n\n#include \"exports.h\"\n#include \"TestUnit.h\"\n\nusing namespace std;\n\n// Global Variables\nlist&lt;TestUnit&gt; testUnits;\n\n\nint main()\n{\n    int nShots1 = 0;\n    int nShots2 = 0;\n\n    // Create Unit\n    TestUnit *testUnit = new TestUnit(\"Name\");\n    testUnits.push_front(*testUnit);\n\n    // Create Shot and add to Unit with same 'name'\n    TestShot *testShot = new TestShot(\"Name\");\n    for (TestUnit unit : testUnits)\n    {\n        if (unit.getName() == (*testShot).getName())\n        {\n            unit.addShot(*testShot);\n            nShots1 = unit.getShots().size();\n        }\n    }\n\n    // Display number of Shots for each Unit\n    for (TestUnit unit : testUnits)\n    {\n        nShots2 = unit.getShots().size();\n\n        std::cout &lt;&lt; nShots1 &lt;&lt; \", \" &lt;&lt; nShots2 &lt;&lt; std::endl;\n    }\n\n\n    system(\"PAUSE\");\n};\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1, 0\n</code></pre>\n\n<p>So the list realises that it's been populated straight after adding to it, but it's then empty when I need to use it.\nI'm guessing this is a scope problem, but I can't seem to figure it out.\nAll help is much appreciated!</p>\n"}, {"tags": ["c++", "constructor", "initialization"], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1523461825, "creation_date": 1523461825, "answer_id": 49779451, "question_id": 49779122, "link": "https://stackoverflow.com/questions/49779122/default-base-class-initializer/49779451#49779451", "title": "Default base class initializer", "body": "<blockquote>\n  <p>Is there a way to specify a default initializer for a base class in the class declaration?</p>\n</blockquote>\n\n<p>To do that in the class declaration itself would require making the base class have a template parameter, eg:</p>\n\n<pre><code>template &lt;size_t NumberOfLegs&gt;\nstruct Animal {\n    Animal() = default;\n    int legs{NumberOfLegs};\n};\n\nstruct Ant : Animal&lt;6&gt; {\n    Ant()               = default;\n    Ant(int size)       : size{size} {}\n    Ant(std::string s)  {}\n    int size{0};\n};\n\nstruct Spider : Animal&lt;8&gt; {\n    Spider()               = default;\n    Spider(int size)       : size{size} {}\n    Spider(std::string s)  {}\n    int size{0};\n};\n</code></pre>\n\n<p>But that means <code>Animal&lt;6&gt;</code> and <code>Animal&lt;8&gt;</code> are different class types, and you won't be able to pass around <code>Ant</code> and <code>Spider</code> objects where <code>Animal</code> is expected (without using more templates, that is). </p>\n\n<p>That being said, assuming you actually want <code>Animal</code> to be a distinct class you can derive from and pass around, I suggest you could give your <code>int</code> constructors default values and omit the <code>= default</code> constructors (and yes, you can use delegating constructors in this example), eg:</p>\n\n<pre><code>struct Animal {\n    Animal(int legs = 4) : legs{legs} {}\n    int legs;\n};\n\nstruct Ant : Animal {\n    Ant(int size = 0)   : Animal{6}, size(size) {}\n    Ant(std::string s)  : Ant(0) {}\n    int size;\n};\n\nstruct Spider : Animal {\n    Spider(int size = 0)   : Animal{8}, size{size} {}\n    Spider(std::string s)  : Spider(0) {}\n    int size;\n};\n</code></pre>\n"}], "owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 49779451, "answer_count": 1, "score": 0, "last_activity_date": 1523461825, "creation_date": 1523460825, "last_edit_date": 1523461357, "question_id": 49779122, "link": "https://stackoverflow.com/questions/49779122/default-base-class-initializer", "title": "Default base class initializer", "body": "<p>Is there a way to specify a default initializer for a base class in the class declaration?</p>\n\n<p>Say I have:</p>\n\n<pre><code>#include &lt;string&gt;\n\nstruct Animal {\n    Animal(int legs) : legs{legs} {}\n    Animal() = default;\n    int legs{4};\n};\n\nstruct Ant : Animal {\n    Ant(int size)       : Animal{6}, size{size} {}\n    Ant()               : Animal{6} {}\n    Ant(std::string s)  : Animal{6} {}\n    int size{0};\n};\n\nstruct Spider : Animal {\n    Spider(int size)       : Animal{8}, size{size} {}\n    Spider()               : Animal{8} {}\n    Spider(std::string s)  : Animal{8} {}\n    int size{0};\n};\n</code></pre>\n\n<p>Is there a way to specify a <em>default base initializer</em> similar to the <a href=\"http://en.cppreference.com/w/cpp/language/data_members\" rel=\"nofollow noreferrer\"><em>default member initializer</em></a>?</p>\n\n<p>Something like perhaps:</p>\n\n<pre><code>#include &lt;string&gt;\n\nstruct Animal {\n    Animal(int legs) : legs{legs} {}\n    Animal() = default;\n    int legs{4};\n};\n\nstruct Ant : Animal{6} {\n    Ant(int size)       : size{size} {}\n    Ant()                {}\n    Ant(std::string s)   {}\n    int size{0};\n};\n\nstruct Spider : Animal{8} {\n    Spider(int size)       : size{size} {}\n    Spider()                {}\n    Spider(std::string s)   {}\n    int size{0};\n};\n</code></pre>\n\n<p>I thought about using delegating constructors, but if there are multiple bases and different constructors where the same bases are not always default initialized then delegating constructors wouldn't help to simplify in the same way as a constructor <a href=\"http://en.cppreference.com/w/cpp/language/initializer_list\" rel=\"nofollow noreferrer\"><em>member initializer list</em></a> would do for members.</p>\n"}, {"tags": ["c++", "list", "pointers", "struct", "singly-linked-list"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523460717, "post_id": 49779051, "comment_id": 86573532, "body": "What is the &quot;non-linked list&quot;?"}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523460759, "post_id": 49779051, "comment_id": 86573568, "body": "@VladfromMoscow I meant not double-linked. I will edit it."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523460900, "post_id": 49779051, "comment_id": 86573662, "body": "Why SIZE is not a member of the structure?"}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523461061, "post_id": 49779051, "comment_id": 86573781, "body": "@VladfromMoscow Does it make any difference if it is ?"}, {"owner": {"reputation": 4457, "user_id": 6614295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2237f8dfeaec1273a07c97b3e1ebbde9?s=128&d=identicon&r=PG&f=1", "display_name": "jotasi", "link": "https://stackoverflow.com/users/6614295/jotasi"}, "edited": false, "score": 2, "creation_date": 1523461109, "post_id": 49779051, "comment_id": 86573812, "body": "Is there a strong reason for you to use that data structure and not one of the standard libraries container classes?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523461113, "post_id": 49779051, "comment_id": 86573816, "body": "@rollstapewz In this case you can not use more than one list in  program."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523461174, "post_id": 49779051, "comment_id": 86573871, "body": "@rollstapewz At least the condition in this if statement for (int j = i + 1; j &lt;= SIZE; j++) is wrong."}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "reply_to_user": {"reputation": 4457, "user_id": 6614295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2237f8dfeaec1273a07c97b3e1ebbde9?s=128&d=identicon&r=PG&f=1", "display_name": "jotasi", "link": "https://stackoverflow.com/users/6614295/jotasi"}, "edited": false, "score": 0, "creation_date": 1523461217, "post_id": 49779051, "comment_id": 86573896, "body": "@jotasi Yes there is. It is a homework assignment although I prefer the stl."}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523461317, "post_id": 49779051, "comment_id": 86573963, "body": "@VladfromMoscow Yeah, I have to use one list and I am pretty convinced the if statement in the second for loop is wrong and I can&#39;t seem to think of a way to write it properly..."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523461335, "post_id": 49779051, "comment_id": 86573975, "body": "@rollstapewz You should not rely on SIZE because you do not change it in the function when a node is deleted."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1523461483, "post_id": 49779051, "comment_id": 86574083, "body": "If your list had iterator support you could use <code>std::unique</code>."}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1523461525, "post_id": 49779051, "comment_id": 86574115, "body": "@JesperJuhl I am aware of that but I am not using stl to have a list as an object."}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523462036, "post_id": 49779051, "comment_id": 86574459, "body": "@VladfromMoscow So if I decrement size after successfully deleting an element would this solve the problem? Edit: Tried it and did not help."}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 1, "creation_date": 1523463076, "post_id": 49779051, "comment_id": 86575150, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> required. Otherwise, we can only guess."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1523463804, "post_id": 49779051, "comment_id": 86575583, "body": "@rollstapewz Your function is very confusing. You are using confusing names as for example pointer and mPointer"}, {"owner": {"reputation": 26889, "user_id": 369792, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fdc806d0a8834e57b2d9309849dea8cd?s=128&d=identicon&r=PG", "display_name": "Jason Goemaat", "link": "https://stackoverflow.com/users/369792/jason-goemaat"}, "edited": false, "score": 0, "creation_date": 1523490132, "post_id": 49779051, "comment_id": 86587201, "body": "Create a test list with 2 <i>equal</i> elements and 2 <i>unique</i> elements and debug your function, I think the problem will come to you pretty quickly..."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523461435, "post_id": 49779216, "comment_id": 86574044, "body": "pointer = pointer -&gt; next is assigned in the else statement if there is not a deleted element."}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523461490, "post_id": 49779216, "comment_id": 86574090, "body": "I have tried both conditions and it wont work."}, {"owner": {"reputation": 11128, "user_id": 425458, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/m6jHW.png?s=128&g=1", "display_name": "tel", "link": "https://stackoverflow.com/users/425458/tel"}, "reply_to_user": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523461590, "post_id": 49779216, "comment_id": 86574155, "body": "@rollstapewz You&#39;ll probably have to post a complete minimum working example in order to get any actual help here. There&#39;s a bunch of stuff it could be. As a piece of advice, if you don&#39;t know how to use a debugger, try just adding print statements so you can at least find out the value of <code>i</code> and <code>j</code> when it crashes"}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523461757, "post_id": 49779216, "comment_id": 86574265, "body": "What do you mean by &quot;complete minimum working example&quot; ? I copied the whole function. In the main thread I am only calling it ? What more than this?"}, {"owner": {"reputation": 11128, "user_id": 425458, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/m6jHW.png?s=128&g=1", "display_name": "tel", "link": "https://stackoverflow.com/users/425458/tel"}, "reply_to_user": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523462166, "post_id": 49779216, "comment_id": 86574534, "body": "@rollstapewz well, there&#39;s a very lovely article about <a href=\"https://stackoverflow.com/help/mcve\">minimal examples right here</a>. The gist of it though is that I need to be able to be able to reproduce your error in order to understand it. I assume when you actually run it you have an example list? I would need that. Otherwise random guessing really is the best anyone can do"}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523462377, "post_id": 49779216, "comment_id": 86574701, "body": "I edited it again. Hope it is more understandable right now."}], "tags": [], "owner": {"reputation": 11128, "user_id": 425458, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/m6jHW.png?s=128&g=1", "display_name": "tel", "link": "https://stackoverflow.com/users/425458/tel"}, "is_accepted": false, "score": 0, "last_activity_date": 1523461483, "last_edit_date": 1523461483, "creation_date": 1523461105, "answer_id": 49779216, "question_id": 49779051, "link": "https://stackoverflow.com/questions/49779051/deleting-duplicate-elements-in-a-list-in-c/49779216#49779216", "title": "Deleting duplicate elements in a list in c++", "body": "<p>At a guess, you're at some point comparing keys with an already deleted node. <del>For example, you're assigning <code>mPointer = pointer-&gt;next</code>, then possibly deleting <code>mpointer</code>, then at the end of the inner loop assigning <code>pointer = pointer-&gt;next</code>. So wouldn't it be possible for <code>pointer-&gt;next</code> to have already been deleted there?</del></p>\n\n<h1>Edit</h1>\n\n<p>Acutally it's much more likely that your inner loop condition is the problem. Try just:</p>\n\n<pre><code>for (int j = i + 1; j &lt; SIZE; j++)\n</code></pre>\n\n<p>instead.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523464021, "post_id": 49779990, "comment_id": 86575727, "body": "Okay, I will try this, thanks a lot. One thing I do not understand is what is the purpose of ostream &amp; ... ?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523464060, "post_id": 49779990, "comment_id": 86575747, "body": "@rollstapewz In this case you can write your list for example in a file."}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523464177, "post_id": 49779990, "comment_id": 86575827, "body": "Yes, but its not necessary ?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523464206, "post_id": 49779990, "comment_id": 86575848, "body": "@rollstapewz You can use your function to output the list. it is just a demonstrative program that shows how the function del_dup can be implemented."}, {"owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "edited": false, "score": 0, "creation_date": 1523465887, "post_id": 49779990, "comment_id": 86576755, "body": "It worked, modified it a bit for my needs. Thank you ! :)"}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1523530454, "last_edit_date": 1523530454, "creation_date": 1523463361, "answer_id": 49779990, "question_id": 49779051, "link": "https://stackoverflow.com/questions/49779051/deleting-duplicate-elements-in-a-list-in-c/49779990#49779990", "title": "Deleting duplicate elements in a list in c++", "body": "<p>For starters it is a bad idea to declare the variable <code>SIZE</code> outside the structure definition. In this case all functions that deal with the list will suffer from accessing to the global variable. You can not have more than one list in the program.</p>\n\n<p>You could \"wrap\" the structure node in one more structure as for example</p>\n\n<pre><code>struct node\n{\n    int key;\n    node *next;\n\n};\n\nstruct list\n{\n    node *head;\n    size_t /*int*/ size;\n};\n</code></pre>\n\n<p>In this case each list would have its one data member size.</p>\n\n<p>The function <code>del_dup</code> looks very confusing and you are using confusing names as for example <code>pointer</code> and <code>mPointer</code>. You should not rely on the variable SIZE that shall be decremented when a node is deleted. </p>\n\n<p>I can suggest the following function implementation.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n\nstruct node\n{\n    int key;\n    node *next;\n} *head = nullptr;\n\nsize_t size;\n\nvoid push_front( node * &amp;head, int key )\n{\n    head = new node { key, head };\n    ++size;\n}\n\nstd::ostream &amp; display_list( node * head, std::ostream &amp;os = std::cout  )\n{\n    os &lt;&lt; size &lt;&lt; \": \";\n\n    for ( const node *current = head; current; current = current-&gt;next )\n    {\n        os &lt;&lt; current-&gt;key &lt;&lt; ' ';\n    }\n\n    return os;\n}\n\nvoid del_dup( node * head )\n{\n    for ( node *first = head; first; first = first-&gt;next )\n    {\n        for ( node *current = first; current-&gt;next;  )\n        {\n            if ( current-&gt;next-&gt;key == first-&gt;key )\n            {\n                node *tmp = current-&gt;next;\n                current-&gt;next = current-&gt;next-&gt;next;\n                delete tmp;\n                --size;\n            }\n            else\n            {\n                current = current-&gt;next;\n            }\n        }\n    }\n}\n\nint main() \n{\n    const size_t N = 10;\n\n    std::srand( ( unsigned int )std::time( nullptr ) );\n\n    for ( size_t i = 0; i &lt; N; i++ )\n    {\n        push_front( head, std::rand() % ( int )N );\n    }\n\n    display_list( head ) &lt;&lt; std::endl;\n\n    del_dup( head );\n\n    display_list( head ) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output might look like</p>\n\n<pre><code>10: 2 2 3 3 8 5 6 2 6 1 \n6: 2 3 8 5 6 1 \n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9393981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5572783561da37cfc75569e29f6e443?s=128&d=identicon&r=PG&f=1", "display_name": "rollstapewz", "link": "https://stackoverflow.com/users/9393981/rollstapewz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1523490420, "accepted_answer_id": 49779990, "answer_count": 2, "score": -2, "last_activity_date": 1523530454, "creation_date": 1523460600, "last_edit_date": 1523463959, "question_id": 49779051, "link": "https://stackoverflow.com/questions/49779051/deleting-duplicate-elements-in-a-list-in-c", "closed_reason": "Not suitable for this site", "title": "Deleting duplicate elements in a list in c++", "body": "<p>I have a task to delete any duplicate elements from a list. I am using a struct and pointers for my functions. Here is the struct and the function: </p>\n\n<pre><code>struct node\n{\n    int key;\n    node *next;\n\n}*start = NULL;\n\nint SIZE = 0;\n</code></pre>\n\n<p>Where size increments when an item is added. There is the function for deleting duplicates:</p>\n\n<pre><code>void del_dup() \n{\n    if (!start) {\n        return;\n    }\n    if (SIZE == 1) {\n        return;\n    }\n\n    node * pointer = start-&gt;next;\n    node * prev = start;\n\n    node * mPointer = nullptr;\n    node * mPrev = nullptr;\n\n    for (int i = 0; i &lt; SIZE - 1; i++)\n    {\n        if (pointer-&gt;next) \n        {\n            mPointer = pointer-&gt;next;\n            mPrev = pointer;\n        }\n        for (int j = i + 1; j &lt;= SIZE; j++)\n        {\n                if (pointer-&gt;key == mPointer-&gt;key)\n                {\n                    mPrev-&gt;next = mPointer-&gt;next;\n\n                    delete mPointer;\n                }\n                else\n                {\n                    mPrev = mPointer;\n                    mPointer = mPointer-&gt;next;\n                }\n        }\n        prev = pointer;\n        pointer = pointer-&gt;next;\n    }\n}\n</code></pre>\n\n<p>The thing is I get a crash at the if statement to compare if the two elements match: </p>\n\n<pre><code>if (pointer-&gt;key == mPointer-&gt;key)\n</code></pre>\n\n<p>The error is access violation type and <strong>nullptr</strong> for <strong>mPointer</strong>.</p>\n\n<p>The list is filled from the user every time he runs the program with the values he wants. Here is the push function: </p>\n\n<pre><code>void push_start(int n) {\n    elem *p = start;\n    start = new elem;\n    start-&gt;key = n;\n    start-&gt;next = p;\n    SIZE++;\n}\n</code></pre>\n\n<p>Any help to fix this would be appreciated. Thanks in forward! </p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1523460571, "post_id": 49778998, "comment_id": 86573427, "body": "Why the double-spaced lines?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523460681, "post_id": 49778998, "comment_id": 86573504, "body": "You should make sure that <code>result</code> is never grater than or equal to 17576"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1523460808, "post_id": 49778998, "comment_id": 86573605, "body": "This is not enough <code>if (result == 17576) result -= 1;</code>"}, {"owner": {"reputation": 19, "user_id": 9586993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc962f4cccf0908e5898b4213a3bf02e?s=128&d=identicon&r=PG&f=1", "display_name": "Evan W.", "link": "https://stackoverflow.com/users/9586993/evan-w"}, "edited": false, "score": 0, "creation_date": 1523460953, "post_id": 49778998, "comment_id": 86573692, "body": "result cant ever be over 17576 because that is 26^3 and the math doesnt allow it to go over, also ust to test i said if( result &gt;= 17576) result = 0; and my compiler still crashed."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1523461056, "post_id": 49778998, "comment_id": 86573778, "body": "Looks program does not agree with your math, how many letters is in that vector?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1523461132, "post_id": 49778998, "comment_id": 86573835, "body": "@EvanW. <i>result cant ever be over 17576 be</i> -- Instead of making assumptions, actually check your program."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1523461136, "post_id": 49778998, "comment_id": 86573839, "body": "Use <code>freqs.at(result)</code> and validate, your &quot;math&quot; looks suspicios."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1523461204, "post_id": 49778998, "comment_id": 86573887, "body": "Note if <code>letters.size()</code> is 0 or 1 you are getting out of bounds"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1523461392, "post_id": 49778998, "comment_id": 86574014, "body": "<i>and my compiler still crashed.</i> -- There is nothing wrong with your compiler.  Your program has bugs and because of those bugs, your program crashes.  Time to learn how to use the debugger."}, {"owner": {"reputation": 19, "user_id": 9586993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc962f4cccf0908e5898b4213a3bf02e?s=128&d=identicon&r=PG&f=1", "display_name": "Evan W.", "link": "https://stackoverflow.com/users/9586993/evan-w"}, "edited": false, "score": 0, "creation_date": 1523462212, "post_id": 49778998, "comment_id": 86574565, "body": "the math checks out, the max number for &#39;zzz&#39; is 17575, but I found the error, in        if(((ch -&#39;a&#39;) &gt;= 0 &amp;&amp; (ch-&#39;a&#39;) &lt;= 26)) letters.push_back(ch); it should be to 25 not 26 otherwise the ascii table values got all messed up"}], "answers": [{"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 0, "last_activity_date": 1523462038, "creation_date": 1523462038, "answer_id": 49779540, "question_id": 49778998, "link": "https://stackoverflow.com/questions/49778998/double-free-or-corruption-error-cant-find-error/49779540#49779540", "title": "double free or corruption error (Can&#39;t find error?)", "body": "<p>I see 2 issues in your program.</p>\n\n<p>First:</p>\n\n<pre><code> for(size_t i = 0; i &lt; letters.size() - 2; i++)\n</code></pre>\n\n<p>condition for this loop should be improved:</p>\n\n<pre><code> for(size_t i = 0; i + 2 &lt; letters.size(); i++)\n</code></pre>\n\n<p>as <code>i</code> and <code>letters.size()</code> both unsigned, size of 1 or 0 will give underflow and out of bound access.</p>\n\n<p>Second issue we do not know your data set, but I do not see why <code>result</code> cannot become greater than <code>17576</code> (for example 26 'z' in <code>letters</code> would make it) so you should at least check for that and report diagnostics. You may do that with assert if you do not want that check to happen in release mode.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 9586993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc962f4cccf0908e5898b4213a3bf02e?s=128&d=identicon&r=PG&f=1", "display_name": "Evan W.", "link": "https://stackoverflow.com/users/9586993/evan-w"}, "is_accepted": true, "score": 0, "last_activity_date": 1523462285, "creation_date": 1523462285, "answer_id": 49779627, "question_id": 49778998, "link": "https://stackoverflow.com/questions/49778998/double-free-or-corruption-error-cant-find-error/49779627#49779627", "title": "double free or corruption error (Can&#39;t find error?)", "body": "<p>I found the solution, the math for result checks out, I had checked that numerous times, but the issue is        </p>\n\n<pre><code>if(((ch -'a') &gt;= 0 &amp;&amp; (ch-'a') &lt;= 26)) letters.push_back(ch); \n</code></pre>\n\n<p>this it should be 25 not 26 otherwise it would take the ascii value one above Z aswell which would then allow it to go over 17576 making an error. Thank you though for all your input I appreciate the help</p>\n"}], "owner": {"reputation": 19, "user_id": 9586993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc962f4cccf0908e5898b4213a3bf02e?s=128&d=identicon&r=PG&f=1", "display_name": "Evan W.", "link": "https://stackoverflow.com/users/9586993/evan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 49779627, "answer_count": 2, "score": 1, "last_activity_date": 1523462285, "creation_date": 1523460436, "last_edit_date": 1523460707, "question_id": 49778998, "link": "https://stackoverflow.com/questions/49778998/double-free-or-corruption-error-cant-find-error", "title": "double free or corruption error (Can&#39;t find error?)", "body": "<p>I'm trying to create a class that will read from a file and calculate frequencies of trigrams, but for some reason I get this double free or corruption error and it crashes Visual Studio Code for me.</p>\n\n<p>this is the .cpp</p>\n\n<pre><code>frequency::frequency(std::ifstream &amp;infile)\n{\n  freqValue(infile);\n}\n\nstd::vector&lt;int&gt; frequency::freqValue(std::ifstream &amp;infile)\n{\n   std::vector&lt;int&gt; freqs(17576);\n   char ch;\n   while(infile.get(ch))\n   {\n       ch = tolower(ch);\n       if(((ch -'a') &gt;= 0 &amp;&amp; (ch-'a') &lt;= 26)) letters.push_back(ch);\n   }\n\n   int result = 0;\n   for(size_t i = 0; i &lt; letters.size() - 2; i++)\n   {\n       result += ((int) (letters[i] - 'a') *676);\n       result += ((int)(letters[i + 1] - 'a') * 26);\n       result += ((int)(letters[i+2] - 'a'));\n       if (result == 17576) result -= 1;\n       freqs[result] += 1;\n       std::cout &lt;&lt; freqs[result];\n       result = 0;\n   }\n   return freqs;\n}\n</code></pre>\n\n<p>this is the main</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    if(argc &gt; 0)\n    {\n        std::ifstream infile;\n        infile.open(argv[0]);\n        frequency i(infile);\n        return 0;\n    }\n}\n</code></pre>\n\n<p>and the header</p>\n\n<pre><code>class frequency\n{\nprivate:\n   std::vector&lt;char&gt; letters;\n   std::vector&lt;int&gt; frequencies;\n\npublic:\n   frequency(std::ifstream &amp;infile);\n   std::vector&lt;int&gt; freqValue(std::ifstream &amp;infile);\n};\n\n#endif\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "c++11", "c++14", "atomic"], "comments": [{"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1523460509, "post_id": 49778967, "comment_id": 86573369, "body": "<code>std::atomic&lt;&gt;::load</code> does not return a reference, so you are simply incrementing a temporary, that is no race condition, but I doubt this is what you want..."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1523460543, "post_id": 49778967, "comment_id": 86573399, "body": "You probably simply want <code>int currentId = ++clientId;</code>."}, {"owner": {"reputation": 355, "user_id": 3397816, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tpAs8.jpg?s=128&g=1", "display_name": "Trinopoty", "link": "https://stackoverflow.com/users/3397816/trinopoty"}, "edited": false, "score": 0, "creation_date": 1523460585, "post_id": 49778967, "comment_id": 86573440, "body": "Put your <code>clientId</code> declaration outside of the function. Putting it inside a function means that a new object will be created every time, defeating it&#39;s purpose. Answering your question, it&#39;s the job of the <code>atomic</code> to prevent race conditions and the such."}, {"owner": {"reputation": 589, "user_id": 1206657, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2531cc3a25fe668da0d28d8481fbab20?s=128&d=identicon&r=PG", "display_name": "Rajeev Mehta", "link": "https://stackoverflow.com/users/1206657/rajeev-mehta"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523460644, "post_id": 49778967, "comment_id": 86573480, "body": "@Jarod42 Can clientId be incremented once again by another thread before it&#39;s coped into currentId?"}], "answers": [{"comments": [{"owner": {"reputation": 589, "user_id": 1206657, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2531cc3a25fe668da0d28d8481fbab20?s=128&d=identicon&r=PG", "display_name": "Rajeev Mehta", "link": "https://stackoverflow.com/users/1206657/rajeev-mehta"}, "edited": false, "score": 0, "creation_date": 1523461001, "post_id": 49779047, "comment_id": 86573724, "body": "Thanks. But in this case, Can clientId be incremented once again by another thread before it&#39;s copied into currentId?"}], "tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": true, "score": 4, "last_activity_date": 1523461013, "last_edit_date": 1523461013, "creation_date": 1523460586, "answer_id": 49779047, "question_id": 49778967, "link": "https://stackoverflow.com/questions/49778967/modify-and-read-from-an-atomic-variable/49779047#49779047", "title": "Modify and read from an atomic variable", "body": "<p><code>std::atomic&lt;int&gt;::load()</code> does not return a reference, so you are not incrementing the current value of <code>clientId</code>, you are incrementing the temporary returned by <code>load()</code>.</p>\n\n<p>You need to do:</p>\n\n<pre><code>int currentId = ++clientId; // no .load()\n</code></pre>\n\n<p>There are <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic/operator_arith\" rel=\"nofollow noreferrer\">overloaded operators</a> for <code>std::atomic</code>. The memory order for the pre-increment operator is <a href=\"http://en.cppreference.com/w/cpp/atomic/memory_order\" rel=\"nofollow noreferrer\"><code>std:: memory_order_seq_cst</code></a><sup>1</sup>, which says:</p>\n\n<blockquote>\n  <p>A load operation with this memory order performs an acquire operation, a store performs a release operation, and read-modify-write performs both an acquire operation and a release operation, plus a single total order exists in which all threads observe all modifications in the same order (see Sequentially-consistent ordering below)</p>\n</blockquote>\n\n<p>So you are safe from data-race condition here.</p>\n\n<p><sub><sup>1</sup> The standard says that <code>++clientId</code> is equivalent to <code>fetch_add(1) + 1</code>, and the default memory order for <code>fetch_add</code> is <code>std::memory_order_seq_cst</code>.</sub></p>\n"}], "owner": {"reputation": 589, "user_id": 1206657, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2531cc3a25fe668da0d28d8481fbab20?s=128&d=identicon&r=PG", "display_name": "Rajeev Mehta", "link": "https://stackoverflow.com/users/1206657/rajeev-mehta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 49779047, "answer_count": 1, "score": 0, "last_activity_date": 1523461013, "creation_date": 1523460340, "last_edit_date": 1523460732, "question_id": 49778967, "link": "https://stackoverflow.com/questions/49778967/modify-and-read-from-an-atomic-variable", "title": "Modify and read from an atomic variable", "body": "<p>A class has the following member,</p>\n\n<pre><code>std::atomic&lt;int&gt; clientId{0};\n</code></pre>\n\n<p>And given the following inside it's member function,</p>\n\n<pre><code>int currentId = ++clientId.load();\n</code></pre>\n\n<p>Is there a race condition here? I am trying to do something similar to generate clientId's. Multiple threads could execute this part of the code. Can a thread that has incremented clientId and before it tries to load() and get a copy, another thread increment the same and thus end up with a race condition?\nIf yes, is protecting with a mutex the best way using an ordinary int and getting a copy inside the mutex?</p>\n\n<p>Please explain.  </p>\n"}, {"tags": ["c++", "qt", "c++11", "qml"], "answers": [{"tags": [], "owner": {"reputation": 612, "user_id": 6921622, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d40276838381d3c015ab20af339f4b23?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Angel Pons", "link": "https://stackoverflow.com/users/6921622/miguel-angel-pons"}, "is_accepted": false, "score": 0, "last_activity_date": 1523462791, "creation_date": 1523462791, "answer_id": 49779807, "question_id": 49778780, "link": "https://stackoverflow.com/questions/49778780/share-c-object-instances-with-qml/49779807#49779807", "title": "Share C++ object instances with QML", "body": "<p>Other option is to store in a singleton object the QQmlContext</p>\n\n<p>then, register objects</p>\n\n<pre><code>SingletonContext::instance()-&gt;Context()-&gt;setContextProperty(\"Plclink\",&amp;m_link );\n</code></pre>\n\n<p>the problem is tha I can access to functions from QTCreator, and Q_ENUM variables are not registered</p>\n\n<p>example:\nwith setContextProperty</p>\n\n<pre><code>onActivated: {\n                    Plclink.setvaluechanged(Plclink.DB_PROGRAMA ,Plclink.DBW_ENCURSO,index )\n                }\n</code></pre>\n\n<p>fails (Q_ENUM DB_PROGRAMA  is always 0)</p>\n\n<p>but with </p>\n\n<pre><code>static plclink *slink=&amp;m_link;\nqmlRegisterSingletonType&lt;plclink&gt;(\"Plclink\", 1, 0, \"Plclink\", [](QQmlEngine *engine, QJSEngine *scriptEngine) -&gt; QObject * {\n    Q_UNUSED(engine) Q_UNUSED(scriptEngine)\n            return slink;\n});\n</code></pre>\n\n<p>and </p>\n\n<pre><code>  import Plclink 1.0\n</code></pre>\n\n<p>works fine</p>\n"}], "owner": {"reputation": 612, "user_id": 6921622, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d40276838381d3c015ab20af339f4b23?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Angel Pons", "link": "https://stackoverflow.com/users/6921622/miguel-angel-pons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577620032, "creation_date": 1523459742, "last_edit_date": 1577620032, "question_id": 49778780, "link": "https://stackoverflow.com/questions/49778780/share-c-object-instances-with-qml", "title": "Share C++ object instances with QML", "body": "<p>I have a logical business in C++11 and I need to expose and SHARE some C++ QObjetcts with QML UI.</p>\n\n<p>I use a fake-singleton approach to expose these objects with a lambda and static variable :</p>\n\n<pre><code>static classname *static_pointer=&amp;non_singleton_QObject_instance;\n\nqmlRegisterSingletonType&lt;classname&gt;(\"ClassName\", 1, 0, \"ClassName\", \n     [](QQmlEngine *engine, QJSEngine *scriptEngine) -&gt; QObject * {\n             Q_UNUSED(engine) Q_UNUSED(scriptEngine) \n             return static_pointer;\n });\n</code></pre>\n\n<p>It works fine, but when application exits I get errors, because\nC++ objects are destroyed by <code>QGuiApplication</code> before <code>QQmlApplicationEngine</code> destructor.</p>\n\n<p>When <code>QQmlApplicationEngine</code>  tries to access these fake-singleton objects in his destructor, I get a crash.</p>\n\n<p>I can solve it skiping QQmlApplicationEngine with an exit(0) call, but I'm looking for a more elegant solution.</p>\n"}, {"tags": ["c++", "templates", "compiler-errors", "fold"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 2, "creation_date": 1523459963, "post_id": 49778731, "comment_id": 86572977, "body": "&quot;that comparing an <code>int*</code> and a <code>float*</code> is considered the same as comparing a pointer and an integer&quot; -- That&#39;s just because <code>a &lt; b &lt; c</code> means <code>(a &lt; b) &lt; c</code>, no? Comparing an <code>int *</code> and a <code>float *</code> produces an <code>int</code> (edit: a <code>bool</code> of course. I was thinking of C). Comparing <i>that</i> to a <code>float *</code> is an error. This seems like a minor detail not relevant for your main question."}, {"owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "edited": false, "score": 0, "creation_date": 1523459975, "post_id": 49778731, "comment_id": 86572982, "body": "As to the second problem, I realize now that chaining comparison operators doesn&#39;t have the intuitive meaning and results in comparing a <code>bool</code> and a pointer / @hvd: thanks, indeed it is only a minor detail."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1523459978, "post_id": 49778731, "comment_id": 86572987, "body": "You cannot overload <code>operator &lt;(int*, float*)</code> or even <code>operator &lt;(float*, float*)</code>. I suspect error 2 come from that."}, {"owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523460104, "post_id": 49778731, "comment_id": 86573075, "body": "@Jarod42: so I must say goodbye to my fair <code>fold expression</code>? because if I can use my custom operator only on custom types, it won&#39;t cover every iterator, since pointers are iterators."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1523460224, "post_id": 49778731, "comment_id": 86573156, "body": "As usual, you can do it with extra layer: <code>(Wrapper&lt;Iterators&gt;() &lt; ...)</code>"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1523460372, "post_id": 49778731, "comment_id": 86573273, "body": "What is the original problem you are trying to solve? Looking at your snippet, it looks like you are trying to use <code>operator&lt;</code> to compare types in a strange way... There are easier ways to do this."}, {"owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1523461142, "post_id": 49778731, "comment_id": 86573847, "body": "@Holt: I&#39;m working on composite iterators, like <code>chain_iterator</code> or <code>zip_iterator</code> for instance. That&#39;s why I need to find the &#39;common denominator&#39; of a list of iterator types, which would be the least powerful one. I could then deduce optimal <code>iterator_traits</code> and other behaviors."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1523461411, "post_id": 49778731, "comment_id": 86574029, "body": "@papagaga I do understand that, but I find it weird to use a comparison operator (<code>operator&lt;</code>) to find the weakest type from a list of types. It is more conventional to use a template with <code>::type</code> typedefs for this kind of stuff, and usually easier to implement."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1523461904, "post_id": 49778731, "comment_id": 86574366, "body": "@papagaga <a href=\"https://godbolt.org/g/75fThc\" rel=\"nofollow noreferrer\">Here</a> is an example equivalent to your snippet without using <code>operator&lt;</code> (you could replace <code>std::conditional</code> with specializations, I do not know what your actual implementation looks like). This feels more &quot;standard&quot; to me, and clean... But maybe that&#39;s just my opinion ;)"}, {"owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1523462672, "post_id": 49778731, "comment_id": 86574900, "body": "@Holt: your code is quite readable and clean, I agree. I&#39;m looking for a less &#39;layered&#39; style of code - by that I mean that you have one template <code>struct</code> and two specializations where I have only one operator. / you didn&#39;t notice that you changed the semantics though (right fold instead of left fold)."}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1523464182, "post_id": 49778731, "comment_id": 86575831, "body": "The first question is interesting, though the whole question seems too broad (you asked two questions)..."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523465394, "post_id": 49778731, "comment_id": 86576504, "body": "With which version of clang do you have issue ? with clang 3.8 c++1z, No issue with this template."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523465442, "post_id": 49778731, "comment_id": 86576527, "body": "Notice that <code>vit</code> can be <code>int*</code> or custom class."}, {"owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523544507, "post_id": 49778731, "comment_id": 86613858, "body": "@Jarod42: clang 7.0. I&#39;ve tested it with 3.8 c++1.z, and it doesn&#39;t accept <code>if constexpr</code>, so I&#39;m a bit unsure of what you&#39;ve tested."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523552810, "post_id": 49778731, "comment_id": 86619145, "body": "I have to simplify code for <code>3.8</code> indeed, maybe I simplify it too much..."}], "owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1523505689, "creation_date": 1523459584, "question_id": 49778731, "link": "https://stackoverflow.com/questions/49778731/template-operator-visibility-gcc-vs-clang", "title": "template operator visibility, gcc vs clang", "body": "<p>I have this code, relying on a fold expression calling a very generic comparison operator:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;vector&gt;\n#include &lt;list&gt;\n\ntemplate &lt;typename Iter_a, typename Iter_b&gt;\nauto operator&lt;(Iter_a, Iter_b) {\n    // original code makes more sense, I assure you\n    if constexpr  ( std::is_same_v&lt;Iter_a, Iter_b&gt; ) { \n        return Iter_a();\n    }\n    else return Iter_b();\n}\n\ntemplate &lt;typename... Iterators&gt;\nusing weakest_iterator = std::decay_t&lt;decltype( (Iterators() &lt; ...) )&gt;;\n\nint main() {\n    using lit = std::list&lt;int&gt;::iterator;\n    using vit = std::vector&lt;int&gt;::iterator;\n    using wi = weakest_iterator&lt;lit, vit, float*&gt;;\n}\n</code></pre>\n\n<p>I have two problems with this code:</p>\n\n<p>The first is that g++ compiles it and clang++ (<code>-std=gnu++2a</code>) refuses to do so:</p>\n\n<pre><code>prog.cc:14:64: error: call to function 'operator&lt;' that is neither visible in the template definition nor found by argument-dependent lookup\nusing weakest_iterator = std::decay_t&lt;decltype( (Iterators() &lt; ...) )&gt;;\n                                                               ^\nprog.cc:19:16: note: in instantiation of template type alias 'weakest_iterator' requested here\n    using wi = weakest_iterator&lt;lit, vit, float*&gt;;\n               ^\nprog.cc:6:6: note: 'operator&lt;' should be declared prior to the call site\nauto operator&lt;(Iter_a, Iter_b) {\n</code></pre>\n\n<p>Do you have any idea why? I find particularly troubling that clang requests a definition prior to the call site at line 19, that it finds by itself at line 6.</p>\n\n<p>The second is that, if I modify it to invoke my meta-function with pointer template arguments (<code>using wi = weakest_iterator&lt;int*, float*, float*&gt;;</code>, I get another error message, this time only with g++ since clang refuses to compile, that I find difficult to really understand:</p>\n\n<pre><code>main.cpp: In substitution of 'template&lt;class ... Iterators&gt; using weakest_iterator = std::decay_t&lt;decltype ((Iterators() &lt; ...))&gt; [with Iterators = {int*, float*, float*}]':\n\nmain.cpp:19:57:   required from here\n\nmain.cpp:14:75: error: ISO C++ forbids comparison between pointer and integer [-fpermissive]\n\n     using weakest_iterator = std::decay_t&lt;decltype( (Iterators() &lt; ...) )&gt;;\n</code></pre>\n\n<p>It seems that 1) the built-in overload of <code>operator&lt;</code> is called (if there is anything such as this) over my ultra-generic one, and 2) that comparing an <code>int*</code> and a <code>float*</code> is considered the same as comparing a pointer and an integer.</p>\n\n<p>Is it possible to make sure that my own implementation of <code>operator&lt;</code> is chosen by the compiler? </p>\n"}, {"tags": ["c++", "memory-management", "heap-memory", "huge-pages"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1523460347, "post_id": 49778717, "comment_id": 86573251, "body": "I&#39;m not going to lie - I&#39;m curious on why you need all 1TB loaded in memory at once; rather than loading only a few MB; processing that; then loading the next!"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1523462054, "post_id": 49778717, "comment_id": 86574466, "body": "The <a href=\"https://www.kernel.org/doc/Documentation/vm/hugetlbpage.txt\" rel=\"nofollow noreferrer\">monospaced type</a> does talk about the need for mounting the hugetlbfs when memory is allocated with mmap().  It has a size parameter.  So a rough guess is that you don&#39;t like how ::operator new is implemented."}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1523574738, "post_id": 49778717, "comment_id": 86629077, "body": "It might be a limitation of the C++ run time library?"}, {"owner": {"reputation": 291, "user_id": 9531032, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213008629704124/picture?type=large", "display_name": "Fredrik Tegenfeldt", "link": "https://stackoverflow.com/users/9531032/fredrik-tegenfeldt"}, "edited": false, "score": 1, "creation_date": 1523630184, "post_id": 49778717, "comment_id": 86653796, "body": "Thanks for the comments! UKMonkey - it&#39;s a code  processing large amount of genetic data and the algo needs random access over the whole DB."}, {"owner": {"reputation": 291, "user_id": 9531032, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213008629704124/picture?type=large", "display_name": "Fredrik Tegenfeldt", "link": "https://stackoverflow.com/users/9531032/fredrik-tegenfeldt"}, "edited": false, "score": 0, "creation_date": 1523630551, "post_id": 49778717, "comment_id": 86654010, "body": "I&#39;ve looked also at the mounting - it does not seem to be that. I tested it by setting the cgroup hugepage limit to a low value (16G) - the program then crashed with bus error. I&#39;ve tried looking into the std c++ library and not found anything, but it may very well be I&#39;m asking the wrong questions"}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523965455, "post_id": 49778717, "comment_id": 86769861, "body": "How much swap space does your server have?  Unless memory is <code>mmap()</code> with <code>MAP_NORESERVE</code>, some swap space has to be available."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1523965649, "post_id": 49778717, "comment_id": 86770012, "body": "There is nothing wrong in the code, mmap fail with &quot;ENOMEM No memory is available.&quot;, no need to check the code. &quot;write(2, &quot;: WARNING: New heap segment map &quot;..., 79) = 79&quot; look like map can&#39;t allocate a new segment. Did you do a memory check ?"}, {"owner": {"reputation": 291, "user_id": 9531032, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213008629704124/picture?type=large", "display_name": "Fredrik Tegenfeldt", "link": "https://stackoverflow.com/users/9531032/fredrik-tegenfeldt"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523966585, "post_id": 49778717, "comment_id": 86770685, "body": "@AndrewHenle it has 2G swap. I ran the same piece of code, 3 instances in parallel. All 3 ended at the same amount of memory - 128G. Hence it looks like a process related limit (or as mentioned above - a limit in c++  run time lib). But before I activated hugepages, I ran a process that used 400G of memory."}, {"owner": {"reputation": 291, "user_id": 9531032, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213008629704124/picture?type=large", "display_name": "Fredrik Tegenfeldt", "link": "https://stackoverflow.com/users/9531032/fredrik-tegenfeldt"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1523966644, "post_id": 49778717, "comment_id": 86770722, "body": "@Stargateur they did a full memcheck before delivering the server."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523967237, "post_id": 49778717, "comment_id": 86771144, "body": "@FredrikTegenfeldt If you think it&#39;s a limitation of the C++ runtime, can you can try allocating huge pages directly with C-style <code>malloc()</code>?  Or even a C executable so that you don&#39;t even link in a C++ runtime, much less use it?"}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 9531032, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213008629704124/picture?type=large", "display_name": "Fredrik Tegenfeldt", "link": "https://stackoverflow.com/users/9531032/fredrik-tegenfeldt"}, "edited": false, "score": 1, "creation_date": 1524038724, "post_id": 49878305, "comment_id": 86804048, "body": "Great! I knew there was something simple I had missed. This solves my issue. My  test code now goes beyond the 128G limit. Many thanks!!"}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 27, "last_activity_date": 1523972873, "last_edit_date": 1523972873, "creation_date": 1523968529, "answer_id": 49878305, "question_id": 49778717, "link": "https://stackoverflow.com/questions/49778717/c-application-fails-allocating-more-hugepages-than-a-certain-limit/49878305#49878305", "title": "c++ application fails allocating more hugepages than a certain limit", "body": "<blockquote>\n  <p>However the application crashes with a std::bad_alloc exception at 128G allocated (or 65536 pages).</p>\n</blockquote>\n\n<p>You are allocating too many small-sized segments, there is a limit of the number of map segments you can get per process.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>sysctl -n vm.max_map_count\n</code></pre>\n\n<p>You are trying to use <code>1024 * 512 * 4 == 2097152</code> MAP at least and one more for the array, but the default value of <code>vm.max_map_count</code> is only 65536.</p>\n\n<p>You can change it with:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>sysctl -w vm.max_map_count=3000000\n</code></pre>\n\n<p>Or you could allocate a bigger segment in your code.</p>\n"}], "owner": {"reputation": 291, "user_id": 9531032, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213008629704124/picture?type=large", "display_name": "Fredrik Tegenfeldt", "link": "https://stackoverflow.com/users/9531032/fredrik-tegenfeldt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1337, "favorite_count": 4, "accepted_answer_id": 49878305, "answer_count": 1, "score": 28, "last_activity_date": 1523972873, "creation_date": 1523459551, "last_edit_date": 1523965063, "question_id": 49778717, "link": "https://stackoverflow.com/questions/49778717/c-application-fails-allocating-more-hugepages-than-a-certain-limit", "title": "c++ application fails allocating more hugepages than a certain limit", "body": "<h1>Overview</h1>\n\n<p>I have a c++ application that reads large amount of data (~1T). I run it using hugepages (614400 pages at 2M) and this works - until it hits 128G.</p>\n\n<p>For testing I created a simple application in c++ that allocates chunks of 2M until it can't.</p>\n\n<p>Application is run using:</p>\n\n<pre><code>LD_PRELOAD=/usr/lib64/libhugetlbfs.so HUGETLB_MORECORE=yes ./a.out\n</code></pre>\n\n<p>While running I monitor the nr of free hugepages (from <em>/proc/meminfo</em>).\nI can see that it consumes hugepages at the expected rate.</p>\n\n<p>However the application crashes with a <em>std::bad_alloc</em> exception at 128G allocated (or 65536 pages).</p>\n\n<p>If I run two or more instances at the same time, they all crash at 128G each.</p>\n\n<p>If I decrease the cgroup limit to something small, say 16G, the app crashes correctly at that point with a 'bus error'.</p>\n\n<p>Am I missing something trivial? Please look below for details.</p>\n\n<p>I'm running out of ideas...</p>\n\n<h1>Details</h1>\n\n<p>Machine, OS and software:</p>\n\n<pre><code>CPU    :  Intel(R) Xeon(R) CPU E5-2650 v4 @ 2.20GHz\nMemory :  1.5T\nKernel :  3.10.0-693.5.2.el7.x86_64 #1 SMP Fri Oct 20 20:32:50 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nOS     :  CentOS Linux release 7.4.1708 (Core)\n\nhugetlbfs : 2.16-12.el7\ngcc       : 7.2.1 20170829\n</code></pre>\n\n<p>Simple test code I used (allocates chunks of 2M until free hugepages is below a limit)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;vector&gt;\n#include &lt;array&gt;\n#include &lt;string&gt;\n\n\n#define MEM512K 512*1024ul\n#define MEM2M   4*MEM512K\n\n// data block\ntemplate &lt;size_t N&gt;\nstruct DataBlock {\n  char data[N];\n};\n\n// Hugepage info\nstruct HugePageInfo {\n  size_t memfree;\n  size_t total;\n  size_t free;\n  size_t size;\n  size_t used;\n  double used_size;\n};\n\n// dump hugepage info\nvoid dumpHPI(const HugePageInfo &amp; hpi) {\n  std::cout &lt;&lt; \"HugePages total : \" &lt;&lt; hpi.total &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"HugePages free  : \" &lt;&lt; hpi.free &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"HugePages size  : \" &lt;&lt; hpi.size &lt;&lt; std::endl;\n}\n\n// dump hugepage info in one line\nvoid dumpHPIline(const size_t i, const HugePageInfo &amp; hpi) {\n  std::cout &lt;&lt; i &lt;&lt; \" \"\n            &lt;&lt; hpi.memfree &lt;&lt; \" \"\n            &lt;&lt; hpi.total-hpi.free &lt;&lt; \" \"\n        &lt;&lt; hpi.free &lt;&lt; \" \"\n            &lt;&lt; hpi.used_size\n            &lt;&lt; std::endl;\n}\n\n// get hugepage info from /proc/meminfo\nvoid getHugePageInfo( HugePageInfo &amp; hpi ) {\n  std::ifstream fmeminfo;\n\n  fmeminfo.open(\"/proc/meminfo\",std::ifstream::in);\n  std::string line;\n  size_t n=0;\n  while (fmeminfo.good()) {\n    std::getline(fmeminfo,line);\n    const size_t sep = line.find_first_of(':');\n    if (sep==std::string::npos) continue;\n\n    const std::string lblstr = line.substr(0,sep);\n    const size_t      endpos = line.find(\" kB\");\n    const std::string trmstr = line.substr(sep+1,(endpos==std::string::npos ? line.size() : endpos-sep-1));\n    const size_t      startpos = trmstr.find_first_not_of(' ');\n    const std::string valstr = (startpos==std::string::npos ? trmstr : trmstr.substr(startpos) );\n    if (lblstr==\"HugePages_Total\") {\n      hpi.total = std::stoi(valstr);\n    } else if (lblstr==\"HugePages_Free\") {\n      hpi.free = std::stoi(valstr);\n    } else if (lblstr==\"Hugepagesize\") {\n      hpi.size = std::stoi(valstr);\n    } else if (lblstr==\"MemFree\") {\n      hpi.memfree = std::stoi(valstr);\n    }\n  }\n  hpi.used = hpi.total - hpi.free;\n  hpi.used_size = double(hpi.used*hpi.size)/1024.0/1024.0;\n}\n// allocate data\nvoid test_rnd_data() {\n  typedef DataBlock&lt;MEM2M&gt; elem_t;\n  HugePageInfo hpi;\n  getHugePageInfo(hpi);\n  dumpHPIline(0,hpi);\n  std::array&lt;elem_t *,MEM512K&gt; memmap;\n  for (size_t i=0; i&lt;memmap.size(); i++) memmap[i]=nullptr;\n\n  for (size_t i=0; i&lt;memmap.size(); i++) {\n    // allocate a new 2M block\n    memmap[i] = new elem_t();\n\n    // output progress\n    if (i%1000==0) {\n      getHugePageInfo(hpi); \n      dumpHPIline(i,hpi);\n      if (hpi.free&lt;1000) break;\n    }\n  }\n  std::cout &lt;&lt; \"Cleaning up....\" &lt;&lt; std::endl;\n  for (size_t i=0; i&lt;memmap.size(); i++) {\n    if (memmap[i]==nullptr) continue;\n    delete memmap[i];\n  }\n}\n\nint main(int argc, const char** argv) {\n  test_rnd_data();\n}\n</code></pre>\n\n<p>Hugepages is setup at boot time to use 614400 pages at 2M each.</p>\n\n<p>From /proc/meminfo:</p>\n\n<pre><code>MemTotal:       1584978368 kB\nMemFree:        311062332 kB\nMemAvailable:   309934096 kB\nBuffers:            3220 kB\nCached:           613396 kB\nSwapCached:            0 kB\nActive:           556884 kB\nInactive:         281648 kB\nActive(anon):     224604 kB\nInactive(anon):    15660 kB\nActive(file):     332280 kB\nInactive(file):   265988 kB\nUnevictable:           0 kB\nMlocked:               0 kB\nSwapTotal:       2097148 kB\nSwapFree:        2097148 kB\nDirty:                 0 kB\nWriteback:             0 kB\nAnonPages:        222280 kB\nMapped:            89784 kB\nShmem:             18348 kB\nSlab:             482556 kB\nSReclaimable:     189720 kB\nSUnreclaim:       292836 kB\nKernelStack:       11248 kB\nPageTables:        14628 kB\nNFS_Unstable:          0 kB\nBounce:                0 kB\nWritebackTmp:          0 kB\nCommitLimit:    165440732 kB\nCommitted_AS:    1636296 kB\nVmallocTotal:   34359738367 kB\nVmallocUsed:     7789100 kB\nVmallocChunk:   33546287092 kB\nHardwareCorrupted:     0 kB\nAnonHugePages:         0 kB\nHugePages_Total:   614400\nHugePages_Free:    614400\nHugePages_Rsvd:        0\nHugePages_Surp:        0\nHugepagesize:       2048 kB\nDirectMap4k:      341900 kB\nDirectMap2M:    59328512 kB\nDirectMap1G:    1552941056 kB\n</code></pre>\n\n<p>Limits from ulimit:</p>\n\n<pre><code>core file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nscheduling priority             (-e) 0\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 6191203\nmax locked memory       (kbytes, -l) 1258291200\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 1024\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nreal-time priority              (-r) 0\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 4096\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n</code></pre>\n\n<p>cgroup limit:</p>\n\n<pre><code>&gt; cat /sys/fs/cgroup/hugetlb/hugetlb.2MB.limit_in_bytes\n9223372036854771712\n</code></pre>\n\n<h1>Tests</h1>\n\n<p>Output when running the test code using HUGETLB_DEBUG=1:</p>\n\n<pre><code>...\nlibhugetlbfs [abc:185885]: INFO: Attempting to map 2097152 bytes\nlibhugetlbfs [abc:185885]: INFO: ... = 0x1ffb200000\nlibhugetlbfs [abc:185885]: INFO: hugetlbfs_morecore(2097152) = ...\nlibhugetlbfs [abc:185885]: INFO: heapbase = 0xa00000, heaptop = 0x1ffb400000, mapsize = 1ffaa00000, delta=2097152\nlibhugetlbfs [abc:185885]: INFO: Attempting to map 2097152 bytes\nlibhugetlbfs [abc:185885]: WARNING: New heap segment map at 0x1ffb400000 failed: Cannot allocate memory\nterminate called after throwing an instance of 'std::bad_alloc'\n  what():  std::bad_alloc\nAborted (core dumped)\n</code></pre>\n\n<p>Using strace:</p>\n\n<pre><code>...\nmmap(0x1ffb400000, 2097152, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_HUGETLB, -1, 0x1ffa200000) = 0x1ffb400000\nmmap(0x1ffb600000, 2097152, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_HUGETLB, -1, 0x1ffa400000) = 0x1ffb600000\nmmap(0x1ffb800000, 2097152, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_HUGETLB, -1, 0x1ffa600000) = 0x1ffb800000\nmmap(0x1ffba00000, 2097152, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_HUGETLB, -1, 0x1ffa800000) = 0x1ffba00000\nmmap(0x1ffbc00000, 2097152, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_HUGETLB, -1, 0x1ffaa00000) = -1 ENOMEM (Cannot allocate memory)\nwrite(2, \"libhugetlbfs\", 12)            = 12\nwrite(2, \": WARNING: New heap segment map \"..., 79) = 79\nmmap(NULL, 3149824, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = -1 ENOMEM (Cannot allocate memory)\nmmap(NULL, 134217728, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_NORESERVE, -1, 0) = -1 ENOMEM (Cannot allocate memory)\nmmap(NULL, 67108864, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_NORESERVE, -1, 0) = -1 ENOMEM (Cannot allocate memory)\nmmap(NULL, 134217728, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_NORESERVE, -1, 0) = -1 ENOMEM (Cannot allocate memory)\nmmap(NULL, 67108864, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_NORESERVE, -1, 0) = -1 ENOMEM (Cannot allocate memory)\nmmap(NULL, 2101248, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = -1 ENOMEM (Cannot allocate memory)\nwrite(2, \"terminate called after throwing \"..., 48) = 48\nwrite(2, \"std::bad_alloc\", 14)          = 14\nwrite(2, \"'\\n\", 2)                      = 2\nwrite(2, \"  what():  \", 11)             = 11\nwrite(2, \"std::bad_alloc\", 14)          = 14\nwrite(2, \"\\n\", 1)                       = 1\nrt_sigprocmask(SIG_UNBLOCK, [ABRT], NULL, 8) = 0\ngettid()                                = 188617\ntgkill(188617, 188617, SIGABRT)         = 0\n--- SIGABRT {si_signo=SIGABRT, si_code=SI_TKILL, si_pid=188617, si_uid=1001} ---\n</code></pre>\n\n<p>Finally in /proc/<em>pid</em>/numa_maps:</p>\n\n<pre><code>...\n1ffb000000 default file=/anon_hugepage\\040(deleted) huge anon=1 dirty=1 N1=1 kernelpagesize_kB=2048\n1ffb200000 default file=/anon_hugepage\\040(deleted) huge anon=1 dirty=1 N1=1 kernelpagesize_kB=2048\n1ffb400000 default file=/anon_hugepage\\040(deleted) huge anon=1 dirty=1 N1=1 kernelpagesize_kB=2048\n1ffb600000 default file=/anon_hugepage\\040(deleted) huge anon=1 dirty=1 N1=1 kernelpagesize_kB=2048\n1ffb800000 default file=/anon_hugepage\\040(deleted) huge anon=1 dirty=1 N1=1 kernelpagesize_kB=2048\n...\n</code></pre>\n"}, {"tags": ["c++", "eclipse", "eclipse-cdt", "header-files", "undefined-reference"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1523458607, "post_id": 49778341, "comment_id": 86571945, "body": "Um, do you have an <code>#endif</code> at the bottom your <code>a.h</code> file?"}, {"owner": {"reputation": 31, "user_id": 9625223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c8933f45216b3d24a9b570794800935?s=128&d=identicon&r=PG&f=1", "display_name": "Attila the Pun", "link": "https://stackoverflow.com/users/9625223/attila-the-pun"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1523468456, "post_id": 49778341, "comment_id": 86578040, "body": "That was a typo. Mia culpa"}], "answers": [{"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1523459103, "creation_date": 1523459103, "answer_id": 49778563, "question_id": 49778341, "link": "https://stackoverflow.com/questions/49778341/undefined-reference-error-with-eclipse-c/49778563#49778563", "title": "Undefined reference error with Eclipse (C++)", "body": "<p>The problem is that <code>main.cpp</code> sees only the definition of the class in the header <code>a.h</code> that does not contain definitions of the constructor and of the member function.</p>\n\n<p>in <code>A.cpp</code> these function are defined but by default they are defined as inline functions. So again main.cpp does not see their definitions.</p>\n\n<p>Take into account that according to the C++ Standard (3.2 One definition rule)</p>\n\n<blockquote>\n  <p>6 There can be more than one definition of a class type (Clause 9),\n  enumeration type (7.2), inline function with external linkage (7.1.2),\n  class template (Clause 14), non-static function template (14.5.6),\n  static data member of a class template (14.5.1.3), member function of\n  a class template (14.5.1.1), or template specialization for which some\n  template parameters are not specified (14.7, 14.5.5) in a program\n  provided that each definition appears in a different translation unit,\n  and provided the definitions satisfy the following requirements. Given\n  such an entity named D defined in more than one translation unit, then</p>\n  \n  <p><strong>(6.1) \u2014 each definition of D shall consist of the same sequence of\n  tokens</strong>; and</p>\n</blockquote>\n\n<p>So in A.cpp you should write</p>\n\n<pre><code>#include \"a.h\"\n\n\n  A::A(int i1, int i2) {\n     i = i1;\n     j = i2;\n  }\n\n  int A::sum() {\n     return (i+j);          \n  }\n</code></pre>\n\n<p>Also a class definition shall be ended with a semicolon.</p>\n"}, {"tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 0, "last_activity_date": 1523459183, "creation_date": 1523459183, "answer_id": 49778591, "question_id": 49778341, "link": "https://stackoverflow.com/questions/49778341/undefined-reference-error-with-eclipse-c/49778591#49778591", "title": "Undefined reference error with Eclipse (C++)", "body": "<p>That's not how you split the public interface and private implementation of a class in C++.</p>\n\n<p>In order for this code in main to compile</p>\n\n<pre><code>   A a(1,2);\n</code></pre>\n\n<p>the compiler needs to already know the size of <code>A</code> - this is because the storage is allocated locally, even if the constructor called to initialize it is defined elsewhere.</p>\n\n<p>You can avoid this coupling by using pointers (preferably smart ones) or the pimpl idiom, but that's the default.</p>\n\n<p>This means the definition of your class in the header must be</p>\n\n<pre><code>class A {\n    int i;\n    int j;\n\npublic:\n    A(int i1, int i2);\n    int sum();\n};\n</code></pre>\n\n<p>(note the <code>'</code> at the end of the class definition, which is important - you also need to be sure you terminated your include guards with an <code>#endif</code>).</p>\n\n<p>The implementation cpp file should then look like</p>\n\n<pre><code>#include \"a.h\"\n\nA::A(int i1, int i2) : i(i1), j(i2)\n{\n}\n\nint A::sum()\n{\n  return (i+j);          \n}\n</code></pre>\n\n<p>You're only allowed to <em>define</em> <code>A</code> once, so you can't have a different definition in the header and in the implementation file.</p>\n\n<p>Now those issues are fixed: if your original error persists, the residual problem is probably with your compile/link setup.</p>\n"}, {"tags": [], "owner": {"reputation": 11128, "user_id": 425458, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/m6jHW.png?s=128&g=1", "display_name": "tel", "link": "https://stackoverflow.com/users/425458/tel"}, "is_accepted": false, "score": 0, "last_activity_date": 1523459412, "creation_date": 1523459412, "answer_id": 49778671, "question_id": 49778341, "link": "https://stackoverflow.com/questions/49778341/undefined-reference-error-with-eclipse-c/49778671#49778671", "title": "Undefined reference error with Eclipse (C++)", "body": "<p>The stuff that everyone is saying about definitions is true. But there are a couple of other problems as well: </p>\n\n<ul>\n<li>you need a semicolon <code>;</code> after the closing brace of a class definition</li>\n<li>you need an <code>#endif</code> directive after the <code>#ifndef</code> (usually goes at the very end of a header file)</li>\n<li>even with <code>#include &lt;iostream&gt;</code>, <code>cout</code> does not get exported to the top-level namespace. You have to refer to it as <code>std::cout</code></li>\n</ul>\n\n<p>Here's a complete working example. It's one file, but you can split it up yourself if you want to:</p>\n\n<pre><code>#ifndef A_H_\n#define A_H_\n\nclass A {\n   private:\n\n      int i;\n      int j;\n\n   public:\n      A(int i1, int i2);\n      int sum();\n};\n#endif\n\nA::A(int i1, int i2) {\n    i = i1;\n    j = i2;\n}\n\nint A::sum() {\n    return (i+j);          \n}\n\n#include &lt;iostream&gt;\n\nint main() {\n   A a(1,2);\n   std::cout &lt;&lt; a.sum();\n   return 0;\n}\n</code></pre>\n\n<p><a href=\"https://tio.run/##fZBNasMwEIX3OsWAF7Gp2zRZyk5Bu94iqJJcxthjY0nZlJ7dHVlOCRQ6IJif7z2NZOb52QyaPte1wI6s60Bd36@i4AzJ5UIw4T0o@BIAMC9408FJkQoOpADYPBR9s43m@DGgkftAlRt3qjN/rh4VPo4lN74bUTiy2AmhpPyjyNcDwoW7Wd6n/MxKIRLEqs1qJxcX4kJQ4lNfNfAbiS6QzBCtgxYnHxanx7dsMWqku4ECXZ5qXhWOx0j5Ryy7dm5xZByECQ73RWs@1SGpfLBSmikGaFvQL/lt/zsk5jahzQb72q/8rHX9AQ\" rel=\"nofollow noreferrer\">Try it out online yourself</a></p>\n"}], "owner": {"reputation": 31, "user_id": 9625223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c8933f45216b3d24a9b570794800935?s=128&d=identicon&r=PG&f=1", "display_name": "Attila the Pun", "link": "https://stackoverflow.com/users/9625223/attila-the-pun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 49778563, "answer_count": 3, "score": 1, "last_activity_date": 1523468695, "creation_date": 1523458443, "last_edit_date": 1523468695, "question_id": 49778341, "link": "https://stackoverflow.com/questions/49778341/undefined-reference-error-with-eclipse-c", "title": "Undefined reference error with Eclipse (C++)", "body": "<p>I have been learning C++, and have been using some test code to debug pieces of a much larger project. I am trying to use an object from another file, but I keep getting an undefined reference error despite having included the appropriate header file. I am using Eclipse with the C++ CDT on Linux. The code looks something like the following:</p>\n\n<p>A.cpp</p>\n\n<pre><code>class A {\n\n   private:\n\n      int i;\n      int j;\n\n   public:\n\n      A(int i1, int i2) {\n         i = i1;\n         j = i2;\n      }\n\n      int sum() {\n         return (i+j);          \n      }\n};\n</code></pre>\n\n<p>a.h</p>\n\n<pre><code>#ifndef A_H_\n#define A_H_\n\nclass A {\n   public:\n      A(int i1, int i2);\n      int sum();\n};\n#endif\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"a.h\"\n\nint main() {\n   A a(1,2); //undefined reference to 'A::A(int,int)'\n   std::cout &lt;&lt; a.sum(); //undefined reference to 'A::sum(void)'\n   return 0;\n}\n</code></pre>\n\n<p>Is this a problem with my syntax, or do I need to go digging around in the compiler?</p>\n"}, {"tags": ["c++", "c++11", "c++14", "language-lawyer", "c++17"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1523598498, "post_id": 49778240, "comment_id": 86634713, "body": "You note the existence of old questions such as <a href=\"https://stackoverflow.com/q/21867617/1708801\">Best platform independent pi constant?</a>. If you worry they are out of date you could always set a bounty on one of them asking for answers based on C++17 etc...   Then all the answers would be in one place. Why is still a good question but perhaps this should focus on why and asking for up to date should be a bounty on existing questions."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1565021918, "post_id": 49778240, "comment_id": 101211445, "body": "I think it may worth adding new answers since C++20 added a pi constant as far as I know"}, {"owner": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1565022138, "post_id": 49778240, "comment_id": 101211522, "body": "@GuillaumeRacicot i updated the question. Not sure if we should address C++20 since it&#39;s not officially out yet."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1570659418, "post_id": 49778240, "comment_id": 102986905, "body": "@GuillaumeRacicot: It\u2019s a bit late to add one\u2026"}], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 6, "creation_date": 1523459143, "post_id": 49778398, "comment_id": 86572353, "body": "You might want to add <code>inline</code> for C++17+."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 8, "creation_date": 1523459730, "post_id": 49778398, "comment_id": 86572808, "body": "Ta. Have an upvote, but note that your definition is still vulnerable to imprecision with platforms with different definitions of <code>double</code>. C# has it easy since the <code>double</code> type is fixed. If I were on the C++ standards committee I&#39;d propose something like <code>std::constants&lt;double&gt;::pi</code>"}, {"owner": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 12, "creation_date": 1523460772, "post_id": 49778398, "comment_id": 86573575, "body": "@Deduplicator isn&#39;t constexpr implicitly inline as well...?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1523461734, "post_id": 49778398, "comment_id": 86574243, "body": "@Bathsheba: <code>double</code> is IEEE double on any reasonable implementation (and any where C conforms to Annex F; I&#39;m not sure if C++ has an analogue but it should). There is no good reason to treat <code>double</code> as a type whose precision could vary. Use <code>long double</code> if you want that."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 4, "creation_date": 1523461865, "post_id": 49778398, "comment_id": 86574337, "body": "@R. Fair enough, although you should static assert on <code>std::numeric_limits&lt;double&gt;::is_iec559;</code> in that case. Which, I confess, is what I have in my &quot;master header&quot;. Note that formally you need to check all the floating point types separately. Just because one is IEEE754 doesn&#39;t mean they all are."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "edited": false, "score": 1, "creation_date": 1523463926, "post_id": 49778398, "comment_id": 86575673, "body": "@snb: For functions, and since C++17 which allowed it and introduced inline-variables, sure, <code>constexpr</code> implies <code>inline</code>. But <b>namespace-level declarations didn&#39;t suddenly change their meaning</b>."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "edited": false, "score": 1, "creation_date": 1523467858, "post_id": 49778398, "comment_id": 86577741, "body": "@snb  <code>constexpr</code> <i>does not imply</i> <code>inline</code> for namespace scope variable [dcl.constexpr]: <i>A function or <b>static data member</b> declared with the constexpr specifier is implicitly an inline function or variable</i>"}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1523559404, "post_id": 49778398, "comment_id": 86622587, "body": "What about something like <code>0x3.243F6A8885A308D3p+0</code> which would make it absolutely clear how many bits of precision you&#39;re giving?"}, {"owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "reply_to_user": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 2, "creation_date": 1523612432, "post_id": 49778398, "comment_id": 86642035, "body": "@DanielSchepler So, what is that &quot;number&quot; supposed to be? I didn&#39;t know there are double numbers with 16 base."}], "tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 34, "last_activity_date": 1610139561, "last_edit_date": 1610139561, "creation_date": 1523458597, "answer_id": 49778398, "question_id": 49778240, "link": "https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi/49778398#49778398", "title": "Does C++11, 14, 17 or 20 introduce a standard constant for pi?", "body": "<p>Up to C++20, no, none of the standards introduced the constant that would represent the <a href=\"https://en.wikipedia.org/wiki/Pi\" rel=\"nofollow noreferrer\">number pi</a> (\u03c0). You can approximate the number in your code:</p>\n<pre><code>constexpr double pi = 3.14159265358979323846;\n</code></pre>\n<p>Other languages such as C# <a href=\"https://msdn.microsoft.com/en-us/library/system.math.pi(v=vs.110).aspx\" rel=\"nofollow noreferrer\">have</a> the constant declared in their libraries.</p>\n<p><strong>Update:</strong>\nStarting with the C++20, there indeed is a <code>pi</code> constant declared inside the <code>&lt;numbers&gt;</code> header. It is accessed via: <code>std::numbers::pi</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1523459771, "post_id": 49778493, "comment_id": 86572844, "body": "As someone suggested, there&#39;s also <code>const long double PI = acosl(-1.0L);</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 10, "creation_date": 1523459803, "post_id": 49778493, "comment_id": 86572871, "body": "@Lundin: But that can&#39;t be a <code>constexpr</code> unfortunately, which is why I say &quot;Defining it with a trig function is a pain &quot;"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 9, "creation_date": 1523461631, "post_id": 49778493, "comment_id": 86574180, "body": "Why does it matter? Pi is a constant, not subject to change or anything implementation-specific. Just write out the value (in a const object if you like) to the number of places significant for <code>double</code> (or some ridiculous number if you care about hypothetical really-long long doubles)."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 10, "creation_date": 1523461717, "post_id": 49778493, "comment_id": 86574236, "body": "@R..The problem I have with that is what appears ridiculous now can become perfectly sane in 20 years time or so. (Bill Gates&#39; 640k springs to mind). I trust Boost to keep up with architecture evolution."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1523464999, "post_id": 49778493, "comment_id": 86576300, "body": "Memorizing the value of pi is much easier than memorizing the formula. (although I have not attempted to memorize the formula at all...)"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 22, "creation_date": 1523465236, "post_id": 49778493, "comment_id": 86576421, "body": "@Bathsheba But is that actually relevant? As far as I understand, <a href=\"https://physics.stackexchange.com/a/9631/147\">~40 digits of pi are enough precision, and will always be enough precision, for any calculation to achieve sub-atomic precision on the scale of the whole Universe.</a>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1523465633, "post_id": 49778493, "comment_id": 86576626, "body": "@KonradRudolph - I thought it was in the 80s: based on the log of the number of cubes of 1 Planck length making up the observable universe. I wonder if anyone has a closer number? And I couldn\u2019t help noticing that you\u2019ve edited your comment; doubling the number! If you double it again you\u2019re at where I\u2019m at!"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1523465735, "post_id": 49778493, "comment_id": 86576680, "body": "@Bathsheba I only vaguely remembered, and updated the number when I found a reference."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 2, "creation_date": 1523465852, "post_id": 49778493, "comment_id": 86576735, "body": "@KonradRudolph - which is a pitiful answer indeed: plenty of physics happens on a sub-proton scale. For now my Planck length cube argument holds and the quality of SO answers is evidently better than the ones on the fizzix site."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 5, "creation_date": 1523466031, "post_id": 49778493, "comment_id": 86576815, "body": "@Bathsheba I don\u2019t think a lot of physics (or <i>any</i>, actually) requires simultaneous precision at sub-proton and macroscopic (Universe) scale. In other words, the dynamic range in that (admittedly, not well written) answer is already exaggerated for all practical purposes. That said, I\u2019m open to be told otherwise."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 3, "creation_date": 1523466189, "post_id": 49778493, "comment_id": 86576886, "body": "@KonradRudolph: You\u2019re absolutely correct but C++ prides itself on being a general purpose language, so if you need unusual floating point accuracy then it ought to be able to provide it. A lot of physics gets bogged down with the fact that Newton\u2019s G is known to woeful precision."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 3, "creation_date": 1523466903, "post_id": 49778493, "comment_id": 86577242, "body": "How much need would there be for pi, if the standard library included a set of trig functions measured angles in units of 2pi radians?  While there are a few purposes involving derivatives, integrals, and differential equations, for which radians are useful, for most purposes involving actual angles they&#39;re just about the worst unit imaginable."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 3, "creation_date": 1523467083, "post_id": 49778493, "comment_id": 86577346, "body": "@supercat: it pops up all over the place. Probability, financial mathematics, solutions using complex number libraries being some applications. C++ is a general purpose language and, as such, IMHO should have pi in its standard."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 3, "creation_date": 1523467804, "post_id": 49778493, "comment_id": 86577720, "body": "@Bathsheba: Yeah, I guess radians end up being a natural unit for some kinds of operations on complex numbers because of Euler&#39;s equality, but it still irks me that there aren&#39;t any trig functions that are intended for use with actual <i>angles</i>.  Having a graphics &quot;rotate&quot; transform use radians, for example, strikes me as just plain dumb, since likely as not the angle is going to be some multiple of pi/4, but rotating four times by pi/4 doesn&#39;t quite yield the original orientation."}, {"owner": {"reputation": 19090, "user_id": 138772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32504cb73cc05b26335a43219fff3a79?s=128&d=identicon&r=PG", "display_name": "JAB", "link": "https://stackoverflow.com/users/138772/jab"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 2, "creation_date": 1523481527, "post_id": 49778493, "comment_id": 86584589, "body": "@supercat You should be using quaternions for rotations anyway."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 10, "creation_date": 1523493490, "post_id": 49778493, "comment_id": 86587928, "body": "@KonradRudolph: A high-precision <i>pi</i> matters if implementing range-reduction.  For example, x86/x87&#39;s internal Pi constant (full 64-bit mantissa) leads to a worst-case error for small inputs to the <code>fsin</code> instruction of  <a href=\"https://randomascii.wordpress.com/2014/10/09/intel-underestimates-error-bounds-by-1-3-quintillion/\" rel=\"nofollow noreferrer\">&quot;about 1.37 quintillion units in the last place, leaving fewer than four bits correct&quot;</a>, and it&#39;s even worse for large inputs where range-reduction wraps around multiple times.  This is somewhat tangential to constants used for <code>long double</code> in C++, but neat anyway."}, {"owner": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 2, "creation_date": 1523528359, "post_id": 49778493, "comment_id": 86602236, "body": "@KonradRudolph: Numerical evaluation of functions and constants requiring 5000 decimal digits has been used with the PSQL algorithm to deduce insights into theoretical physics and reduce evaluation of multidimensional integrals to compile-time constants. See David Bailey&#39;s work on this. Boost.math computes pi dynamically unless it&#39;s in a list of precomputed types; this would be a requirement for any C++ standard value of pi."}, {"owner": {"reputation": 13461, "user_id": 680359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39501f826ecf65950b455b670a78c58a?s=128&d=identicon&r=PG", "display_name": "emsr", "link": "https://stackoverflow.com/users/680359/emsr"}, "edited": false, "score": 0, "creation_date": 1523543666, "post_id": 49778493, "comment_id": 86613216, "body": "As a simple experiment, plot <code>sin(pi*x)</code> with pi specified to 16 digits for double.  Watch the zeros of sin drift by <code>x * epsilon()</code>.  It would be good to have <code>sin_pi()</code>, etc. but sometimes you just need pi because your problem doesn&#39;t present as x*pi. You might well need higher than working precision pi to prevent this aliasing.  This could be implemented with constexpr expression templates for fundamental types.  The pi object for fundamental types might be an unevaluated sum of the float type - a polynomial in epsilon() if you will."}, {"owner": {"reputation": 13461, "user_id": 680359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39501f826ecf65950b455b670a78c58a?s=128&d=identicon&r=PG", "display_name": "emsr", "link": "https://stackoverflow.com/users/680359/emsr"}, "edited": false, "score": 0, "creation_date": 1523543955, "post_id": 49778493, "comment_id": 86613482, "body": "As an aside, I think all the basic math functions could have constexpr noexcept versions if the have error code returns (no write to global, and invariably ignored, <code>errno</code>). <code>double sin(double x, error_code&amp; ec)</code>; and <code>auto [lgval, lgsign] = lgamma(x, ec);</code>, etc."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1523614613, "post_id": 49778493, "comment_id": 86643455, "body": "If you absolutely need precision up to a particular number of digits, why are you using floating point numbers and not fixed?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1523619016, "post_id": 49778493, "comment_id": 86646128, "body": "@Cubic: Floating point is very fast, and, so long as you know how they behave (error accumulation &amp;c.) they are the perfect tool for many physical and financial modelling applications."}, {"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 2, "creation_date": 1542956902, "post_id": 49778493, "comment_id": 93756918, "body": "Precision of \u03c0 in Boost is actually in a funny situation: on the one hand we have this constant you cite, on the other we have <a href=\"https://stackoverflow.com/a/30755358/673852\">this</a>, which is due to a <a href=\"https://svn.boost.org/trac10/ticket/6893\" rel=\"nofollow noreferrer\">7-year-old bug</a>."}, {"owner": {"reputation": 225, "user_id": 2379238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3cd7f3ee7f449c391d0867245ccb89?s=128&d=identicon&r=PG", "display_name": "BrandonL", "link": "https://stackoverflow.com/users/2379238/brandonl"}, "edited": false, "score": 0, "creation_date": 1565133557, "post_id": 49778493, "comment_id": 101254100, "body": "Nobody is fortunate to use Boost"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 114, "last_activity_date": 1591342372, "last_edit_date": 1591342372, "creation_date": 1523458928, "answer_id": 49778493, "question_id": 49778240, "link": "https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi/49778493#49778493", "title": "Does C++11, 14, 17 or 20 introduce a standard constant for pi?", "body": "<p>Up to and including C++17  <em>pi</em> is not a constant introduced into the language, and it's a pain in the neck.</p>\n\n<p>I'm fortunate in that I use <a href=\"https://www.boost.org/\" rel=\"noreferrer\">boost</a> and they define <em>pi</em> with a sufficiently large number of decimal places for even a 128 bit <code>long double</code>.</p>\n\n<p>If you don't use Boost then hardcode it yourself. Defining it with a trigonometric function is tempting but if you do that you can't then make it a <code>constexpr</code>. The accuracy of the trigonometric functions is also not guaranteed by any standard I know of (<em>cf</em>. <code>std::sqrt</code>), so really you are on dangerous ground indeed relying on such a function.</p>\n\n<p>There is a way of getting a <code>constexpr</code> value for <em>pi</em> using metaprogramming: see <a href=\"http://timmurphy.org/2013/06/27/template-metaprogramming-in-c/\" rel=\"noreferrer\">http://timmurphy.org/2013/06/27/template-metaprogramming-in-c/</a></p>\n\n<hr>\n\n<p>From C++20 some good news. There <strong>is</strong> a defininition for <em>pi</em>. C++20 adds some mathematical constants in <code>&lt;numbers&gt;</code>. For example <code>std::numbers::pi</code> is a <code>double</code> type.</p>\n\n<p>Reference: <a href=\"https://en.cppreference.com/w/cpp/numeric/constants\" rel=\"noreferrer\">https://en.cppreference.com/w/cpp/numeric/constants</a></p>\n"}, {"comments": [{"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1565021859, "post_id": 49778635, "comment_id": 101211418, "body": "This is dangerous because the <code>acos()</code> function has an infinite slope at <code>x = -1</code>. Consequently, this method relies on the <code>acos()</code> implementation to basically explicitly catch the case of a precise <code>-1</code> argument, and return the correct constant directly. Better use something like <code>4*atan(1)</code> which is mathematically much more robust (well-behaved slope at <code>x = 1</code> and multiplication by 4 is always precise with floating point math)."}, {"owner": {"reputation": 680, "user_id": 2303176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47107aaff2c656bb305e866155258f1?s=128&d=identicon&r=PG", "display_name": "badola", "link": "https://stackoverflow.com/users/2303176/badola"}, "edited": false, "score": 2, "creation_date": 1568269865, "post_id": 49778635, "comment_id": 102222294, "body": "We are not allowed to use <code>std::acos</code> in a constant expression. clang reports this as error. Kindly note that this is a <b>non-conforming extension</b> and should eventually be fixed in gcc.  Kindly refer to this <a href=\"https://stackoverflow.com/questions/32814678/constexpr-compile-error-using-stdacos-with-clang-not-g\">answer</a> for more details."}], "tags": [], "owner": {"reputation": 3617, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": false, "score": 31, "last_activity_date": 1523641415, "last_edit_date": 1523641415, "creation_date": 1523459304, "answer_id": 49778635, "question_id": 49778240, "link": "https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi/49778635#49778635", "title": "Does C++11, 14, 17 or 20 introduce a standard constant for pi?", "body": "<p>As others said there is no <code>std::pi</code> but if you want precise <code>PI</code> value you can use:</p>\n\n<pre><code>constexpr double pi = std::acos(-1);\n</code></pre>\n\n<p>This assumes that your C++ implementation produces a correctly-rounded value of PI from <code>acos(-1.0)</code>, <a href=\"https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi#comment86574187_49778635\">which is common but not guaranteed</a>.</p>\n\n<p>It's not <code>constexpr</code>, but in practice optimizing compilers like gcc and clang evaluate it at compile time.  Declaring it <code>const</code> is important for the optimizer to do a good job, though.</p>\n"}, {"comments": [{"owner": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "edited": false, "score": 10, "creation_date": 1523461402, "post_id": 49779231, "comment_id": 86574019, "body": "C++14 gave us variable templates. Isn&#39;t it what they are for?"}, {"owner": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "edited": false, "score": 21, "creation_date": 1523461700, "post_id": 49779231, "comment_id": 86574217, "body": "spoken like a true committee member, talk about all the ways it can&#39;t be done despite clear path forward being presented.   <a href=\"http://en.cppreference.com/w/cpp/language/variable_template\" rel=\"nofollow noreferrer\">See the suprisingly relevant example Variable Templates</a>.  I don&#39;t think your answer is bad, but I&#39;m sure it wouldn&#39;t help Bjarne Stroustrup&#39;s eternal depression over the regret of handing control of C++&#39;s future to a very indecisive committee."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "edited": false, "score": 4, "creation_date": 1523476765, "post_id": 49779231, "comment_id": 86582411, "body": "@snb I agree that making <code>pi</code> a polymorphic constant is the clear path forward \u2013 in a language with Hindley-Milner type inference. In Haskell, we&#39;ve always had <code>pi :: Floating a =&gt; a</code>, so that <code>pi</code> would automatically have the value <code>3.1415927</code> in a <code>Float</code> context, <code>3.141592653589793</code> in a <code>Double</code> context, and <code>\u03c0</code> in an symbolic-computation context. But would people really like having to explicitly instantiate the template parameter? Seems a bit awkward, especially if a fixed <code>long double</code> implementation would give identical results in most applications."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1523485304, "post_id": 49779231, "comment_id": 86585896, "body": "There are several platform independent <a href=\"https://stackoverflow.com/q/21867617/1708801\">methods laid out here</a> ... so while it would be nice to have a standardized one we do have options."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1523485855, "post_id": 49779231, "comment_id": 86586068, "body": "Well, we could also have a new empty trivial type <code>__exposition_pi_t</code> with implicit conversion to all types of numbers."}, {"owner": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1523523181, "post_id": 49779231, "comment_id": 86598701, "body": "@leftaroundabout I believe writing <code>auto a = pi&lt;float&gt;;</code> is completely fine, certainly more readable then notorious <code>4*atan(1)</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "edited": false, "score": 0, "creation_date": 1523524311, "post_id": 49779231, "comment_id": 86599458, "body": "@Amomum yeah... people would probably still use monomorphic shorthands locally to de-clunk mathematical formulas, but I agree that <code>auto pi = std::pi&lt;double&gt;</code> looks pretty clean."}, {"owner": {"reputation": 1143, "user_id": 303953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aab285b5be5b0ed08729ea66ef2159f0?s=128&d=identicon&r=PG", "display_name": "Chromatix", "link": "https://stackoverflow.com/users/303953/chromatix"}, "edited": false, "score": 0, "creation_date": 1523566148, "post_id": 49779231, "comment_id": 86626062, "body": "I might argue that defining M_PI as a decimal constant to a &quot;sufficient&quot; number of digits would work nicely, without any of the problems you mention.  Or, if typing <i>is</i> somehow a problem, then also define M_PI_F and M_PI_LD (with the latter specified for 128-bit implementations)."}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 1, "creation_date": 1523684960, "post_id": 49779231, "comment_id": 86672126, "body": "Ugh, I downvoted this by misclick and now I can&#39;t undo it. Sorry. This deserves a +1 for a pretty good explanation of the committee&#39;s reasoning for why it hasn&#39;t been added, even if I personally think the reasoning is fundamentally flawed for the reasons people have already pointed out."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "edited": false, "score": 0, "creation_date": 1559162643, "post_id": 49779231, "comment_id": 99339351, "body": "They could easily have added a function <code>std::pi&lt;T&gt;()</code> that is guaranteed to be defined for <code>T</code> being every possible floating. I&#39;m not so familiar with the new-fangled <code>constexpr</code> idea, but presumably the function could be marked as that too."}], "tags": [], "owner": {"reputation": 16855, "user_id": 1502345, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1beba9dc5373529ea99d294b23118d1b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Aidley", "link": "https://stackoverflow.com/users/1502345/jack-aidley"}, "is_accepted": false, "score": 12, "last_activity_date": 1523461154, "creation_date": 1523461154, "answer_id": 49779231, "question_id": 49778240, "link": "https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi/49779231#49779231", "title": "Does C++11, 14, 17 or 20 introduce a standard constant for pi?", "body": "<p>It is not obviously a good idea because there is no obvious type with which define pi that is universally applicable across domains.</p>\n\n<p>Pi is, of course, an irrational number so it cannot be correctly represented by <em>any</em> C++ type. You might argue that the natural approach, therefore, is to define it in the largest floating point type available. However, the size of the largest standard floating point type <code>long double</code> is not defined by the C++ standard so the value of the constant would vary between systems. Worse, for any program in which the working type was not this largest type, the definition of pi would be inappropriate since it would impose a performance cost on every use of pi.</p>\n\n<p>It is also trivial for any programmer to find the value of pi and define their own constant suitable for use, so it does not provide any great advantage to include it in the maths headers.</p>\n"}, {"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1570635044, "post_id": 49787262, "comment_id": 102976831, "body": "Feel free to reword my edit as you see fit - I just wanted to add the actual spelling of the new constants in here for posterity."}], "tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": false, "score": 29, "last_activity_date": 1610147931, "last_edit_date": 1610147931, "creation_date": 1523501823, "answer_id": 49787262, "question_id": 49778240, "link": "https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi/49787262#49787262", "title": "Does C++11, 14, 17 or 20 introduce a standard constant for pi?", "body": "<p><code>M_PI</code> is defined by &quot;a standard&quot;, if not a <em>language</em> standard: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/math.h.html\" rel=\"nofollow noreferrer\">POSIX</a> with the X/Open System Interfaces extension (which is very commonly supported and required for official UNIX branding).</p>\n<p>C++20, meanwhile, does have <a href=\"https://en.cppreference.com/w/cpp/numeric/constants\" rel=\"nofollow noreferrer\">such constants</a> (merged in the last round of C++20 features).  Specifically, there is both <code>std::numbers::pi</code> (of type <code>double</code>) and a variable template that you can use if you want a different floating point type, e.g. <code>std::numbers::pi_v&lt;float&gt;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "edited": false, "score": 29, "creation_date": 1523611456, "post_id": 49813454, "comment_id": 86641466, "body": "Sure, <code>std::hermite</code> and <code>std::cyl_bessel_i</code> and <code>std::cosh</code> and <code>std::mersenne_twister_engine</code> and <code>std::ranlux48</code> and <code>std::cauchy_distribution</code> and <code>std::assoc_laguerre</code> and <code>std::beta</code> all were absolutely necessary, we all use them every day!"}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 2, "creation_date": 1523612288, "post_id": 49813454, "comment_id": 86641943, "body": "I&#39;m pretty sure you couldn&#39;t get even the committee itself to sign off on the idea that everything they vote in is &quot;absolutely necessary&quot;. It&#39;s not about necessity but about adding value to the language -- almost <i>nothing</i> in the standard library is necessary to write programs, and for that matter most of the core language can be tossed out as well (if you don&#39;t mind working in a Turing tarpit, that is). The value of the inclusion of a constant for pi can be debated, but the idea that it&#39;s not in there because it&#39;s just not necessary doesn&#39;t hold water."}, {"owner": {"reputation": 313, "user_id": 6483524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eeb6ee7ec0f01f1d68bb7a9f2ffa34f?s=128&d=identicon&r=PG&f=1", "display_name": "Tiger4Hire", "link": "https://stackoverflow.com/users/6483524/tiger4hire"}, "edited": false, "score": 0, "creation_date": 1523614300, "post_id": 49813454, "comment_id": 86643257, "body": "Don&#39;t complain at me, I&#39;m just quoting the standards committee. There were long open discussions about how much of boost should be included in the C++11 standard. The reason why such a small subset made it is because the compiler writers complained about how much testing was involved. Therefore, if something is in the standards, it&#39;s there because someone thought it necessary to standardise it. Just because you don&#39;t know why, doesn&#39;t mean there was no reason."}, {"owner": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "edited": false, "score": 1, "creation_date": 1523630020, "post_id": 49813454, "comment_id": 86653665, "body": "@Tiger4Hire I&#39;m sure there is reason for everything, I just can&#39;t understand why constant for pi was not added when a lot of more complex things were. Constant is easy to write with variable templates and won&#39;t require a lot of testing from compiler writers."}, {"owner": {"reputation": 313, "user_id": 6483524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eeb6ee7ec0f01f1d68bb7a9f2ffa34f?s=128&d=identicon&r=PG&f=1", "display_name": "Tiger4Hire", "link": "https://stackoverflow.com/users/6483524/tiger4hire"}, "reply_to_user": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "edited": false, "score": 0, "creation_date": 1523636714, "post_id": 49813454, "comment_id": 86658036, "body": "@Amomum : Yes, adding pi seems like a small overhead for a big win. Mind, personally I&#39;d prefer to see std::network before std::math::constants."}], "tags": [], "owner": {"reputation": 313, "user_id": 6483524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eeb6ee7ec0f01f1d68bb7a9f2ffa34f?s=128&d=identicon&r=PG&f=1", "display_name": "Tiger4Hire", "link": "https://stackoverflow.com/users/6483524/tiger4hire"}, "is_accepted": false, "score": -1, "last_activity_date": 1523616144, "last_edit_date": 1523616144, "creation_date": 1523611125, "answer_id": 49813454, "question_id": 49778240, "link": "https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi/49813454#49813454", "title": "Does C++11, 14, 17 or 20 introduce a standard constant for pi?", "body": "<p>Edited - To remove the term necessary, because it proved controversial. It is too much of an absolute term.</p>\n\n<p>C++ is a large and complex language, for that reason the Standards Committee only include things which are <em>strongly required</em>. As much as possible is left to non-language standard libraries... like Boost.<br>\n<a href=\"https://www.boost.org/doc/libs/1_37_0/libs/math/doc/sf_and_dist/html/math_toolkit/toolkit/internals1/constants.html\" rel=\"nofollow noreferrer\">boost::math::constants</a></p>\n"}], "owner": {"reputation": 5417, "user_id": 1823524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uScxd.jpg?s=128&g=1", "display_name": "Amomum", "link": "https://stackoverflow.com/users/1823524/amomum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27979, "favorite_count": 9, "protected_date": 1523563649, "accepted_answer_id": 49778493, "answer_count": 6, "score": 180, "last_activity_date": 1610147931, "creation_date": 1523458180, "last_edit_date": 1565020874, "question_id": 49778240, "link": "https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi", "title": "Does C++11, 14, 17 or 20 introduce a standard constant for pi?", "body": "<p>There is a rather silly problem with the number pi in C and C++. As far as I know <code>M_PI</code> defined in <code>math.h</code> is not required by any standard.</p>\n\n<p>New C++ standards introduced a lot of complicated math in the standard library - hyperbolic functions, <code>std::hermite</code> and <code>std::cyl_bessel_i</code>, different random number generators and so on and so forth.</p>\n\n<p>Did any of the 'new' standards bring in a constant for pi? If not - why? How does all this complicated math work without it?</p>\n\n<p>I am aware of similar questions about pi in C++ (they are several years and standards old); I would like to know the current state of the problem.</p>\n\n<p>I am also very interested in <em>why oh why</em> C++ still doesn't have a pi constant but has a lot of more complicated math.</p>\n\n<p>UPD: I know that I can define pi myself as 4*atan(1) or acos(1) or double pi = 3.14. Sure. But why in 2018 do I still have to do it? How do standard math functions work without pi?</p>\n\n<p>UPD2: According to <a href=\"https://botondballo.wordpress.com/2019/07/26/trip-report-c-standards-meeting-in-cologne-july-2019/\" rel=\"noreferrer\">this</a> trip report for C++ Committee meeting in July 2019 in Cologne, <a href=\"http://wg21.link/p0631\" rel=\"noreferrer\">proposal P0631</a> (math constants) was accepted into C++20. So it looks like at long last we will have number pi in the standard library!</p>\n"}, {"tags": ["c++", "qt", "opengl"], "answers": [{"comments": [{"owner": {"reputation": 2482, "user_id": 9630756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zkdcg.png?s=128&g=1", "display_name": "Sergio Monteleone", "link": "https://stackoverflow.com/users/9630756/sergio-monteleone"}, "reply_to_user": {"reputation": 1, "user_id": 8382148, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UpBPdzjMVBg/AAAAAAAAAAI/AAAAAAAAABc/y-4eHrd7cco/photo.jpg?sz=128", "display_name": "Alexey Korolev", "link": "https://stackoverflow.com/users/8382148/alexey-korolev"}, "edited": false, "score": 0, "creation_date": 1523459626, "post_id": 49778555, "comment_id": 86572720, "body": "This is the result I got: <a href=\"https://imgur.com/h0IY3jk\" rel=\"nofollow noreferrer\">imgur</a>. Or I missunderstand what you want to obtain?"}, {"owner": {"reputation": 1, "user_id": 8382148, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UpBPdzjMVBg/AAAAAAAAAAI/AAAAAAAAABc/y-4eHrd7cco/photo.jpg?sz=128", "display_name": "Alexey Korolev", "link": "https://stackoverflow.com/users/8382148/alexey-korolev"}, "edited": false, "score": 0, "creation_date": 1523459881, "post_id": 49778555, "comment_id": 86572919, "body": "I need fill the path with the red cross-lines, but without background. right now i have the red fill, with lighter cross-lines."}, {"owner": {"reputation": 2482, "user_id": 9630756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zkdcg.png?s=128&g=1", "display_name": "Sergio Monteleone", "link": "https://stackoverflow.com/users/9630756/sergio-monteleone"}, "reply_to_user": {"reputation": 1, "user_id": 8382148, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UpBPdzjMVBg/AAAAAAAAAAI/AAAAAAAAABc/y-4eHrd7cco/photo.jpg?sz=128", "display_name": "Alexey Korolev", "link": "https://stackoverflow.com/users/8382148/alexey-korolev"}, "edited": false, "score": 0, "creation_date": 1523459953, "post_id": 49778555, "comment_id": 86572971, "body": "Sorry can you make a mockup picture of the result you want?"}, {"owner": {"reputation": 1, "user_id": 8382148, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UpBPdzjMVBg/AAAAAAAAAAI/AAAAAAAAABc/y-4eHrd7cco/photo.jpg?sz=128", "display_name": "Alexey Korolev", "link": "https://stackoverflow.com/users/8382148/alexey-korolev"}, "edited": false, "score": 0, "creation_date": 1523461030, "post_id": 49778555, "comment_id": 86573755, "body": "the main target is fill the node like QBrush style."}], "tags": [], "owner": {"reputation": 2482, "user_id": 9630756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zkdcg.png?s=128&g=1", "display_name": "Sergio Monteleone", "link": "https://stackoverflow.com/users/9630756/sergio-monteleone"}, "is_accepted": false, "score": 1, "last_activity_date": 1523459081, "creation_date": 1523459081, "answer_id": 49778555, "question_id": 49778211, "link": "https://stackoverflow.com/questions/49778211/glsl-qt-shader-program/49778555#49778555", "title": "glsl qt shader program", "body": "<p>Just assign a transparent color to the item.</p>\n\n<p>In main.cpp, at line 50, change:</p>\n\n<pre><code>fillBrush.setColor(Qt::red);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>fillBrush.setColor(Qt::transparent);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8382148, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UpBPdzjMVBg/AAAAAAAAAAI/AAAAAAAAABc/y-4eHrd7cco/photo.jpg?sz=128", "display_name": "Alexey Korolev", "link": "https://stackoverflow.com/users/8382148/alexey-korolev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1523460864, "creation_date": 1523458135, "last_edit_date": 1523460864, "question_id": 49778211, "link": "https://stackoverflow.com/questions/49778211/glsl-qt-shader-program", "title": "glsl qt shader program", "body": "<p>Can you help me write the correct shader program(glsl) for QT painterPath adaptation to SceneGraph. The geometry of the node triangulated ok, but i can't write correct shader material for hatched brush style. </p>\n\n<pre><code>1. pathNode.cpp\n\n#include &lt;QtQuick/QSGSimpleMaterialShader&gt;\n#include &lt;QtQuick/QSGTexture&gt;\n#include &lt;QtQuick/QQuickWindow&gt;\n\n#include &lt;private/qtriangulator_p.h&gt;\n#include &lt;QPainterPath&gt;\n\n#include \"pathNode.h\"\n\n#define TEXTURE_SIZE 64\n\nstruct BrushMaterial\n{\n    ~BrushMaterial() {\n        delete texture;\n    }\n\n    QColor          color;\n    QSGTexture*     texture;\n};\n\nclass BrushShader : public QSGSimpleMaterialShader&lt;BrushMaterial&gt;\n{\n    QSG_DECLARE_SIMPLE_SHADER(BrushShader, BrushMaterial)\n\npublic:\n    BrushShader() : \n        id_color(-1), \n        id_texture(-1),\n        id_textureSize(-1)\n    {\n        setShaderSourceFile(QOpenGLShader::Vertex, \":/shaders/brush.vsh\");\n        setShaderSourceFile(QOpenGLShader::Fragment, \":/shaders/brush.fsh\");\n    }\n\n    QList&lt;QByteArray&gt; attributes() const\n    {\n        return QList&lt;QByteArray&gt;() &lt;&lt; \"aVertex\" &lt;&lt; \"aTexCoord\";\n    }\n\n    void updateState(const BrushMaterial *m, const BrushMaterial *)\n    {\n        // Set the color\n        program()-&gt;setUniformValue(id_color, m-&gt;color);\n\n        // Bind the texture and set program to use texture unit 0 (the default)\n        m-&gt;texture-&gt;bind();\n\n        // Then set the texture size so we can adjust the texture coordinates accordingly in the\n        // vertex shader..\n        QSize s = m-&gt;texture-&gt;textureSize();\n        program()-&gt;setUniformValue(id_textureSize, QSizeF(1.0 / s.width(), 1.0 / s.height()));\n    }\n\n    void resolveUniforms()\n    {\n        id_texture = program()-&gt;uniformLocation(\"texture\");\n        id_textureSize = program()-&gt;uniformLocation(\"textureSize\");\n        id_color = program()-&gt;uniformLocation(\"color\");\n\n        // We will only use texture unit 0, so set it only once.\n        program()-&gt;setUniformValue(id_texture, 0);\n    }\n\nprivate:\n    int id_color;\n    int id_texture;\n    int id_textureSize;\n};\n\nPathNode::PathNode(QSGTexture* texture,const QColor&amp; color)\n    : m_geometry(QSGGeometry::defaultAttributes_TexturedPoint2D(), 0, 0, GL_UNSIGNED_INT)\n{\n    setGeometry(&amp;m_geometry);\n    m_geometry.setDrawingMode(GL_TRIANGLES);\n\n    QSGSimpleMaterial&lt;BrushMaterial&gt;* m = BrushShader::createMaterial();\n\n    m-&gt;state()-&gt;texture = texture;\n    m-&gt;state()-&gt;color = color;\n    m-&gt;setFlag(QSGMaterial::Blending);\n\n    setMaterial(m);\n    setFlag(OwnsMaterial, true);\n}\n\nvoid PathNode::update(const QPainterPath&amp; path)\n{\n    const QTriangleSet triangles{ qTriangulate(path) };\n\n    // Fill vertex buffer\n    m_geometry.allocate(triangles.vertices.size() / 2, triangles.indices.size());\n    QSGGeometry::TexturedPoint2D *vertex = m_geometry.vertexDataAsTexturedPoint2D();\n    for (int i = 0; i &lt; m_geometry.vertexCount(); ++i)\n        vertex[i].set(triangles.vertices.at(2 * i), triangles.vertices.at(2 * i + 1), 1, 0);\n\n    // Fill index buffer\n    uint *indices = m_geometry.indexDataAsUInt();\n    if (triangles.indices.type() != QVertexIndexVector::UnsignedInt)\n        qFatal(\"Unexpected geometry index type\");\n    memcpy(indices, triangles.indices.data(), triangles.indices.size() * sizeof(*indices));\n\n    markDirty(QSGNode::DirtyGeometry);\n}\n</code></pre>\n\n<p>2.PathNode.h</p>\n\n<pre><code>#pragma once\n\n#include &lt;QSGGeometryNode&gt;\n\nclass PathNode : public QSGGeometryNode\n{\n    QSGGeometry             m_geometry;\n\npublic:\n    PathNode(QSGTexture* texture, const QColor&amp; color);\n\n    void update(const QPainterPath&amp; path);\n};\n</code></pre>\n\n<p>3.brush.vsh</p>\n\n<pre><code>attribute highp vec4 aVertex;\nattribute highp vec2 aTexCoord;\n\nuniform highp mat4 qt_Matrix;\nuniform highp vec2 textureSize;\n\nvarying highp vec2 vTexCoord;\nvarying lowp vec2 vShadeCoord;\n\nvoid main() {\n    gl_Position = qt_Matrix * aVertex;\n    vTexCoord = aVertex.xy * textureSize;\n    vShadeCoord = aTexCoord;\n}\n</code></pre>\n\n<ol start=\"4\">\n<li><p>brush.fsh</p>\n\n<pre><code>uniform sampler2D texture;\nuniform lowp float qt_Opacity;\nuniform lowp vec4 color;\n\nvarying highp vec2 vTexCoord;\n\nvoid main()\n{\n    lowp vec4 shade = texture2D(texture, vTexCoord) ;\n    lowp vec4 c = vec4(color.xyz * shade.xyz, 1.0);\n    gl_FragColor = c * qt_Opacity;\n}\n</code></pre></li>\n</ol>\n\n<p>The main trouble is what the painted hatches with colored background, but i want to have transparent background.</p>\n\n<p>link to github code: <a href=\"https://github.com/nik13513513/painterPath_QSGNode\" rel=\"nofollow noreferrer\">painterPath_QSGNode</a></p>\n"}, {"tags": ["c++", "preconditions", "post-conditions"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 8, "creation_date": 1523458083, "post_id": 49778122, "comment_id": 86571510, "body": "Consider using large values for the input so that the multiplication overflows."}, {"owner": {"reputation": 51, "user_id": 9631116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a744c3c81789a245b9bb3670ae94b27?s=128&d=identicon&r=PG&f=1", "display_name": "mcbalsa", "link": "https://stackoverflow.com/users/9631116/mcbalsa"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1523458365, "post_id": 49778122, "comment_id": 86571746, "body": "Oh, it triggered, thanks Hans"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1523458903, "post_id": 49778122, "comment_id": 86572168, "body": "@HansPassant that would be undefined behavior since it&#39;s signed integer overflow ... so no guarantee that it&#39;ll do anything"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1523459383, "post_id": 49778122, "comment_id": 86572524, "body": "That&#39;s obvious.  I don&#39;t know Stroustrup&#39;s didactic, but he doesn&#39;t strike me as the kind of guy that won&#39;t give beginners a chance to see what UB looks like.  If you don&#39;t know how to trigger it then you&#39;re guaranteed to cause it."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1523461297, "post_id": 49778122, "comment_id": 86573949, "body": "It&#39;s also a toy example -- postconditions check that the function itself isn&#39;t buggy."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1523489252, "post_id": 49778122, "comment_id": 86586994, "body": "@mcbalsa You can write an answer and when you&#39;re satisfied that it&#39;s the best, correct answer, you can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 9718, "user_id": 3294441, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UwdVL.png?s=128&g=1", "display_name": "QuestionC", "link": "https://stackoverflow.com/users/3294441/questionc"}, "is_accepted": false, "score": 0, "last_activity_date": 1523490430, "creation_date": 1523490430, "answer_id": 49785944, "question_id": 49778122, "link": "https://stackoverflow.com/questions/49778122/pre-and-post-condition-from-stroustrups-book/49785944#49785944", "title": "Pre and Post Condition from Stroustrup&#39;s book", "body": "<p>Numbers which when multiplied cause signed overflow will possibly cause the value to be negative and certainly cause the result to be incorrect.</p>\n\n<p>Exactly what values cause integer overflow will depend on your architecture and compiler, but the gist is that multiplying two 4 byte integers will result in an 8 byte value, which can not be stored in a 4 byte integer.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 9631116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a744c3c81789a245b9bb3670ae94b27?s=128&d=identicon&r=PG&f=1", "display_name": "mcbalsa", "link": "https://stackoverflow.com/users/9631116/mcbalsa"}, "is_accepted": true, "score": 1, "last_activity_date": 1523556781, "creation_date": 1523556781, "answer_id": 49803372, "question_id": 49778122, "link": "https://stackoverflow.com/questions/49778122/pre-and-post-condition-from-stroustrups-book/49803372#49803372", "title": "Pre and Post Condition from Stroustrup&#39;s book", "body": "<p>Consider using large values for the input so that the multiplication overflows.</p>\n"}, {"tags": [], "owner": {"reputation": 2729, "user_id": 6486187, "user_type": "registered", "profile_image": "https://graph.facebook.com/722616891201339/picture?type=large", "display_name": "Abhishek Keshri", "link": "https://stackoverflow.com/users/6486187/abhishek-keshri"}, "is_accepted": false, "score": 0, "last_activity_date": 1523560978, "creation_date": 1523560978, "answer_id": 49804379, "question_id": 49778122, "link": "https://stackoverflow.com/questions/49778122/pre-and-post-condition-from-stroustrups-book/49804379#49804379", "title": "Pre and Post Condition from Stroustrup&#39;s book", "body": "<p>I tried this, and seems like this works: <code>area(1000000,1000000);</code></p>\n\n<p>The output was: <code>-727379968</code></p>\n"}], "owner": {"reputation": 51, "user_id": 9631116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a744c3c81789a245b9bb3670ae94b27?s=128&d=identicon&r=PG&f=1", "display_name": "mcbalsa", "link": "https://stackoverflow.com/users/9631116/mcbalsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 49803372, "answer_count": 3, "score": 4, "last_activity_date": 1523560978, "creation_date": 1523457936, "last_edit_date": 1523489199, "question_id": 49778122, "link": "https://stackoverflow.com/questions/49778122/pre-and-post-condition-from-stroustrups-book", "title": "Pre and Post Condition from Stroustrup&#39;s book", "body": "<p>In chapter 5.10.1 of Programming: Principles and Practice using C++, there is a \"Try this\" exercise for debugging for bad input of an area. The pre-conditions are if the the inputs for length and width are 0 or negative while the post-condition is checking if the area is 0 or negative. To quote the problem, \"Find a pair of values so that the pre-condition of this version of area holds, but the post-condition doesn\u2019t.\". The code so far is: </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"std_lib_facilities.h\"\n\nint area (int length, int width) {\n    if (length &lt;= 0 || width &lt;= 0) { error(\"area() pre-condition\"); }\n    int a =  length * width;\n    if(a &lt;= 0) { error(\"area() post-condition\"); }\n    return a;\n}\n\nint main() {\n\nint a;\nint b;\nwhile (std::cin &gt;&gt; a &gt;&gt; b) {\n    std::cout &lt;&lt; area(a, b) &lt;&lt; '\\n';\n}\n\nsystem(\"pause\");\nreturn 0;\n}\n</code></pre>\n\n<p>While the code appears to work, I can't wrap my head around what inputs will get the pre-condition to succeed yet will trigger the post-condition. So far I have tried entering strings into one of the inputs but that just terminates the program and tried looking up the ascii equivalent to 0, but same result as well. Is this supposed to be some sort of trick question or am I missing something?</p>\n"}, {"tags": ["c++", "visual-studio"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 7, "creation_date": 1523457431, "post_id": 49777885, "comment_id": 86571023, "body": "Did you try creating a Post-Build event (in Project properties), that does it? Why didn&#39;t it solve the problem for you, if you did?"}, {"owner": {"reputation": 534, "user_id": 5836957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/636dd1f97aea76feebdacdba8b1fec17?s=128&d=identicon&r=PG&f=1", "display_name": "T.G.", "link": "https://stackoverflow.com/users/5836957/t-g"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1523457658, "post_id": 49777885, "comment_id": 86571180, "body": "I wasn&#39;t aware to that option. Thanks! I&#39;ll look it up."}], "answers": [{"comments": [{"owner": {"reputation": 4625, "user_id": 1964969, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0879c1954a7ee8660f80eafdf9f66776?s=128&d=identicon&r=PG", "display_name": "Yury Schkatula", "link": "https://stackoverflow.com/users/1964969/yury-schkatula"}, "edited": false, "score": 1, "creation_date": 1523538441, "post_id": 49796929, "comment_id": 86609206, "body": "Also, it could be worth to delete that copied file in Pre-Build Event so that you can understand the copied target is latest successful build for sure (because if your build fails you may find you with obsolete copy)."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 4625, "user_id": 1964969, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0879c1954a7ee8660f80eafdf9f66776?s=128&d=identicon&r=PG", "display_name": "Yury Schkatula", "link": "https://stackoverflow.com/users/1964969/yury-schkatula"}, "edited": false, "score": 0, "creation_date": 1523539844, "post_id": 49796929, "comment_id": 86610322, "body": "@YurySchkatula That would be my preference as well but I&#39;ll leave that to the discretion of the OP. Some people prefer to be able to run old builds even when the current build fails."}], "tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": true, "score": 2, "last_activity_date": 1523537116, "creation_date": 1523537116, "answer_id": 49796929, "question_id": 49777885, "link": "https://stackoverflow.com/questions/49777885/create-a-copy-of-exe-file-in-visual-studio/49796929#49796929", "title": "create a copy of exe file in visual studio", "body": "<p>You'll want to open up your Project Properties (just select the project and press <kbd>Alt</kbd> + <kbd>Enter</kbd>)\nFrom there go to: \"Configuration Properties\" > \"Build Events\" > \"Post-Build Event\" and edit the \"Command Line\" property:\n <a href=\"https://i.stack.imgur.com/rzMeT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rzMeT.png\" alt=\"enter image description here\"></a>\nThere you'll what to use the <code>$(Target Path)</code> macro to get the generated executable. So you're \"Command Line\" property will probably look something like this:</p>\n\n<blockquote>\n  <p>mkdir \"Lorem Ipsum\"<br>\n  copy \"$(Target Path)\" \"Lorem Ipsum\"</p>\n</blockquote>\n\n<p>Incidentally this can also be accomplished in an <code>AfterBuildEvent</code> In you .vcprojx file. If you're interested you can read more here: <a href=\"https://stackoverflow.com/q/26760052/2642059\">MSBuild AfterBuild Step</a></p>\n"}], "owner": {"reputation": 534, "user_id": 5836957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/636dd1f97aea76feebdacdba8b1fec17?s=128&d=identicon&r=PG&f=1", "display_name": "T.G.", "link": "https://stackoverflow.com/users/5836957/t-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 49796929, "answer_count": 1, "score": 1, "last_activity_date": 1523537116, "creation_date": 1523457285, "question_id": 49777885, "link": "https://stackoverflow.com/questions/49777885/create-a-copy-of-exe-file-in-visual-studio", "title": "create a copy of exe file in visual studio", "body": "<p>Is there a way that whenever I compile my project in Visual Studio it will create the exe file in the project directory and also copy the exe file to a different directory?</p>\n\n<p>Is Visual using a makefile that I can edit and add the copying command to it?\nThanks!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 1, "creation_date": 1523457213, "post_id": 49777818, "comment_id": 86570838, "body": "<a href=\"https://isocpp.org/blog/2016/02/a-bit-of-background-for-the-unified-call-proposal\" rel=\"nofollow noreferrer\">isocpp.org/blog/2016/02/&hellip;</a>"}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1523457227, "post_id": 49777818, "comment_id": 86570854, "body": "Unified Call Syntax proposal"}, {"owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "reply_to_user": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 3, "creation_date": 1523457412, "post_id": 49777818, "comment_id": 86571003, "body": "@SeverinPappadeux Please post as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523457927, "post_id": 49778087, "comment_id": 86571372, "body": "Looks like it was voted down for C++17: <a href=\"https://stackoverflow.com/questions/34376985/how-does-the-c17-proposal-for-uniform-call-syntax-intend-to-handle-namespaces\" title=\"how does the c17 proposal for uniform call syntax intend to handle namespaces\">stackoverflow.com/questions/34376985/&hellip;</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1523457966, "post_id": 49778087, "comment_id": 86571398, "body": "It is kind of a shame as after doing some C# programming recently I have definitely seen how it easy to string together a lot of functions with this."}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523458151, "post_id": 49778087, "comment_id": 86571560, "body": "@NathanOliver Yes, I would agree - nice to have and saves some time. From the other hand, it is not a &quot;big deal&quot; proposal, and a lot of small details to be ironed out. Say, ranges or modules sound and look a lot more sexier to play with and would mean a lot more for general C++ development. Still, keep finger crossed..."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523458465, "post_id": 49778087, "comment_id": 86571835, "body": "Yeah.  I&#39;d rather have modules, ranges or concepts first"}], "tags": [], "owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "is_accepted": true, "score": 6, "last_activity_date": 1523457842, "creation_date": 1523457842, "answer_id": 49778087, "question_id": 49777818, "link": "https://stackoverflow.com/questions/49777818/where-is-the-proposal-for-standardization-of-extension-methods-in-c/49778087#49778087", "title": "Where is the proposal for standardization of &quot;extension methods&quot; in C++?", "body": "<p>There is a proposal for Unified (var Uniform) Call Syntax for C++. From 10,000 feet PoV, it will allow extensions methods a la C# as well as really blending the difference between method call and function call for a given object.</p>\n\n<p>Here is short description how this feature would look like</p>\n\n<p><a href=\"https://isocpp.org/blog/2016/02/a-bit-of-background-for-the-unified-call-proposal\" rel=\"noreferrer\">https://isocpp.org/blog/2016/02/a-bit-of-background-for-the-unified-call-proposal</a></p>\n\n<p>As far as I know, it didn't make it into C++17 (too late?), awaiting for c++2x</p>\n"}, {"comments": [{"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1523646419, "post_id": 49783539, "comment_id": 86663036, "body": "<code>I do not intend to re-raise the proposal for C++20</code> why not?"}, {"owner": {"reputation": 3181, "user_id": 166601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3312831361d90cc9218ff3d542a16495?s=128&d=identicon&r=PG&f=1", "display_name": "jbcoe", "link": "https://stackoverflow.com/users/166601/jbcoe"}, "reply_to_user": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 2, "creation_date": 1523646524, "post_id": 49783539, "comment_id": 86663086, "body": "No one has expressed any interest in pursuing the proposal any further. Given that the universal call syntax proposals that were under discussion at the time of our original proposal have not been advanced, perhaps appetite for extension methods has changed?"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 1, "creation_date": 1543955842, "post_id": 49783539, "comment_id": 94102419, "body": "Could you add a couple of sentences explaining how this differs from having uniform call syntax?"}], "tags": [], "owner": {"reputation": 3181, "user_id": 166601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3312831361d90cc9218ff3d542a16495?s=128&d=identicon&r=PG&f=1", "display_name": "jbcoe", "link": "https://stackoverflow.com/users/166601/jbcoe"}, "is_accepted": false, "score": 4, "last_activity_date": 1544563572, "last_edit_date": 1544563572, "creation_date": 1523476713, "answer_id": 49783539, "question_id": 49777818, "link": "https://stackoverflow.com/questions/49777818/where-is-the-proposal-for-standardization-of-extension-methods-in-c/49783539#49783539", "title": "Where is the proposal for standardization of &quot;extension methods&quot; in C++?", "body": "<p>Roger Orr and I proposed adding extension methods to C++ (17) in 2015 in this paper: </p>\n\n<p><a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0079r0.pdf\" rel=\"nofollow noreferrer\">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0079r0.pdf</a></p>\n\n<p>The (Language) Evolution group were not convinced that this was a direction they were keen to pursue.</p>\n\n<p>I think that extension methods in C# are a nice feature but this does not seem to be a truth universally acknowledged.</p>\n\n<p>I do not intend to re-raise the proposal for C++20.</p>\n\n<h3>Brief summary</h3>\n\n<p>(as requested by einpoklum)</p>\n\n<p>Uniform call syntax proposed that member functions could be called with free function syntax:</p>\n\n<pre><code>void foo(const A&amp; a);\nclass B { void foo(); };\n\nA a;\nfoo(a); // calls foo(const A&amp;);\n\nB b;\nfoo(b); // calls b.foo();\n</code></pre>\n\n<p>Extension methods proposed that suitably written free functions could be called with member function syntax:</p>\n\n<pre><code>void foo(const A&amp; this); // note the name `this` is important\nclass B { void foo(); };\n\nA a;\na.foo(); // calls foo(const A&amp;);\n\nB b;\nb.foo(); // calls b.foo();\n</code></pre>\n"}], "owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 49778087, "answer_count": 2, "score": 5, "last_activity_date": 1544563572, "creation_date": 1523457081, "question_id": 49777818, "link": "https://stackoverflow.com/questions/49777818/where-is-the-proposal-for-standardization-of-extension-methods-in-c", "title": "Where is the proposal for standardization of &quot;extension methods&quot; in C++?", "body": "<p>I forgot the exact term used to describe the feature that was used in the proposal I saw about a year (maybe more) ago. it looked similar to C# extension methods in that a global function defined as part of a class's interface could be invoked using class-member syntax. Very very dumbed down example:</p>\n\n<pre><code>class Foo\n{\npublic:\n    void One();\n};\n\nvoid Two(Foo&amp;);\n\nint main()\n{\n    Foo f;\n    f.One();\n    f.Two(); // This was valid in the proposal I saw\n}\n</code></pre>\n\n<p>I'm sure my code example is way off, but I'm using it more to try to communicate the feature I remember seeing. Am I completely off here or was there a proposal out there for C++ that introduced this mechanism? And if so, could someone point me to the proposal and possibly its status/timeline?</p>\n"}, {"tags": ["python", "c++", "machine-learning", "cython", "mlpack"], "comments": [{"owner": {"reputation": 3984, "user_id": 4121573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kxnXk.png?s=128&g=1", "display_name": "Adonis", "link": "https://stackoverflow.com/users/4121573/adonis"}, "edited": false, "score": 0, "creation_date": 1523457743, "post_id": 49777638, "comment_id": 86571239, "body": "Possibly related: <a href=\"https://stackoverflow.com/a/23392673/4121573\">stackoverflow.com/a/23392673/4121573</a>"}, {"owner": {"reputation": 27, "user_id": 9471762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f29de2c64e8967b5d042c3e93576676?s=128&d=identicon&r=PG&f=1", "display_name": "NORTMP", "link": "https://stackoverflow.com/users/9471762/nortmp"}, "reply_to_user": {"reputation": 3984, "user_id": 4121573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kxnXk.png?s=128&g=1", "display_name": "Adonis", "link": "https://stackoverflow.com/users/4121573/adonis"}, "edited": false, "score": 0, "creation_date": 1523460630, "post_id": 49777638, "comment_id": 86573472, "body": "@Adonis Someone answered the question. Thank you anyway."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9471762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f29de2c64e8967b5d042c3e93576676?s=128&d=identicon&r=PG&f=1", "display_name": "NORTMP", "link": "https://stackoverflow.com/users/9471762/nortmp"}, "edited": false, "score": 0, "creation_date": 1523460577, "post_id": 49778521, "comment_id": 86573433, "body": "This worked, Thank you! It is weird that if I comment out the line <code>pca.Apply(m, m, eig, coeff)</code>, it works well, though some external library functions are used..."}], "tags": [], "owner": {"reputation": 4536, "user_id": 4165324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d50177f8e05b2c515b26455ba250ce?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/4165324/danny"}, "is_accepted": true, "score": 1, "last_activity_date": 1523459012, "creation_date": 1523459012, "answer_id": 49778521, "question_id": 49777638, "link": "https://stackoverflow.com/questions/49777638/undefined-symbol-in-cython-module-when-using-mlpack/49778521#49778521", "title": "undefined symbol in Cython module when using mlpack", "body": "<p>The extension must be linked to the library it is using.</p>\n\n<pre><code>setup(ext_modules=cythonize([Extension(\n    \"pca\", [\"pca.pyx\"], language='c++'),\n    libraries='mlpack',\n]))\n</code></pre>\n\n<p>That all symbols can be found, and libraries linked correctly, can be checked by <code>ldd &lt;.so&gt;</code>.</p>\n\n<p>See <a href=\"http://cython.readthedocs.io/en/latest/src/tutorial/clibraries.html?highlight=linking#compiling-and-linking\" rel=\"nofollow noreferrer\">Compiling and Linking</a> Cython documentation.</p>\n"}], "owner": {"reputation": 27, "user_id": 9471762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f29de2c64e8967b5d042c3e93576676?s=128&d=identicon&r=PG&f=1", "display_name": "NORTMP", "link": "https://stackoverflow.com/users/9471762/nortmp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 49778521, "answer_count": 1, "score": 2, "last_activity_date": 1523459012, "creation_date": 1523456628, "question_id": 49777638, "link": "https://stackoverflow.com/questions/49777638/undefined-symbol-in-cython-module-when-using-mlpack", "title": "undefined symbol in Cython module when using mlpack", "body": "<p>I met the problem \"undefined symbol\" when using mlpack in Cython. Here is my test case:</p>\n\n<pre><code>cdef extern from \"&lt;mlpack/core.hpp&gt;\" namespace \"arma\":\n    ctypedef unsigned uword\n\n    cdef cppclass vec:\n        vec()\n        vec(uword)\n\n    cdef cppclass mat:\n        mat()\n        mat(uword, uword)\n        void matprint \"print\" ()\n        double&amp; operator() (const uword, const uword)\n\ncdef extern from \"&lt;mlpack/methods/pca/pca.hpp&gt;\" namespace \"mlpack::pca\":\n    cdef cppclass ExactSVDPolicy:\n        ExactSVDPolicy()\n\n    cdef cppclass PCA[ExactSVDPolicy]:\n        PCA()\n        void Apply(const mat&amp;, mat&amp;, vec&amp;, mat&amp;)\n\n\ncdef mat m = mat(4, 2)\n(&lt;double*&gt;&amp;m(0, 0))[0] = 1.2\n(&lt;double*&gt;&amp;m(1, 0))[0] = 1.0\n(&lt;double*&gt;&amp;m(2, 0))[0] = 0.8\n(&lt;double*&gt;&amp;m(3, 0))[0] = 0.6 \n(&lt;double*&gt;&amp;m(0, 1))[0] = 0.6\n(&lt;double*&gt;&amp;m(1, 1))[0] = 0.8\n(&lt;double*&gt;&amp;m(2, 1))[0] = 1.0\n(&lt;double*&gt;&amp;m(3, 1))[0] = 1.2\n\ncdef vec eig = vec(2)\ncdef mat coeff = mat(4, 2)\ncdef PCA[ExactSVDPolicy] pca\n\nm.matprint()\npca.Apply(m, m, eig, coeff)\nm.matprint()\n</code></pre>\n\n<p>Here is the setup file:</p>\n\n<pre><code>from distutils.core import setup\nfrom Cython.Build import cythonize\nfrom distutils.extension import Extension\n\nsetup(ext_modules = cythonize([Extension(\"pca\", [\"pca.pyx\"], language='c++')]))\n</code></pre>\n\n<p>Compilation was OK, but when I import the module, python complains that:</p>\n\n<pre><code>undefined symbol: _ZN6mlpack5Timer5StartERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE\n</code></pre>\n\n<p>I looked for the symbol, it is defined in the libmlpack.so. I put it in /usr/local/lib, which is included in LD_LIBRARY_PATH, but it seems Python does not find the symbol during runtime. Is there anyone who can help? Thanks.  </p>\n"}, {"tags": ["c++", "opencv", "darknet", "yolo"], "comments": [{"owner": {"reputation": 2622, "user_id": 2305545, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0c3a74411bc5997af03461a7b0458069?s=128&d=identicon&r=PG", "display_name": "NOhs", "link": "https://stackoverflow.com/users/2305545/nohs"}, "edited": false, "score": 0, "creation_date": 1523457859, "post_id": 49777632, "comment_id": 86571321, "body": "Please provide a mcve (<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>) and also provide the full error message. &quot;It fails&quot; is never specific enough."}, {"owner": {"reputation": 23, "user_id": 6645302, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LxIfYvl_onM/AAAAAAAAAAI/AAAAAAAAACY/-kXJ835UfyI/photo.jpg?sz=128", "display_name": "SoullessStone", "link": "https://stackoverflow.com/users/6645302/soullessstone"}, "reply_to_user": {"reputation": 2622, "user_id": 2305545, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0c3a74411bc5997af03461a7b0458069?s=128&d=identicon&r=PG", "display_name": "NOhs", "link": "https://stackoverflow.com/users/2305545/nohs"}, "edited": false, "score": 0, "creation_date": 1523458668, "post_id": 49777632, "comment_id": 86572003, "body": "@NOhs Thanks for your feedback. The question should now be more specific. The code is there, the parameters to run the programm with. The exception does not seem very meaningful to me..."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6645302, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LxIfYvl_onM/AAAAAAAAAAI/AAAAAAAAACY/-kXJ835UfyI/photo.jpg?sz=128", "display_name": "SoullessStone", "link": "https://stackoverflow.com/users/6645302/soullessstone"}, "edited": false, "score": 0, "creation_date": 1523461340, "post_id": 49778620, "comment_id": 86573979, "body": "Thank you very much. Do you now if the yolov3 compatibility is planned and how to get informed, when it arrives?"}, {"owner": {"reputation": 783, "user_id": 6548453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ac4973820ae04da7eabd746229df73?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Kurtaev", "link": "https://stackoverflow.com/users/6548453/dmitry-kurtaev"}, "reply_to_user": {"reputation": 23, "user_id": 6645302, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LxIfYvl_onM/AAAAAAAAAAI/AAAAAAAAACY/-kXJ835UfyI/photo.jpg?sz=128", "display_name": "SoullessStone", "link": "https://stackoverflow.com/users/6645302/soullessstone"}, "edited": false, "score": 0, "creation_date": 1523509529, "post_id": 49778620, "comment_id": 86591677, "body": "@SoullessStone, YOLO-v3 is a relatively new model so feel free to open an issue at <a href=\"https://github.com/opencv/opencv/issues\" rel=\"nofollow noreferrer\">github.com/opencv/opencv/issues</a> including full name of the model, references to <code>.cfg</code> and <code>.weights</code> files. Thanks!"}, {"owner": {"reputation": 23, "user_id": 6645302, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LxIfYvl_onM/AAAAAAAAAAI/AAAAAAAAACY/-kXJ835UfyI/photo.jpg?sz=128", "display_name": "SoullessStone", "link": "https://stackoverflow.com/users/6645302/soullessstone"}, "reply_to_user": {"reputation": 783, "user_id": 6548453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ac4973820ae04da7eabd746229df73?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Kurtaev", "link": "https://stackoverflow.com/users/6548453/dmitry-kurtaev"}, "edited": false, "score": 0, "creation_date": 1523723993, "post_id": 49778620, "comment_id": 86682721, "body": "@DmitryKurtaev, Thanks! I improved my description and made a ticket. -&gt; <a href=\"https://github.com/opencv/opencv/issues/11310\" rel=\"nofollow noreferrer\">github.com/opencv/opencv/issues/11310</a>"}], "tags": [], "owner": {"reputation": 2124, "user_id": 6055233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041547c8fcabcab4b2536d730fa01d03?s=128&d=identicon&r=PG&f=1", "display_name": "Catree", "link": "https://stackoverflow.com/users/6055233/catree"}, "is_accepted": true, "score": 1, "last_activity_date": 1523459260, "creation_date": 1523459260, "answer_id": 49778620, "question_id": 49777632, "link": "https://stackoverflow.com/questions/49777632/opencv-using-yolov3/49778620#49778620", "title": "OpenCv: Using Yolov3", "body": "<p>Only Yolo v2 is supported as of 2018/04/11, see the corresponding <a href=\"https://github.com/opencv/opencv/pull/9705\" rel=\"nofollow noreferrer\">pull request</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 6645302, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LxIfYvl_onM/AAAAAAAAAAI/AAAAAAAAACY/-kXJ835UfyI/photo.jpg?sz=128", "display_name": "SoullessStone", "link": "https://stackoverflow.com/users/6645302/soullessstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4602, "favorite_count": 2, "accepted_answer_id": 49778620, "answer_count": 1, "score": 2, "last_activity_date": 1524245215, "creation_date": 1523456613, "last_edit_date": 1524245215, "question_id": 49777632, "link": "https://stackoverflow.com/questions/49777632/opencv-using-yolov3", "title": "OpenCv: Using Yolov3", "body": "<p>I used the OpenCV Code from <a href=\"https://docs.opencv.org/3.4.1/da/d9d/tutorial_dnn_yolo.html\" rel=\"nofollow noreferrer\">https://docs.opencv.org/3.4.1/da/d9d/tutorial_dnn_yolo.html</a> and made it work on my machine with the yolov2 config/weights. When I try to run the program with yolov3 config/weights (<a href=\"https://pjreddie.com/media/files/yolov3.weights\" rel=\"nofollow noreferrer\">https://pjreddie.com/media/files/yolov3.weights</a>, <a href=\"https://github.com/pjreddie/darknet/blob/master/cfg/yolov3.cfg\" rel=\"nofollow noreferrer\">https://github.com/pjreddie/darknet/blob/master/cfg/yolov3.cfg</a>. both working, when used in ubuntu / not in opencv), it fails on the line </p>\n\n<pre><code>dnn::Net net = readNetFromDarknet(modelConfiguration, modelBinary);\n</code></pre>\n\n<p>The Exception is:</p>\n\n<blockquote>\n  <p>Unhandled exception at 0xyz in xyz.exe: Microsoft C++ exception: cv::Exception at memory location 0xyz.</p>\n</blockquote>\n\n<p>The expected behavior would be, that it shows the recognition results, like it does with the yolov2 cfg/weights.</p>\n\n<p>Is yolov3 even usable in opencv?</p>\n\n<p>Thanks,\nMichel</p>\n\n<hr>\n\n<p>Update: Question was answered below. I made a issue in github: <a href=\"https://github.com/opencv/opencv/issues/11310\" rel=\"nofollow noreferrer\">https://github.com/opencv/opencv/issues/11310</a></p>\n\n<hr>\n\n<p><strong>Update v2</strong>: yolov3 is now supported in opencv. -> <a href=\"https://github.com/opencv/opencv/issues/11310\" rel=\"nofollow noreferrer\">https://github.com/opencv/opencv/issues/11310</a> includes an example of the usage</p>\n"}, {"tags": ["c++", "boost", "c++14", "metaprogramming", "boost-hana"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1523456927, "post_id": 49777628, "comment_id": 86570606, "body": "Can you make the code self-contained"}, {"owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1523457188, "post_id": 49777628, "comment_id": 86570823, "body": "Sure - basically you just have to write <code>int main() {}</code> below it and it should make for a complete C++ program. Of course it doesn&#39;t compile, since both my attempts above have the aforementioned problem. I&#39;ll append that to the post."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 2, "creation_date": 1523462616, "post_id": 49777628, "comment_id": 86574864, "body": "thanks for the edit. No worries, SSCCE is contained, not &quot;running&quot;. Just helps others jump in (without them having to reinvent the includes, aliases etc. you used (they are sometimes part of the problem, by the way)_"}], "answers": [{"comments": [{"owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "edited": false, "score": 1, "creation_date": 1523524242, "post_id": 49779820, "comment_id": 86599418, "body": "Wow. Boost.Hana really has basically everything. I&#39;ll make this the accepted answer, because it&#39;s a lot cleaner, thanks!"}], "tags": [], "owner": {"reputation": 1567, "user_id": 800347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Buq1.jpg?s=128&g=1", "display_name": "Jason Rice", "link": "https://stackoverflow.com/users/800347/jason-rice"}, "is_accepted": true, "score": 7, "last_activity_date": 1523462822, "creation_date": 1523462822, "answer_id": 49779820, "question_id": 49777628, "link": "https://stackoverflow.com/questions/49777628/use-hanatransform-to-transform-types-inside-tuple-in-c14/49779820#49779820", "title": "Use hana::transform to transform types inside tuple in C++14", "body": "<p>Boost.Hana has <a href=\"http://boostorg.github.io/hana/group__group-Metafunction.html#ga246419f6c3263b648412f346106e6543\" rel=\"noreferrer\"><code>hana::template_</code></a> for applying types to a template which returns a type.</p>\n\n<pre><code>#include &lt;boost/hana/assert.hpp&gt;\n#include &lt;boost/hana/equal.hpp&gt;\n#include &lt;boost/hana/transform.hpp&gt;\n#include &lt;boost/hana/tuple.hpp&gt;\n#include &lt;boost/hana/type.hpp&gt;\n#include &lt;vector&gt;\n\nnamespace hana = boost::hana;\n\n\nint main() {\n    constexpr auto some_tuple = hana::tuple_t&lt;int, char *, bool&gt;;\n    constexpr auto expected_tuple = hana::tuple_t&lt;std::vector&lt;int&gt;,\n                                                  std::vector&lt;char*&gt;,\n                                                  std::vector&lt;bool&gt;&gt;;\n\n    constexpr auto transformed_tuple = hana::transform(some_tuple, hana::template_&lt;std::vector&gt;);\n\n    BOOST_HANA_CONSTANT_CHECK(transformed_tuple == expected_tuple);\n}\n</code></pre>\n"}], "owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 1, "accepted_answer_id": 49779820, "answer_count": 1, "score": 5, "last_activity_date": 1523462822, "creation_date": 1523456594, "last_edit_date": 1523462533, "question_id": 49777628, "link": "https://stackoverflow.com/questions/49777628/use-hanatransform-to-transform-types-inside-tuple-in-c14", "title": "Use hana::transform to transform types inside tuple in C++14", "body": "<p>I'm trying to use Boost's <code>hana::transform</code> to change the types inside a <code>hana::tuple</code>. As an example, say I have </p>\n\n<pre><code>constexpr auto some_tuple = hana::tuple_t&lt;int, char *, bool&gt;;\n</code></pre>\n\n<p>and I want to produce</p>\n\n<pre><code>constexpr auto transformed_tuple = hana::tuple_t&lt;std::vector&lt;int&gt;,\n                                                 std::vector&lt;char *&gt;, \n                                                 std::vector&lt;bool&gt;&gt;;\n</code></pre>\n\n<p><strong>Attempt 1</strong></p>\n\n<p>The solution seemed easy to me: Use <code>hana::transform</code> and make the applied function return <code>hana::type_c&lt;std::vector&lt;decltype(T)::type&gt;&gt;</code>. However, I can't make this work:</p>\n\n<pre><code>constexpr auto transformed_tuple = hana::transform(some_tuple, [](auto T) {\n    using inner_type = typename decltype(T)::type;\n    return hana::type_c&lt;std::vector&lt;inner_type&gt;&gt;;\n});\n</code></pre>\n\n<p>This has the problem that the lambda expression is not a <code>constexpr</code> - and I want to stay in C++14, i.e., lambdas can't be <code>constexpr</code>.</p>\n\n<p><strong>Attempt 2</strong></p>\n\n<p>My next thought: What if I wrapped the <code>hana::transform</code> into a <code>decltype</code>, and then use <code>hana::type_c</code> on that? This way, the lambda never needs to be evaluated (only its return type must be deduced), and <code>constexpr</code>ness should not matter:</p>\n\n<pre><code>constexpr auto transformed_tuple = \n    hana::type_c&lt;decltype(hana::transform(some_tuple, [](auto T) {\n        using inner_type = typename decltype(T)::type;\n        return hana::type_c&lt;std::vector&lt;inner_type&gt;&gt;;\n    }))&gt;;\n</code></pre>\n\n<p>However, now I run into the problem that lambda-expressions may not appear in an \"unevaluated context\".</p>\n\n<p>Is my approach completely wrong? Should I use something else than <code>hana::transform</code>?</p>\n\n<p>Thanks for any help.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>Sample code:</p>\n\n<pre><code>#include &lt;boost/hana.hpp&gt;\n#include &lt;boost/hana/tuple.hpp&gt;\n#include &lt;boost/hana/type.hpp&gt;\nnamespace hana = boost::hana;\n\n#include &lt;vector&gt;\n\nconstexpr auto some_tuple = hana::tuple_t&lt;int, char *, bool&gt;;\n\n/** What I want:\n *\n *   constexpr auto transformed_tuple \n *       = hana::tuple_t&lt;std::vector&lt;int&gt;,\n *           std::vector&lt;char *&gt;, \n *           std::vector&lt;bool&gt;&gt;;\n**/\n\n#if ATTEMPT1\n    constexpr auto transformed_tuple = hana::transform(some_tuple, [](auto T) {\n        using inner_type = typename decltype(T)::type;\n        return hana::type_c&lt;std::vector&lt;inner_type&gt;&gt;;\n    });\n\n#elif ATTEMPT2\n    constexpr auto transformed_tuple = hana::type_c&lt;decltype(hana::transform(some_tuple, [](auto T) {\n        using inner_type = typename decltype(T)::type;\n        return hana::type_c&lt;std::vector&lt;inner_type&gt;&gt;;\n    }))&gt;;\n\n#endif\n</code></pre>\n"}, {"tags": ["c++", "c++11", "stl", "stdvector", "stdset"], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1523456773, "post_id": 49777664, "comment_id": 86570473, "body": "You are 20 seconds faster, damn"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1523456814, "post_id": 49777664, "comment_id": 86570498, "body": "@Slava Sorry, sloth mode was not active ;)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1523457038, "post_id": 49777664, "comment_id": 86570691, "body": "@DanielLangr It all depends on the type.  If it is not bigger than a pointer then AFAIK there is no advantage.  Of course of the object is big then a reference should be used."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 11, "last_activity_date": 1523456905, "last_edit_date": 1523456905, "creation_date": 1523456695, "answer_id": 49777664, "question_id": 49777525, "link": "https://stackoverflow.com/questions/49777525/can-i-insert-into-a-set-all-the-elements-of-a-vector-that-matches-a-condition/49777664#49777664", "title": "Can I insert into a set, all the elements of a vector that matches a condition, in a single line of code", "body": "<p>You can use <a href=\"http://en.cppreference.com/w/cpp/algorithm/copy\" rel=\"noreferrer\"><code>std::copy_if</code></a> with a <a href=\"http://en.cppreference.com/w/cpp/language/lambda\" rel=\"noreferrer\">lambda</a> and <a href=\"http://en.cppreference.com/w/cpp/iterator/inserter\" rel=\"noreferrer\"><code>std::inserter</code></a> to insert the values into the set.  That looks like</p>\n\n<pre><code>std::copy_if(v.begin(), v.end(), std::inserter(s, s.begin()), [](auto val) { return val == some_condition; });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 3, "last_activity_date": 1523457595, "creation_date": 1523457595, "answer_id": 49778005, "question_id": 49777525, "link": "https://stackoverflow.com/questions/49777525/can-i-insert-into-a-set-all-the-elements-of-a-vector-that-matches-a-condition/49778005#49778005", "title": "Can I insert into a set, all the elements of a vector that matches a condition, in a single line of code", "body": "<p>With <a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow noreferrer\">range-v3</a>, it would be</p>\n\n<pre><code>set&lt;int&gt; s = v | ranges::view::filter([](int e){ return cond(e); });\n</code></pre>\n\n<p>or simply (if <code>cond</code> already exist)</p>\n\n<pre><code>set&lt;int&gt; s = v | ranges::view::filter(cond);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523464272, "post_id": 49778825, "comment_id": 86575884, "body": "I don&#39;t see the gain of <code>for_each</code> now that we have for range."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523465028, "post_id": 49778825, "comment_id": 86576314, "body": "@Jarod42 - not a gain at all, IMHO; it&#39;s just for fun (to show an alternative way to make the same thing) when the OP ask for a solution &quot;in a single line of code&quot; (but I suppose also the for range can be written and considered as a single line of code)"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 2, "last_activity_date": 1523459900, "creation_date": 1523459900, "answer_id": 49778825, "question_id": 49777525, "link": "https://stackoverflow.com/questions/49777525/can-i-insert-into-a-set-all-the-elements-of-a-vector-that-matches-a-condition/49778825#49778825", "title": "Can I insert into a set, all the elements of a vector that matches a condition, in a single line of code", "body": "<p>+1 for the <code>std::copy_if()</code> solution that, IMHO, is the natural solution for this problem.</p>\n\n<p>Just for fun, I propose a different solution based on <code>std::for_each()</code></p>\n\n<pre><code>std::set&lt;int&gt; s;\n\nstd::for_each(v.cbegin(), v.cend(),\n              [&amp;](int i) { if ( /* some condition */ ) s.insert(i); }); \n</code></pre>\n"}], "owner": {"reputation": 839, "user_id": 5090093, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wU3YG.jpg?s=128&g=1", "display_name": "nappyfalcon", "link": "https://stackoverflow.com/users/5090093/nappyfalcon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 49777664, "answer_count": 3, "score": 5, "last_activity_date": 1523459900, "creation_date": 1523456353, "question_id": 49777525, "link": "https://stackoverflow.com/questions/49777525/can-i-insert-into-a-set-all-the-elements-of-a-vector-that-matches-a-condition", "title": "Can I insert into a set, all the elements of a vector that matches a condition, in a single line of code", "body": "<p>I have a vector of elements. I want to populate a set using the elements of this vector that match a certain condition. Can I do this using one line, or in any way that is more concise than the below?</p>\n\n<pre><code>// given vector&lt;int&gt; v\n\nset&lt;int&gt; s;\nfor (const int&amp; i : v)\n{\n    if (/* some condition on i*/)\n        s.insert(i);\n}\n</code></pre>\n\n<p>For example, something along the line of:</p>\n\n<pre><code>// given vector&lt;int&gt; v\n\nset&lt;int&gt; s;\ns.insert(v.filter(/* lambda here*/));\n</code></pre>\n\n<p>It goes without saying that the v.filter method should return an iterator, not a separate populated vector, for performance reasons.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1523458375, "post_id": 49777459, "comment_id": 86571754, "body": "Can the score get larger than 3?"}, {"owner": {"reputation": 1, "user_id": 9631034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5abfea5bc9f1848384427b7768a3d4?s=128&d=identicon&r=PG&f=1", "display_name": "Shego", "link": "https://stackoverflow.com/users/9631034/shego"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1523477950, "post_id": 49777459, "comment_id": 86583012, "body": "Yes, it can go up to 6, (that will be when there are 4 &quot;x&quot;s in line. I just showed this little part of the code"}], "owner": {"reputation": 1, "user_id": 9631034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5abfea5bc9f1848384427b7768a3d4?s=128&d=identicon&r=PG&f=1", "display_name": "Shego", "link": "https://stackoverflow.com/users/9631034/shego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523456189, "creation_date": 1523456189, "question_id": 49777459, "link": "https://stackoverflow.com/questions/49777459/gomoku-diagolanl-score-allocation", "title": "Gomoku diagolanl score allocation.", "body": "<p>So, I'm trying to create my own algorithm in Gomoku whereby when player1 \nmakes a move, where ever it placed its \"x\", the \"x\" would be allocated scores around it. For instance, if there is just 1 \"x\" that is not surrounded by any other \"x\", it will get a score of 3 above, beneath and on either sides of it. If an \"x\" is placed next to the same \"x\" then the score around it would increment. So, I'm having trouble with allocating the scores to the diagonal ends. I have to take many things into consideration and its making my code too long. Is there a way that I could make this code shorter? </p>\n\n<p>Thanking everyone in advance. </p>\n\n<pre><code>if (coll==0 &amp;&amp; roww==0 &amp;&amp; boarDD[roww][coll]==1 &amp;&amp; boarDD[roww+1][coll+1]!=1) //diag top left corner\n            {\n                if (boarDD[roww+1][coll+1]&lt;3)\n                {\n                    boarDD[roww+1][coll+1]=3;\n                }\n            }\n            else if (roww==5 &amp;&amp; coll==0 &amp;&amp; boarDD[roww-1][coll+1]!=1 &amp;&amp; boarDD[roww][coll]==1 )//diag bot left\n            {\n                if (boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll+1]=3;\n                }\n            }\n            else if (roww==5 &amp;&amp; coll==5 &amp;&amp; boarDD[roww-1][coll-1]!=1 &amp;&amp; boarDD[roww][coll]==1 )//bot right corner\n            {\n                if (boarDD[roww-1][coll-1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                }\n            }\n            else if (roww==0 &amp;&amp; coll==5 &amp;&amp; boarDD[roww+1][coll-1]!=1 &amp;&amp; boarDD[roww][coll]==1)//top right corner\n            {\n                if (boarDD[roww+1][coll-1]&lt;3)\n                {\n                    boarDD[roww+1][coll-1]=3;\n                }\n            }\n            else if (roww==0 &amp;&amp; coll!=5 &amp;&amp; coll!=0 &amp;&amp; boarDD[roww+1][coll-1]!=1 &amp;&amp; boarDD[roww+1][coll+1]!=1 &amp;&amp; boarDD[roww][coll]==1)// top row exc diag\n            {\n                if (boarDD[roww+1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll+1]&lt;3)\n                {\n                    boarDD[roww+1][coll-1]=3;\n                    boarDD[roww+1][coll+1]=3;\n                }\n                else if (boarDD[roww+1][coll-1]&lt;3)\n                {\n                    boarDD[roww+1][coll-1]=3;\n                }\n                else if (boarDD[roww+1][coll+1]&lt;3)\n                {\n                    boarDD[roww+1][coll+1]=3;\n                }\n            }\n            else if (coll==0 &amp;&amp; roww!=5 &amp;&amp; roww!=0 &amp;&amp; boarDD[roww+1][coll+1]!=1 &amp;&amp; boarDD[roww-1][coll+1]!=1 &amp;&amp; boarDD[roww][coll]==1) //left row\n            {\n                if (boarDD[roww+1][coll+1]&lt;3 &amp;&amp; boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww+1][coll+1]=3;\n                    boarDD[roww-1][coll+1]=3;\n                }\n                else if (boarDD[roww+1][coll+1]&lt;3)\n                {\n                    boarDD[roww+1][coll+1]=3;\n                }\n                else if (boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll+1]=3;\n                }\n            }\n            else if (roww==5 &amp;&amp; coll!=0 &amp;&amp; coll!=5 &amp;&amp; boarDD[roww-1][coll-1]!=1 &amp;&amp; boarDD[roww-1][coll+1]!=1 &amp;&amp; boarDD[roww][coll]==1) //bot roww\n            {\n                if (boarDD[roww-1][coll-1]&lt;3 &amp;&amp; boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                    boarDD[roww-1][coll+1]=3;\n                }\n                else if (boarDD[roww-1][coll-1]&lt;3)\n                {\n                     boarDD[roww-1][coll-1]=3;\n                }\n                else if (boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll+1]=3;\n                }\n            }\n            else if (coll==5 &amp;&amp; roww!=0 &amp;&amp; roww!=5 &amp;&amp; boarDD[roww-1][coll-1]!=1 &amp;&amp; boarDD[roww+1][coll-1]!=1 &amp;&amp; boarDD[roww][coll]==1)//right col\n            {\n                if (boarDD[roww-1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll-1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                    boarDD[roww+1][coll-1]=3;\n                }\n                else if (boarDD[roww-1][coll-1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                }\n                else if (boarDD[roww+1][coll-1]&lt;3)\n                {\n                    boarDD[roww+1][coll-1]=3;\n                }\n            }\n            else if (roww!=0 &amp;&amp; roww!=5 &amp;&amp; coll!=0 &amp;&amp; coll!=5 &amp;&amp; boarDD[roww-1][coll-1]!=1 &amp;&amp; boarDD[roww+1][coll-1]!=1 &amp;&amp; boarDD[roww+1][coll+1]!=1 &amp;&amp; boarDD[roww-1][coll+1]!=1 &amp;&amp; boarDD[roww][coll]==1)\n            {\n                if (boarDD[roww-1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll+1]&lt;3 &amp;&amp; boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                    boarDD[roww+1][coll-1]=3;\n                    boarDD[roww+1][coll+1]=3;\n                    boarDD[roww-1][coll+1]=3;\n                }\n                else if (boarDD[roww-1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                    boarDD[roww+1][coll-1]=3;\n                    boarDD[roww+1][coll+1]=3;\n                }\n                else if (boarDD[roww+1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll+1]&lt;3 &amp;&amp; boarDD[roww-1][coll+1]&lt;3)\n                {\n                     boarDD[roww+1][coll-1]=3;\n                     boarDD[roww+1][coll+1]=3;\n                     boarDD[roww-1][coll+1]=3;\n                }\n                else if(boarDD[roww-1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll+1]&lt;3 &amp;&amp; boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                    boarDD[roww+1][coll+1]=3;\n                    boarDD[roww-1][coll+1]=3;\n\n                }\n                else if (boarDD[roww-1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll-1]&lt;3 &amp;&amp; boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                    boarDD[roww+1][coll-1]=3;\n                    boarDD[roww-1][coll+1]=3;\n                }\n                else if (boarDD[roww-1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll-1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                    boarDD[roww+1][coll-1]=3;\n                }\n                else if(boarDD[roww+1][coll-1]&lt;3 &amp;&amp; boarDD[roww+1][coll+1]&lt;3)\n                {\n                    boarDD[roww+1][coll-1]=3;\n                    boarDD[roww+1][coll+1]=3;\n                }\n                else if (boarDD[roww+1][coll+1]&lt;3 &amp;&amp; boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww+1][coll+1]=3;\n                    boarDD[roww-1][coll+1]=3;\n                }\n                else if (boarDD[roww-1][coll-1]&lt;3 &amp;&amp; boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                    boarDD[roww-1][coll+1]=3;\n                }\n                else if (boarDD[roww-1][coll-1]&lt;3)\n                {\n                    boarDD[roww-1][coll-1]=3;\n                }\n                else if(boarDD[roww+1][coll-1]&lt;3)\n                {\n                    boarDD[roww+1][coll-1]=3;\n                }\n                else if (boarDD[roww+1][coll+1]&lt;3)\n                {\n                    boarDD[roww+1][coll+1]=3;\n                }\n                else if (boarDD[roww-1][coll+1]&lt;3)\n                {\n                    boarDD[roww-1][coll+1]=3;\n                }\n\n            }\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "boost-mutex", "recursive-mutex", "unique-lock"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1523455358, "post_id": 49777134, "comment_id": 86569445, "body": "i find it confusing that you talk in terms of locks. If they all lock the same mutex, then what is the problem?"}, {"owner": {"reputation": 2790, "user_id": 113718, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d8e55da6de45e431355f6f34ef83436d?s=128&d=identicon&r=PG", "display_name": "Bill Kotsias", "link": "https://stackoverflow.com/users/113718/bill-kotsias"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1523455472, "post_id": 49777134, "comment_id": 86569524, "body": "@user463035818 You are right... I am calling the mutex a <code>Lock</code> because that&#39;s how it&#39;s named in the framework I am working on :-) But I have explained what&#39;s causing the lock-up in the bullet-list."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1523455572, "post_id": 49777134, "comment_id": 86569591, "body": "The common way is always lock mutexes in the same order... always."}, {"owner": {"reputation": 81656, "user_id": 8446, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8f9c683775bfbe76ed4855a19b73dc81?s=128&d=identicon&r=PG", "display_name": "Roger Lipscombe", "link": "https://stackoverflow.com/users/8446/roger-lipscombe"}, "edited": false, "score": 1, "creation_date": 1523455824, "post_id": 49777134, "comment_id": 86569778, "body": "Related? <a href=\"https://stackoverflow.com/questions/7125250/making-pthread-rwlock-wrlock-recursive\" title=\"making pthread rwlock wrlock recursive\">stackoverflow.com/questions/7125250/&hellip;</a>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1523455866, "post_id": 49777134, "comment_id": 86569820, "body": "This is a standard deadlock scenario.  A ReaderWriterLock is one of the basic synchronization primitives, google can help you find one.  Also ensures that multiple threads can read concurrently, you don&#39;t have that right now."}, {"owner": {"reputation": 1471, "user_id": 4161406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jmkcSCy65Dc/AAAAAAAAAAI/AAAAAAAAACA/3IMYGIYfw28/photo.jpg?sz=128", "display_name": "BJovke", "link": "https://stackoverflow.com/users/4161406/bjovke"}, "edited": false, "score": 0, "creation_date": 1523456030, "post_id": 49777134, "comment_id": 86569941, "body": "Why do you think that &quot;Lock2&quot; is going to wait? As I understood it&#39;s a <code>shared_lock</code> and <code>Lock1</code> and <code>Lock2</code> lock the same <code>shared_mutex</code>. LockW will wait for Lock1 but Lock2 will succeed without waiting."}, {"owner": {"reputation": 2790, "user_id": 113718, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d8e55da6de45e431355f6f34ef83436d?s=128&d=identicon&r=PG", "display_name": "Bill Kotsias", "link": "https://stackoverflow.com/users/113718/bill-kotsias"}, "reply_to_user": {"reputation": 1471, "user_id": 4161406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jmkcSCy65Dc/AAAAAAAAAAI/AAAAAAAAACA/3IMYGIYfw28/photo.jpg?sz=128", "display_name": "BJovke", "link": "https://stackoverflow.com/users/4161406/bjovke"}, "edited": false, "score": 0, "creation_date": 1523456296, "post_id": 49777134, "comment_id": 86570133, "body": "@BJovke That&#39;s what I thought too, but because Lock1 and Lock2 are in the same thread, and Lock1 outlives Lock2, there&#39;s chance that the deadlock described above will occur..."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1523457276, "post_id": 49777134, "comment_id": 86570889, "body": "Your code has undefined behavior: <code>If lock_shared is called by a thread that already owns the mutex in any mode (exclusive or shared), the behavior is undefined.</code>."}, {"owner": {"reputation": 730, "user_id": 8270416, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/876b251bdfdc25fbda57c01009c054be?s=128&d=identicon&r=PG&f=1", "display_name": "ttemple", "link": "https://stackoverflow.com/users/8270416/ttemple"}, "edited": false, "score": 0, "creation_date": 1523714275, "post_id": 49777134, "comment_id": 86679682, "body": "It sounds like you calling a function that locks from within a function that has already acquired a lock?  If so, that will not work, as pointed out by SergeyA."}], "owner": {"reputation": 2790, "user_id": 113718, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d8e55da6de45e431355f6f34ef83436d?s=128&d=identicon&r=PG", "display_name": "Bill Kotsias", "link": "https://stackoverflow.com/users/113718/bill-kotsias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523455228, "creation_date": 1523455228, "question_id": 49777134, "link": "https://stackoverflow.com/questions/49777134/having-multiple-reader-locks-in-a-single-thread", "title": "Having multiple reader locks in a single thread", "body": "<p>I have data coupled with a <code>Lock = boost::shared_mutex</code>.\nI am <em>locking data access</em> with</p>\n\n<p><em>reader locks</em> <code>ReadLock = boost::shared_lock&lt;Lock&gt;</code></p>\n\n<p><strong>and</strong> <em>writer locks</em> <code>WriteLock = boost::unique_lock&lt;Lock&gt;</code>.</p>\n\n<p>Obviously, lots of readers may be reading the data at a time, and only one writing at it. But here's the catch:</p>\n\n<p>A single thread may have <strong>mutliple readlocks</strong> on the same mutex, because it's calling functions that are locking the data themselves (with a <code>ReadLock</code>). But, as I have found, this causes inter-locking:</p>\n\n<ul>\n<li>Thread 1 read-locks data (Lock1)</li>\n<li>Thread 2 waits with a write-lock (LockW)</li>\n<li>Thread 1 spawns another read-lock (Lock2) while Lock1 is still alive</li>\n</ul>\n\n<p>Now I get a lock because <code>Lock2</code> is waiting for <code>LockW</code> to exit, <code>LockW</code> is waiting for <code>Lock1</code>, and<code>Lock1</code> is stuck because of <code>Lock2</code>.</p>\n\n<p>I don't know if it's possible to change the design so that each thread only does a single <code>ReadLock</code>. I believe that having a system that <strong><em>starves Writers</em></strong> would solve my issues. Is there a <em>common</em> way on how to handle my case?</p>\n"}, {"tags": ["c++", "recursion", "shared-ptr", "boost-serialization"], "owner": {"reputation": 337, "user_id": 7597532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd00f7072ae237106dafcc02c618982f?s=128&d=identicon&r=PG&f=1", "display_name": "B. A. Sylla", "link": "https://stackoverflow.com/users/7597532/b-a-sylla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1523466349, "creation_date": 1523454346, "last_edit_date": 1523466349, "question_id": 49776808, "link": "https://stackoverflow.com/questions/49776808/boost-serialization-with-recursive-shared-pointer-fails", "title": "boost serialization with recursive shared pointer fails", "body": "<p>I have created a sample code that shows a class B derived from class A and A gets a shared pointer for B in the ctor.</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n\n// #include &lt;boost/archive/text_iarchive.hpp&gt;\n// #include &lt;boost/archive/text_oarchive.hpp&gt;\n#include &lt;boost/archive/xml_iarchive.hpp&gt;\n#include &lt;boost/archive/xml_oarchive.hpp&gt;\n#include &lt;boost/archive/tmpdir.hpp&gt;\n#include &lt;boost/filesystem.hpp&gt;\n#include &lt;boost/serialization/shared_ptr.hpp&gt;\n\n// forward declarations\nclass A;\nclass B;\n\n////////////////////////////////////////////////////////////////////////////////\n\nclass A {\nprivate:\n    friend class boost::serialization::access;\n\n    template&lt;class Archive&gt;\n    void serialize(Archive &amp; ar, const unsigned int file_version) {\n        // ar &amp; text_a;\n        ar &amp; BOOST_SERIALIZATION_NVP(text_a);\n        // ar &amp; counter;\n        ar &amp; BOOST_SERIALIZATION_NVP(counter);\n        // ar &amp; pointer_class;\n        ar &amp; BOOST_SERIALIZATION_NVP(pointer_class);\n    }\npublic:\n    std::string    text_a{\"default\"};\n    int            counter{0};\n    boost::shared_ptr&lt;B&gt; pointer_class;\n    // B            *pointer_class;\n    A() {}\n    A(boost::shared_ptr&lt;B&gt; pointer_class): pointer_class(pointer_class) {}\n    // A(B *pointer_class): pointer_class(pointer_class) {}\n    virtual ~A() {}\n};\n\nBOOST_SERIALIZATION_SHARED_PTR(A)\n\n////////////////////////////////////////////////////////////////////////////////\n\nclass B: public A {\nprivate:\n    friend class boost::serialization::access;\n\n    template&lt;class Archive&gt;\n    void serialize(Archive &amp; ar, const unsigned int file_version) {\n        // first base classes\n        // ar &amp; boost::serialization::base_object&lt;A&gt;(*this);\n        ar &amp; BOOST_SERIALIZATION_BASE_OBJECT_NVP(A);\n        // then member fields\n        // ar &amp; text_b;\n        ar &amp; BOOST_SERIALIZATION_NVP(text_b);\n    }\npublic:\n    std::string    text_b{\"default\"};\n    B(): A(boost::shared_ptr&lt;B&gt;(this)) {}\n    // B(): A(this) {}\n    virtual ~B() {}\n};\n\nBOOST_SERIALIZATION_SHARED_PTR(B)\n\n////////////////////////////////////////////////////////////////////////////////\n\nboost::shared_ptr&lt;B&gt; dataset;\n\nvoid SaveDataset(std::string&amp; filename) {\n    std::ofstream ofs(filename.c_str());\n    boost::archive::xml_oarchive archive(ofs);\n    if (!ofs.is_open()) {\n        std::cerr &lt;&lt; \"-- can't open file '\" &lt;&lt; filename &lt;&lt; '\\'' &lt;&lt; std::endl;\n        std::exit(EXIT_FAILURE);\n    }\n    // oa &lt;&lt; dataset;\n    archive &amp; BOOST_SERIALIZATION_NVP(dataset);\n}\n\nvoid LoadDataset(std::string&amp; filename) {\n    std::ifstream ifs(filename.c_str());\n    boost::archive::xml_iarchive archive(ifs);\n    if (!ifs.is_open()) {\n        std::cerr &lt;&lt; \"-- can't open file '\" &lt;&lt; filename &lt;&lt; '\\'' &lt;&lt; std::endl;\n        std::exit(EXIT_FAILURE);\n    }\n    // ia &gt;&gt; dataset;\n    archive &amp; BOOST_SERIALIZATION_NVP(dataset);\n}\n\nvoid PrintDataset() {\n    std::cout &lt;&lt; \"text_a = '\" &lt;&lt; dataset-&gt;text_a &lt;&lt; '\\'' &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"text_b = '\" &lt;&lt; dataset-&gt;text_b &lt;&lt; '\\'' &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"counter = '\" &lt;&lt; dataset-&gt;counter &lt;&lt; '\\'' &lt;&lt; std::endl;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nint main(int argc, char *argv[]) {\n    std::string filename = \"dataset.dat\";\n    // dataset = std::make_shared&lt;B&gt;();\n    dataset = boost::shared_ptr&lt;B&gt;(new B());\n\n    {\n        // if file doesn't exit\n        if (!boost::filesystem::exists(filename)) {\n            // make some changes\n            dataset-&gt;text_a = \"hello\";\n            dataset-&gt;text_b = \"world\";\n\n            // save dataset\n            SaveDataset(filename);\n            std::clog &lt;&lt; \"-- saved dataset\" &lt;&lt; std::endl;\n        }\n\n        // load dataset\n        LoadDataset(filename);\n        std::clog &lt;&lt; \"-- loaded dataset\" &lt;&lt; std::endl;\n\n        // increment the counter twice\n        dataset-&gt;counter++;\n        dataset-&gt;pointer_class-&gt;counter++;\n\n        // print dataset\n        PrintDataset();\n\n        // save dataset before exit for next time\n        SaveDataset(filename);\n        std::clog &lt;&lt; \"-- saved dataset\" &lt;&lt; std::endl;\n    }\n\n    // std::remove(filename.c_str());\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Its possible to compile it, but at runtime I get:</p>\n\n<pre><code>prog.exe: /opt/wandbox/boost-1.66.0/gcc-head/include/boost/smart_ptr/shared_ptr.hpp:698: void boost::shared_ptr&lt;T&gt;::reset(Y*) [with Y = B; T = B]: Assertion `p == 0 || p != px' failed.\n</code></pre>\n\n<p>Here is a <a href=\"https://wandbox.org/permlink/P1oWQ9bY4uXDo1lM\" rel=\"nofollow noreferrer\">demo</a> for that sample code.</p>\n\n<p>But it runs fine, if I change these three lines to c pointers:</p>\n\n<pre><code>boost::shared_ptr&lt;B&gt; pointer_class;\n// B            *pointer_class;\nA(boost::shared_ptr&lt;B&gt; pointer_class): pointer_class(pointer_class) {}\n// A(B *pointer_class): pointer_class(pointer_class) {}\nB(): A(boost::shared_ptr&lt;B&gt;(this)) {}\n// B(): A(this) {}\n</code></pre>\n\n<p>Here is a working <a href=\"https://wandbox.org/permlink/t0Zdl9mjvrpOT4mN\" rel=\"nofollow noreferrer\">demo</a> that is like the sample code above but with these three lines changes.</p>\n\n<p>I tried also to use a third class C and put a shared pointer in class A. And the serial/deserial worked. But if there is recursion with a shared pointer like in this sample, it does not work. Any idea why?</p>\n"}, {"tags": ["c++", "bash", "qt"], "comments": [{"owner": {"reputation": 1766, "user_id": 264148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd00a8313fd6255ddbbe88e7aff63d0e?s=128&d=identicon&r=PG", "display_name": "r_ahlskog", "link": "https://stackoverflow.com/users/264148/r-ahlskog"}, "edited": false, "score": 3, "creation_date": 1523454515, "post_id": 49776646, "comment_id": 86568801, "body": "What you are doing wrong? You are misunderstanding what mkpasswd does."}, {"owner": {"reputation": 713, "user_id": 4090695, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GQruf.jpg?s=128&g=1", "display_name": "\u0160erg", "link": "https://stackoverflow.com/users/4090695/%c5%a0erg"}, "reply_to_user": {"reputation": 1766, "user_id": 264148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd00a8313fd6255ddbbe88e7aff63d0e?s=128&d=identicon&r=PG", "display_name": "r_ahlskog", "link": "https://stackoverflow.com/users/264148/r-ahlskog"}, "edited": false, "score": 0, "creation_date": 1523454995, "post_id": 49776646, "comment_id": 86569184, "body": "I need hash of password. It is possible to get result #2 in Qt?"}, {"owner": {"reputation": 1766, "user_id": 264148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd00a8313fd6255ddbbe88e7aff63d0e?s=128&d=identicon&r=PG", "display_name": "r_ahlskog", "link": "https://stackoverflow.com/users/264148/r-ahlskog"}, "edited": false, "score": 1, "creation_date": 1523455301, "post_id": 49776646, "comment_id": 86569400, "body": "It is absolutely possible. First step in that would be understanding what you need to do, so start by understanding what mkpasswd does to get that result."}, {"owner": {"reputation": 1836, "user_id": 6281755, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-99Ov53Fu-tc/AAAAAAAAAAI/AAAAAAAAAHU/zL_keIDgCbw/photo.jpg?sz=128", "display_name": "Robert Seaman", "link": "https://stackoverflow.com/users/6281755/robert-seaman"}, "edited": false, "score": 2, "creation_date": 1523457966, "post_id": 49776646, "comment_id": 86571397, "body": "Just an FYI - don&#39;t use md5 for password hashing - <a href=\"https://security.stackexchange.com/questions/52461/how-weak-is-md5-as-a-password-hashing-function\" title=\"how weak is md5 as a password hashing function\">security.stackexchange.com/questions/52461/&hellip;</a>"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 1, "creation_date": 1523465276, "post_id": 49776646, "comment_id": 86576441, "body": "The salt is randomly generated each time <code>mkpasswd</code> runs. So if you&#39;re attempting to get identical results - it&#39;s not going to happen. You can only get compatible results."}, {"owner": {"reputation": 95080, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 1, "creation_date": 1523469653, "post_id": 49776646, "comment_id": 86578693, "body": "Your Qt5 code <i>is</i> giving the MD5 hash of the string &quot;test&quot; in hex encoding. Your mkpasswd command, on the other hand, is giving an MD5 hash of the string &quot;test&lt;newline&gt;&quot; <i>and a random salt value</i>, in base64 encoding, wrapped (along with the salt) in passwd entry format. Now: which of these do you actually want? <b>What are you actually trying to do?</b>"}, {"owner": {"reputation": 95080, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 1, "creation_date": 1523470631, "post_id": 49776646, "comment_id": 86579197, "body": "Depending on what you&#39;re actually trying to do, there are a number of possible answers <i>none of which match your question</i>. If you want the MD5 hash of a string, you want bash code that matches the Qt5 result, not vice versa. If you want to store a password hash, you should not use MD5 at all; use bcrypt or scrypt, or maybe Argon2 or PBKDF2. If you want to check against a stored password, you need to do something different from either of your code snippets, but closer to the mkpasswd command."}, {"owner": {"reputation": 1766, "user_id": 264148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd00a8313fd6255ddbbe88e7aff63d0e?s=128&d=identicon&r=PG", "display_name": "r_ahlskog", "link": "https://stackoverflow.com/users/264148/r-ahlskog"}, "reply_to_user": {"reputation": 95080, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 0, "creation_date": 1523517007, "post_id": 49776646, "comment_id": 86595129, "body": "@GordonDavisson you are saying exactly what I was feeling, at work I would have filed this as <b>requirements unclear</b>."}], "answers": [{"comments": [{"owner": {"reputation": 95080, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 0, "creation_date": 1523470220, "post_id": 49777575, "comment_id": 86578993, "body": "I&#39;d recommend using <code>printf &quot;%s&quot;</code> instead of <code>echo -n</code> -- depending on a variety of factors, <code>echo -n test</code> might print &quot;test&quot; without a newline, or might print &quot;-n test&quot; <i>with</i> a newline."}], "tags": [], "owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "is_accepted": false, "score": 2, "last_activity_date": 1523456471, "creation_date": 1523456471, "answer_id": 49777575, "question_id": 49776646, "link": "https://stackoverflow.com/questions/49776646/qt-and-mkpasswd-md5-hashes-difference/49777575#49777575", "title": "Qt and mkpasswd MD5 hashes difference", "body": "<p>You can replicate what you're doing in Qt issuing this bash command:</p>\n\n<pre><code>echo -n test  | md5sum\n</code></pre>\n\n<p>Notice the <code>-n</code> option, to suppress new line.</p>\n\n<p>As far as I can see, <code>mkpasswd</code> is not intended to encrypt existing passwords, but to randomly generate new ones.</p>\n"}, {"tags": [], "owner": {"reputation": 2482, "user_id": 9630756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zkdcg.png?s=128&g=1", "display_name": "Sergio Monteleone", "link": "https://stackoverflow.com/users/9630756/sergio-monteleone"}, "is_accepted": false, "score": 2, "last_activity_date": 1523458366, "last_edit_date": 1523458366, "creation_date": 1523458017, "answer_id": 49778155, "question_id": 49776646, "link": "https://stackoverflow.com/questions/49776646/qt-and-mkpasswd-md5-hashes-difference/49778155#49778155", "title": "Qt and mkpasswd MD5 hashes difference", "body": "<p>As far as I understand you want to generate a password hash for GNU/Linux.</p>\n\n<p>Then you should check the format of the password stored in the /etc/shadow file. It is <strong>not</strong> simply an MD5 hash of the password. </p>\n\n<p>The actual format is:</p>\n\n<p>\"$id$salt$hashed\"</p>\n\n<p>where:</p>\n\n<ul>\n<li>$id is the hashing algorithm. $1$ stands for MD5</li>\n<li>$salt is the random salt</li>\n<li>$hashed is the actual hash. </li>\n</ul>\n\n<p>Have a look at the <a href=\"https://linux.die.net/man/3/crypt\" rel=\"nofollow noreferrer\">crypt</a> man page for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 1766, "user_id": 264148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd00a8313fd6255ddbbe88e7aff63d0e?s=128&d=identicon&r=PG", "display_name": "r_ahlskog", "link": "https://stackoverflow.com/users/264148/r-ahlskog"}, "is_accepted": true, "score": 3, "last_activity_date": 1523458031, "creation_date": 1523458031, "answer_id": 49778160, "question_id": 49776646, "link": "https://stackoverflow.com/questions/49776646/qt-and-mkpasswd-md5-hashes-difference/49778160#49778160", "title": "Qt and mkpasswd MD5 hashes difference", "body": "<p>To replicate the behavior of <code>mkpasswd</code> using C++/Qt you need to figure out what it actually does. It does not hex encode the MD5 result of a string, what it does is more complex.</p>\n\n<p>I started from the man page of <a href=\"https://www.unix.com/man-page/linux/1/mkpasswd/\" rel=\"nofollow noreferrer\" title=\"mkpasswd\">mkpasswd</a> and found that it is a frontend for <a href=\"https://www.unix.com/man-page/linux/3/crypt/\" rel=\"nofollow noreferrer\" title=\"crypt\">crypt</a>. So what does crypt do then?</p>\n\n<p>Well the output is in the from of <code>$id$salt$encrypted</code> where id = 1 means MD5 then you have the salt which is combined with the input in some way finally there there is the output which is what comes from MD5 of the input+salt combo.</p>\n\n<p>The alphabet used is almost base64 according to the manual, with <code>.</code> instead of <code>+</code>.</p>\n"}], "owner": {"reputation": 713, "user_id": 4090695, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GQruf.jpg?s=128&g=1", "display_name": "\u0160erg", "link": "https://stackoverflow.com/users/4090695/%c5%a0erg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 49778160, "answer_count": 3, "score": 0, "last_activity_date": 1523518154, "creation_date": 1523453863, "last_edit_date": 1523518154, "question_id": 49776646, "link": "https://stackoverflow.com/questions/49776646/qt-and-mkpasswd-md5-hashes-difference", "title": "Qt and mkpasswd MD5 hashes difference", "body": "<ol>\n<li><p>In Qt5 i have a code with QCryptographicHash:</p>\n\n<pre><code>QString pass = \"test\";\nQString hash = QString(QCryptographicHash::hash(pass.toLatin1(),QCryptographicHash::Md5).toHex());\nqDebug() &lt;&lt; hash;\n</code></pre></li>\n</ol>\n\n<p>Result:</p>\n\n<blockquote>\n  <p>098f6bcd4621d373cade4e832627b4f6</p>\n</blockquote>\n\n<hr>\n\n<ol start=\"2\">\n<li><p>If I use bash and mkpasswd:</p>\n\n<pre><code>echo test | mkpasswd -s -5\n</code></pre></li>\n</ol>\n\n<p>Result:</p>\n\n<blockquote>\n  <p>$1$xCs.somY$b/VXeBeO9DZbqCR/31iPT1</p>\n</blockquote>\n\n<hr>\n\n<p>I need hash same as #2 result, but in Qt What am I doing wrong? I need hash of password in Qt.</p>\n"}, {"tags": ["c++", "constexpr", "string-view"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1523453920, "post_id": 49776429, "comment_id": 86568323, "body": "Which version of MSVS are you using?  What error(s) do you get?"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1523454146, "post_id": 49776429, "comment_id": 86568506, "body": "Apparently it will only compile with GCC 7.3 and not with the earlier versions."}, {"owner": {"reputation": 2800, "user_id": 2044848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6bec3c808d4bc55483015bacc8a55696?s=128&d=identicon&r=PG", "display_name": "Ellis", "link": "https://stackoverflow.com/users/2044848/ellis"}, "edited": false, "score": 0, "creation_date": 1523454546, "post_id": 49776429, "comment_id": 86568831, "body": "I&#39;m unfamiliar with MSVC versioning but from Compiler Explorer it looks like that version doesn&#39;t support <code>if constexpr</code>. <a href=\"https://blogs.msdn.microsoft.com/vcblog/2017/11/15/msvc-conformance-improvements-in-visual-studio-2017-version-15-5/\" rel=\"nofollow noreferrer\">This</a> page details C++17 features and says &quot;These features can be enabled by using the /std:c++17 version switch.&quot; If I add that switch on Compiler Explorer it tells me it&#39;s an unknown option. Have you tried running it locally with the latest MSVC?"}], "answers": [{"comments": [{"owner": {"reputation": 1397, "user_id": 2056191, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fe75bdfda5b7b10e0a4b57da8e0fd410?s=128&d=identicon&r=PG", "display_name": "Bomaz", "link": "https://stackoverflow.com/users/2056191/bomaz"}, "edited": false, "score": 0, "creation_date": 1523456069, "post_id": 49776932, "comment_id": 86569968, "body": "removing the constexpr from the if statement and making a constexpr bool doesn&#39;t fix it however <a href=\"https://godbolt.org/g/JhwL2W\" rel=\"nofollow noreferrer\">godbolt.org/g/JhwL2W</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1397, "user_id": 2056191, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fe75bdfda5b7b10e0a4b57da8e0fd410?s=128&d=identicon&r=PG", "display_name": "Bomaz", "link": "https://stackoverflow.com/users/2056191/bomaz"}, "edited": false, "score": 2, "creation_date": 1523456162, "post_id": 49776932, "comment_id": 86570045, "body": "@Bomaz There appears to be a bug in MSVS&#39;s implementation of the string comparison.  You should report it."}, {"owner": {"reputation": 1397, "user_id": 2056191, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fe75bdfda5b7b10e0a4b57da8e0fd410?s=128&d=identicon&r=PG", "display_name": "Bomaz", "link": "https://stackoverflow.com/users/2056191/bomaz"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1523460270, "post_id": 49776932, "comment_id": 86573200, "body": "@NathanOliver <a href=\"https://developercommunity.visualstudio.com/content/problem/232218/c-constexpr-string-view.html\" rel=\"nofollow noreferrer\">developercommunity.visualstudio.com/content/problem/232218/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3638, "user_id": 3893262, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c2858a4f4f41634337f78973b0281aa?s=128&d=identicon&r=PG&f=1", "display_name": "O&#39;Neil", "link": "https://stackoverflow.com/users/3893262/oneil"}, "is_accepted": true, "score": 3, "last_activity_date": 1523454714, "creation_date": 1523454714, "answer_id": 49776932, "question_id": 49776429, "link": "https://stackoverflow.com/questions/49776429/constexpr-string-view-comparison/49776932#49776932", "title": "Constexpr string_view comparison", "body": "<p>C++17 <code>constexpr if</code> statements <a href=\"http://en.cppreference.com/w/cpp/compiler_support#cpp17\" rel=\"nofollow noreferrer\">are supported since MSVC 19.11</a>.</p>\n\n<p>We can see in the error message that Compiler Explorer currently uses version 19.10.25017.</p>\n"}], "owner": {"reputation": 1397, "user_id": 2056191, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fe75bdfda5b7b10e0a4b57da8e0fd410?s=128&d=identicon&r=PG", "display_name": "Bomaz", "link": "https://stackoverflow.com/users/2056191/bomaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2749, "favorite_count": 1, "accepted_answer_id": 49776932, "answer_count": 1, "score": 1, "last_activity_date": 1523454714, "creation_date": 1523453293, "question_id": 49776429, "link": "https://stackoverflow.com/questions/49776429/constexpr-string-view-comparison", "title": "Constexpr string_view comparison", "body": "<p>I have <a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Ciostream%3E%0A%23include+%3Cstring_view%3E%0A%0Aint+main(int+argc,+char+**argv)+%7B%0A%09const+constexpr+auto+a+%3D+%22z%22%3B%0A%09const+constexpr+std::string_view+test(%22z%22,1)%3B%0A%09const+constexpr+std::string_view+test2(a,1)%3B%0A%09if+constexpr(test+%3D%3D+test2)+%7B%0A%09%09return+5%3B%0A%09%7D%0A++++else%7B%0A%09++++return+2%3B%0A++++%7D%0A%7D&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:53.99056071826385,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g73,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;0&#39;),lang:c%2B%2B,libs:!(),options:&#39;-std%3Dc%2B%2B17+-O2+&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.3+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:22.26856861236029,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:cl19_64,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;0&#39;),lang:c%2B%2B,libs:!(),options:&#39;/std:c%2B%2Blatest&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+MSVC+19+2017+RTW+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),k:23.74087066937585,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">a small program</a> that compiles on <code>GCC</code> but not on <code>MSVC</code>which compiler isn't following the standard for <code>constexpr string_view</code> comparison?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string_view&gt;\n\nint main(int argc, char **argv) {\n    const constexpr auto a = \"z\";\n    const constexpr std::string_view test(\"z\",1);\n    const constexpr std::string_view test2(a,1);\n    if constexpr(test == test2) {\n        return 5;\n    }\n    else{\n        return 2;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "shared-ptr"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 3, "creation_date": 1523453730, "post_id": 49776400, "comment_id": 86568190, "body": "In most cases, you should not use smart pointers as parameters at all; there are some exceptions, though, and your example is one of these. I recommend having a look at Herb Sutter&#39;s <a href=\"https://herbsutter.com/2013/05/30/gotw-91-smart-pointer-parameters/\" rel=\"nofollow noreferrer\">GotW 91</a> for getting some general info about..."}, {"owner": {"reputation": 103, "user_id": 8891026, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_bsC-SXAsq0/AAAAAAAAAAI/AAAAAAAAAEM/pY8YE00m7LY/photo.jpg?sz=128", "display_name": "Signekatt", "link": "https://stackoverflow.com/users/8891026/signekatt"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1523455288, "post_id": 49776400, "comment_id": 86569388, "body": "@Aconcagua The reason I need to store a shared pointer to an object is to make sure that it&#39;s not destroyed before the objects that need it are. But thank you for the article."}], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1523455419, "post_id": 49776485, "comment_id": 86569486, "body": "If the shared_ptr is passed as a const reference, the constructor will be unable to participate with the shared ownership of the object, thus defeating the entire point."}, {"owner": {"reputation": 538, "user_id": 9564168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arkady Godlin", "link": "https://stackoverflow.com/users/9564168/arkady-godlin"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1523455535, "post_id": 49776485, "comment_id": 86569565, "body": "the constructor will be able to take ownership if and the ref count will be 2 in this case. but now i understand that when you always want to take ownership it is better to accept by value."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1523455620, "post_id": 49776485, "comment_id": 86569626, "body": "@Eljay I don&#39;t know, what you are talking about: With a <code>const &amp;</code> argument, the object is guaranteed to persist as long as the function is executing. And the constructor is free to copy-construct its own <code>shared_ptr&lt;&gt;</code> from it to take part in the ownership."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1523455843, "post_id": 49776485, "comment_id": 86569795, "body": "As a matter of fact, I do not understand the downvotes on this answer: Passing by <code>const &amp;</code> is not exactly wrong, and it has been the best answer for a long time. And there are still cases where <code>const &amp;</code> passing beats move constructing any time. I wouldn&#39;t upvote this answer because move constructing is usually better, but downvoting it seems a bit unfair to me."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1523462784, "post_id": 49776485, "comment_id": 86574979, "body": "@cmaster The question is how to pass a <code>shared_ptr&lt;T&gt;</code> into a constructor where it&#39;ll be copied into a member variable. In that case <code>const&amp;</code> is never better, sometimes worse. There are different cases where <code>const&amp;</code> is better, but that is not this question. Its why I made an edit in my answer to be clear why its better in this case (and how to recognise this case)."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 1, "creation_date": 1523463405, "post_id": 49776485, "comment_id": 86575319, "body": "@MikeVine The case where <code>const &amp;</code> is better is this: Some object is an owner of some instance of <code>Boo</code> via a <code>shared_ptr&lt;&gt;</code>, and is asked to generate a <code>Foo</code> that references the same instance. Passing by value and moving means a) constructing a <code>shared_ptr&lt;&gt;</code> to be passed to the constructor, b) moving that argument over to the member variable. Passing by <code>const &amp;</code> means a) passing a pointer to the existing <code>shared_ptr&lt;&gt;</code> to the constructor, b) constructing the member variable directly from the original <code>shared_ptr&lt;&gt;</code>. Passing a single pointer is definitely faster than moving a <code>shared_ptr&lt;&gt;</code>."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1523485519, "post_id": 49776485, "comment_id": 86585959, "body": "@ArkadyGodlin \u2022 I was under the misimpression that the <code>const&amp;</code> would apply to the shared_ptr (as an object itself - the smart pointer).  That is not the case, I stand corrected, as per... <a href=\"https://stackoverflow.com/questions/44830481/is-use-count-on-const-stdshared-ptr-mutable\" title=\"is use count on const stdshared ptr mutable\">stackoverflow.com/questions/44830481/&hellip;</a>"}], "tags": [], "owner": {"reputation": 538, "user_id": 9564168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arkady Godlin", "link": "https://stackoverflow.com/users/9564168/arkady-godlin"}, "is_accepted": false, "score": -3, "last_activity_date": 1523454741, "last_edit_date": 1523454741, "creation_date": 1523453458, "answer_id": 49776485, "question_id": 49776400, "link": "https://stackoverflow.com/questions/49776400/passing-a-shared-pointer-by-reference-or-by-value-as-parameter-to-a-class/49776485#49776485", "title": "Passing a shared pointer by reference or by value as parameter to a class", "body": "<p>shared_ptr should be treated just like any other class when passing to functions. \nin this case you should pass to const reference.</p>\n\n<p>why i wrote why i wrote Herb Sutter jump to min 21:50\n<a href=\"https://www.youtube.com/watch?v=xnqTKD8uD64\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=xnqTKD8uD64</a></p>\n"}, {"comments": [{"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 5, "creation_date": 1523455370, "post_id": 49776497, "comment_id": 86569458, "body": "Nevertheless, even a move is not free. For the simple function <code>std::shared_ptr&lt;int&gt; foo(std::shared_ptr&lt;int&gt; arg) { return std::move(arg); }</code>, <code>g++</code> generates six memory accesses: Two to read the argument, two to null the argument, and two to construct the result. That&#39;s rather heavy on the memory bus (the CPU will be twiddlings its thumbs in the mean time). Of course, the move (local cache operation) is cheaper than bumping an atomic ref count (which has inter-CPU overheads), so this use of moving is very ok. Nevertheless, there are cases where passing by <code>const &amp;</code> is faster than moving."}], "tags": [], "owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "is_accepted": true, "score": 18, "last_activity_date": 1523454065, "last_edit_date": 1523454065, "creation_date": 1523453503, "answer_id": 49776497, "question_id": 49776400, "link": "https://stackoverflow.com/questions/49776400/passing-a-shared-pointer-by-reference-or-by-value-as-parameter-to-a-class/49776497#49776497", "title": "Passing a shared pointer by reference or by value as parameter to a class", "body": "<p>Pass it by value then move it into the member:</p>\n\n<pre><code>class Foo {\npublic:\n    Foo(std::shared_ptr&lt;Boo&gt; boo) \n        : m_Boo(std::move(boo)) {}\nprivate:\n    std::shared_ptr&lt;Boo&gt; m_Boo;\n};\n</code></pre>\n\n<p>This will be the most efficient in all cases - if the caller has a rvalue-reference then there wont be a single add-ref, if the caller has a value there'll be a single add-ref.</p>\n\n<p>If you pass by <code>const&amp;</code> you force an add-ref even in cases where its unnecessary. If you pass by value and then set without a <code>std::move</code> you may get 2 add-refs.</p>\n\n<p>Edit: This is a good pattern to use if you've got a class where a move is significantly cheaper than a copy, and you have a function call which will always copy the instance passed in - as in this case. You force the copy to happen at the function call boundary by taking it by value, and then if the caller has a rvalue reference the copy need never happen at all - it will be moved instead.</p>\n"}], "owner": {"reputation": 103, "user_id": 8891026, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_bsC-SXAsq0/AAAAAAAAAAI/AAAAAAAAAEM/pY8YE00m7LY/photo.jpg?sz=128", "display_name": "Signekatt", "link": "https://stackoverflow.com/users/8891026/signekatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2209, "favorite_count": 1, "accepted_answer_id": 49776497, "answer_count": 2, "score": 10, "last_activity_date": 1523454741, "creation_date": 1523453210, "last_edit_date": 1523453476, "question_id": 49776400, "link": "https://stackoverflow.com/questions/49776400/passing-a-shared-pointer-by-reference-or-by-value-as-parameter-to-a-class", "title": "Passing a shared pointer by reference or by value as parameter to a class", "body": "<p>Should a shared pointer be passed by reference or by value as a parameter to a class if it is going to be copied to a member variable?</p>\n\n<p>The copying of the shared pointer will increment the refrence count and I don't want to make any unnecessary copies and thus ref count increments. Will passing the shared pointer as a refrence solve this? I assume it does but are there any other problems with this?</p>\n\n<p><strong>Passing by value:</strong></p>\n\n<pre><code>class Boo {\npublic: \n    Boo() { }\n};\n\nclass Foo {\npublic:\n    Foo(std::shared_ptr&lt;Boo&gt; boo) \n        : m_Boo(boo) {}\nprivate:\n    std::shared_ptr&lt;Boo&gt; m_Boo;\n};\n\nint main() {\n    std::shared_ptr&lt;Boo&gt; boo = std::make_shared&lt;Boo&gt;();\n\n    Foo foo(boo);\n}\n</code></pre>\n\n<p><strong>Passing by refrence:</strong></p>\n\n<pre><code>class Boo {\npublic: \n    Boo() { }\n};\n\nclass Foo {\npublic:\n    Foo(std::shared_ptr&lt;Boo&gt;&amp; boo) \n        : m_Boo(boo) {}\nprivate:\n    std::shared_ptr&lt;Boo&gt; m_Boo;\n};\n\nint main() {\n    std::shared_ptr&lt;Boo&gt; boo = std::make_shared&lt;Boo&gt;();\n\n    Foo foo(boo);\n}\n</code></pre>\n"}, {"tags": ["c++", "arduino"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1523452732, "post_id": 49776183, "comment_id": 86567429, "body": "do you change value at all?  why do you talk about heap fragmentation when the variable you&#39;re asking about is on the stack?"}, {"owner": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 0, "creation_date": 1523452753, "post_id": 49776183, "comment_id": 86567441, "body": "I would imagine it&#39;s allocated on the call stack, not the heap, but my C++ is fairly limited. And depending on the compliation and context it may even be optimized out"}, {"owner": {"reputation": 538, "user_id": 9564168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arkady Godlin", "link": "https://stackoverflow.com/users/9564168/arkady-godlin"}, "edited": false, "score": 0, "creation_date": 1523452865, "post_id": 49776183, "comment_id": 86567521, "body": "int value is allocated on the stack and not heap"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523453019, "post_id": 49776183, "comment_id": 86567647, "body": "There is no dynamic allocation going on in your example.  <code>value</code> has automatic storage duration."}, {"owner": {"reputation": 3239, "user_id": 5271927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTJYf.jpg?s=128&g=1", "display_name": "KIIV", "link": "https://stackoverflow.com/users/5271927/kiiv"}, "edited": false, "score": 0, "creation_date": 1523524612, "post_id": 49776183, "comment_id": 86599670, "body": "Usual suspect is Arduino String class and using its concatenations like  <code>someString += anotherString + &quot;blabla&quot; + ..........</code>. It&#39;s usually used to spare some Serial.print() calls."}], "answers": [{"tags": [], "owner": {"reputation": 1069, "user_id": 5909613, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed74c29cc1502b7f39ede71993587291?s=128&d=identicon&r=PG&f=1", "display_name": "Jerome Reinl&#228;nder", "link": "https://stackoverflow.com/users/5909613/jerome-reinl%c3%a4nder"}, "is_accepted": false, "score": 0, "last_activity_date": 1523452928, "creation_date": 1523452928, "answer_id": 49776287, "question_id": 49776183, "link": "https://stackoverflow.com/questions/49776183/how-to-minimize-memory-allocation-on-embedded-platforms/49776287#49776287", "title": "How to minimize memory allocation on embedded platforms?", "body": "<p>I can't say where <code>MyController</code> will be instantiated, but each call of <code>do_stuff</code> instantiates <code>value</code> on the <strong>stack once</strong>. This memory will be freed as soon as <code>do_stuff</code> is left and since there is no recursion, there will not be several instances of <code>value</code> at once.</p>\n"}, {"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 2, "last_activity_date": 1523453002, "creation_date": 1523453002, "answer_id": 49776312, "question_id": 49776183, "link": "https://stackoverflow.com/questions/49776183/how-to-minimize-memory-allocation-on-embedded-platforms/49776312#49776312", "title": "How to minimize memory allocation on embedded platforms?", "body": "<p>On typical platforms, and I don't believe an Arduino is different in this respect, <code>int value</code> probably won't take memory. It will be in a register. (Small variable, local). If not, it will be on the CPU stack, which doesn't fragment, and it recycled whenever the function returns.</p>\n"}], "owner": {"reputation": 50130, "user_id": 247542, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c125f576c3a08c0c1d4330bc565ae28c?s=128&d=identicon&r=PG", "display_name": "Cerin", "link": "https://stackoverflow.com/users/247542/cerin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 49776312, "answer_count": 2, "score": 1, "last_activity_date": 1523517261, "creation_date": 1523452639, "last_edit_date": 1523517261, "question_id": 49776183, "link": "https://stackoverflow.com/questions/49776183/how-to-minimize-memory-allocation-on-embedded-platforms", "title": "How to minimize memory allocation on embedded platforms?", "body": "<p>How do you minimize dynamic memory allocation in C++?</p>\n\n<p>I'm writing some sketches for an Arduino Mega, and on occasion it's hanging, and I suspect it's suffering from memory fragmentation. However, I'm a little unclear as to when variables are allocated.</p>\n\n<p>If I have a class with a method <code>do_stuff</code> like:</p>\n\n<pre><code>class MyController{\n\npublic:\n    MyController(){\n        ...init...\n    }\n\n    void do_stuff(){\n        int value = 123;\n    }\n};\n</code></pre>\n\n<p>I instantiate <code>MyController</code> once but then execute <code>do_stuff()</code> multiple times. Does the program dynamically allocate <code>value</code> each time I call the method or just once when I instantiate the class?</p>\n\n<p>If the former, would it be better to change the method variable to a class variable, so it's only allocated once, and doesn't risk fragmenting the heap?</p>\n"}, {"tags": ["c++", "wmi"], "comments": [{"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "edited": false, "score": 0, "creation_date": 1523459350, "post_id": 49776105, "comment_id": 86572497, "body": "I got t  know from here <a href=\"https://social.technet.microsoft.com/Forums/windows/en-US/a01b3952-8d6b-4c7c-b507-6f18be7b8d7d/how-to-get-a-snapshot-instance-after-create-a-snapshot-by-wmi?forum=winserverhyperv\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/windows/en-US/&hellip;</a> that the new snapshot is associated with Job Object which is returned but how to do it ?"}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "edited": false, "score": 0, "creation_date": 1523605361, "post_id": 49776105, "comment_id": 86637984, "body": "I feel the SnapshotType Parameter is not correct not should be 32768. But how to convert uint16 to Variant is another Question."}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1524103109, "post_id": 49776105, "comment_id": 86838960, "body": "What is <code>WaitForJobCompletion</code>? If that&#39;s your code, can you post it?"}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1524121810, "post_id": 49776105, "comment_id": 86845123, "body": "Just waiting for the job to complete. So I check the status if it says job complete it exit @ministic"}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 1, "creation_date": 1524134645, "post_id": 49776105, "comment_id": 86853417, "body": "Well if there is a bug in here it&#39;s probably in that function, so if you still need help you should post it."}], "answers": [{"comments": [{"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "edited": false, "score": 0, "creation_date": 1524460791, "post_id": 49960617, "comment_id": 86963533, "body": "Nope, doesn&#39;t work, still the ResultingSnapshot is NULL"}, {"owner": {"reputation": 8101, "user_id": 9199167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqdLV.jpg?s=128&g=1", "display_name": "Max Vollmer", "link": "https://stackoverflow.com/users/9199167/max-vollmer"}, "reply_to_user": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "edited": false, "score": 0, "creation_date": 1524465914, "post_id": 49960617, "comment_id": 86965656, "body": "@MilindW There has to be detailed error messages then. What&#39;s the value of hr and what does <code>GetErrorInfo()</code> say?"}], "tags": [], "owner": {"reputation": 8101, "user_id": 9199167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqdLV.jpg?s=128&g=1", "display_name": "Max Vollmer", "link": "https://stackoverflow.com/users/9199167/max-vollmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1524348537, "creation_date": 1524348537, "answer_id": 49960617, "question_id": 49776105, "link": "https://stackoverflow.com/questions/49776105/wmi-execmethod-out-parameter-resultingsnapshot-is-null-irrespective-of-the-r/49960617#49960617", "title": "(WMI) ExecMethod out parameter - ResultingSnapshot is NULL irrespective of the result of the call, Why?", "body": "<p>You provide a <code>ppCallResult</code> parameter. From the <a href=\"https://msdn.microsoft.com/en-us/library/aa392103(v=vs.85).aspx\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>ppCallResult [out] If NULL, this is not used. If ppCallResult is\n  specified, it must be set to point to NULL on entry. <strong>In this case, the\n  call returns immediately with WBEM_S_NO_ERROR.</strong> The ppCallResult\n  parameter receives a pointer to a new IWbemCallResult object, <strong>which\n  must be polled to obtain the result of the method execution using the\n  GetCallStatus</strong> method. The out parameters for the call are available by\n  calling IWbemCallResult::GetResultObject.</p>\n</blockquote>\n\n<p>Therefore you need to use <code>GetCallStatus</code> on <code>pCallResult</code> until the method has finished and then <code>GetResultObject</code> to get the out parameters:</p>\n\n<pre><code>LONG status;\nwhile ((hr = pCallResult-&gt;GetCallStatus(1000, &amp;status)) == WBEM_S_TIMEDOUT);\n/* check hr and status here */\nhr = pCallResult-&gt;GetResultObject(0, &amp;pResObj);\n</code></pre>\n\n<p>or use WBEM_INFINITE:</p>\n\n<pre><code>LONG status;\nhr = pCallResult-&gt;GetCallStatus(WBEM_INFINITE, &amp;status);\n/* check hr and status here */\nhr = pCallResult-&gt;GetResultObject(0, &amp;pResObj);\n</code></pre>\n\n<p>Alternatively provide <code>NULL</code> instead of <code>pCallResult</code> and it will be a synchronous call where <code>pOutParameters</code> will be set:</p>\n\n<pre><code>hr = m_pWbemServices-&gt;ExecMethod(path, L\"CreateSnapshot\", 0, NULL, pInParams, &amp;pOutParameters, NULL);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 1990056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b774f72013a2d0f823cad77f8f436d?s=128&d=identicon&r=PG", "display_name": "user1990056", "link": "https://stackoverflow.com/users/1990056/user1990056"}, "is_accepted": true, "score": 3, "last_activity_date": 1524575204, "last_edit_date": 1524575204, "creation_date": 1524573385, "answer_id": 50001882, "question_id": 49776105, "link": "https://stackoverflow.com/questions/49776105/wmi-execmethod-out-parameter-resultingsnapshot-is-null-irrespective-of-the-r/50001882#50001882", "title": "(WMI) ExecMethod out parameter - ResultingSnapshot is NULL irrespective of the result of the call, Why?", "body": "<pre><code>HRESULT GetRelated(PWSTR sAssociatePath, PWSTR sResultClass, IWbemClassObject** ppResultObject)\n{\nCStringW query;\nquery.Format(L\"associators of {%s} where ResultClass = %s\", sAssociatePath, sResultClass);\n\nCComPtr&lt;IEnumWbemClassObject&gt; pEnumOb;\n\nHRESULT hr = m_pWbemServices-&gt;ExecQuery(\n    BSTR(L\"WQL\"),\n    CComBSTR(query),\n    WBEM_FLAG_FORWARD_ONLY | WBEM_FLAG_RETURN_IMMEDIATELY,\n    NULL,\n    &amp;pEnumOb));\nULONG uReturn = 0;\nCComPtr&lt;IWbemClassObject&gt; pObject;\nhr = pEnumOb-&gt;Next(WBEM_INFINITE, 1, &amp;pObject, &amp;uReturn);\nreturn hr;\n}\n// Call the GetRelated function above with the __PATH parameter of JOB\nCComPtr&lt;IWbemClassObject&gt; pOutParam = NULL;\nCHK_HRES(this-&gt;ExecMethod(pHyperVObject, L\"ConvertToReferencePoint\", pInParams, &amp;pOutParam, NULL));\nCComVariant jobPath;\nCHK_HRES(pOutParam-&gt;Get(L\"Job\", 0, &amp;jobPath, NULL, NULL));\nCComPtr&lt;IWbemClassObject&gt; pResult;\nGetRelated(jobPath.bstrVal, L\"Msvm_VirtualSystemReferencePoint\", &amp;pResult);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12977472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA31AavFgdK1iHPRDhGFLWTGNXBL10b50eNL9v_9w=k-s128", "display_name": "mayank srivastava", "link": "https://stackoverflow.com/users/12977472/mayank-srivastava"}, "reply_to_user": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "edited": false, "score": 0, "creation_date": 1605524594, "post_id": 64802053, "comment_id": 114667242, "body": "@Liger Sorry, for the inconvenience. But did you found an alternative? Because I am also trying to make a recovery snapshot and I am not able to use 32768.  And using 2 it gives me a standard snapshot."}], "tags": [], "owner": {"reputation": 1, "user_id": 12977472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA31AavFgdK1iHPRDhGFLWTGNXBL10b50eNL9v_9w=k-s128", "display_name": "mayank srivastava", "link": "https://stackoverflow.com/users/12977472/mayank-srivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1605600447, "last_edit_date": 1605600447, "creation_date": 1605176462, "answer_id": 64802053, "question_id": 49776105, "link": "https://stackoverflow.com/questions/49776105/wmi-execmethod-out-parameter-resultingsnapshot-is-null-irrespective-of-the-r/64802053#64802053", "title": "(WMI) ExecMethod out parameter - ResultingSnapshot is NULL irrespective of the result of the call, Why?", "body": "<p>Was SnapshotType=32768 giving error to you?\nBecause snapshot is not created when I use this Snapshot Type.</p>\n<p>The following log is getting created:</p>\n<p>Checkpoint creation failed for 'Ubuntu1' because an invalid checkpoint type has been specified. (Virtual machine ID 5C773BB5-B630-48B4-AB9E-71C548F3FAE4)</p>\n<p>Edit: I am not sure if it will help but this solved my problem:\n<a href=\"https://docs.microsoft.com/en-us/answers/questions/160321/wmi-createsnapshot-not-working-with-snapshottype-3.html\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/answers/questions/160321/wmi-createsnapshot-not-working-with-snapshottype-3.html</a></p>\n"}], "owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 922, "favorite_count": 3, "accepted_answer_id": 50001882, "answer_count": 3, "score": 4, "last_activity_date": 1605600447, "creation_date": 1523452419, "last_edit_date": 1523605492, "question_id": 49776105, "link": "https://stackoverflow.com/questions/49776105/wmi-execmethod-out-parameter-resultingsnapshot-is-null-irrespective-of-the-r", "title": "(WMI) ExecMethod out parameter - ResultingSnapshot is NULL irrespective of the result of the call, Why?", "body": "<p>I am using WMI to create an RCT Checkpoint. Below is the code snippet. The problem is when I call the method <code>Create Snapshot</code> using <code>ExecMethod</code>the checkpoint gets created but the <code>ResultingSnapshot</code> to still points to <code>NULL</code>.</p>\n\n<p>Since the call is asynchronous (as the return value from <code>pOutParameters</code> is 4096) I have also waited till the job gets completed in <code>WaitForJobCompletion</code> but <code>pOutParameters</code> is not updated and still, the <code>ResultingSnapshot</code> is NULL.</p>\n\n<p>Basically, I need this <code>ResultingSnapshot</code> for creating a reference point. If there is any other way to do it, I can write it, need guidance though.</p>\n\n<p>I am new to WMI, any help or lead is appreciated.</p>\n\n<pre><code>HRESULT hr;\nCComPtr&lt;IWbemClassObject&gt; pInParams;\nCComPtr&lt;IWbemClassObject&gt; pOutParameters;\nIWbemCallResult *pResult = 0;\n\n// Set Method Paramters\nthis-&gt;GetMethodParams(L\"Msvm_VirtualSystemSnapshotService\", L\"CreateSnapshot\", &amp;pInParams);\n\nIWbemClassObject * pVirtualSystemSnaphotSettingData = NULL;\nhr = m_pWbemServices-&gt;GetObject(L\"Msvm_VirtualSystemSnapshotSettingData\", 0, NULL, &amp;pVirtualSystemSnaphotSettingData, &amp;pResult);\n\nIWbemClassObject * pInpInstOfSnapshotSettingData = NULL;\nhr = pVirtualSystemSnaphotSettingData-&gt;SpawnInstance(0, &amp;pInpInstOfSnapshotSettingData);\n\nVARIANT consistencyLevel;\nVariantInit(&amp;consistencyLevel);\nV_VT(&amp;consistencyLevel) = VT_BSTR;\nV_BSTR(&amp;consistencyLevel) = SysAllocString(L\"1\");\nhr = pInpInstOfSnapshotSettingData-&gt;Put(L\"ConsistencyLevel\", 0, &amp;consistencyLevel, 0);\nVariantClear(&amp;consistencyLevel);\n\nVARIANT elementName;\nVariantInit(&amp;elementName);\nV_VT(&amp;elementName) = VT_BSTR;\nV_BSTR(&amp;elementName) = SysAllocString(L\"rhel-1\");\nhr = pInpInstOfSnapshotSettingData-&gt;Put(L\"ElementName\", 0, &amp;elementName, 0);\nVariantClear(&amp;elementName);\n\nhr = m_pWbemServices-&gt;PutInstance(pInpInstOfSnapshotSettingData, 0, NULL, &amp;pResult);\n\nBSTR objString = NULL;\nhr = pInpInstOfSnapshotSettingData-&gt;GetObjectText(0, &amp;objString);\nBSTR ArgNameTwo = SysAllocString(L\"SnapshotSettings\");\nVARIANT v;\nV_VT(&amp;v) = VT_BSTR;\nV_BSTR(&amp;v) = objString; \n\nhr = pInParams-&gt;Put(ArgNameTwo, 0, &amp;v, 0);\n\nVARIANT vtProp;\nm_pVmWbemClassObject-&gt;Get(L\"__Path\", 0, &amp;vtProp, 0, 0);\n\nwprintf(L\"Affected System : : %ls\", (LPWSTR)vtProp.bstrVal);\nHRESULT hres = pInParams-&gt;Put(L\"AffectedSystem\", 0 , &amp;vtProp, NULL);\n\nVARIANT var;\nVariantInit(&amp;var);\nV_VT(&amp;var) = VT_BSTR;\nV_BSTR(&amp;var) = SysAllocString(L\"2\");\n\n\nCHK_HRES(pInParams-&gt;Put(L\"SnapshotType\", 0, &amp;var, 0));\n\n\nIEnumWbemClassObject* pEnumOb = NULL;\nhr = m_pWbemServices-&gt;ExecQuery(\nBSTR(L\"WQL\"),\nBSTR(L\"select * from Msvm_VirtualSystemSnapshotService\"),\nWBEM_FLAG_FORWARD_ONLY | WBEM_FLAG_RETURN_IMMEDIATELY,\nNULL,\n&amp;pEnumOb);\nIWbemClassObject *pclsObj1 = NULL;\nULONG uReturn1 = 0;\n\nwhile (1)\n{\n    HRESULT hr = pEnumOb-&gt;Next(WBEM_INFINITE, 1, &amp;pclsObj1, &amp;uReturn1);\n\n    if (0 == uReturn1)\n    {\n        break;\n    }\n\n    IWbemCallResult *pCallResult = NULL;\n    IWbemClassObject *pResObj = NULL;\n\n    CComBSTR path(this-&gt;GetStrProperty(L\"__PATH\", pclsObj1));\n\n    hr = m_pWbemServices-&gt;ExecMethod(path, L\"CreateSnapshot\", 0, NULL, pInParams, &amp;pOutParameters, &amp;pCallResult);\n\n\n\n    /* cout &lt;&lt; \"check1 : \" &lt;&lt; hex &lt;&lt; hr &lt;&lt; endl;\n    hr = pCallResult-&gt;GetResultObject(0, &amp;pResObj);\n    cout &lt;&lt; \"check2\" &lt;&lt; endl;*/\n\n    this-&gt;WaitForJobCompletion(pOutParameters);\n   }\n\ncout &lt;&lt; \"\\nSnpshot Complete\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p><strong>EDIT</strong>\nI found that the SnapshotType Parameter is not set correctly it should be 32768 and I have used the following way to convert uint16 to Variant but no Success and I get <code>0x80070057 Incorrect Parameter</code> Error. </p>\n\n<pre><code>VARIANT var;\nVariantInit(&amp;var);\nV_VT(&amp;var) = VT_BSTR;\nV_BSTR(&amp;var) = SysAllocString(L\"32768\");\n\nhr = pInParams-&gt;Put(L\"SnapshotType\", 0, &amp;var, CIM_UINT16);\n</code></pre>\n"}, {"tags": ["c++", "c++11", "language-lawyer"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1523452713, "post_id": 49775980, "comment_id": 86567419, "body": "All members have the same address, active or not... and even if that address is typed such that it belongs to an inactive member, I can&#39;t see why it would be a problem so long as that address were not dereferenced, for reasons given at my suggested dupe around <code>[basic.life]</code>. And in case anyone is worried about <code>std::addressof()</code> specifically, it&#39;s just a bunch of cast acrobatics and doesn&#39;t dereference or otherwise read the object."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523452826, "post_id": 49775980, "comment_id": 86567491, "body": "<code>[class.union]</code> states <i>Each non-static data member is allocated as if it were the sole member of astruct. All non-static data members of a union object have the same address.</i> but I&#39;m not sure if that actually makes this okay."}, {"owner": {"reputation": 3377, "user_id": 2013747, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/666a95f5725d92e6bf6ccc0c2c60db59?s=128&d=identicon&r=PG", "display_name": "Ross Bencina", "link": "https://stackoverflow.com/users/2013747/ross-bencina"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1523452941, "post_id": 49775980, "comment_id": 86567578, "body": "@underscore_d I agree <a href=\"https://stackoverflow.com/questions/48188737/is-pointer-arithmetic-on-inactive-member-of-a-union-ub\" title=\"is pointer arithmetic on inactive member of a union ub\">stackoverflow.com/questions/48188737/&hellip;</a> might be a partial answer, if the answer there was asserted with confidence, which it isn&#39;t. Note that in this question I&#39;m navigating the union member contents with <code>.</code>"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1523452998, "post_id": 49775980, "comment_id": 86567625, "body": "@RossBencina but only to get the address of its member, which also isn&#39;t alive, but is subject to the same limited allowances for things like taking the address as the union itself is."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 2, "creation_date": 1523454132, "post_id": 49775980, "comment_id": 86568494, "body": "The thing that worries me is that the code appears to presume the member is aligned in multiples of its own size. This may be true for primitive types in general, but I can imagine lots of cases where T1 is a struct that this rule could easily be broken."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1523455190, "post_id": 49775980, "comment_id": 86569321, "body": "I can see that the union is being used here to avoid the object from being constructed, and that is &quot;clever&quot;, I guess, though it wastes/reserves static space for a whole U, but for the rest I think I prefer the traditional subtraction using size_t or char* cast: <code>return (size_t)(addressof(instT2.*memberT1)) - (size_t)(addressof(instT2));</code>"}, {"owner": {"reputation": 3377, "user_id": 2013747, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/666a95f5725d92e6bf6ccc0c2c60db59?s=128&d=identicon&r=PG", "display_name": "Ross Bencina", "link": "https://stackoverflow.com/users/2013747/ross-bencina"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1523457736, "post_id": 49775980, "comment_id": 86571236, "body": "@GemTaylor: the original goal was to also make the expression constexpr by avoiding <code>reinterpret_cast</code> (your <code>(size_t)</code> cast) however that failed without me realising it at the time. As far as wasting space, since U is not used I am assuming that it will be optimised away."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1523460966, "post_id": 49775980, "comment_id": 86573704, "body": "@RossBencina I don&#39;t think the space can be optimised away, as you have taken the address of it. Indeed without the declaration of this unique space, you couldn&#39;t definition-legally take the address of the offsetted member."}], "answers": [{"comments": [{"owner": {"reputation": 3377, "user_id": 2013747, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/666a95f5725d92e6bf6ccc0c2c60db59?s=128&d=identicon&r=PG", "display_name": "Ross Bencina", "link": "https://stackoverflow.com/users/2013747/ross-bencina"}, "edited": false, "score": 0, "creation_date": 1523453339, "post_id": 49776289, "comment_id": 86567912, "body": "Would you mind explicitly commenting on whether the way the results of <code>std::addressof</code> are used in the code example are well defined?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1523456100, "post_id": 49776289, "comment_id": 86569990, "body": "There&#39;s a subtle difference in that <code>std::addressof</code> binds a reference to that inactive member, and reference must be initialized to refer to an actual object. But I think there is special-casing for this as well."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1523472507, "post_id": 49776289, "comment_id": 86580138, "body": "@Quentin I didn&#39;t know, thank you."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1523472624, "post_id": 49776289, "comment_id": 86580207, "body": "sh*t I&#39;m the one who answered the duplicate and I have no memory of it."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1523474438, "post_id": 49776289, "comment_id": 86581112, "body": "Don&#39;t worry yet. One time I tried to downvote one of my own answers..."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": true, "score": 3, "last_activity_date": 1523472484, "last_edit_date": 1523472484, "creation_date": 1523452938, "answer_id": 49776289, "question_id": 49775980, "link": "https://stackoverflow.com/questions/49775980/is-it-well-defined-to-use-stdaddressof-on-non-active-union-members/49776289#49776289", "title": "Is it well-defined to use `std::addressof` on non-active union members", "body": "<pre><code>union U { int a; int b; };\nU u;\nu.a = 0; // (1)\nint* pub = &amp;u.b;\n</code></pre>\n\n<p>Yes, this is well defined, but there is restrictions on the way one can use <code>pub</code>. Note : taking the address of an object with the operator <code>&amp;</code> or with <code>std::addressof</code> is similar<sup>1</sup> unless a custom operator <code>&amp;</code> is defined for that object's type.</p>\n\n<blockquote>\n  <p><a href=\"http://eel.is/c%2B%2Bdraft/basic.life#6.sentence-1\" rel=\"nofollow noreferrer\" title=\"C++17 (draft)\"><code>[class.union]/1</code></a><br>\n  In a union, a non-static data member is active if its name refers to an object whose lifetime has begun and has not ended.</p>\n</blockquote>\n\n<p>So on line marked <code>(1)</code>, the lifetime of <code>u.b</code> has not started yet, but the storage that object will occupy has been allocated. Following :</p>\n\n<blockquote>\n  <p><a href=\"http://eel.is/c%2B%2Bdraft/basic.life#6.sentence-1\" rel=\"nofollow noreferrer\" title=\"C++17 (draft)\"><code>[basic.life]/6</code></a><br>\n  Before the lifetime of an object has started but after the storage which the object will occupy has been allocated or, after the lifetime of an object has ended and before the storage which the object occupied is reused or released, any pointer that represents the address of the storage location where the object will be or was located may be used but only in limited ways.</p>\n</blockquote>\n\n<hr>\n\n<p><sup>1)</sup> Except it would, as user Quentin noted, bind a reference to <code>u.b</code>, but it's also OK as per <a href=\"http://eel.is/c%2B%2Bdraft/basic.life#7.sentence-1\" rel=\"nofollow noreferrer\" title=\"C++17 (draft)\"><code>[basic.life]/7</code></a>:</p>\n\n<blockquote>\n  <p>Similarly, before the lifetime of an object has started but after the storage which the object will occupy has been allocated or, after the lifetime of an object has ended and before the storage which the object occupied is reused or released, any glvalue that refers to the original object may be used but only in limited ways. For an object under construction or destruction, see <code>[class.cdtor]</code>. Otherwise, such a glvalue refers to allocated storage ([basic.stc.dynamic.allocation]), and using the properties of the glvalue that do not depend on its value is well-defined.</p>\n</blockquote>\n"}], "owner": {"reputation": 3377, "user_id": 2013747, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/666a95f5725d92e6bf6ccc0c2c60db59?s=128&d=identicon&r=PG", "display_name": "Ross Bencina", "link": "https://stackoverflow.com/users/2013747/ross-bencina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "closed_date": 1523460819, "accepted_answer_id": 49776289, "answer_count": 1, "score": 3, "last_activity_date": 1523472484, "creation_date": 1523452108, "question_id": 49775980, "link": "https://stackoverflow.com/questions/49775980/is-it-well-defined-to-use-stdaddressof-on-non-active-union-members", "closed_reason": "Duplicate", "title": "Is it well-defined to use `std::addressof` on non-active union members", "body": "<p>The code below is an attempt at implementing a <code>constexpr</code> version of <code>offsetof</code> in C++11. It compiles in both gcc 7.2.0 and clang 5.0.0.</p>\n\n<p>It depends on applying <code>std::addressof</code> to members of non-active members of a union.</p>\n\n<p>Is this well-defined C++11? If not, please explain why, including quotes or citations to relevant sections of the standard.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdint&gt;\n#include &lt;memory&gt;\n\n// based on the gist at: https://gist.github.com/graphitemaster/494f21190bb2c63c5516\n// original version by graphitemaster\n\ntemplate &lt;typename T1, typename T2&gt;\nstruct offset_of_impl {\n    union U {\n        char c;\n        T1 m; // instance of type of member\n        T2 object;\n        constexpr U() : c(0) {} // make c the active member\n    };\n    static constexpr U u = {};\n\n    static constexpr std::ptrdiff_t offset(T1 T2::*member) {\n        // The following avoids use of reinterpret_cast, so is constexpr.\n        // The subtraction gives the correct offset because the union layout rules guarantee that all\n        // union members have the same starting address.\n        // On the other hand, it will break if object.*member is not aligned.\n        // Possible problem: it uses std::addressof on non-active union members.\n        // Please let us know at the gist if this is defined or undefined behavior.\n        return (std::addressof(offset_of_impl&lt;T1, T2&gt;::u.object.*member) - \n            std::addressof(offset_of_impl&lt;T1, T2&gt;::u.m)) * sizeof(T1);\n    }\n};\n\ntemplate &lt;typename T1, typename T2&gt;\nconstexpr typename offset_of_impl&lt;T1, T2&gt;::U offset_of_impl&lt;T1, T2&gt;::u;\n\ntemplate &lt;typename T1, typename T2&gt;\ninline constexpr std::ptrdiff_t offset_of(T1 T2::*member) {\n    return offset_of_impl&lt;T1, T2&gt;::offset(member);\n}\n\nstruct S {\n    S(int a_, int b_, int c_) : a(a_), b(b_), c(c_) {}\n    S() = delete;\n    int a;\n    int b;\n    int c;\n};\n\nint main()\n{\n    std::cout &lt;&lt; offset_of(&amp;S::b);   \n}\n</code></pre>\n\n<p>For reference, here is a sandbox version to play with: <a href=\"https://wandbox.org/permlink/rKQXopsltQ51VtEm\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/rKQXopsltQ51VtEm</a></p>\n\n<p>And here is the original version by graphitemaster:\n<a href=\"https://gist.github.com/graphitemaster/494f21190bb2c63c5516\" rel=\"nofollow noreferrer\">https://gist.github.com/graphitemaster/494f21190bb2c63c5516</a></p>\n"}, {"tags": ["c#", "c++", "arrays", "c++-cli", "marshalling"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1523454933, "post_id": 49775903, "comment_id": 86569130, "body": "Delete the C# declaration of the struct, it should use the declaration provided by the C++/CLI assembly.  Change it to public value struct {} to make it a struct instead of class type.  How the caller, passing an array, should call a C++ function that can only modify a single element of the array is not otherwise obvious."}, {"owner": {"reputation": 411, "user_id": 6688377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d53bfc643286b2bdd0ed2219ce7925c?s=128&d=identicon&r=PG&f=1", "display_name": "codebender", "link": "https://stackoverflow.com/users/6688377/codebender"}, "edited": false, "score": 0, "creation_date": 1523541449, "post_id": 49775903, "comment_id": 86611558, "body": "Since you&#39;re writing both sides of the code, you can pass .net types and let the C++/CLI handle the conversion of String^ to LPWStr, if that is needed to communicate with some lower level API."}], "owner": {"reputation": 15, "user_id": 9094892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0590f7ed9bce6a9ef7ddeead03e03e7c?s=128&d=identicon&r=PG&f=1", "display_name": "sfandres", "link": "https://stackoverflow.com/users/9094892/sfandres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1523451836, "creation_date": 1523451836, "question_id": 49775903, "link": "https://stackoverflow.com/questions/49775903/passing-array-of-struct-from-c-to-c-using-c-cli-wrapper", "title": "Passing array of struct from C# to C++ using C++/CLI wrapper", "body": "<p>I am working in a project where we need to optimize a C# code, so I am translating the code to C++ and to do so, I am using a C++/CLI wrapper which works as a bridge between managed C# and unmanaged C++. I am trying to communicate both but it doesn't work since I am quite new with this topic. I have been looking and searching a lot but remains the same.</p>\n\n<p>I wanted to have the same array of structs that I have in C# in the native C++, this is the main goal to achive.</p>\n\n<p>My C# code \"ConsoleApp1\" is the following: </p>\n\n<pre><code>namespace ConsoleApp1\n{\n    class Program\n    {\n        // Struct definition\n        [StructLayout(LayoutKind.Sequential, Pack = 1)]\n        public struct MyStruct\n        {\n            [MarshalAs(UnmanagedType.LPWStr)]\n            public int a;\n\n            [MarshalAs(UnmanagedType.LPWStr)]\n            public int b;\n\n            public MyStruct(int a, int b)\n            {\n                this.a = a;\n                this.b = b;\n            }\n        };\n\n        static void Main(string[] args)\n        {\n            UnmanagedWrap.Class1 test = new UnmanagedWrap.Class1();\n\n            // Instantiating struct and initializing\n            MyStruct str1 = new MyStruct(4, 5);\n            MyStruct str2 = new MyStruct(6, 7);\n\n            // Array of structs\n            MyStruct[] MyArray = new MyStruct[] { str1, str2 };\n\n            // Calling C++/CLI method passing the struct\n            test.Foo(MyArray, MyArray.GetLength);\n\n            Console.ReadKey();\n        }\n    }\n}\n</code></pre>\n\n<p>Then my C++/CLI wrapper called UnmanagedWrap:</p>\n\n<pre><code>namespace UnmanagedWrap {\n\n    public ref class Class1\n    {\n    public:\n\n        // pointer to the Unmanaged class\n        Unmanaged * pu;  \n\n        // the constructor will allocate the pointer pu\n        Class1() : pu(new Unmanaged()) {};      \n\n        void Foo(array&lt;MyStruct^&gt;^ configObject, int ArrayLength) {\n\n            // Allocates memory from the unmanaged memory of the process by using the specified number of bytes.\n            // Between brackets is the required number of bytes in memory.\n            IntPtr ptr = Marshal::AllocHGlobal(Marshal::SizeOf(configObject));\n\n            // Marshals data from a managed object to an unmanaged block of memory. \n            // ptr is a pointer to an unmanaged block of memory, which must be allocated before this method is called.\n            Marshal::StructureToPtr(configObject, ptr, false);\n\n            pu-&gt;Foo(ptr);\n        };\n    };\n\n    public ref struct MyStruct {\n        int a;\n        int b;\n    };\n}\n</code></pre>\n\n<p>And my unmanaged C++ Unmanaged.h:</p>\n\n<pre><code>#pragma once\nclass Unmanaged\n{\npublic:\n\n    struct MyUnmanagedStruct {\n        int var1, var2;\n    };\n\n    void Foo(MyUnmanagedStruct* d);\n};\n</code></pre>\n\n<p>And Unmanaged.cpp:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"Unmanaged.h\"\n\nvoid Unmanaged::Foo(MyUnmanagedStruct* ustr) {\n    int x = ustr-&gt;var1;\n    int y = ustr-&gt;var1;\n}\n</code></pre>\n\n<p>This procedure doesn't work because of type mismatch in the calling function from C++/CLI to C++, but I don't know how to do it the right way even though I looked for it a lot.</p>\n"}, {"tags": ["c++", "sockets", "posix"], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1523453351, "post_id": 49776408, "comment_id": 86567921, "body": "thats what i was hoping for. Only the &quot;...it shall return with a partial count..&quot; confused me a bit and I still dont really understand what it means"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1523453756, "post_id": 49776408, "comment_id": 86568207, "body": "hm, also with udp? then I will have to wrap the call, because in case of timeout I want to make the thread do something else (only for a tiny amount of time), but in case there is a packet waiting to be completely received then i need that packet before doing the something else. Anyhow thanks a lot for the answer"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1523522953, "post_id": 49776408, "comment_id": 86598546, "body": "@UKMonkey: Nope. You need the whole packet to verify the UDP checksum."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1523525945, "post_id": 49776408, "comment_id": 86600561, "body": "@MSalters that said; the underlying mechanism could decide to send your data as 2 packets rather than one ... I think ..."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1523546569, "post_id": 49776408, "comment_id": 86615391, "body": "@user463035818 <i>...it shall return with a partial count..</i> is followed by <i>or errno set to [EAGAIN] or [EWOULDBLOCK] if no data is received</i>. If data is received then the call behave as usual, and if no data received during the delay call is terminated in timeout. You can&#39;t have <b>timeout and data</b>."}, {"owner": {"reputation": 823, "user_id": 2833055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc22fb885e60a88afd512817e3d985cd?s=128&d=identicon&r=PG&f=1", "display_name": "JoGusto", "link": "https://stackoverflow.com/users/2833055/jogusto"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1562616867, "post_id": 49776408, "comment_id": 100423964, "body": "@MSalters -- TCP send/recv can send your data as any number of packets, and when you call recv, the amount you receive can be different from the original send() call size. Usually it&#39;s 1:1, but it&#39;s not guaranteed; you must always be ready to read more data if you get less than you are expecting."}, {"owner": {"reputation": 823, "user_id": 2833055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc22fb885e60a88afd512817e3d985cd?s=128&d=identicon&r=PG&f=1", "display_name": "JoGusto", "link": "https://stackoverflow.com/users/2833055/jogusto"}, "edited": false, "score": 1, "creation_date": 1562617118, "post_id": 49776408, "comment_id": 100424039, "body": "regarding &quot;...it shall return  partial count...&quot; is relevant for SOCK_STREAM types (eg: TCP). For SOCK_DGRAM types (eg UDP) you will either receive all the data in the sent UDP message, or no data. There won&#39;t be a partial count. The count you get is the size the sender sent. Since the SO_RCVTIMEO parameter can be set for either type of socket, the description covers both circumstances."}], "tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": true, "score": 3, "last_activity_date": 1523453240, "creation_date": 1523453240, "answer_id": 49776408, "question_id": 49775673, "link": "https://stackoverflow.com/questions/49775673/can-setting-a-timeout-for-posix-recv-cause-lost-udp-packets/49776408#49776408", "title": "Can setting a timeout for posix recv cause lost udp packets?", "body": "<p>No; it doesn't make you more likely to drop packets.</p>\n\n<p>Looking at how network transport happens at a lower level; you have a network card.  As this card receives data, irrespective of what your program is doing, it stores the data into it's own memory area.  When you call recv; you're asking the OS to move data from the network cards memory to your programs memory.  This means that if a packet comes in while your thread is doing something else; it isn't just dropped, but processed the next time your thread comes to get data.</p>\n\n<p>If your thread doesn't call recv often enough; then the memory for the network card will become full.  When this happens no new packets can be stored; and if it's using TCP then the router will be told that it's not able to process it; if it's UDP then it will simply be dropped.  It is this part that makes UDP inherently unreliable as it can happen at any point during the transport of the packet.</p>\n\n<p>The timeout impacts how long the thread will wait for data to appear in the networkcard memory area; and unless you never call recv again; does not impact dropped packets or not.</p>\n"}, {"tags": [], "owner": {"reputation": 236, "user_id": 3307882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7149ae7c36191c49f2ec868cb0c667a4?s=128&d=identicon&r=PG", "display_name": "FrancoVS", "link": "https://stackoverflow.com/users/3307882/francovs"}, "is_accepted": false, "score": 0, "last_activity_date": 1614867549, "last_edit_date": 1614867549, "creation_date": 1614131195, "answer_id": 66343532, "question_id": 49775673, "link": "https://stackoverflow.com/questions/49775673/can-setting-a-timeout-for-posix-recv-cause-lost-udp-packets/66343532#66343532", "title": "Can setting a timeout for posix recv cause lost udp packets?", "body": "<p>The answer is no, losing UDP data would be in violation of <a href=\"http://%20https://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow noreferrer\">POSIX</a>:</p>\n<blockquote>\n<p>The recv() function shall return the length of the message written to the buffer pointed to by the buffer argument. <strong>For message-based sockets, such as SOCK_DGRAM and SOCK_SEQPACKET, the entire message shall be read in a single operation</strong>.</p>\n</blockquote>\n<p>Presumably, the &quot;partial count&quot; only happens is a connection-based socket when the <code>MSG_WAITALL</code> option is used.</p>\n<p>That being said, the use of <code>SO_RECVTIMEO</code> is generally frowned upon, and the &quot;proper&quot; way to implement timeouts on sockets is by using nonblocking sockets and <code>select()</code>. This is for historical reasons, and not because setting a timeout is somehow inherently bad design or something. If you insist on using <code>SO_RECVTIMEO</code>, be aware of potential portability problems:</p>\n<ul>\n<li>POSIX mentions <code>SO_RECVTIMEO</code>, but <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow noreferrer\">does not require it</a></li>\n<li>On Windows, a timeout in rcv() will <a href=\"https://docs.microsoft.com/windows/win32/api/winsock/nf-winsock-recv\" rel=\"nofollow noreferrer\">put the socket in a bad state</a> and you should close it immediately afterwards. On POSIX you can (in my experience) still use the socket after a timeout caused by <code>SO_RECVTIMEO</code>, but one could argue this is not 100% guaranteed by the spec</li>\n</ul>\n"}], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 49776408, "answer_count": 2, "score": 0, "last_activity_date": 1614867549, "creation_date": 1523451093, "last_edit_date": 1523451847, "question_id": 49775673, "link": "https://stackoverflow.com/questions/49775673/can-setting-a-timeout-for-posix-recv-cause-lost-udp-packets", "title": "Can setting a timeout for posix recv cause lost udp packets?", "body": "<p>I found <a href=\"https://stackoverflow.com/a/2939145/4117728\">this answer</a> on how to set a timeout for posix socket. The linux part of that answer:</p>\n\n<pre><code>// LINUX\nstruct timeval tv;\ntv.tv_sec = timeout_in_seconds;\ntv.tv_usec = 0;\nsetsockopt(sockfd, SOL_SOCKET, SO_RCVTIMEO, (const char*)&amp;tv, sizeof tv);\n</code></pre>\n\n<p>and the quote from the posix documentation:</p>\n\n<blockquote>\n<pre><code>SO_RCVTIMEO\n</code></pre>\n  \n  <p>Sets the timeout value that specifies the maximum amount of time an input function waits until it completes. It accepts a timeval\n  structure with the number of seconds and microseconds specifying the\n  limit on how long to wait for an input operation to complete. If a\n  receive operation has blocked for this much time without receiving\n  additional data, it shall return with a partial count or errno set to\n  [EAGAIN] or [EWOULDBLOCK] if no data is received. The default for this\n  option is zero, which indicates that a receive operation shall not\n  time out. This option takes a timeval structure. Note that not all\n  implementations allow this option to be set.</p>\n</blockquote>\n\n<p>What I dont understand is: Can this cause loosing udp packages?\nWhat if the timeout is reached while a udp package is received?</p>\n\n<p>Also related: <a href=\"https://stackoverflow.com/questions/16163260/setting-timeout-for-recv-fcn-of-a-udp-socket\">setting timeout for recv fcn of a UDP socket</a></p>\n\n<p>PS: I am aware that UDP is inherently unreliable, so my question is really mainly about the case where the timeout occurs while an udp message is processed. </p>\n"}, {"tags": ["c++", "namespaces", "argument-dependent-lookup"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1523451129, "post_id": 49775595, "comment_id": 86566197, "body": "<a href=\"https://godbolt.org/g/rQY14p\" rel=\"nofollow noreferrer\">No idea what you&#39;re talking about</a>"}, {"owner": {"reputation": 51, "user_id": 5415300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699ae0e5d4770e1d8ba6c732f5033b0f?s=128&d=identicon&r=PG", "display_name": "Braynstorm", "link": "https://stackoverflow.com/users/5415300/braynstorm"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1523451370, "post_id": 49775595, "comment_id": 86566388, "body": "@StoryTeller Yeah, though I didn&#39;t find it because I didn&#39;t know it was called that way. Definitely a duplicate."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1523451520, "post_id": 49775595, "comment_id": 86566497, "body": "BTW <code>Categories::f(Categories::T::A);</code> can just be <code>f(Categories::T::A);</code> as well"}], "owner": {"reputation": 51, "user_id": 5415300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699ae0e5d4770e1d8ba6c732f5033b0f?s=128&d=identicon&r=PG", "display_name": "Braynstorm", "link": "https://stackoverflow.com/users/5415300/braynstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1523451447, "answer_count": 0, "score": 1, "last_activity_date": 1523451496, "creation_date": 1523450906, "last_edit_date": 1523451496, "question_id": 49775595, "link": "https://stackoverflow.com/questions/49775595/redundant-namespace-qualifier-on-the-call", "closed_reason": "Duplicate", "title": "Redundant namespace qualifier on the call", "body": "<p>Why is <strong>Categories</strong><code>::ff(Categories::a)</code> redundant?</p>\n\n<pre><code>namespace Outter{\n    namespace Categories{\n        struct V {};\n        V a;\n        enum class T { A, B };\n        void f(T a);\n        void ff(V a);\n    }\n\n    void f() {\n        auto vec = vector&lt;float&gt;{};\n        Categories::f(Categories::T::A); // Nothing redundant.\n        Categories::ff(Categories::a);   // Redundant Categories quantifier\n                                         // on the call itself.\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "clion"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1523451055, "post_id": 49775560, "comment_id": 86566129, "body": "this is probably more a cmake/mingw question than a clion one."}], "answers": [{"tags": [], "owner": {"reputation": 337, "user_id": 9630578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQv1H54M-A0/AAAAAAAAAAI/AAAAAAAAAGM/LRzWl5qj-g0/photo.jpg?sz=128", "display_name": "super sahar", "link": "https://stackoverflow.com/users/9630578/super-sahar"}, "is_accepted": true, "score": 11, "last_activity_date": 1523458303, "creation_date": 1523458303, "answer_id": 49778282, "question_id": 49775560, "link": "https://stackoverflow.com/questions/49775560/how-to-create-standalone-exe-in-clion/49778282#49778282", "title": "How to create standalone exe in clion?", "body": "<p>I did it.\nTo do this you need to add to the file <code>CMakeLists.txt</code> this line:</p>\n\n<blockquote>\n  <p>set (CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -static-libstdc++ -static-libgcc\")</p>\n</blockquote>\n\n<p>After this <code>CMakeLists.txt</code> shoud look like this:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.9)\nproject(MyProject)\n\nset(CMAKE_CXX_STANDARD 11)\nset (CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -static-libstdc++ -static-libgcc\")\n\nset(SOURCE_FILES main.cpp)\nadd_executable(MyProject${SOURCE_FILES})\n</code></pre>\n\n<p>Reload changes in <code>CMakeLists.txt</code></p>\n\n<p>Run -> Clean</p>\n\n<p>Run -> Build</p>\n\n<p>Now <code>.exe</code> file is standalone</p>\n"}], "owner": {"reputation": 337, "user_id": 9630578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQv1H54M-A0/AAAAAAAAAAI/AAAAAAAAAGM/LRzWl5qj-g0/photo.jpg?sz=128", "display_name": "super sahar", "link": "https://stackoverflow.com/users/9630578/super-sahar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7847, "favorite_count": 1, "closed_date": 1523493550, "accepted_answer_id": 49778282, "answer_count": 1, "score": 5, "last_activity_date": 1523458303, "creation_date": 1523450792, "last_edit_date": 1523450982, "question_id": 49775560, "link": "https://stackoverflow.com/questions/49775560/how-to-create-standalone-exe-in-clion", "closed_reason": "Not suitable for this site", "title": "How to create standalone exe in clion?", "body": "<p>When I try to run <code>.exe</code> from <code>cmake-build-debug</code> I have an error:  </p>\n\n<blockquote>\n  <p>\"libgcc_s_dw2-1.dll not found\".</p>\n</blockquote>\n\n<p>How to build standalone <code>.exe</code> without any <code>dlls</code>. I use <code>CLion 2017.2.4, MinGW 5.0, cmake 3.9.4</code></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1523450906, "post_id": 49775559, "comment_id": 86566001, "body": "<code>constexpr</code> might help."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1523450910, "post_id": 49775559, "comment_id": 86566006, "body": "This isn&#39;t anywhere close to legal C++ - where is your actual attempt?"}, {"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "edited": false, "score": 0, "creation_date": 1523450918, "post_id": 49775559, "comment_id": 86566014, "body": "by using const<code>const</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1523450925, "post_id": 49775559, "comment_id": 86566021, "body": "Sounds like you could use a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>.  That will teach you what the C++ syntax is, which is not the same as Java"}, {"owner": {"reputation": 5, "user_id": 3618747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de3806a56510c23882a97426db19e490?s=128&d=identicon&r=PG&f=1", "display_name": "user3618747", "link": "https://stackoverflow.com/users/3618747/user3618747"}, "edited": false, "score": 0, "creation_date": 1523451101, "post_id": 49775559, "comment_id": 86566166, "body": "Sorry, could have been clearer, this is Java I wrote to try and illustrate what I would like to do in C++."}, {"owner": {"reputation": 5, "user_id": 3618747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de3806a56510c23882a97426db19e490?s=128&d=identicon&r=PG&f=1", "display_name": "user3618747", "link": "https://stackoverflow.com/users/3618747/user3618747"}, "edited": false, "score": 0, "creation_date": 1523451168, "post_id": 49775559, "comment_id": 86566232, "body": "I&#39;m happy to learn syntax from a textbook, but I&#39;m more asking if this is something that is really done at all in C++. I imagine as a OOP language that there is something similar, but I would appreciate a point in the right direction."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 2, "creation_date": 1523451190, "post_id": 49775559, "comment_id": 86566240, "body": "&quot;Or am I trying to solve the problem in the wrong way?&quot; That&#39;s the one.  They don&#39;t belong in a separate class but either the same one or the same namespace;  even java doesn&#39;t usually create a separate class from what I remember it as static final color instances would be in the color class"}, {"owner": {"reputation": 538, "user_id": 9564168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arkady Godlin", "link": "https://stackoverflow.com/users/9564168/arkady-godlin"}, "edited": false, "score": 0, "creation_date": 1523451402, "post_id": 49775559, "comment_id": 86566417, "body": "read about this regarding static members  <a href=\"https://stackoverflow.com/questions/185844/how-to-initialize-private-static-members-in-c\" title=\"how to initialize private static members in c\">stackoverflow.com/questions/185844/&hellip;</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1523451703, "post_id": 49775559, "comment_id": 86566621, "body": "in c++ you dont use <code>new</code> everywhere all the time but rather very sparingly only when really needed"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1523452103, "post_id": 49775559, "comment_id": 86566940, "body": "There is no equivalent as there can&#39;t be one. Making parallels between the two completely different languages is counter productive."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1523452129, "post_id": 49775559, "comment_id": 86566970, "body": "C++ is turing complete like Java or Assembly. So asking if something which can be done in Java can be done in C++ is pointless. Learning the language will teach you how you <b>can</b> solve a problem. Practicing the language will teach you how you <b>should</b> solve it (i.e. best practice)."}], "answers": [{"comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1523451791, "post_id": 49775776, "comment_id": 86566687, "body": "There is no question to begin with. I suspect that is why you are receiving the downvotes."}, {"owner": {"reputation": 2162, "user_id": 2534472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d8dce53c214aa63495ff868b09a1a4?s=128&d=identicon&r=PG", "display_name": "UniversE", "link": "https://stackoverflow.com/users/2534472/universe"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1523453386, "post_id": 49775776, "comment_id": 86567936, "body": "I am receiving downvotes, because I am one of the few, who read the question carefully enough. He said: &quot;but I get linker errors as colors <b>is reinstantiated in every file I include it in</b>.&quot; And that is to what I responded."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1523453524, "post_id": 49775776, "comment_id": 86568045, "body": "Could indeed be the case."}], "tags": [], "owner": {"reputation": 2162, "user_id": 2534472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d8dce53c214aa63495ff868b09a1a4?s=128&d=identicon&r=PG", "display_name": "UniversE", "link": "https://stackoverflow.com/users/2534472/universe"}, "is_accepted": false, "score": -2, "last_activity_date": 1523451400, "creation_date": 1523451400, "answer_id": 49775776, "question_id": 49775559, "link": "https://stackoverflow.com/questions/49775559/equivalent-in-c-of-java-static-class-of-objects/49775776#49775776", "title": "Equivalent in C++ of Java static class of objects", "body": "<p>In C++ an include is an actual include. That means, in contrast to Java imports, the code is actually <em>copied</em>.</p>\n\n<p>When you now include your file multiple times, you have multiple occurrences of your code. That is why you need to protect your header code from being copied twice.</p>\n\n<p>Solution 1: Write the following as the first line of your header file:</p>\n\n<pre><code>#pragma once\n</code></pre>\n\n<p>Solution 2 (more portable and widely recommended):</p>\n\n<pre><code>#ifndef MYHEADERFILENAME_H\n#define MYHEADERFILENAME_H\n// your header code goes here\n#endif /* MYHEADERFILENAME_H */\n</code></pre>\n\n<p>Some more thoughts about your problem:</p>\n\n<ol>\n<li><p>Do not use a class for encapsulating constexpr values. This is not necessary in C++. In Java there cannot be something outside a class, but in C++ this is perfectly legal. Just declare your symbol and define it in your source file <em>outside</em> a class. You should declare it in your own namespace, though, to avoid name clashes.</p></li>\n<li><p>Maybe an enum class aka <a href=\"http://en.cppreference.com/w/cpp/language/enum\" rel=\"nofollow noreferrer\" title=\"scoped enumeration\">scoped enumeration</a> comes closer to what you really want.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1523452849, "post_id": 49775910, "comment_id": 86567509, "body": "Your solution seems way too complicated, there is no problem with having constant objects instead of static functions: <a href=\"https://ideone.com/prJYrk\" rel=\"nofollow noreferrer\">ideone.com/prJYrk</a>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1523453039, "post_id": 49775910, "comment_id": 86567658, "body": "@UnholySheep If you are ok with putting things in an extra namespace, that works too."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1523453098, "post_id": 49775910, "comment_id": 86567704, "body": "using namespaces is a good practice, though my example would also work without it: <a href=\"https://ideone.com/J1twYz\" rel=\"nofollow noreferrer\">ideone.com/J1twYz</a>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1523453303, "post_id": 49775910, "comment_id": 86567879, "body": "I meant &quot;in the namespace instead of the/a class&quot;. Can you do the same as part of a class? If I had different color representations and a template like <code>template&lt;class TColor&gt; TColor bar() { return TColor::WHITE; }</code> in some shape or form, the namespace solution won&#39;t work. Example is trivial and beyond the scope of the question, I know, but I had exactly this kind of problem before."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 0, "last_activity_date": 1523452717, "last_edit_date": 1523452717, "creation_date": 1523451852, "answer_id": 49775910, "question_id": 49775559, "link": "https://stackoverflow.com/questions/49775559/equivalent-in-c-of-java-static-class-of-objects/49775910#49775910", "title": "Equivalent in C++ of Java static class of objects", "body": "<p>Assuming that your problem is actually the color thing you presented, this would probably be the easiest way to achieve it:</p>\n\n<pre><code>struct Color\n{\n    int r, g, b;\n\n    Color(int r, int g, int b)\n    {\n        this-&gt;r = r;\n        this-&gt;g = g;\n        this-&gt;b = b;\n    }\n\n    static Color WHITE() { return {255, 255, 255}; }\n    static Color BLACK() { return {0, 0, 0}; }\n};\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/DBrM1C\" rel=\"nofollow noreferrer\">https://godbolt.org/g/DBrM1C</a></p>\n\n<hr>\n\n<p>If you for some reason need to be able to reference the static objects (i.e. there should be exactly one static object instance for every named color), you could declare them in the header (<code>Colors.h</code>) and initialize them in the associated compilation unit (<code>Colors.cpp</code>), but that is somewhat cumbersome and also means your compile time constants cannot be inlined/constant folded etc. by the compiler (without link-time optimization at least). It does protect you from recompilations of files that include <code>Colors.h</code> if the constants change though.</p>\n\n<hr>\n\n<p>This method would be a (not much better) middle ground where there is still one static object instance per color but you can keep it to the header: <a href=\"https://godbolt.org/g/13krNc\" rel=\"nofollow noreferrer\">https://godbolt.org/g/13krNc</a></p>\n\n<p>Note however that, despite optimizations, the compiler cannot figure out that <code>bar()</code> should always return <code>255</code>. Instead, it has to check in every call whether the static constants were initialized already and, if not, initialize them (which requires a lock for thread safety!). </p>\n"}], "owner": {"reputation": 5, "user_id": 3618747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de3806a56510c23882a97426db19e490?s=128&d=identicon&r=PG&f=1", "display_name": "user3618747", "link": "https://stackoverflow.com/users/3618747/user3618747"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "closed_date": 1523452176, "accepted_answer_id": 49775910, "answer_count": 2, "score": 0, "last_activity_date": 1523452717, "creation_date": 1523450784, "last_edit_date": 1523451725, "question_id": 49775559, "link": "https://stackoverflow.com/questions/49775559/equivalent-in-c-of-java-static-class-of-objects", "closed_reason": "Not suitable for this site", "title": "Equivalent in C++ of Java static class of objects", "body": "<p>Coming from a Java background, I am used to the concept of making a class A, then creating class B to hold specific static instantiations of class A to use throughout the program. Some example Java code:</p>\n\n<pre><code>public class Color {\n    public int r;\n    public int g;\n    public int b;\n\n    public Color(int r, int g, int b) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\npublic class Colors {\n    public static final Color WHITE = new Color(255, 255, 255);\n    public static final Color BLACK = new Color(0, 0, 0);\n}\n</code></pre>\n\n<p>I have tried a <code>class Color</code>, with a <code>struct Colors</code> named <code>colors</code>, but I get linker errors as <code>colors</code> is reinstantiated in every file I include it in. What is the best way to do this in C++? Or am I trying to solve the problem in the wrong way?</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1523451450, "post_id": 49775353, "comment_id": 86566453, "body": "I did a similar thing with shaders while teaching my son some techniques.  Take a look in the <code>shaders</code> directory of this project. <a href=\"https://github.com/AlexAndDad/dungeon\" rel=\"nofollow noreferrer\">github.com/AlexAndDad/dungeon</a>"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1523451737, "post_id": 49775353, "comment_id": 86566649, "body": "Do you expect everyone is familar with this tool (&quot;embed-resource&quot;)? Looking into <a href=\"https://github.com/cyrilcode/embed-resource/blob/master/embedresource.cpp\" rel=\"nofollow noreferrer\">its code</a> I see simple <code>char sym_name[] = { bytes ... };</code> definition. Not sure how namespaces are related with it. And how CMake is related with all this problem? Yes, the tool uses CMake, but the problem isn&#39;t CMake-related, isn&#39;t it? Some code examples would definitely improve the question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1523463287, "post_id": 49775353, "comment_id": 86575263, "body": "That&#39;s apparently not a C, but pure C++ problem."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1523466085, "post_id": 49775353, "comment_id": 86576843, "body": "@Olaf: From my understanding, the question is about &quot;porting&quot; <code>C</code> approach to the <code>C++</code>. Or even having approach suitable for both <code>C</code> and <code>C++</code>. So removed <code>C</code> tag was meaningful in some extent."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1523466774, "post_id": 49775353, "comment_id": 86577172, "body": "@Tsyvarev:; It is definitively not. There are no custom name spaces in C not are the required symbol features like name-mangling supported by C. Just using C ABI functions does not justify adding the C tag. Feel free to provide proof I&#39;m wrong, provide the required information <b>in tthe question</b> and post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1523467316, "post_id": 49775353, "comment_id": 86577466, "body": "@Olaf: This is not my question, so I can only <i>guess</i>. OK, lets wait clarification from the author."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1523466912, "post_id": 49776399, "comment_id": 86577248, "body": "L&#214;et apart that unnecessarily using macros is even worse style in C++ than in C, it is not only about the symbols."}, {"owner": {"reputation": 529, "user_id": 1856821, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/38fbf32bc45d1ac7e4b7b4122280667a?s=128&d=identicon&r=PG", "display_name": "Dids", "link": "https://stackoverflow.com/users/1856821/dids"}, "edited": false, "score": 0, "creation_date": 1523517695, "post_id": 49776399, "comment_id": 86595479, "body": "While this makes perfect sense, it unfortunately doesn&#39;t work, presumably due to using a macro? Error: expected unqualified-id"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 2, "last_activity_date": 1523453201, "creation_date": 1523453201, "answer_id": 49776399, "question_id": 49775353, "link": "https://stackoverflow.com/questions/49775353/issues-embedding-resources-from-a-namespace-c-cmake/49776399#49776399", "title": "Issues embedding resources from a namespace (C++ &amp; CMake)", "body": "<p>That <code>extern \"C\"</code> in C headers included from C++ code is exactly for calling C functions/objects from C++ without namespace (or better: for calling function/objects not by using C++ mangled name, but using a C name).<br>\n<a href=\"https://github.com/cyrilcode/embed-resource/blob/master/embedresource.cpp\" rel=\"nofollow noreferrer\">This embded-rsource tool</a> is cool, just add <code>extern \"C\"</code> in <code>LOAD_RESOURCE</code> like this:</p>\n\n<pre><code> #define LOAD_RESOURCE(RESOURCE) ([]() {                      \\\n    extern \"C\" const char _resource_##RESOURCE[]; extern \"C\" const size_t _resource_##RESOURCE##_len;   \\\n    return Resource(_resource_##RESOURCE, _resource_##RESOURCE##_len);  \\\n})()\n</code></pre>\n\n<p>That way you instruct compiler, that <code>__resource##RESOURCE</code> is not a C++ symbol, but a C symbol compiled with a C compiler.</p>\n"}], "owner": {"reputation": 529, "user_id": 1856821, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/38fbf32bc45d1ac7e4b7b4122280667a?s=128&d=identicon&r=PG", "display_name": "Dids", "link": "https://stackoverflow.com/users/1856821/dids"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "closed_date": 1523486628, "answer_count": 1, "score": 2, "last_activity_date": 1523463266, "creation_date": 1523450173, "last_edit_date": 1523463266, "question_id": 49775353, "link": "https://stackoverflow.com/questions/49775353/issues-embedding-resources-from-a-namespace-c-cmake", "closed_reason": "Not suitable for this site", "title": "Issues embedding resources from a namespace (C++ &amp; CMake)", "body": "<p>I've been using a technique for embedding resources (raw binary data) into compiled executables, using a combination of C, C++ and CMake.</p>\n\n<p>The code/configuration I've used is very similar to what's available in <a href=\"https://github.com/cyrilcode/embed-resource\" rel=\"nofollow noreferrer\">this GitHub repository</a>, and I've even reproduced the issue with this particular sample.</p>\n\n<p>Used as is, the resource embedding works great, but as soon as C++ namespacing is introduced, things start breaking left and right.</p>\n\n<p>The issue seems to be that the C-style resources are by default using the global/anonymous namespace when called from within C++, but if they're called from a namespace inside C++, then that namespace gets prefixed to the resource, which results in undefined symbols.</p>\n\n<p>So far I've tried all I can think of, including converting the original C-style code to C++ and using namespaces with it, which yields the same results.</p>\n\n<p>More details on the specific calls/code can be seen in <a href=\"https://github.com/cyrilcode/embed-resource/issues/4\" rel=\"nofollow noreferrer\">this GitHub issue</a>.</p>\n\n<p>Ps. I realize that there's hardly any code/context in this post, but I figured it would make more sense to link to the original topics/articles that go through this, instead of trying to explain it myself. Also, if it helps, this topic has also been discussed <a href=\"https://beesbuzz.biz/blog/e/2014/07/31-embedding_binary_resources_with_cmake_and_c11.php\" rel=\"nofollow noreferrer\">here</a> and even on StackOverflow <a href=\"https://stackoverflow.com/questions/11813271/embed-resources-eg-shader-code-images-into-executable-library-with-cmake\">here</a>.</p>\n"}, {"tags": ["c++", "arrays", "for-loop"], "comments": [{"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "edited": false, "score": 0, "creation_date": 1523448968, "post_id": 49774847, "comment_id": 86564527, "body": "Can you rewrite your functions?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1523448987, "post_id": 49774847, "comment_id": 86564535, "body": "No, there is no way to do this automatically. But maybe your code needs to be refactored."}, {"owner": {"reputation": 4966, "user_id": 3605497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mV6Nc.jpg?s=128&g=1", "display_name": "Tripp Kinetics", "link": "https://stackoverflow.com/users/3605497/tripp-kinetics"}, "edited": false, "score": 0, "creation_date": 1523449014, "post_id": 49774847, "comment_id": 86564555, "body": "Three <code>for</code> loops?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1523449021, "post_id": 49774847, "comment_id": 86564562, "body": "Which syntax do you like ? something like <code>foo({&amp;fun1, &amp;fun2, &amp;fun3}, {A[0], A[1]});</code> ?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1523449158, "post_id": 49774847, "comment_id": 86564650, "body": "<code>for (auto f : {&amp;func1, &amp;func2, &amp;func3}) { for (auto&amp; a : {A[0], A[1]}) { f(a); } }</code> ?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1523449448, "post_id": 49774847, "comment_id": 86564896, "body": "Do the functions have the same signatures?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1523449730, "post_id": 49774847, "comment_id": 86565115, "body": "@Galik obviously fun1, fun2 and fun3 have the same signature, otherwise the first code snipped was not valid."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1523450064, "post_id": 49774847, "comment_id": 86565339, "body": "@MichaelWalz The first code snipped is just example code. So I wanted to know if the real code was strictly identical signatures. But even the example code could be mixing compatible parameter types"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1523450182, "post_id": 49774847, "comment_id": 86565436, "body": "@MichaelWalz implicit conversions could be happening."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1523450497, "post_id": 49774847, "comment_id": 86565675, "body": "@MichaelWalz signature could have default values that arent present in the snippet"}], "answers": [{"tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": false, "score": 5, "last_activity_date": 1523449139, "creation_date": 1523449139, "answer_id": 49774944, "question_id": 49774847, "link": "https://stackoverflow.com/questions/49774847/do-every-operation-twice/49774944#49774944", "title": "Do every operation twice", "body": "<p>You can use function pointers to loop through all the functions you want to call on each of the elements in your container. For example</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nvoid fun1(int i)\n{\n    std::cout &lt;&lt; \"fun1: \" &lt;&lt; i &lt;&lt; \"\\n\";\n}\n\nvoid fun2(int i)\n{\n    std::cout &lt;&lt; \"fun2: \" &lt;&lt; i &lt;&lt; \"\\n\";\n}\n\nint main()\n{\n    using fn_t = void(*)(int);\n    std::vector&lt;fn_t&gt; funs{&amp;fun1, &amp;fun2};\n    std::vector&lt;int&gt; A = {2, 5};\n\n    for (auto&amp; f : funs)\n    {\n        for (int i : A)\n        {\n            f(i);\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"http://cpp.sh/7cdan\" rel=\"noreferrer\">Output</a></p>\n\n<pre><code>fun1: 2\nfun1: 5\nfun2: 2\nfun2: 5\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1523450042, "post_id": 49775272, "comment_id": 86565328, "body": "<code>std::vector</code> predates C++11 (assuming that&#39;s what you meant by &quot;C++0x&quot;) by a lot"}, {"owner": {"reputation": 46, "user_id": 9630216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L7YXP.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/9630216/neo"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1523450341, "post_id": 49775272, "comment_id": 86565556, "body": "I wanted to say a C version (ignoring <code>std</code> obviously). I have just edited it, thanks!"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 3, "creation_date": 1523450840, "post_id": 49775272, "comment_id": 86565945, "body": "If the OP deliberately tagged C++ what is the purpose of providing a C solution?"}], "tags": [], "owner": {"reputation": 46, "user_id": 9630216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L7YXP.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/9630216/neo"}, "is_accepted": true, "score": 3, "last_activity_date": 1523450251, "last_edit_date": 1523450251, "creation_date": 1523449983, "answer_id": 49775272, "question_id": 49774847, "link": "https://stackoverflow.com/questions/49774847/do-every-operation-twice/49775272#49775272", "title": "Do every operation twice", "body": "<p>Here is a C version (ignoring std namespace) for storing an array of functions, just in case you cannot use the solution provided by @CoryKramer.</p>\n\n<pre><code>typedef void (*PointerFunction)(int x);\n\nvoid functA(int a) {\n    std::cout &lt;&lt; \"functA: \" &lt;&lt; a &lt;&lt; std::endl;\n}\nvoid functB(int b) {\n    std::cout &lt;&lt; \"functB: \" &lt;&lt; b &lt;&lt; std::endl;\n}\n\nPointerFunction functions[] = { functA, functB };\n\nfor (int func = 0; func &lt; 2; func++) {\n    for (int i = 0; i &lt; 2; i++) {\n        functions[func](i);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 472, "user_id": 4990485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5853eb83d309719afafb211b70725962?s=128&d=identicon&r=PG&f=1", "display_name": "sv90", "link": "https://stackoverflow.com/users/4990485/sv90"}, "is_accepted": false, "score": 0, "last_activity_date": 1523451562, "creation_date": 1523451562, "answer_id": 49775825, "question_id": 49774847, "link": "https://stackoverflow.com/questions/49774847/do-every-operation-twice/49775825#49775825", "title": "Do every operation twice", "body": "<p>You can wrap that behaviour in a higher order function that applies a function twice and apply that function on you functions.</p>\n\n<p>Using C++17 fold expressions that function could look as easy as</p>\n\n<pre><code>template &lt;typename Func, typename Arr, typename... Indices&gt;\nvoid map_indices(Func&amp;&amp; f, Arr&amp;&amp; arr, Indices&amp;&amp;... is) {\n  (f(arr[is]), ...);\n}\n</code></pre>\n\n<p>Using C++11 or C++14 this can be implemented using recursion.</p>\n\n<p>Your example would then look like</p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;typename Func, typename Arr, typename... Indices&gt;\nvoid map_indices(Func&amp;&amp; f, Arr&amp;&amp; arr, Indices&amp;&amp;... is) {\n  (f(arr[is]), ...);\n}\n\nvoid f1(int x) {\n  std::cout &lt;&lt; \"f1 \" &lt;&lt; x &lt;&lt; '\\n';\n}\n\nvoid f2(int x) {\n  std::cout &lt;&lt; \"f2 \" &lt;&lt; x &lt;&lt; '\\n';\n}\n\nvoid f3(int x) {\n  std::cout &lt;&lt; \"f3 \" &lt;&lt; x &lt;&lt; '\\n';\n}\n\nint main() {\n  std::array arr{1, 2, 3};\n  map_indices(f1, arr, 0, 1);\n  map_indices(f2, arr, 0, 1);\n  map_indices(f3, arr, 0, 1);\n}\n</code></pre>\n\n<p>If you know that you will only need the indices 0 and 1 <code>map_indices</code> can be simplified to</p>\n\n<pre><code>template &lt;typename Func, typename Arr&gt;\nvoid map_indices(Func&amp;&amp; f, Arr&amp;&amp; arr) {\n  f(arr[0]);\n  f(arr[1]);\n}\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 6036003, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8068b8179114e08d697d9b68f9faf4?s=128&d=identicon&r=PG&f=1", "display_name": "docp", "link": "https://stackoverflow.com/users/6036003/docp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 49775272, "answer_count": 3, "score": 0, "last_activity_date": 1523451562, "creation_date": 1523448847, "question_id": 49774847, "link": "https://stackoverflow.com/questions/49774847/do-every-operation-twice", "title": "Do every operation twice", "body": "<p>I would like to every function to be done twice. Arguments are in array, so it is something like this:</p>\n\n<pre><code>fun1(A[0]);\nfun1(A[1]);\n\nfun2(A[0]);\nfun2(A[1]);\n\nfun3(A[0]);\nfun3(A[1]);\n</code></pre>\n\n<p>Is there a way to do it automatically? I cannot use</p>\n\n<pre><code>for(int i=0; i&lt;2; i++)\n</code></pre>\n\n<p>cause it will be:</p>\n\n<pre><code>fun1(A[0]);\nfun2(A[0]);\nfun3(A[0]);\n\nfun1(A[1]);\nfun2(A[1]);\nfun3(A[1]);\n</code></pre>\n\n<p>And order in that case matters. </p>\n"}, {"tags": ["c++", "dll", "mql5", "metatrader5"], "comments": [{"owner": {"reputation": 4318, "user_id": 5069609, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-53Qj1KsrIN4/AAAAAAAAAAI/AAAAAAAAAAA/aXIMx-Fadms/photo.jpg?sz=128", "display_name": "Daniel Kniaz", "link": "https://stackoverflow.com/users/5069609/daniel-kniaz"}, "edited": false, "score": 1, "creation_date": 1523447947, "post_id": 49774469, "comment_id": 86563850, "body": "#import &quot;BPNN1.dll&quot; and cannot load BPNNl.dll or it just looks like last letter is small L ?"}, {"owner": {"reputation": 6177, "user_id": 4948889, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7f1b540c13a4b2663a9bf668f6a50145?s=128&d=identicon&r=PG", "display_name": "Jaffer Wilson", "link": "https://stackoverflow.com/users/4948889/jaffer-wilson"}, "reply_to_user": {"reputation": 4318, "user_id": 5069609, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-53Qj1KsrIN4/AAAAAAAAAAI/AAAAAAAAAAA/aXIMx-Fadms/photo.jpg?sz=128", "display_name": "Daniel Kniaz", "link": "https://stackoverflow.com/users/5069609/daniel-kniaz"}, "edited": false, "score": 0, "creation_date": 1523448263, "post_id": 49774469, "comment_id": 86564068, "body": "<code>2018.04.11 05:02:55.935\t2018.01.01 00:00:00   Cannot load &#39;C:\\Users\\AIM\\AppData\\Roaming\\MetaQuotes\\Tester\\D0E8209F77C8&zwnj;&#8203;CF37AD8BF550E51FF075&zwnj;&#8203;\\Agent-127.0.0.1-300&zwnj;&#8203;0\\MQL5\\Indicators\\BP&zwnj;&#8203;NN\\BPNN1.dll&#39; [126]</code> I guess this is something not understood."}, {"owner": {"reputation": 6177, "user_id": 4948889, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7f1b540c13a4b2663a9bf668f6a50145?s=128&d=identicon&r=PG", "display_name": "Jaffer Wilson", "link": "https://stackoverflow.com/users/4948889/jaffer-wilson"}, "reply_to_user": {"reputation": 4318, "user_id": 5069609, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-53Qj1KsrIN4/AAAAAAAAAAI/AAAAAAAAAAA/aXIMx-Fadms/photo.jpg?sz=128", "display_name": "Daniel Kniaz", "link": "https://stackoverflow.com/users/5069609/daniel-kniaz"}, "edited": false, "score": 0, "creation_date": 1523448293, "post_id": 49774469, "comment_id": 86564085, "body": "That is not small L. It is 1 (one)"}, {"owner": {"reputation": 1281, "user_id": 1356096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTexs.png?s=128&g=1", "display_name": "YesThatIsMyName", "link": "https://stackoverflow.com/users/1356096/yesthatismyname"}, "edited": false, "score": 0, "creation_date": 1523449242, "post_id": 49774469, "comment_id": 86564712, "body": "Already looked at <a href=\"https://stackoverflow.com/questions/1922580/import-a-dll-with-c-win32\" title=\"import a dll with c win32\">stackoverflow.com/questions/1922580/import-a-dll-with-c-win3&zwnj;&#8203;2</a> ?"}], "owner": {"reputation": 6177, "user_id": 4948889, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7f1b540c13a4b2663a9bf668f6a50145?s=128&d=identicon&r=PG", "display_name": "Jaffer Wilson", "link": "https://stackoverflow.com/users/4948889/jaffer-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523449652, "creation_date": 1523447677, "last_edit_date": 1523449652, "question_id": 49774469, "link": "https://stackoverflow.com/questions/49774469/how-to-call-the-cpp-file-in-mql5", "title": "How to call the .cpp file in MQL5?", "body": "<p>I am trying to call the <code>DLL</code> file so that I can use the function from the dll. But I failed. See the error I came across:  </p>\n\n<pre><code>#import \"BPNN1.dll\"\nstring Train(\n   double &amp;inpTrain[], // Input training data (1D array carrying 2D data, old first)\n   double &amp;outTarget[],// Output target data for training (2D data as 1D array, oldest 1st)\n   double &amp;outTrain[], // Output 1D array to hold net outputs from training\n   int    ntr,        // # of training sets\n   int    UEW,        // Use Ext. Weights for initialization (1=use extInitWt, 0=use rnd)\n   double &amp;extInitWt[],// Input 1D array to hold 3D array of external initial weights\n   double &amp;trainedWt[],// Output 1D array to hold 3D array of trained weights\n    int    numLayers,  // # of layers including input, hidden and output\n    int    &amp;lSz[],      // # of neurons in layers. lSz[0] is # of net inputs\n    int    AFT,        // Type of neuron activation function (0:sigm, 1:tanh, 2:x/(1+x))\n    int    OAF,        // 1 enables activation function for output layer; 0 disables\n    int    nep,        // Max # of training epochs\n    double maxMSE      // Max MSE; training stops once maxMSE is reached\n    );\n\nstring Test(\n   double &amp;inpTest[],  // Input test data (2D data as 1D array, oldest first)\n   double &amp;outTest[],  // Output 1D array to hold net outputs from training (oldest first)\n   int    ntt,        // # of test sets\n   double &amp;extInitWt[],// Input 1D array to hold 3D array of external initial weights\n    int    numLayers,  // # of layers including input, hidden and output\n    int    &amp;lSz[],      // # of neurons in layers. lSz[0] is # of net inputs\n   int    AFT,        // Type of neuron activation function (0:sigm, 1:tanh, 2:x/(1+x))\n    int    OAF         // 1 enables activation function for output layer; 0 disables\n    );\n#import\n</code></pre>\n\n<p>Error:<br>\n<a href=\"https://i.stack.imgur.com/jbIfS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jbIfS.png\" alt=\"resource image\"></a>   </p>\n\n<p>So this means that the dll is failing to load and read. So Is there a way I can include the <code>.cpp</code> source file in my MQL5 program and use it? Kindly, suggest me the way out.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 643, "user_id": 6030776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KkNn3.jpg?s=128&g=1", "display_name": "necko", "link": "https://stackoverflow.com/users/6030776/necko"}, "edited": false, "score": 0, "creation_date": 1523447623, "post_id": 49774422, "comment_id": 86563635, "body": "What programming language is this? Might want to retag your question."}, {"owner": {"reputation": 321, "user_id": 7587493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0G85h.jpg?s=128&g=1", "display_name": "JosanSun", "link": "https://stackoverflow.com/users/7587493/josansun"}, "reply_to_user": {"reputation": 643, "user_id": 6030776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KkNn3.jpg?s=128&g=1", "display_name": "necko", "link": "https://stackoverflow.com/users/6030776/necko"}, "edited": false, "score": 0, "creation_date": 1523447988, "post_id": 49774422, "comment_id": 86563870, "body": "@necko <a href=\"https://en.wikipedia.org/wiki/Qt_(software)\" rel=\"nofollow noreferrer\">Qt</a> a cross-platform application framework using C++."}, {"owner": {"reputation": 715, "user_id": 2104425, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/83bcd3a9286611ab251ac07a0d6feec5?s=128&d=identicon&r=PG", "display_name": "FrozenTarzan", "link": "https://stackoverflow.com/users/2104425/frozentarzan"}, "edited": false, "score": 0, "creation_date": 1523448320, "post_id": 49774422, "comment_id": 86564104, "body": "You might need to read the data as you do but then split it up into smaller chunks that can then be set as plain text in the widget. This way you might need to take scrolling/resizing/line breaks into account. Not sure if this is feasible."}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1523448324, "post_id": 49774422, "comment_id": 86564106, "body": "<code>QTextEdit</code> is known to be slow due to its layouting capabilities. You might consider using other widgets for your text, for example <code>QPlainTextEdit</code>."}, {"owner": {"reputation": 321, "user_id": 7587493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0G85h.jpg?s=128&g=1", "display_name": "JosanSun", "link": "https://stackoverflow.com/users/7587493/josansun"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1523450245, "post_id": 49774422, "comment_id": 86565489, "body": "@vahancho It costs <code>32s</code> now, but still annoying..."}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1523465641, "post_id": 49774422, "comment_id": 86576631, "body": "What is the structure (encoding, character set, locale) of your test file? upload it to your repository."}, {"owner": {"reputation": 321, "user_id": 7587493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0G85h.jpg?s=128&g=1", "display_name": "JosanSun", "link": "https://stackoverflow.com/users/7587493/josansun"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1523495577, "post_id": 49774422, "comment_id": 86588355, "body": "@MohammadKanan I have uploaded my test file in the testFile folder. Its name is <b>longline.txt</b>."}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 7587493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0G85h.jpg?s=128&g=1", "display_name": "JosanSun", "link": "https://stackoverflow.com/users/7587493/josansun"}, "edited": false, "score": 0, "creation_date": 1523532060, "post_id": 49790977, "comment_id": 86604619, "body": "My result of test is about 1000ms. Thank you. The result is acceptable."}], "tags": [], "owner": {"reputation": 2482, "user_id": 9630756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zkdcg.png?s=128&g=1", "display_name": "Sergio Monteleone", "link": "https://stackoverflow.com/users/9630756/sergio-monteleone"}, "is_accepted": true, "score": 3, "last_activity_date": 1523519789, "creation_date": 1523519789, "answer_id": 49790977, "question_id": 49774422, "link": "https://stackoverflow.com/questions/49774422/how-can-i-improve-the-speed-of-qtexteditsetplaintext-in-qt/49790977#49790977", "title": "How can I improve the speed of QTextEdit::setPlainText() in QT?", "body": "<p>The name of the test file tells the story already (<em>longline.txt</em>). </p>\n\n<p>The performance penalty is due to the default word wrap mode (<strong>QTextOption::WrapAtWordBoundaryOrAnywher</strong>e), which tries to wrap words without cutting them in half. </p>\n\n<p>Since your file is basically a very long single \"word\", the poor QTextEdit has no choice but to <strong>scan the whole file</strong> looking for the end of it.</p>\n\n<p>If you add this line in the constructor:</p>\n\n<pre><code>setWordWrapMode(QTextOption::WrapAnywhere);\n</code></pre>\n\n<p>you can override the default wrap mode. When <strong>QTextOption::WrapAnywhere</strong> is set, wrapping can occur at any point on a line (check the documentation <a href=\"http://doc.qt.io/qt-5/qtextoption.html#WrapMode-enum\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>Just for reference, doing so my machine took only 199 ms to load the file and display it.</p>\n\n<p>However, since this is a very unusual text case, I would suggest you to test your application with real world examples, or at the least expose the wrap mode settings to the user via the UI.</p>\n"}], "owner": {"reputation": 321, "user_id": 7587493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0G85h.jpg?s=128&g=1", "display_name": "JosanSun", "link": "https://stackoverflow.com/users/7587493/josansun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "accepted_answer_id": 49790977, "answer_count": 1, "score": -1, "last_activity_date": 1523519789, "creation_date": 1523447526, "last_edit_date": 1523448048, "question_id": 49774422, "link": "https://stackoverflow.com/questions/49774422/how-can-i-improve-the-speed-of-qtexteditsetplaintext-in-qt", "title": "How can I improve the speed of QTextEdit::setPlainText() in QT?", "body": "<p>I am recently writing a <a href=\"https://github.com/JosanSun/textEditor\" rel=\"nofollow noreferrer\">TextEditor project</a> uplaoded in the Github. The project has finished with the basic function of plain text editor! </p>\n\n<p>However, I cannot be satisfied with the speed of opening a big file.</p>\n\n<p>For example, when opening 540KB file, the cost of <code>readAll()</code> is 18ms, but the cost of <code>setPlainText()</code> is <strong><code>42s</code></strong>, which is annoying. How can I improve my code performance? Can you give me some advice? Thanks in advance.</p>\n\n<p>My main code is below:</p>\n\n<pre><code>// textedit.cpp \n#define qcout qDebug()\nbool TextEditor::readFile(const QString &amp;fileName)\n{\n    QFile file(fileName);\n    if(!file.open(QIODevice::ReadOnly | QIODevice::Text))\n    {\n        QMessageBox::warning(this, tr(\"TextEditor\"),\n                             tr(\"Cannot read file %1.\\n%2.\")\n                             .arg(file.fileName())\n                             .arg(file.errorString()));\n        return false;\n    }\n\n    //QTextStream inFile(&amp;file);\n#ifndef QT_NO_CURSOR\n    QApplication::setOverrideCursor(Qt::WaitCursor);\n#endif\n    QTime t1, t2, t3, t4;\n    t1 = QTime::currentTime();\n    const QByteArray data = file.readAll();     // 18ms\n    t2 = QTime::currentTime();\n    qcout &lt;&lt; t1.msecsTo(t2);\n    QTextCodec::ConverterState state;\n    QTextCodec *codec = QTextCodec::codecForName(\"UTF-8\");\n    const QString text = codec-&gt;toUnicode(data.constData(), data.size(), &amp;state);\n    //qcout &lt;&lt; text;\n    t3 = QTime::currentTime();\n    qcout &lt;&lt; t2.msecsTo(t3);\n    if (state.invalidChars &gt; 0)\n    {\n        // Not a UTF-8 text - using system default locale\n        QTextCodec * codec1 = QTextCodec::codecForLocale();\n        qcout &lt;&lt; codec1-&gt;name();\n        if (!codec1)\n            return false;\n        qcout &lt;&lt; \"invalidChars &gt; 0\";\n        setPlainText(codec1-&gt;toUnicode(data));\n    }\n    else\n    {\n        qcout &lt;&lt; \"invalidChars = 0\";\n        setPlainText(text);\n    }\n    t4 = QTime::currentTime();\n    qcout &lt;&lt; t3.msecsTo(t4);              // 42s annoying!\n#ifndef QT_NO_CURSOR\n    QApplication::restoreOverrideCursor();\n#endif\n    return true;\n}\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>18\n1\ninvalidChars = 0\n42126\n</code></pre>\n"}, {"tags": ["c++", "qt", "qml"], "comments": [{"owner": {"reputation": 1051, "user_id": 7192989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d41f45e6cacfb3d4195a9878880724?s=128&d=identicon&r=PG", "display_name": "Rinat Veliakhmedov", "link": "https://stackoverflow.com/users/7192989/rinat-veliakhmedov"}, "edited": false, "score": 0, "creation_date": 1523448652, "post_id": 49774324, "comment_id": 86564321, "body": "Please provide more code. From what I can see here, this shouldn&#39;t happen."}, {"owner": {"reputation": 2748, "user_id": 6165833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1b6bbdd7a7472d52c14da82af5eb6d20?s=128&d=identicon&r=PG&f=1", "display_name": "ymoreau", "link": "https://stackoverflow.com/users/6165833/ymoreau"}, "edited": false, "score": 0, "creation_date": 1523451948, "post_id": 49774324, "comment_id": 86566814, "body": "I could not find the answer is the doc. How is created <code>cppObject</code>? What is its lifetime compared to your Item?"}, {"owner": {"reputation": 11264, "user_id": 2056452, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/51f9d3e603983dd1aee8aadd80f17e2f?s=128&d=identicon&r=PG", "display_name": "derM", "link": "https://stackoverflow.com/users/2056452/derm"}, "edited": false, "score": 0, "creation_date": 1523455032, "post_id": 49774324, "comment_id": 86569215, "body": "Maybe a problem with the JS connections... Does the problem still arise when you use QML-style <code>Connections</code>?"}, {"owner": {"reputation": 11264, "user_id": 2056452, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/51f9d3e603983dd1aee8aadd80f17e2f?s=128&d=identicon&r=PG", "display_name": "derM", "link": "https://stackoverflow.com/users/2056452/derm"}, "edited": false, "score": 0, "creation_date": 1523456020, "post_id": 49774324, "comment_id": 86569938, "body": "If you&#39;d provide a full minimal, complete and verifiable example, we might see, if there is mistake on your side, or whether it should be published on bugreports.qt.io"}, {"owner": {"reputation": 528, "user_id": 3569069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Om05h.jpg?s=128&g=1", "display_name": "pier_nasos", "link": "https://stackoverflow.com/users/3569069/pier-nasos"}, "edited": false, "score": 1, "creation_date": 1523461233, "post_id": 49774324, "comment_id": 86573911, "body": "Added information about the life cycle of the cpp object. If I have time, I&#39;ll try to make a minimal project."}, {"owner": {"reputation": 4406, "user_id": 4911665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4f3ec7f68e33af504b9055abed79b7?s=128&d=identicon&r=PG&f=1", "display_name": "talamaki", "link": "https://stackoverflow.com/users/4911665/talamaki"}, "edited": false, "score": 0, "creation_date": 1523472470, "post_id": 49774324, "comment_id": 86580114, "body": "What is your Qt version?"}, {"owner": {"reputation": 528, "user_id": 3569069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Om05h.jpg?s=128&g=1", "display_name": "pier_nasos", "link": "https://stackoverflow.com/users/3569069/pier-nasos"}, "edited": false, "score": 0, "creation_date": 1523519254, "post_id": 49774324, "comment_id": 86596401, "body": "added information about the qt version"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1523519823, "post_id": 49774324, "comment_id": 86596693, "body": "@pier_nasos With the code that shows I have tried to reproduce its error and I do not have any problem, I have done it in Linux with Qt 5.10.1, only replace Model for a class that inherits from QObject."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1523519894, "post_id": 49774324, "comment_id": 86596739, "body": "@pier_nasos If you want us to help you, you must provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, that code by definition must be complete, that is, without gaps, and yours must be patched everywhere.  the error could be caused by the implementation of Model."}, {"owner": {"reputation": 1936, "user_id": 4322884, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007767376821/picture?type=large", "display_name": "mike510a", "link": "https://stackoverflow.com/users/4322884/mike510a"}, "edited": false, "score": 0, "creation_date": 1524127184, "post_id": 49774324, "comment_id": 86848304, "body": "Whats on line 77 of <code>&#47;qml&#47;xxxxxxxx.qml</code> ??  thats where the error is..."}], "answers": [{"tags": [], "owner": {"reputation": 1936, "user_id": 4322884, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007767376821/picture?type=large", "display_name": "mike510a", "link": "https://stackoverflow.com/users/4322884/mike510a"}, "is_accepted": false, "score": 0, "last_activity_date": 1524128310, "last_edit_date": 1524128310, "creation_date": 1524127768, "answer_id": 49916689, "question_id": 49774324, "link": "https://stackoverflow.com/questions/49774324/signal-slot-connection-after-destruction-of-qml-objects/49916689#49916689", "title": "Signal-Slot connection after destruction of qml objects?", "body": "<p>Easy solution is to :</p>\n\n<p>istantiate the cppObject directly from QML to ensure that both objects are properly cleaned up by adding to your main.cpp file before you load the QML file</p>\n\n<pre><code>qmlRegisterType&lt;Model&gt;(\"com.your.app\", 1, 0, \"CppModel\");\n</code></pre>\n\n<p>and then in your QML file include:</p>\n\n<pre><code>import com.your.app 1.0\n\n....\n\nCppModel {\n     id: cppObject\n\n     onSomeSignal:  { cppObject.cppObjectFunction(); }\n}\n</code></pre>\n\n<p>This way will make the extra connections and the extra qmlFunction() both unnecessary. </p>\n\n<p>and maybe this too:</p>\n\n<p>If <code>cppObjectFunction()</code> is a public slot from  <code>cppObject</code> that is defined on the C++ side, you can try adding <code>Q_INVOKABLE</code> to the front of it in order to add it to the metaobject system.</p>\n\n<pre><code>Q_INVOKABLE void cppObjectFunction()  {  /* your code */ } \n</code></pre>\n"}], "owner": {"reputation": 528, "user_id": 3569069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Om05h.jpg?s=128&g=1", "display_name": "pier_nasos", "link": "https://stackoverflow.com/users/3569069/pier-nasos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 506, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1524128310, "creation_date": 1523447225, "last_edit_date": 1523519207, "question_id": 49774324, "link": "https://stackoverflow.com/questions/49774324/signal-slot-connection-after-destruction-of-qml-objects", "title": "Signal-Slot connection after destruction of qml objects?", "body": "<p>What happens with the connection of signals from c++ objects to qml objects slots after destruction of qml objects?</p>\n\n<pre><code>Item {\n\n    function qmlFunction() {\n        cppObject.cppObjectFunction() \n    }\n\n    Component.onCompleted: {\n        cppObject.someSignal.connect(qmlFunction);\n    }\n\n    Component.onDestruction: {\n        cppObject.someSignal.disconnect(qmlFunction);\n    }\n}\n</code></pre>\n\n<p>Before I wrote Component.onDestruction with disconnect() the program displayed an error message:</p>\n\n<pre><code>qrc:/qml/xxxxxxxx.qml:77: TypeError: Cannot call method 'cppObjectFunction' of undefined\n</code></pre>\n\n<p>Is the disconnection of signals and slots not performed automatically?</p>\n\n<hr>\n\n<p>Object cppObject \"always\" exist and passed to qml this way:</p>\n\n<p>main.cpp</p>\n\n<pre><code>QQmlApplicationEngine engine;\nModel* model = new Model::instance(&amp;engine);\nengine.setObjectOwnership(model, QQmlEngine::CppOwnership);\nengine.rootContext()-&gt;setContextProperty(\"cppObject\", model);\nengine.load(QUrl(QStringLiteral(\"qrc:/qml/main.qml\")));\n</code></pre>\n\n<p>QML item is loaded by the <code>Loader</code> and can be reloaded several times during the program. Naturally, the error occurs after the QML item has been reloaded and cppObject triggers a signal <code>someSignal</code>.</p>\n\n<hr>\n\n<p>on windows: Qt 5.6.2   &lt;- my program log error to debug console</p>\n\n<p>on linux:   Qt 5.9.2   &lt;- my program crashes</p>\n\n<p>main.qml</p>\n\n<pre><code>import QtQuick 2.3\nimport QtQuick.Controls 1.2\nimport QtQuick.Layouts 1.1\nimport QtQuick.Dialogs 1.2\nimport QtQuick.Controls.Styles 1.3\nimport QtQuick.Window 2.2\n</code></pre>\n\n<p>File with error</p>\n\n<pre><code>import QtQuick 2.3\nimport QtQuick.Layouts 1.1\nimport QtQuick.Controls 1.3\n</code></pre>\n"}, {"tags": ["c++", "caffe", "rnn"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1523447398, "post_id": 49774286, "comment_id": 86563482, "body": "This might require a bit more code."}], "owner": {"reputation": 21, "user_id": 9629472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95fba5bd03ed6b326e894c712447b68e?s=128&d=identicon&r=PG&f=1", "display_name": "Izen", "link": "https://stackoverflow.com/users/9629472/izen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1523617092, "creation_date": 1523447126, "last_edit_date": 1523617092, "question_id": 49774286, "link": "https://stackoverflow.com/questions/49774286/deploying-caffe-rnns", "title": "Deploying caffe RNNs", "body": "<p>I'm trying to deploy a caffe model containing a RNN layer. The issue I'm having is how to compute the output from the network. My assumption was that I could call</p>\n\n<pre><code>net-&gt;Forward();\n</code></pre>\n\n<p>to update the network and then</p>\n\n<pre><code>net-&gt;output_blobs()[0]-&gt;mutable_cpu_data()[x];\n</code></pre>\n\n<p>once every timestep to read the output. However, using a constant input and then running \"<code>net-Forward()</code>\" multiple times does not affect the output as one would expect. I've tried to use different weights/biases, which changes the output, but no matter what configuration I'm using the output will still be static. Does anyone know what the proper procedure for deploying caffe RNNs with C++ is?</p>\n\n<p>Edit: </p>\n\n<p>This was tested with a single neuron RNN layer like below.</p>\n\n<p>model.prototxt:</p>\n\n<pre><code>layer {\n    name: \"input\"\n    type: \"Input\"\n    top: \"states\"\n    input_param {\n        shape: {\n            dim: 1\n            dim: 1\n        }\n    }\n}\n\ninput: \"clip\"\ninput_shape { dim: 1 dim: 1 dim: 1}\n\nlayer {\n    name: \"rnn\"\n    type: \"RNN\"\n    top: \"rnn\"\n    bottom: \"clip\"\n    bottom: \"states\"\n    recurrent_param {\n        num_output: 1\n    }\n}\n</code></pre>\n\n<p>And the .cpp:</p>\n\n<pre><code>caffe::Blob&lt;float&gt;* input_layer = test_net-&gt;input_blobs()[0];\nfloat* input_data;\ninput_data = input_layer-&gt;mutable_cpu_data();\n\ninput_data[0] = 1.0;\nfor (int i=0; i&lt;5; i++)\n{\n    test_net-&gt;Forward();\n    cout &lt;&lt; \"Ouput: \" &lt;&lt; net-&gt;output_blobs().back()-&gt;mutable_cpu_data()[0] &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "template-templates"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1523447744, "post_id": 49774254, "comment_id": 86563707, "body": "A template template parameter is always a class template, not a function template. The syntax is always <code>template &lt;...&gt; class-or-typename</code>."}, {"owner": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1523448453, "post_id": 49774254, "comment_id": 86564188, "body": "@n.m. So should I be able to do this using a template class as a functor?"}, {"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 3, "creation_date": 1523448696, "post_id": 49774254, "comment_id": 86564346, "body": "There are no pointers to templates. You can use pointers to specific instantiations of  templates however."}, {"owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "edited": false, "score": 1, "creation_date": 1523448762, "post_id": 49774254, "comment_id": 86564397, "body": "Maybe this can move You forward: <a href=\"https://stackoverflow.com/questions/213761/what-are-some-uses-of-template-template-parameters-in-c#213811\" title=\"what are some uses of template template parameters in c%23213811\">stackoverflow.com/questions/213761/&hellip;</a>"}, {"owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "edited": false, "score": 0, "creation_date": 1523448849, "post_id": 49774254, "comment_id": 86564443, "body": "And also: <a href=\"https://stackoverflow.com/questions/10115048/template-member-function-pointers#10115067\" title=\"template member function pointers%2310115067\">stackoverflow.com/questions/10115048/&hellip;</a>"}, {"owner": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "reply_to_user": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1523449060, "post_id": 49774254, "comment_id": 86564583, "body": "@PaulR Yeah, but I would like to have the template instantiated by the GetMaterial instantiation, so I don&#39;t need to give the unit at the GetMaterial call site."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1523455873, "post_id": 49774254, "comment_id": 86569828, "body": "<i>using a template class as a functor</i> Yes I believe this should be possible."}], "answers": [{"comments": [{"owner": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "edited": false, "score": 0, "creation_date": 1523452354, "post_id": 49775134, "comment_id": 86567149, "body": "Great, thanks! Why is <code>template</code> required in <code>return T::template func&lt;Unit::model_unit&gt;(p);</code> ? I&#39;ve never seen this."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "edited": false, "score": 1, "creation_date": 1523458763, "post_id": 49775134, "comment_id": 86572072, "body": "@ThreeStarProgrammer57 - sometimes that  <code>template</code> is required to tell the compiler that the called method is a <code>template</code> one; frankly I have great troubles to understand when, exactly, is required and when isn&#39;t required. This case seems to be required."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 3, "last_activity_date": 1523449962, "last_edit_date": 1523449962, "creation_date": 1523449593, "answer_id": 49775134, "question_id": 49774254, "link": "https://stackoverflow.com/questions/49774254/how-to-pass-a-template-template-non-type-member-function-pointer/49775134#49775134", "title": "How to pass a template template non-type member function pointer?", "body": "<p>As explained in comments, there isn't a single pointer to a template function (or method) because isn't a function but a set of functions.</p>\n\n<p>The best I can imagine to do something similar (I mean... explicating the <code>Unit</code> type inside <code>GetMaterial()</code>) is to add a couple of sub-structs in <code>Impl</code> with static template methods</p>\n\n<pre><code>   struct lm1\n    {\n      template &lt;Unit U&gt;\n      static Material * func (Point const &amp; p)\n       { return nullptr; }\n    };\n\n   struct lm2\n    {\n      template &lt;Unit U&gt;\n      static Material * func (Point const &amp; p)\n       { return nullptr; }\n    };\n</code></pre>\n\n<p>then rewrite <code>GetMaterial()</code> as follows</p>\n\n<pre><code>template &lt;typename T&gt;\nMaterial * GetMaterial (Point const &amp; p)\n { return T::template func&lt;Unit::model_unit&gt;(p); }\n</code></pre>\n\n<p>and use it this way</p>\n\n<pre><code>void DoSomething()\n {\n   Point p = {};\n\n   auto mat_1 = GetMaterial&lt;lm1&gt;(p);\n   auto mat_2 = GetMaterial&lt;lm2&gt;(p);\n }\n</code></pre>\n\n<p>This way you pass to <code>GetMaterial()</code> a single type (<code>lm1</code> or <code>lm2</code>) that contains the full set of template functions; then, inside <code>GetMaterial()</code>, you select the right function explicating <code>Unit::model_unit</code>.</p>\n\n<p>The following is a full working example</p>\n\n<pre><code>enum Unit { model_unit, nanometers, meters };\n\nstruct Material\n { double rho; };\n\nstruct Point\n { double x, y, z; };\n\nstruct Impl\n {\n   struct lm1\n    {\n      template &lt;Unit U&gt;\n      static Material * func (Point const &amp; p)\n       { return nullptr; }\n    };\n\n   struct lm2\n    {\n      template &lt;Unit U&gt;\n      static Material * func (Point const &amp; p)\n       { return nullptr; }\n    };\n\n\n   template &lt;typename T&gt;\n   Material * GetMaterial (Point const &amp; p)\n    { return T::template func&lt;Unit::model_unit&gt;(p); }\n\n   void DoSomething()\n    {\n      Point p = {};\n\n      auto mat_1 = GetMaterial&lt;lm1&gt;(p);\n      auto mat_2 = GetMaterial&lt;lm2&gt;(p);\n    }\n };\n\nint main ()\n {\n   Impl i;\n\n   i.DoSomething();\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "edited": false, "score": 0, "creation_date": 1523462019, "post_id": 49778321, "comment_id": 86574449, "body": "Yeah, that&#39;s exactly what I ended up doing, after reading your comment. Thanks!"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1523458397, "creation_date": 1523458397, "answer_id": 49778321, "question_id": 49774254, "link": "https://stackoverflow.com/questions/49774254/how-to-pass-a-template-template-non-type-member-function-pointer/49778321#49778321", "title": "How to pass a template template non-type member function pointer?", "body": "<p>Here's the class-template-as-functor way of doing this.</p>\n\n<pre><code>template&lt;Unit unit&gt;\nstruct LookupMat_1\n{\n   Material * operator()(const Point&amp; p) {\n       return nullptr;\n   }\n};\n\ntemplate&lt;Unit unit&gt;\nstruct LookupMat_2\n{\n   Material * operator()(const Point&amp; p) {\n       return nullptr;\n   }\n};\n\ntemplate&lt;template&lt;Unit&gt; typename LookupMat&gt;\nMaterial * GetMaterial(const Point &amp; p)\n{\n    return LookupMat&lt;Unit::model_unit&gt;()(p);\n}\n</code></pre>\n"}], "owner": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 49778321, "answer_count": 2, "score": 2, "last_activity_date": 1523458397, "creation_date": 1523447010, "question_id": 49774254, "link": "https://stackoverflow.com/questions/49774254/how-to-pass-a-template-template-non-type-member-function-pointer", "title": "How to pass a template template non-type member function pointer?", "body": "<p>I would like to pass (to a template member function) a pointer to a another template member function as a template template non-type parameter.</p>\n\n<p>Here is what I've tried:</p>\n\n<pre><code>enum Unit { model_unit, nanometers, meters };\n\nstruct Material {\n     double rho;\n};\n\nstruct Point {\n    double x, y, z;\n};\n\nstruct Impl{\n\n    template&lt;Unit unit&gt;\n    Material * LookupMat_1(const Point&amp; p) {\n        return nullptr; // let's suppose it returns a valid pointer\n    }\n\n    template&lt;Unit unit&gt;\n    Material * LookupMat_2(const Point&amp; p) {\n        return nullptr; // let's suppose it returns a valid pointer\n    }\n\n    // compiler error here:\n    // expected 'class' or 'typename' before 'Material'\n    // template&lt;template&lt;Unit&gt; Material * (Impl::*LookupFunc)(const Point&amp;)\n    //                         ^~~~~~~~\n    template&lt;template&lt;Unit&gt; Material * (Impl::*LookupFunc)(const Point&amp;) &gt;\n    Material * GetMaterial(const Point &amp; p) {\n\n        return (this-&gt;*LookupFunc&lt;Unit::model_unit&gt;)(p);\n    }\n\n    void DoSomething() {\n\n        Point p = {};\n\n        auto mat_1 = GetMaterial&lt;LookupMat_1&gt;(p);\n        auto mat_2 = GetMaterial&lt;LookupMat_2&gt;(p);\n    }\n};\n\nint main() {\n\n    Impl i;\n\n    i.DoSomething();\n\n}\n</code></pre>\n\n<p>My syntax is wrong, the compiler says:</p>\n\n<blockquote>\n<pre><code>main.cpp:25:29: error: expected 'class' or 'typename' before 'Material'\ntemplate&lt;template&lt;Unit&gt; Material * (Impl::*LookupFunc)(const Point&amp;)\n                        ^~~~~~~~\n</code></pre>\n</blockquote>\n\n<p>I cannot figure out the right syntax.</p>\n\n<p><code>LookupFunc</code> is a template of type <code>Material * (Impl::*)(const Point&amp;)</code> which is a pointer to a member fonction.</p>\n\n<p>Is what I am trying to do possible?</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1523447058, "post_id": 49774185, "comment_id": 86563234, "body": "I was surprised, but indeed: <a href=\"http://en.cppreference.com/w/cpp/types/underlying_type\" rel=\"nofollow noreferrer\">&quot;If <code>T</code> is a complete enumeration type, provides a member typedef type that names the underlying <code>type</code> of <code>T</code>. Otherwise, the behavior is undefined.&quot;</a>. Well, that sucks."}], "answers": [{"tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 10, "last_activity_date": 1523447502, "last_edit_date": 1523447502, "creation_date": 1523447411, "answer_id": 49774383, "question_id": 49774185, "link": "https://stackoverflow.com/questions/49774185/how-can-i-specialize-a-class-for-enums-of-underlying-type-int/49774383#49774383", "title": "How can I specialize a class for enums of underlying type int?", "body": "<p>A simple enough solution to this quirk is to insulate <code>std::underlying_type</code> behind your own SFINAE-friendly trait:</p>\n\n<pre><code>template &lt;class T, class = void&gt;\nstruct underlying_type {};\n\ntemplate &lt;class T&gt;\nstruct underlying_type&lt;\n    T,\n    typename std::enable_if&lt;std::is_enum&lt;T&gt;::value&gt;::type\n&gt; {\n    using type = typename std::underlying_type&lt;T&gt;::type;\n};\n</code></pre>\n\n<p>Then your specialization can be written as:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass MyClass&lt;\n    T, \n    typename std::enable_if&lt;std::is_same&lt;\n        typename underlying_type&lt;T&gt;::type,\n        int\n    &gt;::value&gt;::type\n&gt; {\n    // ...\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 3, "last_activity_date": 1523448835, "creation_date": 1523448835, "answer_id": 49774843, "question_id": 49774185, "link": "https://stackoverflow.com/questions/49774185/how-can-i-specialize-a-class-for-enums-of-underlying-type-int/49774843#49774843", "title": "How can I specialize a class for enums of underlying type int?", "body": "<p>With one extra (delayed) indirection with <code>conditional&lt;..&gt;::type::type</code>:</p>\n\n<pre><code>template &lt;typename T&gt; struct Identity { using type = T; };\n\ntemplate &lt;typename E&gt;\nclass MyClass &lt;E, \n    typename std::enable_if&lt;\n        std::is_enum&lt;E&gt;::value \n        &amp;&amp; std::is_same&lt;\n            int,\n            typename std::conditional&lt;\n                std::is_enum&lt;E&gt;::value,\n                std::underlying_type&lt;E&gt;,\n                Identity&lt;E&gt;\n            &gt;::type::type\n        &gt;::value\n    &gt;::type\n&gt;\n{\n    // ...\n};\n</code></pre>\n\n<p>We really does <code>std::underlying_type&lt;E&gt;::type</code> only for enum.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/843f43f18083e604\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 91, "user_id": 9629931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d34011c96fa73c11d16dccb3fe9994d9?s=128&d=identicon&r=PG&f=1", "display_name": "RaB", "link": "https://stackoverflow.com/users/9629931/rab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 49774383, "answer_count": 2, "score": 8, "last_activity_date": 1523450886, "creation_date": 1523446795, "last_edit_date": 1523450886, "question_id": 49774185, "link": "https://stackoverflow.com/questions/49774185/how-can-i-specialize-a-class-for-enums-of-underlying-type-int", "title": "How can I specialize a class for enums of underlying type int?", "body": "<pre><code>#include &lt;type_traits&gt;\n\nenum class MyEnum\n{\n    Hello\n};\n\ntemplate &lt;typename T, typename Enable = void&gt;\nclass MyClass\n{\npublic:\n    MyClass(T obj) : e(obj)\n    {}\n\nprivate:\n    T e;\n};\n\ntemplate &lt;typename T&gt;\nclass MyClass &lt;T, \n    typename std::enable_if&lt; std::is_enum&lt;T&gt;::value \n                             &amp;&amp; std::is_same&lt;typename std::underlying_type&lt;T&gt;::type, \n                                             int&gt;::value&gt;::type &gt; \n{\npublic:\n    MyClass(T obj) : e(obj)\n    {}\n\nprivate:\n    T e;\n};\n\nint main()\n{\n    MyClass&lt;MyEnum&gt; c(MyEnum::Hello);\n    MyClass&lt;int&gt; c1(1); //does not compile due to std::underlying_type\n    return 0;\n}\n</code></pre>\n\n<p>I would like to be able to specialize MyClass for enums of underlying type 'int'. I can't do that using std::underlying_type because it is only specific to enums.\nAny ideas on how I can proceed?</p>\n"}, {"tags": ["c#", "c++", "interop", "access-violation", "interopservices"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9163694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038cec1c49aba481fa91c26a6bb78d7f?s=128&d=identicon&r=PG&f=1", "display_name": "skitiddu", "link": "https://stackoverflow.com/users/9163694/skitiddu"}, "edited": false, "score": 0, "creation_date": 1523449697, "post_id": 49774663, "comment_id": 86565092, "body": "So the message is  <code>Exception thrown at 0x001E15D9 in TheManagedCode.exe: 0xC0000005: Access violation reading location 0x00000004.</code> I am not sure I entirely follow you here; If I have not provided my own <code>::operator new</code> how is it to  be broken then?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 31, "user_id": 9163694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038cec1c49aba481fa91c26a6bb78d7f?s=128&d=identicon&r=PG&f=1", "display_name": "skitiddu", "link": "https://stackoverflow.com/users/9163694/skitiddu"}, "edited": false, "score": 0, "creation_date": 1523452836, "post_id": 49774663, "comment_id": 86567499, "body": "@skitiddu: Well, since you didn&#39;t provide that information up front, I just covered a few cases. So the problem here is the <b>read</b>. It&#39;s obviously dereferencing a null pointer, but why? The next bit of information is the instruction which caused it, at <code>0x001.....</code>. That&#39;s probably in the EXE. Why is it in there? Static CRT? <code>operator new</code> usually is in a DLL (as you want it to be shared by all modules)."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 1, "last_activity_date": 1523448257, "creation_date": 1523448257, "answer_id": 49774663, "question_id": 49774071, "link": "https://stackoverflow.com/questions/49774071/dynamic-memory-allocation-in-native-dll/49774663#49774663", "title": "Dynamic memory allocation in native dll", "body": "<p><code>new MyClass</code> is most likely going to call <code>::operator new</code>, the global operator, unless you have provided <code>MyClass::operator new</code>. And if you haven't provided <code>::operator new</code> yourself, you should be getting the <code>::operator new</code> from your compiler (likely Visual Studio).</p>\n\n<p>This <code>::operator new</code> implementation will probably forward to <code>HeapAlloc</code>. And guess what? That's the same Win32 function which .Net will call as well. There's not much magic involved here; that's how Windows assigns pages of memory to your virtual address space. And when you use those pages, Windows will assign RAM.</p>\n\n<p>Now the thing here is that you don't need to do anything special for this. In fact, doing anything special is how you would <strong>break</strong> <code>operator new</code>. And since you broke it, you''re going to have to figure that out. There is not much magic code going on here. Use a debug build, so you will have a clear stack dump (no inlining). Can you backtrack to <code>HeapAlloc</code>?</p>\n\n<p>Check also the <strong>content</strong> of the Access Violation Exception. The error code will be C0000005. But what type of exception is it? Read or write? On what type of address? Code or data?  </p>\n"}], "owner": {"reputation": 31, "user_id": 9163694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038cec1c49aba481fa91c26a6bb78d7f?s=128&d=identicon&r=PG&f=1", "display_name": "skitiddu", "link": "https://stackoverflow.com/users/9163694/skitiddu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1523448329, "creation_date": 1523446485, "last_edit_date": 1523448329, "question_id": 49774071, "link": "https://stackoverflow.com/questions/49774071/dynamic-memory-allocation-in-native-dll", "title": "Dynamic memory allocation in native dll", "body": "<p>I have a native (unmanaged) .dll written in C++ that is to be called from a managed process (a C# program). When debugging the dll the problem I have has shown to be that when I create an object in the dll with the <code>new</code> keyword I get a System Access Violation Exception. This only shows up when calling the dll from a managed process, not when I am calling it from another native program.</p>\n\n<p>The code is something similar to this:</p>\n\n<pre><code>// Native.dll file\nMyClass myInstance; // global variable (and does need to be so)\n__declspec(dllexport) uint8_t _stdcall NativeFunction(){\n    myInstance = new MyClass(); // &lt;-- this causes Access Violation Exception\n}\n</code></pre>\n\n<p>and the C# code:</p>\n\n<pre><code>using System.Runtime.Interopservices;\n// Loading the dll\n[DllImport(\"Native.dll\",CallingConvention = CallingConvention.StdCall)]\nprivate extern static byte NativeFunction();\n\nclass TestClass{\n   byte returnVal = NativeFunction(); //&lt;-- exception in managed context\n}\n</code></pre>\n\n<p>I know this has something to do with the native process trying to allocate memory outside allowed memory-space. It only happens when memory is allocated with <code>new</code> (at least in this project) which I unfortunately do need to use. My question is: Does anyone know why this is causing the exception and how to avoid it?</p>\n"}, {"tags": ["c++", "rtti", "typeid", "typeinfo"], "answers": [{"comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 1, "creation_date": 1545678138, "post_id": 53897983, "comment_id": 94676638, "body": "Notably, it&#39;s <i>possible</i> for a target to override this, but no target actually does."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1545678515, "post_id": 53897983, "comment_id": 94676725, "body": "@o11c 3 targets do override it: <code>__GXX_MERGED_TYPEINFO_NAMES=0</code>."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1545681406, "post_id": 53897983, "comment_id": 94677338, "body": "Er, right, but they overwrite it to the value it already has."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1545675851, "last_edit_date": 1545675851, "creation_date": 1545500568, "answer_id": 53897983, "question_id": 49773686, "link": "https://stackoverflow.com/questions/49773686/which-platforms-dont-use-string-comparison-in-type-info-op/53897983#53897983", "title": "Which platforms don&#39;t use string comparison in type_info op==?", "body": "<blockquote>\n  <p>In libstdc++ it's controlled with <code>__GXX_MERGED_TYPEINFO_NAMES</code></p>\n</blockquote>\n\n<p><a href=\"https://github.com/gcc-mirror/gcc/commit/62164d4c3690257a01326783bed77c15831d52b9\" rel=\"nofollow noreferrer\">In newer versions of gcc (since 23 Jul 2009) this macro is set to 0 by default</a>. It always compares pointers first and if that fails they do the full string comparison. <a href=\"https://github.com/gcc-mirror/gcc/blob/41d6b10e96a1de98e90a7c0378437c3255814b16/libstdc%2B%2B-v3/libsupc%2B%2B/typeinfo#L48\" rel=\"nofollow noreferrer\">See here</a>:</p>\n\n<blockquote>\n  <p>We used to do inline pointer comparison by default if weak symbols are available, but even with weak symbols sometimes names are not merged when objects are loaded with <code>RTLD_LOCAL</code>, so now we always use <code>strcmp</code> by default. </p>\n</blockquote>\n"}], "owner": {"reputation": 10759, "user_id": 343443, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2dcf7b64ff07a02fbd78c27f50ce9631?s=128&d=identicon&r=PG", "display_name": "Abyx", "link": "https://stackoverflow.com/users/343443/abyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 5, "accepted_answer_id": 53897983, "answer_count": 1, "score": 13, "last_activity_date": 1545677550, "creation_date": 1523445379, "last_edit_date": 1545677550, "question_id": 49773686, "link": "https://stackoverflow.com/questions/49773686/which-platforms-dont-use-string-comparison-in-type-info-op", "title": "Which platforms don&#39;t use string comparison in type_info op==?", "body": "<p>Here is a typical implementation of <code>type_info::operator==</code>:</p>\n\n<pre><code>#if _PLATFORM_SUPPORTS_UNIQUE_TYPEINFO\n    bool operator==(const type_info&amp; __rhs) const {\n      return __mangled_name == __rhs.__mangled_name;\n    }\n#else\n    bool operator==(const type_info&amp; __rhs) const {\n      return __mangled_name == __rhs.__mangled_name ||\n             strcmp(__mangled_name, __rhs.__mangled_name) == 0;\n    }\n#endif\n</code></pre>\n\n<p>In libstdc++ it's controlled with <code>__GXX_MERGED_TYPEINFO_NAMES</code>,<br>\nin libc++ it's <code>_LIBCPP_NONUNIQUE_RTTI_BIT</code>,<br>\nMSVC always compares strings.</p>\n\n<p>What are the platforms which don't compare strings?</p>\n"}, {"tags": ["c++", "object", "casting", "instantiation", "c++17"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1523445721, "post_id": 49773485, "comment_id": 86562359, "body": "May I ask, how is this useful?"}, {"owner": {"reputation": 49861, "user_id": 882932, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/KdHtK.png?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/882932/vincent"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1523445804, "post_id": 49773485, "comment_id": 86562410, "body": "@PasserBy This is mostly a theoretical question"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1523447751, "post_id": 49773485, "comment_id": 86563711, "body": "<code>object&lt;int&gt;</code> may be instantiated if you write a <b>specialization</b> for it which allow it. Cannot be instanitated from that generic class."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1523447816, "post_id": 49773485, "comment_id": 86563753, "body": "You can create a <code>void*</code> pointer and cast it to <code>object&lt;T&gt;*</code>, right? This is a defined behaviour, isn&#39;t it? Although not a defined value."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1523447931, "post_id": 49773485, "comment_id": 86563838, "body": "@freakish No it&#39;s not."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1523448021, "post_id": 49773485, "comment_id": 86563902, "body": "@PasserBy The standard explicitely allows casting from <code>void*</code> to any pointer type. How is that not a defined behaviour? Or am I wrong about it?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1523448174, "post_id": 49773485, "comment_id": 86564008, "body": "@freakish - There isn&#39;t an object there. Not for a type like this, anyway."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1523449948, "post_id": 49773485, "comment_id": 86565252, "body": "@PasserBy you could use this for a collection of static functions ... most people would put them in a namespace as free functions but here&#39;s an alternative."}, {"owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "edited": false, "score": 0, "creation_date": 1524330779, "post_id": 49773485, "comment_id": 86932778, "body": "Create a buffer and use a cast. This way without initializing or destructing, an object can be used. Answer attached."}], "answers": [{"tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": false, "score": 1, "last_activity_date": 1523446948, "creation_date": 1523446948, "answer_id": 49774233, "question_id": 49773485, "link": "https://stackoverflow.com/questions/49773485/can-a-non-aggregate-class-with-deleted-constructors-and-destructor-be-ever-insta/49774233#49774233", "title": "Can a non-aggregate class with deleted constructors and destructor be ever instantiated?", "body": "<p>I don't claim this to be an answer (am not a language lawyer), just post some findings from n4659:</p>\n\n<blockquote>\n  <p>11.6.20: An object whose initialization has completed is deemed to be constructed, even if no constructor of the object\u2019s class is invoked for the initialization. [ Note: <strong>Such an object might have been value-initialized</strong> or\n  initialized by aggregate initialization (11.6.1) or by an inherited constructor (15.6.3). \u2014end note ]</p>\n</blockquote>\n\n<p>From the 3 options mentioned in the note, only the first applies:</p>\n\n<blockquote>\n  <p>11.6.8: To <strong>value-initialize</strong> an object of type T means ... (8.1) \u2014 if T is a (possibly cv-qualified) class type (Clause 12) with either no default constructor (15.1) <strong>or a default constructor that is</strong> user-provided or <strong>deleted</strong>, then the object is <strong>default-initialized</strong>;</p>\n</blockquote>\n\n<p>Since a default constructor is deleted:</p>\n\n<blockquote>\n  <p>11.6.7: To <strong>default-initialize</strong> an object of type T means ... (7.1) \u2014 If T is a (possibly cv-qualified) class type (Clause 12), constructors are considered. The applicable constructors are enumerated (16.3.1.3), and the best one for the initializer () is chosen through overload resolution (16.3). <strong>The constructor thus selected is called</strong>, with an empty argument list, to initialize the object.</p>\n</blockquote>\n\n<p>Since there is no constructor that can be called, I think the instance of class <code>object</code> cannot be constructed.</p>\n"}, {"tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": true, "score": 4, "last_activity_date": 1523448517, "last_edit_date": 1592644375, "creation_date": 1523447642, "answer_id": 49774464, "question_id": 49773485, "link": "https://stackoverflow.com/questions/49773485/can-a-non-aggregate-class-with-deleted-constructors-and-destructor-be-ever-insta/49774464#49774464", "title": "Can a non-aggregate class with deleted constructors and destructor be ever instantiated?", "body": "<p>No it cannot. From <a href=\"https://timsong-cpp.github.io/cppwp/basic.life\" rel=\"nofollow noreferrer\">[basic.life]</a></p>\n<blockquote>\n<p>[...] The lifetime of an object of type <code>T</code> begins when:</p>\n<ul>\n<li><p>storage with the proper alignment and size for type <code>T</code> is obtained, and</p>\n</li>\n<li><p>if the object has non-vacuous initialization, its initialization is complete,</p>\n</li>\n</ul>\n</blockquote>\n<p>Thus initialization must be performed. We then look at <a href=\"https://timsong-cpp.github.io/cppwp/dcl.init#17\" rel=\"nofollow noreferrer\">all the possible initializations</a>.</p>\n<ol>\n<li><p>If the initializer is <code>{...}</code>, then it is <a href=\"https://timsong-cpp.github.io/cppwp/dcl.init.list\" rel=\"nofollow noreferrer\">list-initialized</a>.</p>\n<ul>\n<li>The class is non-aggregate, so it cannot be <a href=\"https://timsong-cpp.github.io/cppwp/dcl.init.aggr\" rel=\"nofollow noreferrer\">aggregate-initialized</a>.</li>\n<li>The class has no default constructor, so it can't be value-initialized by <code>{}</code></li>\n<li>The class can be direct-initialized or copy-initialized by a <code>{x}</code>, which calls a constructor through overload resolution</li>\n</ul>\n</li>\n<li><p>If the initializer is <code>()</code>, then it is value-initialized</p>\n</li>\n<li><p>If the initializer is the same cv-unqualified type, the initializer expression for the initializer is used instead as the initializer</p>\n<ul>\n<li>That is, <code>T x = T(T());</code> is just to default-initialize <code>x</code>, with no copies</li>\n</ul>\n</li>\n<li><p>If there is no initializers, then it is default-initialized</p>\n</li>\n<li><p>Otherwise constructors are considered and called with overload resolution.</p>\n</li>\n<li><p>To value-initialize is to default-initialize the object in this case.</p>\n</li>\n<li><p>Default-initialization calls the default constructor in this case.</p>\n</li>\n</ol>\n<p>If you look carefully, there is only one way on this list to initialize the object, and that is to call a constructor. Since we have deleted all constructors, we can't initialize the object.</p>\n"}, {"tags": [], "owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "is_accepted": false, "score": -1, "last_activity_date": 1524327373, "last_edit_date": 1524327373, "creation_date": 1524326743, "answer_id": 49957667, "question_id": 49773485, "link": "https://stackoverflow.com/questions/49773485/can-a-non-aggregate-class-with-deleted-constructors-and-destructor-be-ever-insta/49957667#49957667", "title": "Can a non-aggregate class with deleted constructors and destructor be ever instantiated?", "body": "<p>The rules are clear, this object cannot be initialized correctly.</p>\n\n<p>Since that is what is asked for, then create a buffer for Your class, and use it with care.</p>\n\n<pre><code>template&lt; typename T &gt;\nclass object_wrapper\n{\n    std::byte buffer[ sizeof( T ) ];\n\npublic:\n    auto&amp; inner() { return *reinterpret_cast&lt; T* &gt;( buffer ); }\n};\n</code></pre>\n\n<p>Here is an example:</p>\n\n<pre><code>int main()\n{\n    //object&lt; int &gt; o; // impossible\n\n    object_wrapper&lt; object&lt; int &gt; &gt; ow; // wrap the object\n\n    object&lt; int &gt;&amp; o( ow.inner() );     // possible\n\n    o.some_foo();\n\n}\n</code></pre>\n"}], "owner": {"reputation": 49861, "user_id": 882932, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/KdHtK.png?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/882932/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 3, "accepted_answer_id": 49774464, "answer_count": 3, "score": 10, "last_activity_date": 1524327373, "creation_date": 1523444816, "last_edit_date": 1523446395, "question_id": 49773485, "link": "https://stackoverflow.com/questions/49773485/can-a-non-aggregate-class-with-deleted-constructors-and-destructor-be-ever-insta", "title": "Can a non-aggregate class with deleted constructors and destructor be ever instantiated?", "body": "<p>Consider the following class:</p>\n\n<pre><code>template &lt;class T&gt;\nclass object {\npublic:\n    using type = T;\n\n    object() = delete;\n    object(const object&amp;) = delete;\n    object(object&amp;&amp;) = delete;\n    object&amp; operator=(const object&amp;) = delete;\n    object&amp; operator=(object&amp;&amp;) = delete;\n    ~object() = delete;\n\nprivate:\n    type value = 0;\n};\n</code></pre>\n\n<p>Is it possible to instantiate an object (on the stack (probably not) or on the heap (maybe?)) of type <code>object&lt;int&gt;</code> by any weird trickery, or is it impossible for an <code>object&lt;int&gt;</code> to ever exist in any conceivable (well formed and with well defined behavior) <code>C++17</code> program?</p>\n\n<p>Addendum: First we consider non ill-formed NDR programs/non undefined behavior. If and only if, there are only ill-formed NDR programs/undefined behavior programs possible, you can illustrate the answer with such a program.</p>\n"}, {"tags": ["c++", "opencv", "gaussianblur"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1523455288, "post_id": 49773387, "comment_id": 86569387, "body": "Based on the original documentation link... you&#39;re using OpenCV 3.4.1, but refer to docs for 2.4.x -- keep in mind that there were some small changes in the API, so it&#39;s advisable to refer to the ones that match the version you use. However, as far as I can tell so far, it doesn&#39;t seem to be the source of the problem here."}, {"owner": {"reputation": 1378, "user_id": 4405942, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c7bec3f70a2a1a0c35a5a33323b4f51?s=128&d=identicon&r=PG&f=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/4405942/gerry"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1523457107, "post_id": 49773387, "comment_id": 86570751, "body": "How did you figure out that the docs are for 2.4? The link indicates 3.4: <a href=\"https://docs.opencv.org/3.4.1/d4/d86/group__imgproc__filter.html#gaabe8c836e97159a9193fb0b11ac52cf1\" rel=\"nofollow noreferrer\">docs.opencv.org/3.4.1/d4/d86/&hellip;</a>"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1523457350, "post_id": 49773387, "comment_id": 86570949, "body": "Because I read it before approving Dmitrii&#39;s edit. | BTW, can you try this with some older release of OpenCV? So far I tried to reproduce it with 3.1.0 which I had on hand, but couldn&#39;t reproduce it. It might be a regression, or some recent change that didn&#39;t make it to the docs. I interpret the documentation the same way you do, and that just should work (unless I&#39;m also missing something :D )."}, {"owner": {"reputation": 2089, "user_id": 4766168, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xrRVf1o5oQk/AAAAAAAAAAI/AAAAAAAAAEk/Uu9PgLhfHwA/photo.jpg?sz=128", "display_name": "Dmitrii Z.", "link": "https://stackoverflow.com/users/4766168/dmitrii-z"}, "edited": false, "score": 1, "creation_date": 1523457958, "post_id": 49773387, "comment_id": 86571389, "body": "By the look of <a href=\"https://github.com/opencv/opencv/blob/master/modules/imgproc/src/smooth.cpp#L3171\" rel=\"nofollow noreferrer\">source code</a> Gerry&#39;s code should work. Could it be some unstable build? Try to install opencv from stable channel"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "reply_to_user": {"reputation": 2089, "user_id": 4766168, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xrRVf1o5oQk/AAAAAAAAAAI/AAAAAAAAAEk/Uu9PgLhfHwA/photo.jpg?sz=128", "display_name": "Dmitrii Z.", "link": "https://stackoverflow.com/users/4766168/dmitrii-z"}, "edited": false, "score": 0, "creation_date": 1523458198, "post_id": 49773387, "comment_id": 86571594, "body": "@DmitriiZ. Yeah, I was just looking through that as well, than part hasn&#39;t changed in 8 years... Quite odd."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12397559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDFhjeHYrOPmm2xkc9nkVehkENGcvI_x8nmB7vCtw=k-s128", "display_name": "Nishikanth Vellore", "link": "https://stackoverflow.com/users/12397559/nishikanth-vellore"}, "is_accepted": false, "score": 0, "last_activity_date": 1574664522, "creation_date": 1574664522, "answer_id": 59026540, "question_id": 49773387, "link": "https://stackoverflow.com/questions/49773387/opencv-gaussianblur-kernel-size-0/59026540#59026540", "title": "OpenCV GaussianBlur kernel size 0", "body": "<p>You cannot make the Kernel Size zero. You can make the sigma values as zero. That is why the assertion has failed.</p>\n\n<p>It also important to note that the dimensions of the Kernel should be strictly be odd numbers. </p>\n"}, {"tags": [], "owner": {"reputation": 846, "user_id": 7200084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3f015adb015ff957d7924beb4be217?s=128&d=identicon&r=PG&f=1", "display_name": "f4f", "link": "https://stackoverflow.com/users/7200084/f4f"}, "is_accepted": false, "score": 0, "last_activity_date": 1574676552, "creation_date": 1574676552, "answer_id": 59029412, "question_id": 49773387, "link": "https://stackoverflow.com/questions/49773387/opencv-gaussianblur-kernel-size-0/59029412#59029412", "title": "OpenCV GaussianBlur kernel size 0", "body": "<p>You can call <code>cv::GaussianBlur(...)</code> with your kernel in this case <strong>kernel size</strong> in both dimensions must be <strong>odd</strong>: <code>kernel.width % 2 == 1 &amp;&amp; kernel.height % 2 == 1</code>.</p>\n\n<p>Or you can leave kernel size unset and provide <em>positive sigma values</em> (<code>sigma1</code> must be set, <code>sigma2</code> will be set equal to it by default). If so kernel is computed like:</p>\n\n<pre><code>template &lt;typename T&gt;\nstatic void createGaussianKernels( T &amp; kx, T &amp; ky, int type, Size &amp;ksize,\n                               double sigma1, double sigma2 )\n{\nint depth = CV_MAT_DEPTH(type);\nif( sigma2 &lt;= 0 )\n    sigma2 = sigma1;\n\n// automatic detection of kernel size from sigma\nif( ksize.width &lt;= 0 &amp;&amp; sigma1 &gt; 0 )\n    ksize.width = cvRound(sigma1*(depth == CV_8U ? 3 : 4)*2 + 1)|1;\nif( ksize.height &lt;= 0 &amp;&amp; sigma2 &gt; 0 )\n    ksize.height = cvRound(sigma2*(depth == CV_8U ? 3 : 4)*2 + 1)|1;\n\nCV_Assert( ksize.width  &gt; 0 &amp;&amp; ksize.width  % 2 == 1 &amp;&amp;\n           ksize.height &gt; 0 &amp;&amp; ksize.height % 2 == 1 );\n...\n...\n}\n</code></pre>\n\n<p>This is from OpenCV 4.1.1 sources. So your code looks pretty valid. I compiled it and it ran without assertion, like it was expected.\nCheck which version of lib do you use, but that is the very basic functional it hardly was changed recently.</p>\n\n<p>You can also try to provide both <code>sigma1</code> and <code>sigma2</code> (and use double values to avoid implicit type conversions):</p>\n\n<pre><code>double sigmaX = 1.;\ndouble sigmaY = 1.;\ncv::GaussianBlur(input, smooth, cv::Size(0, 0), sigmaX, sigmaY);\n</code></pre>\n"}], "owner": {"reputation": 1378, "user_id": 4405942, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c7bec3f70a2a1a0c35a5a33323b4f51?s=128&d=identicon&r=PG&f=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/4405942/gerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 921, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574676552, "creation_date": 1523444583, "last_edit_date": 1523455174, "question_id": 49773387, "link": "https://stackoverflow.com/questions/49773387/opencv-gaussianblur-kernel-size-0", "title": "OpenCV GaussianBlur kernel size 0", "body": "<p>As stated in the <a href=\"https://docs.opencv.org/3.4.1/d4/d86/group__imgproc__filter.html#gaabe8c836e97159a9193fb0b11ac52cf1\" rel=\"nofollow noreferrer\">opencv docs</a>, </p>\n\n<blockquote>\n  <p>ksize \u2013 Gaussian kernel size. ksize.width and ksize.height can differ but they both must be positive and odd. Or, they can be zero\u2019s and then they are computed from sigma* .</p>\n</blockquote>\n\n<p>I tried setting kernel size to 0:</p>\n\n<pre><code>Mat input = imread(inputImagePath, IMREAD_COLOR);\nMat smooth;\nint sigma=1;\nGaussianBlur(input, smooth, Size(0, 0), sigma);\n</code></pre>\n\n<p>Which resulted in:</p>\n\n<pre><code>OpenCV(3.4.1) Error: Assertion failed (ksize.width &gt; 0 &amp;&amp; ksize.width % 2 == 1 &amp;&amp; ksize.height &gt; 0 &amp;&amp; ksize.height % 2 == 1) in createGaussianKernels\n</code></pre>\n\n<p>It works with <code>Size(3, 3)</code>. Where am I wrong? Thank you.</p>\n"}, {"tags": ["c++", "linux", "signals", "boost-process"], "answers": [{"comments": [{"owner": {"reputation": 12965, "user_id": 245416, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2dd35668d8f2c8931d75793fc3a52cf6?s=128&d=identicon&r=PG", "display_name": "Abruzzo Forte e Gentile", "link": "https://stackoverflow.com/users/245416/abruzzo-forte-e-gentile"}, "edited": false, "score": 0, "creation_date": 1523532635, "post_id": 49775486, "comment_id": 86604992, "body": "thanks for your response. In true  I have 2 issue. The first is that. I want my app to exit on a command received via pipe, so probably in that signal handler I should not call std::exit. The second one, which is the bigger, is the that I am using linux &#39;poll&#39; to read from console. If I do like you say the &#39;polling&#39;, which is supposed to read the STOP command, returns on signal and doesn&#39;t do the read.  What can I do for this case? Do you think that signal masking could be an option? I never used them but I understood that prevents the signal to be completely ignored."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 1, "last_activity_date": 1523450547, "creation_date": 1523450547, "answer_id": 49775486, "question_id": 49773319, "link": "https://stackoverflow.com/questions/49773319/signal-propagation-from-boostprocess-to-boostchild/49775486#49775486", "title": "signal propagation from boost::process to boost::child", "body": "<blockquote>\n  <p>Is this signal propagation the normal behavior?</p>\n</blockquote>\n\n<p>It's not propagation per se, it's that when you type <kbd>Ctrl</kbd>+<kbd>C</kbd> in a POSIX terminal, the <code>SIGINT</code> signal is broadcast to <em>all processes</em> of the terminal's <em>foreground process group</em>. Process groups are managed by the shell and by default forked processed remain in the group of the parent (<a href=\"https://stackoverflow.com/questions/6108953/how-does-ctrl-c-terminate-a-child-process\">source</a>).</p>\n\n<blockquote>\n  <p>What I can do to prevent this to happen so that I can issue my command via pipe without interference?</p>\n</blockquote>\n\n<p>Intercept <code>SIGINT</code> in the child and perform the necessary cleanup:</p>\n\n<pre><code>#include &lt;boost/asio/signal_set.hpp&gt;\n#include &lt;iostream&gt;\n\nvoid exit_handler(const boost::system::error_code&amp;, int signal_number)\n{\n  std::cerr &lt;&lt; \"Signal \" &lt;&lt; signal_number &lt;&lt; \"!\\n\";\n  exit(1);\n}\n\nint main()\n{\n  boost::asio::io_service io_service;\n\n  boost::asio::signal_set signals(io_service, SIGINT);\n\n  signals.async_wait( exit_handler );\n\n  io_service.run();\n}\n</code></pre>\n\n<p>It's probably a good idea to think about other signals as well (<code>HUP</code>, <code>TERM</code>).</p>\n"}], "owner": {"reputation": 12965, "user_id": 245416, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2dd35668d8f2c8931d75793fc3a52cf6?s=128&d=identicon&r=PG", "display_name": "Abruzzo Forte e Gentile", "link": "https://stackoverflow.com/users/245416/abruzzo-forte-e-gentile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1523450547, "creation_date": 1523444370, "question_id": 49773319, "link": "https://stackoverflow.com/questions/49773319/signal-propagation-from-boostprocess-to-boostchild", "title": "signal propagation from boost::process to boost::child", "body": "<p>I am using <code>boost::process</code> v. 1.65.1 in a master application for Linux to create few <code>boost::process::child</code> objects and manage data exchanged via <code>boost::process::std_in</code> and <code>boost::process::std_out</code> i.e. pipes.    </p>\n\n<p>When my master application receives a CTRL-C sent by console, I see that the child as well do receive  a CTRL-C signal.  </p>\n\n<p>To terminate my child I'd prefer to send a clear command via pipe, but when I do this the signal has been propagated already. Actually Some child sees the command other do not and see the signal.</p>\n\n<ol>\n<li>Is this signal propagation the normal behavior?</li>\n<li>What I can do to prevent this to happen so that I can issue my command via pipe without interference? </li>\n</ol>\n"}, {"tags": ["c++", "qt", "qpixmap"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1523445232, "post_id": 49773270, "comment_id": 86562014, "body": "Do you know this?: <a href=\"http://blog.qt.io/blog/2009/12/16/qt-graphics-and-performance-an-overview/\" rel=\"nofollow noreferrer\">Qt Graphics and Performance \u2013 An Overview</a>. Depending on how the images are composited, <i>may be</i>, <code>QImage</code> may provide benefit with conversion to <code>QPixmap</code> as late as possible. Hard to say without more details."}, {"owner": {"reputation": 1603, "user_id": 6048373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d610d6bb4ae631578ec03de40ae8f8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Vishaal Shankar", "link": "https://stackoverflow.com/users/6048373/vishaal-shankar"}, "edited": false, "score": 0, "creation_date": 1523445294, "post_id": 49773270, "comment_id": 86562060, "body": "Just off the top of my head, probably <code>omp parallel</code> could help ?"}, {"owner": {"reputation": 4254, "user_id": 46478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e44debd67415e7aa7759c83b829be6a?s=128&d=identicon&r=PG", "display_name": "OJW", "link": "https://stackoverflow.com/users/46478/ojw"}, "edited": false, "score": 0, "creation_date": 1523464064, "post_id": 49773270, "comment_id": 86575750, "body": "&quot;Qt Graphics and Performance&quot; mentions that QPixmaps are a pool of OpenGL Frame Buffer Objects, which explains why they&#39;re faster than CPU-based QImage."}], "answers": [{"comments": [{"owner": {"reputation": 4254, "user_id": 46478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e44debd67415e7aa7759c83b829be6a?s=128&d=identicon&r=PG", "display_name": "OJW", "link": "https://stackoverflow.com/users/46478/ojw"}, "edited": false, "score": 0, "creation_date": 1523445536, "post_id": 49773684, "comment_id": 86562232, "body": "Using QImage instead of QPixmap increased the time taken by a factor of 10."}, {"owner": {"reputation": 1638, "user_id": 1037293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ycPs2.jpg?s=128&g=1", "display_name": "Andrii", "link": "https://stackoverflow.com/users/1037293/andrii"}, "reply_to_user": {"reputation": 4254, "user_id": 46478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e44debd67415e7aa7759c83b829be6a?s=128&d=identicon&r=PG", "display_name": "OJW", "link": "https://stackoverflow.com/users/46478/ojw"}, "edited": false, "score": 0, "creation_date": 1523445716, "post_id": 49773684, "comment_id": 86562354, "body": "@OJW Increases the time taken for what?"}, {"owner": {"reputation": 4254, "user_id": 46478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e44debd67415e7aa7759c83b829be6a?s=128&d=identicon&r=PG", "display_name": "OJW", "link": "https://stackoverflow.com/users/46478/ojw"}, "edited": false, "score": 0, "creation_date": 1523446280, "post_id": 49773684, "comment_id": 86562706, "body": "Total time to combine a stack of images using the method above, takes much longer if the images are stored in QImage instead of QPixmap.  (using QPainter::drawImage and QPainter::drawPixmap respectively)"}, {"owner": {"reputation": 1638, "user_id": 1037293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ycPs2.jpg?s=128&g=1", "display_name": "Andrii", "link": "https://stackoverflow.com/users/1037293/andrii"}, "reply_to_user": {"reputation": 4254, "user_id": 46478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e44debd67415e7aa7759c83b829be6a?s=128&d=identicon&r=PG", "display_name": "OJW", "link": "https://stackoverflow.com/users/46478/ojw"}, "edited": false, "score": 0, "creation_date": 1523450228, "post_id": 49773684, "comment_id": 86565475, "body": "@OJW &quot;2-10ms for a maximised window&quot; - does it mean that a displaying is slow, not a composing?"}, {"owner": {"reputation": 4254, "user_id": 46478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e44debd67415e7aa7759c83b829be6a?s=128&d=identicon&r=PG", "display_name": "OJW", "link": "https://stackoverflow.com/users/46478/ojw"}, "edited": false, "score": 0, "creation_date": 1523450412, "post_id": 49773684, "comment_id": 86565601, "body": "2-10ms measurement doesn&#39;t include displaying the final image on screen."}], "tags": [], "owner": {"reputation": 1638, "user_id": 1037293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ycPs2.jpg?s=128&g=1", "display_name": "Andrii", "link": "https://stackoverflow.com/users/1037293/andrii"}, "is_accepted": false, "score": 0, "last_activity_date": 1523445378, "creation_date": 1523445378, "answer_id": 49773684, "question_id": 49773270, "link": "https://stackoverflow.com/questions/49773270/qpixmap-copy-speed/49773684#49773684", "title": "QPixmap copy speed", "body": "<p>Qt documentation <a href=\"http://doc.qt.io/qt-5/qpixmap.html#details\" rel=\"nofollow noreferrer\">says</a>:</p>\n\n<blockquote>\n  <p>QImage is designed and optimized for I/O, and for <strong>direct pixel access and manipulation</strong>, while QPixmap is designed and optimized for <strong>showing images on screen</strong>.</p>\n</blockquote>\n\n<p>So the proper way is to complete all composition manipulations with QImages and then, if you are going to display/repaint the result multiple times, it would be better to convert a resulting QImage to a QPixmap before it rendered.</p>\n"}], "owner": {"reputation": 4254, "user_id": 46478, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e44debd67415e7aa7759c83b829be6a?s=128&d=identicon&r=PG", "display_name": "OJW", "link": "https://stackoverflow.com/users/46478/ojw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523445378, "creation_date": 1523444224, "question_id": 49773270, "link": "https://stackoverflow.com/questions/49773270/qpixmap-copy-speed", "title": "QPixmap copy speed", "body": "<p>Compositing multiple images into one using Qt's QPixmap as the storage:</p>\n\n<pre><code>QPainter painter(&amp;destinationPixmap);\npainter.drawPixmap(0, 0, sourcePixmap);\n</code></pre>\n\n<p>This seems to be quite slow (2-10ms for a maximised window on typical monitor) - any way to do it quicker without changing to completely different technology?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1523443670, "post_id": 49773013, "comment_id": 86560967, "body": "This text somehow states that exception = programmer error = crash. Also use of <code>noexcept</code> is equivalent to wrapping function body into <code>try</code>...<code>catch</code> block cataching any exceptions and calling <code>std::terminate</code>. So <code>noexcept</code> does not really ensure that there is no exceptions."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1523443730, "post_id": 49773013, "comment_id": 86561024, "body": "Just because something has raised an exception - doesn&#39;t mean it should crash.  It just means something &quot;exceptional&quot; has happened.  For example an <code>IOBlockException</code> (like in Java) means that that there&#39;s no data available .... and if it&#39;s not caught then THAT is the error"}, {"owner": {"reputation": 11267, "user_id": 903651, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3dda4f66a2b7cc9fdced12a0fbede58?s=128&d=identicon&r=PG", "display_name": "Adrian Maire", "link": "https://stackoverflow.com/users/903651/adrian-maire"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1523443883, "post_id": 49773013, "comment_id": 86561115, "body": "@UKMonkey In embedded, you usually don&#39;t want exceptional situation to happen: It is another flow of execution to test and certify, and it is especially difficult to test (because exceptions are not structured programming)."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1523443973, "post_id": 49773013, "comment_id": 86561171, "body": "<code>Usage of noexcept specifier can significantly reduce the size of binary files and increase performance</code>  You&#39;ll find that it might impact the size of the binary; but there&#39;s no change in performance."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 11267, "user_id": 903651, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3dda4f66a2b7cc9fdced12a0fbede58?s=128&d=identicon&r=PG", "display_name": "Adrian Maire", "link": "https://stackoverflow.com/users/903651/adrian-maire"}, "edited": false, "score": 0, "creation_date": 1523444147, "post_id": 49773013, "comment_id": 86561276, "body": "@AdrianMaire &quot;test and certify&quot; just because it&#39;s embedded doesn&#39;t mean it needs to be certified; just because it&#39;s not embedded doesn&#39;t mean it doesn&#39;t need to be certified.  Exception raising can easily be tested with test objects in the same way you would test non-exception raising."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1523444176, "post_id": 49773013, "comment_id": 86561288, "body": "&quot;<i>Usage of noexcept specifier can significantly reduce the size of binary files and increase performance.</i>&quot; - do you have a source for the latter? I am no embedded expert, but I don&#39;t think there is much performance lost, especially in no-exceptional flow. Unless some predictors/program caches are thrown off by extra code. But I&#39;ve seen no measurements."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1523445267, "post_id": 49773013, "comment_id": 86562045, "body": "@VTT, a <code>try-catch</code> block that calls <code>terminate</code> requires stack unwinding to happen before the exception is caught, which requires running any destructors with side-effects. When an exception would exit from a <code>noexcept</code> function the compiler is allowed <i>but not required</i> to do any stack unwinding. It can just terminate instead of unwinding to the catch point. So the two cases are not exactly equivalent (and one can produce smaller faster code)."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1523445435, "post_id": 49773013, "comment_id": 86562164, "body": "@JonathanWakely That is why I wrote &quot;equivalent&quot; and not just &quot;equal&quot; or &quot;the same&quot;."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1523445570, "post_id": 49773013, "comment_id": 86562254, "body": "@VTT and my comment says &quot;not exactly equivalent&quot;, so other readers won&#39;t mistakenly think that&#39;s what you meant. In normal English equivalent and equal and identical can be used as synonyms."}], "answers": [{"comments": [{"owner": {"reputation": 1089, "user_id": 5299433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2dc842e32992ec3c0d8cd694c26afb70?s=128&d=identicon&r=PG&f=1", "display_name": "Smit Ycyken", "link": "https://stackoverflow.com/users/5299433/smit-ycyken"}, "edited": false, "score": 0, "creation_date": 1523444490, "post_id": 49773195, "comment_id": 86561506, "body": "So, is it preferable to use compiler flag when there is no need to handle exceptions?"}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 1089, "user_id": 5299433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2dc842e32992ec3c0d8cd694c26afb70?s=128&d=identicon&r=PG&f=1", "display_name": "Smit Ycyken", "link": "https://stackoverflow.com/users/5299433/smit-ycyken"}, "edited": false, "score": 0, "creation_date": 1523445414, "post_id": 49773195, "comment_id": 86562148, "body": "If you don&#39;t want to deal with exceptions then yes, tell the compiler you don&#39;t want to use exceptions (and make sure any libraries you&#39;re using will do something else instead of throwing, like abort). It seems obviously better to do that than to still allow exceptions to be thrown and then editing every single function in your code base to terminate."}], "tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": true, "score": 6, "last_activity_date": 1523444005, "creation_date": 1523444005, "answer_id": 49773195, "question_id": 49773013, "link": "https://stackoverflow.com/questions/49773013/using-noexcept-and-compiler-flags-that-turn-off-exceptions/49773195#49773195", "title": "Using noexcept and compiler flags that turn off exceptions", "body": "<blockquote>\n  <p>In this way, every stl function inside a function with <code>noexcept</code> will call <code>noexcept</code> overload if it is available.</p>\n</blockquote>\n\n<p>No, because you can't overload on <code>noexcept</code>. Marking a function with <code>noexcept</code> doesn't affect overload resolution of functions it calls.</p>\n\n<p>The size reduction from marking a function <code>noexcept</code> is because the compiler doesn't need to emit code for stack unwinding and exception handling, it can just terminate. But if you use <code>-fno-exceptions</code> the compiler also doesn't have to emit code for stack unwinding and exception handling, so you should get the same benefits (without needing to add <code>noexcept</code> anywhere).</p>\n\n<blockquote>\n  <p>Are there any good practices how to use <code>noexcept</code> specifier or flags, in the case where it is necessary to upgrade legacy code (before c++11), increase performance and reduce size of binaries?</p>\n</blockquote>\n\n<p>Good practice is to only add <code>noexcept</code> to functions that you know <em>definitely</em> can't throw, and which will never be changed to throw, <em>or</em> if you definitely want them to call <code>std::terminate</code> if an exception does happen.</p>\n\n<p>That doesn't mean adding it to every function.</p>\n\n<p>It also doesn't mean adding it to virtual functions carelessly. Doing so changes the contract of the base class, and requires all overrides to be updated.</p>\n"}], "owner": {"reputation": 1089, "user_id": 5299433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2dc842e32992ec3c0d8cd694c26afb70?s=128&d=identicon&r=PG&f=1", "display_name": "Smit Ycyken", "link": "https://stackoverflow.com/users/5299433/smit-ycyken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1178, "favorite_count": 0, "accepted_answer_id": 49773195, "answer_count": 1, "score": 2, "last_activity_date": 1523444005, "creation_date": 1523443427, "last_edit_date": 1592644375, "question_id": 49773013, "link": "https://stackoverflow.com/questions/49773013/using-noexcept-and-compiler-flags-that-turn-off-exceptions", "title": "Using noexcept and compiler flags that turn off exceptions", "body": "<h3>introduction</h3>\n<p>In embedded c++, and especially in real-time systems there is no need to handle exceptions and if a system is going to crash, in common practice, we let it crash. Every crash is a programmer error, that must be fixed. So there is no need to handle exceptions in a release.</p>\n<h3>problem</h3>\n<p>Usage of <code>noexcept</code> specifier can significantly reduce the size of binary files and increase performance. In this way, every <code>stl</code> function inside a function with <code>noexcept</code> will call noexcept overload if it is available. But usage of this specifier is restrictive and has a lot of limitations(inheritance, virtual functions signature, compatibility). If you modify source without proper integration, there will be errors like <code>looser throw specifier for...</code>.</p>\n<p>No exception flag(like g++ <code>-fno-exceptions</code>) only replace all <code>throw</code> for <code>abort</code> and may reduce some stack size.</p>\n<h3>question</h3>\n<p>Are there any good practices how to use <code>noexcept</code> specifier or flags, in the case where it is necessary to upgrade legacy code (before c++11), increase performance and reduce size of binaries? For now, I can see only one way - add <code>noexcept</code> to every function.</p>\n<p>compilers(arm-none-eabi-g++, C++ compiler MSVC), c++14</p>\n"}, {"tags": ["c++", "c++11", "static-cast", "narrowing", "multibyte-characters"], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1523444162, "creation_date": 1523444162, "answer_id": 49773241, "question_id": 49772935, "link": "https://stackoverflow.com/questions/49772935/how-does-multi-byte-char-377777-work/49773241#49773241", "title": "How does multi-byte char &#39;\\377777&#39; work?", "body": "<p>The behaviour on using more than 3 digits with an octal constant specified by <code>\\</code> and enclosed in single quotation characters is not defined by the C++ standard. (Interestingly, you can define multicharacter constants using more than 2 hexadecimal digits, or even notation like <code>'ab'</code> but the value of the <code>int</code> you get is <em>implementation</em> defined.)</p>\n\n<p>Consult your compiler documentation for the treatment of a longer octal constant.</p>\n"}], "owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523444162, "creation_date": 1523443215, "question_id": 49772935, "link": "https://stackoverflow.com/questions/49772935/how-does-multi-byte-char-377777-work", "title": "How does multi-byte char &#39;\\377777&#39; work?", "body": "<p>Clang mentioned this thingy to me when I was trying some various non-std ways to find <code>std::numeric_limits&lt;size_t&gt;::max()</code> for my <code>allocator::max_size()</code></p>\n\n<p>The expression size seems limited at 4 bytes so it looks pretty much like an impl-defined multi-byte char but I don't know how it works exactly.</p>\n\n<pre><code>printf(\"0x%016hhX\\n\", '\\377');     // 0x00000000000000FF\nprintf(\"0x%016X  \\n\", '\\3777');    // 0x000000000000FF37\nprintf(\"0x%016X  \\n\", '\\37777');   // 0x0000000000FF3737\nprintf(\"0x%016X  \\n\", '\\377777');  // 0x00000000FF373737 [-Wfour-char-constants]\nprintf(\"0x%016X  \\n\", '\\3777777'); // 0x0000000037373737 [ too long ]\nprintf(\"0x%016X  \\n\", '\\3777777'); // 0x0000000037373737 [ too long ]\n</code></pre>\n\n<p>Line 2 - 4 all seem return int but only 4th line warn of <code>-Wfour-char-constants</code> if turn on <code>-Weveryting</code>. Why does 4-byte char have to warn its user?</p>\n\n<p>Please explain how it works. Does it have any colloquial or probably normative term?</p>\n\n<p><a href=\"https://godbolt.org/g/7AR9nw\" rel=\"nofollow noreferrer\">godbolt.org/g/7AR9nw</a></p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 538, "user_id": 9564168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arkady Godlin", "link": "https://stackoverflow.com/users/9564168/arkady-godlin"}, "edited": false, "score": 0, "creation_date": 1523441857, "post_id": 49772390, "comment_id": 86559769, "body": "use comments in code and not * before code, as * is having some meaning in c++"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1523441895, "post_id": 49772390, "comment_id": 86559790, "body": "Not <i>as</i>, but <i>in</i>. You can have a bag which contains other bags."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1523443013, "post_id": 49772390, "comment_id": 86560508, "body": "<code>tempNs</code> is not the same object as <code>nVals</code>. <code>nVals</code>&#39;s elements are copies of <code>tempN</code>."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1523443016, "post_id": 49772390, "comment_id": 86560509, "body": "A <code>vector&lt;vector&lt;long&gt; &gt;</code> has elements of type <code>vector&lt;long&gt;</code>.   A vector&#39;s <code>push_back()</code> method copies an element to the vector.  <code>par.nValues</code> is of type <code>vector&lt;vector&lt;long&gt; &gt;</code> so pushing <code>tempNS</code> - which is of type <code>vector&lt;long&gt;</code> is completely appropriate."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1523443038, "post_id": 49772390, "comment_id": 86560518, "body": "<code>vector&lt;vector&lt;long int&gt; &gt;  nVals;</code> &lt;-- it is <i>defined</i> to accept vectors. The code puts vectors into it using <code>nVals.push_back(tempN)</code>. <code>tempN</code> is a vector."}, {"owner": {"reputation": 147, "user_id": 3727079, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3aea2b733f78d941764f41da169f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Allure", "link": "https://stackoverflow.com/users/3727079/allure"}, "edited": false, "score": 0, "creation_date": 1523444081, "post_id": 49772390, "comment_id": 86561238, "body": "Thanks for answers, it makes sense now. To confirm: suppose tempNs[5] = 2, and it is the third vector that&#39;s stored in nVals. Does this mean that nVals [3][5] = 2?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1523444619, "post_id": 49772390, "comment_id": 86561586, "body": "No, it means <code>nVals[2][5] = 2</code>.  The first element of a vector is index zero, not one."}, {"owner": {"reputation": 147, "user_id": 3727079, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3aea2b733f78d941764f41da169f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Allure", "link": "https://stackoverflow.com/users/3727079/allure"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1523444927, "post_id": 49772390, "comment_id": 86561804, "body": "@Peter suggest writing that as an answer, since it solves my question =)"}], "answers": [{"tags": [], "owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "is_accepted": false, "score": 1, "last_activity_date": 1523442747, "creation_date": 1523442747, "answer_id": 49772771, "question_id": 49772390, "link": "https://stackoverflow.com/questions/49772390/code-stores-a-vector-as-a-vectorvector-why-no-error-message/49772771#49772771", "title": "Code stores a vector as a vector&lt;vector&gt;, why no error message?", "body": "<p>There is no problem in using a vector of vectors of longs.\nIts almost the same as using a two-dimensional array, but you don't need to know the size at compile time or manage memory allocation.</p>\n\n<p>There is no problem for compiling that code. Vector elements can be primitives(int, float, double), pointers or other objects(like vector or your user-defined classes).</p>\n"}, {"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 1, "last_activity_date": 1523443533, "creation_date": 1523443533, "answer_id": 49773047, "question_id": 49772390, "link": "https://stackoverflow.com/questions/49772390/code-stores-a-vector-as-a-vectorvector-why-no-error-message/49773047#49773047", "title": "Code stores a vector as a vector&lt;vector&gt;, why no error message?", "body": "<p>The constraints on the (first) type parameter of <code>std::vector</code> are fairly lax. Almost any non-reference type can be stored in a <code>std::vector</code>, including <code>std::vector</code>s of something else. This is exactly what this code is doing.</p>\n\n<p>You could wrap <code>std::vector&lt;long int&gt;</code> in a </p>\n\n<pre><code>struct partition { \n    std::vector&lt;long int&gt; indexes; \n    double lambda; \n    double alpha; \n}; \n</code></pre>\n\n<p>and change <code>potentialPars</code> to</p>\n\n<pre><code>struct potentialPartitions {\n    int nMaximum;\n    int fNum;\n    std::vector&lt;partition&gt; partitions;\n};\n</code></pre>\n\n<p>which would add clarity, but would change how the consumer of <code>potentialPartitions</code> accesses those values. </p>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1523491611, "last_edit_date": 1523491611, "creation_date": 1523452113, "answer_id": 49775986, "question_id": 49772390, "link": "https://stackoverflow.com/questions/49772390/code-stores-a-vector-as-a-vectorvector-why-no-error-message/49775986#49775986", "title": "Code stores a vector as a vector&lt;vector&gt;, why no error message?", "body": "<p>A <code>vector&lt;vector&lt;long&gt; &gt;</code> has elements of type <code>vector&lt;long&gt;</code>.</p>\n\n<p>A <code>vector</code>s <code>push_back()</code> method copies an element to the vector.</p>\n\n<p>In code you've shown, <code>par.nValues</code> is of type <code>vector&lt;vector&lt;long&gt; &gt;</code> so pushing <code>tempNS</code> - which is of type <code>vector&lt;long&gt;</code> - is completely appropriate.</p>\n"}], "owner": {"reputation": 147, "user_id": 3727079, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3aea2b733f78d941764f41da169f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Allure", "link": "https://stackoverflow.com/users/3727079/allure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 49775986, "answer_count": 3, "score": -2, "last_activity_date": 1523491611, "creation_date": 1523441669, "last_edit_date": 1523442184, "question_id": 49772390, "link": "https://stackoverflow.com/questions/49772390/code-stores-a-vector-as-a-vectorvector-why-no-error-message", "title": "Code stores a vector as a vector&lt;vector&gt;, why no error message?", "body": "<p>I'm working on a piece of C++ code left by a predecessor, and it apparently stores a <code>vector&lt;long int&gt;</code> as a <code>vector&lt;vector&lt;long int&gt;&gt;</code>. The code compiles and runs, but I don't understand why. Here's the function that does the storing.</p>\n\n<pre><code>void setPotentialParameters(const int&amp; seed, const int&amp; nMax, const double&amp; lambdaStd, const int fieldNum, potentialPars&amp; par)\n{\n    gsl_rng * r = gsl_rng_alloc (gsl_rng_taus);\n    gsl_rng_set (r, seed);\n    par.nMaximum= nMax;\n    par.fNum= fieldNum;\n    for (int i=0; i&lt;100; i++) gsl_ran_gaussian (r, lambdaStd);\n    int counter=0;\n    vector&lt;long int&gt; tempNs(fieldNum); //Defines tempNs as a vector&lt;long int&gt;\n    for (long int i=0; i&lt; (-0.2+pow(2*nMax+1, fieldNum)); i++) { \n        findPartition(i, fieldNum, 2*nMax+1, tempNs ); \n        for (int i = 0; i &lt; tempNs.size(); i++) {\n            tempNs[i] -= nMax;\n        }\n        if (goodPartition(tempNs, nMax)) {\n            counter++;\n            par.lambdas.push_back(abs( gsl_ran_gaussian (r, lambdaStd))); \n            par.nVals.push_back(tempNs); //Stores tempNs in nVals\n            par.alphas.push_back(2*M_PI * gsl_rng_uniform (r));\n        };\n    };\n};\n</code></pre>\n\n<p>And this is the struct that tempNs is stored in.</p>\n\n<pre><code>struct potentialPars{\n    int nMaximum;\n    int fNum;\n    vector&lt;double&gt; lambdas;\n    vector&lt;vector&lt;long int&gt; &gt;  nVals; //Defines nVals as a vector&lt;vector&lt;long int&gt;&gt;\n    vector&lt;double&gt; alphas;\n};\n</code></pre>\n\n<p>I marked the three most relevant lines with comments. tempNs only has one element (as seen from the <code>tempNs[i] -= nMax</code> line), consistent with its definition as a <code>vector&lt;long int&gt;</code> but when nVals is called elsewhere in the program it has two elements, also consistent with its definition as a <code>vector&lt;vector&lt;long int&gt;&gt;</code>. It doesn't seem possible. Even though tempNs is modified by the findPartition function, it should still remain a vector of long integers. What am I missing?</p>\n"}, {"tags": ["c++", "templates", "functional-programming"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1523441202, "post_id": 49772134, "comment_id": 86559336, "body": "Your template needs two different comparator template parameters one for <code>comp</code> and another for <code>comp_equal</code>. Although there is no need for two comparators at all since it is possible to figure out equality just from <code>comp</code>."}, {"owner": {"reputation": 341, "user_id": 7207527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1814914645459557/picture?type=large", "display_name": "Moises Rojo", "link": "https://stackoverflow.com/users/7207527/moises-rojo"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1523442807, "post_id": 49772134, "comment_id": 86560384, "body": "How? You can&#39;t use !comp"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 4, "creation_date": 1523443479, "post_id": 49772134, "comment_id": 86560796, "body": "<code>!((a &lt; b) || (b &lt; a))</code>"}, {"owner": {"reputation": 341, "user_id": 7207527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1814914645459557/picture?type=large", "display_name": "Moises Rojo", "link": "https://stackoverflow.com/users/7207527/moises-rojo"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1523445421, "post_id": 49772134, "comment_id": 86562154, "body": "Yeah! I change it, <code>if( comp( *first, *limit.front() ) )</code> <code>else if( !comp( *limit.front(), *first ) )</code>, it the same that <code>!((a &lt; b) || (b &lt; a))</code>, because by De Morgan<code>(!(a &lt; b) &amp;&amp; !(b &lt; a))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 7207527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1814914645459557/picture?type=large", "display_name": "Moises Rojo", "link": "https://stackoverflow.com/users/7207527/moises-rojo"}, "edited": false, "score": 0, "creation_date": 1523445586, "post_id": 49773307, "comment_id": 86562263, "body": "Yeah. Se the comment above, I change the last if, but without using <code>!((a&lt;b) || (b&lt;a))</code>"}, {"owner": {"reputation": 341, "user_id": 7207527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1814914645459557/picture?type=large", "display_name": "Moises Rojo", "link": "https://stackoverflow.com/users/7207527/moises-rojo"}, "edited": false, "score": 0, "creation_date": 1523445684, "post_id": 49773307, "comment_id": 86562330, "body": "Why are different types,  are not both functors? that is... the same type."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "reply_to_user": {"reputation": 341, "user_id": 7207527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1814914645459557/picture?type=large", "display_name": "Moises Rojo", "link": "https://stackoverflow.com/users/7207527/moises-rojo"}, "edited": false, "score": 0, "creation_date": 1523451486, "post_id": 49773307, "comment_id": 86566467, "body": "I&#39;m having a hard time telling whether you actually know what a type is. &quot;Functor&quot; is an concept that applies to any type with the right interface - more like a typeclass than a concrete type."}], "tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 3, "last_activity_date": 1523452807, "last_edit_date": 1592644375, "creation_date": 1523444337, "answer_id": 49773307, "question_id": 49772134, "link": "https://stackoverflow.com/questions/49772134/use-template-of-binary-predicate-function-as-parameter-stdgreater-stdequal/49773307#49773307", "title": "Use Template of binary predicate function as parameter (std::greater, std::equal_to ) C++", "body": "<pre><code>deduced conflicting types for parameter \u2018Compare\u2019\n</code></pre>\n<p>This is because <code>std::greater&lt;T&gt;</code> and <code>std::equal_to&lt;T&gt;</code> are different types. They're not functions of the form <code>bool (*)(T,T)</code>, but functors.</p>\n<p>Your first and last iterators on the other hand, are two different instances of the same type.</p>\n<p>And, as VTT says, you don't need two comparitors anyway; assuming comp is a sane <code>&lt;</code>,</p>\n<pre><code>const bool equal = !(comp(a,b) || comp(b,a));\n</code></pre>\n<p>ie, <code>!((a&lt;b) || (b&lt;a))</code> =&gt; <code>((a&gt;=b) &amp;&amp; (b&gt;=a))</code> =&gt; <code>(a==b)</code></p>\n<hr />\n<blockquote>\n<blockquote>\n<p>This is because <code>std::greater&lt;T&gt;</code> and <code>std::equal_to&lt;T&gt;</code> are different types</p>\n</blockquote>\n<p>Why are different types, are not both functors?</p>\n</blockquote>\n<p>The definitions look something like</p>\n<pre><code>template &lt;typename T&gt;\nstruct greater {\n  constexpr bool operator()(const T&amp; lhs, const T&amp; rhs) {\n    return lhs &gt; rhs;\n  }\n};\ntemplate &lt;typename T&gt;\nstruct equal_to {\n  constexpr bool operator()(const T&amp; lhs, const T&amp; rhs) {\n    return lhs == rhs;\n  }\n};\n</code></pre>\n<p>Each <code>struct</code> or <code>class</code> you define is a different type. Each template defines a new type for each distinct instantiation (set of template parameters).</p>\n<p>They're both functors because they both have an <code>operator()</code>.\nMore specifically they're both binary predicates because they both have a function call operator of the form <code>bool operator()(T,T)</code>. But even when you instantiate them both for the same T, one has type <code>greater&lt;T&gt;</code> and the other has type <code>equal_to&lt;T&gt;</code>.</p>\n<p>As I mentioned above, although <code>greater&lt;T&gt;</code> and <code>equal_to&lt;T&gt;</code> are different types, <code>bool (*)(T,T)</code> is a single type (a pointer to a binary predicate nonmember function) which could be used for either:</p>\n<pre><code>template &lt;typename T&gt;\nbool f_greater(T const &amp;lhs, const T&amp; rhs) {\n  return lhs &gt; rhs;\n}\ntemplate &lt;typename T&gt;\nbool f_equal_to(T const &amp;lhs, const T&amp; rhs) {\n  return lhs == rhs;\n}\n\ntypedef bool(*binary_predicate)(int const&amp;, int const&amp;);\nbool greater_or_equal(int a, int b,\n                      binary_predicate g,\n                      binary_predicate e)\n{\n  return g(a,b) || e(a,b);\n}\n\n// ... example use ...\ngreater_or_equal(17, 12, &amp;f_greater&lt;int&gt;, &amp;f_equal_to&lt;int&gt;);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "is_accepted": true, "score": 3, "last_activity_date": 1523448171, "creation_date": 1523448171, "answer_id": 49774633, "question_id": 49772134, "link": "https://stackoverflow.com/questions/49772134/use-template-of-binary-predicate-function-as-parameter-stdgreater-stdequal/49774633#49774633", "title": "Use Template of binary predicate function as parameter (std::greater, std::equal_to ) C++", "body": "<p>The reason you need two different template type parameters for the types of <code>comp</code> and <code>comp_equal</code> is, as VTT stated in a comment, that the types are different.</p>\n\n<p><code>std::greater&lt;uint64_t&gt;</code> and <code>std::equal_to&lt;uint64_t&gt;</code> are not at all the same type.\nThey happen to be templates that have the same parameter, but otherwise they are not related.</p>\n\n<p>You can use one type parameter for the iterator, because <code>first</code> and <code>last</code> have the same type.</p>\n\n<p>You could write your own comparison function objects like this:</p>\n\n<pre><code>struct my_greater {\n    bool operator()(uint32_t a, uint32_t b) {\n        return a &gt; b;\n    }\n};\n</code></pre>\n\n<p>That is roughly how std::greater looks like, except that it is a template where you can select the input type.</p>\n\n<p>Even though the signature of the call operator of std::equal is the same, the compiler must call a different function.</p>\n\n<p>As user Useless wrote in a not at all useless answer, a template parameter is not necessarily a function pointer, which would be compatible as soon as the signatures match.</p>\n\n<p>Because you can use an arbitrary type as comparison operator, there are many useful things that can be done. I will use a minimum function as an example to better show the concepts:</p>\n\n<pre><code>// here I provided a default for the less comparison, \n// so you do not have to write it\n// first we have a default for the type\n// and then we have a default for the actual value\ntemplate &lt;typename T, typename Less = std::less&lt;T&gt;&gt;\nT myMin(T a, T b, Less less=Less{}) {\n   return less(b, a) ? b : a;\n}\n</code></pre>\n\n<p>First of all, if your comparators are simple like std::greater and std::equal, the compiler can inline the <code>operator()</code> and generate optimal code like in the following example:</p>\n\n<pre><code>int min_int(int a, int b) {\n  return myMin(a, b);\n}\n\nint max_int(int a, int b) {\n  return myMin(a, b, std::greater&lt;int&gt;{});\n}\n</code></pre>\n\n<p>gcc generates nice code for this, note how <code>less</code> and <code>greater</code> were inlined:</p>\n\n<pre><code>min_int(int, int):\n  cmp edi, esi\n  mov eax, esi\n  cmovle eax, edi\n  ret\nmax_int(int, int):\n  cmp edi, esi\n  mov eax, esi\n  cmovge eax, edi\n  ret\n</code></pre>\n\n<p>If the type was a function pointer, the compiler could only do this inlining if the outer function itself is inlined and the arguments are compile time constants (unless it is using some rather advanced optimizations).</p>\n\n<p>Note that you could explicitly use a function pointer as the template argument if you really needed to figure out which function to call at runtime.</p>\n\n<pre><code>int pointy_min(int a, int b, bool(*less)(int, int)) {\n    return myMin(a, b, less);    \n}\n</code></pre>\n\n<p>In this example the compiler knows nothing about the less argument and must therefore generate more code for calling the function pointer.</p>\n\n<p>Or you could write function objects with their own state, whatever you want, without compromising the efficiency of the common case at all.</p>\n\n<p>Regarding the equality comparison that you can build from greater or less, note that the compiler is well aware of the meaning of less and greater and De Morgan's rules so it will usually optimize well once it inlines  <code>std::greater::operator()</code>. Just write whatever you find the most obvious and readable, unless you suspect somebody is going to use your template with a heavyweight comparison function.</p>\n\n<pre><code>template&lt;typename T, typename Less = std::less&lt;T&gt;&gt;\nbool myEqual(T a, T b, Less less=Less{}) {\n    return !(less(a,b) || less(b,a));\n}\n\nbool intEqual(int a, int b) {\n    return myEqual(a, b);\n}\n\nbool otherEqual(int a, int b) {\n    return a == b;    \n}\n</code></pre>\n\n<p>See how the compiler figured out the optimal code after inlining:    </p>\n\n<pre><code>intEqual(int, int): # @intEqual(int, int)\n  cmp edi, esi\n  sete al\n  ret\notherEqual(int, int): # @otherEqual(int, int)\n  cmp edi, esi\n  sete al\n  ret\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 7207527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1814914645459557/picture?type=large", "display_name": "Moises Rojo", "link": "https://stackoverflow.com/users/7207527/moises-rojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 0, "accepted_answer_id": 49774633, "answer_count": 2, "score": 1, "last_activity_date": 1523452807, "creation_date": 1523440942, "question_id": 49772134, "link": "https://stackoverflow.com/questions/49772134/use-template-of-binary-predicate-function-as-parameter-stdgreater-stdequal", "title": "Use Template of binary predicate function as parameter (std::greater, std::equal_to ) C++", "body": "<p>Why do I need to use 2 templates, one for each binary predicate, in the definition of a function?</p>\n\n<p>I write a function that is almost the same that or std::min_element or std::max_element, just that instead of return 1 element, return all the positions that are equal to that limit <strong>(or min, or max)</strong></p>\n\n<p>I spend last time reading boost::minmax_element.hpp, and I copy the function and change the output and the while loop to create the function.</p>\n\n<p>And <strong>works if</strong> I use </p>\n\n<pre><code>if( *first &gt; *lim.front() ) \n</code></pre>\n\n<p>But <strong>not If</strong> I use</p>\n\n<pre><code>if( comp(*first, *lim.front()) )\n</code></pre>\n\n<p>Here the function</p>\n\n<pre><code>template &lt;typename INPUT_ITERATOR, class Compare&gt;\nstd::vector&lt;INPUT_ITERATOR&gt;\nbasic_limit_positions( INPUT_ITERATOR first, INPUT_ITERATOR last, Compare comp, Compare comp_equal ) {\n\n  std::vector&lt;INPUT_ITERATOR&gt; lim;\n\n  if ( first == last ) {\n    lim.push_back( last );\n    return lim;\n  }\n\n  lim.push_back(first);\n  while (++first != last) {\n\n    if ( comp( *first, *lim.front() ) ) {\n      lim.clear();\n      lim.push_back( first );\n    }\n    else if ( comp_equal( *first, *lim.front() ) )\n      lim.push_back( first );\n\n  }\n\n  return lim;\n}\n</code></pre>\n\n<p>How I use it:</p>\n\n<pre><code>  std::vector&lt; std::vector&lt;uint64_t&gt;::iterator &gt; it = basic_limit_positions(v.begin(),\n                                                                               v.end(),\n                                                                               std::greater&lt; uint64_t &gt;(),\n                                                                               std::equal_to&lt; uint64_t &gt; ()\n                                                                               );\n</code></pre>\n\n<p>And the error:</p>\n\n<pre><code>test.cpp:40:80: error: no matching function for call to \u2018basic_limit_positions(std::vector&lt;long unsigned int&gt;::iterator, std::vector&lt;long unsigned int&gt;::iterator, std::greater&lt;long unsigned int&gt;, std::equal_to&lt;long unsigned int&gt;)\u2019\n                                                                                );\n                                                                                ^\nIn file included from test.cpp:10:0:\nnewton/algorithm/superior_positions.hpp:7:1: note: candidate: template&lt;class INPUT_ITERATOR, class Compare&gt; std::vector&lt;INPUT_NUMBER&gt; basic_limit_positions(INPUT_ITERATOR, INPUT_ITERATOR, Compare, Compare)\n basic_limit_positions( INPUT_ITERATOR first, INPUT_ITERATOR last, Compare comp, Compare comp_equal ) {\n ^~~~~~~~~~~~~~~~~~~~~\nnewton/algorithm/superior_positions.hpp:7:1: note:   template argument deduction/substitution failed:\ntest.cpp:40:80: note:   deduced conflicting types for parameter \u2018Compare\u2019 (\u2018std::greater&lt;long unsigned int&gt;\u2019 and \u2018std::equal_to&lt;long unsigned int&gt;\u2019)\n                                                                                );\n                                                                                ^\n</code></pre>\n\n<p>So I think: \"the problem is the template because, if <strong>deduced conflicting types for parameter \u2018Compare\u2019</strong>, and the type is correct, the unique remain case is changing template name\"</p>\n\n<pre><code>template &lt;typename INPUT_ITERATOR, class Compare1, class Compare2&gt;\nstd::vector&lt;INPUT_ITERATOR&gt;\nbasic_limit_positions( INPUT_ITERATOR first, INPUT_ITERATOR last, Compare1 comp, Compare2 comp_equal )\n</code></pre>\n\n<p>And... Works, <strong>But \u00bf?</strong> It's the same type, so I use the same template name to <strong>first and last</strong> Why!? can't use the same name to <strong>comp and comp_equal</strong></p>\n\n<p>Really don't have sense to me.</p>\n"}, {"tags": ["c++", "arrays", "header-files"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1523441103, "post_id": 49772131, "comment_id": 86559273, "body": "Please don&#39;t rewrite code into your questions. Copy-paste it instead. If you rewrite, you might, by mistake, add irrelevant errors. Which you have done."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1523441130, "post_id": 49772131, "comment_id": 86559292, "body": "As for your problem, what <i>is</i> <code>iItemPrice</code>? Why do you think you would be able to index it like an array?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1523441610, "post_id": 49772131, "comment_id": 86559613, "body": "And regarding &quot;irrelevant&quot; problems, what is the initial value of <code>iCount</code>? Remember that uninitialized local (non-static) variables will have an <i>indeterminate</i> value, and using them without initialization leads to <i>undefined behavior</i>."}], "answers": [{"comments": [{"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "edited": false, "score": 1, "creation_date": 1523441318, "post_id": 49772206, "comment_id": 86559416, "body": "Why would you need a vector when you know the size at compile-time? it&#39;s just an unnecessary overhead. <code>std::array</code> is the c++ way to do that."}, {"owner": {"reputation": 1, "user_id": 9629827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f1a95c726c31493cad66f9c0217369?s=128&d=identicon&r=PG&f=1", "display_name": "limpz", "link": "https://stackoverflow.com/users/9629827/limpz"}, "edited": false, "score": 0, "creation_date": 1523441332, "post_id": 49772206, "comment_id": 86559423, "body": "i tried using vectors but couldnt get them to work with references like iCount etc"}, {"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "edited": false, "score": 0, "creation_date": 1523441380, "post_id": 49772206, "comment_id": 86559460, "body": "iCount is not a reference. Its a variable of type <code>int</code>"}, {"owner": {"reputation": 1, "user_id": 9629827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f1a95c726c31493cad66f9c0217369?s=128&d=identicon&r=PG&f=1", "display_name": "limpz", "link": "https://stackoverflow.com/users/9629827/limpz"}, "edited": false, "score": 0, "creation_date": 1523441443, "post_id": 49772206, "comment_id": 86559504, "body": "i mean to use it to access the array, i couldnt get that to work with vectors"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1, "user_id": 9629827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f1a95c726c31493cad66f9c0217369?s=128&d=identicon&r=PG&f=1", "display_name": "limpz", "link": "https://stackoverflow.com/users/9629827/limpz"}, "edited": false, "score": 0, "creation_date": 1523511673, "post_id": 49772206, "comment_id": 86592457, "body": "@limpz Since you have a compile-time fixed-size array (or rather want one) then use <a href=\"http://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a> instead, like <code>std::array&lt;int, 5&gt; iItemPrice;</code>. If you want a run-time expandable &quot;array&quot; then <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a> like <code>std::vector&lt;int&gt; iItemPrice(5);  &#47;&#47; Create a vector with an initial size of 5 elements</code>"}], "tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": 1, "last_activity_date": 1523441169, "creation_date": 1523441169, "answer_id": 49772206, "question_id": 49772131, "link": "https://stackoverflow.com/questions/49772131/c-subscript-requires-array-or-pointer-type/49772206#49772206", "title": "C++ subscript requires array or pointer type", "body": "<p><code>iItemPrice</code> isn't an array. If you want to create an array use <code>int iItemPrice[size]</code>, even better use <code>std::vector&lt;int&gt; iItemPrice</code></p>\n"}, {"tags": [], "owner": {"reputation": 954, "user_id": 85322, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/06269b593bfad0570d26d8495c4ec042?s=128&d=identicon&r=PG", "display_name": "Jens Luedicke", "link": "https://stackoverflow.com/users/85322/jens-luedicke"}, "is_accepted": false, "score": 3, "last_activity_date": 1523441184, "creation_date": 1523441184, "answer_id": 49772208, "question_id": 49772131, "link": "https://stackoverflow.com/questions/49772131/c-subscript-requires-array-or-pointer-type/49772208#49772208", "title": "C++ subscript requires array or pointer type", "body": "<p>iItemPrice is declared as an int. Not an array/pointer.</p>\n\n<p>Declare it as:</p>\n\n<pre><code>int iItemPrice[5];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9629827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f1a95c726c31493cad66f9c0217369?s=128&d=identicon&r=PG&f=1", "display_name": "limpz", "link": "https://stackoverflow.com/users/9629827/limpz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1454, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1523441947, "creation_date": 1523440928, "question_id": 49772131, "link": "https://stackoverflow.com/questions/49772131/c-subscript-requires-array-or-pointer-type", "title": "C++ subscript requires array or pointer type", "body": "<p>trying out putting classes and objects in header files and keep getting this error, not sure whether its because i havent included the correct files or its just written incorrectly. \nerror is on line 28: iItemPrice[iCount]</p>\n\n<pre><code>    #include \"stdafx.h\"\n#include &lt;string&gt;\n#include &lt;conio.h&gt;\n#include &lt;array&gt;\n#include &lt;vector&gt;\n#include \"ItemsClass.h\"\n#include \"A2main.cpp\"\n#include &lt;iostream&gt;\n\nusing namespace std;\nItemsClass::ItemsClass()\n{\n}\n\nvoid ItemsClass::enter_items() {\n    string sItmes[5];\n    string sChoice;\n    int iCount;\n    int iItemPrice;\n    int iNumOfItems;\n\n\n    do {\n\n        cout &lt;&lt; \"--------- ENTER NEW ITEMS ---------\\n\\nPlease enter the item Name: \";\n        cin &gt;&gt; sItems[iCount];\n        cout &lt;&lt; \"\\nPlease enter the price of: \" &lt;&lt; sItems[iCount] &lt;&lt; \"\\n\";\n        cin &gt;&gt; iItemPrice[iCount];\n        cout &lt;&lt; \"\\nWould you like to enter another item? Y/N \\n\";\n        cin &gt;&gt; sChoice;\n\n        if (sChoice == \"Y\" || sChoice == \"y\")\n        {\n            ++iCount;\n            ++iNumOfItems;\n        }\n\n    } while ((sChoice == \"Y\" || sChoice == \"y\") &amp;&amp; iNumOfItems &lt; 5);\n\n}\n</code></pre>\n"}, {"tags": ["c++", "udp"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1523440859, "post_id": 49772081, "comment_id": 86559085, "body": "You don&#39;t check results of most calls. And even when you do (in case of <code>accept</code>) you are doing it wrong."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1523464991, "last_edit_date": 1523464991, "creation_date": 1523464595, "answer_id": 49780341, "question_id": 49772081, "link": "https://stackoverflow.com/questions/49772081/winsock-always-finding-connection/49780341#49780341", "title": "Winsock always finding connection", "body": "<p>UDP is connection-less, you can't call <code>listen()</code> or <code>accept()</code> on a UDP socket.  They will both fail and report <code>WSAEOPNOTSUPP</code> from <code>WSAGetLastError()</code>.</p>\n\n<p>You are ignoring errors from <code>listen()</code>.</p>\n\n<p>You are not testing the return value of <code>accept()</code> correctly.  When <code>accept()</code> fails, it returns <code>INVALID_SOCKET</code>, which is defined as <code>(SOCKET)(~0)</code> (aka <code>-1</code> casted to a <code>SOCKET</code>).  Any non-zero value will evaluate as true in a boolean expression, such as an <code>if</code> statement.</p>\n\n<p>There is no way to detect whether a UDP listener is running before you send packets to it.  All you can do is unconditionally send packets and hope that responses are sent back.</p>\n"}], "owner": {"reputation": 15, "user_id": 9081159, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IQUmHvc4L-A/AAAAAAAAAAI/AAAAAAAAAFE/Q93r0SETsik/photo.jpg?sz=128", "display_name": "fsxflyer789 Productions", "link": "https://stackoverflow.com/users/9081159/fsxflyer789-productions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 49780341, "answer_count": 1, "score": 0, "last_activity_date": 1523464991, "creation_date": 1523440764, "question_id": 49772081, "link": "https://stackoverflow.com/questions/49772081/winsock-always-finding-connection", "title": "Winsock always finding connection", "body": "<p>I am trying to send a string over a udp socket in c++. Whenever i run this code, it always prints connection found infinitely. What am i doing wrong here? I'm not sure what it is seeing as a connection being made to it while listening or if something in my listening code is wrong? Any help would be appreciated :)</p>\n\n<pre><code>void main()\n\n{\nlong sucessful;\nWSAData WinSockData;\nWORD DLLVERSION;\n\nDLLVERSION = MAKEWORD(2, 1);\n\nsucessful = WSAStartup(DLLVERSION, &amp;WinSockData);\n\nSOCKADDR_IN ADDRESS;\nint cacheSize = sizeof(ADDRESS);\n\nSOCKET sock_LISTEN;\n\nSOCKET sock_CONNECTION;\n\nsock_CONNECTION = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n\nADDRESS.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\nADDRESS.sin_family = AF_INET;\nADDRESS.sin_port = htons(444);\n\nsock_LISTEN = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\nbind(sock_LISTEN, (SOCKADDR*)&amp;ADDRESS, sizeof(ADDRESS));\nlisten(sock_LISTEN, SOMAXCONN);\n\nfor (;;) {\n\n\n    if (sock_CONNECTION = accept(sock_LISTEN,NULL, NULL)) {\n        cout &lt;&lt; \"connection was found \\n\";\n        sucessful = send(sock_CONNECTION, \"I SEE YOU JAVA!\", 100, NULL);\n    }\n\n    }\n\n\n\n } \n</code></pre>\n"}, {"tags": ["c++", "c", "riscv", "bare-metal", "chisel"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1523441528, "post_id": 49771918, "comment_id": 86559560, "body": "What is <i>C++ Emulator</i>?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1523444476, "post_id": 49771918, "comment_id": 86561493, "body": "What&#39;s the purpose of C language tag if you use C++? Please don&#39;t use unrelated tags."}, {"owner": {"reputation": 373, "user_id": 8014623, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8c549808e163e1181894193e9678629b?s=128&d=identicon&r=PG&f=1", "display_name": "noureddine-as", "link": "https://stackoverflow.com/users/8014623/noureddine-as"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1523455049, "post_id": 49771918, "comment_id": 86569230, "body": "@VTT C++ Emulator is the CABA (cycle accurate bit accurate) simulator used to simulate software taking in consideration your personalized hardware. Spike is just a functional simulator, which doesn&#39;t take in consideration your hardware."}, {"owner": {"reputation": 373, "user_id": 8014623, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8c549808e163e1181894193e9678629b?s=128&d=identicon&r=PG&f=1", "display_name": "noureddine-as", "link": "https://stackoverflow.com/users/8014623/noureddine-as"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1523455058, "post_id": 49771918, "comment_id": 86569236, "body": "@Gerhardh because the emulator is programmed in C++ but the program running on it is in C."}], "answers": [{"comments": [{"owner": {"reputation": 373, "user_id": 8014623, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8c549808e163e1181894193e9678629b?s=128&d=identicon&r=PG&f=1", "display_name": "noureddine-as", "link": "https://stackoverflow.com/users/8014623/noureddine-as"}, "edited": false, "score": 0, "creation_date": 1523454260, "post_id": 49772346, "comment_id": 86568601, "body": "I know this. I made a little example here: <a href=\"https://github.com/noureddine-as/riscv-baremetal-DefaultConfig\" rel=\"nofollow noreferrer\">github.com/noureddine-as/riscv-baremetal-DefaultConfig</a> Executing this on the Emulator prints the hello message correctly. Then I made another one, but this time it gives me <code>*** FAILED *** (tohost = 1337) *** FAILED *** via dtm (code = 1337, seed 1523460801) after 208588 cycles</code> in the C++ Emulator even if it works well in Spike simulation ! Any idea?"}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "reply_to_user": {"reputation": 373, "user_id": 8014623, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8c549808e163e1181894193e9678629b?s=128&d=identicon&r=PG&f=1", "display_name": "noureddine-as", "link": "https://stackoverflow.com/users/8014623/noureddine-as"}, "edited": false, "score": 1, "creation_date": 1523497008, "post_id": 49772346, "comment_id": 86588648, "body": "here <code>uint64_t magic_mem[8] __attribute__((aligned(64)));</code> array size is <code>8 * 8</code>, so may be it&#39;s overflow causing to fail after <code>208588</code> cycle"}, {"owner": {"reputation": 373, "user_id": 8014623, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8c549808e163e1181894193e9678629b?s=128&d=identicon&r=PG&f=1", "display_name": "noureddine-as", "link": "https://stackoverflow.com/users/8014623/noureddine-as"}, "edited": false, "score": 0, "creation_date": 1523517069, "post_id": 49772346, "comment_id": 86595157, "body": "I resolved this. I remarked than if I put for example <code>printf(&quot;something&quot;);</code> without a \\n it doesn&#39;t print in both cases with pk or baremetal. I didn&#39;t investigate the real source but I thing it&#39;s because printf is reimplemented in the syscalls and i don&#39;t use the Standard one. Moreover I guess that Spike still waits for the \\n to print the text. Anyway it works now. What I would like to know @Thiru is how to debug programs using Spike and especially the C++ Emulator?"}], "tags": [], "owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "is_accepted": false, "score": 1, "last_activity_date": 1523441580, "creation_date": 1523441580, "answer_id": 49772346, "question_id": 49771918, "link": "https://stackoverflow.com/questions/49771918/using-c-emulator-fails-when-calling-printf-syscall-from-a-risc-v-baremetal-pro/49772346#49772346", "title": "Using C++ Emulator fails when calling printf syscall from a RISC-V baremetal program", "body": "<blockquote>\n  <p>Is it possible to call syscalls (like printf, putchar ..) from the C\n  Emulator?</p>\n</blockquote>\n\n<p>Yes these functions already defined <a href=\"https://github.com/riscv/riscv-tests/blob/master/benchmarks/common/syscalls.c\" rel=\"nofollow noreferrer\">here</a> in code base</p>\n\n<p>As per the code base, data address pointing by global external variable, from this address you need to read 4 index of 64bit data</p>\n\n<pre><code>extern volatile uint64_t tohost;\nextern volatile uint64_t fromhost;\n</code></pre>\n\n<p>The <code>printf(), putchar()</code> implemented using this <code>syscall</code></p>\n\n<pre><code>static uintptr_t syscall(uintptr_t which, uint64_t arg0, uint64_t arg1, uint64_t arg2)\n{\n  volatile uint64_t magic_mem[8] __attribute__((aligned(64)));\n  magic_mem[0] = which;\n  magic_mem[1] = arg0;\n  magic_mem[2] = arg1;\n  magic_mem[3] = arg2;\n  __sync_synchronize();\n\n  tohost = (uintptr_t)magic_mem;\n  while (fromhost == 0)\n    ;\n  fromhost = 0;\n\n  __sync_synchronize();\n  return magic_mem[0];\n}\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 8014623, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8c549808e163e1181894193e9678629b?s=128&d=identicon&r=PG&f=1", "display_name": "noureddine-as", "link": "https://stackoverflow.com/users/8014623/noureddine-as"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523441580, "creation_date": 1523440346, "question_id": 49771918, "link": "https://stackoverflow.com/questions/49771918/using-c-emulator-fails-when-calling-printf-syscall-from-a-risc-v-baremetal-pro", "title": "Using C++ Emulator fails when calling printf syscall from a RISC-V baremetal program", "body": "<p>I'm working on a project based on Rocket-Chip tools. I made a simple baremetal program that works well on Spike (even with multiple cores ...etc).</p>\n\n<p>The problem is that when I run it in the C++ Emulator, the latter stops in the first printf call.</p>\n\n<p>My question is: Is it possible to call syscalls (like printf, putchar ..) from the C Emulator? Or is there any way to print the results of a program out of the simulation like fetching the data memory or something? (I struggled with that and I didn't find where it saves the data variables).</p>\n\n<p>PS: The program is based on <a href=\"https://github.com/riscv/riscv-tests/tree/master/benchmarks\" rel=\"nofollow noreferrer\">riscv-tests/benchmarks</a> the syscalls are already defined there.</p>\n"}]