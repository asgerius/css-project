[{"tags": ["c++", "opencv", "windows-10", "video-capture", "multi-camera-api"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1558570143, "post_id": 56266401, "comment_id": 99149044, "body": "Just use the Basler SDK for your image acquisition."}, {"owner": {"reputation": 21, "user_id": 10668383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c24be7caf90d7a1a209ba1f9b4422f?s=128&d=identicon&r=PG&f=1", "display_name": "UT-Doug", "link": "https://stackoverflow.com/users/10668383/ut-doug"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1558574608, "post_id": 56266401, "comment_id": 99149793, "body": "But I am trying to automate the image processing process. It would be easier to use opencv.."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1558576220, "post_id": 56266401, "comment_id": 99150069, "body": "Well, then create a bug report on the opencv github, but honestly I wouldn&#39;t hold my breath. How many maintainers of an open source library do you think have 6 of those cameras sitting around to even try to reproduce the issue? | Plus, the VideoCapture API is a least common denominator to support several dozen different backends. You have much more control using the SDK directly."}, {"owner": {"reputation": 21, "user_id": 10668383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c24be7caf90d7a1a209ba1f9b4422f?s=128&d=identicon&r=PG&f=1", "display_name": "UT-Doug", "link": "https://stackoverflow.com/users/10668383/ut-doug"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1558586551, "post_id": 56266401, "comment_id": 99151799, "body": "Thanks for your input."}], "owner": {"reputation": 21, "user_id": 10668383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c24be7caf90d7a1a209ba1f9b4422f?s=128&d=identicon&r=PG&f=1", "display_name": "UT-Doug", "link": "https://stackoverflow.com/users/10668383/ut-doug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558581660, "creation_date": 1558569342, "last_edit_date": 1558581660, "question_id": 56266401, "link": "https://stackoverflow.com/questions/56266401/opencv-videocapture-in-win10-vs17-cannot-open-more-than-four-usb-3-0-cameras", "title": "OpenCV VideoCapture in Win10 VS17 cannot open more than four USB 3.0 cameras", "body": "<p>I am trying set up a multi-camera system in VS17 win10 OpenCV environment using VideoCapture function from OpenCV library. Cameras are Basler USB 3.0 (3840*2748 monochrome). I had no issue to open and stream up to four cameras. However, the fifth camera or more was not able to be opened. Whereas, all six cameras can be accessed with no issue using Basler software. I am not sure if there is a hardware limitation (like USB bandwidth or PCI bus), which should not be because in Basler SDK, all cameras can be used as normal.</p>\n\n<p>I have tried to set lower resolution image to see if it is USB bandwidth limit, but still not working.</p>\n\n<p>int main(){</p>\n\n<pre><code>    VideoCapture cap0(0), cap1(1), cap2(2), cap3(3), cap4(4), cap5(5);\nMat ca1, ca2, ca3, ca4, ca5, ca6;\ncv::namedWindow(\"Camera1\", WINDOW_NORMAL);\ncv::namedWindow(\"Camera2\", WINDOW_NORMAL);\ncv::namedWindow(\"Camera3\", WINDOW_NORMAL);\ncv::namedWindow(\"Camera4\", WINDOW_NORMAL);\ncv::namedWindow(\"Camera5\", WINDOW_NORMAL);\ncv::namedWindow(\"Camera6\", WINDOW_NORMAL);\nwhile (true) {\n    if (cap0.grab()) {\n        cap0.retrieve(ca1);\n    }\n    if (!cap0.grab()) {\n        std::cout &lt;&lt; \"camera 0 cannot be grabbed\\n\";\n    }\n    if (cap1.grab()) {\n        cap1.retrieve(ca2);\n    }\n    if (!cap1.grab()) {\n        std::cout &lt;&lt; \"camera 1 cannot be grabbed\\n\";\n    }\n    if (cap2.grab()) {\n        cap2.retrieve(ca3);\n    }\n    if (!cap2.grab()) {\n        std::cout &lt;&lt; \"camera 2 cannot be grabbed\\n\";\n    }\n    if (cap3.grab()) {\n        cap3.retrieve(ca4);\n    }\n    if (!cap3.grab()) {\n        std::cout &lt;&lt; \"camera 3 cannot be grabbed\\n\";\n    }\n    if (cap4.grab()) {\n        cap3.retrieve(ca5);\n    }\n    if (!cap4.grab()) {\n        std::cout &lt;&lt; \"camera 4 cannot be grabbed\\n\";\n    }\n    if (cap5.grab()) {\n        cap3.retrieve(ca6);\n    }\n    if (!cap5.grab()) {\n        std::cout &lt;&lt; \"camera 5 cannot be grabbed\\n\";\n    }\n    cv::imshow(\"Camera1\", ca1);\n    cv::imshow(\"Camera2\", ca2);\n    cv::imshow(\"Camera3\", ca3);\n    cv::imshow(\"Camera4\", ca4);\n    cv::imshow(\"Camera5\", ca5);\n    cv::imshow(\"Camera6\", ca6);\n    char c = waitKey(1);\n    if (c == 'q') {\n        destroyAllWindows();\n        break;\n    }\n}\ncap0.release();\ncap1.release();\ncap2.release();\ncap3.release();\ncap4.release();\ncap5.release();\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>Compile fails at cap4.grab(), basically it said camera 4 and 5 cannot be grabbed (opened).\nCan someone please help? Thank you very much in advance.</p>\n\n<p><img src=\"https://i.stack.imgur.com/bSxuX.jpg\" alt=\"image\"></p>\n"}, {"tags": ["c++", "templates", "template-meta-programming", "stdtuple", "type-deduction"], "comments": [{"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 3, "creation_date": 1558569534, "post_id": 56266390, "comment_id": 99148903, "body": "Are you fine with adding a trailing &quot;s&quot;? <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/operator%22%22s\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/basic_string/operator%22%22&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 100, "user_id": 5179631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/721dda3ea53e0ff2ce6b8164845bd068?s=128&d=identicon&r=PG&f=1", "display_name": "Ody", "link": "https://stackoverflow.com/users/5179631/ody"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1558569702, "post_id": 56266390, "comment_id": 99148949, "body": "No I would like to use the tuple as storage space, so I basically want to store copies of the const char* strings. For example instead of passing a string literal it could be passing a s.c_str(); I updated the code in the question so it is more clear"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558570378, "post_id": 56266390, "comment_id": 99149090, "body": "@Ody: The vast majority of the time, the non-literal cases can be made to be strings in the first place (e.g. <code>std::getline</code> to populate a <code>std::string</code> instead of <code>istream.getline</code> to populate a <code>char*</code>), so the trailing <code>s</code> approach to string literals closes most of the remaining gap. In the remaining cases not covered, you&#39;re likely working with C APIs, and being explicit about the conversion to <code>std::string</code> is the way to go. I&#39;m fairly sure <code>std::tuple</code> won&#39;t support this out of the box; you&#39;d have to write your own wrapper."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1558570417, "post_id": 56266390, "comment_id": 99149096, "body": "@Ody: &quot;<i>No I would like to use the tuple as storage space, so I basically want to store copies of the <code>const char*</code> strings.</i>&quot; That is exactly what the <code>s</code> literal would do. It will create a <code>std::string</code>, which copies the string literal into itself, and that would be what gets stored in the <code>tuple</code>."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1558570464, "post_id": 56266390, "comment_id": 99149108, "body": "@NicolBolas: They meant that some of these won&#39;t be literals, so the suffix doesn&#39;t help them in those cases (that said, it&#39;s a better solution in the cases it applies, since the <code>s</code> prefix automatically invokes the pre-sized constructor using the compile-time known length,  instead of having to scan for a <code>NUL</code> terminator at runtime)."}], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 5179631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/721dda3ea53e0ff2ce6b8164845bd068?s=128&d=identicon&r=PG&f=1", "display_name": "Ody", "link": "https://stackoverflow.com/users/5179631/ody"}, "edited": false, "score": 0, "creation_date": 1558572839, "post_id": 56266609, "comment_id": 99149480, "body": "Thanks a lot, I&#39;ve added a wandbox example using your solution"}], "tags": [], "owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "is_accepted": true, "score": 2, "last_activity_date": 1558571304, "creation_date": 1558571304, "answer_id": 56266609, "question_id": 56266390, "link": "https://stackoverflow.com/questions/56266390/deducing-stdstring-from-const-char-or-char-when-creating-a-stdtuple/56266609#56266609", "title": "Deducing std::string from const char* or char* when creating a std::tuple", "body": "<p>Regardless of wether this is something you should be doing or not, the question can still be answered as asked:</p>\n\n<p>I don't think  you'll be able to pull this off without providing your own <code>make_tuple</code>.</p>\n\n<p>Thankfully, a lot of the heavy lifting can still be done by <code>std::make_tuple()</code>. All you have to do, really, is explicitely specify the template arguments, instead of letting them be deduced:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct Promoted {\n    using type = T;\n};\n\ntemplate&lt;&gt;\nstruct Promoted&lt;const char *&gt; {\n    using type = std::string;\n};\n\ntemplate&lt;typename T&gt;\nusing Promoted_t = typename Promoted&lt;T&gt;::type;\n\ntemplate&lt;typename... ArgsT&gt;\nauto make_my_tuple(ArgsT&amp;&amp;... args) {\n    return std::make_tuple&lt;Promoted_t&lt;std::decay_t&lt;ArgsT&gt;&gt;...&gt;(std::forward&lt;ArgsT&gt;(args)...);\n}\n</code></pre>\n\n<p><strong>Disclaimer:</strong> The code I posted is not meant to be a complete solution. It's a guideline on how I would tackle the issue. There are probably some edge cases not being covered here.</p>\n"}], "owner": {"reputation": 100, "user_id": 5179631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/721dda3ea53e0ff2ce6b8164845bd068?s=128&d=identicon&r=PG&f=1", "display_name": "Ody", "link": "https://stackoverflow.com/users/5179631/ody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 56266609, "answer_count": 1, "score": 0, "last_activity_date": 1558572892, "creation_date": 1558569240, "last_edit_date": 1558572892, "question_id": 56266390, "link": "https://stackoverflow.com/questions/56266390/deducing-stdstring-from-const-char-or-char-when-creating-a-stdtuple", "title": "Deducing std::string from const char* or char* when creating a std::tuple", "body": "<p>I'm wondering if there is an easy way to deducing a <code>std::string</code> from a <code>const char*</code> when making a tuple.\nThat would be possible with my own tuple implementation but I'm wondering if it is possible with <code>std::tuple</code></p>\n\n<p>For example in the code below <code>storage_</code> will have the type of :</p>\n\n<p><code>std::tuple&lt;int, int, const char*&gt;</code></p>\n\n<p><code>std::tuple&lt;const char*, char*&gt;</code></p>\n\n<p>I would like to get :</p>\n\n<p><code>std::tuple&lt;int, int, std::string&gt;</code></p>\n\n<p><code>std::tuple&lt;std::string, std::string&gt;</code></p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;string&gt;\n#include &lt;string.h&gt;\ntemplate&lt;typename T&gt;\nclass foo\n{\npublic:\n    foo(T storage) : storage_(std::move(storage)) {}\nprivate:\n    T storage_;\n};\n\nint main()\n{\n    char* s2 = strdup(\"123\");\n\n    foo f { std::make_tuple(12,123,\"1234\") };\n\n    foo f2 { std::make_tuple(\"321\", s2) };\n\n    free(s2);\n    // still want to keep s2 stored in f2\n}\n\n</code></pre>\n\n<p>I know I can write <code>std::tuple&lt;int,std::string&gt; t1 = std::make_tuple(123,\"12\");</code> but that doesn't solve my problem as I want to have any number of arguments passed in any order</p>\n\n<p><strong>Solution:</strong> <a href=\"https://wandbox.org/permlink/MsUxZ18SYD1K2ujv\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/MsUxZ18SYD1K2ujv</a></p>\n"}, {"tags": ["c++", "io"], "comments": [{"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 2, "creation_date": 1558568734, "post_id": 56266337, "comment_id": 99148770, "body": "Did you include <code>&lt;fstream&gt;</code>?"}, {"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 1, "creation_date": 1558568937, "post_id": 56266337, "comment_id": 99148814, "body": "Please <a href=\"https://stackoverflow.com/posts/56266337/edit\">edit</a> your question to contain a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Why are <code>setx</code> and <code>sety</code> <code>const</code> functions, surely they change parts of <code>Point</code>?"}, {"owner": {"reputation": 1, "user_id": 10568883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2c2df28d915a5330b27973ab84f0d4?s=128&d=identicon&r=PG&f=1", "display_name": "\u0415\u0432\u0433\u0435\u043d\u0438\u0439 \u041a\u0440\u0430\u043c\u0430\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/10568883/%d0%95%d0%b2%d0%b3%d0%b5%d0%bd%d0%b8%d0%b9-%d0%9a%d1%80%d0%b0%d0%bc%d0%b0%d1%80%d0%be%d0%b2"}, "reply_to_user": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 0, "creation_date": 1558571421, "post_id": 56266337, "comment_id": 99149252, "body": "@Quimby Thx, I&#39;ve carefully re-checked inclusion sequence and it happened, that one of incorrect header guards stopped fstream from including. Now the question seems so dumb.."}], "answers": [{"tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 1, "last_activity_date": 1558569890, "creation_date": 1558569890, "answer_id": 56266464, "question_id": 56266337, "link": "https://stackoverflow.com/questions/56266337/why-ifstream-cant-read-a-double/56266464#56266464", "title": "Why i(f)stream can&#39;t read a double", "body": "<p>Perhaps you forgot to <code>#include &lt;iostream&gt;</code>? Without that, you'd expect to get an error message like you've cited.</p>\n\n<p>Once you fix that, I'd expect to see a couple of other warnings/errors. First, you're pass <code>point</code> by reference to const <code>Point</code>, even though <code>operator&gt;&gt;</code> seems to be modifying the <code>Point</code> that's passed (which is as expected). You probably want to remove the <code>const</code>.</p>\n\n<p>Second, you've declared your <code>operator&gt;&gt;</code> to return an <code>std::istream &amp;</code>, but failed to return anything. You probably want to add <code>return is;</code> just before its end.</p>\n\n<p>This code compiles:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Point { \n    double x;\n    double y;\n\n    void setx(double x_) { x = x_; }\n    void sety(double y_) { y = y_; }\n};\n\nstd::istream&amp; operator &gt;&gt;(std::istream&amp; is, Point&amp; point)\n{\n  double temp;\n  is &gt;&gt; temp;\n  point.setx(temp);\n  is.ignore(3,';');\n  is &gt;&gt; temp;\n  point.sety(temp);\n  is.ignore(3,';');\n  return is;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10568883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2c2df28d915a5330b27973ab84f0d4?s=128&d=identicon&r=PG&f=1", "display_name": "\u0415\u0432\u0433\u0435\u043d\u0438\u0439 \u041a\u0440\u0430\u043c\u0430\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/10568883/%d0%95%d0%b2%d0%b3%d0%b5%d0%bd%d0%b8%d0%b9-%d0%9a%d1%80%d0%b0%d0%bc%d0%b0%d1%80%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558569890, "creation_date": 1558568669, "question_id": 56266337, "link": "https://stackoverflow.com/questions/56266337/why-ifstream-cant-read-a-double", "title": "Why i(f)stream can&#39;t read a double", "body": "<p>I'm writing a program and one thing needed to be implemented is to overload <code>&gt;&gt;</code> operator for reading a point at once. What I've tried:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::istream&amp; operator &gt;&gt;(std::istream&amp; is, const Point&amp; point)\n{\n  double temp;\n  is &gt;&gt; temp;\n  point.setx(temp);\n  is.ignore(3,';');\n  is &gt;&gt; temp;\n  point.sety(temp);\n  is.ignore(3,';');\n}\n</code></pre>\n\n<p>It somewhy fails to compile in VS2019 (if that matters) with a message that there's no operator <code>&gt;&gt;</code> accepting <code>std::istream</code> &amp; <code>double</code> as arguments. The problem remains with any type <code>temp</code>. Either it is an <code>int</code> or a <code>char*</code> and doesn't depend on whether I read from <code>istream</code> or <code>ifstream</code>.</p>\n\n<p>What could be a reason for such behaviour and any possible soltion?</p>\n"}, {"tags": ["c++", "drag-and-drop", "gtk3", "gtkmm"], "owner": {"reputation": 25809, "user_id": 640584, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/22c2a81ffc7aeed2599f9aaa8d95a69d?s=128&d=identicon&r=PG", "display_name": "Tyilo", "link": "https://stackoverflow.com/users/640584/tyilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1558567834, "creation_date": 1558567834, "question_id": 56266254, "link": "https://stackoverflow.com/questions/56266254/how-to-make-a-draggable-gtk-widget-that-will-drop-a-file-in-other-programs", "title": "How to make a draggable GTK widget that will drop a file in other programs", "body": "<p>I want to make a GTK widget, when dragged and dropped in another program, will act as if a file was dropped (behaving the same way as dragging a file from Nautilus).</p>\n\n<p>I have tried 3 different ways of setting the drag data in the callback, but nothing seems to work:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;bits/stdc++.h&gt;\n#include &lt;gtkmm.h&gt;\n\n#define FILENAME \"/tmp/foo.txt\"\n\nint main(int argc, char *argv[]) {\n    auto app = Gtk::Application::create(argc, argv, \"com.tyilo.foo\");\n\n    Gtk::Window window;\n    window.set_default_size(200, 200);\n    window.set_keep_above();\n\n    Gtk::Button button(\"Drag this\");\n    window.add(button);\n\n    std::vector&lt;Gtk::TargetEntry&gt; listTargets;\n    listTargets.push_back(Gtk::TargetEntry(\"text/uri-list\"));\n    //listTargets.push_back(Gtk::TargetEntry(\"text/plain\"));\n    //listTargets.push_back(Gtk::TargetEntry(\"text/plain;charset=utf-8\"));\n    //listTargets.push_back(Gtk::TargetEntry(\"UTF8_STRING\"));\n    //listTargets.push_back(Gtk::TargetEntry(\"COMPOUND_STRING\"));\n    //listTargets.push_back(Gtk::TargetEntry(\"TEXT\"));\n    //listTargets.push_back(Gtk::TargetEntry(\"STRING\"));\n\n    button.drag_source_set(listTargets, Gdk::ModifierType(GDK_BUTTON1_MASK | GDK_BUTTON3_MASK),\n                           Gdk::DragAction(GDK_ACTION_COPY | GDK_ACTION_MOVE));\n    button.drag_source_set_icon(\"document-save\");\n\n    button.signal_drag_data_get().connect([&amp;](auto, auto selection_data, auto, auto) {\n        std::cout &lt;&lt; \"Data get: \" &lt;&lt; selection_data.get_target() &lt;&lt; std::endl;\n\n        auto uri = Glib::filename_to_uri(FILENAME);\n        std::cout &lt;&lt; uri &lt;&lt; std::endl;\n\n        // All but one of (1), (2) and (3) should be commented out\n\n        // (1)\n        selection_data.set_uris({uri});\n\n        // (2)\n        //uri += \"\\r\\n\";\n        //selection_data.set(selection_data.get_target(), 8, (const guchar*)uri.c_str(), uri.bytes());\n\n\n        // (3)\n        //selection_data.set(\"text/uri-list\", \"file:///tmp/foo.txt\\r\\n\");\n    });\n\n    window.show_all();\n    return app-&gt;run(window);\n}\n</code></pre>\n\n<p>Do I need to specify more targets than just <code>text/uri-list</code>? Do I need to handle these differently?</p>\n\n<p>Or am I doing something wrong with setting the selection data?</p>\n\n<p>I'm using <code>gtkmm3</code> version <code>3.24.1</code> and <code>gtk3</code> version <code>3.24.8</code> and I'm compiling with:</p>\n\n<pre><code>g++ foo.cpp $(pkg-config gtkmm-3.0 --cflags --libs)\n</code></pre>\n\n<p>An easy way to test if it works, is try to drag the file to the following <code>&lt;input&gt;</code> tag in your browser:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input type=file value=\"Drop here\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1558566649, "post_id": 56266042, "comment_id": 99148388, "body": "What exactly was wrong with the first on? It looked okay to me."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1558566695, "post_id": 56266042, "comment_id": 99148400, "body": "Also, not really sure what you&#39;re trying to do with the second one."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11541986"}, "edited": false, "score": 0, "creation_date": 1558566916, "post_id": 56266042, "comment_id": 99148453, "body": "@Chipster: Thanks for your comment. In the second one, I am trying to solve the same problem as the first one but instead using comparisons to find the maximum and minimum, I find them by using math formulas max(x,y)=(x+y+abs(y-x))/2 and min(x,y)=(x+y-abs(y-x))/2. This can be found in exercise 13 on page 16 of Spivak Calculus (fourth edition)."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1558567167, "post_id": 56266042, "comment_id": 99148510, "body": "@Vafa <i>if there is a cleaner way of doing this but he did not reply</i> -- <a href=\"https://www.ideone.com/Y8G2z3\" rel=\"nofollow noreferrer\">I can reply</a>.  Second, why are you resorting to math formulas to get the minimum and maximum of a set of integers?  All that will do is confuse fellow programmers as to what you&#39;re trying to accomplish."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1558567331, "post_id": 56266042, "comment_id": 99148548, "body": "Hmm. Again, I say it looks okay to me. Any idea what exactly is wrong with it? Is there something else in the assignment you missed?"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558567598, "post_id": 56266042, "comment_id": 99148600, "body": "@PaulMcKenzie That doesn&#39;t halt when the next integer is -99."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11541986"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558567942, "post_id": 56266042, "comment_id": 99148654, "body": "@PaulMcKenzie Thanks for your comment. I was just trying to test different things as I am learning that is why I resorted to math formulas. I guess that maybe my lecturer was also confused and he did not understand the logic of my program."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1558568070, "post_id": 56266042, "comment_id": 99148679, "body": "I&#39;d use <code>minimum = std::min(minimum, number);</code> etc. instead of <code>if</code>&#39;s, and check to make sure reading an int succeeded instead of assuming it does."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1558570218, "post_id": 56266042, "comment_id": 99149059, "body": "Now would be a good time to invest in learning to use a debugger.  The debugger will let you execute statement by statement."}, {"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1558574543, "post_id": 56266042, "comment_id": 99149777, "body": "Both are incorrect because when the first entry is -99, minimum and maximum are uninitialized and therefore the result is undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 1, "creation_date": 1558574263, "post_id": 56266516, "comment_id": 99149730, "body": "This doesn&#39;t work. If the users only inputs positive numbers, the condition (number &lt; minimum will never be true and minimum will stay at 0. Same with negative numbers only."}, {"owner": {"reputation": 1619, "user_id": 741174, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8af754d41e2d360de64da0afc9e3de3e?s=128&d=identicon&r=PG", "display_name": "Cool Java guy \u05de\u05d5\u05d7\u05de\u05d3", "link": "https://stackoverflow.com/users/741174/cool-java-guy-%d7%9e%d7%95%d7%97%d7%9e%d7%93"}, "edited": false, "score": 0, "creation_date": 1559035624, "post_id": 56266516, "comment_id": 99283491, "body": "Thank you my friends. I hope it is correct. Correct me if I&#39;m wrong."}], "tags": [], "owner": {"reputation": 1619, "user_id": 741174, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8af754d41e2d360de64da0afc9e3de3e?s=128&d=identicon&r=PG", "display_name": "Cool Java guy \u05de\u05d5\u05d7\u05de\u05d3", "link": "https://stackoverflow.com/users/741174/cool-java-guy-%d7%9e%d7%95%d7%97%d7%9e%d7%93"}, "is_accepted": false, "score": -1, "last_activity_date": 1559035513, "last_edit_date": 1559035513, "creation_date": 1558570322, "answer_id": 56266516, "question_id": 56266042, "link": "https://stackoverflow.com/questions/56266042/why-is-my-c-code-wrong-to-calculate-the-maximum-and-minimum-of-integers/56266516#56266516", "title": "Why is my C++ code wrong to calculate the maximum and minimum of integers?", "body": "<pre><code>    #include &lt;iostream&gt;\n    #include &lt;cmath&gt;\n    using namespace std;\n    int main()\n    {\n        int number, maximum=0, minimum=0;\n        bool isDirty = false;\n        do\n        {\n            cout&lt;&lt;\"Enter an integer: \";\n            cin&gt;&gt;number;\n            if(number!=-99){\n               if(isDirty==false) {\n                 isDirty = true;\n                 minimum = maximum =number;\n               } else {\n                  if (number &lt; minimum) { \n                    minimum = number;\n                   } \n                   if (number &gt; maximum){ \n                     maximum = number;\n                   }\n\n                 } \n            }\n        }\n        while(number!=-99);\n\n        cout&lt;&lt;\"The smallest entered integer is \"\n        &lt;&lt;minimum\n        &lt;&lt;\" and the largest entered integer is \"\n        &lt;&lt;maximum\n        &lt;&lt;endl;\n        return(0);\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1558574863, "post_id": 56266524, "comment_id": 99149836, "body": "Also incorrect when the sequence of numbers before -99 has zero occurrences above -99 or  zero occurrences of numbers under 99 (e.g. &quot;-99&quot; or &quot;-200 -100 -99&quot; or &quot;100 200 -99&quot;"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 1, "creation_date": 1558575436, "post_id": 56266524, "comment_id": 99149933, "body": "@ComeRaczy You&#39;re right about the null input part but for the second part I figure -99 has to be the lower bound of the input (and so I made +99 the upper bound). If the OP wants to change this he can use <code>INT_MIN</code> and <code>INT_MAX</code> respectively."}, {"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1558576931, "post_id": 56266524, "comment_id": 99150179, "body": "INT_MIN and INT_MAX would work (even though it\u2019s a C answer) but this doesn\u2019t change the fact that without checking for out of bound values 99 and -99 will lead to incorrect answers (that\u2019s obviously the second input the lecturer will try)"}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 1, "creation_date": 1558577316, "post_id": 56266524, "comment_id": 99150253, "body": "@ComeRaczy Yes but like I said I&#39;m assuming the input <i>will</i> be a number between -99 and 99."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1559009868, "post_id": 56266524, "comment_id": 99274760, "body": "The second program doesn&#39;t work fine.  It can allow undefined behavior (due to signed integer overflow)"}], "tags": [], "owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "is_accepted": false, "score": 1, "last_activity_date": 1558575532, "last_edit_date": 1558575532, "creation_date": 1558570349, "answer_id": 56266524, "question_id": 56266042, "link": "https://stackoverflow.com/questions/56266042/why-is-my-c-code-wrong-to-calculate-the-maximum-and-minimum-of-integers/56266524#56266524", "title": "Why is my C++ code wrong to calculate the maximum and minimum of integers?", "body": "<p>Both of your programs work fine. If you'd like it be cleaner than you can do the following:</p>\n\n<ul>\n<li>Check if the input succeeded before using <code>number</code>. You can do this by putting the input operation in a <code>while</code> loop.</li>\n<li>Just use the <code>max</code> and <code>min</code> functions found in <code>&lt;cmath&gt;</code>.</li>\n</ul>\n\n<p>This will be your program:</p>\n\n\n\n<pre class=\"lang-c++ prettyprint-override\"><code>int main() {\n  int number = -100, maximum = -99, minimum = 99;\n  while (cin &gt;&gt; number &amp;&amp; number != -99) {\n    maximum = max(maximum, number);\n    minimum = min(minimum, number);\n  }\n  if (number == -99) {\n    cout &lt;&lt; \"The smallest entered integer is \"     &lt;&lt; minimum\n         &lt;&lt; \" and the largest entered integer is \" &lt;&lt; maximum &lt;&lt; endl;\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "is_accepted": false, "score": 1, "last_activity_date": 1558576049, "creation_date": 1558576049, "answer_id": 56267075, "question_id": 56266042, "link": "https://stackoverflow.com/questions/56266042/why-is-my-c-code-wrong-to-calculate-the-maximum-and-minimum-of-integers/56267075#56267075", "title": "Why is my C++ code wrong to calculate the maximum and minimum of integers?", "body": "<p>There are several ways to correct the problem. One is to check for the value of k in your initial example to verify that a value was actually entered and that minimum and maximum are initialized.</p>\n\n<p>A slightly different approach that might impress your lecturer is to initialize minimum and maximum to values that will lead to a correct result. std::numeric_limits provides the minimum and maximum values for integers. Using this you could implement something along these lines:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;limits&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    int number;\n    int maximum = std::numeric_limits&lt;int&gt;::min();\n    int minimum = std::numeric_limits&lt;int&gt;::max();\n    while ((std::cin &gt;&gt; number) &amp;&amp; (number != -99))\n    {\n        maximum = std::max(maximum, number);\n        minimum = std::min(minimum, number);\n    }\n    if (std::cin)\n    {\n        if ((maximum != std::numeric_limits&lt;int&gt;::min()) || (minimum != std::numeric_limits&lt;int&gt;::max()))\n        {\n            std::cout &lt;&lt; \"maximum = \" &lt;&lt; maximum &lt;&lt; std::endl;\n            std::cout &lt;&lt; \"minimum = \" &lt;&lt; minimum &lt;&lt; std::endl;\n        }\n        else\n        {\n            std::cout &lt;&lt; \"No number entered\" &lt;&lt; std::endl;\n        }\n    }\n    else\n    {\n        std::cout &lt;&lt; \"Errorr reading the number\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 0, "last_activity_date": 1559010081, "last_edit_date": 1559010081, "creation_date": 1559009690, "answer_id": 56334237, "question_id": 56266042, "link": "https://stackoverflow.com/questions/56266042/why-is-my-c-code-wrong-to-calculate-the-maximum-and-minimum-of-integers/56334237#56334237", "title": "Why is my C++ code wrong to calculate the maximum and minimum of integers?", "body": "<p>The formulas used in your second code snippet are mathematically correct, but have drawbacks if used in computer programming where <strong>variables have limited range</strong>.</p>\n\n<p>The first code snippet works across the entire representable set of integers (except <code>-99</code> for obvious reasons).</p>\n\n<p>The second code snippet will not work for inputs whose absolute value is greater than <code>INT_MIN / -2</code>, because the computations will overflow.</p>\n\n<p>Don't feel bad, this bug is not at all obvious and a lot of programmers have overlooked it.  For a related example, see:</p>\n\n<ul>\n<li><a href=\"https://ai.googleblog.com/2006/06/extra-extra-read-all-about-it-nearly.html\" rel=\"nofollow noreferrer\">Extra, Extra - Read All About It: Nearly All Binary Searches and Mergesorts are Broken</a></li>\n</ul>\n\n<p>Unfortunately, if you have this kind of bug in code processing untrusted input, your range checking could fail and lead to a security vulnerability.  So don't go ignoring it just because \"I never expect inputs that large\".</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11541986"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1559035513, "creation_date": 1558566104, "question_id": 56266042, "link": "https://stackoverflow.com/questions/56266042/why-is-my-c-code-wrong-to-calculate-the-maximum-and-minimum-of-integers", "title": "Why is my C++ code wrong to calculate the maximum and minimum of integers?", "body": "<p>I am learning the C++ programming language and I am a beginner. I had to write a code so that a user inputs a series of integers and whenever he enters -99, that should signal the end of the series and then my program needs to find the smallest and largest integers. I initially came up with this solution</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint main()\n{\n    int k=0, number, maximum, minimum;\n    do\n    {\n        cout&lt;&lt;\"Enter an integer: \";\n        cin&gt;&gt;number;\n        if (number==-99)\n        {\n            break;\n        }\n        if (k==0)\n        {\n            maximum=number;\n            minimum=number;\n        }\n        if (number&gt;maximum)\n        {\n            maximum=number;\n        }\n        if (number&lt;minimum)\n        {\n            minimum=number;\n        }\n        k++;\n    }\n    while(number!=-99);\n    cout&lt;&lt;\"The smallest entered integer is \"\n    &lt;&lt;minimum\n    &lt;&lt;\" and the largest entered integer is \"\n    &lt;&lt;maximum\n    &lt;&lt;endl;\n    return(0);\n}\n</code></pre>\n\n<p>and sent it to my lecturer and asked if there is a cleaner way of doing this but he did not reply. Next, I changed this program to find the maximum and minimum using the formulas max(x,y)=(x+y+abs(y-x))/2 and min(x,y)=(x+y-abs(y-x))/2 instead using comparisons.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\nint main()\n{\n    int k=0, number, maximum, minimum;\n    do\n    {\n        cout&lt;&lt;\"Enter an integer: \";\n        cin&gt;&gt;number;\n        if (number==-99)\n        {\n            break;\n        }\n        if (k==0)\n        {\n            maximum=number;\n            minimum=number;\n        }\n        maximum=(maximum+number+abs(number-maximum))/2;\n        minimum=(minimum+number-abs(number-minimum))/2;\n        k++;\n    }\n    while(number!=-99);\n    cout&lt;&lt;\"The smallest entered integer is \"\n    &lt;&lt;minimum\n    &lt;&lt;\" and the largest entered integer is \"\n    &lt;&lt;maximum\n    &lt;&lt;endl;\n    return(0);\n}\n</code></pre>\n\n<p>but this time my lecturer replied and the only thing he said was that it is wrong. I have tested both of my codes few times and they show me the correct result so I have no clue what my lecturer meant by saying it is wrong. Could someone please let me know why any of the two codes above is wrong and why?</p>\n"}, {"tags": ["c++", "llvm-c++-api"], "owner": {"reputation": 320, "user_id": 7999299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pRiwA.jpg?s=128&g=1", "display_name": "Zehanort", "link": "https://stackoverflow.com/users/7999299/zehanort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558564837, "creation_date": 1558564582, "last_edit_date": 1558564837, "question_id": 56265850, "link": "https://stackoverflow.com/questions/56265850/keeping-track-of-scopes-while-generating-llvm-ir", "title": "Keeping track of scopes while generating LLVM IR?", "body": "<p>I am writing a compiler for a simple imperative language. This language allows encapsulated function definitions (like Python). These functions (their bodies) play the role of scopes, which means that if a variable <code>x</code> is declared inside a function <code>foo</code>, then it is not visible outside of it, but <code>x</code> is visible inside functions that are defined after <code>x</code>, inside <code>foo</code>. The same applies for functions and, of course, variable and function shadowing is allowed.</p>\n\n<p>Is there a standard/recommended way provided by the LLVM C++ API to keep track of which variables/functions are visible while generating LLVM IR for my language at any given moment (like a \"stack of scopes\" of sorts)? </p>\n\n<p>Right now, I keep track of these with a custom logger class of mine.</p>\n"}, {"tags": ["c++", "c++11", "valgrind", "poco-libraries"], "answers": [{"tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 0, "last_activity_date": 1558587179, "creation_date": 1558587179, "answer_id": 56268256, "question_id": 56265840, "link": "https://stackoverflow.com/questions/56265840/how-to-fix-poco-poconettcpserverparams-valgrind-definite-leak/56268256#56268256", "title": "How to fix poco Poco::Net::TCPServerParams() valgrind definite leak", "body": "<p>A common way to use <code>TCPServerParams</code> is that it works with <code>TCPServer</code> together. First you create <code>TCPServerParams</code> by <code>new</code> then it is passed into <code>TCPServer</code> which takes ownership of params. It is described in <a href=\"https://pocoproject.org/docs/Poco.Net.TCPServer.html\" rel=\"nofollow noreferrer\">reference of TCPServer</a>.</p>\n\n<blockquote>\n  <p>The server also takes ownership of the TCPServerParams object.</p>\n</blockquote>\n\n<p>so <code>TCPServer</code> deletes param instance where it is no needed.</p>\n\n<hr>\n\n<p>You cannot delete <code>TCPServerParams</code> manually by <code>delete</code> because destructor is protected.</p>\n\n<p>In Poco library many classes have protected destructor, it forces you to use <code>Poco::AutoPtr</code> class to manage lifetime of instances.</p>\n\n<p><code>TCPServerParams</code> derives from <code>RefCountedObject</code>. <code>RefCountedObject</code> provides reference counter mechanism. It has <code>release</code> method which deletes an object when the lifetime of <code>AutoPtr</code> ends.</p>\n\n<p>So you could write:</p>\n\n<pre><code>Poco::AutoPtr&lt;Poco::Net::TCPServerParams&gt; p(new Poco::Net::TCPServerParams());\n</code></pre>\n\n<p>and memory is released automatically by <code>AutoPtr</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 9747942, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gDqCEXqZcUM/AAAAAAAAAAI/AAAAAAAABn4/cGvGRv-p6x0/photo.jpg?sz=128", "display_name": "Mohammed Haroon", "link": "https://stackoverflow.com/users/9747942/mohammed-haroon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56268256, "answer_count": 1, "score": 0, "last_activity_date": 1558587196, "creation_date": 1558564471, "last_edit_date": 1558587196, "question_id": 56265840, "link": "https://stackoverflow.com/questions/56265840/how-to-fix-poco-poconettcpserverparams-valgrind-definite-leak", "title": "How to fix poco Poco::Net::TCPServerParams() valgrind definite leak", "body": "<p>I am using Poco and I am creating TCP server params as below:\nPoco::Net::TCPServerParams *pParams = new Poco::Net::TCPServerParams();</p>\n\n<p>When I use Valgring, I get definite memory leak:\n   1271 ==00:00:01:37.131 48682==    at 0x4C2903F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so\n)</p>\n\n<p>at line: Poco::Net::TCPServerParams *pParams = new Poco::Net::TCPServerParams();</p>\n\n<p>Poco version:\ndpkg -l | grep poco\nii  libpoco-dev                            1.6.1-AVA3                       amd64        C++ Portable Components (POCO) Development files\nii  libpoconet31                           1.6.1-AVA3                       amd64        C++ Portable Components (POCO) Network library</p>\n\n<p>To fix it, I used delete on the pointer and but I get an error </p>\n\n<p><code>delete pParams</code></p>\n\n<p>'TCPServerParams.h:98:10: error: \u2018virtual Poco::Net::TCPServerParams::~TCPServerParams()\u2019 is protected'</p>\n"}, {"tags": ["c++", "concurrency", "atomic"], "comments": [{"owner": {"reputation": 1038, "user_id": 9775850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbb2fe93c368d757bc6e0cfe6eaa68a?s=128&d=identicon&r=PG&f=1", "display_name": "skeller", "link": "https://stackoverflow.com/users/9775850/skeller"}, "edited": false, "score": 0, "creation_date": 1558564407, "post_id": 56265777, "comment_id": 99147904, "body": "hm...maybe consider the &quot;null object pattern&quot; and &quot;swap&quot; when loaded"}, {"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1558567530, "post_id": 56265777, "comment_id": 99148587, "body": "Aren&#39;t you reimplementing <code>std::unique_ptr&lt;&gt;</code> here, with a simple <code>swap</code> being your <code>setResource</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1558626178, "last_edit_date": 1558626178, "creation_date": 1558625368, "answer_id": 56278566, "question_id": 56265777, "link": "https://stackoverflow.com/questions/56265777/using-stdatomict-as-a-fence/56278566#56278566", "title": "Using std::atomic&lt;T*&gt; as a fence", "body": "<p>When the code does <code>delete resource.load(std::memory_order_acquire);</code> another thread may still be using the resource, so this is a race condition.</p>\n\n<p>One simple work-around is to never delete the existing resource. You can have that black texture as a global object with static storage duration that is alive during entire execution of your application.</p>\n\n<p>Another, is for <code>getResource</code> to return a <code>std::shared_ptr&lt;T&gt;</code> (by value), so that the old resource gets automatically destroyed when its last user disposes of it. E.g.:</p>\n\n<pre><code>struct NullDeleter {\n    template&lt;class T&gt;\n    void operator()(T const&amp;) {}\n};\n\ntemplate&lt;typename T&gt;\nclass Resource {\nprotected:\n    std::shared_ptr&lt;T&gt; resource;\npublic:\n    Resource(T&amp; res) : resource(&amp;res, NullDeleter{}) {}\n\n    Resource(std::shared_ptr&lt;T&gt; const&amp; res) : resource(res) {}\n\n    std::shared_ptr&lt;T&gt; getResource() {\n        return atomic_load(&amp;resource);\n    }\n\n    void setResource(std::shared_ptr&lt;T&gt; const&amp; res) {\n        atomic_store(&amp;resource, res);\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 2087, "user_id": 1248401, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1c35f8fcadd984819a7e32d982f13e87?s=128&d=identicon&r=PG", "display_name": "deniz", "link": "https://stackoverflow.com/users/1248401/deniz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558626178, "creation_date": 1558563947, "question_id": 56265777, "link": "https://stackoverflow.com/questions/56265777/using-stdatomict-as-a-fence", "title": "Using std::atomic&lt;T*&gt; as a fence", "body": "<p>I've written a Resource class below for an async resource manager. During load, a Resource object is created with the default resource (e.g. a black texture) so that the main thread that will use the Resource doesn't have to wait, even though it's a blank resource. As soon as the loading is finished, the loader thread will call setResource() and set the underlying resource to the newly loaded one. But there is also ownership involved. So when the loading is finished, the newly assigned resource will be owned by Resource class so that it can be released when Resource is destroyed or another setResource is called because file on disk has changed and needed reloading. </p>\n\n<pre><code>template &lt;typename T&gt;\nclass Resource {\n protected:\n  // Underlying object\n  std::atomic&lt;T*&gt; resource;\n\n  // Do I own resource\n  bool isOwner;\n\n  // Id of resource for faster mapping\n  uint64_t id;\n\n  // Name\n  std::string name;\n\n public:\n  Resource(T* res) : resource(res), isOwner(false), id(0), name(\"non\") {}\n\n  Resource(std::unique_ptr&lt;T&gt;&amp;&amp; res)\n      : resource(res.release()), isOwner(true), id(0), name(\"non\") {}\n\n  ~Resource() {\n    if (isOwner) delete resource.load(std::memory_order_acquire);\n  }\n\n  Resource(Resource&amp;&amp;) = default;\n\n  Resource(const Resource&amp;) = delete;\n  Resource&amp; operator=(const Resource&amp;) = delete;\n\n  T* getResource() { \n    return resource.load(std::memory_order_acquire);\n  }\n\n  void setResource(T* res, bool own = false) {\n    if (isOwner) { \n      delete resource.load(std::memory_order_acquire);\n    }\n\n    isOwner = own;\n    resource.store(res, std::memory_order_release);\n  }\n\n  void setResource(std::unique_ptr&lt;T&gt;&amp;&amp; res) {\n    if (isOwner) { \n      delete resource.load(std::memory_order_acquire);\n    }\n\n    isOwner = true;\n    resource.store(res.release(), std::memory_order_release);\n  }\n\n  void setId(uint64_t idd) { id = idd; }\n};\n</code></pre>\n\n<p>Is there a data race on isOwner or does atomic.store() act as a fence in that case? Or should I change the whole ownership approach and just use <code>std::atomic&lt;std::shared_ptr&lt;T&gt;&gt;</code> which I don't know if doable?</p>\n"}, {"tags": ["java", "c++", "swig"], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 2177366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2331c3e38435be0727ecc732fadd00ed?s=128&d=identicon&r=PG", "display_name": "getchar", "link": "https://stackoverflow.com/users/2177366/getchar"}, "is_accepted": false, "score": 0, "last_activity_date": 1558993175, "creation_date": 1558993175, "answer_id": 56332678, "question_id": 56265696, "link": "https://stackoverflow.com/questions/56265696/missing-semicolon-error-when-running-swig-on-c-header-file-that-uses-namespace/56332678#56332678", "title": "Missing semicolon error when running SWIG on c++ header file that uses namespace std", "body": "<pre><code>/* AdaptationPlanner.i */\n%module AdaptationPlanner\n%{\n/* Includes the header in the wrapper code */\n#include \"AdaptationPlanner.h\" \nusing namespace std; /* &lt;--- */\n%}\n\n/* Parse the header file to generate wrappers */\n%include \"AdaptationPlanner.h\"\n</code></pre>\n\n<p>I can't really tell why you are having an issue like that. However, care to try the above solution? Just explicitly mention the namespace in the interface file as well. </p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 2766943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38610c9cde77caf015b7643d3829bbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Arvind", "link": "https://stackoverflow.com/users/2766943/arvind"}, "is_accepted": false, "score": 0, "last_activity_date": 1588369337, "creation_date": 1588369337, "answer_id": 61551245, "question_id": 56265696, "link": "https://stackoverflow.com/questions/56265696/missing-semicolon-error-when-running-swig-on-c-header-file-that-uses-namespace/61551245#61551245", "title": "Missing semicolon error when running SWIG on c++ header file that uses namespace std", "body": "<p>I had the same error. getchar's suggestion did not resolve it. What resolved it was renaming the %module name from \"AdaptationPlanner\" to \"AdaptationPlannerSwig\" to avoid the name collision.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14987720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ea43e2fc280076a4a0c5e5e1450ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Kakaya", "link": "https://stackoverflow.com/users/14987720/kakaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1610430254, "last_edit_date": 1610430254, "creation_date": 1610420972, "answer_id": 65677521, "question_id": 56265696, "link": "https://stackoverflow.com/questions/56265696/missing-semicolon-error-when-running-swig-on-c-header-file-that-uses-namespace/65677521#65677521", "title": "Missing semicolon error when running SWIG on c++ header file that uses namespace std", "body": "<p>You must using -c++ in your swig command.</p>\n<p><strong>Example:</strong> <code>swig -java -package xxx.xxx.xxx.xxx -c++ AdaptationPlanner.i</code></p>\n"}], "owner": {"reputation": 31, "user_id": 11518367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a08e52d35a6dd53a7ba1b63512ef20?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Zhang", "link": "https://stackoverflow.com/users/11518367/frank-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 380, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1610430254, "creation_date": 1558563420, "question_id": 56265696, "link": "https://stackoverflow.com/questions/56265696/missing-semicolon-error-when-running-swig-on-c-header-file-that-uses-namespace", "title": "Missing semicolon error when running SWIG on c++ header file that uses namespace std", "body": "<p>I want to generate a wrapper file for Java from a c++ header file that uses namespace std and also includes some libraries. When I tried running swig it gives me a syntax error saying a semicolon is missing, even when my header file is from a large code base and it compiles and runs perfectly fine.</p>\n\n<p>I tried including the line \"using namespace std\" in the .i file required by swig, and also including the libraries like    that were included in the .h file, but the same error still exists.</p>\n\n<p>This is my AdaptationPlanner.h file</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// some code ...\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;set&gt;\nusing namespace std; //line 68\n// more code ...\n</code></pre>\n\n<p>And here is my AdaptationPlanner.i file</p>\n\n<pre><code>/* AdaptationPlanner.i */\n%module AdaptationPlanner\n%{\n/* Includes the header in the wrapper code */\n#include \"AdaptationPlanner.h\" \n%}\n\n/* Parse the header file to generate wrappers */\n%include \"AdaptationPlanner.h\"\n\n</code></pre>\n\n<p>And here is the error message swig gives:</p>\n\n<pre><code>AdaptationPlanner.h:68: Error: Syntax error - possibly a missing semicolon.\n</code></pre>\n"}, {"tags": ["c++", "build", "cmake", "std", "gnu-make"], "comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 1, "creation_date": 1558563385, "post_id": 56265655, "comment_id": 99147645, "body": "Have you included anything, or is your header file exactly as is?"}, {"owner": {"reputation": 129, "user_id": 5698556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/inxZT.jpg?s=128&g=1", "display_name": "Bilal Ahmed", "link": "https://stackoverflow.com/users/5698556/bilal-ahmed"}, "reply_to_user": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1558563425, "post_id": 56265655, "comment_id": 99147654, "body": "@Tas No, the header file is exactly as is."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1558563520, "post_id": 56265655, "comment_id": 99147680, "body": "@BilalAhmed <a href=\"http://coliru.stacked-crooked.com/a/22c3d731444c1bbe\" rel=\"nofollow noreferrer\">No repro</a>. Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> reproducing the problem as required please."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1558563539, "post_id": 56265655, "comment_id": 99147689, "body": "Your header file needs to include where <code>std::size_t</code> is defined if you are to use it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1558563685, "post_id": 56265655, "comment_id": 99147734, "body": "See <a href=\"https://en.cppreference.com/w/cpp/types/size_t\" rel=\"nofollow noreferrer\">this</a> for the include you can use."}, {"owner": {"reputation": 129, "user_id": 5698556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/inxZT.jpg?s=128&g=1", "display_name": "Bilal Ahmed", "link": "https://stackoverflow.com/users/5698556/bilal-ahmed"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558563839, "post_id": 56265655, "comment_id": 99147771, "body": "@NathanOliver Thanks so much."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1558570892, "post_id": 56265655, "comment_id": 99149170, "body": "Why is one statement <code>array = new int[int_size]();</code> and the other <code>array = new int[int_size];</code> (without the parens)?"}, {"owner": {"reputation": 129, "user_id": 5698556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/inxZT.jpg?s=128&g=1", "display_name": "Bilal Ahmed", "link": "https://stackoverflow.com/users/5698556/bilal-ahmed"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1558572788, "post_id": 56265655, "comment_id": 99149472, "body": "@ThomasMatthews In the first statement, the parentheses are used to initialize the array to zeros.  While in the second one, there is already a parameter called init_val that is used to initialize the array with the user passed argument."}], "answers": [{"tags": [], "owner": {"reputation": 421, "user_id": 11521482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QIrZ4uBKGpc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfy52SQZZoz_RBLxJ0jRvF-_uNwbQ/mo/photo.jpg?sz=128", "display_name": "Mathias Schmid", "link": "https://stackoverflow.com/users/11521482/mathias-schmid"}, "is_accepted": false, "score": 0, "last_activity_date": 1558564296, "creation_date": 1558564296, "answer_id": 56265820, "question_id": 56265655, "link": "https://stackoverflow.com/questions/56265655/why-do-i-get-invalid-use-of-scope-resolution-operator/56265820#56265820", "title": "Why do I get &quot;Invalid use of :: (scope resolution operator)?&quot;", "body": "<p>Add the following header file and it should work.</p>\n\n<p><code>#include &lt;cstddef&gt;</code></p>\n"}], "owner": {"reputation": 129, "user_id": 5698556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/inxZT.jpg?s=128&g=1", "display_name": "Bilal Ahmed", "link": "https://stackoverflow.com/users/5698556/bilal-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1558564296, "creation_date": 1558563103, "question_id": 56265655, "link": "https://stackoverflow.com/questions/56265655/why-do-i-get-invalid-use-of-scope-resolution-operator", "title": "Why do I get &quot;Invalid use of :: (scope resolution operator)?&quot;", "body": "<p>I'm building a data structures project using <code>cmake</code> and I built an array class. </p>\n\n<p>I used <code>std::size_t</code> as a parameter for my default constructor. \nBut when I try to build the project an error appears saying <code>Invalid use of ::</code> </p>\n\n<p>I tried <code>using namespace std;</code> but also didn't work.</p>\n\n<p>barra.h file</p>\n\n<pre><code>#ifndef BARRAY_H\n#define BARRAY_H\n\nclass BArray\n{\npublic:\n    BArray() = delete;                            //Declare the default constructor as deleted to avoid\n                                                  //declaring an array without specifying its size.\n    BArray(std::size_t);\n    BArray(int, int);                             //Constructor that initializes the array with init_val.\nprivate:\n    int* array;\n    int length;\n};\n\n#endif // BARRAY_H\n</code></pre>\n\n<p>And barray.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"barray.h\"\n\nBArray::BArray(std::size_t init_size)\n{\n    array = new int[init_size]();\n    length = init_size;\n}\n\nBArray::BArray(int init_size, int init_val)\n{\n    array = new int[init_size];\n    length = init_size;\n\n    for(int i = 0; i &lt; init_size; ++i)\n        array[i] = init_val;\n}\n\n</code></pre>\n\n<p>Error message:</p>\n\n<p>error: invalid use of <code>::</code></p>\n"}, {"tags": ["c++", "c++11"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9833551"}, "edited": false, "score": 0, "creation_date": 1558597690, "post_id": 56266232, "comment_id": 99155676, "body": "After I posed the question I &quot;realised&quot; that you can say int a = int(); and it is intuitive to think that int() is a call to some sort of default constructor which would set a to zero. I just wanted some C++ jargon to be honest :).   Thanks for the C++11 supplement as well !"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1558623454, "post_id": 56266232, "comment_id": 99170283, "body": "Sorry about missing that bit. I focused in too closely the syntax you asked about and didn&#39;t mention the really easy improvement in C++ 11, inline initialization."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 1, "last_activity_date": 1558592522, "last_edit_date": 1558592522, "creation_date": 1558567655, "answer_id": 56266232, "question_id": 56265617, "link": "https://stackoverflow.com/questions/56265617/initialising-template-variables-using-initializer-list/56266232#56266232", "title": "Initialising template variables using initializer list", "body": "<p>If this has a name, I don't know it.</p>\n\n<p>What's happening:</p>\n\n<p><code>T()</code> constructs a temporary <code>T</code> and <a href=\"https://en.cppreference.com/w/cpp/language/zero_initialization\" rel=\"nofollow noreferrer\">Zero Initializes</a> it. </p>\n\n<p><code>_mem(T())</code> makes <code>_mem</code> a copy of the temporary <code>T</code>. Note: A modern compiler will almost certainly <a href=\"https://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"nofollow noreferrer\">elide the copy</a> and simply zero initialize <code>_mem</code>. This still requires that <code>T</code> be copy-or-moveable, so <code>_mem(T())</code> and <code>_mem()</code> are not exactly the same.</p>\n\n<p>The only relevant C++ 11 difference I can think of is you can use curly braces, <code>_mem{T{}}</code>, for <a href=\"https://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">List Initialization</a>. Not useful here, but very useful in other circumstances.</p>\n"}, {"tags": [], "owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1558593469, "creation_date": 1558593469, "answer_id": 56269323, "question_id": 56265617, "link": "https://stackoverflow.com/questions/56265617/initialising-template-variables-using-initializer-list/56269323#56269323", "title": "Initialising template variables using initializer list", "body": "<p>This is just to safeguard against an uninitialized <code>A::_mem</code> when <code>T</code> is a POD type or a built-in type (like an <code>int</code>). Using a constructor initializer list of <code>: _mem(T())</code> will default construct a <code>T</code> and initialize <code>_mem</code> with it. For example:</p>\n\n<pre><code>struct POD {\n    int num;\n};\n\n// ...\n\nA&lt;POD&gt; a;\n</code></pre>\n\n<p>Here, <code>a._mem</code> would be unitialized (in this case, this means <code>a._mem.num</code> is unitialized.) The <code>: _mem(T())</code> prevents that from happening and will initialize <code>a._mem.num</code> to 0.</p>\n\n<p>However, since C++11 you can just use inline initialization instead:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass A {\npublic:\n    A() {};\nprivate:\n    T _mem{};\n};\n</code></pre>\n\n<p><code>T _mem{};</code> will default-construct <code>_mem</code>, which in turn means <code>POD::num</code> will be default-constructed, which for an <code>int</code> means it will be zero-initialized.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9833551"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56266232, "answer_count": 2, "score": 1, "last_activity_date": 1558593469, "creation_date": 1558562870, "question_id": 56265617, "link": "https://stackoverflow.com/questions/56265617/initialising-template-variables-using-initializer-list", "title": "Initialising template variables using initializer list", "body": "<p>I looked at a piece of code and I am trying to understand how it works and so here is a minimal working example </p>\n\n<pre><code>template &lt;typename T&gt;\nclass A\n{\npublic:\n    A() : _mem(T()) {};\nprivate:\n    T   _mem;\n};\n</code></pre>\n\n<p>The first thing I was not exactly clear about is the initialisation of _mem in the initialiser list. What is this technique(?) called? If I look in the debugger _mem is set to 0. If there is a c++11 way to do the same thing could I receive some comments on that?</p>\n"}, {"tags": ["python", "c++", "python-3.x"], "comments": [{"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "edited": false, "score": 0, "creation_date": 1558573803, "post_id": 56265562, "comment_id": 99149656, "body": "These lines seem extraneous: <code>Py_SetPythonHome(const_cast&lt;wchar_t*&gt;(L&quot;C:\\\\Anaconda3\\\\envs\\&zwnj;&#8203;\\Deep_Learning&quot;));</code>     <code>PyRun_SimpleString(&quot;import sys&quot;);</code>     <code>PyRun_SimpleString(&quot;sys.path.append(\\&quot;C:\\\\python_files\\&quot;)&quot;);</code>  Add the directory of your python files to your <code>PYTHONPATH</code>, this answer is helpful (<a href=\"https://stackoverflow.com/a/4855685/9238288\">stackoverflow.com/a/4855685/9238288</a>)"}, {"owner": {"reputation": 11, "user_id": 11477327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p_Mvjz48w_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfrhDbbDyW7T1OwmUBBQ68TI8cn8g/mo/photo.jpg?sz=128", "display_name": "Soumya Mohanty", "link": "https://stackoverflow.com/users/11477327/soumya-mohanty"}, "reply_to_user": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "edited": false, "score": 0, "creation_date": 1558705126, "post_id": 56265562, "comment_id": 99200070, "body": "@jackw11111 If I add my directory to PYTHONPATH then Py_Initialize() doesnt work. Nor does it solve this problem. The reason for Py_Initialize not working properly with PYTHONPATH and PYTHONHOME is explained here: <a href=\"https://stackoverflow.com/questions/5694706/py-initialize-fails-unable-to-load-the-file-system-codec\" title=\"py initialize fails unable to load the file system codec\">stackoverflow.com/questions/5694706/&hellip;</a>. Please see the third answer."}, {"owner": {"reputation": 11, "user_id": 11477327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p_Mvjz48w_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfrhDbbDyW7T1OwmUBBQ68TI8cn8g/mo/photo.jpg?sz=128", "display_name": "Soumya Mohanty", "link": "https://stackoverflow.com/users/11477327/soumya-mohanty"}, "reply_to_user": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "edited": false, "score": 1, "creation_date": 1558705699, "post_id": 56265562, "comment_id": 99200383, "body": "I managed to find a fix. But I am still uncertain about the cause of this error.  In the python program if we give the full path like &quot;C:\\\\python_files\\\\filename. Then it works fine. Same goes for loading pre-trained models in the python program as well.  This is unusual because if python can run a program successfully then, once we embed that program in C++ it should work as well. But in this case just giving the file-name (when file is in same directory as the python program) works for python, but not when it is embedded in C++."}], "owner": {"reputation": 11, "user_id": 11477327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p_Mvjz48w_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfrhDbbDyW7T1OwmUBBQ68TI8cn8g/mo/photo.jpg?sz=128", "display_name": "Soumya Mohanty", "link": "https://stackoverflow.com/users/11477327/soumya-mohanty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558573263, "creation_date": 1558562474, "last_edit_date": 1558572594, "question_id": 56265562, "link": "https://stackoverflow.com/questions/56265562/how-to-openfile-path-rb-in-a-a-python-file-that-is-embedded-in-c", "title": "How to open(&#39;file-path&#39;, &#39;rb&#39;) in a a python file that is embedded in C++?", "body": "<p>I have some C++ code which is calling a function inside a python file. If I try to read a pickled file in the python code then I get the following error:</p>\n\n<pre><code>Exception ignored in: &lt;module 'threading' from 'C:\\\\Anaconda3\\\\envs\\\\Deep_Learning\\\\lib\\\\threading.py'&gt;\nTraceback (most recent call last):\n  File \"C:\\Anaconda3\\envs\\Deep_Learning\\lib\\threading.py\", line 1289, in _shutdown\n    assert tlock.locked()\nSystemError: &lt;built-in method locked of _thread.lock object at 0x000002328D1EAAA8&gt; returned a result with an error set\n</code></pre>\n\n<p><strong>Python file:</strong></p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def test():\n    print(\"In function test of pyemb.py file \\n\")    \n    import pickle\n    with open('filepath', 'rb') as f_in:\n        C = pickle.load(f_in)\n</code></pre>\n\n<p><strong>C++ (This file is calling the python file)</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;pyhelper.hpp&gt;\n\n#include &lt;iostream&gt;\n\nint main()\n{\n    CPyInstance hInstance;\n\n\n    CPyObject pName = PyUnicode_FromString(\"pyemb\");\n    CPyObject pModule = PyImport_Import(pName);       //importing the file\n\n    if (pModule) \n    {\n        std::cout &lt;&lt; \"Module load successful\" &lt;&lt; std::endl;\n\n        CPyObject pFunc1 = PyObject_GetAttrString(pModule, \"test\"); //passing name of function to be called\n        if (pFunc1 &amp;&amp; PyCallable_Check(pFunc1)) // checking if not null and callable\n        {\n            PyObject_CallObject(pFunc1, NULL); \n        }\n        else\n        {\n            printf(\"ERROR: function test didn't run as intended\\n\");\n        }\n    }\n    else\n    {\n        printf_s(\"ERROR: Module not imported\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>C++(pyhelper.hpp to handle Py_Initialize ,Py_Finalize etc)</strong></p>\n\n<pre><code>#ifndef PYHELPER_HPP\n#define PYHELPER_HPP\n#pragma once\n\n#include &lt;Python.h&gt;\n\n// This will take care of closing the session when CPyInstance scope ends,\n// as destructor will be implicitly called to close the Py instance\nclass CPyInstance\n{\npublic:\n    CPyInstance()\n    {\n        // Setting Python home path for reading lib and bin\n        Py_SetPythonHome(const_cast&lt;wchar_t*&gt;(L\"C:\\\\Anaconda3\\\\envs\\\\Deep_Learning\"));\n\n        // Initializing Python interpreter\n        Py_Initialize(); \n\n        // Setting path for python to find our python model files \n        PyRun_SimpleString(\"import sys\");\n        PyRun_SimpleString(\"sys.path.append(\\\"C:\\\\python_files\\\")\");\n    }\n\n    ~CPyInstance()\n    {\n        Py_Finalize(); // closes the python interpreter instance\n    }\n};\n\n...More code for other stuff...\n</code></pre>\n\n<p>How can I fix this?</p>\n\n<p>Please help.</p>\n"}, {"tags": ["c++", "c++11", "c++14"], "comments": [{"owner": {"reputation": 1038, "user_id": 9775850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbb2fe93c368d757bc6e0cfe6eaa68a?s=128&d=identicon&r=PG&f=1", "display_name": "skeller", "link": "https://stackoverflow.com/users/9775850/skeller"}, "edited": false, "score": 2, "creation_date": 1558562480, "post_id": 56265551, "comment_id": 99147402, "body": "never use throw and catch for the control flow of your program, get a <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good c++ book</a>"}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 0, "creation_date": 1558562539, "post_id": 56265551, "comment_id": 99147416, "body": "Why? I mean why mess with control flow?"}, {"owner": {"reputation": 60, "user_id": 11304416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c72faadd6fe24121c6c37b354281e478?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad", "link": "https://stackoverflow.com/users/11304416/amjad"}, "reply_to_user": {"reputation": 1038, "user_id": 9775850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbb2fe93c368d757bc6e0cfe6eaa68a?s=128&d=identicon&r=PG&f=1", "display_name": "skeller", "link": "https://stackoverflow.com/users/9775850/skeller"}, "edited": false, "score": 0, "creation_date": 1558562568, "post_id": 56265551, "comment_id": 99147427, "body": "@skeller If you have another approach to skipping function calls, I will be happy to accept it."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1558562618, "post_id": 56265551, "comment_id": 99147443, "body": "@Amjad You may use a <code>std::stack</code> in a loop instead of recursion, and prune <code>N</code> push operations by <code>pop()</code>&#39;ing from it&#39;s current state."}], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 11304416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c72faadd6fe24121c6c37b354281e478?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad", "link": "https://stackoverflow.com/users/11304416/amjad"}, "edited": false, "score": 0, "creation_date": 1558563144, "post_id": 56265627, "comment_id": 99147593, "body": "This is not the problem I&#39;m trying to solve. I only posted that as an Idea. My real problem would be too big and hard to understand if I post it on here. I need to know if there is a way or hack to traversing the stack"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1558563145, "post_id": 56265627, "comment_id": 99147594, "body": "Significantly more efficient to do <code>summation(1,10) + summation(15,20)</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1558563790, "post_id": 56265627, "comment_id": 99147762, "body": "@BenVoigt,  agree with you on the efficiency front. If I understand the OP&#39;s intent correctly, they have to use <code>summation(1, 9) + summation(16, 20)</code>."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1558563882, "post_id": 56265627, "comment_id": 99147776, "body": "In the question, the ranges are [1,10] and [15, 20] which are inclusive sets.  The &quot;hole&quot; is stated as (10, 15) which is an exclusive set.  And the pseudo-code includes 15 in the count (but I guess not 10, although the final comment indicates it should be included)."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1558564096, "last_edit_date": 1558564096, "creation_date": 1558562919, "answer_id": 56265627, "question_id": 56265551, "link": "https://stackoverflow.com/questions/56265551/in-a-recursive-function-how-can-i-jump-to-a-different-function-call-on-the-stac/56265627#56265627", "title": "In a recursive function, how can I jump to a different function call on the stack?", "body": "<p>Keep the function simple.</p>\n\n<pre><code>int summation(int x, int y) {\n    if(x == y) return x;\n    return x + summation(x+1,y);\n}\n</code></pre>\n\n<p>and use</p>\n\n<pre><code>summation(1, 10) + summation(15, 20);\n</code></pre>\n\n<p>on the client side.</p>\n\n<p>You can make the client side a little bit simpler by adding another function that takes care of the numbers to skip.</p>\n\n<pre><code>int summation_with_skip(int x1, int x2, int x3, int x4) {\n   return summation(x1, x2) + summation(x3, x4);\n}\n</code></pre>\n\n<p>and use</p>\n\n<pre><code>summation_with_skip(1, 10, 15, 20);\n</code></pre>\n\n<hr>\n\n<p>If you must have the logic to skip items in the function, you can use</p>\n\n<pre><code>int summation_with_skip(int x1, int x2, int x3, int x4) \n{\n   if ( x1 &gt; x4 )\n   {\n      return 0;\n   }\n\n   int s = summation(x1+1, x2, x3, x4)\n\n   if ( (x1 &gt; x2) &amp;&amp; (x1 &lt; x3) )\n   {\n      return s;\n   }\n   else\n   {\n      return x1 + s;\n   }\n}\n</code></pre>\n\n<p>I like the idea of passing all arguments to the function.</p>\n"}, {"tags": [], "owner": {"reputation": 1038, "user_id": 9775850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbb2fe93c368d757bc6e0cfe6eaa68a?s=128&d=identicon&r=PG&f=1", "display_name": "skeller", "link": "https://stackoverflow.com/users/9775850/skeller"}, "is_accepted": false, "score": 1, "last_activity_date": 1558563325, "creation_date": 1558563325, "answer_id": 56265687, "question_id": 56265551, "link": "https://stackoverflow.com/questions/56265551/in-a-recursive-function-how-can-i-jump-to-a-different-function-call-on-the-stac/56265687#56265687", "title": "In a recursive function, how can I jump to a different function call on the stack?", "body": "<p>well, this would be a solution without throw&amp;catch</p>\n\n<p>still an odd solution for the given problem</p>\n\n<pre><code>int summation(int x, int y) \n{\n    if(x &gt; y) return 0;\n\n    if ((x &gt;= 10) &amp;&amp; (x &lt;= 15))\n    {\n        return summation(x+1, y);\n    }\n    else\n    {\n        return x + summation(x+1, y);   \n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 3, "last_activity_date": 1558563389, "creation_date": 1558563389, "answer_id": 56265692, "question_id": 56265551, "link": "https://stackoverflow.com/questions/56265551/in-a-recursive-function-how-can-i-jump-to-a-different-function-call-on-the-stac/56265692#56265692", "title": "In a recursive function, how can I jump to a different function call on the stack?", "body": "<p>In order to set the try/catch in the right stack frame, you need to know the edge of the skip interval before you recurse deeper.  Given that, it will be better to just never make the useless function calls instead of using an exception to unwind them.  For example:</p>\n\n<pre><code>int summation(int const x, int const y)\n{\n    if(x == y) return x;\n    int const next = (x==10)? 15: (x+1);  // skip from 10 to 15 directly\n    return x + summation(next, y);\n}\n</code></pre>\n\n<p>Avoiding exceptions also gives you the possibility to write the function tail-recursively:</p>\n\n<pre><code>int summation(int const x, int const y, int partial_sum = 0)\n{\n    partial_sum += x;\n    if(x == y) return partial_sum;\n\n    int const next = (x==10)? 15: (x+1);  // skip from 10 to 15 directly\n    return summation(next, y, partial_sum);\n}\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 11304416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c72faadd6fe24121c6c37b354281e478?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad", "link": "https://stackoverflow.com/users/11304416/amjad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56265692, "answer_count": 3, "score": -2, "last_activity_date": 1558564096, "creation_date": 1558562379, "question_id": 56265551, "link": "https://stackoverflow.com/questions/56265551/in-a-recursive-function-how-can-i-jump-to-a-different-function-call-on-the-stac", "title": "In a recursive function, how can I jump to a different function call on the stack?", "body": "<p>To make my question more clear, I'll give an example. Say I want to implement a recursive function that sums up the range of numbers from [1-10] and [15-20], skipping (10-15). I would want to add up [15-20] and skip the function calls on stack of (10-15), and continue with [1-10]. How can I do this? </p>\n\n<pre><code>int summation(int x, int y) {\n    if(x == y) return x;\n\n    // Catch here and return sum of 15-20 back to calls of 1-10\n    if(x == 10) \n        catch(int n) \n            return n;\n\n    int sum = x + summation(x+1,y);\n\n    // Skip function calls 10-15\n    if(x==15) throw sum;\n\n    return sum;\n\n}\n\nsummation(1,20) // &gt;&gt; 160 or [1-10] = 55, [15,20] = 105 \n</code></pre>\n\n<p>I know how to solve the above example with a different approach, but this example gives an idea of what I'm trying to do.</p>\n"}, {"tags": ["c++", "visual-c++", "crtp", "expression-templates"], "comments": [{"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1558567993, "post_id": 56265404, "comment_id": 99148669, "body": "What is a literal to you? If it is one of the built-in types (finite typelist), then yes, you can do this via <code>std::enable_if_t&lt;&gt;</code> and possibly <code>boost::mpl::vector&lt;&gt;</code> to store the typelist. If not, then you want a partial function template specialization, which is a no-go; but you can usually delegate from a generic fn template to a static fn of a class template and the latter can be partially specialized. The conceptual issue here is, however, that in some expressions you <i>might_want</i> <code>OpExpression&lt;&gt;</code> to be a literal, e.g. when you work on the meta-tree."}, {"owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "reply_to_user": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1558569128, "post_id": 56265404, "comment_id": 99148838, "body": "A literal can potentially be of type <code>std::complex&lt;&gt;</code>. Would delegating to a partially specialized class template work to generalize the overloaded operator functions? Ideally, I would want the expressions in a readable format. I also do have a list of the literal types. Re. the conceptual issue; perhaps I&#39;m misunderstanding you - the only way I use any of the <code>OpExpression</code> types is by calling the <code>eval</code> function, so would it matter if its literal or not? Ultimately, it seems I have to cast to a <code>OpLiteral</code> here."}, {"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1558569893, "post_id": 56265404, "comment_id": 99148991, "body": "The specialization with the most bound parameters wind the race. Thus, if you added a typename Dummy=void parameter, you could have the generic for void and then have enabe_if for the other ones I think."}, {"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1558570041, "post_id": 56265404, "comment_id": 99149016, "body": "As for the other part: do you say you never want to have metafunctions (functions implemented as OpExpressions that operate over OpExpressions)? If that\u2019s banned, this part is not an issue."}, {"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1558570516, "post_id": 56265404, "comment_id": 99149114, "body": "Also, SFINAE. You might typedef something in your OpExpression that you can detect (e.g. use as return type) in your overloads."}, {"owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "reply_to_user": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1558605897, "post_id": 56265404, "comment_id": 99160242, "body": "Actually yes, I will probably employ metafunctions (though I&#39;m not sure in what capacity yet). Currently, I change how the expression is treated by changing <code>eval</code> (I know the algorithm at compile time), though it might be better to apply metafunctions. Regarding your last point, that was one of my initial thoughts also, since everything inherits from <code>OpExpression</code>, I can add a typedef to check on."}], "owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558620102, "creation_date": 1558561301, "last_edit_date": 1558620102, "question_id": 56265404, "link": "https://stackoverflow.com/questions/56265404/combining-literals-with-expression-templates-based-on-crtp", "title": "Combining Literals with Expression Templates Based On CRTP", "body": "<p>This is the basic implementation I'm using for <a href=\"https://en.wikipedia.org/wiki/Expression_templates\" rel=\"nofollow noreferrer\">expression templates</a>, based on the CRTP which allows me to conveniently combine multiple types of operations without also asking <em>everything</em> to be an expression tree.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename E&gt;\nstruct OpExpression\n{\n    auto eval(iter_type n) const\n    {\n        return static_cast&lt;E const&amp;&gt;(*this).eval(n);\n    }\n};\n\ntemplate&lt;typename T&gt;\nstruct OpFrame : OpExpression&lt;OpFrame&lt;T&gt;&gt;\n{\n    T *ptr;\n    OpFrame(T *ptr) : ptr{ ptr } {}\n\n    T eval(iter_type n) const\n    {\n        return ptr[n];\n    }\n};\n\n\ntemplate&lt;typename T&gt;\nstruct OpLiteral : OpExpression&lt;OpLiteral&lt;T&gt;&gt;\n{\n    T value;\n    OpLiteral&lt;T&gt;(T value) : value{ value } {}\n\n    T eval(iter_type) const\n    {\n        return value;\n    }\n    operator T() const\n    {\n        return value;\n    }\n};\n</code></pre>\n\n<p>Here is a class to apply the addition between two values (and an operator overload to make it pretty):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename E1, typename E2&gt;\nstruct OpFrameAdd : OpExpression&lt;OpFrameAdd&lt;E1, E2&gt;&gt;\n{\n    OpFrameAdd(E1 const a, E2 const b) : a{ a }, b{ b } {}\n    auto eval(iter_type n) const\n    {\n        return a.eval(n) + b.eval(n);\n    }\n\nprotected:\n    E1 const a;\n    E2 const b;\n};\n\ntemplate&lt;typename E1, typename E2&gt;\nauto operator+(OpExpression&lt;E1&gt; const&amp; a, OpExpression&lt;E2&gt; const&amp; b)\n{\n    auto v = OpFrameAdd&lt;E1, E2&gt;(*static_cast&lt;const E1*&gt;(&amp;a), *static_cast&lt;const E2*&gt;(&amp;b));\n    return v;\n}\n</code></pre>\n\n<p>To provide some more detail/context; I have an array holding a bunch of values (could be of various types), and an arithmetic expression defining how I want to transform that array into another one. However, this transformation is not concrete, so I'm using the expression tree as something I can pass to objects that will then handle it in different ways (i.e. I have to wait to evaluate it). Additionally, I only want to define the expression once.</p>\n\n<p>I'm wondering, if based on this design, I can introduce literals (<em>without casting</em> to an <code>OpLiteral</code>) to my expressions? For example:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>double arr[100]{ 0 };\nOpFrame arr_t(arr);\n\n// I can do this\nauto ev1 = arr_t + arr_t + arr_t + OpLiteral(2.0);\n\n// But I would prefer to do this\nauto ev2 = arr_t + arr_t + arr_t + 2.0;\n</code></pre>\n\n<p>Based on my question <a href=\"https://stackoverflow.com/questions/56262451/binary-operator-for-template-class-doesnt-resolve-implicit-conversion\">here</a>, I know <code>2.0</code> won't automatically cast to the correct type, but the solution is also not compatible with this design (it causes either an ambiguous call, or in bigger expressions, mixes up the tree by applying the generic template rather than one based on <code>OpExpression&lt;T&gt;</code>).</p>\n\n<p>How I had tried to implement that solution:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename E1, typename T&gt;\nauto operator+(OpExpression&lt;E1&gt; const&amp; a, T b)\n{\n    auto v = OpFrameAdd&lt;E1, OpLiteral&lt;T&gt;&gt;(*static_cast&lt;const E1*&gt;(&amp;a), OpLiteral&lt;T&gt;(b));\n    return v;\n}\ntemplate&lt;typename E2, typename T&gt;\nauto operator+(T a, OpExpression&lt;E2&gt; const&amp; b)\n{\n    auto v = OpFrameAdd&lt;OpLiteral&lt;T&gt;, E2&gt;(OpLiteral&lt;T&gt;(a), *static_cast&lt;const E2*&gt;(&amp;b));\n    return v;\n}\n</code></pre>\n\n<p>So my questions are:</p>\n\n<p>Is it possible to augment the design to use the literal in the preferred way? If not, is this is just a limitation of the templates/design I chose? (Casting to <code>OpLiteral</code> is still a lot easier than making a new operator overload for each type and for both sides). More broadly, is there a known (different) design to deal with this problem? Have I applied this design correctly to the problem?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>With the given design, it doesn't appear possible to accept and convert another type implicitly. Ultimately, it seems the problem can be phrased as: I want to have an operation between 1) A parent class and another parent class; 2) A parent class an any other object; 3) Any class and that parent class. Obviously this is inherently problematic.</p>\n\n<p>For instance, when I attempted to remedy the ambiguous call in the above attempt, it instead results in operations between children of <code>OpExpression</code> becoming a template argument of <code>OpLiteral</code>. This is because instead of resolving the 'correct' operator (i.e. applying operator with both argument types of <code>OpExpression</code>), it will choose the one with the more generic argument type.</p>\n\n<p>The conclusion is that as it is, this is simply a limitation of the design (and for good reason).</p>\n\n<p>However, suppose I have a complete list of all the literal types I would want to use in an expression. If I don't want to create individual template specializations for each one, how would I modify the overloaded operator to use that? Would I instead have to modify the classes of <code>OpExpression</code>?</p>\n"}, {"tags": ["c++", "makefile", "g++", "makefile-errors"], "comments": [{"owner": {"reputation": 1, "user_id": 11058636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cxtpkPA-8ME/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN6rdNRpmTkvBvrfQgrKaSHi2irAQ/mo/photo.jpg?sz=128", "display_name": "sebastiaan oerlemans", "link": "https://stackoverflow.com/users/11058636/sebastiaan-oerlemans"}, "edited": false, "score": 0, "creation_date": 1558561204, "post_id": 56265361, "comment_id": 99147066, "body": "I just found this what says that i could include the .o files in my prequisites . Im going to tes this out. <a href=\"https://stackoverflow.com/questions/15440183/makefile-include-header\" title=\"makefile include header\">stackoverflow.com/questions/15440183/makefile-include-header</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1558561521, "post_id": 56265361, "comment_id": 99147160, "body": "Some possibly helpful reading: <a href=\"https://codereview.stackexchange.com/questions/2547/makefile-dependency-generation\">makefile dependency generation</a> and <a href=\"http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/\" rel=\"nofollow noreferrer\">Auto-Dependency Generation</a>"}, {"owner": {"reputation": 1, "user_id": 11058636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cxtpkPA-8ME/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN6rdNRpmTkvBvrfQgrKaSHi2irAQ/mo/photo.jpg?sz=128", "display_name": "sebastiaan oerlemans", "link": "https://stackoverflow.com/users/11058636/sebastiaan-oerlemans"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1558564284, "post_id": 56265361, "comment_id": 99147878, "body": "i tried reading it but i dont know enough about makefiles to know how to setup including the .d files. So after running: g++ -std=c++17 -MD *.cpp *.h -lncurses. I dont know what to do."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11058636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cxtpkPA-8ME/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN6rdNRpmTkvBvrfQgrKaSHi2irAQ/mo/photo.jpg?sz=128", "display_name": "sebastiaan oerlemans", "link": "https://stackoverflow.com/users/11058636/sebastiaan-oerlemans"}, "edited": false, "score": 0, "creation_date": 1558568481, "post_id": 56265967, "comment_id": 99148726, "body": "You got it i was a complete idiot i forget to add the &quot;drawterm&quot; to the &quot;g++  -o $(OBJECTS) $(LIBS)&quot;"}], "tags": [], "owner": {"reputation": 1539, "user_id": 269448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbf876e123027b9573d3a25a8a63bf6b?s=128&d=identicon&r=PG", "display_name": "Zbigniew Zag&#243;rski", "link": "https://stackoverflow.com/users/269448/zbigniew-zag%c3%b3rski"}, "is_accepted": false, "score": 1, "last_activity_date": 1558565583, "creation_date": 1558565583, "answer_id": 56265967, "question_id": 56265361, "link": "https://stackoverflow.com/questions/56265361/makefiles-and-nested-headers/56265967#56265967", "title": "Makefiles and nested headers", "body": "<p>I think that this is inferior line:</p>\n\n<pre><code>    g++ -o $(OBJECTS) $(LIBS)\n</code></pre>\n\n<p>When <code>$(OBJECTS)</code> is expanded it becomes (probably, because you didn't show declaration of OBJECTS variable):</p>\n\n<pre><code>    g++ -o main.o MovementHandle.o Cursor.o ...\n</code></pre>\n\n<p><code>-o</code> option swallows <code>main.o</code> as it's argument, so this command means basically:</p>\n\n<blockquote>\n  <p>build program <code>main.o</code> from objects <code>MovementHandle.o</code> ...</p>\n</blockquote>\n\n<p>Most probably you need to change it to something like this:</p>\n\n<pre><code>    g++ -o $@ $(OBJECTS)\n    # $@ resolves to target, which in your case will be name of executable you want\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11058636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cxtpkPA-8ME/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN6rdNRpmTkvBvrfQgrKaSHi2irAQ/mo/photo.jpg?sz=128", "display_name": "sebastiaan oerlemans", "link": "https://stackoverflow.com/users/11058636/sebastiaan-oerlemans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558950136, "creation_date": 1558561101, "last_edit_date": 1558950136, "question_id": 56265361, "link": "https://stackoverflow.com/questions/56265361/makefiles-and-nested-headers", "title": "Makefiles and nested headers", "body": "<p>My problem is with getting a makefile to run I'm new at this cause normally I just compile from the terminal or use my IDE.</p>\n\n<p>So my problem is probaly with nested header dependencies. I have files that include header files that have header files that have header files. And all those header files have a .cpp file.</p>\n\n<p>So I Googled the Internet to find a thread that said that if you have header files that include header files. You have to add those to the prequisites and that there is no way around this.</p>\n\n<p><a href=\"https://stackoverflow.com/q/5741579\">Basic Makefile and header dependencies</a></p>\n\n<p>So I tried this but my case was a little different cause my nested headers also had .cpp files. So I tried adding those to the recipe place that didn't work. So I tried to add the .cpp files that were necessary to the prequisite location. That didn't work either.</p>\n\n<pre><code>  1 OBJECTS = main.o MovementHandle.o Cursor.o PromptHandle.o \\\n  2           Prompt.o NcursesOptions.o RT_Error.o Video.o Frame.o RGB.o\n  3 \n  4 CXXFLAGS = -std=c++17 -c\n  5 LIBS = -lncurses\n  6 \n  7 drawterm : $(OBJECTS)\n  8         g++ -o $(OBJECTS) $(LIBS)\n  9 \n 10 main.o : main.cpp MovementHandle.o PromptHandle.o\n 11         g++ $(CXXFLAGS) main.cpp\n 12 \n 13 MovementHandle.o : MovementHandle.cpp MovementHandle.h Cursor.o\n 14         g++ $(CXXFLAGS) MovementHandle.cpp\n 15 \n 16 Cursor.o : Cursor.cpp Cursor.h\n 17         g++ $(CXXFLAGS) Cursor.cpp\n 18 \n 19 PromptHandle.o : PromptHandle.cpp PromptHandle.h Prompt.o Video.o\n 20         g++ $(CXXFLAGS) PromptHandle.cpp\n 21 \n 22 Prompt.o : Prompt.cpp Prompt.h Cursor.o NcursesOptions.o\n 23         g++ $(CXXFLAGS) Prompt.cpp\n 24 \n 25 NcursesOptions.o : NcursesOptions.cpp NcursesOptions.h RT_Error.o\n 26         g++ $(CXXFLAGS) NcursesOptions.cpp\n 27 \n 28 RT_Error.o : RT_Error.cpp RT_Error.h\n 29         g++ $(CXXFLAGS) RT_Error.cpp\n 30 \n 31 Video.o : Video.cpp Video.h Frame.o\n 32         g++ $(CXXFLAGS) Video.cpp\n 33 \n 34 Frame.o : Frame.cpp Frame.h RGB.o\n 35         g++ $(CXXFLAGS) Frame.cpp\n 36 \n 37 RGB.o : RGB.cpp RGB.h\n 38         g++ $(CXXFLAGS) RGB.cpp\n</code></pre>\n\n<p>So I kept getting this and I know that it means:</p>\n\n<pre><code>/usr/bin/ld: /usr/lib/gcc/x86_64-pc-linux-gnu/8.3.0/../../../../lib/Scrt1.o: in function `_start':\n    (.text+0x24): undefined reference to `main'\ncollect2: error: ld returned 1 exit status\nmake: *** [makefile:8: drawterm] Error 1\n</code></pre>\n\n<p>It means that make found a file that I haven't yet properly compiled meaning that make assumes it has a</p>\n\n<pre><code>int main()\n{\n    return 0;\n}\n</code></pre>\n\n<p>In it but it isn't finding it because it isn't intended to be interpreted like that.</p>\n"}, {"tags": ["c++", "language-lawyer", "c++17", "structured-bindings"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 3, "creation_date": 1558560348, "post_id": 56265205, "comment_id": 99146783, "body": "Disable extension on MSVC by <code>&#47;Za</code> and the code fails too."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558560382, "post_id": 56265205, "comment_id": 99146793, "body": "You&#39;re doing <code>auto&amp; x = foo();</code> Does that help answer your question?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1558560439, "post_id": 56265205, "comment_id": 99146814, "body": "@rafix07 If you have the time, explain what <code>&#47;Za</code> exactly does, and this should be an answer."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1558560823, "post_id": 56265205, "comment_id": 99146946, "body": "@Barry I closed it to the canonical."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558560907, "post_id": 56265205, "comment_id": 99146965, "body": "@NathanOliver Weird. I&#39;m pretty sure that target includes every permutation I searched for but couldn&#39;t find it anyway. Nice!"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1558561035, "post_id": 56265205, "comment_id": 99147005, "body": "Prefer <code>&#47;permissive-</code> to <code>&#47;Za</code> if you can; it makes MSVC even more standards compliant"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1558561040, "post_id": 56265205, "comment_id": 99147010, "body": "@Barry It&#39;s a tough one to find.  I actually used it in an answer of mine with the link text containing evil so when I need it I just search my answers for evil and it pops right up :)"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 1, "creation_date": 1558561477, "post_id": 56265205, "comment_id": 99147148, "body": "An insight in what&#39;s happening: <a href=\"https://cppinsights.io/lnk?code=I2luY2x1ZGU8dHVwbGU+Cgpkb3VibGUgcmVmZCA9IDUuMDsKaW50IHJlZmkgPSAxOwpkZWNsdHlwZShhdXRvKSBmb28oKXtyZXR1cm4gc3RkOjp0dXBsZTxkb3VibGUmLGludCY+e3JlZmQscmVmaX07fQoKYXV0byYmW2QsaV0gPSBmb28oKTsgLy9tc3ZjOnBhc3M=&amp;insightsOptions=cpp17&amp;std=cpp17&amp;rev=1.0\" rel=\"nofollow noreferrer\">cppinsights</a>"}], "owner": {"reputation": 311, "user_id": 4709428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcb3a36ffc611782afe81bbb6d31cb?s=128&d=identicon&r=PG&f=1", "display_name": "Neelahn", "link": "https://stackoverflow.com/users/4709428/neelahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1558560797, "answer_count": 0, "score": 2, "last_activity_date": 1558560420, "creation_date": 1558560198, "last_edit_date": 1558560420, "question_id": 56265205, "link": "https://stackoverflow.com/questions/56265205/discrepancy-compiler-output-for-structured-bindings-with-ref-qualifier-in-c17", "closed_reason": "Duplicate", "title": "Discrepancy compiler output for structured-bindings with ref-qualifier in C++17", "body": "<p>Consider the snippet below:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include&lt;tuple&gt;\n\ndouble refd = 5.0;\nint refi = 1;\ndecltype(auto) foo(){return std::tuple&lt;double&amp;,int&amp;&gt;{refd,refi};}\n\nauto&amp;[d,i] = foo(); //msvc:pass, gcc:fail, clang:fail\n</code></pre>\n\n<p>Available on <a href=\"https://godbolt.org/z/ZqLp4C\" rel=\"nofollow noreferrer\">compiler explorer</a></p>\n\n<p>In the case of gcc/clang, the error is:</p>\n\n<blockquote>\n  <p>error: cannot bind non-const lvalue reference of type <code>'std::tuple&lt;double&amp;,int&amp;&gt;&amp;'</code> to an rvalue of type <code>'std::tuple&lt;double&amp;, int&amp;&gt;'</code></p>\n</blockquote>\n\n<p>However, MSVC does not complain and compiles just fine.</p>\n\n<p>Which one is correct ?</p>\n"}, {"tags": ["c++", "sfml"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1558561244, "post_id": 56265165, "comment_id": 99147077, "body": "On line 42 you define ypos as a 16-bit variable."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1558561609, "post_id": 56265165, "comment_id": 99147181, "body": "@stark: That can hold 65536 distinct values (0 to 65535 or -32768 to +32767) so it doesn&#39;t explain wrapping at 800."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1558563923, "post_id": 56265165, "comment_id": 99147790, "body": "@BenVoigt  But on line 43 OP multiplies by 40."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1558564103, "post_id": 56265165, "comment_id": 99147826, "body": "I don&#39;t see any source code where you get your line numbers, but my understanding of the question is that a number <code>y</code> in the range 0...26 is getting multiplied by 40 to form <code>yPos</code>."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1558590813, "post_id": 56265165, "comment_id": 99152830, "body": "@stark Line 42 and 43 of what? Is there something missing on my side? I don&#39;t see any exposed code of OP."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1558591065, "post_id": 56265165, "comment_id": 99152917, "body": "Btw. if it works with <code>m_TileSprite[x][y].setPosition(0, 920);</code> but not with <code>m_TileSprite[x][y].setPosition(xPos, yPos);</code> where <code>xPos = x*40; yPos = y*40;</code>... this smells like Undefined Behavior. Have you checked the values of <code>x</code>, <code>y</code>, <code>xPos</code>, and <code>yPos</code> in debugger just before call of <code>setPosition()</code>?"}, {"owner": {"reputation": 395, "user_id": 11035837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76e561f57afd9c1d7f2d97e44c543729?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsshield", "link": "https://stackoverflow.com/users/11035837/wolfsshield"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1558617462, "post_id": 56265165, "comment_id": 99166576, "body": "@Scheff Yes. All the values of the variables match the desired values.  I checked that before asking the question hoping that the values would give me a clue.  It&#39;s almost like the window was created using resolution.y =800, but then scaled to fit 1080.  But <code>resolution.y = VideoMode::getDesktopMode().height;</code> is returning 1080."}, {"owner": {"reputation": 395, "user_id": 11035837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76e561f57afd9c1d7f2d97e44c543729?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsshield", "link": "https://stackoverflow.com/users/11035837/wolfsshield"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1558617807, "post_id": 56265165, "comment_id": 99166794, "body": "@BenVoigt Correct.  0&lt;=y&lt;27 and 0&lt;=x&lt;48 for yPos in the set of (0,40,80,...,800,840,880,920,960,1000,1040) and xPos in the set of (0,40,80,...1800,1840,1880)."}, {"owner": {"reputation": 395, "user_id": 11035837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76e561f57afd9c1d7f2d97e44c543729?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsshield", "link": "https://stackoverflow.com/users/11035837/wolfsshield"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1558618050, "post_id": 56265165, "comment_id": 99166964, "body": "@stark I also do not know where you get lines 42 and 43."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1558618906, "post_id": 56265165, "comment_id": 99167488, "body": "The line <code>yPos * 40.0;</code> doesn&#39;t do anything."}, {"owner": {"reputation": 395, "user_id": 11035837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76e561f57afd9c1d7f2d97e44c543729?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsshield", "link": "https://stackoverflow.com/users/11035837/wolfsshield"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1558619170, "post_id": 56265165, "comment_id": 99167671, "body": "@interjay that was a transfer typo"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1558619256, "post_id": 56265165, "comment_id": 99167732, "body": "You need to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem. We can&#39;t guess based on incomplete code snippets that you haven&#39;t tested."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1558624365, "post_id": 56265165, "comment_id": 99170755, "body": "There&#39;s just not enough of your code here to solve your problem."}, {"owner": {"reputation": 395, "user_id": 11035837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76e561f57afd9c1d7f2d97e44c543729?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsshield", "link": "https://stackoverflow.com/users/11035837/wolfsshield"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1558626457, "post_id": 56265165, "comment_id": 99171842, "body": "@BenVoigt Sorry, hoped the snippets would be enough because an executable variant would be bulky.  Added the variant"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1558628335, "post_id": 56265165, "comment_id": 99172777, "body": "You seem to have some redundancies here -- <code>m_TileGrid.x</code> ought to always be the same as <code>xPos</code>.  And <code>setTileSpritePos</code> doesn&#39;t seem to be called but it would also recalculate <code>m_TileGrid.x</code> and call <code>m_TileSprite[x][y].setPosition(m_TileGrid);</code> just like the for loop is already doing.  Oh now I see, that function <i>is</i> called during <code>firstDraw</code>.  Are all the calculations failing or do they disagree?  If you read back the position after you set it, do you get the original value or has it wrapped?"}, {"owner": {"reputation": 395, "user_id": 11035837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76e561f57afd9c1d7f2d97e44c543729?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsshield", "link": "https://stackoverflow.com/users/11035837/wolfsshield"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1558630063, "post_id": 56265165, "comment_id": 99173484, "body": "@BenVoigt It&#39;s wrapping even after setting.  I have multiple methods in there because I thought that some type conversion issues may have been a factor.  I gave some of it in commented form to show other methods I&#39;ve tried and setting the variables even I didn&#39;t use them on this iteration didn&#39;t seem to be a problem."}], "owner": {"reputation": 395, "user_id": 11035837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76e561f57afd9c1d7f2d97e44c543729?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsshield", "link": "https://stackoverflow.com/users/11035837/wolfsshield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558626383, "creation_date": 1558559984, "last_edit_date": 1558626383, "question_id": 56265165, "link": "https://stackoverflow.com/questions/56265165/why-is-the-setpositionxpos-ypos-wrapping-at-ypos-y40-where-y-20-ypos-800", "title": "Why is the setPosition(xPos,yPos) wrapping at yPos=y*40 where y = 20 (yPos=800)?", "body": "<p>I'm experimenting with making my own tile map. \nFirst, using Paint, I created several png images and then resized them to 40p by 40p images. (40_Brick01.png, 40_Brick02.png, 40_Water01.png, etc).</p>\n\n<p>I then loaded them to their respective Texture variables.</p>\n\n<p>I created a Sprite array of 48 by 27 to cover the 1920x1080 res screen in 40 pixal increments.\nUsing for loops and if/else statements I assigned each Sprite a texture based on the logic I used for the if else statements.\nInside these for loops I assigned positions to the Sprites using  <code>m_TileSprite[x][y].setPosition(xPos, yPos);</code> where <code>xPos = x*40; yPos = y*40;</code></p>\n\n<p>Then using embedded for loops I executed the draw command.</p>\n\n<p>Most of the screen loads fine, but the last 6 lines/rows of tiles weren't populating.</p>\n\n<p>I commented out the first block of tiles at the top of the screen and discovered the missing tiles were hiding \"under the sea\" of the just commented out tiles.</p>\n\n<p>I selected two tiles (0,23) and (0,26) and discovered they were displaying in the locations for tiles (1,2) and (1,5).  This is where I discovered that everything with a y start location greater than 800 is moving over to the next x column and proceeding from y=0.</p>\n\n<p>When I use <code>m_TileSprite[x][y].setPosition(0, 920);</code> and <code>m_TileSprite[x][y].setPosition(0, 1040);</code> instead of <code>m_TileSprite[x][y].setPosition(xPos, yPos);</code> then tiles (0,23) and (0,26) position correctly.</p>\n\n<p>I have tried multiple different ways of variablizing the input to the setPosition function but they all have the same effect.  After plugging in some debugging checks, I find that the variables are being populated to their correct respective coordinates, but somehow it is getting corrupted in the setPosition call.</p>\n\n<p><strong>Why is it wrapping when using the variables, but not when using values directly?</strong></p>\n\n<p>An alternative way of doing what I'm attempting is here: <a href=\"https://www.sfml-dev.org/tutorials/2.5/graphics-vertex-array.php\" rel=\"nofollow noreferrer\">https://www.sfml-dev.org/tutorials/2.5/graphics-vertex-array.php</a></p>\n\n<p>But I'd like to figure out why my method doesn't work before borrowing another method.</p>\n\n<p><strong>Edit:</strong>\nI've tried:</p>\n\n<pre><code>Vector2f m_TileGrid; //declared in .h\n\n//in .cpp\nm_TileGrid.x = 0.0;\nm_TileGrid.y = 0.0;\nfor (int x = 0; x &lt; 48; x++)\n{\n    for (int y = 0; y &lt; 27; y++)\n    {\n        m_TileGrid.x = x * 40.f; //Tried with just 40 as well\n        m_TileGrid.y = y * 40.f;\n        m_TileSprite[x][y].setPosition(m_TileGrid);\n    }\n}\n</code></pre>\n\n<p>I've also tried:</p>\n\n<pre><code>//in .cpp\nint xPos = 0;  //Tried with float and double\nint yPos = 0;\nfor (int x = 0; x &lt; 48; x++)\n{\n    for (int y = 0; y &lt; 27; y++)\n    {\n        xPos = x * 40.0; //Tried with just 40 as well and 40.f\n        yPos = y * 40.0;\n        m_TileSprite[x][y].setPosition(xPos,yPos);\n    }\n}\n</code></pre>\n\n<p>The only time I get anything to populate \"below\" y=800 IE where y>=840 is when I do stuff like the following:</p>\n\n<pre><code>if (y == 23 &amp;&amp; x == 0)\n{\n    m_TileSprite[x][y].setPosition(0, 920);\n}\nif (y == 26 &amp;&amp; x == 0)\n{\n    m_TileSprite[x][y].setPosition(0, 1040);\n}\n</code></pre>\n\n<p><strong>Additional Info:</strong>\nI just discovered that it is setting the positions for this Sprites before the window size is defined.  This shouldn't matter as the draw command doesn't happen until after the window size is defined.  Unless it is doing some pre-processing on my variables and wrapping them before the window is defined.  As the positions do not change it cannot correct that in the while loop that refreshes the screen, redrawing everything.  Where as if I put a direct value in- a constant, mayhaps no pre-processing is occurring. <strong>Doesn't seem to be the case as I have now tried setting the position after the window creation.</strong></p>\n\n<p>I don't know if I can get the sample code any smaller and still demonstrate the effect:  </p>\n\n<pre><code>//Tim.h\n//Adopted and adapted from Bob.h from http://gamecodeschool.com/sfml/building-a-simple-game-engine-in-c-plus-plus/\n#pragma once\n#include &lt;SFML/Graphics.hpp&gt;\n\nusing namespace sf;\n\nclass Tim\n{\nprivate:\n    Vector2f m_TileGrid;\n    Texture m_Cobble01, m_Water05;\n\n    Sprite m_TileSprite[48][21];\n\n\npublic:\n    Tim();\n    Sprite getTileSprite(int, int);\n    void setTileSpritePos(int, int);\n\n};\n\n//Tim.cpp\n//Adopted and adapted from Bob.ccp from http://gamecodeschool.com/sfml/building-a-simple-game-engine-in-c-plus-plus/\n#include \"stdafx.h\"\n#include \"Tim.h\"\n\nTim::Tim()\n{\n\n    m_Cobble01.loadFromFile(\"C:\\\\Visual Studio Stuff\\\\Projects\\\\Simple Game Engine\\\\Simple Game Engine\\\\40_Cobble01.png\");\n    m_Water05.loadFromFile(\"C:\\\\Visual Studio Stuff\\\\Projects\\\\Simple Game Engine\\\\Simple Game Engine\\\\40_Water05.png\");\n    sf::Vector2f position;\n    m_TileGrid.x = 0.0;\n    m_TileGrid.y = 0.0;\n    float xPos = 0.f, yPos = 0.f;\n    for (int x = 0; x &lt; 48; x++)\n    {\n        yPos = 0;\n        for (int y = 0; y &lt; 27; y++)\n        {\n            m_TileGrid.x = x * 40.f; m_TileGrid.y = y * 40.f;\n            //m_TileSprite[x][y].setPosition(xPos, yPos);\n            if (y &lt; 20)\n            {\n                m_TileSprite[x][y].setTexture(m_Water05);\n            }\n            else \n            {\n                m_TileSprite[x][y].setTexture(m_Cobble01);\n            }\n            m_TileSprite[x][y].setPosition(xPos, yPos);\n            yPos += 40;\n        }\n        xPos += 40;\n    }\n}\n\nSprite Tim::getTileSprite(int x, int y)\n{\n    return m_TileSprite[x][y];\n}\nvoid Tim::setTileSpritePos(int x, int y)\n{\n    m_TileGrid.x = x*40.f;\n    m_TileGrid.y = y*40.f;\n    m_TileSprite[x][y].setPosition(m_TileGrid);\n    //m_TileSprite[x][y].sf::Transformable.m_position.x = m_TileGrid.x;\n    //m_TileSprite[x][y].sf::Transformable.m_position.y = m_TileGrid.y;\n    //  setPosition(m_TileGrid);\n}\n\n//Engine.h\n//Adopted and adapted from Engine.h from http://gamecodeschool.com/sfml/building-a-simple-game-engine-in-c-plus-plus/\n#pragma once\n#include &lt;SFML/Graphics.hpp&gt;\n#include \"Tim.h\";\n\nusing namespace sf;\n\nclass Engine\n{\nprivate:\n    RenderWindow m_Window;\n    Tim m_Tim;\n    void draw();\n    void firstDraw();\n\npublic:\n    Engine();\n    void start();\n\n};\n\n//Engine.cpp  -variant\n//Adopted and adapted from Engine.cpp from http://gamecodeschool.com/sfml/building-a-simple-game-engine-in-c-plus-plus/\n#include \"stdafx.h\"\n#include \"Engine.h\"\n\nEngine::Engine()\n{\n    Vector2f resolution;\n    resolution.x = VideoMode::getDesktopMode().width;\n    resolution.y = VideoMode::getDesktopMode().height;\n\n    m_Window.create(VideoMode(resolution.x, resolution.y),\n        \"Simple Game Engine\",\n        Style::Fullscreen);\n\n\n\n}\n\nvoid Engine::start()\n{\n    firstDraw();\n    while (m_Window.isOpen())\n    {\n        if (Keyboard::isKeyPressed(Keyboard::Escape))\n        {\n            m_Window.close();\n        }\n    }\n}\n\n//Draw.ccp\n//Adopted and adapted from Draw.cpp from http://gamecodeschool.com/sfml/building-a-simple-game-engine-in-c-plus-plus/\n#include \"stdafx.h\"\n#include \"Engine.h\"\n\nvoid Engine::firstDraw()\n{\n    for (int x = 0; x &lt; 48; x++)\n    {\n        for (int y = 0; y &lt; 27; y++)\n        {\n            m_Tim.setTileSpritePos(x, y);\n        }\n    }\n\n    draw();\n}\nvoid Engine::draw()\n{\n    m_Window.clear(Color::White);\n\n    for (int x = 0; x &lt; 48; x++)\n    {\n        for (int y = 0; y &lt; 27; y++)\n        {\n            if (y&gt;8)\n            {\n                m_Window.draw(m_Tim.getTileSprite(x, y));\n            }\n        }\n    }\n    m_Window.display();\n}\n\n//Main.cpp\n//Adopted and adapted from Main.cpp from http://gamecodeschool.com/sfml/building-a-simple-game-engine-in-c-plus-plus/\n#include \"stdafx.h\"\n#include \"Engine.h\"\n\nint main()\n{\n    Engine engine;\n\n    engine.start();\n\n    return 0;\n}\n</code></pre>\n\n<p>The \"water\" at the top, above the white - should actually be \"cobble\" and below where the cobble line at the bottom is.</p>\n"}, {"tags": ["c++", "linux", "exec"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558559907, "post_id": 56265119, "comment_id": 99146646, "body": "Why don&#39;t you add const in the type iso casting it away?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1558560120, "post_id": 56265119, "comment_id": 99146709, "body": "<code>char* arg0 = &quot;link&quot;</code> should also be problematic, as <code>const</code> (or cast here) is missing too..."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558560407, "post_id": 56265119, "comment_id": 99146805, "body": "I am not sure, but will the lifetimes of <code>dev</code> and <code>status</code> matter here?  You&#39;re calling <code>execv</code> and populating it with strings returned by <code>std::string</code>&#39;s that go out of scope after <code>main</code> exits."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558561034, "post_id": 56265119, "comment_id": 99147004, "body": "Can you take parameter by value, instead of const ref? (a way to remove <code>const</code>, and if copy would have be done in function (as suggested in answer, it might avoid an extra copy))."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 1979344, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e34a0ea3f2a6b8464e79c89d9ba9808c?s=128&d=identicon&r=PG", "display_name": "stcheng", "link": "https://stackoverflow.com/users/1979344/stcheng"}, "edited": false, "score": 0, "creation_date": 1558560262, "post_id": 56265148, "comment_id": 99146758, "body": "The issue with this approach is that <code>execv</code> is taking <code>char *const</code>. If I&#39;m passing <code>char const*</code>, it will throw error <code>invalid conversion from \u2018const char**\u2019 to \u2018char* const*\u2019</code>."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 133, "user_id": 1979344, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e34a0ea3f2a6b8464e79c89d9ba9808c?s=128&d=identicon&r=PG", "display_name": "stcheng", "link": "https://stackoverflow.com/users/1979344/stcheng"}, "edited": false, "score": 0, "creation_date": 1558560387, "post_id": 56265148, "comment_id": 99146797, "body": "@stcheng Yeah, that&#39;s why I also gave how to get <code>char*</code>s instead of <code>char const*</code>s."}, {"owner": {"reputation": 133, "user_id": 1979344, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e34a0ea3f2a6b8464e79c89d9ba9808c?s=128&d=identicon&r=PG", "display_name": "stcheng", "link": "https://stackoverflow.com/users/1979344/stcheng"}, "edited": false, "score": 0, "creation_date": 1558560483, "post_id": 56265148, "comment_id": 99146829, "body": "just updated my question, the two strings are also const :("}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1558561094, "post_id": 56265148, "comment_id": 99147031, "body": "As you copy arguments, taking them by copy might make sense."}], "tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": false, "score": 1, "last_activity_date": 1558560633, "last_edit_date": 1558560633, "creation_date": 1558559908, "answer_id": 56265148, "question_id": 56265119, "link": "https://stackoverflow.com/questions/56265119/how-to-convert-from-a-string-array-to-a-char-array-array/56265148#56265148", "title": "How to convert from a string array to a char array array?", "body": "<p>It's probably best to declare <code>args</code> as an array of <code>char const*</code>:</p>\n\n<pre><code>char const* args[] = {\"link\", \"set\", \"dev\", dev.c_str(), status.c_str()};\n</code></pre>\n\n<p>However, if you truly need a <code>char*</code> and not a <code>char const*</code>, as <code>execv</code> requires, we need <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/data\" rel=\"nofollow noreferrer\"><code>std::string::data</code></a>:</p>\n\n<pre><code>void f(const string &amp;dev_, const string &amp;status_){\n  // Note: string literals don't convert to char* in C++,\n  // although some compilers allow it as an extension.\n\n  // Declare these as arrays so we can form `char*`s to them:\n  char link[] = \"link\";\n  char set[] = \"set\";\n  char dev_lit[] = \"dev\";\n\n  // No choice but to copy the const args:\n  std::string dev{dev_};\n  std::string status{status_};\n\n  // C++17-specific:\n  char* args[] = {link, set, dev_lit, dev.data(), status.data()};\n  execv(\"/sbin/ip\", args);\n}\n</code></pre>\n\n<p>Before C++17, you can use <code>&amp;status[0]</code> rather than <code>status.data()</code>, which is correct even if <code>status.size() == 0</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558560199, "post_id": 56265163, "comment_id": 99146732, "body": "BTW, <code>&quot;link&quot;</code> is still not a <code>char*</code>."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558560250, "post_id": 56265163, "comment_id": 99146755, "body": "@Jarod42, true."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1558560934, "post_id": 56265163, "comment_id": 99146975, "body": "This is C++, not C. Don&#39;t use <code>strdup</code>, use a <code>std::string</code> copy. Besides, heap-allocating memory for the string literals is wasteful."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1558560613, "last_edit_date": 1558560613, "creation_date": 1558559979, "answer_id": 56265163, "question_id": 56265119, "link": "https://stackoverflow.com/questions/56265119/how-to-convert-from-a-string-array-to-a-char-array-array/56265163#56265163", "title": "How to convert from a string array to a char array array?", "body": "<blockquote>\n  <p>The code does not look nice. Is there a better solution?</p>\n</blockquote>\n\n<p>For what it's worth, use of</p>\n\n<pre><code>char* args[] = {\"link\", \"set\", \"dev\", ... };\n</code></pre>\n\n<p>is wrong to start with. String literals can decay to <code>char const*</code>, not <code>char*</code>.</p>\n\n<p>I suggest use of a helper function that uses <code>strdup</code> to give you a copy of the input string.</p>\n\n<pre><code>char* toArg(std::string const&amp; s)\n{\n    return strdup(s.c_str());\n}\n</code></pre>\n\n<p>and use</p>\n\n<pre><code>char* args[] = {toArg(\"link\"), toArg(\"set\"), toArg(\"dev\"), toArg(dev), toArg(status)};\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 1979344, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e34a0ea3f2a6b8464e79c89d9ba9808c?s=128&d=identicon&r=PG", "display_name": "stcheng", "link": "https://stackoverflow.com/users/1979344/stcheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558560633, "creation_date": 1558559734, "last_edit_date": 1558560437, "question_id": 56265119, "link": "https://stackoverflow.com/questions/56265119/how-to-convert-from-a-string-array-to-a-char-array-array", "title": "How to convert from a string array to a char array array?", "body": "<p>I want to pass an array of arguments to exec() function. The current parameters are all strings. How could I convert the array of string into the array of char array?</p>\n\n<p>Right now I'm using const_cast to remove the const. The code does not look nice.\nIs there a better solution?</p>\n\n<p>Sample code looks like:</p>\n\n<pre><code>void f(const string &amp;dev, const string &amp;status){\n\n  char* args[] = {\"link\", \"set\", \"dev\", const_cast&lt;char*&gt;(dev.c_str()), \n  const_cast&lt;char*&gt;(status.c_str())};\n  execv(\"/sbin/ip\", args);\n}\n</code></pre>\n"}, {"tags": ["c++", "dynamic-cast"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1558559337, "post_id": 56265039, "comment_id": 99146415, "body": "<code>a</code> is not a <code>B*</code>.  Why are you expecting it to work?"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558559457, "post_id": 56265039, "comment_id": 99146469, "body": "a ain&#39;t a B, you can only cast to a type that was used in the creation (or one of its bases)"}, {"owner": {"reputation": 1484, "user_id": 11102572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c83b6b17eb13d31ab7c5d1ac554ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Igor G", "link": "https://stackoverflow.com/users/11102572/igor-g"}, "edited": false, "score": 0, "creation_date": 1558559472, "post_id": 56265039, "comment_id": 99146478, "body": "<code>B* down = down</code>?"}, {"owner": {"reputation": 27, "user_id": 7269235, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/114c66e128556bd9b07232479450666d?s=128&d=identicon&r=PG&f=1", "display_name": "NewUser2810", "link": "https://stackoverflow.com/users/7269235/newuser2810"}, "edited": false, "score": 0, "creation_date": 1558559738, "post_id": 56265039, "comment_id": 99146589, "body": "Ah now it makes sense, i thought i need a A* to upcast a pointer from derived class"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558561186, "post_id": 56265039, "comment_id": 99147057, "body": "@NewUser2810 <code>down-&gt;print();</code> is <i>undefined behavior</i>. Anything can happen."}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558561057, "post_id": 56265109, "comment_id": 99147021, "body": "That only answers half of the question. What is happening with <code>down</code>?"}, {"owner": {"reputation": 1484, "user_id": 11102572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c83b6b17eb13d31ab7c5d1ac554ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Igor G", "link": "https://stackoverflow.com/users/11102572/igor-g"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558561357, "post_id": 56265109, "comment_id": 99147113, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, it&#39;s been answered by NathanOliver before me: &quot;<code>a</code> is not a <code>B*</code>&quot;."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1558561552, "post_id": 56265109, "comment_id": 99147167, "body": "@Nathan didn&#39;t write an answer, but left a comment pointing out the one half of the issue. Answers should be self contained and complete (as is <a href=\"https://stackoverflow.com/a/56265241/1413395\">this one</a>). You may put a link to <a href=\"https://stackoverflow.com/questions/56265039/downcast-from-base-to-derive/56265109?noredirect=1#comment99146415_56265039\">Nathan&#39;s comment</a> to credit them for their contribution and put in the missing part."}, {"owner": {"reputation": 1484, "user_id": 11102572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c83b6b17eb13d31ab7c5d1ac554ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Igor G", "link": "https://stackoverflow.com/users/11102572/igor-g"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558562203, "post_id": 56265109, "comment_id": 99147327, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, sorry. I&#39;ll fix my answer once I get home to a PC. However, even with a due credit, I still feel embarrassed about writing essentially the same explanation as was given above. Would you say that I&#39;d better just delete my semi-answer?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558562359, "post_id": 56265109, "comment_id": 99147378, "body": "<i>&quot;Would you say that I&#39;d better just delete my semi-answer?&quot;</i> No, better shape it to completeness, as soon you have access to your PC."}, {"owner": {"reputation": 1484, "user_id": 11102572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c83b6b17eb13d31ab7c5d1ac554ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Igor G", "link": "https://stackoverflow.com/users/11102572/igor-g"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558570338, "post_id": 56265109, "comment_id": 99149086, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, Done."}], "tags": [], "owner": {"reputation": 1484, "user_id": 11102572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c83b6b17eb13d31ab7c5d1ac554ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Igor G", "link": "https://stackoverflow.com/users/11102572/igor-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1558570309, "last_edit_date": 1558570309, "creation_date": 1558559638, "answer_id": 56265109, "question_id": 56265039, "link": "https://stackoverflow.com/questions/56265039/downcast-from-base-to-derive/56265109#56265109", "title": "Downcast from Base to Derive", "body": "<p>Ability to cast from Base to Derived and from Derived to Base isn't the unique distinguishing feature of <code>dynamic_cast</code>. The key feature is that <code>dynamic_cast</code> performs such conversion <em>at runtime</em>, after checking that the most derived object <em>actually matches</em> (or <em>actually contains</em>) the desired target type. Which means that an error, if the conversion was unsuccessful, is also a run-time error, and that your program should be prepered to handle such errors at runtime.</p>\n\n<p>What errors could those be? <code>dynamic_cast</code> may report an error either by returning a null pointer if you were casting between pointer types, say <code>X*</code> to <code>Y*</code>, or by throwing a <code>std::bad_cast</code> exception if you were casting between reference types, like <code>X&amp;</code> to <code>Y&amp;</code>.</p>\n\n<p>Casting from <code>a</code> with the static type <code>A*</code> to <code>B*</code> could yield either valid pointer to <code>B</code> or null. The latter is exactly what happened in your example: <code>a</code> actually points to a complete object of type <code>A</code>, and there's no subobject of type <code>B</code> in it. So the cast returns null pointer which is then immediately used to call a member function <code>down-&gt;print()</code>. Any attempt to dereference the null pointer value is UB (undefined behaviour), which may well manifest as a segfault.</p>\n\n<p>Protecting your program from such segfault is easy: just check that the value returned isn't null:</p>\n\n<pre><code>B* down = dynamic_cast&lt;B*&gt;(a);\nif (down)\n{\n    // Use down all you want\n}\nelse\n{\n    // Report an error, skip some actions\n    // or return from the function.\n    // But don't use `down`!\n}\n</code></pre>\n\n<p>As for printing \"from D\", that's because <code>print</code> method is declared virtual. It means that the implementation from the most derived class will get called even though you call it via a pointer to a base subobject.</p>\n"}, {"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558561941, "post_id": 56265241, "comment_id": 99147257, "body": "Mentioning <i>undefined behavior</i> regarding the <code>down</code> case would be a good idea."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558568604, "post_id": 56265241, "comment_id": 99148750, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Done. Thanks."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 2, "last_activity_date": 1558568592, "last_edit_date": 1558568592, "creation_date": 1558560461, "answer_id": 56265241, "question_id": 56265039, "link": "https://stackoverflow.com/questions/56265039/downcast-from-base-to-derive/56265241#56265241", "title": "Downcast from Base to Derive", "body": "<p>When using <code>dynamic_cast</code> to convert a pointer, you need to check the resulting pointer to see if the cast had been valid before accessing it. Accessing an invalid pointer results in undefined behavior.</p>\n\n<pre><code>    B* down = dynamic_cast&lt;B*&gt;(a);\n    if (down == 0) {\n        std::cerr &lt;&lt; \"a is not a B!\\n\";\n    } else {\n        down-&gt;print();\n    }\n</code></pre>\n\n<p>You do not need to use <code>dynamic_cast</code> for \"up casting\". You are allowed to assign the derived to a parent. If the relationship doesn't exist, you will get a compile time error.</p>\n\n<pre><code>    A* up= d;\n    up-&gt;print();\n</code></pre>\n\n<p>Since <code>print</code> is a virtual method, <code>up-&gt;print()</code> resolves to the implementation of the derived. However, if you wish to see the base's implementation, you can call it explicitly.</p>\n\n<pre><code>    d-&gt;A::print();\n</code></pre>\n\n<p><a href=\"https://tio.run/##rZHRaoMwFIbv8xRn7kZLhV1HKxh9jMFIk3QENAYTW0Zxr@6iia3QDcZYIBA@zn@@H2Vap@@MTc9SsWbgAnLZGdsL2hYTa6gxUKIrAtDDsZEMu9dZ9nagDXyWcXIdYUPOneSge6lsnDg8xwCM5RizbrCQ5xCd@q6FMsrzBQvFm8xNjfPNkPcRfN/orQ8V4Ncq8qgaM/An@Cr8f7rqZ12w1Xi1kP36qv7sq7/zIYRcEFoqlftDS7TcwREOoMQFSLYSFkh1IzyQ@kZoIKXbOiPihrqLcpR/KNpK9saosTnZFTFNfEqeIPYzB3hJQvd7f9H3S38K0oDqrFOQp1cV@fAIojFiE5o3pUX4FGEGre0G7Xp4OOjN1EJ4WpQY39g4TV8\" rel=\"nofollow noreferrer\" title=\"C++ (gcc) \u2013 Try It Online\">Try it online!</a></p>\n"}], "owner": {"reputation": 27, "user_id": 7269235, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/114c66e128556bd9b07232479450666d?s=128&d=identicon&r=PG&f=1", "display_name": "NewUser2810", "link": "https://stackoverflow.com/users/7269235/newuser2810"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1558570309, "creation_date": 1558559259, "last_edit_date": 1558559556, "question_id": 56265039, "link": "https://stackoverflow.com/questions/56265039/downcast-from-base-to-derive", "title": "Downcast from Base to Derive", "body": "<p>I am learning dynamic cast and search a lot of websites and I came to the conclusion that dynamic cast can cast from base to derive and derive to base.\nHowever when I cast from Base to derive it gives a segmentation fault.\nThis is the code:</p>\n\n<p>I expect from up a \"from A\" but it gives me a from D even after casting</p>\n\n<pre><code>\nclass A\n{\n  public:\n  virtual ~A(){} \n  virtual void print()\n  {\n    std::cout &lt;&lt; \"from A\"&lt;&lt;std::endl;\n  }\n  };\nclass B:  virtual public A\n{\n  public:\n    void print()\n  {\n    std::cout &lt;&lt; \"from B\"&lt;&lt;std::endl;\n  }\n};       \nclass C: virtual public A\n{\n  public:\n    void print()\n  {\n    std::cout &lt;&lt; \"from C\"&lt;&lt;std::endl;\n  }\n};      \nclass D: public B, public C\n{\n  public:\n    void print()\n  {\n    std::cout &lt;&lt; \"from D\"&lt;&lt;std::endl;\n  }\n};\n\n\nint main(){\n    A* b = new B;\n    A* c = new C;\n    A* d = new D;\n    A* a = new A;\n\n    B* down = dynamic_cast&lt;B*&gt;(a);  // this gives me problem\n    down-&gt;print();\n\n    A* up= dynamic_cast&lt;A*&gt;(d); // upcasten dont print from A either\n    up-&gt;print();\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "unique-lock"], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 5, "last_activity_date": 1558559777, "creation_date": 1558559777, "answer_id": 56265126, "question_id": 56264918, "link": "https://stackoverflow.com/questions/56264918/why-stdlock-causes-the-endless-loop-when-works-with-my-own-unique-lock-objec/56265126#56265126", "title": "Why std::lock() causes the endless loop when works with my own unique_lock object?", "body": "<p>Change <code>std::ref(m_b), std::ref(m_b)</code> to <code>std::ref(m_b), std::ref(m_c)</code>.  Copy/paste typo.</p>\n\n<p>Your <code>std::lock</code> is trying to lock <code>m_b</code> twice.</p>\n\n<p>Other issues: you violate rule of 0/3/5.  You have multiple different near-identical lock fiddling for lock/unlock code (refactor).</p>\n"}], "owner": {"reputation": 5, "user_id": 11541564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MFzflda3jbE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFSiInVya21uvbygRJZt51fhEFQQ/mo/photo.jpg?sz=128", "display_name": "Yevhenii Molodtsov", "link": "https://stackoverflow.com/users/11541564/yevhenii-molodtsov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56265126, "answer_count": 1, "score": 0, "last_activity_date": 1558559777, "creation_date": 1558558655, "question_id": 56264918, "link": "https://stackoverflow.com/questions/56264918/why-stdlock-causes-the-endless-loop-when-works-with-my-own-unique-lock-objec", "title": "Why std::lock() causes the endless loop when works with my own unique_lock object?", "body": "<p>I am trying to implement the analog of unique_lock (it's just studying task, I understand that standard library implementation works perfectly).</p>\n\n<p>I've already written all the methods that I need and now I am trying to test my code on the example from <a href=\"https://en.cppreference.com/w/cpp/thread/unique_lock/unique_lock\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/thread/unique_lock/unique_lock</a>. </p>\n\n<p>When it comes to    std::lock(lk_b, lk_c);    the infinite loop starts.</p>\n\n<p>I did some cout's to understand where the program loses control and the result is the following: lock -> try -> unlock -> lock -> try -> unlock.</p>\n\n<p>Here is partial unique_lock implementation (I included only those methods, which are used in the problem part of the example).</p>\n\n<pre><code>template&lt;typename Mutex&gt;\nclass my_unique_lock {\n    Mutex *lockable;\n    bool is_acquired;\npublic:\n    explicit my_unique_lock(Mutex&amp; m): lockable{&amp;m}, is_acquired{true}{\n        lockable-&gt;lock();\n        //std::cout &lt;&lt; \"constructor my_unique_lock(Mutex&amp; m)\" &lt;&lt; std::endl;\n    }\n\n    my_unique_lock(Mutex&amp; m, std::defer_lock_t t): lockable{&amp;m}, is_acquired{false}{\n        std::cout &lt;&lt; \"constructor my_unique_lock(Mutex&amp; m, std::defer_lock_t t)\" &lt;&lt; std::endl;\n    }\n\n    bool try_lock(){\n        std::cout &lt;&lt; \"try_lock\" &lt;&lt; std::endl;\n        if(lockable == nullptr)\n            throw std::system_error();\n        is_acquired = mutex()-&gt;try_lock();\n        return is_acquired;\n    }\n\n    void lock(){\n        std::cout &lt;&lt; \"lock\" &lt;&lt; std::endl;\n        if(lockable == nullptr || owns_lock())\n            throw std::system_error();\n        mutex()-&gt;lock();\n        is_acquired = true;\n    }\n\n    void unlock(){\n        //std::cout &lt;&lt; \"unlock\" &lt;&lt; std::endl;\n        if(lockable == nullptr || !owns_lock())\n            throw std::system_error();\n        mutex()-&gt;unlock();\n        is_acquired = false;\n        std::cout &lt;&lt; \"unlocked\" &lt;&lt; std::endl;\n    }\n\n    Mutex *mutex() const noexcept {\n        //std::cout &lt;&lt; \"*mutex()\" &lt;&lt; std::endl;\n        return lockable;\n    }\n\n    bool owns_lock() const noexcept {\n        //std::cout &lt;&lt; \"owns_lock()\" &lt;&lt; std::endl;\n        return lockable != nullptr &amp;&amp; is_acquired;\n    }\n\n    ~my_unique_lock(){\n        //std::cout &lt;&lt; \"destructor\" &lt;&lt; std::endl;\n        if(mutex() != nullptr &amp;&amp; owns_lock()){\n            mutex()-&gt;unlock();\n            is_acquired = false;\n        }\n    }\n};\n</code></pre>\n\n<p>And here is the example.</p>\n\n<pre><code>\nvoid update(std::mutex &amp;m_a, std::mutex &amp;m_b, std::mutex &amp;m_c, int &amp;a, int &amp;b, int &amp;c)\n{\n    {   \n        my_unique_lock&lt;std::mutex&gt; lk(m_a);\n        a++;\n    }\n\n    { \n        my_unique_lock&lt;std::mutex&gt; lk_b(m_b, std::defer_lock);\n        my_unique_lock&lt;std::mutex&gt; lk_c(m_c, std::defer_lock);\n        std::lock(lk_b, lk_c);\n        b = std::exchange(c, b + c);\n    }\n}\n\nint main()\n{\n    std::mutex m_a, m_b, m_c;\n    int a, b, c = 1;\n\n    std::vector&lt;std::thread&gt; threads;\n    for (unsigned i = 0; i &lt; 1; ++i)\n        threads.emplace_back(update, std::ref(m_a), std::ref(m_b), std::ref(m_b), std::ref(a), std::ref(b), std::ref(c));\n\n    for (auto&amp; i: threads)\n        i.join();\n\n    std::cout &lt;&lt; a &lt;&lt; \"'th and \" &lt;&lt; a+1 &lt;&lt; \"'th Fibonacci numbers: \"\n              &lt;&lt; b &lt;&lt; \" and \" &lt;&lt; c &lt;&lt; '\\n';\n}\n\n</code></pre>\n\n<p>So, as I said, I don't really understand why lock() causes the endless loop with such a chain of calls (lock -> try_lock -> unlocked).</p>\n"}, {"tags": ["c++", "class", "overloading", "operator-keyword"], "comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 1, "creation_date": 1558558711, "post_id": 56264886, "comment_id": 99146155, "body": "Please <a href=\"http://format.krzaq.cc/\" rel=\"nofollow noreferrer\">format your code</a> properly."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558558734, "post_id": 56264886, "comment_id": 99146164, "body": "Change <code>ostream&amp; operator&lt;&lt;(ostream&amp; out, Rational&amp; r)</code> to <code>ostream&amp; operator&lt;&lt;(ostream&amp; out, const Rational&amp; r)</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558559359, "post_id": 56264886, "comment_id": 99146424, "body": "Missing <code>const</code> also for <code>operator+</code>."}, {"owner": {"reputation": 1, "user_id": 11541258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Z-wRKRLinZ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcidH8EaU3lWji1XZWDx7fe6g_Bsw/mo/photo.jpg?sz=128", "display_name": "Alex Topirceanu", "link": "https://stackoverflow.com/users/11541258/alex-topirceanu"}, "edited": false, "score": 0, "creation_date": 1558559813, "post_id": 56264886, "comment_id": 99146617, "body": "I did that and it gave me an E1086 The object has type qualifiers that are not compatible with the member function &quot;Pereche::getA&quot; The object has type qualifiers that are not compatible with the member function &quot;Pereche::getB&quot; but I fixed it by overloading the &lt;&lt; operator in my base class which is Pereche, and Rational being derived from it. Thanks for your help"}], "owner": {"reputation": 1, "user_id": 11541258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Z-wRKRLinZ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcidH8EaU3lWji1XZWDx7fe6g_Bsw/mo/photo.jpg?sz=128", "display_name": "Alex Topirceanu", "link": "https://stackoverflow.com/users/11541258/alex-topirceanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "closed_date": 1558558758, "answer_count": 0, "score": 0, "last_activity_date": 1558558497, "creation_date": 1558558497, "question_id": 56264886, "link": "https://stackoverflow.com/questions/56264886/how-do-i-overload-the-operator-to-print-two-summed-class-objects-that-are-are", "closed_reason": "Duplicate", "title": "How do I overload the &lt;&lt; operator to print two summed class objects that are are summed by overloading the + operator?", "body": "<blockquote>\n  <p>I want to print the result of a sum of two class objects,rational \n    numbers, like cout &lt;&lt; a + b, where a and b are objects of my class, \n     numerator and denominator. I overloaded the + operator and the &lt;&lt; \n     operator, and they work flawlessly if used separately, like c = a + b; cout \n     &lt;&lt; c; But when I use them simultaneously, like cout &lt;&lt; a + b, it gives \n     E0349 \"no operator \"&lt;&lt;\" matches these operands. What do I need to modify             for it to work?</p>\n  \n  <p>I tried overloading the + and &lt;&lt; as member and non-member functions, \n      and it didn't work.</p>\n  \n  <p>This is the overloading from the .cpp after declaring my &lt;&lt; overloading \n      in the class as a friend function:</p>\n</blockquote>\n\n<pre><code>ostream&amp; operator&lt;&lt;(ostream&amp; out, Rational&amp; r)\n{\nout &lt;&lt; r.getA() &lt;&lt; \"/\" &lt;&lt; r.getB();\nreturn out;\n}\n</code></pre>\n\n<blockquote>\n  <p>And this is the + overloaded to sum two rational numbers from the class header:</p>\n</blockquote>\n\n<pre><code>Rational friend operator+(Rational&amp; r1, Rational&amp; r2)\n{\nRational r3;\nfloat numarator, numitor , numitor1, numitor2;\nif (r1.getB() != r2.getB())\n{\nnumitor1 = r1.getB();\nnumitor2 = r2.getB();\nwhile (numitor1 != numitor2)\n{\nnumitor1 &lt; numitor2 ? numitor2 = numitor2 - numitor1 : \nnumitor1 = numitor1 - numitor2;\n}\nif (numitor1 == 1)\n{\nr3.setA(r1.getA() * r2.getB() + r2.getA() * r1.getB());\nr3.setB(r1.getB() * r2.getB());\n}\nelse\nif (numitor1 &lt; numitor2)\n{\nr3.setA(r1.getA() * (r2.getB() / r1.getA()) + r2.getA()); \nr3.setB(r2.getB());\n}\nelse\n{\nr3.setA(r1.getA() + r2.getA() * (r1.getB() / r2.getB()));\nr3.setB(r1.getB());\n}\n}\nnumarator = r3.getA();\nnumitor = r3.getB();\nwhile (numarator != numitor)\n{\nnumarator &lt; numitor ? numitor = numitor - numarator : numarator = \nnumarator - numitor;\n}\nr3.setA(r3.getA() / numarator);\nr3.setB(r3.getB() / numitor);\nreturn r3;\n}\n</code></pre>\n\n<blockquote>\n  <p>The error messages are E0349 no operator \"&lt;&lt;\" matches these operands\n      and\n      C2679 binary '&lt;&lt;': no operator found which takes a right-hand operand of \n      type 'Rational' (or there is no acceptable conversion)</p>\n</blockquote>\n"}, {"tags": ["c++", "vector", "stl", "stdvector"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1558558175, "post_id": 56264692, "comment_id": 99145950, "body": "<code>t_layer != neuralNetwork.size()</code> That test doesn&#39;t look right."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7823283, "user_type": "registered", "profile_image": "https://graph.facebook.com/1382127245143021/picture?type=large", "display_name": "Alex Crim", "link": "https://stackoverflow.com/users/7823283/alex-crim"}, "edited": false, "score": 0, "creation_date": 1558654600, "post_id": 56264830, "comment_id": 99182109, "body": "Great catch! Unfortunately, though it is still segfaulting."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 47, "user_id": 7823283, "user_type": "registered", "profile_image": "https://graph.facebook.com/1382127245143021/picture?type=large", "display_name": "Alex Crim", "link": "https://stackoverflow.com/users/7823283/alex-crim"}, "edited": false, "score": 0, "creation_date": 1558669112, "post_id": 56264830, "comment_id": 99184334, "body": "@AlexCrim Does every neuron&#39;s <code>pWeights</code> object have the same number of neurons?  Possibly the calculation of <code>it</code> is returning <code>pWeights.end()</code> or even past the end of whatever container that is.  You should use your debugger to see the program state at the time of the crash and work from there to figure out what is wrong."}, {"owner": {"reputation": 47, "user_id": 7823283, "user_type": "registered", "profile_image": "https://graph.facebook.com/1382127245143021/picture?type=large", "display_name": "Alex Crim", "link": "https://stackoverflow.com/users/7823283/alex-crim"}, "edited": false, "score": 0, "creation_date": 1558715967, "post_id": 56264830, "comment_id": 99205512, "body": "That was it! pWeights was not sized accordingly so it was immediately out of the container. Thanks for all the help."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 1, "last_activity_date": 1558558210, "creation_date": 1558558210, "answer_id": 56264830, "question_id": 56264692, "link": "https://stackoverflow.com/questions/56264692/segfault-occurring-when-using-erase-on-a-vector/56264830#56264830", "title": "Segfault occurring when using erase on a vector", "body": "<p>Your <code>if(t_layer != neuralNetwork.size())</code> check will always be true, because <code>t_layer</code> is less than <code>neuralNetwork.size()</code> (if it wasn't, the previous line's access to <code>neuralNetwork[t_layer]</code> would result in Undefined Behavior).</p>\n\n<p>You probably meant to check</p>\n\n<pre><code>if (t_layer + 1 != neuralNetwork.size())\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7823283, "user_type": "registered", "profile_image": "https://graph.facebook.com/1382127245143021/picture?type=large", "display_name": "Alex Crim", "link": "https://stackoverflow.com/users/7823283/alex-crim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56264830, "answer_count": 1, "score": 0, "last_activity_date": 1558558210, "creation_date": 1558557597, "question_id": 56264692, "link": "https://stackoverflow.com/questions/56264692/segfault-occurring-when-using-erase-on-a-vector", "title": "Segfault occurring when using erase on a vector", "body": "<p>I'm writing some basic neural network tools for a larger scale project I'm working on.</p>\n\n<p>the neural network itself is made up of vectors of different structs and for one function I want it to delete a neuron from a specified layer. Whenever I use the function it works correctly until it removes the neuron's edge that go to the neurons into the next layer (layer+1) which is causing a segfault.</p>\n\n<pre><code>void NeuralNetwork::deleteNeuron(int t_layer, int t_neuronToDelete){\n  if(t_layer &lt; 0 || t_layer &gt;= neuralNetwork.size())\n    throw LayerDoesNotExistException();\n\n  int numOfNeurons = neuralNetwork[t_layer].neurons.size();\n  if(t_neuronToDelete &lt; 0 || t_neuronToDelete &gt;= numOfNeurons)\n    throw NeuronDoesNotExistException();\n  //delete neuron\n\n//removes neuron\nneuralNetwork[t_layer].neurons.erase(neuralNetwork[t_layer].neurons.begin() + t_neuronToDelete);\n\n//remove its edge from neurons to the right\n  if(t_layer != neuralNetwork.size())//doesnt let it remove edges if its the output layer\n    for(int i=0; i &lt; neuralNetwork[t_layer+1].neurons.size(); i++){\n      std::vector&lt;double*&gt;::iterator it = neuralNetwork[t_layer+1].neurons[i].pWeights.begin() + t_neuronToDelete;\n\n      //this line segfaults\n      neuralNetwork[t_layer+1].neurons[i].pWeights.erase(it);\n    }\n}\n\n</code></pre>\n"}, {"tags": ["c++", "if-statement"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 83, "creation_date": 1558557630, "post_id": 56264674, "comment_id": 99145719, "body": "Guys, this is not a typo question.  The OP wants to know why the if statement is entered with this code since <code>i</code> is set to <code>1</code>."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 24, "creation_date": 1558557836, "post_id": 56264674, "comment_id": 99145814, "body": "Or does it assign the result of <code>1 &amp;&amp; i == 0</code>?"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 4, "creation_date": 1558618575, "post_id": 56264674, "comment_id": 99167296, "body": "Suggestion for beginners: They should not use such &quot;advanced&quot; language construct. Just assign the variable separately. That will also avoid possible problems with sequence point. This kind of code in practical code will usually looks bad too."}, {"owner": {"reputation": 3954, "user_id": 6754706, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TZSs8.jpg?s=128&g=1", "display_name": "RAZ_Muh_Taz", "link": "https://stackoverflow.com/users/6754706/raz-muh-taz"}, "edited": false, "score": 1, "creation_date": 1558649615, "post_id": 56264674, "comment_id": 99181071, "body": "this is bound to end up on an interview question"}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1558701226, "post_id": 56264744, "comment_id": 99197866, "body": "@J&#246;rgWMittag That&#39;s pretty cool.  I like that it forces you to use parentheses."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558703483, "post_id": 56264744, "comment_id": 99199120, "body": "Basically, <code>i = !i; if (i)</code> properly written"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1558704375, "post_id": 56264744, "comment_id": 99199667, "body": "@NathanOliver: Fortress was a pretty cool language that got a lot of things right. (The lead designer was Guy L. Steele, so no surprise there.) Unfortunately, it didn&#39;t get picked up for the final round of DARPA funding, and was subsequently mothballed by Oracle."}, {"owner": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 0, "creation_date": 1558706417, "post_id": 56264744, "comment_id": 99200836, "body": "Then there&#39;s <a href=\"https://en.wikipedia.org/wiki/APL_syntax_and_symbols#Syntax_rules\" rel=\"nofollow noreferrer\">the APL way</a>, where there is no operator precedence ..."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 6, "creation_date": 1558707751, "post_id": 56264744, "comment_id": 99201573, "body": "Naturally, asking for a modicum of warnings from the compiler would have detected that error,"}, {"owner": {"reputation": 7162, "user_id": 3800782, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d6d5273f12d5fd7a7cc4c31769558918?s=128&d=identicon&r=PG&f=1", "display_name": "rghome", "link": "https://stackoverflow.com/users/3800782/rghome"}, "edited": false, "score": 4, "creation_date": 1558709900, "post_id": 56264744, "comment_id": 99202726, "body": "Any language that doesn&#39;t assume ints and booleans are equivalent would also pick this up."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1558791078, "post_id": 56264744, "comment_id": 99221161, "body": "@Deduplicator I know right, if only we had <a href=\"https://godbolt.org/z/XLPbXb\" rel=\"nofollow noreferrer\">compilers that warned on this code...</a>"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558793549, "post_id": 56264744, "comment_id": 99221765, "body": "@Barry I just expected it in the answer, as the OP didn&#39;t seem to have a clue."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 393, "last_activity_date": 1559148780, "last_edit_date": 1559148780, "creation_date": 1558557853, "answer_id": 56264744, "question_id": 56264674, "link": "https://stackoverflow.com/questions/56264674/why-does-this-if-statement-combining-assignment-and-an-equality-check-return-tru/56264744#56264744", "title": "Why does this if-statement combining assignment and an equality check return true?", "body": "<p>This has to do with <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"noreferrer\">operator precedence</a>.  </p>\n\n<pre><code>if (i = 1 &amp;&amp; i == 0)\n</code></pre>\n\n<p>is not</p>\n\n<pre><code>if ((i = 1) &amp;&amp; (i == 0))\n</code></pre>\n\n<p>because both <code>&amp;&amp;</code> and <code>==</code> have a higher precedence than <code>=</code>.  What it really works out to is</p>\n\n<pre><code>if (i = (1 &amp;&amp; (i == 0)))\n</code></pre>\n\n<p>which assigns the result of <code>1 &amp;&amp; (i == 0)</code> to <code>i</code>.  So, if <code>i</code> starts at <code>0</code> then <code>i == 0</code> is <code>true</code>, so <code>1 &amp;&amp; true</code> is <code>true</code> (or <code>1</code>), and then <code>i</code> gets set to <code>1</code>.  Then since <code>1</code> is true, you enter the if block and print the value you assigned to <code>i</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 454, "user_id": 7349206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cad0cc4d9461869bde3c1dbd5e28865?s=128&d=identicon&r=PG", "display_name": "Modelmat", "link": "https://stackoverflow.com/users/7349206/modelmat"}, "edited": false, "score": 40, "creation_date": 1558598954, "post_id": 56264761, "comment_id": 99156309, "body": "Was the extra code really necessary? It seems pretty obvious that this would be the case as it would not run otherwise."}, {"owner": {"reputation": 3208, "user_id": 2162673, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9XSFy.jpg?s=128&g=1", "display_name": "Francisco Zarabozo", "link": "https://stackoverflow.com/users/2162673/francisco-zarabozo"}, "edited": false, "score": 13, "creation_date": 1558600502, "post_id": 56264761, "comment_id": 99157186, "body": "Not only unnecessary extra code. The answer fails to clearly explain operator precedence."}, {"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 35, "creation_date": 1558606511, "post_id": 56264761, "comment_id": 99160584, "body": "Since we&#39;re on the nitpick train... I see a <code>using namespace std</code>!"}, {"owner": {"reputation": 85, "user_id": 5876282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41cf80c4c168244a6093aa29f61f2b56?s=128&d=identicon&r=PG&f=1", "display_name": "B Charles H", "link": "https://stackoverflow.com/users/5876282/b-charles-h"}, "edited": false, "score": 8, "creation_date": 1558621205, "post_id": 56264761, "comment_id": 99168894, "body": "There is extra code - but it is still not incorrect code. And the answer is still right. Of course, it does not explain operator precedence. But someone could suggest it to be added, instead of outright down-voting!"}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 14, "creation_date": 1558624908, "post_id": 56264761, "comment_id": 99171035, "body": "Wow, -4 is harsh, considering this answers the question correctly, though maybe not optimally. It doesn&#39;t expand on operator precedence as much as the other answer, but it does say just enough about it in the context of the code so that anyone who thought that <code>=</code> came before <code>&amp;&amp;</code> can see the issue. Also, yes, the expansion is extraneous, but I don&#39;t think it matters that much. I can&#39;t believe such minor differences cause people to vote 151 to -4."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 6, "creation_date": 1558625364, "post_id": 56264761, "comment_id": 99171311, "body": "Also, I see that the expansion is not so extraneous if it&#39;s based on one of the first few revisions of the question. Mateen nitpicks on <code>using namespace std</code>, but Neil only added it because the first revision of TehMattGR&#39;s question needed it to make sense. This is one of those cases where I wish I could downvote comments."}, {"owner": {"reputation": 15365, "user_id": 52074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd14249e07e1f1d6a949bffa569377ad?s=128&d=identicon&r=PG", "display_name": "Trevor Boyd Smith", "link": "https://stackoverflow.com/users/52074/trevor-boyd-smith"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 6, "creation_date": 1558646584, "post_id": 56264761, "comment_id": 99180181, "body": "@JoL i feel like the vote discrepancy seen here is a canonical example of what a lot of stackoverflow has become... i know 40+ people both offline/online who never contribute because of... reasons."}, {"owner": {"reputation": 12675, "user_id": 636009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IIQJV.jpg?s=128&g=1", "display_name": "David Conrad", "link": "https://stackoverflow.com/users/636009/david-conrad"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 2, "creation_date": 1558723184, "post_id": 56264761, "comment_id": 99208321, "body": "@JoL It does not need <code>using namespace std</code> to make sense. <code>using std::cout</code> does the job perfectly well, without the infamous problems of the former."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "reply_to_user": {"reputation": 12675, "user_id": 636009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IIQJV.jpg?s=128&g=1", "display_name": "David Conrad", "link": "https://stackoverflow.com/users/636009/david-conrad"}, "edited": false, "score": 2, "creation_date": 1558724963, "post_id": 56264761, "comment_id": 99208969, "body": "@DavidConrad It doesn&#39;t matter in the context of the question, though, does it? The question used simply <code>cout</code> in the first revision and Neil expanded to the most likely guess of what OP had in his file just to communicate that he&#39;s assuming that <code>cout</code> is from <code>std</code> and not something else. It&#39;s not like Neil is promoting the use of <code>using namespace std</code> here. If that&#39;s the reason why votes are 251 to 4 right now for practically identical answers posted at practically the same time and why when I got here Neil had -4, I find this totally absurd."}, {"owner": {"reputation": 12675, "user_id": 636009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IIQJV.jpg?s=128&g=1", "display_name": "David Conrad", "link": "https://stackoverflow.com/users/636009/david-conrad"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 2, "creation_date": 1558735056, "post_id": 56264761, "comment_id": 99212024, "body": "@JoL Putting it in a StackOverflow answer certainly is promoting it."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "reply_to_user": {"reputation": 12675, "user_id": 636009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IIQJV.jpg?s=128&g=1", "display_name": "David Conrad", "link": "https://stackoverflow.com/users/636009/david-conrad"}, "edited": false, "score": 0, "creation_date": 1558737630, "post_id": 56264761, "comment_id": 99212607, "body": "@DavidConrad You put it in a StackOverflow comment. By the same logic, is that not promoting it? What&#39;s the difference? As far as I can see neither of you recommended nor made any praise of it. Neil is just guessing what I believe anyone would agree are the most likely, however awful, surroundings of OP&#39;s code in the first revision. I&#39;m astounded by the community reaction here, but I&#39;m also surprised that you can say with such conviction that this behavior from the community is warranted. This page really leaves a bad taste in my mouth."}, {"owner": {"reputation": 12675, "user_id": 636009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IIQJV.jpg?s=128&g=1", "display_name": "David Conrad", "link": "https://stackoverflow.com/users/636009/david-conrad"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 2, "creation_date": 1558738640, "post_id": 56264761, "comment_id": 99212771, "body": "@JoL I put it in a comment criticizing its use and pointing out how it can be avoided. People look at SO answers as a model to imitate. When a newbie comes along and sees an answer from someone with 28k reputation, they may well assume that the code is good code unless there are caveats. This answer isn&#39;t so bad, but it adds nothing to the accepted answer while modeling a bad practice without mentioning it as such. If it is &quot;however awful&quot;, the answer ought to say as much."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": false, "score": 17, "last_activity_date": 1558557910, "creation_date": 1558557910, "answer_id": 56264761, "question_id": 56264674, "link": "https://stackoverflow.com/questions/56264674/why-does-this-if-statement-combining-assignment-and-an-equality-check-return-tru/56264761#56264761", "title": "Why does this if-statement combining assignment and an equality check return true?", "body": "<p>Assuming your code actually looks like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()  {\n    int i = 0;\n    if (i = 1 &amp;&amp; i == 0) {\n        cout &lt;&lt; i;\n    }\n}\n</code></pre>\n\n<p>Then this:</p>\n\n<pre><code>if (i = 1 &amp;&amp; i == 0) {\n</code></pre>\n\n<p>evaluates as</p>\n\n<pre><code> if (i = (1 &amp;&amp; i == 0)) {\n</code></pre>\n\n<p>and so <code>i</code> is set to <code>1</code>.        </p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1559226749, "post_id": 56349165, "comment_id": 99360867, "body": "Associativity (&quot;right to left rules&quot;) has nothing to do with this. It&#39;s about precedence (&quot;importance&quot;), and the operators used <i>don&#39;t</i> have equal precedence."}], "tags": [], "owner": {"reputation": 320, "user_id": 1445782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/788def1484e62941d45004963411c3e1?s=128&d=identicon&r=PG", "display_name": "Leslie Satenstein", "link": "https://stackoverflow.com/users/1445782/leslie-satenstein"}, "is_accepted": false, "score": -4, "last_activity_date": 1559072937, "creation_date": 1559072937, "answer_id": 56349165, "question_id": 56264674, "link": "https://stackoverflow.com/questions/56264674/why-does-this-if-statement-combining-assignment-and-an-equality-check-return-tru/56349165#56349165", "title": "Why does this if-statement combining assignment and an equality check return true?", "body": "<p>It has to do with parsing an the right to left rules. \nEg y = x+5.<br>\nAll sub-expressions are weighted in importance.\nTwo expressions of equal importance are evaluated right to left, . The &amp;&amp; expression side  is done first, followed by the LHS. </p>\n\n<p>Makes sense to me.</p>\n"}, {"comments": [{"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 2, "creation_date": 1559106666, "post_id": 56349723, "comment_id": 99311174, "body": "1) The docs link to C operator precedence, when this question is tagged with C++. Two different languages. 2a) <code>i = 1</code> is an assignment [not an equivalence] operator; 2b) I can assure you that <code>if (i = 0)</code> will evaluate to false condition in both C and C++, so whether it evaluates to true wrt &quot;it never fails&quot; is somewhat misleading."}, {"owner": {"reputation": 2847, "user_id": 5049185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f0d2dc8ee06f428e43d0d115a57c4f?s=128&d=identicon&r=PG&f=1", "display_name": "syck", "link": "https://stackoverflow.com/users/5049185/syck"}, "edited": false, "score": 1, "creation_date": 1559149463, "post_id": 56349723, "comment_id": 99334029, "body": "<code>and     cl, 1                     ; = operator always TRUE</code> &lt;&lt; correct me if I am wrong, but I see no assignation here. It represents the <code>1 &amp;&amp;</code> part of the expression. So this answer basically evaluates to <code>false</code>."}, {"owner": {"reputation": 329, "user_id": 6147643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PteZ2.jpg?s=128&g=1", "display_name": "ar18", "link": "https://stackoverflow.com/users/6147643/ar18"}, "edited": false, "score": 0, "creation_date": 1559228039, "post_id": 56349723, "comment_id": 99361582, "body": "&quot;The docs link to C operator precedence, when this question is tagged with C++. Two different languages&quot; -- and when you compare C to C++ operator precedence, what is the difference between the two? They have the same precedence in regards to this topic, which isn&#39;t surprising, seeing as C++ is a direct derivative of C (or another way to put it is, C is a subset of the C++ language, so of course they will have a lot in common, including precedence). I will fix my post anyways, in case that is confusing."}, {"owner": {"reputation": 329, "user_id": 6147643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PteZ2.jpg?s=128&g=1", "display_name": "ar18", "link": "https://stackoverflow.com/users/6147643/ar18"}, "edited": false, "score": 0, "creation_date": 1559259824, "post_id": 56349723, "comment_id": 99373792, "body": "&quot;Correct me if I am wrong, but I see no assignation here&quot; -- Then let me correct you! The 1 is an immediate value and not the result of any test or calculation. It is what is called a &quot;presumed TRUE&quot; value. The only test that takes place is for the i==0 statement, i.e. -- &quot;cmp dword ptr [rbp - 8], 0&quot;. You would only be correct if it had said &quot;movzx edx,1&quot;. According to ALL the posts preceding mine, there should be two comparisons, but in real life there is only one, and the asm output of EVERY major compiler proves those posts are completely incorrect."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1559260932, "post_id": 56349723, "comment_id": 99374037, "body": "As well as getting the precedence wrong (see NathanOliver&#39;s answer for the correct parsing), you make the false claim that the assignment operator always evalutes to TRUE.  Try <code>if ( i = 0 ) { print something }</code>. Also your answer contradicts itself; at the start you say that <code>i=1</code> is evaluated before <code>&amp;&amp;</code> is applied, and then at the end you say that <code>i</code> is set to the result of the <code>&amp;&amp;</code> operator."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1559261456, "post_id": 56349723, "comment_id": 99374121, "body": "<code>and cl,1</code> corresponds to  <code>1 &amp;&amp; cl</code> storing the result in <code>cl</code>. The previous value of <code>cl</code> was the result of <code>i == 0</code>. Then <code>mov     dword ptr [rbp - 8], edx</code> stores the result of the <code>and</code> (which was copied from <code>cl</code> to <code>edx</code>) into the memory location of <code>i</code>."}, {"owner": {"reputation": 329, "user_id": 6147643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PteZ2.jpg?s=128&g=1", "display_name": "ar18", "link": "https://stackoverflow.com/users/6147643/ar18"}, "edited": false, "score": 0, "creation_date": 1559396017, "post_id": 56349723, "comment_id": 99411612, "body": "&quot;As well as getting the precedence wrong&quot; -- Well you better tell every compiler manufacture in the world that they got it wrong. Good luck on that!"}, {"owner": {"reputation": 329, "user_id": 6147643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PteZ2.jpg?s=128&g=1", "display_name": "ar18", "link": "https://stackoverflow.com/users/6147643/ar18"}, "edited": false, "score": 0, "creation_date": 1559396243, "post_id": 56349723, "comment_id": 99411662, "body": "&quot;Then mov dword ptr [rbp - 8], edx stores the result of the and (which was copied from cl to edx)&quot; -- That is just a guess and it isn&#39;t correct. Like I said, change the 1 to a 2 AND NOTHING WILL CHANGE."}, {"owner": {"reputation": 329, "user_id": 6147643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PteZ2.jpg?s=128&g=1", "display_name": "ar18", "link": "https://stackoverflow.com/users/6147643/ar18"}, "edited": false, "score": 0, "creation_date": 1570057346, "post_id": 56349723, "comment_id": 102798179, "body": "1) The code I provided was generated by a C++ compiler and there was no pragma to place in the C mode   2) The output of ALL the compilers on Compiler Explorer tells us what the precedence is -- anything else is blind faith assertion   3) Like I said, changing the code doesn&#39;t change the result, which completely contradicts your claim of what the program is doing in assembly."}], "tags": [], "owner": {"reputation": 329, "user_id": 6147643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PteZ2.jpg?s=128&g=1", "display_name": "ar18", "link": "https://stackoverflow.com/users/6147643/ar18"}, "is_accepted": false, "score": -3, "last_activity_date": 1570057915, "last_edit_date": 1570057915, "creation_date": 1559075729, "answer_id": 56349723, "question_id": 56264674, "link": "https://stackoverflow.com/questions/56264674/why-does-this-if-statement-combining-assignment-and-an-equality-check-return-tru/56349723#56349723", "title": "Why does this if-statement combining assignment and an equality check return true?", "body": "<p>The actual answer is:</p>\n\n<ol>\n<li>The compiler gives <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">precedence</a> to \"i == 0\", which evaluates to true.</li>\n<li>Then it will evaluate i=1 as TRUE or FALSE, and since compiled assignment operators never fail (otherwise they wouldn't compile), it also evaluates to true.</li>\n<li>Since both statements evaluate as true, and TRUE &amp;&amp; TRUE evaluates to TRUE, the if statement will evaluate to TRUE.</li>\n</ol>\n\n<p>As proof, just look at the asm output of your compiler for the code you entered (all comments are my own):</p>\n\n<pre><code>mov     dword ptr [rbp - 8], 0    ; i = 0;\ncmp     dword ptr [rbp - 8], 0    ; i == 0?\nsete    al                        ; TRUE (=1)\nmov     cl, al\nand     cl, 1                     ; = operator always TRUE\nmovzx   edx, cl\nmov     dword ptr [rbp - 8], edx  ; set i=TRUE;\ntest    al, 1                     ; al never changed,\n                                  ; so final ans is TRUE\n</code></pre>\n\n<p>The asm output above was from CLANG, but all other compilers I looked at gave similar output. This is true for all the compilers on that site, whether they are pure C or C++ compilers, all without any pragmas to change the mode of the compiler (which by default is C++ for the C++ compilers)</p>\n\n<p>Note that your compiler did not actually set i=1, but i=TRUE (which means any 32-bit not zero integer value). That's because the &amp;&amp; operator only evaluates whether a statement is TRUE or FALSE, and then sets the results according to that result. As proof, try changing i=1 to i=2 and you can observe for yourself that nothing will change. See for yourself using any online compiler at <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">Compiler Explorer</a></p>\n"}], "owner": {"reputation": 1678, "user_id": 11212670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OaIwa.png?s=128&g=1", "display_name": "TehMattGR", "link": "https://stackoverflow.com/users/11212670/tehmattgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11643, "favorite_count": 22, "accepted_answer_id": 56264744, "answer_count": 4, "score": 217, "last_activity_date": 1570057915, "creation_date": 1558557520, "last_edit_date": 1558621616, "question_id": 56264674, "link": "https://stackoverflow.com/questions/56264674/why-does-this-if-statement-combining-assignment-and-an-equality-check-return-tru", "title": "Why does this if-statement combining assignment and an equality check return true?", "body": "<p>I've been thinking of some beginner mistakes and I ended up with the one on the <code>if</code> statement. I expanded a bit the code to this:</p>\n\n<pre><code>int i = 0;\nif (i = 1 &amp;&amp; i == 0) {\n    std::cout &lt;&lt; i;\n}\n</code></pre>\n\n<p>I have seen that the <code>if</code> statement returns true, and it <code>cout</code>'s <code>i</code> as <code>1</code>. If <code>i</code> is assigned <code>1</code> in the if statement, why did <code>i == 0</code> return <code>true</code>?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1558556987, "post_id": 56264548, "comment_id": 99145465, "body": "What are the errors you are getting?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1558557080, "post_id": 56264548, "comment_id": 99145497, "body": "<code>Box(double l = 2.0 double = 2.0 double h = 2.0) {</code> You need commas. <code>Box(double l = 2.0, double b = 2.0, double h = 2.0) {</code> You also forgot a name for 2nd param."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 3, "creation_date": 1558557412, "post_id": 56264548, "comment_id": 99145633, "body": "A tip: never sort your compiler warnings"}], "answers": [{"tags": [], "owner": {"reputation": 1676, "user_id": 8796240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Frmc2F7AVDs/AAAAAAAAAAI/AAAAAAAAQLM/B_xiXHfq_Ss/photo.jpg?sz=128", "display_name": "yaho cho", "link": "https://stackoverflow.com/users/8796240/yaho-cho"}, "is_accepted": true, "score": 1, "last_activity_date": 1558557224, "creation_date": 1558557224, "answer_id": 56264606, "question_id": 56264548, "link": "https://stackoverflow.com/questions/56264548/how-do-i-resolve-undeclared-identifier-error-from-the-code/56264606#56264606", "title": "How do I resolve &quot;undeclared identifier&quot; error from the code?", "body": "<p>Just modify the constructor of <code>Box</code> Class. You just missed <code>,</code> between parameters and name of <code>b</code>.</p>\n\n<pre><code>Box(double l = 2.0, double b = 2.0, double h = 2.0) {\n</code></pre>\n\n<p>Please see the full code as following:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass Box {\npublic:\n    static int objectCount;\n\n    //Constructor definition\n    Box(double l = 2.0, double b = 2.0, double h = 2.0) {\n        cout &lt;&lt; \"Constructor Called.\" &lt;&lt; endl;\n        length = l;\n        breadth = b;\n        height = h;\n\n        //Increase everytime the object is created\n        objectCount++;\n    }\n    double Volume() {\n        return length * breadth* height;\n    }\nprivate:\n    double length;\n    double breadth;\n    double height;\n};\n// Initialize static member of class Box\nint Box::objectCount = 0;\n\nint main(void) {\n    Box Box1(3.3, 1.2, 1.5);\n    Box Box2(8.5, 6.0, 2.0);\n\n    cout &lt;&lt; \"Total objects: \" &lt;&lt; Box::objectCount &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Please get your result as following:</p>\n\n<pre><code>Constructor Called.\nConstructor Called.\nTotal objects: 2\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7377353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746caa2b2abb9ddce2ca0d4f904a2ef4?s=128&d=identicon&r=PG&f=1", "display_name": "user7377353", "link": "https://stackoverflow.com/users/7377353/user7377353"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1558557730, "accepted_answer_id": 56264606, "answer_count": 1, "score": -2, "last_activity_date": 1558557440, "creation_date": 1558556926, "last_edit_date": 1558557278, "question_id": 56264548, "link": "https://stackoverflow.com/questions/56264548/how-do-i-resolve-undeclared-identifier-error-from-the-code", "closed_reason": "Not suitable for this site", "title": "How do I resolve &quot;undeclared identifier&quot; error from the code?", "body": "<p>I am trying to learn C++ and I ran the following code in Visual Studio  2019.\nI am getting 12 errors , but the code runs fine on the website.</p>\n\n<p>You can find the code here:\n<a href=\"https://www.tutorialspoint.com/cplusplus/cpp_static_members.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/cplusplus/cpp_static_members.htm</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n\n    using namespace std;\n\nclass Box{\npublic:\n    static int objectCount;\n\n    //Constructor definition\n    Box(double l = 2.0 double b = 2.0 double h = 2.0) {\n        cout &lt;&lt; \"Constructor Called.\" &lt;&lt; endl;\n        length = l;\n        breadth = b;\n        height = h;\n\n        //Increase everytime the object is created\n        objectCount++;\n    }\n    double Volume() {\n        return length * breadth* height;\n    }\nprivate:\n    double length;\n    double breadth;\n    double height;\n};\n// Initialize static member of class Box\nint Box::objectCount = 0;\n\nint main(void) {\n    Box Box1(3.3, 1.2, 1.5);\n    Box Box2(8.5, 6.0, 2.0);\n\n    cout &lt;&lt; \"Total objects: \" &lt;&lt; Box::objectCount &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/lpMuT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lpMuT.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "windows", "winapi"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 4, "creation_date": 1558556709, "post_id": 56264443, "comment_id": 99145339, "body": "You will have to mention the framework or api that you are using. Standard C++ has no concept of a GUI. Also you probably should include a minimal code example. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1558556947, "post_id": 56264443, "comment_id": 99145448, "body": "What platform?  What GUI framework?  MFC has a different method for creating dialog boxes than wxWidgets and Qt.  Linux has a different system as well."}, {"owner": {"reputation": 1, "user_id": 9008392, "user_type": "registered", "profile_image": "https://graph.facebook.com/1786837081349857/picture?type=large", "display_name": "Livijus Kievi\u0161as", "link": "https://stackoverflow.com/users/9008392/livijus-kievi%c5%a1as"}, "edited": false, "score": 0, "creation_date": 1558557157, "post_id": 56264443, "comment_id": 99145534, "body": "I use Win32 GUI."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 1, "creation_date": 1558557626, "post_id": 56264443, "comment_id": 99145717, "body": "If you don&#39;t know how to edit a dialog resource or create a modal dialog, then the next step is to read some tutorials at CodeProject.com, Microsoft, the Petzold book, etc. -- please read <a href=\"https://stackoverflow.com/tour\">tour</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to see what kind of questions are good for StackOverflow.  &quot;Getting started&quot; and tutorial questions are usually better answered by searching for blogs, tutorials, YouTube videos, etc."}], "answers": [{"tags": [], "owner": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "is_accepted": false, "score": 0, "last_activity_date": 1558604527, "last_edit_date": 1592644375, "creation_date": 1558604527, "answer_id": 56272397, "question_id": 56264443, "link": "https://stackoverflow.com/questions/56264443/how-to-set-up-a-dialog-box-that-allows-users-to-input-data/56272397#56272397", "title": "How to set up a dialog box that allows users to input data?", "body": "<p>I wrote a simple demo, you can refer to the following code</p>\n<p>Compiler tool: VS2017</p>\n<pre><code>// WindowsProject29.cpp : Defines the entry point for the application.\n//\n\n#include &quot;stdafx.h&quot;\n#include &quot;WindowsProject29.h&quot;\n\n#define MAX_LOADSTRING 100\n#define IDB_ONE 133\n\n// Global Variables:\nHINSTANCE hInst;                                // current instance\nWCHAR szTitle[MAX_LOADSTRING];                  // The title bar text\nWCHAR szWindowClass[MAX_LOADSTRING];            // the main window class name\nHWND hWnd;\n// Forward declarations of functions included in this code module:\nATOM                MyRegisterClass(HINSTANCE hInstance);\nATOM                MyRegisterClass_1(HINSTANCE hInstance);\nBOOL                InitInstance(HINSTANCE, int);\nLRESULT CALLBACK    WndProc(HWND, UINT, WPARAM, LPARAM);\nINT_PTR CALLBACK    About(HWND, UINT, WPARAM, LPARAM);\nvoid DisplayModelDialog(HWND hParent);\nLRESULT CALLBACK DialogProc(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam);\nint APIENTRY wWinMain(_In_ HINSTANCE hInstance,\n                     _In_opt_ HINSTANCE hPrevInstance,\n                     _In_ LPWSTR    lpCmdLine,\n                     _In_ int       nCmdShow)\n{\n    UNREFERENCED_PARAMETER(hPrevInstance);\n    UNREFERENCED_PARAMETER(lpCmdLine);\n\n    // TODO: Place code here.\n\n    // Initialize global strings\n    LoadStringW(hInstance, IDS_APP_TITLE, szTitle, MAX_LOADSTRING);\n    LoadStringW(hInstance, IDC_WINDOWSPROJECT29, szWindowClass, MAX_LOADSTRING);\n    MyRegisterClass(hInstance);\n    MyRegisterClass_1(hInstance);\n    // Perform application initialization:\n    if (!InitInstance (hInstance, nCmdShow))\n    {\n        return FALSE;\n    }\n\n    HACCEL hAccelTable = LoadAccelerators(hInstance, MAKEINTRESOURCE(IDC_WINDOWSPROJECT29));\n\n    MSG msg;\n\n    // Main message loop:\n    while (GetMessage(&amp;msg, nullptr, 0, 0))\n    {\n        if (!TranslateAccelerator(msg.hwnd, hAccelTable, &amp;msg))\n        {\n            TranslateMessage(&amp;msg);\n            DispatchMessage(&amp;msg);\n        }\n    }\n\n    return (int) msg.wParam;\n}\n\n\n\n//\n//  FUNCTION: MyRegisterClass()\n//\n//  PURPOSE: Registers the window class.\n//\nATOM MyRegisterClass(HINSTANCE hInstance)\n{\n    WNDCLASSEXW wcex;\n\n    wcex.cbSize = sizeof(WNDCLASSEX);\n\n    wcex.style          = CS_HREDRAW | CS_VREDRAW;\n    wcex.lpfnWndProc    = WndProc;\n    wcex.cbClsExtra     = 0;\n    wcex.cbWndExtra     = 0;\n    wcex.hInstance      = hInstance;\n    wcex.hIcon          = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_WINDOWSPROJECT29));\n    wcex.hCursor        = LoadCursor(nullptr, MAKEINTRESOURCE(IDC_CURSOR1));\n    wcex.hbrBackground  = (HBRUSH)(COLOR_WINDOW+1);\n    wcex.lpszMenuName   = MAKEINTRESOURCEW(IDC_WINDOWSPROJECT29);\n    wcex.lpszClassName  = szWindowClass;\n    wcex.hIconSm        = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(IDI_SMALL));\n\n    return RegisterClassExW(&amp;wcex);\n}\n\nATOM MyRegisterClass_1(HINSTANCE hInstance)\n{\n    WNDCLASSEXW wcex;\n\n    wcex.cbSize = sizeof(WNDCLASSEX);\n\n    wcex.style = CS_HREDRAW | CS_VREDRAW;\n    wcex.lpfnWndProc = DialogProc;\n    wcex.cbClsExtra = 0;\n    wcex.cbWndExtra = 0;\n    wcex.hInstance = hInstance;\n    wcex.hIcon = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_WINDOWSPROJECT29));\n    wcex.hCursor = LoadCursor(nullptr, MAKEINTRESOURCE(IDC_CURSOR1));\n    wcex.hbrBackground = (HBRUSH)(COLOR_WINDOW + 1);\n    wcex.lpszMenuName = MAKEINTRESOURCEW(IDC_WINDOWSPROJECT29);\n    wcex.lpszClassName = TEXT(&quot;Dialog&quot;);\n    wcex.hIconSm = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(IDI_SMALL));\n\n    return RegisterClassExW(&amp;wcex);\n}\n//\n//   FUNCTION: InitInstance(HINSTANCE, int)\n//\n//   PURPOSE: Saves instance handle and creates main window\n//\n//   COMMENTS:\n//\n//        In this function, we save the instance handle in a global variable and\n//        create and display the main program window.\n//\nBOOL InitInstance(HINSTANCE hInstance, int nCmdShow)\n{\n   hInst = hInstance; // Store instance handle in our global variable\n\n   hWnd = CreateWindowW(szWindowClass, szTitle, WS_OVERLAPPEDWINDOW,\n      CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, nullptr, nullptr, hInstance, nullptr);\n\n //  DisplayModelDialog(hWnd);\n\n   if (!hWnd)\n   {\n      return FALSE;\n   }\n\n   ShowWindow(hWnd, nCmdShow);\n   UpdateWindow(hWnd);\n\n   return TRUE;\n}\n\n//\n//  FUNCTION: WndProc(HWND, UINT, WPARAM, LPARAM)\n//\n//  PURPOSE: Processes messages for the main window.\n//\n//  WM_COMMAND  - process the application menu\n//  WM_PAINT    - Paint the main window\n//  WM_DESTROY  - post a quit message and return\n//\n//\nLRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)\n{\n    switch (message)\n    {\n    case WM_CREATE:\n    {\n        CreateWindow(L&quot;Button&quot;, L&quot;Click&quot;, WS_VISIBLE | WS_CHILD | BS_PUSHBUTTON,\n            35, 10, 120, 60, hWnd, (HMENU)IDB_ONE, hInst, NULL);\n    }\n    case WM_COMMAND:\n        {\n            int wmId = LOWORD(wParam);\n            // Parse the menu selections:\n            switch (wmId)\n            {\n            case IDM_ABOUT:\n                DialogBox(hInst, MAKEINTRESOURCE(IDD_ABOUTBOX), hWnd, About);\n                break;\n            case IDM_EXIT:\n                DestroyWindow(hWnd);\n                break;\n            case IDB_ONE:\n                DisplayModelDialog(hWnd);\n\n                break;\n            default:\n                return DefWindowProc(hWnd, message, wParam, lParam);\n            }\n        }\n        break;\n    case WM_PAINT:\n        {\n            PAINTSTRUCT ps;\n            HDC hdc = BeginPaint(hWnd, &amp;ps);\n            // TODO: Add any drawing code that uses hdc here...\n        \n            EndPaint(hWnd, &amp;ps);\n        }\n        break;\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n    default:\n        return DefWindowProc(hWnd, message, wParam, lParam);\n    }\n    return 0;\n}\n\n// Message handler for about box.\nINT_PTR CALLBACK About(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)\n{\n    UNREFERENCED_PARAMETER(lParam);\n    switch (message)\n    {\n    case WM_INITDIALOG:\n        return (INT_PTR)TRUE;\n\n    case WM_COMMAND:\n        if (LOWORD(wParam) == IDOK || LOWORD(wParam) == IDCANCEL)\n        {\n            EndDialog(hDlg, LOWORD(wParam));\n            return (INT_PTR)TRUE;\n        }\n        break;\n    }\n    return (INT_PTR)FALSE;\n}\n\n\nvoid DisplayModelDialog(HWND hParent) \n{\n    EnableWindow(hParent, FALSE);\n\n    HWND hDlg = CreateWindow(\n        TEXT(&quot;Dialog&quot;),\n        TEXT(&quot;Dialog&quot;),\n        WS_OVERLAPPEDWINDOW | WS_VISIBLE,\n        CW_USEDEFAULT,\n        CW_USEDEFAULT,\n        500,\n        300,\n        hParent,\n        NULL,\n        (HINSTANCE)GetWindowLong(hParent, GWL_HINSTANCE),\n        NULL);\n    HWND EDIT= CreateWindow(L&quot;edit&quot;, NULL, WS_CHILD | WS_VISIBLE | WS_BORDER,\n        20, 20, 200, 50, hDlg, NULL, NULL, NULL);\n    ShowWindow(hDlg, SW_SHOW);\n    UpdateWindow(hDlg);\n\n    MSG msg;\n\n    while (GetMessage(&amp;msg, NULL, 0, 0)) {\n\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n\n    EnableWindow(hParent, TRUE);\n    SetForegroundWindow(hParent);\n}\n\nLRESULT CALLBACK DialogProc(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam) \n{\n    switch (message) {\n\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        return 0;\n    }\n\n    return DefWindowProc(hwnd, message, wParam, lParam);\n}\n</code></pre>\n<p>Debug Result:\n<a href=\"https://i.stack.imgur.com/XTiFk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XTiFk.png\" alt=\"Design sketch\" /></a></p>\n<p>More details, such as the need to save the text of the edit box and so on, can be added according to the actual situation.</p>\n"}], "owner": {"reputation": 1, "user_id": 9008392, "user_type": "registered", "profile_image": "https://graph.facebook.com/1786837081349857/picture?type=large", "display_name": "Livijus Kievi\u0161as", "link": "https://stackoverflow.com/users/9008392/livijus-kievi%c5%a1as"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1558604527, "creation_date": 1558556502, "last_edit_date": 1558557180, "question_id": 56264443, "link": "https://stackoverflow.com/questions/56264443/how-to-set-up-a-dialog-box-that-allows-users-to-input-data", "title": "How to set up a dialog box that allows users to input data?", "body": "<p>I am doing a school project and i want to set it up so when the user presses a button a dialog box pops up and allows users to input data. How should I implement this? I use resedit if that matters.</p>\n"}, {"tags": ["c++", "visual-studio", "curl", "woocommerce-rest-api"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558557365, "post_id": 56264435, "comment_id": 99145618, "body": "Maybe you should read up a bit on HTTP in addition to curl itself :)"}, {"owner": {"reputation": 35, "user_id": 9613455, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DTHkXeLEnqY/AAAAAAAAAAI/AAAAAAAAJLg/AK7Kz7Kmd44/photo.jpg?sz=128", "display_name": "damnitmat", "link": "https://stackoverflow.com/users/9613455/damnitmat"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558619145, "post_id": 56264435, "comment_id": 99167658, "body": "I&#39;ve read about it as you told me so, and I think I have unterstood how it works. To sum it up, I know that I have to send a request (of type GET, POST, DELETE,... etc) , like it is done in the documentation. But there is some kind of progress : this morning, when I tried again, the program compiled but curl gave me this error : &quot;Unspported protocol&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 9613455, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DTHkXeLEnqY/AAAAAAAAAAI/AAAAAAAAJLg/AK7Kz7Kmd44/photo.jpg?sz=128", "display_name": "damnitmat", "link": "https://stackoverflow.com/users/9613455/damnitmat"}, "is_accepted": true, "score": 0, "last_activity_date": 1558626575, "creation_date": 1558626575, "answer_id": 56278891, "question_id": 56264435, "link": "https://stackoverflow.com/questions/56264435/how-to-send-a-request-to-the-woocommerce-api/56278891#56278891", "title": "How to send a request to the WooCommerce API", "body": "<p>Ok, I've figured it out, for those who pass by and may have the same problem as I had. The commands you do with cURL in the terminal and with the library are totally different :</p>\n\n<ul>\n<li>In the command prompt, you got to enter <code>curl -X POST https://blablablabla</code></li>\n<li>In the C++ library, you have to call the <code>curl_easy_setopt()</code> function with parameters to specify each component of the request : <code>CURLOPT_URL</code> is your main domain, <code>CURLOPT_POSTFIELDS</code> is the data you want to POST, and there are other parameters such as <code>CURLOPT_WRITEFUNCTION</code>, <code>CURLOPT_WRITE_DATA</code>,... etc. that handles the response from the server.</li>\n</ul>\n\n<p>For me, <a href=\"https://curl.haxx.se/libcurl/c/simplepost.html\" rel=\"nofollow noreferrer\">this example</a> was really useful, I don't know how I could have missed it :D Thanks Jesper Juhl for the advice, it is crucial to understand how HTTP and HTTPS works to figure this out.</p>\n"}], "owner": {"reputation": 35, "user_id": 9613455, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DTHkXeLEnqY/AAAAAAAAAAI/AAAAAAAAJLg/AK7Kz7Kmd44/photo.jpg?sz=128", "display_name": "damnitmat", "link": "https://stackoverflow.com/users/9613455/damnitmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 56278891, "answer_count": 1, "score": 0, "last_activity_date": 1558626575, "creation_date": 1558556468, "question_id": 56264435, "link": "https://stackoverflow.com/questions/56264435/how-to-send-a-request-to-the-woocommerce-api", "title": "How to send a request to the WooCommerce API", "body": "<p>I'm currently building a solution for a company as an intern, and I need to use the WooCommerce REST API features in my C++ project to send data to the website.</p>\n\n<p>I've so far, after 2 long painful days, managed to install the cURL library (through vcpkg) and tested the library a bit with the many examples that you can find on the internet. But for now, what I found doesn't seem to match with what the people at WooCommerce put in their documentation.\nFor example, in <a href=\"https://woocommerce.github.io/woocommerce-rest-api-docs/?javascript#create-a-product\" rel=\"nofollow noreferrer\">this</a> section, they show how to create a product on the platform using cURL, but I can't understand how to translate it in cURL language inside the C++ project. Heck, the command doesn't even work when I use it in the command prompt with my parameters.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;curl/curl.h&gt;\n#include &lt;string&gt;\n\n// cUrl declaration \n    CURL* curl;\n    CURLcode res;\n    std::string readBuffer;\n    std::string URL = \"http://www.example.com\";\n\n    curl_global_init(CURL_GLOBAL_ALL);\n    curl = curl_easy_init();\n    if (curl) {\n        curl_easy_setopt(curl, CURLOPT_URL, URL);\n        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, WriteCallback);\n        curl_easy_setopt(curl, CURLOPT_WRITEDATA, &amp;readBuffer);\n        res = curl_easy_perform(curl);\n\n        // Check for errors\n        if (res != CURLE_OK) {\n            std::string error = \"curl_easy_perform() failed: \";\n            error += curl_easy_strerror(res);\n            error += \"\\nImpossible de se connecter au site WooCommerce fourni. Veuillez verifier vos param\u00e8tres et red\u00e9marrer l'application.\";\n            wxMessageBox(error);\n        }\n        else {\n            std::string success = \"Connexion au domaine \";\n            success += URL;\n            success += \" r\u00e9ussie.\\nPour changer de domaine, veuillez consulter la page Param\u00e8tres.\";\n            wxMessageBox(success);\n        }\n\n    }\n\n    // cleanup\n    curl_easy_cleanup(curl);\n    curl_global_cleanup();\n</code></pre>\n\n<p>This code works fine, I know that I have to add the company's website instead of the example, but I can't figure out where to add my client key and client secret (basically like in the example shown on the WooCommerce doc). The basic cURL commands work fine in my local command prompt, but the example doesn't event work.\nI know that my request for help may be kind of basic and easy to solve but I just spent the last 2 days and a half working on this and I'm starting to lose it.</p>\n\n<p>Thanks for your help, I tried to speak the best english I could, so sorry in advance for any typo, or sorry if my post doesn't live up to the presentation standards of this platform, I'm kinda new around here :D</p>\n"}, {"tags": ["c++", "sfml"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558556591, "post_id": 56264296, "comment_id": 99145281, "body": "You could start by formatting your code properly, so it&#39;s readable. Hint: <a href=\"https://clang.llvm.org/docs/ClangFormat.html\" rel=\"nofollow noreferrer\">Clang Format</a>."}, {"owner": {"reputation": 55, "user_id": 11047613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8846ae2f827bfc480fb05c1da7e3e242?s=128&d=identicon&r=PG&f=1", "display_name": "LordNani", "link": "https://stackoverflow.com/users/11047613/lordnani"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558556611, "post_id": 56264296, "comment_id": 99145286, "body": "So I was correct about referencing problem, yay! Gonna find some information about that aspect. It works, thanks !"}, {"owner": {"reputation": 55, "user_id": 11047613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8846ae2f827bfc480fb05c1da7e3e242?s=128&d=identicon&r=PG&f=1", "display_name": "LordNani", "link": "https://stackoverflow.com/users/11047613/lordnani"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558556710, "post_id": 56264296, "comment_id": 99145340, "body": "@JesperJuhl yep wish I knew how to"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558557076, "post_id": 56264296, "comment_id": 99145495, "body": "That&#39;s where my &quot;Hint&quot; link comes into the picture ;-)"}, {"owner": {"reputation": 55, "user_id": 11047613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8846ae2f827bfc480fb05c1da7e3e242?s=128&d=identicon&r=PG&f=1", "display_name": "LordNani", "link": "https://stackoverflow.com/users/11047613/lordnani"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558557433, "post_id": 56264296, "comment_id": 99145642, "body": "@JesperJuhl yeah, thanks man, I installed clang and now getting used to format before committing :)"}], "owner": {"reputation": 55, "user_id": 11047613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8846ae2f827bfc480fb05c1da7e3e242?s=128&d=identicon&r=PG&f=1", "display_name": "LordNani", "link": "https://stackoverflow.com/users/11047613/lordnani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558555884, "creation_date": 1558555884, "question_id": 56264296, "link": "https://stackoverflow.com/questions/56264296/why-pixel-is-not-changing-color", "title": "Why pixel is not changing color", "body": "<p>I am making pseudo paint on C++ (near zero experience in C++ ) using SFML library.\nI made a separate function to edit the image and \"tool 0\" is basically a pencil. When I try to pass this args to my function it doesn't work, but when I do the same without passing this to drawOnImage func it works normally.\nI've cut out extra parts on the presented code</p>\n\n<p>I have tried to pass x and y of mouse position as separate args (without the use of Vector), but this doesn't help</p>\n\n<pre><code>void drawOnImage(sf::Color color, int tool, sf::Texture canvas, sf::Image image, sf::Vector2i vector);\n\nint main()\n{\n    sf::Image image;\n    image.create(windowWidth, windowHeight, sf::Color::White);\n    sf::Texture canvas;\n    sf::Color currentColor = sf::Color::Black;  // Color\n    int currentTool = 0; // instrument that is currently chosen\n    sf::Sprite sprite;\n    int mousedown = 0;\n    mainWindow.setFramerateLimit(60);\n    canvas.loadFromImage(image);\n    sprite.setTexture(canvas);\nwhile (mainWindow.isOpen())\n    {\n        canvas.loadFromImage(image);\n        sf::Event event;\n        while (mainWindow.pollEvent(event))\n        {\n            // \"close requested\" event: we close the window\n            if (event.type == sf::Event::Closed)\n                mainWindow.close();\n            else if ((event.type == sf::Event::MouseMoved) &amp;&amp; (mousedown == 1)) \n            {\n                canvas.update(mainWindow);\n                drawOnImage(currentColor, currentTool, canvas, image, sf::Mouse::getPosition(mainWindow));\n            }\n            else if (event.type == sf::Event::MouseButtonPressed)\n            {\n                mousedown = 1;\n                drawOnImage(currentColor, currentTool, canvas, image, sf::Mouse::getPosition(mainWindow));\n                //image.setPixel(sf::Mouse::getPosition(mainWindow).x, //IT WORKS but drawOnImage does not \n sf::Mouse::getPosition(mainWindow).y, sf::Color::Black);\n}\nvoid drawOnImage(sf::Color color, int tool, sf::Texture canvas, sf::Image image,sf::Vector2i vector) {\n    if (tool == 0) {\n        image.setPixel(vector.x,vector.y, sf::Color::Black);\n    }\n}\n</code></pre>\n\n<p>I am sure that I simply don't know some of c++ features like passing the address of the object rather than name, but I can't figure this out by myself</p>\n"}, {"tags": ["c++", "linux", "multithreading"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1558555323, "post_id": 56264145, "comment_id": 99144695, "body": "Do you have to use <code>pthread</code>?  C++11+ comes with built in thread support that is type safe and lets you get away from all the casts and <code>void*</code>&#39;s that <code>pthread</code> uses."}, {"owner": {"reputation": 17, "user_id": 5860546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jR2l8z5aKIY/AAAAAAAAAAI/AAAAAAAAAB4/sGM18pm-AC8/photo.jpg?sz=128", "display_name": "Fra Papas", "link": "https://stackoverflow.com/users/5860546/fra-papas"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558555427, "post_id": 56264145, "comment_id": 99144745, "body": "yes, i have to use pthread sadly"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 2, "creation_date": 1558555502, "post_id": 56264145, "comment_id": 99144781, "body": "Show the other parts of your code. As long as the list doesn&#39;t go out of scope this is fine."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1558555547, "post_id": 56264145, "comment_id": 99144797, "body": "This will create the thread, but to tell you whether or not you have the synchronization correct, we&#39;ll need to see the synchronization code."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558556314, "post_id": 56264145, "comment_id": 99145136, "body": "@FraPapas on Linux std::thread uses pthread, so technically you are using it. Homework requirement?"}, {"owner": {"reputation": 4394, "user_id": 11218687, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q9OQOfewRmE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf6UauF-z1wrWfcYS38osHELYqJMA/mo/photo.jpg?sz=128", "display_name": "Dmitry Kuzminov", "link": "https://stackoverflow.com/users/11218687/dmitry-kuzminov"}, "edited": false, "score": 0, "creation_date": 1558559067, "post_id": 56264145, "comment_id": 99146309, "body": "Locking a list with a single mutex is a bad and not effective practice. I would advise you to read the book of Anthony Williams &quot;C++ Concurrency in Action&quot;. That is not an answer to you question (because that would be a huge quote from the book), but that is the best recommendation that could be given. The book worth the time spent. <a href=\"https://www.cplusplusconcurrencyinaction.com/\" rel=\"nofollow noreferrer\">cplusplusconcurrencyinaction.com</a>"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1558559535, "post_id": 56264145, "comment_id": 99146500, "body": "Voted as &quot;off topic&quot; because the real problem was a misunderstanding about how to pass a pointer to a thread."}], "answers": [{"tags": [], "owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "is_accepted": false, "score": 0, "last_activity_date": 1558555649, "creation_date": 1558555649, "answer_id": 56264251, "question_id": 56264145, "link": "https://stackoverflow.com/questions/56264145/sharing-a-list-between-threads-in-c/56264251#56264251", "title": "Sharing a list between threads in C++", "body": "<p>Perhaps make sure the data you're passing in is valid over the lifetime of the threads? If it's destroyed before the threads are done using it, that would lead to undefined behavior.</p>\n\n<p>The last argument to <code>pthread_create</code> is simply a convenience when you want to re-use the same <code>start_routine</code> with different arguments. Threads can shared data simply by referencing the same variables.</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 17, "user_id": 5860546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jR2l8z5aKIY/AAAAAAAAAAI/AAAAAAAAAB4/sGM18pm-AC8/photo.jpg?sz=128", "display_name": "Fra Papas", "link": "https://stackoverflow.com/users/5860546/fra-papas"}, "edited": false, "score": 0, "creation_date": 1558556634, "post_id": 56264415, "comment_id": 99145299, "body": "@FraPapas Alternatively, allocate <code>l</code> on the stack <code>list l;</code> and remove that <code>delete l;</code>."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1558556389, "creation_date": 1558556389, "answer_id": 56264415, "question_id": 56264145, "link": "https://stackoverflow.com/questions/56264145/sharing-a-list-between-threads-in-c/56264415#56264415", "title": "Sharing a list between threads in C++", "body": "<p>In:</p>\n\n<pre><code>thread_create(&amp;(tid[i]), NULL, &amp;trythis, &amp;l); \n</code></pre>\n\n<p>It passes the address of local variable <code>l</code> which is of type <code>list*</code>, so that <code>trythis</code> function gets <code>list**</code> and incorrectly casts it to <code>list*</code>. </p>\n\n<p>Pass <code>l</code> by value instead:</p>\n\n<pre><code>thread_create(&amp;(tid[i]), NULL, &amp;trythis, l); \n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5860546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jR2l8z5aKIY/AAAAAAAAAAI/AAAAAAAAAB4/sGM18pm-AC8/photo.jpg?sz=128", "display_name": "Fra Papas", "link": "https://stackoverflow.com/users/5860546/fra-papas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 1, "closed_date": 1558559462, "accepted_answer_id": 56264415, "answer_count": 2, "score": 0, "last_activity_date": 1558557170, "creation_date": 1558555247, "last_edit_date": 1558556012, "question_id": 56264145, "link": "https://stackoverflow.com/questions/56264145/sharing-a-list-between-threads-in-c", "closed_reason": "Not suitable for this site", "title": "Sharing a list between threads in C++", "body": "<p>I am having a problem with sharing a list between 2 or more threads at C++. I initialize my list in main() and then create the threads, passing the list object pointer as argument: </p>\n\n<pre><code>pthread_create(&amp;(tid[i]), NULL, &amp;threadfunction, &amp;l);\n</code></pre>\n\n<p>where <code>&amp;l</code> is the argument. Is this the correct way to manipulate the same list from 2 or more threads? I use a simple mutex for locking/unlocking, so no more than one thread is accessing it at a time.</p>\n\n<p>EDIT: code below</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;string.h&gt; \n#include &lt;pthread.h&gt; \n#include &lt;stdlib.h&gt; \n#include &lt;unistd.h&gt;\n#include \"list.h\" \n\nusing namespace std;\nint count = 0;\npthread_t tid[2]; \npthread_mutex_t lock; \n\nvoid* trythis(void *arg) \n{ \n    pthread_mutex_lock(&amp;lock); \n    printf(\"Starting thread\\n\");\n    count++;\n    printf(\"%d\\n\", count);\n    if(count == 1)\n    {\n        ((list *)arg)-&gt;Append((char *)\"some\", (char *)\"thing\");\n        printf(\"Appending done\\n\");\n    }\n    else\n    {\n        ((list *)arg)-&gt;Append((char *)\"some\", (char *)\"else\");\n        printf(\"Appending done\\n\");\n    }\n\n    pthread_mutex_unlock(&amp;lock); \n\n    return NULL; \n} \n\nint main(void) \n{ \n    list* l = new list();\n    int i = 0; \n    printf(\"Starting\\n\");\n    if (pthread_mutex_init(&amp;lock, NULL) != 0) \n    { \n        printf(\"mutex init has failed\\n\"); \n        return 1; \n    } \n\nwhile(i &lt; 2) \n{ \n    int err = pthread_create(&amp;(tid[i]), NULL, &amp;trythis, &amp;l); \n    if (err != 0) \n        printf(\"\\nThread can't be created :[%s]\", strerror(err)); \n    i++; \n} \n\npthread_join(tid[0], NULL); \nprintf(\"Im out 1\\n\");\npthread_join(tid[1], NULL); \nprintf(\"Im out 2\\n\");\n\npthread_mutex_destroy(&amp;lock); \n\ndelete l;\nreturn 0; \n</code></pre>\n\n<p>} </p>\n\n<hr>\n\n<p>The Append() function is just adding some elements in the list ( every list Node has 2 char* members).</p>\n"}, {"tags": ["c++", "c++11", "namespaces", "ros"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1558554751, "post_id": 56263914, "comment_id": 99144443, "body": "Usually you cannot pass a member function as a callback because you need an instance of that class in order to call it. I don&#39;t have any experience with ros here, but I&#39;m guessing that&#39;s your issue. You may be able to pass a lambda that captures your instance like so: <code>[&amp;obj](&lt;params&gt;){return obj.filter_function(&lt;params&gt;);</code>"}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 2, "creation_date": 1558554780, "post_id": 56263914, "comment_id": 99144456, "body": "Please post the declaration of <code>ross::NodeHandle::subscribe</code>. Member function pointers cannot be converted to ordinary function pointers."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1558554819, "post_id": 56263914, "comment_id": 99144473, "body": "Remember the hidden <code>this</code>. You must somehow pass an instance into <code>subscribe</code>. <code>obj.filter_function</code> won&#39;t do this for you. see if a lambda expression or <code>std::bind</code> can help."}, {"owner": {"reputation": 1549, "user_id": 3600304, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/582e17ff0889a21f8b0f39315e064e76?s=128&d=identicon&r=PG&f=1", "display_name": "PapaDiHatti", "link": "https://stackoverflow.com/users/3600304/papadihatti"}, "edited": false, "score": 0, "creation_date": 1558554852, "post_id": 56263914, "comment_id": 99144483, "body": "I think you can pass member functions using bind statement so it should be like &quot;auto f = std::bind(&amp;madgwick::MADGWICK_reader,obj,filter_function&quot; and then passing f to n.subscribe."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1558554881, "post_id": 56263914, "comment_id": 99144497, "body": "For those suggesting <code>std::bind</code>, it&#39;s all but deprecated. Use a lambda instead. It reads clearer."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1558555052, "post_id": 56263914, "comment_id": 99144567, "body": "I disagree with lambda being a an easier read than <code>std::bind</code>, but lambda brings several indisputable advantages (faster being a big one) over <code>std::bind</code> to the table, so prefer lambda."}, {"owner": {"reputation": 1816, "user_id": 10150736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed9cdb705538c68aa60a67d628d1cc0?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/10150736/emanuele"}, "edited": false, "score": 0, "creation_date": 1558555083, "post_id": 56263914, "comment_id": 99144577, "body": "Thanks all for the time in reading the question. Can you please provide the answer you are suggesting with the part that I should edit on the <code>main</code> using lambda function?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1558555291, "post_id": 56263914, "comment_id": 99144675, "body": "We can only do that if you answer Quimby&#39;s question."}], "answers": [{"tags": [], "owner": {"reputation": 1549, "user_id": 3600304, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/582e17ff0889a21f8b0f39315e064e76?s=128&d=identicon&r=PG&f=1", "display_name": "PapaDiHatti", "link": "https://stackoverflow.com/users/3600304/papadihatti"}, "is_accepted": true, "score": 1, "last_activity_date": 1558556238, "creation_date": 1558556238, "answer_id": 56264375, "question_id": 56263914, "link": "https://stackoverflow.com/questions/56263914/how-a-nonstatic-member-reference-must-be-relative-to-a-specific-object-can-be/56264375#56264375", "title": "how a &quot;nonstatic member reference must be relative to a specific object&quot; can be solved accessing different function", "body": "<p>Since you have not provided declaration of subscribe but it seems your problem is related to passing class member functions to other function so below solution provide two ways of achieving that one by lambdas and other by bind.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\nclass Test{\n    public:\n    void fun(int x)\n    {\n        std::cout&lt;&lt;\"I am having fun in Test with number \"&lt;&lt;x&lt;&lt;std::endl;\n    }\n};\nvoid sampleFunction(std::function&lt;void(int)&gt; sf,int x)\n{\n    sf(x);\n}\nint main()\n{\n    Test obj;\n    auto objf = std::bind(&amp;Test::fun,&amp;obj,std::placeholders::_1);\n    sampleFunction(objf,5);\n\n    auto lf = [&amp;obj](int y) { return obj.fun(y); };\n    sampleFunction(lf,6);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1816, "user_id": 10150736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed9cdb705538c68aa60a67d628d1cc0?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/10150736/emanuele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 56264375, "answer_count": 1, "score": 0, "last_activity_date": 1558556238, "creation_date": 1558554262, "question_id": 56263914, "link": "https://stackoverflow.com/questions/56263914/how-a-nonstatic-member-reference-must-be-relative-to-a-specific-object-can-be", "title": "how a &quot;nonstatic member reference must be relative to a specific object&quot; can be solved accessing different function", "body": "<p>I am trying to pass some function for testing, into a <code>main()</code> node as shown below. \nHowever, I am getting the following <code>non static member reference must be relative to a specific object</code>. \nI was doing a good amount of research about this probelm, like for example I found <a href=\"https://stackoverflow.com/questions/9818515/what-does-error-a-nonstatic-member-reference-must-be-relative-to-a-specific-o\">this</a> that had a similar problem, also <a href=\"https://stackoverflow.com/questions/36749925/a-nonstatic-member-reference-must-be-relative-to-a-specific-object\">this is useful</a> that was explaining how to access and understand the relationship with the \"parent\" instance. I applied what was advised <a href=\"https://stackoverflow.com/questions/32145335/i-get-a-nonstatic-member-reference-must-be-relative-to-specific-object-error-i\">here</a> and thanks to passing <code>madgwick::MADGWICK_reader obj(std::string file);</code> on the main I was partially able to access to the <code>class MADGWICK_reader</code> that has the function <code>void filter_function(const sensor_msgs::Imu &amp;msg);</code> that I am trying to access from <code>main</code> but still something is not totally correct.</p>\n\n<p>I know that it is not correct to make the members static by simply adding the \"static\" keyword, and that I need to define them as well, and that is the reason why the function is specifically set as <code>void filter_function(const sensor_msgs::Imu &amp;msg);</code>\nI am passing ampersend <code>&amp;</code> on purpose to pass it by reference to <code>main</code> but it seems that the function is never received.</p>\n\n<p>This is the <strong>madgwick_filter.h</strong>, notice the <code>void filter_function(const sensor_msgs::Imu &amp;msg);</code> function that is having the issue in the <code>main</code>:</p>\n\n<pre><code>namespace madgwick\n{\n    using timestamp_t = uint64_t;\n    using timestampToDouble_t = double;\n\n    struct IMU_MADGWICK_DATA\n    {\n        double magz;\n        double magy;\n        double magx;\n        float accelz;\n        float accelx;\n        float accely;\n        unsigned long timestamp;\n        double phi;   // orientation\n        double psi;   // orientation\n        double theta; // orientation\n        double gyrox; // angular velocity x\n        double gyroy; // angular velocity y\n        double gyroz; // angular velocity z\n    };\n\n\n    class Madgwick\n    {\n    public:\n      Madgwick();\n\n    };\n\n    class MADGWICK_reader\n    {\n    public:\n        MADGWICK_reader(std::string filename);\n        bool nextLine();\n        bool nextLineWithSupport();\n\n        IMU_MADGWICK_DATA madgwick_data;\n\n        sensor_msgs::Imu imuMadgwickMsg;\n        sensor_msgs::MagneticField magMedgwickMsg;\n\n        geometry_msgs::QuaternionStamped q;\n        geometry_msgs::Vector3Stamped v;\n        geometry_msgs::TransformStamped q_trans;\n        float sampleFreq;\n        double beta;\n        double q0=1.0, q1=0.0, q2=0.0, q3=0.0;\n        std_msgs::Header header;\n        float ax, ay, az, gx, gy, gz;\n        ros::Duration dtime;\n        float dt;\n\n        float invSqrt();\n        void qua2Euler(geometry_msgs::QuaternionStamped);\n        void madgwickIMU(float gx, float gy, float gz, float ax, float ay, float az);\n        void filter_function(const sensor_msgs::Imu &amp;msg);\n\n    private:\n        io::CSVReader&lt;13&gt; madg_imu_reader;\n        unsigned int imuMadgNum;\n        unsigned int magMadgNum;\n        void packMadgMagMsg();\n        void pack_Imu_Madgwick_Msg();\n        void pack_Mag_Madgwick_Msg();\n    };\n}\n</code></pre>\n\n<p><strong>madgwick_filter.cpp</strong></p>\n\n<pre><code>namespace madgwick\n{\n    Madgwick::Madgwick()\n    {\n\n    }\n\n    MADGWICK_reader::MADGWICK_reader(std::string filename):\n        madg_imu_reader(filename)\n    {\n        // operations ...\n    }\n\n    void MADGWICK_reader::filter_function(const sensor_msgs::Imu &amp;msg)\n    {\n        timestampToDouble_t currentTime = (madgwick_data.timestamp)/1e6;\n        ros::Time stamp(currentTime);\n        header = msg.header;\n        ax = float(msg.linear_acceleration.x);\n        ay = float(msg.linear_acceleration.y);\n        az = float(msg.linear_acceleration.z);\n\n        // more operations ...\n    }\n}\n</code></pre>\n\n<p>and finally this is the <strong>madgwick_filter_node.cpp</strong></p>\n\n<pre><code>#include \"imu_filter_madgwick/madgwick_filter.h\"\n#include &lt;iostream&gt;\n\n    int main(int argc, char** argv)\n    {\n        ros::init(argc, argv, \"madgwick_filter_node\");\n        madgwick::MADGWICK_reader reader(std::string filename);\n\n        ros::NodeHandle n;\n        ros::Publisher pub1 = n.advertise&lt;geometry_msgs::QuaternionStamped&gt;(\"quaternion\", 1);\n        ros::Publisher pub2 = n.advertise&lt;geometry_msgs::Vector3Stamped&gt;(\"ypr\", 1);\n\n        tf::TransformBroadcaster q_brodecaster;\n\n        madgwick::MADGWICK_reader obj(std::string file);\n\n        ros::Subscriber sub = n.subscribe(\"imu0\", 10, obj.filter_function); // &lt;-- Error Here\n\n        ros::spin();\n    }\n</code></pre>\n\n<p>Can anyone point to the right direction or provide an explanation on why it is still not possible to access to the function contained in the class from the <code>main</code>? Thanks for shedding light on this.</p>\n"}, {"tags": ["c++", "eclipse", "inheritance", "constructor"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558555983, "post_id": 56263807, "comment_id": 99144988, "body": "Why do you create <i>two</i> obstacles to people reading your code? 1) C++ (can&#39;t be helped). 2) German (can be rectified) - the international language of programming is english; like it or not, it&#39;s a <i>fact</i>. Don&#39;t make things harder for everyone by using non-english names."}], "answers": [{"tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 1, "last_activity_date": 1558554255, "last_edit_date": 1558554255, "creation_date": 1558553954, "answer_id": 56263843, "question_id": 56263807, "link": "https://stackoverflow.com/questions/56263807/how-to-fix-no-matching-fuction-for-call-to-error-in-c/56263843#56263843", "title": "How to fix &quot;no matching fuction for call to:&quot; error in c++", "body": "<p>You should invoke base class constructor instead of trying to initialize base class fields in derived class (which is not allowed):</p>\n\n<pre><code>gehaltsAbrechnung::gehaltsAbrechnung(int periode, mitarbeiter arbeiter,\n    double gehalt): abrechnung(periode, arbeiter), gehalt(gehalt) {}\n</code></pre>\n\n<p>also <code>mitarbeiter</code> should probably be passed as <code>const &amp;</code></p>\n"}], "owner": {"reputation": 17, "user_id": 9213370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7bcba98c9dce68881fb0cb3497e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Fo Young Areal Lo", "link": "https://stackoverflow.com/users/9213370/fo-young-areal-lo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1558554255, "creation_date": 1558553797, "question_id": 56263807, "link": "https://stackoverflow.com/questions/56263807/how-to-fix-no-matching-fuction-for-call-to-error-in-c", "title": "How to fix &quot;no matching fuction for call to:&quot; error in c++", "body": "<p>I'm writing a program for salary statements and I get this wierd error when I \ninherit purely virally.</p>\n\n<p>I already checked whether I made some mistake in the baseclass or anywhere else but I can't find one.</p>\n\n<p>Base class:</p>\n\n<pre><code>class abrechnung {\npublic:\n    abrechnung(int periode, mitarbeiter&amp; mitarbeiter);\n    virtual ~abrechnung();\n    int getPeriode();\n    mitarbeiter getMitarbeiter();\n    virtual double getVerdienst()=0;\n    std::string toString();\nprivate:\n    int periode;\n    mitarbeiter arbeiter;\n};\n</code></pre>\n\n<p>Derived class:</p>\n\n<pre><code>class gehaltsAbrechnung: public abrechnung {\npublic:\n    gehaltsAbrechnung(int periode, mitarbeiter arbeiter, double gehalt);\n    virtual ~gehaltsAbrechnung();\n    double getVerdienst();\nprivate:\n    double gehalt;\n};\n\ngehaltsAbrechnung::gehaltsAbrechnung(int periode, mitarbeiter arbeiter,                                     \ndouble gehalt): periode(periode), arbeiter(arbeiter), gehalt(gehalt) {}\n</code></pre>\n\n<p>The unexpected error messages are:</p>\n\n<pre><code>no matching function for call to 'abrechnung::abrechnung()'\nclass 'gehaltsAbrechnung' does not have any field named 'periode'\nclass 'gehaltsAbrechnung' does not have any field named 'arbeiter'\n</code></pre>\n\n<p>What did I do wrong and how can I fix that?</p>\n"}, {"tags": ["c++", "templates", "constructor", "variadic-templates", "smart-pointers"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1558554445, "post_id": 56263804, "comment_id": 99144312, "body": "With perfect forwarding: <code>template &lt;typename T, typename... Args&gt;     void CreateComponent(Args&amp;&amp;... args)      {         auto component = std::make_shared&lt;T&gt;(std::forward&lt;Args&gt;(args)...);}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1558554334, "post_id": 56263838, "comment_id": 99144248, "body": "<code>, Args...</code> can probably be omitted as deduced."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558554740, "post_id": 56263838, "comment_id": 99144438, "body": "@Fran&#231;oisAndrieux - yes; I&#39;ve added something. Thanks."}, {"owner": {"reputation": 53, "user_id": 5983799, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/746ede3be11837499c7dc71e2ca61cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Miko\u0142aj Popieluch", "link": "https://stackoverflow.com/users/5983799/miko%c5%82aj-popieluch"}, "edited": false, "score": 0, "creation_date": 1558555756, "post_id": 56263838, "comment_id": 99144884, "body": "Okay, gotcha! Thanks for your help !"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 3, "last_activity_date": 1558555675, "last_edit_date": 1558555675, "creation_date": 1558553944, "answer_id": 56263838, "question_id": 56263804, "link": "https://stackoverflow.com/questions/56263804/create-object-using-parameters-pack-in-template/56263838#56263838", "title": "Create object using parameters pack in template", "body": "<blockquote>\n  <p>But compiler returns an error \" 'args' parameter pack must be expanded in this context\"</p>\n</blockquote>\n\n<p>Yes: you've forgotten to expand the types</p>\n\n<pre><code>m_world-&gt;AddComponent&lt;TComponent, Args...&gt;(m_id, args...);\n// ...................................^^^\n</code></pre>\n\n<p>As pointed by Jarod42, according to the circumstances, you could avoid to explicit the <code>Args...</code> expansion</p>\n\n<pre><code>m_world-&gt;AddComponent&lt;TComponent&gt;(m_id, args...);\n// no more Args...\n</code></pre>\n\n<p>and let the compiler deduce the types through <code>args...</code> (but we should see the <code>AddComponent()</code> definition). </p>\n\n<p>Anyway, I don't see errors in your <code>CreateComponents()</code> function but, as correctly says Fran\u00e7ois Andrieux in a comment, you don't using perfect forwarding.</p>\n\n<p>It's a too-great argument to explain in an answer but, this way, you're renouncing to move semantics advantages (that is: you, potentially, make some unnecessary copies).</p>\n\n<p>The following is your <code>CreateComponents()</code> function enabling perfect forwarding</p>\n\n<pre><code>template &lt;typename TComponent, typename ... Args&gt;\nvoid CreateComponent (Args &amp;&amp; ... args) \n { // .....................^^ forwarding reference added\n   std::shared_ptr&lt;TComponent&gt; component\n     = std::make_shared&lt;TComponent&gt;(std::forward&lt;Args&gt;(args)...);\n } // ..............................^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5983799, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/746ede3be11837499c7dc71e2ca61cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Miko\u0142aj Popieluch", "link": "https://stackoverflow.com/users/5983799/miko%c5%82aj-popieluch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 56263838, "answer_count": 1, "score": 1, "last_activity_date": 1558555675, "creation_date": 1558553786, "last_edit_date": 1558555532, "question_id": 56263804, "link": "https://stackoverflow.com/questions/56263804/create-object-using-parameters-pack-in-template", "title": "Create object using parameters pack in template", "body": "<p>I'd like to create template function that would create object basing on template typename and parameters pack.</p>\n\n<p>I created a function that is supposed to create object based on typename from template, and I would also like to pass parameters pack to that template i order to pass parameters to constructor. Is this correct?:</p>\n\n<pre><code>template&lt;typename TComponent, typename... Args&gt;\n    void CreateComponent(Args... args) \n    {\n        std::shared_ptr&lt;TComponent&gt; component = std::make_shared&lt;TComponent&gt;(args ...);\n    }\n</code></pre>\n\n<p>I also wanted to pass those parameters to another fucntion like this:</p>\n\n<pre><code>template&lt;typename TComponent, typename... Args&gt;\n    void AddComponent(Args... args) \n    {\n          m_world-&gt;AddComponent&lt;TComponent, Args&gt;(m_id, args...);\n    }\n</code></pre>\n\n<p>But compiler returns an error \" 'args' parameter pack must be expanded in this context\"</p>\n\n<p>Is it even possible to achieve what I want to achieve ?</p>\n"}, {"tags": ["c++", "string", "templates", "std"], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1558554248, "post_id": 56263754, "comment_id": 99144216, "body": "interesting observation. Note that outside of constexpr-if the code must be valid, irrespective of any <code>return</code>s before. Its similar to <code>void foo() { return; asdf; }</code> being invalid even though you could argue that <code>asdf;</code> is never reached."}, {"owner": {"reputation": 1153, "user_id": 11434141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1pKD.png?s=128&g=1", "display_name": "AKL", "link": "https://stackoverflow.com/users/11434141/akl"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558558186, "post_id": 56263754, "comment_id": 99145954, "body": "@formerlyknownas_463035818 shouldn&#39;t your comment be (also)under the question?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 1153, "user_id": 11434141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1pKD.png?s=128&g=1", "display_name": "AKL", "link": "https://stackoverflow.com/users/11434141/akl"}, "edited": false, "score": 0, "creation_date": 1558597746, "post_id": 56263754, "comment_id": 99155699, "body": "@AKL its the same user. why should I comment twice?"}, {"owner": {"reputation": 1153, "user_id": 11434141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1pKD.png?s=128&g=1", "display_name": "AKL", "link": "https://stackoverflow.com/users/11434141/akl"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558597921, "post_id": 56263754, "comment_id": 99155781, "body": "@formerlyknownas_463035818  no i know that. I said it because I got confused by reading it under the answer the first time but I found it more fitting for the question."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 1153, "user_id": 11434141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1pKD.png?s=128&g=1", "display_name": "AKL", "link": "https://stackoverflow.com/users/11434141/akl"}, "edited": false, "score": 0, "creation_date": 1558597972, "post_id": 56263754, "comment_id": 99155803, "body": "@AKL sorry, I dont get it. My comment refers to the answer not to the question"}, {"owner": {"reputation": 1153, "user_id": 11434141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1pKD.png?s=128&g=1", "display_name": "AKL", "link": "https://stackoverflow.com/users/11434141/akl"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558598196, "post_id": 56263754, "comment_id": 99155927, "body": "@formerlyknownas_463035818 I am really confused now my friend! Maybe I am getting it wrong but the situation that you illustrated can be seen in the code in the question but not in the answer!"}], "tags": [], "owner": {"reputation": 391, "user_id": 109199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d4d090e4a8574c0c8769e23d13e7e?s=128&d=identicon&r=PG", "display_name": "EMon", "link": "https://stackoverflow.com/users/109199/emon"}, "is_accepted": false, "score": 5, "last_activity_date": 1558553555, "creation_date": 1558553555, "answer_id": 56263754, "question_id": 56263726, "link": "https://stackoverflow.com/questions/56263726/how-to-return-stdstring-from-method-of-templated-class-no-matter-the-type/56263754#56263754", "title": "How to return std::string from method of templated class, no matter the type?", "body": "<p>Almost as soon as I posted, the answer jumped out at me... but perhaps this helps someone else in the future!</p>\n\n<pre><code>if constexpr (!std::is_same_v&lt;T, std::string&gt;) {\n    return std::to_string(m_vector[m_current_index]);\n} else {\n    return m_vector[m_current_index];\n}\n</code></pre>\n\n<p>The compiler isn't smart enough to ignore the 'else' case unless it's specifically within an 'else' block.</p>\n"}], "owner": {"reputation": 391, "user_id": 109199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d4d090e4a8574c0c8769e23d13e7e?s=128&d=identicon&r=PG", "display_name": "EMon", "link": "https://stackoverflow.com/users/109199/emon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1558673040, "creation_date": 1558553456, "last_edit_date": 1558673040, "question_id": 56263726, "link": "https://stackoverflow.com/questions/56263726/how-to-return-stdstring-from-method-of-templated-class-no-matter-the-type", "title": "How to return std::string from method of templated class, no matter the type?", "body": "<p>I'm having a hell of a time solving what I think should be an easy thing to do.  I have a templated class, that looks something like this (has other code, to load the values, etc).  The types I'm concerned with working are char, int, bool, and std::string.</p>\n\n<pre><code>template &lt;typename T&gt;\nclass MyVector\n{\npublic:\n    std::string get()\n    {\n        return m_vector[m_current_index];                   // 1\n        return std::to_string(m_vector[m_current_index]);   // 2\n\n                                                            // 3\n        if constexpr (!std::is_same_v&lt;T, std::string&gt;) {\n            return std::to_string(m_vector[m_current_index]);\n        }\n        return m_vector[m_current_index];\n    }\n\nprivate:\n    std::vector&lt;T&gt; m_vector;\n    int m_current_index{-1};\n};\n</code></pre>\n\n<p>Option (1) above fails for any typename T that is not a std::string.</p>\n\n<p>Option (2) works for any typename T <strong>except</strong> for std::string</p>\n\n<p>Option (3) doesn't appear to get actually handled at compile time (the same error occurs as in the case of option (1))</p>\n"}, {"tags": ["c++", "c", "typedef"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1558553483, "post_id": 56263708, "comment_id": 99143901, "body": "This has a lot of disadvantages, and no real benefits. If it&#39;s any version of a language where booleans exist, those should be used instead. This typedef means that you can have different true values not equal to each other."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558553484, "post_id": 56263708, "comment_id": 99143902, "body": "Some people don&#39;t even bother to <code>typedef</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 9, "creation_date": 1558553492, "post_id": 56263708, "comment_id": 99143907, "body": "C++ and C are two different languages."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1558553495, "post_id": 56263708, "comment_id": 99143910, "body": "Before <code>bool</code> was added to standard C it was fashionable to define your own. There&#39;s heaps of legacy code with it still. Cleaning it completely out is just never a priority."}, {"owner": {"reputation": 337, "user_id": 8952646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd2b924ba57e7db4a4029b0a9bf510b?s=128&d=identicon&r=PG&f=1", "display_name": "isragram", "link": "https://stackoverflow.com/users/8952646/isragram"}, "edited": false, "score": 0, "creation_date": 1558553578, "post_id": 56263708, "comment_id": 99143943, "body": "No advantage at all. Better  #include &lt;stdbool.h&gt;"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558554157, "post_id": 56263708, "comment_id": 99144185, "body": "Fun anecdote: until recently <code>bool b = false; b++;</code> was legal - because obviously you can increment a <code>bool</code> like an <code>int</code> ;) Luckily we recently got rid of that. Compatibility and legacy concerns never fail to surprise and screw you over."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558554298, "post_id": 56263708, "comment_id": 99144236, "body": "@JesperJuhl Still legal... it&#39;s just that <code>b</code> is casted back to <code>bool</code>, so you will get <code>1</code> even after many increments."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558554436, "post_id": 56263708, "comment_id": 99144306, "body": "@EugeneSh. I can&#39;t check right now (on my phone), but I&#39;m <i>fairly</i> sure that as of C++17 &quot;bool increment&quot; is no longer just deprecated, but actually invalid.."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558554455, "post_id": 56263708, "comment_id": 99144318, "body": "@JesperJuhl Oh.. I am talking about C."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1558554643, "post_id": 56263708, "comment_id": 99144390, "body": "@EugeneSh. Just goes to show that C and C++ are <i>very</i> different languages these days :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558555337, "post_id": 56263708, "comment_id": 99144703, "body": "One can do some funny tricks applying arithmetic and bitwise operators on (the standard) <code>bool</code> (in C). <a href=\"https://ideone.com/PrRY2D\" rel=\"nofollow noreferrer\">ideone.com/PrRY2D</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558555421, "post_id": 56263708, "comment_id": 99144741, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193790/discussion-between-jesper-juhl-and-eugene-sh\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1558554848, "post_id": 56263773, "comment_id": 99144481, "body": "@melpomene I&#39;ll take your word on that. My memory of when <code>_Bool</code> was introduced is a bit fuzzy ;) it was a fair number of years ago."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1558555000, "post_id": 56263773, "comment_id": 99144542, "body": "I can give you a citation. :-) ISO 9899:1999, 6.2.5 Types, 2 &quot;An object declared as type <code>_Bool</code> is large enough to store the values 0 and 1.&quot;"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1558555112, "post_id": 56263773, "comment_id": 99144588, "body": "@melpomene Thanks :)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1558556049, "post_id": 56263773, "comment_id": 99145016, "body": "C didn&#39;t want to adopt <code>bool</code> because so much legacy code had already defined their own versions of <code>bool</code> and they didn&#39;t want to invalidate all of that code.  Instead, they made another type from a reserved namespace (that is, a name beginning with an underscore followed by a capital letter).  They still made it really easy to use <code>bool</code> by just including <code>&lt;stdbool.h&gt;</code> if you weren&#39;t handcuffed by legacy code.  Seems like a reasonable compromise to me."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1558556411, "post_id": 56263773, "comment_id": 99145176, "body": "@ChristianGibbons the whole _ + capital == reserved name I know well enough and I can see why they did that. Not breaking old code also makes sense - somewhat. Sometimes you have to break eggs to make an omelet and C++ had already established <code>bool</code> as a keyword. So I <i>get</i> their reasons, but I just think that when looking towards the future (where <i>most</i> code is written) it would have made sense to make a clean break and just adopt <code>bool</code>. But, that&#39;s just <i>my</i> opinion and not what happened."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1558567084, "post_id": 56263773, "comment_id": 99148497, "body": "@JesperJuhl  It is not for the standards body to choose to break my eggs!  As a compiler vendor (who have seats in the standardisation committee), it would be commercially foolish to introduce changes that break your customer&#39;s existing code.  Moreover most of the code I am using now was written in the past (and none of it was written in the future!).  GCC has to compile the Linux code base, and VC++ Windows neither GNU nor Microsoft would needlessly break their own code bases."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 6, "last_activity_date": 1558554338, "last_edit_date": 1558554338, "creation_date": 1558553648, "answer_id": 56263773, "question_id": 56263708, "link": "https://stackoverflow.com/questions/56263708/why-would-someone-use-int-instead-of-bool-data-type/56263773#56263773", "title": "Why would someone use int instead of bool data type?", "body": "<p>One might do so if they were interfacing a lot with C code. Since C does not have a <code>bool</code> type - at least not untill C11 (I think it was, or maybe C99) introduced the <code>_Bool</code> type - which I can't honestly remember if is compatible with C++ <code>bool</code> - they should have just adopted the <code>bool</code> keyword (IMHO), but I digress.</p>\n\n<p>Also, it is common in old C++ code bases that pre-date the C++98 standard where C++ gained <code>bool</code>. </p>\n\n<p>So <em>legacy</em> and <em>C compatibility</em> is the answer.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1558560491, "creation_date": 1558560491, "answer_id": 56265243, "question_id": 56263708, "link": "https://stackoverflow.com/questions/56263708/why-would-someone-use-int-instead-of-bool-data-type/56265243#56265243", "title": "Why would someone use int instead of bool data type?", "body": "<p>C did not have a dedicated Boolean type until the 1999 standard - any scalar with a non-zero value was considered \"true\", while a zero value was considered \"false\".  A common <em>convention</em> was to use macros and/or typedefs to create Boolean values:</p>\n\n<pre><code>#define BOOL int\n#define TRUE (1)\n#define FALSE (0)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>typedef int bool;\nstatic const bool true = 1;\nstatic const bool false = 0;\n</code></pre>\n\n<p>or something similar.</p>\n\n<p>So what you're looking at is either old (pre-C99) C code, or code written by someone who learned C before that standard came out.  </p>\n\n<p>Note that C still considers <em>any</em> non-zero scalar value to be \"true\", and control expressions in <code>if</code> and <code>for</code> and <code>while/do while</code> statements do not specifically have to have Boolean types.  Since it was derived from C, the same is true in C++, even though it also has dedicated Boolean types and operators.  </p>\n"}], "owner": {"reputation": 123, "user_id": 3310193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee55be569e8707bdfd21c5a748e86efe?s=128&d=identicon&r=PG&f=1", "display_name": "Infinity", "link": "https://stackoverflow.com/users/3310193/infinity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 56263773, "answer_count": 2, "score": 0, "last_activity_date": 1558560491, "creation_date": 1558553359, "last_edit_date": 1558554543, "question_id": 56263708, "link": "https://stackoverflow.com/questions/56263708/why-would-someone-use-int-instead-of-bool-data-type", "title": "Why would someone use int instead of bool data type?", "body": "<p>Recently I saw in one project where they typedef int as BOOL and used it in place of bool. Does doing so provides any advantages?</p>\n\n<pre><code>typedef int BOOL;\n</code></pre>\n"}, {"tags": ["c++", "macos", "opengl", "cmake", "clion"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1558554678, "post_id": 56263706, "comment_id": 99144411, "body": "I think the problem is that you pass include directory instead of lib directory <code>link_directories(${ASSIMP_INCLUDE_DIRS})</code>"}, {"owner": {"reputation": 1, "user_id": 11541180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MHIDKBwhgZU/AAAAAAAAAAI/AAAAAAAAASA/RDo9rcNLfcs/photo.jpg?sz=128", "display_name": "Krzysztof Sychla", "link": "https://stackoverflow.com/users/11541180/krzysztof-sychla"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1558562204, "post_id": 56263706, "comment_id": 99147329, "body": "I cnaged it to <code>link_directories(${ASSIMP_LIBRARIES})</code> but the compile errors is still the same (I reloaded my cmake)."}, {"owner": {"reputation": 3822, "user_id": 792456, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6706944a2a8b4e2d37b330dd64cf9c69?s=128&d=identicon&r=PG", "display_name": "arved", "link": "https://stackoverflow.com/users/792456/arved"}, "edited": false, "score": 0, "creation_date": 1558707640, "post_id": 56263706, "comment_id": 99201513, "body": "Try to set VERBOSE=1 environment variable to find out what -L options are used"}, {"owner": {"reputation": 11664, "user_id": 207791, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c9ffc6f77d7f8ee002acd0e9ebc872f2?s=128&d=identicon&r=PG", "display_name": "Victor Sergienko", "link": "https://stackoverflow.com/users/207791/victor-sergienko"}, "edited": false, "score": 0, "creation_date": 1561679220, "post_id": 56263706, "comment_id": 100153790, "body": "<code>${ASSIMP_LIBRARIES}</code> is a set of library file references, not a directory. Try <code>target_link_libraries(OpenGlSetup  ${ASSIMP_LIBRARIES})</code>."}], "owner": {"reputation": 1, "user_id": 11541180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MHIDKBwhgZU/AAAAAAAAAAI/AAAAAAAAASA/RDo9rcNLfcs/photo.jpg?sz=128", "display_name": "Krzysztof Sychla", "link": "https://stackoverflow.com/users/11541180/krzysztof-sychla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558555468, "creation_date": 1558553353, "last_edit_date": 1558555468, "question_id": 56263706, "link": "https://stackoverflow.com/questions/56263706/clion-fails-to-link-a-found-library-while-manual-compiling-works", "title": "Clion fails to link a found library, while manual compiling works", "body": "<p>I am trying to create a cross-platform openGL application on macos using Clion. Cmake script finds assimp library properly but is unable to link it.</p>\n\n<p>I tried reinstalling assimp, then recompiling it. Next I checked if compiling manually does the job (surprisingly it does).</p>\n\n<p>Here is the command: <code>clang main.cpp -std=c++11 -framework OpenGL -lglfw -lassimp -lglew -o main</code> (it works also with g++).</p>\n\n<p>Here is my CmakeList.txt:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.12)\nproject(OpenGlSetup)\n\nset(CMAKE_CXX_STANDARD 17)\n\nset(CMAKE_MODULE_PATH \"${PROJECT_SOURCE_DIR}/Modules/\")\nmessage(CMAKE_MODULE_PATH : ${PROJECT_SOURCE_DIR}/Modules/)\n\nset(SOURCE_FILES main.cpp)\nadd_executable(OpenGlSetup ${SOURCE_FILES})\n\nfind_package(ASSIMP REQUIRED)\nIF (NOT ASSIMP_FOUND)\nmessage(WARNING ASSIMP-NOT-FOUND : ${ASSIMP_INCLUDE_DIRS})\nENDIF()\n\n*** rest of the libraries are loaded in the same way, and they load properly (project compiles and run provided i remove assimp parts) **\n\ninclude_directories(${OPENGL_INCLUDE_DIR} ${GLM_INCLUDE_DIRS} ${ASSIMP_INCLUDE_DIRS})\nlink_directories(${ASSIMP_INCLUDE_DIRS})\ntarget_link_libraries(OpenGlSetup ${OPENGL_LIBRARY} ${GLEW_LIBRARY} ${ASSIMP_LIBRARIES} glfw)\n</code></pre>\n\n<p>Here is my application:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;GL/glew.h&gt;\n#include &lt;GLFW/glfw3.h&gt;\n#include &lt;glm/glm.hpp&gt;\n#include &lt;cmath&gt;\n\n#include &lt;assimp/scene.h&gt;\n#include &lt;assimp/Importer.hpp&gt;\n\n    static void glfwError(int id, const char* description)\n{\n    std::cout &lt;&lt; description &lt;&lt; std::endl;\n}\n\nint main(int argc, char *argv[]) {\n    if (!glfwInit()) {\n        printf(\"failed to initialize GLFW.\\n\");\n        return -1;\n    }\n\n\n\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);\n    glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, true);\n    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\n\n    auto window = glfwCreateWindow(1000, 600, \"awesome\", nullptr, nullptr);\n    if (!window) {\n        return -1;\n    }\n\n    glfwMakeContextCurrent(window);\n    if (glewInit()) {\n        printf(\"failed to initialize OpenGL\\n\");\n        return -1;\n    }\n\n    printf(\"OpenGL %s, GLSL %s\\n\", glGetString(GL_VERSION), glGetString(GL_SHADING_LANGUAGE_VERSION));\n\n    while(!glfwWindowShouldClose(window)) {\n        glClearColor(0.f,\n                     0.f,\n                     1.f,\n                     1.f\n                     );\n        glClear(GL_COLOR_BUFFER_BIT);\n        glfwSwapBuffers(window);\n        glfwPollEvents();\n    };\n\n    Assimp::Importer importer;\n    aiScene* scene;\n\n    return 0;\n}\n</code></pre>\n\n<p>Errors:</p>\n\n<pre><code>[ 50%] Building CXX object CMakeFiles/OpenGlSetup.dir/main.cpp.o\n[100%] Linking CXX executable OpenGlSetup\nld: library not found for -lassimp\nclang: error: linker command failed with exit code 1 (use -v to see.         invocation)\nmake[3]: *** [OpenGlSetup] Error 1\nmake[2]: *** [CMakeFiles/OpenGlSetup.dir/all] Error 2\nmake[1]: *** [CMakeFiles/OpenGlSetup.dir/rule] Error 2\nmake: *** [OpenGlSetup] Error 2\n</code></pre>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1558553373, "post_id": 56263694, "comment_id": 99143849, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/class_template#Explicit_instantiation\" rel=\"nofollow noreferrer\">Explicit instantiation</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1558553389, "post_id": 56263694, "comment_id": 99143856, "body": "&quot;I&#39;ve seen the following code in cppreference&quot; - obviously, you should link to where you have seen this."}, {"owner": {"reputation": 437, "user_id": 11535065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d96873cd2481b71144c919655ffa2c?s=128&d=identicon&r=PG&f=1", "display_name": "beginpluses", "link": "https://stackoverflow.com/users/11535065/beginpluses"}, "edited": false, "score": 0, "creation_date": 1558553492, "post_id": 56263694, "comment_id": 99143908, "body": "Added a link. Thanks"}, {"owner": {"reputation": 437, "user_id": 11535065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d96873cd2481b71144c919655ffa2c?s=128&d=identicon&r=PG&f=1", "display_name": "beginpluses", "link": "https://stackoverflow.com/users/11535065/beginpluses"}, "edited": false, "score": 0, "creation_date": 1558553752, "post_id": 56263694, "comment_id": 99144009, "body": "Thank you! What if I wrote just void func&lt;X&gt;();? Wouldn&#39;t such a declaration instantiate the template of function func?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558554756, "post_id": 56263694, "comment_id": 99144447, "body": "You could, but not at namespace scope. It would look like you are trying to just execute it which you can&#39;t do there. You could put it in function though, but in this case it doesn&#39;t look like they actually intend to execute it."}, {"owner": {"reputation": 1153, "user_id": 11434141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1pKD.png?s=128&g=1", "display_name": "AKL", "link": "https://stackoverflow.com/users/11434141/akl"}, "edited": false, "score": 0, "creation_date": 1558554790, "post_id": 56263694, "comment_id": 99144464, "body": "I think, that is not the actual code my friend but an explanation for a  temporary result."}], "owner": {"reputation": 437, "user_id": 11535065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d96873cd2481b71144c919655ffa2c?s=128&d=identicon&r=PG&f=1", "display_name": "beginpluses", "link": "https://stackoverflow.com/users/11535065/beginpluses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558553390, "creation_date": 1558553267, "last_edit_date": 1558553390, "question_id": 56263694, "link": "https://stackoverflow.com/questions/56263694/what-is-template-void-funcx", "title": "What is template void func&lt;X&gt;();?", "body": "<p>I've seen the following code in cppreference page about enable_if:</p>\n\n<pre><code>struct X {\n    enum { value1 = true, value2 = true };\n};\n\ntemplate&lt;class T, std::enable_if_t&lt;T::value1, int&gt; = 0&gt;\nvoid func() {} // #1\n\ntemplate void func&lt;X&gt;(); // What's this?\n</code></pre>\n\n<p>Could you please tell me what does template before function</p>\n\n<pre><code>template void func&lt;X&gt;(); \n</code></pre>\n\n<p>mean? </p>\n\n<p>cppreference link:\n<a href=\"https://en.cppreference.com/w/cpp/types/enable_if\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/types/enable_if</a></p>\n"}, {"tags": ["c++", "qt", "qt5", "qtcpsocket"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558553970, "post_id": 56263647, "comment_id": 99144109, "body": "Is there any way to replicate the server?"}, {"owner": {"reputation": 11, "user_id": 8967406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e50d679a7dc451ff29ebbf47fb843c0?s=128&d=identicon&r=PG&f=1", "display_name": "neewaz", "link": "https://stackoverflow.com/users/8967406/neewaz"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558554694, "post_id": 56263647, "comment_id": 99144423, "body": "The server is a robot simulator software from Universal Robot. I don&#39;t know any way to replicate it.  But the simulator can be downloaded from the links below: <a href=\"https://www.universal-robots.com/download/?option=51823#section16597\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 11, "user_id": 8967406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e50d679a7dc451ff29ebbf47fb843c0?s=128&d=identicon&r=PG&f=1", "display_name": "neewaz", "link": "https://stackoverflow.com/users/8967406/neewaz"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558554891, "post_id": 56263647, "comment_id": 99144500, "body": "@eyllanesc link for linux is: <a href=\"https://www.universal-robots.com/download/?option=51821#section16632\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558555244, "post_id": 56263647, "comment_id": 99144654, "body": "Assuming that I download the SW and execute it, what else do I have to do to be able to use your script?"}, {"owner": {"reputation": 11, "user_id": 8967406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e50d679a7dc451ff29ebbf47fb843c0?s=128&d=identicon&r=PG&f=1", "display_name": "neewaz", "link": "https://stackoverflow.com/users/8967406/neewaz"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558556695, "post_id": 56263647, "comment_id": 99145330, "body": "If you have a windows machine the simulator should be run on VMware player, beacuse it is linux based. And you just need to connect to the corresponding IP of the virtual machine and port 30003. There will be 3 robot simulator software on the main screen UR3, UR5 and UR10, you just need to run one of them and then you can run the script."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8967406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e50d679a7dc451ff29ebbf47fb843c0?s=128&d=identicon&r=PG&f=1", "display_name": "neewaz", "link": "https://stackoverflow.com/users/8967406/neewaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1558899194, "creation_date": 1558899194, "answer_id": 56316752, "question_id": 56263647, "link": "https://stackoverflow.com/questions/56263647/qtcpsocket-decoding-received-data/56316752#56316752", "title": "QTcpSocket: decoding received data", "body": "<p>I am able to decode the data myself with the code below:</p>\n\n<pre><code>// joint values\ndouble q1 = 0, q2=0, q3=0, q4=0, q5=0, q6=0;\n// pose values\ndouble x = 0, y=0, z=0, rX=0, rY=0, rZ=0;\n\nQByteArray array;\narray = p_socket-&gt;readAll();\n\n// decoding length data\nint length = 0;\nmemcpy(&amp;length, array.constData(), 4);\nlength = qToBigEndian(length);\nqDebug() &lt;&lt; length;\n\nint byteLength = 8;\n\n// decoding joint 1 value\nQByteArray jointArray1 = array.mid(252,byteLength).toHex();\nlong long currentJointPosition1=jointArray1.toLongLong(0,16);\nq1 = reinterpret_cast&lt;double&amp;&gt;(currentJointPosition1);\n\n// decoding joint 2 value\nQByteArray jointArray2 = array.mid(252+1*byteLength,byteLength).toHex();\nlong long currentJointPosition2=jointArray2.toLongLong(0,16);\nq2 = reinterpret_cast&lt;double&amp;&gt;(currentJointPosition2);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8967406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e50d679a7dc451ff29ebbf47fb843c0?s=128&d=identicon&r=PG&f=1", "display_name": "neewaz", "link": "https://stackoverflow.com/users/8967406/neewaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558899194, "creation_date": 1558553041, "last_edit_date": 1558554563, "question_id": 56263647, "link": "https://stackoverflow.com/questions/56263647/qtcpsocket-decoding-received-data", "title": "QTcpSocket: decoding received data", "body": "<p>I need to decode the data received from Universal Robot UR5 server. The data received is below. Can somebody please help me with decoding this message using Qt5 c++?</p>\n\n<pre><code>\\x00\\x00\\x04T@\\xE2\\xB2\\xB8\\xD4\\xFD\\xF3\\xB6@\\t\\\"\\xD0\\xE5`A\\x8A\\xBF\\xF9\\\"\\xD0\\xE5`A\\x88?\\xF9\\\"\\xD0\\xE5`A\\x89@\\x12\\xD9\\x16\\x87+\\x02\\f@\\x12\\xD9\\x16\\x87+\\x02\\f@\\t\\\"\\xD0\\xE5`A\\x89\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xBB\\xE0\"\"f\\xD1\\x1B\\xE1\\x95\\x8B\\xBF\\xF5\\xB6\\x18\\xBE\\xB0YA\\xBF\\xF5\\xB8\\x9E\\xE6\\xCB\\xD9\\xBC\\xBF\\xC4^\\\\\\xFC^\\x81i\\xBE\\xEE@\\x01\\xF2\\xD7\\b\\x05\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xBC\\x19\\xE2\"\"B\\x00\\x00\\x00\\x00\\xC0\"\"1!\\xAF\\x86w&amp;m\\xC0\"\"1#\\xAD\"\"b\\x1C\\xD9\\xCE\\xBF\\xF7\\xB5\\xA6.\\xF4Tz\\xBF!\\x9B\\x1B\\xF6\\x80\\xFFP\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00@\\t\\\"\\xD0\\xE0\\x00\\x00\\x00\\xBF\\xF9\\\"\\xD0\\xD1\\x10\\xB4`?\\xF9\\\"\\xD0\\xE0\\x00\\x00\\x00@\\x12\\xD9\\x16\\x80\\x00\\x00\\x00@\\x12\\xD9\\x16\\x80\\x00\\x00\\x00@\\t\\\"\\xD0\\xE0\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xBB\\xE0\"\"f\\xD1 \\x00\\x00\\x00\\xBF\\xF5\\xB6\\x18\\xC0\\x00\\x00\\x00\\xBF\\xF5\\xB8\\x9E\\xE0\\x00\\x00\\x00\\xBF\\xC4^]\\x00\\x00\\x00\\x00\\xBE\\xEE@\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xBB\\xE0\"\"f\\xD1 \\x00\\x00\\x00\\xBF\\xF5\\xB6\\x18\\xC0\\x00\\x00\\x00\\xBF\\xF5\\xB8\\x9E\\xE0\\x00\\x00\\x00\\xBF\\xC4^]\\x00\\x00\\x00\\x00\\xBE\\xEE@\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00?\\xDF(\\xD4\\xDE\\xE9Z\\x10?\\xBB\\xF7\\xD1N%*9?\\xD0\\xC2\\xE6\\xB9\\x87\\x1C\\xE1@\\x01\\xC4\\xB7+\\x83\\x8B\\xD2@\\x01\\xC4\\xB7\\x14\\xE4\\x1D\\xCA&gt;\\x93q]e!\\xED\\xD8\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&gt;\\xAE\\x18\\xA0\\x85\\x9A\\xCB'&gt;\\x8B\\r\\xC1\"\"E\\x1F\\x9C\\x06&gt;\\xAC\\xB0\\xAA\\xDB\\xDFm,\\xBEkF\\xDE\"\"b\\x8D\\xBCQ&gt;\\x95\\xADv\\x92\\xF8(\\xF5\\xBD\\xE3\\xFC\\x04\\x11\\xC6\\xD3\\x19?\\xDF(\\xD4\\xA9\\xCF\\xAD\\x8C?\\xBB\\xF7\\xD2\\x15\\x90\\xF0\\xA6?\\xD0\\xC2\\xE6\\xCB\\xBC]O@\\x01\\xC4\\xB7\"\"6\\x1C\\xF6\\x04@\\x01\\xC4\\xB7\\x1F\\x7F\\xE0M&gt;\\x97\\x96\"\"3\\x90\\xB0*\\xE2\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00@D\\x00\\x00\\x00\\x00\\x00\\x00@D\\x00\\x00\\x00\\x00\\x00\\x00@D\\x00\\x00\\x00\\x00\\x00\\x00@D\\x00\\x00\\x00\\x00\\x00\\x00@D\\x00\\x00\\x00\\x00\\x00\\x00@D\\x00\\x00\\x00\\x00\\x00\\x00?\\xC1\\xF0g\\x05\\xC8\\x96\\xDD@ \\x00\\x00\\x00\\x00\\x00\\x00@\\x1C\\x00\\x00\\x00\\x00\\x00\\x00@o\\xA0\\x00\\x00\\x00\\x00\\x00@o\\xA0\\x00\\x00\\x00\\x00\\x00@o\\xA0\\x00\\x00\\x00\\x00\\x00@o\\xA0\\x00\\x00\\x00\\x00\\x00@o\\xA0\\x00\\x00\\x00\\x00\\x00@o\\xA0\\x00\\x00\\x00\\x00\\x00?\\xF0\\x00\\x00\\x00\\x00\\x00\\x00@\\x13\\xB8\\xAA\\x9D\\x1AX\\xAE@\\x14k\\xD0*\\xDC-\\xAE@\\x15\\xAEW\\xC1q\\x0E\\xBC@\\f\\xDBv7\\x18'\\xDA@\\x0B\\x03t\\x19\\x01\\xE5{?\\xF1\\x05\\x92*d\n</code></pre>\n\n<p>This works with the python code below. But I need to do this in Qt5 c++.</p>\n\n<pre><code>     s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n     s.settimeout(10)\n     s.connect((HOST, PORT_30003))\n     time.sleep(1.00)\n     print \"\"\n     packet_1 = s.recv(4)\n     packet_2 = s.recv(8)\n     packet_3 = s.recv(48)\n     packet_4 = s.recv(48)\n     packet_5 = s.recv(48)\n     packet_6 = s.recv(48)\n     packet_7 = s.recv(48)\n\n     #reading current joint values from 48 bytes\n\n     packet_18 = s.recv(8)\n     packet_18 = packet_18.encode(\"hex\") #convert the data from \\x hex notation to plain hex\n     q1 = str(packet_18)\n     q1 = struct.unpack('!d', packet_18.decode('hex'))[0]\n     print \"q1 = \", q1 * 180/3.1416\n\n     packet_19 = s.recv(8)\n     packet_19 = packet_19.encode(\"hex\") #convert the data from \\x hex notation to plain hex\n     q2 = str(packet_19)\n     q2 = struct.unpack('!d', packet_19.decode('hex'))[0]\n     print \"q2 = \", q2 * 180/3.1416\n\n     packet_20 = s.recv(8)\n     packet_20 = packet_20.encode(\"hex\") #convert the data from \\x hex notation to plain hex\n     q3 = str(packet_20)\n     q3 = struct.unpack('!d', packet_20.decode('hex'))[0]\n     print \"q3 = \", q3 * 180/3.1416\n\n     packet_21 = s.recv(8)\n     packet_21 = packet_21.encode(\"hex\") #convert the data from \\x hex notation to plain hex\n     q4 = str(packet_21)\n     q4 = struct.unpack('!d', packet_21.decode('hex'))[0]\n     print \"q4 = \", q4 * 180/3.1416\n\n     packet_22 = s.recv(8)\n     packet_22 = packet_22.encode(\"hex\") #convert the data from \\x hex notation to plain hex\n     q5 = str(packet_22)\n     q5 = struct.unpack('!d', packet_22.decode('hex'))[0]\n     print \"q5 = \", q5 * 180/3.1416\n\n     packet_23 = s.recv(8)\n     packet_23 = packet_23.encode(\"hex\") #convert the data from \\x hex notation to plain hex\n     q6 = str(packet_23)\n     q6 = struct.unpack('!d', packet_23.decode('hex'))[0]\n     print \"q6 = \", q6 * 180/3.1416\n</code></pre>\n"}, {"tags": ["c++", "opengl", "glm-math"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558553182, "post_id": 56263607, "comment_id": 99143764, "body": "What is &quot;in front of&quot; in this case?"}], "answers": [{"comments": [{"owner": {"reputation": 864, "user_id": 9609025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a028356e4549baeabab70bc969af80a8?s=128&d=identicon&r=PG&f=1", "display_name": "mackycheese21", "link": "https://stackoverflow.com/users/9609025/mackycheese21"}, "edited": false, "score": 0, "creation_date": 1558553882, "post_id": 56263629, "comment_id": 99144071, "body": "No! You forgot to normalize <code>a.dir</code>.  If you don&#39;t normalize it, then it will be 2 dir lengths in front of A, not two units in front of A."}, {"owner": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "reply_to_user": {"reputation": 864, "user_id": 9609025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a028356e4549baeabab70bc969af80a8?s=128&d=identicon&r=PG&f=1", "display_name": "mackycheese21", "link": "https://stackoverflow.com/users/9609025/mackycheese21"}, "edited": false, "score": 0, "creation_date": 1558553896, "post_id": 56263629, "comment_id": 99144078, "body": "@mackycheese21 Wouldn&#39;t you assume a field called <code>direction</code> is already normalized?"}, {"owner": {"reputation": 864, "user_id": 9609025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a028356e4549baeabab70bc969af80a8?s=128&d=identicon&r=PG&f=1", "display_name": "mackycheese21", "link": "https://stackoverflow.com/users/9609025/mackycheese21"}, "edited": false, "score": 0, "creation_date": 1558553981, "post_id": 56263629, "comment_id": 99144114, "body": "Not necesarilly, no.  Direction could mean anything from velocity to actual direction.  And normalization is such a simple operation, and it gives you such an important gaurantee, that it&#39;s worth it to have."}, {"owner": {"reputation": 864, "user_id": 9609025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a028356e4549baeabab70bc969af80a8?s=128&d=identicon&r=PG&f=1", "display_name": "mackycheese21", "link": "https://stackoverflow.com/users/9609025/mackycheese21"}, "edited": false, "score": 0, "creation_date": 1558554028, "post_id": 56263629, "comment_id": 99144130, "body": "I realize that it has a square root which is slow, but consider this: If the speed of square roots is slowing your computer down, either you are misusing GLM and should be using GPU / GLSL / OpenCL, or you are on a potato and no-one can help you."}, {"owner": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "reply_to_user": {"reputation": 864, "user_id": 9609025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a028356e4549baeabab70bc969af80a8?s=128&d=identicon&r=PG&f=1", "display_name": "mackycheese21", "link": "https://stackoverflow.com/users/9609025/mackycheese21"}, "edited": false, "score": 0, "creation_date": 1558554227, "post_id": 56263629, "comment_id": 99144210, "body": "@mackycheese21 I find your last statement a bit ridiculous. Any attempt to optimize CPU code is futile, just use GPUs instead?"}, {"owner": {"reputation": 864, "user_id": 9609025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a028356e4549baeabab70bc969af80a8?s=128&d=identicon&r=PG&f=1", "display_name": "mackycheese21", "link": "https://stackoverflow.com/users/9609025/mackycheese21"}, "edited": false, "score": 0, "creation_date": 1558554411, "post_id": 56263629, "comment_id": 99144287, "body": "no.  If your code is so slow that removing square roots seems the best route to efficiency, then you have other issues.  What I meant was that if a single square root was slowing you down, then you are probably doing way too many GLM operations and you should consider moving them to the GPU.  The GPU is very good at repeated things.  GLM is best for once-per-frame calculations."}, {"owner": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "reply_to_user": {"reputation": 864, "user_id": 9609025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a028356e4549baeabab70bc969af80a8?s=128&d=identicon&r=PG&f=1", "display_name": "mackycheese21", "link": "https://stackoverflow.com/users/9609025/mackycheese21"}, "edited": false, "score": 0, "creation_date": 1558554563, "post_id": 56263629, "comment_id": 99144364, "body": "@mackycheese21 It&#39;s a futile argument. If performance is an issue, you should never be in a position where you don&#39;t know whether or not the data you&#39;re operating on is normalized. If it is, you absolutely don&#39;t need to re-normalize, otherwise you definitely do."}, {"owner": {"reputation": 864, "user_id": 9609025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a028356e4549baeabab70bc969af80a8?s=128&d=identicon&r=PG&f=1", "display_name": "mackycheese21", "link": "https://stackoverflow.com/users/9609025/mackycheese21"}, "reply_to_user": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "edited": false, "score": 0, "creation_date": 1558554661, "post_id": 56263629, "comment_id": 99144405, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193789/discussion-between-mackycheese21-and-rotem\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "is_accepted": false, "score": 0, "last_activity_date": 1558553410, "last_edit_date": 1558553410, "creation_date": 1558552957, "answer_id": 56263629, "question_id": 56263607, "link": "https://stackoverflow.com/questions/56263607/create-vector-b-using-position-and-direction-of-vector-a/56263629#56263629", "title": "Create Vector B Using Position and Direction of Vector A", "body": "<p>Point B would have position which is equal to Point A's position + Point A's direction times 2, since (I'm assuming here) the direction is a unit vector of length 1.</p>\n\n<pre><code>glm::vec3 positionB = a.pos + a.dir * 2.f;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 2, "last_activity_date": 1558554816, "last_edit_date": 1558554816, "creation_date": 1558553308, "answer_id": 56263700, "question_id": 56263607, "link": "https://stackoverflow.com/questions/56263607/create-vector-b-using-position-and-direction-of-vector-a/56263700#56263700", "title": "Create Vector B Using Position and Direction of Vector A", "body": "<p>A point on a ray can be get by:</p>\n\n<pre><code>B = A + D * t\n</code></pre>\n\n<p>where <code>A</code> is the origin of the ray, <code>D</code> is a the direction vector with length 1 (<a href=\"https://en.wikipedia.org/wiki/Unit_vector\" rel=\"nofollow noreferrer\"><code>Unit vector</code></a>) and <code>t</code> is the distance form <code>A</code> to <code>B</code>. </p>\n\n<p>With the <a href=\"https://glm.g-truc.net/0.9.9/index.html\" rel=\"nofollow noreferrer\">GLM</a> this can be expressed like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct Ray\n{\n    glm::vec3 position;\n    glm::vec3 direction;\n};\n\nRay A;\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>float t = 2.0f;\nglm::vec3 B = A.position + glm::normalize(A.direction) * t;\n</code></pre>\n\n<p><a href=\"https://glm.g-truc.net/0.9.9/api/a00697.html#ga3b8d3dcae77870781392ed2902cce597\" rel=\"nofollow noreferrer\"><code>normalize()</code></a> calculates a vector in the same direction as the given vector, but with length of 1.</p>\n\n<p>If the direction vector is stored as a unit vector (with length 1), then the expensive <code>normalize()</code> operation can be avoided, when a point on the ray is calculated.<br>\nI recommend to define a <code>class Ray</code> which can calculate a point on the ray:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Ray\n{\npublic:\n\n   Ray(const glm::vec3 &amp;O, const glm::vec3 &amp;D)\n     : _O(O)\n     , _D(glm::normalize(D))\n   {}\n\n   glm::vec3 P(float t) const {\n       return _O + _D * t;\n   }\n\nprivate:\n    glm::vec3 _O;\n    glm::vec3 _D;\n};\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Ray A(glm::vec3(....), glm::vec3(....));\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>glm::vec3 B = A.P( 2.0f );\n</code></pre>\n"}], "owner": {"reputation": 2022, "user_id": 1609485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/1KzNA.jpg?s=128&g=1", "display_name": "whitwhoa", "link": "https://stackoverflow.com/users/1609485/whitwhoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "closed_date": 1558613786, "accepted_answer_id": 56263700, "answer_count": 2, "score": 0, "last_activity_date": 1558554816, "creation_date": 1558552847, "question_id": 56263607, "link": "https://stackoverflow.com/questions/56263607/create-vector-b-using-position-and-direction-of-vector-a", "closed_reason": "Needs details or clarity", "title": "Create Vector B Using Position and Direction of Vector A", "body": "<p>I am currently trying to understand how to go about creating a vector at a specific position relative to the position and direction of another vector. For example, I have this illustration which might help explain what I am trying to accomplish:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E5YEJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E5YEJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Point <code>A</code> contains properties: <code>glm::vec3 position</code> and <code>glm::vec3 direction</code>. Now let's say I want point <code>B</code> to be 2 units in front of <code>A</code>. Is there a way to solve this mathematically using glm to determine the position of <code>B</code>?</p>\n"}, {"tags": ["c++", "class", "c++11", "stdvector", "stdinitializerlist"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1558553426, "post_id": 56263581, "comment_id": 99143873, "body": "Is <code>MainClass::MainClass(std::vector&lt;int&gt; varName) {    for ( size_t i : varName )    {       attribute.push_back(std::vector&lt;ExtClass&gt;(i));    } }</code> not acceptable?"}, {"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1558553855, "post_id": 56263581, "comment_id": 99144057, "body": "<code>ExtClass </code> has tow fields: <code>ext</code> and <code>pet</code>. How would <code>attribute[0] has {1, 2, 3, 4} of type ExtClass</code> fit inside?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1558554162, "post_id": 56263581, "comment_id": 99144190, "body": "@JeJo, I think he means there will be 9 instances of <code>ExtClass</code> and the first four inistances will be used to create the first element of <code>atttribtute</code>."}, {"owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 0, "creation_date": 1558556400, "post_id": 56263581, "comment_id": 99145170, "body": "R Sahu, that&#39;s exactly what I meant. Not the solution I am looking for, but thanks! :) It works! :)"}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 1, "creation_date": 1558556484, "post_id": 56264053, "comment_id": 99145216, "body": "Thanks, JeJo! :)  The first code didn&#39;t work for me, maybe I&#39;ve mistyped something. But the second is definitely working.  I was looking how to do that using initialiser list, but this is okay since it works.  Thank you and R Sahu! :)"}, {"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "reply_to_user": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 0, "creation_date": 1558557412, "post_id": 56264053, "comment_id": 99145634, "body": "@Amaterastis Hmm.. That&#39;s strange. The first one allocates <code>vec.size()</code> no of rows in the <code>attribute</code> first and then for each rows (i.e. <code>std::vector&lt;ExtClass&gt;</code> in the vector) will be <i>resized</i> to the passed elements(i.e. column number) of <code>vec</code>. Where as the second one construct the <code>std::vector&lt;ExtClass&gt;</code> in a vector <i>in-place</i>, as per the passed elements(i.e. column number) of <code>vec</code>. Technically speaking, the end result should be the same."}], "tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": true, "score": 3, "last_activity_date": 1558555609, "last_edit_date": 1558555609, "creation_date": 1558554797, "answer_id": 56264053, "question_id": 56263581, "link": "https://stackoverflow.com/questions/56263581/how-to-use-initialiser-list-in-constructor-call-to-configure-stdvectorstdv/56264053#56264053", "title": "How to use initialiser list in constructor call to configure `std::vector&lt;std::vector&lt;MyClass&gt;&gt;`?", "body": "<p>You can <em><a href=\"https://en.cppreference.com/w/cpp/container/vector/resize\" rel=\"nofollow noreferrer\"><code>std::vector::resize</code></a></em> each <em>vector</em> of <code>std::vector&lt;ExtClass&gt;</code> in the constrotr of the <code>MainClass</code>.</p>\n\n<p>See a <strong>(<a href=\"https://wandbox.org/permlink/tX3sIYGLhhR1zexA\" rel=\"nofollow noreferrer\">sample code</a>)</strong></p>\n\n<pre><code>MainClass(const std::vector&lt;int&gt;&amp; vec)\n    : attribute(vec.size())\n{\n    int row = 0;\n    // each cols will be resized to as per\n    for(const int colSize: vec) attribute[row++].resize(colSize);\n}\n</code></pre>\n\n<p>Or as <em><a href=\"https://stackoverflow.com/questions/56263581/how-to-use-initialiser-list-in-constructor-call-to-configure-stdvectorstdve#comment99143873_56263581\">@RSahu</a></em> suggested in in the comments.</p>\n\n<pre><code>MainClass(const std::vector&lt;int&gt;&amp; vec)\n{\n    attribute.reserve(vec.size()); // reserve the memory for row = vec.size()\n    for (const int colSize : vec)\n        attribute.emplace_back(std::vector&lt;ExtClass&gt;(colSize));\n}\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56264053, "answer_count": 1, "score": 1, "last_activity_date": 1558557142, "creation_date": 1558552731, "last_edit_date": 1558557142, "question_id": 56263581, "link": "https://stackoverflow.com/questions/56263581/how-to-use-initialiser-list-in-constructor-call-to-configure-stdvectorstdv", "title": "How to use initialiser list in constructor call to configure `std::vector&lt;std::vector&lt;MyClass&gt;&gt;`?", "body": "<p>About an hour ago or so, I have been pointed out to something called initializer list, so immediately I have started researching it, but there is one thing I cannot understand.</p>\n\n<p>If I have something like:</p>\n\n<pre><code>class ExtClass {\n    public:\n        int ext;\n        int pet;        \n        ExtClass();\n};\n\nExtClass::ExtClass() {\n    this-&gt;ext = rand();\n    this-&gt;pet = rand();\n}\n\nclass MainClass {\n    public:    \n        std::vector&lt;std::vector&lt;ExtClass&gt;&gt; attribute;\n\n        MainClass(std::vector&lt;int&gt;&gt;);\n};\n\nMainClass::MainClass(std::vector&lt;int&gt; varName) : attribute(...) { }\n</code></pre>\n\n<p>The thing is I want this to happen:</p>\n\n<pre><code>attribute[0] has {1, 2, 3, 4} of type ExtClass\nattribute[1] has {5, 6}       of type ExtClass\nattribute[2] has {7, 8, 9}    of type ExtClass\n</code></pre>\n\n<p>and so on.</p>\n\n<p>What I would like is when I call:</p>\n\n<pre><code>std::vector&lt;int&gt; a{4, 2, 3};\nMainClass mainObject(a);\n</code></pre>\n\n<p>to get the example I have written:</p>\n\n<pre><code>attribute[0] reserves 4 places and creates 4 objects using ExtClass constructor\nattribute[1] reserves 2 places and creates 2 objects using ExtClass constructor\nattribute[2] reserves 3 places and creates 3 objects using ExtClass constructor\n</code></pre>\n\n<p>Is there any short way to do that with initializer list or do I need to take another approach (if so which)?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 547, "user_id": 10445407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe64e72ba7a58e0136a570488d2d501?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/10445407/rahul"}, "edited": false, "score": 0, "creation_date": 1558552952, "post_id": 56263569, "comment_id": 99143650, "body": "The condition <code>(number % i) != 0</code> is satisfied multiple times ."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1558552966, "post_id": 56263569, "comment_id": 99143658, "body": "Any particular reason you&#39;re not printing the factors you&#39;re testing to validate your assumption that <code>i==5</code> is reporting <code>Yes</code> incorrectly? <code>cout &lt;&lt; &quot;Yes : &quot; &lt;&lt; i &lt;&lt; &#39;\\n&#39;;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1558554150, "post_id": 56263687, "comment_id": 99144181, "body": "Addendum for future askers : You may find researching prime number sieving algorithms a helpful alternative solution."}], "tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": true, "score": 2, "last_activity_date": 1558553219, "creation_date": 1558553219, "answer_id": 56263687, "question_id": 56263569, "link": "https://stackoverflow.com/questions/56263569/prime-numbers-implementation/56263687#56263687", "title": "Prime Numbers Implementation", "body": "<p>Let's step through the following code in detail, assuming that <code>number == 25</code>:</p>\n\n<pre><code>for (int i = 2; i&lt;number; i++) {\n    if ((number % i) != 0) {\n        cout &lt;&lt; \"Yes\";\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>In the first run of the loop, we have <code>number == 25</code> and <code>i == 2</code>.</p>\n\n<pre><code>if ((number % i) != 0) {\n    cout &lt;&lt; \"Yes\";\n}\n</code></pre>\n\n<p>Evaluating <code>number % i</code> yields <code>25 % 2</code>, which is <code>1</code>. <code>1</code> is not equal to <code>0</code>, so the body of the <code>if</code>-statement is executed, and prints <code>\"Yes\"</code> to that standard output.</p>\n\n<hr>\n\n<p>Clearly, there are many numbers that don't evenly divide <code>25</code>. To test whether <code>25</code> is prime, we need to test that <em>none</em> of the numbers evenly divide <code>25</code>.</p>\n\n<p>Here's one way you could do this:</p>\n\n<pre><code>for (int i = 2; i&lt;number; i++) {\n    // if `i` evenly divides `number`,\n    if ((number % i) == 0) {\n        // it is certainly not prime\n        cout &lt;&lt; \"No\";\n        // stop searching and return\n        return 0;\n    }\n}\n// Otherwise, if this point is reached, nothing divides `number`\n// Thus, `number` must be prime\ncout &lt;&lt; \"Yes\";\n</code></pre>\n\n<hr>\n\n<p>With any good C++ compiler, you should be able to debug your program interactively, and step through the code line-by-line, watching values change, and seeing where your intuition and your code don't match. Debugging is a very valuable part of programming. How exactly it's done varies with your compiler, but if you simply google \"how to debug C++ using [my compiler]\", I expect you'll find many helpful resources.</p>\n"}], "owner": {"reputation": 11, "user_id": 11541079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c667e7c4a3279c9b9b1efcac3a572075?s=128&d=identicon&r=PG&f=1", "display_name": "DigJohn", "link": "https://stackoverflow.com/users/11541079/digjohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56263687, "answer_count": 1, "score": 0, "last_activity_date": 1558553219, "creation_date": 1558552697, "question_id": 56263569, "link": "https://stackoverflow.com/questions/56263569/prime-numbers-implementation", "title": "Prime Numbers Implementation", "body": "<p>I started to learn algorithms and C++,and I thought to write a program which will check prime numbers.I know it's awful code,and I'm going to improve that,but firstly i need to know the problem.</p>\n\n<p>So let's check for example number=25.When i=5,25%5=0,so why it gives me 'Yes'?</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint main()\n{\nint number;\ncin &gt;&gt; number;\nif (number &lt; 2) {\n    cout &lt;&lt; \"No\";\n}\nelse if (number == 2) {\n    cout &lt;&lt; \"Yes\";\n}\nelse {\n    for (int i = 2; i&lt;number; i++) {\n        if ((number % i) != 0) {\n            cout &lt;&lt; \"Yes\";\n        }\n    }\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>======================================================================</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint main()\n{\nint number;\ncin &gt;&gt; number;\nif (number &lt; 2) {\n    cout &lt;&lt; \"No\";\n}\nelse if (number == 2) {\n    cout &lt;&lt; \"Yes\";\n}\n    for (int i = 2; ((i &lt; number) &amp;&amp; (number%i==0)); i++) {\n        cout &lt;&lt; \"No\";\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>Also I tried something like this above(but I'm not sure about this),but the problem with odd numbers with few dividers is still the same.</p>\n"}, {"tags": ["c++", "clang", "compiler-optimization", "lto"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1558552336, "post_id": 56263448, "comment_id": 99143348, "body": "windows or linux?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558552399, "post_id": 56263448, "comment_id": 99143380, "body": "&quot;1.&quot; should be easy to check by inspecting the compiled binaries with <a href=\"http://sourceware.org/binutils/docs/binutils/objdump.html\" rel=\"nofollow noreferrer\">objdump</a>, <a href=\"https://en.m.wikipedia.org/wiki/Nm_(Unix)\" rel=\"nofollow noreferrer\">nm</a>, <a href=\"https://en.m.wikipedia.org/wiki/Readelf\" rel=\"nofollow noreferrer\">readelf</a> or similar."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558554629, "post_id": 56263448, "comment_id": 99144384, "body": "So what research did you do? Did you try it? Are those variables stripped out if are unused? Also <code>static int      sFooListIndex = 0;</code> is invalid, it hes to be constexpr or initialized outside of the class... Also you are missing many <code>;</code>. Did you at least check if the code you posted compiles? Optimization cares about side effects. The code you posted has no side effects at all, it can be optimized to no-op. You have to post a reproducible example, source code and steps needed to reproduce and analyze it, so others can test it."}, {"owner": {"reputation": 31, "user_id": 6290127, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DvAdggwd270/AAAAAAAAAAI/AAAAAAAAAIo/nBZs_sehpfg/photo.jpg?sz=128", "display_name": "Virag Doshi", "link": "https://stackoverflow.com/users/6290127/virag-doshi"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558561227, "post_id": 56263448, "comment_id": 99147075, "body": "@KamilCuk The code I put in the question does not compile, it is merely supposed to show how the library is structured."}], "owner": {"reputation": 31, "user_id": 6290127, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DvAdggwd270/AAAAAAAAAAI/AAAAAAAAAIo/nBZs_sehpfg/photo.jpg?sz=128", "display_name": "Virag Doshi", "link": "https://stackoverflow.com/users/6290127/virag-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558552123, "creation_date": 1558552123, "question_id": 56263448, "link": "https://stackoverflow.com/questions/56263448/stripping-out-static-global-objects-with-llvm-lto", "title": "Stripping out static global objects with LLVM LTO", "body": "<p>I am working on a static library which gets linked into multiple binaries. My objective is to reduce the memory footprint of my library when it gets linked in.</p>\n\n<p>The users of my library require certain global objects that I create in a cpp file in my library and then export a header file which has extern declarations of these variables.</p>\n\n<p>Problem is, depending on how the library gets used, some of these global variables may not get used at all.</p>\n\n<p>The following code shows the structure of my code somewhat:</p>\n\n<p>Foo.hpp:</p>\n\n<pre><code>class Foo\n{\n    static int      sFooListIndex = 0;\n    static Foo *    sFooList[10] = { nullptr };\n\npublic:\n    Foo()\n    {\n        if(sFooListIndex &lt; 10)\n        {\n            sFooList[sFooListIndex++] = this;\n        }\n    }\n}\n</code></pre>\n\n<p>Bar1.hpp:</p>\n\n<pre><code>#include \"Foo.hpp\"\n\nclass Bar1 : public Foo\n{\npublic:\n    Bar1() : Foo() { }\n}\n</code></pre>\n\n<p>Bar2.hpp:</p>\n\n<pre><code>#include \"Foo.hpp\"\n\nclass Bar2 : public Foo\n{\npublic:\n    Bar2() : Foo() { }\n}\n</code></pre>\n\n<p>Globals.cpp:</p>\n\n<pre><code>#include \"Bar1.hpp\u201d\n#include \"Bar2.hpp\"\n\nstatic Bar1 bar1;\nFoo &amp; foo1 = bar1;\n\nstatic Bar2 bar2;\nFoo &amp; foo2 = bar2;\n</code></pre>\n\n<p>Export.hpp:</p>\n\n<pre><code>#include \"Foo.hpp\"\n\nextern Foo &amp; foo1;\nextern Foo &amp; foo2;\n</code></pre>\n\n<p>Here's my questions:</p>\n\n<ol>\n<li><p>If the project that includes my library only uses foo1, then will foo2 get stripped out from the final binary? And thus will the code for the class Bar2 get stripped out as well?</p></li>\n<li><p>If not, do you know how I can restructure my code such that the unused symbols and the unused code gets stripped out during linking? The only way I can think of is moving Globals.cpp and Export.hpp into the project that includes my library. Is there any other way?</p></li>\n<li><p>One way I can think of is moving splitting Globals.hpp and Export.hpp into smaller files with groups of declarations and definitions that make sense together. Would that help?</p></li>\n</ol>\n"}, {"tags": ["c++", "visual-studio", "stdstring"], "comments": [{"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 3, "creation_date": 1558552327, "post_id": 56263432, "comment_id": 99143343, "body": "<code>&lt;string&gt;</code> is the correct header to use. If you are ever in doubt as to whether something should compile, try compiling the offending code in a clean environment like <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">compiler explorer</a>. In this case, it seems like there may be something wrong with your setup."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1558552786, "post_id": 56263432, "comment_id": 99143567, "body": "To make damn sure you&#39;re using a proper include and lib path, open a visual studio command prompt via Start menu: Start/Visual Studio 2015/Developer Command Prompt. From there, inspect the INCLUDE and LIB paths; they should be properly fronted by the VC bits. From that command prompt, type <code>devenv</code> to launch the GUI, then open your project and try again. If that doesn&#39;t work, the project itself probably has overrides to include paths that are breaking your build, and lord only knows how you managed that."}, {"owner": {"reputation": 640, "user_id": 3793674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a5746c9da4b2293984258875ce00e1?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/3793674/chrisd"}, "edited": false, "score": 1, "creation_date": 1558553156, "post_id": 56263432, "comment_id": 99143753, "body": "Would also be worthwhile to double check your project properties (Properties/VC++ Directories/General/Include Directories) and make sure it hasn&#39;t lost its inherited include directories (the system ones are <code>$(VC_Include_Path)</code> or similar)"}, {"owner": {"reputation": 3, "user_id": 11540882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87342f26e8b97ac81f3880284b90091?s=128&d=identicon&r=PG&f=1", "display_name": "pthien", "link": "https://stackoverflow.com/users/11540882/pthien"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1558554277, "post_id": 56263432, "comment_id": 99144226, "body": "@Mansoor cool, thanks for the link. I also suspect it is something to do with my setup. that&#39;s why i tagged visual-studio. i can&#39;t copy the entire file over because it&#39;s on a different machine but it seems to work fine on that site."}, {"owner": {"reputation": 3, "user_id": 11540882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87342f26e8b97ac81f3880284b90091?s=128&d=identicon&r=PG&f=1", "display_name": "pthien", "link": "https://stackoverflow.com/users/11540882/pthien"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1558554577, "post_id": 56263432, "comment_id": 99144368, "body": "@WhozCraig cool didn&#39;t know there was a whole command prompt for VS, thanks. <code>inspect</code> is not recognized in the command prompt so i&#39;m not sure what you mean by inspect their paths or by &quot;VC bits.&quot; <code>devenv</code> works but the project still has issues  @ChrisD Include Directories has <code>$(VC_Include_Path);$(WindowsSDK_IncludePath);</code>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1558559209, "post_id": 56263432, "comment_id": 99146365, "body": "&quot;[Clang IntelliSense]&quot; is unusual.  If you have a mix of #include files, some from Clang and others from VS then you will get a lot of complaints.  Project &gt; Properties &gt; VC++ Directories &gt; Include Directories might be wrong."}, {"owner": {"reputation": 3, "user_id": 11540882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87342f26e8b97ac81f3880284b90091?s=128&d=identicon&r=PG&f=1", "display_name": "pthien", "link": "https://stackoverflow.com/users/11540882/pthien"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1558562199, "post_id": 56263432, "comment_id": 99147325, "body": "@HansPassant I thought IntelliSense is part of the VisualGDB debugging system that we have but I could be wrong.   I typed all the #include statements myself. what do you mean &quot;from&quot; clang or VS?  I posted the contents of Include Directoes in the comment above yours. what seems wrong about it?  back to the <code>include</code>s, here are all the ones I have:  <code>#include &lt;iostream&gt; #include &lt;string&gt; #include &lt;sstream&gt; #include &lt;map&gt;  #include &quot;curl&#47;curl.h&quot; #include &quot;curl&#47;easy.h&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11540882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87342f26e8b97ac81f3880284b90091?s=128&d=identicon&r=PG&f=1", "display_name": "pthien", "link": "https://stackoverflow.com/users/11540882/pthien"}, "edited": false, "score": 0, "creation_date": 1558555796, "post_id": 56264173, "comment_id": 99144899, "body": "sorry, the code is on another machine without internet access so I am not able to copy the code. the double argc is a typo on my part. do you know how I can see what compiler is actually being used? I guess not if you&#39;re unfamiliar with VS. i&#39;m not using the command line or anything. I&#39;m just using debugging so I never type <code>g++ *.cpp</code> or anything like that"}, {"owner": {"reputation": 51, "user_id": 11120946, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kCOYjmSFUrU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOq0vq6ck-o1B35c95a1pXEDKWf_A/mo/photo.jpg?sz=128", "display_name": "madoflancashire", "link": "https://stackoverflow.com/users/11120946/madoflancashire"}, "reply_to_user": {"reputation": 3, "user_id": 11540882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87342f26e8b97ac81f3880284b90091?s=128&d=identicon&r=PG&f=1", "display_name": "pthien", "link": "https://stackoverflow.com/users/11540882/pthien"}, "edited": false, "score": 0, "creation_date": 1558578424, "post_id": 56264173, "comment_id": 99150443, "body": "No worries! So, when I was referring to the different compilers, it was in response to your saying that you see different compilers invoked, in which case you might&#39;ve seen an error specific to a compiler. When I use <code>make</code>, for instance, I see the different compilation steps listed on the screen. Any error that follows that step, I know that error is associated with that step. Do you see anything like that? If so, that would be the compiler to fix."}, {"owner": {"reputation": 3, "user_id": 11540882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87342f26e8b97ac81f3880284b90091?s=128&d=identicon&r=PG&f=1", "display_name": "pthien", "link": "https://stackoverflow.com/users/11540882/pthien"}, "edited": false, "score": 0, "creation_date": 1558627518, "post_id": 56264173, "comment_id": 99172383, "body": "I have added part of the output to the main post. the formatting is messed up and I can&#39;t edit it for some reason but it&#39;s there"}], "tags": [], "owner": {"reputation": 51, "user_id": 11120946, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kCOYjmSFUrU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOq0vq6ck-o1B35c95a1pXEDKWf_A/mo/photo.jpg?sz=128", "display_name": "madoflancashire", "link": "https://stackoverflow.com/users/11120946/madoflancashire"}, "is_accepted": false, "score": 0, "last_activity_date": 1558555343, "creation_date": 1558555343, "answer_id": 56264173, "question_id": 56263432, "link": "https://stackoverflow.com/questions/56263432/variable-has-incomplete-type-stdstring-string-h-has-many-errors/56264173#56264173", "title": "variable has incomplete type std::String; string.h has many errors", "body": "<p>If you copied your code exactly from what you have, I see two declarations of <code>argc</code> in your definition of <code>main</code>. Your compiler should definitely be throwing errors about that. Perhaps your compiler delays the read error until you declare a <code>std::string</code> in <code>main</code>? (I've had a compiler throw an error several lines after the actual error for something seemingly unrelated.) So, you may have fixed the error in having a bad file path, but perhaps your bad definition of <code>main</code> throws your compiler off.</p>\n\n<p>Now, if that didn't work, you mentioned seeing a bunch of compilers being used. If you see a particular compiler throwing that error, then you might want to separately update said compiler. The functionality of compilers is modular, so you can pick and choose which compiler you use for which step of the compilation. VS is probably doing this to get what it figures is the best result. Sometimes compilers carry with them the files they want to use, thus updating (or even un/reinstalling) the compiler should fix the files that it carries with it. (Windows likes to do everything for you, so you might actually mess something up if you try to update the parts separately. That was always my experience, anyway. But, I haven't used Windows in well over a year, so that may have changed.)</p>\n\n<p>If that still doesn't fix it, you may have to un/reinstall VS. I will admit to knowing nothing about VS, as I use Emacs to edit and Makefile/g++ to compile. My guess, however, is VS may carry all the compilers and files it needs with it, so an update or un/reinstall will (hopefully) fix your issue.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11540882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87342f26e8b97ac81f3880284b90091?s=128&d=identicon&r=PG&f=1", "display_name": "pthien", "link": "https://stackoverflow.com/users/11540882/pthien"}, "is_accepted": true, "score": 0, "last_activity_date": 1558652213, "creation_date": 1558652213, "answer_id": 56283876, "question_id": 56263432, "link": "https://stackoverflow.com/questions/56263432/variable-has-incomplete-type-stdstring-string-h-has-many-errors/56283876#56283876", "title": "variable has incomplete type std::String; string.h has many errors", "body": "<p>managed to avoid this issue, but probably not solve the still-unknown underlying issue, by removing an unused library from my list of directories and then <a href=\"https://i.stack.imgur.com/8Qz1c.jpg\" rel=\"nofollow noreferrer\">reloading all directories</a>. I'm not convinced anything was solved because reloading directories gives random results. sometimes it fixes issues and sometimes it causes new ones. Just yesterday, I reloaded and it was then unable to find system.h and time.h (don't remember the names). I was troubleshooting that but the issue disappeared a few hours later. anyway \nI posted a follow-up question <a href=\"https://stackoverflow.com/questions/56283794/strtoll-and-many-others-not-a-member-of-std\">here</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11540882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87342f26e8b97ac81f3880284b90091?s=128&d=identicon&r=PG&f=1", "display_name": "pthien", "link": "https://stackoverflow.com/users/11540882/pthien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 0, "accepted_answer_id": 56283876, "answer_count": 2, "score": 0, "last_activity_date": 1558652213, "creation_date": 1558552049, "last_edit_date": 1558630395, "question_id": 56263432, "link": "https://stackoverflow.com/questions/56263432/variable-has-incomplete-type-stdstring-string-h-has-many-errors", "title": "variable has incomplete type std::String; string.h has many errors", "body": "<p>something is very wrong with strings. I have been using them for weeks without issue, but halfway through Monday,  I started having strange issues:\n<code>[Clang IntelliSense] Error: variable has incomplete type 'std::string'</code>\nwhenever I try to make a string. similar errors occur when I try <code>wstring</code> and <code>ostringstream</code>, but not <code>stringstream</code>. <code>initializing std::string* s</code>also works fine but <code>s-&gt;append(...)</code> results in<code>\"member has access into incomplete type 'std::string'\"</code></p>\n\n<p>this all came about because visual studio (VS) was all of a sudden unable to find some<code>#includes</code>that i have had for weeks, including some standard libraries (don't remember which because...). I solved that by having VS search for the correct files and it found some files (unsure if they're the same as before or different) so it no longer has an issue with the<code>#include</code> statements but now I have this issue. </p>\n\n<p>I had been using <code>&lt;string.h&gt;</code> fine for weeks. while researching this issue, i read that <code>&lt;string.h&gt;</code> is the wrong file to use so I've tried #include <code>&lt;string&gt;</code> but there is no difference. I've since tried<code>&lt;strings.h&gt;</code> and <code>&lt;cstring&gt;</code>but no difference there as well. </p>\n\n<p>I checked out my external dependencies and string.h has dozens of errors, which I thought is weird because it's a standard file that I haven't touched.</p>\n\n<p>I'm using VS2015, GNU make, and I see Clang IntelliSense but I also see some g++ here so i'm not sure what compiler it's actually using. also using visualGDB 5.3. let me know if I forgot anything.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\nint main(int argc, char *argv[])\n{\nstd::string message = \"uncomment\";\n...\n</code></pre>\n\n<pre><code>message\n</code></pre>\n\n<p>is the part that is highlighted as having an issue (incomplete type) </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::wstring wideMessage;\n</code></pre>\n\n<p>also incomplete type </p>\n\n<p>expected results: no problems like the past few weeks. i was able to declare, initialize, append(), whatever\nactual results: can't compile/debug\nerrors: <code>variable has incomplete type 'std::string'\nvariable has incomplete type 'std::wstring'\nno matching constructor for initialization of 'std::ostringstream'</code></p>\n\n<p>I see many similar issues here, but all the issues have to do with forward declaration and I don't see what that has to do with this. I'm not having any issues with classes, structs, or functions; even declaring a variable in main() is problematic</p>\n\n<p>edit: based on <a href=\"https://stackoverflow.com/questions/31885337/what-compiler-is-in-visual-studio-2015\" title=\"yes, this one\">this answer</a>, it is likely using VC++ 14.0 as a compiler but I do not know how to tell for sure</p>\n\n<p>edit 2: error message:</p>\n\n<pre><code>1&gt;  VisualGDB: Sending 45 updated source files to build machine...\n1&gt;  VisualGDB: Run \"make  CONFIG=Debug\" in directory \"/tmp/VisualGDB/c/Users/pthien/VS/Whatever/Whatever\" on pthien@buildserver (SSH)\n1&gt;  /opt/poky/1.8/sysroots/x86_64-pokysdk-linux/usr/bin/arm-poky-linux-gnueabi/arm-poky-linux-gnueabi-g++ -march=armv7-a -mfloat-abi=hard -mfpu=neon -mtune=cortex-a8 --sysroot=/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi -ggdb -ffunction-sections -O0 -std=c++11 -march=armv7-a -mfloat-abi=hard -mfpu=neon -mtune=cortex-a8 --sysroot=/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi -ggdb -ffunction-sections -O0 -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/include -I/opt/googletest-master/googletest/include -I/opt/boost_1_61_0 -I../../cereal/cereal-1.2.2/cereal-1.2.2/include -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/websocketpp-master -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/include/websocketpp -I/opt/curl-7.54.0 -I/opt/boost_1_61_0/boost -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/include/easywsclient-master -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/include/uWebSockets-master -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/include/c++/4.9.2/experimental -I/opt/boost_1_61_0/boost/tr1/tr1 -I/opt/boost_1_61_0/tools/build/src/engine -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/include/c++/4.9.2 -I/opt/curl-7.54.0/include -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/include/cereal -I/opt/poky/1.8/sysroots/x86_64-pokysdk-linux/usr/lib/arm-poky-linux-gnueabi/gcc/arm-poky-linux-gnueabi/4.9.2/include-fixed -I/opt/boost_1_61_0/boost/compatibility/cpp_c_headers -I\"../../../../../Program -IFiles -I(x86)/Microsoft -IVisual -IStudio -I10.0/VC/crt/src\" -I\"../../../../../Program -IFiles -I(x86)/Microsoft -IVisual -IStudio -I14.0/VC/include\" -I/opt/poky/1.8/sysroots/cortexa8hf-vfp-neon-poky-linux-gnueabi/usr/include/c++/4.9.2/arm-poky-linux-gnueabi -DDEBUG  -c Whatever.cpp -o Debug/Whatever.o -MD -MF Debug/Whatever.dep\n1&gt;  C:\\Users\\pthien\\AppData\\Local\\VisualGDB\\RemoteSourceCache\\buildserver\\0008\\include\\wchar.h(459,20): note :    'wcstold'\n1&gt;   extern long double wcstold (const wchar_t *__restrict __nptr,\n1&gt;                      ^\n1&gt;  Whatever.cpp: In function 'int main(int, char**)':\n1&gt;C:\\Users\\pthien\\VS\\Whatever\\Whatever\\Whatever.cpp(138,47): error : 'strlen' was not declared in this scope\n1&gt;     size_t request_len = strlen(webSocketRequest);\n1&gt;                                                 ^\n1&gt;  Makefile:160: recipe for target 'Debug/Whatever.o' failed\n1&gt;  make: *** [Debug/Whatever.o] Error 1\n1&gt;  -------------------------------------------------------------\n1&gt;  Command exited with code 2\n1&gt;  Executable: make\n1&gt;  Arguments:  CONFIG=Debug\n1&gt;  Directory: /tmp/VisualGDB/c/Users/pthien/VS/Whatever/Whatever\n1&gt;VisualGDB : error : Command-line action failed\n1&gt;C:\\Program Files (x86)\\MSBuild\\Microsoft.Cpp\\v4.0\\V140\\Microsoft.MakeFile.Targets(37,5): error MSB3073: The command \"\"C:\\Program Files (x86)\\Sysprogs\\VisualGDB\\\\VisualGDB.exe\" /build \"C:\\Users\\pthien\\VS\\Whatever\\Whatever\\Whatever.vcxproj\" \"/solution:C:\\Users\\pthien\\VS\\Whatever\\Whatever.sln\"  \"/config:Debug\" \"/platform:Win32\"\" exited with code 1.\n========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========\n</code></pre>\n\n<p>this is about 10% of the output, including the beginning and the end. what's weird is the issue with strlen(). it is not underlined in the IDE so I had no idea there was an issue with it. it makes sense because i commented out the <code>#include</code>for <code>&lt;string.h&gt;</code>and <code>&lt;cstring&gt;</code> and strlen() is in one of those.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558551727, "post_id": 56263339, "comment_id": 99143093, "body": "It doesn&#39;t solve circular dependencies"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1558551744, "post_id": 56263339, "comment_id": 99143103, "body": "You generally forward declare when you don&#39;t or can&#39;t include a header. The fact that they have include guards doesn&#39;t really come into play."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558551854, "post_id": 56263339, "comment_id": 99143137, "body": "Forward declarations are useful when they can be used to avoid having to include the full header (improves compilation time - matters a lot in big projects). Include guards defend against multiple inclusions/definitions - different thing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1558551914, "post_id": 56263339, "comment_id": 99143161, "body": "&quot;is it really necessary to have forward declarations?&quot;  - yes, if you have data structures that refer to each other."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558552021, "post_id": 56263339, "comment_id": 99143210, "body": "please show an example, there is no obvious relation between include guards and forward declarations, they are rather orthogonal"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 2, "creation_date": 1558552057, "post_id": 56263339, "comment_id": 99143226, "body": "Forward declarations and include guards are totally unrelated matters. The former makes the <i>compiler</i> aware of the existance of some type, even though the definition is yet unknown. The latter one prevents the <i>pre-processor</i> from including one and the same header multiple times (and in consequence possibly repeating type definitions or ending up in endless include recursions)."}, {"owner": {"reputation": 111, "user_id": 2701114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781b5c867349134606afba7b1630d620?s=128&d=identicon&r=PG&f=1", "display_name": "user2701114", "link": "https://stackoverflow.com/users/2701114/user2701114"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558553705, "post_id": 56263339, "comment_id": 99143992, "body": "@JVApen: I read that header guards do prevent circular dependencies. Is that not true?"}, {"owner": {"reputation": 111, "user_id": 2701114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781b5c867349134606afba7b1630d620?s=128&d=identicon&r=PG&f=1", "display_name": "user2701114", "link": "https://stackoverflow.com/users/2701114/user2701114"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558553802, "post_id": 56263339, "comment_id": 99144024, "body": "@Fran&#231;oisAndrieux: are there reasons you can&#39;t use a header that can&#39;t be solved with using header guards?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558553840, "post_id": 56263339, "comment_id": 99144049, "body": "@user2701114 The most common case is probably when <a href=\"https://stackoverflow.com/questions/625799/resolve-build-errors-due-to-circular-dependency-amongst-classes\">each header needs to include the other</a>."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558554824, "post_id": 56263339, "comment_id": 99144475, "body": "@user2701114 Not exactly, having circular includes gives problems with guards. Though having 1 class with a member, that member type can still use the first in function signatures when using FWDs"}, {"owner": {"reputation": 111, "user_id": 2701114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781b5c867349134606afba7b1630d620?s=128&d=identicon&r=PG&f=1", "display_name": "user2701114", "link": "https://stackoverflow.com/users/2701114/user2701114"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558561478, "post_id": 56263339, "comment_id": 99147149, "body": "@JVApen I thought an answer like this suggested that circular includes could be solved using header guards: <a href=\"https://stackoverflow.com/questions/3127171/how-are-circular-includes-resolved\" title=\"how are circular includes resolved\">stackoverflow.com/questions/3127171/&hellip;</a>"}, {"owner": {"reputation": 111, "user_id": 2701114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781b5c867349134606afba7b1630d620?s=128&d=identicon&r=PG&f=1", "display_name": "user2701114", "link": "https://stackoverflow.com/users/2701114/user2701114"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558561498, "post_id": 56263339, "comment_id": 99147153, "body": "@formerlyknownas_463035818 I have added an example to my original question"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558561671, "post_id": 56263339, "comment_id": 99147190, "body": "@user2701114 yes, at compile level, it can solve the problem, though your code won&#39;t work. The answer with the diamond diagram looks more correct"}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558597675, "post_id": 56263488, "comment_id": 99155667, "body": "question has been clarified with an example. Actually OP misunderstood <code>#include &quot;someheader.h&quot;</code> as being an include guard. maybe you want to update the answer..."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1558552348, "creation_date": 1558552348, "answer_id": 56263488, "question_id": 56263339, "link": "https://stackoverflow.com/questions/56263339/are-forward-declarations-needed-if-you-already-have-include-guards/56263488#56263488", "title": "Are Forward Declarations Needed If You Already Have Include Guards?", "body": "<p>You are mixing two unrelated concepts.</p>\n\n<ol>\n<li><p>You use forward declaration when you need something by name only.</p></li>\n<li><p>You use include guards to prevent processing of the same code multiple times in a single translation unit, i.e. .cpp file. Whether you use include guards or not is based on the intended use of the .h file. Most of the time, you don't want the contents of the file to be processed multiple times in a .cpp file but there are use cases where allowing that is essential. For the later category of uses, you must not use include guards.</p></li>\n</ol>\n\n<p>You can combine them anyway you want.</p>\n\n<p>It's ok to:</p>\n\n<ol>\n<li>Use forward declarations AND use include guards.</li>\n<li>Use forward declarations AND not use include guards.</li>\n<li>Not use forward declarations AND use include guards.</li>\n<li>Not use forward declarations AND not use include guards.</li>\n</ol>\n"}], "owner": {"reputation": 111, "user_id": 2701114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781b5c867349134606afba7b1630d620?s=128&d=identicon&r=PG&f=1", "display_name": "user2701114", "link": "https://stackoverflow.com/users/2701114/user2701114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1558553239, "creation_date": 1558551652, "last_edit_date": 1558553239, "question_id": 56263339, "link": "https://stackoverflow.com/questions/56263339/are-forward-declarations-needed-if-you-already-have-include-guards", "title": "Are Forward Declarations Needed If You Already Have Include Guards?", "body": "<p>If you have a set of header files with include guards, is it really necessary to have forward declarations?</p>\n\n<p>I've been doing this out of habit in my code, and I recommended a colleague add forward declarations to their code, but when they asked whether it was really necessary because of the include guards already present, I was at a bit of a loss. It seems like it's good practice, but wouldn't include guards solve all of the problems that forward declarations do?</p>\n\n<p>Here's an example. Suppose I have a header file like so:</p>\n\n<pre><code>//This is the header file of class B\nclass MyClassA; //This is forward declaration    \n\nclass B{\n    private:\n        MyClassA *myClass; //pointer to MyClassA\n    public:\n        B(){}\n        ~B(){};\n\n        void print(MyClassA* myClass); //Passing by reference. Not calling any methods of MyClassA.\n}\n</code></pre>\n\n<p>If I know that there is an include guard in MyClassA.h, would the above be better practice than the following? And, if so, why?</p>\n\n<pre><code>#include \u201cMyClassA.h\u201d  \n\nclass B{\n    private:\n        MyClassA *myClass; //pointer to MyClassA\n    public:\n        B(){}\n        ~B(){};\n\n        void print(MyClassA* myClass); //Passing by reference. Not calling any methods of MyClassA.\n}\n</code></pre>\n\n<p>Would the second example also prevent a circular declaration/multiple declaration?</p>\n"}, {"tags": ["c++", "sdl"], "comments": [{"owner": {"reputation": 1435, "user_id": 5271478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0ee8d843b4e6f99de3b4baa563811b?s=128&d=identicon&r=PG&f=1", "display_name": "noobius", "link": "https://stackoverflow.com/users/5271478/noobius"}, "edited": false, "score": 1, "creation_date": 1558551878, "post_id": 56263169, "comment_id": 99143146, "body": "Seem to be the naming of the lib is different? I&#39;m seeing libSDL2_image.a inside the lib folder so should it be -llibSDL2_image instead? Sorry I don&#39;t have MinGW setup to test this (using VS2017) - adding this as comment per Jesper Juhl suggestion (still new with Stackoverflow.)"}, {"owner": {"reputation": 144, "user_id": 10167309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--cXbOfjlR_Q/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxDuDc5ay3_mzsiOQVg-mVjOgjww/mo/photo.jpg?sz=128", "display_name": "Ambu", "link": "https://stackoverflow.com/users/10167309/ambu"}, "reply_to_user": {"reputation": 1435, "user_id": 5271478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0ee8d843b4e6f99de3b4baa563811b?s=128&d=identicon&r=PG&f=1", "display_name": "noobius", "link": "https://stackoverflow.com/users/5271478/noobius"}, "edited": false, "score": 0, "creation_date": 1558618948, "post_id": 56263169, "comment_id": 99167520, "body": "Solution works, thanks!"}], "owner": {"reputation": 144, "user_id": 10167309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--cXbOfjlR_Q/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxDuDc5ay3_mzsiOQVg-mVjOgjww/mo/photo.jpg?sz=128", "display_name": "Ambu", "link": "https://stackoverflow.com/users/10167309/ambu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558551378, "creation_date": 1558550870, "question_id": 56263169, "link": "https://stackoverflow.com/questions/56263169/cannot-find-lsdl-image", "title": "cannot find -lSDL_image", "body": "<p>I'm trying to learn SDL and I've added the following:</p>\n\n<p>C:\\SDL2_image-2.0.4\\i686-w64-mingw32\\include\\SDL2</p>\n\n<p>C:\\SDL2_image-2.0.4\\i686-w64-mingw32\\lib</p>\n\n<p>to my linker/compiler search directories and:</p>\n\n<p>-lSDL_image</p>\n\n<p>to linker settings, but my code is returning the error: \"cannot find -lSDL_image\".</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>#ifndef GAME_H\n#define GAME_H\n\n#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n#include &lt;SDL.h&gt;\n#include &lt;SDL_image.h&gt;\n\n(...)\n</code></pre>\n\n<p>in Game.h and </p>\n\n<p><code>#include \"Game.h\"</code></p>\n\n<p>in both main.cpp and Game.cpp respectively. All .dlls are in place, so I'm unable to eliminate what might be causing the error.</p>\n"}, {"tags": ["c++", "re2"], "answers": [{"tags": [], "owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "is_accepted": false, "score": 0, "last_activity_date": 1600346498, "creation_date": 1600346498, "answer_id": 63938259, "question_id": 56262968, "link": "https://stackoverflow.com/questions/56262968/simultaneously-matching-multiple-regular-expressions-with-google-re2/63938259#63938259", "title": "Simultaneously Matching Multiple Regular Expressions with Google RE2", "body": "<p>Just implemented this today for something I'm working on, here is a snippet for the use of future readers.</p>\n<p>The right class to handle this using <code>RE2</code> is <code>RE2::Set</code>, you can find the code <a href=\"https://github.com/google/re2/blob/master/re2/set.h\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>Here is an example:</p>\n<pre><code>std::vector&lt;std::string&gt; kRegexExpressions = {\n  R&quot;My name is [\\w]+&quot;,\n  R&quot;His number is [\\d]+&quot;,\n};\n\nRE2::Set regex_set(RE2::DefaultOptions, RE2::UNANCHORED);\n\nfor (const auto &amp;exp : kRegexExpressions) {\n  int index = regex_set.Add(exp, &amp;err);\n  if (index &lt; 0) {\n    &lt;report-error&gt;\n    return;\n  }\n}\n\nif (!regex_set.Compile()) {\n  &lt;report-error&gt;\n  return;\n}\n\nstd::vector&lt;int&gt; matching_rules;\nif (!regex_set_.Match(line, &amp;matching_rules)) {\n  &lt;no-match&gt;\n  return;\n}\n\nfor (auto rule_index : matching_rules) {\n  std::cout &lt;&lt; &quot;MATCH: Rule #&quot; &lt;&lt; rule_index &lt;&lt; &quot;: &quot; &lt;&lt; kRegexExpressions &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 9813502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8c5048bf07f586c971b9364e9e15c4?s=128&d=identicon&r=PG&f=1", "display_name": "EnnFour", "link": "https://stackoverflow.com/users/9813502/ennfour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1600346498, "creation_date": 1558549950, "question_id": 56262968, "link": "https://stackoverflow.com/questions/56262968/simultaneously-matching-multiple-regular-expressions-with-google-re2", "title": "Simultaneously Matching Multiple Regular Expressions with Google RE2", "body": "<p>I'm attempting to match many (500+) regular expressions quickly using Google's RE2 Library, as I'd like to get similar results to <a href=\"https://www.usenix.org/system/files/nsdi19-wang-xiang.pdf\" rel=\"nofollow noreferrer\">this whitepaper</a>. I'd like to use RE2-m on page 13.</p>\n\n<p>From what I've seen online, the Set interface is the way to go, though I'm unsure where to get started -- I haven't been able to find Google RE2 tutorials using the set interface online. Could someone please point me in the right direction?</p>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558597863, "post_id": 56262942, "comment_id": 99155756, "body": "I deleted the answer, because actually I didnt like it at all and it was somehow drowned in discussion. I would suggest you do look at the source and if the <code>boost</code> implementation isnt doing what you expect you could write your own."}, {"owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558599913, "post_id": 56262942, "comment_id": 99156833, "body": "@formerlyknownas_463035818 Thank you; I appreciated the discussion. That is exactly what I decided to do. (And you are right about <code>boost::math::tools::brent_find_minima</code> not doing any such checking.)"}], "answers": [{"comments": [{"owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "edited": false, "score": 0, "creation_date": 1558736017, "post_id": 56294541, "comment_id": 99212276, "body": "I agree on smoothness. Perhaps I wasn&#39;t clear enough in the question, but I was thinking only of unimodality (&quot;with no maxima occuring in that interval&quot;). The search works by successively narrowing down a bracket around the presumed minimum. If at some point the algorithm encounters a value within the bracket that is higher than the bracket&#39;s end-points, then the condition is clearly violated."}, {"owner": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "reply_to_user": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "edited": false, "score": 0, "creation_date": 1558755977, "post_id": 56294541, "comment_id": 99214724, "body": "Smoothness is harder than maxima determination, but if you can&#39;t guarantee smoothness then maxima can be detected only by exhaustive search."}], "tags": [], "owner": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "is_accepted": false, "score": 0, "last_activity_date": 1558707619, "creation_date": 1558707619, "answer_id": 56294541, "question_id": 56262942, "link": "https://stackoverflow.com/questions/56262942/detecting-bad-input-for-boostmathtoolsbrent-find-minima/56294541#56294541", "title": "Detecting bad input for `boost::math::tools::brent_find_minima()`", "body": "<p>There is no way for this to be done. If you read Corless's <em>A Graduate Introduction to Numerical Methods</em>, you'll read a very interesting point: All numerically defined functions are discontinuous halfway between representables, and have zero derivatives between representables. Basically they can be thought of as a sum of Heaviside functions.</p>\n\n<p>So <em>none</em> of them are differentiable in the mathematical sense. Ok, maybe you think this is a bit unfair-the scale should be zoomed out. But how much? We know that <code>|x-1|</code> isn't differentiable at <code>x=1</code>, but how could a computer tell that? How does it know that there isn't some locally smooth mollifier that makes it differentiable between <code>x=1-eps</code> and <code>x=1+eps</code>? I don't think there's a good answer to this question.</p>\n\n<p>One of the most difficult problems in this class arises in quadrature. Some of these methods work fast when the complex extension of the function has poles far from the real axis. Try to numerically determine <em>that</em>.</p>\n\n<p>Function spaces are impossible to determine numerically. Users just have to get it right.</p>\n"}], "owner": {"reputation": 5685, "user_id": 827280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c39ecec1f8d62bf8b6b27ba05904990?s=128&d=identicon&r=PG", "display_name": "Museful", "link": "https://stackoverflow.com/users/827280/museful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558736082, "creation_date": 1558549839, "last_edit_date": 1558736082, "question_id": 56262942, "link": "https://stackoverflow.com/questions/56262942/detecting-bad-input-for-boostmathtoolsbrent-find-minima", "title": "Detecting bad input for `boost::math::tools::brent_find_minima()`", "body": "<p><a href=\"https://www.boost.org/doc/libs/1_70_0/libs/math/doc/html/math_toolkit/brent_minima.html\" rel=\"nofollow noreferrer\">This</a> documentation page of <code>boost::math::tools::brent_find_minima</code> says about its first argument:</p>\n\n<blockquote>\n  <p>The function to minimise: a function object (or C++ lambda) ... with no maxima occurring in that interval.</p>\n</blockquote>\n\n<p>But what happens if this is not the case? (After all, this condition is rather difficult to pre-ensure, especially since the function is usually expensive to evaluate at many points.) Best would be to detect violations to this condition on  the fly.</p>\n\n<p>If this condition is violated, does boost throw an exception, or does it exhibit undefined behavior?</p>\n\n<p>A workaround I am thinking of is to build the checking into the lambda (\"function to minimize\"), by capturing and maintaining a <code>std::map&lt;double,double&gt;</code> holding all the points that  have been evaluated, and comparing each new evaluation with its nearest neighbor in each direction, to check whether there may be a local maximum. But I don't want to do all that if it isn't necessary.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1558549684, "post_id": 56262886, "comment_id": 99142215, "body": "Probably you are not compiling <code>data.cpp</code>"}, {"owner": {"reputation": 9219, "user_id": 979325, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b513c9edd4da1688c05ba041820011c7?s=128&d=identicon&r=PG", "display_name": "Jepessen", "link": "https://stackoverflow.com/users/979325/jepessen"}, "edited": false, "score": 0, "creation_date": 1558549730, "post_id": 56262886, "comment_id": 99142237, "body": "What&#39;s the exact error? At the moment it seems that you&#39;re not creating the object file for <code>data.cpp</code>, or that you&#39;re not linking it somehow..."}, {"owner": {"reputation": 3, "user_id": 11540957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4c1be4bc7977bcba42d01f175fde9a?s=128&d=identicon&r=PG&f=1", "display_name": "Goat", "link": "https://stackoverflow.com/users/11540957/goat"}, "edited": false, "score": 0, "creation_date": 1558551205, "post_id": 56262886, "comment_id": 99142883, "body": "I don\u2019t get an error, I get the cout that\u2019s in the void coming up in the console so surly it\u2019s compiling it??"}, {"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1558552006, "post_id": 56262886, "comment_id": 99143202, "body": "When you say &quot;I can&#39;t get the write function to work&quot;, we don&#39;t know what your expected behavior is. You say you &quot;get the cout,&quot; which I assume means that <code>&quot;test&quot;</code> is printed, which, based on the contents of the <code>phonedata1()</code> function, seems to be what you should expect. What is the difference between what you expect to have happen and what is happening?"}], "owner": {"reputation": 3, "user_id": 11540957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4c1be4bc7977bcba42d01f175fde9a?s=128&d=identicon&r=PG&f=1", "display_name": "Goat", "link": "https://stackoverflow.com/users/11540957/goat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1558549659, "answer_count": 0, "score": 0, "last_activity_date": 1558551657, "creation_date": 1558549594, "last_edit_date": 1558551657, "question_id": 56262886, "link": "https://stackoverflow.com/questions/56262886/c-call-function-from-another-cpp-file", "closed_reason": "Duplicate", "title": "C++ Call function from another cpp file", "body": "<p>Okay so I\u2019m learning to write process memory using Windows API ReadProcessMemory. All is working fine if I\u2019m using it in main (after getting a process handle). </p>\n\n<p>I went on to make a memory reading class to make it faster in the future to read memory.</p>\n\n<p>When calling my memory call in my int main(), it works completely fine and I get what I should get. \nI then made another Cpp file and header files called \u201cdata\u201d. I made this to be able to easily call bunches of data.</p>\n\n<p>In my data.h I included my memory.h. I then wrote</p>\n\n<pre><code>void phonedata1();\n</code></pre>\n\n<p>In my data.cpp I wrote</p>\n\n<pre><code>Void phonedata1()\n{\nMy memory write call function;\ncout &lt;&lt; \u201ctest\u201d;\n} \n</code></pre>\n\n<p>In my main .cpp (after including \u201cdata.h\u201d and \u201cmemory.h\u201d</p>\n\n<pre><code>int main()\n{\nphonedata1();\n}\n</code></pre>\n\n<p>Unfortunately I can\u2019t get the write function to work, however I get the cout.</p>\n\n<p>More info:</p>\n\n<p>1) if I put my memory write function directly in int main, it works</p>\n\n<p>The code above is an example code I have written so I didn\u2019t have to paste everything I\u2019ve written!!</p>\n\n<p>Thanks guys!</p>\n"}, {"tags": ["c++", "c++builder"], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1558566984, "post_id": 56263844, "comment_id": 99148468, "body": "Since you KNOW the <code>Sender</code> will always be a <code>TEdit</code>, you should use <code>static_cast</code> instead, and get rid of the <code>if</code> statement entirely."}], "tags": [], "owner": {"reputation": 51, "user_id": 2113260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66929863558ba5eea680c7b41ad7a70b?s=128&d=identicon&r=PG", "display_name": "user2113260", "link": "https://stackoverflow.com/users/2113260/user2113260"}, "is_accepted": false, "score": 1, "last_activity_date": 1558553959, "creation_date": 1558553959, "answer_id": 56263844, "question_id": 56262878, "link": "https://stackoverflow.com/questions/56262878/is-there-any-possible-way-to-append-an-event-custom-made-to-an-object-created/56263844#56263844", "title": "Is there any possible way to append an event (custom made) to an object created in run-time ?[C++ Builder]", "body": "<p>One way would be to embed the index in the TEdit Tag field, then give them all the same OnClick handler:</p>\n\n<pre><code>    Edit[i]-&gt;Left=50;\n    Edit[i]-&gt;Parent=Form1;\n    Edit[i]-&gt;Tag = i;\n    Edit[i]-&gt;OnClick = myclick;\n</code></pre>\n\n<p>Then the myclick handler could be:</p>\n\n<pre><code>void __fastcall TForm1::myclick(TObject *Sender)\n{\n    if (TEdit * ed = dynamic_cast&lt;TEdit *&gt;(Sender))\n    {\n        ed-&gt;Text=\"Enter some value in the\"+AnsiString(ed-&gt;Tag)+\" box\";\n    }\n}\n</code></pre>\n\n<p>HTH.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1558712197, "last_edit_date": 1558712197, "creation_date": 1558566863, "answer_id": 56266134, "question_id": 56262878, "link": "https://stackoverflow.com/questions/56262878/is-there-any-possible-way-to-append-an-event-custom-made-to-an-object-created/56266134#56266134", "title": "Is there any possible way to append an event (custom made) to an object created in run-time ?[C++ Builder]", "body": "<p>You cannot assign a handler that does not match the signature that <code>OnClick</code> is expecting:</p>\n\n<pre><code>typedef void __fastcall (__closure *TNotifyEvent)(System::TObject* Sender);\n</code></pre>\n\n<p>Which means you cannot add extra parameters at all.</p>\n\n<p>However, you can assign a single <code>OnClick</code> handler to all of the <code>TEdit</code> controls, and then leverage the <code>Sender</code> parameter to know which <code>TEdit</code> is being clicked on, eg:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Edit = new TEdit*[nr_elem];\n\nfor(int i = 0; i &lt; nr_elem; ++i)\n{\n    Edit[i] = new TEdit(this);\n\n    Edit[i]-&gt;Width = 75;\n    Edit[i]-&gt;Height = 20;\n    Edit[i]-&gt;Top = 100+15*i;\n    Edit[i]-&gt;Left = 50;\n    Edit[i]-&gt;Parent = this;\n    Edit[i]-&gt;Tag = i;\n    Edit[i]-&gt;OnClick = EditClick;\n}\n\n...\n\nvoid __fastcall TForm1::EditClick(TObject *Sender)\n{\n    TEdit *Edit = static_cast&lt;TEdit*&gt;(Sender);\n    EditNClick(Edit, Edit-&gt;Tag);\n}\n\nvoid __fastcall TForm1::EditNClick(TEdit *Sender, int index)\n{\n    Sender-&gt;Text = _D(\"Enter some value in the \") + String(index) + _D(\" box\");\n}\n</code></pre>\n\n<p>If you don't want to rely on the <code>Tag</code> (ie, if you are using it for something else), or if you want to attach additional custom data to each Edit, you can use a custom derived class instead:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class TMyEdit : public TEdit\n{\npublic:\n    int ArrayIndex;\n    ...\n    __fastcall TMyEdit(TComponent *Owner) : TEdit(Owner) {}\n};\n\n...\n\nEdit = new TEdit*[nr_elem];\n\nfor(int i = 0; i &lt; nr_elem; ++i)\n{\n    Edit[i] = new TMyEdit(this);\n\n    Edit[i]-&gt;Width = 75;\n    Edit[i]-&gt;Height = 20;\n    Edit[i]-&gt;Top = 100+15*i;\n    Edit[i]-&gt;Left = 50;\n    Edit[i]-&gt;Parent = this;\n    static_cast&lt;TMyEdit*&gt;(Edit[i])-&gt;ArrayIndex = i;\n    Edit[i]-&gt;OnClick = EditClick;\n}\n\n...\n\nvoid __fastcall TForm1::EditClick(TObject *Sender)\n{\n    TMyEdit *Edit = static_cast&lt;TMyEdit*&gt;(Sender);\n    EditNClick(Edit, Edit-&gt;ArrayIndex);\n}\n\nvoid __fastcall TForm1::EditNClick(TEdit *Sender, int index)\n{\n    Sender-&gt;Text = _D(\"Enter some value in the \") + String(index) + _D(\" box\");\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11540844, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9X4wIDN7bNE/AAAAAAAAAAI/AAAAAAAAAoU/TuT3JJnIYeA/photo.jpg?sz=128", "display_name": "\u0412\u043b\u0430\u0434 \u0411\u0430\u043b\u0430\u0443\u0440", "link": "https://stackoverflow.com/users/11540844/%d0%92%d0%bb%d0%b0%d0%b4-%d0%91%d0%b0%d0%bb%d0%b0%d1%83%d1%80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 56266134, "answer_count": 2, "score": 0, "last_activity_date": 1558712197, "creation_date": 1558549562, "question_id": 56262878, "link": "https://stackoverflow.com/questions/56262878/is-there-any-possible-way-to-append-an-event-custom-made-to-an-object-created", "title": "Is there any possible way to append an event (custom made) to an object created in run-time ?[C++ Builder]", "body": "<p>So, i have tried to create some TEdit objects in run-time, eventually what I'm trying to find out is: <strong>How am i supposed to create a custom OnClick event and append it to an Object in run-time</strong>, for example, the event should take 2 parameters, the Sender object(obviously) and the index of the TEdit object. The event should change some properties of the TEdit object created in run-time, whose index would be passed as a parameter, so the Text property would be like : \"Enter some values in the [index] edit\", or something in this manner.</p>\n\n<pre><code>Edit=new TEdit*[nr_elem];\n\n    for(int i=0;i&lt;nr_elem;i++)\n    {\n    Edit[i]=new TEdit(this);\n\n    Edit[i]-&gt;Width=75;\n    Edit[i]-&gt;Height=20;\n    Edit[i]-&gt;Top=100+15*i;\n    Edit[i]-&gt;Left=50;\n    Edit[i]-&gt;Parent=Form1;\n   /** Now I should append the event to the Edit[i] object*/\n}\n</code></pre>\n\n<p>The event should look like:</p>\n\n<pre><code> void __fastcall TForm1::EditNClick(TObject *Sender,int index)\n{\n    Edit[index]-&gt;Text=\"Enter some value in the\"+AnsiString(index)+\" box\";\n}\n</code></pre>\n"}, {"tags": ["c++", "linux", "qt5"], "answers": [{"comments": [{"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 1, "creation_date": 1558550982, "post_id": 56262979, "comment_id": 99142791, "body": "I should have added that this is already set to true in my constructor. So that&#39;s not it."}, {"owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "reply_to_user": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1558551178, "post_id": 56262979, "comment_id": 99142869, "body": "So that&#39;s not it, have you verified if it&#39;s handled as a mouse event instead? You touch the screen and a mouse event is received?"}, {"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 1, "creation_date": 1558551445, "post_id": 56262979, "comment_id": 99142975, "body": "Yes, as I said, I added a mouse event handler as well to test that mouse events worked and it doesn&#39;t trigger that handler either. I don&#39;t check the event type in that handler... I just change the status bar to indicate that it was triggered."}, {"owner": {"reputation": 147, "user_id": 9578753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d8384cf03c7f3da0ae5bb24b24344e?s=128&d=identicon&r=PG&f=1", "display_name": "G. Adnane", "link": "https://stackoverflow.com/users/9578753/g-adnane"}, "edited": false, "score": 0, "creation_date": 1580317783, "post_id": 56262979, "comment_id": 106060871, "body": "Please, for my case, it&#39;s handled as a mouse event, how to do to make it handel touch instead of mouse events @SilvanoCerza"}], "tags": [], "owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "is_accepted": false, "score": 1, "last_activity_date": 1558550008, "creation_date": 1558550008, "answer_id": 56262979, "question_id": 56262776, "link": "https://stackoverflow.com/questions/56262776/qt5-not-registering-touch-events/56262979#56262979", "title": "Qt5 Not Registering Touch Events", "body": "<p>The <code>QTouchEvent</code> <a href=\"https://doc.qt.io/qt-5/qtouchevent.html#details\" rel=\"nofollow noreferrer\">documentation</a> says:</p>\n\n<blockquote>\n  <p>Touch events occur when pressing, releasing, or moving one or more\n  touch points on a touch device (such as a touch-screen or track-pad).\n  To receive touch events, widgets have to have the\n  Qt::WA_AcceptTouchEvents attribute set and graphics items need to have\n  the acceptTouchEvents attribute set to true.</p>\n</blockquote>\n\n<p>Probably you just need to call <code>setAttribute(Qt::WA_AcceptTouchEvents, true)</code> inside the <code>MainWindow</code> constructor.</p>\n"}, {"comments": [{"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1558703211, "post_id": 56291697, "comment_id": 99198979, "body": "I don&#39;t know if it has to do with the G++ compiler or Qt itself, but if I try that &quot;override&quot; syntax, I get an error saying it&#39;s expecting a semicolon before the override keyword. I should add that I&#39;m not familiar with C++14/17. I haven&#39;t used C++ actively in years and only learned a little of the C++11 standard."}, {"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1558703388, "post_id": 56291697, "comment_id": 99199063, "body": "I&#39;m using GCC/G++ 4.4.7, which it appears doesn&#39;t support override."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1558704023, "post_id": 56291697, "comment_id": 99199437, "body": "@DarinBeaudreau It&#39;s not needed. It&#39;s just a recommendation. Also, 4.4.7 is rather old, I&#39;d try and upgrade."}, {"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1558705118, "post_id": 56291697, "comment_id": 99200063, "body": "Not under my control. I have the use the version my team uses. The software is a few years old, so it likely won&#39;t be updated any time soon."}, {"owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "edited": false, "score": 0, "creation_date": 1558705230, "post_id": 56291697, "comment_id": 99200122, "body": "Anyway... I got it working and it&#39;s still not raising any touch events. I&#39;ve been trying to contact Qt tech support to find out if they read events directly from <b>/dev/input/eventX</b> or somewhere else, because I can see the events when I dump that location directly. If events are read from X, I&#39;m probably not going to get it working."}], "tags": [], "owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1558697418, "last_edit_date": 1558697418, "creation_date": 1558697007, "answer_id": 56291697, "question_id": 56262776, "link": "https://stackoverflow.com/questions/56262776/qt5-not-registering-touch-events/56291697#56291697", "title": "Qt5 Not Registering Touch Events", "body": "<blockquote>\n  <p>Is there something wrong with the way I'm using the touch event handler? </p>\n</blockquote>\n\n<p>There is no touch event handler. If you change:</p>\n\n<pre><code>int touchEvent(QTouchEvent *ev);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>int touchEvent(QTouchEvent *ev) override;\n</code></pre>\n\n<p>(which you should always do when you are trying to override virtual functions so you can catch exactly this kind of mistake), you'll see that there is no such function for you to override. What you need to override is the <code>event()</code> handler:</p>\n\n<pre><code>protected:\n    bool event(QEvent *ev) override;\n</code></pre>\n\n<p>You need to check for touch events there:</p>\n\n<pre><code>bool MainWindow::event(QEvent *ev)\n{\n    switch(ev-&gt;type()) {\n    case QEvent::TouchBegin:\n        touchPoints++;\n        break;\n    case QEvent::TouchEnd:\n        touchPoints++;\n        break;\n    default:\n        return QMainWindow(ev); \n    }\n\n    ui-&gt;statusBar-&gt;showMessage(\"Touch Points: \" + touchPoints);\n}\n</code></pre>\n\n<p>However, it might be better to work with gestures instead of touch events. But I don't know what kind of application you're writing. If you wanted to let Qt recognize gestures rather than implementing them yourself through touch events, you would first grab the gestures you want, in this case pinching:</p>\n\n<pre><code>setAttribute(Qt::WA_AcceptTouchEvents);\ngrabGesture(Qt::PinchGesture);\n</code></pre>\n\n<p>and then handle it:</p>\n\n<pre><code>bool MainWindow::event(QEvent *ev)\n{\n    if (e-&gt;type() != QEvent::Gesture) {\n        return QMainWindow::event(e);\n    }\n\n    auto* gestEv = static_cast&lt;QGestureEvent*&gt;(e);\n    if (auto* gest = gestEv-&gt;gesture(Qt::PinchGesture)) {\n        auto* pinchGest = static_cast&lt;QPinchGesture*&gt;(gest);\n        auto sf = pinchGest-&gt;scaleFactor();\n\n        // You could use the pinch scale factor here to zoom an image\n        // for example.\n\n        e-&gt;accept();\n        return true;\n    }\n    return QMainWindow::event(e);\n}\n</code></pre>\n\n<p>Working with gestures instead of touch events has the advantage of using the platform's gesture recognition facilities, like those of Android and iOS. But again, I don't know what kind of application you're writing and on what kind of platform you're working on.</p>\n"}], "owner": {"reputation": 604, "user_id": 1205340, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7273304eb7892b2ee4edaf4bb094f72?s=128&d=identicon&r=PG", "display_name": "Darin Beaudreau", "link": "https://stackoverflow.com/users/1205340/darin-beaudreau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1558703923, "creation_date": 1558549128, "last_edit_date": 1558703923, "question_id": 56262776, "link": "https://stackoverflow.com/questions/56262776/qt5-not-registering-touch-events", "title": "Qt5 Not Registering Touch Events", "body": "<p>I'm working on determining if a certain touchscreen will be compatible with an application and recently got a loaner model of an Elo 2402L touchscreen. I've installed the driver the company provides and was able to see multi-touch events using the <code>evtest</code> utility (parser for <strong>/dev/input/eventX</strong>).</p>\n\n<p>The thing is that I'm running Scientific Linux 6.4, which uses Linux kernel 2.6.32. I've seen a lot of mixed information on touchscreen compatibility for Linux kernels before 3.x.x. Elo says that their driver only supports single-touch for 2.6.32. Also, I've seen people say that the majority of the compatibility issues with touch events in this kernel version are with Xorg interfaces.</p>\n\n<p>I developed a very simple Qt5 application to test whether Qt could detect the touch events or not, because I'm not sure whether Qt applications are X-based and if they read events directly from <strong>/dev/input</strong> or something else.</p>\n\n<p>However, despite a simple mouse event handler being able to correctly register mouse events, I also created a simple touch event handler and nothing happens when I touch the main screen. There is a beep, as part of the driver that Elo provides makes a beep when the screen is touched, so I know that SOMETHING is registering that touch, but neither the desktop, nor this application seem to recognize the touch event.</p>\n\n<p>Also, <strong>yes</strong>, the WA_AcceptTouchEvents attribute is set to true in the window's constructor.</p>\n\n<p>I have a simple mainwindow.h:</p>\n\n<pre><code>...\nprotected:\n    int touchEvent(QTouchEvent *ev);\n...\n</code></pre>\n\n<p>And mainwindow.cpp:</p>\n\n<pre><code>MainWindow::MainWindow(QWidget *parent) {\n    ...\n    setAttribute(Qt::WA_AcceptTouchEvents, true);\n    touchPoints = 0;\n}\n...\nint MainWindow::touchEvent(QTouchEvent *ev) {\n    switch(ev-&gt;type()) {\n        case QEvent::TouchBegin:\n            touchPoints++;\n            break;\n        case QEvent::TouchEnd:\n            touchPoints--;\n            break;\n    }\n\n    ui-&gt;statusBar-&gt;showMessage(\"Touch Points: \" + touchPoints);\n}\n</code></pre>\n\n<p>Is there something wrong with the way I'm using the touch event handler? Or is there some issue with the device itself? Does Qt read input events directly from <strong>/dev/input</strong>, or does it get its input events from X?</p>\n\n<p>Very confused here, as I haven't used Qt before and want to narrow down the cause before I say that it's the device causing the issue.</p>\n\n<p>Also, if anyone has any insight into the device / kernel compatibility issue, that would be extremely helpful.</p>\n"}, {"tags": ["c++", "templates", "visual-c++", "operator-overloading"], "comments": [{"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1558548241, "post_id": 56262451, "comment_id": 99141558, "body": "<code>bar_value</code> and <code>1.0</code> are different types and will not match a single <code>T</code> and <code>1.0</code> No implicit conversions prevents a lot of grief in template programming."}, {"owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "reply_to_user": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1558548375, "post_id": 56262451, "comment_id": 99141613, "body": "There&#39;s no problem with the statement <code>bar ev2 = bar_value + 1.0</code>; implicit conversion is used to match my defined operator. That&#39;s not the case with <code>foo&lt;double&gt; ev2 = foo_value + 1.0</code> even though the implicit conversion seems obvious."}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "edited": false, "score": 0, "creation_date": 1558548499, "post_id": 56262611, "comment_id": 99141671, "body": "I tried the latter, and if you define the template like that for both lhs and rhs, the compiler won&#39;t know which operator it should use, and it will be an ambiguous call."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "edited": false, "score": 1, "creation_date": 1558548706, "post_id": 56262611, "comment_id": 99141758, "body": "@Riddick I&#39;d have to see that code to tell you why it didn&#39;t work.  It works just fine <a href=\"http://coliru.stacked-crooked.com/a/64d53b1a298c0642\" rel=\"nofollow noreferrer\">here</a>;"}, {"owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "edited": false, "score": 0, "creation_date": 1558549403, "post_id": 56262611, "comment_id": 99142096, "body": "I figured out what happened when I got an ambiguous call: I am asking for the parameter as the parent class type (not shown in the question). So I&#39;m assuming since it doesn&#39;t fit the arguments precisely, adding the two additional overloads introduces ambiguity when I pass child classes. When I cast to parent, it works."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "edited": false, "score": 0, "creation_date": 1558549501, "post_id": 56262611, "comment_id": 99142135, "body": "@Riddick Sounds plausible.  Hope this helps you."}, {"owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "edited": false, "score": 0, "creation_date": 1558558591, "post_id": 56262611, "comment_id": 99146114, "body": "Is there any practical reason it doesn&#39;t attempt to apply implicit conversions in the template case? The way I reason, if it can match object <code>bar</code> to a double <i>and</i> I can create a variable with <code>foo foo_value(1.0)</code> (and have it correctly match the template), it seems within reach to implicitly convert the argument to the right type too. Would that make function matching too greedy?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "edited": false, "score": 1, "creation_date": 1558559199, "post_id": 56262611, "comment_id": 99146362, "body": "@Riddick The practical reason is there could be any any number of things it could do a conversion to.  Lets say you have two types (<code>A</code> and <code>B</code>) that can convert to each other, and you pass them to a function template that only takes a single type.  Does the compile convert <code>A</code> to a <code>B</code>, or does it convert <code>B</code> to an <code>A</code>?  Trying to solve that problem, and all of the other edge cases, would make the rules for templates and order of magnitude more complex then they are already, and they are pretty complex as is."}, {"owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "edited": false, "score": 0, "creation_date": 1558559322, "post_id": 56262611, "comment_id": 99146409, "body": "Could I ask you in chat about the larger problem I&#39;m trying to resolve?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "edited": false, "score": 0, "creation_date": 1558559377, "post_id": 56262611, "comment_id": 99146434, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193795/discussion-between-nathanoliver-and-riddick\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1558548846, "last_edit_date": 1558548846, "creation_date": 1558548389, "answer_id": 56262611, "question_id": 56262451, "link": "https://stackoverflow.com/questions/56262451/binary-operator-for-template-class-doesnt-resolve-implicit-conversion/56262611#56262611", "title": "Binary Operator for Template Class Doesn&#39;t Resolve Implicit Conversion", "body": "<p>The thing you have to remember about templates is that they will <strong>not</strong> do a conversion for you.  All they do is try and figure out the types things are, and if that jives with template parameters, then it will stamp out the function and call it.</p>\n\n<p>In you case when you do</p>\n\n<pre><code>foo_value + 1.0\n</code></pre>\n\n<p>the compiler goes okay, lets see if we have any <code>operator +</code> that will work for this.  It finds</p>\n\n<pre><code>template&lt;typename T&gt;\nfoo&lt;T&gt; operator+(foo&lt;T&gt; a, foo&lt;T&gt; b)\n{\n    return foo&lt;T&gt;(a.val + b.val);\n}\n</code></pre>\n\n<p>and then it tries to figure out what <code>T</code> is so it can stamp out a concrete function.  It looks at <code>foo_value</code>, sees it is a <code>foo&lt;double&gt;</code> so it says for the first parameter <code>T</code> needs to be a <code>double</code>.  Then it looks at <code>1.0</code> and goes okay, I have a <code>double</code> and that is when you run into a problem.  The compiler can't deduce what <code>T</code> should be for <code>b</code> because it expects a <code>foo&lt;some_type&gt;</code>, but got a <code>double</code> instead.  Because it can't deduce a type, your code fails to compile.</p>\n\n<p>In order to get the behavior you want you would need to add</p>\n\n<pre><code>template&lt;typename T&gt;\nfoo&lt;T&gt; operator+(foo&lt;T&gt; a, T b)\n{\n    return foo&lt;T&gt;(a.val + b);\n}\n</code></pre>\n\n<p>Which lets you add a <code>T</code> to a <code>foo&lt;T&gt;</code>, or better yet</p>\n\n<pre><code>template&lt;typename T, typename U&gt;\nfoo&lt;T&gt; operator+(foo&lt;T&gt; a, U b)\n{\n    return foo&lt;T&gt;(a.val + b);\n}\n</code></pre>\n\n<p>Which lets you add anything to a <code>foo&lt;T&gt;</code> (<code>foo&lt;double&gt; + int</code> for instance where the first version would not allow that)</p>\n"}], "owner": {"reputation": 251, "user_id": 6042280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdQPb.jpg?s=128&g=1", "display_name": "Riddick", "link": "https://stackoverflow.com/users/6042280/riddick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56262611, "answer_count": 1, "score": 1, "last_activity_date": 1558549697, "creation_date": 1558547698, "question_id": 56262451, "link": "https://stackoverflow.com/questions/56262451/binary-operator-for-template-class-doesnt-resolve-implicit-conversion", "title": "Binary Operator for Template Class Doesn&#39;t Resolve Implicit Conversion", "body": "<p>Consider the following classes, where the first is templated. Both are meant to hold a numeric value.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nstruct foo\n{\n    foo(T val) : val{ val } {}\n    T val;\n};\n\nstruct bar\n{\n    bar(double val) : val{ val } {}\n    double val;\n};\n</code></pre>\n\n<p>I want to define a way to add these classes together to get a new one with a different value.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nfoo&lt;T&gt; operator+(foo&lt;T&gt; a, foo&lt;T&gt; b)\n{\n    return foo&lt;T&gt;(a.val + b.val);\n}\n\nbar operator+(bar a, bar b)\n{\n    return bar(a.val + b.val);\n}\n</code></pre>\n\n<p>When I use these operators with implicit conversion, the operator using object of type <code>foo</code> doesn't use the implicit conversion on the double value to apply my overloaded operator, even though it can do it for the non-template class. The result is that there is no operator matching the types in that expression.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int main()\n{\n    foo&lt;double&gt; foo_value(11.0);\n    bar bar_value(11.0);\n\n    foo&lt;double&gt; ev1 = foo_value + 1.0; // no operator matches these operands\n    bar ev2 = bar_value + 1.0;\n}\n</code></pre>\n\n<p>Does the operator have to be explicitly instantiated first? If so, a) how does that look like, and b) why isn't the instantiation done implicitly, if it can be done when initializing an object of type <code>foo&lt;double&gt;</code>?</p>\n\n<p>If the standard doesn't support any sort of resolution without explicitly casting <code>1.0</code> to a value of type <code>foo&lt;double&gt;</code>, I presume the only other possibility is defining operator overloads for each type I want to use like that (for both lhs and rhs)?</p>\n"}, {"tags": ["c++", "arrays", "debugging", "compiler-construction", "undefined-behavior"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1558547610, "post_id": 56262411, "comment_id": 99141287, "body": "Please <b><a href=\"https://stackoverflow.com/posts/56262411/edit\">edit</a></b> your question with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE (Short, Self Contained, Correct Example)</a>"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 4, "creation_date": 1558547620, "post_id": 56262411, "comment_id": 99141291, "body": "You seem to have an off-by-one error in iterating over your array. You&#39;re ranging from 1 to 6, inclusive, which seems like it ought to be 0 to 5, inclusive."}, {"owner": {"reputation": 1, "user_id": 6141111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mwu80AuRvJ0/AAAAAAAAAAI/AAAAAAAAADs/tinkW0f2xrU/photo.jpg?sz=128", "display_name": "Ardhendu", "link": "https://stackoverflow.com/users/6141111/ardhendu"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558547942, "post_id": 56262411, "comment_id": 99141444, "body": "@NathanOliver i am new to stack overflow in terms of asking questions. i didn&#39;t get exactly what you said, but i tried to edit it. is it okay now?"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1558548567, "post_id": 56262411, "comment_id": 99141696, "body": "<code>swap(heap[k], heap[k&#47;2]</code> - for k == 1, k/2 == 0."}, {"owner": {"reputation": 1, "user_id": 6141111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mwu80AuRvJ0/AAAAAAAAAAI/AAAAAAAAADs/tinkW0f2xrU/photo.jpg?sz=128", "display_name": "Ardhendu", "link": "https://stackoverflow.com/users/6141111/ardhendu"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1558548614, "post_id": 56262411, "comment_id": 99141720, "body": "@templatetypedef , the heap is 1 indexed, and the a is 0 indexed.i checked it, it was not the problem. :/  and if it was the case, then online ide should&#39;ve produced the same output(with garbage), right? :/"}, {"owner": {"reputation": 1, "user_id": 6141111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mwu80AuRvJ0/AAAAAAAAAAI/AAAAAAAAADs/tinkW0f2xrU/photo.jpg?sz=128", "display_name": "Ardhendu", "link": "https://stackoverflow.com/users/6141111/ardhendu"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1558548844, "post_id": 56262411, "comment_id": 99141824, "body": "@500-InternalServerError , k won&#39;t take the value 1. cause if h == 1, it just assigned heap[h] with a[i], and didn&#39;t do any swapping or assigning values to k."}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1558549007, "post_id": 56262411, "comment_id": 99141906, "body": "In your while statement you can have <code>k&#47;2</code>equal to 0."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1558549051, "post_id": 56262411, "comment_id": 99141929, "body": "@Ardhendu: you have it in a <code>while</code> loop, winding it down."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1558549485, "post_id": 56262411, "comment_id": 99142127, "body": "Show a great deal of caution with <code>#include &lt;bits&#47;stdc++.h&gt;</code>. You should not directly call anything in the bits directory. They are implementation-specific headers and aren&#39;t guaranteed to work if included directly.  For specifics on bits/stdc++.h&#39;s downsides read <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h\">Why should I not #include &lt;bits/stdc++.h&gt;?</a>. When you combine it with <code>using namespace std;</code>, you turn the global namespace into a minefield. Tens of thousands of identifiers can now conflict with your declarations causing bizarre errors."}, {"owner": {"reputation": 1, "user_id": 6141111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mwu80AuRvJ0/AAAAAAAAAAI/AAAAAAAAADs/tinkW0f2xrU/photo.jpg?sz=128", "display_name": "Ardhendu", "link": "https://stackoverflow.com/users/6141111/ardhendu"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1558549514, "post_id": 56262411, "comment_id": 99142140, "body": "@500-InternalServerError  thank you, i have changed it to ` while(k/2)` , but why did it happen to only my device and not the online ide with the same input?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558549645, "post_id": 56262411, "comment_id": 99142195, "body": "@Ardhendu Overwriting  an array leads to undefined behavior.  There is no guarantee what your output will be if you go beyond the bounds of the array.  So all of those things you were doing (every 3 or 4 times it works, but fails, etc.) just had you waste your time.  If you see it wrong just once, just stop everything and fix the problem.  Also, if you had used <code>std::array</code> instead of the usual arrays, and used <code>at()</code> instead of <code>[ ]</code> to access the elements, then all of the environments you tested on would have failed with an <code>out_of_range</code> exception."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558550031, "post_id": 56262411, "comment_id": 99142372, "body": "@Ardhendu Also, a comment about the code you posted -- instead of having the input being done using <code>cin</code> statements, please populate the array in the code directly.  For example <code>int a[10] = {6,5,1,4,2,3};</code>.  No one is going to type in the data over and over again each time they run the program."}, {"owner": {"reputation": 1, "user_id": 6141111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mwu80AuRvJ0/AAAAAAAAAAI/AAAAAAAAADs/tinkW0f2xrU/photo.jpg?sz=128", "display_name": "Ardhendu", "link": "https://stackoverflow.com/users/6141111/ardhendu"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558550702, "post_id": 56262411, "comment_id": 99142661, "body": "@PaulMcKenzie it was helpful, thank you !"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558550863, "post_id": 56262411, "comment_id": 99142735, "body": "@Ardhendu <a href=\"http://coliru.stacked-crooked.com/a/0ab18f0be5087a41\" rel=\"nofollow noreferrer\">Here is the program, with the arrays having size 6 using std::array</a>.  Note the exception -- every standard compiler will run and give you the same exception (std::out_of_range).  Look at where the <code>at()</code> calls are placed -- that is where you&#39;re going out-of-bounds.  Your original code covered up this bug by making the arrays too big.  Making the arrays the correct size revealed the error.  That&#39;s the danger of making arrays too big -- it covers up off-by-one bugs like this."}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558575369, "post_id": 56262411, "comment_id": 99149924, "body": "@PaulMcKenzie The point here is that he isn&#39;t using the first element (for some undisclosed reason), so using <code>std::array</code> rather than a static array would in fact not resolve this particular issue. On top of that, bounds checks aren&#39;t free (although not very expensive either), and while certainly helpful at times, I don&#39;t think it makes sense to blindly use them everywhere just because you can."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1558575500, "post_id": 56262411, "comment_id": 99149948, "body": "@Qubit I am well-aware of what <code>at()</code> does.  The reason why I used it is for debugging purposes.  Once the off-by-one bugs are cleaned up, then <code>[ ]</code> is reintroduced.  You won&#39;t believe the thousands of posts that would never need to be here if the original poster&#39;s knew about this technique of <i>debugging</i>."}, {"owner": {"reputation": 1, "user_id": 6141111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mwu80AuRvJ0/AAAAAAAAAAI/AAAAAAAAADs/tinkW0f2xrU/photo.jpg?sz=128", "display_name": "Ardhendu", "link": "https://stackoverflow.com/users/6141111/ardhendu"}, "edited": false, "score": 0, "creation_date": 1558612900, "post_id": 56262411, "comment_id": 99164011, "body": "thank you everyone. i got my answer. so the main reason was: in the loop i set the condition to be <code>while(k)</code> but inside there was a <code>k&#47;2</code> , so it turned out that for <code>k = 1</code>, my program had accessed <code>heap[k&#47;2]</code> that is <code>heap[0]</code>, but i started putting values in heap from index 1. so the garbage value in <code>heap[0]</code> was swapped in the main heap array if it was larger than <code>heap[k]</code>. as for codechef ide, <i>heap[0]&#39;s</i> value was small enough for not to be swapped. but in my environment, the value was (most of the time) large enough to be swapped. that&#39;s where the problem began. again thanks everyone"}], "owner": {"reputation": 1, "user_id": 6141111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mwu80AuRvJ0/AAAAAAAAAAI/AAAAAAAAADs/tinkW0f2xrU/photo.jpg?sz=128", "display_name": "Ardhendu", "link": "https://stackoverflow.com/users/6141111/ardhendu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558549940, "creation_date": 1558547497, "last_edit_date": 1558549940, "question_id": 56262411, "link": "https://stackoverflow.com/questions/56262411/how-did-printing-an-array-alter-the-values-of-another-array", "title": "How did &quot;printing an array&quot; alter the values of another array?", "body": "<p>i have two arrays, i wanted to output only the later one, but in the output an element just got a garbage value.\nbut, if i printed the first array before it then the garbage value in the second array isn't outputted anymore (well, i had to compile &amp; run 3/4 times in order to get the correct value once, the remaining 2/3 times i get the garbage value)</p>\n\n<p>( i run my code without printing the first array in codechef.com/ide , and it gave the desired output every time. )</p>\n\n<p>so i have two questions.</p>\n\n<ol>\n<li><p>why did this happen?</p></li>\n<li><p>why did this happen only to my &amp; not to the oj?</p></li>\n</ol>\n\n<p>i was trying to implement heap build, that is to take an array <strong>a</strong> , put this array to another array called <strong>heap</strong> in a way that the <strong>heap</strong> follows the property of <em>Binary Min Heap</em> . lastly, print the elements of <strong>heap</strong> .\nwhen i compiled and run it, it outputted a garbage value instead of a certain element's value each time.\nthen , to debug it , i took a loop before printing the <strong>heap</strong> in order to print the <strong>a</strong> array to see if it takes the inputs correctly. this time, the <strong>heap</strong> array was printed correctly! but when i again compile and run it, it gave me the same garbage value instead of an element's value as before. i just began to compile and run the code for some times. i noticed that, in every 3/4 compilations , it gave correct answer just once.</p>\n\n<p>later i submitted my code in codechef's ide, this time i got the correct output every time without having printing the extra array <strong>a</strong>.\n</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\n\nusing namespace std;\n\nint main(void)\n{ \n    int a[10];\n\n    for (int i = 0; i &lt; 6; i++)\n    {\n        cin &gt;&gt; a[i];\n    }\n\n    int heap[10];\n\n    for (int i = 0, h = 1; i &lt; 6; i++, h++)\n    {\n        if(h == 1) heap[h] = a[i];\n        else{\n            heap[h] = a[i];\n            int k = h;\n            //checking if the new heap element violates the heap property\n            //if it does then swap with it's parent , and repeat\n            while(k){\n                if(heap[k] &lt; heap[k/2]) swap(heap[k], heap[k/2]);\n                k /= 2;\n            }\n        }\n    }\n    /* if this part is executed then the heap printing\n    // part prints the correct heap array atleast one time\n    // in every 3 or more than 3 \"build &amp; run\" without any garbage value\n\n    //if not executed, then the heap printing part prints a \n    //garbage value each and every time \n    */\n\n    // weird start\n    //prints the main array\n    // for (int i = 0; i &lt;= 5; ++i)\n    // {\n    //  cout &lt;&lt; a[i] &lt;&lt;' ';\n    // }\n    // cout &lt;&lt; endl;\n    //weird end\n\n    //heap printing part\n    for (int i = 1; i &lt;= 6; ++i)\n    {\n        cout &lt;&lt; heap[i] &lt;&lt; ' ';\n    }\n    cout &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>for input: \n6 5 1 4 2 3</p>\n\n<p>i expected: 1 2 3 6 4 5</p>\n\n<p>i got: 2 4 3 6 5 4199040 </p>\n\n<p>(editor: sublime text and codeblocks &amp; compiler: minGW)</p>\n\n<p>update: replacing <code>while(k)</code> with <code>while(k/2)</code> did the job for outputting the answer without any help printing of another array. <strong>but how did the code generated a two different output in several build &amp; run operations in my device?  and it every time outputted the right answer in the online ide but not in mine.</strong> (<em>this was the main question actually</em>) </p>\n"}, {"tags": ["c++", "stdvector"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1558547315, "post_id": 56262313, "comment_id": 99141173, "body": "<code>reserve</code> != <code>resize</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1558547337, "post_id": 56262313, "comment_id": 99141184, "body": "No new needed BTW."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1558547392, "post_id": 56262313, "comment_id": 99141206, "body": "Your vector is defined to hold objects of type <code>ExtClass</code> but you are trying to push pointers there. You either need to have vector of smart pointers or redesign your approach"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1558547445, "post_id": 56262313, "comment_id": 99141229, "body": "Use <code>push_back</code> or <code>emplace_back</code>. It&#39;s very important to know the difference between a pointer to an object and an object itself (<code>Object*</code> and <code>Object</code>) in C++."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558548363, "post_id": 56262313, "comment_id": 99141604, "body": "This use of <code>new</code> shows an influence from languages like Java. You don&#39;t need to <code>new</code> every single object in C++. In fact, you should not use it at all (outside of very specific use cases) in modern code. Only use dynamic allocation when you <i>really</i> need it, and then prefer <code>std::make_unique</code> or <code>std::make_shared</code> instead of <code>new</code>."}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558548374, "post_id": 56262437, "comment_id": 99141612, "body": "@Fran&#231;oisAndrieux I though it was clear by my remark, anyway changed it to be more clear"}, {"owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 0, "creation_date": 1558548823, "post_id": 56262437, "comment_id": 99141809, "body": "Thanks for the help! :) Honestly, these two make more sense to me, although I do not understand the first one at all. Google it is! :)"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 0, "creation_date": 1558549119, "post_id": 56262437, "comment_id": 99141958, "body": "@Amaterastis it is called member initializer list, you can find some details for example here <a href=\"https://www.geeksforgeeks.org/when-do-we-use-initializer-list-in-c/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/when-do-we-use-initializer-list-in-c</a>"}, {"owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 0, "creation_date": 1558549235, "post_id": 56262437, "comment_id": 99142021, "body": "Thanks once again! :)"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 0, "creation_date": 1558550413, "post_id": 56262437, "comment_id": 99142538, "body": "@Amaterastis More on the <a href=\"https://en.cppreference.com/w/cpp/language/initializer_list\" rel=\"nofollow noreferrer\">member initializer list</a>. It is one of the most useful and least taught pieces of C++ syntax out there. Not only does it make constructors easier to write (and often faster to run), but there&#39;s a lot of code that you simply cannot write without it."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": 3, "last_activity_date": 1558548342, "last_edit_date": 1558548342, "creation_date": 1558547630, "answer_id": 56262437, "question_id": 56262313, "link": "https://stackoverflow.com/questions/56262313/creating-stdvectorclass-with-calling-class-constructor-later-on/56262437#56262437", "title": "Creating std::vector&lt;Class&gt; with calling Class constructor later on", "body": "<p>Code as written can be fixed by this:</p>\n\n<pre><code>MainClass(int size) \n   : attribute( size )\n{\n}\n</code></pre>\n\n<p>that's it it will initialize <code>attribute</code> with <code>size</code> default constructed objects of <code>ExtClass</code>. </p>\n\n<p>Note that this code:</p>\n\n<pre><code>this-&gt;attribute.reserve(size) // reserving enough places in vector\nfor (int i = 0; i &lt; size; ++i)\n    this-&gt;attribute[i] = new ExtClass(); // problem\n</code></pre>\n\n<p>even if we fix it to be compilable:</p>\n\n<pre><code>this-&gt;attribute.reserve(size) // reserving enough places in vector\nfor (int i = 0; i &lt; size; ++i)\n    this-&gt;attribute[i] = ExtClass(); // problem\n</code></pre>\n\n<p>leads to UB as you try to access elements of empty vector - calling reserve does not change how many objects vector holds, only capacity for future use.</p>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 0, "creation_date": 1558548773, "post_id": 56262490, "comment_id": 99141784, "body": "Thanks for the help! :) It works! I&#39;ll check more details about that method. :)"}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 2, "last_activity_date": 1558547850, "creation_date": 1558547850, "answer_id": 56262490, "question_id": 56262313, "link": "https://stackoverflow.com/questions/56262313/creating-stdvectorclass-with-calling-class-constructor-later-on/56262490#56262490", "title": "Creating std::vector&lt;Class&gt; with calling Class constructor later on", "body": "<p>As the comments above indicate, you can replace:</p>\n\n<pre><code>for (int i = 0; i &lt; size; ++i)\n    this-&gt;attribute[i] = new ExtClass();\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>for (int i = 0; i &lt; size; ++i)\n    this-&gt;attribute.emplace_back ();\n</code></pre>\n\n<p>Your vector will then manage the lifetimes of your <code>ExtClass</code> objects for you.</p>\n"}], "owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56262437, "answer_count": 2, "score": 1, "last_activity_date": 1558548342, "creation_date": 1558547125, "question_id": 56262313, "link": "https://stackoverflow.com/questions/56262313/creating-stdvectorclass-with-calling-class-constructor-later-on", "title": "Creating std::vector&lt;Class&gt; with calling Class constructor later on", "body": "<p>I've been googling and stackoverflowing this question, but couldn't find any answer.</p>\n\n<p>The thing I am trying to do is create a vector with a custom class, which I have no problem with. I understand I need to do:</p>\n\n<pre><code>std::vector&lt;ExtClass&gt; varName;\n</code></pre>\n\n<p>But, what I want to do is this:</p>\n\n<p>Since varName is now of type ExtClass, I want to call it's constructor in another class. To clarify, I think the code will explain this the best:</p>\n\n<pre><code>class ExtClass {\n    public:\n        int ext;\n        int pet;\n\n    ExtClass();\n};\n\nExtClass:ExtClass() {\n    this-&gt;ext = std::rand();\n    this-&gt;pet = std::rand();\n}\n\n________________________\n\nclass MainClass {\n    public:\n        std::vector&lt;ExtClass&gt; attribute;\n\n    MainClass(int);\n}\n\nMainClass(int size) {\n    this-&gt;attribute.reserve(size) // reserving enough places in vector\n    for (int i = 0; i &lt; size; ++i)\n        this-&gt;attribute[i] = new ExtClass(); // problem\n}\n</code></pre>\n\n<p>I have used all public members to avoid unnecessary code.</p>\n\n<p>I thought since std::vector attribute is a vector of ExtClass elements, and since none have been defined, that I could assign each element of the vector as:</p>\n\n<pre><code>new ExtClass()\n</code></pre>\n\n<p>and that would create, for example:</p>\n\n<pre><code>attribute[0].ext = 5125;\nattribute[0].pet = 151;\n</code></pre>\n\n<p>This is definitely not the case and the compiler argues on this line with:</p>\n\n<pre><code>note: candidate: constexpr ExtClass&amp; ExtClass::operator=(const ExtClass&amp;)\nclass ExtClass {\n      ^~~~~~\nnote:   no known conversion for argument 1 from \u2018ExtClass*\u2019 to \u2018const ExtClass&amp;\u2019\nnote: candidate: constexpr ExtClass&amp; ExtClass::operator=(ExtClass&amp;&amp;)\nnote:   no known conversion for argument 1 from \u2018ExtClass*\u2019 to \u2018ExtClass&amp;&amp;\u2019\n</code></pre>\n\n<p>I am not an expert in C++, but relatively new to it and I am practicing. Can you tell me what is my mistake? What assumption did I make wrong?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "multithreading"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 6, "creation_date": 1558546885, "post_id": 56262226, "comment_id": 99141004, "body": "&quot;I believe it will - but it is not thread safe and data corruption can happen&quot; -- yeah, that pretty much sums It up."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 2, "creation_date": 1558547022, "post_id": 56262226, "comment_id": 99141045, "body": "As a rule of thumb : each thread can only access it&#39;s own memory, unless you&#39;re using a synchronization mecanism. Outside of that, it &quot;may&quot; work, but in fact, it does not."}, {"owner": {"reputation": 721, "user_id": 410719, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8a002e3ee026eb6964c04f50cf5293c3?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/410719/sean"}, "reply_to_user": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 0, "creation_date": 1558547507, "post_id": 56262226, "comment_id": 99141256, "body": "@MartinV&#233;ronneau But globals are stored in Heap, and all threads can access heap. What bothers me really is : t2 is launched by t1 which has exited - so whether the subsequent updates to myInt will lead to a problem of variable life time. other than that what synch mechanisms are applicable here . if you could help a bit - it would be awesome"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1558547635, "post_id": 56262226, "comment_id": 99141300, "body": "@Sean First, I&#39;d strongly recommend pretending <code>detach</code> doesn&#39;t exist. You&#39;ll inevitably come to regret it&#39;s use outside of the most trivial use cases."}, {"owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "edited": false, "score": 1, "creation_date": 1558547722, "post_id": 56262226, "comment_id": 99141331, "body": "@Sean &quot;all threads can access heap&quot; -&gt; They do, but without synchronization it will become a huge mess. Where each thread is launched doesn&#39;t really matter."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558547736, "post_id": 56262226, "comment_id": 99141338, "body": "@Sean It&#39;s hard to say for sure if there is a problem with how <code>myInt</code> is used, as that use is not shown. What&#39;s clear is that there is a race on <code>firsttime</code>. Any number of <code>t1</code>s could be trying to read it or may have already evaluated it to be <code>true</code> by the time the first one gets to <code>firsttime = false;</code>."}, {"owner": {"reputation": 721, "user_id": 410719, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8a002e3ee026eb6964c04f50cf5293c3?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/410719/sean"}, "edited": false, "score": 0, "creation_date": 1558547814, "post_id": 56262226, "comment_id": 99141377, "body": "I have to. there seems to be no other way to recall launchthread - the SDK forces to call launchthread (it await data on serial and when it is present it calls launchthread and detaches it automatically. I can supply a new definition of launchthread but that is it - and i cant keep launchthread running infinitely)"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558547986, "post_id": 56262226, "comment_id": 99141459, "body": "@Sean I&#39;m not sure I understand the constraint, but it sounds like you&#39;re sure. But it seems like quite a terribly designed SDK, if you want my opinion. Be sure you don&#39;t have any other viable alternative, such a library may be more trouble than it&#39;s worth."}, {"owner": {"reputation": 721, "user_id": 410719, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8a002e3ee026eb6964c04f50cf5293c3?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/410719/sean"}, "edited": false, "score": 0, "creation_date": 1558548040, "post_id": 56262226, "comment_id": 99141476, "body": "sadly, that is the only one i have from the manufacturer of an external hardware, and yes i concur - it&#39;s terrible"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558548116, "post_id": 56262226, "comment_id": 99141500, "body": "@Sean Other than synchronizing <code>firstTime</code> (you could just use an <code>std::atomic</code> for that) it would be helpful to show what you intend to do with <code>myInt</code> if you want a constructive answer."}, {"owner": {"reputation": 721, "user_id": 410719, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8a002e3ee026eb6964c04f50cf5293c3?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/410719/sean"}, "edited": false, "score": 0, "creation_date": 1558548280, "post_id": 56262226, "comment_id": 99141574, "body": "Some edit added. does that help?"}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 1, "creation_date": 1558548981, "post_id": 56262226, "comment_id": 99141889, "body": "You may wish to look at that article that is very well made : <a href=\"https://www.codeproject.com/Articles/598695/Cplusplus11-threads-locks-and-condition-variables\" rel=\"nofollow noreferrer\">codeproject.com/Articles/598695/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4783, "user_id": 3854787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WRLaI.jpg?s=128&g=1", "display_name": "C&#225;ssio Renan", "link": "https://stackoverflow.com/users/3854787/c%c3%a1ssio-renan"}, "is_accepted": false, "score": 2, "last_activity_date": 1559146747, "last_edit_date": 1559146747, "creation_date": 1558549396, "answer_id": 56262834, "question_id": 56262226, "link": "https://stackoverflow.com/questions/56262226/c-thread-from-thread/56262834#56262834", "title": "C++ thread from thread", "body": "<h2>About the lifetime of <code>myInt</code> and <code>firsttime</code></h2>\n\n<p>The lifetime of both <code>myInt</code> and <code>firstime</code> will start before <code>main()</code> runs, and end after <code>main()</code> returns. Neither <code>launchThread</code> nor <code>doThings</code> manage the lifetime of any variables (except for <code>t2</code>, which is detached anyway, so it shouldn't matter).</p>\n\n<p>Whether a thread was started by the main thread, or by any other thread, doesn't have any relevance. Once a thread starts, and specially when it is detached, it is basically independent: It has no relation to the other threads running in the program.</p>\n\n<h2>Thou shalt not access shared memory without synchronization</h2>\n\n<p>But yes, you will run into problems. <code>myInt</code> is shared between multiple threads, so you have to synchronize acesses to it. If you don't, you will eventually run into undefined behavior caused by simultaneous access to shared memory. The simplest way to synchronize <code>myInt</code> is to make it into an <a href=\"https://en.cppreference.com/w/cpp/atomic/atomic\" rel=\"nofollow noreferrer\">atomic</a>.</p>\n\n<p>I'm assuming only one thread is running <code>launchThread</code> at each given time. Looking at your example, though, that may be not the case. If it is not, you also need to synchronize <code>firsttime</code>.</p>\n\n<h2>Alternatives</h2>\n\n<p>However, your <code>myInt</code> looks a lot like a <a href=\"https://en.cppreference.com/w/cpp/thread/condition_variable\" rel=\"nofollow noreferrer\">Condition Variable</a>. Maybe you want to have <code>doThings</code> be blocked until your condition (<code>myInt &gt; 200</code>) is fulfilled. An <code>std::condition_variable</code> will help you with that. This will avoid a <a href=\"https://en.wikipedia.org/wiki/Busy_waiting\" rel=\"nofollow noreferrer\">busy wait</a> and save your processor some cycles. Some kind of event system using <a href=\"https://en.wikipedia.org/wiki/Message_queue\" rel=\"nofollow noreferrer\">Message Queues</a> can also help you with that, and it will even make your program cleaner and easier to maintain.</p>\n\n<hr>\n\n<p>Following is a small example on using condition variables and atomics to synchronize your threads. I've tried to keep it simple, so there's still some improvements to be made here. I leave those to your discretion.</p>\n\n<pre><code>#include &lt;atomic&gt;\n#include &lt;condition_variable&gt;\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\nstd::mutex cv_m; // This mutex will be used both for myInt and cv.\nstd::condition_variable cv;\nint myInt = 10; // myInt is already protected by the mutex, so there's not need for it to be an atomic.\n\nstd::atomic&lt;bool&gt; firstTime{true}; // firstTime does need to be an atomic, because it may be accessed by multiple threads, and is not protected by a mutex.\n\nvoid dothings(){\n    while(true) {\n      // std::condition_variable only works with std::unique_lock.\n      std::unique_lock&lt;std::mutex&gt; lock(cv_m);\n\n      // This will do the same job of your while(myInt &gt; 200).\n      // The difference is that it will only check the condition when\n      // it is notified that the value has changed.\n      cv.wait(lock, [](){return myInt &gt; 200;});\n\n      // Note that the lock is reaquired after waking up from the wait(), so it is safe to read and modify myInt here.\n      std::cout &lt;&lt; \"Alert! (\" &lt;&lt; myInt &lt;&lt; \")\\n\";\n      myInt -= 40; // I'm making myInt fall out of the range here. Otherwise, we would get multiple alerts after the condition (since it would be now true forever), and it wouldn't be as interesting.\n    }\n}\n\nvoid launchThread() { \n    // Both the read and the write to firstTime need to be a single atomic operation.\n    // Otherwise, two or more threads could read the value as \"true\", and assume this is the first time entering this function.\n    if (firstTime.exchange(false)) {\n      std::thread t2(dothings); \n      t2.detach();\n    } else {\n      {\n        std::lock_guard&lt;std::mutex&gt; lock(cv_m);\n        myInt += 50;\n      }\n      // Value of myInt has changed. Notify all waiting threads.\n      cv.notify_all();\n    }\n    return;\n}\n\nint main() {\n    for (int i = 0; i &lt; 6; ++i) { // I'm making this a for loop just so I can be sure the program exits\n        std::thread t1(launchThread);\n        t1.detach();\n    }\n\n    // We sleep only to wait for anything to be printed. Your program has an infinite loop on main() already, so you don't have this problem.\n    std::this_thread::sleep_for(std::chrono::milliseconds(10));\n}\n</code></pre>\n\n<h3><a href=\"http://coliru.stacked-crooked.com/a/dcbe17c1cc6fc241\" rel=\"nofollow noreferrer\">See it live on Coliru!</a></h3>\n"}], "owner": {"reputation": 721, "user_id": 410719, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8a002e3ee026eb6964c04f50cf5293c3?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/410719/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559146747, "creation_date": 1558546715, "last_edit_date": 1558548242, "question_id": 56262226, "link": "https://stackoverflow.com/questions/56262226/c-thread-from-thread", "title": "C++ thread from thread", "body": "<p>Please consider this code:</p>\n\n<pre><code>#include &lt;stdio&gt;\n\nint myInt = 10;\nbool firstTime = true;\n\nvoid dothings(){ \n    /*repeatedly check for myInt here*/ \n    while(true) {\n        if(myInt &gt; 200) { /*send an alert to a socket*/}\n    }\n}\nvoid launchThread() { \n    if (firsttime) {\n        std::thread t2(dothings); \n        t2.detach();\n        firsttime = false;\n    } else {\n    /* update myInt with some value here*/\n    }\n    return;\n}\nint main() {\n\n    /* sleep for 4 seconds */\n    while(true) {\n        std::thread t1(launchThread);\n        t1.detach();\n    }\n} \n</code></pre>\n\n<p>I have to call <code>launchthread</code> - there is no other way around to update a value or to start the thread <code>t2</code> - this is how a third party SDK is designed.</p>\n\n<p>Note that <code>launchThread</code> is exiting first. Main will keep on looping.</p>\n\n<p>To my understanding, however, <code>dothings()</code> will continue to run. </p>\n\n<p>My question is - can <code>dothings</code> still access the newly updated values of <code>myInt</code> after subsequent calls of <code>launchThread</code> from main? </p>\n\n<p>I can't find a definite answer on google - but I believe it will - but it is not thread safe and data corruption can happen. But may be experts here can correct me. Thank you.</p>\n"}, {"tags": ["c++", "c", "shared-libraries", "static-libraries"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558546190, "post_id": 56262079, "comment_id": 99140728, "body": "You need headers to see the declarations, a static stub library for the linker, and a dynamic library that can be accessed and loaded at runtime."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1558548303, "post_id": 56262079, "comment_id": 99141581, "body": "Short answer: Yes (and for both dynamic and static libraries)."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1558548435, "post_id": 56262079, "comment_id": 99141643, "body": "Your conclusion is almost correct. The compiler uses the declarations in .h to set up the calling structure, but you if you know them you can simply declare them yourself. :-)... Now when the compiler outputs the .o for a .c or a .cc you still have stubs (except the call stack for function calls is relatively okay). When the linker gets invoked, all .o and .a and even the .so (dynamic linking at runtime) resolve the &quot;relative addresses&quot; to actual addresses in memory of the final &quot;linked executable&quot; as it&#39;s loaded by the kernel upon <code>exec</code> using symbol lookups and other techniques."}, {"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1558548508, "post_id": 56262079, "comment_id": 99141675, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 a static stub library is as far as I know only needed on windows."}, {"owner": {"reputation": 471, "user_id": 2678241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/us5mu.png?s=128&g=1", "display_name": "Dimitris Pantelis", "link": "https://stackoverflow.com/users/2678241/dimitris-pantelis"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1558602507, "post_id": 56262079, "comment_id": 99158373, "body": "@AhmedMasud thanks for the clear explanation. It was very useful :)"}], "owner": {"reputation": 471, "user_id": 2678241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/us5mu.png?s=128&g=1", "display_name": "Dimitris Pantelis", "link": "https://stackoverflow.com/users/2678241/dimitris-pantelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1558546350, "answer_count": 0, "score": 0, "last_activity_date": 1558546102, "creation_date": 1558546102, "question_id": 56262079, "link": "https://stackoverflow.com/questions/56262079/to-use-shared-libraries-in-c-c-both-the-h-and-so-files-are-needed", "closed_reason": "Duplicate", "title": "To use shared libraries in C/C++, both the .h and .so files are needed?", "body": "<p>I have seen the answer to my question heavily implied but have not seen it somewhere written, hence I am making these questions (just to be sure I am correct).</p>\n\n<p>To use a shared library in a C/C++ program you need both the <strong>.h file</strong> and the <strong>.so file</strong>? (if I understand correctly, the compiler needs the .h file and the linker needs the .so file)</p>\n\n<p>As a bonus question, is this true for static (.a) libraries?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558546024, "post_id": 56262029, "comment_id": 99140645, "body": "That depends on the allocator class used in the underlying container."}, {"owner": {"reputation": 2273, "user_id": 1737197, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8cf36a1db2987797cfe1be2cb75fa510?s=128&d=identicon&r=PG", "display_name": "debonair", "link": "https://stackoverflow.com/users/1737197/debonair"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1558546589, "post_id": 56262029, "comment_id": 99140887, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 how about <code>std::queue&lt;int&gt;</code> ?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1558551130, "post_id": 56262029, "comment_id": 99142848, "body": "@debonair -- Try to implement <code>std::queue</code> yourself.  You will quickly see that the only practical way to implement it is to use <code>new</code> or some sort of dynamic memory allocation to maintain the data structure."}], "answers": [{"tags": [], "owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "is_accepted": false, "score": 1, "last_activity_date": 1558547165, "creation_date": 1558547165, "answer_id": 56262322, "question_id": 56262029, "link": "https://stackoverflow.com/questions/56262029/memory-for-stdqueue-allocated-on-heap-or-stack/56262322#56262322", "title": "Memory for std::queue allocated on heap or stack", "body": "<p>If no alternative <code>allocator</code> or <code>container</code> was provided: the free store because it uses a <code>std::deque</code></p>\n"}, {"tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 0, "last_activity_date": 1558547378, "creation_date": 1558547378, "answer_id": 56262377, "question_id": 56262029, "link": "https://stackoverflow.com/questions/56262029/memory-for-stdqueue-allocated-on-heap-or-stack/56262377#56262377", "title": "Memory for std::queue allocated on heap or stack", "body": "<p>All standard containers use an Allocator object for their memory management needs. By default, unless you provide your own, they use <a href=\"https://en.cppreference.com/w/cpp/memory/allocator\" rel=\"nofollow noreferrer\"><code>std::allocator</code></a>. This includes <code>std::deque&lt;T&gt;</code>, which is what a <code>std::queue&lt;T&gt;</code> uses. <code>std::allocator</code> uses the free store (the memory space used by <code>new</code> and <code>delete</code>) which is where the elements of your <code>std::queue</code> will be created.</p>\n\n<p><code>std::deque</code> and pretty much every other standard type that uses dynamically allocated objects manage that memory internally, using pointers that are not usually visible to their user. It's not because you didn't dynamically allocate an object that that object can't internally dynamically allocate memory for it's own purposes.</p>\n"}], "owner": {"reputation": 2273, "user_id": 1737197, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8cf36a1db2987797cfe1be2cb75fa510?s=128&d=identicon&r=PG", "display_name": "debonair", "link": "https://stackoverflow.com/users/1737197/debonair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "accepted_answer_id": 56262377, "answer_count": 2, "score": 0, "last_activity_date": 1558547378, "creation_date": 1558545786, "question_id": 56262029, "link": "https://stackoverflow.com/questions/56262029/memory-for-stdqueue-allocated-on-heap-or-stack", "title": "Memory for std::queue allocated on heap or stack", "body": "<p>If I use <code>std::queue&lt;ClassA&gt; my_queue</code>, where is the memory allocated for the objects inside queue? If I don't use pointers for objects to be stored in queue, will it still allocate on heap?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1558559140, "post_id": 56261810, "comment_id": 99146339, "body": "I recommend reading about <code>switch</code> and <code>case</code> statements.  The <code>switch</code> and <code>case</code> are good for processing menu selections (more readable IMHO)."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1558559192, "post_id": 56261810, "comment_id": 99146358, "body": "What are the results after you used a debugger?  Which statements are causing the issue?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 11509346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0319a8f6eb7932ce826404f72f92d?s=128&d=identicon&r=PG&f=1", "display_name": "Jacked", "link": "https://stackoverflow.com/users/11509346/jacked"}, "is_accepted": false, "score": 0, "last_activity_date": 1558590195, "creation_date": 1558590195, "answer_id": 56268715, "question_id": 56261810, "link": "https://stackoverflow.com/questions/56261810/the-output-is-not-right-when-the-number-of-rows-and-columns-do-not-match/56268715#56268715", "title": "The output is not right when the number of rows and columns do not match", "body": "<p>Now i do not get the error anymore</p>\n\n<p>{</p>\n\n<pre><code>// Variable Declaration\n    int num1 = 0, num2 = 0, choice = 0, A[10][20], B[10][20], n = 0, x = 0;\n\n    for (int k = 0; choice != 7; k++)\n    {\n        // Function Call\n        showcases();\n\n        // Input Choice Number\n        cin &gt;&gt; choice;\n\n        cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl;\n\n        // Output Choice &amp; Function Call\n        if (choice == 1)\n        {\n            input_element(A, num1, num2);\n        }\n        else if (choice == 2)\n        {\n            display_matrix(A, num1, num2);\n        }\n        else if (choice == 3)\n        {\n            sum(A, num1, num2);\n        }\n        else if (choice == 4)\n        {\n            row_sum(A, num1, num2);\n        }\n        else if (choice == 5)\n        {\n            col_sum(A, num1, num2);\n        }\n        else if (choice == 6)\n        {\n            cout &lt;&lt; \"The transpose of the matrix is: \" &lt;&lt; endl;\n            transp(A, num1, num2);\n            cout &lt;&lt; endl;\n        }\n        else if (choice == 7)\n        {\n            cout &lt;&lt; \"The application will exit now!!\" &lt;&lt; endl;\n        }\n        else\n        {\n            cout &lt;&lt; \"Your choice is invalid\" &lt;&lt; endl;\n        }\n\n        cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl;\n    }\n\n    // Exit\n    system(\"pause\");\n    return 0;\n}\n\n// Input Function\nvoid input_element(int A[][20], int&amp; m, int&amp; n)\n{\n    cout &lt;&lt; \"Enter  number of rows for matrix: \";\n    cin &gt;&gt; m;\n    cout &lt;&lt; \"Enter number of columns for matrix: \";\n    cin &gt;&gt; n;\n\n    cout &lt;&lt; endl;\n\n    for (int i = 0; i &lt; m; i++)\n    {\n        for (int j = 0; j &lt; n; j++)\n        {\n            cout &lt;&lt; \"Enter elements of matrix \" &lt;&lt; \"[\" &lt;&lt; i + 1 &lt;&lt; \"]\" &lt;&lt; \" [\" &lt;&lt; j + 1 &lt;&lt; \"]: \";\n            cin &gt;&gt; A[i][j];\n        }\n    }\n}\n\n// Dispaly Matrix Function\nvoid display_matrix(int A[][20], int&amp; m, int&amp; n)\n{\n    for (int i = 0; i &lt; m; i++)\n    {\n        cout &lt;&lt; \"[\";\n        for (int j = 0; j &lt; n; j++)\n        {\n            cout &lt;&lt; A[i][j];\n\n            if (j != n - 1)\n                cout &lt;&lt; \" \";\n            else if (j == n - 1)\n                cout &lt;&lt; \"]\";\n        }\n        cout &lt;&lt; endl;\n    }\n}\n\n// Sum Function\nvoid sum(int A[][20], int&amp; m, int&amp; n)\n{\n    int sum = 0;\n\n    for (int row = 0; row &lt; m; row++)\n    {\n        for (int column = 0; column &lt; n; column++)\n        {\n            sum += A[row][column];\n        }\n    }\n\n    cout &lt;&lt; \"Matrix Elements Sum = \" &lt;&lt; sum &lt;&lt; endl;\n}\n\n// Row Sum Function\nvoid row_sum(int A[][20], int&amp; m, int&amp; n)\n{\n    cout &lt;&lt; \"The sum of the matrix rows are the following: -\\n\";\n\n    int row_sum = 0;\n\n    for (int i = 0; i &lt; m; i++)\n    {\n        row_sum = 0;\n\n        for (int j = 0; j &lt; n; j++)\n        {\n            row_sum += A[i][j];\n        }\n\n        cout &lt;&lt; \"R\" &lt;&lt; i + 1 &lt;&lt; \" Sum = \" &lt;&lt; row_sum &lt;&lt; endl;\n    }\n\n    return;\n}\n\n// Column Sum Function\nvoid col_sum(int A[][20], int&amp; m, int&amp; n)\n{\n    cout &lt;&lt; \"The sum of the matrix columns are the following : -\\n\";\n\n    int col_sum = 0;\n\n    for (int j = 0; j &lt; n; j++)\n    {\n        col_sum = 0;\n\n        for (int i = 0; i &lt; m; i++)\n        {\n            col_sum += A[i][j];\n        }\n\n        cout &lt;&lt; \"C\" &lt;&lt; j + 1 &lt;&lt; \" Sum = \" &lt;&lt; col_sum &lt;&lt; endl;\n    }\n\n    return;\n}\n\n// Transpose Function\nvoid transp(int A[][20], int&amp; m, int&amp; n)\n{\n    for (int j = 0; j &lt; n; j++)\n    {\n        cout &lt;&lt; \"[\";\n\n        for (int i = 0; i &lt; m; i++)\n        {\n            cout &lt;&lt; A[i][j];\n\n            if (i != (m - 1))\n            {\n                cout &lt;&lt; \" \";\n            }\n            else if (i == (m - 1))\n            {\n                cout &lt;&lt; \"]\";\n            }\n        }\n\n        cout &lt;&lt; endl;\n    }\n}\n\n// Showcase Menu Function\nvoid showcases()\n{\n    cout &lt;&lt; \"Menu\" &lt;&lt; endl;\n    cout &lt;&lt; \"1. Input Elements\" &lt;&lt; endl;\n    cout &lt;&lt; \"2. Display Matrix\" &lt;&lt; endl;\n    cout &lt;&lt; \"3. Sum Of Matrix Elements\" &lt;&lt; endl;\n    cout &lt;&lt; \"4. Sum Of Matrix Rows\" &lt;&lt; endl;\n    cout &lt;&lt; \"5. Sum Of Matrix Columns\" &lt;&lt; endl;\n    cout &lt;&lt; \"6. Transpose Of Matrix\" &lt;&lt; endl;\n    cout &lt;&lt; \"7. Exit\" &lt;&lt; endl;\n    cout &lt;&lt; \"Choose among the options above: \";\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11509346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0319a8f6eb7932ce826404f72f92d?s=128&d=identicon&r=PG&f=1", "display_name": "Jacked", "link": "https://stackoverflow.com/users/11509346/jacked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1558590195, "creation_date": 1558544658, "last_edit_date": 1558544701, "question_id": 56261810, "link": "https://stackoverflow.com/questions/56261810/the-output-is-not-right-when-the-number-of-rows-and-columns-do-not-match", "title": "The output is not right when the number of rows and columns do not match", "body": "<p>The col-sum and tranpose functions work perfectly fine when i the numbers of rows and columns match but then it does not work when one differs from another</p>\n\n<pre><code>        #include&lt;iostream&gt;\n        using namespace std;\n\n        // protype\n        void showcases();\n        void accept(int Array[][40], int&amp; a, int&amp; b);\n        void outputs(int Array[][40], int&amp; a, int&amp; b);\n        int sum(int Array[][40], int&amp; a, int&amp; b);\n        void row_sum(int Array[][40], int&amp; a, int&amp; b);\n        void col_sum(int Array[][40], int&amp; a, int&amp; b); /// something wrong with this function. test it.\n        void transposed(int Array[][40], int&amp; a, int&amp; b); /// something wrong with this function. test it.\n\n\n        int main()\n        {\n            // variable declaration\n            int a = 0, b = 0, choice = 0, A[20][40], n = 0, x = 0, y = 0, z = 0;\n\n            // For loop execution\n            for (int k = 0; choice != 7; k++)\n            {\n                //To showcase the given options \n                showcases();\n\n                //input the user choice\n                cin &gt;&gt; choice;\n\n                cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl;\n\n                /// if else ? you don't like them? + the unreasonable empty lines between the ifs\n                //To perform a certain operation when a number is selected\n                if (choice == 1)\n                {\n                    accept(A, a, b);\n                    cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl; /// remove this\n                }\n                else if (choice == 2)\n                {\n                    outputs(A, a, b);\n                    cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl; /// remove this\n                }\n                else if (choice == 3)\n                {\n                    cout &lt;&lt; \"Matrix elements sum = \" &lt;&lt; sum(A, a, b) &lt;&lt; endl;\n                    cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl; /// remove this\n                }\n                else if (choice == 4)\n                {\n                    cout &lt;&lt; \"The sum of matrix rows are as following: -\" &lt;&lt; endl;\n                    row_sum(A, a, b);\n                    cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl; /// remove this\n                }\n                else if (choice == 5)\n                {\n                    cout &lt;&lt; \"The sum of matrix rows are as following: -\" &lt;&lt; endl;\n                    col_sum(A, a, b);\n                    cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl; /// remove this\n                }\n                else if (choice == 6)\n                {\n                    cout &lt;&lt; \"The transpose of the Matrix: \" &lt;&lt; endl;\n                    transposed(A, a, b);\n                    cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl; /// remove this\n                }\n                else if (choice == 7)\n                {\n                    cout &lt;&lt; \"The application will exit now!!\" &lt;&lt; endl;\n                    cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl; /// remove this\n                    return -1; /// remvoe this\n                }\n                else if (choice &gt;= 8 || choice &lt;= 0)\n                {\n                    cout &lt;&lt; \"Your choice is invalid\" &lt;&lt; endl;\n                    cout &lt;&lt; \"----------------------------------------------\" &lt;&lt; endl &lt;&lt; endl;\n                }\n                /// add something here. figure it out\n\n                /// add something here. figure it out\n            }\n\n            /// add something here. figure it out\n            system(\"pause\");\n            return 0;\n        }\n\n        // To input the elements \n        void accept(int Array[][40], int&amp; a, int&amp; b)\n        {\n            cout &lt;&lt; \"Enter  number of rows for matrix: \";\n            cin &gt;&gt; a;\n            cout &lt;&lt; \"Enter number of columns for matrix: \";\n            cin &gt;&gt; b;\n\n            cout &lt;&lt; endl;\n\n            for (int i = 0; i &lt; a; i++)\n            {\n                for (int j = 0; j &lt; b; j++)\n                {\n                    cout &lt;&lt; \"Enter elements of matrix \" &lt;&lt; \"[\" &lt;&lt; i + 1 &lt;&lt; \"]\" &lt;&lt; \" [\" &lt;&lt; j + 1 &lt;&lt; \"]: \";\n                    cin &gt;&gt; Array[i][j];\n                }\n            }\n        }\n\n        // TO output the elements \n        void outputs(int Array[][40], int&amp; a, int&amp; b)\n        {\n            for (int i = 0; i &lt; a; i++)\n            {\n                cout &lt;&lt; \"[\";\n                for (int j = 0; j &lt; b; j++)\n                {\n                    cout &lt;&lt; Array[i][j];\n\n                    if (j != b - 1)\n                        cout &lt;&lt; \" \";\n\n                    else if (j == b - 1)\n                        cout &lt;&lt; \"]\";\n                }\n                cout &lt;&lt; endl;\n            }\n        }\n\n        // To find the total sum \n        int sum(int Array[][40], int&amp; a, int&amp; b)\n        {\n            int s = 0, i, j;\n            for (i = 0; i &lt; a; i++)\n            {\n                for (j = 0; j &lt; b; j++)\n                {\n                    s += Array[i][j];\n                }\n            }\n            return s;\n        }\n\n        // To find the row sum\n        void row_sum(int Array[][40], int&amp; a, int&amp; b)\n        {\n            int row_s = 0;\n            for (int i = 0; i &lt; a; i++)\n            {\n                for (int j = 0; j &lt; b; j++)\n                {\n                    row_s += Array[i][j];\n                }\n                cout &lt;&lt; \"R\" &lt;&lt; i + 1 &lt;&lt; \" Sum\" &lt;&lt; \" = \" &lt;&lt; row_s;\n                row_s = 0;\n                cout &lt;&lt; endl;\n            }\n            return;\n        }\n\n        // To find the column sum \n        void col_sum(int Array[][40], int&amp; a, int&amp; b)\n        {\n            int col_s = 0;\n            for (int i = 0; i &lt; a; i++)\n            {\n                for (int j = 0; j &lt; b; j++)\n                {\n                    col_s += Array[j][i];\n                }\n                cout &lt;&lt; \"C\" &lt;&lt; i + 1 &lt;&lt; \" Sum\" &lt;&lt; \" = \" &lt;&lt; col_s;\n                col_s = 0;\n                cout &lt;&lt; endl;\n            }\n            return;\n        }\n\n        // To transpose (To change the elements of rows and columns) the matrix \n        void transposed(int Array[][40], int&amp; a, int&amp; b)\n        {\n            for (int i = 0; i &lt; a; i++)\n            {\n                cout &lt;&lt; \"[\";\n                for (int j = 0; j &lt; b; j++)\n                {\n                    cout &lt;&lt; Array[j][i];\n\n                    if (j != b - 1)\n                        cout &lt;&lt; \" \";\n\n                    else if (j == b - 1)\n                        cout &lt;&lt; \"]\";\n                }\n                cout &lt;&lt; endl;\n            }\n            return;\n        }\n\n        // To display (To showcase) the available choiced \n        void showcases()\n        {\n            cout &lt;&lt; \"Menu\" &lt;&lt; endl;\n            cout &lt;&lt; \"1. input elements\" &lt;&lt; endl;\n            cout &lt;&lt; \"2. Display matrix\" &lt;&lt; endl;\n            cout &lt;&lt; \"3. Sum of matrix elements\" &lt;&lt; endl;\n            cout &lt;&lt; \"4. Sum of matrix rows\" &lt;&lt; endl;\n            cout &lt;&lt; \"5. Sum of matrix columns\" &lt;&lt; endl;\n            cout &lt;&lt; \"6. The transpose of elements\" &lt;&lt; endl;\n            cout &lt;&lt; \"7. Exit\" &lt;&lt; endl;\n            cout &lt;&lt; \"Choose among the options above: \";\n        }\n\n\n    when both the number of rows and columns are 3 this is my output when i select 2 to display the elements\n\n\n[1 2 3]\n[4 5 6]\n[6 7 8]\n\nand after transpose this is the new matrix\n[1 4 6]\n[2 5 7]\n[3 6 8]\n\nand col sum works fine\nC1 Sum = 11\nC2 Sum = 14\nC3 Sum = 17\n\nbut if number of rows and columns differ this is the output \nEg:  no of rows:4\n no of columns: 3\n\noutput after asking to display the output\n[1 2 3]\n[4 5 6]\n[7 8 9]\n[0 2 4]\n\noutput after the transpose\n[1 4 7]\n[2 5 8]\n[3 6 9]\n[-858993460 -858993460 -858993460]\n\nsum of columns\nC1 Sum = 12\nC2 Sum = 15\nC3 Sum = 18\nC4 Sum = 1717986916\n</code></pre>\n\n<p>Any help is appreciated sorry if the format is wrong it was not letting me upload and it keep telling me either my code is not formmated or your post is mostly code</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558542191, "post_id": 56261171, "comment_id": 99138962, "body": "I am not fully sure to understand your question, but I think to use combined expressions, you&#39;ll need to use them in a tree (AST)."}], "answers": [{"comments": [{"owner": {"reputation": 4762, "user_id": 411768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68c7cc0d48dc36878142557289acbd02?s=128&d=identicon&r=PG", "display_name": "shuhalo", "link": "https://stackoverflow.com/users/411768/shuhalo"}, "edited": false, "score": 0, "creation_date": 1568702588, "post_id": 56261472, "comment_id": 102347593, "body": "This will cause deep copies when the expressions are not mere constants anymore, right?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 4762, "user_id": 411768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68c7cc0d48dc36878142557289acbd02?s=128&d=identicon&r=PG", "display_name": "shuhalo", "link": "https://stackoverflow.com/users/411768/shuhalo"}, "edited": false, "score": 0, "creation_date": 1568727260, "post_id": 56261472, "comment_id": 102360512, "body": "@shuhalo depends. Most of the time, expression template hardly contain anything. A reference is usually much more heavy than a reference to an object. So in a sense it&#39;s even faster to copy than to copy a pointer (passing by reference)"}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 2, "last_activity_date": 1558543151, "creation_date": 1558543151, "answer_id": 56261472, "question_id": 56261171, "link": "https://stackoverflow.com/questions/56261171/c-expression-templates-lifetime/56261472#56261472", "title": "C++ expression templates lifetime", "body": "<p>Instead of storing reference here:</p>\n\n<pre><code>template&lt;typename E1, typename E2&gt;\nclass ExpressionSum : public Expression&lt;ExpressionSum&lt;E1,E2&gt;&gt; {\n    E1 const&amp; u_; // &lt;------| These are references\n    E2 const&amp; v_; // &lt;------|\npublic:\n    ExpressionSum(E1 const&amp; u, E2 const&amp; v) : u_(u), v_(v)\n    { }\n\n    // ...\n};\n</code></pre>\n\n<p>These does not cause lifetime extension. The wikipedia article assume the expression template is never stored and only live in the same statement as the expression.</p>\n\n<p>Store them as value:</p>\n\n<pre><code>template&lt;typename E1, typename E2&gt;\nclass ExpressionSum : public Expression&lt;ExpressionSum&lt;E1,E2&gt;&gt; {\n    E1 u_; // &lt;------| Fixed!\n    E2 v_; // &lt;------|\npublic:\n    ExpressionSum(E1 const&amp; u, E2 const&amp; v) : u_(u), v_(v)\n    { }\n\n    // ...\n};\n</code></pre>\n\n<p>You can also extend <code>std::tuple</code> to piggyback on it's EBO:</p>\n\n<pre><code>template&lt;typename E1, typename E2&gt;\nclass ExpressionSum : public Expression&lt;ExpressionSum&lt;E1,E2&gt;&gt;, private std::tuple&lt;E1, E2&gt; {\n    auto u_() const -&gt; E1 const&amp; { return std::get&lt;0&gt;(*this); }\n    auto v_() const -&gt; E2 const&amp; { return std::get&lt;1&gt;(*this); }\npublic:\n    ExpressionSum(E1 const&amp; u, E2 const&amp; v) : std::tuple&lt;E1, E2&gt;(u, v)\n    { }\n\n    // ...\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": -1, "last_activity_date": 1558543302, "creation_date": 1558543302, "answer_id": 56261503, "question_id": 56261171, "link": "https://stackoverflow.com/questions/56261171/c-expression-templates-lifetime/56261503#56261503", "title": "C++ expression templates lifetime", "body": "<p>Do not use <code>auto</code> with expression templates. If the smart people behind the <code>Eigen</code> library <a href=\"https://eigen.tuxfamily.org/dox-devel/TopicPitfalls.html\" rel=\"nofollow noreferrer\">can't make it work</a>, you don't really have a chance either.</p>\n\n<p>I mean, you can copy just about every value involved but that's generally the thing you want to avoid with expression templates.</p>\n"}, {"tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": false, "score": 4, "last_activity_date": 1558547788, "last_edit_date": 1558547788, "creation_date": 1558545083, "answer_id": 56261887, "question_id": 56261171, "link": "https://stackoverflow.com/questions/56261171/c-expression-templates-lifetime/56261887#56261887", "title": "C++ expression templates lifetime", "body": "<h2>Avoid CRTP: Use Argument-Dependent Lookup to simplify the library</h2>\n\n<p>We want to keep things as simple as possible. The Curiously Recurring Template Pattern (and it's relatives) are powerful tools, but they increase compile-times and are cumbersome when you want to expand what you're doing. </p>\n\n<p>By taking advantage of <a href=\"https://en.cppreference.com/w/cpp/language/adl\" rel=\"nofollow noreferrer\">argument dependent lookup</a>, we can implement operator overloading <em>without having a base class</em>. This greatly simplifies the design of the library. I'll explain more about this in the examples given below</p>\n\n<h3>Avoid lifetime issues: store subexpressions by value unless explicitly using <code>std::ref</code></h3>\n\n<p>We want to keep this library simple. An expression is either a constant, a unary operation and an input, or a binary operation and an input. There aren't any class invariants - the inputs can take on any value, and the operation itself is stored based on it's type, so it can only have 1 value. </p>\n\n<p>This means that we can represent expressions as <strong>aggregate types</strong>, making them trivially constructible, trivially copyable, trivially destructible, and reducing both compiletimes and the size of the resulting binary. </p>\n\n<pre><code>namespace expr // We need to put them in a namespace so we can use ADL\n{\n    template&lt;class Value&gt;\n    class Constant\n    {\n       public:\n        Value value;\n    };\n\n    template&lt;class Op, class Input&gt;\n    class UnaryOp\n    {\n       public:\n        Op op;\n        Input input; \n    };\n    template&lt;class Op, class Left, class Right&gt;\n    class BinaryOp\n    {\n       public:\n        Op op;\n        Left lhs;\n        Right rhs; \n    };\n}\n</code></pre>\n\n<h3>Simplify operator overloads: use namespace scoping</h3>\n\n<p>If we write the operator overloads in a namespace, <strong>they'll only be considered when working with types from that namespace</strong>. This means we can avoid having a base class, and we can use unconstrained templates. </p>\n\n<pre><code>namespace expr \n{\n    template&lt;class A&gt;\n    auto operator-(A const&amp; a)\n    {\n        return UnaryOp&lt;Negate, A&gt;{{}, a}; \n    }\n    template&lt;class A, class B&gt;\n    auto operator+(A const&amp; a, B const&amp; b) \n    {\n        return BinaryOp&lt;Plus, A, B&gt;{{}, a, b}; \n    }\n    template&lt;class A, class B&gt;\n    auto operator-(A const&amp; a, B const&amp; b) \n    {\n        return BinaryOp&lt;Minus, A, B&gt;{{}, a, b}; \n    }\n    template&lt;class A, class B&gt;\n    auto operator*(A const&amp; a, B const&amp; b) {\n        return BinaryOp&lt;Times, A, B&gt;{{}, a, b}; \n    }\n}\n</code></pre>\n\n<h3>Simplify evaluation: Operation types know how to evaluate their inputs</h3>\n\n<p>This is pretty simple to achieve - basically, any operation is a functor type that knows how to evaluate the inputs. In C++20, this can be achieved with lambdas, but for our purposes we'll just overload the <code>operator()</code>. </p>\n\n<pre><code>namespace expr {\n    class Negate {\n        template&lt;class A&gt;\n        constexpr auto operator()(A&amp;&amp; a) const \n            noexcept(noexcept(-a))\n            -&gt; decltype(-a)\n        {\n            return -a; \n        }\n    };\n    class Plus {\n    public:\n        template&lt;class A, class B&gt;\n        constexpr auto operator()(A&amp;&amp; a, B&amp;&amp; b) const\n            noexcept(noexcept(a + b))\n            -&gt; decltype(a + b) \n        {\n            return a + b; \n        }\n    };\n    class Minus {\n    public:\n        template&lt;class A, class B&gt;\n        constexpr auto operator()(A&amp;&amp; a, B&amp;&amp; b) const\n            noexcept(noexcept(a - b))\n            -&gt; decltype(a - b) \n        {\n            return a - b; \n        }\n    };\n    class Times {\n    public:\n        template&lt;class A, class B&gt;\n        constexpr auto operator()(A&amp;&amp; a, B&amp;&amp; b) const\n            noexcept(noexcept(a * b))\n            -&gt; decltype(a * b) \n        {\n            return a * b; \n        }\n    };\n}\n</code></pre>\n\n<h3>Take advantage of pattern-matching with namespace-scope <code>evaluate</code></h3>\n\n<p>Rather than having it as a member function, we can take advantage of pattern matching and recursion when writing an <code>evaluate</code> function at namespace scope. </p>\n\n<pre><code>namespace expr\n{\n    // This one is applied to things that aren't constants or expressions\n    template&lt;class Thing&gt;\n    auto evaluate(Thing const&amp; t) -&gt; Thing const&amp; {\n        return t; \n    }\n    template&lt;class Value&gt;\n    auto evaluate(Constant&lt;Value&gt; const&amp; value) {\n        return evaluate(value.value);\n    }\n    template&lt;class Op, class Input&gt;\n    auto evaluate(UnaryOp&lt;Op, Input&gt; const&amp; expr) {\n        return expr.op(evaluate(expr.value)); \n    }\n    template&lt;class Op, class LHS, class RHS&gt;\n    auto evaluate(BinaryOp&lt;Op, LHS, RHS&gt; const&amp; expr) {\n        return expr.op(evaluate(expr.lhs), evaluate(expr.rhs)); \n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 588, "user_id": 9759769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/103f6c140cd1a7b04c8b8d4c04a54370?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/9759769/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 1, "accepted_answer_id": 56261472, "answer_count": 3, "score": 6, "last_activity_date": 1558547788, "creation_date": 1558541977, "question_id": 56261171, "link": "https://stackoverflow.com/questions/56261171/c-expression-templates-lifetime", "title": "C++ expression templates lifetime", "body": "<p>I was looking at the example of expression templates at <a href=\"https://en.wikipedia.org/wiki/Expression_templates\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/Expression_templates</a>. Then I tried to make a simple symbolic expression tree, i.e. to add constants and variables like a + b + 10. So I started with</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n\ntemplate&lt;typename E&gt;\nclass Expression {\npublic:\n    std::ostream&amp; print(std::ostream&amp; os) const\n    {\n        return expression().print(os);\n    }\n    E const&amp; expression() const { return static_cast&lt;E const&amp;&gt;(*this); }\n};\n\nclass Var : public Expression&lt;Var&gt; {\npublic:\n    Var(const char name)\n            : name_(name)\n    {}\n\n    std::ostream&amp; print(std::ostream&amp; os) const\n    {\n        return os &lt;&lt; name_;\n    }\nprivate:\n    const char name_;\n};\n\nclass Constant : public Expression&lt;Constant&gt; {\npublic:\n    Constant(const double value)\n            : value_(value)\n    {}\n\n    std::ostream&amp; print(std::ostream&amp; os) const\n    {\n        return os &lt;&lt; value_;\n    }\n\nprivate:\n    const double value_;\n};\n\ntemplate&lt;typename E1, typename E2&gt;\nclass ExpressionSum : public Expression&lt;ExpressionSum&lt;E1,E2&gt;&gt; {\n    E1 const&amp; u_;\n    E2 const&amp; v_;\npublic:\n    ExpressionSum(E1 const&amp; u, E2 const&amp; v) : u_(u), v_(v)\n    {\n    }\n\n    std::ostream&amp; print(std::ostream&amp; os) const\n    {\n        os &lt;&lt; \"(\";\n        u_.print(os);\n        os &lt;&lt; \" + \";\n        v_.print(os);\n        os &lt;&lt; \")\";\n        return os;\n    }\n};\ntemplate &lt;typename E1, typename E2&gt;\nExpressionSum&lt;E1,E2&gt; operator+(Expression&lt;E1&gt; const&amp; u, Expression&lt;E2&gt; const&amp; v) {\n    return ExpressionSum&lt;E1, E2&gt;(u.expression(), v.expression());\n}\n\nint main() {\n    Var a('a');\n    Var b('b');\n    Constant c(1.0);\n\n    auto expr = a + b + c;\n    expr.print(std::cout);\n    std::cout &lt;&lt; std::endl;\n\n    auto expr2 = expr + Constant{2.0};\n    expr2.print(std::cout);\n    std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>The expression <code>expr</code> is fine, but I cannot reuse <code>expr</code> to build another expression like <code>expr2</code> since the temporary <code>ExpressionSum</code> of <code>a+b</code> is already destroyed. Is there a way to store these temporaries in the expression?</p>\n"}, {"tags": ["c++", "busy-waiting", "busy-loop"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558542322, "post_id": 56261102, "comment_id": 99139030, "body": "<code>stl</code> is a bit ambiguous. I allowed myself to remove the tag, because its description says that the tag refers to the Standard Template Library (the one that was adopted partly into the c++ standard), not to the c++ standard library."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1558542847, "post_id": 56261102, "comment_id": 99139261, "body": "<a href=\"https://en.cppreference.com/w/cpp/thread/timed_mutex\" rel=\"nofollow noreferrer\">std::timed_mutex</a> maybe?"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558543124, "post_id": 56261102, "comment_id": 99139390, "body": "Condition_variable?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 1, "creation_date": 1558543171, "post_id": 56261102, "comment_id": 99139415, "body": "@JVApen Condition variable in combination with <code>std::timed_mutex</code> :)"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 1, "creation_date": 1558543319, "post_id": 56261102, "comment_id": 99139478, "body": "Not needed: <a href=\"https://en.cppreference.com/w/cpp/thread/condition_variable/wait_for\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/thread/condition_variable/wait_for</a>"}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1558544497, "post_id": 56261102, "comment_id": 99140019, "body": "&quot;one thread needs to poll anyways.&quot; -- The word &#39;poll&#39; implies unlimited testing, a waste of resources.  Consider alternatives ... how often does your software need to check the shared memory?  A 100 hz check is likely a trivial cpu load.  And for user triggered shared-memory-activity, 10 hz is usually more than sufficient.  This idea is sometimes referred to as periodic status update."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558544846, "post_id": 56261102, "comment_id": 99140155, "body": "Looks like I read over the fact that condition_variable can&#39;t be used in this case."}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "reply_to_user": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1558544890, "post_id": 56261102, "comment_id": 99140167, "body": "@2785528 the poll intervall highly depends to the scenario, in case of a power fail, 10hz would not be sufficient."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558545097, "post_id": 56261102, "comment_id": 99140246, "body": "@florgeng Do I understand your question correctly if I see that you want to &#39;watch&#39; a certain bit/byte in memory and be notified as soon as it gets changed? (Though, prevent infinite wait via a time-out)"}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558545217, "post_id": 56261102, "comment_id": 99140309, "body": "@JVApen exactly, I am waiting for certain responses in different use cases but need to abort if the subsystem needs too long"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558545511, "post_id": 56261102, "comment_id": 99140439, "body": "@florgeng I don&#39;t think there is anything in the STL that provides such functionality. I think you are best off with looking at system calls instead. Another option: <a href=\"https://www.boost.org/doc/libs/master/doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.conditions\" rel=\"nofollow noreferrer\">Boost::interprocess</a> If you can&#39;t use it, you might find some tricks in what they do."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1558547072, "post_id": 56261102, "comment_id": 99141058, "body": "This sounds kind of like readers/writers scenario. One thread should be pumping a message queue (reader) that others write to (writer). Is this kind of approach not feasible on your target platform?"}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1558599393, "post_id": 56261102, "comment_id": 99156544, "body": "@JVApen Boost.Interprocess can&#39;t be used here since it needs c++ in the subsystem."}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1558599538, "post_id": 56261102, "comment_id": 99156616, "body": "@AndyG yes, but still then one thread is needed to poll the interface, but that could fire events/condition variables to waiting threads. But then there is no scenario based controls over the reaction speed like with passed poll intervals"}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1558543112, "post_id": 56261228, "comment_id": 99139384, "body": "<i>&quot;but since you&#39;ve got a poll interval, sleep_for() is probably your best bet&quot;</i> I don&#39;t think so. Busy wait is almost never what you want to do."}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "edited": false, "score": 1, "creation_date": 1558545483, "post_id": 56261228, "comment_id": 99140431, "body": "Maybe yield should be used if no poll interval is specified, instead of default=1ms"}], "tags": [], "owner": {"reputation": 1091, "user_id": 1988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5yyul.png?s=128&g=1", "display_name": "John Tyner", "link": "https://stackoverflow.com/users/1988/john-tyner"}, "is_accepted": true, "score": 1, "last_activity_date": 1558542206, "creation_date": 1558542206, "answer_id": 56261228, "question_id": 56261102, "link": "https://stackoverflow.com/questions/56261102/is-there-a-standard-function-to-busy-wait-for-a-condition-or-until-a-timeout/56261228#56261228", "title": "Is there a standard function to busy wait for a condition or until a timeout", "body": "<p>Not to my knowledge. In general, the goal is to wait without burning clock cycles, so the standard library is geared toward that usage.</p>\n\n<p>I'm aware of <code>std::this_thread::yield()</code> which is what I usually use when I want to busy wait, but since you've got a poll interval, <code>sleep_for()</code> is probably your best bet.</p>\n"}, {"comments": [{"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "edited": false, "score": 0, "creation_date": 1558546837, "post_id": 56261969, "comment_id": 99140976, "body": "thanks for your answer and the review. I will consider all your remarks. I think I will do it like you suggested with a time_point as parameter. I havent seen a template which take the predicate function by reference until now, but yes -- I can&#39;t see a problem in doing that right now."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "edited": false, "score": 0, "creation_date": 1558547246, "post_id": 56261969, "comment_id": 99141143, "body": "@florgeng actually never mind the reference suggestion. Use value instead, and if you need to avoid copy, pass the functor with <code>std::ref(check)</code>."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1558547209, "last_edit_date": 1558547209, "creation_date": 1558545496, "answer_id": 56261969, "question_id": 56261102, "link": "https://stackoverflow.com/questions/56261102/is-there-a-standard-function-to-busy-wait-for-a-condition-or-until-a-timeout/56261969#56261969", "title": "Is there a standard function to busy wait for a condition or until a timeout", "body": "<blockquote>\n  <p>Is there a standard function to busy wait for a condition or until a timeout</p>\n</blockquote>\n\n<p>No. There are functions for <em>blocking</em> until timeout or notification, but not for <em>busy</em> waiting. However, that is indeed fairly simple to write, as you've demonstrated.</p>\n\n<p>An important consideration regarding the context: There is no guarantee in general that the <code>check()</code> is still true after the function has returned true. To achieve that guarantee, you must make sure that anything that touches the shared memory (including the subsystem) won't change the check to be false, with the exception of the thread that does the polling (and that means there can only be one thread doing so).</p>\n\n<hr>\n\n<p>Bonus code review</p>\n\n<ul>\n<li>Since you have a template anyway, it is probably a good idea to let the type of the time arguments be templated as well, so that the user can use any <code>std::chrono::time_point</code> and thereby any unit the wish. In addition, you can get rid of <code>duration_cast</code>s and <code>count</code> in your template.</li>\n</ul>\n"}], "owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "accepted_answer_id": 56261228, "answer_count": 2, "score": 1, "last_activity_date": 1558595940, "creation_date": 1558541702, "last_edit_date": 1558595940, "question_id": 56261102, "link": "https://stackoverflow.com/questions/56261102/is-there-a-standard-function-to-busy-wait-for-a-condition-or-until-a-timeout", "title": "Is there a standard function to busy wait for a condition or until a timeout", "body": "<p>I need to wait in my program for a subsystem. In different places a have to wait for different conditions. I know I could also make use of threads and conditions variables. But since the subsystem (bare metal programmed in  C) is connected via shared memory with no interrupts registered to it -- one thread needs to poll anyways. </p>\n\n<p>So I did the following template to be able to wait for anything. I was wondering whether there is already a STL function which could be used for that? </p>\n\n<pre><code>#include &lt;chrono&gt;\n#include &lt;thread&gt;\n\n\n//given poll interval\ntemplate&lt;typename predicate, \n         typename Rep1, typename Period1, \n         typename Rep2, typename Period2&gt; \nbool waitActiveFor(predicate check,\n                   std::chrono::duration&lt;Rep1, Period1&gt; x_timeout,\n                   std::chrono::duration&lt;Rep2, Period2&gt; x_pollInterval)\n{\n  auto x_start = std::chrono::steady_clock::now();\n  while (true)\n  {\n    if (check())\n      return true;\n\n    if ((std::chrono::steady_clock::now() - x_start) &gt; x_timeout)\n      return false;\n\n    std::this_thread::sleep_for(x_pollInterval);\n  }\n}\n\n//no poll interval defined\ntemplate&lt;typename predicate, \n         typename Rep, typename Period&gt;\nbool waitActiveFor(predicate check,\n                   std::chrono::duration&lt;Rep, Period&gt; x_timeout)\n{\n  auto x_start = std::chrono::steady_clock::now();\n  while (true)\n  {\n    if (check())\n      return true;\n\n    if ((std::chrono::steady_clock::now() - x_start) &gt; x_timeout)\n      return false;\n\n    std::this_thread::yield();\n  }\n}\n</code></pre>\n\n<p><a href=\"https://coliru.stacked-crooked.com/a/03e8a55036a18364\" rel=\"nofollow noreferrer\">running sample</a></p>\n\n<hr>\n\n<p>2019-05-23: Code update regarding the comments and answers</p>\n"}, {"tags": ["c++", "sorting", "set"], "answers": [{"comments": [{"owner": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "edited": false, "score": 0, "creation_date": 1558581292, "post_id": 56261717, "comment_id": 99150928, "body": "Thank you so much! Question 3), I am using the lambda function in set&lt;Line, decltype(cmp)&gt; s(cmp), i.e., replace the a.up &lt;= b.down comparison with lambda function in Question 3); To summarize, for Question 1) the 6 cases listed show that just comparing a.up &lt;= b.down it enough to cover the only 2 valid cases of non-overlapping!  Smart! 2) the set insert fails when there are equivalent elements, thus, only !(l1 &lt; l3) is not enought to reject l1, thus l1 is accepted."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "edited": false, "score": 0, "creation_date": 1558598954, "post_id": 56261717, "comment_id": 99156308, "body": "comparer should sastify <code>bool operator&lt;</code> semantic. Your returns -1, 0, 1. So true, false, true. Which is not what you want anyway."}, {"owner": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "edited": false, "score": 0, "creation_date": 1558601222, "post_id": 56261717, "comment_id": 99157645, "body": "I see. So -1 also means true, right? b/c it is != 0"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "edited": false, "score": 0, "creation_date": 1558601440, "post_id": 56261717, "comment_id": 99157759, "body": "Yes, any non-zero number is <code>true</code>."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 2, "last_activity_date": 1558544187, "creation_date": 1558544187, "answer_id": 56261717, "question_id": 56260963, "link": "https://stackoverflow.com/questions/56260963/c-sort-intervals-struct-as-well-as-removing-overlapping-intervals/56261717#56261717", "title": "C++ sort intervals struct as well as removing overlapping intervals", "body": "<blockquote>\n  <p>1) Why is simply comparing a.up &lt;= b.down enough to detect overlapping intervals?</p>\n</blockquote>\n\n<p><code>[a.down, a.up[</code> overlaps <code>[b.down, b.up[</code> when <code>max(a.down, b.down) &lt; min(a.up, b.up)</code>\nwhich is equivalent to <code>a.down &lt; b.up &amp;&amp; b.down &lt; a.up</code> (remember that we also have <code>a.down &lt;= a.up &amp;&amp; b.down &lt;= b.up</code> from interval definition).</p>\n\n<p>We can also list possibilities:</p>\n\n<ul>\n<li><code>a.down &lt; a.up &lt; b.down &lt; b.up</code> <code>(a &lt; b)</code></li>\n<li><code>a.down &lt; b.down &lt; a.up &lt; b.up</code> Intersection</li>\n<li><code>a.down &lt; b.down &lt; b.up &lt; a.up</code> Intersection (Totally included)</li>\n<li><code>b.down &lt; a.down &lt; a.up &lt; b.up</code> Intersection (Totally included)</li>\n<li><code>b.down &lt; a.down &lt; b.up &lt; a.up</code> Intersection</li>\n<li><code>b.down &lt; b.up &lt; a.down &lt; a.up</code> <code>(b &lt; a)</code></li>\n</ul>\n\n<blockquote>\n  <p>The 3rd step is not clear to me</p>\n  \n  <p><code>insert 3-&gt;5 success\n  insert 1-&gt;2 success //OK, b/c 2 &lt;= 3, a.up &lt;= b.down return true\n  insert 2-&gt;3 success //Why success? 3 &gt; 1, i.e., a.up &gt; b.down, return false; does it only compare with interval 3-&gt;5?</code></p>\n</blockquote>\n\n<pre><code>Line l1{2, 3};\nLine l2{3, 5};\nLine l3{1, 2};\nLine l4{4, 6};\n</code></pre>\n\n<p>To insert <code>l1</code> in <code>{l3, l2}</code></p>\n\n<ul>\n<li><code>l1 &lt; l2</code> so <code>l1</code> is before <code>l2</code></li>\n<li><code>!(l1 &lt; l3)</code> so <code>l1</code> is not before <code>l3</code></li>\n<li><code>l3 &lt; l1</code> so <code>l1</code> is after <code>l3</code>\n-> <code>{l3, l1, l2}</code></li>\n</ul>\n\n<p>For <code>l4</code> in <code>{l3, l1, l2}</code> We have:</p>\n\n<ul>\n<li><code>!(l4 &lt; l2)</code> (similarly for <code>l3</code> and <code>l1</code>) so <code>l4</code> is not before <code>l2</code></li>\n<li><code>!(l2 &lt; l4)</code>  so <code>l4</code> is not after <code>l2</code></li>\n</ul>\n\n<p>we have both <code>!(l2 &lt; l4) &amp;&amp; !(l4 &lt; l2)</code> so there are <em>equivalent</em>, we don't insert <code>l4</code>.</p>\n\n<blockquote>\n  <p>3) Why does below code not work for removing overlapping intervals?</p>\n</blockquote>\n\n<p>I don't understand where you use it.</p>\n"}], "owner": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 2, "accepted_answer_id": 56261717, "answer_count": 1, "score": 0, "last_activity_date": 1558544187, "creation_date": 1558541143, "question_id": 56260963, "link": "https://stackoverflow.com/questions/56260963/c-sort-intervals-struct-as-well-as-removing-overlapping-intervals", "title": "C++ sort intervals struct as well as removing overlapping intervals", "body": "<p>Here intervals is the same as Line. Although I figured out the correct solution for the two purposes:</p>\n\n<p>1) sort intervals;</p>\n\n<p>2) reject when adding intervals overlapping with existing ones.</p>\n\n<pre><code>struct Line {\n    int down;\n    int up;\n\n    Line(int down, int up) {\n        this-&gt;down = down;\n        this-&gt;up = up;\n    }\n};\n\nint main() {\n    auto cmp = [] (const Line&amp; a, const Line&amp; b) {//NOTE: this can even detect the intersection, as well as sort the interval!!\n        if (a.up &lt;= b.down) return true;\n        else return false;\n    };\n\n    set&lt;Line, decltype(cmp)&gt; s(cmp);\n    Line l1{2, 3};\n    Line l2{3, 5};\n    Line l3{1, 2}; //success for insertion\n    Line l4{4, 6}; //fail for insertion b/c of insersection\n\n\n    auto ret = s.insert(l2);\n    cout &lt;&lt; \"insert 3-&gt;5 \";\n    if (ret.second) cout &lt;&lt; \"success \" &lt;&lt; endl;\n    else cout &lt;&lt; \"fail \" &lt;&lt; endl;\n\n    ret = s.insert(l3);\n    cout &lt;&lt; \"insert 1-&gt;2 \";\n    if (ret.second) cout &lt;&lt; \"success \" &lt;&lt; endl;\n    else cout &lt;&lt; \"fail \" &lt;&lt; endl;\n\n    ret = s.insert(l1);\n    cout &lt;&lt; \"insert 2-&gt;3 \";\n    if (ret.second) cout &lt;&lt; \"success \" &lt;&lt; endl;\n    else cout &lt;&lt; \"fail \" &lt;&lt; endl;\n\n    ret = s.insert(l4);\n    cout &lt;&lt; \"insert 4-&gt;6 \";\n    if (ret.second) cout &lt;&lt; \"success \" &lt;&lt; endl;\n    else cout &lt;&lt; \"fail \" &lt;&lt; endl;\n\n    return 0;\n}\n\nOutput:\ninsert 3-&gt;5 success\ninsert 1-&gt;2 success\ninsert 2-&gt;3 success\ninsert 4-&gt;6 fail\nset finally contains: 1-&gt;2, 2-&gt;3, 3-&gt;5,\n</code></pre>\n\n<p>There is something still puzzling to me:</p>\n\n<p>1) Why is simply comparing <code>a.up &lt;= b.down</code> enough to detect overlapping intervals?</p>\n\n<p>Shouldn't we do something like standard approach of detecting interval overlapping?</p>\n\n<pre><code>max(a.down, b.down) &lt; min(a.up, b.up)\n</code></pre>\n\n<p>2) The 3rd step is not clear to me</p>\n\n<pre><code>insert 3-&gt;5 success\ninsert 1-&gt;2 success //OK, b/c 2 &lt;= 3, a.up &lt;= b.down return true\ninsert 2-&gt;3 success //Why success? 3 &gt; 1, i.e., a.up &gt; b.down, return false; does it only compare with interval 3-&gt;5?\n</code></pre>\n\n<p>3) Why does below code not work for removing overlapping intervals?</p>\n\n<pre><code>    auto cmp_set = [](const Line&amp; a, const Line&amp; b) {\n        if (max(a.down, b.down) &lt; min(a.up, b.up)) return 0; //standard way to detect overlapping of intervals\n        else { //sort the two intervals \n            if(a.up &lt;= b.down) return -1;\n            else return 1;\n        }\n    };\n</code></pre>\n"}, {"tags": ["c++", "r", "rcpp"], "comments": [{"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1558541524, "post_id": 56260846, "comment_id": 99138613, "body": "Works for me with <code>g++</code> and <code>clang++</code> on Linux (once I add the missing lines; would be nice if you submit a complete example next time).  I suggest you check your macOS header files / added header files."}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "reply_to_user": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1558541822, "post_id": 56260846, "comment_id": 99138774, "body": "@DirkEddelbuettel this is more of a (older) compiler issue, just pack ::pow into lambda"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1558541928, "post_id": 56260846, "comment_id": 99138833, "body": "Well, maybe not as OP states success on Windows where R imposes <code>g++</code> version 4.9.3."}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "reply_to_user": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1558542196, "post_id": 56260846, "comment_id": 99138966, "body": "@DirkEddelbuettel well, on Mac usually it is older Apple-patched clang, so one might expect differences."}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1558543791, "post_id": 56260846, "comment_id": 99139672, "body": "I don&#39;t know. Works for me with <code>clang++-4.0</code> (the oldest one I have around) as well as the newer default."}, {"owner": {"reputation": 4728, "user_id": 6332958, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fo0yl.jpg?s=128&g=1", "display_name": "Steffen Moritz", "link": "https://stackoverflow.com/users/6332958/steffen-moritz"}, "edited": false, "score": 0, "creation_date": 1558565656, "post_id": 56260846, "comment_id": 99148193, "body": "First thanks for your help. Can&#39;t really tell you which clang version I have ... Apple has it&#39;s own versioning: clang++ --version gives Apple LLVM version 10.0.0 (clang-1000.10.44.4). The most recent &#39;normal&#39; Clang version is 8."}, {"owner": {"reputation": 4728, "user_id": 6332958, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fo0yl.jpg?s=128&g=1", "display_name": "Steffen Moritz", "link": "https://stackoverflow.com/users/6332958/steffen-moritz"}, "edited": false, "score": 0, "creation_date": 1558566238, "post_id": 56260846, "comment_id": 99148306, "body": "Packing ::pow into lamda solved the problem! But I had to set Sys.setenv(&quot;PKG_CXXFLAGS&quot;=&quot;-std=c++11&quot;) to be able to use it. Which is fine, but since it is for a CRAN package it would have the disadvantage that (I guess) I now need a Makevars file with CXX_STD = CXX11 and have to set SystemRequirements: C++11 in the DESCRIPTION FILE. Is there an alternate solution, which could prevent this?"}, {"owner": {"reputation": 4728, "user_id": 6332958, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fo0yl.jpg?s=128&g=1", "display_name": "Steffen Moritz", "link": "https://stackoverflow.com/users/6332958/steffen-moritz"}, "edited": false, "score": 0, "creation_date": 1558570657, "post_id": 56260846, "comment_id": 99149142, "body": "Severin Pappadeux now also addressed this in his answer. Thx :)"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1558585993, "post_id": 56260846, "comment_id": 99151692, "body": "What\u2019s the disadvantage of requiring C++11 for a CRAN package? In addition, newer R versions ask for other clang builds, cf <a href=\"https://thecoatlessprofessor.com/programming/r-compiler-tools-for-rcpp-on-macos/\" rel=\"nofollow noreferrer\">thecoatlessprofessor.com/programming/&hellip;</a>"}, {"owner": {"reputation": 4728, "user_id": 6332958, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fo0yl.jpg?s=128&g=1", "display_name": "Steffen Moritz", "link": "https://stackoverflow.com/users/6332958/steffen-moritz"}, "edited": false, "score": 0, "creation_date": 1558626246, "post_id": 56260846, "comment_id": 99171739, "body": "Thanks for the link. Guess the only real disadvantage is as mentioned that you would probably have to have a Makevars file. (if you see this as disadvantage)"}], "answers": [{"comments": [{"owner": {"reputation": 4728, "user_id": 6332958, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fo0yl.jpg?s=128&g=1", "display_name": "Steffen Moritz", "link": "https://stackoverflow.com/users/6332958/steffen-moritz"}, "edited": false, "score": 0, "creation_date": 1558566261, "post_id": 56261057, "comment_id": 99148311, "body": "Packing ::pow into lamda solved the problem! But I had to set Sys.setenv(&quot;PKG_CXXFLAGS&quot;=&quot;-std=c++11&quot;) to be able to use it. Which is fine, but since it is for a CRAN package it would have the disadvantage that (I guess) I now need a Makevars file with CXX_STD = CXX11 and have to set SystemRequirements: C++11 in the DESCRIPTION FILE. Is there an alternate solution, which could prevent this?"}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "reply_to_user": {"reputation": 4728, "user_id": 6332958, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fo0yl.jpg?s=128&g=1", "display_name": "Steffen Moritz", "link": "https://stackoverflow.com/users/6332958/steffen-moritz"}, "edited": false, "score": 0, "creation_date": 1558568874, "post_id": 56261057, "comment_id": 99148794, "body": "@stats0007 Well, lambda is basically a functor, class with overloaded operator(). So probably yes, please check the update"}, {"owner": {"reputation": 4728, "user_id": 6332958, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fo0yl.jpg?s=128&g=1", "display_name": "Steffen Moritz", "link": "https://stackoverflow.com/users/6332958/steffen-moritz"}, "edited": false, "score": 0, "creation_date": 1558570596, "post_id": 56261057, "comment_id": 99149129, "body": "Great, this completely solved my problems :) Many thanks!"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1558643133, "post_id": 56261057, "comment_id": 99178835, "body": "One issue I overlooked is that OP used an Integer and a NumericVector, so the automatic &#39;cast up&#39; into double only seems to happen with newer compiler.  I actually show the functor approach in a few tutorials but am now spoiled with C++11 being default almost everywhere ..."}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "reply_to_user": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1558665803, "post_id": 56261057, "comment_id": 99183878, "body": "@DirkEddelbuettel Well, I just tried latest&amp;greatest MSVC 19.22.27706.1 from VS 2019 preview, and it didn&#39;t compile original OP code with ::pow - cannot find overload match from transform. With either lambda or functor all goes well"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1558714888, "post_id": 56261057, "comment_id": 99205086, "body": "The <a href=\"https://cloud.r-project.org/web/packages/Rcpp/vignettes/Rcpp-FAQ.pdf\" rel=\"nofollow noreferrer\">Rcpp FAQ</a> is very clear on this; please don&#39;t expect it to work."}], "tags": [], "owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "is_accepted": true, "score": 5, "last_activity_date": 1558569067, "last_edit_date": 1558569067, "creation_date": 1558541546, "answer_id": 56261057, "question_id": 56260846, "link": "https://stackoverflow.com/questions/56260846/rcpp-no-matching-function-for-call-to-transform/56261057#56261057", "title": "RCPP - no matching function for call to &#39;transform&#39;", "body": "<p>This is actually C++ compiler error. Compiler cannot match ::pow with BinaryOp, so pack it into lambda. This works for me</p>\n\n<pre><code>std::transform(base.cbegin(), base.cend(), exp.cbegin(), out.begin(), [](double a, double b) {return ::pow(a, b); });\n</code></pre>\n\n<p>If lambdas are not available, one could try to make a functor (which lambda is equivalent to, please check <a href=\"https://medium.com/@winwardo/c-lambdas-arent-magic-part-1-b56df2d92ad2\" rel=\"nofollow noreferrer\">https://medium.com/@winwardo/c-lambdas-arent-magic-part-1-b56df2d92ad2</a>, <a href=\"https://medium.com/@winwardo/c-lambdas-arent-magic-part-2-ce0b48934809\" rel=\"nofollow noreferrer\">https://medium.com/@winwardo/c-lambdas-arent-magic-part-2-ce0b48934809</a>). Along the lines (untested code, I'm not at my computer)</p>\n\n<pre><code>struct pow_wrapper {\n    public: double operator()(double a, double b) {\n        return ::pow(a, b);\n    }\n};\n</code></pre>\n\n<p>Then try</p>\n\n<pre><code>std::transform(base.cbegin(), base.cend(), exp.cbegin(), out.begin(), pow_wrapper());\n</code></pre>\n"}], "owner": {"reputation": 4728, "user_id": 6332958, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fo0yl.jpg?s=128&g=1", "display_name": "Steffen Moritz", "link": "https://stackoverflow.com/users/6332958/steffen-moritz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 56261057, "answer_count": 1, "score": 2, "last_activity_date": 1558569067, "creation_date": 1558540747, "last_edit_date": 1558565357, "question_id": 56260846, "link": "https://stackoverflow.com/questions/56260846/rcpp-no-matching-function-for-call-to-transform", "title": "RCPP - no matching function for call to &#39;transform&#39;", "body": "<p>I have a problem while using Rcpp on Mac (on Windows the problem does not occur).</p>\n\n<p>Here is the C++ Code that causes the error.</p>\n\n<pre><code>#include &lt;Rcpp.h&gt;\nusing namespace Rcpp;\n\nNumericVector vecpow(const IntegerVector base, const NumericVector exp) \n{\n  NumericVector out(base.size());\n  std::transform(base.begin(), base.end(), exp.begin(), out.begin(), ::pow);\n  return out;\n}\n</code></pre>\n\n<p>Seems like nothing too fancy or complicated.</p>\n\n<p>Still I get the following error when I try to compile it:</p>\n\n<blockquote>\n  <p>na_ma.cpp:7:3: error: no matching function for call to 'transform'\n    std::transform(base.begin(), base.end(), exp.begin(), out.begin(), ::pow);\n    ^~~~~~~~~~~~~~</p>\n  \n  <p>/Library/Developer/CommandLineTools/usr/include/c++/v1/algorithm:2028:1: note: candidate function template not viable: requires 4 arguments, but 5 were provided\n  transform(_InputIterator __first, _InputIterator __last, _OutputIterator __result, _UnaryOperation __op)\n  ^</p>\n</blockquote>\n\n<p>I am wondering how to fix this. While searching for solutions I came to some suggestions to create a Makevars file - but this did not work for me.</p>\n\n<p>Would be also nice, if somebody could explain to me, why this error is occurring since I don't understand it.</p>\n"}, {"tags": ["c++", "multithreading", "thread-safety"], "comments": [{"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 0, "creation_date": 1558540303, "post_id": 56260658, "comment_id": 99137913, "body": "You might want to take a look at: <a href=\"http://valgrind.org/docs/manual/hg-manual.html\" rel=\"nofollow noreferrer\">valgrind.org/docs/manual/hg-manual.html</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558540318, "post_id": 56260658, "comment_id": 99137921, "body": "Is this variable being accessed via a getter or through the object directly?"}, {"owner": {"reputation": 8871, "user_id": 1132871, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IO6V2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1132871/alex"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558540567, "post_id": 56260658, "comment_id": 99138042, "body": "@NathanOliver The variable is a private member that is overwritten in a public method"}, {"owner": {"reputation": 8871, "user_id": 1132871, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IO6V2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1132871/alex"}, "reply_to_user": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 0, "creation_date": 1558540856, "post_id": 56260658, "comment_id": 99138217, "body": "@DavideSpataro this is a good idea, I didn&#39;t know about such tool. On the other hand I as a developer want to be able to mark variable as unsafe and make other developer that uses this structure think about thread safety."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558541067, "post_id": 56260658, "comment_id": 99138334, "body": "<a href=\"https://clang.llvm.org/docs/ThreadSanitizer.html\" rel=\"nofollow noreferrer\">Thread sanitizer</a> (available for Clang &amp; GCC) is <i>excellent</i> for spotting problems like that."}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 1, "last_activity_date": 1558541516, "creation_date": 1558541516, "answer_id": 56261050, "question_id": 56260658, "link": "https://stackoverflow.com/questions/56260658/identifying-thread-unsafe-data-structures-used-by-different-threads-simultaneous/56261050#56261050", "title": "Identifying thread unsafe data structures used by different threads simultaneously", "body": "<p>You can try using <code>clang++</code> with <a href=\"https://clang.llvm.org/docs/ThreadSanitizer.html\" rel=\"nofollow noreferrer\"><strong>ThreadSanitizer</strong></a>. This involves recompiling your code with <code>-fsanitize=thread -ltsan</code>, and executing it. TSan should detect data races and give you stack traces to figure out what's causing them.</p>\n\n<blockquote>\n  <p>ThreadSanitizer is a tool that detects data races. It consists of a compiler instrumentation module and a run-time library. Typical slowdown introduced by ThreadSanitizer is about 5x-15x. Typical memory overhead introduced by ThreadSanitizer is about 5x-10x.</p>\n</blockquote>\n"}], "owner": {"reputation": 8871, "user_id": 1132871, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IO6V2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1132871/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558541516, "creation_date": 1558540101, "question_id": 56260658, "link": "https://stackoverflow.com/questions/56260658/identifying-thread-unsafe-data-structures-used-by-different-threads-simultaneous", "title": "Identifying thread unsafe data structures used by different threads simultaneously", "body": "<p>There is a legacy project that contains hundreds of thousands SLOC and runs a lot of different threads.</p>\n\n<p>There is a data structure that contains non-atomic member, that theoretically may be used by different threads, but due to high complexity of code it may be difficult to identify this case from a simple code analysis.</p>\n\n<p>Timings not always cause the crash but it may happen (e.g. this member uses heap).</p>\n\n<p>Is there any way to identify such variables or e.g. during the testing make application crash during the first access of this variable by thread that is different from the thread that accessed it before?</p>\n"}, {"tags": ["python", "c++", "eigen"], "comments": [{"owner": {"reputation": 36366, "user_id": 371739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6e42063400331743a848740f8827c90e?s=128&d=identicon&r=PG", "display_name": "Owen", "link": "https://stackoverflow.com/users/371739/owen"}, "edited": false, "score": 0, "creation_date": 1558540226, "post_id": 56260624, "comment_id": 99137873, "body": "Can you post <code>XtX</code> so we can try it out?"}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 1, "creation_date": 1558540343, "post_id": 56260624, "comment_id": 99137937, "body": "Well which one is correct? Can you try that? Also you might want to switch to doubles. Floats are usually not faster on CPUs anyway."}, {"owner": {"reputation": 36366, "user_id": 371739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6e42063400331743a848740f8827c90e?s=128&d=identicon&r=PG", "display_name": "Owen", "link": "https://stackoverflow.com/users/371739/owen"}, "edited": false, "score": 3, "creation_date": 1558540376, "post_id": 56260624, "comment_id": 99137953, "body": "Certainly you are correct that there can only be one set of eigenvalues for a matrix. If I had to guess I would say numerical precision. The eigenvalues nearest 0 are the hardest to compute precisely, especially for a large matrix."}, {"owner": {"reputation": 1, "user_id": 10281561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e24b1b8b7e39d4c98eb736f93a81db?s=128&d=identicon&r=PG&f=1", "display_name": "anhbeo", "link": "https://stackoverflow.com/users/10281561/anhbeo"}, "edited": false, "score": 0, "creation_date": 1558552021, "post_id": 56260624, "comment_id": 99143211, "body": "Hi. @Quimbly, yes. Definitely will switch to double. To be honest, this is the first time I am working with Eigenvalues, and I am not sure which one is correct. Which way could I try? My matrix size is 84x84."}], "answers": [{"tags": [], "owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "is_accepted": false, "score": 0, "last_activity_date": 1558557807, "creation_date": 1558557807, "answer_id": 56264735, "question_id": 56260624, "link": "https://stackoverflow.com/questions/56260624/computing-eigen-values-using-python-different-from-eigen-library-in-cpp-in-non-p/56264735#56264735", "title": "Computing eigen values using python different from Eigen Library in Cpp in non-positive components", "body": "<p>You are using single precision float. Their relative precision is about 1e-7, so all eigenvalues below 197323*1e-7 can be considered as zero. With that in mind, both versions can be considered numerically equivalent. For more accuracy, switch to double.</p>\n"}], "owner": {"reputation": 1, "user_id": 10281561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e24b1b8b7e39d4c98eb736f93a81db?s=128&d=identicon&r=PG&f=1", "display_name": "anhbeo", "link": "https://stackoverflow.com/users/10281561/anhbeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558557807, "creation_date": 1558540010, "question_id": 56260624, "link": "https://stackoverflow.com/questions/56260624/computing-eigen-values-using-python-different-from-eigen-library-in-cpp-in-non-p", "title": "Computing eigen values using python different from Eigen Library in Cpp in non-positive components", "body": "<p>I am using </p>\n\n<pre><code>scipy.linalg import eigh\n</code></pre>\n\n<p>to compute Eigenvalues. Everything works correctly, however, while computing a non-positive eigenvalue.The results provided from Scipy is different from Eigen library in Cpp.</p>\n\n<p>I tried the same array data on 2 Cpp and Python. It seems to be correct with non-negative results.\nBut not with negative one. </p>\n\n<p>'''python</p>\n\n<pre><code>    from scipy.linalg import eigh\n    eigenVal, eigenVec = eigh(XtX)\n    idx = eigenVal.argsort()[::-1]\n    eigenVal = eigenVal[idx] / n  # Descending Sort\n</code></pre>\n\n<p>'''</p>\n\n<p>'''Cpp</p>\n\n<pre><code>   // Compute Eigendecomposition:\n   Eigen::MatrixXf XtX (r,r);\n   if (m &lt;= n\n        XtX.template triangularView&lt;Eigen::Lower&gt;() = X * X.transpose();\n   else\n        XtX.template triangularView&lt;Eigen::Lower&gt;() = X.transpose() * X;\n   Eigen::SelfAdjointEigenSolver&lt;Eigen::MatrixXf&gt; eig (XtX);\n   // eigenvalues provide squared singular values:\n   Eigen::VectorXf s = eig.eigenvalues();\n\n   s=s.reverse().eval()/n;\n</code></pre>\n\n<p>'''</p>\n\n<p>output in python:\n'''</p>\n\n<pre><code>array([  1.97322578e+05,   8.04158203e+03,   7.24907227e+03,           \n    6.59655957e+03,   5.78095068e+03,   5.29064844e+03,\n    4.74032520e+03,   4.46454346e+03,   4.23509229e+03,\n    4.09968652e+03,   3.52356104e+03,   3.17308252e+03,\n    3.14735107e+03,   2.88025342e+03,   2.80748145e+03,\n    2.62388794e+03,   2.50723022e+03,   2.42145996e+03,\n    2.11814282e+03,   2.03532385e+03,   1.79338770e+03,\n    1.75364771e+03,   1.69037793e+03,   1.57554895e+03,\n    1.45615894e+03,   1.33216003e+03,   1.26516211e+03,\n    1.18433081e+03,   1.14839172e+03,   9.90758057e+02,\n    8.59174011e+02,   8.20709900e+02,   7.86408569e+02,\n    7.27681091e+02,   6.52041077e+02,   5.90487732e+02,\n    5.26059814e+02,   4.99097687e+02,   4.49730896e+02,\n    4.16578094e+02,   3.22004700e+02,   3.04409729e+02,\n    2.79609161e+02,   2.15276245e+02,   1.84194916e+02,\n    1.57032639e+02,   1.26647469e+02,   9.45600433e+01,\n    7.59200439e+01,   5.26064911e+01,   4.35399475e+01,\n    3.20723610e+01,   2.21866665e+01,   1.30586596e+01,\n    3.81547445e-03,   1.16530398e-03,   1.07570493e-03,\n    9.38778510e-04,   7.38311443e-04,   5.67958807e-04,\n    5.35471656e-04,   5.30579535e-04,   5.17265638e-04,\n    5.16666041e-04,   5.10115584e-04,   5.03800577e-04,\n    5.00108406e-04,   4.70151805e-04,   4.33832814e-04,\n    4.32742119e-04,   4.15480201e-04,   3.78245371e-04,\n    3.75256117e-04,   3.71288595e-04,   3.53171228e-04,\n    3.44453088e-04,   3.06655653e-04,   3.04728514e-04,\n    2.60292058e-04,   2.57157430e-04,   2.02826763e-04,\n    1.92918960e-04,   1.73933528e-04,  -9.30694770e-03], \ndtype=float32)$\n</code></pre>\n\n<p>output in C:</p>\n\n<pre><code>    197323     8041.61    7249.11    6596.59    5780.98    5290.66    \n    4740.34    4464.56    4235.1    4099.7    3523.58    3173.09\n    3147.36    2880.26    2807.48    2623.89    2507.23    2421.46\n    2118.15    2035.33    1793.39    1753.65    1690.38    1575.55\n    1456.16    1332.16    1265.16    1184.33    1148.39    990.759\n    859.177    820.711    786.409    727.682    652.043    590.488\n    526.061    499.099    449.731    416.578    322.005     304.41\n    279.611    215.276    184.195    157.033    126.647    94.5601\n    75.9213    52.6073    43.5399    32.0722    22.1875    13.0586\n    0.0208003    0.00212419    0.00183017    0.00154398    \n    0.00125332   0.00120334    0.00113175    0.000939068  \n    0.000862687  0.000722841     0.000684395  0.000629895  \n    0.000528611  0.000499585  0.0004829     0.000405769  0.000357388  \n    0.000167705  8.70496e-05 -1.52459e-05     -0.000112141  \n    -0.000141369  -0.000237786  -0.000504876  -0.000550637     \n    -0.000704483  -0.000729621  -0.000882211  -0.00105727  -0.00215314\n</code></pre>\n"}, {"tags": ["c++", "qt", "c++11", "lambda", "slot"], "comments": [{"owner": {"reputation": 5161, "user_id": 3065406, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6697e5c2ff5cfdf8f196fe42a309598?s=128&d=identicon&r=PG", "display_name": "deW1", "link": "https://stackoverflow.com/users/3065406/dew1"}, "edited": false, "score": 0, "creation_date": 1558540218, "post_id": 56260361, "comment_id": 99137868, "body": "Capture what you need"}], "answers": [{"comments": [{"owner": {"reputation": 1082, "user_id": 2319028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bad9eb9af19e9244b1a240abcdee4878?s=128&d=identicon&r=PG", "display_name": "Matthias Kuhn", "link": "https://stackoverflow.com/users/2319028/matthias-kuhn"}, "edited": false, "score": 2, "creation_date": 1558595486, "post_id": 56260494, "comment_id": 99154560, "body": "The object is already there from the context in this question (see <code>mMyObject</code>), but +1 for adding it this way to make things explicit for future readers."}], "tags": [], "owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "is_accepted": true, "score": 2, "last_activity_date": 1558540428, "last_edit_date": 1558540428, "creation_date": 1558539618, "answer_id": 56260494, "question_id": 56260361, "link": "https://stackoverflow.com/questions/56260361/a-slot-as-a-paramater-in-a-lambda-function-in-c-qt/56260494#56260494", "title": "A slot as a paramater in a lambda function in C++ / Qt", "body": "<p>This should work, you're just missing the name of the function pointer.</p>\n\n<pre><code>  auto createShortcuts = [ = ]( const QString &amp;sequence, void ( MyObject::* myFunc )() )\n  {\n    QShortcut *sc = new QShortcut( QKeySequence( sequence ), this );\n    connect( sc, &amp;QShortcut::activated, mMyObject, myFunc);\n  };\n\n  createShortcuts( QStringLiteral( \"whatever\" ), &amp;MyObject::mySlot );\n</code></pre>\n\n<p>Edit:\nThe above solution works only if the <code>mMyObject</code> is declared in the same scope <code>createShortcuts</code> is declared, the below is safer.</p>\n\n<pre><code>  auto createShortcuts = [ = ]( const QString &amp;sequence, const MyObject* mMyObject, void ( MyObject::* myFunc )() )\n  {\n    QShortcut *sc = new QShortcut( QKeySequence( sequence ), this );\n    connect( sc, &amp;QShortcut::activated, mMyObject, myFunc);\n  };\n  auto obj = new MyObject();\n  createShortcuts( QStringLiteral( \"whatever\" ), obj, &amp;MyObject::mySlot );\n</code></pre>\n"}], "owner": {"reputation": 1651, "user_id": 1548052, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8b9a9309ea3ed901b3118852bfe57cbc?s=128&d=identicon&r=PG", "display_name": "Denis Rouzaud", "link": "https://stackoverflow.com/users/1548052/denis-rouzaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 56260494, "answer_count": 1, "score": 2, "last_activity_date": 1558540428, "creation_date": 1558539145, "last_edit_date": 1558539530, "question_id": 56260361, "link": "https://stackoverflow.com/questions/56260361/a-slot-as-a-paramater-in-a-lambda-function-in-c-qt", "title": "A slot as a paramater in a lambda function in C++ / Qt", "body": "<p>I have a lambda method which I would like to receive a slot as a parameter</p>\n\n<p>I have ended up with:</p>\n\n<pre><code>  auto createShortcuts = [ = ]( const QString &amp;sequence, const std::function &lt; void () &gt; &amp;slot  )\n  {\n    QShortcut *sc = new QShortcut( QKeySequence( sequence ), this );\n    connect( sc, &amp;QShortcut::activated, mMyObject, slot );\n  };\n\n  createShortcuts( QStringLiteral( \"whatever\" ), [=](){mMyObject-&gt;mySlot();} );\n</code></pre>\n\n<p>But I would prefer avoid using a lambda slot when calling createShortcuts. Rather something like</p>\n\n<pre><code>  auto createShortcuts = [ = ]( const QString &amp;sequence, void ( MyObject::* )() )\n  {\n    QShortcut *sc = new QShortcut( QKeySequence( sequence ), this );\n    connect( sc, &amp;QShortcut::activated, mMyObject, ??? );\n  };\n\n  createShortcuts( QStringLiteral( \"whatever\" ), &amp;MyObject::mySlot );\n</code></pre>\n\n<p>But I couldn't find the proper syntax to call the slot.</p>\n"}, {"tags": ["python", "c++", "qt", "pyside2", "qwebengineview"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1558551286, "post_id": 56260319, "comment_id": 99142911, "body": "In my case the image is progressively showing but when a certain threshold passes the image disappears, which I suspect is that the image is so heavy that Qt WebEngine does not support it, I am looking at the docs the limit of the size of the images that can be handled Qt or Qt WebEngine."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1558551710, "post_id": 56260319, "comment_id": 99143086, "body": "For example in X11 QPixmap is limited to 32768x32768 <a href=\"https://code.qt.io/cgit/qt/qtbase.git/tree/src/plugins/platforms/xcb/nativepainting/qpixmap_x11.cpp#n492\" rel=\"nofollow noreferrer\">code.qt.io/cgit/qt/qtbase.git/tree/src/plugins/platforms/xcb&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 121, "user_id": 5932531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZbYTe.jpg?s=128&g=1", "display_name": "Krzysztof Sakowski", "link": "https://stackoverflow.com/users/5932531/krzysztof-sakowski"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1558591668, "post_id": 56260319, "comment_id": 99153125, "body": "@eyllanesc The image I am using in the code sample is only 5400\u200a&#215;\u200a2700 so it is within QPixmap limits. I have experienced issues with smaller images, it is simply easier to reproduce the issue with larger image."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1558591857, "post_id": 56260319, "comment_id": 99153177, "body": "The limit that indicates only a reference, probably Qt WebEngine has other limits, later I will test the example in C++ to rule out that the problem is the binding of PySide2, if so it is probably a bug or limitation of Qt WebEngine"}, {"owner": {"reputation": 121, "user_id": 5932531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZbYTe.jpg?s=128&g=1", "display_name": "Krzysztof Sakowski", "link": "https://stackoverflow.com/users/5932531/krzysztof-sakowski"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 2, "creation_date": 1558594536, "post_id": 56260319, "comment_id": 99154153, "body": "@eyllanesc I have been trying adding a timer of 300ms between loadFinished signal and save function and it helps for this code snippet but it does not look like a reliable solution. I am looking for some kind of signal or event stating &quot;view is ready you can take the screenshot now&quot;."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1558627564, "post_id": 56260319, "comment_id": 99172407, "body": "If you react on <code>loadFinished()</code>, your issue might be caused due to snapshot-ing before rendering is completed. This sounds to me, like there are still pending update events in the event queue when you make the snapshot. If that&#39;s true, the solution is not that complicated: Make the snapshot via a single-shot timer (with timeout 0) because this should appear at end of queue i.e. after all pending rendering events. (I must admit that I&#39;ve no experience with QWebEngine - just some experience with Qt in general.)"}, {"owner": {"reputation": 121, "user_id": 5932531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZbYTe.jpg?s=128&g=1", "display_name": "Krzysztof Sakowski", "link": "https://stackoverflow.com/users/5932531/krzysztof-sakowski"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1558681077, "post_id": 56260319, "comment_id": 99187465, "body": "FYI: @eyllanesc C++ version of the code snippet: <a href=\"https://pastebin.com/cH7ZgFDB\" rel=\"nofollow noreferrer\">pastebin.com/cH7ZgFDB</a>"}, {"owner": {"reputation": 121, "user_id": 5932531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZbYTe.jpg?s=128&g=1", "display_name": "Krzysztof Sakowski", "link": "https://stackoverflow.com/users/5932531/krzysztof-sakowski"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1558681212, "post_id": 56260319, "comment_id": 99187524, "body": "@Scheff thanks for the tip. I tried that. Unfortunately 0 does not fix the issue. I was able to get correct results with ~300ms, but that is not really a solution."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1558690275, "post_id": 56260319, "comment_id": 99192034, "body": "I had a look onto the doc. of <code>QWebEngine</code>. It seems there is nothing that is signaled after rendering has been completed. (The only thing I found was <code>QWebEngineView::renderProcessTerminated()</code> which isn&#39;t helpful for your issue.) I&#39;m afraid that there is no such thing because, actually, there is no such point as a web page may periodically be updated (e.g. for rendering gif animations). Hence, your 300 ms might be the best you can get. (Tracking paintEvents is probably as good or bad for the same reasons.)"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 1, "creation_date": 1559180161, "post_id": 56260319, "comment_id": 99343549, "body": "Did you try with JavaScript .. <a href=\"https://stackoverflow.com/questions/33467776/qt-qwebengine-render-after-scrolling\" title=\"qt qwebengine render after scrolling\">stackoverflow.com/questions/33467776/&hellip;</a>"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 1, "creation_date": 1559180254, "post_id": 56260319, "comment_id": 99343570, "body": "<a href=\"https://stackoverflow.com/questions/821516/browser-independent-way-to-detect-when-image-has-been-loaded\" title=\"browser independent way to detect when image has been loaded\">stackoverflow.com/questions/821516/&hellip;</a>"}, {"owner": {"reputation": 121, "user_id": 5932531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZbYTe.jpg?s=128&g=1", "display_name": "Krzysztof Sakowski", "link": "https://stackoverflow.com/users/5932531/krzysztof-sakowski"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 1, "creation_date": 1559313378, "post_id": 56260319, "comment_id": 99392620, "body": "@MohammadKanan I tried similar solution with intercepting Qt paint events from <a href=\"https://stackoverflow.com/questions/30566101/how-can-i-get-paint-events-with-qtwebengine\" title=\"how can i get paint events with qtwebengine\">stackoverflow.com/questions/30566101/&hellip;</a> and it did not work."}, {"owner": {"reputation": 171, "user_id": 3219089, "user_type": "registered", "profile_image": "https://graph.facebook.com/1209716101/picture?type=large", "display_name": "Ivan", "link": "https://stackoverflow.com/users/3219089/ivan"}, "edited": false, "score": 0, "creation_date": 1571901568, "post_id": 56260319, "comment_id": 103394901, "body": "You can try with <code>QWebEnginePage::contentsSizeChanged</code>. It is emitted two or more times during rendering with different size in the parameter. The first time the size is equal to the initial view size."}], "owner": {"reputation": 121, "user_id": 5932531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZbYTe.jpg?s=128&g=1", "display_name": "Krzysztof Sakowski", "link": "https://stackoverflow.com/users/5932531/krzysztof-sakowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1560256126, "creation_date": 1558539006, "last_edit_date": 1560256126, "question_id": 56260319, "link": "https://stackoverflow.com/questions/56260319/how-ensure-qwebengineview-is-fully-rendered-before-taking-screenshot", "title": "How ensure QWebEngineView is fully rendered before taking screenshot?", "body": "<p>I want to take a screenshot of <code>QWebEngineView</code> for a page with a large image. When running code below red background is rendered correctly but the image is not. </p>\n\n<p>How can I ensure the page is fully rendered before taking a screenshot?</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from PySide2 import QtCore, QtWidgets, QtWebEngineWidgets\n\nhtml = \"\"\"\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n  &lt;meta charset=\"UTF-8\"&gt;\n  &lt;style&gt;\n  img { max-width:100%; max-height:100%; }\n  div { height: 270px; width: 540px; }\n  body { margin: 0; background-color: red; }\n  &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div&gt;\n  &lt;img src=\"https://eoimages.gsfc.nasa.gov/images/imagerecords/73000/73751/world.topo.bathy.200407.3x5400x2700.png\"&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\"\"\"\n\nclass Capture(QtWebEngineWidgets.QWebEngineView):\n  def __init__(self, parent=None):\n    super(Capture, self).__init__(parent)\n\n    self.loadFinished.connect(self.save)\n    self.show()\n    self.resize(540, 270+5)\n\n  @QtCore.Slot(bool)\n  def save(self, isOk):\n    if not isOk:\n      print('Error')\n      return\n\n    self.grab().save('page.png', b'PNG')\n\nif __name__ == '__main__':\n  app = QtWidgets.QApplication()\n  capture = Capture()\n  capture.setHtml(html)\n  app.exec_()\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Equivalent code snippet in C++: <a href=\"https://pastebin.com/cH7ZgFDB\" rel=\"nofollow noreferrer\">https://pastebin.com/cH7ZgFDB</a></p>\n\n<p>EDIT 2:</p>\n\n<p>I have opened <a href=\"https://bugreports.qt.io/browse/QTBUG-76183\" rel=\"nofollow noreferrer\">ticket</a> in Qt bug tracking system.</p>\n"}, {"tags": ["c++", "stream"], "answers": [{"tags": [], "owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "is_accepted": true, "score": 7, "last_activity_date": 1558539046, "creation_date": 1558539046, "answer_id": 56260338, "question_id": 56260154, "link": "https://stackoverflow.com/questions/56260154/delayed-stream-invalidation-in-a-loop/56260338#56260338", "title": "Delayed stream invalidation in a loop", "body": "<p>It's because it successfully reads the <code>2</code> part of the <code>2.53</code> into <code>a</code>. It then loops back round again, tries to do something with the <code>.</code> and then drops out of the loop.</p>\n\n<p>You can see this in action if you also log what was read, i.e.:</p>\n\n<pre><code>while (cin &gt;&gt; a)\n{\n    cout &lt;&lt; a &lt;&lt; \" \" &lt;&lt; ++count &lt;&lt; endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 10115137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g6PMU.png?s=128&g=1", "display_name": "lineage", "link": "https://stackoverflow.com/users/10115137/lineage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 56260338, "answer_count": 1, "score": 2, "last_activity_date": 1558539046, "creation_date": 1558538456, "question_id": 56260154, "link": "https://stackoverflow.com/questions/56260154/delayed-stream-invalidation-in-a-loop", "title": "Delayed stream invalidation in a loop", "body": "<p>A program reads <code>int</code> values via <code>cin</code> and displays their count. <code>cin</code> is used as the <code>while</code> loop test.</p>\n\n<p>Strangely, even with a non-integral input the loop increments the count i.e. the loop executes at least once even after stream invalidation before exiting. </p>\n\n<p>In other words, for input</p>\n\n<pre><code>2.53\n</code></pre>\n\n<p>ouput is</p>\n\n<pre><code>1\n</code></pre>\n\n<p>As per <em>C++ Primer,5e by Lippman, Lajoie, Moo</em></p>\n\n<blockquote>\n  <blockquote>\n    <p>When we use an istream as a condition, the effect is to test the state of the\n    stream. If the stream is valid\u2014that is, if the stream hasn\u2019t encountered an error\u2014then\n    the test succeeds. An istream becomes invalid when we hit end-of-file or encounter\n    an <strong>invalid input</strong>, such as reading a value that is not an integer. An istream that is in\n    an invalid state will cause the condition to yield false.</p>\n  </blockquote>\n</blockquote>\n\n<p>Since the stream is invalidated upon trying to read a double, why does the loop execute anyways and then exit only in the next  iteration?</p>\n\n<p><strong>Code</strong></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\nusing std::cin;\nusing std::cout;\nusing std::endl;\nint main()\n{\n\n    int a;\n    int count = 0;\n    while (cin &gt;&gt; a)\n        cout &lt;&lt; ++count &lt;&lt; endl;\n\n    return 0;\n}\n\n</code></pre>\n\n<p>Beginner so any help is thoroughly appreciated.</p>\n"}, {"tags": ["c++", "textures", "sdl", "sdl-2"], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1559288874, "post_id": 56369658, "comment_id": 99380643, "body": "I already tried this attempt, I was dropping frames this way."}, {"owner": {"reputation": 6715, "user_id": 2899280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4458bb90b869271c5787c7e600b4ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Allred", "link": "https://stackoverflow.com/users/2899280/brad-allred"}, "reply_to_user": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 1, "creation_date": 1559325450, "post_id": 56369658, "comment_id": 99397989, "body": "@J.Panek If you tried a render texture why did you not say so in your question? I will update my answer with an alternative for software rendering directly to the window, but I dont know if it would actually help performance."}, {"owner": {"reputation": 6715, "user_id": 2899280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4458bb90b869271c5787c7e600b4ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Allred", "link": "https://stackoverflow.com/users/2899280/brad-allred"}, "reply_to_user": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1559325492, "post_id": 56369658, "comment_id": 99398004, "body": "@J.Panek you could also try disabling vsync. does that help?"}, {"owner": {"reputation": 6715, "user_id": 2899280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4458bb90b869271c5787c7e600b4ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Allred", "link": "https://stackoverflow.com/users/2899280/brad-allred"}, "reply_to_user": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1559326880, "post_id": 56369658, "comment_id": 99398489, "body": "@J.Panek updated answer with a couple of other ideas. if you can batch your drawing that should help a noticeable amount."}, {"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1559542838, "post_id": 56369658, "comment_id": 99438919, "body": "In the question I wrote about my attempt on a render texture: <i>I tried rendering the new content to a texture, copy it to the renderer and then render, but this did not work at all</i>, maybe I expressed myself badly here. Your answer helped me a lot, Thank you for that, now only tearing issues remain."}, {"owner": {"reputation": 6715, "user_id": 2899280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4458bb90b869271c5787c7e600b4ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Allred", "link": "https://stackoverflow.com/users/2899280/brad-allred"}, "reply_to_user": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1559575003, "post_id": 56369658, "comment_id": 99454822, "body": "@J.Panek you are welcome. Sorry for the confusion. You may want to look into some of the batching concepts to increase performance further. If you have tearing it sounds like probably you need vsync, but that will be a performance penalty."}, {"owner": {"reputation": 2476, "user_id": 325464, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e29e86208d91a3532ed796bf6d70446?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/325464/bob"}, "edited": false, "score": 0, "creation_date": 1563629445, "post_id": 56369658, "comment_id": 100767479, "body": "I think batching is only available in 2.0.10 (not 2.0.9) which is now in pre-release."}], "tags": [], "owner": {"reputation": 6715, "user_id": 2899280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4458bb90b869271c5787c7e600b4ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Allred", "link": "https://stackoverflow.com/users/2899280/brad-allred"}, "is_accepted": true, "score": 3, "last_activity_date": 1559333049, "last_edit_date": 1592644375, "creation_date": 1559171509, "answer_id": 56369658, "question_id": 56260097, "link": "https://stackoverflow.com/questions/56260097/how-to-use-sdl2-texture-as-sort-of-updating-canvas/56369658#56369658", "title": "How to use SDL2 Texture as sort of updating canvas?", "body": "<p>You probably have a couple of options that can help:</p>\n<h1>Use a texture render target</h1>\n<p>You ought to be able to accomplish this using a &quot;render target texture&quot;. That is an <code>SDL_Texture</code> you create (see <code>SDL_CreateTexture</code>) with the <code>SDL_TEXTUREACCESS_TARGET</code> flag.</p>\n<p>You would draw new points to this texture by calling <code>SDL_SetRenderTarget</code> and passing this texture before then rendering the points.</p>\n<p>your main loop would then need to call <code>SDL_SetRenderTarget</code> and pass <code>nullptr</code> to restore the window as the rendering target. You then render your texture to the window every frame.</p>\n<p>The <a href=\"https://wiki.libsdl.org/SDL_CreateTexture\" rel=\"nofollow noreferrer\">SDL documentation</a> has a small sample demoing how to use a render target texture.</p>\n<h1>update to SDL 2.0.9 and use render batching</h1>\n<p>the latest version of SDL 2 supports render batching if you set <code>SDL_HINT_RENDER_BATCHING</code> (<code>SDL_SetHint(SDL_HINT_RENDER_BATCHING, &quot;1&quot;);</code>). You should use <code>SDL_CreateWindowAndRenderer()</code> to ensure you have batching enabled.</p>\n<p>This may not do anything if your platform doesnt support hardware acceleration. You can use this in conjunction with a render target. read about SDL render batching <a href=\"https://www.patreon.com/posts/project-sdl-21856507\" rel=\"nofollow noreferrer\">here</a>.</p>\n<h1>Batch your rects/points together</h1>\n<p>This is separate from render batching and should work on any version of SDL 2.</p>\n<p>If you can, collect all your rectangles/points together in an array you can use\n<code>SDL_RenderDrawPoints</code> or <code>SDL_RenderDrawRects</code> to have SDL do them all at once which should improve performance even if you have no hardware acceleration. This can be used in conjunction with a render target.</p>\n<h1>Ditch SDL_Renderer/SDL_Texture</h1>\n<p>If your device lacks hardware acceleration, then it might be faster to ditch SDL_Renderer and instead use <code>SDL_GetWindowSurface</code> to get the <code>SDL_Surface</code> for the window and use <code>SDL_BlitSurface</code> (or manually set pixels via <code>surface-&gt;pixels</code>) to draw directly to that then update the window with <code>SDL_UpdateWindowSurface</code>. See also <code>SDL_UpdateWindowSurfaceRects</code> for how to only update the rectangles you are changing for even better performance.</p>\n<p>You will need to <a href=\"https://wiki.libsdl.org/SDL_Surface\" rel=\"nofollow noreferrer\">familiarize yourself</a> with <code>SDL_Surface</code> as you will need to inspect the pixel format of the window surface in order to update it correctly should you choose to directly manipulate the pixels.</p>\n"}], "owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1329, "favorite_count": 1, "accepted_answer_id": 56369658, "answer_count": 1, "score": 4, "last_activity_date": 1559333049, "creation_date": 1558538262, "question_id": 56260097, "link": "https://stackoverflow.com/questions/56260097/how-to-use-sdl2-texture-as-sort-of-updating-canvas", "title": "How to use SDL2 Texture as sort of updating canvas?", "body": "<p>I am trying to create a dynamic plotter in SDL2 for an embedded project. Currently, the code executes on both architectures, x86, and ARM. On x86 I get a smooth running plotter, however, on ARM it runs very slow at a fraction of the frames I get on x86. I am pretty sure this is because I rerender every pixel on the surface at this is a massive overheat on the embedded device.</p>\n\n<p>I tried rendering the new content to a texture, copy it to the renderer and then render, but this did not work at all.</p>\n\n<p>Due to the double-buffering, I have to clear every frame. Otherwise, I will \"drop\" changes. But I also need to render the old data points and only overwrite them when the plotter reaches them again.</p>\n\n<p>Is there a way in SDL2 to save these data points to some sort of canvas and only add (redraw) the newly added ones?</p>\n\n<p>Heres my source code:</p>\n\n<p><strong>Plotter.cpp</strong></p>\n\n<pre><code>#include &lt;SDL2/SDL.h&gt;\n#include &lt;stdio.h&gt;\n#include \"PlotterHelper.h\"\n\n/*Implementation*/\nint main(int arhc, char * argv[])\n{\n    //Top and bottom viewport\n    SDL_Rect topViewport;\n    SDL_Rect bottomViewport;\n    topViewport = CreateViewPort(0,0, SCREEN_WIDTH, (SCREEN_HEIGHT/2));\n    bottomViewport = CreateViewPort(0,(SCREEN_HEIGHT/2), SCREEN_WIDTH, SCREEN_HEIGHT/2);\n\n    float timeFrame = 4.0;\n    int updateWidth = round(SCREEN_WIDTH/(60.0 * timeFrame));\n\n\n    uint8_t backgroundColor = 0xff;\n\n    int delayTime = 0;\n    int sinusScale = 0;\n    int rectWidth = RECT_WIDTH;\n    bool rectEnd = false;\n\n    SDL_Point points[SCREEN_WIDTH] = {0,0};\n    int pointPosition = 0;\n\n    if (!init())\n    {\n        printf(\"Init failed!\\n\");\n    }\n    else\n    {\n\n        SDL_ShowCursor(SDL_DISABLE);\n        //Main lopp flag\n        bool quit = false;\n        //Event handler\n        SDL_Event event;\n\n        //While application is running\n        while(!quit)\n        {\n            //Handle events on queue\n            while (SDL_PollEvent( &amp;event) != 0)\n            {\n                //User requests quit\n                if(event.type == SDL_QUIT)\n                {\n                    quit = true;\n                }\n                else if(event.type == SDL_KEYDOWN)\n                {\n                    switch(event.key.keysym.sym)\n                    {\n                    case SDLK_w:\n                        delayTime += 50;\n                        if(delayTime &gt; 5000)\n                            delayTime = 5000;\n                        break;\n                    case SDLK_s:\n                        delayTime -= 50;\n                        if(delayTime &lt; 0)\n                            delayTime = 0;\n                        break;\n                    case SDLK_d:\n                        timeFrame -= 1;\n                        if(timeFrame &lt; 1)\n                            timeFrame = 1.0;\n                        updateWidth = round(SCREEN_WIDTH/(60.0 * timeFrame));\n                        printf(\"timeFrame = %lf\\n\", timeFrame);\n                        break;\n                    case SDLK_a:\n                        timeFrame += 1;\n                        if(timeFrame &gt; 44)\n                            timeFrame = 44.0;\n                        updateWidth = round(SCREEN_WIDTH/(60.0 * timeFrame));\n                        printf(\"timeFrame = %lf\\n\", timeFrame);\n                        break;\n                    case SDLK_r:\n                        if(backgroundColor == 0x3f)\n                            break;\n                        else\n                        {\n                            ++backgroundColor;\n                            break;\n                        }\n                    case SDLK_f:\n                        if(backgroundColor == 0x00)\n                                break;\n                        else\n                        {\n                            --backgroundColor;\n                            break;\n                        }\n                    }\n                }\n            }\n\n            //Reset Plotter when the end of the window was reached\n            if(pointPosition &gt; SCREEN_WIDTH-1)\n            {\n                pointPosition = 0;\n                sinusScale = (rand() % 100 + 1) - 50;\n                rectWidth = RECT_WIDTH;\n                rectEnd = false;\n            }\n\n            //Handler eraser when he reaches end of window\n            if(((SCREEN_WIDTH-1) - pointPosition) &lt; RECT_WIDTH)\n            {\n                rectWidth = (SCREEN_WIDTH -1) - pointPosition;\n                rectEnd = true;\n\n            }\n\n\n            //Clear screen\n            SDL_SetRenderDrawColor(gRenderer, backgroundColor, backgroundColor, backgroundColor, 0xff);\n            SDL_RenderClear(gRenderer);\n\n\n            //Draw top viewport\n            SDL_RenderSetViewport( gRenderer, &amp;topViewport );\n\n            SDL_SetRenderDrawColor(gRenderer, 0x00, 0x66, 0x00, 0xff);\n            for(int iterator = 0; iterator &lt;= SCREEN_WIDTH -1; ++iterator)\n            {\n                SDL_RenderDrawLine(\n                        gRenderer,\n                        points[iterator].x,\n                        0,\n                        points[iterator].x,\n                        SCREEN_HEIGHT/2);\n            }\n\n            PlotEraser(rectEnd, backgroundColor, rectWidth,points[pointPosition].x );\n\n            //raw bottom viewport\n            SDL_RenderSetViewport( gRenderer, &amp;bottomViewport );\n\n            SDL_SetRenderDrawColor(gRenderer, 0x00, 0x66, 0x00, 0xff);\n            for(int iterator = 0; iterator &lt;= SCREEN_WIDTH -1; ++iterator)\n                {\n                    SDL_RenderDrawLine(\n                            gRenderer,\n                            points[iterator].x,\n                            SCREEN_HEIGHT/2,\n                            points[iterator].x,\n                            points[iterator].y);\n                }\n\n            PlotEraser(rectEnd, backgroundColor, rectWidth,points[pointPosition].x );\n\n\n            for(int iterator = pointPosition; iterator &lt;= pointPosition + updateWidth; ++iterator)\n            {\n                points[iterator].x = iterator;\n                points[iterator].y = round(((SCREEN_HEIGHT/4 )* sin(iterator/(100.0+sinusScale))) + SCREEN_HEIGHT/4);\n            }\n            pointPosition += updateWidth;\n\n            //Update Screen\n            SDL_RenderPresent(gRenderer);\n\n            SDL_Delay(delayTime);\n        }\n\n    }\n\n    //Free resources and close SDL\n    close();\n\n    return 0;\n}\n\n/*End of File*/\n\n</code></pre>\n\n<p><strong>PlotterHelper.cpp</strong></p>\n\n<pre><code>/*Includes*/\n\n#include \"PlotterHelper.h\"\n\nSDL_Window  * gWindow = NULL;\nSDL_Renderer * gRenderer = NULL;\nSDL_Renderer * intermediate = NULL;\n\n/*Implementation*/\n\n/*********************************************************************\n *********************************************************************\n *********************************************************************\n*/\nbool init()\n{\n    //Init  flag\n    bool success = true;\n\n    //Init SDL\n    if(SDL_Init(SDL_INIT_VIDEO) &lt; 0)\n    {\n        printf( \"SDL could not initialize! SDL_Error: %s\\n\", SDL_GetError() );\n        success = false;\n    }\n    else\n    {\n        //Set texture filtering to linear\n        if( !SDL_SetHint( SDL_HINT_RENDER_SCALE_QUALITY, \"1\" ) )\n        {\n            printf( \"Warning: Linear texture filtering not enabled!\" );\n        }\n\n        //Set VSYNC\n        if( !SDL_SetHint( SDL_HINT_RENDER_VSYNC, \"1\" ) )\n        {\n            printf( \"Warning: VSYNC not enabled!\" );\n        }\n\n        //Create window\n        gWindow = SDL_CreateWindow(\n                \"SDL Plotter\",\n                SDL_WINDOWPOS_UNDEFINED,\n                SDL_WINDOWPOS_UNDEFINED,\n                SCREEN_WIDTH,\n                SCREEN_HEIGHT,\n                SDL_WINDOW_SHOWN );\n        if (NULL == gWindow)\n        {\n            printf( \"Window could not be created! SDL_Error: %s\\n\", SDL_GetError() );\n            success = false;\n        }\n        else\n        {\n            //Create renderer for window\n            gRenderer = SDL_CreateRenderer(gWindow, -1, SDL_RENDERER_ACCELERATED );\n            if(NULL == gRenderer)\n            {\n                printf(\"Renderer could not be created! SDLError: %s\\n\", SDL_GetError());\n                success = false;\n            }\n            else\n            {\n                //Initialise renderer colour\n                SDL_SetRenderDrawColor(gRenderer, 0xff, 0xff, 0xff, 0xff);\n            }\n\n        }\n    }\n    return success;\n}\n\n/*********************************************************************\n *********************************************************************\n *********************************************************************\n*/\nvoid close()\n{\n    //Destroy window\n    SDL_DestroyRenderer(gRenderer);\n    SDL_DestroyWindow(gWindow);\n    gRenderer = NULL;\n    gWindow = NULL;\n\n    //Quit SDL subsystems\n    SDL_Quit();\n}\n\n/*********************************************************************\n *********************************************************************\n *********************************************************************\n*/\n\nSDL_Rect CreateViewPort(int x, int y, int w, int h)\n{\n    SDL_Rect Viewport;\n    Viewport.x = x;\n    Viewport.y = y;\n    Viewport.w = w;\n    Viewport.h = h;\n\n    return Viewport;\n}\n/*********************************************************************\n *********************************************************************\n *********************************************************************\n*/\nvoid PlotEraser(bool rectEnd, uint8_t backgroundColor, int rectWidth, int x)\n{\n    SDL_Rect fillRectBot = {x, 0, rectWidth, SCREEN_HEIGHT/2};\n\n    SDL_SetRenderDrawColor(gRenderer, backgroundColor, backgroundColor, backgroundColor, 0xff);\n    SDL_RenderFillRect(gRenderer, &amp;fillRectBot);\n\n    if(rectEnd)\n    {\n        int startRecWidth = RECT_WIDTH - rectWidth;\n\n        SDL_Rect startRec = {0, 0, startRecWidth, SCREEN_HEIGHT/2};\n        SDL_RenderFillRect(gRenderer, &amp;startRec);\n    }\n}\n\n/*End of File*/\n\n</code></pre>\n\n<p><strong>PlotterHelper.h</strong></p>\n\n<pre><code>\n\n#ifndef PLOTTER_HELPER_H_\n#define PLOTTER_HELPER_H_\n\n#include &lt;SDL2/SDL.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;cmath&gt;\n#include &lt;string&gt;\n/*Globals*/\n\n//Screen  constants\nconst int SCREEN_WIDTH = 1024;\nconst int SCREEN_HEIGHT = 768;\nconst int RECT_WIDTH = 10;\n\n//The window we'll be rendering to\nextern SDL_Window * gWindow;\n//The window renderer\nextern SDL_Renderer * gRenderer;\nextern SDL_Renderer * intermediate;\n\n\n/*Prototypes*/\n/*********************************************************************\n *********************************************************************\n *********************************************************************\n*/\n//Starts up SDL and creates window\nbool init();\n/*********************************************************************\n *********************************************************************\n *********************************************************************\n*/\n//Free media and shut down SDL\nvoid close();\n/*********************************************************************\n *********************************************************************\n *********************************************************************\n*/\n//CreateVieport\nSDL_Rect CreateViewPort(int x, int y, int w, int h);\n/*********************************************************************\n *********************************************************************\n *********************************************************************\n*/\n//Plot Eraser\nvoid PlotEraser(bool rectEnd, uint8_t backgroundColor, int rectWidth, int x);\n#endif /* PLOTTER_HELPER_H_ */\n/*End of File*/\n\n</code></pre>\n"}, {"tags": ["python", "c++", "c", "python-c-api"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558539915, "post_id": 56260096, "comment_id": 99137701, "body": "Is your test code supposed to be <code>if &#39;word&#39; in iterable():</code>, or did you mean <code>if &#39;word&#39; in item:</code> as before? As written, <code>if &#39;word&#39; in iterable():</code> is nonsensical."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558541535, "post_id": 56260096, "comment_id": 99138617, "body": "Never mind; I checked your full code and it makes sense (sort of) now. It&#39;s costing you performance to implement it that way though; I&#39;ve updated <a href=\"https://stackoverflow.com/a/56260851/364696\">my answer</a> to address that."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558542575, "post_id": 56260096, "comment_id": 99139152, "body": "FYI, <a href=\"https://github.com/evandrocoan/fastfilepackage/blob/c919b6084f4a46ad453b9353bcdb052d502fc278/source/fastfile.cpp#L85\" rel=\"nofollow noreferrer\">this is a memory leak waiting to happen</a>. If <code>next</code> and <code>call</code> aren&#39;t perfectly paired, then <code>next</code> fails to decref the line it discards; you avoid the leak while they&#39;re paired only because <code>call</code> is eventually returning an owned reference to the string (meaning your cache is now a borrowed reference), so the <code>pop_front</code> doesn&#39;t leak. And if you call <code>call</code> more than once, you return the same pointer twice, with only one owning reference, which will lead to double free."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 1, "creation_date": 1558551538, "post_id": 56260096, "comment_id": 99143009, "body": "100MB log file &#225; 100-300 characters per line result in about 500K lines. This means that about 500K times a zero terminated C string is converted into a Python Unicode string and then processed in Python. If performance is the primary objective, it may be better to either have the processing in C and pass only the result to Python, or to perform the processing entirely in Python. Presumable both variants should be faster than this approach with 500K calls into native C."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "edited": false, "score": 0, "creation_date": 1558575544, "post_id": 56260096, "comment_id": 99149955, "body": "<b>If <code>next</code> and <code>call</code> aren&#39;t perfectly paired, then next fails to decref the line it discards</b>, Can I fix this just calling <code>Py_XDECREF(linecache[0])</code> before <code>linecache.pop_front()</code>? I did a <a href=\"https://github.com/evandrocoan/fastfilepackage/commit/d0c823bdbb056847143d752d8c455cae90debb96\" rel=\"nofollow noreferrer\">new commit</a> with this change."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "edited": false, "score": 0, "creation_date": 1558575556, "post_id": 56260096, "comment_id": 99149958, "body": "<b>And if you call <code>call</code> more than once, you return the same pointer twice, with only one owning reference, which will lead to double free</b>, Currently, I am calling <code>Py_XINCREF</code> on every value returned by call on <code>fastfilewrapper.cpp</code>. Would not this fix it?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1558623831, "post_id": 56260096, "comment_id": 99170482, "body": "@user: &quot;Currently, I am calling Py_XINCREF on every value returned by call on fastfilewrapper.cpp&quot;. Ah, I missed that part. Usually, the person returning the value in the first place increfs it, because borrowed vs. owned is part of the closest level API contract. I&#39;ll note that <code>Py_XDECREF</code> should probably be <code>Py_CLEAR</code> if you want to remove the risk of some other bug causing a double-free (<code>Py_CLEAR</code> is <code>Py_XDECREF</code> followed by setting the value to <code>NULL</code>)."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 1, "creation_date": 1558628040, "post_id": 56260096, "comment_id": 99172650, "body": "@StephanSchlecht I just benchmarked the <code>std::getline</code> against Posix <code>getline</code> and <code>std::getline</code> is 2.5 times slower than Python builtin readline, while Posix <code>getline</code> (not available on msvc) is only 1.5 times slower than Python builtin <code>getline</code>. On these results, I am excluding the conversion from <code>c string</code> to Python Unicode. When enabling the conversion from <code>c string</code> to Python Unicode, it only added 0.4 of slow down, then <code>std::getline</code> was 2.9 slower, while Posix <code>getline</code> was 1.9 slower. Indeed, the bottleneck is more the getline implementation used other than Python and C interface."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558646105, "post_id": 56260096, "comment_id": 99180022, "body": "That&#39;s interesting. On *nix-like operating systems, when scanning larger text files, I would expect a simple C-loop with &#39;readline&#39; and &#39;strstr&#39; to be almost twice as fast as the Python equivalent shown, where C doesn&#39;t work with Unicode, so Python actually doesn&#39;t do so badly. The functionality on which something like this is based (such as &#39;readline&#39; and &#39;strstr&#39;) is usually highly optimized and is therefore not easy to beat with custom implementations (unless you have special cases). I would therefore assume that additional operations like string conversion etc. can simply slow them down."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558652703, "post_id": 56260096, "comment_id": 99181724, "body": "@StephanSchlecht, I just noticed I forgot to compile the Posix C <code>getline</code> with <code>-O2</code>.  I was compiling it with <code>-O0</code>. Now both Python and Posix C are using <code>-O2</code> they matched the <code>1:1</code>, i.e., no one was faster than the other. When I also set to do the conversion from the <code>C String</code> to <code>Python Object</code> the program runs <code>1.3</code> times slower. That is what I am losing of performance for not building a Python Unicode string from the start, as the builtin Python method <code>for line in file</code> is doing."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558655283, "post_id": 56260096, "comment_id": 99182224, "body": "@StephanSchlecht, I just managed to optimize my Posix C <code>getline</code> usage (by caching the total buffer size instead of always passing 0) and now the Posix C <code>getline</code> beats the Python builtin <code>for line in file</code> by <code>5%</code>. I guess if I remove all Python and C++ code around the Posix C <code>getline</code>, it should gain some more performance."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558657055, "post_id": 56260096, "comment_id": 99182510, "body": "@StephanSchlecht, I also was compiling the benchmarks I did with <code>std::getline</code> using <code>-O0</code> instead of <code>-O2</code>. Sadly, its performance still bad, but now it is only <code>35%</code> slower than the Python builtin C <code>for line in file</code>. However, I manage to improve the C++ performance to only <code>9%</code> slower than the builtin Python C <code>for line in file</code> by replacing the usage of <code>std::getline</code> by <code>std::ifstream.getline()</code>."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558659738, "post_id": 56260096, "comment_id": 99182929, "body": "@StephanSchlecht, I was not caching the <code>std::getline</code> input string, then the performance was bad. Now I posted my codes as <a href=\"https://stackoverflow.com/a/56284547/4934640\">an answer</a> for proper understanding."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558772014, "post_id": 56260096, "comment_id": 99217208, "body": "Quicktest of 10M lines with approx 200 chars parsing, counting bytes and lines containing substring &#39;word&#39;: Simple C with readlines/strstr loop, a pure python solution and the last one with C extension (readline in C, subtring search in Python): simple c: 4.31s (3.46s user / 0.84 sys) vs. pure python: 10.81s (9.99 user / 0.80 sys)  vs c-extension: 11.28s (10.28 user / 0.96 sys) I expected the difference between pure C and Python solutions, interesting for me (as you said before) is that the C extension solution is almost equivalent to the pure Python solution."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558772416, "post_id": 56260096, "comment_id": 99217305, "body": "For me this means, if performance is the most important criterion, I stil would recommend to do the calculation purely on C side and only return the result. Otherwise you can work purely with Python, because I/O is done by highly optimized routines anyway, so you only get (slightly) slower if you only move I/O to C, but have a much more complex code."}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558542179, "post_id": 56260851, "comment_id": 99138956, "body": "Extremely minor performance tip: As a rule, C++ templates can&#39;t specialize to actual functions, only to function prototypes, which means the function ends up being called through a pointer, which is slightly slower than a direct call. Functors (and lambdas, which are syntactic sugar for functors) are unique types though, and the template fully specializes for them. You may gain a little by changing code like <code>(self-&gt;cppobjectpointer)-&gt;call( PyUnicode_DecodeUTF8 );</code> to <code>(self-&gt;cppobjectpointer)-&gt;call( [](const char *s, Py_ssize_t sz, const char *e) { return PyUnicode_DecodeUTF8(s, sz, e); });</code>"}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "edited": false, "score": 0, "creation_date": 1558575239, "post_id": 56260851, "comment_id": 99149900, "body": "<b>tp_call is not nearly so cheap, going through convoluted general purpose code paths</b>, I use <code>call()</code> because it is much more optimized than a simple <code>object.function()</code> call. But now, I stopped returning None from <code>tp_next</code> and I am actually returning the first object. Thanks!"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 2, "last_activity_date": 1558541469, "last_edit_date": 1558541469, "creation_date": 1558540784, "answer_id": 56260851, "question_id": 56260096, "link": "https://stackoverflow.com/questions/56260096/how-to-improve-python-c-extensions-file-line-reading/56260851#56260851", "title": "How to improve Python C Extensions file line reading?", "body": "<p>Reading line by line is going to cause unavoidable slowdowns here. Python's built-in text oriented read-only file objects are actually three layers:</p>\n\n<ol>\n<li><code>io.FileIO</code> - Raw, unbuffered access to the file</li>\n<li><code>io.BufferedReader</code> - Buffers the underlying <code>FileIO</code></li>\n<li><code>io.TextIOWrapper</code> - Wraps the <code>BufferedReader</code> to implement buffered decode to <code>str</code></li>\n</ol>\n\n<p>While <code>iostream</code> does perform buffering, it's only doing the job of <code>io.BufferedReader</code>, not <code>io.TextIOWrapper</code>. <code>io.TextIOWrapper</code> adds an extra layer of buffering, reading 8 KB <em>chunks</em> out of the <code>BufferedReader</code> and decoding them in bulk to <code>str</code> (when a chunk ends in an incomplete character, it saves off the remaining bytes to prepend to the next chunk), then yielding individual lines from the decoded chunk on request until it's exhausted (when a decoded chunk ends in a partial line, the remainder is prepended to the next decoded chunk).</p>\n\n<p>By contrast, you're consuming a line at a time with <code>std::getline</code>, then decoding a line at a time with <code>PyUnicode_DecodeUTF8</code>, then yielding back to the caller; by the time the caller requests the next line, odds are at least some of the code associated with your <code>tp_iternext</code> implementation has left the CPU cache (or at least, left the fastest parts of the cache). A tight loop decoding 8 KB of text to UTF-8 is going to go extremely fast; repeatedly leaving the loop and only decoding a 100-300 bytes at a time is going to be slower.</p>\n\n<p>The solution is to do roughly what <code>io.TextIOWrapper</code> does: Read in chunks, not lines, and decode them in bulk (preserving incomplete UTF-8 encoded characters for the next chunk), then search for newlines to fish out substrings from the decoded buffer until it's exhausted (don't trim the buffer each time, just track indices). When no more complete lines remain in the decoded buffer, trim the stuff you've already yielded, and read, decode, and append a new chunk.</p>\n\n<p>There is some room for improvement on <a href=\"https://github.com/python/cpython/blob/3.7/Modules/_io/textio.c#L2014\" rel=\"nofollow noreferrer\">Python's underlying implementation of <code>io.TextIOWrapper.readline</code></a> (e.g. they have to construct a Python level <code>int</code> each time they read a chunk and call indirectly since they can't guarantee they're wrapping a <code>BufferedReader</code>), but it's a solid basis for reimplementing your own scheme.</p>\n\n<p><strong>Update:</strong> On checking your full code (which is wildly different from what you've posted), you've got other issues. Your <code>tp_iternext</code> just repeatedly yields <code>None</code>, requiring you to <em>call</em> your object to retrieve the string. That's... unfortunate. That's more than doubling the Python interpreter overhead per item (<code>tp_iternext</code> is cheap to call, being quite specialized; <code>tp_call</code> is not nearly so cheap, going through convoluted general purpose code paths, requiring the interpreter to pass an empty <code>tuple</code> of args you never use, etc.; side-note, <code>PyFastFile_tp_call</code> should be accepting a third argument for the <code>kwds</code>, which you ignore, but must still be accepted; casting to <code>ternaryfunc</code> is silencing the error, but this will break on some platforms).</p>\n\n<p>Final note (not really relevant to performance for all but the smallest files): The contract for <code>tp_iternext</code> does not require you to set an exception when the iterator is exhausted, just that you <code>return NULL;</code>. You can remove your call to <code>PyErr_SetNone( PyExc_StopIteration );</code>; as long as no other exception is set, <code>return NULL;</code> alone indicates end of iteration, so you can save some work by not setting it at all.</p>\n"}, {"tags": [], "owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "is_accepted": false, "score": 0, "last_activity_date": 1558945091, "last_edit_date": 1558945091, "creation_date": 1558658871, "answer_id": 56284547, "question_id": 56260096, "link": "https://stackoverflow.com/questions/56260096/how-to-improve-python-c-extensions-file-line-reading/56284547#56284547", "title": "How to improve Python C Extensions file line reading?", "body": "<p>These results are only for Linux or Cygwin compiler. If you are using <code>Visual Studio Compiler</code>, the results for <code>std::getline</code> and <code>std::ifstream.getline</code> are <code>100%</code> or more slower than Python builtin <code>for line in file</code> iterator.</p>\n\n<p>You will see <code>linecache.push_back( emtpycacheobject )</code> being used around the code because this way I am only benchmarking the time used to read the lines, excluding the time Python would spend converting the input string into a Python Unicode Object. Therefore, I commented out all lines which call <code>PyUnicode_DecodeUTF8</code>.</p>\n\n<p>These are the global definitions used on the examples:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const char* filepath = \"./myfile.log\";\nsize_t linecachesize = 131072;\n\nPyObject* emtpycacheobject;\nemtpycacheobject = PyUnicode_DecodeUTF8( \"\", 0, \"replace\" );\n</code></pre>\n\n<p>I managed to optimize my Posix C <code>getline</code> usage (by caching the total buffer size instead of always passing 0) and now the Posix C <code>getline</code> beats the Python builtin <code>for line in file</code> by <code>5%</code>. I guess if I remove all Python and C++ code around the Posix C <code>getline</code>, it should gain some more performance:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>char* readline = (char*) malloc( linecachesize );\nFILE* cfilestream = fopen( filepath, \"r\" );\n\nif( cfilestream == NULL ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to open the file '\" &lt;&lt; filepath &lt;&lt; \"'!\" &lt;&lt; std::endl;\n}\n\nif( readline == NULL ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to alocate internal line buffer!\" &lt;&lt; std::endl;\n}\n\nbool getline() {\n    ssize_t charsread;\n    if( ( charsread = getline( &amp;readline, &amp;linecachesize, cfilestream ) ) != -1 ) {\n        fileobj.getline( readline, linecachesize );\n        // PyObject* pythonobject = PyUnicode_DecodeUTF8( readline, charsread, \"replace\" );\n        // linecache.push_back( pythonobject );\n        // return true;\n\n        Py_XINCREF( emtpycacheobject );\n        linecache.push_back( emtpycacheobject );\n        return true;\n    }\n    return false;\n}\n\nif( readline ) {\n    free( readline );\n    readline = NULL;\n}\n\nif( cfilestream != NULL) {\n    fclose( cfilestream );\n    cfilestream = NULL;\n}\n</code></pre>\n\n<p>I also managed to improve the C++ performance to only <code>20%</code> slower than the builtin Python C <code>for line in file</code> by using <code>std::ifstream.getline()</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>char* readline = (char*) malloc( linecachesize );\nstd::ifstream fileobj;\nfileobj.open( filepath );\n\nif( fileobj.fail() ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to open the file '\" &lt;&lt; filepath &lt;&lt; \"'!\" &lt;&lt; std::endl;\n}\n\nif( readline == NULL ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to alocate internal line buffer!\" &lt;&lt; std::endl;\n}\n\nbool getline() {\n\n    if( !fileobj.eof() ) {\n        fileobj.getline( readline, linecachesize );\n        // PyObject* pyobj = PyUnicode_DecodeUTF8( readline, fileobj.gcount(), \"replace\" );\n        // linecache.push_back( pyobj );\n        // return true;\n\n        Py_XINCREF( emtpycacheobject );\n        linecache.push_back( emtpycacheobject );\n        return true;\n    }\n    return false;\n}\n\nif( readline ) {\n    free( readline );\n    readline = NULL;\n}\n\nif( fileobj.is_open() ) {\n    fileobj.close();\n}\n</code></pre>\n\n<p>Finally, I also managed to get only <code>10%</code> slower performance than the builtin Python C <code>for line in file</code> with <code>std::getline</code> by caching the <code>std::string</code> it uses as input:</p>\n\n<pre><code>std::string line;\nstd::ifstream fileobj;\nfileobj.open( filepath );\n\nif( fileobj.fail() ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to open the file '\" &lt;&lt; filepath &lt;&lt; \"'!\" &lt;&lt; std::endl;\n}\n\ntry {\n    line.reserve( linecachesize );\n}\ncatch( std::exception error ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to alocate internal line buffer!\" &lt;&lt; std::endl;\n}\n\nbool getline() {\n\n    if( std::getline( fileobj, line ) ) {\n        // PyObject* pyobj = PyUnicode_DecodeUTF8( line.c_str(), line.size(), \"replace\" );\n        // linecache.push_back( pyobj );\n        // return true;\n\n        Py_XINCREF( emtpycacheobject );\n        linecache.push_back( emtpycacheobject );\n        return true;\n    }\n    return false;\n}\n\nif( fileobj.is_open() ) {\n    fileobj.close();\n}\n</code></pre>\n\n<p>After removing all boilerplate from C++, the performance for Posix C <code>getline</code> was 10% inferior to the Python builtin <code>for line in file</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const char* filepath = \"./myfile.log\";\nsize_t linecachesize = 131072;\n\nPyObject* emtpycacheobject = PyUnicode_DecodeUTF8( \"\", 0, \"replace\" );\nchar* readline = (char*) malloc( linecachesize );\nFILE* cfilestream = fopen( filepath, \"r\" );\n\nstatic PyObject* PyFastFile_tp_call(PyFastFile* self, PyObject* args, PyObject *kwargs) {\n    Py_XINCREF( emtpycacheobject );\n    return emtpycacheobject;\n}\n\nstatic PyObject* PyFastFile_iternext(PyFastFile* self, PyObject* args) {\n    ssize_t charsread;\n    if( ( charsread = getline( &amp;readline, &amp;linecachesize, cfilestream ) ) == -1 ) {\n        return NULL;\n    }\n    Py_XINCREF( emtpycacheobject );\n    return emtpycacheobject;\n}\n\nstatic PyObject* PyFastFile_getlines(PyFastFile* self, PyObject* args) {\n    Py_XINCREF( emtpycacheobject );\n    return emtpycacheobject;\n}\n\nstatic PyObject* PyFastFile_resetlines(PyFastFile* self, PyObject* args) {\n    Py_INCREF( Py_None );\n    return Py_None;\n}\n\nstatic PyObject* PyFastFile_close(PyFastFile* self, PyObject* args) {\n    Py_INCREF( Py_None );\n    return Py_None;\n}\n</code></pre>\n\n<p>Values from the last test run where Posix C <code>getline</code> was 10% inferior to Python:</p>\n\n<pre><code>$ /bin/python3.6 fastfileperformance.py fastfile_time 1.15%, python_time 0.87%\nPython   timedifference 0:00:00.695292\nFastFile timedifference 0:00:00.796305\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.13%, python_time 0.88%\nPython   timedifference 0:00:00.708298\nFastFile timedifference 0:00:00.803594\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.14%, python_time 0.88%\nPython   timedifference 0:00:00.699614\nFastFile timedifference 0:00:00.795259\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.15%, python_time 0.87%\nPython   timedifference 0:00:00.699585\nFastFile timedifference 0:00:00.802173\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.15%, python_time 0.87%\nPython   timedifference 0:00:00.703085\nFastFile timedifference 0:00:00.807528\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.17%, python_time 0.85%\nPython   timedifference 0:00:00.677507\nFastFile timedifference 0:00:00.794591\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.20%, python_time 0.83%\nPython   timedifference 0:00:00.670492\nFastFile timedifference 0:00:00.804689\n</code></pre>\n"}], "owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "accepted_answer_id": 56260851, "answer_count": 2, "score": 0, "last_activity_date": 1558945091, "creation_date": 1558538249, "last_edit_date": 1558735406, "question_id": 56260096, "link": "https://stackoverflow.com/questions/56260096/how-to-improve-python-c-extensions-file-line-reading", "title": "How to improve Python C Extensions file line reading?", "body": "<p>Originally asked on <a href=\"https://stackoverflow.com/questions/56249992/are-there-alternative-and-portable-algorithm-implementation-for-reading-lines-fr\">Are there alternative and portable algorithm implementation for reading lines from a file on Windows (Visual Studio Compiler) and Linux?</a> but closed as too abroad, then, I am here trying to reduce its scope with a more concise case usage.</p>\n\n<p>My goal is to implement my own file reading module for Python with Python C Extensions with a line caching policy. The purely Python Algorithm implementation  without any line caching policy is this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code># This takes 1 second to parse 100MB of log data\nwith open('myfile', 'r', errors='replace') as myfile:\n    for line in myfile:\n        if 'word' in line: \n            pass\n</code></pre>\n\n<p>Resuming the Python C Extensions implementation: (<a href=\"https://github.com/evandrocoan/fastfilepackage/blob/c919b6084f4a46ad453b9353bcdb052d502fc278/source/fastfilewrapper.cpp#L66-L80\" rel=\"nofollow noreferrer\">see here the full code with line caching policy</a>)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// other code to open the file on the std::ifstream object and create the iterator\n...\n\nstatic PyObject * PyFastFile_iternext(PyFastFile* self, PyObject* args)\n{\n    std::string newline;\n\n    if( std::getline( self-&gt;fileifstream, newline ) ) {\n        return PyUnicode_DecodeUTF8( newline.c_str(), newline.size(), \"replace\" );\n    }\n\n    PyErr_SetNone( PyExc_StopIteration );\n    return NULL;\n}\n\nstatic PyTypeObject PyFastFileType =\n{\n    PyVarObject_HEAD_INIT( NULL, 0 )\n    \"fastfilepackage.FastFile\" /* tp_name */\n};\n\n// create the module\nPyMODINIT_FUNC PyInit_fastfilepackage(void)\n{\n    PyFastFileType.tp_iternext = (iternextfunc) PyFastFile_iternext;\n    Py_INCREF( &amp;PyFastFileType );\n\n    PyObject* thismodule;\n    // other module code creating the iterator and context manager\n    ...\n\n    PyModule_AddObject( thismodule, \"FastFile\", (PyObject *) &amp;PyFastFileType );\n    return thismodule;\n}\n</code></pre>\n\n<p>And this is the Python code which uses the Python C Extensions code to open a file and read its lines one by one:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from fastfilepackage import FastFile\n\n# This takes 3 seconds to parse 100MB of log data\niterable = fastfilepackage.FastFile( 'myfile' )\nfor item in iterable:\n    if 'word' in iterable():\n        pass\n</code></pre>\n\n<p>Right now the Python C Extensions code <code>fastfilepackage.FastFile</code> with C++ 11 <code>std::ifstream</code> takes 3 seconds to parse 100MB of log data, while the Python implementation presented takes 1 second. </p>\n\n<p>The content of the file <code>myfile</code> are just <code>log lines</code> with around 100~300 characters on each line. The characters are just ASCII (module % 256), but due bugs on the logger engine, it can put invalid ASCII or Unicode characters. Hence, this is why I used the <code>errors='replace'</code> policy while opening the file.</p>\n\n<p>I just wonder if I can replace or improve this Python C Extension implementation, reducing the 3 seconds time to run the Python program.</p>\n\n<p>I used this to do the benchmark:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import time\nimport datetime\nimport fastfilepackage\n\n# usually a file with 100MB\ntestfile = './myfile.log'\n\ntimenow = time.time()\nwith open( testfile, 'r', errors='replace' ) as myfile:\n    for item in myfile:\n        if None:\n            var = item\n\npython_time = time.time() - timenow\ntimedifference = datetime.timedelta( seconds=python_time )\nprint( 'Python   timedifference', timedifference, flush=True )\n# prints about 3 seconds\n\ntimenow = time.time()\niterable = fastfilepackage.FastFile( testfile )\nfor item in iterable:\n    if None:\n        var = iterable()\n\nfastfile_time = time.time() - timenow\ntimedifference = datetime.timedelta( seconds=fastfile_time )\nprint( 'FastFile timedifference', timedifference, flush=True )\n# prints about 1 second\n\nprint( 'fastfile_time %.2f%%, python_time %.2f%%' % ( \n        fastfile_time/python_time, python_time/fastfile_time ), flush=True )\n</code></pre>\n\n<p>Related questions:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/25866045/reading-file-line-by-line-in-c\">Reading file Line By Line in C</a></li>\n<li><a href=\"https://stackoverflow.com/questions/34493913/improving-cs-reading-file-line-by-line\">Improving C++&#39;s reading file line by line?</a></li>\n</ol>\n"}, {"tags": ["c++", "function", "types", "arguments"], "comments": [{"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1558538290, "post_id": 56260024, "comment_id": 99136798, "body": "This is how you suppress the &quot;unused variable&quot; warnings and also make your intention very clears"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "edited": false, "score": 0, "creation_date": 1558538298, "post_id": 56260024, "comment_id": 99136806, "body": "In case of a class method it is a way of constraining future function override."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1558541413, "post_id": 56260024, "comment_id": 99138547, "body": "<code>But there is no way to use that argument</code>. Yes there is. Give it a name!"}], "owner": {"reputation": 399, "user_id": 10833151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/105e1c301f6ff60de3fbd9ef73fd19cc?s=128&d=identicon&r=PG&f=1", "display_name": "James Ronald", "link": "https://stackoverflow.com/users/10833151/james-ronald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1558538108, "answer_count": 0, "score": 0, "last_activity_date": 1558538007, "creation_date": 1558538007, "question_id": 56260024, "link": "https://stackoverflow.com/questions/56260024/c-why-can-a-function-declaration-not-assign-a-name-to-its-arguments", "closed_reason": "Duplicate", "title": "C++: why can a function declaration not assign a name to it&#39;s argument(s)?", "body": "<p>For example, this code: <code>double sqrt(double) { return 0; }</code> is apparently completely fine. It takes one argument of type double. But there is no way to use that argument in any way because it wasn't assigned a name, so there's nothing to call it by. What's the point of having that argument there then? </p>\n"}, {"tags": ["c++", "grpc", "google-cloud-pubsub"], "answers": [{"comments": [{"owner": {"reputation": 2907, "user_id": 1928515, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a01ce6c702f6514136cfecc06b8cdb25?s=128&d=identicon&r=PG", "display_name": "nabroyan", "link": "https://stackoverflow.com/users/1928515/nabroyan"}, "edited": false, "score": 0, "creation_date": 1572090080, "post_id": 56292005, "comment_id": 103457914, "body": "I used the first approach and it was working quite well. However, I encountered an issue lately. Could you please take a look? <a href=\"https://stackoverflow.com/questions/58569932/deadlock-inside-grpc-read-function\" title=\"deadlock inside grpc read function\">stackoverflow.com/questions/58569932/&hellip;</a>"}], "tags": [], "owner": {"reputation": 81, "user_id": 8351440, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-q86f0CBM2hY/AAAAAAAAAAI/AAAAAAAAAQU/4F1fbjgH3y0/photo.jpg?sz=128", "display_name": "Manuel Menzella", "link": "https://stackoverflow.com/users/8351440/manuel-menzella"}, "is_accepted": true, "score": 2, "last_activity_date": 1558698249, "creation_date": 1558698249, "answer_id": 56292005, "question_id": 56260017, "link": "https://stackoverflow.com/questions/56260017/consumer-example-for-google-pub-sub-in-c/56292005#56292005", "title": "Consumer example for Google Pub/Sub in C++", "body": "<p>Just like you are making Publish requests, you can make <a href=\"https://cloud.google.com/pubsub/docs/pull#streamingpull\" rel=\"nofollow noreferrer\">StreamingPull</a> requests for messages. Note that this is a simple proof of concept, and, in practice, you\u2019d probably want to make this code more robust; e.g. create multiple streams, have the message processing happen on a thread pool, implement some kind of flow control, etc\u2026</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\n#include &lt;grpc++/grpc++.h&gt;\n\n#include \"google/pubsub/v1/pubsub.grpc.pb.h\"\n\nauto main() -&gt; int {\n    using grpc::ClientContext;\n    using grpc::ClientReaderWriter;\n    using google::pubsub::v1::Subscriber;\n    using google::pubsub::v1::StreamingPullRequest;\n    using google::pubsub::v1::StreamingPullResponse;\n\n    auto creds = grpc::GoogleDefaultCredentials();\n    auto stub = std::make_unique&lt;Subscriber::Stub&gt;(\n        grpc::CreateChannel(\"pubsub.googleapis.com\", creds));\n\n    // Open up the stream.\n    ClientContext context;\n    std::unique_ptr&lt;ClientReaderWriter&lt;\n        StreamingPullRequest, StreamingPullResponse&gt;&gt; stream(\n            stub-&gt;StreamingPull(&amp;context));\n\n    // Send initial message.\n    StreamingPullRequest request;\n    request.set_subscription(\n        \"projects/pubsub-cpp-api-1504713535863/subscriptions/testing\");\n    request.set_stream_ack_deadline_seconds(10);\n    stream-&gt;Write(request);\n\n    // Receive messages.\n    StreamingPullResponse response;\n    while (stream-&gt;Read(&amp;response)) {\n      // Ack messages.\n      StreamingPullRequest ack_request;\n      for (const auto &amp;message : response.received_messages()) {\n        ack_request.add_ack_ids(message.ack_id());\n      }\n      stream-&gt;Write(ack_request);\n    }\n}\n</code></pre>\n\n<p>This is the newest Cloud Pub/Sub API, and is the currently recommended way of pulling messages from the service; this is especially true for users who expect high throughput and low latency. Currently, there is no existing client library for C++, but there is an open <a href=\"https://github.com/googleapis/google-cloud-cpp/issues/777\" rel=\"nofollow noreferrer\">issue</a> on GitHub for it. The existing client libraries for other languages (e.g. Java) already use this API, so you may be able to replicate their functionality in your own C++ code.</p>\n\n<p>For simpler use-cases, you could also use the older <a href=\"https://cloud.google.com/pubsub/docs/pull\" rel=\"nofollow noreferrer\">Pull</a> API, which makes many independent requests for messages. Note that, for high throughput and low latency, you should most likely be making many simultaneous asynchronous RPCs: see gRPC <a href=\"https://grpc.io/docs/tutorials/async/helloasync-cpp/\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\n#include &lt;grpc++/grpc++.h&gt;\n\n#include \"google/pubsub/v1/pubsub.grpc.pb.h\"\n\nauto main() -&gt; int {\n    using grpc::ClientContext;\n    using google::pubsub::v1::Subscriber;\n    using google::pubsub::v1::PullRequest;\n    using google::pubsub::v1::PullResponse;\n\n    auto creds = grpc::GoogleDefaultCredentials();\n    auto stub = std::make_unique&lt;Subscriber::Stub&gt;(\n        grpc::CreateChannel(\"pubsub.googleapis.com\", creds));\n\n    PullRequest request;\n    request.set_subscription(\n        \"projects/pubsub-cpp-api-1504713535863/subscriptions/testing\");\n    request.set_max_messages(50);\n    request.set_return_immediately(false);\n\n    PullResponse response;\n    ClientContext ctx;\n\n    auto status = stub-&gt;Pull(&amp;ctx, request, &amp;response);\n    if (!status.ok()) {\n        // ...\n    }\n\n    // Do something with \"response\".\n}\n</code></pre>\n\n<p>As a last resort, you could use a <a href=\"https://cloud.google.com/pubsub/docs/push\" rel=\"nofollow noreferrer\">Push</a> subscription, which would only require you to implement an HTTP endpoint on your client. However, this is not usually recommended unless you are fanning in from multiple subscriptions, or for cases where your client cannot make outgoing requests.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3692665, "user_type": "registered", "profile_image": "https://graph.facebook.com/1232757279/picture?type=large", "display_name": "user3692665", "link": "https://stackoverflow.com/users/3692665/user3692665"}, "is_accepted": false, "score": 0, "last_activity_date": 1577710567, "last_edit_date": 1577710567, "creation_date": 1577708903, "answer_id": 59530868, "question_id": 56260017, "link": "https://stackoverflow.com/questions/56260017/consumer-example-for-google-pub-sub-in-c/59530868#59530868", "title": "Consumer example for Google Pub/Sub in C++", "body": "<p>There is c++ library called <code>pubsuber</code> for accessing google pubsub.\nFor more information look <a href=\"https://github.com/sandvikcode/pubsuber\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 2907, "user_id": 1928515, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a01ce6c702f6514136cfecc06b8cdb25?s=128&d=identicon&r=PG", "display_name": "nabroyan", "link": "https://stackoverflow.com/users/1928515/nabroyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2113, "favorite_count": 0, "accepted_answer_id": 56292005, "answer_count": 2, "score": 1, "last_activity_date": 1577710567, "creation_date": 1558537989, "question_id": 56260017, "link": "https://stackoverflow.com/questions/56260017/consumer-example-for-google-pub-sub-in-c", "title": "Consumer example for Google Pub/Sub in C++", "body": "<p>I am trying to play around Google Pub/Sub and I need to integrate it in C++ code-base.</p>\n\n<p>As there is no native support for <code>Google Pub/Sub</code> in C++, I am using it through <code>gRPC</code>. Thus, I have generated corresponding <code>pubsub.grpc.pb.h</code>, <code>pubsub.grpc.pb.cc</code>, <code>pubsub.pb.h</code> and <code>pubsub.pb.cc</code> files via <code>protoc</code>.</p>\n\n<p>Question part: because of lack of documentation it would be very helpful to have an example in C++. I have found an <a href=\"https://groups.google.com/forum/#!topic/cloud-pubsub-discuss/BE7A5qFqywQ\" rel=\"nofollow noreferrer\">example</a> for publisher part, but not for the subscriber part. I tried to dive into the generated code and examples in other languages, but quite many question arise. Is there any example for the subscriber part? Or may be someone already had such kind of experience?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 21, "creation_date": 1558537288, "post_id": 56259783, "comment_id": 99136155, "body": "It means that this is old code that should be rewritten to use <code>nullptr</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 16, "last_activity_date": 1558538948, "last_edit_date": 1558538948, "creation_date": 1558537404, "answer_id": 56259844, "question_id": 56259783, "link": "https://stackoverflow.com/questions/56259783/operators-in-c-what-does-type0-mean/56259844#56259844", "title": "Operators in C++ what does (::Type*)0 mean", "body": "<p>It means \"cast the integer <code>0</code> (using a C-style cast) to the type <code>Trip*</code> (<code>Trip</code> pointer) found in the global namespace (<code>::</code>)\".</p>\n\n<p>It should just use <code>nullptr</code> - as in</p>\n\n<pre><code>return is_modifyCurrentTrip() ?\n    u.modifyCurrentTrip : nullptr; \n</code></pre>\n\n<p>Note: using <code>::</code> explicitly to designate the global namespace prevents the compiler from prepending any namespace names itself - this is completely irrelevant when just using <code>nullptr</code> though.</p>\n"}], "owner": {"reputation": 77, "user_id": 11374433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-az2sqxDRUXo/AAAAAAAAAAI/AAAAAAAAZ7U/pzzuK6bSFwU/photo.jpg?sz=128", "display_name": "Billal Ouali", "link": "https://stackoverflow.com/users/11374433/billal-ouali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 56259844, "answer_count": 1, "score": 7, "last_activity_date": 1558548396, "creation_date": 1558537229, "last_edit_date": 1558548143, "question_id": 56259783, "link": "https://stackoverflow.com/questions/56259783/operators-in-c-what-does-type0-mean", "title": "Operators in C++ what does (::Type*)0 mean", "body": "<p>Can anyone tell me what this means? </p>\n\n<pre><code>(::Type*)0\n</code></pre>\n\n<p>actually it is part of this</p>\n\n<pre><code>return (is_modifytype()) ?\nu.myfunction : (::Type*)0; \n</code></pre>\n"}, {"tags": ["c++", "qt", "qt5", "mousemove", "qgraphicsitem"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6230697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296c14bf983c4994f83167db8d492307?s=128&d=identicon&r=PG&f=1", "display_name": "kostas petsis", "link": "https://stackoverflow.com/users/6230697/kostas-petsis"}, "edited": false, "score": 0, "creation_date": 1558622888, "post_id": 56260041, "comment_id": 99169926, "body": "Yes you are right.I need to tell it the x,y(origin) of my shape, and width, height of it.Thanks"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 3, "last_activity_date": 1558538070, "creation_date": 1558538070, "answer_id": 56260041, "question_id": 56259690, "link": "https://stackoverflow.com/questions/56259690/qt-moving-a-qgraphicsitem-causes-artifacts-leaves-trailes-behind/56260041#56260041", "title": "Qt- Moving a QGraphicsItem causes artifacts.Leaves trailes behind", "body": "<p><code>QGraphicsItem</code> for efficiency only repaint the section that returns <code>boundingRect()</code> method, in your case <code>QRect(0, 0, 80, 80)</code> only returns half the necessary area since the coordinate <code>(0, -80)</code> is outside the boundingRect. The solution is:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>QRectF Note::boundingRect() const {\n    return QRectF(0, -80, 80, 160) ;\n    // or\n    // return shape().boundingRect();\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6230697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296c14bf983c4994f83167db8d492307?s=128&d=identicon&r=PG&f=1", "display_name": "kostas petsis", "link": "https://stackoverflow.com/users/6230697/kostas-petsis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 56260041, "answer_count": 1, "score": 1, "last_activity_date": 1558538168, "creation_date": 1558536967, "last_edit_date": 1558538168, "question_id": 56259690, "link": "https://stackoverflow.com/questions/56259690/qt-moving-a-qgraphicsitem-causes-artifacts-leaves-trailes-behind", "title": "Qt- Moving a QGraphicsItem causes artifacts.Leaves trailes behind", "body": "<p>When i move a QGraphicsItem, weird artifacts stay behind.Some parts of the item dont render,other render...\nIn the note.cpp i have a shape</p>\n\n<pre><code>QPainterPath Note::shape()const{\n   QPainterPath path;\n   //    path.addRect(0, 0, 50, 20);\n   path.moveTo(0, -80.0);\n   path.lineTo(0.0, 80.0);\n   path.lineTo(80.0, 0.0);\n   //    path.lineTo(75.0, -30.0);\n   path.closeSubpath();\n   return path;\n}\n</code></pre>\n\n<p>In the paint function</p>\n\n<pre><code>QPointF *points = new QPointF[3];\npoints[0] = QPointF(0,-80);\npoints[1] = QPointF(0,80);\npoints[2] = QPointF(80,0);\npainter-&gt;drawPolygon(points,3);\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/r2SS0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r2SS0.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/phUkz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/phUkz.png\" alt=\"enter image description here\"></a>\nThe first picture shows that all are fine when i start the app.\nThe second picture shows that when i move a triangle with the mouse, it gets sliced.Other times it leaves some trails and doesn't render all parts of the triangle\nHere is the github link for the project.\n<a href=\"https://github.com/rivenblades/Qt-QGraphicsItem-MovingArtifacts\" rel=\"nofollow noreferrer\">Github link</a></p>\n\n<p>To reproduce, just move a triangle.</p>\n"}, {"tags": ["c++", "opencv", "computer-vision"], "answers": [{"comments": [{"owner": {"reputation": 1125, "user_id": 7745011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZId9o.jpg?s=128&g=1", "display_name": "Roland Deschain", "link": "https://stackoverflow.com/users/7745011/roland-deschain"}, "edited": false, "score": 0, "creation_date": 1558619974, "post_id": 56270345, "comment_id": 99168129, "body": "Thx for the info, helps a lot :)"}], "tags": [], "owner": {"reputation": 664, "user_id": 5707440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54a4defbda5f9d7982bde84371a83c87?s=128&d=identicon&r=PG&f=1", "display_name": "Grillteller", "link": "https://stackoverflow.com/users/5707440/grillteller"}, "is_accepted": true, "score": 3, "last_activity_date": 1558597417, "creation_date": 1558597417, "answer_id": 56270345, "question_id": 56259668, "link": "https://stackoverflow.com/questions/56259668/opencv-how-to-calculate-essential-matrix-from-feature-matches-between-two-image/56270345#56270345", "title": "OpenCV: How to calculate essential matrix from feature matches between two images from different cameras using 5-point algorithm?", "body": "<p>In OpenCV there is no standard function for calculating the essential matrix using two different cameras. But it is very easy to implement it yourself.\nYou can add a function to the <code>five-point.cpp</code> and recompile OpenCV.\nI just added an overloaded function <code>cv::findEssentialMat</code> with an additional parameter for the second camera matrix.</p>\n\n<pre><code>cv::Mat cv::findEssentialMat(InputArray _points1, InputArray _points2, InputArray _cameraMatrix1, InputArray _cameraMatrix2, int method, double prob, double threshold, OutputArray _mask)\n{\n    CV_INSTRUMENT_REGION();\n\n    Mat points1, points2, cameraMatrix1, cameraMatrix2;\n    _points1.getMat().convertTo(points1, CV_64F);\n    _points2.getMat().convertTo(points2, CV_64F);\n    _cameraMatrix1.getMat().convertTo(cameraMatrix1, CV_64F);\n    _cameraMatrix2.getMat().convertTo(cameraMatrix2, CV_64F);\n\n    int npoints = points1.checkVector(2);\n    CV_Assert(npoints &gt;= 0 &amp;&amp; points2.checkVector(2) == npoints &amp;&amp;\n        points1.type() == points2.type());\n\n    CV_Assert(cameraMatrix1.rows == 3 &amp;&amp; cameraMatrix1.cols == 3 &amp;&amp; cameraMatrix1.channels() == 1);\n    CV_Assert(cameraMatrix2.rows == 3 &amp;&amp; cameraMatrix2.cols == 3 &amp;&amp; cameraMatrix2.channels() == 1);\n\n    if (points1.channels() &gt; 1)\n    {\n        points1 = points1.reshape(1, npoints);\n        points2 = points2.reshape(1, npoints);\n    }\n\n    double fx1 = cameraMatrix1.at&lt;double&gt;(0, 0);\n    double fy1 = cameraMatrix1.at&lt;double&gt;(1, 1);\n    double cx1 = cameraMatrix1.at&lt;double&gt;(0, 2);\n    double cy1 = cameraMatrix1.at&lt;double&gt;(1, 2);\n    double fx2 = cameraMatrix2.at&lt;double&gt;(0, 0);\n    double fy2 = cameraMatrix2.at&lt;double&gt;(1, 1);\n    double cx2 = cameraMatrix2.at&lt;double&gt;(0, 2);\n    double cy2 = cameraMatrix2.at&lt;double&gt;(1, 2);\n\n    points1.col(0) = (points1.col(0) - cx1) / fx1;\n    points2.col(0) = (points2.col(0) - cx2) / fx2;\n    points1.col(1) = (points1.col(1) - cy1) / fy1;\n    points2.col(1) = (points2.col(1) - cy2) / fy2;\n\n    // Reshape data to fit opencv ransac function\n    points1 = points1.reshape(2, npoints);\n    points2 = points2.reshape(2, npoints);\n\n    threshold /= (fx1 + fy1) / 2;\n\n    Mat E;\n    if (method == RANSAC)\n        createRANSACPointSetRegistrator(makePtr&lt;EMEstimatorCallback&gt;(), 5, threshold, prob)-&gt;run(points1, points2, E, _mask);\n    else\n        createLMeDSPointSetRegistrator(makePtr&lt;EMEstimatorCallback&gt;(), 5, prob)-&gt;run(points1, points2, E, _mask);\n\n    return E;\n}\n</code></pre>\n\n<p>Then you have to add the function declaration to <code>calib3d.hpp</code>, recompile and reinstall your OpenCV version.</p>\n\n<blockquote>\n  <p><strong>Additional question:</strong> If I have calculated the essential matrix can I just use it as parameter in the method <code>computeCorrespondEpilines()</code> instead of the fundamental matrix, assuming images are already rectified?</p>\n</blockquote>\n\n<p>Yes, I think this should work.</p>\n"}], "owner": {"reputation": 1125, "user_id": 7745011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZId9o.jpg?s=128&g=1", "display_name": "Roland Deschain", "link": "https://stackoverflow.com/users/7745011/roland-deschain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1827, "favorite_count": 0, "accepted_answer_id": 56270345, "answer_count": 1, "score": 1, "last_activity_date": 1558597417, "creation_date": 1558536918, "question_id": 56259668, "link": "https://stackoverflow.com/questions/56259668/opencv-how-to-calculate-essential-matrix-from-feature-matches-between-two-image", "title": "OpenCV: How to calculate essential matrix from feature matches between two images from different cameras using 5-point algorithm?", "body": "<p>Basically I want do to the same thing as this function here:\n<a href=\"https://docs.opencv.org/master/d9/d0c/group__calib3d.html#ga13f7e34de8fa516a686a56af1196247f\" rel=\"nofollow noreferrer\">https://docs.opencv.org/master/d9/d0c/group__calib3d.html#ga13f7e34de8fa516a686a56af1196247f</a></p>\n\n<p>However, the parameter description states, that this algorithm assumes that the matched feature points of the two images are from cameras with the same camera matrix. </p>\n\n<p>What if I have matched features, but images from two different cameras with different camera matrices? How can I calculate the 5-Point essential matrix then?</p>\n\n<p><strong>Additional question</strong>: \nIf I have calculated the essential matrix can I just use it as parameter in the method <a href=\"https://docs.opencv.org/4.1.0/d9/d0c/group__calib3d.html#ga19e3401c94c44b47c229be6e51d158b7\" rel=\"nofollow noreferrer\"><code>computeCorrespondEpilines()</code></a> instead of the fundamental matrix, assuming images are already rectified?</p>\n"}, {"tags": ["c++", "c++11", "lambda"], "comments": [{"owner": {"reputation": 12376, "user_id": 4790924, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hzxAE.png?s=128&g=1", "display_name": "Sharon Ben Asher", "link": "https://stackoverflow.com/users/4790924/sharon-ben-asher"}, "edited": false, "score": 0, "creation_date": 1558537010, "post_id": 56259644, "comment_id": 99135943, "body": "there is really no reason for the Java tag"}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 3, "creation_date": 1558537149, "post_id": 56259644, "comment_id": 99136046, "body": "There&#39;s no need for <code>new</code>. Pass it by move or at least make a <code>std::unique_ptr</code>"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 5, "creation_date": 1558538754, "post_id": 56259644, "comment_id": 99137073, "body": "<code>SimpleTask</code> isn&#39;t an interface.  There is no virtual method, let alone a pure virtual method."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 3, "creation_date": 1558541762, "post_id": 56259644, "comment_id": 99138741, "body": "If you are going to modernize existing C++ then you should use modern techniques. C++ has changed since 1998 when interfaces and virtual functions were a big thing. The more (use the term loosely) common technique is to use templates and duck typing. If the object passed has the appropriate interface you can use it. For Lambda the interface is functor like i.e. <code>operator()(&lt;Argument List&gt;)</code>."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1558543652, "post_id": 56259644, "comment_id": 99139601, "body": "<code>I did a bit research in C++11 and found there nothing similar to this</code> Except maybe C++ Lambda? <code>[&lt;CaptureList&gt;](&lt;ArgList&gt;){&lt;Code&gt;}</code> Most fun declaration in C++ is <code>[](){}();</code>"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1558563115, "post_id": 56259644, "comment_id": 99147584, "body": "The problem is that lambdas are designed to work with <code>std::function&lt;void()&gt;</code>, rather than <code>SimpleTask</code>."}, {"owner": {"reputation": 487, "user_id": 6241424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ddb894d629c3cebb838a758aade708?s=128&d=identicon&r=PG&f=1", "display_name": "Hongkun Wang", "link": "https://stackoverflow.com/users/6241424/hongkun-wang"}, "edited": false, "score": 0, "creation_date": 1558567428, "post_id": 56259644, "comment_id": 99148570, "body": "Thanks for all input / suggestions. The code I had were originally written back in 2005, and there are tons of better C++ patterns I can adopt, such as use C++ smart pointer instead of &quot;new&quot;, it takes time to modernize the whole library."}, {"owner": {"reputation": 487, "user_id": 6241424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ddb894d629c3cebb838a758aade708?s=128&d=identicon&r=PG&f=1", "display_name": "Hongkun Wang", "link": "https://stackoverflow.com/users/6241424/hongkun-wang"}, "edited": false, "score": 0, "creation_date": 1558567525, "post_id": 56259644, "comment_id": 99148585, "body": "Sorry, the &quot;run&quot; method should have signature &quot;virtual void run() = 0;&quot;, I made it wrong when I write the question."}], "answers": [{"comments": [{"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 1, "creation_date": 1558537135, "post_id": 56259724, "comment_id": 99136035, "body": "Perhaps show where the <code>&#47;&#47;Do somthing for this task</code> bit would go in your version to make it a bit clearer"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1558537223, "post_id": 56259724, "comment_id": 99136095, "body": "Not really. Java let&#39;s you write anonymous class definition inline, when calling method. So in this case Java code would look e.g. like this: <code>registerTask(new SimpleTask { void run() { \\\\run; }});</code>. <code>std::thread</code> is completely unelated to the question."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1558537280, "post_id": 56259724, "comment_id": 99136146, "body": "@Yksisarvinen OP explicitly mentioned the need for lambda, not anonymous class."}, {"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 2, "creation_date": 1558537377, "post_id": 56259724, "comment_id": 99136214, "body": "OP seems to have his own <code>Thread</code> class, which accepts <code>SimpleTask</code> pointer in its constructor. Not sure how this answer is related"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1558537442, "post_id": 56259724, "comment_id": 99136263, "body": "@Jean-BaptisteYun&#232;s They mentioned the Java lambda, asking whether something similar could be done in C++"}, {"owner": {"reputation": 487, "user_id": 6241424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ddb894d629c3cebb838a758aade708?s=128&d=identicon&r=PG&f=1", "display_name": "Hongkun Wang", "link": "https://stackoverflow.com/users/6241424/hongkun-wang"}, "edited": false, "score": 0, "creation_date": 1558567939, "post_id": 56259724, "comment_id": 99148653, "body": "Thanks for your suggestions. The thread example is just one of many &quot;event handler&quot; or callback design in my library. So adopting std::thread did not answer my question. Appreciate it anyway. :-)"}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 4, "last_activity_date": 1558537213, "last_edit_date": 1558537213, "creation_date": 1558537066, "answer_id": 56259724, "question_id": 56259644, "link": "https://stackoverflow.com/questions/56259644/in-c11-or-above-is-there-a-way-to-implement-a-single-method-pure-virtual-c/56259724#56259724", "title": "In C++11 or above, Is there a way to implement a single-method pure virtual C++ interface by lambda?", "body": "<p>Isn't it what you are looking for?</p>\n\n<pre><code>std::thread t(\n  [](){\n    std::cout &lt;&lt; \"thread\\n\"; // Here is the code run by the thread...\n  }\n);\nstd::cout &lt;&lt; \"main\\n\";\nt.join();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 0, "creation_date": 1558537771, "post_id": 56259784, "comment_id": 99136475, "body": "As <code>SimpleTask</code> is referred as an example interface, your answer would be complete if it was passed as template argument, not hardcoded. Edit adjustment: and only proper <code>makeXXX</code> functions were to be implemented."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 1, "creation_date": 1558537868, "post_id": 56259784, "comment_id": 99136547, "body": "@R2RT Agree, but I doubt all interfaces match <code>void run()</code>. I&#39;ve added some details at the end of the answer."}, {"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 0, "creation_date": 1558538166, "post_id": 56259784, "comment_id": 99136737, "body": "Oups, right. One last note: shouldn&#39;t <code>t</code> be moved in constructor and <code>makeSimpleTask</code>?"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "edited": false, "score": 0, "creation_date": 1558538231, "post_id": 56259784, "comment_id": 99136770, "body": "It should ;) And it should also be forwarded in <code>makeXXX</code>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1558539306, "post_id": 56259784, "comment_id": 99137362, "body": "<code>WRAPPER_FOR</code> could take the name of the method, and deduce arguments from the type of <code>&amp;C::M</code>, then forward to the lambda.  And yes, that covers the dangerous bit.  It gets annoying with <code>&amp;</code> <code>&amp;&amp;</code> <code>const</code> <code>volatile</code> <code>noexcept</code> overloads tho."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1558541448, "post_id": 56259784, "comment_id": 99138572, "body": "@Yakk-AdamNevraumont I would be interested in how you do that for <code>WRAPPER_FOR</code>... I have no clue how to do that."}, {"owner": {"reputation": 487, "user_id": 6241424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ddb894d629c3cebb838a758aade708?s=128&d=identicon&r=PG&f=1", "display_name": "Hongkun Wang", "link": "https://stackoverflow.com/users/6241424/hongkun-wang"}, "edited": false, "score": 0, "creation_date": 1558567760, "post_id": 56259784, "comment_id": 99148624, "body": "Thanks for your solution, I think it makes code slightly more concise. I can not have through understanding on all your code (particularly the Macro part) but I&#39;ll give it a try!"}], "tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": true, "score": 11, "last_activity_date": 1558538879, "last_edit_date": 1558538879, "creation_date": 1558537229, "answer_id": 56259784, "question_id": 56259644, "link": "https://stackoverflow.com/questions/56259644/in-c11-or-above-is-there-a-way-to-implement-a-single-method-pure-virtual-c/56259784#56259784", "title": "In C++11 or above, Is there a way to implement a single-method pure virtual C++ interface by lambda?", "body": "<p>You can create a wrapper, e.g.:</p>\n\n<pre><code>class SimpleTask {\npublic:\n    virtual void run() = 0;\n};\n\n// This class wraps a lambda (or any callable) and implement the run()\n// method by simply calling the callable.\ntemplate &lt;class T&gt;\nclass LambdaSimpleTask: public SimpleTask {\n    T t;\n\npublic:\n    LambdaSimpleTask(T t) : t(std::move(t)) { }\n\n    virtual void run() {\n        t();\n    }\n};\n\n\ntemplate &lt;class T&gt;\nauto makeSimpleTask(T &amp;&amp;t) {\n    // I am returning a dynamically allocated object following your example,\n    // but I would rather return a statically allocated one.\n    return new LambdaSimpleTask&lt;std::decay_t&lt;T&gt;&gt;{std::forward&lt;T&gt;(t)};\n}\n</code></pre>\n\n<p>And then to create the task:</p>\n\n<pre><code>auto task = makeSimpleTask([]() { });\nThread myThread(L\"MyTestingThread\", task);\n</code></pre>\n\n<p>Note that you still need to have a wrapper and a <code>makeXXX</code> function for each one of your interface. With C++17 and above, you can get rid of the <code>makeXXX</code> function by using class template argument deduction. Getting rid of the wrapper is not possible but you might be able to reduce the boilerplate code by encapsulating some stuff in macros.</p>\n\n<hr>\n\n<p>Here is an example macro (not perfect) that could be used to reduce the boilerplate code:</p>\n\n<pre><code>#define WRAPPER_FOR(C, M, ...)                       \\\n    template &lt;class T&gt;                               \\\n    class Lambda##C: public C {                      \\\n        T t;                                         \\\n    public:                                          \\\n        Lambda##C(T t) : t(std::move(t)) { }         \\\n        virtual M { return t(__VA_ARGS__); }         \\\n    };                                               \\\n    template &lt;class T&gt; auto make##C(T &amp;&amp;t) {         \\\n        return Lambda##C&lt;std::decay_t&lt;T&gt;&gt;{std::forward&lt;T&gt;(t)}; }\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>class SimpleTask {\npublic:\n    virtual void run() = 0;\n};\n\nclass ComplexTask {\npublic:\n    virtual int run(int, double) = 0;\n};\n\nWRAPPER_FOR(SimpleTask, void run());\nWRAPPER_FOR(ComplexTask, int run(int a, double b), a, b);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 487, "user_id": 6241424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ddb894d629c3cebb838a758aade708?s=128&d=identicon&r=PG&f=1", "display_name": "Hongkun Wang", "link": "https://stackoverflow.com/users/6241424/hongkun-wang"}, "edited": false, "score": 0, "creation_date": 1558568394, "post_id": 56261271, "comment_id": 99148717, "body": "Thanks for all your suggestions, I need to update my modern C++ knowledge before I can completely understand your solution, appreciate it!"}], "tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 2, "last_activity_date": 1558544891, "last_edit_date": 1558544891, "creation_date": 1558542378, "answer_id": 56261271, "question_id": 56259644, "link": "https://stackoverflow.com/questions/56259644/in-c11-or-above-is-there-a-way-to-implement-a-single-method-pure-virtual-c/56261271#56261271", "title": "In C++11 or above, Is there a way to implement a single-method pure virtual C++ interface by lambda?", "body": "<p>Old Virtual interface style:</p>\n\n<pre><code>struct MyInterface {\n    virtual Type action(argList)  = 0;\n};\n\nclass MyClassThatUsesInterface\n{\n    MyInterface&amp;   interface;\n    public:\n        MyClassThatUsesInterface(MyInterface&amp; ref)\n            : interface(ref)\n        {}\n        Type doStuff(argList)\n        {\n             return interface.action(argList);\n        }\n};\n...\nMyInterfaceImplementation injectedInterface;\nMyClassThatUsesInterface  worker(injectedInterface);\n...\nworker.doStuff(someStuff);\n</code></pre>\n\n<p>More Modern style:<br>\nOr Duck Typing Style:</p>\n\n<pre><code>// No need for an explicit interface definition.\n// Any function that will work can be used\n// Let the compiler decide if the used function (functor/lambda) works.\n\ntemplate&lt;typename F&gt;\nclass MyClassThatUsesLambda\n{\n    F   interface;\n    public:\n        MyClassThatUsesLambda(F&amp;&amp; ref)\n            : interface(std::move(ref))\n        {}\n        Type doStuff(argList)\n        {\n             return interface(argList);\n             // Will compile if the type F supports function like operations.\n             // This means a:\n             //   * function pointer.\n             //   * std::function\n             //   * A type the overloads operator()\n             //   * Lambda\n        }\n};\ntemplate&lt;typename F&gt;\nMyClassThatUsesLambda&lt;F&gt; make_MyClassThatUsesLambda(F&amp;&amp; f) {return MyClassThatUsesLambda&lt;F&gt;(std::move(f));}\n...\nauto  worker = make_MyClassThatUsesLambda([](argList){/* Some Stuff*/});\n...\nworker.doStuff(someStuff);\n</code></pre>\n\n<p>Looking at your example (Which is obviously not C++ by the way)</p>\n\n<pre><code>// Added C++ required virtuals etc:\n// Some basic memory management (not checked).\nclass SimpleTask\n{\n    public:\n        virtual void run() = 0;\n};\n// Guessed at this object.\nclass Thread\n{\n    std::string                    name;\n    std::unique_ptr&lt;SimpleTask&gt;    task\n    public:\n        Thread(std::string const&amp; name, std::unique_ptr&lt;SimpleTask&gt;&amp;&amp; task)\n            : name(name)\n            , task(std:move(task))\n        {}\n        void start() {\n            task.run();\n        }\n};\nvoid myFunction()\n{\n    class MySimpleTask: public SimpleTask\n    {\n        public:\n            virtual void run() override\n            {\n                //Do something for this task\n                ...\n                // Destroying this is an exceptionally bad idea.\n                // Let the owner destroy it.\n                // I made the task hold it as an std::unique_ptr\n                // To solve this.    \n                // delete this;    //Finally, destroy the instance\n            }\n    };\n    ...\n    Thread myThread(\"MyTestingThread\", std::make_unique&lt;MySimpleTask&gt;());\n    myThread.start();\n    ...\n}\n</code></pre>\n\n<p>Now lets re-write using duck typing:</p>\n\n<pre><code>template&lt;typename F&gt;\nclass Thread\n{\n    std::string                    name;\n    F                              task\n    public:\n        Thread(std::string const&amp; name, F&amp;&amp; task)\n            : name(name)\n            , task(std:move(task))\n        {}\n        void start() {\n            task();\n        }\n};\ntemplate&lt;typename F&gt;\nThread&lt;F&gt; make_Thread(std::string const&amp; name, F&amp;&amp; f) {return Thread&lt;F&gt;(name, std::move(f));}\nvoid myFunction()\n{ \n    ...\n    auto  myThread = make_Thread(\"MyTestingThread\", [](argList){/* Do something for this task */});\n    myThread.start();\n    ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 487, "user_id": 6241424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ddb894d629c3cebb838a758aade708?s=128&d=identicon&r=PG&f=1", "display_name": "Hongkun Wang", "link": "https://stackoverflow.com/users/6241424/hongkun-wang"}, "edited": false, "score": 0, "creation_date": 1558568430, "post_id": 56264132, "comment_id": 99148722, "body": "Thanks for all your suggestions!"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1558562923, "last_edit_date": 1558562923, "creation_date": 1558555192, "answer_id": 56264132, "question_id": 56259644, "link": "https://stackoverflow.com/questions/56259644/in-c11-or-above-is-there-a-way-to-implement-a-single-method-pure-virtual-c/56264132#56264132", "title": "In C++11 or above, Is there a way to implement a single-method pure virtual C++ interface by lambda?", "body": "<p>This is a way to do @Holt's excellent answer with a bit better syntax.  It is not complete, because there is boilerplate to do.</p>\n\n<pre><code>template&lt;class C, class M = decltype(&amp;C::run)&gt;\nstruct run_as_lambda_impl;\n\n// non-const non-volatile non-ref qualified noexcept(false) case:\ntemplate&lt;class C, class R, class...Args&gt;\nstruct run_as_lambda_impl&lt;C, R(C::*)(Args...)&gt;: C {\n  std::function&lt;R(Args...)&gt; f;\n  R run(Args...) final override {\n    return static_cast&lt;R&gt;(f( std::forward&lt;Args&gt;(args)... ));\n  }\n};\n</code></pre>\n\n<p>You'll need 3 ref qualifies, times 2 const qualifies, times 2 volatile qualifies, times noexcept true/false for a total of 24 different versions of this.</p>\n\n<p>now imagine a macro:</p>\n\n<pre><code>#define RUN_AS_LAMBDA_TYPE( CLASS ) \\\n  run_as_lambda_impl&lt; CLASS &gt;\n</code></pre>\n\n<p>this hard codes <code>run</code> as the method we override, but does not hard code the signature.  Also we type erase the lambda, but I'm ok with that for now.</p>\n\n<p>We can get around this.</p>\n\n<pre><code>#define BASE_LAMBDA_TEMPLATE( NAME, METHOD ) \\\n  template&lt;class C, class M = decltype(&amp;C::METHOD)&gt; \\\n  struct NAME\n\n#define LAMBDA_TEMPLATE_IMPL( NAME, METHOD, QUALS ) \\\n  template&lt;class C, class R, class...Args&gt; \\\n  struct NAME&lt;C, R(C::*)(Args...) QUALS&gt; : C { \\\n    std::function&lt;R(Args...)&gt; f; \\\n    NAME( std::function&lt;R(Args...)&gt; fin ): f(std::move(fin)) {} \\\n    R METHOD(Args...) QUALS final override { \\\n      return static_cast&lt;R&gt;( f( std::forward&lt;Args&gt;(args)... ) ); \\\n    } \\\n  }\n\n  #define LAMBDA_TEMPLATE( NAME, METHOD ) \\\n    BASE_LAMBDA_TEMPLATE( NAME, METHOD ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, &amp; ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, &amp;&amp; ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, const ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, const &amp; ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, const &amp;&amp; ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile &amp; ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile &amp;&amp; ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile const ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile const &amp; ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile const &amp;&amp; ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, &amp; noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, &amp;&amp; noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, const noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, const &amp; noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, const &amp;&amp; noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile &amp; noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile &amp;&amp; noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile const noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile const &amp; noexcept(true) ); \\\n    LAMBDA_TEMPLATE_IMPL( NAME, METHOD, volatile const &amp;&amp; noexcept(true) )\n</code></pre>\n\n<p>which is 24 different <code>LAMBDA_TEMPLATE_IMPL</code> calls for the 3*2*2*2*2 types of method overrides.  You could reduce this:</p>\n\n<pre><code>#define LAMBDA_TEMPLATE_IMPL_C( NAME, METHOD, QUALS ) \\\n  LAMBDA_TEMPLATE_IMPL( NAME, METHOD, QUALS ); \\\n  LAMBDA_TEMPLATE_IMPL( NAME, METHOD, const QUALS )\n\n#define LAMBDA_TEMPLATE_IMPL_CV( NAME, METHOD, QUALS ) \\\n  LAMBDA_TEMPLATE_IMPL_C( NAME, METHOD, QUALS ); \\\n  LAMBDA_TEMPLATE_IMPL_C( NAME, METHOD, volatile QUALS )\n\n#define LAMBDA_TEMPLATE_IMPL_CVR( NAME, METHOD, QUALS ) \\\n  LAMBDA_TEMPLATE_IMPL_CV( NAME, METHOD, QUALS ); \\\n  LAMBDA_TEMPLATE_IMPL_CV( NAME, METHOD, &amp; QUALS ); \\\n  LAMBDA_TEMPLATE_IMPL_CV( NAME, METHOD, &amp;&amp; QUALS )\n\n#define LAMBDA_TEMPLATE_IMPL_CVRE( NAME, METHOD ) \\\n  LAMBDA_TEMPLATE_IMPL_CVR( NAME, METHOD,  ); \\\n  LAMBDA_TEMPLATE_IMPL_CVR( NAME, METHOD, noexcept(true) )\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>  #define LAMBDA_TEMPLATE( NAME, METHOD ) \\\n    BASE_LAMBDA_TEMPLATE( NAME, METHOD ); \\\n    LAMBDA_TEMPLATE_IMPL_CVRE( NAME, METHOD )\n</code></pre>\n\n<p>which is 3+3+3+3+4 = 16 lines instead of 24.</p>\n\n<hr>\n\n<p>Suppose you have these two interfaces:</p>\n\n<pre><code>class SimpleTask {\npublic:\n  virtual void run() = 0;\n};\n\nclass ComplexTask {\npublic:\n  virtual int do_stuff(int, double) = 0;\n};\n</code></pre>\n\n<p>then you can write</p>\n\n<pre><code>LAMBDA_TEMPLATE( LambdaRun, run );\nLAMBDA_TEMPLATE( LambdaDoTask, do_task );\n</code></pre>\n\n<p>and we can use <code>LambdaRun&lt;SimpleTask&gt;{ []{std::cout &lt;&lt; \"I ran\\n\"; } }</code> as a lambda-based implementation of <code>SimpleTask</code>.</p>\n\n<p>Similarly, <code>LambdaDoTask&lt;ComplexTask&gt;{ [](auto a, auto b) { return a+b; } }</code>.</p>\n\n<hr>\n\n<p>This isn't very Java-like.  Java is a far more OO-centric language than C++; in C++, OO design is an <em>option</em>.</p>\n\n<p>C++ lambdas create invokable objects that override <code>operator()</code>.  If you have something that is \"can be run with a signature\", the idiomatic way to do it in C++ is to use a <code>std::function&lt;void()&gt;</code> or similar.</p>\n\n<p><code>std::function</code> uses value semantics; internally you can store a pointer within the value if you want.</p>\n\n<p>So in C++ you'd want:</p>\n\n<pre><code>using SimpleTask = std::function&lt;void()&gt;;\n</code></pre>\n\n<p>and the rest of your code is now trivial:</p>\n\n<pre><code>Thread myThread(L\"MyTestingThread\", []{ /* code */} );\nmyThread.start();\n</code></pre>\n\n<p>because the lambda can be directly converted-to a <code>std::function&lt;void()&gt;</code> if the signatures are compatible.</p>\n\n<p>A part of this is migrating to value-semantics.</p>\n\n<p>But barring that, you'll want to </p>\n"}], "owner": {"reputation": 487, "user_id": 6241424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ddb894d629c3cebb838a758aade708?s=128&d=identicon&r=PG&f=1", "display_name": "Hongkun Wang", "link": "https://stackoverflow.com/users/6241424/hongkun-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 1, "accepted_answer_id": 56259784, "answer_count": 4, "score": 7, "last_activity_date": 1611333038, "creation_date": 1558536865, "last_edit_date": 1611333038, "question_id": 56259644, "link": "https://stackoverflow.com/questions/56259644/in-c11-or-above-is-there-a-way-to-implement-a-single-method-pure-virtual-c", "title": "In C++11 or above, Is there a way to implement a single-method pure virtual C++ interface by lambda?", "body": "<p>I have a large scale C++ library written in C++ 98, which heavily uses C++ interface (precisely, C++ classes with only pure virtual functions) for event handling. Now seeing that my code are compiled by C++11/14 compiler, I'm thinking if I can reduce boilerplate code by using C++11 lambda to replace interface implementation.</p>\n<p>In my library, there are some C++ interfaces who have only a single method, for example, the following interface us used to define a simple task:</p>\n<pre><code>class SimpleTask\n{\npublic:\n    virtual void run() = NULL;\n};\n</code></pre>\n<p>My intention is to use C++ lambda to replace the old single-method interface implementation code like this:</p>\n<pre><code>void myFunction()\n{\n    ...\n\n    class MySimpleTask : SimpleTask //An inline class to implement the iterface\n    {\n    public:\n        void run() \n        {\n            //Do somthing for this task\n            ...    \n            delete this;    //Finally, destroy the instance\n        }\n    };\n    MySimpleTask * myThreadTask = new MySimpleTask();\n    Thread myThread(L&quot;MyTestingThread&quot;, myThreadTask);\n    myThread.start();\n\n    ...\n}\n</code></pre>\n<p>In Java 8, <a href=\"http://tutorials.jenkov.com/java/lambda-expressions.html#lambda-expressions-vs-anonymous-interface-implementations\" rel=\"nofollow noreferrer\">we can use Java lambda to implement a single-method interface</a> to write code more concise than using anonymous class. I did a bit research in C++11 and found there nothing similar to this.</p>\n<p>Since my library's event handling code is designed in object oriented pattern, not in functional coding style, is there way to use lambda to help reduce those single-method interface implementation code?</p>\n"}, {"tags": ["c++", "multiple-inheritance", "virtual-inheritance"], "comments": [{"owner": {"reputation": 428, "user_id": 7421020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6faa42c836c9cf455d50c86e033c44b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/7421020/federico"}, "edited": false, "score": 2, "creation_date": 1558536919, "post_id": 56259568, "comment_id": 99135885, "body": "why getname and getSex  are implemented twice exactly with the same code? are you sure it is necessary?"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1558536965, "post_id": 56259568, "comment_id": 99135917, "body": "How should <code>InService</code> know which function it should call? It has 2 different implementations to choose from. <code>virtual</code> inheritance helps in case <i>base</i> class has method implemented."}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 0, "creation_date": 1558537325, "post_id": 56259568, "comment_id": 99136186, "body": "Why is <code>sex</code> and <code>name</code> property of students and workers? Does person not have those?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10444434"}, "reply_to_user": {"reputation": 428, "user_id": 7421020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6faa42c836c9cf455d50c86e033c44b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/7421020/federico"}, "edited": false, "score": 0, "creation_date": 1558537442, "post_id": 56259568, "comment_id": 99136261, "body": "@Federico so i was following this tutorial, and as i understood it is to made to use the same function name to operate on different objects. For example, base class is shape and it has pur virtual function getArea; we also have derived classes such as Rectangle, Circle and Triangle. Since for each shape it has different calculations, hence we need to use virtual fucntion. <a href=\"https://youtu.be/ng98qapa4Sw?t=1319\" rel=\"nofollow noreferrer\">youtu.be/ng98qapa4Sw?t=1319</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1558537459, "post_id": 56259568, "comment_id": 99136271, "body": "is there actually any difference between a <code>Worker</code> and a <code>Student</code> ? I have the feeling your design needs a fix, but I dont really understand what you want to design for, it rather seems like you could forget about inheritance all togther to achieve similar"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10444434"}, "reply_to_user": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 0, "creation_date": 1558537599, "post_id": 56259568, "comment_id": 99136358, "body": "@Quimby Didn&#39;t i declare sex and name variables in Person class ? and Students and Workers get it by inheritance ?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558537663, "post_id": 56259568, "comment_id": 99136394, "body": "@Dr.raider yes but there is no need to make the getters virtual you can define them in the base"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10444434"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558538460, "post_id": 56259568, "comment_id": 99136893, "body": "The thing it is a school task,and  the main.cpp code runs on the server, so i can&#39;t change it, i only need to implement the header file code. So by looking at that main function code i thought about inheritance. @formerlyknownas_463035818"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558538792, "post_id": 56259568, "comment_id": 99137091, "body": "ok then I understand. Would be good if you included that information in the question. Not being allowed to change the <code>main</code> but having to fill the holes is quite essential to understand your problem"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558538901, "post_id": 56259568, "comment_id": 99137151, "body": "once this out of the way, it is also clear that you do not necessarily have to use a diamond. Now its basically up to you if your question is targeted at fixing your diamond or solving the actual task ;)"}], "answers": [{"tags": [], "owner": {"reputation": 1435, "user_id": 5271478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0ee8d843b4e6f99de3b4baa563811b?s=128&d=identicon&r=PG&f=1", "display_name": "noobius", "link": "https://stackoverflow.com/users/5271478/noobius"}, "is_accepted": true, "score": 0, "last_activity_date": 1558542527, "last_edit_date": 1558542527, "creation_date": 1558541658, "answer_id": 56261088, "question_id": 56259568, "link": "https://stackoverflow.com/questions/56259568/diamond-problem-with-multiple-inheritance-c/56261088#56261088", "title": "Diamond problem with Multiple inheritance C++", "body": "<pre><code> InService(string _name, int _sex, string _sno, string _wno){\n        Person::name = _name;\n        Person::sex - _sex;\n        Worker::wno = _wno;\n        Student::sno = _sno;\n    }\n</code></pre>\n\n<p>There's a typo there, Person::sex - _sex; should be Person::sex = _sex;</p>\n\n<p>Also you can remove name and sex virtual function and have it just a standard function in Person, since it's exactly the same for all classes that derive from it.  That will remove the ambiguity of which getName and getSex function that InService class virtual table needs to point to.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10444434"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 56261088, "answer_count": 1, "score": 1, "last_activity_date": 1558542527, "creation_date": 1558536613, "last_edit_date": 1558540836, "question_id": 56259568, "link": "https://stackoverflow.com/questions/56259568/diamond-problem-with-multiple-inheritance-c", "title": "Diamond problem with Multiple inheritance C++", "body": "<p>I have a homework task with a given main.cpp code wich is not allowed to be changed. According to that main.cpp and simple <strong>input</strong> and <strong>output</strong>(which is down below) example i must to finish the program. My tries are: I'm trying to create 4 classes, class Person; class Worker; class Student; class InService; in my main function through instantiating an object of InService class i pass 4 parameters (name,sex,studentNo,workerNo); and with help of pointer of type of Base class, have the desired output.  The error it shows is: <strong>[Error] no unique final overrider for 'virtual std::string Person::getName()' in 'InService'\n          [Error] no unique final overrider for 'virtual int Person::getSex()' in 'InService'</strong></p>\n\n<p>I've tried to use virtual inheritance for that, but i can't really figure out how to solve this problem. I did some research on virtual inheritance, and referenced to other experts <a href=\"https://stackoverflow.com/questions/24006199/virtual-inheritance-error-no-unique-final-overrider\">answers</a>, but still getting confused with whole OOP stuff. </p>\n\n<pre><code>//Inservice.h\n#include&lt;string&gt;\nusing namespace std;\nclass Person{\n    public:\n        Person();\n        ~Person();      \n        string name;\n        int sex;\n        virtual string getName() = 0;\n        virtual int getSex()  = 0;\n};\n///////////////////////////////////////////////////\nclass Student:virtual public Person{\n    public:\n        Student();\n        ~Student();\n        string sno;\n\n        virtual string getName() {\n        return name;\n        }\n\n        virtual int getSex(){\n            return sex;\n        }\n\n        string getSno(){\n            return sno;\n        }\n};\n//////////////////////////////////////////////////\nclass Worker:virtual public Person{\n    public:\n        Worker();\n        ~Worker();\n        string wno;\n\n        virtual std::string getName(){\n        return name;\n        }\n\n        virtual int getSex(){\n            return sex;\n        }\n\n        string getWno(){\n            return wno;\n        }\n};\n///////////////////////////////////////////////////////\nclass InService: public Student, public Worker{\n    public:\n    InService(string _name, int _sex, string _sno, string _wno){\n        Person::name = _name;\n        Person::sex - _sex;\n        Worker::wno = _wno;\n        Student::sno = _sno;\n    }\n};\n///////////////////////////////////////////////////////\n\n//main.cpp\n#include &lt;iostream&gt;\n#include \"inservice.h\"\nusing namespace std;\n\nint main() {\n    string name, sno, wno;\n    int sex;\n\n    cin &gt;&gt; name;\n    cin &gt;&gt; sex;\n    cin &gt;&gt; sno;\n    cin &gt;&gt; wno;\n\n    InService is(name, sex, sno, wno);\n\n    Person* p = &amp;is;\n    Student* s = &amp;is;\n    Worker* w = &amp;is; \n\n    cout &lt;&lt; p-&gt;getName() &lt;&lt; endl;\n    cout &lt;&lt; p-&gt;getSex() &lt;&lt; endl;\n\n    cout &lt;&lt; s-&gt;getName() &lt;&lt; endl;\n    cout &lt;&lt; s-&gt;getSex() &lt;&lt; endl;\n    cout &lt;&lt; s-&gt;getSno() &lt;&lt; endl;\n\n    cout &lt;&lt; w-&gt;getName() &lt;&lt; endl;\n    cout &lt;&lt; w-&gt;getSex() &lt;&lt; endl;\n    cout &lt;&lt; w-&gt;getWno() &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>Suppose my input is:  </p>\n\n<pre><code>Jack  \n1 //1-for male; 0 -for female  \n12345678 //studentNo\n87654321  //workerNo  \n</code></pre>\n\n<p>I expect the output to be:  </p>\n\n<pre><code>Jack  \n1  \n12345678   \nJack  \n1  \n87654321  \n</code></pre>\n"}, {"tags": ["c++", "templates", "compiler-errors", "ostream", "c++98"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5549921"}, "edited": false, "score": 0, "creation_date": 1558536865, "post_id": 56259620, "comment_id": 99135853, "body": "For some reason I&#39;ve done this in the past and it has worked fine and yet now my compilers are choosing to only accept non-constants.."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1558537001, "post_id": 56259620, "comment_id": 99135941, "body": "@finnrayment You may have done that with other operators, but I doubt that any compiler has ever been broken enough to let you do it with <code>operator&lt;&lt;</code> and <code>std::ostream</code>. (Note that you won&#39;t get a problem if you never use the stream - <code>std::cout &lt;&lt; tree;</code> should work as long as your overload doesn&#39;t write anything.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5549921"}, "edited": false, "score": 0, "creation_date": 1558537101, "post_id": 56259620, "comment_id": 99136019, "body": "Honest to god, I swear I did it with <code>operator&lt;&lt;</code> on <code>std::ostream</code> the other day and it compiled on more than three computers... Regardless, you have solved my issue, so thank you very much!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558537140, "post_id": 56259620, "comment_id": 99136039, "body": "@finnrayment it is &quot;fine&quot; for <code>std::cout &lt;&lt; x;</code> but anything beyond that not. The stream itself it not const of course, but <code>std::cout &lt;&lt; x;</code> results in a <code>const</code> reference, hence <code>std::cout &lt;&lt; x &lt;&lt; whatever;</code> cannot work"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5549921"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1558537212, "post_id": 56259620, "comment_id": 99136079, "body": "@formerlyknownas_463035818 Ah-hah ! That would be why; I was doing one liners exactly like that"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1558537265, "post_id": 56259620, "comment_id": 99136140, "body": "@finnrayment I fall into this trap on a regular basis, forgetting to return the stream, ignoring the warning, all seems fine until I use chaining..."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 5, "last_activity_date": 1558536776, "creation_date": 1558536776, "answer_id": 56259620, "question_id": 56259520, "link": "https://stackoverflow.com/questions/56259520/unable-to-pipe-template-class-to-cout/56259620#56259620", "title": "Unable to pipe template class to cout", "body": "<p>Remove the <code>const</code>s on <code>std::ostream</code> - you can't use a const stream for anything.</p>\n\n<pre><code>template &lt;typename value_type&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; o, const Tree&lt;value_type&gt;&amp; t) {\n    return o;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5549921"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56259620, "answer_count": 1, "score": 3, "last_activity_date": 1558536781, "creation_date": 1558536502, "last_edit_date": 1558536781, "question_id": 56259520, "link": "https://stackoverflow.com/questions/56259520/unable-to-pipe-template-class-to-cout", "title": "Unable to pipe template class to cout", "body": "<p>When I try to compile the following (truncated into the small snippet below) code,</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\ntemplate &lt;typename value_type&gt;\nclass Tree {\npublic:\n    Tree();\n    ~Tree();\n};\n\ntemplate &lt;typename value_type&gt;\nconst std::ostream&amp; operator&lt;&lt;(const std::ostream&amp; o, const Tree&lt;value_type&gt;&amp; t) {\n    return o;\n}\n\nint main() {\n    Tree&lt;int&gt; tree;\n    cout &lt;&lt; tree &lt;&lt; endl;\n}\n</code></pre>\n\n<p>I get the following errors:</p>\n\n<p><strong>clang</strong> on a mac</p>\n\n<pre><code>error: reference to overloaded function could not be resolved;\n      did you mean to call it?\n        cout &lt;&lt; tree &lt;&lt; endl;\n                        ^~~~\n</code></pre>\n\n<p><strong>gnu gcc</strong> on debian linux</p>\n\n<pre><code>error: no match for 'operator&lt;&lt;'\n(operand types are\n    'const ostream {aka const std::basic_ostream&lt;char&gt;}'\n    and '&lt;unresolved overloaded function type&gt;')\n        cout &lt;&lt; tree &lt;&lt; endl;\n        ~~~~~~~~~~~~~^~~~~~~\n</code></pre>\n\n<p>If I never implement the operator overload, gnu g++ instead gives me the following error:</p>\n\n<pre><code>error: no match for 'operator&lt;&lt;'\n(operand types are\n    'std::ostream {aka std::basic_ostream&lt;char&gt;}'\n    and 'Tree&lt;int&gt;')\n        cout &lt;&lt; tree &lt;&lt; endl;\n        ~~~~~^~~~~~~\n</code></pre>\n\n<p>I don't actually understand what I am doing wrong here. All I want to do is be able to pipe my template class to <code>ostream</code> as you do. Any ideas?</p>\n"}, {"tags": ["c++", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 562, "user_id": 2721822, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Sn6dE.png?s=128&g=1", "display_name": "Hani Gotc", "link": "https://stackoverflow.com/users/2721822/hani-gotc"}, "edited": false, "score": 1, "creation_date": 1558537250, "post_id": 56259515, "comment_id": 99136128, "body": "@HaniGotc: because all your <code>result_of</code> also need to change: <a href=\"https://wandbox.org/permlink/kfs953jtSdr17Gq3\" rel=\"nofollow noreferrer\">wandbox.org/permlink/kfs953jtSdr17Gq3</a>"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 2, "last_activity_date": 1558537876, "last_edit_date": 1558537876, "creation_date": 1558536474, "answer_id": 56259515, "question_id": 56259430, "link": "https://stackoverflow.com/questions/56259430/apply-transformation-to-vector-with-index-using-template-function/56259515#56259515", "title": "apply transformation to vector with index using template function", "body": "<p>You call <code>itransformationFunction(idx, element)</code> (2 arguments)\nwhereas your lambda once expect one.</p>\n\n<p>Change call to something like:</p>\n\n<pre><code>transformWithIndex(source, [](int index, int &amp;elem) { return index + 1; })\n</code></pre>\n\n<p>and your <code>result_of</code> should be fixed too to include index:</p>\n\n<pre><code>template &lt;typename Range, class TransformationFunction&gt;\nstd::vector&lt;typename std::result_of&lt;TransformationFunction(std::size_t, typename Range::value_type)&gt;::type&gt;\ntransformWithIndex(const Range &amp;iRange, const TransformationFunction &amp;itransformationFunction) {\n  std::vector&lt;typename std::result_of&lt;TransformationFunction(std::size_t, typename Range::value_type)&gt;::type&gt; result;\n  int                                                                                            idx = 0;\n  for (auto &amp;&amp;element : iRange) {\n    result.push_back(itransformationFunction(idx, element));\n    idx++;\n  }\n  return result;\n}\n</code></pre>\n\n<p>and <code>std::decay_t</code> should probably be applied to handle cases when functor return reference or const objects.</p>\n"}], "owner": {"reputation": 562, "user_id": 2721822, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Sn6dE.png?s=128&g=1", "display_name": "Hani Gotc", "link": "https://stackoverflow.com/users/2721822/hani-gotc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56259515, "answer_count": 1, "score": 0, "last_activity_date": 1558537876, "creation_date": 1558536188, "question_id": 56259430, "link": "https://stackoverflow.com/questions/56259430/apply-transformation-to-vector-with-index-using-template-function", "title": "apply transformation to vector with index using template function", "body": "<p>I am trying to apply a transformation on a vector while also adding the index in the transformation function. I am using the following transformation function <code>transformWithIndex</code>. If I remove <code>idx</code> from <code>result.push_back(itransformationFunction(idx, element));</code> it works correctly. </p>\n\n<blockquote>\n  <p>I understood that I have an extra argument. But I don't understand how\n  to modify the transformation function in order to handle the IDX.</p>\n</blockquote>\n\n<hr>\n\n<pre><code>// Example program That can be tested\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\ntemplate &lt;typename Range, class TransformationFunction&gt;\ninline std::vector&lt;typename std::result_of&lt;TransformationFunction(typename Range::value_type)&gt;::type&gt;\ntransformWithIndex(const Range &amp;iRange, const TransformationFunction &amp;itransformationFunction) {\n  std::vector&lt;typename std::result_of&lt;TransformationFunction(typename Range::value_type)&gt;::type&gt; result;\n  int                                                                                            idx = 0;\n  for (auto &amp;&amp;element : iRange) {\n    result.push_back(itransformationFunction(idx, element));\n    idx++;\n  }\n  return result;\n}\n\nint main()\n{\n   std::vector&lt;int&gt; source = {1, 2, 3};\n   std::vector&lt;int&gt; result = transformWithIndex(source, [](int i) { return ++i; });\n\n   return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>The errors are the following:</p>\n\n<pre><code>&gt;  In instantiation of 'std::vector&lt;typename\n&gt; std::result_of&lt;TransformationFunction(typename\n&gt; Range::value_type)&gt;::type&gt; transformWithIndex(const Range&amp;, const\n&gt; TransformationFunction&amp;) [with Range = std::vector&lt;int&gt;;\n&gt; TransformationFunction = main()::&lt;lambda(int)&gt;; typename\n&gt; std::result_of&lt;TransformationFunction(typename\n&gt; Range::value_type)&gt;::type = int]': 21:82:   required from here 12:58:\n&gt; error: no match for call to '(const main()::&lt;lambda(int)&gt;) (int&amp;,\n&gt; const int&amp;)' 21:58: note: candidates are: 12:58: note: int (*)(int)\n&gt; &lt;conversion&gt; 12:58: note:   candidate expects 2 arguments, 3 provided\n&gt; 21:65: note: main()::&lt;lambda(int)&gt; 21:65: note:   candidate expects 1\n&gt; argument, 2 provided\n</code></pre>\n"}, {"tags": ["c++", "design-patterns", "super", "anti-patterns"], "comments": [{"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1558536694, "post_id": 56259418, "comment_id": 99135736, "body": "I don&#39;t get it. Doesn&#39;t this actually call the derived class&#39;s <code>onInit</code> twice? Once from <code>Base</code>&#39;s <code>init</code>, and once from the expansion of the <code>DELEGATE</code> macro."}, {"owner": {"reputation": 755, "user_id": 1376968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/307fe759978ad86e4916f71883be1cf1?s=128&d=identicon&r=PG", "display_name": "lagarkane", "link": "https://stackoverflow.com/users/1376968/lagarkane"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1558537244, "post_id": 56259418, "comment_id": 99136122, "body": "Sorry, you&#39;re right. Base::init() should call Base::onInit() insteead on onInit() I fixed my post, sorry for that"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558539077, "post_id": 56259418, "comment_id": 99137244, "body": "You might use CRTP, instead of MACRO (and so handle easily multiple inheritance)."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558539388, "post_id": 56259418, "comment_id": 99137399, "body": "For duplicated calls, you might pass a <code>std::set&lt;std::type_index&gt;</code> to conditionally call <code>onInit</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558539628, "post_id": 56259418, "comment_id": 99137527, "body": "Unfortunately, <a href=\"https://stackoverflow.com/questions/18435001/what-is-the-status-of-n2965-stdbases-and-stddirect-bases\">proposal for <code>std::bases</code> and <code>std::direct_bases</code></a> has been rejected."}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 1376968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/307fe759978ad86e4916f71883be1cf1?s=128&d=identicon&r=PG", "display_name": "lagarkane", "link": "https://stackoverflow.com/users/1376968/lagarkane"}, "edited": false, "score": 0, "creation_date": 1558537731, "post_id": 56259660, "comment_id": 99136442, "body": "Thanks for your answer @bartop but this won&#39;t do for me, as I want all the childs, and the child&#39;s childs to get their init() method called in a cascade. If I had a class A inheriting Base, a class B inheriting A and a class C inheriting B for instance, I&#39;d want a call to init() on C to perform the following calls: Base::init(); A::init(): B::init(); C::init()"}], "tags": [], "owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "is_accepted": false, "score": 0, "last_activity_date": 1558536892, "creation_date": 1558536892, "answer_id": 56259660, "question_id": 56259418, "link": "https://stackoverflow.com/questions/56259418/cascade-calls-on-override-virtual-methods/56259660#56259660", "title": "Cascade calls on override virtual methods", "body": "<p>This is what I would to protect yourself from forgetting about overriding in children classes. This is simple template method design pattern implementation:</p>\n\n<pre><code>class Base {\npublic:\n    void init() {\n        //base init steps\n        childInit();\n    }\n\nprivate:\n    virtual void childInit() = 0;\n};\n\nclass Child : public Base {\nprivate:\n    void childInit() override { /*init the child*/}\n};\n</code></pre>\n"}], "owner": {"reputation": 755, "user_id": 1376968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/307fe759978ad86e4916f71883be1cf1?s=128&d=identicon&r=PG", "display_name": "lagarkane", "link": "https://stackoverflow.com/users/1376968/lagarkane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1558538623, "creation_date": 1558536143, "last_edit_date": 1558538623, "question_id": 56259418, "link": "https://stackoverflow.com/questions/56259418/cascade-calls-on-override-virtual-methods", "title": "Cascade calls on override virtual methods", "body": "<p>I'm working on a large software, that heavily relies on the call super anti-pattern.</p>\n\n<p>Basically, an interface defines an <code>init()</code> virtual method that is then overridden in every classes that inherits it.\nWhen <code>init()</code> is called on the class, EVERY overloaded <code>init</code> methods are cascaded, from the base class to the top daughter class, and all in between.</p>\n\n<p>But the user HAS to call its direct parent's <code>init()</code> method in its own, which results in code like this:</p>\n\n<pre><code>class myClass : public Base\n{\n    virtual void init()\n    {\n        Parent::Init() // often forgotten, or misplaced by the developer\n        // Do some init stuff\n    }\n}\n</code></pre>\n\n<p>An alternative to this is usually to use delegates. The Base class has stuff to do in <code>init</code>, that is declared <code>final</code> in Base, and delegates part of it to an <code>onInit()</code> method that inheriting classes should override. But this does not cascade the calls to all parent classes as I'd like it to.</p>\n\n<p>The alternative I've first implemented is a variant of the delegate approach. Both daughter classes and Base implement a <code>onInit()</code> and a <code>init()</code> method. \n<code>init()</code> calls <code>Parent::init()</code> followed by a call to <code>onInit()</code> on itself, and is auto-generated using template meta-programming &amp; macros.\nand <code>onInit()</code> contains the class-specific code.</p>\n\n<pre><code># define DELEGATE(T, Parent) \\\n     void init() override { Parent::init(); T::onInit(); }\n\nstruct Base\n{\n    virtual void init() { Base::onInit(); }\n    virtual void onInit() {}\n};\n\nstruct A : public Base\n{\n     DELEGATE(A, Base)\n     void onInit() override { /* MyCustom code for A */ }\n};\n\nstruct B : public A\n{\n     DELEGATE(B, A)\n     void onInit() override { /* MyCustom code for B */ }\n};\n</code></pre>\n\n<p>This works pretty well.. except that multiple inheritance becomes a mess, and even if handled, diamond inheritance causes issues with duplicated calls.</p>\n\n<p>Which leaves me wondering: I can't be the only person looking for a design pattern solving my issue, and the stackoverflow community must know about it :)</p>\n\n<p>Have you ever encountered a design pattern for this?\nI'm really looking forward to your ideas!</p>\n"}, {"tags": ["c++", "c++14"], "comments": [{"owner": {"reputation": 623, "user_id": 11047101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8166d13f72bafa5d26bdf3517a98a?s=128&d=identicon&r=PG&f=1", "display_name": "User Using", "link": "https://stackoverflow.com/users/11047101/user-using"}, "edited": false, "score": 5, "creation_date": 1558535564, "post_id": 56259192, "comment_id": 99135057, "body": "What about the <code>else</code> branch?, What would the function returns <code>if(not)</code>?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1558535566, "post_id": 56259192, "comment_id": 99135058, "body": "Your example is strange btw, as forwarding is not needed, const ref does the job here."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558535632, "post_id": 56259192, "comment_id": 99135092, "body": "@Jarod42 You mean because of the template type deduction rule?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1558535677, "post_id": 56259192, "comment_id": 99135120, "body": "You don&#39;t say what version of c++ you are compiling against. Use of clever deduced return types needs better than C++11"}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 623, "user_id": 11047101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8166d13f72bafa5d26bdf3517a98a?s=128&d=identicon&r=PG&f=1", "display_name": "User Using", "link": "https://stackoverflow.com/users/11047101/user-using"}, "edited": false, "score": 0, "creation_date": 1558535709, "post_id": 56259192, "comment_id": 99135143, "body": "@UsingCpp That is the answer!!!! It could not deduce the type with my example, omg, how stupid I am..."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1558535735, "post_id": 56259192, "comment_id": 99135163, "body": "@GemTaylor Yes, added the tag now"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1558535835, "post_id": 56259192, "comment_id": 99135224, "body": "I can&#39;t reproduce this error message."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1558535922, "post_id": 56259192, "comment_id": 99135278, "body": "@Brian Try with <code>int a = 2</code>, the code will be out of if statement and auto won&#39;t be able to deduce the type, I should have added which int I used"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 1, "creation_date": 1558536128, "post_id": 56259192, "comment_id": 99135415, "body": "Still can&#39;t reproduce it. The arguments passed at run-time should not cause a compile-time error. See <a href=\"http://coliru.stacked-crooked.com/a/b09f50dbccdb549f\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/b09f50dbccdb549f</a>"}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "edited": false, "score": 0, "creation_date": 1558535545, "post_id": 56259212, "comment_id": 99135052, "body": "Yes correct but I still get this error: <code>error: use of \u2018decltype(auto) factorgraph::normalize_pose(T&amp;&amp;) [with T = int&amp;]\u2019 before deduction of \u2018auto\u2019   auto test = factorgraph::normalize_pose(a);</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1558535953, "post_id": 56259212, "comment_id": 99135297, "body": "Pretty sure <code>decltype(auto)</code> is also not needed since <code>std::forward&lt;T&gt;(pose) - 2* M_PI</code> is most likely a prvalue expression and the else branch wouldn&#39;t."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558536084, "post_id": 56259212, "comment_id": 99135387, "body": "@NathanOliver Dunno guys, I am here to learn if needed. I just followed the example from the book &quot;Effective Modern C++&quot;"}, {"owner": {"reputation": 623, "user_id": 11047101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8166d13f72bafa5d26bdf3517a98a?s=128&d=identicon&r=PG&f=1", "display_name": "User Using", "link": "https://stackoverflow.com/users/11047101/user-using"}, "edited": false, "score": 0, "creation_date": 1558536338, "post_id": 56259212, "comment_id": 99135538, "body": "Unrelated: <code>decltype(auto)</code> simply can be <code>T</code>. I don&#39;t know why OP want this way!"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558536355, "post_id": 56259212, "comment_id": 99135546, "body": "Updated code fails if an integer is passed: <a href=\"http://coliru.stacked-crooked.com/a/13731e038276b632\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/13731e038276b632</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558536388, "post_id": 56259212, "comment_id": 99135569, "body": "Although that may be moot as normalizing an <code>int</code> doesn&#39;t make a lot of sense."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 623, "user_id": 11047101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8166d13f72bafa5d26bdf3517a98a?s=128&d=identicon&r=PG&f=1", "display_name": "User Using", "link": "https://stackoverflow.com/users/11047101/user-using"}, "edited": false, "score": 1, "creation_date": 1558536399, "post_id": 56259212, "comment_id": 99135577, "body": "@UsingCpp According to the book I have mentioned it should be decltype because auto slices off the &amp; part due to the template type deduction rule"}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558536464, "post_id": 56259212, "comment_id": 99135602, "body": "@NathanOliver because it is not always int, what if I have supplied float?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1558536510, "post_id": 56259212, "comment_id": 99135639, "body": "It still wont work because of <code>decltype(auto)</code>.  Do you really want a reference returned?"}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558536564, "post_id": 56259212, "comment_id": 99135668, "body": "@NathanOliver No but in some cases returning the reference will be important."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558536758, "post_id": 56259212, "comment_id": 99135769, "body": "@NathanOliver I think my knowledge stops there. Can you explain what exactly might go wrong with this code?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558536766, "post_id": 56259212, "comment_id": 99135777, "body": "@NathanOliver: Fixed. Didn&#39;t want to change OP&#39;s code that much. (we can probably get rid of template too, and just use <code>double</code>)."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "edited": false, "score": 0, "creation_date": 1558536822, "post_id": 56259212, "comment_id": 99135820, "body": "@Jarod42 But what happens if I supply &amp;int? I guess T return value will be int?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "edited": false, "score": 3, "creation_date": 1558536878, "post_id": 56259212, "comment_id": 99135859, "body": "@Edmund The code as it is now is really what you would want.  Using <code>decltyp(auto)</code>, to get a reference returned can&#39;t work because <code>pose - 2 * M_PI</code> will not have the same type as <code>pose</code>.  For <code>decltype(auto)</code> to work all control paths need to return the same type and you just can&#39;t do that in this situation."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558536943, "post_id": 56259212, "comment_id": 99135903, "body": "@NathanOliver You mean if pose is int, the return type will be double/float?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "edited": false, "score": 1, "creation_date": 1558537144, "post_id": 56259212, "comment_id": 99136042, "body": "@Edmund No.  Lets say <code>T</code> is a double.  then <code>pose - 2 * M_PI</code> would be of type <code>double</code>.  <code>pose</code> on the other hand would be of type <code>double const &amp;</code> since that is the type of <code>pose</code>.  <code>double</code> and <code>double const &amp;</code> are not the same type so <code>decltype(auto)</code> fails.  You can use Jarod&#39;s solution and then if you need a normalized value, but also setting the variable to that normalized value, you can use something like <code>auto foo = (bar = normalize(bar)) * more_stuff;</code>"}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558537404, "post_id": 56259212, "comment_id": 99136227, "body": "@NathanOliver Just a quick question, so why does the author of Effective Modern C++ writes this as a good example? <code>template&lt;typename Container, typename Index&gt; decltype(auto) authAndAccess(Container&amp;&amp; c, Index i) { authenticateUser(); return std::forward&lt;Container&gt;(c)[i]; }</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "edited": false, "score": 0, "creation_date": 1558537548, "post_id": 56259212, "comment_id": 99136323, "body": "@Edmund Because that function can only return a single type.  That means they can return the exact reference type.  Had the function been <code>template&lt;typename Container, typename Index&gt; decltype(auto) authAndAccess(Container&amp;&amp; c, Index i) { if (authenticateUser()) return std::forward&lt;Container&gt;(c)[i]; else return foo; }</code> then you are returning 2 different types and it can&#39;t work."}, {"owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558537653, "post_id": 56259212, "comment_id": 99136388, "body": "@NathanOliver Okay but if the else return type was double (for example multiplied by M_PI) then my example code will be valid?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "edited": false, "score": 0, "creation_date": 1558537725, "post_id": 56259212, "comment_id": 99136440, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193779/discussion-between-nathanoliver-and-edmund\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 8, "last_activity_date": 1558536670, "last_edit_date": 1558536670, "creation_date": 1558535441, "answer_id": 56259212, "question_id": 56259192, "link": "https://stackoverflow.com/questions/56259192/my-template-function-with-the-universal-reference-does-not-work/56259212#56259212", "title": "My template function with the universal reference does not work", "body": "<p>It should be</p>\n\n<pre><code>if (pose &gt; 2 * M_PI) return std::forward&lt;T&gt;(pose) - 2* M_PI;\n</code></pre>\n\n<p>Apply <code>std::forward</code> to variable only.</p>\n\n<p>And you also need to return value for the else branch (of the same type to satisfy \n <code>decltype(auto)</code>).</p>\n\n<p>But in your case, a simple:</p>\n\n<pre><code>template&lt;typename T&gt;\nauto normalize_pose(const T&amp; pose)\n{\n    return (pose &gt; 2 * M_PI) ? pose - 2 * M_PI : pose;\n}\n</code></pre>\n\n<p>handles all cases.</p>\n"}], "owner": {"reputation": 859, "user_id": 10280636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76cf49e7821c17ee227e4d07e7ee5076?s=128&d=identicon&r=PG&f=1", "display_name": "aikhs", "link": "https://stackoverflow.com/users/10280636/aikhs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56259212, "answer_count": 1, "score": 2, "last_activity_date": 1558536670, "creation_date": 1558535362, "last_edit_date": 1558535940, "question_id": 56259192, "link": "https://stackoverflow.com/questions/56259192/my-template-function-with-the-universal-reference-does-not-work", "title": "My template function with the universal reference does not work", "body": "<p>I want to make a template function that is flexible and can take both rvalue and lvalue. This is how I wrote it:</p>\n\n<pre><code>template&lt;typename T&gt;\ndecltype(auto) normalize_pose(T&amp;&amp; pose)\n{\n    if (pose &gt; 2 * M_PI) return std::forward&lt;T&gt;(pose - 2* M_PI);\n} \n</code></pre>\n\n<p>So I double checked the function and it seems correct to me. Then I have decided to test it and wrote:</p>\n\n<pre><code>int a = 2;\nauto test = factorgraph::normalize_pose(a);\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code> error: use of \u2018decltype(auto) factorgraph::normalize_pose(T&amp;&amp;) [with T = int&amp;]\u2019 before deduction of \u2018auto\u2019\n</code></pre>\n\n<p>If I try to add <code>&lt;int&gt;</code>, I get an error that no such function exist.</p>\n"}, {"tags": ["c++", "qt5", "smart-pointers"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1558534782, "post_id": 56258964, "comment_id": 99134552, "body": "Maybe you forgot to include <code>QLineEdit</code> header?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1558536039, "post_id": 56258964, "comment_id": 99135357, "body": "<code>...to incomplete type &#39;QLineEdit&#39;</code> - clear indication the compiler hasn&#39;t a clue what a QLineEdit is at the time of compiling that line of source. So.. figure out why. Missing header? Conditionally excluded by preprocessor? There could be any number of reasons that we could only guess."}], "answers": [{"tags": [], "owner": {"reputation": 27886, "user_id": 158285, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/53f7def58ca1dfdc13369dfd5e2aaace?s=128&d=identicon&r=PG", "display_name": "bradgonesurfing", "link": "https://stackoverflow.com/users/158285/bradgonesurfing"}, "is_accepted": true, "score": 0, "last_activity_date": 1558538001, "creation_date": 1558538001, "answer_id": 56260022, "question_id": 56258964, "link": "https://stackoverflow.com/questions/56258964/why-i-cant-use-the-smart-pointer-to-make-a-new-qlineedit-class/56260022#56260022", "title": "why i can&#39;t use the smart-pointer to make a new QLineEdit class", "body": "<p>Include the header files correctly</p>\n\n<pre><code>#include &lt;QTextEdit&gt; // https://doc.qt.io/qt-5/qlineedit.html\n#include &lt;QLineEdit&gt; // https://doc.qt.io/qt-5/qtextedit.html\n#include &lt;memory&gt;     //https://en.cppreference.com/w/cpp/memory/shared_ptr/make_shared\n\nint main(){\n   shared_ptr&lt;QTextEdit&gt; t1 = std::make_shared&lt;QTextEdit&gt;(); \n   shared_ptr&lt;QLineEdit&gt; t2 = std::make_shared&lt;QLineEdit&gt;(); \n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8579930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c26a20803de76dcfb04bd3f869ccc10?s=128&d=identicon&r=PG&f=1", "display_name": "\u90d1\u94a6\u80dc", "link": "https://stackoverflow.com/users/8579930/%e9%83%91%e9%92%a6%e8%83%9c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56260022, "answer_count": 1, "score": 0, "last_activity_date": 1558538001, "creation_date": 1558534663, "question_id": 56258964, "link": "https://stackoverflow.com/questions/56258964/why-i-cant-use-the-smart-pointer-to-make-a-new-qlineedit-class", "title": "why i can&#39;t use the smart-pointer to make a new QLineEdit class", "body": "<p>As the title demonstrates, i want to use some buffer for QLineEdit class by smart-pointer, but the compiler show \"invaild application of 'sizeof' to incomplete type 'QLineEdit'\". I found the 'aligned_buffer.h' file by buiding message. but it is helpless. What i'm confused about is when i use the same way to use some buffer for QTextEdit, the compiler is successful. why QLineEdit can't use same way to do that?</p>\n\n<pre><code>...\nshared_ptr&lt;QTextEdit&gt; t1 = make_shared&lt;QTextEdit&gt;(); // successd\nshared_ptr&lt;QLineEdit&gt; t2 = make_shared&lt;QLineEdit&gt;(); // failed\n...\n</code></pre>\n"}, {"tags": ["c++", "clang", "clang++", "gcov"], "comments": [{"owner": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "edited": false, "score": 1, "creation_date": 1560940841, "post_id": 56258782, "comment_id": 99899443, "body": "Did you mean <code>llvm-cov</code>? Clang has it&#39;s own coverage source code intrumentation method, currently I don&#39;t know if it is compatible with gcov."}], "answers": [{"comments": [{"owner": {"reputation": 10938, "user_id": 155082, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f1316ecb725006d020998e6b8a0740c?s=128&d=identicon&r=PG", "display_name": "Lothar", "link": "https://stackoverflow.com/users/155082/lothar"}, "edited": false, "score": 1, "creation_date": 1607309700, "post_id": 56665794, "comment_id": 115223294, "body": "This once pointed to a valid version of the Clang manual but now at CLang 12 it only contains a description of the new sanitizer coverage &quot;-fprofile-instr-generate&quot; not the gcov format anymore."}, {"owner": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "reply_to_user": {"reputation": 10938, "user_id": 155082, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f1316ecb725006d020998e6b8a0740c?s=128&d=identicon&r=PG", "display_name": "Lothar", "link": "https://stackoverflow.com/users/155082/lothar"}, "edited": false, "score": 0, "creation_date": 1607341515, "post_id": 56665794, "comment_id": 115232715, "body": "Thanks for the heads up @Lothar , have updated the answer to point to <code>llvm-cov gcov</code> documentation. But the other answer might be more relevant."}], "tags": [], "owner": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "is_accepted": false, "score": 0, "last_activity_date": 1607341438, "last_edit_date": 1607341438, "creation_date": 1560940958, "answer_id": 56665794, "question_id": 56258782, "link": "https://stackoverflow.com/questions/56258782/when-i-compile-my-code-with-clang-gcov-throws-out-of-memory-error/56665794#56665794", "title": "When I compile my code with clang, gcov throws out of memory error", "body": "<p><a href=\"https://clang.llvm.org/docs/SourceBasedCodeCoverage.html\" rel=\"nofollow noreferrer\">Here's</a> reference to get Source based code coverage report from Clang and associated utilities.</p>\n<p><strong>Update:</strong>\nAs noted by @Lothar in the comment the above-mentioned link now points to Source-Based Code Coverage supported by Clang Tooling, <code>gcov</code> compatible example section has been removed.</p>\n<p>For <code>gcov</code> compatible documentation one can refer <a href=\"https://llvm.org/docs/CommandGuide/llvm-cov.html\" rel=\"nofollow noreferrer\">here</a> for the <code>llvm-cov gcov</code> command line invocation.</p>\n"}, {"tags": [], "owner": {"reputation": 861, "user_id": 1945549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ae77cbb3459cfc6ea048204839160e7?s=128&d=identicon&r=PG", "display_name": "Roland Sarrazin", "link": "https://stackoverflow.com/users/1945549/roland-sarrazin"}, "is_accepted": false, "score": 4, "last_activity_date": 1569505761, "creation_date": 1569505761, "answer_id": 58118318, "question_id": 56258782, "link": "https://stackoverflow.com/questions/56258782/when-i-compile-my-code-with-clang-gcov-throws-out-of-memory-error/58118318#58118318", "title": "When I compile my code with clang, gcov throws out of memory error", "body": "<p>I faced a similar mismatching version issue when trying to generate html reports with <code>lcov</code> and xml reports with <code>gcovr</code>.</p>\n\n<h2>lcov</h2>\n\n<p>I added the parameter <code>--gcov-tool gcov_for_clang.sh</code>.</p>\n\n<h2>gcovr</h2>\n\n<p>I added the parameter <code>--gcov-executable gcov_for_clang.sh</code>.</p>\n\n<h2>gcov_for_clang.sh</h2>\n\n<p>Contains:</p>\n\n<pre><code>#!/bin/bash\nexec llvm-cov-6.0 gcov \"$@\"\n</code></pre>\n\n<p>Rationale: <code>lcov</code>'s <code>--gcov-tool</code> cannot handle the space between <code>llvm-cov-6.0</code> and <code>gcov</code>, hence the bash script indirection. Don't forget to make the file executable!</p>\n\n<h2>Back to your question</h2>\n\n<p>I guess you simply need to replace <code>gcov main.gcno</code> by <code>llvm-cov-6.0 gcov main.gcno</code>. This isn't using LLVM's genuine source-based coverage facility but its <a href=\"https://clang.llvm.org/docs/SourceBasedCodeCoverage.html#introduction\" rel=\"nofollow noreferrer\">gcov-compatible coverage implementation</a>.</p>\n\n<h2>Note on compiler options</h2>\n\n<p>In my setup I simply pass <code>--coverage</code> as compiler option, this should be sufficient.</p>\n"}], "owner": {"reputation": 1498, "user_id": 4219264, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100000410908000/picture?type=large", "display_name": "Serban Stoenescu", "link": "https://stackoverflow.com/users/4219264/serban-stoenescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1760, "favorite_count": 5, "answer_count": 2, "score": 3, "last_activity_date": 1607341438, "creation_date": 1558534107, "question_id": 56258782, "link": "https://stackoverflow.com/questions/56258782/when-i-compile-my-code-with-clang-gcov-throws-out-of-memory-error", "title": "When I compile my code with clang, gcov throws out of memory error", "body": "<p>I am trying to set up a basic project, and I want to use gcov. When I use g++, it works:</p>\n\n<pre><code>g++ main.cpp whatever.cpp -fprofile-arcs -ftest-coverage\n</code></pre>\n\n<p>The output of gcov is OK:</p>\n\n<pre><code>gcov main.gcno \nmain.gcda:cannot open data file, assuming not executed\nFile 'main.cpp'\nLines executed:0.00% of 20\nCreating 'main.cpp.gcov'\n\nFile '/usr/include/c++/7/iostream'\nLines executed:0.00% of 1\nCreating 'iostream.gcov'\n</code></pre>\n\n<p>However, I need to use clang. After running the compile command:</p>\n\n<pre><code>clang++-6.0 main.cpp whatever.cpp -fprofile-arcs -ftest-coverage\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>main.gcno:version '402*', prefer 'A73*'\n\ngcov: out of memory allocating 16158246392 bytes after a total of 0 bytes\n</code></pre>\n\n<p>My gcov version is 7.3.0, same as gcc and g++.</p>\n\n<p>Any idea what is wrong and what I can do about it?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "lambda"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558534139, "post_id": 56258759, "comment_id": 99134159, "body": "<code>main</code>&#39;s return type is required to be <code>int</code>."}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1558534158, "post_id": 56258759, "comment_id": 99134172, "body": "&quot;program terminates at the specified point&quot;: specified how?"}, {"owner": {"reputation": 143, "user_id": 11452004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Fotd3_dxfc/AAAAAAAAAAI/AAAAAAAAADU/F2PW0ORcVc0/photo.jpg?sz=128", "display_name": "Perotto", "link": "https://stackoverflow.com/users/11452004/perotto"}, "edited": false, "score": 0, "creation_date": 1558534205, "post_id": 56258759, "comment_id": 99134213, "body": "I added the comment with the point where program fails"}, {"owner": {"reputation": 143, "user_id": 11452004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Fotd3_dxfc/AAAAAAAAAAI/AAAAAAAAADU/F2PW0ORcVc0/photo.jpg?sz=128", "display_name": "Perotto", "link": "https://stackoverflow.com/users/11452004/perotto"}, "edited": false, "score": 0, "creation_date": 1558534251, "post_id": 56258759, "comment_id": 99134246, "body": "changing &#39;void&#39; to &#39;int&#39; does not seem to be a solution =)"}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 1, "creation_date": 1558534335, "post_id": 56258759, "comment_id": 99134296, "body": "It is undefined behaviour <code>anon</code> takes <code>f</code> by reference, but <code>f</code> is local you have dangling reference in <code>result</code>."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 11452004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Fotd3_dxfc/AAAAAAAAAAI/AAAAAAAAADU/F2PW0ORcVc0/photo.jpg?sz=128", "display_name": "Perotto", "link": "https://stackoverflow.com/users/11452004/perotto"}, "edited": false, "score": 0, "creation_date": 1558534704, "post_id": 56258850, "comment_id": 99134518, "body": "Yes, that seems to be a problem. How to code it correctly? I tried to create a copy of &#39;f&#39; like <code>std::function&lt;double(A*, A*)&gt; f1 = f;</code> but this results in the same error"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 143, "user_id": 11452004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Fotd3_dxfc/AAAAAAAAAAI/AAAAAAAAADU/F2PW0ORcVc0/photo.jpg?sz=128", "display_name": "Perotto", "link": "https://stackoverflow.com/users/11452004/perotto"}, "edited": false, "score": 0, "creation_date": 1558534847, "post_id": 56258850, "comment_id": 99134596, "body": "@Perotto - as suggested at the end of the answer, try passing <code>f</code>, to the lambda, by copy: <code>std::function&lt;double(A*)&gt; result = [&amp;, f](A * param_)</code>"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 2, "last_activity_date": 1558535052, "last_edit_date": 1558535052, "creation_date": 1558534332, "answer_id": 56258850, "question_id": 56258759, "link": "https://stackoverflow.com/questions/56258759/error-during-program-execution-in-function-that-returns-another-function/56258850#56258850", "title": "Error during program execution in function that returns another function", "body": "<p>Not sure that is the only problem but is a problem.</p>\n\n<p>In the following function</p>\n\n<pre><code>std::function&lt;double(A*)&gt; anon(std::function&lt;double(A*, A*)&gt; f, A&amp; x, A&amp; y)\n{\n    std::function&lt;double(A*)&gt; result = [&amp;](A * param_)\n    {\n        // Program fails somewhere at that point\n\n        double sum = 0.0;\n\n        for (unsigned i = 0; i &lt; x.s; i++)\n            sum += f(param_, &amp;x) - y.d[i];\n\n        return sum;\n    };\n\n    return result;\n}\n</code></pre>\n\n<p>the returned lambda receive <code>f</code> by reference bit <code>anon()</code> receive <code>f</code> by copy.</p>\n\n<p>So when you call the returned lambda <strong>outside</strong> <code>anon()</code>, it contains a dangling reference to <code>f</code>.</p>\n\n<p>Suggestion: try passing <code>f</code>, to the lambda, by copy.</p>\n\n<pre><code>// ....................................V  f by copy\nstd::function&lt;double(A*)&gt; result = [&amp;, f](A * param_)\n { /* lambda content */ }\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 11452004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Fotd3_dxfc/AAAAAAAAAAI/AAAAAAAAADU/F2PW0ORcVc0/photo.jpg?sz=128", "display_name": "Perotto", "link": "https://stackoverflow.com/users/11452004/perotto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56258850, "answer_count": 1, "score": 1, "last_activity_date": 1558535052, "creation_date": 1558534024, "last_edit_date": 1558534163, "question_id": 56258759, "link": "https://stackoverflow.com/questions/56258759/error-during-program-execution-in-function-that-returns-another-function", "title": "Error during program execution in function that returns another function", "body": "<p>I try to call the 'testfun' function inside 'test' function using 'std::function', reducing variables number by 1 and performing intermediate calculations.</p>\n\n<p>The 'A' class (vector) contains a 1D array of double.</p>\n\n<p>During execution the program terminates at the specified point and 'functional' file is opened on 'const auto _Impl = _Getimpl();' line. How to solve the problem?</p>\n\n<pre><code>#include &lt;functional&gt;\n\nclass A\n{\npublic:\n    double* d;\n    unsigned s;\n\n    A(unsigned size)\n    {\n        s = size;\n        d = new double[s];\n    }\n};\n\ndouble testfun(A* param, A* x)\n{\n    return param-&gt;d[0] + param-&gt;d[1] * x-&gt;d[0];\n}\n\nstd::function&lt;double(A*)&gt; anon(std::function&lt;double(A*, A*)&gt; f, A&amp; x, A&amp; y)\n{\n    std::function&lt;double(A*)&gt; result = [&amp;](A * param_)\n    {\n        // Program fails somewhere at that point\n\n        double sum = 0.0;\n\n        for (unsigned i = 0; i &lt; x.s; i++)\n            sum += f(param_, &amp;x) - y.d[i];\n\n        return sum;\n    };\n\n    return result;\n}\n\ndouble test(std::function&lt;double(A*, A*)&gt; f)\n{\n    A x(1); A y(1);\n    x.d[0] = 0.0;\n    y.d[0] = 2.0;\n\n    A* param = new A(2);\n    param-&gt;d[0] = 2.0; param-&gt;d[1] = 6.0;\n\n    std::function&lt;double(A*)&gt; func = anon(f, x, y);\n\n    return func(param);\n}\n\nvoid main()\n{\n    double t = test(testfun);\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "cmake", "clion"], "comments": [{"owner": {"reputation": 1995, "user_id": 4850111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c63534a6d43180d0d0636e5c3a26b8?s=128&d=identicon&r=PG&f=1", "display_name": "nada", "link": "https://stackoverflow.com/users/4850111/nada"}, "edited": false, "score": 0, "creation_date": 1558533982, "post_id": 56258674, "comment_id": 99134056, "body": "Is ultralib actually found by find_library? You could either make it REQUIRED or print out ${ULTRA_LIB} via message(${ULTRA_LIB}) or so. You probably should also not put hard coded absolute paths in a CMakeLists i think."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1558534259, "post_id": 56258674, "comment_id": 99134253, "body": "I&#39;d recommend filing a feature request to ultralight to support cmake <code>find_package(UltraLight)</code> and exported target to ease useage."}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1558535095, "post_id": 56258674, "comment_id": 99134759, "body": "Try printing the contents of <code>${ULTRA_LIB}</code> in your CMake file after calling <code>find_package</code>. This will show whether or not the variable was populated. Try this: <code>message(STATUS ${ULTRA_LIB})</code>"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 1, "creation_date": 1558544966, "post_id": 56258674, "comment_id": 99140195, "body": "@squareskittles: <code>find_library</code> always populates the variable, either with the existed path to the library file, or with a <code>-NOTFOUND</code> value, which is never ignored by CMake (unlike to empty value). CMake may even warn when it finds <code>NOTFOUND</code> value used in the <code>target_link_libraries</code> call. Even without warning, the linker will emit an error about such values (because it cannot find the library with given name)."}], "answers": [{"comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 65, "user_id": 9318103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aba1568d5f94c959afb96a74622c9752?s=128&d=identicon&r=PG", "display_name": "Anu Panicker", "link": "https://stackoverflow.com/users/9318103/anu-panicker"}, "edited": false, "score": 0, "creation_date": 1558539682, "post_id": 56260152, "comment_id": 99137557, "body": "Then you probably miss some needed library. Or your libraries are <b>not compatible</b> with the compiler (e.g. libraries has been created for MinGW, and you attempt to use them with Visual Studio)."}, {"owner": {"reputation": 65, "user_id": 9318103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aba1568d5f94c959afb96a74622c9752?s=128&d=identicon&r=PG", "display_name": "Anu Panicker", "link": "https://stackoverflow.com/users/9318103/anu-panicker"}, "edited": false, "score": 0, "creation_date": 1558713503, "post_id": 56260152, "comment_id": 99204461, "body": "Yep @Tsyvarev the libraries were created for msvc and i tried to link it to mingw. The name mangling of c++ compiler were root of the error"}], "tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": false, "score": 1, "last_activity_date": 1558538447, "creation_date": 1558538447, "answer_id": 56260152, "question_id": 56258674, "link": "https://stackoverflow.com/questions/56258674/cmake-unable-to-correctly-link-ultralight-ui-libraries-to-executable-in-clion-20/56260152#56260152", "title": "CMake unable to correctly link ultralight ui libraries to executable in Clion 2019.1.2", "body": "<p>You incorrectly use <code>NAMES</code> parameter for <code>find_library</code>: this parameter contains list of <strong>alternatives</strong>, and <code>find_library</code> will result only with a <em>single library</em>, which has one of those names.</p>\n\n<p>If you want several libraries to be found, you need to issue several <code>find_library</code> commands, each with its own name (and its own variable):</p>\n\n<pre><code>find_library(\n    ULTRA_LIB_CORE\n    NAMES UltralightCore\n    HINTS ${LINK_DIRS})\n\nfind_library(\n    ULTRA_LIB_APP_CORE\n    NAMES AppCore\n    HINTS ${LINK_DIRS})\n\nfind_library(\n    ULTRA_LIB\n    NAMES Ultralight\n    HINTS ${LINK_DIRS})\n\nfind_library(\n    ULTRA_LIB_WEB_CORE\n    NAMES WebCore\n    HINTS ${LINK_DIRS})\n\n...\n\ntarget_link_libraries(untitled1\n    ${ULTRA_LIB_CORE} ${ULTRA_LIB_APP_CORE} ${ULTRA_LIB} ${ULTRA_LIB_WEB_CORE}\n)\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9318103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aba1568d5f94c959afb96a74622c9752?s=128&d=identicon&r=PG", "display_name": "Anu Panicker", "link": "https://stackoverflow.com/users/9318103/anu-panicker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558538447, "creation_date": 1558533728, "question_id": 56258674, "link": "https://stackoverflow.com/questions/56258674/cmake-unable-to-correctly-link-ultralight-ui-libraries-to-executable-in-clion-20", "title": "CMake unable to correctly link ultralight ui libraries to executable in Clion 2019.1.2", "body": "<p>Hi i'm trying to build a basic app using ultralight <a href=\"https://github.com/ultralight-ux/Ultralight\" rel=\"nofollow noreferrer\">https://github.com/ultralight-ux/Ultralight</a>. However the build is failing at the linking stage. I have gone through through a lot of other answers and not getting any progress.</p>\n\n<p>The Cmake error:</p>\n\n<pre><code>C:/Users/AMWAJ-PC/Desktop/untitled1/main.cpp:10: undefined reference to `__imp__ZN10ultralight3App6CreateEv'\n\nC:/Users/AMWAJ-PC/Desktop/untitled1/main.cpp:11: undefined reference to `__imp__ZN10ultralight6Window6CreateEPNS_7MonitorEjjbj'\nC:/Users/AMWAJ-PC/Desktop/untitled1/main.cpp:14: undefined reference to `__imp__ZN10ultralight7Overlay6CreateENS_3RefINS_6WindowEEEjjii'\nC:/Users/AMWAJ-PC/Desktop/untitled1/main.cpp:15: undefined reference to `__imp__ZN10ultralight6StringC1EPKc'\nC:/Users/AMWAJ-PC/Desktop/untitled1/main.cpp:15: undefined reference to `__imp__ZN10ultralight6StringD1Ev'\nC:/Users/AMWAJ-PC/Desktop/untitled1/main.cpp:15: undefined reference to `__imp__ZN10ultralight6StringD1Ev'\n</code></pre>\n\n<p>The Cmakelist.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.14)\nproject(untitled1)\nset(CMAKE_CXX_STANDARD 17)\n\nset(INCLUDE_DIRS \"C:/C++/ultralight_ui/include/\")\nset(LINK_DIRS \"C:/C++/ultralight_ui/lib/\")\ninclude_directories(\"${INCLUDE_DIRS}\")\nfind_library(\n    ULTRA_LIB\n    NAMES UltralightCore AppCore Ultralight WebCore\n    HINTS \"${LINK_DIRS}\")\n\nadd_executable(untitled1 main.cpp)\ntarget_link_libraries(untitled1 ${ULTRA_LIB})\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;AppCore/App.h&gt;\n#include &lt;AppCore/Window.h&gt;\n#include &lt;AppCore/Overlay.h&gt;\n\nusing namespace ultralight;\n\nint main()\n{\n\nauto app = App::Create();\nauto window = Window::Create(app-&gt;main_monitor(), 300, 300, false, kWindowFlags_Titled);\nwindow-&gt;SetTitle(\"Tutorial 2 - Basic App\");\napp-&gt;set_window(window);\nauto overlay = Overlay::Create(window, window-&gt;width(), window-&gt;height(), 0, 0);\noverlay-&gt;view()-&gt;LoadHTML(\"&lt;center&gt;Hello World!&lt;/center&gt;\");\napp-&gt;Run();\n\nreturn 0;\n}\n</code></pre>\n\n<p>Any help will do great good to me :) Thank you</p>\n"}, {"tags": ["c++", "stack", "g++", "allocation"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1558533801, "post_id": 56258586, "comment_id": 99133926, "body": "C++ does not support VLA period."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1558534429, "post_id": 56258586, "comment_id": 99134345, "body": "See <code>std::vector</code>, which can increase size during runtime."}, {"owner": {"reputation": 91, "user_id": 10955990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fbe97500a97f7b00a3dcbff596738d?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Quesy", "link": "https://stackoverflow.com/users/10955990/bill-quesy"}, "edited": false, "score": 0, "creation_date": 1558535394, "post_id": 56258586, "comment_id": 99134967, "body": "Is it expensive for vector to increase size during runtime?"}], "owner": {"reputation": 91, "user_id": 10955990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fbe97500a97f7b00a3dcbff596738d?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Quesy", "link": "https://stackoverflow.com/users/10955990/bill-quesy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1558533778, "answer_count": 0, "score": 0, "last_activity_date": 1558533446, "creation_date": 1558533446, "question_id": 56258586, "link": "https://stackoverflow.com/questions/56258586/stack-allocation-using-g", "closed_reason": "Duplicate", "title": "Stack Allocation using g++", "body": "<p><a href=\"https://people.eecs.ku.edu/~jrmiller/Courses/JavaToC++/StackAllocatedArrays.html\" rel=\"nofollow noreferrer\">https://people.eecs.ku.edu/~jrmiller/Courses/JavaToC++/StackAllocatedArrays.html</a></p>\n\n<p>It says here that you can stack allocate using g++ even when the size of the array is not known at compile time... How does this work? How does the user program request memory to place data on the stack in the first place?</p>\n\n<p>I've tried this on my arch machine using g++ and I can allocate memory with it.</p>\n\n<p>This is what I ran:</p>\n\n<pre><code>void someFunc(int k, int j){\n    int h[k];\n    int l[j];\n}\n</code></pre>\n\n<p>You have two arrays being placed on the stack like this:</p>\n\n<pre><code>  FP -----\n\n  |var1|  some variables\n\n  |var2|\n\n  |[arr1]| some pre-initialized arrays - not sure how this would be implemented w/o pointers and hence use of heap\n\n  |[arr2]|\n\n  SP --------\n</code></pre>\n\n<p>How would I increase the size of the array and still reap the benefits of a stack?</p>\n"}, {"tags": ["c++", "c++11", "memory-management", "stl"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 3, "creation_date": 1558533791, "post_id": 56258549, "comment_id": 99133916, "body": "I&#39;d say a smart ptr with a string_view but thats c++17 sadly."}, {"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1558533842, "post_id": 56258549, "comment_id": 99133961, "body": "@SombreroChicken that would only take care of the string_view, not the underlying char array. string_view is non-owning."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 1, "creation_date": 1558533881, "post_id": 56258549, "comment_id": 99133987, "body": "@Steve The smart pointer would take care of it. It&#39;s why I said both."}, {"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1558533940, "post_id": 56258549, "comment_id": 99134029, "body": "@SombreroChicken, yes, it&#39;d take care of the string_view, not the underlying array."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 2, "creation_date": 1558534019, "post_id": 56258549, "comment_id": 99134078, "body": "@Steve obviously a smart ptr owning the returned <code>char*</code>. Not the string_view."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1558534040, "post_id": 56258549, "comment_id": 99134093, "body": "If we imagine this was possible, what happens if you <code>push_back</code> on the wrapping string?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558534587, "post_id": 56258549, "comment_id": 99134443, "body": "Sort of the opposite of <a href=\"https://stackoverflow.com/q/56127946/560648\">stackoverflow.com/q/56127946/560648</a> lol"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1558536219, "post_id": 56258549, "comment_id": 99135469, "body": "What about providing an allocator for <code>std::basic_string</code>? I never done that, so I&#39;m not sure how reasonable solution this could be."}], "answers": [{"comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1558539575, "post_id": 56258701, "comment_id": 99137499, "body": "You shouldn&#39;t need to use a functor! But I have been down that path... it is worth working through the syntax error for yourself."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1558605236, "post_id": 56258701, "comment_id": 99159867, "body": "Ah! My mistake! Corrected!"}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 8, "last_activity_date": 1558605607, "last_edit_date": 1558605607, "creation_date": 1558533825, "answer_id": 56258701, "question_id": 56258549, "link": "https://stackoverflow.com/questions/56258549/is-it-possible-to-use-stdbasic-string-as-a-wrapper-around-char/56258701#56258701", "title": "Is it possible to use std::basic_string as a wrapper around char*?", "body": "<p>Sadly, std::string does its own memory management and can't reuse a malloced string.</p>\n\n<p>You could copy them to a std::string and immediately delete them, but that will invoke all the behaviours you are trying to avoid.</p>\n\n<p>What you can do is immediately declare a unique_ptr with a custom deleter. When that goes out of scope, it will call the deleter, which will be <code>free()</code>. Meanwhile, you can use it in the same way you would have used the raw pointer.</p>\n\n<pre><code>std::unique_ptr&lt;char, decltype(free)*&gt; RAII(makeAPICall(), free);\n</code></pre>\n\n<p>In the future you could create an owning wrapper for std::string_view, and perhaps there is advantage in rolling your own in the short term, but unless you have a newer stdlib (c++17) that has replicated all the methods to take string_view I recon it is an exercise in futility.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1558534263, "last_edit_date": 1558534263, "creation_date": 1558533955, "answer_id": 56258736, "question_id": 56258549, "link": "https://stackoverflow.com/questions/56258549/is-it-possible-to-use-stdbasic-string-as-a-wrapper-around-char/56258736#56258736", "title": "Is it possible to use std::basic_string as a wrapper around char*?", "body": "<blockquote>\n  <p>I want to avoid calling free manually at the end of my code.</p>\n</blockquote>\n\n<p>If the library doesn't do that, then there is no way for you to avoid calling <code>free</code> (disregarding intentionally leaking the memory).</p>\n\n<p>If the library itself doesn't use the string, then if you wish to use <code>std::string</code> and <code>std::wstring</code>, you can use the constructor that accepts a <code>CharT*</code>, and immediately after creating the string, deallocate the original using <code>free</code>.</p>\n\n<p>If you wish to avoid additional allocation and copying, then <code>std::string</code> is not an option. You can use a smart pointer to deallocate when the pointer goes out of scope.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 4, "last_activity_date": 1558534172, "creation_date": 1558534172, "answer_id": 56258800, "question_id": 56258549, "link": "https://stackoverflow.com/questions/56258549/is-it-possible-to-use-stdbasic-string-as-a-wrapper-around-char/56258800#56258800", "title": "Is it possible to use std::basic_string as a wrapper around char*?", "body": "<p>You cannot use <code>std::basic_string</code>.  <code>std::basic_string</code> manages it's own memory so it would allocate new storage and copy the data into the string.  You would still have to manually release the storage from the returned pointer.</p>\n\n<p>If you can use C++17 you could use a <code>std::basic_string_view</code> as it will just hold a copy of the pointer, but you run into the same issue where you would need to call the deallocation function manually for the pointer when you are done with it.</p>\n\n<p>What you could do is use a <code>std::unique_ptr</code> or <code>std::shared_ptr</code> with a custom deleter to store the returned pointer from the function so it will automatically reallocate the memmory for you.  Then, if you can use C++17 you can get a <code>std::basic_string_view</code> to that pointer so you have all of the string functions without having to make a copy.  Otherwise would could just use the c-string function from <code>&lt;cstring&gt;</code> to work with it or write your own version of <code>std::basic_string_view</code> (or find a C++11 library that has one like <a href=\"https://github.com/martinmoene/string-view-lite\" rel=\"nofollow noreferrer\">this one</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1558537362, "creation_date": 1558537362, "answer_id": 56259825, "question_id": 56258549, "link": "https://stackoverflow.com/questions/56258549/is-it-possible-to-use-stdbasic-string-as-a-wrapper-around-char/56259825#56259825", "title": "Is it possible to use std::basic_string as a wrapper around char*?", "body": "<p>In <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> there is <code>string_view</code>.</p>\n\n<pre><code>template&lt;class T, class Deleter=std::default_delete&lt;T&gt;&gt;\nstruct string_view_buff : std::string_view&lt;T&gt; {\n  std::unique_ptr&lt;T[]&gt; buff;\n  explicit string_view_buff( T* in, Deleter d = {} ):\n    buff( in, std::move(d) ),\n    std::string_view&lt;T&gt;(in) {}\n};\n</code></pre>\n\n<p>something like that can take ownership of a buffer and expose string-like functionality at the same time without additional heap allocation.  (Code not tested)</p>\n\n<p>Prior to that, no, <code>std::string</code> allocates and manages its own memory.  You cannot give it a buffer and a deletion function.</p>\n"}], "owner": {"reputation": 466, "user_id": 2282979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66d31b3cf52c3fb50310f62aac3e96a6?s=128&d=identicon&r=PG", "display_name": "Dmitrii Motorygin", "link": "https://stackoverflow.com/users/2282979/dmitrii-motorygin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 4, "score": 7, "last_activity_date": 1558605607, "creation_date": 1558533371, "question_id": 56258549, "link": "https://stackoverflow.com/questions/56258549/is-it-possible-to-use-stdbasic-string-as-a-wrapper-around-char", "title": "Is it possible to use std::basic_string as a wrapper around char*?", "body": "<p>I have third party library that returns char* (and wchar_t*) that are created in it by strdup (and wcsdup functions respectively).</p>\n\n<p>I want to avoid calling free manually at the end of my code.</p>\n\n<p>Is it possible to write an allocator for std::basic_string so that it would handle dealing with this c-strings returned by this library? Ideally I don't want to allocate any new memory at all and use memory blocks that were returned (strings are supposed to be constant).</p>\n"}, {"tags": ["c++", "arrays", "string", "char"], "comments": [{"owner": {"reputation": 3837, "user_id": 1749713, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PqPOy.png?s=128&g=1", "display_name": "Micha\u0142 Walenciak", "link": "https://stackoverflow.com/users/1749713/micha%c5%82-walenciak"}, "edited": false, "score": 1, "creation_date": 1558532168, "post_id": 56258106, "comment_id": 99132807, "body": "<a href=\"https://stackoverflow.com/help/reprex\">stackoverflow.com/help/reprex</a>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1558532176, "post_id": 56258106, "comment_id": 99132809, "body": "Probably undefined behavior. The code you show is incomplete so we can&#39;t reproduce and identify the problem. Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1558532398, "post_id": 56258106, "comment_id": 99132962, "body": "Does the indeterminism go away if you use <code>string stringbuffer(buffer, dotpoint - lastdot)</code> instead? If so, the string pointed to by <code>lastdot</code> may not end in a NUL byte OR <code>linequery.copy</code> does not add a NUL byte."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1558533182, "post_id": 56258106, "comment_id": 99133483, "body": "Without knowing what <code>linequery</code> is, it&#39;s a bit hard to say for sure. But it appears that <code>size_t lengthh = linequery.copy(buffer, 4, 0);</code> copies four characters to <code>buffer</code>.  The constructor of <code>string</code>, called in the line <code>string stringbuffer(buffer);</code> assumes there is a terminating <code>&#39;\\0&#39;</code> in the passed buffer.    If it is not there (e.g. because four characters have been copied to <code>buffer</code> and none of them is <code>&#39;\\0&#39;</code>_) then the behaviour is undefined. The output of <code>length :6</code> suggests that there is no <code>&#39;\\0&#39;</code> terminator and that your code has copied 6 characters from a four character buffer."}, {"owner": {"reputation": 11, "user_id": 9576362, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jakinto", "link": "https://stackoverflow.com/users/9576362/jakinto"}, "edited": false, "score": 0, "creation_date": 1558534142, "post_id": 56258106, "comment_id": 99134163, "body": "Thank you ,I Understand  Now"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1558533204, "post_id": 56258265, "comment_id": 99133493, "body": "&quot;which is not guaranteed&quot; it is actually guaranteed to be Undefined Behavior"}, {"owner": {"reputation": 11, "user_id": 9576362, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jakinto", "link": "https://stackoverflow.com/users/9576362/jakinto"}, "edited": false, "score": 0, "creation_date": 1558533230, "post_id": 56258265, "comment_id": 99133513, "body": "Yes it works perfectly . But why sometimes before  despite for  the *char array was define [4]   the string was longer ?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 11, "user_id": 9576362, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jakinto", "link": "https://stackoverflow.com/users/9576362/jakinto"}, "edited": false, "score": 0, "creation_date": 1558533398, "post_id": 56258265, "comment_id": 99133634, "body": "@Jakinto <code>std::string</code> ctor does have no idea what size buffer has. In that form it assumes you pass a null terminated string to it and it leads to UB if there is no termination. If you know the length use another form of <code>std::string</code> ctor. And no it does not work in either case, welcome to UB."}, {"owner": {"reputation": 11, "user_id": 9576362, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jakinto", "link": "https://stackoverflow.com/users/9576362/jakinto"}, "edited": false, "score": 0, "creation_date": 1558534117, "post_id": 56258265, "comment_id": 99134144, "body": "Thank you ,I Understand  Now"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 1, "last_activity_date": 1558532474, "creation_date": 1558532474, "answer_id": 56258265, "question_id": 56258106, "link": "https://stackoverflow.com/questions/56258106/char-array-to-string-two-times-run-code-and-two-different-result/56258265#56258265", "title": "*char array to string (two times run code and two different result )", "body": "<p>Likely the <code>linequery.copy</code> does not write a terminating null, so you rely on the next character after <code>buffer</code> being a NULL which is not guaranteed. You should build the string with:</p>\n\n<pre><code>string stringbuffer(buffer, dotpoint-lastdot);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9576362, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jakinto", "link": "https://stackoverflow.com/users/9576362/jakinto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1558533436, "accepted_answer_id": 56258265, "answer_count": 1, "score": -1, "last_activity_date": 1558541526, "creation_date": 1558532001, "last_edit_date": 1558541526, "question_id": 56258106, "link": "https://stackoverflow.com/questions/56258106/char-array-to-string-two-times-run-code-and-two-different-result", "closed_reason": "Not suitable for this site", "title": "*char array to string (two times run code and two different result )", "body": "<p>Why the same code has two different results, not always is alternate but sometimes string made from *array has length : 4 and different time will be length : 6 . This last 2 characters are random. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>string linequery;\n\ngetline(cin, linequery);\n\nchar  * buffer =  new char [4];\n\nsize_t lengthh = linequery.copy(buffer, 4, 0);\nstring stringbuffer(buffer);\n\ncout &lt;&lt; \" length :\" &lt;&lt; stringbuffer.length() &lt;&lt; endl;\ncout &lt;&lt; \" string buffer : \" &lt;&lt; stringbuffer &lt;&lt; endl;\n\nreferencetree.push_back(stringbuffer);\n\ndelete []  buffer;\n</code></pre>\n\n<p>OUTPUT with length 6 :</p>\n\n<p>length :6</p>\n\n<p>string buffer : tag1</p>\n\n<p>line query : tag1.tag2~name    :length :14</p>\n\n<hr>\n\n<p>OUTPUT with properly length 4 :</p>\n\n<p>length :4</p>\n\n<p>string buffer : tag1</p>\n\n<p>line query :tag1.tag2~name  : length :14</p>\n\n<hr>\n\n<p>INPUT is the same : tag1.tag2~name</p>\n"}, {"tags": ["c++", "visual-studio", "qt"], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 7653905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26a1d24f5b2cd4c25e20e104189b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Yalimov", "link": "https://stackoverflow.com/users/7653905/timur-yalimov"}, "is_accepted": true, "score": 0, "last_activity_date": 1559724660, "creation_date": 1559724660, "answer_id": 56457160, "question_id": 56258104, "link": "https://stackoverflow.com/questions/56258104/qt-vsaddin-error-object-reference-not-set-to-an-instanse-of-an-object/56457160#56457160", "title": "QT VsAddIn error Object reference not set to an instanse of an object", "body": "<p>So, it was a bug in QT VSAddin. Moved to QTCreator.</p>\n"}], "owner": {"reputation": 135, "user_id": 7653905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26a1d24f5b2cd4c25e20e104189b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Yalimov", "link": "https://stackoverflow.com/users/7653905/timur-yalimov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56457160, "answer_count": 1, "score": 0, "last_activity_date": 1559724660, "creation_date": 1558531993, "question_id": 56258104, "link": "https://stackoverflow.com/questions/56258104/qt-vsaddin-error-object-reference-not-set-to-an-instanse-of-an-object", "title": "QT VsAddIn error Object reference not set to an instanse of an object", "body": "<p>My Qt version - 5.12.3\nVS version - 2017</p>\n\n<p>Builded Qt from sources as follows:</p>\n\n<pre><code>SET _ROOT = D:\\Qt\\src\nSET PATH = %_ROOT%\\qtbase\\bin;%_ROOT%\\gnuwin32\\bin;%PATH%\nconfigure -static -static-runtime -release -platform win32-msvc - opensource -confirm-license -nomake examples -nomake tests -prefix \nD:\\Qt\\build\njom\njom install\n</code></pre>\n\n<p>Building was successfull. No errors occured.</p>\n\n<p>Installed QtVsAddIn, added previously built qt to extention.</p>\n\n<p>When creationg any qt project i see this error:\nObject reference not set to an instance of an object</p>\n\n<p>Tried install AddIns for 19 and 15 version of VS, doesn't worked for me.</p>\n"}, {"tags": ["c++", "templates", "c++14", "variadic-templates"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1558531884, "post_id": 56257923, "comment_id": 99132624, "body": "&quot;The problem is that some of template parameters can be enums&quot; - it is not clear how this is a problem. Are you basically asking how to use type template parameter and a non-type template parameter on the same spot?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 1, "creation_date": 1558531963, "post_id": 56257923, "comment_id": 99132678, "body": "&quot;I am interested if this problem has a workaround.&quot; - it seems to me that you&#39;re using a good enough workaround; maybe you can think the translate it in <code>Action</code> specializations."}, {"owner": {"reputation": 111, "user_id": 10933370, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZYsn6JU77Rw/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYSI-zJZ1SreMfXEsGjI4osxKAXUw/mo/photo.jpg?sz=128", "display_name": "Bioliquid", "link": "https://stackoverflow.com/users/10933370/bioliquid"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1558532398, "post_id": 56257923, "comment_id": 99132961, "body": "@VTT, some sort of. I guess there&#39;s no way to put non-type template parameter to <code>typename...</code>, so I tried to think about different solution, but didn&#39;t come up with anything."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1558532711, "post_id": 56257923, "comment_id": 99133177, "body": "<a href=\"https://en.cppreference.com/w/cpp/types/integral_constant\" rel=\"nofollow noreferrer\">std::integral_constant</a> might replace <code>enum_</code>."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1558532812, "post_id": 56257923, "comment_id": 99133233, "body": "Parameter packs can contain both type and non-type template parameters, so it&#39;s still not clear why one of the params being an enum is a problem. Do you mean you want to wrap any non-type enum param in the <code>enum_</code> wrapper? Or you want to specialize <code>Action</code> for these types? Or something else?"}, {"owner": {"reputation": 111, "user_id": 10933370, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZYsn6JU77Rw/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYSI-zJZ1SreMfXEsGjI4osxKAXUw/mo/photo.jpg?sz=128", "display_name": "Bioliquid", "link": "https://stackoverflow.com/users/10933370/bioliquid"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1558533132, "post_id": 56257923, "comment_id": 99133453, "body": "@Useless, if I have <code>template&lt;typename...&gt; struct Action {};</code> and <code>enum class Types {};</code> I can&#39;t write something like <code>Action&lt;Types::type, int&gt; a; Action&lt;int&gt; b;</code>"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1558533249, "post_id": 56257923, "comment_id": 99133535, "body": "@Useless I&#39;d say that they can contain either only type or only non-type parameters, but not both at the same time."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1558534980, "post_id": 56257923, "comment_id": 99134685, "body": "Could you give the two flavors of <code>ActionType</code> different names? Something like <code>TypedAction</code> vs <code>UntypedAction</code>?"}, {"owner": {"reputation": 1153, "user_id": 11434141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1pKD.png?s=128&g=1", "display_name": "AKL", "link": "https://stackoverflow.com/users/11434141/akl"}, "edited": false, "score": 0, "creation_date": 1558557154, "post_id": 56257923, "comment_id": 99145529, "body": "I am having hard time understanding this. I also agree with max66. Please explain more. Is how to have a mixed type, non-type(and non-template) parameter pack for a template your question? if not I also agree with Useless."}], "owner": {"reputation": 111, "user_id": 10933370, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZYsn6JU77Rw/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYSI-zJZ1SreMfXEsGjI4osxKAXUw/mo/photo.jpg?sz=128", "display_name": "Bioliquid", "link": "https://stackoverflow.com/users/10933370/bioliquid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558531437, "creation_date": 1558531437, "question_id": 56257923, "link": "https://stackoverflow.com/questions/56257923/is-there-a-way-to-define-type-with-template-that-takes-optional-specific-enum-an", "title": "Is there a way to define type with template that takes optional specific enum and infinite types?", "body": "<p>I have enum with some values and struct that converts it to a type.</p>\n\n<pre><code>enum class Types : uint8_t {\n    ...\n}; \n\ntemplate&lt;Types type&gt;\nstruct enum_ {\n    ...\n}\n</code></pre>\n\n<p>I also have main template class Action, which is a lambda-like struct with overloaded operator(), depending on passed types</p>\n\n<pre><code>template&lt;typename...&gt;\nstruct Action;\n\ntemplate&lt;typename T&gt;\nstruct Action&lt;T&gt; { ... };\n\ntemplate&lt;typename T, typename R&gt;\nstruct Action&lt;T, R&gt; { ... };\n</code></pre>\n\n<p>The problem is that some of template parameters can be enums (e.g <code>T = enum_&lt;Types::type&gt;</code>)</p>\n\n<p>Is it possible to do something like that:</p>\n\n<pre><code>template&lt;typename... Args&gt;\nusing ActionType = Action&lt;Args...&gt;;\n\ntemplate&lt;Types type, typename... Args&gt;\nusing ActionType = Action&lt;enum_&lt;type&gt;, Args...&gt;;\n</code></pre>\n\n<p>so in this case <code>T</code> is an optional enum type. I now I can use like this <code>ActionType&lt;enum_&lt;Types::type&gt;, ...&gt;</code>, but I am interested if this problem has a workaround.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 39, "user_id": 9083264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ea46018d33d7592aba83c564ba328b?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/9083264/tuts"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558534834, "post_id": 56257674, "comment_id": 99134584, "body": "Gave my best try at it, have a look. I thought I removed enough code the last time for it to be understandable."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558534969, "post_id": 56257674, "comment_id": 99134678, "body": "I do not understand, have you read that it is an MCVE ?, your code is not. When they ask you for an MCVE the main thing is complete and verifiable, the minimum is secondary since it is the easiest to obtain."}, {"owner": {"reputation": 39, "user_id": 9083264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ea46018d33d7592aba83c564ba328b?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/9083264/tuts"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558535639, "post_id": 56257674, "comment_id": 99135095, "body": "How about you just ask me what is confusing? I thought this was complete enough, as the mentioned code is what needs to be changed.. I added all else that I have in the code related to the undo/redo actions at the moment."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558535896, "post_id": 56257674, "comment_id": 99135259, "body": "No, if you want to use undo-redo the first thing is to identify what the commands are. In your code I can not identify what a command is since it is not understood what kind of actions exist. Are the commands differentiated by the shape? If your question was clear, I would not ask for an MCVE. Please read the link so that you understand that I am asking you. If you do, you tell me, it&#39;s annoying that I have to invest comments to convince him of something I&#39;ve clearly asked from the beginning."}, {"owner": {"reputation": 39, "user_id": 9083264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ea46018d33d7592aba83c564ba328b?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/9083264/tuts"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1558536006, "post_id": 56257674, "comment_id": 99135336, "body": "her* and it was not clearly asked. I would have added them if I had any. Since I don&#39;t know how to use the QUndoCommand classes in this case (it is unlike the examples on the Internet), I have nothing to add. My apologies. I am a beginner with Qt and C++."}], "owner": {"reputation": 39, "user_id": 9083264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ea46018d33d7592aba83c564ba328b?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/9083264/tuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558535888, "creation_date": 1558530753, "last_edit_date": 1558535888, "question_id": 56257674, "link": "https://stackoverflow.com/questions/56257674/using-qt-undo-framework-with-qpainter", "title": "Using Qt Undo Framework With QPainter", "body": "<p>I am creating a drawing application with Qt and want to include undo and redo commands for whatever is drawn on a QImage. For this, I want to at least try and incorporate the Qt undo framework, since manually doing it will probably be above my skill level. \nI have a MainWindow class where the main work is done and where I have the menu with undo and redo QActions. \nThe painting is done in a QWidget class called DrawingArea like this (PenShape is an enum of shapes):</p>\n\n<pre><code>void DrawingArea::drawLine(const QPoint &amp;endPoint) {\nQPainter painter(&amp;image);\n\n//some pen config code\n\nswitch (currentShape){\ncase PenShape::Polygon:\n    painter.drawPolygon(&amp;endPoint, 5, Qt::OddEvenFill);\n    break;\ncase PenShape::Line:\n    painter.drawLine(lastPoint, endPoint);\n    break;\n//other shapes and their draw methods..\n}\nupdate()\n}\n</code></pre>\n\n<p>So as can be seen, the painter can draw in multiple shapes. I know I would have to somehow transfer this to a QUndoCommand class, but how? The drawline method is called only in DrawingArea's mouse event methods like this:</p>\n\n<pre><code>void DrawingArea::mousePressEvent(QMouseEvent *event){\nif (event-&gt;button() == Qt::LeftButton) {\n        lastPoint = event-&gt;pos();\n    }\n}\n</code></pre>\n\n<p>The QtUndoStack is located in MainWindow and the QActions are also there, but somehow I would have to connect the drawLine QtUndoCommand class and the mousePressEvent and mainWindow QAction with its connected slot method all together. This is what I don't know how to do.</p>\n\n<p>Any help is appreciated!</p>\n\n<p>Edit, here's the menu button actions:</p>\n\n<pre><code>m_undo = undoStack-&gt;createUndoAction(this, tr(\"&amp;Undo\"));\nm_undo-&gt;setShortcuts(QKeySequence::Undo);\n\nm_redo = undoStack-&gt;createRedoAction(this, tr(\"&amp;Redo\"));\nm_redo-&gt;setShortcuts(QKeySequence::Redo);\n</code></pre>\n\n<p>I have no QUndoCommand classes because I'm unsure of how to create them yet. \nIn my MainWindow, I have a undoStack declared like this:</p>\n\n<pre><code>undoStack = new QUndoStack(this); \n</code></pre>\n"}, {"tags": ["c++", "dll", "poco", "poco-libraries"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1558530872, "post_id": 56257633, "comment_id": 99131858, "body": "You are likely missing a link to an import library."}, {"owner": {"reputation": 11, "user_id": 8468361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aYOB0UGDR7g/AAAAAAAAAAI/AAAAAAAAAA8/jV5vlCdRJRA/photo.jpg?sz=128", "display_name": "Debashish Roy", "link": "https://stackoverflow.com/users/8468361/debashish-roy"}, "edited": false, "score": 0, "creation_date": 1558531044, "post_id": 56257633, "comment_id": 99131983, "body": "But I have added every .lib files related to poco in linke-&gt;input-&gt;additional dependency and also added the path to additional libraries directories."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 1, "creation_date": 1558531451, "post_id": 56257633, "comment_id": 99132305, "body": "linked for all configurations? (x86, x64, debug, release)"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1558531557, "post_id": 56257633, "comment_id": 99132374, "body": "There probably are different libraries per configuration."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1558531590, "post_id": 56257633, "comment_id": 99132396, "body": "I believe <code>poco</code> wants you to use <code>CMake</code>"}, {"owner": {"reputation": 11, "user_id": 8468361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aYOB0UGDR7g/AAAAAAAAAAI/AAAAAAAAAA8/jV5vlCdRJRA/photo.jpg?sz=128", "display_name": "Debashish Roy", "link": "https://stackoverflow.com/users/8468361/debashish-roy"}, "reply_to_user": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1558531654, "post_id": 56257633, "comment_id": 99132453, "body": "@StackDanny used x64 release only"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1558531687, "post_id": 56257633, "comment_id": 99132481, "body": "<b><i>used x64 release only</i></b> That will not be good for a debug mode application."}, {"owner": {"reputation": 11, "user_id": 8468361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aYOB0UGDR7g/AAAAAAAAAAI/AAAAAAAAAA8/jV5vlCdRJRA/photo.jpg?sz=128", "display_name": "Debashish Roy", "link": "https://stackoverflow.com/users/8468361/debashish-roy"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1558531805, "post_id": 56257633, "comment_id": 99132564, "body": "@drescherjm documentation nowhere mentioned using cmake also for building dll it&#39;s a bit doable."}], "owner": {"reputation": 11, "user_id": 8468361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aYOB0UGDR7g/AAAAAAAAAAI/AAAAAAAAAA8/jV5vlCdRJRA/photo.jpg?sz=128", "display_name": "Debashish Roy", "link": "https://stackoverflow.com/users/8468361/debashish-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1558533265, "answer_count": 0, "score": 0, "last_activity_date": 1559127163, "creation_date": 1558530664, "last_edit_date": 1559127163, "question_id": 56257633, "link": "https://stackoverflow.com/questions/56257633/error-lnk2001-unresolved-external-symbol-declspecdllimport-while-building-d", "closed_reason": "Duplicate", "title": "Error LNK2001: unresolved external symbol __declspec(dllimport) While Building DLL File For Plugin", "body": "<p>I am trying to build a class loader with the help of poco c++ library. I am following this resource <a href=\"https://pocoproject.org/slides/120-SharedLibraries.pdf\" rel=\"nofollow noreferrer\">https://pocoproject.org/slides/120-SharedLibraries.pdf</a>.\nI trying to add plugin support to an Open source project which uses poco 1.5.3.\nEven while building dll files for the plugin loader it gives a linking error but all the error get resolved when I turned off the whole program optimization option. Till here poco 1.5.3 works but while building class loader it is giving unresolved external symbol linking error. But when I changed the path of the linking library to poco 1.9 in the Linker->input section it gets worked without error. But due to the dependency problem, I want to stick to poco 1.5.3.</p>\n\n<p>I have followed some answers in StackOverflow which tells to add <code>.lib</code> in <code>Linker-&gt;input</code> in the project or add additional dependency directory but it didn't work. And also the famous answer <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a> but it seems a bit different issue to me. \nI am following the main.cpp for classloader program at the end of the <code>pdf</code>.</p>\n\n<p>Error messages are as follows:</p>\n\n<blockquote>\n  <p>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: static void __cdecl Poco::Bugcheck::nullPointer(char const *,char const *,int)\" (__imp_?nullPointer@Bugcheck@Poco@@SAXPEBD0H@Z)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: __cdecl Poco::FastMutex::FastMutex(void)\" (__imp_??0FastMutex@Poco@@QEAA@XZ)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: __cdecl Poco::FastMutex::~FastMutex(void)\" (__imp_??1FastMutex@Poco@@QEAA@XZ)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: void __cdecl Poco::FastMutex::lock(void)\" (__imp_?lock@FastMutex@Poco@@QEAAXXZ)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: void __cdecl Poco::FastMutex::unlock(void)\" (__imp_?unlock@FastMutex@Poco@@QEAAXXZ)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: __cdecl Poco::ManifestBase::ManifestBase(void)\" (__imp_??0ManifestBase@Poco@@QEAA@XZ)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: virtual __cdecl Poco::ManifestBase::~ManifestBase(void)\" (__imp_??1ManifestBase@Poco@@UEAA@XZ)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: __cdecl Poco::SharedLibrary::SharedLibrary(class std::basic_string,class std::allocator > const &amp;)\" (__imp_??0SharedLibrary@Poco@@QEAA@AEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: virtual __cdecl Poco::SharedLibrary::~SharedLibrary(void)\" (__imp_??1SharedLibrary@Poco@@UEAA@XZ)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: void __cdecl Poco::SharedLibrary::unload(void)\" (__imp_?unload@SharedLibrary@Poco@@QEAAXXZ)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: bool __cdecl Poco::SharedLibrary::hasSymbol(class std::basic_string,class std::allocator > const &amp;)\" (__imp_?hasSymbol@SharedLibrary@Poco@@QEAA_NAEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: void * __cdecl Poco::SharedLibrary::getSymbol(class std::basic_string,class std::allocator > const &amp;)\" (__imp_?getSymbol@SharedLibrary@Poco@@QEAAPEAXAEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)\n  1>Pluginloader.obj : error LNK2001: unresolved external symbol \"__declspec(dllimport) public: static class std::basic_string,class std::allocator > __cdecl Poco::SharedLibrary::suffix(void)\" (__imp_?suffix@SharedLibrary@Poco@@SA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)\n  1>C:\\Users\\Debashish\\documents\\visual studio 2015\\Projects\\Pluginloader\\x64\\Release\\Pluginloader.exe : fatal error LNK1120: 13 unresolved externals</p>\n</blockquote>\n\n<p>Please help to build me the <code>dll</code> for the plugin.</p>\n"}, {"tags": ["c++", "readfile", "wininet"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1558530669, "post_id": 56257539, "comment_id": 99131721, "body": "Don&#39;t forget that <code>char</code> strings in C++ are really called <b><i>null-terminated</b> byte strings</i>. The <i>null-terminator</i> needs space as well (and if the <code>InternetReadFile</code> function doesn&#39;t add it for you, then you need to do it explicitly yourself). A better solution is of course to use a standard string class for your strings, like e.g. <code>std::string</code>."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1558530674, "post_id": 56257539, "comment_id": 99131726, "body": "Unrelated to your issue, but the cast in <code>LPCTSTR url = (LPCTSTR) &quot;https:&#47;&#47;example.com&quot;;</code> is <i>always</i> wrong. Please just remove it: <code>LPCTSTR url =  &quot;https:&#47;&#47;example.com&quot;;</code> Infact, as you&#39;re explicitely using the &#39;A&#39; version of the API just make it <code>LPCSTR url = https:&#47;&#47;example.com&quot;;</code> or even <code>const char* url = &quot;https:&#47;&#47;example.com&quot;;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4256388"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1558531847, "post_id": 56257539, "comment_id": 99132599, "body": "@MikeVine Yes, you&#39;re right, I&#39;ll change it, thanks for the warning."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4256388"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1558531851, "post_id": 56257539, "comment_id": 99132604, "body": "@Someprogrammerdude Thanks, that was the solution."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4256388"}, "edited": false, "score": 1, "creation_date": 1558531671, "post_id": 56257916, "comment_id": 99132472, "body": "Yep, I understand now, thanks a lot for the explanation! =)"}], "tags": [], "owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "is_accepted": true, "score": 1, "last_activity_date": 1558531413, "creation_date": 1558531413, "answer_id": 56257916, "question_id": 56257539, "link": "https://stackoverflow.com/questions/56257539/downloading-content-from-web-url/56257916#56257916", "title": "Downloading content from web URL", "body": "<p>The data you're receiving is a C-style string, i.e. a null-character terminated array of characters. The important part here is that a string of 5 characters actually requires an array of size 6, for example:</p>\n\n<pre><code>\"hello\"\n</code></pre>\n\n<p>is made up of an array of 6 characters, <code>'h'</code>, <code>'e'</code>, <code>'l'</code>, <code>'l'</code>, <code>'o'</code>, <code>'\\0'</code>.</p>\n\n<p><code>OutputDebugString</code> will go through the array printing the characters until it reaches a <code>'\\0'</code>.</p>\n\n<p>In this case you're not allocating anywhere for the terminating <code>'\\0'</code> to go, so <code>OutputDebugString</code> will keep going until there happens to be a <code>'\\0'</code> in memory (or until it reaches memory it's not allowed to access).</p>\n\n<p>Change this bit:</p>\n\n<pre><code>char * buffer = new char[size]; // size = 5\nInternetReadFile(request, buffer, size, &amp;dwRead);\n</code></pre>\n\n<p>to be </p>\n\n<pre><code>char * buffer = new char[size + 1]; // size = 5, allocate 6 chars\nInternetReadFile(request, buffer, size, &amp;dwRead);\nbuffer [size] = '\\0';\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4256388"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 56257916, "answer_count": 1, "score": 2, "last_activity_date": 1558533443, "creation_date": 1558530428, "last_edit_date": 1558533443, "question_id": 56257539, "link": "https://stackoverflow.com/questions/56257539/downloading-content-from-web-url", "title": "Downloading content from web URL", "body": "<p>I'm trying to get data from the URL address using <code>WinInet.h</code>. Here is my simplified code:</p>\n\n<pre><code>LPCTSTR url = (LPCTSTR) \"https://example.com\"; // 2.9.1\nHINTERNET connection = InternetOpenA(NULL, INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0);\nHINTERNET request = InternetOpenUrlA(connection, url, NULL, 0, INTERNET_FLAG_RELOAD, 0);\n\nchar status_code[10];\nDWORD info_size = 10000;\nHttpQueryInfoA(request, HTTP_QUERY_STATUS_CODE, status_code, &amp;info_size, NULL);\n\nDWORD size;\nDWORD dwRead = 0;\nInternetQueryDataAvailable(request, &amp;size, 0, 0); // size = 5\n\nchar * buffer = new char[size]; // size = 5\nInternetReadFile(request, buffer, size, &amp;dwRead);\nOutputDebugString(buffer); // 1.2.3\u00fd\u00fd\u00fd\u00fd\n\nInternetCloseHandle(connection);\nInternetCloseHandle(request);\n</code></pre>\n\n<p>It works well, but the data on the URL address is <code>2.9.1</code> but the buffer returns <code>2.9.1\u00fd\u00fd\u00fd\u00fd</code>.</p>\n\n<p>If I try to print char after char, this is the result:</p>\n\n<pre><code>for (int i = 0; i &lt; size; i++)\n    OutputDebugString(&amp;buffer[i]);\n\nchar[0] = 2.9.1\u00fd\u00fd\u00fd\u00fd\nchar[1] = .9.1\u00fd\u00fd\u00fd\u00fd\nchar[2] = 9.1\u00fd\u00fd\u00fd\u00fd\nchar[3] = .1\u00fd\u00fd\u00fd\u00fd\nchar[4] = 1\u00fd\u00fd\u00fd\u00fd\n</code></pre>\n\n<p>Can anyone explain to me why this is happening?</p>\n"}, {"tags": ["c++", "vector", "set"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1558530494, "post_id": 56257529, "comment_id": 99131620, "body": "voting to close as a typo.  Remove the variable name from the return line, you don&#39;t need a named variable there.  <code>return vector&lt;string&gt;res(container.begin(), container.end());</code> should be <code>return vector&lt;string&gt;(container.begin(), container.end());</code>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1558530601, "post_id": 56257529, "comment_id": 99131686, "body": "<code>vector&lt;string&gt;res</code> is a variable declaration. You could do <code>vector&lt;string&gt;res(...); return res;</code> or do <code>return vector&lt;string&gt;(...);</code>."}, {"owner": {"reputation": 200, "user_id": 9154125, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-C6_tf12h5uE/AAAAAAAAAAI/AAAAAAAAACM/DhGZdVfGbh0/photo.jpg?sz=128", "display_name": "Abhishek Patel", "link": "https://stackoverflow.com/users/9154125/abhishek-patel"}, "edited": false, "score": 0, "creation_date": 1558530667, "post_id": 56257529, "comment_id": 99131718, "body": "yeah thanks, it worked."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 4, "creation_date": 1558530671, "post_id": 56257529, "comment_id": 99131722, "body": "You might even do <code>return {container.begin(), container.end()};</code>"}, {"owner": {"reputation": 200, "user_id": 9154125, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-C6_tf12h5uE/AAAAAAAAAAI/AAAAAAAAACM/DhGZdVfGbh0/photo.jpg?sz=128", "display_name": "Abhishek Patel", "link": "https://stackoverflow.com/users/9154125/abhishek-patel"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1558530944, "post_id": 56257529, "comment_id": 99131906, "body": "@GemTaylor oh thanks man I just tried it and it worked just fine, So it automatically converts set into Vector? and it worked much faster before it took 56ms for code to execute now 44ms."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 3, "creation_date": 1558531191, "post_id": 56257529, "comment_id": 99132088, "body": "C++11 tries hard to make it so you don&#39;t need to keep writing complex type statements. This is basically just list initialisation, and the compiler already knows the return type. <a href=\"https://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/list_initialization</a>"}, {"owner": {"reputation": 200, "user_id": 9154125, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-C6_tf12h5uE/AAAAAAAAAAI/AAAAAAAAACM/DhGZdVfGbh0/photo.jpg?sz=128", "display_name": "Abhishek Patel", "link": "https://stackoverflow.com/users/9154125/abhishek-patel"}, "edited": false, "score": 0, "creation_date": 1558531420, "post_id": 56257529, "comment_id": 99132278, "body": "okay thanks, helped."}], "owner": {"reputation": 200, "user_id": 9154125, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-C6_tf12h5uE/AAAAAAAAAAI/AAAAAAAAACM/DhGZdVfGbh0/photo.jpg?sz=128", "display_name": "Abhishek Patel", "link": "https://stackoverflow.com/users/9154125/abhishek-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558530404, "creation_date": 1558530404, "question_id": 56257529, "link": "https://stackoverflow.com/questions/56257529/getting-error-while-trying-to-copy-stl-set-into-vector", "title": "Getting error while trying to copy STL Set into Vector", "body": "<p>I am trying to initialize vector by already preset Set but getting error</p>\n\n<pre><code>vector&lt;string&gt; findRepeatedDnaSequences(string s) {\n    int size = s.length();\n    set&lt;string&gt;container;\n    unordered_map&lt;string,int&gt;hmap;\n    for(int i=0;i&lt;size;i++){\n        string first=s.substr(i,10);\n        if(hmap.find(first)!=hmap.end()){\n            // if((i-hmap[first])&gt;=10)\n                container.insert(first);\n        }else hmap[first] = i;\n    }\n\n    // ERROR IN THIS LINE \n    return vector&lt;string&gt;res(container.begin(), container.end());\n}\n</code></pre>\n\n<pre><code>anagrams.cpp:21:26: error: expected '(' for function-style cast or type construction return vector&lt;string&gt;res((container.begin(), container.end()));\n</code></pre>\n"}, {"tags": ["c++", "formatting", "googletest", "clion", "gmock"], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 1574642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2825e3945fc7cab47b6def4a560b1032?s=128&d=identicon&r=PG", "display_name": "uta", "link": "https://stackoverflow.com/users/1574642/uta"}, "is_accepted": false, "score": 1, "last_activity_date": 1580380392, "creation_date": 1580380392, "answer_id": 59983978, "question_id": 56257486, "link": "https://stackoverflow.com/questions/56257486/clion-formatter-breaks-mock-method-lines/59983978#59983978", "title": "CLion formatter breaks MOCK_METHOD lines", "body": "<p>That is a bug: <a href=\"https://youtrack.jetbrains.com/issue/CPP-18644\" rel=\"nofollow noreferrer\">CPP-18644</a> \nIt will be fixed in the next EAP/fix-release.\nSorry.</p>\n"}], "owner": {"reputation": 2625, "user_id": 365408, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5bda2dfa5ddef88c4f9b1b71616e44b8?s=128&d=identicon&r=PG", "display_name": "Ziv", "link": "https://stackoverflow.com/users/365408/ziv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1580380392, "creation_date": 1558530258, "question_id": 56257486, "link": "https://stackoverflow.com/questions/56257486/clion-formatter-breaks-mock-method-lines", "title": "CLion formatter breaks MOCK_METHOD lines", "body": "<p>I am using gmock in CLion, whenever I format my file, all the MOCK_METHOD macros are broken up with unnecessary line breaks. like this:</p>\n\n<p>Before:</p>\n\n<pre><code>    class MockObservableExecutor : public IObservableExecutor {\n        MOCK_METHOD1(registerExecutor, void(IObserverExecutor*));\n        MOCK_METHOD2(sendMessage, void(const std::string&amp;, const std::string&amp;));\n    };\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>    class MockObservableExecutor : public IObservableExecutor {\n        MOCK_METHOD1(registerExecutor, void(IObserverExecutor\n                *));\n\n        MOCK_METHOD2(sendMessage, void(\n                const std::string&amp;, const std::string&amp;));\n    };\n</code></pre>\n\n<p>I see no reason that the single asterisk should get a line of its own, how can I tell CLion to stop its shenanigans? Why does it decide that it should break the line there?</p>\n\n<p>For now I have added <code>//@formatter:off</code> and <code>//@formatter:on</code> statemenst around my mock but I do want formatting to work for some of the stuff in my mock.</p>\n"}, {"tags": ["c++", "arrays", "pointers", "sizeof"], "comments": [{"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 2, "creation_date": 1558530293, "post_id": 56257478, "comment_id": 99131461, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/492384/how-to-find-the-sizeof-a-pointer-pointing-to-an-array\">How to find the &#39;sizeof&#39; (a pointer pointing to an array)?</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1558530356, "post_id": 56257478, "comment_id": 99131511, "body": "The size of a pointer is the size of the pointer itself, not what it might point to. Use <code>std::vector</code> or <code>std::array</code> instead, and you won&#39;t have such problems."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1558530386, "post_id": 56257478, "comment_id": 99131530, "body": "The answer is you can not. You need to pass the dimensions if you have to use such constructs over a container class like std::vector. sizeof() in c++ is a compile time constant. In this case it will return the size of a pointer."}, {"owner": {"reputation": 443, "user_id": 9355797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fedace5aa9047a8293b3ccb4a5593de?s=128&d=identicon&r=PG&f=1", "display_name": "3D_fun", "link": "https://stackoverflow.com/users/9355797/3d-fun"}, "edited": false, "score": 0, "creation_date": 1558531210, "post_id": 56257478, "comment_id": 99132101, "body": "drescherjm:  write an answer, I will give you a solution mark."}], "answers": [{"tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 1, "last_activity_date": 1558533745, "last_edit_date": 1558533745, "creation_date": 1558533412, "answer_id": 56258569, "question_id": 56257478, "link": "https://stackoverflow.com/questions/56257478/count-size-of-two-dim-array-created-as-double-pointer/56258569#56258569", "title": "Count size of two dim array created as double pointer", "body": "<p><code>sizeof()</code> will only return the size of the pointer.</p>\n\n<p>There is only one way to get the size of the array. Create a class/structure that wraps the raw array <strong>and</strong> contains its size too.</p>\n\n<p>Fortunately, you don't have to create such a structure because since C++11 you can use <code>std::array</code> that does it for you and is exactly what you need. You can rewrite your example as follows:</p>\n\n<pre><code>std::array&lt;std::array&lt;float, 3&gt;, 3&gt; square; // size 3x3\n\n    for(size_t i = 0; i &lt; square.size(); ++i)\n    {\n        for(size_t j = 0; j &lt; square[0].size(); ++j)\n            square[i][j] = i;\n    }\n</code></pre>\n\n<p>The method <code>size()</code> gives you the size of the inner array.</p>\n\n<p>I hope it helps you.</p>\n"}], "owner": {"reputation": 443, "user_id": 9355797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fedace5aa9047a8293b3ccb4a5593de?s=128&d=identicon&r=PG&f=1", "display_name": "3D_fun", "link": "https://stackoverflow.com/users/9355797/3d-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558533745, "creation_date": 1558530226, "question_id": 56257478, "link": "https://stackoverflow.com/questions/56257478/count-size-of-two-dim-array-created-as-double-pointer", "title": "Count size of two dim array created as double pointer", "body": "<p>I have problem with counting columns or rows quantity (it doesn't matter, because it will be always square matrix) of this array, created as below:</p>\n\n<pre><code>    float **arr1 = new float*[3];\n\n    for (int i = 0; i &lt; 3; i++){\n        arr1[i] = new float[3];\n    }\n\n    for (int i = 0; i &lt; 3; i++){\n        for (int i = 0; i &lt; 3; i++){\n            arr1[i][j] = i;\n        }\n    }\n\n</code></pre>\n\n<p>I tried many options but I always get result: 1, for example:</p>\n\n<pre><code>    sizeof(arr1[0])/sizeof(arr1[0][0]);\n</code></pre>\n\n<p>If you know a solution, please share with me.</p>\n"}, {"tags": ["c++", "mysql"], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 8377354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b852fff36d193a03a66e15ad3237e5e?s=128&d=identicon&r=PG&f=1", "display_name": "quark", "link": "https://stackoverflow.com/users/8377354/quark"}, "is_accepted": true, "score": 0, "last_activity_date": 1558552410, "creation_date": 1558552410, "answer_id": 56263502, "question_id": 56257473, "link": "https://stackoverflow.com/questions/56257473/how-to-fix-mysql-prepared-resultsetgetint-invalid-value-of-columnindex/56263502#56263502", "title": "How to fix: &quot;MySQL_Prepared_ResultSet::getInt: invalid value of &#39;columnIndex&quot;", "body": "<p>I've just solved it. I forgot about \"id\" column in SELECT statement.</p>\n"}], "owner": {"reputation": 60, "user_id": 8377354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b852fff36d193a03a66e15ad3237e5e?s=128&d=identicon&r=PG&f=1", "display_name": "quark", "link": "https://stackoverflow.com/users/8377354/quark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 56263502, "answer_count": 1, "score": 0, "last_activity_date": 1558552410, "creation_date": 1558530221, "last_edit_date": 1558534657, "question_id": 56257473, "link": "https://stackoverflow.com/questions/56257473/how-to-fix-mysql-prepared-resultsetgetint-invalid-value-of-columnindex", "title": "How to fix: &quot;MySQL_Prepared_ResultSet::getInt: invalid value of &#39;columnIndex&quot;", "body": "<p>When I am trying to select some rows from MySQL database in my C++ project I am getting an error: </p>\n\n<pre><code>MySQL error code: 0 MySQL_Prepared_ResultSet::getInt: invalid value of 'columnIndex'  \n</code></pre>\n\n<p>In the database, column \"id\" has datatype INT(11).  </p>\n\n<p>I have no problem with getting string values from others columns. I also tried to set as an argument in function getInt() both a string value - column's name, as well as a number of the column. </p>\n\n<p>This is my code:</p>\n\n<pre><code>    preparedStatementPtr = shared_ptr &lt; sql::PreparedStatement &gt;( connectionPtr-&gt;prepareStatement(\n            \"SELECT description, category FROM plans WHERE date = ? \" ) );\n    string d = boost::gregorian::to_iso_extended_string( date );\n    preparedStatementPtr-&gt;setString( 1, d );\n    preparedStatementPtr-&gt;execute();\n    resultSetPtr = shared_ptr &lt; ResultSet &gt;( preparedStatementPtr-&gt;getResultSet() );\n\n    int id;\n    string description;\n    string category;\n\n    while ( resultSetPtr-&gt;next() )\n    {\n        id = resultSetPtr-&gt;getInt( \"id\" );\n        description = resultSetPtr-&gt;getString( \"description\" );\n        category = resultSetPtr-&gt;getString( \"category\" );\n        plans.emplace_back( std::shared_ptr &lt; Plan &gt;( new Plan( id, description, category, date) ) );\n    }\n</code></pre>\n\n<p>What should I do to get values from the column \"id\"? Thank you in advance for any help.</p>\n\n<p><strong>EDIT:</strong> Getting id works when I don't use prepared statement, as in the following code:</p>\n\n<pre><code>    resultSetPtr = shared_ptr &lt; sql::ResultSet &gt; ( statementPtr-&gt;executeQuery (\n            \"SELECT * FROM plans WHERE date = '2019-05-22'\" ) );\n\n\n    while ( resultSetPtr-&gt;next() )\n    {\n        id = resultSetPtr-&gt;getInt( \"id\" );\n        description = resultSetPtr-&gt;getString( \"description\" );\n        category = resultSetPtr-&gt;getString( \"category\" );\n        plans.emplace_back( std::shared_ptr &lt; Plan &gt;( new Plan( id, description, category, date ) ) );\n    }\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1558530312, "post_id": 56257466, "comment_id": 99131477, "body": "very related: <a href=\"https://stackoverflow.com/questions/7454990/why-cant-we-pass-arrays-to-function-by-value\" title=\"why cant we pass arrays to function by value\">stackoverflow.com/questions/7454990/&hellip;</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1558530475, "post_id": 56257466, "comment_id": 99131605, "body": "For argument declarations, the compiler treats e.g. <code>Student s[]</code> as <code>Student* s</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3141, "user_id": 2468549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b87d95c561b24d120cbfb5a1c5c9867?s=128&d=identicon&r=PG", "display_name": "Frax", "link": "https://stackoverflow.com/users/2468549/frax"}, "edited": false, "score": 0, "creation_date": 1558534177, "post_id": 56257726, "comment_id": 99134189, "body": "The last snippet is missing the <code>&amp;</code>. <code>std::array</code> is an option only if your argument is really of fixed size. When it&#39;s not, templating doesn&#39;t help. <code>std::vector</code> seems to be what OP is looking for."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 3141, "user_id": 2468549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b87d95c561b24d120cbfb5a1c5c9867?s=128&d=identicon&r=PG", "display_name": "Frax", "link": "https://stackoverflow.com/users/2468549/frax"}, "edited": false, "score": 0, "creation_date": 1558534341, "post_id": 56257726, "comment_id": 99134300, "body": "@Frax thanks for pointing out the error. You&#39;re right, <code>std::vector</code> definitely is the way to go, I edited the post to mention that."}, {"owner": {"reputation": 21, "user_id": 11536892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a076c76fcbf4007c592236342e3931a?s=128&d=identicon&r=PG&f=1", "display_name": "Finixzz", "link": "https://stackoverflow.com/users/11536892/finixzz"}, "edited": false, "score": 0, "creation_date": 1558550167, "post_id": 56257726, "comment_id": 99142431, "body": "@Blaze thanks ! Finally I think got the point, practically I could make a function set name that would make copy of one object, and then make another function with an array of objects. That way throughout the for loop, each object would get its own copy. Am I right ?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 21, "user_id": 11536892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a076c76fcbf4007c592236342e3931a?s=128&d=identicon&r=PG&f=1", "display_name": "Finixzz", "link": "https://stackoverflow.com/users/11536892/finixzz"}, "edited": false, "score": 0, "creation_date": 1558591848, "post_id": 56257726, "comment_id": 99153173, "body": "@Finixzz if I understand this correctly, you want to pass a pointer to an array to the function, which then calls a setter on the objects in the array? Sure, that&#39;ll work."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 0, "last_activity_date": 1558534223, "last_edit_date": 1558534223, "creation_date": 1558530885, "answer_id": 56257726, "question_id": 56257466, "link": "https://stackoverflow.com/questions/56257466/why-copy-constructor-doesent-call-itself-when-an-object-of-arrays-is-passed-as-a/56257726#56257726", "title": "Why copy constructor doesent call itself when an object of arrays is passed as a function argument?", "body": "<p>It's only passing a pointer to <code>S</code>, so it's not copying any <code>Student</code>. If you want to actually pass a copy of the array instead of just a pointer to it (and thus leave the original unchanged), you can wrap it using <code>std::array</code> like this:</p>\n\n<pre><code>void input(std::array&lt;Student, 2&gt; s)\n</code></pre>\n\n<p>And in <code>main</code>:</p>\n\n<pre><code>std::array&lt;Student, 2&gt; S;//Calls constructor\n</code></pre>\n\n<p>This way you get:</p>\n\n<pre><code>Constructor is called\nConstructor is called\nCopy constructor  is called\nCopy constructor  is called\n</code></pre>\n\n<p>However, the array will always have to be of the same size this way, unlike in your solution where you pass the size as an extra parameter. You could solve this issue with templates by declaring the function like this:</p>\n\n<pre><code>template &lt;unsigned int n&gt;\nvoid input(std::array&lt;Student, n&gt; s) {\n</code></pre>\n\n<p>And calling it like this:</p>\n\n<pre><code>input&lt;2&gt;(S);\n</code></pre>\n\n<p>Or, if you don't mind slightly lower performance, just use <code>std::vector</code> instead:</p>\n\n<pre><code>void input(std::vector&lt;Student&gt; s) {\n    for (int i = 0; i &lt; s.size(); i++) {\n        cout &lt;&lt; \"Input data for \" &lt;&lt; i + 1 &lt;&lt; \". student\\n\";\n        s[i].set();\n    }\n}\n\nint main() {\n    std::vector&lt;Student&gt; S(2);//Calls constructor\n    input(S);//Should call copy constructor \n    return 0;\n}\n</code></pre>\n\n<p>However, those don't do the same thing as your original function anymore, because since you're now passing just a copy, the original isn't modified. If you pass a reference however:</p>\n\n<pre><code>void input(std::vector&lt;Student&gt; &amp;s) {\n</code></pre>\n\n<p>The original is modified and you don't see <code>Copy constructor is called</code> anymore (this also works with the <code>std::array</code> version).</p>\n"}], "owner": {"reputation": 21, "user_id": 11536892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a076c76fcbf4007c592236342e3931a?s=128&d=identicon&r=PG&f=1", "display_name": "Finixzz", "link": "https://stackoverflow.com/users/11536892/finixzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 56257726, "answer_count": 1, "score": 0, "last_activity_date": 1558534223, "creation_date": 1558530185, "last_edit_date": 1558530281, "question_id": 56257466, "link": "https://stackoverflow.com/questions/56257466/why-copy-constructor-doesent-call-itself-when-an-object-of-arrays-is-passed-as-a", "title": "Why copy constructor doesent call itself when an object of arrays is passed as a function argument?", "body": "<p>Simple program that doesn't do anything much, but can anyone explain why copy constructor is not calling itself when an array of objects is passed in function argument? Works perfectly fine when only one object is initialized </p>\n\n<pre><code>class Student{\n    public:\n        Student(string name_val=\"empty\",int tg=2019,int gu=0):\n            name{name_val},current_year{tg}{cout&lt;&lt;\"Constructor is called \"&lt;&lt;endl;}\n        Student(const Student &amp;source):\n            name{source.name},current_year{source.current_year}{\n            cout&lt;&lt;\"Copy constructor  is called \"&lt;&lt;endl;\n            }\n        ~Student(){cout&lt;&lt;\"Destructor is called \"&lt;&lt;endl;}\n\n        void set(){\n            cout&lt;&lt;\"Input name and surname: \";getline(cin,name);\n        }   \n    private:\n        string name;\n        int current_year;\n};\n\nvoid input(Student s[],int n){//Should display when input function is called\n    for(int i=0;i&lt;n;i++){\n        cout&lt;&lt;\"Input data for \"&lt;&lt;i+1&lt;&lt;\". student\\n\";\n        s[i].set();\n    }\n}\n\nint main(){\n    Student S[2];//Calls constructor\n    input(S,2);//Should call copy constructor \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "image-processing", "bitmapimage"], "comments": [{"owner": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "edited": false, "score": 0, "creation_date": 1558530303, "post_id": 56257451, "comment_id": 99131469, "body": "you should read the documentation specific to each image format, however I would assume you should use a 16-bit type, such as uint16_t, also you should probably use uint8_t instead of unsigned char to make sure you have the right size"}, {"owner": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "edited": false, "score": 0, "creation_date": 1558530631, "post_id": 56257451, "comment_id": 99131699, "body": "unless you&#39;re doing this to learn as a learning experience I&#39;d advise you to consider using one of the already available libraries"}, {"owner": {"reputation": 101, "user_id": 10320361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QMDeLs6gz_A/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP6ZjlGncW7UimHkTM2xjcZRvxbig/mo/photo.jpg?sz=128", "display_name": "John Paoletto", "link": "https://stackoverflow.com/users/10320361/john-paoletto"}, "reply_to_user": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "edited": false, "score": 0, "creation_date": 1558530717, "post_id": 56257451, "comment_id": 99131745, "body": "definitely for the experience :)"}, {"owner": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "edited": false, "score": 0, "creation_date": 1558530806, "post_id": 56257451, "comment_id": 99131813, "body": "try reading the specs than <a href=\"http://www.dragonwins.com/domains/GetTechEd/bmp/bmpfileformat.htm\" rel=\"nofollow noreferrer\">dragonwins.com/domains/GetTechEd/bmp/bmpfileformat.htm</a> keep in mind that you might meet 1-bit bitmaps which have 1 byte representing 8 pixels"}, {"owner": {"reputation": 101, "user_id": 10320361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QMDeLs6gz_A/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP6ZjlGncW7UimHkTM2xjcZRvxbig/mo/photo.jpg?sz=128", "display_name": "John Paoletto", "link": "https://stackoverflow.com/users/10320361/john-paoletto"}, "reply_to_user": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "edited": false, "score": 0, "creation_date": 1558531032, "post_id": 56257451, "comment_id": 99131971, "body": "Yup, I suppose I just have to multiply the number of pixels by the number of bytes per pixel in the case of my function. But my initial problem of the fread (as it is above) returning 0 remains, even though height and width have values of 256 each."}, {"owner": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "edited": false, "score": 0, "creation_date": 1558531945, "post_id": 56257451, "comment_id": 99132668, "body": "did you open the stream? need more code for conclusions. Always check if opening succeeds, seeking succeeds, etc."}, {"owner": {"reputation": 101, "user_id": 10320361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QMDeLs6gz_A/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP6ZjlGncW7UimHkTM2xjcZRvxbig/mo/photo.jpg?sz=128", "display_name": "John Paoletto", "link": "https://stackoverflow.com/users/10320361/john-paoletto"}, "reply_to_user": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "edited": false, "score": 0, "creation_date": 1558532335, "post_id": 56257451, "comment_id": 99132918, "body": "OK, I&#39;ve added the surrounding code and comments to show the run results!!"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1558532405, "post_id": 56257451, "comment_id": 99132966, "body": "You do realize that BMP files use compression, right?"}, {"owner": {"reputation": 101, "user_id": 10320361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QMDeLs6gz_A/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP6ZjlGncW7UimHkTM2xjcZRvxbig/mo/photo.jpg?sz=128", "display_name": "John Paoletto", "link": "https://stackoverflow.com/users/10320361/john-paoletto"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1558532502, "post_id": 56257451, "comment_id": 99133040, "body": "@Cris, yup but this file doesn&#39;t. It&#39;s my start file :) Simple 8 bits per pixel bitmap image, no compression"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1558533272, "post_id": 56257451, "comment_id": 99133556, "body": "Also, <code>bitDepth&#47;8</code> is 0 if <code>bitDepth&lt;8</code>. And <code>unsigned char pixelDataBuffer[pixelDataSize];</code> is illegal in C++, it must be a compile-time constant. Use <code>std::vector</code> for your buffers."}, {"owner": {"reputation": 101, "user_id": 10320361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QMDeLs6gz_A/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP6ZjlGncW7UimHkTM2xjcZRvxbig/mo/photo.jpg?sz=128", "display_name": "John Paoletto", "link": "https://stackoverflow.com/users/10320361/john-paoletto"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1558533542, "post_id": 56257451, "comment_id": 99133752, "body": "@Cris ok, will do that"}], "answers": [{"tags": [], "owner": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "is_accepted": true, "score": 3, "last_activity_date": 1558533279, "creation_date": 1558533279, "answer_id": 56258507, "question_id": 56257451, "link": "https://stackoverflow.com/questions/56257451/problem-extracting-pixel-data-from-bitmap/56258507#56258507", "title": "Problem extracting Pixel Data from bitmap", "body": "<p>Your problem is declaring the result of fread as short.</p>\n\n<p>Try always using auto as much as possible. Using:</p>\n\n<pre><code>auto counter = fread(pixelDataBuffer, sizeof(unsigned char), pixelDataSize, streamIn);\n</code></pre>\n\n<p>makes it work. The problem is 65536 cannot be represented in short, in fact it overflows it by just enough that it would seem the result was 0 instead.</p>\n\n<p>If you are using an older version of C++ (before C++11) and you can't use auto use size_t instead (which is the actual return type of fread).</p>\n\n<p>I'd also advise you to learn to break your code into smaller functions and avoid writing huge if blocks, for readability and maintainability in the future.</p>\n"}], "owner": {"reputation": 101, "user_id": 10320361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QMDeLs6gz_A/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP6ZjlGncW7UimHkTM2xjcZRvxbig/mo/photo.jpg?sz=128", "display_name": "John Paoletto", "link": "https://stackoverflow.com/users/10320361/john-paoletto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56258507, "answer_count": 1, "score": 0, "last_activity_date": 1558533720, "creation_date": 1558530151, "last_edit_date": 1558533720, "question_id": 56257451, "link": "https://stackoverflow.com/questions/56257451/problem-extracting-pixel-data-from-bitmap", "title": "Problem extracting Pixel Data from bitmap", "body": "<p>I am using native C++ without to build an image processing library from ground up, currently for bitmaps. </p>\n\n<p>For example, I use the following to extract the pixel data from a bitmap after setting the stream's position to the correct location.</p>\n\n<pre><code>fread(pixelDataBuffer, sizeof(unsigned char), (height * width), streamIn);\n</code></pre>\n\n<p>Where <em>height</em> and <em>width</em> are the pixel dimensions of the bitmap image. I thought this would work and makes sense for an image with 8 bits per pixel, but it's still not working (the function returns 0). This happens even though height and width have values of 256 each, and pixelDataBuffer is initialized as below:</p>\n\n<pre><code>unsigned char pixelDataBuffer[height * width]; \n// also tried:\nunsigned char pixelDataBuffer[65536]; // which is 256*256\n</code></pre>\n\n<p>Thank you!</p>\n\n<p>Adding more code for clarity:</p>\n\n<pre><code>bool isTrial = true;\nFILE *streamIn;\nFILE *outputFile;\n\nint main(int argc, const char * argv[]) {\n\n    if (isTrial) {\n        streamIn = fopen(\"Images/cameraman.bmp\", \"rb\");\n        outputFile = fopen(\"Images/cameraman_copy.bmp\", \"wb\");\n    } else {\n        streamIn = fopen(\"Images/flag.bmp\", \"rb\");\n        outputFile = fopen(\"Images/flag_copy.bmp\", \"wb\");\n    }\n\n    unsigned char header[54];\n    unsigned char colourTable[1024];\n\n    if (streamIn == nullptr) {\n        printf(\"null pointer\");\n    } else {\n\n        for (int i = 0; i &lt; 54; i++) {\n            header[i] = getc(streamIn);\n        }\n\n        unsigned int width = *(int*)&amp;header[18];\n        cout &lt;&lt; \"width: \" &lt;&lt; width &lt;&lt; \"\\n\"; // = 256\n\n        unsigned int height = *(int *)&amp;header[22];\n        cout &lt;&lt; \"height: \" &lt;&lt; height &lt;&lt; \"\\n\"; // = 256\n\n        unsigned short bitDepth = *(short *)&amp;header[28];\n        cout &lt;&lt; \"bitDepth: \" &lt;&lt; bitDepth &lt;&lt; \"\\n\"; // = 8\n\n        unsigned int fileSize = *(int *)&amp;header[2];\n        cout &lt;&lt; \"fileSize: \" &lt;&lt; fileSize &lt;&lt; endl; // 66614\n\n        if (1 &lt; bitDepth &amp;&amp; bitDepth &lt;= 8) {\n            short count = fread(colourTable, sizeof(unsigned char), 1024, streamIn); \n            if (count == 1024) {\n                printf(\"colourTable read\\n\"); // colourTable gets read\n            } else {\n                printf(\"colourTable NOT read properly\");\n            }\n        } else {\n            printf(\"bitsPerPixel / bitDepth is more than 8\");\n        }\n\n\n        { // getting pixelData, at this point I assumed that the stream's position starts where pixel data starts (i.e. after Headers &amp; ColourTable)\n\n            unsigned int pixelDataSize = height * width * (bitDepth/8); // = 65536\n            cout &lt;&lt; \"pixelDataSize: \" &lt;&lt; pixelDataSize &lt;&lt; endl;\n\n            unsigned char pixelDataBuffer[pixelDataSize]; // also tried initializing like unsigned char pixelDataBuffer[height*width]\n\n            short counter = fread(pixelDataBuffer, sizeof(unsigned char), pixelDataSize, streamIn);\n            cout &lt;&lt; \"counter: \" &lt;&lt; counter &lt;&lt; endl; // = 0 THIS IS THE ISSUE. Documentation says \"If either size or count is zero, the function returns zero and both the stream state and the content pointed by ptr remain unchanged.\" But I think I have size and count &gt;0 correctly?\n\n        }\n\n\n        { // writing our header onto the outputFile\n            short count = fwrite(header, sizeof(unsigned char), 54, outputFile);\n            if (count == 54) {\n                printf(\"header written\\n\"); // Header gets written\n            } else {\n                printf(\"header not written\");\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++17", "virtual", "destructor", "virtual-destructor"], "comments": [{"owner": {"reputation": 1356, "user_id": 2287458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dAyBK.jpg?s=128&g=1", "display_name": "Phil-ZXX", "link": "https://stackoverflow.com/users/2287458/phil-zxx"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1558531322, "post_id": 56257395, "comment_id": 99132203, "body": "@VTT: My question is about the implications of boilerplate code, and whether or not, one should add it. I am <b>not</b> asking &quot;in which instance do we need to make destructors virtual&quot;."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1558532126, "post_id": 56257395, "comment_id": 99132787, "body": "To which part of this code you are referring to as &quot;boilerplate&quot;? Virtual destructor in base class is not a boilerplate because it is a necessary code that makes it possible to hold ownership of derived object through a pointer to a base object. You don&#39;t add it to get rid of the warning, you add it when you want to make that particular ownership pattern work."}, {"owner": {"reputation": 187, "user_id": 3733334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e39a8a702cb94d44e344727625120f1?s=128&d=identicon&r=PG&f=1", "display_name": "mcabreb", "link": "https://stackoverflow.com/users/3733334/mcabreb"}, "edited": false, "score": 2, "creation_date": 1558534309, "post_id": 56257395, "comment_id": 99134275, "body": "Adding a virtual destructor is not boilerplate. It allows you to create a derived class and then delete it through a pointer to the base class. Without the virtual destructor only the base class allocaed memory would be freed, not the whole base+derived class allocated memory.  The compiler does not create a virtual default destructor because maybe you don&#39;t want it. Maybe you won&#39;t delete through pointers to base. It does not know what you want to do with the class."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1558535250, "post_id": 56257395, "comment_id": 99134859, "body": "It&#39;s <i>possible</i> to have virtual methods and a nonvirtual destructor, and not have undefined behaviour, so long as you never delete <code>Base *</code>s. That&#39;s why it&#39;s a warning and not an error"}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1558535264, "post_id": 56257395, "comment_id": 99134873, "body": "Remember that compilers can and will optimize, and even inline a call to a virtual function or destructor when possible."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 187, "user_id": 3733334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e39a8a702cb94d44e344727625120f1?s=128&d=identicon&r=PG&f=1", "display_name": "mcabreb", "link": "https://stackoverflow.com/users/3733334/mcabreb"}, "edited": false, "score": 0, "creation_date": 1558540180, "post_id": 56257395, "comment_id": 99137843, "body": "@mcabreb -- without the virtual destructor, the behavior (when deleting an object of a derived type through a pointer to base) is undefined. What you describe is a possible consequence, but it is not required and not usually what happens."}], "owner": {"reputation": 1356, "user_id": 2287458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dAyBK.jpg?s=128&g=1", "display_name": "Phil-ZXX", "link": "https://stackoverflow.com/users/2287458/phil-zxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "closed_date": 1558530081, "answer_count": 0, "score": 0, "last_activity_date": 1558529945, "creation_date": 1558529945, "question_id": 56257395, "link": "https://stackoverflow.com/questions/56257395/practicality-of-virtual-destructor-in-base-class", "closed_reason": "Duplicate", "title": "Practicality of virtual destructor in Base Class", "body": "<p>Lets take this example:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    /* Source.cpp */\n\n    struct Base {\n        virtual void func() = 0;\n    };\n\n    struct Derived : public Base {\n        virtual void func() override { }\n    };\n\n    int main() {\n        return 0;\n    }\n</code></pre>\n\n<p>Upon compilation (on g++ 8.3.0) via <code>g++ Source.cpp -Wnon-virtual-dtor</code> we get this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    Source.cpp:2:8: warning: 'struct Base' has virtual functions and accessible non-virtual destructor [-Wnon-virtual-dtor]\n     struct Base {\n            ^~~~\n    Source.cpp:6:8: warning: base class 'struct Base' has accessible non-virtual destructor [-Wnon-virtual-dtor]\n     struct Derived : public Base {\n            ^~~~~~~\n    Source.cpp:6:8: warning: 'struct Derived' has virtual functions and accessible non-virtual destructor [-Wnon-virtual-dtor]\n</code></pre>\n\n<p><br></p>\n\n<p>What is the <strong>practical</strong> thing to do? </p>\n\n<ul>\n<li>Add <code>virtual ~Base() = default;</code> to every such class <code>Base</code> to get rid of the warning (downside is we are adding boilerplate code, which inherently doesn't seem to do anything).</li>\n<li>Or is there an argument to remove <code>-Wnon-virtual-dtor</code> and leave the code untouched? (downside is we are potentially allowing memory leaks, or are we)</li>\n<li>I guess a question worth asking is, why doesn't the compiler create a <em>virtual default destructor</em> if the class has <em>virtual members</em>?</li>\n</ul>\n"}, {"tags": ["c++", "winapi", "cursor"], "comments": [{"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 0, "creation_date": 1558530342, "post_id": 56256645, "comment_id": 99131503, "body": "This saves all icons correctly but fails on cursors? The on-disk .cur format is not exactly the same as .ico"}, {"owner": {"reputation": 306, "user_id": 8203729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43645d8f08494a1e7634ce94939975de?s=128&d=identicon&r=PG&f=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/8203729/krish"}, "reply_to_user": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 0, "creation_date": 1558589928, "post_id": 56256645, "comment_id": 99152562, "body": "@Anders Then how can I identify the captured data is icon or cursor, Is any generic way."}, {"owner": {"reputation": 306, "user_id": 8203729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43645d8f08494a1e7634ce94939975de?s=128&d=identicon&r=PG&f=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/8203729/krish"}, "reply_to_user": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 0, "creation_date": 1558593826, "post_id": 56256645, "comment_id": 99153872, "body": "@Anders For windows all standard cursors its working fine but some custom cursors like photoshop have their own type of cursors their my writing part fails it writes cursor with black rectangle box and even few hand shaped cursors in gmail."}], "answers": [{"tags": [], "owner": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "is_accepted": false, "score": 0, "last_activity_date": 1558598480, "creation_date": 1558598480, "answer_id": 56270601, "question_id": 56256645, "link": "https://stackoverflow.com/questions/56256645/how-to-apply-masking-for-mouse-cursor-while-writing-in-to-icon-ico/56270601#56270601", "title": "How to apply masking for mouse cursor while writing in to icon(.ico)", "body": "<p>The <code>ICONINFO</code> struct contains two members, <code>hbmMask</code> and <code>hbmColor</code>, that contain the mask and color bitmaps, respectively, for the cursor (see the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/embedded/ms929934(v=msdn.10)\" rel=\"nofollow noreferrer\">MSDN</a> page for <code>ICONINFO</code> for the official documentation).</p>\n\n<p>When you call <code>GetIconInfo()</code> for the default cursor, the <code>ICONINFO</code> struct contains both valid mask and color bitmaps.</p>\n\n<blockquote>\n  <p>There is probably a better way to render the cursor that the\n  <code>BitBlt()</code> - <code>BitBlt()</code> - <code>MakeTransparent()</code> combination of method\n  calls.</p>\n</blockquote>\n\n<p>Refer to the @Tarsier approach, although it's C #, but the idea is the same.</p>\n\n<p>Link: <a href=\"https://stackoverflow.com/questions/918990/c-sharp-capturing-the-mouse-cursor-image\">Capturing the Mouse cursor image</a></p>\n"}], "owner": {"reputation": 306, "user_id": 8203729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43645d8f08494a1e7634ce94939975de?s=128&d=identicon&r=PG&f=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/8203729/krish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1558598480, "creation_date": 1558527496, "last_edit_date": 1558528364, "question_id": 56256645, "link": "https://stackoverflow.com/questions/56256645/how-to-apply-masking-for-mouse-cursor-while-writing-in-to-icon-ico", "title": "How to apply masking for mouse cursor while writing in to icon(.ico)", "body": "<p>I using <code>GetCursorInfo</code> to capture cursor but while saving the cursor as icon getting some black rectangle over on icon.</p>\n\n<p>For windows default cursors are fine but few custom cursor I facing this issue <a href=\"http://www.cursors-4u.com/\" rel=\"nofollow noreferrer\">http://www.cursors-4u.com/</a></p>\n\n<p>Placed one example cursor icon in link <a href=\"https://www.google.com/search?q=cursor+icon&amp;rlz=1C1CHBD_enIN789IN789&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=0ahUKEwix9aj_gq_iAhWCXCsKHcusD0oQ_AUIDigB&amp;biw=1366&amp;bih=657#imgrc=rOxlbRoBfnKs8M\" rel=\"nofollow noreferrer\">https://www.google.com/search?q=cursor+icon&amp;rlz=1C1CHBD_enIN789IN789&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=0ahUKEwix9aj_gq_iAhWCXCsKHcusD0oQ_AUIDigB&amp;biw=1366&amp;bih=657#imgrc=rOxlbRoBfnKs8M</a>:</p>\n\n<pre><code>HRESULT SaveIcon(HICON hIcon, const char* path) \n{\n    // Create the IPicture intrface\n    PICTDESC desc = { sizeof(PICTDESC) };\n    desc.picType = PICTYPE_ICON;\n    desc.icon.hicon = hIcon;\n    IPicture* pPicture = 0;\n    HRESULT hr = OleCreatePictureIndirect(&amp;desc, IID_IPicture, FALSE, (void**)&amp;pPicture);\n    if (FAILED(hr)) return hr;\n\n    // Create a stream and save the image\n    IStream* pStream = 0;\n    CreateStreamOnHGlobal(0, TRUE, &amp;pStream);\n    LONG cbSize = 0;\n    hr = pPicture-&gt;SaveAsFile(pStream, TRUE, &amp;cbSize);\n\n    // Write the stream content to the file\n    if (!FAILED(hr)) \n    {\n        HGLOBAL hBuf = 0;\n        GetHGlobalFromStream(pStream, &amp;hBuf);\n        void* buffer = GlobalLock(hBuf);\n        HANDLE hFile = CreateFileA(path, GENERIC_WRITE, 0, 0, CREATE_ALWAYS, 0, 0);\n        if (!hFile) \n        {\n            hr = HRESULT_FROM_WIN32(GetLastError());\n        }\n        else \n        {\n            DWORD written = 0;\n            WriteFile(hFile, buffer, cbSize, &amp;written, 0);\n            CloseHandle(hFile);\n        }\n        GlobalUnlock(buffer);\n    }\n    // Cleanup\n    pStream-&gt;Release();\n    pPicture-&gt;Release();\n    return hr;\n}\n\n//Capture cursor.\nCURSORINFO getHCursor()\n{\n  CURSORINFO cursorInfo;\n  cursorInfo.cbSize = sizeof(CURSORINFO);\n\n  if (GetCursorInfo(&amp;cursorInfo) == 0) \n  { \n    MessageBox(NULL, _T(\"Exception : GetCursorInfo creation failed\"),_T(\"message\"),MB_OK|MB_SYSTEMMODAL);       \n    cursorInfo.hCursor = NULL;\n    return cursorInfo;\n  }\n\n  return cursorInfo;\n}\n\n//Main Call\nint _tmain(int argc, _TCHAR* argv[])\n{\n    while (true)\n    {\n        CURSORINFO CursorInfo = getHCursor();\n        if (CursorInfo.hCursor == NULL) \n        {           \n            ::Sleep(MinSleep);\n            continue;\n        }       \n\n        SaveIcon((HICON)CursorInfo.hCursor, \"C:\\\\Users\\\\Desktop\\\\myicon.ico\");\n\n        Sleep(MaxSleep);\n    }   \n    return 0;\n}\n</code></pre>\n\n<p>My agenda is to capture cursor and save cursor in to icon(.ico) file or load in to buffer.</p>\n\n<p>Is any other way I can write cursor data in to icon file or buffer ?</p>\n"}, {"tags": ["c++", "templates", "c++14"], "comments": [{"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 4, "creation_date": 1558528278, "post_id": 56256640, "comment_id": 99130221, "body": "offtopic: this <code>std::forward</code> is misused. It should be used only if argument can be moved to next function/template. It doesn&#39;t break anything here it is just boilerplate."}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1558528288, "post_id": 56256640, "comment_id": 99130230, "body": "After your edit: How can this possibly work with <code>void</code> return types? Either you assign the return value to <code>result</code> or you leave it. <code>auto return = some_void_func()</code> doesn&#39;t make any sense."}, {"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 4, "creation_date": 1558528547, "post_id": 56256640, "comment_id": 99130370, "body": "@MarekR what if function object with rvalue only overload of <code>operator()</code> is passed? Will it work without <code>forward</code>?"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1558529047, "post_id": 56256640, "comment_id": 99130648, "body": "OK fair point, it is possible that someone can define such operator. This is quite unusual, but possible, so <code>std::forward</code> can have sense here."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 1, "creation_date": 1558531163, "post_id": 56256640, "comment_id": 99132068, "body": "related proposal: <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0146r1.html\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0146r1.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11187, "user_id": 1147772, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OAgfw.jpg?s=128&g=1", "display_name": "Drax", "link": "https://stackoverflow.com/users/1147772/drax"}, "edited": false, "score": 2, "creation_date": 1558529014, "post_id": 56256705, "comment_id": 99130630, "body": "bonus tip: the &quot;generic stuff&quot; should better not throw anything"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614012, "post_id": 56256705, "comment_id": 99164569, "body": "And what if it does throw something? What if you need to propagate that exception?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614444, "post_id": 56256705, "comment_id": 99164841, "body": "@Barry - yes: this is another limit of this solution."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 14, "last_activity_date": 1558530450, "last_edit_date": 1558530450, "creation_date": 1558527707, "answer_id": 56256705, "question_id": 56256640, "link": "https://stackoverflow.com/questions/56256640/function-argument-returning-void-or-non-void-type/56256705#56256705", "title": "Function argument returning void or non-void type", "body": "<p>if you can place the \"some generic stuff\" in the destructor of a <code>bar</code> class (inside a security try/catch block, if you're not sure that doesn't throw exceptions, as pointed by Drax), you can simply write</p>\n\n<pre><code>template &lt;typename F&gt;\nauto foo (F &amp;&amp;f)\n {\n   bar b;\n\n   return std::forward&lt;F&gt;(f)(/*some args*/);\n }\n</code></pre>\n\n<p>So the compiler compute <code>f(/*some args*/)</code>, exec the destructor of <code>b</code> and return the computed value (or nothing).</p>\n\n<p>Observe that <code>return func();</code>, where <code>func()</code> is a function returning <code>void</code>, is perfectly legal.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558530211, "post_id": 56256964, "comment_id": 99131409, "body": "<i>&quot;Some specialization, somewhere, is necessary.&quot;</i> not with a <code>Finally</code> raii code, as proposed in another answer."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1558530801, "post_id": 56256964, "comment_id": 99131809, "body": "@Jarod42 - but the other answer has a great limit: if the &quot;some generic stuff&quot; needs the value computed by <code>f()</code> (if not <code>void</code>) I don&#39;t see a way to avoid a specialization somewhere. I suspect that Sam&#39;s answer is better than mine."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558534847, "post_id": 56256964, "comment_id": 99134595, "body": "This incurs an unconditional extra copy."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1558535382, "post_id": 56256964, "comment_id": 99134958, "body": "An extra copy could be avoided by having <code>foo()</code> return the helper object itself. Which will necessitate changing the callers."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558535871, "post_id": 56256964, "comment_id": 99135243, "body": "@SamVarshavchik That&#39;s... not a solution."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 9, "last_activity_date": 1558528568, "creation_date": 1558528568, "answer_id": 56256964, "question_id": 56256640, "link": "https://stackoverflow.com/questions/56256640/function-argument-returning-void-or-non-void-type/56256964#56256964", "title": "Function argument returning void or non-void type", "body": "<p>Some specialization, somewhere, is necessary. But the goal here is to avoid specializing the function itself. However, you can specialize a helper class.</p>\n\n<p>Tested with gcc 9.1 with <code>-std=c++17</code>.</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename T&gt;\nstruct return_value {\n\n\n    T val;\n\n    template&lt;typename F, typename ...Args&gt;\n    return_value(F &amp;&amp;f, Args &amp;&amp; ...args)\n        : val{f(std::forward&lt;Args&gt;(args)...)}\n    {\n    }\n\n    T value() const\n    {\n        return val;\n    }\n};\n\ntemplate&lt;&gt;\nstruct return_value&lt;void&gt; {\n\n    template&lt;typename F, typename ...Args&gt;\n    return_value(F &amp;&amp;f, Args &amp;&amp; ...args)\n    {\n        f(std::forward&lt;Args&gt;(args)...);\n    }\n\n    void value() const\n    {\n    }\n};\n\ntemplate&lt;class F&gt;\nauto foo(F &amp;&amp;f)\n{\n    return_value&lt;decltype(std::declval&lt;F &amp;&amp;&gt;()(2, 4))&gt; r{f, 2, 4};\n\n    // Something\n\n    return r.value();\n}\n\nint main()\n{\n    foo( [](int a, int b) { return; });\n\n    std::cout &lt;&lt; foo( [](int a, int b) { return a+b; }) &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 5, "last_activity_date": 1558534377, "creation_date": 1558534377, "answer_id": 56258868, "question_id": 56256640, "link": "https://stackoverflow.com/questions/56256640/function-argument-returning-void-or-non-void-type/56258868#56258868", "title": "Function argument returning void or non-void type", "body": "<p>The best way to do this, in my opinion, is to actually change the way you call your possibly-void-returning functions. Basically, we change the ones that return <code>void</code> to instead return some class type <code>Void</code> that is, for all intents and purposes, the same thing and no users really are going to care.</p>\n\n<pre><code>struct Void { };\n</code></pre>\n\n<p>All we need to do is to wrap the invocation. The following uses C++17 names (<code>std::invoke</code> and <code>std::invoke_result_t</code>) but they're all implementable in C++14 without too much fuss:</p>\n\n<pre><code>// normal case: R isn't void\ntemplate &lt;typename F, typename... Args, \n    typename R = std::invoke_result_t&lt;F, Args...&gt;,\n    std::enable_if_t&lt;!std::is_void&lt;R&gt;::value, int&gt; = 0&gt;\nR invoke_void(F&amp;&amp; f, Args&amp;&amp;... args) {\n    return std::invoke(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...);\n}\n\n// special case: R is void\ntemplate &lt;typename F, typename... Args, \n    typename R = std::invoke_result_t&lt;F, Args...&gt;,\n    std::enable_if_t&lt;std::is_void&lt;R&gt;::value, int&gt; = 0&gt;\nVoid invoke_void(F&amp;&amp; f, Args&amp;&amp;... args) {\n    // just call it, since it doesn't return anything\n    std::invoke(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...);\n\n    // and return Void\n    return Void{};\n}\n</code></pre>\n\n<p>The advantage of doing it this way is that you can just directly write the code you wanted to write to begin with, in the way you wanted to write it:</p>\n\n<pre><code>template&lt;class F&gt;\nauto foo(F &amp;&amp;f) {\n    auto result = invoke_void(std::forward&lt;F&gt;(f), /*some args*/);\n    //do some generic stuff\n    return result;\n}\n</code></pre>\n\n<p>And you don't have to either shove all your logic in a destructor or duplicate all of your logic by doing specialization. At the cost of <code>foo([]{})</code> returning <code>Void</code> instead of <code>void</code>, which isn't much of a cost.</p>\n\n<p>And then if <a href=\"https://wg21.link/p0146\" rel=\"noreferrer\">Regular Void</a> is ever adopted, all you have to do is swap out <code>invoke_void</code> for <code>std::invoke</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558579533, "post_id": 56263543, "comment_id": 99150622, "body": "This solution imposes default construction and assignment as requirements (in addition to lots of boilerplate). The underlying idea, swapping out <code>void</code> for a regular type, is a good one though - see my answer for a better way to implement that idea."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558607183, "post_id": 56263543, "comment_id": 99160935, "body": "@Barry - Yes, this solution require a lots of boilerplate but permit to use the computed value in the &quot;generic stuff&quot;; my other solution is trivially simple but the result is unusable; taking this in account, I think the boilerplate is justifiable. You&#39;re right about default contruction and assignment; i was thinking of add a caveat in the answer but there is a simple way (a little boilerplate more) to avoid this problem; answer modified. Anyway, I find your solution interesting but really different because change the signature of the function (<code>foo()</code> never return <code>void</code> anymore)."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558613309, "post_id": 56263543, "comment_id": 99164191, "body": "... and now it requires an extra copy and a full allocation!"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558613527, "post_id": 56263543, "comment_id": 99164307, "body": "@Barry - yes, but avoid the problem of the default construction and assignment; the extra copy is about a pointer."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558613788, "post_id": 56263543, "comment_id": 99164440, "body": "The extra copy is not a pointer, it&#39;s the full object. This inhibits RVO."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614115, "post_id": 56263543, "comment_id": 99164628, "body": "@Barry - sorry, which extra copy do you refer?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614174, "post_id": 56263543, "comment_id": 99164664, "body": "The return object, <code>return *pResult;</code> That&#39;s a copy."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614343, "post_id": 56263543, "comment_id": 99164768, "body": "@Barry - &quot;Also you can&#39;t &quot;yes, but&quot; an extra allocation...&quot; - why not?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614408, "post_id": 56263543, "comment_id": 99164812, "body": "No, there was no extra copy in the original code. Copy elision applies."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614545, "post_id": 56263543, "comment_id": 99164890, "body": "You can&#39;t just add an extra allocation/deallocation because it makes it convenient to solve a metaprogramming puzzle. That is a huge performance hit that&#39;s completely unnecessary."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614606, "post_id": 56263543, "comment_id": 99164927, "body": "@Barry - copy elision... yes, you&#39;re right. But isn&#39;t an extra copy (in <code>void</code>/<code>Void</code> case) also in your solution?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614641, "post_id": 56263543, "comment_id": 99164942, "body": "All this because it&#39;s supposedly &quot;really different&quot; to return <code>void</code> instead of <code>Void</code>? It&#39;s actually not different at all, neither conceptually nor practically. A unit type is a unit type, many languages have them more directly -- we just happen not to."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614695, "post_id": 56263543, "comment_id": 99164977, "body": "No, there&#39;s no extra copy. And <code>Void</code> is an empty type anyway so even if there were...?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614757, "post_id": 56263543, "comment_id": 99165019, "body": "When I say the allocation is totally unnecessary, Sam&#39;s solution demonstrates one way of doing this."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614796, "post_id": 56263543, "comment_id": 99165040, "body": "@Barry - I disagree: IMHO, you can&#39;t change the function signature to solve a problem of this type."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558614997, "post_id": 56263543, "comment_id": 99165156, "body": "@Barry - OK: it&#39;s possible avoid an allocation and probably the allocation is heavy. Said this, with all defects (IMHO, the ugliest is the repetition of the <code>f</code> call) I think that this way can be of interest for someone interested in this problem."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558615853, "post_id": 56263543, "comment_id": 99165682, "body": "Of course you can change the signature. If the caller is passing you a void function, they&#39;re not expecting a return anyway. Compare that to the upside of being able to write normal code, AND be able to properly handle exceptions, AND avoid any extra copies. Far from being a downside, returning <code>Void</code> is it&#39;s own benefit since it lets this function compose too. I&#39;ve been using this pattern as a basic building block of several libraries and not one time have I ever <i>needed</i> the return type to stay <code>void</code>."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558616492, "post_id": 56263543, "comment_id": 99166047, "body": "Incidentally, this also won&#39;t work if <code>TR_t</code> is a reference type."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1558617396, "post_id": 56263543, "comment_id": 99166545, "body": "@Barry - &quot;Incidentally, this also won&#39;t work if <code>TR_t</code> is a reference type&quot;; yes, this is a great limits I dind&#39;t noticed; thanks. Answer modified adding your points (correct it if I&#39;ve misunderstand something)."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": -1, "last_activity_date": 1558617272, "last_edit_date": 1558617272, "creation_date": 1558552604, "answer_id": 56263543, "question_id": 56256640, "link": "https://stackoverflow.com/questions/56256640/function-argument-returning-void-or-non-void-type/56263543#56263543", "title": "Function argument returning void or non-void type", "body": "<p>In case you need to use <code>result</code> (in non-void cases) in \"some generic stuff\", I propose a <code>if constexpr</code> based solution (so, unfortunately, not before C++17).</p>\n\n<p>Not really elegant, to be honest.</p>\n\n<p>First of all, detect the \"true return type\" of <code>f</code> (given the arguments)</p>\n\n<pre><code>using TR_t = std::invoke_result_t&lt;F, As...&gt;;\n</code></pre>\n\n<p>Next a <code>constexpr</code> variable to see if the returned type is <code>void</code> (just to simplify a little the following code)</p>\n\n<pre><code>constexpr bool isVoidTR { std::is_same_v&lt;TR_t, void&gt; };\n</code></pre>\n\n<p>Now we define a (potentially) \"fake return type\": <code>int</code> when the true return type is <code>void</code>, the <code>TR_t</code> otherwise</p>\n\n<pre><code>using FR_t = std::conditional_t&lt;isVoidTR, int, TR_t&gt;;\n</code></pre>\n\n<p>Then we define the a smart pointer to the result value as pointer to the \"fake return type\" (so <code>int</code> in void case)</p>\n\n<pre><code>std::unique_ptr&lt;FR_t&gt;  pResult;\n</code></pre>\n\n<p>Passing through a pointer, instead of a simple variable of type \"fake return type\", we can operate also when <code>TR_t</code> isn't default constructible or not assignable (limits, pointed by Barry (thanks), of the first version of this answer).</p>\n\n<p>Now, using <code>if constexpr</code>, the two case to exec <code>f</code> (this, IMHO, is the ugliest part because we have to write two times the same <code>f</code> invocation)</p>\n\n<pre><code>if constexpr ( isVoidTR )\n   std::forward&lt;F&gt;(f)(std::forward&lt;As&gt;(args)...);\nelse\n   pResult.reset(new TR_t{std::forward&lt;F&gt;(f)(std::forward&lt;As&gt;(args)...)});\n</code></pre>\n\n<p>After this, the \"some generic stuff\" that can use <code>result</code> (in non-void cases) and also `isVoidTR).</p>\n\n<p>To conclude, another <code>if constexpr</code></p>\n\n<pre><code>if constexpr ( isVoidTR )\n   return;\nelse\n   return *pResult;\n</code></pre>\n\n<p>As pointed by Barry, this solution has some important downsides because (not <code>void</code> cases)</p>\n\n<ul>\n<li>require an allocation</li>\n<li>require an extra copy in correspondence of the <code>return</code></li>\n<li>doesn't works at all if the <code>TR_t</code> (the type returned by <code>f()</code>) is a reference type</li>\n</ul>\n\n<p>Anyway, the following is a full compiling C++17 example</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename F, typename ... As&gt;\nauto foo (F &amp;&amp; f, As &amp;&amp; ... args)\n {\n   // true return type\n   using TR_t = std::invoke_result_t&lt;F, As...&gt;;\n\n   constexpr bool isVoidTR { std::is_same_v&lt;TR_t, void&gt; };\n\n   // (possibly) fake return type\n   using FR_t = std::conditional_t&lt;isVoidTR, int, TR_t&gt;;\n\n   std::unique_ptr&lt;FR_t&gt;  pResult;\n\n   if constexpr ( isVoidTR )\n      std::forward&lt;F&gt;(f)(std::forward&lt;As&gt;(args)...);\n   else\n      pResult.reset(new TR_t{std::forward&lt;F&gt;(f)(std::forward&lt;As&gt;(args)...)});\n\n   // some generic stuff (potentially depending from result,\n   // in non-void cases)\n\n   if constexpr ( isVoidTR )\n      return;\n   else\n      return *pResult;\n }\n\nint main ()\n {\n   foo([](){});\n\n   //auto a { foo([](){}) };  // compilation error: foo() is void\n\n   auto b { foo([](auto a0, auto...){ return a0; }, 1, 2l, 3ll) };\n\n   static_assert( std::is_same_v&lt;decltype(b), int&gt; );\n\n }\n</code></pre>\n"}], "owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1334, "favorite_count": 0, "accepted_answer_id": 56256705, "answer_count": 4, "score": 18, "last_activity_date": 1558617272, "creation_date": 1558527489, "last_edit_date": 1558575850, "question_id": 56256640, "link": "https://stackoverflow.com/questions/56256640/function-argument-returning-void-or-non-void-type", "title": "Function argument returning void or non-void type", "body": "<p>I am in the middle of writing some generic code for a future library. I came across the following problem inside a template function. Consider the code below:</p>\n\n<pre><code>template&lt;class F&gt;\nauto foo(F &amp;&amp;f) {\n    auto result = std::forward&lt;F&gt;(f)(/*some args*/);\n    //do some generic stuff\n    return result;\n}\n</code></pre>\n\n<p>It will work fine, unless I pass to it a function that returns <code>void</code> like:</p>\n\n<pre><code>foo([](){});\n</code></pre>\n\n<p>Now, of course, I could use some <code>std::enable_if</code> magic to check the return type and perform specialization for a function returning <code>void</code> that looks like this:</p>\n\n<pre><code>template&lt;class F, class = /*enable if stuff*/&gt;\nvoid foo(F &amp;&amp;f) {\n    std::forward&lt;F&gt;(f)(/*some args*/);\n    //do some generic stuff\n}\n</code></pre>\n\n<p>But that would awfully duplicate code for actually logically equivalent functions. Can this be done easily in a generic way for both <code>void</code>-returning and non-<code>void</code>-returning functions in a elegant way?</p>\n\n<p>EDIT:\nthere is data dependency between function <code>f()</code> and generic stuff I want to do, so I do not take code like this into account: </p>\n\n<pre><code>template&lt;class F&gt;\nauto foo(F &amp;&amp;f) {\n    //do some generic stuff\n    return std::forward&lt;F&gt;(f)(/*some args*/);\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1558527159, "post_id": 56256431, "comment_id": 99129661, "body": "Something tells me the warning can be removed by casting to <code>void *</code> first."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1558528391, "post_id": 56256431, "comment_id": 99130288, "body": "Why not use static_cast to a float *? Does that remove the warning?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1558529020, "post_id": 56256431, "comment_id": 99130638, "body": "How does <code>get()</code> know how many char&#39;s it should put in its buffer?"}], "answers": [{"tags": [], "owner": {"reputation": 17902, "user_id": 116273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cc60634738ece15d1de4738110c76aa8?s=128&d=identicon&r=PG", "display_name": "erenon", "link": "https://stackoverflow.com/users/116273/erenon"}, "is_accepted": false, "score": 1, "last_activity_date": 1558527061, "creation_date": 1558527061, "answer_id": 56256510, "question_id": 56256431, "link": "https://stackoverflow.com/questions/56256431/warning-cast-from-char-to-float-increases-required-alignment-from-1-to/56256510#56256510", "title": "warning: cast from &#39;char *&#39; to &#39;float *&#39; increases required alignment from 1 to 4 [-Wcast-align]", "body": "<p>Under what kind of conditions? If it always returns a float buffer, make it so (<code>float* get()</code>), if sometimes it does not, a static decorator will not help.</p>\n\n<p>If you know that the returned pointer points to a float, <code>reinterpret_cast</code> can be used. If it does not, but you still want a float, <a href=\"http://en.cppreference.com/w/c/string/byte/memcpy\" rel=\"nofollow noreferrer\">memcpy</a> or <a href=\"https://en.cppreference.com/w/cpp/numeric/bit_cast\" rel=\"nofollow noreferrer\">bit_cast</a> (C++20) can be used.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1558527606, "post_id": 56256608, "comment_id": 99129866, "body": "and probably <code>std::alignment_of_v&lt;float&gt;</code> instead of <code>4</code>."}, {"owner": {"reputation": 11126, "user_id": 136285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/98d92168760c5b402a315926e4700d5f?s=128&d=identicon&r=PG", "display_name": "malat", "link": "https://stackoverflow.com/users/136285/malat"}, "edited": false, "score": 0, "creation_date": 1558527752, "post_id": 56256608, "comment_id": 99129949, "body": "still I shame I cannot decorate the actual <code>get</code> function instead."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1558528272, "post_id": 56256608, "comment_id": 99130219, "body": "The question asks for C++11 though. No down vote from me though, since it is still handy to know other versions of C++."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1558529238, "post_id": 56256608, "comment_id": 99130775, "body": "If the pointer returned by <code>get()</code> isn&#39;t aligned, <code>std::assume_aligned</code> won&#39;t help if I understand the wiki correctly. &quot;<i>The behavior is undefined if ptr does not point to an object of type T (ignoring cv-qualification at every level),</i>&quot;"}, {"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 2, "creation_date": 1558529737, "post_id": 56256608, "comment_id": 99131091, "body": "@Chipster Hence the &quot;pre-C++20&quot; comment below."}, {"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1558529804, "post_id": 56256608, "comment_id": 99131142, "body": "@TedLyngmo This assumption is explicitly acknowledged by OP. <code>Under certain condition I know that the buffer returned by get() will contain properly aligned floating point buffer.</code>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1558530526, "post_id": 56256608, "comment_id": 99131643, "body": "Yes, ok, but what does <code>std::assume_aligned</code> really help with if you tell it to assume <code>float</code> alignment for something that has <code>float</code> alignment? What optimization could possibly be done with that information? It seems to only be useful when supplying an alignment that is bigger than what the original type requires. Not sure ..."}, {"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1558530722, "post_id": 56256608, "comment_id": 99131752, "body": "@TedLyngmo It has float alignment, but the compiler <i>doesn&#39;t know that</i>. It&#39;s essentially a static analysis helper."}, {"owner": {"reputation": 1995, "user_id": 4850111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c63534a6d43180d0d0636e5c3a26b8?s=128&d=identicon&r=PG&f=1", "display_name": "nada", "link": "https://stackoverflow.com/users/4850111/nada"}, "edited": false, "score": 0, "creation_date": 1558532809, "post_id": 56256608, "comment_id": 99133231, "body": "<i>&quot;Since C++20&quot;</i> sounds like we are in &gt;= 2020 :)"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 0, "creation_date": 1558536608, "post_id": 56256608, "comment_id": 99135694, "body": "@milleniumbug Shouldn&#39;t the compiler make the same assumption when you <code>reinterpret_cast&lt;float*&gt;</code>? It would be strange if it didn&#39;t since accessing the pointed to memory via the <code>float*</code> would also be UB if it wasn&#39;t aligned."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1558536929, "post_id": 56256608, "comment_id": 99135894, "body": "... and shouldn&#39;t it be: <code>float *f = std::assume_aligned&lt;alignof(float)&gt;(reinterpret_cast&lt;float*&gt;&zwnj;&#8203;(get()));</code>"}], "tags": [], "owner": {"reputation": 35010, "user_id": 703016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6daa32d7171f74efb1b663c6edc32e3b?s=128&d=identicon&r=PG&f=1", "display_name": "user703016", "link": "https://stackoverflow.com/users/703016/user703016"}, "is_accepted": false, "score": 3, "last_activity_date": 1558528545, "last_edit_date": 1558528545, "creation_date": 1558527396, "answer_id": 56256608, "question_id": 56256431, "link": "https://stackoverflow.com/questions/56256431/warning-cast-from-char-to-float-increases-required-alignment-from-1-to/56256608#56256608", "title": "warning: cast from &#39;char *&#39; to &#39;float *&#39; increases required alignment from 1 to 4 [-Wcast-align]", "body": "<p>I'd recommend against using C-style casts and favoring <code>reinterpret_cast</code> instead. This also has the nice property of getting rid of the warning.</p>\n\n<p>However, to answer your question proper:</p>\n\n<p>Since C++20 you can use <a href=\"https://en.cppreference.com/w/cpp/memory/assume_aligned\" rel=\"nofollow noreferrer\"><code>std::assume_aligned</code></a> like so:</p>\n\n<pre><code>extern char* get();\n\nvoid foo()\n{\n  float *f = (float*)std::assume_aligned&lt;alignof(float)&gt;(get());\n}\n</code></pre>\n\n<p>Pre C++20, you can also use non-portable compiler intrinsics:</p>\n\n<pre><code>extern char* get();\n\nvoid foo()\n{\n  float *f = (float*)__builtin_assume_aligned(get(), alignof(float));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11126, "user_id": 136285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/98d92168760c5b402a315926e4700d5f?s=128&d=identicon&r=PG", "display_name": "malat", "link": "https://stackoverflow.com/users/136285/malat"}, "edited": false, "score": 0, "creation_date": 1558528324, "post_id": 56256641, "comment_id": 99130248, "body": "Turns out this is actually the best answer, not ideal since I&#39;d like to have a keyword for the actual function. But changing the function signature to return <code>void*</code> will make sure user will actually read the documentation."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558529887, "post_id": 56256641, "comment_id": 99131207, "body": "Trouble is I see no evidence in the question that the warning is in any way wrong. Why is everybody recommending to inhibit it?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558531278, "post_id": 56256641, "comment_id": 99132161, "body": "@LightnessRacesinOrbit: OP has said in question: <i>Under certain condition I know that the buffer returned by get() will contain properly aligned floating point buffer</i>. As would do a kind compiler, I warn OP that he is responsible for alignment and strict aliasing respect, and I trust him to know what he does. <b>I</b> know, that if <code>get</code> returns a <code>malloc</code>-ed buffer, or a pointer to a float or an array of float, then it will be fine."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558532785, "post_id": 56256641, "comment_id": 99133209, "body": "@SergeBallesta They also said it comes from a <code>std::vector&lt;char&gt;</code>. Will that be okay?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558533371, "post_id": 56256641, "comment_id": 99133623, "body": "@LightnessRacesinOrbit: Close to an angels sex debate :-). It is certainly UB, but I had read some vector implementations and all of them use an allocated buffer for their data. So deep inside the internals of the standard library, the vector data buffer has no declared type and is properly aligned for any type. But I must admit I would not use that in production code!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558533658, "post_id": 56256641, "comment_id": 99133832, "body": "@SergeBallesta Okay no that makes sense actually"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558533717, "post_id": 56256641, "comment_id": 99133874, "body": "@LightnessRacesinOrbit: Anyway, I have edited my post to better reflect the question you raised."}, {"owner": {"reputation": 11126, "user_id": 136285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/98d92168760c5b402a315926e4700d5f?s=128&d=identicon&r=PG", "display_name": "malat", "link": "https://stackoverflow.com/users/136285/malat"}, "edited": false, "score": 0, "creation_date": 1558540184, "post_id": 56256641, "comment_id": 99137846, "body": "@SergeBallesta Thanks for the edit. I was under the impression that C++ standard requires allocation functions (malloc() and operator new()) to allocate memory suitably aligned for any standard type (eg. <code>float</code> or <code>double</code>). Since internally std::vector data are allocated, I do not understand you last (edited) comment."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 11126, "user_id": 136285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/98d92168760c5b402a315926e4700d5f?s=128&d=identicon&r=PG", "display_name": "malat", "link": "https://stackoverflow.com/users/136285/malat"}, "edited": false, "score": 0, "creation_date": 1558542550, "post_id": 56256641, "comment_id": 99139138, "body": "@malat: The problem is that as noticed by  LightnessRacesinOrbit, you can always store a float representation in the data member of a <code>vector&lt;char&gt;</code>, but using type punning to use it as a float is formally UB, even if most if not all implementations will allow it. The allocator is supposed to return a char array when ask to, but I do not think that it guarantees that the char array has no declared type."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1558533666, "last_edit_date": 1558533666, "creation_date": 1558527491, "answer_id": 56256641, "question_id": 56256431, "link": "https://stackoverflow.com/questions/56256431/warning-cast-from-char-to-float-increases-required-alignment-from-1-to/56256641#56256641", "title": "warning: cast from &#39;char *&#39; to &#39;float *&#39; increases required alignment from 1 to 4 [-Wcast-align]", "body": "<p>Warnings are just messages from the compiler to warn the programmer (you) that something is suspect. In the general case, converting from a <code>char *</code> to a <code>float *</code> can cause alignment problems hence the warning.</p>\n\n<p>If you know that in your use case, no alignment problem will ever occur and that strict aliasing is not a problem either, then you can safely ignore the warning. Be sure to leave a comment in the code for future maintainers not to worry about that warning at that place.</p>\n\n<p>After reading again last line of your question, I would not rely on using the data buffer of a <code>vector&lt;char&gt;</code> for that usage. At least you should use a <code>vector&lt;float&gt;</code>: by definition it can contain floats, and it is always safe to access any type (here an array or floats) as a char array.</p>\n"}], "owner": {"reputation": 11126, "user_id": 136285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/98d92168760c5b402a315926e4700d5f?s=128&d=identicon&r=PG", "display_name": "malat", "link": "https://stackoverflow.com/users/136285/malat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1558533666, "creation_date": 1558526731, "last_edit_date": 1558527546, "question_id": 56256431, "link": "https://stackoverflow.com/questions/56256431/warning-cast-from-char-to-float-increases-required-alignment-from-1-to", "title": "warning: cast from &#39;char *&#39; to &#39;float *&#39; increases required alignment from 1 to 4 [-Wcast-align]", "body": "<p>Is there a way for me to use the c++11 keyword <a href=\"https://en.cppreference.com/w/cpp/language/alignas\" rel=\"nofollow noreferrer\">alignas</a> to decorate the function <code>get()</code>. Under certain condition I know that the buffer returned by <code>get()</code> will contain properly aligned floating point buffer.</p>\n\n<p>Code:</p>\n\n<pre><code>$ cat c.cxx\nextern char* get();\n\nvoid foo()\n{\n  float *f = (float*)get();\n}\n</code></pre>\n\n<p>leads to</p>\n\n<pre><code>$ clang++-8 -Wcast-align -c c.cxx\nc.cxx:5:14: warning: cast from 'char *' to 'float *' increases required alignment from 1 to 4 [-Wcast-align]\n  float *f = (float*)get();\n             ^~~~~~~~~~~~~\n1 warning generated.\n</code></pre>\n\n<p>For reference the function <code>char* get()</code>, simply return <code>&amp;v[0]</code> of a <code>std::vector&lt;char&gt;</code> which depending of the internal type may contains a byte buffer or a float buffer (variant).</p>\n"}, {"tags": ["c++", "algorithm", "std", "stdvector"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558524974, "post_id": 56255725, "comment_id": 99128486, "body": "So by &quot;both&quot; you really mean &quot;either&quot;?"}, {"owner": {"reputation": 193, "user_id": 3881394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LirL1.jpg?s=128&g=1", "display_name": "Approachable", "link": "https://stackoverflow.com/users/3881394/approachable"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558525442, "post_id": 56255725, "comment_id": 99128756, "body": "@LightnessRacesinOrbit yes"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558525836, "post_id": 56255725, "comment_id": 99128947, "body": "We don&#39;t need the accepted answer in the question; it&#39;s right there below, in the answer section, accepted :)"}], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 6, "last_activity_date": 1558524827, "last_edit_date": 1558524827, "creation_date": 1558524521, "answer_id": 56255834, "question_id": 56255725, "link": "https://stackoverflow.com/questions/56255725/how-to-find-stdmax-element-on-stdvectorstdpairint-int-in-either-of-th/56255834#56255834", "title": "How to find std::max_element on std::vector&lt;std::pair&lt;int, int&gt;&gt; in either of the axis?", "body": "<p>You need provide predicate which will define \"less\" relation for your items:</p>\n\n<pre><code>const auto p = std::minmax_element(\n        edges.begin(), edges.end(),\n        [](const auto&amp; a, const auto&amp; b) {\n    // provide relation less you need, example:\n    return std::max(a.first, a.second) &lt; std::max(b.first, b.second);\n});\n</code></pre>\n\n<p>By default (in your code) less operator is used. For <code>std::pair</code> it works in lexicographical ordering of elements (if first elements are less returns true if they are equal checks <code>second</code> elements if the are less).</p>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 3881394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LirL1.jpg?s=128&g=1", "display_name": "Approachable", "link": "https://stackoverflow.com/users/3881394/approachable"}, "edited": false, "score": 1, "creation_date": 1558526871, "post_id": 56255889, "comment_id": 99129526, "body": "Just a small syntax issue add the ); at the end of the first line. And thanks for the solution."}], "tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": true, "score": 9, "last_activity_date": 1558528006, "last_edit_date": 1558528006, "creation_date": 1558524660, "answer_id": 56255889, "question_id": 56255725, "link": "https://stackoverflow.com/questions/56255725/how-to-find-stdmax-element-on-stdvectorstdpairint-int-in-either-of-th/56255889#56255889", "title": "How to find std::max_element on std::vector&lt;std::pair&lt;int, int&gt;&gt; in either of the axis?", "body": "<p>Use <a href=\"https://en.cppreference.com/w/cpp/algorithm/max_element\" rel=\"noreferrer\">std::max_element</a> with a custom compare function, something like:</p>\n\n<pre><code>auto max_pair = *std::max_element(std::begin(edges), std::end(edges), \n    [](const auto&amp; p1, const auto&amp; p2) {\n        return std::max(p1.first, p1.second) &lt; std::max(p2.first, p2.second);\n    });\nint max = std::max(max_pair.first, max_pair.second);\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3881394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LirL1.jpg?s=128&g=1", "display_name": "Approachable", "link": "https://stackoverflow.com/users/3881394/approachable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 56255889, "answer_count": 2, "score": 7, "last_activity_date": 1558536181, "creation_date": 1558524133, "last_edit_date": 1558536181, "question_id": 56255725, "link": "https://stackoverflow.com/questions/56255725/how-to-find-stdmax-element-on-stdvectorstdpairint-int-in-either-of-th", "title": "How to find std::max_element on std::vector&lt;std::pair&lt;int, int&gt;&gt; in either of the axis?", "body": "<p>How do i find the max element in this pair <code>std::vector&lt;std::pair&lt;int, int&gt;&gt;</code> in either of the axis.</p>\n\n<p>Let this be the sample pair:</p>\n\n<pre><code>0, 1\n0, 2\n1, 1\n1, 2\n1, 4\n2, 2\n3, 1\n</code></pre>\n\n<p>I tried using <a href=\"https://en.cppreference.com/w/cpp/algorithm/minmax_element\" rel=\"nofollow noreferrer\"><code>std::minmax_element()</code></a>:</p>\n\n<pre><code>const auto p = std::minmax_element(edges.begin(), edges.end());\nauto max = p.second-&gt;first;\n</code></pre>\n\n<p>But this generates the max element only of the first column i.e <code>3</code>, but i want the max element of either the columns i.e <code>4</code>.</p>\n\n<p>I want the max element to be the highest element of either the columns.</p>\n"}]