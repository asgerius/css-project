[{"tags": ["c++", "macos", "clion", "ogre", "dyld"], "comments": [{"owner": {"reputation": 2211, "user_id": 8258079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hGor17Y5EI/AAAAAAAAAAI/AAAAAAAAAMM/imoWXkV2oCM/photo.jpg?sz=128", "display_name": "Richard Barber", "link": "https://stackoverflow.com/users/8258079/richard-barber"}, "edited": false, "score": 0, "creation_date": 1553760158, "post_id": 55388144, "comment_id": 97505926, "body": "Can you resolve the @executable_path/../Frameworks and check if the dylib is in there?"}, {"owner": {"reputation": 33, "user_id": 1470514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E2Etm.jpg?s=128&g=1", "display_name": "dcordonu", "link": "https://stackoverflow.com/users/1470514/dcordonu"}, "reply_to_user": {"reputation": 2211, "user_id": 8258079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hGor17Y5EI/AAAAAAAAAAI/AAAAAAAAAMM/imoWXkV2oCM/photo.jpg?sz=128", "display_name": "Richard Barber", "link": "https://stackoverflow.com/users/8258079/richard-barber"}, "edited": false, "score": 0, "creation_date": 1554031036, "post_id": 55388144, "comment_id": 97597011, "body": "@executable_path resolves as the folder in which the compiled program is executed, which in my case is <code>&#47;Users&#47;diego&#47;CLionProjects&#47;ogre&#47;sample&#47;cmake-build-debug</code>. The library however is located in <code>&#47;opt&#47;Ogre3D&#47;ogre-1.11.5&#47;build&#47;lib&#47;macosx&#47;OgreBites.framework&zwnj;&#8203;&#47;Versions&#47;1.11.5</code> which is a different folder. Using <code>install_name_tool -change @executable_path&#47;..&#47;Frameworks&#47;OgreBites.framework&#47;Versions&#47;&zwnj;&#8203;1.11.5&#47;OgreBites &#47;opt&#47;Ogre3D&#47;ogre-1.11.5&#47;build&#47;lib&#47;macosx&#47;OgreBites.framework&zwnj;&#8203;&#47;Versions&#47;1.11.5&#47;Ogr&zwnj;&#8203;eBites sample</code> fixes the problem but then it fails with the next library."}], "owner": {"reputation": 33, "user_id": 1470514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E2Etm.jpg?s=128&g=1", "display_name": "dcordonu", "link": "https://stackoverflow.com/users/1470514/dcordonu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1554031392, "creation_date": 1553730408, "last_edit_date": 1554031392, "question_id": 55388144, "link": "https://stackoverflow.com/questions/55388144/dyld-not-loading-ogre-library", "title": "dyld not loading Ogre library", "body": "<p>I am trying to setup an environment to develop an Ogre3D application. I have manually compiled Ogre into folder <code>/opt/Ogre3D/ogre-1.11.5/build</code> and created a CMake project in CLion with this content:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.13)\nproject(sample)\n\nset(CMAKE_CXX_STANDARD 14)\nset(OGRE_DIR /opt/Ogre3D/ogre-1.11.5/build/sdk/cmake)\n\n# specify which version and components you need\nfind_package(OGRE 1.11 REQUIRED COMPONENTS Bites RTShaderSystem)\n\n# copy resource.cfg next to our binaries where OGRE looks for it\nfile(COPY ${OGRE_CONFIG_DIR}/resources.cfg DESTINATION ${CMAKE_BINARY_DIR})\n\nadd_executable(sample main.cpp)\ntarget_link_libraries(sample ${OGRE_LIBRARIES})\n\n</code></pre>\n\n<p>when I try to run it, compilation is OK but then it can't execute it:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>/Users/diego/CLionProjects/ogre/sample/cmake-build-debug/sample\ndyld: Library not loaded: @executable_path/../Frameworks/OgreBites.framework/Versions/1.11.5/OgreBites\n  Referenced from: /Users/diego/CLionProjects/ogre/sample/cmake-build-debug/sample\n  Reason: image not found\n\nProcess finished with exit code 6\n</code></pre>\n\n<p>I have looked at <code>otool -l /opt/Ogre3D/ogre-1.11.5/build/lib/macosx/OgreBites.framework/Versions/1.11.5/OgreBites</code> and there is a command <code>LC_ID_DYLIB</code> with the name <code>@executable_path/../Frameworks/OgreBites.framework/Versions/1.11.5/OgreBites</code>, which matches the path given in the runtime error. However I don't know which step to take now as I have few experience with native library resolution on macOS.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Executing the command <code>install_name_tool</code> makes the linker find the library, but then it fails with the next one. I suppose/hope there is an option in CMake to pass it to the compiler so the binary files created during Ogre's compilation do not use the <code>@execute_path</code> directive?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1553729842, "post_id": 55388070, "comment_id": 97497944, "body": "Hint: what&#39;s the maximum index you can use in a vector with <code>n</code> elements?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1553730094, "post_id": 55388070, "comment_id": 97497994, "body": "You will find that &quot;practice problems&quot; <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">from a good C++ book</a> will be far more useful, and informative."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1553730748, "post_id": 55388088, "comment_id": 97498179, "body": "Sidenote: The <code>std::vector::at</code> function does the bounds checking JMAA is talking about. Yes it is slower, but when debugging, it&#39;s worth the hit if you suspect you could be going out of bounds. <code>sumB += arr.at(n-i).at(n-i);</code> would throw an exception, you&#39;d find the bug, and once you&#39;re sure you have fixed the problem, you switch back to using operator <code>[]</code> (if you need the speed)."}], "tags": [], "owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "is_accepted": false, "score": 2, "last_activity_date": 1553729818, "creation_date": 1553729818, "answer_id": 55388088, "question_id": 55388070, "link": "https://stackoverflow.com/questions/55388070/how-to-fix-segmentation-fault-compiler-message/55388088#55388088", "title": "How to fix: &quot;Segmentation Fault&quot; compiler message?", "body": "<p>In C++ <code>std::vector</code>s (and almost everything else) are 0-indexed. So if a vector contains <code>n</code> elements, valid indices are <code>0</code> through to <code>n-1</code>. In your line </p>\n\n<pre><code>sumB += arr[n-i][n-i];\n</code></pre>\n\n<p>On the first iteration, <code>i</code> is 0. Therefore you're accessing <code>arr[n][n]</code>, both indices are out of range, hence the segmentation fault.</p>\n\n<hr>\n\n<p>Some other advice:</p>\n\n<ul>\n<li><p>\"segmentation fault\" is not a compiler error (unless you're colossally unlucky or trying very hard), it's a runtime error.</p></li>\n<li><p>\"segmentation fault\" means, basically, that you're trying to access or change some memory location you shouldn't be. Probably the most common is because you have a collection (vector, array, or similar) and you're using an out-of-range index (exactly your problem here).</p></li>\n<li><p>C++ generally takes the attitude that things, correctly coded, should run as fast as they possibly can. Therefore, things like vector index checks aren't performed (because they'd slow things down slightly if the code were correct). This is why ugly and often hard-to-debug \"segmentation faults\" are relatively common.</p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 10857753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eBgMY.png?s=128&g=1", "display_name": "Willever", "link": "https://stackoverflow.com/users/10857753/willever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553729818, "creation_date": 1553729631, "question_id": 55388070, "link": "https://stackoverflow.com/questions/55388070/how-to-fix-segmentation-fault-compiler-message", "title": "How to fix: &quot;Segmentation Fault&quot; compiler message?", "body": "<p>I'm new to c++ and I was trying to solve a c++ practise problem on hacker rank. After compiling I got the compiler message \"Segmentation Fault\" when trying to get the absolute difference between the sums of the two diagonals in a square matrix.</p>\n\n<p>I have narrowed down the problem to line 8 but I don't know how to solve it.</p>\n\n<pre><code>int diagonalDifference(vector&lt;vector&lt;int&gt;&gt; arr) {\n    int sumA,sumB;\n    int n = arr.size();\n    for (int i=0;i&lt;n;++i) {\n        sumA += arr[i][i];\n        sumB += arr[n-i][n-i];\n    }\n    return abs(sumA - sumB);\n}\n</code></pre>\n\n<p>I expect the output to be an absolute difference between the sum of the two diagonals in a square matrix.</p>\n"}, {"tags": ["c++", "oop", "data-structures", "idioms"], "comments": [{"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553731448, "post_id": 55388069, "comment_id": 97498327, "body": "have you considered using an <code>operator[]</code> overload to abstract away the interactions, and smart pointers for the connections? Smart pointers could also deal with the multiple NodeRef objects problem."}, {"owner": {"reputation": 51182, "user_id": 1468366, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2e313135581cf6ceaad355580af931f8?s=128&d=identicon&r=PG", "display_name": "MvG", "link": "https://stackoverflow.com/users/1468366/mvg"}, "reply_to_user": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553731910, "post_id": 55388069, "comment_id": 97498450, "body": "@Tzalumen: Smart pointers are inherently tricky when there is no clear ownership, which is the case with most linked data structures that are not trees. Main benefit of smart pointers is decent RAII-based cleanup, but cleanup is not even one of the problems with pointers I listed, so all the issues I listed would still apply to smart pointers. Not sure how you&#39;d use the <code>operator[]</code> here. Defining it on <code>LinkedList</code> to construct a <code>NodeRef</code> could make the abstracting code simpler to read but would not affect the question at hand since the redundant reference would still be there."}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553785071, "post_id": 55388069, "comment_id": 97521968, "body": "Have you looked at <code>std::weak_ptr</code> and <code>std::shared_from_this</code>? <code>weak_ptr</code> is for final pointers in a cycle, and <code>shared_from_this</code> gives you an easy way to enforce shared ownership by multiple <code>NodeRef</code> referencing the same <code>LinkedList</code>."}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553785233, "post_id": 55388069, "comment_id": 97522083, "body": "For a separate question, is there a reason you&#39;re not just using a <code>std::list</code> instead of rolling your own?"}], "answers": [{"tags": [], "owner": {"reputation": 1029, "user_id": 7878485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15dabd902549f21699b86daa04ecaeed?s=128&d=identicon&r=PG&f=1", "display_name": "nitronoid", "link": "https://stackoverflow.com/users/7878485/nitronoid"}, "is_accepted": false, "score": 1, "last_activity_date": 1553732097, "creation_date": 1553732097, "answer_id": 55388360, "question_id": 55388069, "link": "https://stackoverflow.com/questions/55388069/oop-interface-when-using-indices-for-links/55388360#55388360", "title": "OOP interface when using indices for links", "body": "<p>You could require that <code>LinkedList</code> be supplied when you want to act on a <code>NodeRef</code>, and then have an accessing object or a lambda which stores your single reference and wraps calls to the <code>NodeRef</code>.</p>\n\n<p>For example to remove nodes from the list you could use:</p>\n\n<pre><code>struct NodeRef\n{\n  int i;\n  // LinkedList&amp; l;  // Remove this\n  NodeRef(int index) : i(index) {}\n  NodeRef prev(LinkedList&amp; l) const;\n  NodeRef next(LinkedList&amp; l) const;\n  void remove(LinkedList&amp; l);\n};\n// Require that a list is supplied instead of storing a ref\nvoid NodeRef::remove(LinkedList&amp; l)\n{\n  Node&amp; n = l.nodes[i];\n  l.nodes[n.next].prev = n.prev;\n  l.nodes[n.prev].next = n.next;\n}\n\n// create a lambda with a captured list that wraps the call\nLinkedList linkedList;\n//...\nauto remover = [&amp;linkedList](NodeRef node)\n{\n  node.remove(linkedList);\n};\n//...\nNodeRef nodeRef(0);\nremover(nodeRef);\n</code></pre>\n\n<p>Not sure if this is what you want, but it avoids multiple references to the list and could allow reuse of the <code>NodeRef</code> objects.</p>\n"}, {"tags": [], "owner": {"reputation": 1029, "user_id": 7878485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15dabd902549f21699b86daa04ecaeed?s=128&d=identicon&r=PG&f=1", "display_name": "nitronoid", "link": "https://stackoverflow.com/users/7878485/nitronoid"}, "is_accepted": false, "score": 0, "last_activity_date": 1553735474, "creation_date": 1553735474, "answer_id": 55388750, "question_id": 55388069, "link": "https://stackoverflow.com/questions/55388069/oop-interface-when-using-indices-for-links/55388750#55388750", "title": "OOP interface when using indices for links", "body": "<p>Another option could be using templates to store a static pointer to the list, shared between all derived classes. Using different int's to differentiate your lists and <code>NodeRef</code>'s. You're forced to manage those ints at compile time so again, probably not ideal, but it does solve the multiple reference issue.</p>\n\n<pre><code>#include &lt;vector&gt;\n\ntemplate &lt;int X&gt;\nstruct LinkedList;\n\ntemplate &lt;int X&gt;\nstruct NodeRef\n{\n  static LinkedList&lt;X&gt;* l;\n  int i;\n  NodeRef(int index) : i(index) {}\n  NodeRef prev() const;\n  NodeRef next() const;\n  void remove();\n};\n\nstruct Node { int prev, next; };\n\ntemplate &lt;int X&gt;\nstruct LinkedList \n{\n  LinkedList() \n  {\n      NodeRef&lt;X&gt;::l = this;\n  }\n  std::vector&lt;Node&gt; nodes;\n  NodeRef&lt;X&gt; root() { return NodeRef&lt;X&gt;(0); }\n};\n\n\n// Use the static pointer\ntemplate&lt;int X&gt;\nvoid NodeRef&lt;X&gt;::remove()\n{\n  auto&amp; l = *NodeRef&lt;X&gt;::l;\n  Node&amp; n = l.nodes[i];\n  l.nodes[n.next].prev = n.prev;\n  l.nodes[n.prev].next = n.next;\n}\n\n\n\nint main()\n{\n    LinkedList&lt;0&gt; linkedList;\n\n    // All node refs templated by 0 share the list pointer\n    auto nodeRef = linkedList.root();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "is_accepted": false, "score": 0, "last_activity_date": 1553863823, "creation_date": 1553863823, "answer_id": 55417814, "question_id": 55388069, "link": "https://stackoverflow.com/questions/55388069/oop-interface-when-using-indices-for-links/55417814#55417814", "title": "OOP interface when using indices for links", "body": "<p>You could make all <code>LinkedList</code>s share one pool of <code>Node</code>s:</p>\n\n<pre><code>struct LinkedList {\n  static std::vector&lt;Node&gt; nodes; // &lt;-- static\n  void remove(int i) {\n    Node&amp; n = nodes[i];\n    nodes[n.next].prev = n.prev;\n    nodes[n.prev].next = n.next;\n  }\n};\n</code></pre>\n\n<p>This way, for a <code>NodeRef</code> the index alone is fully sufficient to identify the referenced <code>Node</code>.</p>\n\n<p>Note however, that depending on how frequently <code>LinkedList</code>s and <code>Node</code>s are created, modified, and destroyed, you may get performance issues here due to cache misses because <code>Node</code>s that are neighbors in a list may not be neighbors at all in memory.\nThis issue may exist with your current approach already. In that case a global <code>Node</code> pool will make it even worse.</p>\n\n<p>Also, if you have a multi-threaded application, you will have to perform the usual locking mechanisms which will slow down your app even more.</p>\n"}], "owner": {"reputation": 51182, "user_id": 1468366, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2e313135581cf6ceaad355580af931f8?s=128&d=identicon&r=PG", "display_name": "MvG", "link": "https://stackoverflow.com/users/1468366/mvg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1553863823, "creation_date": 1553729622, "question_id": 55388069, "link": "https://stackoverflow.com/questions/55388069/oop-interface-when-using-indices-for-links", "title": "OOP interface when using indices for links", "body": "<p>TL;DR: I have a linked data structure, and I decide to use not pointers but indices into a container to express these links. Can I model the individual elements as stand-alone objects for the sake of more readable code without incurring the cost for keeping multiple references to the array?</p>\n\n<hr>\n\n<p>Suppose I have a linked data structure. For the sake of simplicity, let's use a doubly linked list as an example, with an operation to remove a node. Classical way to model this would be using pointers:</p>\n\n<pre><code>struct Node {\n  Node *prev, *next;\n  void remove() { next-&gt;prev = prev; prev-&gt;next = next; }\n};\n</code></pre>\n\n<p>But pointers have a number of drawbacks. They may waste space since pointer size usually can't be chosen to match the use case. They make for a poor wire format. If I keep the nodes in a vector, resizing that may invalidate pointers. Copying the data structures becomes harder. So I could go for indices into some array instead:</p>\n\n<pre><code>struct Node {\n  int prev, next;\n};\nstruct LinkedList {\n  std::vector&lt;Node&gt; nodes;\n  void remove(int i) {\n    Node&amp; n = nodes[i];\n    nodes[n.next].prev = n.prev;\n    nodes[n.prev].next = n.next;\n  }\n};\n</code></pre>\n\n<p>But now the operation that was previously a method of the individual node has become a method of the container class. That semantic shift makes some code harder to read. To avoid that problem, I could go for a representation based on the pair of container and node index.</p>\n\n<pre><code>struct Node { int prev, next; };\nstruct LinkedList;\nstruct NodeRef {\n  int i;\n  LinkedList&amp; l;  // This reference here is what's worrying me\n  NodeRef(int index, LinkedList&amp; list) : i(index), l(list) {}\n  NodeRef prev() const;\n  NodeRef next() const;\n  void remove();\n};\nstruct LinkedList {\n  std::vector&lt;Node&gt; nodes;\n  NodeRef root() { return NodeRef(0, *this); }\n};\nNodeRef NodeRef::prev() const { return NodeRef(l.nodes[i].prev, l); }\nNodeRef NodeRef::next() const { return NodeRef(l.nodes[i].next, l); }\nvoid NodeRef::remove() {\n  Node&amp; n = l.nodes[i];\n  l.nodes[n.next].prev = n.prev;\n  l.nodes[n.prev].next = n.next;\n}\n</code></pre>\n\n<p>So now I can use NodeRef to express my algorithm in a nicely object-oriented manner, with the node as an entity I can iteract with, while at the same time using indices instead of pointers behind the scenes.</p>\n\n<p>But when I have some complicated algorithm operating with multiple nodes at the same time, then I'd have multiple NodeRef objects all referencing the same underlying LinkedList object. That feels kind of wasteful, both in terms of memory consumption and work to copy them. I would <em>guess</em> that a compiler <em>might</em> be able to detect some of that redundancy and get rid of it. But is there anything I could do to help it, to ensure that this will get optimized to only use a single reference even though semantically I have multiple?</p>\n"}, {"tags": ["c++", "dictionary"], "comments": [{"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553728336, "post_id": 55387833, "comment_id": 97497532, "body": "Creating a copy of what? It seems that your <code>SOR</code> type is probably an alias of <code>long64</code>, which is probably a <code>int64_t</code> or similar. Therefore, the both key and value of your <code>map</code> are simple value types (some sort of integer, and a raw pointer). There is no functional difference between copy and move for simple value types."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1553728370, "post_id": 55387833, "comment_id": 97497538, "body": "Can you think of a simple experiment that would answer your question?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553728535, "post_id": 55387833, "comment_id": 97497584, "body": "Unrelated: <code>kPartBase&amp; part</code> isn&#39;t shouting &quot;I have a long lifetime!&quot; at me, so I&#39;ll drop a reminder to make sure <code>part</code> isn&#39;t an variable with a shorter lifetime (like an Automatic) than <code>Parts</code>."}, {"owner": {"reputation": 127, "user_id": 10826121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cMQw7ELRuk/AAAAAAAAAAI/AAAAAAAAACQ/lB4jTdi0goI/photo.jpg?sz=128", "display_name": "xX_EASY HD LP MC AWP GOD_Xx", "link": "https://stackoverflow.com/users/10826121/xx-easy-hd-lp-mc-awp-god-xx"}, "reply_to_user": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553728783, "post_id": 55387833, "comment_id": 97497662, "body": "@JMAA yeah SOR is an alias. I was scared that it would copy the variable part"}, {"owner": {"reputation": 127, "user_id": 10826121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cMQw7ELRuk/AAAAAAAAAAI/AAAAAAAAACQ/lB4jTdi0goI/photo.jpg?sz=128", "display_name": "xX_EASY HD LP MC AWP GOD_Xx", "link": "https://stackoverflow.com/users/10826121/xx-easy-hd-lp-mc-awp-god-xx"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553728846, "post_id": 55387833, "comment_id": 97497680, "body": "@user4581301 Dont worry, part will be destroyed if the object is"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553729109, "post_id": 55387833, "comment_id": 97497756, "body": "I&#39;m not worried about <code>part</code> NOT being destroyed. I&#39;m worried about it being destroyed while <code>Parts</code> still holds a pointer to it."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1553729647, "post_id": 55387833, "comment_id": 97497885, "body": "@user4581301 &quot;<i>I&#39;m worried about it being destroyed while <code>Parts</code> still holds a pointer to it</i>&quot; - then you should be managing the object&#39;s lifetime using a smart pointer. Either <code>std::unique_ptr</code> or <code>std::shared_ptr</code>. Probably the latter in your case, but hard to tell for sure since you didn&#39;t show how the map is populated or used. You can store smart pointers in a <code>std::map</code>."}, {"owner": {"reputation": 127, "user_id": 10826121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cMQw7ELRuk/AAAAAAAAAAI/AAAAAAAAACQ/lB4jTdi0goI/photo.jpg?sz=128", "display_name": "xX_EASY HD LP MC AWP GOD_Xx", "link": "https://stackoverflow.com/users/10826121/xx-easy-hd-lp-mc-awp-god-xx"}, "edited": false, "score": 0, "creation_date": 1553729831, "post_id": 55387833, "comment_id": 97497940, "body": "The map is part of an element called kFixedConstruct - they exists in a hierachical tree - only when a FixedConstruct is deleted all its parts and the map are deleted , and ive build in some nullptr checks. Maybe shared ptr is a good idea but dont know how it works :/"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1553730273, "post_id": 55387833, "comment_id": 97498043, "body": "I&#39;ll take you at your word that you have the lifetime covered, but don&#39;t count on null pointer checks to find dangling pointers. Pointers only go one way; there is no back channel to set them to null if their target goes away."}, {"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553730307, "post_id": 55387833, "comment_id": 97498049, "body": "If an object is deleted, pointers to it are not set to <code>nullptr</code>. It seems like you need to go and read up on a good introduction to C++ pointers, as much of what you&#39;re saying suggests deep misunderstandings of what they are and how they work."}, {"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553730459, "post_id": 55387833, "comment_id": 97498094, "body": "&quot;Maybe shared ptr is a good idea but dont know how it works&quot; - it looks like you&#39;re also not clear on how raw pointers work. <code>shared_ptr</code> and <code>unique_ptr</code> are much safer, especially if you&#39;re not entirely sure how they work."}], "answers": [{"comments": [{"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553729126, "post_id": 55387982, "comment_id": 97497763, "body": "While technically correct (and solid advice), I suspect that OP was concerned that the object pointed at by the reference <code>part</code> would be copied, which it wont."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 1, "last_activity_date": 1553728981, "creation_date": 1553728981, "answer_id": 55387982, "question_id": 55387833, "link": "https://stackoverflow.com/questions/55387833/is-stdmake-pair-creating-copies-when-the-objects-are-added-to-a-map/55387982#55387982", "title": "Is std::make_pair creating copies when the objects are added to a map?", "body": "<p>There will be several copies of your data.  To see them all, lets break this down into individual steps.</p>\n\n<p>First we create a pair from your two values:</p>\n\n<pre><code>std::pair&lt;SOR, kPartBase*&gt; first(static_cast&lt;long64&gt;(part.SorID), &amp;part);\n</code></pre>\n\n<p>Then, since this isn't the right type for <code>map::insert</code>, we copy them again to a different variable:</p>\n\n<pre><code>std::pair&lt;const SOR, kPartBase*&gt; second(first);\n</code></pre>\n\n<p>because a map::value_type has a const key value.   This copy can be avoided by using</p>\n\n<pre><code>Partlist::value_type(static_cast&lt;long64&gt;(part.SorID), &amp;part)\n</code></pre>\n\n<p>in place of <code>make_pair</code>.  This pair (<code>second</code>) will be copied into your map.</p>\n\n<p>Or you can use</p>\n\n<pre><code>Parts.emplace(static_cast&lt;long64&gt;(part.SorID), &amp;part);\n</code></pre>\n\n<p>(or <code>try_emplace</code>) and avoid all but the copy needed to put the values into the map.</p>\n"}], "owner": {"reputation": 127, "user_id": 10826121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cMQw7ELRuk/AAAAAAAAAAI/AAAAAAAAACQ/lB4jTdi0goI/photo.jpg?sz=128", "display_name": "xX_EASY HD LP MC AWP GOD_Xx", "link": "https://stackoverflow.com/users/10826121/xx-easy-hd-lp-mc-awp-god-xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "accepted_answer_id": 55387982, "answer_count": 1, "score": 1, "last_activity_date": 1553728981, "creation_date": 1553728060, "question_id": 55387833, "link": "https://stackoverflow.com/questions/55387833/is-stdmake-pair-creating-copies-when-the-objects-are-added-to-a-map", "title": "Is std::make_pair creating copies when the objects are added to a map?", "body": "<p>my problem is that i want to add something to map:</p>\n\n<p>I dont know if std make pair is creating copies of the obejct? It should only add the pointer to the map and should create a copy of the long64 SOR. \nIm using pointers because references are not working!</p>\n\n<p><code>typedef std::map&lt;SOR, kPartBase*&gt; Partlist; //the map</code></p>\n\n<pre><code>void kFixedConstruct::push_part(kPartBase&amp; part)\n{\n    Parts.insert(std::make_pair&lt;SOR, kPartBase*&gt;(static_cast&lt;long64&gt;(part.SorID), &amp;part)); //Is this like really inserting the pointers to the originals or is it creating a copy?\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "reverse", "allocation"], "comments": [{"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553728586, "post_id": 55387804, "comment_id": 97497597, "body": "Welcome to stackoverflow! People are happy to answer specific programming questions here that you have made some effort to solve yourself and present in a easily understood way. People are very unlikely to respond positively to a dump of code and a &quot;please find my problem&quot;. Please close this question, narrow down exactly what you don&#39;t understand, and ask a new specific question on that if you are still stuck."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1553728614, "post_id": 55387804, "comment_id": 97497609, "body": "Both of your <code>search</code> functions have Undefined Behavior."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1553728902, "post_id": 55387804, "comment_id": 97497696, "body": "<code>head = tail = new listrec2&lt;T&gt;; </code> OK. <code>head-&gt;value = s[0];</code> Maybe this is a good idea. Need to keep reading. <code>head = NULL;</code> Why? You just allocated and set up <code>head</code>. Why nuke it?"}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1553732912, "post_id": 55387804, "comment_id": 97498675, "body": "This line does not look good: ` head2 = tail = new listrec2&lt;T&gt;; // make a new node` Probably want tail2?"}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1553733256, "post_id": 55387804, "comment_id": 97498743, "body": "Seems like you need to separate your logic:  you need one function to create your linked-list and a separate funciton for searching it.  You have mixed them together, which means you will create the linked-list when you are searching, which is counter-intuitive."}, {"owner": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "edited": false, "score": 0, "creation_date": 1553733744, "post_id": 55387804, "comment_id": 97498841, "body": "Well I needed one to show it reversed and another one to show it non-reversed. Should I create the linked list in a third function?"}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1553734547, "post_id": 55387804, "comment_id": 97499022, "body": "yes!  That would divide the problem a little better."}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1553734667, "post_id": 55387804, "comment_id": 97499049, "body": "Have you learned about passing arguments by reference?"}, {"owner": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "edited": false, "score": 0, "creation_date": 1553736711, "post_id": 55387804, "comment_id": 97499465, "body": "Yes I have should I use it for the third function?"}], "answers": [{"tags": [], "owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "is_accepted": true, "score": 0, "last_activity_date": 1553737463, "creation_date": 1553737463, "answer_id": 55388974, "question_id": 55387804, "link": "https://stackoverflow.com/questions/55387804/displays-reverse-order-but-not-the-non-reverse-order-c/55388974#55388974", "title": "Displays reverse order but not the non-reverse order c++", "body": "<p>Here is one way of doing it with a create_list, search_up, search_down, and destory_list functions.  I try to use variable names that are more descriptive.  I do not like <code>listrec2</code> because it is very confusing.  It makes me think of the second node, but that is not what it is.  It is a node type.</p>\n\n<p>Also, it is a good habbit to capitalize your types (e.g. Node).  Then, you can use the lowercase version for the object (e.g. Node node;)</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n// of linked list in reverse order\n\n// Structure of a Node\n\ntemplate&lt;class T&gt;\nstruct Node {\n    T value; //corresponds to data\n    Node *next; //points to next Node\n    Node *prev; //points to previous nod\n};\n\ntemplate&lt;typename T&gt;\nvoid CreateList(Node&lt;T&gt; *&amp;head, Node&lt;T&gt; *&amp;tail, T value_array[], int array_size)\n{\n\n  head = nullptr;\n  tail = nullptr;\n\n  for (int i = 0; i &lt; array_size; i++) {\n    // Create new node and add node to the end of the list\n    Node&lt;T&gt; *node = new Node&lt;T&gt;();\n\n    node-&gt;next = nullptr;\n    node-&gt;prev = tail;\n    if (head == nullptr) {\n      head = tail = node;\n    } else {\n      tail-&gt;next = node;\n      tail = node;\n    }\n    node-&gt;value = value_array[i];\n\n  }\n}\n\ntemplate&lt;class T&gt;\nvoid downwardSearch(Node&lt;T&gt; *head)\n//traverse from start of linked list to end of linked list\n//print out value of each Node along way\n{\n\n  Node&lt;T&gt; *ptr = head;\n  cout &lt;&lt; \"The array in forward order: \" &lt;&lt; endl;\n  while (ptr != nullptr) {\n    cout &lt;&lt; ptr-&gt;value;\n    ptr = ptr-&gt;next;\n\n  }\n}\n\ntemplate&lt;class T&gt;\nvoid DestroyList(Node&lt;T&gt; *head)\n{\n  Node&lt;T&gt; *ptr;\n\n  while (head != nullptr) {\n    ptr = head-&gt;next;\n    delete head;\n    head = ptr;\n  }\n}\n\ntemplate&lt;class T&gt;\nvoid upwardSearch(Node&lt;T&gt; *tail)\n{\n\n  Node&lt;T&gt; *ptr = tail;\n\n  cout &lt;&lt; \"The array in reverse order or backwards: \" &lt;&lt; endl;\n  while (ptr != nullptr) {\n    cout &lt;&lt; ptr-&gt;value;\n    ptr = ptr-&gt;prev;\n  }\n  cout &lt;&lt; endl;\n}\n\nint main()\n{\n  char s[] = {'c', 'd', 'e'};\n\n  Node&lt;char&gt; *head;\n  Node&lt;char&gt; *tail;\n\n  CreateList&lt;char&gt;(head, tail, s, 3);\n\n  upwardSearch(tail);\n\n  downwardSearch(head);\n\n  DestroyList(head);\n  head = tail = nullptr;\n\n  return 0;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10500850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feaec958c08a9957e8bef3af09b7e3cc?s=128&d=identicon&r=PG&f=1", "display_name": "csstudent", "link": "https://stackoverflow.com/users/10500850/csstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 55388974, "answer_count": 1, "score": -1, "last_activity_date": 1553737463, "creation_date": 1553727849, "last_edit_date": 1553728659, "question_id": 55387804, "link": "https://stackoverflow.com/questions/55387804/displays-reverse-order-but-not-the-non-reverse-order-c", "title": "Displays reverse order but not the non-reverse order c++", "body": "<p>It will not show the string char array in non-reverse order (cde), but it does display the array in reverse order (edc). Could you please help with why it isn't displaying the cde?</p>\n\n<p>I tried changing variable names, but I'm a new programmer so I don't really know yet what to do. </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n// of linked list in reverse order\n\n// Structure of a node\n\ntemplate&lt;class T&gt;\nstruct listrec2\n{\n    T value; //corresponds to data\n    listrec2 *next; //points to next node\n    listrec2 *prev; //points to previous nod\n};\n\ntemplate&lt;class T&gt;\nvoid downwardSearch(listrec2&lt;T&gt; *head)\n//traverse from start of linked list to end of linked list\n//print out value of each node along way\n{\n\n    char s[] = { 'c', 'd', 'e' };\n// if you wanted to make it in the function listrec2&lt;T&gt; *tail;\n\n    listrec2&lt;T&gt; *current;\n    listrec2&lt;T&gt; *tail;\n    listrec2&lt;T&gt; value;\n\n    head = tail = new listrec2&lt;T&gt;; // make a new node\n    head-&gt;value = s[0];\n    tail = NULL;\n    head = NULL;\n\n    for (int i = 1; i &lt; strlen(s); i++)\n    {\n        current = new listrec2&lt;T&gt;; //makes new node\n        current-&gt;value = s[i];\n        current-&gt;next = NULL;\n        current-&gt;prev = tail;\n        tail-&gt;next = current;\n        tail = current;\n\n    }\n\n    listrec2&lt;T&gt; *ptr;\n    ptr = head;\n    cout &lt;&lt; \"The array in non-reverse order: \" &lt;&lt; endl;\n    while (ptr != NULL)\n    {\n        cout &lt;&lt; ptr-&gt;value;\n        ptr = ptr-&gt;next;\n\n    }\n}\n\ntemplate&lt;class T&gt;\nvoid upwardSearch(listrec2&lt;T&gt; *tail)\n{\n\n    char s[] = { 'c', 'd', 'e' };\n// if you wanted to make it in the function listrec2&lt;T&gt; *tail;\n\n// listrec2&lt;T&gt; *temp;\n    listrec2&lt;T&gt; *current2;\n    listrec2&lt;T&gt; *tail2;\n    listrec2&lt;T&gt; *value;\n    listrec2&lt;T&gt; *head2;\n\n    head2 = tail = new listrec2&lt;T&gt;; // make a new node\n    head2-&gt;value = s[0];\n    tail2 = NULL;\n    head2 = NULL;\n\n    for (int i = 1; i &lt; strlen(s); i++)\n    {\n        current2 = new listrec2&lt;T&gt;;\n        current2-&gt;value = s[i];\n        current2-&gt;next = NULL;\n        current2-&gt;prev = tail;\n        tail-&gt;next = current2;\n        tail = current2;\n\n    }\n\n    listrec2&lt;T&gt; *ptr2;\n    ptr2 = tail;\n    cout &lt;&lt; \"The array in reverse order or backwards: \" &lt;&lt; endl;\n    while (ptr2 != NULL)\n    {\n        cout &lt;&lt; ptr2-&gt;value;\n        ptr2 = ptr2-&gt;prev;\n    }\n    cout &lt;&lt; endl;\n}\n\nint main()\n{\n//missing info here\n\n    listrec2&lt;char&gt; *head;\n    listrec2&lt;char&gt; *tail;\n\n    upwardSearch(head);\n\n    downwardSearch(tail);\n\n    return 0;\n\n}\n</code></pre>\n\n<p>The expected results are: the array before reversal: cde\nthe array after reversa: edc.</p>\n"}, {"tags": ["python", "c++", "visual-studio", "embed"], "comments": [{"owner": {"reputation": 3869, "user_id": 1009546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ef706ed0517098e827bf5da5d64dfb?s=128&d=identicon&r=PG", "display_name": "battlmonstr", "link": "https://stackoverflow.com/users/1009546/battlmonstr"}, "edited": false, "score": 0, "creation_date": 1553729076, "post_id": 55387775, "comment_id": 97497748, "body": "The error means that it is not able to find library code for the used functions like <code>Py_Initialize</code>, i.e. it is not able to find <code>python36.lib</code> (or maybe python36.lib doesn&#39;t have the functions). One thing that is odd is that you are referring to python 2.x docs, but try to embed python 3.6"}, {"owner": {"reputation": 3869, "user_id": 1009546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ef706ed0517098e827bf5da5d64dfb?s=128&d=identicon&r=PG", "display_name": "battlmonstr", "link": "https://stackoverflow.com/users/1009546/battlmonstr"}, "edited": false, "score": 0, "creation_date": 1553729197, "post_id": 55387775, "comment_id": 97497776, "body": "Nevermind, the <a href=\"https://docs.python.org/3/extending/embedding.html\" rel=\"nofollow noreferrer\">3.x version</a> looks similar. So how did you add python36.lib to the project? You need to add it to &quot;link additional libraries&quot; section in the project settings."}, {"owner": {"reputation": 453, "user_id": 7428707, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/vcI9j.jpg?s=128&g=1", "display_name": "Kanmani", "link": "https://stackoverflow.com/users/7428707/kanmani"}, "edited": false, "score": 0, "creation_date": 1553749257, "post_id": 55387775, "comment_id": 97501999, "body": "not the op, but I have the same problem. I linked the python36.lib file and still the build is not successful. Is there anything else I should check ?"}], "owner": {"reputation": 49, "user_id": 8276872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d46fe3344e779842246709012c8f4e31?s=128&d=identicon&r=PG&f=1", "display_name": "MineII CrafterII", "link": "https://stackoverflow.com/users/8276872/mineii-crafterii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1102, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1553762716, "creation_date": 1553727707, "last_edit_date": 1553762716, "question_id": 55387775, "link": "https://stackoverflow.com/questions/55387775/embed-python-in-c-in-visual-studio", "title": "Embed Python in C++ in Visual Studio", "body": "<p>This may be a duplicate idk. I searched for answers and none helped me.\nIm trying to embed Python in C++ in Visual Studio 2017. My Goal is to run this: </p>\n\n<pre><code>#include &lt;Python.h&gt;\n\nint\nmain()\n{\n  Py_Initialize();\n  PyRun_SimpleString(\"from time import time,ctime\\n\"\n                     \"print 'Today is',ctime(time())\\n\");\n  Py_Finalize();\n  return 0;\n}\n</code></pre>\n\n<p>What im doing is:<br>\ninstall the nuget paket \"python-embed\" for the project<br>\ni add ...\\packages\\python-embed.3.6.1.1\\lib\\native\\include to additional includes<br>\ni add ...\\packages\\python-embed.3.6.1.1\\lib\\native\\libs\\python36.lib to additional dependencies<br>\ncopy the code above, build <strike>and run</strike><br></p>\n\n<p>i get the following errors:<br>\n1>PYxC.obj : error LNK2001: unresolved external symbol __imp__Py_Initialize<br>\n1>PYxC.obj : error LNK2001: unresolved external symbol __imp__PyRun_SimpleStringFlags<br>\n1>PYxC.obj : error LNK2001: unresolved external symbol __imp__Py_Finalize<br>\n1>C:\\Users\\Windows\\source\\repos\\PYxC\\Release\\PYxC.exe : fatal error LNK1120: 3 unresolved external</p>\n\n<p>can somebody please explain to sombebody with a low iq how to embed python in c++ in visual studio 2017 as in the code above or as in this <a href=\"https://docs.python.org/2/extending/embedding.html#very-high-level-embedding\" rel=\"nofollow noreferrer\">https://docs.python.org/2/extending/embedding.html#very-high-level-embedding</a></p>\n"}, {"tags": ["c++", "templates", "types"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1553727686, "post_id": 55387711, "comment_id": 97497322, "body": "just <code>A&lt;T&gt;</code>, or any <code>C&lt;Ts...&gt;</code> or also <code>std::array&lt;T, N&gt;</code> ?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1553729013, "post_id": 55387711, "comment_id": 97497727, "body": "Do you want to detect <code>struct Der : A&lt;int&gt; {}</code> ?"}, {"owner": {"reputation": 737, "user_id": 4860693, "user_type": "registered", "profile_image": "https://graph.facebook.com/838129839615438/picture?type=large", "display_name": "Anthony Monterrosa", "link": "https://stackoverflow.com/users/4860693/anthony-monterrosa"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1553732181, "post_id": 55387711, "comment_id": 97498517, "body": "@Jarod42 just any <code>A&lt;T&gt;</code>s, but nothing else. So, excluding your next two examples."}], "answers": [{"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1553728940, "post_id": 55387767, "comment_id": 97497704, "body": "Note that this violates LSP; make <code>A</code> final if you do this."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1553729240, "post_id": 55387767, "comment_id": 97497785, "body": "@Yakk-AdamNevraumont - ehmmm... sorry, I don&#39;t understand what do you mean."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1553731677, "post_id": 55387767, "comment_id": 97498393, "body": "Ah.  <a href=\"https://en.wikipedia.org/wiki/Liskov_substitution_principle\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Liskov_substitution_principle</a> -- that a derived type can be substituted for its parent.  If <code>A&lt;int&gt;</code> is non-final, and B derives from <code>A&lt;int&gt;</code>, your code will behave differently if passed <code>A&lt;int&gt;</code> than <code>B</code>.  Hence violates LSP."}, {"owner": {"reputation": 737, "user_id": 4860693, "user_type": "registered", "profile_image": "https://graph.facebook.com/838129839615438/picture?type=large", "display_name": "Anthony Monterrosa", "link": "https://stackoverflow.com/users/4860693/anthony-monterrosa"}, "edited": false, "score": 0, "creation_date": 1554107482, "post_id": 55387767, "comment_id": 97615932, "body": "@max66 I believe this LSP substitution violation could be solved if the template used <code>std::condition</code> to determine if it inherited from <code>true_type</code> or <code>false_type</code>, instead of using specialization."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 4, "last_activity_date": 1553728126, "last_edit_date": 1553728126, "creation_date": 1553727689, "answer_id": 55387767, "question_id": 55387711, "link": "https://stackoverflow.com/questions/55387711/way-to-deduce-if-type-is-from-a-templated-class/55387767#55387767", "title": "Way to deduce if type is from a templated class", "body": "<p>Maybe with a custom type traits.</p>\n\n<p>Something as follows</p>\n\n<pre><code>template &lt;typename&gt;\nstruct is_A : public std::false_type\n { };\n\ntemplate &lt;typename T&gt;\nstruct is_A&lt;A&lt;T&gt;&gt; : public std::true_type\n { };\n\n// ...\n\ntemplate &lt;typename T&gt;\nauto someFunction(T item) {\n   if( is_A&lt;T&gt;::value ) {\n    // yep A&lt;int&gt; is 'from' A.\n   }\n}\n</code></pre>\n\n<p>Or, maybe, you want intercept non only <code>A&lt;T&gt;</code> but, generically, all types that are a template type, maybe with an undefined number of template arguments?</p>\n\n<p>In this case you can try with something as follows</p>\n\n<pre><code>template &lt;typename&gt;\nstruct is_template : public std::false_type\n { };\n\ntemplate &lt;template &lt;typename...&gt; class C, typename ... Ts&gt;\nstruct is_template&lt;C&lt;Ts...&gt;&gt; : public std::true_type\n { };\n</code></pre>\n\n<p>Problem: this type traits intercepts all template types with types template arguments and <em>only</em> template arguments. But doesn't intercept, by example, <code>std::integer_sequence&lt;int, 0, 1, 2, 3, 4, 5&gt;</code> that receive a type and some non-type template parameter.</p>\n\n<p>You can add other specializations for <code>is_template</code>, to intercept other cases, but you can't define a specialization that catch all template types (all combinations of template parameters).</p>\n"}, {"comments": [{"owner": {"reputation": 737, "user_id": 4860693, "user_type": "registered", "profile_image": "https://graph.facebook.com/838129839615438/picture?type=large", "display_name": "Anthony Monterrosa", "link": "https://stackoverflow.com/users/4860693/anthony-monterrosa"}, "edited": false, "score": 0, "creation_date": 1553732422, "post_id": 55387836, "comment_id": 97498570, "body": "Lovely! Thank you. What is the name of the syntax in the line <code>struct is_from_A&lt;A&lt;T&gt;&gt; : ...</code>? I thought template specializations could only use explicit values, i.e. <code>is_from_A&lt;A&lt;int&gt;&gt; : ...</code>, but apparently this is not the case."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 737, "user_id": 4860693, "user_type": "registered", "profile_image": "https://graph.facebook.com/838129839615438/picture?type=large", "display_name": "Anthony Monterrosa", "link": "https://stackoverflow.com/users/4860693/anthony-monterrosa"}, "edited": false, "score": 1, "creation_date": 1553739824, "post_id": 55387836, "comment_id": 97500082, "body": "@AnthonyMonterrosa: And so it is <i>partial specialization</i> (not available for function BTW)."}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1553728065, "creation_date": 1553728065, "answer_id": 55387836, "question_id": 55387711, "link": "https://stackoverflow.com/questions/55387711/way-to-deduce-if-type-is-from-a-templated-class/55387836#55387836", "title": "Way to deduce if type is from a templated class", "body": "<p>Use a type trait</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;class T&gt;\nclass A { };\n\nauto a = A&lt;int&gt;();\n\ntemplate &lt;typename X&gt;\nstruct is_from_A : std::false_type {};\n\ntemplate &lt;typename T&gt;\nstruct is_from_A&lt;A&lt;T&gt;&gt; : std::true_type {};\n\nint main() {\n    std::cout &lt;&lt; is_from_A&lt;int&gt;::value &lt;&lt; \"\\n\";     // 0\n    std::cout &lt;&lt; is_from_A&lt;A&lt;int&gt;&gt;::value &lt;&lt; \"\\n\";  // 1\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1553736054, "creation_date": 1553736054, "answer_id": 55388830, "question_id": 55387711, "link": "https://stackoverflow.com/questions/55387711/way-to-deduce-if-type-is-from-a-templated-class/55388830#55388830", "title": "Way to deduce if type is from a templated class", "body": "<p>An other way, allowing derived class to match:</p>\n\n<pre><code>template &lt;typename T&gt;\nstd::true_type is_an_A_impl(A&lt;T&gt;*);\n\nstd::false_type is_an_A_impl(...);\n\ntemplate &lt;typename T&gt;\nusing is_a_A = decltype(is_an_A_impl(std::declval&lt;T*&gt;()));\n</code></pre>\n"}], "owner": {"reputation": 737, "user_id": 4860693, "user_type": "registered", "profile_image": "https://graph.facebook.com/838129839615438/picture?type=large", "display_name": "Anthony Monterrosa", "link": "https://stackoverflow.com/users/4860693/anthony-monterrosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55387767, "answer_count": 3, "score": 0, "last_activity_date": 1553736054, "creation_date": 1553727312, "question_id": 55387711, "link": "https://stackoverflow.com/questions/55387711/way-to-deduce-if-type-is-from-a-templated-class", "title": "Way to deduce if type is from a templated class", "body": "<p>I've been trying to answer the question in the title, but I'm stumped. Basically, trying to see if there's a built-in way to tell the 'source' of a template instantiation, at least for classes. Here is an example of what I'd like to do:</p>\n\n<pre><code>template&lt;class T&gt;\nclass A { };\n\nauto a = A&lt;int&gt;();\n\ntemplate&lt;class T&gt;\nauto someFunction(T item) {\n    if(/* if type of a is from the templated class A */) {\n        // yep A&lt;int&gt; is 'from' A.\n    }\n}\n</code></pre>\n\n<p>Is this possible, in some way such as this? I could use some saved value or inheritance shenanigans to get something similar, but I'd rather not.</p>\n"}, {"tags": ["c++", "opencv", "image-processing", "visual-c++", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553759819, "post_id": 55387701, "comment_id": 97505809, "body": "&quot;What should I do to run this project properly?&quot; - Ask its developer about this. The project&#39;s <code>CMakeLists.txt</code> lacks for <code>cmake_minimum_required</code> call, which causes at least warning on any new CMake."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1553769273, "post_id": 55387701, "comment_id": 97511090, "body": "As for searching for OpenCV, you definitely need OpenCV installed with its <code>OpenCVConfig.cmake</code> file. Then find installation directory of OpenCV. When build your project, in CMake GUI create <code>CMAKE_PREFIX_PATH</code> cache entry (of type STRING, or PATH) and set its value to the directory with OpenCV installation. Or find location of <code>OpenCVConfig.cmake</code> file on your machine, and assign this location to the <code>OpenCV_DIR</code> cache entry. BTW, this is what is written in the error message."}, {"owner": {"reputation": 648, "user_id": 8463337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ee114d8516ce04935eb38df7ef29fa?s=128&d=identicon&r=PG", "display_name": "Majid Alaeinia", "link": "https://stackoverflow.com/users/8463337/majid-alaeinia"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553772560, "post_id": 55387701, "comment_id": 97513175, "body": "I have <a href=\"https://github.com/cxcxcxcx/imgwarp-opencv/issues/5\" rel=\"nofollow noreferrer\">asked its developer</a> as an issue but he says that he does not have time to write more document. And yes, as the error says, I can find the <code>OpenCVConfig.cmake</code> on my machine but do not know where is <code>OpenCV_DIR</code> and how should I link it to the project. Should I modify the <code>CMakeLists.txt</code>? Could you please try running this project yourself? And tell me what should I do to run this properly? I really appreciate that."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1553773226, "post_id": 55387701, "comment_id": 97513628, "body": "<code>OpenCV_DIR</code> is a CMake cache entry. Please, re-read my previous comment, it explains how to set this entry."}, {"owner": {"reputation": 648, "user_id": 8463337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ee114d8516ce04935eb38df7ef29fa?s=128&d=identicon&r=PG", "display_name": "Majid Alaeinia", "link": "https://stackoverflow.com/users/8463337/majid-alaeinia"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553775147, "post_id": 55387701, "comment_id": 97514718, "body": "How should I build the project, and after that which folder should I assign to the source code in CMake GUI? (God bless python!)"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1553776215, "post_id": 55387701, "comment_id": 97515399, "body": "As you build the project directly from Visual Studio, you don&#39;t need to use CMake GUI instead - Visual Studio already provides needed user interface. You may find CMake cache entries in menu <code>CMake</code> / <code>Cache</code> / <code>View CMakeCache</code>."}, {"owner": {"reputation": 648, "user_id": 8463337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ee114d8516ce04935eb38df7ef29fa?s=128&d=identicon&r=PG", "display_name": "Majid Alaeinia", "link": "https://stackoverflow.com/users/8463337/majid-alaeinia"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553778867, "post_id": 55387701, "comment_id": 97517234, "body": "I have changed that file into <code>OpenCV_DIR:PATH=C:\\Users\\Majid\\Desktop\\imgwarp-opencv\\imgwar&zwnj;&#8203;p-opencv\\src\\opencv\\&zwnj;&#8203;build\\OpenCVConfig.c&zwnj;&#8203;make</code>, but still get the same error when I <code>Generate</code> it.  In the repository, there are different <code>CMakeLists.txt</code> in each folder. Which one should I Generate?"}, {"owner": {"reputation": 648, "user_id": 8463337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ee114d8516ce04935eb38df7ef29fa?s=128&d=identicon&r=PG", "display_name": "Majid Alaeinia", "link": "https://stackoverflow.com/users/8463337/majid-alaeinia"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553779242, "post_id": 55387701, "comment_id": 97517495, "body": "There is one is <code>src</code> folder, one in <code>demo</code> folder and one in <code>lib</code> folder."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1553779968, "post_id": 55387701, "comment_id": 97518026, "body": "<code>OpenCV_DIR</code> should contain <b>directory</b>, not a <i>file</i>. Also, as it is CMake variable, it should use &quot;generic&quot; path separator, not a one used by Windows itself. Assign <code>C:&#47;Users&#47;Majid&#47;Desktop&#47;imgwarp-opencv&#47;imgwarp-opencv&#47;src&#47;ope&zwnj;&#8203;ncv&#47;build</code> to that variable."}, {"owner": {"reputation": 648, "user_id": 8463337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ee114d8516ce04935eb38df7ef29fa?s=128&d=identicon&r=PG", "display_name": "Majid Alaeinia", "link": "https://stackoverflow.com/users/8463337/majid-alaeinia"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553780362, "post_id": 55387701, "comment_id": 97518300, "body": "Sorry, my mistake, I should have used a <b>directory</b>. Now, I get this error: <code>CMake Error at C:&#47;Program Files (x86)&#47;Microsoft Visual Studio&#47;2017&#47;Community&#47;Common7&#47;IDE&#47;CommonExtensions&#47;Microsoft&zwnj;&#8203;&#47;CMake&#47;CMake&#47;share&#47;c&zwnj;&#8203;make-3.12&#47;Modules&#47;Fi&zwnj;&#8203;ndQt4.cmake:1313 (message):   Found unsuitable Qt version &quot;&quot; from NOTFOUND, this code requires Qt 4.x</code>.  I think now I must install Qt and deal with that, right?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1553785937, "post_id": 55387701, "comment_id": 97522562, "body": "Yes, install QT."}, {"owner": {"reputation": 648, "user_id": 8463337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ee114d8516ce04935eb38df7ef29fa?s=128&d=identicon&r=PG", "display_name": "Majid Alaeinia", "link": "https://stackoverflow.com/users/8463337/majid-alaeinia"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553794910, "post_id": 55387701, "comment_id": 97528190, "body": "Sorry for the continuous questions. I have installed Qt, and I should change this line in <code>CMakeLists.txt</code> which is <code>QT_QMAKE_EXECUTABLE:FILEPATH=NOTFOUND</code> but I can not the executable Qt file in the installed directory of CMake which is <code>C:\\Qt\\Tools\\QtCreator\\share\\qtcreator\\templates\\wizards\\proj&zwnj;&#8203;ects\\qmake</code>. In the <code>qmake</code> folder there is a folder called <code>empty</code> and in the <code>empty</code> folder there are two files: <code>file.pro</code> and <code>wizard.json</code>. I installed the default open source Qt from its website."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553803265, "post_id": 55387701, "comment_id": 97532489, "body": "Wait, you need OpenCV, not QT. For work with OpenCV, you need to install it completely, not just to copy its <code>OpenCVConfig.cmake</code> file. After installing OpenCV, find its <code>OpenCVConfig.cmake</code> file, and set <code>OpenCV_DIR</code> to point to this file. <b>Do not copy</b> file <code>OpenCVConfig.cmake</code> - it should be located exactly where it is installed with OpenCV. In other places this file doesn&#39;t work."}, {"owner": {"reputation": 648, "user_id": 8463337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ee114d8516ce04935eb38df7ef29fa?s=128&d=identicon&r=PG", "display_name": "Majid Alaeinia", "link": "https://stackoverflow.com/users/8463337/majid-alaeinia"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1553810553, "post_id": 55387701, "comment_id": 97535464, "body": "I did not copy anything, I just linked the folder containing <code>OpenCVConfig.cmake</code> to the <code>OpenCV_DIR</code> variable in the <code>CMakeLists.txt</code> file, and after generating the code one more time, got a new error about not finding Qt."}], "owner": {"reputation": 648, "user_id": 8463337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ee114d8516ce04935eb38df7ef29fa?s=128&d=identicon&r=PG", "display_name": "Majid Alaeinia", "link": "https://stackoverflow.com/users/8463337/majid-alaeinia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553772839, "creation_date": 1553727274, "last_edit_date": 1553772839, "question_id": 55387701, "link": "https://stackoverflow.com/questions/55387701/cmake-error-at-c-users-desktop-imgwarp-opencv-imgwarp-opencv-src-cmakelists", "title": "CMake Error at C:\\Users\\...\\Desktop\\imgwarp-opencv\\imgwarp-opencv\\src\\CMakeLists.txt:2 (FIND_PACKAGE)", "body": "<p>I am using Window 10, Visual Studio 2017. I have installed OpenCV properly and I can run some basic projects of C++ OpenCV that can be found around the internet.\nI have also followed <a href=\"https://www.youtube.com/watch?v=LxHV-KNEG3k\" rel=\"nofollow noreferrer\">this video</a> which shows <em>How to Build Open Source Projects Using CMake and Visual Studio</em>.</p>\n\n<p>But, I can not run <a href=\"https://github.com/cxcxcxcx/imgwarp-opencv\" rel=\"nofollow noreferrer\">this project</a> on my machine. I try <strong>File->Open->CMake</strong> to open the <strong>CMakeLists.txt</strong> which can be found in the downloaded repository, and I get this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SUfrs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SUfrs.png\" alt=\"CMake Error\"></a></p>\n\n<pre><code>CMake Error at C:\\Users\\Majid\\Desktop\\imgwarp-opencv\\imgwarp-opencv\\src\\CMakeLists.txt:2 (FIND_PACKAGE):\n  By not providing \"FindOpenCV.cmake\" in CMAKE_MODULE_PATH this project has\n  asked CMake to find a package configuration file provided by \"OpenCV\", but\n  CMake did not find one.\n\n  Could not find a package configuration file provided by \"OpenCV\" with any\n  of the following names:\n\n    OpenCVConfig.cmake\n    opencv-config.cmake\n\n  Add the installation prefix of \"OpenCV\" to CMAKE_PREFIX_PATH or set\n  \"OpenCV_DIR\" to a directory containing one of the above files.  If \"OpenCV\"\n  provides a separate development package or SDK, be sure it has been\n  installed.\n</code></pre>\n\n<p>I think I must extract the downloaded <strong>opencv-4.0.1-vc14_vc15.exe</strong> file somewhere in the project folder and link the <strong>CMakeLists.txt</strong> file (which one?) to the <strong>OpenCVConfig.cmake</strong> which is in the extracted opencv. Or maybe not.</p>\n\n<p>I have also <strong>CMake gui</strong> and if I should run it that way I will appreciate that you explain it that way instead of using Visual Studio <strong>File->Open->CMake</strong>. No matter how, any way that helps me run this project is welcome. Please explain it step by step.</p>\n\n<p><strong>In one line (forget all the above):</strong> What should I do to run <a href=\"https://github.com/cxcxcxcx/imgwarp-opencv\" rel=\"nofollow noreferrer\">this project</a> properly?</p>\n"}, {"tags": ["c++", "pipe", "system"], "comments": [{"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1553728824, "post_id": 55387656, "comment_id": 97497672, "body": "There is no portable way to achieve that. For linux you can try redirecting the output to <code>&#47;dev&#47;stdout</code>. Also how do you expect to run the output? Note that depending on compiler, os and cpu it will be in different binary format. So IMO what you are trying to do is hopeless anyway. The easiest solution would be to compile to dll/so, dump to disk and do dynamic loading via <code>dlopen</code> (or equivalent). Also you may want to have a look at JITing with e.g. LLVM (which is a set of tools for that). Although it is rather difficult."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1553766000, "post_id": 55387656, "comment_id": 97509031, "body": "You are already tying yourself to a particular platform. Why not go all the way and include clang (or g++) in your program? Then you don&#39;t need to use files at all."}, {"owner": {"reputation": 303, "user_id": 2420471, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee90c5d2cbb803d5e34986d36fabcf7c?s=128&d=identicon&r=PG", "display_name": "me me", "link": "https://stackoverflow.com/users/2420471/me-me"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1553768977, "post_id": 55387656, "comment_id": 97510895, "body": "@freakish, AFAIK compiler shouldn&#39;t matter, as the &quot;extern C&quot; should allow dlopen (or the windows equivalent) to call the function. Currently I&#39;m compiling to .dll/.so (see my other question, which now has a link). Regarding the CPU and OS, as the code is compiled at runtime, they will match and the only thing necessary is a C++-compiler on the host machine. I think including clang/g++ would be much more complicated?"}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 2420471, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee90c5d2cbb803d5e34986d36fabcf7c?s=128&d=identicon&r=PG", "display_name": "me me", "link": "https://stackoverflow.com/users/2420471/me-me"}, "edited": false, "score": 0, "creation_date": 1553764451, "post_id": 55387948, "comment_id": 97508082, "body": "I realize C++ and Python are very different, it was meant more as a metaphor to get across what I&#39;m trying to accomplish. I want users to be able to modify the program&#39;s behaviour at certain well-defined points (the user can implement specific functions), but I need the raw performance as it is a rendering engine. The solution I currently have works as expected and solves my problem, but I would like to get rid of the two temp files.  The link looks interesting. I&#39;m definitely going to have a look at it, although it might be overkill."}, {"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "reply_to_user": {"reputation": 303, "user_id": 2420471, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee90c5d2cbb803d5e34986d36fabcf7c?s=128&d=identicon&r=PG", "display_name": "me me", "link": "https://stackoverflow.com/users/2420471/me-me"}, "edited": false, "score": 1, "creation_date": 1553769796, "post_id": 55387948, "comment_id": 97511405, "body": "Given that you&#39;re expecting your &quot;users&quot; to write C++, I think it&#39;s also fair to expect that they might be able to compile their own shared libraries too. Why not just ship a header file for your interface, have users write small and compile small shared libraries ahead of time, then runtime link to whichever is required? I think my point is: why does the runtime compilation matter so much? Let the users deal with debugging and any platform-specific issues. If you&#39;re feeling generous, you can give them a template cmake project (or something) and build instructions to help them along?"}, {"owner": {"reputation": 303, "user_id": 2420471, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee90c5d2cbb803d5e34986d36fabcf7c?s=128&d=identicon&r=PG", "display_name": "me me", "link": "https://stackoverflow.com/users/2420471/me-me"}, "edited": false, "score": 1, "creation_date": 1553773400, "post_id": 55387948, "comment_id": 97513736, "body": "Good question, I&#39;ve left out a lot of details in the original to reduce irrelevant information and simplify the question. I want to allow experimentation and quick iterations, which is why the program offers a (simple) code editor. The code is then read/analysed by the program (so it actually needs the source and not just the compiled library), translated to valid c++ and compiled. These steps sound much more complicated then they are and they actually work like a charm."}, {"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "reply_to_user": {"reputation": 303, "user_id": 2420471, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee90c5d2cbb803d5e34986d36fabcf7c?s=128&d=identicon&r=PG", "display_name": "me me", "link": "https://stackoverflow.com/users/2420471/me-me"}, "edited": false, "score": 0, "creation_date": 1553773759, "post_id": 55387948, "comment_id": 97513922, "body": "Good on you, not a project I would embark on lightly but I&#39;m glad it&#39;s working for you. I apologise that I seem to have underestimated your understanding in my original answer (I thought I was saving a novice from python from world of hurt)"}], "tags": [], "owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "is_accepted": false, "score": 2, "last_activity_date": 1553728845, "creation_date": 1553728845, "answer_id": 55387948, "question_id": 55387656, "link": "https://stackoverflow.com/questions/55387656/how-to-compile-c-code-at-runtime-like-eval-in-python/55387948#55387948", "title": "How to compile c++ code at runtime (like eval in Python)?", "body": "<p>Please reconsider what you're doing. C++ and Python are very different languages in very many ways, not least in their build and execution models. It seems <em>very</em> unlikely that runtime compilation is the real solution to your underlying problem (which you have not shared with us). Simply put, C++ was not designed to support this, Python was.</p>\n\n<p>Technically, there are <a href=\"https://github.com/RuntimeCompiledCPlusPlus/RuntimeCompiledCPlusPlus/wiki\" rel=\"nofollow noreferrer\">a few solutions for runtime compilation of C++</a>, but they require much more management and effort than <code>eval</code> in Python. However, they are pretty specialised and, again, unlikely to be a good solution to your underlying problem.</p>\n"}], "owner": {"reputation": 303, "user_id": 2420471, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee90c5d2cbb803d5e34986d36fabcf7c?s=128&d=identicon&r=PG", "display_name": "me me", "link": "https://stackoverflow.com/users/2420471/me-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553763908, "creation_date": 1553726992, "last_edit_date": 1553763908, "question_id": 55387656, "link": "https://stackoverflow.com/questions/55387656/how-to-compile-c-code-at-runtime-like-eval-in-python", "title": "How to compile c++ code at runtime (like eval in Python)?", "body": "<p>I'm compiling some C++ code at runtime, which I'm then calling in a sort of plugin system, see also my <a href=\"https://stackoverflow.com/questions/55393629/how-to-call-dynamic-library-function-from-c\">other</a> question. What I do is I create the source code, write it to a file, compile that file and write the output to another file. However, this process feels kinda ugly so I was hoping for some input.</p>\n\n<pre><code>//Open a file\nstd::ofstream fout(\"SOURCECODEPATH\");\n\n//Write actual function to file\nfout &lt;&lt; \"extern \\\"C\\\" void testFunc(float testArray[]) {\\n\"\n        \"    testArray[0] = 1.0;\\n\"\n        \"    testArray[1] = 2.0;\\n\"\n        \"    testArray[2] = 3.0;\\n\"\n        \"}\" &lt;&lt; std::endl;\n\n//Compile the file, and write the stdout and stderr to PROCESSOUTPUTPATH using \"&amp;&gt;\"\nsystem(\"c++ -shared -fPIC -std=c++14 SOURCECODEPATH -o COMPILEDLIBRARYPATH &amp;&gt; PROCESSOUTPUTPATH\");\n\n//Read PROCESSOUTPUTPATH (not implemented)\n</code></pre>\n\n<p>Currently it's creating 3 files, <em>SOURCECODEPATH</em>, <em>COMPILEDLIBRARYPATH</em>, and <em>PROCESSOUTPUTPATH</em>. However, I would much rather not have the <em>SOURCECODEPATH</em> and <em>PROCESSOUTPUTPATH</em> written to the OS, but rather have them used internally. So pipe (?) the sourcecode to the process and get back the output (preferable split into stderr and stdout). What would be the easiest way to do this?</p>\n"}, {"tags": ["c++", "io", "istream"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9161706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F0jBB.png?s=128&g=1", "display_name": "fjcop", "link": "https://stackoverflow.com/users/9161706/fjcop"}, "edited": false, "score": 0, "creation_date": 1553729657, "post_id": 55387789, "comment_id": 97497887, "body": "Thanks Ted. But your ss istringstream is only a single stream - the loop will exit at the end even without quit as getline thinks the stream is EOF. What I&#39;m aiming at is having the Handler::loop run in a seperate thread. Then send a command from a unit test - wait for a result, send next command, etc."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 31, "user_id": 9161706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F0jBB.png?s=128&g=1", "display_name": "fjcop", "link": "https://stackoverflow.com/users/9161706/fjcop"}, "edited": false, "score": 0, "creation_date": 1553786987, "post_id": 55387789, "comment_id": 97523379, "body": "Ok, then I&#39;m not sure I get exactly what you&#39;d like to do. Is the Handler::loop` supposed to emulate the program? if so, doesn&#39;t it stop executing when <code>std::cin</code> is closed? If so, wouldn&#39;t starting a new thread and supplying it with a new <code>std::istream</code> whenever the old stream gets depleted?"}, {"owner": {"reputation": 31, "user_id": 9161706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F0jBB.png?s=128&g=1", "display_name": "fjcop", "link": "https://stackoverflow.com/users/9161706/fjcop"}, "edited": false, "score": 0, "creation_date": 1553791875, "post_id": 55387789, "comment_id": 97526467, "body": "The code      if(!getline(is, cmd)) ... works as expected with std::cin because it blocks as long as there is no input from the keyboard or process pipe. But in a unit test there will be no keyboard or process pipe so I need getline() to block on an empty stream (empty does not mean closed). In Java this is easy as Java&#39;s readLine distinguishes between empty (blocking) and closed. readLine() would wait until there is new content in the stream.  getline() in C++ on the other hand does not block when a stream is empty (only when the stream is cin.)"}, {"owner": {"reputation": 31, "user_id": 9161706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F0jBB.png?s=128&g=1", "display_name": "fjcop", "link": "https://stackoverflow.com/users/9161706/fjcop"}, "edited": false, "score": 0, "creation_date": 1553791878, "post_id": 55387789, "comment_id": 97526469, "body": "Is cin special and can I get getline() block on any other kind of stream?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 31, "user_id": 9161706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F0jBB.png?s=128&g=1", "display_name": "fjcop", "link": "https://stackoverflow.com/users/9161706/fjcop"}, "edited": false, "score": 0, "creation_date": 1553792895, "post_id": 55387789, "comment_id": 97527065, "body": "As long as the <code>std::istream</code> is open and not at <code>eof</code> it should block. A <code>stringstream</code> will however be depleated and reach <code>eof</code> very fast. In linux, you could create a filesystem pipe (<code>mknod cmd_pipe p</code>) and open that for reading and use as <code>std::istream</code>. As long as it&#39;s open, the <code>getline</code> function will block and then you can send commands at any speed you want."}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1553727774, "creation_date": 1553727774, "answer_id": 55387789, "question_id": 55387550, "link": "https://stackoverflow.com/questions/55387550/unit-test-for-protocol-over-cin-cout-how-to-block-on-streams-to-wait-for-conte/55387789#55387789", "title": "Unit test for protocol over cin/cout - how to block on streams to wait for content?", "body": "<p><code>std:::getline</code> returns the input stream object you gave it as argument. The stream itself will have a state which is used to determine if it should be evaluated as <code>true</code> or <code>false</code> in a boolean context. I made your loop able to accept a generic <code>std::istream</code> so it can be tested both with <code>std::cin</code> and other istreams. First run usues <code>std::cin</code> and second run usues a <code>std::istringstream</code> to show that it works.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;iomanip&gt;\n\nvoid loop(std::istream&amp; is) {\n    std::cout &lt;&lt; \"-----------------------------\\n\";\n    std::string cmd, token;\n    do {\n        std::cout &lt;&lt; \"HANDLER WAIT FOR COMMAND:\\n\";\n\n        // Block here waiting for input or EOF\n        // only blocks on cin!!\n        if(!getline(is, cmd)) cmd = \"quit\";\n\n        //  create the stream object\n        std::istringstream inStream(cmd);\n\n        inStream &gt;&gt; std::skipws &gt;&gt; token;\n        std::cout &lt;&lt; \"HANDLER RECEIVED: \" &lt;&lt; token &lt;&lt; \"\\n\";\n\n        if(token == \"quit\") break;\n        // handle commands...\n        else if(token == \"noop\") /* noop */\n            ;\n        else\n            std::cerr &lt;&lt; \"Unknown command: \" &lt;&lt; token &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; \"HANDLER COMMAND PROCESSED: \" &lt;&lt; token &lt;&lt; \"\\n\";\n\n    } while(token != \"quit\");\n}\n\nint main() {\n    loop(std::cin);\n    std::istringstream ss(\"unknown\\nnoop\\nquit\\nafter quit\\n\");\n    loop(ss);\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9161706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F0jBB.png?s=128&g=1", "display_name": "fjcop", "link": "https://stackoverflow.com/users/9161706/fjcop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553727774, "creation_date": 1553726324, "question_id": 55387550, "link": "https://stackoverflow.com/questions/55387550/unit-test-for-protocol-over-cin-cout-how-to-block-on-streams-to-wait-for-conte", "title": "Unit test for protocol over cin/cout - how to block on streams to wait for content?", "body": "<p>I'm trying to write a unit test for a program which needs to communicate with another process over a protocol through cin/cout pipe. It works well when excuting and testing with keyboard or another program sending and receiving commands and responses.</p>\n\n<p>In the unit test I would obviously need to replace cin/cout with other streams I can send and receive data from. (Through another thread and writing to the input stream of the protocol handler)</p>\n\n<p>Unfortunately I can't find a method to get a blocking read method which waits until a stream gets more content. </p>\n\n<p>The code below works fine when using cin.</p>\n\n<pre><code>void Handler::loop() {\n  string cmd, token;\n  do {\n    cout &lt;&lt; \"HANDLER WAIT FOR COMMAND:\" &lt;&lt; endl;\n\n    // Block here waiting for input or EOF\n    // only blocks on cin!!\n    if (!getline(*pInputStream, cmd)) cmd = \"quit\";\n\n    //  create the stream object\n    istringstream inStream(cmd);\n\n    inStream &gt;&gt; skipws &gt;&gt; token;\n    cout &lt;&lt; \"HANDLER RECEIVED: \" &lt;&lt; token &lt;&lt; endl;\n\n    if (token == \"quit\") break;\n    // handle commands...\n    else if (token == \"noop\") /* noop */;\n    else cerr &lt;&lt; \"Unknown command: \" &lt;&lt; token &lt;&lt; endl;\n    cout &lt;&lt; \"HANDLER COMMAND PROCESSED: \" &lt;&lt; token &lt;&lt; endl;\n\n  } while (token != \"quit\");\n}\n</code></pre>\n\n<p>When using </p>\n\n<pre><code>istringstream is;\n</code></pre>\n\n<p>instead of cin  then 'getline(*pInputStream, cmd)' does not block any more and returns with -1 immediately. I can't find any other mothed which would accomplish what I need (if have done some research for some time now). </p>\n\n<p>In Java I implemented it with:</p>\n\n<pre><code>final BufferedReader in = \n    new BufferedReader(newnputStreamReader(inputStream));\n\nwhile (running) {\n  try {\n    // wait until a line is ready to be read\n    final String readLine = in.readLine();\n...\n</code></pre>\n\n<p>This works fine with System.in or other streams. in.readline() always blocks until content is availabe. Ideal for unit testing.</p>\n\n<p>So speficically how can this be accomplished in C++ or more generally how to unit test protocols over inter process pipes?</p>\n\n<p>Thanks in advance for any ideas.</p>\n"}, {"tags": ["c++", "gcc", "lambda", "c++17", "gcc8"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 3, "creation_date": 1553726643, "post_id": 55387542, "comment_id": 97496992, "body": "Passing a lambda to a <code>const std::function&lt;...&gt; &amp;</code> parameter creates a temporary <code>std::function</code> on the spot, which is then destroyed at the end of the full expression."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1553727543, "post_id": 55387542, "comment_id": 97497272, "body": "std::function != lambda, it&#39;s a wrapper this a performance cost"}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 6, "last_activity_date": 1553727419, "last_edit_date": 1553727419, "creation_date": 1553726584, "answer_id": 55387585, "question_id": 55387542, "link": "https://stackoverflow.com/questions/55387542/segfault-when-using-stdfunction-class-member-with-compiler-optimizations/55387585#55387585", "title": "Segfault when using std::function class member with compiler optimizations", "body": "<p>As far I know, it's undefined behaviour.</p>\n\n<p>The problem is that your class register the reference</p>\n\n<pre><code>// ..........V  reference !!!\nconst Lambda &amp; _lambda;\n</code></pre>\n\n<p>of the argument of the constructor</p>\n\n<pre><code>Lambda_Expression(const Lambda &amp; l) : _lambda(l) {}\n</code></pre>\n\n<p>that is a <code>std::function</code></p>\n\n<pre><code>using Lambda = std::function&lt;T()&gt;;\n</code></pre>\n\n<p>But when you call the constructor with a lambda (as in <code>main()</code>)</p>\n\n<pre><code>auto test_expression = Lambda_Expression&lt;double, std::vector&lt;double&gt;&gt;(lambda);\n</code></pre>\n\n<p>you save in <code>_lambda</code> the reference to a temporary object because <code>lambda</code> isn't a <code>std::function</code> so it's created a <strong>temporary</strong> object, of type <code>std::function&lt;double()&gt;</code>, initialized with <code>lambda</code>.</p>\n\n<p>So the problem: the reference to the temporary object become a dangling reference at the end of the construction of <code>test_expression</code> so, when you call <code>test_expression[idx]</code>, you use <code>_lambda</code> that is pointing (potentially) to garbage.</p>\n\n<p>I suggest to avoid this sort of problems avoiding the reference part (make <code>_lambda</code> a regular member of type <code>std::function</code></p>\n\n<pre><code>const Lambda _lambda;  // &lt;-- no more reference\n</code></pre>\n\n<p>so you copy the temporary object)</p>\n\n<p>But if you really want that <code>_lambda</code> is a reference to a <code>std::function</code>, you should write something as follows</p>\n\n<pre><code>std::function&lt;double()&gt;  f{lambda};\n\nauto test_expression = Lambda_Expression&lt;double, std::vector&lt;double&gt;&gt;{f};\n</code></pre>\n\n<p>This way the constructor receive a reference to a <code>std::function</code> object (<code>f</code>) that survive to his call.</p>\n"}], "owner": {"reputation": 2107, "user_id": 4069571, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UwoxX.jpg?s=128&g=1", "display_name": "GPMueller", "link": "https://stackoverflow.com/users/4069571/gpmueller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 55387585, "answer_count": 1, "score": 3, "last_activity_date": 1553727419, "creation_date": 1553726261, "question_id": 55387542, "link": "https://stackoverflow.com/questions/55387542/segfault-when-using-stdfunction-class-member-with-compiler-optimizations", "title": "Segfault when using std::function class member with compiler optimizations", "body": "<p>I have a quite simple code example which crashes when optimized with <code>-O2</code> under gcc 8.2.0</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename T, typename Container&gt;\nclass Lambda_Expression\n{\n    using Lambda = std::function&lt;T()&gt;;\n    const Lambda &amp; _lambda;\n\npublic:\n    Lambda_Expression(const Lambda &amp; l) : _lambda(l) {}\n\n    T operator[](const std::size_t i)\n    {\n        std::cerr &lt;&lt; \"inside expression [] \" &lt;&lt; i &lt;&lt; std::endl;\n        return _lambda();\n    }\n};\n\nauto lambda = []() -&gt; double\n{\n    return 1.0;\n};\n\nint main()\n{\n    int N = 10;\n    std::vector&lt;double&gt; res(N, 0.0);\n\n    double x = lambda();\n\n    std::cerr &lt;&lt; \"before for loop \" &lt;&lt; x &lt;&lt; std::endl;\n\n    auto test_expression = Lambda_Expression&lt;double, std::vector&lt;double&gt;&gt;(lambda);\n\n    for( int idx=0; idx&lt;N; ++idx )\n    {\n        std::cerr &lt;&lt; \"loop \" &lt;&lt; idx &lt;&lt; std::endl;\n        double x = test_expression[idx];\n    }\n}\n</code></pre>\n\n<p>Using also <code>-std=c++17</code>, in case that makes a difference.</p>\n\n<p>I get</p>\n\n<pre><code>before for loop 1\nloop 0\ninside expression [] 0\n[1]    5288 segmentation fault  ./bench_lambdas\n</code></pre>\n\n<p>whereas I would expect the loop to run for 10 iterations. This segfault does not appear with optimization level less than 2.</p>\n\n<p>The above example looks like fairly harmless code to me and as far as I know level 2 optimizations should not break correct code.</p>\n\n<p><strong>Question:</strong>\nIs there undefined behaviour or incorrect code in my example or what might be the issue?</p>\n"}, {"tags": ["c++", "glfw", "premake"], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 1566559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c34ba1a7cbd44b9f6d87f971358426?s=128&d=identicon&r=PG", "display_name": "daniel", "link": "https://stackoverflow.com/users/1566559/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1580767130, "last_edit_date": 1592644375, "creation_date": 1580766602, "answer_id": 60047656, "question_id": 55387519, "link": "https://stackoverflow.com/questions/55387519/premake-linkinglinking-into-sharedlib-not-working/60047656#60047656", "title": "Premake linkingLinking into SharedLib not working", "body": "<p>Have a look at the glfw documentation. There it says you have to link some windows specific libraries for different compiler versions.</p>\n<blockquote>\n<p><a href=\"https://www.glfw.org/docs/3.0/build.html#build_link\" rel=\"nofollow noreferrer\">GLFW Documentation</a>:</p>\n<p>When linking a program under Windows that uses the static version of\nGLFW, you must link with opengl32. On some versions of MinGW, you must\nalso explicitly link with gdi32, while other versions of MinGW include\nit in the set of default libraries along with other dependencies like\nuser32 and kernel32. If you are using GLU, you must also link with\nglu32.</p>\n</blockquote>\n<p>If you use MinGW you might need to link gdi32 to your &quot;MojoEngine&quot; project.</p>\n<p><em><strong>Note:</strong></em> You are linking dynamically, so you need to link opengl32. Sorry misread that.</p>\n"}], "owner": {"reputation": 3, "user_id": 9873224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e49997f596c81959ae93bae36503e5fa?s=128&d=identicon&r=PG&f=1", "display_name": "MojoForPresident", "link": "https://stackoverflow.com/users/9873224/mojoforpresident"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580857338, "creation_date": 1553726104, "last_edit_date": 1592644375, "question_id": 55387519, "link": "https://stackoverflow.com/questions/55387519/premake-linkinglinking-into-sharedlib-not-working", "title": "Premake linkingLinking into SharedLib not working", "body": "<p>I am currently trying to learn C++ and thought doing some OpenGL magic would be a nice idea.\nI saw a Premake5 tutorial and followed along, except I tried linking a library myself (GLFW).\nWhen generating the project files for Visual Studio 2017, the library I specified somehow does not get properly linked into the project.\nI get lots a lots of LINK errors in the likes of:</p>\n<blockquote>\n<p>glfw3.lib(monitor.c.obj) : error LNK2019: Verweis auf nicht aufgel\u00f6stes externes Symbol &quot;__imp__strdup&quot; in Funktion &quot;_glfwAllocMonitor&quot;.</p>\n<p>glfw3.lib(win32_window.c.obj) : error LNK2001: Nicht aufgel\u00f6stes externes Symbol &quot;__imp__strdup&quot;.</p>\n<p>...</p>\n</blockquote>\n<p>This is how my premake5.lua file looks like:</p>\n<pre><code>workspace &quot;MojoEngine&quot;\narchitecture &quot;x64&quot;\n\nconfigurations\n{\n    &quot;Debug&quot;,\n    &quot;Release&quot;,\n    &quot;Dist&quot;\n}\n\noutputdir = &quot;%{cfg.buildcfg}-%{cfg.system}-%{cfg.architecture}&quot;\n\nproject &quot;MojoEngine&quot;\nlocation &quot;MojoEngine&quot;\nkind &quot;SharedLib&quot;\nlanguage &quot;C++&quot;\n\ntargetdir (&quot;bin/&quot; .. outputdir .. &quot;/%{prj.name}&quot;)\nobjdir (&quot;bin-int/&quot; .. outputdir .. &quot;/%{prj.name}&quot;)\n\nlibrarydir = &quot;%{prj.name}/libraries/&quot;\n\nfiles\n{\n    &quot;%{prj.name}/src/**.h&quot;,\n    &quot;%{prj.name}/src/**.cpp&quot;\n}\n\nincludedirs\n{\n    librarydir .. &quot;GLFW/include&quot;,\n    &quot;%{prj.name}/vendor/spdlog/include&quot;\n}\n\nlibdirs\n{\n    librarydir .. &quot;GLFW/lib&quot;\n}\n\nlinks\n{\n    &quot;glfw3&quot;,\n    &quot;glfw3dll&quot;\n}\n\nfilter &quot;system:windows&quot;\n    cppdialect &quot;C++17&quot;\n    staticruntime &quot;On&quot;\n    systemversion &quot;latest&quot;\n\n    defines\n    {\n        &quot;ME_PLATFORM_WINDOWS&quot;,\n        &quot;ME_BUILD_DLL&quot;\n    }\n\n    postbuildcommands\n    {\n        (&quot;{COPY} %{cfg.buildtarget.relpath} ../bin/&quot; .. outputdir .. \n    &quot;/Sandbox&quot;),\n        (&quot;{COPY} %{prj.name}/lib/GLFW/glfw3.dll ../bin/&quot; .. outputdir .. \n    &quot;/Sandbox&quot;)\n    }\n\nfilter &quot;configurations:Debug&quot;\n    defines &quot;ME_DEBUG&quot;\n    symbols &quot;On&quot;\n\nfilter &quot;configurations:Release&quot;\n    defines &quot;ME_RELEASE&quot;\n    optimize &quot;On&quot;\n\nfilter &quot;configurations:Dist&quot;\n    defines &quot;ME_DIST&quot;\n    optimize &quot;On&quot;\n\nproject &quot;Sandbox&quot;\nlocation &quot;Sandbox&quot;\nkind &quot;ConsoleApp&quot;\nlanguage &quot;C++&quot;\n\ntargetdir (&quot;bin/&quot; .. outputdir .. &quot;/%{prj.name}&quot;)\nobjdir (&quot;bin-int/&quot; .. outputdir .. &quot;/%{prj.name}&quot;)\n\nfiles\n{\n    &quot;%{prj.name}/src/**.h&quot;,\n    &quot;%{prj.name}/src/**.cpp&quot;\n}\n\nincludedirs\n{\n    &quot;MojoEngine/vendor/spdlog/include&quot;,\n    &quot;MojoEngine/src&quot;\n}\n\nlinks\n{\n    &quot;MojoEngine&quot;\n}\n\nfilter &quot;system:windows&quot;\n    cppdialect &quot;C++17&quot;\n    staticruntime &quot;On&quot;\n    systemversion &quot;latest&quot;\n\n    defines\n    {\n        &quot;ME_PLATFORM_WINDOWS&quot;,\n    }\n\nfilter &quot;configurations:Debug&quot;\n    defines &quot;ME_DEBUG&quot;\n    symbols &quot;On&quot;\n\nfilter &quot;configurations:Release&quot;\n    defines &quot;ME_RELEASE&quot;\n    optimize &quot;On&quot;\n\nfilter &quot;configurations:Dist&quot;\n    defines &quot;ME_DIST&quot;\n    optimize &quot;On&quot;\n</code></pre>\n"}, {"tags": ["c++", "c++11", "exitstatus"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553727021, "post_id": 55387490, "comment_id": 97497104, "body": "Save yourself a couple <code>for</code> loops: <code>int field[2003][2003] = {0};</code> will initialize the first element of the array to 0, because that&#39;s what we asked for, and the rest to 0 because that&#39;s the default if you don&#39;t specify a value."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553727761, "post_id": 55387490, "comment_id": 97497347, "body": "there are several problems in your code, see my answer"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 2, "last_activity_date": 1553728740, "last_edit_date": 1553728740, "creation_date": 1553726496, "answer_id": 55387578, "question_id": 55387490, "link": "https://stackoverflow.com/questions/55387490/exit-status-1-on-c-program/55387578#55387578", "title": "Exit Status -1 on C++ Program", "body": "<p>in</p>\n\n<pre><code>fin &gt;&gt; dir &gt;&gt; steps;\n</code></pre>\n\n<p>you do not get the expected values</p>\n\n<p>the first input is <code>int n; fin &gt;&gt; n;</code> and if the input file is like you indicate in the question the first value for <em>dir</em> will be the newline (after 6 in the input file) , then <code>&gt;&gt;</code> will definitively stay in error without doing something because after there is a <em>N</em> not compatible with <em>steps</em> being an <em>int</em></p>\n\n<p>To solve that problem </p>\n\n<ul>\n<li>do not must mix <em>int</em> and <em>char</em> read without to be sure of the format and bypassing explicitly all necessary characters</li>\n<li>or much more simple and secure do not read a <em>char</em> for <em>dir</em> but a string, so <code>string dir;</code> rather than <code>char dir;</code> and of course change the tests <code>(dir == 'X')</code> by <code>(dir == \"X\")</code> after where <em>X</em> is <em>N</em>, <em>S</em> or <em>W</em></li>\n</ul>\n\n<p>Probably you missed to add some <em>else</em> because you do :</p>\n\n<pre><code>if (dir == 'N') {\n  ...\n}\nif (dir == 'S') {\n  ...\n}\nif (dir == 'W') {\n  ...\n}\nelse {\n  ...\n}\n</code></pre>\n\n<p>so the last <em>else</em> normally for the case 'E' is also done for N and S case, probably you want</p>\n\n<pre><code>if (dir == 'N') { // in fact (dir == \"N\") see remark above\n  ...\n}\nelse if (dir == 'S') { // in fact (dir == \"S\") see remark above\n  ...\n}\nelse if (dir == 'W') { // in fact (dir == \"W\") see remark above\n  ...\n}\nelse {\n  ...\n}\n</code></pre>\n\n<p>I encourage you to check you open the files successfully, currently you suppose you did, and to check you read well in the input file</p>\n\n<p>Note on my raspberrypi the stack is limited to 8192K (<code>ulimit -s</code>) so the size of <em>field</em> is too large, I changed it to be <em>static</em> to be able to execute the program (and I replaced the complicated initialization using the 2 <em>for</em> )</p>\n\n<p>What is the expected content for <em>mowing.out</em> ? Doing the changes above I get 18</p>\n\n<hr>\n\n<p>If I use the definition :</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;fstream&gt;\nusing namespace std;\n\nint main() {\n  ofstream fout(\"mowing.out\");\n\n  if (!fout.is_open()) {\n    cerr &lt;&lt; \"cannot open mowing.out\" &lt;&lt; endl;\n    return -1;\n  }\n\n  ifstream fin(\"mowing.in\");\n\n  if (! fin.is_open()) {\n    cerr &lt;&lt; \"cannot open mowing.int\" &lt;&lt; endl;\n    return -1;\n  }\n\n  int n; \n\n  if ((!(fin &gt;&gt; n)) || (n &lt; 0)) {\n    cerr &lt;&lt; \"invalid number of couples\" &lt;&lt; endl;\n    return -1;\n  }\n\n  int ans = 0;\n  static int field[2003][2003] = { 0};\n  int xloc = 1001, yloc = 1001, time = 0;\n\n  for (int i = 0; i &lt; n; i++) {\n    string dir; int steps;\n\n    if (!(fin &gt;&gt; dir &gt;&gt; steps)) {\n      cerr &lt;&lt; \"error while reading fin &amp; dir\" &lt;&lt; endl;\n      return -1;\n    }\n\n    if (dir == \"N\") {\n      for (int j = 1; j &lt; steps; j++) {\n        yloc++;\n        time++;\n        if (field[xloc][yloc] != 0) ans = max(ans, time-field[xloc][yloc]);\n        field[xloc][yloc] = time;\n      }\n    }\n    else if (dir == \"S\") {\n      for (int j = 1; j &lt; steps; j++) {\n        yloc--;\n        time++;\n        if (field[xloc][yloc] != 0) ans = max(ans, time-field[xloc][yloc]);\n        field[xloc][yloc] = time;\n      }\n    }\n    else if (dir == \"W\") {\n      for (int j = 1; j &lt; steps; j++) {\n        xloc--;\n        time++;\n        if (field[xloc][yloc] != 0) ans = max(ans, time-field[xloc][yloc]);\n        field[xloc][yloc] = time;\n      }\n    }\n    else {\n      for (int j = 1; j &lt; steps; j++) {\n        xloc++;\n        time++;\n        if (field[xloc][yloc] != 0) ans = max(ans, time-field[xloc][yloc]);\n        field[xloc][yloc] = time;\n      }\n    }\n  }\n  if (ans == 0) fout &lt;&lt; -1 &lt;&lt; \"\\n\";\n  else fout &lt;&lt; ans &lt;&lt; \"\\n\";\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ g++ -g -pedantic -Wextra -Wall e.cc\npi@raspberrypi:/tmp $ cat mowing.in \n6\n\nN 10\n\nE 2\n\nS 3\n\nW 4\n\nS 5\n\nE 8\npi@raspberrypi:/tmp $ ./a.out\npi@raspberrypi:/tmp $ cat mowing.out \n18\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "is_accepted": true, "score": 1, "last_activity_date": 1553727712, "creation_date": 1553727712, "answer_id": 55387777, "question_id": 55387490, "link": "https://stackoverflow.com/questions/55387490/exit-status-1-on-c-program/55387777#55387777", "title": "Exit Status -1 on C++ Program", "body": "<p>On top of excellent points made by bruno, I believe the root cause of the problem you encounter is a (nomen omen!) stack overflow.</p>\n\n<p>Your array is <em>too big</em> to place on stack. Quick calculations (assuming <code>sizeof(int) == 4</code>):</p>\n\n<pre><code>2003 * 2003 * 4 B = 16048036 B = 15671.91015625 KiB = 15.304599761962890625 MiB\n</code></pre>\n\n<p>You're trying to allocate 15.3 MiB of memory on stack, whereas, according to <a href=\"https://softwareengineering.stackexchange.com/questions/310658/how-much-stack-usage-is-too-much\">this question</a>, by default Windows allows 1 MiB and Linux usually allows 8 MiB.</p>\n\n<p>You should either allocate memory on the heap by yourself or (better) use <code>std::vector</code>, like this:</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; field (2003, std::vector(2003));\n//it is already initialized above, no need for for loops ;)\n//later on it can be used like regular array in most of the cases\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553729904, "post_id": 55387950, "comment_id": 97497960, "body": "This was going on back in the 90&#39;s, too. in &#39;93 I had a Computer Science professor tell the class that he wouldn&#39;t cover debugging because if you wrote your programs correctly you wouldn&#39;t have to debug. I thought he was just being funny until I talked to him later and found he wasn&#39;t."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553731979, "post_id": 55387950, "comment_id": 97498470, "body": "@user4581301: Well, he was technically correct... It&#39;s also a waste of money to buy an eraser for your pencil work, because if you write down everything correctly you never have to erase anything :-)"}], "tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": false, "score": 0, "last_activity_date": 1553728847, "creation_date": 1553728847, "answer_id": 55387950, "question_id": 55387490, "link": "https://stackoverflow.com/questions/55387490/exit-status-1-on-c-program/55387950#55387950", "title": "Exit Status -1 on C++ Program", "body": "<blockquote>\n  <p>Can anybody see why I am getting exit status -1?</p>\n</blockquote>\n\n<p>Not just anybody - <em>you</em> can do it! </p>\n\n<p><a href=\"https://i.stack.imgur.com/6HInj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6HInj.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>... by using a <a href=\"https://en.wikipedia.org/wiki/Debugger\" rel=\"nofollow noreferrer\">debugger</a> to stop your program at different points during its execution and check the values of <code>n</code>, <code>ans</code> and other variables.</p>\n\n<p>I'm assuming you're using some IDE to edit and compile your code. IDEs typically have integrated debuggers. Examples:</p>\n\n<ul>\n<li><a href=\"https://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.cdt.doc.user%2Fgetting_started%2Fcdt_w_debug.htm\" rel=\"nofollow noreferrer\">Eclipse CDT</a> (on Linux, Windows and other platforms)</li>\n<li><a href=\"https://docs.microsoft.com/en-us/visualstudio/debugger/navigating-through-code-with-the-debugger?view=vs-2017\" rel=\"nofollow noreferrer\">Microsoft Visual Studio</a> (Windows only)</li>\n</ul>\n\n<p>It seems like <a href=\"https://stackoverflow.com/q/1942838/1593077\">students these days really aren't taught to debug...</a> :-(</p>\n"}], "owner": {"reputation": 47, "user_id": 10173550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VEbZY.jpg?s=128&g=1", "display_name": "usercow", "link": "https://stackoverflow.com/users/10173550/usercow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 1, "accepted_answer_id": 55387777, "answer_count": 3, "score": 0, "last_activity_date": 1553728847, "creation_date": 1553725942, "last_edit_date": 1553728379, "question_id": 55387490, "link": "https://stackoverflow.com/questions/55387490/exit-status-1-on-c-program", "title": "Exit Status -1 on C++ Program", "body": "<p>When executed, my code gives an exit status -1. I can show the input if it makes any difference. Can anybody find why this is happening?</p>\n\n<p>INPUT:</p>\n\n<blockquote>\n  <p>6</p>\n  \n  <p>N 10</p>\n  \n  <p>E 2</p>\n  \n  <p>S 3</p>\n  \n  <p>W 4</p>\n  \n  <p>S 5</p>\n  \n  <p>E 8</p>\n</blockquote>\n\n<p>I have already looked at the 2D integer array, and the variables in my code, looking for uninitialized ones, but I found no such errors. Can anybody see why I am getting exit status -1?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;fstream&gt;\nusing namespace std;\n\nint main() {\n  ofstream fout(\"mowing.out\");\n  ifstream fin(\"mowing.in\");\n  int n; fin &gt;&gt; n;\n  int ans = 0;\n  int field[2003][2003];\n  for (int i = 0; i &lt; 2003; i++) {\n    for (int j = 0; j &lt; 2003; j++) {\n      field[i][j] = 0;\n    }\n  }\n  int xloc = 1001, yloc = 1001, time = 0;\n  for (int i = 0; i &lt; n; i++) {\n    char dir; int steps;\n    fin &gt;&gt; dir &gt;&gt; steps;\n    if (dir == 'N') {\n      for (int j = 1; j &lt; steps; j++) {\n        yloc++;\n        time++;\n        if (field[xloc][yloc] != 0) ans = max(ans, time-field[xloc][yloc]);\n        field[xloc][yloc] = time;\n      }\n    }\n    if (dir == 'S') {\n      for (int j = 1; j &lt; steps; j++) {\n        yloc--;\n        time++;\n        if (field[xloc][yloc] != 0) ans = max(ans, time-field[xloc][yloc]);\n        field[xloc][yloc] = time;\n      }\n    }\n    if (dir == 'W') {\n      for (int j = 1; j &lt; steps; j++) {\n        xloc--;\n        time++;\n        if (field[xloc][yloc] != 0) ans = max(ans, time-field[xloc][yloc]);\n        field[xloc][yloc] = time;\n      }\n    }\n    else {\n      for (int j = 1; j &lt; steps; j++) {\n        xloc++;\n        time++;\n        if (field[xloc][yloc] != 0) ans = max(ans, time-field[xloc][yloc]);\n        field[xloc][yloc] = time;\n      }\n    }\n  }\n  if (ans == 0) fout &lt;&lt; -1 &lt;&lt; \"\\n\";\n  else fout &lt;&lt; ans &lt;&lt; \"\\n\";\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8349083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1ef7138fa53aa357822b72b89493d4?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/8349083/keith"}, "edited": false, "score": 0, "creation_date": 1553727194, "post_id": 55387584, "comment_id": 97497156, "body": "so the code after &quot;##&quot; must be a variable? In this case, FIELD is a variable."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 53, "user_id": 8349083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1ef7138fa53aa357822b72b89493d4?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/8349083/keith"}, "edited": false, "score": 0, "creation_date": 1553727268, "post_id": 55387584, "comment_id": 97497189, "body": "No, it does not need to be a variable, it is whatever is specified in the <code>FIELD</code> parameter when the macro is invoked. <code>Value</code> and <code>Data</code> are not variables in my example.  Macros are basically just text substitution, nothing more."}, {"owner": {"reputation": 53, "user_id": 8349083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1ef7138fa53aa357822b72b89493d4?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/8349083/keith"}, "edited": false, "score": 0, "creation_date": 1553727669, "post_id": 55387584, "comment_id": 97497316, "body": "Thanks. I understand. Another question is what is &quot;const throw()&quot; for? It will throw exceptions every time?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 53, "user_id": 8349083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1ef7138fa53aa357822b72b89493d4?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/8349083/keith"}, "edited": false, "score": 0, "creation_date": 1553728428, "post_id": 55387584, "comment_id": 97497557, "body": "The <code>const</code> specifier means the method&#39;s implicit <code>this</code> parameter is a pointer to a <code>const</code> object, and so the method is not allowed to modify any members of the object. The <code>throw()</code> specifier (which is deprecated BTW, use <code>noexcept</code> instead) means the method is not allowed to throw any exceptions at all, if it does <code>std::terminate()</code> will be called to terminate the app."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1553727726, "last_edit_date": 1553727726, "creation_date": 1553726575, "answer_id": 55387584, "question_id": 55387477, "link": "https://stackoverflow.com/questions/55387477/met-c-code-define-elementtype-field/55387584#55387584", "title": "Met c++ code &quot; #define ELEMENT(TYPE, FIELD)&quot;", "body": "<p>Yes, <code>ELEMENT()</code> is a preprocessor macro, which is just a fancy way to replace one piece of text with another piece of text before the compiler is invoked.  At the site where a macro is invoked, it is replaced with the text content of the macro.  If the macro has parameters, each parameter is replaced with the text that the caller passed in to the macro.</p>\n\n<p>In this case, the <code>TYPE</code> parameter is being used as-is within the macro text, whereas the <code>FIELD</code> parameter is being concatenated with <code>get</code> via <code>##</code> concatenation to produce a new token identifier <code>get&lt;FIELD&gt;</code>.</p>\n\n<p><code>ELEMENT()</code> can be used like this, for example:</p>\n\n<pre><code>class MyClass\n{\n    ELEMENT(int, IntValue)   // TYPE=int, FIELD=IntValue\n    ELEMENT(string, StrData) // TYPE=string, FIELD=StrData\n    // and so on ...\n};\n</code></pre>\n\n<p>Which will be expanded by the preprocessor to this code, which is what the compiler actually sees:</p>\n\n<pre><code>class MyClass\n{\n    bool getIntValue(int *field) const throw()\n    {\n        return x_-&gt;getIntValue(y_, field);\n    }\n\n    bool getStrData(string *field) const throw()\n    {\n        return x_-&gt;getStrData(y_, field);\n    }\n\n    // and so on ...\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 8349083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1ef7138fa53aa357822b72b89493d4?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/8349083/keith"}, "edited": false, "score": 0, "creation_date": 1553727658, "post_id": 55387688, "comment_id": 97497311, "body": "Thanks. I understand. Another question is what is &quot;const throw()&quot; for? It will throw exceptions every time?"}, {"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553727664, "post_id": 55387688, "comment_id": 97497314, "body": "While I agree that one should generally try to avoid preprocessor tricks in modern C++, it unfortunately remains the only way (or even more often, the only legible way) to achieve certain things. So I&#39;d like to suggest that this response&#39;s condemnation of them is rather too strong. After all, <code>#include</code> is the preprocessor too."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1553727725, "post_id": 55387688, "comment_id": 97497339, "body": "#include is no longer relevant with C++20"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1553727855, "post_id": 55387688, "comment_id": 97497375, "body": "const should be common knowledge with sufficient answers on this side"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1553727921, "post_id": 55387688, "comment_id": 97497398, "body": "throw() is already deprecated since 2011, see <a href=\"https://en.cppreference.com/w/cpp/language/except_spec\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/except_spec</a> for details"}], "tags": [], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "is_accepted": false, "score": 1, "last_activity_date": 1553728100, "last_edit_date": 1553728100, "creation_date": 1553727203, "answer_id": 55387688, "question_id": 55387477, "link": "https://stackoverflow.com/questions/55387477/met-c-code-define-elementtype-field/55387688#55387688", "title": "Met c++ code &quot; #define ELEMENT(TYPE, FIELD)&quot;", "body": "<p>I'm sorry to tell you, someone tried to be clever.</p>\n\n<p><code>#define</code> is used to textually replace one piece of text with another. The 2 arguments can be passed as a kind of arguments. Normally, such an argument is a token. However, thanks to ##, one can do token concatenation.</p>\n\n<p>Let's take an example: ELEMENT(int, Cost);</p>\n\n<p>This will result in the following code being injected:</p>\n\n<pre><code>bool getCost(int *field) const throw()\n     ...\n</code></pre>\n\n<p>So as you can see, int is kept as token, while Cost is glued together into getCost.</p>\n\n<p>I hope you found this in legacy code, cause using the preprocessor is considered bad coding in C++. The language hasn't been able to get rid of most usages. However they are providing alternatives to most common usages.\nThe <code>#include</code> and header guards have gotten replacements with the C++20 modules proposal. </p>\n"}], "owner": {"reputation": 53, "user_id": 8349083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1ef7138fa53aa357822b72b89493d4?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/8349083/keith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55387584, "answer_count": 2, "score": 0, "last_activity_date": 1553728100, "creation_date": 1553725879, "last_edit_date": 1553726672, "question_id": 55387477, "link": "https://stackoverflow.com/questions/55387477/met-c-code-define-elementtype-field", "title": "Met c++ code &quot; #define ELEMENT(TYPE, FIELD)&quot;", "body": "<pre><code>#define ELEMENT(TYPE, FIELD)\\\n      bool get##FIELD(TYPE *field) const throw()\\\n      { \\\n          return x_-&gt;get##FIELD(y_, field);\\\n      } \\\n</code></pre>\n\n<p>I never met code like this before.</p>\n\n<p>First, why do we put code in <code>#define</code>, is it a macro? So, I can use <code>ELEMENT()</code> later in other places?</p>\n\n<p>Second, what is <code>##</code>?  What I can find online is \"The ## operator takes two separate tokens and pastes them together to form a single token. The resulting token could be a variable name, class name or any other identifier.\"</p>\n\n<p>Could someone tell me how I should know what this kind of code works? </p>\n"}, {"tags": ["c++", "graph"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1553726627, "post_id": 55387446, "comment_id": 97496987, "body": "Because of the C-influence on this code, I&#39;m going to say no, not without a lot of work. Turn <code>Graph::edge</code> into <code>std::vector&lt;Edge&gt;</code> and the difficulty level goes way down, but there can be many, many hidden surprises in the code that&#39;s not shown."}], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 1, "last_activity_date": 1553727799, "last_edit_date": 1553727799, "creation_date": 1553726834, "answer_id": 55387635, "question_id": 55387446, "link": "https://stackoverflow.com/questions/55387446/is-it-possible-to-add-nodes-to-a-graph-once-its-been-made/55387635#55387635", "title": "Is it possible to add nodes to a graph once its been made?", "body": "<p>It's always possible.  It's just more painful if you use manually allocated arrays: </p>\n\n<ul>\n<li>to remove a node, you'd need to reduce the value of <code>graph-&gt;E</code>, and copy every nodes following the one you want to delete to one position earlier, for example with<br/> <a href=\"https://en.cppreference.com/w/cpp/algorithm/copy\" rel=\"nofollow noreferrer\"><code>std::copy(graph-&gt;edge+i, graph-&gt;edge+graph-&gt;E, graph+i-1);</code></a> </li>\n<li>to insert a node, you'd need to allocate a new array,  copy all the nodes, add the new one (at the end?), and increment <code>graph-&gt;E</code>, and <code>delete[]</code> the old array.  </li>\n</ul>\n\n<p>However, you'd do yourself a favor if you'd use <code>vector&lt;Edge&gt;</code> instead.  Then you can dynamically add new nodes with <a href=\"https://en.cppreference.com/w/cpp/container/vector/push_back\" rel=\"nofollow noreferrer\"><code>graph-&gt;edge.pushback()</code></a> and delete nodes with <a href=\"https://en.cppreference.com/w/cpp/container/vector/erase\" rel=\"nofollow noreferrer\"><code>graph-&gt;edge.erase()</code></a>.  You'd no loner need a graph->E since you could get it on the flow with <code>graph-&gt;edge.size()</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 9926095, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YwGJhqQmhG8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0yjHSonuAnZ8VGpgcGQGNSgmoSfQ/mo/photo.jpg?sz=128", "display_name": "David Neill", "link": "https://stackoverflow.com/users/9926095/david-neill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553727799, "creation_date": 1553725759, "last_edit_date": 1553726249, "question_id": 55387446, "link": "https://stackoverflow.com/questions/55387446/is-it-possible-to-add-nodes-to-a-graph-once-its-been-made", "title": "Is it possible to add nodes to a graph once its been made?", "body": "<p>Was wondering if it was possible to add and delete nodes from my graph even though it has already been created?</p>\n\n<p>The code below is how I am creating my graph:</p>\n\n<pre><code>int V = 6;  // Number of vertices in graph\nint E = 18;  // Number of edges in graph \n//graph being created\nstruct Graph* graph = createGraph(V, E); \n//////////////////////////////////////////////\n\nstruct Graph* createGraph(int V, int E) { \n   struct Graph* graph = new Graph; \n   graph-&gt;V = V; \n   graph-&gt;E = E; \n   graph-&gt;edge = new Edge[E]; \n   return graph; \n}\n</code></pre>\n"}, {"tags": ["c++", "exception", "try-catch"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1553724453, "post_id": 55387147, "comment_id": 97496315, "body": "Don&#39;t throw integers.  Throw a <i>type</i>."}, {"owner": {"reputation": 155, "user_id": 9524018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb16df57b3838d4d03850a392d6a2e7f?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/9524018/william"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1553724788, "post_id": 55387147, "comment_id": 97496413, "body": "Ah yes, I considered this, but it feels clunky? Throw an int for below bounds and a string for above? Is this the best solution?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1553724996, "post_id": 55387147, "comment_id": 97496479, "body": "Not clunky at all and instantly recognizable to anyone reading your code. Name the type correctly and the code is almost self documenting. A programmer who sees <code>throw 42;</code> is likely to have a WTF moment followed by searching through the code trying to figure out what you are doing or the same WTF moment followed tossing your code into a waste bin. But if they see <code>throw lowerbound;</code>, that tells them something."}, {"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 0, "creation_date": 1553725689, "post_id": 55387147, "comment_id": 97496691, "body": "Why you don&#39;t throw directly <code>std::out_of_range</code> ?"}, {"owner": {"reputation": 155, "user_id": 9524018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb16df57b3838d4d03850a392d6a2e7f?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/9524018/william"}, "reply_to_user": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 0, "creation_date": 1553726489, "post_id": 55387147, "comment_id": 97496941, "body": "@raindrop7 As far as I could see it didn&#39;t differentiate low and high, just that it was out of bounds."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9524018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb16df57b3838d4d03850a392d6a2e7f?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/9524018/william"}, "edited": false, "score": 0, "creation_date": 1553726417, "post_id": 55387329, "comment_id": 97496922, "body": "Hey, this seems to be an excellent answer! Several solutions building in complexity. I just learnt a lot! (Also, you were always my favourite of the X-Men ;)  )"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 4, "last_activity_date": 1553726950, "last_edit_date": 1553726950, "creation_date": 1553725080, "answer_id": 55387329, "question_id": 55387147, "link": "https://stackoverflow.com/questions/55387147/how-can-i-execute-different-catches-depending-on-which-side-i-am-out-of-bounds/55387329#55387329", "title": "How can I execute different catches depending on which side I am out of bounds?", "body": "<blockquote>\n  <p>Is it possible to throw an exception with a different int (for example) for out of upper/lower bounds, and have catches that execute different code depending on the value of that int?</p>\n</blockquote>\n\n<p>Sort of.  You can certainly throw a different <code>int</code> value based on a condition, but you would have to catch a single generic <code>int</code> and test its value, you can't catch different <code>int</code> values individually. For example:</p>\n\n<pre><code>const int OutOfBoundsInFront = -1;\nconst int OutOfBoundsInBack = 1;\n\nfloat arr::operator[](const int i) const\n{\n    if (i &lt; 0)\n        throw OutOfBoundsInFront;\n\n    if (i &gt;= size)\n        throw OutOfBoundsInBack;\n\n    return value[i];\n}\n\n...\n\ntry\n{\n    ... = myarr[index];\n}\ncatch (int value)\n{\n    switch (value)\n    {\n        case OutOfBoundsInFront:\n            //...\n            break;\n\n        case OutOfBoundsInBack:\n            //...\n            break;\n    }\n}\n</code></pre>\n\n<p>However, when throwing an exception, it is better to throw an object instead of a simple POD type.  <code>catch</code> blocks deal in types, not values.  In this case, you can define different class types for each condition you want to catch. For example:</p>\n\n<pre><code>#include &lt;stdexcept&gt;\n\nclass OutOfBoundsInFront : public std::out_of_range\n{\npublic:\n    OutOfBoundsInFront() : std::out_of_range(\"out of bounds in front\") {}\n};\n\nclass OutOfBoundsInBack : public std::out_of_range\n{\npublic:\n    OutOfBoundsInBack() : std::out_of_range(\"out of bounds in back\") {}\n};\n\nfloat arr::operator[](const int i) const\n{\n    if (i &lt; 0)\n        throw OutOfBoundsInFront();\n\n    if (i &gt;= size)\n        throw OutOfBoundsInBack();\n\n    return value[i];\n}\n\n...\n\ntry\n{\n    ... = myarr[index];\n}\ncatch (const OutOfBoundsInFront &amp;)\n{\n    //...\n}\ncatch (const OutOfBoundsInBack &amp;)\n{\n    //...\n}\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>#include &lt;stdexcept&gt;\n\nclass OutOfBoundsOnSide : public std::out_of_range\n{\npublic:\n    enum WhichSide { InFront, InBack };\n\n    static const char* WhichSideErrorMsg[] = {\n        \"out of bounds in front\",\n        \"out of bounds in back\"\n    };\n\n    WhichSide whichSide;\n\n    OutOfBoundsOnSide(WhichSide side) : std::out_of_range(WhichSideErrorMsg[side]), whichSide(side) {}\n};\n\nclass OutOfBoundsInFront : public OutOfBoundsOnSide\n{\npublic\n    OutOfBoundsInFront() : OutOfBoundsOnSide(InFront) {}\n};\n\nclass OutOfBoundsInBack : public OutOfBoundsOnSide\n{\npublic\n    OutOfBoundsInBack() : OutOfBoundsOnSide(InBack) {}\n};\n\nfloat arr::operator[](const int i) const\n{\n    if (i &lt; 0)\n        throw OutOfBoundsInFront();\n\n    if (i &gt;= size)\n        throw OutOfBoundsInBack();\n\n    return value[i];\n}\n\n...\n\ntry\n{\n    ... = myarr[index];\n}\ncatch (const OutOfBoundsOnSide &amp;e)\n{\n    switch (e.whichSide)\n    {\n        case InFront:\n            //...\n            break;\n\n        case InBack:\n            //...\n            break;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9524018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb16df57b3838d4d03850a392d6a2e7f?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/9524018/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 55387329, "answer_count": 1, "score": -2, "last_activity_date": 1553726950, "creation_date": 1553724103, "question_id": 55387147, "link": "https://stackoverflow.com/questions/55387147/how-can-i-execute-different-catches-depending-on-which-side-i-am-out-of-bounds", "title": "How can I execute different catches depending on which side I am out of bounds?", "body": "<p>I've overloaded an operator such that I can return the value of an array. I can handle out of bounds using <code>if</code>:</p>\n\n<pre><code>float arr::operator[](const int i) const\n{\n    if (i &lt; 0)\n    {\n        cout &lt;&lt; \"Outside of array, first entry returned\" &lt;&lt; endl;\n        return value[0];\n    }\n\n    else if (i &gt;=size)\n    {\n        cout &lt;&lt; \"Outside of array, last entry returned\"  &lt;&lt; endl;\n        return value[size-1];\n    }\n\n    else return value[i];\n}\n</code></pre>\n\n<p>but I am learning about exceptions and try-catch blocks.  </p>\n\n<p>Is it possible to throw an exception with a different int (for example) for out of upper/lower bounds, and have catches that execute different code depending on the value of that int?</p>\n\n<p>I know that <code>if</code>  works well here, but I'm looking to develop my knowledge for use in more complex ideas.</p>\n"}, {"tags": ["c++", "c++17", "assignment-operator"], "answers": [{"tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": false, "score": 24, "last_activity_date": 1553724261, "creation_date": 1553724261, "answer_id": 55387171, "question_id": 55387065, "link": "https://stackoverflow.com/questions/55387065/in-the-expression-left-right-why-is-right-sequenced-first/55387171#55387171", "title": "In the expression left() = right(), why is right() sequenced first?", "body": "<p>In the proposal <a href=\"https://wg21.link/P0145\" rel=\"noreferrer\">P0145</a> that introduced this evaluation order, the authors gave the following example:</p>\n\n<pre><code>#include &lt;map&gt;\nint main() {\n    std::map&lt;int, int&gt; m;\n    m[0] = m.size();\n}\n</code></pre>\n\n<p>In this situation, left-to-right evaluation would give 1, whereas right-to-left evaluation would give 0. Having the result be 0, thanks to right-to-left evaluation, corresponds more closely to our intuition that the value that should be assigned is the one that existed immediately before the assignment expression was evaluated.</p>\n"}, {"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 19, "last_activity_date": 1553725400, "creation_date": 1553725400, "answer_id": 55387380, "question_id": 55387065, "link": "https://stackoverflow.com/questions/55387065/in-the-expression-left-right-why-is-right-sequenced-first/55387380#55387380", "title": "In the expression left() = right(), why is right() sequenced first?", "body": "<p>In addition to the unintuitive result when doing what Brian showed:</p>\n\n<pre><code>#include &lt;map&gt;\nint main() {\n    std::map&lt;int, int&gt; m;\n    m[0] = m.size(); // before C++17 m[0] could be 0 or 1 - it was implementation defined\n}\n</code></pre>\n\n<p>If we take a the same map but do:</p>\n\n<pre><code>#include &lt;map&gt;\nint main() {\n    std::map&lt;int, int&gt; m;\n    m[0] = Right(); // Right() may throw\n}\n</code></pre>\n\n<p>If <code>Right()</code> throws: </p>\n\n<p>Before C++17 you could get a default constructed element in <code>m[0]</code> (left to right) or <code>m[0]</code> wouldn't be created at all (right to left). In C++17 <code>m[0]</code> will not get created at all.</p>\n"}], "owner": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 1, "accepted_answer_id": 55387380, "answer_count": 2, "score": 12, "last_activity_date": 1553725400, "creation_date": 1553723645, "question_id": 55387065, "link": "https://stackoverflow.com/questions/55387065/in-the-expression-left-right-why-is-right-sequenced-first", "title": "In the expression left() = right(), why is right() sequenced first?", "body": "<p>In C++, the expression <code>left() = right()</code> evaluates</p>\n\n<ol>\n<li><code>right()</code></li>\n<li><code>left()</code></li>\n</ol>\n\n<p>in that sequence. The <code>right()</code> goes first, as has been discussed <a href=\"https://stackoverflow.com/q/52762511/1275653\">here.</a></p>\n\n<p>I cannot think of a reason for <code>right()</code> to go first. Can you? I presume that there exists a reason. Otherwise, the standard would hardly say what it says, but consider: <code>right()</code> will return some result. At the machine-code level, does the CPU not need to know where to put the result <code>right()</code> will return before asking <code>right()</code> to return it?</p>\n\n<p>If you happen to know what the standard committee was thinking (because you were in the room or have read the memo), that's great: I'd like to read your answer. However, my actual question is more modest. All I want to know is whether there exists a plausible reason and what that reason might be.</p>\n"}, {"tags": ["c++", "memory", "memory-leaks"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1553723249, "post_id": 55386951, "comment_id": 97495838, "body": "<code>A a();</code> -- This does not create an object.  This declares a function called <code>a()</code> that takes no parameters and returns an <code>A</code> object."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553723710, "post_id": 55386951, "comment_id": 97496016, "body": "@Gox The call to <i><code>foo();</code></i> in <code>main()</code> would probably optimized out by any decent c++ compiler, since that function doesn&#39;t have any effect."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553723715, "post_id": 55386951, "comment_id": 97496020, "body": "Sidenote: The destructor does not free the memory of the object being destroyed. It is most often called as part of the chain leading to the freeing of memory, but can be invoked separately  to destroy an object without releasing the memory. See <a href=\"https://en.wikipedia.org/wiki/Placement_syntax\" rel=\"nofollow noreferrer\">Placement new/delete</a>  for more about this."}], "answers": [{"comments": [{"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 0, "creation_date": 1553724182, "post_id": 55386965, "comment_id": 97496202, "body": "@Gox - Yes, for a variable on the stack, the destructor is called when the block it was declared in exits."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 0, "creation_date": 1553724368, "post_id": 55386965, "comment_id": 97496284, "body": "@Gox - I added a more complete answer to your question in the comment to my answer. And, you&#39;re welcome."}], "tags": [], "owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "is_accepted": false, "score": 2, "last_activity_date": 1553724615, "last_edit_date": 1553724615, "creation_date": 1553723215, "answer_id": 55386965, "question_id": 55386951, "link": "https://stackoverflow.com/questions/55386951/local-variable-and-memory-leak/55386965#55386965", "title": "Local variable and memory leak", "body": "<p>If you don't provide a destructor, the compiler will provide one for you. This destructor will call the destructors of any member variables and base classes.</p>\n\n<p>There are a few cases in which you must write a destructor to avoid leaks. One case is if you're holding a bare pointer to something allocated with <code>new</code> and your object is the best candidate for 'owning' that pointer. In most cases, when you allocate something with <code>new</code> you consider yourself the owner of the pointer.</p>\n\n<p>Another case is when you've acquired some other sort of resource and need to release it. For example, if you open a file, or socket, you probably will need to write a custom destructor to close it.</p>\n\n<p>Though, what I do for all such resources is that I make a class that wraps the resource and has a destructor that closes it. This localizes the issue so I have to remember as little as possible with regards to resource management for most of my code. This is a common idiom in C++ and is referred to as <em>RAII</em>, meaning \"Resource Acquisition Is Initialization\".</p>\n\n<p>This is also why you should prefer <code>make_unique</code> and <code>make_shared</code> or things like <code>vector</code> to allocating memory with <code>new</code>. They give you objects that wrap the memory resource who's destructors will automatically release the resource for you.</p>\n\n<p>To answer the question in your comment on my answer more thoroughly...</p>\n\n<p>A local variable's destructor is called as soon as control leaves the block it was declared in. For a concrete example:</p>\n\n<pre><code>void foo () {\n    A b;\n    {\n        A c;\n    } // Destructor for c is called here\n} // Destructor for b is called here.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 1, "creation_date": 1553724128, "post_id": 55387043, "comment_id": 97496184, "body": "@Gox, are you trying to find out when the destructor is called?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 1, "creation_date": 1553724406, "post_id": 55387043, "comment_id": 97496301, "body": "@Gox, who is talking about memory leak for such objects?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 1, "creation_date": 1553724833, "post_id": 55387043, "comment_id": 97496429, "body": "@Gox, I hear your frustration. I hope you stick with language. Like any learned skill, it gets easier with practice. Best of luck."}, {"owner": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 0, "creation_date": 1554645341, "post_id": 55387043, "comment_id": 97819600, "body": "<i>are you trying to find out when the destructor is called?</i> Yes. <i>Who is talking about memory leak for such objects?</i> some old <b>Learn C++ easily tutorial</b>. It was somebody&#39;s recommendation that I should read this printed version of that tutorial."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 0, "creation_date": 1554669885, "post_id": 55387043, "comment_id": 97826689, "body": "@Gox, inline destructors have been around for a long time. I have been using it since 1995. It certainly has been part of the C++98 standard."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1553724430, "last_edit_date": 1553724430, "creation_date": 1553723521, "answer_id": 55387043, "question_id": 55386951, "link": "https://stackoverflow.com/questions/55386951/local-variable-and-memory-leak/55387043#55387043", "title": "Local variable and memory leak", "body": "<p>From <a href=\"https://timsong-cpp.github.io/cppwp/n3337/class.dtor#4\" rel=\"nofollow noreferrer\">the standard</a>:</p>\n\n<blockquote>\n  <p>If a class has no user-declared destructor, a destructor is implicitly declared as defaulted <a href=\"https://timsong-cpp.github.io/cppwp/n3337/dcl.fct.def\" rel=\"nofollow noreferrer\">([dcl.fct.def])</a>. An implicitly-declared destructor is an <code>inline public</code> member of its class.</p>\n</blockquote>\n\n<p>In other words,</p>\n\n<pre><code>class A {\n    public:\n        A () { }\n};\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>class A {\n    public:\n        A () { }\n        inline ~A() = default;\n};\n</code></pre>\n\n<p>As for your question</p>\n\n<blockquote>\n  <p>But my question is, is this inline destruct called when <code>foo()</code> is done?</p>\n</blockquote>\n\n<p>The answer is yes. However, that is true even for a user defined destructor.</p>\n"}], "owner": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 55387043, "answer_count": 2, "score": -1, "last_activity_date": 1613337085, "creation_date": 1553723134, "last_edit_date": 1613337085, "question_id": 55386951, "link": "https://stackoverflow.com/questions/55386951/local-variable-and-memory-leak", "title": "Local variable and memory leak", "body": "<p>I am reading some things around, and came across this:</p>\n\n<blockquote>\n  <p>Destructors are called when variable goes out of scope</p>\n</blockquote>\n\n<p>So my question is what happens with variables that do not have destructors?</p>\n\n<p>As an example:</p>\n\n<pre><code>class A {\n    public:\n        A () { }\n};\n\nvoid foo () {\n    A a;\n}\n\nint main (void) {\n    foo();\n}\n</code></pre>\n\n<p>So in this instance is <code>a()</code>? Is memory that was allocated for <code>a</code> destructed after <code>foo()</code> is done or not?</p>\n\n<p>Than I have this example:</p>\n\n<pre><code>class A {\n        std::vector &lt;int&gt; aa;\n    public:\n        A () : aa(5) { }\n};\n\nvoid foo () {\n    A b;\n}\n\nint main (void) {\n    foo();\n}\n</code></pre>\n\n<p>In this case as well is memory that was allocated for <code>b</code> destructed after <code>foo()</code> is done or not?</p>\n\n<p>One more clarifications, I know this:</p>\n\n<pre><code>class A {\n    public:\n        A () { }\n};\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>class A {\n    public:\n        A () { }\n        inline ~A() = default;\n};\n</code></pre>\n\n<p>But my question is, is this inline destruct called when <code>foo()</code> is done?</p>\n\n<p>EDIT:\nWhen was <code>inline</code> destructor added as default?</p>\n"}, {"tags": ["c++", "libcurl"], "answers": [{"comments": [{"owner": {"reputation": 3159, "user_id": 4566726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703bf229fd5caa423e3681efd566dcb7?s=128&d=identicon&r=PG", "display_name": "H. Guijt", "link": "https://stackoverflow.com/users/4566726/h-guijt"}, "edited": false, "score": 0, "creation_date": 1553799198, "post_id": 55388090, "comment_id": 97530375, "body": "Thanks, this is most helpful. Is the fact that it completely fails to load certificates from file intended as a feature, or should I report this as a bug on libcurl?"}, {"owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "reply_to_user": {"reputation": 3159, "user_id": 4566726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703bf229fd5caa423e3681efd566dcb7?s=128&d=identicon&r=PG", "display_name": "H. Guijt", "link": "https://stackoverflow.com/users/4566726/h-guijt"}, "edited": false, "score": 1, "creation_date": 1553804646, "post_id": 55388090, "comment_id": 97533147, "body": "I think that&#39;s how it&#39;s meant to work (looking at the code)"}], "tags": [], "owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "is_accepted": true, "score": 1, "last_activity_date": 1553729843, "creation_date": 1553729843, "answer_id": 55388090, "question_id": 55386742, "link": "https://stackoverflow.com/questions/55386742/failed-to-get-certificate-location-in-libcurl/55388090#55388090", "title": "Failed to get certificate location in libcurl", "body": "<p>Seems you can't specify a path to certificate file if libcurl is built with schannel on Windows (native TLS API). You need to specify the path to a cert in System Storage, as stated in <a href=\"https://curl.haxx.se/libcurl/c/CURLOPT_SSLCERT.html\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<p>(Schannel only) Client certificates must be specified by a path expression to a certificate store. (Loading PFX is not supported; you can import it to a store first). You can use <code>&lt;store location&gt;&lt;store name&gt;&lt;thumbprint&gt;</code> to refer to a certificate in the system certificates store, for example, <code>\"CurrentUser\\MY\\934a7ac6f8a5d579285a74fa61e19f23ddfe8d7a\"</code>. Thumbprint is usually a SHA-1 hex string which you can see in certificate details. Following store locations are supported: CurrentUser, LocalMachine, CurrentService, Services, CurrentUserGroupPolicy, LocalMachineGroupPolicy, LocalMachineEnterprise.</p>\n\n<p>You can check it inside the libcurl sources as well, look at the functions <code>schannel_connect_step1</code> and <code>get_cert_location</code> in the file <code>lib/vtls/schannel.c</code></p>\n"}], "owner": {"reputation": 3159, "user_id": 4566726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703bf229fd5caa423e3681efd566dcb7?s=128&d=identicon&r=PG", "display_name": "H. Guijt", "link": "https://stackoverflow.com/users/4566726/h-guijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1535, "favorite_count": 0, "accepted_answer_id": 55388090, "answer_count": 1, "score": 1, "last_activity_date": 1553729843, "creation_date": 1553722190, "question_id": 55386742, "link": "https://stackoverflow.com/questions/55386742/failed-to-get-certificate-location-in-libcurl", "title": "Failed to get certificate location in libcurl", "body": "<p>I'm using libcurl in a client application written in C++, to connect to a remote system using HTTPS. The connection is further secured by client certificates. Upon connecting I get the following messages:</p>\n\n<pre><code>Cert file: 'C:\\my-certs\\client.crt'.\nKey file: 'C:\\my-certs\\client.key'.\nCURL (0): Trying &lt;ipaddress&gt;...\nCURL (0): TCP_NODELAY set\nCURL (0): Connected to &lt;hostname&gt; (&lt;ipaddress&gt;) port 443 (#0)\nCURL (0): schannel: SSL/TLS connection with &lt;hostname&gt; port 443 (step 1/3)\nCURL (0): schannel: disabled server certificate revocation checks\nCURL (0): schannel: verifyhost setting prevents Schannel from comparing the supplied target name with the subject names in server certificates.\nCURL (0): schannel: Failed to get certificate location for C:\\my-certs\\client.crt\nThe connection to &lt;hostname&gt; was closed.\n</code></pre>\n\n<p>I'm certain the .crt and .key files exist in the specified location, and are readable. I'm setting the following SSL-related options in CURL:</p>\n\n<pre><code>CURLOPT_SSLCERT: C:\\my-certs\\client.crt\nCURLOPT_SSLKEY: C:\\my-certs\\client.key\nCURLOPT_SSL_VERIFYHOST: 0\nCURLOPT_SSL_VERIFYPEER: 0\n</code></pre>\n\n<p>What does the message \"Failed to get certificate location\" mean, and what should I do about it?</p>\n\n<p>I'm using libcurl/7.61.1-DEV WinSSL zlib/1.2.11, taken from vcpkg, and running on Windows 7. The application works fine with client certificates disabled; it's only when I add the SSLCERT and SSLKEY options that it fails. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1553722358, "post_id": 55386740, "comment_id": 97495525, "body": "<code>temp = r = s = start</code> - then why have 3 different variables for the same thing?"}, {"owner": {"reputation": 13, "user_id": 11268816, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QwhfPa9-8As/AAAAAAAAAAI/AAAAAAAAF-w/Bu3nO13tDJo/photo.jpg?sz=128", "display_name": "ahmed selim", "link": "https://stackoverflow.com/users/11268816/ahmed-selim"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1553722536, "post_id": 55386740, "comment_id": 97495589, "body": "it is to start the linked list data retrieving process, so i set all the values as start."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1553722554, "post_id": 55386740, "comment_id": 97495595, "body": "<code>matrix</code> contains values of type <code>int</code>. It cannot contain NULL."}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 6, "creation_date": 1553722555, "post_id": 55386740, "comment_id": 97495596, "body": "Always initialize your variable: <code>int matrix[10][10] = {0};</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11268816, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QwhfPa9-8As/AAAAAAAAAAI/AAAAAAAAF-w/Bu3nO13tDJo/photo.jpg?sz=128", "display_name": "ahmed selim", "link": "https://stackoverflow.com/users/11268816/ahmed-selim"}, "edited": false, "score": 0, "creation_date": 1553723102, "post_id": 55386862, "comment_id": 97495780, "body": "this is not the right way of doing it as it consumes more of the memory"}, {"owner": {"reputation": 13, "user_id": 11268816, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QwhfPa9-8As/AAAAAAAAAAI/AAAAAAAAF-w/Bu3nO13tDJo/photo.jpg?sz=128", "display_name": "ahmed selim", "link": "https://stackoverflow.com/users/11268816/ahmed-selim"}, "edited": false, "score": 0, "creation_date": 1553723148, "post_id": 55386862, "comment_id": 97495801, "body": "Always initialize your variable: int matrix[10][10] = {0};  by Amadeus       this is the right way of doing it  thanks again Amadeus"}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "reply_to_user": {"reputation": 13, "user_id": 11268816, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QwhfPa9-8As/AAAAAAAAAAI/AAAAAAAAF-w/Bu3nO13tDJo/photo.jpg?sz=128", "display_name": "ahmed selim", "link": "https://stackoverflow.com/users/11268816/ahmed-selim"}, "edited": false, "score": 0, "creation_date": 1553723621, "post_id": 55386862, "comment_id": 97495977, "body": "@ahmedselim It doesn&#39;t consume more memory; the memory is allocated as soon as you say <code>int matrix[20][20]</code> (or whatever the dimensions).  Using memset may be <code>slower</code> than a static initialization, depending on the scope of the matrix; it may be possible for it to be initialized during compilation."}], "tags": [], "owner": {"reputation": 134, "user_id": 11209337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LQgOlyFPQrA/AAAAAAAAAAI/AAAAAAAAAAk/5mSg0xIU2Ek/photo.jpg?sz=128", "display_name": "CodeoftheWarrior", "link": "https://stackoverflow.com/users/11209337/codeofthewarrior"}, "is_accepted": false, "score": 0, "last_activity_date": 1553722711, "creation_date": 1553722711, "answer_id": 55386862, "question_id": 55386740, "link": "https://stackoverflow.com/questions/55386740/how-to-display-the-null-values-of-2d-array-as-0-in-c/55386862#55386862", "title": "How to display the null values of 2D array as 0 in C++?", "body": "<p>So there is nothing that requires that an array have all 0's in it or NULL values when you first initialize it. It would have whatever was in memory prior to that section of memory being allocated for an array. You should at the beginning of your program, iterate through the matrix and set all values to 0 and then proceed. You can also probably get away with a call to memset</p>\n"}, {"comments": [{"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 1, "creation_date": 1553723532, "post_id": 55386969, "comment_id": 97495940, "body": "The compiler doesn&#39;t create garbage values if you don&#39;t initialize it. Or <i>any</i> values.  Rather, whatever data <i>already exist</i> at that point in memory will be interpreted as <code>int</code>s."}, {"owner": {"reputation": 2646, "user_id": 6308685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d4e8cd4bfec537fda6e26c9ea2d430?s=128&d=identicon&r=PG&f=1", "display_name": "alex067", "link": "https://stackoverflow.com/users/6308685/alex067"}, "reply_to_user": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1553723639, "post_id": 55386969, "comment_id": 97495984, "body": "That is my meaning of garbage values. The compiler has to output something. That something is garbage, because the values have nothing to do with what we need."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1553723784, "post_id": 55386969, "comment_id": 97496046, "body": "Theoretically, a platform that has status bits for a byte of memory which make that byte write-only (until initialized) and trap (halting the program) if it is read from would be a dangerous kind of garbage value to use uninitialized."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1553723815, "post_id": 55386969, "comment_id": 97496065, "body": "@Ray: That is naive and generally false. When the compiler sees that the value has never been initialized or assigned, it might not even bother to access that memory, and instead do something else, like &quot;create&quot; garbage values."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1553724169, "post_id": 55386969, "comment_id": 97496196, "body": "@AnT Accessing an uninitialized variable is undefined behavior, so it would be free to do that. (Simply <i>having</i> uninitialized variables is perfectly legal).  And since it&#39;s undefined, the compiler is free to write garbage values to those locations if it wants to. It could also write garbage values to any other location, or explode, or print a recipe for German chocolate cake.  Once we&#39;re bringing undefined behavior into the mix, assuming that it will do one <i>specific</i> thing like creating garbage values isn&#39;t the right approach either. But you are correct that we can&#39;t <i>rely</i> on anything here."}], "tags": [], "owner": {"reputation": 2646, "user_id": 6308685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d4e8cd4bfec537fda6e26c9ea2d430?s=128&d=identicon&r=PG&f=1", "display_name": "alex067", "link": "https://stackoverflow.com/users/6308685/alex067"}, "is_accepted": true, "score": 0, "last_activity_date": 1553723272, "last_edit_date": 1553723272, "creation_date": 1553723233, "answer_id": 55386969, "question_id": 55386740, "link": "https://stackoverflow.com/questions/55386740/how-to-display-the-null-values-of-2d-array-as-0-in-c/55386969#55386969", "title": "How to display the null values of 2D array as 0 in C++?", "body": "<p>Please initialize your 2d array to 0 first.</p>\n\n<pre><code>int arr[10][10] = {0} \n</code></pre>\n\n<p>To avoid any garbage values being entered by the compiler.</p>\n"}], "owner": {"reputation": 13, "user_id": 11268816, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QwhfPa9-8As/AAAAAAAAAAI/AAAAAAAAF-w/Bu3nO13tDJo/photo.jpg?sz=128", "display_name": "ahmed selim", "link": "https://stackoverflow.com/users/11268816/ahmed-selim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 55386969, "answer_count": 2, "score": -2, "last_activity_date": 1553723272, "creation_date": 1553722188, "last_edit_date": 1553722260, "question_id": 55386740, "link": "https://stackoverflow.com/questions/55386740/how-to-display-the-null-values-of-2d-array-as-0-in-c", "title": "How to display the null values of 2D array as 0 in C++?", "body": "<p>i am trying to display a matrix using 2D array (int matrix[ ][ ]) .\nnow after i created the array i am trying to display it back, but there is always null values in the array, and it shows this number (-858993460) in the place of the null value.\ni did a lot of research and i found out that the array should display 0 in the places of null values which what i want, but that doesn't happen in my case.</p>\n\n<p>this how i display the array values:\n...</p>\n\n<pre><code>for (int i = 0; i &lt; row_num; i++)\n{\n    cout &lt;&lt; \" }\";\n    cout &lt;&lt; endl &lt;&lt; \"{  \";\n    for (int j = 0; j &lt; column_num; j++)\n    {\n        cout &lt;&lt; matrix[i][j];\n        cout &lt;&lt; \"  \";\n    }\n\n}\n}\n</code></pre>\n\n<p>...</p>\n\n<p>and here is how i stored the elements of the array</p>\n\n<pre><code>struct Node *temp, *r, *s;\ntemp = r = s = start;\nint matrix[10][10];\nwhile (temp != NULL || r != NULL || s != NULL)\n{\n    matrix[temp-&gt;row][r-&gt;column] = s-&gt;value;\n    temp = temp-&gt;next;\n    r = r-&gt;next;\n    s = s-&gt;next;\n}\n</code></pre>\n\n<p>...</p>\n\n<p>i added 1 and 2 and 2 to specific positions in the array as input when the program ran, and i left the rest of the array empty.\nhere is the output:</p>\n\n<pre><code>{  1  -858993460  -858993460   }\n{  2  -858993460  -858993460   }\n{  -858993460  2  -858993460   }\n</code></pre>\n"}, {"tags": ["c++", "xcode", "eclipse"], "comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 2, "creation_date": 1553722206, "post_id": 55386730, "comment_id": 97495463, "body": "Please <a href=\"https://stackoverflow.com/posts/55386730/edit\">edit</a> your question to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, otherwise we&#39;re simply guessing what <code>die1</code> etc is and what you&#39;ve included. Also ensure you include what error you&#39;re receiving from eclipse. Is it a compiler error or runtime?"}, {"owner": {"reputation": 35, "user_id": 11204681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7c5efd5483e78100edbd6e45121684?s=128&d=identicon&r=PG&f=1", "display_name": "firenation1254", "link": "https://stackoverflow.com/users/11204681/firenation1254"}, "reply_to_user": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 1, "creation_date": 1553723028, "post_id": 55386730, "comment_id": 97495755, "body": "@Tas I added the error, along with the code."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11204681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7c5efd5483e78100edbd6e45121684?s=128&d=identicon&r=PG&f=1", "display_name": "firenation1254", "link": "https://stackoverflow.com/users/11204681/firenation1254"}, "edited": false, "score": 0, "creation_date": 1553724031, "post_id": 55387044, "comment_id": 97496154, "body": "I added #include&lt;algorithm&gt; but threw up the same error. If you don&#39;t mind me asking how would I check if it is compiling in C++11? And would that mean Xcode is compiling in C++11 because the code runs fine in Xcode, and its running without #include&lt;algorithm&gt;."}, {"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "reply_to_user": {"reputation": 35, "user_id": 11204681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7c5efd5483e78100edbd6e45121684?s=128&d=identicon&r=PG&f=1", "display_name": "firenation1254", "link": "https://stackoverflow.com/users/11204681/firenation1254"}, "edited": false, "score": 0, "creation_date": 1553724107, "post_id": 55387044, "comment_id": 97496178, "body": "Yep, XCode is likely compiling in at least C++11. I&#39;ve not much experience with Eclipse but it would appear <a href=\"https://stackoverflow.com/questions/9131763/how-to-enable-c11-c0x-support-in-eclipse-cdt\">this</a> should aid you in setting up C++11."}], "tags": [], "owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "is_accepted": false, "score": 2, "last_activity_date": 1553723530, "creation_date": 1553723530, "answer_id": 55387044, "question_id": 55386730, "link": "https://stackoverflow.com/questions/55386730/c-program-running-in-xcode-but-not-eclipse/55387044#55387044", "title": "C++ program running in Xcode, but not Eclipse", "body": "<p>I can think of a couple of reasons for this. Firstly, you should <code>include &lt;algorithm&gt;</code> for <code>std::max</code>, and secondly the initializer list overload was only added in C++11, so it may be that your Eclipse is not compiling in at least C++11.</p>\n"}], "owner": {"reputation": 35, "user_id": 11204681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7c5efd5483e78100edbd6e45121684?s=128&d=identicon&r=PG&f=1", "display_name": "firenation1254", "link": "https://stackoverflow.com/users/11204681/firenation1254"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553856023, "creation_date": 1553722123, "last_edit_date": 1553856023, "question_id": 55386730, "link": "https://stackoverflow.com/questions/55386730/c-program-running-in-xcode-but-not-eclipse", "title": "C++ program running in Xcode, but not Eclipse", "body": "<p>The problem seems to be with <code>int m = std::max({die1, die2, die3});</code> it brings up an error in eclipse, but runs fine in Xcode. Why is that?\ncode is </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\nusing namespace std;\nint main() {\n    int die1; \n    int die2; \n    int die3; \n    cin &gt;&gt; die1;\n    cin &gt;&gt; die2;\n    cin &gt;&gt; die3;\n    int m = std::max({die1, die2, die3}); \n    cout &lt;&lt; m &lt;&lt; endl; \nreturn 0;\n}\n</code></pre>\n\n<p>the error is </p>\n\n<blockquote>\n  <p>../src/playground.cpp:19:22: error: expected expression<br>\n      int m = std::max({die1, die2, die3});<br>\n  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0^<br>\n  1 error generated.<br>\n  make: *** [src/playground.o] Error 1</p>\n</blockquote>\n"}, {"tags": ["c++", "openssl", "omnet++", "veins", "ecdsa"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7064754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b48d00cd8f2f337f5f6bb71169c9146?s=128&d=identicon&r=PG&f=1", "display_name": "Ricla", "link": "https://stackoverflow.com/users/7064754/ricla"}, "edited": false, "score": 0, "creation_date": 1553800763, "post_id": 55387989, "comment_id": 97531292, "body": "Thank you. I used the second solution. In this case the correct way to call the function <code>ECDSA_SIG_get0</code> is <code>ECDSA_SIG_get0(signed_hash, &amp;pr, &amp;ps);</code>. Right?"}], "tags": [], "owner": {"reputation": 12010, "user_id": 23235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281820b28d03f98e85bb3d901ae3f39?s=128&d=identicon&r=PG", "display_name": "Shane Powell", "link": "https://stackoverflow.com/users/23235/shane-powell"}, "is_accepted": true, "score": 2, "last_activity_date": 1553729009, "creation_date": 1553729009, "answer_id": 55387989, "question_id": 55386633, "link": "https://stackoverflow.com/questions/55386633/veins-simulation-terminates-calling-openssl-ecdsa-sig-get0-function/55387989#55387989", "title": "Veins simulation terminates calling openssl ECDSA_SIG_get0 function", "body": "<p>Your problem has nothing to do with openssl, but your \"C\" code and your misuse of pointers.</p>\n\n<p>Your problem line is:</p>\n\n<pre><code>signed_hash = ECDSA_do_sign(hash, 32, eckey);\n</code></pre>\n\n<p>Your code assumes it's changing the pointer in the calling function, it is not.  It's only changing the \"copy\" of the pointer.  You want to either return the pointer or pass in a pointer to a pointer and set it that way.</p>\n\n<p>e.g.</p>\n\n<pre><code>ECDSA_SIG *SignatureOpenSSL::generateSignature(const unsigned char* message, int messageLength)\n{\n    ...\n    ECDSA_SIG *  signed_hash = ECDSA_do_sign(hash, 32, eckey);\n    ...\n    return signed_hash;\n}\n\n\nECDSA_SIG * signed_hash = s-&gt;generateSignature(message, messageLength);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>void SignatureOpenSSL::generateSignature(const unsigned char* message, int messageLength, ECDSA_SIG ** signed_hash)\n{\n    ...\n    *signed_hash = ECDSA_do_sign(hash, 32, eckey);\n\n    if (*signed_hash == NULL){\n        std::cout &lt;&lt;\" ko signature \" &lt;&lt; std::endl;\n    }else{\n        std::cout &lt;&lt;\" ok signature\" &lt;&lt; std::endl;\n    }\n}\n\nECDSA_SIG * signed_hash;\ns-&gt;generateSignature(message, messageLength, &amp;signed_hash);\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7064754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b48d00cd8f2f337f5f6bb71169c9146?s=128&d=identicon&r=PG&f=1", "display_name": "Ricla", "link": "https://stackoverflow.com/users/7064754/ricla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 55387989, "answer_count": 1, "score": 0, "last_activity_date": 1553729009, "creation_date": 1553721626, "question_id": 55386633, "link": "https://stackoverflow.com/questions/55386633/veins-simulation-terminates-calling-openssl-ecdsa-sig-get0-function", "title": "Veins simulation terminates calling openssl ECDSA_SIG_get0 function", "body": "<p>I am using the virtual machine <code>instant-veins-4-7-1-i1</code> on VirtualBox with <code>Omnet++-5.3</code> and <code>Sumo-0.32.0</code>.</p>\n\n<p>I have installed the library <code>openssl</code> version 1.1.0. When I try to access to the struct <code>ECDSA_SIG</code> that store the signature with the function <code>ECDSA_SIG_get0</code> the simulation terminate suddenly with the following error </p>\n\n<p><a href=\"https://i.stack.imgur.com/KKrER.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KKrER.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is a snippet of the code that generate the error:</p>\n\n<pre><code>ECDSA_SIG * signed_hash;\ns-&gt;generateSignature(message, messageLength, signed_hash);\nconst BIGNUM **pr;\nconst BIGNUM **ps;\nECDSA_SIG_get0(signed_hash, pr, ps);\n</code></pre>\n\n<p>The <code>generateSignature</code> function code is:</p>\n\n<pre><code>void SignatureOpenSSL::generateSignature(const unsigned char* message, int messageLength, ECDSA_SIG * signed_hash)\n{\n\n    unsigned char *md;\n    unsigned char *hash;\n    hash = SHA256(message, messageLength, md);\n\n    // Computes the ECDSA signature of the given message using the supplied private key and returns the created signature\n    signed_hash = ECDSA_do_sign(hash, 32, eckey);\n\n    if (signed_hash == NULL){\n        std::cout &lt;&lt;\" ko signature \" &lt;&lt; std::endl;\n    }else{\n        std::cout &lt;&lt;\" ok signature\" &lt;&lt; std::endl;\n    }\n\n}\n</code></pre>\n\n<p>I have upgraded the <code>openssl</code> library to version 1.1.1 but the error keeps occurring.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "arrays", "class"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1553721713, "post_id": 55386629, "comment_id": 97495204, "body": "Looks like you forgot the size.  Try <code>const float test::f[2] = {1 , 2};</code>"}, {"owner": {"reputation": 739, "user_id": 8808047, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RNZnhl-JxaE/AAAAAAAAAAI/AAAAAAAAAD8/STLEovcCjNE/photo.jpg?sz=128", "display_name": "Skiller Dz", "link": "https://stackoverflow.com/users/8808047/skiller-dz"}, "edited": false, "score": 0, "creation_date": 1553722088, "post_id": 55386629, "comment_id": 97495418, "body": "first of all , the variable F is const , it means that you can&#39;t do f[0] = value or f[1] = value , it&#39;s read only variable , so you must initialize it at the first  , and secondly , you cannot access to a class obj variable like const float test::f = {1,2} , but only test::{1,2};"}, {"owner": {"reputation": 1, "user_id": 10845185, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8S3sl4varFE/AAAAAAAAAAI/AAAAAAAAAXc/jWJ03ABY6qo/photo.jpg?sz=128", "display_name": "Enes", "link": "https://stackoverflow.com/users/10845185/enes"}, "edited": false, "score": 0, "creation_date": 1553723181, "post_id": 55386629, "comment_id": 97495812, "body": "check here, <a href=\"https://stackoverflow.com/questions/370283/why-cant-i-have-a-non-integral-static-const-member-in-a-class\" title=\"why cant i have a non integral static const member in a class\">stackoverflow.com/questions/370283/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 310, "user_id": 7543250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3uDj4.jpg?s=128&g=1", "display_name": "Daichi Jameson", "link": "https://stackoverflow.com/users/7543250/daichi-jameson"}, "is_accepted": false, "score": 1, "last_activity_date": 1553723352, "creation_date": 1553723352, "answer_id": 55386995, "question_id": 55386629, "link": "https://stackoverflow.com/questions/55386629/initialize-class-variable-float-array-in-c/55386995#55386995", "title": "Initialize class variable float array in C++", "body": "<p>As @NathanOliver was saying, you can add the size to your initialization outside of the class:</p>\n\n<pre><code>class test                                                                   \n{                                                                            \npublic:                                                                      \n    static const float f[2];                                                 \n};                                                                           \n...                                                                          \nconst float test::f[2] = {1, 2};\n</code></pre>\n\n<p>Alternatively, you can also use <code>constexpr</code> and declare the array within the class itself:</p>\n\n<pre><code>class test                                                                  \n{                                                                           \npublic:                                                                     \n    static constexpr float f[2] = {1, 2};                                   \n};\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1180790"}, "is_accepted": true, "score": 1, "last_activity_date": 1553725466, "last_edit_date": 1553725466, "creation_date": 1553724184, "answer_id": 55387157, "question_id": 55386629, "link": "https://stackoverflow.com/questions/55386629/initialize-class-variable-float-array-in-c/55387157#55387157", "title": "Initialize class variable float array in C++", "body": "<h3>Explanation</h3>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/static\" rel=\"nofollow noreferrer\"><code>static</code></a> <code>test::f</code> means that <code>f</code> is not bound to <code>test</code> class instances. In other words, there is only one, single <code>f</code> like if <code>test</code> was <code>namespace</code>, not <code>class</code>. There is only one and exactly one <code>f</code>.</p>\n\n<h3>Note</h3>\n\n<p>Also, You've forgot to add size of <code>f</code> array which must be given at compile time.\nYou can also always use <a href=\"https://en.cppreference.com/w/cpp/language/decltype\" rel=\"nofollow noreferrer\"><code>decltype</code></a> specifier that will automagically provide correct type of member for you.</p>\n\n<h3>Basic example</h3>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass test\n{\npublic:\n    static const float f[2];\n};\n\ndecltype(test::f) test::f = {1, 2};\n\nint main(){\n    // Outputs: 1, 2\n    std::cout &lt;&lt; test::f[0] &lt;&lt; \", \" &lt;&lt; test::f[1];\n}\n</code></pre>\n\n<h3>Modern example</h3>\n\n<p>More modern solution would use <a href=\"https://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a>, <a href=\"https://en.cppreference.com/w/cpp/utility/initializer_list\" rel=\"nofollow noreferrer\">initializer list</a>, <a href=\"https://en.cppreference.com/w/cpp/language/auto\" rel=\"nofollow noreferrer\"><code>auto</code></a> placeholder type specifier and <a href=\"https://en.cppreference.com/w/cpp/language/constexpr\" rel=\"nofollow noreferrer\"><code>constexpr</code></a> specifier. In that case, you don't need to provide array size at all.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;array&gt;\n\nclass test\n{\npublic:\n    static constexpr auto f = std::array {1.f, 2.f};\n};\n\nint main(){\n    // Outputs: 1, 2\n    std::cout &lt;&lt; test::f[0] &lt;&lt; \", \" &lt;&lt; test::f[1];\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9156841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8827c049dbdea3e704dbb792e683aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Q Stollen", "link": "https://stackoverflow.com/users/9156841/q-stollen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 55387157, "answer_count": 2, "score": 0, "last_activity_date": 1553725466, "creation_date": 1553721607, "question_id": 55386629, "link": "https://stackoverflow.com/questions/55386629/initialize-class-variable-float-array-in-c", "title": "Initialize class variable float array in C++", "body": "<p>I'm trying to initialize a class variable array. As I understand normal class variable initialization works like this: </p>\n\n<pre><code>class test\n{\npublic:\n    static const float f;\n};\n</code></pre>\n\n<p>However, as an array, it suddenly doesnt work:</p>\n\n<pre><code>class test\n{\npublic:\n    static const float f[2];\n};\n//const float test::f = { 1 ,2};\n</code></pre>\n\n<p>The whole code should work, but I commented out the line 6. In line 4, it still threw </p>\n\n<blockquote>\n  <p>Error LNK2001 unresolved external symbol \"public: static float const *\n  const test::f\"</p>\n</blockquote>\n\n<p>I tried pointers and dynamic allocation, both of which didn't work either. How can I fix this error, and is there something wrong with line 6?</p>\n"}, {"tags": ["c++", "algorithm", "performance", "data-structures"], "owner": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1553721043, "creation_date": 1553721043, "question_id": 55386502, "link": "https://stackoverflow.com/questions/55386502/efficient-id-lookup-using-wildcard-strings-as-keys", "title": "Efficient ID lookup using wildcard strings as keys", "body": "<p>I need to efficiently match an input string against a large set of previously inserted strings, all of known length N.</p>\n\n<p>This problem can usually be tackled with radix trees (an example <a href=\"https://stackoverflow.com/questions/2815083/efficient-data-structure-for-word-lookup-with-wildcards\">question here</a>), but I have some particular properties which I believe make this problem different from what I've seen so far:</p>\n\n<ul>\n<li>Both the input and stored strings can contain wildcard characters <code>_</code> (no string - stored or input - can contain only wildcards). For example, <code>a_c</code> would match <code>_bc</code>, but not <code>__b</code>.</li>\n<li>The set changes, so it must be easy to insert/remove entries.</li>\n<li>The strings are not arbitrary; the allowed characters are different for each position in the string. For example, the first character might only be in <code>[a-c]</code>, while the second char could be in <code>[a-z]</code>. This is known in advance and never changes.</li>\n<li>I do not need to actually get the string matches back. Instead, I need the IDs of the matching strings. I mention this in case there's an efficient way to store the graph without representing all inserted strings.</li>\n</ul>\n\n<p>My current solution is to store a 3-dimensional set of vectors, where the first dimension corresponds to the position of a char in the string, and the other with its value (including the wildcard character); the third dimension contains all IDs that match that particular position/value. To find the set of matches I compute the <code>set_intersection</code> of all the IDs that I get by looking this matrix with the input string (similar to <a href=\"https://stackoverflow.com/a/2815387/1356926\">this proposed solution</a>).</p>\n\n<p>However, this solution is still not quite fast enough (it's my current bottleneck), and I was wondering whether there was a way to do better.</p>\n"}, {"tags": ["c++", "range-v3"], "comments": [{"owner": {"reputation": 8973, "user_id": 713961, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/30e8520a25cb0fa4a91acca77059244d?s=128&d=identicon&r=PG", "display_name": "Matt Kline", "link": "https://stackoverflow.com/users/713961/matt-kline"}, "edited": false, "score": 0, "creation_date": 1553721189, "post_id": 55386500, "comment_id": 97494963, "body": "At first glance this question resembles <a href=\"https://stackoverflow.com/q/48383671\">stackoverflow.com/q/48383671</a>, but there seems to be different problems at play there. <code>ranges::to_&lt;string&gt;</code> doesn&#39;t solve this problem."}, {"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 0, "creation_date": 1553724494, "post_id": 55386500, "comment_id": 97496330, "body": "Why don&#39;t you return auto instead of string? This will allow you to make it truly lazy"}, {"owner": {"reputation": 8973, "user_id": 713961, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/30e8520a25cb0fa4a91acca77059244d?s=128&d=identicon&r=PG", "display_name": "Matt Kline", "link": "https://stackoverflow.com/users/713961/matt-kline"}, "reply_to_user": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 0, "creation_date": 1553727800, "post_id": 55386500, "comment_id": 97497357, "body": "You certainly would outside a demo like this, but that just makes the static assertion occur elsewhere. Eventually you want to collect the result into a string (for I/O or storage in another structure), and it fires there."}], "answers": [{"comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1605825003, "post_id": 55404810, "comment_id": 114778789, "body": "Where do we file a feature request?"}], "tags": [], "owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "is_accepted": true, "score": 4, "last_activity_date": 1553798655, "creation_date": 1553798655, "answer_id": 55404810, "question_id": 55386500, "link": "https://stackoverflow.com/questions/55386500/range-v3-joining-piped-ranges-with-a-delimeter/55404810#55404810", "title": "range-v3: Joining piped ranges with a delimeter", "body": "<p><code>action::join</code> should accept a delimiter. Feel free to file a feature request. The actions need a lot of love.</p>\n"}], "owner": {"reputation": 8973, "user_id": 713961, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/30e8520a25cb0fa4a91acca77059244d?s=128&d=identicon&r=PG", "display_name": "Matt Kline", "link": "https://stackoverflow.com/users/713961/matt-kline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 55404810, "answer_count": 1, "score": 3, "last_activity_date": 1553798655, "creation_date": 1553721036, "last_edit_date": 1553722008, "question_id": 55386500, "link": "https://stackoverflow.com/questions/55386500/range-v3-joining-piped-ranges-with-a-delimeter", "title": "range-v3: Joining piped ranges with a delimeter", "body": "<p>I'm trying to build a basic demo of the range-v3 library: take some integers, filter out odd values, stringify them, then join those into a comma-separated list. For example, <code>{ 8, 6, 7, 5, 3, 0, 9 }</code> becomes <code>\"8, 6, 0\"</code>. From reading the <a href=\"https://ericniebler.github.io/range-v3/index.html\" rel=\"nofollow noreferrer\">docs</a> and going through examples, it seems like the na\u00efve solution would resemble:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>string demo(const vector&lt;int&gt;&amp; v)\n{\n    return v |\n        ranges::view::filter([](int i) { return i % 2 == 0; }) |\n        ranges::view::transform([](int i) { return to_string(i); }) |\n        ranges::view::join(\", \");\n}\n</code></pre>\n\n<p>but building on Clang 7 fails with a static assertion that one, \"Cannot get a view of a temporary container\". Since I'm collecting the result into a string, I can use the eager version - <code>action::join</code> - instead:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>string demo(const vector&lt;int&gt;&amp; v)\n{\n    return v |\n        ranges::view::filter([](int i) { return i % 2 == 0; }) |\n        ranges::view::transform([](int i) { return to_string(i); }) |\n        ranges::action::join;\n}\n</code></pre>\n\n<p>but the eager version doesn't seem to have an overload that takes a delimiter.</p>\n\n<p>Interestingly, the original assertion goes away if you collect <code>join</code>'s inputs into a container first. The following compiles and runs fine:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>string demo(const vector&lt;int&gt;&amp; v)\n{\n    vector&lt;string&gt; strings = v |\n        ranges::view::filter([](int i) { return i % 2 == 0; }) |\n        ranges::view::transform([](int i) { return to_string(i); });\n    return strings | ranges::view::join(\", \");\n}\n</code></pre>\n\n<p>but this totally defeats the principle of lazy evaluation that drives so much of the library.</p>\n\n<p>Why is the first example failing? If it's not feasible, can <code>action::join</code> be given a delimiter?</p>\n"}, {"tags": ["c++", "windows", "apache", "cgi"], "owner": {"reputation": 3159, "user_id": 4566726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703bf229fd5caa423e3681efd566dcb7?s=128&d=identicon&r=PG", "display_name": "H. Guijt", "link": "https://stackoverflow.com/users/4566726/h-guijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553719956, "creation_date": 1553719956, "question_id": 55386257, "link": "https://stackoverflow.com/questions/55386257/apache-on-windows-how-are-cgis-terminated-on-client-disconnect", "title": "Apache on Windows, how are CGIs terminated on client disconnect?", "body": "<p>I have a CGI program (written in C++) that is started by Apache. It sends a long-running stream of data to the client. This works; the problem is that if the client disconnects, the CGI program does not notice this and keeps running until it is manually interrupted. </p>\n\n<p>On Linux Apache sends a SIGPIPE that aborts the CGI program. But SIGPIPE does not exist on Windows. How does Apache tell the CGI program that it should stop?</p>\n\n<p>The full setup is as follows: the client asks for a .BAT file, which then runs a .EXE file. Ideally I'd like to keep this setup, but I could call the .exe file directly if that is necessary. The C++ program writes its output to std::cout. I'm not seeing any errors writing to std::cout.</p>\n"}, {"tags": ["c#", "c++", "arrays", "struct", "interop"], "comments": [{"owner": {"reputation": 1830, "user_id": 3343753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY4qS.jpg?s=128&g=1", "display_name": "Pedro Rodrigues", "link": "https://stackoverflow.com/users/3343753/pedro-rodrigues"}, "edited": false, "score": 0, "creation_date": 1553720883, "post_id": 55386234, "comment_id": 97494821, "body": "Hello and welcome to StackOverflow. It is a long post indeed, yet it would probably help to post the first exception you&#39;re getting, at least."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1553723941, "post_id": 55386234, "comment_id": 97496120, "body": "An embedded array is not IntPtr.  Just use a normal array[]. It needs [MarshalAs(UnmanagedType.ByValArray, SizeConst = 10)] to marshal correctly."}, {"owner": {"reputation": 39, "user_id": 10997805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV424.gif?s=128&g=1", "display_name": "DDT", "link": "https://stackoverflow.com/users/10997805/ddt"}, "edited": false, "score": 0, "creation_date": 1553735722, "post_id": 55386234, "comment_id": 97499287, "body": "Thanks Pedro. Those exceptions are in the comments. The first one.... It&#39;s like that (that&#39;s what system says)"}, {"owner": {"reputation": 39, "user_id": 10997805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV424.gif?s=128&g=1", "display_name": "DDT", "link": "https://stackoverflow.com/users/10997805/ddt"}, "edited": false, "score": 0, "creation_date": 1553735928, "post_id": 55386234, "comment_id": 97499323, "body": "Hey Hans. Was hopping you would reply. Gonna try with that. Perhaps adapting the &quot;Attempt2&quot; code? I&#39;ll try tomorrow at job and gonna let you know. Thanks for feedback"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 10997805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV424.gif?s=128&g=1", "display_name": "DDT", "link": "https://stackoverflow.com/users/10997805/ddt"}, "is_accepted": true, "score": 1, "last_activity_date": 1554217287, "last_edit_date": 1554217287, "creation_date": 1553777924, "answer_id": 55398273, "question_id": 55386234, "link": "https://stackoverflow.com/questions/55386234/passing-a-complex-struct-with-inner-array-of-struct-from-c-to-c/55398273#55398273", "title": "Passing a complex Struct (with inner array of struct) from C# to C++", "body": "<p>Thanks Hans. Seems it worked!</p>\n\n<p>Just modiffied the struct as suggested:</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic struct DevParam\n{\n   public bool Enable;\n   public uint Font;\n   public char Symbol;\n   public ImParam Image1;\n   public ImParam Image2;\n   //public IntPtr Properties;\n   [MarshalAs(UnmanagedType.ByValArray, SizeConst = 10)]\n   public sProperties[] Properties;\n   public uint FeedMode;\n\n   public DeviceParameters(int n) //(IntPtr SnP)\n   {\n       Enable = true;\n       Font = 0;\n       Symbol = '?';\n       Image1 = new ImParam(3);\n       Image2 = new ImParam(3);\n       //Properties = SnP;\n       Properties = new sProperties[n];\n        for(int i = 0; i &lt; n; i++)\n           Properties[i] = new sProperties(0);\n       FeedMode = 1;\n   }\n};\n</code></pre>\n\n<p>And used the \"Attemp1\" code.</p>\n"}], "owner": {"reputation": 39, "user_id": 10997805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV424.gif?s=128&g=1", "display_name": "DDT", "link": "https://stackoverflow.com/users/10997805/ddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 55398273, "answer_count": 1, "score": 0, "last_activity_date": 1576090789, "creation_date": 1553719839, "last_edit_date": 1576090789, "question_id": 55386234, "link": "https://stackoverflow.com/questions/55386234/passing-a-complex-struct-with-inner-array-of-struct-from-c-to-c", "title": "Passing a complex Struct (with inner array of struct) from C# to C++", "body": "<p>I'm working on a driver for a scanner. Got dll and header files from provider, aside of a manual in PDF, written in native C++ (dont have source code). Need to use it within a C# project but I'm having problems with the structs (either trying to read or send them).</p>\n\n<p>I got the dll methods using the Command Prompt, demangling them in a website (since it has +100). Of course, I wont use all of them, just the ones I need. Didn't have problems with the ones using primitive data types, in fact, made the scanner turn on/off, scan and such.</p>\n\n<p>My main problem is the following: I need to set some parameters, because with the default ones I'm not getting the needed info (and that's the MOST important thing I need, actually). The only way to do it is with a method that include 2 params: the ID (just an int) and the setting (an struct). That struct has internally not one, but 2 different structs instances (and one of them is an array, within another kind of struct as one of the params). In other words, gonna need to work with 4 different structs.</p>\n\n<p>I declared all my structs, following the template provided in the .h file, and inmported the method. When I try to do a test it keeps giving me an error. I believe the problem is the array of structs. I tried with a normal passing, Marshaling, using a pin to array, changing data type, adding a \"MarshalAs\" with all bool vars... nothing seems to work.</p>\n\n<p>Been trying to solve this for days already. Dont know what am I doing wrong (because this is my first time importing methods). I read about the C++/Cli thing but never worked with that either.</p>\n\n<p>See code below (I kinda modified a little because of confidentiality of the information)</p>\n\n<p>This is how is defined in the .h file (C++) </p>\n\n<pre><code>// The structs (won't add all parameters, but are basically the same type)\ntypedef struct _ImParam\n{\n  UINT Format;\n  UINT Resolution;\n  UINT ColorDepth;\n} IM_PARAM;\n\ntypedef struct _sValues\n{\n  UINT Xpos;\n  UINT Ypos;\n  UINT Width;\n  UINT Height;\n  BOOL Milli; \n} S_VALUES;\n\ntypedef struct _sProperties\n{\n  BOOL Enable;\n  S_VALUES Properties;\n} S_PROPERTIES;\n\ntypedef struct _DevParam\n{\n  BOOL Enable;\n  UINT Font;\n  char Symbol;\n  IM_PARAM Image1;\n  IM_PARAM Image2;\n  S_PROPERTIES Properties[10];\n  UINT FeedMode;\n} DevParam;\n\n// more code, comments, etc. etc.\n\n// This is how is defined\nBOOL SetParameters( DWORD ID, DevParams DParam )\n</code></pre>\n\n<p>This is how I build the structs in C#</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic struct ImParam\n{\n   public uint Format;\n   public uint Resolution;\n   public uint ColorDepth;\n\n   public ImParam(uint n)\n   {\n       Format = n;\n       Resolution = 300;\n       ColorDepth = 256;\n   }\n};\n\n[StructLayout(LayoutKind.Sequential)]\npublic struct sValues\n{\n   public uint Xpos;\n   public uint Ypos;\n   public uint Width;\n   public uint Height;\n   public bool Milli;\n\n   public sValues(uint n)\n   {\n       Xpos = n;\n       Ypos = n;\n       Width = n;\n       Height = n;\n       Milli = false;\n   }\n};\n\n[StructLayout(LayoutKind.Sequential)]\npublic struct sProperties\n{\n   public bool Enable;\n   public sValues Properties;\n\n   public sProperties(int n)\n   {\n       Enable = false;\n       Front = false;\n       Properties = new sValues(n);\n   }\n};\n\n// Commented code is from another attemp\n[StructLayout(LayoutKind.Sequential)]\npublic struct DevParam\n{\n   public bool Enable;\n   public uint Font;\n   public char Symbol;\n   public ImParam Image1;\n   public ImParam Image2;\n   public IntPtr Properties;\n   //public sProperties[] Properties;\n   public uint FeedMode;\n\n   public DeviceParameters(IntPtr SnP) //(int n)\n   {\n       Enable = true;\n       Font = 0;\n       Symbol = '?';\n       Image1 = new ImParam(3);\n       Image2 = new ImParam(3);\n       Properties = SnP;\n       /*Properties = new sProperties[n];\n        *for(int i = 0; i &lt; n; i++)\n        *   Properties[i] = new sProperties(0);*/\n       FeedMode = 1;\n   }\n};\n\n// .dll file path definition, some methods imported, etc. etc.\n[DllImport(path, EntryPoint = \"?SetParameters@@YGHKU_DevParam@@@Z\")]\npublic static extern bool SetParameters(int ID, DevParam dParam);\n</code></pre>\n\n<p>And this is when I do call it (added commented code to show you my attemps)</p>\n\n<pre><code>static void Main(string[] args)\n{\n    bool res = false;\n    int ID;\n    sProperties[] SnP = new sProperties[10];\n    for (int i = 0; i &lt; 10; i++)\n        SnP[i] = new sProperties(0);\n\n    try\n    {\n        // Some code to turn on scanner, get ID value and such\n\n        /* Attemp1: Passing the struct normaly.\n         * Result: ArgumentException [HRESULT: 0x80070057 (E_INVALIDARG))]\n         * try\n         * {\n         *     DevParam dParam = new DevParam(10);\n         *     res = Class1.SetParameters(ID, dParam);\n         *     Console.WriteLine(res);\n         * }\n         * catch (Exception e) { Console.WriteLine(e); }*/\n\n        /* Attemp2: Marshaling each element of the array.\n         * Result: The managed PInvoke signature doesnt mach the destination one\n         * int S = Marshal.SizeOf(typeof(sProperties));\n         * DevParam dParam = new DevParam(Marshal.AllocHGlobal(SnP.Length*S));\n         * IntPtr ptr = dParam.Properties;\n         * for (int i = 0; i &lt; SnP.Length; i++)\n         * {\n         *     Marshal.StructureToPtr(SnP[i], ptr, false);\n         *     ptr += S;\n         * }\n         * try\n         * {\n         *     res = Class1.SetDevParam(ID, dParam);\n         *     Console.WriteLine(res);\n         * }\n         * finally { Marshal.FreeHGlobal(dParam.sProperties); }*/\n\n         /* Attemp3: Adding a Pin Pointer to struct\n          * Result: Exception (Object has no primitive data and it can't\n          *     be transfered into bits blocks) */\n         GCHandle SpHandle = GCHandle.Alloc(SnP, GCHandleType.Pinned);\n         try\n         {\n             DevParam dParam = new DevParam(SpHandle.AddrOfPinnedObject());\n             res = Class1.SetParameters(ID, dParam);\n             Console.WriteLine(res);\n         }\n         catch (Exception e) { Console.WriteLine(e); }\n         finally { SpHandle.Free(); }\n\n         // More code for testing other methods and blahblahblah\n     }\n     catch (Exception e) { Console.WriteLine(e); }\n     Console.WriteLine(\"Finished\");\n     Console.ReadKey();\n}\n</code></pre>\n\n<p>What do I expect? Getting just a boolean result to see if method executed sucessfully (and of course, if true, scanner should have defined the new parameters)</p>\n\n<p>What do I get? A bunch of exceptions.</p>\n\n<p>Please, any help would be great. Thanks in advance.</p>\n\n<p>PD: Sorry for that long post.\nPD2: I'm quite rockie, so please try to explain it \"for dummies\"</p>\n"}, {"tags": ["c++", "arrays", "string", "input", "char"], "comments": [{"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 3, "creation_date": 1553719622, "post_id": 55386151, "comment_id": 97494196, "body": "Depends how you define &quot;sentence&quot;, but you probably want <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow noreferrer\"><code>std::getline</code></a>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1553719641, "post_id": 55386151, "comment_id": 97494199, "body": "Are you using C or C++?  The code you posted is C code."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10706674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135f00303d4c7c965dff2d9468f07859?s=128&d=identicon&r=PG&f=1", "display_name": "livelive96", "link": "https://stackoverflow.com/users/10706674/livelive96"}, "edited": false, "score": 0, "creation_date": 1553720297, "post_id": 55386206, "comment_id": 97494539, "body": "I get this error: &quot;no matching function for call to getline&quot;"}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "reply_to_user": {"reputation": 53, "user_id": 10706674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135f00303d4c7c965dff2d9468f07859?s=128&d=identicon&r=PG&f=1", "display_name": "livelive96", "link": "https://stackoverflow.com/users/10706674/livelive96"}, "edited": false, "score": 0, "creation_date": 1553720761, "post_id": 55386206, "comment_id": 97494775, "body": "Ah I made a mistake in formatting. It should read &quot;assuming you can use iostream and string&quot;. The getline function is defined in the string library."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553721539, "post_id": 55386206, "comment_id": 97495125, "body": "&quot;<i><code>scanf</code> only reads up until the first space</i>&quot; - actually, <code>scanf()</code> itself can read more than 1 word at a time. It is <code>%s</code> specifically that stops reading when it encounters whitespace, but you can use something more like <code>%[^\\n]\\n</code> or <code>%[^.].</code> instead to read a whole sentence. Just be sure to specify a width to avoid a buffer overflow."}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553723702, "post_id": 55386206, "comment_id": 97496012, "body": "@RemyLebeau I figured that was outside of the scope of this question, just wanted to keep things simple."}], "tags": [], "owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "is_accepted": false, "score": 6, "last_activity_date": 1553720893, "last_edit_date": 1553720893, "creation_date": 1553719719, "answer_id": 55386206, "question_id": 55386151, "link": "https://stackoverflow.com/questions/55386151/input-a-sentence-into-c/55386206#55386206", "title": "Input a sentence into C++", "body": "<p><code>scanf</code> only reads up until the first space, as does <code>cin &gt;&gt; someString</code>. What you want, assuming you can use <code>&lt;iostream&gt;</code> and <code>&lt;string&gt;</code>, is</p>\n\n<pre><code>std::string str;\nstd::getline(std::cin, str);\n</code></pre>\n\n<p>This will get all input up until the user hits enter (\\n).</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 10706674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135f00303d4c7c965dff2d9468f07859?s=128&d=identicon&r=PG&f=1", "display_name": "livelive96", "link": "https://stackoverflow.com/users/10706674/livelive96"}, "edited": false, "score": 1, "creation_date": 1553720319, "post_id": 55386313, "comment_id": 97494553, "body": "this seemed to work better than using getline, thank you!"}], "tags": [], "owner": {"reputation": 782, "user_id": 1898505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be95f487b76ad590c1f4ec332f4f663e?s=128&d=identicon&r=PG", "display_name": "Ivan Salo", "link": "https://stackoverflow.com/users/1898505/ivan-salo"}, "is_accepted": false, "score": 6, "last_activity_date": 1553720158, "creation_date": 1553720158, "answer_id": 55386313, "question_id": 55386151, "link": "https://stackoverflow.com/questions/55386151/input-a-sentence-into-c/55386313#55386313", "title": "Input a sentence into C++", "body": "<p>Use fgets() (which has buffer overflow protection) to get your input into a string.</p>\n\n<pre><code>printf(\"Enter a sentance: \");\nfgets(st, 256, stdin);\nprintf(\"%s\", st);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 8892336, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gwbh991oGvQ/AAAAAAAAAAI/AAAAAAAAAHU/vxVoCyuLQ3o/photo.jpg?sz=128", "display_name": "Arafat", "link": "https://stackoverflow.com/users/8892336/arafat"}, "is_accepted": false, "score": 1, "last_activity_date": 1553720710, "creation_date": 1553720710, "answer_id": 55386440, "question_id": 55386151, "link": "https://stackoverflow.com/questions/55386151/input-a-sentence-into-c/55386440#55386440", "title": "Input a sentence into C++", "body": "<p>Try like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main() {\n    std::string st;\n    std::cout &lt;&lt; \"Enter a sentence: \";\n    getline(std::cin, st);\n    std::cout&lt;&lt; st;\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10706674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135f00303d4c7c965dff2d9468f07859?s=128&d=identicon&r=PG&f=1", "display_name": "livelive96", "link": "https://stackoverflow.com/users/10706674/livelive96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1553721920, "creation_date": 1553719528, "question_id": 55386151, "link": "https://stackoverflow.com/questions/55386151/input-a-sentence-into-c", "title": "Input a sentence into C++", "body": "<p>How can I get user input including spaces.</p>\n\n<p>I tried doing this:</p>\n\n<pre><code>printf(\"Enter a sentance: \");\nscanf(\"%s\", st);\n    getchar();\nprintf(\"%s\", st);\n</code></pre>\n\n<p>But when I enter \nHello World\nit only returns \nHello</p>\n"}, {"tags": ["c++", "function", "exponent"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1553719491, "post_id": 55386115, "comment_id": 97494142, "body": "You implemented multiplication, not exponentiation."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 3, "creation_date": 1553719717, "post_id": 55386115, "comment_id": 97494233, "body": "You have a multiply function, now use it to make an exponent function."}, {"owner": {"reputation": 3869, "user_id": 1009546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ef706ed0517098e827bf5da5d64dfb?s=128&d=identicon&r=PG", "display_name": "battlmonstr", "link": "https://stackoverflow.com/users/1009546/battlmonstr"}, "edited": false, "score": 2, "creation_date": 1553719993, "post_id": 55386115, "comment_id": 97494390, "body": "<code>a*4 = a+a+a+a;</code>     <code>a^4 = a*a*a*a;</code> replace 4 with N and there you go"}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1553720679, "post_id": 55386115, "comment_id": 97494734, "body": "You should also remember to special case the return value if <code>b == 0</code>"}, {"owner": {"reputation": 134, "user_id": 11209337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LQgOlyFPQrA/AAAAAAAAAAI/AAAAAAAAAAk/5mSg0xIU2Ek/photo.jpg?sz=128", "display_name": "CodeoftheWarrior", "link": "https://stackoverflow.com/users/11209337/codeofthewarrior"}, "edited": false, "score": 0, "creation_date": 1553720982, "post_id": 55386115, "comment_id": 97494870, "body": "Also the special case where a and b are equal to 0. I assume you want that to return 1 in which case Sean Bright&#39;s comment works, but consider this for your final implementation that you may want it to be 0 or 1 depending on context or maybe even undefined."}], "answers": [{"comments": [{"owner": {"reputation": 134, "user_id": 11209337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LQgOlyFPQrA/AAAAAAAAAAI/AAAAAAAAAAk/5mSg0xIU2Ek/photo.jpg?sz=128", "display_name": "CodeoftheWarrior", "link": "https://stackoverflow.com/users/11209337/codeofthewarrior"}, "edited": false, "score": 0, "creation_date": 1553721091, "post_id": 55386509, "comment_id": 97494924, "body": "value = exp(num1, num2);"}, {"owner": {"reputation": 1, "user_id": 5993468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dqTBy.png?s=128&g=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5993468/shadow"}, "edited": false, "score": 0, "creation_date": 1553726411, "post_id": 55386509, "comment_id": 97496920, "body": "I&#39;ve only started c++ a couple months ago so I&#39;m pretty green when I put in value = exp(num1, num2); I got uninitialized num2 error used I also don&#39;t know what special case is and where it is on my code"}, {"owner": {"reputation": 1, "user_id": 5993468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dqTBy.png?s=128&g=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5993468/shadow"}, "edited": false, "score": 0, "creation_date": 1553732771, "post_id": 55386509, "comment_id": 97498639, "body": "what is meant by I implemented multiplication, not exponentiation? is that in the for loop for (int i = 0; i &lt; a; i++)     {         result += b;"}, {"owner": {"reputation": 1, "user_id": 5993468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dqTBy.png?s=128&g=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5993468/shadow"}, "edited": false, "score": 0, "creation_date": 1553737775, "post_id": 55386509, "comment_id": 97499668, "body": "I figured it out I had this value = exp(num1, num2) in the wrong place and fixed the for loop                           /function definition int exp(int a, int b)  { \tint result = 0;     for (int count = 0;  count &lt; a; count++) \t{ \t\tresult = result + b; \t\t \t} \treturn (result);"}], "tags": [], "owner": {"reputation": 134, "user_id": 11209337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LQgOlyFPQrA/AAAAAAAAAAI/AAAAAAAAAAk/5mSg0xIU2Ek/photo.jpg?sz=128", "display_name": "CodeoftheWarrior", "link": "https://stackoverflow.com/users/11209337/codeofthewarrior"}, "is_accepted": false, "score": 1, "last_activity_date": 1553721065, "creation_date": 1553721065, "answer_id": 55386509, "question_id": 55386115, "link": "https://stackoverflow.com/questions/55386115/writing-a-exponent-function-without-pow-or-multiplication/55386509#55386509", "title": "Writing a exponent function Without POW or Multiplication", "body": "<p>True, you are implementing multiplication not exponentiation, but the reason you are getting 0 everytime is that you are not storing the return value of your function call in value variable and are instead just outputing the zero everytime.</p>\n"}], "owner": {"reputation": 1, "user_id": 5993468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dqTBy.png?s=128&g=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5993468/shadow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 2, "answer_count": 1, "score": -3, "last_activity_date": 1553721065, "creation_date": 1553719381, "last_edit_date": 1553720550, "question_id": 55386115, "link": "https://stackoverflow.com/questions/55386115/writing-a-exponent-function-without-pow-or-multiplication", "title": "Writing a exponent function Without POW or Multiplication", "body": "<p>Im trying to Write a function that accepts two input parameters and computes the result of raising the value of the \ufb01rst input to the value of the second input, and returns the result. You are not allowed to use the multiplication operator(*)for performing multiplication, nor are you allowed to use any built-in C++ functionality that directly produces the exponentiation result.</p>\n\n<p>Data Types: function works correctly for both inputs being positives, zeroes, or ones, and when the second input is negative. my return is always 0 what am I doing wrong</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint exp(int, int);\n\nint main()\n{\n    int num1, // to store first number\n        num2, // to store second number\n        value = 0;\n\n    // read numbers\n    cout &lt;&lt; \"Enter first number: \";\n    cin &gt;&gt; num1;\n    cout &lt;&lt; \"Enter second number: \";\n    cin &gt;&gt; num2;\n\n    // call function\n    exp(num1, num2);\n\n    // print value\n    cout &lt;&lt; \"The value of \" &lt;&lt; num1 &lt;&lt; \" to the \" &lt;&lt; num2 &lt;&lt; \" is: \" &lt;&lt; value &lt;&lt; endl &lt;&lt; endl;\n\n    system(\"pause\");\n    return 0;\n}\n\n// function definition\nint exp(int a, int b)\n{\n    int result = 0;\n\n    for (int i = 0; i &lt; a; i++)\n    {\n        result += b;\n    }\n    return result;\n}\n</code></pre>\n"}, {"tags": ["c++", "amazon-web-services", "aws-sdk"], "comments": [{"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1553721730, "post_id": 55386095, "comment_id": 97495213, "body": "Typically you would store credentials KMS-encrypted in EC2 Parameter Store or AWS Secrets Manager. Then your Lambda function would use the SSM or Secrets Manager API to retrieve those. Assuming that you had access to the relevant KMS key, they would be decrypted for you. Where are you storing your credentials?"}, {"owner": {"reputation": 235, "user_id": 3019720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a97455500463581ba6727bb698b6d2dd?s=128&d=identicon&r=PG", "display_name": "Samuaz", "link": "https://stackoverflow.com/users/3019720/samuaz"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1553722556, "post_id": 55386095, "comment_id": 97495597, "body": "all the credentials are managed and storage by the aws administrator so i don&#39;t have  access to that configuration, i only have the encrypted db password. when i make the lambda i publish it a git repository after that a jenkins process build and deploy the lambda to aws, jenkins has the credentials etc and i suppose that also at saved in the ec2 or aws config, they only give me a example of how to do that but its in nodejs i need to do a c++ version of that for example this is the nodejs example, please read again my question i update that with more details"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1553723706, "post_id": 55386095, "comment_id": 97496015, "body": "DecryptRequest has a SetCiphertextBlob() method, equivalent to the Node example. Did that not work the same way?"}], "owner": {"reputation": 235, "user_id": 3019720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a97455500463581ba6727bb698b6d2dd?s=128&d=identicon&r=PG", "display_name": "Samuaz", "link": "https://stackoverflow.com/users/3019720/samuaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553722635, "creation_date": 1553719320, "last_edit_date": 1553722635, "question_id": 55386095, "link": "https://stackoverflow.com/questions/55386095/aws-sdk-cpp-how-to-decrypt-a-password-encrypted-by-kms-using-kmsclient-of-c-sd", "title": "aws-sdk-cpp How to decrypt a password encrypted by kms using KMSCLIENT of c++ sdk", "body": "<p>im trying to found any example to how decrypt a password encrypted by KMS, for example i have a RDS database password encrypted by KMS, i want to decrypt it in my aws-cpp-lambda function to connect to the database.</p>\n\n<p>i see that for call client Decrypt i need a DecryptRequest;\nbut i don't know how to initialize it and where set my \"encriptedPassword\" in the DecryptedRequest to call client.Decrypt()</p>\n\n<p>this is base64\nencriptedPassword = \"GPK0ujdAAAAZzBlBgkqhkiG\"</p>\n\n<pre><code>\nAws::SDKOptions options;\nInitAPI(options);\n    {\n        Aws::Client::ClientConfiguration awsConfig;\n        awsConfig.region = Aws::Environment::GetEnv(\"AWS_REGION\");\n        Aws::KMS::KMSClient client(awsConfig);\n\n\n  //      Aws::KMS::Model::DecryptRequest decryptRequest;\n   //     client.Decrypt(decryptRequest);\n\n    }\n    // shutdown the aws api\n    std::cout &lt;&lt; \"shutdown api\" &lt;&lt; \"\\n\";\n    ShutdownAPI(options);\n\n</code></pre>\n\n<p>all the credentials are managed and storage by the aws administrator so i don't have access to that configuration, i only have the encrypted db password. when i make the lambda i publish it a git repository after that a jenkins process build and deploy the lambda to aws, jenkins has the credentials etc and i suppose that also is saved in the ec2 or aws config, they only give me a example of how to do that but its in nodejs i need to do a c++ version of that for example this is the nodejs example</p>\n\n<pre><code>use strict'\nconst AWS = require('aws-sdk');\n\nmodule.exports.decrypt = (key) =&gt; {\n    return new Promise((resolve, reject) =&gt; {\n        const kms = new AWS.KMS();\n    console.log('Attempting to decrypt: ' + key);\n    const params = {CiphertextBlob: new Buffer(key, 'base64')};\n    console.log(params);\n    kms.decrypt(params, function (err, data) {\n        if (err) {\n            console.log('Error while decrypting key: ' + err);\n            reject(err)\n        } else {\n            console.log('Decrypted key');\n            resolve(data.Plaintext.toString('ascii'));\n        }\n    });\n});\n</code></pre>\n\n<p>what nodejs version do is decrypt the password using sdk kms client after that is passed as simple string to the db connection lib and connect to the database using host, port, db name, etc.</p>\n\n<p>what i need to do is decrypt the password using the KMSCLIENT for c++ like the node version.</p>\n\n<p>anyone cant write a small example please. Thanks to all!!</p>\n"}, {"tags": ["c++", "mongodb", "mongo-cxx-driver"], "comments": [{"owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 1, "creation_date": 1553717806, "post_id": 55385691, "comment_id": 97493390, "body": "Well, I&#39;d propose taking your two examples and benchmarking them! I&#39;d be interested to know myself."}, {"owner": {"reputation": 10131, "user_id": 1485926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/t4pjt.jpg?s=128&g=1", "display_name": "fgalan", "link": "https://stackoverflow.com/users/1485926/fgalan"}, "reply_to_user": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 0, "creation_date": 1553717874, "post_id": 55385691, "comment_id": 97493425, "body": "At some point, I think I&#39;ll do that. But before starting that task, I&#39;d like to have some a priori information to guide my steps (that&#39;s why I&#39;m asking :). Thanks for the feedback @acm!"}, {"owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 2, "creation_date": 1553718011, "post_id": 55385691, "comment_id": 97493489, "body": "I&#39;d never really thought about it. I&#39;d like to say that the stream builder (please benchmark the basic one too!) ought to be pretty fast. But you are right it is a lot of calls. In cases like the one you present where the document is entirely a literal with no interpolated values, it may in fact be faster do parse it as JSON due to the reduced number of round trips into the C driver&#39;s BSON library. I think it is also likely that if you are building a complex object where  you are injecting a lot of state (say from a container), It probably isn&#39;t great to stringify and then parse?"}, {"owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 0, "creation_date": 1553718169, "post_id": 55385691, "comment_id": 97493556, "body": "Also, just a hint, but C++11 raw string literals will make declaring that JSON string a lot less painful: <a href=\"https://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/string_literal</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1553718175, "post_id": 55385691, "comment_id": 97493562, "body": "Just benchmark it. It&#39;s a common knowledge that programmers are way too often wrong when predicting performance. There just too many factors at play to correctly account for all of them."}, {"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1553760785, "post_id": 55385691, "comment_id": 97506171, "body": "Frankly I would at least <i>like to think</i> that any JSON parsing really should only be used as a <i>&quot;utility&quot;</i> in the cases where you might happen to have <i>raw JSON input</i> rather than a means to construct your coded statements. At any rate the end result needs to get to BSON to be valid for the wire protocol request to the server. It&#39;s a common misconception that JSON is the &quot;lingua franca&quot; for MongoDB, when it just is not. The end result is many things written in other languages with <i>&quot;awkward&quot;</i> JSON strings present in the code. Which is actually pretty awful. IMHO. Still, <b>benchmark it</b>,"}], "answers": [{"comments": [{"owner": {"reputation": 10131, "user_id": 1485926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/t4pjt.jpg?s=128&g=1", "display_name": "fgalan", "link": "https://stackoverflow.com/users/1485926/fgalan"}, "edited": false, "score": 0, "creation_date": 1580496462, "post_id": 60009339, "comment_id": 106129591, "body": "Any feedback about the benchmarking procedure is welcome! :)"}, {"owner": {"reputation": 10131, "user_id": 1485926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/t4pjt.jpg?s=128&g=1", "display_name": "fgalan", "link": "https://stackoverflow.com/users/1485926/fgalan"}, "edited": false, "score": 0, "creation_date": 1581008374, "post_id": 60009339, "comment_id": 106295001, "body": "I have edited my original self-answer to include more information related a test case with basic appender."}], "tags": [], "owner": {"reputation": 10131, "user_id": 1485926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/t4pjt.jpg?s=128&g=1", "display_name": "fgalan", "link": "https://stackoverflow.com/users/1485926/fgalan"}, "is_accepted": true, "score": 2, "last_activity_date": 1581008302, "last_edit_date": 1581008302, "creation_date": 1580495041, "answer_id": 60009339, "question_id": 55385691, "link": "https://stackoverflow.com/questions/55385691/mongoc-driver-bson-construction-stream-based-vs-string-parsing-based-which/60009339#60009339", "title": "MongoC++ driver BSON construction: stream-based vs. string parsing based. Which one has better performance?", "body": "<p>I did some benchmarking at the end. I'm sharing my results in the case they can be useful for others. Driver veresion is 3.4.0.</p>\n\n<p>This is the stream based version:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include &lt;bsoncxx/builder/stream/document.hpp&gt;\n#include &lt;bsoncxx/json.hpp&gt;\n\n#include &lt;mongocxx/client.hpp&gt;\n#include &lt;mongocxx/instance.hpp&gt;\n\n\nint main(int, char**) {\n    mongocxx::instance inst{};\n    mongocxx::client conn{mongocxx::uri{}};\n\n    for (unsigned int ix = 0; ix &lt; 10000000 ; ++ix) {\n       auto builder = bsoncxx::builder::stream::document{};\n       bsoncxx::document::value doc_value = builder\n      &lt;&lt; \"name\" &lt;&lt; \"MongoDB\"\n      &lt;&lt; \"type\" &lt;&lt; \"database\"\n      &lt;&lt; \"count\" &lt;&lt; 1\n      &lt;&lt; \"versions\" &lt;&lt; bsoncxx::builder::stream::open_array\n        &lt;&lt; \"v3.2\" &lt;&lt; \"v3.0\" &lt;&lt; \"v2.6\"\n      &lt;&lt; bsoncxx::builder::stream::close_array\n      &lt;&lt; \"info\" &lt;&lt; bsoncxx::builder::stream::open_document\n        &lt;&lt; \"x\" &lt;&lt; 203\n        &lt;&lt; \"y\" &lt;&lt; 102\n      &lt;&lt; bsoncxx::builder::stream::close_document\n          &lt;&lt; bsoncxx::builder::stream::finalize;\n    }\n}\n</code></pre>\n\n<p>This is the text parsing based version:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include &lt;bsoncxx/builder/stream/document.hpp&gt;\n#include &lt;bsoncxx/json.hpp&gt;\n\n#include &lt;mongocxx/client.hpp&gt;\n#include &lt;mongocxx/instance.hpp&gt;\n\n\nint main(int, char**) {\n    mongocxx::instance inst{};\n    mongocxx::client conn{mongocxx::uri{}};\n\n    for (unsigned int ix = 0; ix &lt; 10000000 ; ++ix) {\n        std::string doc = \"{ \"\n      \"\\\"name\\\" : \\\"MongoDB\\\",\"\n      \"\\\"type\\\" : \\\"database\\\",\"\n      \"\\\"count\\\" : 1,\"\n      \"\\\"versions\\\": [ \\\"v3.2\\\", \\\"v3.0\\\", \\\"v2.6\\\" ],\"\n      \"\\\"info\\\" : {\"\n        \"\\\"x\\\" : 203,\"\n        \"\\\"y\\\" : 102\"\n      \"}\"\n    \"}\";\n       bsoncxx::document::value doc_value = bsoncxx::from_json(doc);\n    }\n}\n</code></pre>\n\n<p>As you see, the structure of the program and the number of iterations (10,000,000) is the same in both cases.</p>\n\n<p>Compiled using:</p>\n\n<pre><code>c++ --std=c++11 test-stream.cpp -o test-stream $(pkg-config --cflags --libs libmongocxx)\nc++ --std=c++11 test-textparsing.cpp -o test-textparsing $(pkg-config --cflags --libs libmongocxx)\n</code></pre>\n\n<p>The results with test-stream (three times):</p>\n\n<pre><code>$ time ./test-stream ; time ./test-stream ; time ./test-stream \n\nreal    0m16,454s\nuser    0m16,200s\nsys 0m0,084s\n\nreal    0m17,034s\nuser    0m16,900s\nsys 0m0,012s\n\nreal    0m18,812s\nuser    0m18,708s\nsys 0m0,036s\n</code></pre>\n\n<p>The results with test-textparsing (also three times):</p>\n\n<pre><code>$ time ./test-textparsing ; time ./test-textparsing ; time ./test-textparsing \n\nreal    0m53,678s\nuser    0m53,576s\nsys 0m0,024s\n\nreal    1m0,203s\nuser    0m59,788s\nsys 0m0,116s\n\nreal    0m57,259s\nuser    0m56,824s\nsys 0m0,200s\n</code></pre>\n\n<p><strong>Conclusion</strong>: the stream based strategy outperforms text-based by large.</p>\n\n<p>A peer check of the experiment would be great to confirm results ;)</p>\n\n<p><strong>EDIT</strong>: I have added a test case based in the basic builder:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include &lt;bsoncxx/builder/stream/document.hpp&gt;\n#include &lt;bsoncxx/json.hpp&gt;\n\n#include &lt;mongocxx/client.hpp&gt;\n#include &lt;mongocxx/instance.hpp&gt;\n\nusing bsoncxx::builder::basic::kvp;\n\nint main(int, char**) {\n    mongocxx::instance inst{};\n    mongocxx::client conn{mongocxx::uri{}};\n\n    for (unsigned int ix = 0; ix &lt; 10000000 ; ++ix) {\n       bsoncxx::builder::basic::document basic_builder{};\n       basic_builder.append(kvp(\"name\", \"MongoDB\"));\n       basic_builder.append(kvp(\"type\", \"database\"));\n       basic_builder.append(kvp(\"count\", 1));\n\n       bsoncxx::builder::basic::array array_builder{};\n       array_builder.append(\"v3.2\");\n       array_builder.append(\"v3.0\");\n       array_builder.append(\"v2.6\");\n       basic_builder.append(kvp(\"versions\", array_builder.extract()));  \n\n       bsoncxx::builder::basic::document object_builder{};\n       object_builder.append(kvp(\"x\", 203));\n       object_builder.append(kvp(\"y\", 102));\n       basic_builder.append(kvp(\"info\", object_builder.extract()));  \n\n       bsoncxx::document::value doc_value = basic_builder.extract();\n    }\n}\n</code></pre>\n\n<p>compiled this way:</p>\n\n<pre><code>c++ --std=c++11 test-basic.cpp -o test-basic $(pkg-config --cflags --libs libmongocxx)\n</code></pre>\n\n<p>I have run again the tests with these results:</p>\n\n<pre><code>basic\n-----\n\nreal    0m20,725s\nuser    0m20,656s\nsys 0m0,004s\n\nreal    0m20,651s\nuser    0m20,620s\nsys 0m0,008s\n\nreal    0m20,102s\nuser    0m20,088s\nsys 0m0,000s\n\nstream\n------\n\nreal    0m11,841s\nuser    0m11,780s\nsys 0m0,024s\n\nreal    0m11,967s\nuser    0m11,932s\nsys 0m0,008s\n\nreal    0m11,634s\nuser    0m11,616s\nsys 0m0,008s\n\ntextparsing\n-----------\n\nreal    0m37,209s\nuser    0m37,184s\nsys 0m0,004s\n\nreal    0m36,336s\nuser    0m36,208s\nsys 0m0,028s\n\nreal    0m35,840s\nuser    0m35,648s\nsys 0m0,048s\n</code></pre>\n\n<p>Conclusions:</p>\n\n<ul>\n<li>Gold medal: stream-based approach</li>\n<li>Silver medal: basic builder approach (times increases 81.8% compared to stream-based)</li>\n<li>Bronze medal: text parsing approach (times increases 227.7% compared to stream-based)</li>\n</ul>\n\n<p>I'd have bet before starting the experiment that basic build will win, but it was stream-based at the end. Maybe there is something woring on my <code>test-basic.cpp</code> code? Or the result makes sense?</p>\n"}], "owner": {"reputation": 10131, "user_id": 1485926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/t4pjt.jpg?s=128&g=1", "display_name": "fgalan", "link": "https://stackoverflow.com/users/1485926/fgalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 60009339, "answer_count": 1, "score": 1, "last_activity_date": 1581008302, "creation_date": 1553717555, "last_edit_date": 1553717882, "question_id": 55385691, "link": "https://stackoverflow.com/questions/55385691/mongoc-driver-bson-construction-stream-based-vs-string-parsing-based-which", "title": "MongoC++ driver BSON construction: stream-based vs. string parsing based. Which one has better performance?", "body": "<p>The <a href=\"http://mongocxx.org/\" rel=\"nofollow noreferrer\">MongoDB C++ driver</a> allows two ways (<a href=\"http://mongocxx.org/mongocxx-v3/working-with-bson/\" rel=\"nofollow noreferrer\">among others</a>) of creating BSON objects.</p>\n\n<p>Based in stream:</p>\n\n<pre><code>auto builder = bsoncxx::builder::stream::document{};\nbsoncxx::document::value doc_value = builder\n  &lt;&lt; \"name\" &lt;&lt; \"MongoDB\"\n  &lt;&lt; \"type\" &lt;&lt; \"database\"\n  &lt;&lt; \"count\" &lt;&lt; 1\n  &lt;&lt; \"versions\" &lt;&lt; bsoncxx::builder::stream::open_array\n    &lt;&lt; \"v3.2\" &lt;&lt; \"v3.0\" &lt;&lt; \"v2.6\"\n  &lt;&lt; close_array\n  &lt;&lt; \"info\" &lt;&lt; bsoncxx::builder::stream::open_document\n    &lt;&lt; \"x\" &lt;&lt; 203\n    &lt;&lt; \"y\" &lt;&lt; 102\n  &lt;&lt; bsoncxx::builder::stream::close_document\n  &lt;&lt; bsoncxx::builder::stream::finalize;\n</code></pre>\n\n<p>Based in parsing a JSON string:</p>\n\n<pre><code>std::string doc = \"{ \"\n  \"\\\"name\\\" : \\\"MongoDB\\\",\"\n  \"\\\"type\\\" : \\\"database\\\",\"\n  \"\\\"count\\\" : 1,\"\n  \"\\\"versions\\\": [ \\\"v3.2\\\", \\\"v3.0\\\", \\\"v2.6\\\" ],\"\n  \"\\\"info\\\" : {\"\n    \"\\\"x\\\" : 203,\"\n    \"\\\"y\\\" : 102\"\n  \"}\"\n\"}\";\nbsoncxx::document::value bsoncxx::from_json(doc);\n</code></pre>\n\n<p>I would like to know which one is the most convenient from the point of view of performance. I tend to think that the number of function calls involved by the stream alternative \"under the hood\" will be worse than procesing the JSON string but it could be the other way around or be equal.</p>\n\n<p>I have tried to find some information about this in the MongoDB C++ driver documentation with no luck. Any information is really welcomed... thanks in advance!</p>\n"}, {"tags": ["c++", "qt", "qt5"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11257231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5099fa60b70232dfe72d545f36c3a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas M&#252;ller", "link": "https://stackoverflow.com/users/11257231/lukas-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1553717696, "post_id": 55385621, "comment_id": 97493333, "body": "it says that is not declared in this scope :("}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553717761, "post_id": 55385621, "comment_id": 97493367, "body": "<code>QObject::connect(linha_button, SIGNAL (clicked()), yourDiagramaObject, SLOT(changeModo()));</code> - better; <code>QObject::connect(linha_button, &amp;QPushButton::clicked, yourDiagramaObject, &amp;Diagrama::changeModo);</code> - will be checked at compile time, not run time and will be faster since it does not involve a bunch of nasty string comparisons (which the old-style macros cause). Use the new compile time checked, member function pointer based, syntax, please. The old <code>SIGNAL()</code> and <code>SLOT()</code> macro crap needs to <i>die</i>."}, {"owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "reply_to_user": {"reputation": 21, "user_id": 11257231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5099fa60b70232dfe72d545f36c3a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas M&#252;ller", "link": "https://stackoverflow.com/users/11257231/lukas-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1553719086, "post_id": 55385621, "comment_id": 97493932, "body": "@lukas M&#252;ller, you have to change <code>yourDiagramaObject</code> by the name of your own object."}], "tags": [], "owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "is_accepted": false, "score": 1, "last_activity_date": 1553717243, "creation_date": 1553717243, "answer_id": 55385621, "question_id": 55385533, "link": "https://stackoverflow.com/questions/55385533/how-to-change-the-value-of-variables-of-another-class-using-qpushbutton/55385621#55385621", "title": "How to change the value of variables of another class using QPushButton?", "body": "<p>Declare a setter as a slot in your <code>Diagrama</code> class and connect your <code>MainWindow</code> to it:</p>\n\n<pre><code>class Diagrama: public QWidget\n{\nQ_OBJECT\n...\npublic slots:\n    void changeModo() { modo = \"trafo\"; }\n};\n</code></pre>\n\n<p>In your <code>MainWindow</code> class:</p>\n\n<pre><code>QObject::connect(linha_button, SIGNAL (clicked()), yourDiagramaObject, SLOT(changeModo()));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "edited": false, "score": 0, "creation_date": 1553761143, "post_id": 55387505, "comment_id": 97506346, "body": "His <code>modo</code> variable is in another class. It will not fix his problem, unfortunately."}, {"owner": {"reputation": 360, "user_id": 2081355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0814b0a48b34336b91e309239ef52310?s=128&d=identicon&r=PG", "display_name": "Artmetic", "link": "https://stackoverflow.com/users/2081355/artmetic"}, "reply_to_user": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "edited": false, "score": 0, "creation_date": 1553856788, "post_id": 55387505, "comment_id": 97550528, "body": "if it is static maybe AnotherClass::modo in this case Diagrama::modo connect(linha_button,&amp;QPushButton::clicked,[this](){ Diagrama::modo = &quot;trafo&quot;; }) ;"}], "tags": [], "owner": {"reputation": 360, "user_id": 2081355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0814b0a48b34336b91e309239ef52310?s=128&d=identicon&r=PG", "display_name": "Artmetic", "link": "https://stackoverflow.com/users/2081355/artmetic"}, "is_accepted": false, "score": 0, "last_activity_date": 1553726150, "last_edit_date": 1553726150, "creation_date": 1553726019, "answer_id": 55387505, "question_id": 55385533, "link": "https://stackoverflow.com/questions/55385533/how-to-change-the-value-of-variables-of-another-class-using-qpushbutton/55387505#55387505", "title": "How to change the value of variables of another class using QPushButton?", "body": "<p>Or use lambda  </p>\n\n<pre><code>connect(linha_button,&amp;QPushButton::clicked,[this](){ modo = \"trafo\"; }) ;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11257231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5099fa60b70232dfe72d545f36c3a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas M&#252;ller", "link": "https://stackoverflow.com/users/11257231/lukas-m%c3%bcller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553726150, "creation_date": 1553716803, "last_edit_date": 1553718119, "question_id": 55385533, "link": "https://stackoverflow.com/questions/55385533/how-to-change-the-value-of-variables-of-another-class-using-qpushbutton", "title": "How to change the value of variables of another class using QPushButton?", "body": "<p>I'm writing a code that i used QWidget to create the widget that i wanted and later i set this widget as a central widget.</p>\n\n<p>So far so good, but in the widget i had buttons, that if one of them was clicked it changed a string variable value.</p>\n\n<p>After that i set this as a central widget, i created the same buttons in the MainWindow, but i can't change the values of the variables that i want anymore :(</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>\n    {..... \n    linha_button=new QPushButton(this);\n    linha_button-&gt;setGeometry(QRect(QPoint(41,924),QSize(40,40)));\n    linha_button-&gt;setIcon(QIcon(url_linha));\n    linha_button-&gt;setIconSize(QSize(30,30));\n    linha_button-&gt;setCheckable(true);\n    QObject::connect(linha_button, SIGNAL (clicked()), this, SLOT (lihaButton()));}\n\nvoid MainWindow::lihaButton()\n{\n     Diagrama::modo=\"trafo\";\n\n}\n</code></pre>\n\n<p>The variable modo is declared in the widget named Diagrama.\nThis code don't execute, the error is:\ninvalid use of non=static data member 'modo'</p>\n\n<p>How can I fix this??</p>\n"}, {"tags": ["c++", "visual-studio-2017"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1553716842, "post_id": 55385495, "comment_id": 97492928, "body": "Maybe just use a <code>std::string</code> instead of all the manual memory management and <code>char*</code> gunk that you are currently doing."}, {"owner": {"reputation": 730, "user_id": 8270416, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/876b251bdfdc25fbda57c01009c054be?s=128&d=identicon&r=PG&f=1", "display_name": "ttemple", "link": "https://stackoverflow.com/users/8270416/ttemple"}, "edited": false, "score": 0, "creation_date": 1553716869, "post_id": 55385495, "comment_id": 97492942, "body": "Is the file really binary?"}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "edited": false, "score": 0, "creation_date": 1553716889, "post_id": 55385495, "comment_id": 97492954, "body": "Is it really a binary file or is it a text file? If it&#39;s really a binary file, treating it like you can trust it&#39;s a text file is probably a problem. If you want to dump the contents, you probably should dump them one character at a time, because it might have, you know, binary data. If it&#39;s a text file, then you should open it as a text file and read into a string. However, Remy&#39;s answer isn&#39;t horrible."}, {"owner": {"reputation": 39, "user_id": 4774361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1404910f958c03b383dd5f1d9fd3f878?s=128&d=identicon&r=PG&f=1", "display_name": "thefighter3", "link": "https://stackoverflow.com/users/4774361/thefighter3"}, "edited": false, "score": 0, "creation_date": 1553717021, "post_id": 55385495, "comment_id": 97493027, "body": "Yes, it is a .dat file"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553718537, "post_id": 55385495, "comment_id": 97493705, "body": "@thefighter3 &quot;it is a .dat file&quot; - the <i>name</i> of the file, including its extension (<code>.dat</code> in this case) means <i>nothing</i>. You can name a PNG file &quot;.txt&quot; if you want to, that doesn&#39;t turn the image into a text document. You cannot infer <i>anything</i> from the file name alone."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 3, "last_activity_date": 1553716911, "creation_date": 1553716911, "answer_id": 55385558, "question_id": 55385495, "link": "https://stackoverflow.com/questions/55385495/how-can-i-add-a-zero-at-the-end-of-a-string/55385558#55385558", "title": "How can I add a zero at the end of a string?", "body": "<p>Simply allocate +1 more <code>char</code> for your array, but don't read into that <code>char</code>, just set it to <code>0</code>:</p>\n\n<pre><code>char buffer[15];\ninp.read(buffer, 14);\nbuffer[14] = '\\0';\ncout &lt;&lt; buffer &lt;&lt; endl;\n</code></pre>\n\n<p>Or, simply don't use a <code>char[]</code> at all, use <code>std::string</code> instead, see:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/116038/\">What is the best way to read an entire file into a std::string in C++?</a></p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 4774361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1404910f958c03b383dd5f1d9fd3f878?s=128&d=identicon&r=PG&f=1", "display_name": "thefighter3", "link": "https://stackoverflow.com/users/4774361/thefighter3"}, "is_accepted": true, "score": 0, "last_activity_date": 1554392793, "creation_date": 1554392793, "answer_id": 55520114, "question_id": 55385495, "link": "https://stackoverflow.com/questions/55385495/how-can-i-add-a-zero-at-the-end-of-a-string/55520114#55520114", "title": "How can I add a zero at the end of a string?", "body": "<p>I did it with the <code>std::string</code> now. If you want you can replace the 14 by an integer variable.</p>\n\n<pre><code>void cSpectrum::readSpectrum(const std::string &amp; filename, double tubeVoltage, double \n        &amp; minEnergy, std::string const &amp; spectrumName){\n\n    ifstream inp(filename, ios::binary);\n\n    //Checks if the file is open\n    if (!inp.is_open()) {\n        throw runtime_error(\"ERROR: Could not open the file!\");\n    }\n\n    //Reads the title\n    string title(14, '\\0');\n    inp.read(&amp;title[0], 14);\n\n    //If it is not the correct file throw an ERROR\n    if (title != spectrumName)\n        throw runtime_error(\"ERROR: Wrong file title\");\n\n    readSpectrum(inp, tubeVoltage, minEnergy, spectrumName);\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4774361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1404910f958c03b383dd5f1d9fd3f878?s=128&d=identicon&r=PG&f=1", "display_name": "thefighter3", "link": "https://stackoverflow.com/users/4774361/thefighter3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 55520114, "answer_count": 2, "score": -1, "last_activity_date": 1554392793, "creation_date": 1553716653, "question_id": 55385495, "link": "https://stackoverflow.com/questions/55385495/how-can-i-add-a-zero-at-the-end-of-a-string", "title": "How can I add a zero at the end of a string?", "body": "<p>I'm trying to read some text out of a file called \"file.dat\". The problem is, that the string in the file does not include a zero at the end as for standard C. So I need something that adds the zero, so I can work with the string without getting random symbols after the string when I print it.</p>\n\n<pre><code>void cSpectrum::readSpectrum(const std::string &amp;filename, double \ntubeVoltage, double &amp;minEnergy, std::string &amp;spectrumName)\n{\n    //Object with the name \"inp\" of the class ifstream\n    ifstream inp(filename, ios::binary);\n\n    //Checks if the file is open\n    if (!inp.is_open()) {\n        throw runtime_error(\"File not open!\");\n    }\n\n    cout &lt;&lt; \"I opened the file!\" &lt;&lt; endl;\n\n    //Check the title of the file\n    string title;\n    char *buffer = new char[14];\n    inp.read(buffer, 14);\n\n    cout &lt;&lt; buffer &lt;&lt; endl;\n}\n</code></pre>\n\n<p>At the moment I get the following output, I would like to get it without the \u00b2\u00b2\u00b2\u00b2\u2518.</p>\n\n<p>I opened the file!</p>\n\n<p>x-ray spectrum\u00b2\u00b2\u00b2\u00b2\u2518</p>\n"}, {"tags": ["c++", "c", "interop"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1553716671, "post_id": 55385467, "comment_id": 97492859, "body": "May be you&#39;d better not compile with code with C++ compiler? This looks like one of the not so many examples when C++ compiler should not be used to compile C headers. I believe your problem does not have a solution in C++. No matter what you do, a nested type in C++ will be a nested type, and will never become global."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1553716782, "post_id": 55385467, "comment_id": 97492901, "body": "By the way, I wonder why this question was downvoted. It is a valid question, even if it doesn&#39;t seem to have a solution."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1553717903, "post_id": 55385467, "comment_id": 97493432, "body": "The only way to fix it sanely is to make the nested declaration in C non-nested.  The local rules for your C code headers that have to be usable from C++ says &quot;though shalt not define a structure or union (or enumeration) type within another structure or union type definition&quot; \u2014 I don&#39;t think you can nest type definitions within an enumeration, so that problem doesn&#39;t arise."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553718128, "post_id": 55385467, "comment_id": 97493536, "body": "Don&#39;t use global variables."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10330832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5dfee0d2329a877bd0d9d0e1689bf90?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Yan", "link": "https://stackoverflow.com/users/10330832/michael-yan"}, "is_accepted": false, "score": 1, "last_activity_date": 1553735815, "creation_date": 1553735815, "answer_id": 55388797, "question_id": 55385467, "link": "https://stackoverflow.com/questions/55385467/c-and-c-header-define-global-struct-inside-of-another-struct/55388797#55388797", "title": "C and C++ header: Define global struct inside of another struct", "body": "<p>I recommend this</p>\n\n<pre><code>struct my_library_a_t {\n    struct my_library_b_t {\n        int data;\n        struct my_library_c_t {\n            int data;\n        } c;\n    } b;\n    int data;\n};\n#ifdef __cplusplus\n    typedef struct my_library_a_t::my_library_b_t my_library_b_t;\n    typedef struct my_library_b_t::my_library_c_t my_library_c_t;\n#else\n    typedef struct my_library_a_t my_library_a_t;\n    typedef struct my_library_b_t my_library_b_t;\n    typedef struct my_library_c_t my_library_c_t;\n#endif\n</code></pre>\n\n<p>Notice that after alias my_library_b_t, you don't need to use my_library_a_t::my_library_b_t::my_library_c_t</p>\n"}], "owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1553735815, "creation_date": 1553716473, "question_id": 55385467, "link": "https://stackoverflow.com/questions/55385467/c-and-c-header-define-global-struct-inside-of-another-struct", "title": "C and C++ header: Define global struct inside of another struct", "body": "<p>I have some C code that has some structs that looks like this:</p>\n\n\n\n<pre class=\"lang-cpp prettyprint-override\"><code>typedef struct my_library_a_t my_library_a_t;\ntypedef struct my_library_b_t my_library_b_t;\ntypedef struct my_library_c_t my_library_c_t;\n\nstruct my_library_a_t {\n    struct my_library_b_t {\n        int data;\n        struct my_library_c_t {\n            int data;\n        } c;\n    } b;\n    int data;\n};\n</code></pre>\n\n<p>This doesn't work in C++, because in C <code>struct my_library_b_t</code> defines a global <code>struct my_library_b_t</code>, whereas in C++ it defines <code>::my_library_a_t::my_library_b_t</code>.</p>\n\n<p>How can I get the inner struct definition to define a global struct in C++? Or even just not have to change too much code for it to work (I don't mind having a <code>#ifdef __cplusplus</code> block, but I don't want to pull the structs out because the reason they are nested in the first place is that they are used only one time each, and it's really hard to read when the inner class definitions are above the outer class definitions)</p>\n\n<p>I tried <code>struct ::my_library_b_t</code> in the definition, but this doesn't work.</p>\n\n<p>For context, I'm parsing a string that has a definition that would look like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>a     = b \",\" data\nb     = data \",\" c\nc     = data\ndata  = %x31-39 *DIGIT  ; 1-9 followed by *(0-9)\n      / \"0\"\n</code></pre>\n\n<p>And the intermediate parts have meaning, so it's useful to be able to have functions that take <code>my_library_b_t*</code> or <code>my_library_c_t*</code>.</p>\n\n<p>I would prefer to have a solution that looks like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#ifdef __cplusplus\n#define GLOBAL_STRUCT(name) ???  (I tried `:: name`)\nextern \"C\" {\n#else\n#define GLOBAL_STRUCT(name) name\n#endif\n\nstruct my_library_a_t {\n    struct GLOBAL_STRUCT(my_library_b_t) {\n// ...\n</code></pre>\n"}, {"tags": ["c++", "winapi", "stdthread"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553717191, "post_id": 55385338, "comment_id": 97493115, "body": "The thread needs the handle from the DLL, it can then wait on the handle and call your event wrapper when signaled"}, {"owner": {"reputation": 1, "user_id": 11268438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781e2dc92152927ad55a85a62923163?s=128&d=identicon&r=PG&f=1", "display_name": "tricostume", "link": "https://stackoverflow.com/users/11268438/tricostume"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553717917, "post_id": 55385338, "comment_id": 97493439, "body": "In both cases I get the handle from the dll. Just in one case I get it at main and in the other inside the event_checking function just before infinite while , in which the handle is waited for many times."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553718380, "post_id": 55385338, "comment_id": 97493650, "body": "Unless the DLL is thread-aware (unlikely), it shouldn&#39;t matter which thread obtains the handle. But, you could always make <code>main</code> obtain the handle first and then pass it to the thread, if needed. Waiting on a handle with <code>WaitForSingleObject()</code> can be done in any thread regardless of which thread obtains the handle. If your thread is not detecting a signal, then either the handle is not being signaled at all, or the handle state is being reset to unsignaled before the thread waits on it."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11268438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781e2dc92152927ad55a85a62923163?s=128&d=identicon&r=PG&f=1", "display_name": "tricostume", "link": "https://stackoverflow.com/users/11268438/tricostume"}, "is_accepted": false, "score": 0, "last_activity_date": 1553842852, "last_edit_date": 1553842852, "creation_date": 1553777518, "answer_id": 55398141, "question_id": 55385338, "link": "https://stackoverflow.com/questions/55385338/how-to-make-waitforsingleobject-receive-a-signal-inside-a-thread-called-from-mai/55398141#55398141", "title": "How to make WaitForSingleObject receive a signal inside a thread called from main as a class member function?", "body": "<p>I solved the issue. So everything Remy Lebeau said was true. In the end the dll had a function to activate the reception of signals through the event handle that I had to call before. So in reality no signals were coming but just to be informative what I could confirm after this debugging experience was basically that \"parent\" threads need to be kept alive in Windows, winapi WaitForSingleObject() keeps the state of an event signaled if it has not been waited for and new re-setting an event does not change its state (remains signaled) as long as no thread has waited for it (after which it changes to unsignaled mode) so time issues do not arise. As a matter of fact, it should be checked if the events provided by 3d party software care about the thread in which it was created and if therefore there is no problem where the handle is retrieved. Thanks!</p>\n"}], "owner": {"reputation": 1, "user_id": 11268438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781e2dc92152927ad55a85a62923163?s=128&d=identicon&r=PG&f=1", "display_name": "tricostume", "link": "https://stackoverflow.com/users/11268438/tricostume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553842852, "creation_date": 1553715918, "last_edit_date": 1553753117, "question_id": 55385338, "link": "https://stackoverflow.com/questions/55385338/how-to-make-waitforsingleobject-receive-a-signal-inside-a-thread-called-from-mai", "title": "How to make WaitForSingleObject receive a signal inside a thread called from main as a class member function?", "body": "<p>I have a working piece of code on main function in Windows with C++ like:</p>\n\n<pre><code>some_handle = dll_generate_handle;\nwhile(true) {\n    if(WaitForSingleObject(some_handle,100)){\n          //CODE I AM INTERESTED ABOUT\n    }\n}\n</code></pre>\n\n<p>The signal comes from a dll function.\nI attempt to port this principle into a framework in the next manner:</p>\n\n<ol>\n<li><p>I have a main again but this main gets the static instance of a class i1. This class has a member function \"event_checking\" doing the same piece of code above.</p></li>\n<li><p>I can access to this event_checking function through an instance i2 of an intermediate class so I decided to Wrap i1.event_checking with</p>\n\n<pre><code>void eventCheckingWrapper(){\n    i1.event_checking();\n}\n</code></pre></li>\n<li><p>Still in the main I spawn a thread on eventCheckingWrapper. So I am not interested in the thread returning as long as signals arrive.\nAn example of this principle could be:</p>\n\n<pre><code>std::thread t(&amp;ClassName::eventCheckingWrapper, &amp;i2);\n</code></pre></li>\n</ol>\n\n<p>The thread is running well but no signals are arriving such that the timeout is always reached and the thread starts over in its while loop.</p>\n\n<p>How can I properly get this to work?</p>\n"}, {"tags": ["c++", "eclipse"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1553716089, "post_id": 55385317, "comment_id": 97492579, "body": "you should omit <code>lib</code> prefix when linking libraries. Also you have multiple definition errors, most likely you have a non-inline function definition in header file or including cpp file."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553716633, "post_id": 55385317, "comment_id": 97492846, "body": "<code>&#47;home&#47;chris&#47;Programs&#47;lib&#47;SFML-2.5.1</code> looks like a different path from <code>&#47;home&#47;chris&#47;Programs&#47;lib&#47;SFML-2.5.1&#47;lib&#47;libsfml-system.so</code> did you need to use <code>&#47;home&#47;chris&#47;Programs&#47;lib&#47;SFML-2.5.1&#47;lib</code> and drop the lib prefix?"}, {"owner": {"reputation": 1, "user_id": 5678211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f62f92c85ab0210e6b334f9c9f64c1?s=128&d=identicon&r=PG&f=1", "display_name": "AshKetchupp", "link": "https://stackoverflow.com/users/5678211/ashketchupp"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553717505, "post_id": 55385317, "comment_id": 97493254, "body": "@drescherjm I have a folder of libraries called lib and inside the libaries folder it also has a folder called lib so they&#39;re different folders, changing the prefix has not done anything. I tried changing the file path for Project Properties &gt;&gt; C/C++ General &gt;&gt; Paths and Symbols &gt;&gt; Library Paths to have the /SFML-2.5.1/lib instead of just /SFML-2.5.1"}], "owner": {"reputation": 1, "user_id": 5678211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f62f92c85ab0210e6b334f9c9f64c1?s=128&d=identicon&r=PG&f=1", "display_name": "AshKetchupp", "link": "https://stackoverflow.com/users/5678211/ashketchupp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553715895, "creation_date": 1553715834, "last_edit_date": 1553715895, "question_id": 55385317, "link": "https://stackoverflow.com/questions/55385317/c-eclipse-linker-usr-bin-ld-cannot-find-so-files", "title": "C++ Eclipse Linker, /usr/bin/ld cannot find .so files", "body": "<p>I'm trying to compile a project for learning C++ and have struggled with this for a while, searching about has yielded no results. I'm trying to include .so files in another folder but the compiler (g++) cannot find the files in the directory even though they exist and Eclipse tells me it can find them. (So I know I'm not making a mistake about their location)</p>\n\n<p>My console output is the following</p>\n\n<pre><code>Info: Internal Builder is used for build\ng++ -L/home/chris/Programs/lib/SFML-2.5.1 -o space Graphics.o Physics.o main.o -llibsfml-network.so -llibsfml-graphics.so -l../../../lib/SFML-2.5.1/lib/libsfml-audio.so -llibsfml-window -l/home/chris/Programs/lib/SFML-2.5.1/lib/libsfml-system.so \n/usr/bin/ld: Physics.o: in function `std::iterator_traits&lt;long double const*&gt;::iterator_category std::__iterator_category&lt;long double const*&gt;(long double const* const&amp;)':\n/home/chris/Programs/C++/space/Debug/../SEntity.h:22: multiple definition of `createEntity(long double, long double, long double, long double, long double, int)'; Graphics.o:/home/chris/Programs/C++/space/Debug/../SEntity.h:22: first defined here\n/usr/bin/ld: main.o: in function `std::iterator_traits&lt;long double const*&gt;::iterator_category std::__iterator_category&lt;long double const*&gt;(long double const* const&amp;)':\n/usr/include/c++/8/bits/vector.tcc:478: multiple definition of `createEntity(long double, long double, long double, long double, long double, int)'; Graphics.o:/home/chris/Programs/C++/space/Debug/../SEntity.h:22: first defined here\n/usr/bin/ld: cannot find -llibsfml-network.so\n/usr/bin/ld: cannot find -llibsfml-graphics.so\n/usr/bin/ld: cannot find -l../../../lib/SFML-2.5.1/lib/libsfml-audio.so\n/usr/bin/ld: cannot find -llibsfml-window\n/usr/bin/ld: cannot find -l/home/chris/Programs/lib/SFML-2.5.1/lib/libsfml-system.so\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I've included multiple methods of finding the files but none have worked.</p>\n\n<p>In Eclipse I've also added the include folder (with .h files) of the library to </p>\n\n<p>Project Properties >> C/C++ General >> Paths and Symbols >> Includes</p>\n\n<p>And the folder of the library (highest level folder) to</p>\n\n<p>Project Properties >> C/C++ General >> Paths and Symbols >> Library Paths</p>\n"}, {"tags": ["c++", "windows", "http-post", "libcurl", "iso-8859-1"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553719121, "post_id": 55385298, "comment_id": 97493950, "body": "You are not supposed to encode the binary file data AT ALL, you are supposed to send its raw bytes AS-IS, that is what <code>application&#47;octet-stream</code> does. When using libcurl, you should be using <a href=\"https://curl.haxx.se/libcurl/c/curl_mime_init.html\" rel=\"nofollow noreferrer\"><code>curl_mime_init()</code></a>, <a href=\"https://curl.haxx.se/libcurl/c/curl_mime_addpart.html\" rel=\"nofollow noreferrer\"><code>curl_mime_addpart()</code></a>, <a href=\"https://curl.haxx.se/libcurl/c/curl_mime_filedata.html\" rel=\"nofollow noreferrer\"><code>curl_mime_filedata()</code></a>, etc to prepare a <code>multipart&#47;form-data</code> request, and then send it using <a href=\"https://curl.haxx.se/libcurl/c/CURLOPT_MIMEPOST.html\" rel=\"nofollow noreferrer\"><code>CURLOPT_MIMEPOST</code></a>..."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553719373, "post_id": 55385298, "comment_id": 97494084, "body": "... even the older <a href=\"https://curl.haxx.se/libcurl/c/CURLOPT_HTTPPOST.html\" rel=\"nofollow noreferrer\"><code>CURLOPT_HTTPPOST</code></a> can post a binary file in <code>multipart&#47;form-data</code> format via <a href=\"https://curl.haxx.se/libcurl/c/curl_formadd.html\" rel=\"nofollow noreferrer\"><code>curl_formadd(CURLFORM_FILE)</code></a>."}, {"owner": {"reputation": 13, "user_id": 11167502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d3c54e9543240196e01c6d7e5e6fff?s=128&d=identicon&r=PG&f=1", "display_name": "Veronian", "link": "https://stackoverflow.com/users/11167502/veronian"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553822801, "post_id": 55385298, "comment_id": 97538677, "body": "@RemyLebeau I thought it was a bit weird to change from binary to ISO-8859-1 but as I indicated I&#39;m not an experienced HTTP programmer.  I was just following the PowerShell script that I was given and that&#39;s what it appeared to be doing.  Before seeing your reply I had converted over to using the &#39;mime&#39; functions and it almost worked.  I just posted another question on this forum that perhaps you could provide an answer for.  The upload appears to start okay but does not complete the entire file.  Thanks again for your help."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553834483, "post_id": 55385298, "comment_id": 97541106, "body": "I posted an answer to your <a href=\"https://stackoverflow.com/questions/55409192/\">other question</a>."}], "owner": {"reputation": 13, "user_id": 11167502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d3c54e9543240196e01c6d7e5e6fff?s=128&d=identicon&r=PG&f=1", "display_name": "Veronian", "link": "https://stackoverflow.com/users/11167502/veronian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553718759, "creation_date": 1553715779, "last_edit_date": 1553718759, "question_id": 55385298, "link": "https://stackoverflow.com/questions/55385298/how-do-i-encode-binary-file-data-to-iso-8859-1-to-attach-to-the-body-of-an-http", "title": "How do I encode binary file data to ISO-8859-1 to attach to the body of an HTTP post message", "body": "<p>I'm trying to convert the full string of bytes from a file opened in binary mode to a string encoded in the ISO-8859-1 character set.  My understanding is that by converting to ISO-8859-1 all binary information from the file is retained which is why it is being converted to that format.  Is this a valid statement?</p>\n\n<p>I'm working in C++ (Visual Studio 2017) building an executable to be used on the Windows platform.  I'm not experienced in HTTP programming.</p>\n\n<p>I have prototype code written in PowerShell code which successfully performs the functionality that I'm trying to duplicate in C++.  In the power shell code an HTTP message is sent to upload a firmware file to a device.</p>\n\n<ul>\n<li>The message includes headers and a body:</li>\n<li>The message is using the multipart/form-data protocol.</li>\n</ul>\n\n<p>An example of the headers of the message are:</p>\n\n<pre>\nAuthorization: Bearer Yosda0IDRQuVaU_L0SnV5g==                                                                                                              \nContent-Type: multipart/form-data; boundary=42b745c8-4da8-454e-8c13-cbb5c1f7694f                                                                           \nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  \n</pre>\n\n<p>An example of the body of the message is:</p>\n\n<pre>\n--1a2fc07a-d882-4470-a1da-79716d34cd9b\nContent-Disposition: form-data; name=\"upgrade_file\"; filename=\"\"\nContent-Type: application/octet-stream\n\n// File data (encoded in ISO-8859-1 format) goes here //\n--1a2fc07a-d882-4470-a1da-79716d34cd9b\nContent-Disposition: form-data; name=\"submit\"\n\nInstall OS\n--1a2fc07a-d882-4470-a1da-79716d34cd9b--\n</pre>\n\n<p>The PowerShell script is converting the file with the following lines of code: </p>\n\n<pre><code>$bytes = [System.IO.File]::ReadAllBytes($file.FullName);\nif ( $bytes )\n{\n  $enc = [System.Text.Encoding]::GetEncoding(iso-8859-1);\n  $data = $enc.GetString($bytes);\n}\n</code></pre>\n\n<p>Once the headers and body are setup the message is sent and the firmware is uploaded when running the PowerShell code.</p>\n\n<p>In my C++ code I've got the headers and the pre-body and post-body codes worked out.  I think (not sure) that I just need to convert the file to iso-8859-1 to get the message to work now.</p>\n\n<p>I'm using libcurl to send the message.</p>\n\n<pre><code>res = curl_easy_perform(pCurl);\n</code></pre>\n\n<p>Currently (without converting file to iso-8859-1) I get the following error message from the function call: </p>\n\n<blockquote>\n  <p>Failure when receiving data from the peer</p>\n</blockquote>\n\n<p>When the message is sent I can see that only some bytes are uploaded.  I assume that could be because the file data is not properly encoded and when it is reading that data it reaches some point where the data is in a format that it cannot handle.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 830, "user_id": 1794179, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/BnY2x.jpg?s=128&g=1", "display_name": "Sceptical Jule", "link": "https://stackoverflow.com/users/1794179/sceptical-jule"}, "edited": false, "score": 1, "creation_date": 1553716199, "post_id": 55385281, "comment_id": 97492639, "body": "Do you really have to work with raw arrays? This would be much easier to achieve with STL."}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "reply_to_user": {"reputation": 830, "user_id": 1794179, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/BnY2x.jpg?s=128&g=1", "display_name": "Sceptical Jule", "link": "https://stackoverflow.com/users/1794179/sceptical-jule"}, "edited": false, "score": 0, "creation_date": 1553716744, "post_id": 55385281, "comment_id": 97492886, "body": "@ScepticalJule telling raw beginners to work with the stl is hardly helpful. if he doesn&#39;t understand the basics of arrays, he&#39;s been learning for about 10 minutes. This is clearly a learning exercise, and no way is he ready to learn the stl."}], "answers": [{"comments": [{"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 1, "creation_date": 1553716374, "post_id": 55385386, "comment_id": 97492727, "body": "This answer it too cryptographic to me"}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1553716680, "post_id": 55385386, "comment_id": 97492864, "body": "@Amadeus cryptographic? Perhaps you mean confusing? Look at his if(size == capacity) code block. He only adds to the array if a resize is required."}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1553717313, "post_id": 55385386, "comment_id": 97493169, "body": "I&#39;m sorry, this was a kind of sarcasm to say that your answer is too dificult to undersand. It would be easier if you shows in code what do you really means or want to say in words"}, {"owner": {"reputation": 45, "user_id": 11258961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a31a33a954960a62bda68aa6f3494?s=128&d=identicon&r=PG&f=1", "display_name": "gLee", "link": "https://stackoverflow.com/users/11258961/glee"}, "edited": false, "score": 0, "creation_date": 1553717745, "post_id": 55385386, "comment_id": 97493360, "body": "It worked out Joseph, i put input and size++ right below cin&gt;&gt;input;"}], "tags": [], "owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "is_accepted": true, "score": 0, "last_activity_date": 1553716158, "creation_date": 1553716158, "answer_id": 55385386, "question_id": 55385281, "link": "https://stackoverflow.com/questions/55385281/dynamic-array-storing-values/55385386#55385386", "title": "Dynamic array storing values", "body": "<p>Your if statement whether you need to resize the array is too encompassing. The {} should contain just the resize, then outside the {} is when you should store into the array.</p>\n\n<p>Instead, size is 0, which != capacity, so you don't do anything.</p>\n"}], "owner": {"reputation": 45, "user_id": 11258961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a31a33a954960a62bda68aa6f3494?s=128&d=identicon&r=PG&f=1", "display_name": "gLee", "link": "https://stackoverflow.com/users/11258961/glee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55385386, "answer_count": 1, "score": 0, "last_activity_date": 1553716158, "creation_date": 1553715704, "question_id": 55385281, "link": "https://stackoverflow.com/questions/55385281/dynamic-array-storing-values", "title": "Dynamic array storing values", "body": "<p>I resized my array with a function, however it seems like it does not store any array value I entered.</p>\n\n<p>basically I put -1, the loop stops and then supposed to show the elements in array. but it does not show anything.</p>\n\n<p>The output does not show anything after cout.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nvoid resize(int *&amp;arr, int &amp;size){\n    int tempsize=size;\n    size=size+10;\n    int *temp= new int [size];\n    for(int i=0; i&lt;tempsize;i++){\n        temp[i]=arr[i];\n    }\n    delete [] arr;\n    arr=temp;    \n}\n\nint main()\n{\n    int size=0;\n    int capacity =10;\n    int *p=new int[capacity];\n    int check=0;\n    int input;\n\n    cout&lt;&lt;\"Please enter the number in array and input -1 to end it.\";\n\n    while(check!=-1)\n    {\n        cin&gt;&gt;input;\n        if(input==-1)\n            {check=-1;}\n        else{\n        if(size==capacity){\n            resize(p,capacity);\n            p[size]=input;\n            size++;\n        }\n        }\n\n    }\n\n    cout&lt;&lt;\"Show me the numbers in array: \";\n\n    for(int i=0; i&lt;size;i++){\n        cout&lt;&lt;p[i]&lt;&lt;\" \";\n    }\n    cout&lt;&lt;endl;\n\n    delete [] p;\n\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "libexif"], "comments": [{"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1553714769, "post_id": 55384840, "comment_id": 97491942, "body": "Did you check what&#39;s the value of <code>qba-&gt;data()</code>?"}, {"owner": {"reputation": 13, "user_id": 11267851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a833e69bab7284e204702beb92df59b?s=128&d=identicon&r=PG&f=1", "display_name": "Hephaestsus", "link": "https://stackoverflow.com/users/11267851/hephaestsus"}, "reply_to_user": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1553715635, "post_id": 55384840, "comment_id": 97492369, "body": "Yeah, even after  <code>ent-&gt;data = (unsigned char*)get_c_str(ui-&gt;modelL-&gt;text());</code> i get correct string data in ent-&gt;data"}], "owner": {"reputation": 13, "user_id": 11267851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a833e69bab7284e204702beb92df59b?s=128&d=identicon&r=PG&f=1", "display_name": "Hephaestsus", "link": "https://stackoverflow.com/users/11267851/hephaestsus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553716058, "creation_date": 1553713803, "last_edit_date": 1553714222, "question_id": 55384840, "link": "https://stackoverflow.com/questions/55384840/how-to-save-char-tag-values-in-libexif", "title": "How to save char* tag values in libexif", "body": "<p>I'm having an issue with libexif saving tags string data. I'm allocating memory for string value, using strcpy and then just assiggn pointer to specific tags entry->data. Problem is - saving with exif_data_save_data and fwrite, i get my string value cutted to 7 chars. If I load all this data at first from file with longer string value for this specific exif tag (EXIF_TAG_NAME in particular), max string len coud be different.</p>\n\n<pre><code>static char* get_c_str(QString qs)\n{\n    QByteArray *qba = new QByteArray(qs.toLatin1());\n    char* str = (char *)malloc(qba-&gt;count());\n    strcpy(str,qba-&gt;data());\n\n    return str;\n}\n\n\nstatic ExifEntry *init_tag(ExifData *exif, ExifIfd ifd, ExifTag tag)\n{\n    ExifEntry *entry;\n\n    if (!((entry = exif_content_get_entry (exif-&gt;ifd[ifd], tag)))) {\n\n        entry = exif_entry_new ();\n        assert(entry != NULL); \n        entry-&gt;tag = tag;\n\n        exif_content_add_entry (exif-&gt;ifd[ifd], entry);\n\n        exif_entry_initialize (entry, tag);\n\n        exif_entry_unref(entry);\n    }\n    return entry;\n}\n\nvoid MainWindow::on_writeButton_clicked()\n{\n    if(!buf)\n        return;\n\n    ent = init_tag(ed,ExifIfd::EXIF_IFD_0,ExifTag::EXIF_TAG_MODEL);\n    ent-&gt;data = (unsigned char*)get_c_str(ui-&gt;modelL-&gt;text());\n\n    ................................................\n\n    exif_data_save_data(ed, &amp;exifData, &amp;exifDatLen);\n\n    f = fopen(path, \"wb\");\n\n    fwrite(exif_header,exif_header_len,1,f);\n\n    fputc((exifDatLen+2)&gt;&gt;8,f);\n    fputc((exifDatLen+2) &amp; 0xff, f);\n\n    fwrite(exifData,exifDatLen,1,f);\n    fwrite(buf+image_data_offset,flen,1,f);\n\n    fclose(f);\n}\n</code></pre>\n\n<p>Expected Camera Model to be \"Canon EOS 5D Mark II\" but was \"Canon E\"</p>\n"}, {"tags": ["android", "c++", "audio", "oboe"], "comments": [{"owner": {"reputation": 157, "user_id": 9241727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-feSsNAvzjJI/AAAAAAAAAAI/AAAAAAAALD8/lSPmnaTazZc/photo.jpg?sz=128", "display_name": "Jazib Khan", "link": "https://stackoverflow.com/users/9241727/jazib-khan"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1553713812, "post_id": 55384777, "comment_id": 97491518, "body": "I tried 0.2f instead of 2, still it&#39;s distorting heavily."}], "answers": [{"tags": [], "owner": {"reputation": 12122, "user_id": 824903, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0903f3a872eef8fded8e48257fde823?s=128&d=identicon&r=PG", "display_name": "donturner", "link": "https://stackoverflow.com/users/824903/donturner"}, "is_accepted": true, "score": 1, "last_activity_date": 1554202641, "creation_date": 1554202641, "answer_id": 55473068, "question_id": 55384777, "link": "https://stackoverflow.com/questions/55384777/how-to-amplify-audio-data-in-oboe-onaudioready-method/55473068#55473068", "title": "How to amplify Audio Data in Oboe onAudioReady Method?", "body": "<p>In the LiveEffect sample both the recording and playback streams are <code>AudioFormat::I16</code> i.e. 16 bit integers. On this line you're casting to <code>float</code>: </p>\n\n<pre><code>auto *outputData = static_cast&lt;float *&gt;(audioData);    \n</code></pre>\n\n<p>This is going to cause the distortion you hear so instead just cast to <code>int16_t</code> and multiply by a constant amplitude.</p>\n\n<p>Make sure to check that the scaled up sample value isn't above <code>INT16_MAX</code> otherwise you'll get wraparound and distortion.</p>\n"}], "owner": {"reputation": 157, "user_id": 9241727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-feSsNAvzjJI/AAAAAAAAAAI/AAAAAAAALD8/lSPmnaTazZc/photo.jpg?sz=128", "display_name": "Jazib Khan", "link": "https://stackoverflow.com/users/9241727/jazib-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 55473068, "answer_count": 1, "score": 1, "last_activity_date": 1592054043, "creation_date": 1553713594, "last_edit_date": 1592054043, "question_id": 55384777, "link": "https://stackoverflow.com/questions/55384777/how-to-amplify-audio-data-in-oboe-onaudioready-method", "title": "How to amplify Audio Data in Oboe onAudioReady Method?", "body": "<p>I want to amplify the audioData that is recorded by microphone using Oboe Library. \nI created AudioEngine.cpp like this: <a href=\"https://github.com/google/oboe/blob/master/samples/LiveEffect/src/main/cpp/LiveEffectEngine.cpp\" rel=\"nofollow noreferrer\">https://github.com/google/oboe/blob/master/samples/LiveEffect/src/main/cpp/LiveEffectEngine.cpp</a>\nHere's is the class that has audioData:</p>\n\n<pre><code>DataCallbackResult\nAudioEngine::onAudioReady(AudioStream *oboeStream, void *audioData, int32_t numFrames) {\n\n    /* some code */\n\n\n // add your audio processing here\n\n    return DataCallbackResult::Continue;\n}\n</code></pre>\n"}, {"tags": ["c++", "linux", "fork"], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1553713627, "last_edit_date": 1553713627, "creation_date": 1553712928, "answer_id": 55384609, "question_id": 55384551, "link": "https://stackoverflow.com/questions/55384551/how-to-print-the-child-process-with-their-name-and-pid-once-under-the-last-child/55384609#55384609", "title": "How to print the child process with their name and pid once under the last child fork()", "body": "<pre><code> child_A=fork();\n if(x==0){\n    cout&lt;&lt;\"i am child A\" &lt;&lt; child_A &lt;&lt; \"\\n\";\n    cout&lt;&lt;\"i am child B\" &lt;&lt; child_B &lt;&lt; \"\\n\";\n    cout&lt;&lt;\"i am child C\" &lt;&lt; child_C &lt;&lt; \"\\n\";\n    x++;\n }\n</code></pre>\n\n<p>Either <code>x</code> is 0 or it's not. If <code>x</code> is zero, then neither of the processes returning from the <code>fork</code> call will produce output. If <code>x</code> is not zero, then both processes will produce output. So your expected output seems impossible. How can each of these output lines run once?</p>\n\n<p>Presumably, <code>x</code> was zero. So both processes produced output. The differt \"child A\" values show that one of these came from the parent and one from the child.</p>\n"}, {"tags": [], "owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "is_accepted": false, "score": 1, "last_activity_date": 1553713030, "creation_date": 1553713030, "answer_id": 55384643, "question_id": 55384551, "link": "https://stackoverflow.com/questions/55384551/how-to-print-the-child-process-with-their-name-and-pid-once-under-the-last-child/55384643#55384643", "title": "How to print the child process with their name and pid once under the last child fork()", "body": "<p>Pay attention to where your last fork is in relation to the couts. If you'll notice, the PID for child A is different each time it is printed, while the other two are the same. The PID will be 0 if it's the child, while the PID will be something else if it's the parent. Since the child A prints two different things, it's happening in both the child and the parent. </p>\n"}], "owner": {"reputation": 1, "user_id": 10666786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1tC17OgNsPU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jXd-D2v1nYT4v30ntOeQPI3Aqqcw/mo/photo.jpg?sz=128", "display_name": "Simon", "link": "https://stackoverflow.com/users/10666786/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1553716710, "creation_date": 1553712702, "last_edit_date": 1553716710, "question_id": 55384551, "link": "https://stackoverflow.com/questions/55384551/how-to-print-the-child-process-with-their-name-and-pid-once-under-the-last-child", "title": "How to print the child process with their name and pid once under the last child fork()", "body": "<p>I am learning how to generate process in Linux using C++ <code>fork()</code> method. When i tried to print out their pid with ChildA,B,C i have created. It print out twice. If i only want them print once, how can i change the code.</p>\n\n<p>I tried to put an count under the print out command. When it print out once it should stop and not more printing again.</p>\n\n<pre><code>child_C=fork();\nif(Child_C==0){\n  //do some function here;\n}else{\n  child_B=fork();\n  if(Child_B==0){\n    //do some function here;\n    }else{\n     child_A=fork();\n     if(x==0){\n        cout&lt;&lt;\"i am child A\" &lt;&lt; child_A &lt;&lt; \"\\n\";\n        cout&lt;&lt;\"i am child B\" &lt;&lt; child_B &lt;&lt; \"\\n\";\n        cout&lt;&lt;\"i am child C\" &lt;&lt; child_C &lt;&lt; \"\\n\";\n        x++;\n     }\n     if(Child_A==0){\n        //do some function here;\n     }else{\n         //do some function here;\n     }\n  }\n}\n</code></pre>\n\n<p>i expect the output:<br/></p>\n\n<pre><code>i am child A 123\ni am child B 234\ni am child C 345\n</code></pre>\n\n<p>but it prints out:<br/></p>\n\n<pre><code>i am child A 123\ni am child B 234\ni am child C 345\ni am child A 0\ni am child B 234\ni am child C 345\n</code></pre>\n"}, {"tags": ["c++", "istream", "streambuf"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553712925, "post_id": 55384512, "comment_id": 97491104, "body": "<i>&quot;but to reimplement streambuf&quot;</i> I doubt that it&#39;s reasonably possible with that restriction. But &#175;_(\u30c4)_/&#175; who knows ..."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553713039, "post_id": 55384512, "comment_id": 97491158, "body": "it is not clear how you want to read from several files. how to wrap that into a <code>std::istream</code> interface is kind of secondary before you know how to read from multiple files and what to do with their contents"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553713165, "post_id": 55384512, "comment_id": 97491206, "body": "&quot;how would i be able to read from multiple files without having them all in memory&quot; - I doubt you will be able to, without having at least <i>parts</i> of them in memory. How would you read something that&#39;s not available for you to read?"}, {"owner": {"reputation": 366, "user_id": 741646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5acffcfc1c672d0a7901ede6d19f45f0?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/741646/kai"}, "edited": false, "score": 0, "creation_date": 1553713196, "post_id": 55384512, "comment_id": 97491229, "body": "I&#39;m struggling a bit myself, this might not make sense. So here is a preliminary &quot;idea&quot; how it could work: create a buffer, stream the file into the buffer, and if one file is done and the buffer has space left - start loading the other file into it. I am kind of dubious about the idea myself and ask myself if this is good design, hence the ask."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553713258, "post_id": 55384512, "comment_id": 97491267, "body": "in what order do you want to read the contents? if it is one file after the other, you dont have to write anything yourself"}, {"owner": {"reputation": 366, "user_id": 741646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5acffcfc1c672d0a7901ede6d19f45f0?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/741646/kai"}, "edited": false, "score": 0, "creation_date": 1553713367, "post_id": 55384512, "comment_id": 97491310, "body": "Did I miss something obvious? I want to read: file1start -- file1end file2start--file2end  file3start -- ... and so forth, you get the idea."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553714152, "post_id": 55384512, "comment_id": 97491666, "body": "why cant you just read till the end then open the next? I dont understand why you think you need to &quot;create a istream class&quot; or what that is supposed to mean exactly. What problem are you actually trying to solve? Can you show some example code?"}, {"owner": {"reputation": 366, "user_id": 741646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5acffcfc1c672d0a7901ede6d19f45f0?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/741646/kai"}, "edited": false, "score": 0, "creation_date": 1553714328, "post_id": 55384512, "comment_id": 97491748, "body": "I&#39;m asking myself the same question, you seem to have the same suspicions - code is currently not available, but that part is in it&#39;s infancy anyway. I have to give a istream of some kind to another third party object - so could I just: 1.create an ifstream 2.stream file1 3.close,clear,open file2 4. stream file2 and so forth?"}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1553717539, "post_id": 55384512, "comment_id": 97493270, "body": "If you just want to read from the files sequentially, an easier approach might be to just concatenate them together from the shell, e.g. <code>cat file0 file1 file2 | .&#47;your_program</code> (replace <code>cat</code> with <code>type</code> for windows).  This will work exactly as you want; it won&#39;t keep everything in memory at once."}, {"owner": {"reputation": 27199, "user_id": 427158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f706984800b6d136b9331a6ee20c676f?s=128&d=identicon&r=PG", "display_name": "maxschlepzig", "link": "https://stackoverflow.com/users/427158/maxschlepzig"}, "edited": false, "score": 0, "creation_date": 1616955227, "post_id": 55384512, "comment_id": 118158424, "body": "Similar question (asked in 2013): <a href=\"https://stackoverflow.com/q/19506444/427158\">Composite std::istream in C++</a>"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1553720231, "post_id": 55385634, "comment_id": 97494510, "body": "Implementing a custom <code>std::streambuf</code>/<code>std::filebuf</code> would likely be easier/better than implementing a custom <code>std:istream</code>. When the stream buffer encounters an EOF while reading in data, it can simply open the next file and keep reading, the <code>istream</code> won&#39;t know the difference."}, {"owner": {"reputation": 366, "user_id": 741646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5acffcfc1c672d0a7901ede6d19f45f0?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/741646/kai"}, "edited": false, "score": 0, "creation_date": 1553765769, "post_id": 55385634, "comment_id": 97508882, "body": "I&#39;ll definitely try it, thank you both! Anyone know of a verbose description of the interface of streambuf?"}], "tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": true, "score": 1, "last_activity_date": 1553717308, "creation_date": 1553717308, "answer_id": 55385634, "question_id": 55384512, "link": "https://stackoverflow.com/questions/55384512/c-how-to-write-a-ifstream-for-multiple-files/55385634#55385634", "title": "C++ how to write a ifstream for multiple files?", "body": "<h3>Is it possible to make an <code>istream</code> that reads multiple files?</h3>\n\n<p>Yes, but you'll have to make it yourself. You can implement your own <code>istream</code> class by extending <code>std::istream</code>, and then implementing the methods it defines:</p>\n\n<pre><code>class custom_istream : public std::istream {\n    std::ifstream underlying; \n    //... implement methods\n};\n</code></pre>\n\n<p>The interface of <code>std::istream</code> is sufficiently flexible to allow you to do what you want. <em>However</em>, implementing <code>std::istream</code> would require a lot of work, as you'd have to implement the entirety of the interface. </p>\n\n<h3>Is there an easier solution?</h3>\n\n<p>If you only need a subset of the functionality provided by <code>std::istream</code>, you could just write your own class.</p>\n\n<p>For example, if you only need to be able to read lines from the file, the below class will work just fine for multiple files:</p>\n\n<pre><code>class MultiFileReader {\n    std::ifstream filestream; \n    std::ios_base::openmode mode;  \n    size_t file_index = 0; \n    std::vector&lt;std::string&gt; filenames; \n    void open_next_file() {\n        file_index++; \n        filestream = std::ifstream(filenames.at(file_index), mode); \n    }\n   public:\n    MultiFileReader(std::vector&lt;std::string&gt; const&amp; files, std::ios_base::openmode mode)\n      : filestream(files[0], mode), mode(mode) {}\n    // Checks if there's no more files to open, and no more to read\n    // in the current file\n    bool hasMoreToRead() {\n        if(file_index == filenames.size()) return false;\n        if(file_index + 1 == filenames.size()) \n            return not filestream.eof(); \n        return true;\n    }\n    std::string read_line() {\n        if(not hasMoreToRead()) {\n            throw std::logic_error(\"No more to read\"); \n        }\n        // If at the end of the file, open the next file\n        if(filestream.eof()) {\n            open_next_file(); \n        }\n        else {\n            std::string line; \n            std::getline(filestream, line);\n            return line; \n        }\n    }\n};  \n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 741646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5acffcfc1c672d0a7901ede6d19f45f0?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/741646/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 55385634, "answer_count": 1, "score": -1, "last_activity_date": 1553717308, "creation_date": 1553712554, "question_id": 55384512, "link": "https://stackoverflow.com/questions/55384512/c-how-to-write-a-ifstream-for-multiple-files", "title": "C++ how to write a ifstream for multiple files?", "body": "<p>So I have several files that form a contingent number of lines, so let's call them file1, file2, file3 and so forth. What I want to do is to create a istream class which streams all the files as if they were one. One thing i got is not to subclass std::istream but to reimplement streambuf. My question is: how would I go about this - how would i be able to read from multiple files without having them all in memory?</p>\n"}, {"tags": ["c++", "unit-testing", "visual-c++", "googlemock", "microsoft-cpp-unit-test"], "answers": [{"tags": [], "owner": {"reputation": 2434, "user_id": 2118271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/292878529647e590d35206075ee622a5?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Olsen", "link": "https://stackoverflow.com/users/2118271/chris-olsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1583102110, "last_edit_date": 1583102110, "creation_date": 1553712100, "answer_id": 55384423, "question_id": 55384422, "link": "https://stackoverflow.com/questions/55384422/how-to-use-google-mock-with-cppunittestframework/55384423#55384423", "title": "How to use Google Mock with CppUnitTestFramework", "body": "<p>I was able to get <a href=\"https://github.com/google/googletest/tree/master/googlemock\" rel=\"nofollow noreferrer\"><code>GMock</code></a> working correctly with the <a href=\"https://docs.microsoft.com/en-us/visualstudio/test/how-to-use-microsoft-test-framework-for-cpp?view=vs-2017\" rel=\"nofollow noreferrer\"><code>CppUnitTestFramework</code></a> by creating a custom <code>TestEventListener</code>. I then created a simple set of interface functions to make it easier to work with.</p>\n\n<p>I used the <a href=\"https://www.nuget.org/packages/gmock/1.7.0\" rel=\"nofollow noreferrer\">gmock 1.7.0 NuGet package</a> to install the GMock framework into my project, and added the two files shown below. </p>\n\n<p><strong>GMockUtils.h</strong></p>\n\n<pre><code>#pragma once\n\n#include &lt;CppUnitTest.h&gt;\n#include &lt;gmock/gmock.h&gt;\n\nnamespace testing { \n    namespace GMockUtils {\n\n        // Call once per test class or module to set up everything needed by GoogleMock.\n        void InitGoogleMock();\n\n        // Call once per test method to check for GoogleMock messages.\n        void CheckGoogleMock();\n    }\n}\n</code></pre>\n\n<p><strong>GMockUtils.cpp</strong></p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"GMockUtils.h\"\n\nusing namespace Microsoft::VisualStudio::CppUnitTestFramework;\n\nnamespace testing {\n    namespace GMockUtils {\n        namespace {\n\n            // Test event listener for use with CppUnitTestFramework\n            class CppUnitTestReporter : public EmptyTestEventListener\n            {\n            public:\n                CppUnitTestReporter() : _failed(false) \n                {\n                }\n\n                // Helper for converting std::string to std::wstring\n                std::wstring to_wstring(const std::string&amp; str) const\n                {\n                    std::wstring output;\n                    std::copy(str.begin(), str.end(), std::back_inserter(output));\n                    return output;\n                }\n\n                // Called after a failed assertion or a SUCCEED() invocation.\n                void OnTestPartResult(const ::testing::TestPartResult&amp; result) override\n                {\n                    // Log this result to the CppUnitTestFramework output\n                    Logger::WriteMessage(result.summary());\n\n                    // Note: You cannot do an Assert directly from a listener, so we\n                    // just store the messages until CheckGoogleMock() is called.\n                    if (result.failed())\n                    {\n                        _failed = true;\n\n                        // Append this result to the running summary\n                        _failedSummary += result.message();\n                        _failedSummary += \"\\n\";\n                    }\n                }\n\n                // Clear any previous failures\n                void ResetFailures()\n                {\n                    _failed = false;\n                    _failedSummary.clear();\n                }\n\n                // Assert if any failures have been detected. Also resets failures.\n                void CheckFailures()\n                {\n                    auto failed = _failed;\n                    auto failedSummary = _failedSummary;\n                    ResetFailures();\n                    Assert::IsFalse(failed, to_wstring(failedSummary).c_str());\n                }\n\n            protected:\n                bool _failed;\n                std::string _failedSummary;\n\n            } *_listener;\n        }\n\n        // Initialize the Google Mock framework for use with CppUnitTestFramework\n        void InitGoogleMock()\n        {\n            // Avoids calling the function unnecessarily\n            if (_listener != nullptr)\n                return;\n\n            // Dummy command line parameters (could pass exe path here)\n            int argc = 0;\n            char** argv = nullptr;\n\n            // Initialize the framework\n            ::testing::InitGoogleMock(&amp;argc, argv);\n\n            // We don't want exceptions thrown, regardless what the doc says\n            GTEST_FLAG(throw_on_failure) = false;\n\n            // Remove default listener\n            auto &amp;listeners = UnitTest::GetInstance()-&gt;listeners();\n            delete listeners.Release(listeners.default_result_printer());\n\n            // Create and install the new listener\n            _listener = new CppUnitTestReporter();\n            listeners.Append(_listener);\n        }\n\n        // Reset any previous failures detected by the listener\n        void ResetGoogleMock()\n        {\n            _listener-&gt;ResetFailures();\n        }\n\n        // Prints messages and asserts if any Google Mock messages are found.\n        void CheckGoogleMock()\n        {\n            Assert::IsNotNull(_listener, L\"Google Mock framework not initialized by InitGoogleMock()\");\n            _listener-&gt;CheckFailures();\n        }\n    }\n}\n</code></pre>\n\n<p>I use the GMockUtils functions in unit test classes like this:</p>\n\n<pre><code>#include \"GMockUtils.h\"\n\nusing namespace Microsoft::VisualStudio::CppUnitTestFramework;\nusing namespace ::testing;\n\nnamespace GMockUtilsDemo\n{\n    TEST_CLASS(GMockUtilTests)\n    {\n    public:\n\n        TEST_CLASS_INITIALIZE(ClassInitializer)\n        {\n            // IMPORTANT: This must be called before any mock object constructors\n            GMockUtils::InitGoogleMock();\n        }\n\n        TEST_METHOD_CLEANUP(MethodCleanup)\n        {\n            // Checks for GoogleMock messages. Asserts if found.\n            GMockUtils::CheckGoogleMock();\n        }\n\n        TEST_METHOD(Method1_ParamIsOne_Method2CalledWithOne)\n        {\n            MockTestClass mockObj;\n            EXPECT_CALL(mockObj, Method2(1)).Times(1); // Expectation will be met\n            mockObj.Method1(1);\n        }\n\n        TEST_METHOD(Method1_ParamIsZero_IntentionallyFail)\n        {\n            MockTestClass mockObj;\n            EXPECT_CALL(mockObj, Method2(1)).Times(1); // Expectation will not be met\n            mockObj.Method1(0);\n        }\n    };\n}\n</code></pre>\n\n<p><br>\n<strong>The Console Output</strong></p>\n\n<p>The console output now shows all GMock messages, and the run does not abort on the first test failure.</p>\n\n<pre><code>[3/27/2019 12:23:46 PM Informational] ------ Run test started ------\n[3/27/2019 12:23:46 PM Informational] \nUnexpected mock function call - returning directly.\n    Function call: Method2(0)\nGoogle Mock tried the following 1 expectation, but it didn't match:\n\nc:\\...\\gmockutilsdemo.cpp(64): EXPECT_CALL(_mockObj, Method2(1))...\n  Expected arg #0: is equal to 1\n           Actual: 0\n         Expected: to be called once\n           Actual: never called - unsatisfied and active\n[3/27/2019 12:23:46 PM Informational] Actual function call count doesn't match EXPECT_CALL(_mockObj, Method2(1))...\n         Expected: to be called once\n           Actual: never called - unsatisfied and active\n[3/27/2019 12:23:46 PM Informational] ========== Run test finished: 2 run (0:00:00.8631468) ==========\n</code></pre>\n\n<p><br>\n<strong>Test Explorer View</strong></p>\n\n<p>If I run the tests via Visual Studio Test Explorer, I can also see all GMock messages related to a particular test. It also works with the VsTest task on Azure DevOps.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CKoDO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CKoDO.png\" alt=\"Test Explorer screen snippet\"></a></p>\n\n<p>Hopefully this will be useful to anyone who finds themselves in the same situation.</p>\n"}], "owner": {"reputation": 2434, "user_id": 2118271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/292878529647e590d35206075ee622a5?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Olsen", "link": "https://stackoverflow.com/users/2118271/chris-olsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1976, "favorite_count": 0, "accepted_answer_id": 55384423, "answer_count": 1, "score": 1, "last_activity_date": 1583102245, "creation_date": 1553712100, "last_edit_date": 1583102245, "question_id": 55384422, "link": "https://stackoverflow.com/questions/55384422/how-to-use-google-mock-with-cppunittestframework", "title": "How to use Google Mock with CppUnitTestFramework", "body": "<p><strong>TL;DR:</strong> <em>You can use GMock to add mocking capability to your Microsoft native c++ unit tests. See <a href=\"https://stackoverflow.com/a/55384423/2118271\">my answer</a> below for details.</em></p>\n\n<hr>\n\n<p>I want to start adding mocks to my existing set of native unit tests. The tests are written using Microsoft's <a href=\"https://docs.microsoft.com/en-us/visualstudio/test/how-to-use-microsoft-test-framework-for-cpp?view=vs-2017\" rel=\"nofollow noreferrer\"><code>CppUnitTestFramework</code></a> framework, which doesn't have support for mocking. I don't really want to convert the entire test suite to another framework just to add a few mocks.</p>\n\n<p>Google's <a href=\"https://github.com/google/googlemock/tree/master/googlemock\" rel=\"nofollow noreferrer\">GMock</a> framework seems to provide everything I need and the documentation suggests it can be used with frameworks other than <code>gtest</code>. So using advice from blog posts like <a href=\"https://blog.many-monkeys.com/using_gmock_with_visual_studio_cpp_unit_test_framework/\" rel=\"nofollow noreferrer\">this one</a>, I created a couple of unit tests.</p>\n\n<pre><code>    TEST_MODULE_INITIALIZE(ModuleInitialize)\n    {\n        // Enable google mock\n        GTEST_FLAG(throw_on_failure) = true;\n        int argc = 0;\n        TCHAR **argv = nullptr;\n        InitGoogleMock(&amp;argc, argv);\n    }\n\n    TEST_CLASS(GMockTests)\n    {\n    public:\n        MockTestClass _mockObj;\n\n        TEST_METHOD(Method1_ParamIsOne_Method2CalledWithOne)\n        {\n            EXPECT_CALL(_mockObj, Method2(1)).Times(1);\n            _mockObj.Method1(1);\n        }\n\n        TEST_METHOD(Method1_ParamIsZero_IntentionallyFail)\n        {\n            // Expectation will fail\n            EXPECT_CALL(_mockObj, Method2(1)).Times(1);\n            _mockObj.Method1(0);\n        }\n\n    };\n</code></pre>\n\n<p>The results are less than satisfactory. The expectations do work (first method passes), but if any expectation fails the entire run is aborted with only the following unhelpful message in the test output:</p>\n\n<pre><code>[3/27/2019 11:39:17 AM Error] The active test run was aborted. Reason: \n[3/27/2019 11:39:17 AM Informational] ========== Run test finished: 0 run (0:00:22.3042194) ==========\n</code></pre>\n\n<p>The Visual Studio Test Explorer window doesn't indicate what the problem is either. It just shows that one test succeeded and the other one didn't run:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q44zS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q44zS.png\" alt=\"Test Explorer screen snip\"></a></p>\n\n<p>So what I'm looking for from this integration is:</p>\n\n<ol>\n<li>A GMock test failure doesn't abort the entire run.</li>\n<li>Tests that fail GMock expectations are shown as failed.</li>\n<li>All GMock messages should be shown in the test output.</li>\n</ol>\n"}, {"tags": ["c++", "dokan"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553712012, "post_id": 55384389, "comment_id": 97490656, "body": "Did you try asking the author of the library?"}, {"owner": {"reputation": 19, "user_id": 10296926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WrQGbVecvvg/AAAAAAAAAAI/AAAAAAAACGk/2gLzG2GIQ0Q/photo.jpg?sz=128", "display_name": "Devendra shaktawat", "link": "https://stackoverflow.com/users/10296926/devendra-shaktawat"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553712171, "post_id": 55384389, "comment_id": 97490717, "body": "Can I raise an issue for this?  why -1 on it?  how can i improve it?"}, {"owner": {"reputation": 19, "user_id": 10296926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WrQGbVecvvg/AAAAAAAAAAI/AAAAAAAACGk/2gLzG2GIQ0Q/photo.jpg?sz=128", "display_name": "Devendra shaktawat", "link": "https://stackoverflow.com/users/10296926/devendra-shaktawat"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553712257, "post_id": 55384389, "comment_id": 97490758, "body": "I didn&#39;t ask to author, it seems my lack of knowledge, not any technical issue"}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1553712281, "post_id": 55384389, "comment_id": 97490772, "body": "I wonder what one gets when one runs the source from GitHub through a compiler,"}, {"owner": {"reputation": 2357, "user_id": 4074081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emDh4.png?s=128&g=1", "display_name": "dewaffled", "link": "https://stackoverflow.com/users/4074081/dewaffled"}, "edited": false, "score": 0, "creation_date": 1553712455, "post_id": 55384389, "comment_id": 97490855, "body": "Windows drivers need to be signed these days. I suppose, you need to install pre-built one from the <a href=\"https://github.com/dokan-dev/dokany/releases\" rel=\"nofollow noreferrer\">releases page</a>."}, {"owner": {"reputation": 19, "user_id": 10296926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WrQGbVecvvg/AAAAAAAAAAI/AAAAAAAACGk/2gLzG2GIQ0Q/photo.jpg?sz=128", "display_name": "Devendra shaktawat", "link": "https://stackoverflow.com/users/10296926/devendra-shaktawat"}, "reply_to_user": {"reputation": 2357, "user_id": 4074081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emDh4.png?s=128&g=1", "display_name": "dewaffled", "link": "https://stackoverflow.com/users/4074081/dewaffled"}, "edited": false, "score": 0, "creation_date": 1553712564, "post_id": 55384389, "comment_id": 97490908, "body": "okay @dewaffled,  I will trying that ,"}, {"owner": {"reputation": 19, "user_id": 10296926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WrQGbVecvvg/AAAAAAAAAAI/AAAAAAAACGk/2gLzG2GIQ0Q/photo.jpg?sz=128", "display_name": "Devendra shaktawat", "link": "https://stackoverflow.com/users/10296926/devendra-shaktawat"}, "edited": false, "score": 0, "creation_date": 1553712714, "post_id": 55384389, "comment_id": 97490994, "body": "also , I have tried to find this  using <a href=\"https://docs.microsoft.com/en-us/windows/desktop/Dlls/using-run-time-dynamic-linking?fbclid=IwAR231OGaEcKSSvyYM5_02sXWNX3P3ExbZSyOebF8dvs8LxTflNNfjNDErjc\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/Dlls/&hellip;</a> , still couldn&#39;t find it"}, {"owner": {"reputation": 19, "user_id": 10296926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WrQGbVecvvg/AAAAAAAAAAI/AAAAAAAACGk/2gLzG2GIQ0Q/photo.jpg?sz=128", "display_name": "Devendra shaktawat", "link": "https://stackoverflow.com/users/10296926/devendra-shaktawat"}, "edited": false, "score": 0, "creation_date": 1553713195, "post_id": 55384389, "comment_id": 97491228, "body": "I have installed dokansetup.exe file , how can i find .dll file now"}], "owner": {"reputation": 19, "user_id": 10296926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WrQGbVecvvg/AAAAAAAAAAI/AAAAAAAACGk/2gLzG2GIQ0Q/photo.jpg?sz=128", "display_name": "Devendra shaktawat", "link": "https://stackoverflow.com/users/10296926/devendra-shaktawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553711959, "creation_date": 1553711959, "question_id": 55384389, "link": "https://stackoverflow.com/questions/55384389/dokanfuse-how-to-use-fuse-wrapper-of-dokan-to-import-a-simple-file-system-appl", "title": "Dokanfuse : how to use Fuse wrapper of Dokan to import a simple file system application of Fuse to windows", "body": "<p>I have a simple filesystem created by FUSE on Linux, I wanted to port this to windows using FUSE wrapper of Dokan, </p>\n\n<p><a href=\"https://github.com/dokan-dev/dokany/wiki/FUSE\" rel=\"nofollow noreferrer\">https://github.com/dokan-dev/dokany/wiki/FUSE</a>\nhow can I use this, I can't find the dokanfuse.dll file mentioned in the documentation anywhere.</p>\n\n<p>My question is where can I find this dokanfuse.dll file and how can I link it as mentioned in the document.</p>\n"}, {"tags": ["c++", "multidimensional-array", "strlen"], "comments": [{"owner": {"reputation": 24558, "user_id": 457237, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34f7425ea0a472d1493230c28204010a?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan Manjunath", "link": "https://stackoverflow.com/users/457237/pavan-manjunath"}, "edited": false, "score": 0, "creation_date": 1553711534, "post_id": 55384257, "comment_id": 97490423, "body": "Did you try <code>sizeof</code> instead of <code>strlen</code>?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 7, "creation_date": 1553711582, "post_id": 55384257, "comment_id": 97490450, "body": "<code>strlen</code> is for null-terminated byte strings - which you don&#39;t have"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553711662, "post_id": 55384257, "comment_id": 97490495, "body": "From what I can see, <code>m[0]</code> is not a null-terminated string, hence, according to the documentation of <a href=\"https://en.cppreference.com/w/cpp/string/byte/strlen\" rel=\"nofollow noreferrer\"><code>strlen</code></a>: &quot;<i>The behavior is undefined if there is no null character in the character array pointed to by str.</i>&quot;"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 3, "creation_date": 1553711718, "post_id": 55384257, "comment_id": 97490526, "body": "Use a <code>std::array</code> or a <code>std::vector</code> that knows its <code>.size()</code>. Forget that C-style arrays exist (or know they exist but <i>stop using them</i>). And please learn about rhe <a href=\"https://en.cppreference.com/w/cpp/algorithm\" rel=\"nofollow noreferrer\">standard algorithms</a> so you don&#39;t have to hand-roll stuff like your writing code in the previous century."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1553712561, "post_id": 55384257, "comment_id": 97490904, "body": "You could probably replace <code>m</code> with <code>vector&lt;string&gt;</code> or <code>array&lt;string, 3&gt;</code>. All of <code>vector</code>, <code>array</code>, and <code>string</code> have tons of helpful functions and safety checks built-in to save you from yourself, and they all work really cleanly with a ton of standard algorithms"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 24558, "user_id": 457237, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34f7425ea0a472d1493230c28204010a?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan Manjunath", "link": "https://stackoverflow.com/users/457237/pavan-manjunath"}, "edited": false, "score": 1, "creation_date": 1553712623, "post_id": 55384257, "comment_id": 97490940, "body": "@PavanManjunath Please don&#39;t write (or suggest others write) C++ by guessing."}, {"owner": {"reputation": 24558, "user_id": 457237, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34f7425ea0a472d1493230c28204010a?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan Manjunath", "link": "https://stackoverflow.com/users/457237/pavan-manjunath"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553713084, "post_id": 55384257, "comment_id": 97491171, "body": "@JesperJuhl I agree I should have added more details. But the idea was to veer OP towards looking up <code>sizeof</code> and see if it fits their needs themselves."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 24558, "user_id": 457237, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34f7425ea0a472d1493230c28204010a?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan Manjunath", "link": "https://stackoverflow.com/users/457237/pavan-manjunath"}, "edited": false, "score": 0, "creation_date": 1553714242, "post_id": 55384257, "comment_id": 97491715, "body": "@PavanManjunath &quot;the idea was to veer OP towards looking up sizeof and see if it fits their needs&quot; - That is (IMHO) still steering them in the wrong direction. The <i>real</i> problem is the use of C-style arrays and use of C functions. There are <i>much better</i> ways to approach this in C++, if one just crawls out of the C mindset first."}], "answers": [{"tags": [], "owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "is_accepted": false, "score": 1, "last_activity_date": 1553715405, "creation_date": 1553715405, "answer_id": 55385205, "question_id": 55384257, "link": "https://stackoverflow.com/questions/55384257/how-to-use-the-strlen-with-2d-array/55385205#55385205", "title": "How to use the strlen() with 2d array?", "body": "<p>You have a few things going on. Some of the comments above help, but let's go over it.</p>\n\n<p>First, if you're using C++ and you're holding strings, you should use std::string. However, your problem indicates you're just learning, so let's stick to old-school C.</p>\n\n<p>What you have allocated is a 2-dimensional array of single characters. That is, you are storing in total 12 characters of data.</p>\n\n<p>In C (or C++) strings are null-terminated. That is, if you store as a string \"Hi\", it's actually 3 characters, not two. H, I, and a zero byte that indicates the end of the string.</p>\n\n<p>strlen simply counts the number of characters until the zero byte. So in my example, 2.</p>\n\n<p>You don't have any 0-bytes in your array, so strlen counts until it hits a zero due to some other reason -- completely outside your array. Yikes!</p>\n\n<p>So... It's a mistake to use the string methods (strlen, strdup, etc) when dealing with single characters.</p>\n\n<p>Now, the safest thing would be to use a vector of std::string, as others have suggested. However, I am a firm believer in understanding the basics before taking shortcuts, and that's a shortcut.</p>\n\n<p>So if what you really want is 3 strings, but you want to use old-school C, then you should actually have a 1-dimensional array of char *.</p>\n\n<pre><code>char *m[3];\nm[0] = \"Hello\";\nm[1] = \"there\";\nm[2] = \"everyone\";\n</code></pre>\n\n<p>It would be REALLY weird to store strings the way you have, and it's considered quite dangerous to use fixed-length character buffers for holding strings. This is where the infamous buffer overrun exploits come from, the most common exploits in old school web applications.</p>\n\n<p>Alternatively, you could modify your example. make m[3][5], and store a zero-byte in each row after the end of your strings. strlen() will start to work. But it's really kind of ugly.</p>\n"}], "owner": {"reputation": 37, "user_id": 11268083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdpKk.jpg?s=128&g=1", "display_name": "Emdetto", "link": "https://stackoverflow.com/users/11268083/emdetto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553715405, "creation_date": 1553711431, "question_id": 55384257, "link": "https://stackoverflow.com/questions/55384257/how-to-use-the-strlen-with-2d-array", "title": "How to use the strlen() with 2d array?", "body": "<p>I want to know the horizontal size of my 2D char array. I found strlen() for that, but it works only with a simple char array. With 2D it doesn't work. Any idea? Thanks for the answers!</p>\n\n<pre><code>char m[3][4];\n    for(int i = 0; i &lt; 3; i++){\n        for(int j = 0; j &lt; 4; j++){\n            m[i][j] = ' ';\n        }\n    }\n\ncout &lt;&lt; \"CHAR Matrix: \" &lt;&lt; endl;\n    for(int i = 0; i &lt; 3; i++){\n        for(int j = 0; j &lt; 4; j++){\n            cout &lt;&lt; \"[\" &lt;&lt; m[i][j] &lt;&lt; \"]\";\n        }\n        cout &lt;&lt; endl;\n    }\n\ncout &lt;&lt; \"Sizeof matrix -&gt; \" &lt;&lt; sizeof(m) &lt;&lt; \"B\" &lt;&lt; endl;\n\ncout &lt;&lt; \"Length of Matrix strlen(m[0]): \" &lt;&lt; strlen(m[0]) &lt;&lt; endl;\n</code></pre>\n\n<p><strong>The problem is that ,,strlen(m[0]),, gives me 18. How could i get 4?</strong></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553710504, "post_id": 55383930, "comment_id": 97489872, "body": "why do you store pointers ? I didnt read further, because most likely it is <code>std::vector&lt;Handler*&gt;</code> storing dangling pointers. Why not <code>std::vector&lt;Handler&gt;</code> ?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1553710517, "post_id": 55383930, "comment_id": 97489882, "body": "The lambda function is out of scope when you call it. And why do you store pointers to std::function, which it self is a pointer to function. You are storing pointers to pointers to functions."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553710560, "post_id": 55383930, "comment_id": 97489906, "body": "1) Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. There are pieces of code missing (what is <code>SubHandler</code>?) 2) Does <code>handler.addHandler</code> call  end up in <code>MessageHandler::addHandler</code>? If so, you are storing a pointer of local variable. Which leads to a question of: Why <code>std::vector&lt;Handler*&gt; handlers;</code> instead of <code>std::vector&lt;Handler&gt; handlers;</code>?"}, {"owner": {"reputation": 57, "user_id": 11268016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a86c5fc20f9abf5f3eb552d4693511?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie Grace", "link": "https://stackoverflow.com/users/11268016/maggie-grace"}, "edited": false, "score": 0, "creation_date": 1553710593, "post_id": 55383930, "comment_id": 97489932, "body": "Cause i copied that from the example you can see in the link above."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553710619, "post_id": 55383930, "comment_id": 97489944, "body": "btw <code>abstract</code> is not a c++ keyword"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553710639, "post_id": 55383930, "comment_id": 97489953, "body": "@MaggieGrace &quot;<i>Cause i copied that from the example you can see in the link above</i>&quot; 1) All information, necessary to answer the question, must be in the question itself, and not hidden behind external links. 2) Be wary of <a href=\"https://en.wikipedia.org/wiki/Cargo_cult_programming\" rel=\"nofollow noreferrer\">Cargo cult programming</a>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553710692, "post_id": 55383930, "comment_id": 97489998, "body": "the example you copied from is pretty useless for anything else beyond that example ;). Be careful with capturing by reference and be careful with storing pointers"}, {"owner": {"reputation": 57, "user_id": 11268016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a86c5fc20f9abf5f3eb552d4693511?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie Grace", "link": "https://stackoverflow.com/users/11268016/maggie-grace"}, "edited": false, "score": 0, "creation_date": 1553710760, "post_id": 55383930, "comment_id": 97490029, "body": "Okay, the example i use is doing it this way, of storing it as a pointer, to answer to the why pointer questions"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1553710915, "post_id": 55383930, "comment_id": 97490118, "body": "@MaggieGrace I will repeat myself: 1) please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, as without one, we can only guess at the problem. 2) Most likely you are storing pointer to a local variable (local lambda), which gets destroyed at the end of the function, before you call it."}, {"owner": {"reputation": 57, "user_id": 11268016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a86c5fc20f9abf5f3eb552d4693511?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie Grace", "link": "https://stackoverflow.com/users/11268016/maggie-grace"}, "edited": false, "score": 0, "creation_date": 1553711288, "post_id": 55383930, "comment_id": 97490305, "body": "Okay, i made two changes now.  The 1st is, that i kicked the pointer out of my vector and just stored them as you told me  The second change is, that i pulled out the code of my setHandler function into my message Loop, where i dont loose the scope of the Lambda function  Now its working. Thanks :)"}, {"owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "edited": false, "score": 0, "creation_date": 1598885512, "post_id": 55383930, "comment_id": 112595042, "body": "I believe the code will be greatly simplified if you use <code>using xx =</code> or even templates or <code>std::function</code>"}], "answers": [{"tags": [], "owner": {"reputation": 589, "user_id": 7623655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0c35cea1baf410727643201e2bf0c9?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Samson", "link": "https://stackoverflow.com/users/7623655/olivier-samson"}, "is_accepted": false, "score": 0, "last_activity_date": 1553713006, "creation_date": 1553713006, "answer_id": 55384633, "question_id": 55383930, "link": "https://stackoverflow.com/questions/55383930/how-can-lambda-functions-and-function-typedefinitions-work-as-a-listener/55384633#55384633", "title": "How can lambda functions and function typedefinitions work as a listener?", "body": "<p>This is because your lambda defined in your Server class method isn't in the scope of your MessageHandler class. I suggest you read through this : <a href=\"https://blog.feabhas.com/2014/03/demystifying-c-lambdas/\" rel=\"nofollow noreferrer\">https://blog.feabhas.com/2014/03/demystifying-c-lambdas/</a> to get a good idea of what the problem is and how to fix it.</p>\n\n<p>Though, it might be a good solution to define a struct holding your lambda, which would then work with <a href=\"https://en.cppreference.com/w/cpp/utility/functional/mem_fn\" rel=\"nofollow noreferrer\">std::mem_fn</a>.</p>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 1, "last_activity_date": 1598887433, "last_edit_date": 1598887433, "creation_date": 1553715700, "answer_id": 55385279, "question_id": 55383930, "link": "https://stackoverflow.com/questions/55383930/how-can-lambda-functions-and-function-typedefinitions-work-as-a-listener/55385279#55385279", "title": "How can lambda functions and function typedefinitions work as a listener?", "body": "<p>You should compile your code using <code>/permissive-</code>. The compiler should refuse your code.</p>\n<pre><code>void addHandler(Handler&amp; handler) {\n        handlers.push_back(&amp;handler);\n}\n</code></pre>\n<p>You shouldn't be able to send a temporary to this function, but yet you are!</p>\n<pre><code>//                 v----- This lambda is a temporary object --------------------------v\nhandler.addHandler([&amp;](int id, std::string message) { executingFunction(id, message); });\n</code></pre>\n<p>The lambda object created at that line dies just after the statement is finished.</p>\n<pre><code>//                 v---- pointer to the temporary.\nhandlers.push_back(&amp;handler);\n</code></pre>\n<p>My recomendation would be to drop the pointer and use <code>std::function</code> object by value. They are made to be used like that:</p>\n<pre><code>//  abstract is not a C++ keyword.\nclass MessageHandler /* abstract */\n{ \npublic:\n    // using instead of typedef and non const\n    using Handler = std::function&lt;void(int, std::string)&gt;;\n\n    void addHandler(Handler const&amp; handler) { // const reference\n            // insert by value\n            handlers.push_back(handler);\n    }\nprivate:\n    // no pointer here.\n    std::vector&lt;Handler&gt; handlers;\nprotected:        \n    void someFunction(int id, std::string message) {\n        for (auto const&amp; handler : handlers) {\n            handler(id, message); //Here it will not crash anymore\n        }\n    }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1553717981, "creation_date": 1553717981, "answer_id": 55385791, "question_id": 55383930, "link": "https://stackoverflow.com/questions/55383930/how-can-lambda-functions-and-function-typedefinitions-work-as-a-listener/55385791#55385791", "title": "How can lambda functions and function typedefinitions work as a listener?", "body": "<p>Your source is bad :/\nYou might use instead something like:</p>\n\n<pre><code>class MessageHandler\n{ \npublic:\n    using Handler = std::function&lt;void(int, const std::string&amp;)&gt; Handler;\n\n    void addHandler(const Handler&amp; handler) { handlers.push_back(handler); }\n\n    void execute(int id, const std::string&amp; message) {\n        for (auto&amp; handler : handlers) {\n            (*handler)(id, message);\n        }\n    }\n\nprivate:\n    std::vector&lt;Handler&gt; handlers;\n};\n</code></pre>\n\n<p>And then use it:</p>\n\n<pre><code>class Server\n{\nprivate:\n    MessageHandler handler;\n\n    void setHandlers()\n    {\n        handler.addHandler(&amp;Server::executingFunction);\n        handler.addHandler(\n            [](int id, const std::string&amp; message)\n            {\n                std::cout &lt;&lt; message &lt;&lt; id &lt;&lt; std::endl;\n            });\n    }\n\n    static void executingFunction(int id, const std::string&amp; message) {\n        std::cout &lt;&lt; \"Listener Worked!\" &lt;&lt; std::endl;\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11268016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a86c5fc20f9abf5f3eb552d4693511?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie Grace", "link": "https://stackoverflow.com/users/11268016/maggie-grace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55385279, "answer_count": 3, "score": 0, "last_activity_date": 1598887433, "creation_date": 1553710203, "last_edit_date": 1598885169, "question_id": 55383930, "link": "https://stackoverflow.com/questions/55383930/how-can-lambda-functions-and-function-typedefinitions-work-as-a-listener", "title": "How can lambda functions and function typedefinitions work as a listener?", "body": "<p>I'm trying to make the equivalent of a Event Listener from Java, but in C++.\nMy goal is, that I can call a function from a class, which triggers my listener I added to this class.</p>\n<p>I found the following <a href=\"https://gist.github.com/4poc/3155832\" rel=\"nofollow noreferrer\">Link</a> which gave me a solution to do this.</p>\n<p>The problem hereby is, that my program crashed as soon as I tried to call the listeners.</p>\n<p>My code is structured like this:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>class MessageHandler abstract\n{ \npublic:\n    typedef const std::function&lt;void(int, std::string)&gt; Handler;\n    void addHandler(Handler&amp; handler) {\n            handlers.push_back(&amp;handler);\n    }\nprivate:\n    std::vector&lt;Handler*&gt; handlers;\nprotected:        \n    void someFunction(int id, std::string message) {\n        for (auto&amp; handler : handlers) {\n            (*handler)(id, message); //Here it will crash\n        }\n    }\n};\n</code></pre>\n<p>As you maybe already mentioned, this is the base class from which I derive some childclasses. These childclasses call then my &quot;someFunction&quot; code.</p>\n<p>And the class where I create one of these childclasses, is structured like this:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>class Server\n{\nprivate:\n    SubHandler handler;\n\n    void setHandlers() {\n        handler.addHandler([&amp;](int id, std::string message) { executingFunction(id, message); });\n    }\n\n    void executingFunction(int id, std::string message) {\n        std::cout &lt;&lt; &quot;Listener Worked!&quot; &lt;&lt; std::endl;\n        //Not actually the code inside, but it doesn't matter, case I don't even get to this code\n    }\n};\n</code></pre>\n<p>The program crashes at the line, where I loop over my listeners and call them with error:</p>\n<blockquote>\n<p>&quot;Access violation when reading at position 0x000000000000000010.&quot;</p>\n</blockquote>\n<p>(This is translated, so its not the message you will get if you have your Visual Studio set to English)</p>\n"}, {"tags": ["c++", "friend", "crtp"], "answers": [{"comments": [{"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "edited": false, "score": 0, "creation_date": 1553712411, "post_id": 55384149, "comment_id": 97490840, "body": "Yep, got it backwards.  Thanks!  BTW, <code>friend Base</code> also apparently works."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 2, "last_activity_date": 1553710986, "creation_date": 1553710986, "answer_id": 55384149, "question_id": 55383909, "link": "https://stackoverflow.com/questions/55383909/cant-use-private-constructor-of-befriended-crtp-class/55384149#55384149", "title": "Can&#39;t use private constructor of befriended CRTP class", "body": "<p>You've got the <code>friend</code> declaration in the wrong class.  <code>Derived</code> needs to declare <code>Base&lt;Derived&gt;</code> as a friend, since a friend can access the private members.  (A class declares another class to be a friend.  A class does not declare itself as a friend of another class.)</p>\n\n<p>You want to add</p>\n\n<pre><code>friend Base&lt;Derived&gt;;\n</code></pre>\n\n<p>into the <code>Derived</code> class declaration.</p>\n"}, {"comments": [{"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "edited": false, "score": 0, "creation_date": 1553712458, "post_id": 55384168, "comment_id": 97490856, "body": "Yep, got it backwards. Thanks! BTW, friend Base also apparently works.   And you have an eagle-eye for errors (counting the one in the comment to the question above as well)!"}], "tags": [], "owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "is_accepted": false, "score": 2, "last_activity_date": 1553711057, "creation_date": 1553711057, "answer_id": 55384168, "question_id": 55383909, "link": "https://stackoverflow.com/questions/55383909/cant-use-private-constructor-of-befriended-crtp-class/55384168#55384168", "title": "Can&#39;t use private constructor of befriended CRTP class", "body": "<p>The concrete problem you are mentioning is that you placed the <code>friend</code> declaration in <code>Base</code> rather than in <code>Derived</code>.</p>\n\n<p>The next problem is that <code>Derived::Hello()</code> has no implementation. If you don't need one (as in your example above) implement it only in <code>Base</code> and remove the <code>virtual</code> declaration. <code>Derived</code> will inherit it anyways. </p>\n\n<p>The following works:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\ntemplate &lt;class CRTP&gt;\nclass Base\n{\n public:\n  static void Factory()\n  {\n    cout &lt;&lt; \"Base::Factory()\" &lt;&lt; endl;\n    CRTP x;\n    x.Hello();\n  }\n  void Hello() { cout &lt;&lt; \"Base::Hello()\" &lt;&lt; endl; }\n\n protected:\n  Base() { cout &lt;&lt; \"Base::Base()\" &lt;&lt; endl; }\n  virtual ~Base() { cout &lt;&lt; \"Base::~Base()\" &lt;&lt; endl; }\n};\n\nclass Derived final : public Base&lt;Derived&gt;\n{\n  friend Base&lt;Derived&gt;;\n/*^^^^^^ friend declaration goes here, not in Base */\n\n  Derived() { cout &lt;&lt; \"Derived::Derived()\" &lt;&lt; endl; }\n  ~Derived() override { cout &lt;&lt; \"Derived::~Derived()\" &lt;&lt; endl; }\n}; \n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Base::Factory()\nBase::Base()\nDerived::Derived()\nBase::Hello()\nDerived::~Derived()\nBase::~Base()\n</code></pre>\n"}], "owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 55384149, "answer_count": 2, "score": 0, "last_activity_date": 1553711057, "creation_date": 1553710147, "last_edit_date": 1553710540, "question_id": 55383909, "link": "https://stackoverflow.com/questions/55383909/cant-use-private-constructor-of-befriended-crtp-class", "title": "Can&#39;t use private constructor of befriended CRTP class", "body": "<p>I have code which uses this design, simplifed to get this MCVE - code and compiler errors follow.</p>\n\n<p>The basic problem is that I thought befriending the CRTP class would allow the templated base class access to the derived CRTP class's private members, including its private constructor.</p>\n\n<p>But apparently it doesn't.  Why?</p>\n\n<p><a href=\"https://wandbox.org/permlink/bCHhLS7J5aF7JdbA\" rel=\"nofollow noreferrer\">this code on wandbox</a>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\nusing namespace std;\n\ntemplate &lt;class CRTP&gt;\nclass Base\n{\n  friend CRTP;\npublic:\n  static void Factory()\n  {\n      cout &lt;&lt; \"Base::Factory()\" &lt;&lt; endl;\n      CRTP x;\n      x.Hello();\n  }\n  virtual void Hello() { cout &lt;&lt; \"Base::Hello()\" &lt;&lt; endl; }\nprotected:\n  Base() { cout &lt;&lt; \"Base::Base()\" &lt;&lt; endl; }\n  virtual ~Base() { cout &lt;&lt; \"Base::~Base()\" &lt;&lt; endl; }\n};\n\n\nclass Derived final : public Base&lt;Derived&gt;\n{\npublic:\n  void Hello() override;\nprivate:\n  Derived() { cout &lt;&lt; \"Derived::Derived()\" &lt;&lt; endl; }\n  ~Derived() override { cout &lt;&lt; \"Derived::~Derived()\" &lt;&lt; endl; }\n};\n\nint main()\n{\n    Derived::Factory();\n    // Expected output:\n    //   Base::Factory()\n    //   Base::Base()\n    //   Derived::Derived()\n    //   Derived::Hello()\n    //   Derived::~Derived()\n    //   Base::~Base()\n}\n</code></pre>\n\n<p>And getting this compiler error (from clang 9.0.0, but gcc complains the same way):</p>\n\n<pre><code>prog.cc:12:12: error: calling a private constructor of class 'Derived'\n      CRTP x;\n           ^\nprog.cc:33:14: note: in instantiation of member function 'Base&lt;Derived&gt;::Factory' requested here\n    Derived::Factory();\n             ^\nprog.cc:27:3: note: declared private here\n  Derived() { cout &lt;&lt; \"Derived::Derived()\" &lt;&lt; endl; }\n  ^\nprog.cc:12:12: error: variable of type 'Derived' has private destructor\n      CRTP x;\n           ^\nprog.cc:28:11: note: declared private here\n  virtual ~Derived() { cout &lt;&lt; \"Derived::~Derived()\" &lt;&lt; endl; }\n          ^\n2 errors generated.\n</code></pre>\n\n<p>(FYI: Use case is I want the template base class to control lifetime - including construction - of the (CRTP) derived class instances via a static factory.  So I want the derived classes to declare their constructors private, yet accessible to the parent's static factory method.  This example shows the derived class instance created on the stack but the same errors occur if it is created in the heap (and returned).)</p>\n"}, {"tags": ["c++", "pointers", "struct", "constants"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 4, "creation_date": 1553710154, "post_id": 55383881, "comment_id": 97489680, "body": "<code>const structParent *data</code> is a pointer - you probably want just an object <code>const structParent data</code>"}, {"owner": {"reputation": 326, "user_id": 7289561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Om794D_d7HE/AAAAAAAAAAI/AAAAAAAAFf8/6YuhCZVNHjw/photo.jpg?sz=128", "display_name": "Bruno Araujo", "link": "https://stackoverflow.com/users/7289561/bruno-araujo"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1553710869, "post_id": 55383881, "comment_id": 97490093, "body": "Yes, but  I have to use data as a pointer in a function"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1553710955, "post_id": 55383881, "comment_id": 97490139, "body": "You could use the address-of operator to pass it into the function (<code>&amp;data</code>) - just like you do with <code>points</code>. Or if you insist on keeping it as a raw pointer you have to create an object using <code>new structParent</code>"}, {"owner": {"reputation": 326, "user_id": 7289561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Om794D_d7HE/AAAAAAAAAAI/AAAAAAAAFf8/6YuhCZVNHjw/photo.jpg?sz=128", "display_name": "Bruno Araujo", "link": "https://stackoverflow.com/users/7289561/bruno-araujo"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1553711006, "post_id": 55383881, "comment_id": 97490175, "body": "Follow function someFunction(const dwLidarDecodedPacket* packet, dwLidarAccumulatorHandle_t obj);"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1553711061, "post_id": 55383881, "comment_id": 97490198, "body": "I don&#39;t know what you are trying to say with that comment"}, {"owner": {"reputation": 326, "user_id": 7289561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Om794D_d7HE/AAAAAAAAAAI/AAAAAAAAFf8/6YuhCZVNHjw/photo.jpg?sz=128", "display_name": "Bruno Araujo", "link": "https://stackoverflow.com/users/7289561/bruno-araujo"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1553711608, "post_id": 55383881, "comment_id": 97490466, "body": "the function that receives as parameter the &quot;DATA&quot;"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1553711691, "post_id": 55383881, "comment_id": 97490506, "body": "I don&#39;t see how it is relevant or how it contradicts my previous comments. My second comment already contains the solution to your problem"}, {"owner": {"reputation": 326, "user_id": 7289561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Om794D_d7HE/AAAAAAAAAAI/AAAAAAAAFf8/6YuhCZVNHjw/photo.jpg?sz=128", "display_name": "Bruno Araujo", "link": "https://stackoverflow.com/users/7289561/bruno-araujo"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1553712129, "post_id": 55383881, "comment_id": 97490709, "body": "Yeah sorry, I will delete it."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553713614, "post_id": 55383881, "comment_id": 97491446, "body": "Fun fact: C++ benefited greatly from decades of C programming. One of these benefits is you do not need <code>typedef struct { ... } PointXYZI;</code> to avoid typing <code>struct</code> every time you refer to a <code>struct</code>. The C++ compiler knows the <code>struct</code> is a <code>struct</code>, so you can get away with <code>struct PointXYZI{ ... } ;</code> and use to <code>PointXYZI</code> without additional adornment."}], "answers": [{"comments": [{"owner": {"reputation": 326, "user_id": 7289561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Om794D_d7HE/AAAAAAAAAAI/AAAAAAAAFf8/6YuhCZVNHjw/photo.jpg?sz=128", "display_name": "Bruno Araujo", "link": "https://stackoverflow.com/users/7289561/bruno-araujo"}, "edited": false, "score": 0, "creation_date": 1553780263, "post_id": 55390527, "comment_id": 97518228, "body": "thank you. But that not solved my problem. I&#39;ll post later the solution, following @UnholySheep"}], "tags": [], "owner": {"reputation": 351, "user_id": 10443813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ee2ae00e0a906599c69e0e698035d0?s=128&d=identicon&r=PG&f=1", "display_name": "KL-Yang", "link": "https://stackoverflow.com/users/10443813/kl-yang"}, "is_accepted": true, "score": 1, "last_activity_date": 1553749567, "creation_date": 1553749567, "answer_id": 55390527, "question_id": 55383881, "link": "https://stackoverflow.com/questions/55383881/how-set-value-in-constant-into-struct-c/55390527#55390527", "title": "How set value in constant into struct c++", "body": "<p>An explained by example version of @UnholySheep's answer is the following.</p>\n\n<pre><code>void someFunc(const structParent &amp;x)\n//                             ^^^^^^\n{\n  std::cout &lt;&lt; \" @_@ \" &lt;&lt; x.xyzi-&gt;c &lt;&lt; std::endl;\n}\n\nint main()\n{\n\n  float o = 10.f, p = 5.0f, z = 96.0f;\n\n  PointXYZI points = {o, p, z, 0};\n  //                        ^^^^^\n  const structParent data = {0,0, &amp;points};\n  //                ^^^\n  std::cout &lt;&lt; \" *-* \" &lt;&lt; data.xyzi-&gt;c &lt;&lt; std::endl;\n  std::cout &lt;&lt; \" *-* \" &lt;&lt; points.a &lt;&lt; std::endl;\n\n  someFunc(data);\n  //      ^^^^^^^\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 326, "user_id": 7289561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Om794D_d7HE/AAAAAAAAAAI/AAAAAAAAFf8/6YuhCZVNHjw/photo.jpg?sz=128", "display_name": "Bruno Araujo", "link": "https://stackoverflow.com/users/7289561/bruno-araujo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 55390527, "answer_count": 1, "score": 0, "last_activity_date": 1553749567, "creation_date": 1553710035, "question_id": 55383881, "link": "https://stackoverflow.com/questions/55383881/how-set-value-in-constant-into-struct-c", "title": "How set value in constant into struct c++", "body": "<p>I can not assign a value to a constant within a structure, follow the code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct\n{\n  float a;\n  float b;\n  float c;\n  float intensity;\n} PointXYZI;\n\ntypedef struct structParent{\n  int x;\n  int y;\n  const PointXYZI* xyzi;\n} structParent;\n\nint main()\n{\n\n  float o = 10.f, p = 5.0f, z = 96.0f;\n\n  PointXYZI points = {o, p, z};\n\n  const structParent *data = {0,0, &amp;points};\n\n  std::cout &lt;&lt; \" *-* \" &lt;&lt; data.xyzi-&gt;c &lt;&lt; std::endl;\n  std::cout &lt;&lt; \" *-* \" &lt;&lt; points.a &lt;&lt; std::endl;\n\n\n  return 0;\n}\n</code></pre>\n\n<p>I get the following error with this code: </p>\n\n<p>error: scalar object \u2018data\u2019 requires one element in initializer const structParent *data = {0,0, &amp;points};</p>\n\n<p>Thank you...</p>\n"}, {"tags": ["c++", "algorithm", "loops", "inline", "compiler-optimization"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 6, "creation_date": 1553710177, "post_id": 55383866, "comment_id": 97489692, "body": "I suggest to measure time and inspect resulting assembly, rather than assume. Many abstractions in C++ can have zero overhead (functions can be inlined, and so on)."}, {"owner": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "edited": false, "score": 1, "creation_date": 1553710205, "post_id": 55383866, "comment_id": 97489706, "body": "How about inline functions?"}, {"owner": {"reputation": 2298, "user_id": 6427477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oYQ8Y.png?s=128&g=1", "display_name": "C.M.", "link": "https://stackoverflow.com/users/6427477/c-m"}, "edited": false, "score": 0, "creation_date": 1553710205, "post_id": 55383866, "comment_id": 97489708, "body": "<code>inline</code> keyword?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1553721185, "post_id": 55383866, "comment_id": 97494960, "body": "Are you wanting to use a lambda?"}, {"owner": {"reputation": 101, "user_id": 9962144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c046f0ae6a7a0714822efd25e61e2921?s=128&d=identicon&r=PG", "display_name": "F&#225;bio Lob&#227;o", "link": "https://stackoverflow.com/users/9962144/f%c3%a1bio-lob%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1554128192, "post_id": 55383866, "comment_id": 97627468, "body": "Did an update with test results using lambda and inline functions. Results are intriguing."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 9962144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c046f0ae6a7a0714822efd25e61e2921?s=128&d=identicon&r=PG", "display_name": "F&#225;bio Lob&#227;o", "link": "https://stackoverflow.com/users/9962144/f%c3%a1bio-lob%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1554128596, "post_id": 55383931, "comment_id": 97627707, "body": "True about the main concern being the algorithm.  Inline function doesn&#39;t seem to be a good idea though. From the update best alternative would be combining the use of object methods and lambda function."}], "tags": [], "owner": {"reputation": 16855, "user_id": 1502345, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1beba9dc5373529ea99d294b23118d1b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Aidley", "link": "https://stackoverflow.com/users/1502345/jack-aidley"}, "is_accepted": true, "score": 4, "last_activity_date": 1553710203, "creation_date": 1553710203, "answer_id": 55383931, "question_id": 55383866, "link": "https://stackoverflow.com/questions/55383866/how-to-repeat-a-code-segment-without-the-use-of-function-or-class-for-high-perfo/55383931#55383931", "title": "How to repeat a code segment without the use of function or class for high performance loop in C++", "body": "<p>If the code is short enough, it can be declared inline and the compiler will put it inline. If it's not, well, then it probably won't help to repeat it.</p>\n\n<p>But, honestly, this is the least effective form of optimisation anyway. Concern yourself with efficient algorithms and cache efficient data structures.</p>\n"}, {"comments": [{"owner": {"reputation": 16855, "user_id": 1502345, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1beba9dc5373529ea99d294b23118d1b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Aidley", "link": "https://stackoverflow.com/users/1502345/jack-aidley"}, "edited": false, "score": 0, "creation_date": 1553765341, "post_id": 55393110, "comment_id": 97508611, "body": "It&#39;s true that the compiler won&#39;t always inline, however if you&#39;re using a decent compiler, in most cases where it won&#39;t inlining your code won&#39;t make things faster."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "reply_to_user": {"reputation": 16855, "user_id": 1502345, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1beba9dc5373529ea99d294b23118d1b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Aidley", "link": "https://stackoverflow.com/users/1502345/jack-aidley"}, "edited": false, "score": 0, "creation_date": 1553768692, "post_id": 55393110, "comment_id": 97510734, "body": "@JackAidley agree but this has other advantages ... like its passing no operands at all so it does not have call overhead unlike (non)inline which is the major performance difference especially for stuff inside iteration loops ... stack/heap trashing can slows things down a lot in such cases (even passing just pointer is sometimes a problem)..."}], "tags": [], "owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "is_accepted": false, "score": 1, "last_activity_date": 1553763046, "last_edit_date": 1553763046, "creation_date": 1553761921, "answer_id": 55393110, "question_id": 55383866, "link": "https://stackoverflow.com/questions/55383866/how-to-repeat-a-code-segment-without-the-use-of-function-or-class-for-high-perfo/55393110#55393110", "title": "How to repeat a code segment without the use of function or class for high performance loop in C++", "body": "<p>As others suggested <code>inline</code> keyword would do it but there are restrictions (different for each compiler) some do not like loops inside etc ... So if you got something inside that your compiler do not like than the function will not be inline at all...</p>\n\n<p>So if you want better solution without restrictions (for more complicated code) that works always I usually use <code>#define</code> for this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// definition\n#define code_block1(operands) { code ... }\n#define code_block2(operands) { code ... \\\n code ... \\\n code ... \\\n code ... \\\n code ... }\n\n// usage:\n\ncode ...\ncode_block1(); // this is macro so the last ; is not needed but I like it there ...\ncode_block2();\n\ncode ...\ncode_block2();\n\ncode ...\ncode_block1();\n\ncode ...\ncode_block2();\ncode_block1();\n...\n\n// undefinition so tokens do not fight with latter on code\n#undef code_block1\n#undef code_block2\n</code></pre>\n\n<p>so you simply define your code in form of macro (<code>#define</code>) instead of function ... it can use global and local variables ... The <code>{ }</code> are not needed but its a good idea so the macro is behaving the same way as a singular expression. That will prevent latter on headaches once you start using stuff like:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for (i=0;i&lt;100;i++) code_block1();\n</code></pre>\n\n<p>without the <code>{ }</code> inside macro the code would break as only the first expression inside macro would be inside the loop ... which is not obvious from a quick look at the code.</p>\n\n<p>For short code you can write the stuff into single line but if the code is long you can divide the define into multi line by using <code>\\</code>. Beware do not use comments <code>//</code> inside define lines as that would comment out everything even code after used macro in your code... so If yo must have comments use <code>/* ... */</code> instead.</p>\n\n<p>The <code>(operands)</code> part is optional for no operands it would be just</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define code_block1 { code ... }\n</code></pre>\n\n<p>The <code>#undef</code> part is optional depends on that if you want to have such macros across your whole code or just locally in some function, class, file ... Also as you can see only the token name is used in macro no operands at all.</p>\n\n<p>I am using this a lot for example see:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/a/37178781/2521214\">How to detect robot direction from Image?</a></li>\n</ul>\n\n<p>and look for <code>loop_beg</code> and <code>loop_end</code> ... Its a loop macro with usage:</p>\n\n<pre><code>loop_beg custom_code; loop_end\n</code></pre>\n\n<p>that is why it does not have the <code>{}</code> as the <code>{</code> is in <code>loop_beg</code> and the <code>}</code> is in <code>loop_end</code>.</p>\n"}], "owner": {"reputation": 101, "user_id": 9962144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c046f0ae6a7a0714822efd25e61e2921?s=128&d=identicon&r=PG", "display_name": "F&#225;bio Lob&#227;o", "link": "https://stackoverflow.com/users/9962144/f%c3%a1bio-lob%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 55383931, "answer_count": 2, "score": 2, "last_activity_date": 1554195892, "creation_date": 1553709973, "last_edit_date": 1554195892, "question_id": 55383866, "link": "https://stackoverflow.com/questions/55383866/how-to-repeat-a-code-segment-without-the-use-of-function-or-class-for-high-perfo", "title": "How to repeat a code segment without the use of function or class for high performance loop in C++", "body": "<p>My program in C++11 is performing an online processing of serialized data and the loop need to run over millions of memory positions. Efficiency on the computation is a must and my concern is that by calling a function or a class within such a loop will create unnecessary operations that will affect efficiency, e.g. transfer of several pointer values needed for the operation between different variable scopes.</p>\n\n<p>To exemplify, let's consider the following dummy example where \"something\" is the operation that is repeated. Please note that the code within \"something\" uses the variables within the loop scope.</p>\n\n<pre><code>do {\n    something(&amp;span,&amp;foo);\n    spam++\n    foo++\n    if ( spam == spam_spam ) {\n      something(&amp;span,&amp;foo);\n      other_things(&amp;span,&amp;foo);\n      something(&amp;span,&amp;foo);\n    }\n    else {\n      something(&amp;span,&amp;foo);\n      still_other_things(&amp;span,&amp;foo);\n      something(&amp;span,&amp;foo);\n    }\n}\nwhile (foo&lt;bar);\n</code></pre>\n\n<p>Is there a way to repeat a code block and avoid variables being moved and copied around using unnecessary operations? Does the use of functions and classes on such loops actually implies on additional operations and how one could avoid it?</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>As suggested, I ran some tests with the code presented below. I tested several options on how to call a simple increment 100 million times. I'm using GCC over RHEL 7 Server 7.6 on a x86_64 virtual machine under Hyper-V.</p>\n\n<p>Initially, compiling with \"g++ -std=c++17 -o test.o test.cpp\"</p>\n\n<ul>\n<li><p>Simple loop computation (baseline): 211.046ms </p></li>\n<li><p>Inline Function: 468.768ms </p></li>\n<li><p>Lambda Function: 253.466ms</p></li>\n<li><p>Define Macro: 211.995ms</p></li>\n<li><p>Function passing values: 466.986ms </p></li>\n<li><p>Function passing pointers: 344.646ms </p></li>\n<li><p>Function with void: 190.557ms </p></li>\n<li><p>Object method operating with members: 231.458ms </p></li>\n<li><p>Object method passing values: 227.615ms </p></li>\n</ul>\n\n<p>From these results I realized that the compiler was not taking the inline suggestion, even after trying to bulge it to do it as suggested at <a href=\"https://stackoverflow.com/questions/7866861/g-doesnt-inline-functions\">g++ doesn&#39;t inline functions</a></p>\n\n<p>Later, as suggested on the answer from Mat on the same post I turned on the compiler optimizations using \"g++ -std=c++17 -O2 -o test.o test.cpp\" and got the following result for the same the number of iterations compared with the test without optimization.</p>\n\n<ul>\n<li><p>Simple loop computation (baseline): 62.9254ms </p></li>\n<li><p>Inline Function: 65.0564ms </p></li>\n<li><p>Lambda Function: 32.8637ms </p></li>\n<li><p>Define Macro: 63.0299ms</p></li>\n<li><p>Function passing values: 64.2876ms </p></li>\n<li><p>Function passing pointers: 63.3416ms </p></li>\n<li><p>Function with void: 32.1073ms </p></li>\n<li><p>Object method operating with members: 63.3847ms </p></li>\n<li><p>Object method passing values: 62.5151ms </p></li>\n</ul>\n\n<p><strong>Conclusion to this point:</strong></p>\n\n<ul>\n<li><p>inline function is not good alternative because one can not be sure on how the compiler will really take it and the result might be as bad as using a standard function. </p></li>\n<li><p>\"define macros\" and \"lambda functions\" are better alternatives to inline. Each has its benefits and features, #define being more flexible.</p></li>\n<li><p>using object members and methods seams a good balance to solve the problem on any situation while maintaining the code in a form that is easier to maintain and optimize.</p></li>\n<li><p>tweaking the compiler is worth it;</p></li>\n</ul>\n\n<p>Follows the code used for testing:</p>\n\n<pre><code>// Libraries\n    #include &lt;iostream&gt;\n    #include &lt;cmath&gt;\n    #include &lt;chrono&gt;\n\n// Namespaces\n    using namespace std;\n    using namespace std::chrono;\n\n// constants that control program behaviour\n    const long END_RESULT = 100000000;\n    const double AVERAGING_LENGTH = 40.0;\n    const int NUMBER_OF_ALGORITHM = 9;\n    const long INITIAL_VALUE = 0;\n    const long INCREMENT = 1;\n\n// Global variables used for test with void function and to general control of the program;\n    long global_variable;\n    long global_increment;\n\n// Function that returns the execution time for a simple loop\nint64_t simple_loop_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // Perform the computation for baseline\n        do {\n            local_variable += local_increment;\n        } while ( local_variable != END_RESULT);\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return(duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count());\n}\n\n// Functions that computes the execution time when using inline code within the loop\ninline long increment_variable() __attribute__((always_inline));\ninline long increment_variable(long local_variable, long local_increment) {\n    return local_variable += local_increment;\n}\n\nint64_t inline_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // Perform the computation for baseline\n        do {\n            local_variable = increment_variable(local_variable,local_increment);\n        } while ( local_variable != END_RESULT);\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count();\n}\n\n// Functions that computes the execution time when using lambda code within the loop\nint64_t labda_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // define lambda function\n        auto lambda_increment = [&amp;] {\n            local_variable += local_increment;\n        };\n\n    // Perform the computation for baseline\n        do {\n            lambda_increment();\n        } while ( local_variable != END_RESULT);\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count();\n}\n\n// define lambda function\n    #define define_increment() local_variable += local_increment;\n\n// Functions that computes the execution time when using lambda code within the loop\nint64_t define_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // Perform the computation for baseline\n        do {\n            define_increment();\n        } while ( local_variable != END_RESULT);\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count();\n}\n// Functions that compute the execution time when calling a function within the loop passing variable values\nlong increment_with_values_function(long local_variable, long local_increment) {\n    return local_variable += local_increment;\n}\n\nint64_t function_values_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // Perform the computation for baseline\n        do {\n            local_variable = increment_with_values_function(local_variable,local_increment);\n        } while ( local_variable != END_RESULT);\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count();\n}\n// Functions that compute the execution time when calling a function within the loop passing variable pointers\nlong increment_with_pointers_function(long *local_variable, long *local_increment) {\n    return *local_variable += *local_increment;\n}\n\nint64_t function_pointers_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // Perform the computation for baseline\n        do {\n            local_variable = increment_with_pointers_function(&amp;local_variable,&amp;local_increment);\n        } while ( local_variable != END_RESULT);\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count();\n}\n// Functions that compute the execution time when calling a function within the loop without passing variables \nvoid increment_with_void_function(void) {\n    global_variable += global_increment;\n}\n\nint64_t function_void_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // set global variables\n        global_variable = local_variable;\n        global_increment = local_increment;\n\n    // Perform the computation for baseline\n        do {\n            increment_with_void_function();\n        } while ( global_variable != END_RESULT);\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count();\n}\n// Object and Function that compute the duration when using a method of the object where data is stored without passing variables\nstruct object {\n    long object_variable = 0;\n    long object_increment = 1;\n\n    object(long local_variable, long local_increment) {\n        object_variable = local_variable;\n        object_increment = local_increment;\n    }\n\n    void increment_object(void){\n        object_variable+=object_increment;\n    }\n\n    void increment_object_with_value(long local_increment){\n        object_variable+=local_increment;\n    }\n};\n\nint64_t object_members_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // Create object\n        object object_instance = {local_variable,local_increment};\n\n    // Perform the computation for baseline\n        do {\n            object_instance.increment_object();\n        } while ( object_instance.object_variable != END_RESULT);\n\n    // Get the results out of the object\n        local_variable = object_instance.object_variable;\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count();\n}\n\n// Function that compute the duration when using a method of the object where data is stored passing variables\nint64_t object_values_computation(long local_variable, long local_increment) {\n    // Starts the clock to measure the execution time for the baseline\n        high_resolution_clock::time_point timer_start = high_resolution_clock::now();\n\n    // Create object\n        object object_instance = {local_variable,local_increment};\n\n    // Perform the computation for baseline\n        do {\n            object_instance.increment_object_with_value(local_increment);\n        } while ( object_instance.object_variable != END_RESULT);\n\n    // Get the results out of the object\n        local_variable = object_instance.object_variable;\n\n    // Stop the clock to measure performance of the silly version\n        high_resolution_clock::time_point timer_stop = high_resolution_clock::now();\n\n        return duration_cast&lt;microseconds&gt;( timer_stop - timer_start ).count();\n}\n\nint main() {\n\n    // Create array to store execution time results for all tests\n        pair&lt;string,int64_t&gt; duration_sum[NUMBER_OF_ALGORITHM]={\n            make_pair(\"Simple loop computation (baseline): \",0.0),\n            make_pair(\"Inline Function: \",0.0),\n            make_pair(\"Lambda Function: \",0.0),\n            make_pair(\"Define Macro: \",0.0)\n            make_pair(\"Function passing values: \",0.0),\n            make_pair(\"Function passing pointers: \",0.0),\n            make_pair(\"Function with void: \",0.0),\n            make_pair(\"Object method operating with members: \",0.0),\n            make_pair(\"Object method passing values: \",0.0),\n        };\n\n    // loop to compute average of several execution times\n        for ( int i = 0; i &lt; AVERAGING_LENGTH; i++) {\n            // Compute the execution time for a simple loop as the baseline\n                duration_sum[0].second = duration_sum[0].second + simple_loop_computation(INITIAL_VALUE, INCREMENT);\n\n            // Compute the execution time when using inline code within the loop (expected same as baseline)\n                duration_sum[1].second = duration_sum[1].second + inline_computation(INITIAL_VALUE, INCREMENT);\n\n            // Compute the execution time when using lambda code within the loop (expected same as baseline)\n                duration_sum[2].second = duration_sum[2].second + labda_computation(INITIAL_VALUE, INCREMENT);\n\n            // Compute the duration when using a define macro\n                duration_sum[3].second = duration_sum[3].second + define_computation(INITIAL_VALUE, INCREMENT);\n\n            // Compute the execution time when calling a function within the loop passing variables values\n                duration_sum[4].second = duration_sum[4].second + function_values_computation(INITIAL_VALUE, INCREMENT);\n\n            // Compute the execution time when calling a function within the loop passing variables pointers\n                duration_sum[5].second = duration_sum[5].second + function_pointers_computation(INITIAL_VALUE, INCREMENT);\n\n            // Compute the execution time when calling a function within the loop without passing variables\n                duration_sum[6].second = duration_sum[6].second + function_void_computation(INITIAL_VALUE, INCREMENT);\n\n            // Compute the duration when using a method of the object where data is stored without passing variables\n                duration_sum[7].second = duration_sum[7].second + object_members_computation(INITIAL_VALUE, INCREMENT);\n\n            // Compute the duration when using a method of the object where data is stored passing variables\n                duration_sum[8].second = duration_sum[8].second + object_values_computation(INITIAL_VALUE, INCREMENT);\n        }\n\n\n        double average_baseline_duration = 0.0;\n\n    // Print out results\n        for ( int i = 0; i &lt; NUMBER_OF_ALGORITHM; i++) {\n        // compute averave from sum\n            average_baseline_duration = ((double)duration_sum[i].second/AVERAGING_LENGTH)/1000.0;\n\n        // Print the result\n            cout &lt;&lt; duration_sum[i].first &lt;&lt; average_baseline_duration &lt;&lt; \"ms \\n\";\n        }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "singleton", "qmake", "undefined-reference"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553708877, "post_id": 55383548, "comment_id": 97489007, "body": "I suspect the <code>cpp</code> file is not part of your project / Makefile."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553708939, "post_id": 55383548, "comment_id": 97489037, "body": "Maybe you need to run qmake."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553709052, "post_id": 55383548, "comment_id": 97489096, "body": "What does your linker command line actually look like?"}, {"owner": {"reputation": 1, "user_id": 11267974, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dqYW6Lw8ryI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdj3QZEHaM7Wfp_ZI3Z1Jc9NZWSkQ/mo/photo.jpg?sz=128", "display_name": "Aymen Mhamdi", "link": "https://stackoverflow.com/users/11267974/aymen-mhamdi"}, "edited": false, "score": 0, "creation_date": 1553711673, "post_id": 55383548, "comment_id": 97490501, "body": "I am using Qt creator and both .h and .cpp files are added to the .pro file"}], "owner": {"reputation": 1, "user_id": 11267974, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dqYW6Lw8ryI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdj3QZEHaM7Wfp_ZI3Z1Jc9NZWSkQ/mo/photo.jpg?sz=128", "display_name": "Aymen Mhamdi", "link": "https://stackoverflow.com/users/11267974/aymen-mhamdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "closed_date": 1553709014, "answer_count": 0, "score": 0, "last_activity_date": 1553708958, "creation_date": 1553708741, "last_edit_date": 1553708958, "question_id": 55383548, "link": "https://stackoverflow.com/questions/55383548/undefined-reference-to-getinstance-in-meyers-singleton-pattern", "closed_reason": "Duplicate", "title": "Undefined reference to getInstance() in Meyer&#39;s Singleton Pattern", "body": "<p>I have been getting am undefined reference to getInstance() even though the function declaration and definition are the same...</p>\n\n<p>I though this was a linking problem but the .h and cpp files seems to be added to the .pro file in QT</p>\n\n<p>my .h file :</p>\n\n<pre><code>class ErrorStruct\n{\npublic:\n    ErrorStruct(ErrorStruct const&amp;)= delete;\n    ErrorStruct&amp; operator=(ErrorStruct const&amp;) = delete;\n    static ErrorStruct&amp; getInstance(bool mode);\n    void setError(std::string errorMessage, bool critical);\n private:\n    ErrorStruct() {}\n    ~ErrorStruct() {}\n    bool _abortMode;\n    bool _isCritical;\n    std::string _criticalError;\n    std::vector&lt;std::string&gt; _errorStack;\n};\n</code></pre>\n\n<pre><code>\nmy .cpp file:\nErrorStruct&amp; ErrorStruct::getInstance(bool mode){\n    static ErrorStruct instance;\n    instance._abortMode=mode;\n    return instance;\n}\nvoid ErrorStruct::setError(std::string errorMessage, bool critical){\n    /*always push the error to the errorStack\n     * only save the first critical error when abort mode is on*/\n    _errorStack.push_back(errorMessage);\n    if (critical &amp;&amp; _abortMode &amp;&amp; !_isCritical){\n        _criticalError=errorMessage;\n        _isCritical=true;\n    }\n}\n</code></pre>\n\n<p>and this is how I am trying to use it :</p>\n\n<pre><code> ErrorStruct&amp; c = ErrorStruct::getInstance(true);\n c.setError(\"bbb\",true);\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 3, "creation_date": 1553708492, "post_id": 55383428, "comment_id": 97488796, "body": "&quot; I suppose it is time consuming to allocate memory to local variables every time.&quot; Is this actually true? Have you tested that?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553708869, "post_id": 55383428, "comment_id": 97489001, "body": "Sounds like a XY-problem for me. What&#39;s the reason for this requirement: <i>&quot;But I do not want them to be visible to other functions of the same class.&quot;</i>? However such could be probably achieved with inheritance constructs."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553709695, "post_id": 55383428, "comment_id": 97489437, "body": "<i>@user11132556</i> <i>&quot; I suppose it is time consuming to allocate memory to local variables every time.&quot;</i> It&#39;s usually not. Please don&#39;t do premature that kindo micro optimization, before you actually hit a performance bottleneck with your application when <i>local variables</i> are allocated. If so it might be rather a problem with those constructor functions, but not really the allocation of the variable representation itself."}, {"owner": {"reputation": 1, "user_id": 11132556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rbt6i.png?s=128&g=1", "display_name": "user11132556", "link": "https://stackoverflow.com/users/11132556/user11132556"}, "edited": false, "score": 0, "creation_date": 1553713545, "post_id": 55383428, "comment_id": 97491409, "body": "Good question. I had not tested, but now I did. In fact, it really takes time to allocate memory to local variables. But the subsequent function operations probably will take much more time. Surprisingly (to me), in some tests, repeated local variable declarations run faster than once outside function ones. Maybe reading values stored in local variables takes less time, I don&#39;t know."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1553719788, "post_id": 55383428, "comment_id": 97494278, "body": "@user11132556 I supposed you have not tested that in a release build with optimisation enabled and stuff? It&#39;s almost useless to test debug builds."}], "answers": [{"tags": [], "owner": {"reputation": 3498, "user_id": 6801443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cba631e2b30cf9b6b8fa433996ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Sean F", "link": "https://stackoverflow.com/users/6801443/sean-f"}, "is_accepted": false, "score": 1, "last_activity_date": 1553708623, "creation_date": 1553708623, "answer_id": 55383523, "question_id": 55383428, "link": "https://stackoverflow.com/questions/55383428/class-variable-with-scope-restricted-to-function/55383523#55383523", "title": "Class variable with scope restricted to function", "body": "<p>It is not time-consuming to allocate local variables, they are part of a call stack that is allocated in large blocks. What you are intending to do is the opposite of what is good practice. Good practice is to declare a variable in the smallest scope you can. \nAlso, you cannot hide fields from member functions in the same class. </p>\n"}, {"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553708963, "post_id": 55383583, "comment_id": 97489051, "body": "<i>&quot;this is not possible&quot;</i> Well, introducing inheritance level indirections maybe."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553709228, "post_id": 55383583, "comment_id": 97489181, "body": "<i>&quot;because the class knows what it does&quot;</i> At least its developer/maintainer should do ;-D ..."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553709333, "post_id": 55383583, "comment_id": 97489241, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 the existence of the visibility says the developers don&#39;t know what they do (joke) ^^"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1553709378, "post_id": 55383583, "comment_id": 97489263, "body": "<i>&quot;I encourage you to not do that kind of <b>gas factory</b>&quot;</i> You made my day now, that deserves an upvote :-D :-D :-D"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 2, "last_activity_date": 1553709271, "last_edit_date": 1553709271, "creation_date": 1553708886, "answer_id": 55383583, "question_id": 55383428, "link": "https://stackoverflow.com/questions/55383428/class-variable-with-scope-restricted-to-function/55383583#55383583", "title": "Class variable with scope restricted to function", "body": "<p>you look at a wrong question/problem</p>\n\n<ul>\n<li>if you always want a given method returns a given value whatever the instance and the historic of course do not use an attribute for that</li>\n<li>if the value of the attribute depends on the instance use a (non static) attribute</li>\n<li>if the value does not depend on the instance but can change during the execution use a class instance (e.g. <em>static</em>)</li>\n</ul>\n\n<blockquote>\n  <p>But I do not want them to be visible to other functions of the same class.</p>\n</blockquote>\n\n<p>This is not possible just using the visibility, all the methods of the class have (fortunately) access to the attributes of the class, this cannot be a problem because the class knows what it does. Of course the attribute must be at least <em>protected</em>.</p>\n\n<p>Anyway </p>\n\n<ul>\n<li>if the value do not depends on the instance you can may be use a static var defined in the method. </li>\n<li>else you can use a <em>map</em> defined <em>static</em> in the method where the key are the instances and the value the expected value, but that complicate the way to do because you at least need to take into account the deletion of instances. I encourage you to not do that kind of <em>gaz factory</em></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 11132556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rbt6i.png?s=128&g=1", "display_name": "user11132556", "link": "https://stackoverflow.com/users/11132556/user11132556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1553709271, "creation_date": 1553708310, "question_id": 55383428, "link": "https://stackoverflow.com/questions/55383428/class-variable-with-scope-restricted-to-function", "title": "Class variable with scope restricted to function", "body": "<p>A member function will be called repeatedly.<br>\nI suppose it is time consuming to allocate memory to local variables every time.<br>\nA solution would be to declare these variables in the class declaration.<br>\nBut I do not want them to be visible to other functions of the same class.<br>\nIs there a way to do that?<br>\nTried to use namespaces, but it didn't work.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class A\n{\n    int n;                  // only function 'One' should see 'n'\n\n    public:\n        A(void);            // default constructor\n        int One(void);      // member function\n        int Two(void);      // member function\n};\n\n\nA::A(void)                  // default constructor\n{\n     n = 7;\n}\n\n\nint A::One(void)            // function 'One'\n{\n    return n;               // no time lost declaring 'n'\n}\n\nint A::Two(void)            // function 'Two'\n{\n    int n = 7;              // obligatory, no other 'n' available\n    return n;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-c++", "c++-coroutine"], "comments": [{"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 1, "creation_date": 1553708342, "post_id": 55383398, "comment_id": 97488704, "body": "A coroutine needs to return a <code>generator&lt;int&gt;</code> or the like. VS provides an implementation of <code>generator</code> in <code>&lt;experimental&#47;generator&gt;</code> IIRC."}, {"owner": {"reputation": 8647, "user_id": 112755, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/653e9876709910096ccdde524a306bf8?s=128&d=identicon&r=PG", "display_name": "Mordachai", "link": "https://stackoverflow.com/users/112755/mordachai"}, "reply_to_user": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1553708594, "post_id": 55383398, "comment_id": 97488853, "body": "Okay, I found that - but I don&#39;t see how to use that either.  the only operators on generator&lt;int&gt; are begin() and end() - but I&#39;m expecting that to output one value per call - not a range...  ((confused))"}], "owner": {"reputation": 8647, "user_id": 112755, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/653e9876709910096ccdde524a306bf8?s=128&d=identicon&r=PG", "display_name": "Mordachai", "link": "https://stackoverflow.com/users/112755/mordachai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553708192, "creation_date": 1553708192, "question_id": 55383398, "link": "https://stackoverflow.com/questions/55383398/how-do-i-create-a-coroutine-in-vs-2017", "title": "How do I create a coroutine in VS 2017", "body": "<p>I'm trying to learn a bit about coroutines - and as such I just want to create some simple examples to mess around with.</p>\n\n<p>What do I need to define in order to simply declare a short coroutine such as:</p>\n\n<pre><code>int my_fn(int i) { co_yield i; co_yield i&lt;&lt;1; co_yeild i*i; }\n</code></pre>\n\n<p>I'm getting errors from VS 2017 about no promise type for the above co routine definition.</p>\n\n<p>Do I really need to provide a <code>std::experimental::coroutine_traits&lt;int, ...&gt;</code>?</p>\n\n<p>I would have thought that such a thing would be generated on my behalf.  Obviously not!  Or I'm failing to configure the VS project properly in some way?</p>\n"}, {"tags": ["c++", "stl-algorithm"], "comments": [{"owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "edited": false, "score": 0, "creation_date": 1553708441, "post_id": 55383381, "comment_id": 97488769, "body": "<code>std::remove_if</code>only puts at the end of your vector all the elements that evaluates the predicate to <code>true</code>, and returns an iterator to the first element. It must be paired with std::erase using the first iterator as what was returned by remove_if, and the last iterator being <code>vec.end()</code>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1553708488, "post_id": 55383381, "comment_id": 97488795, "body": "<code>std::remove_if()</code> without <code>std::erase()</code> ing the results is practically a NOP at the original container."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1553708543, "post_id": 55383381, "comment_id": 97488823, "body": "<code>std::remove</code> doesn&#39;t remove anything, <code>std::move</code> doesn&#39;t move anything. What a language :-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11267896"}, "reply_to_user": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "edited": false, "score": 0, "creation_date": 1553708596, "post_id": 55383381, "comment_id": 97488854, "body": "@AlexG I&#39;m aware of that. I should have worded it better; what I meant was that <code>std::remove_if</code> rearranges the elements incorrectly (in this case), since the <code>finalScore</code> of elements after <code>rem</code> should be less than 5, although they aren&#39;t (see produced result/edited post)."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1553709378, "post_id": 55383381, "comment_id": 97489264, "body": "@memories do you want to <i>rearrange but not erase</i> elements in your vector? That&#39;s not what <code>remove_if</code> is for, and that would make your question distinct enough to be reopened and answered."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11267896"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1553709703, "post_id": 55383381, "comment_id": 97489447, "body": "@alterigel This is just a test sample but I do want to <code>std::erase</code> them, although I am unable to, since, as I&#39;ve already mentioned, <code>std::remove_if</code> returns an iterator after which elements have a <code>finalScore</code> value of <code>&gt;= 5</code> (that <i>shouldn&#39;t</i> be possible due to the predicate)."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1553709803, "post_id": 55383381, "comment_id": 97489498, "body": "@memories that&#39;s not how <code>remove_if</code> works. I&#39;ll try to have your question reopened so that I can give a formal answer, and a way to actually rearrange elements the way you&#39;re expecting"}, {"owner": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "edited": false, "score": 2, "creation_date": 1553709829, "post_id": 55383381, "comment_id": 97489514, "body": "@memories if you read carefully about <code>std::remove_if</code> the resulting elements have UNSPECIFIED values, thus you can&#39;t look at member variables and expect to have sane results. <code>Relative order of the elements that remain is preserved and the physical size of the container is unchanged. Iterators pointing to an element between the new logical end and the physical end of the range are still dereferenceable, but the elements themselves have unspecified values (as per MoveAssignable post-condition).</code> at best, use <code>std::distance</code> to look the new size of your vector."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11267896"}, "reply_to_user": {"reputation": 1033, "user_id": 7667894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cbd2317a1ddffc1e8f9ca0ff56b6f6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexG", "link": "https://stackoverflow.com/users/7667894/alexg"}, "edited": false, "score": 0, "creation_date": 1553710257, "post_id": 55383381, "comment_id": 97489735, "body": "@AlexG thank you. @alterigel thanks, but that won&#39;t be necessary. I simply wasn&#39;t aware that elements have undefined values after <code>std::remove_if</code>. Tried creating a new <code>std::vector</code> with the use of <code>std::copy_if</code> and everything worked out."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 2, "creation_date": 1553710473, "post_id": 55383381, "comment_id": 97489851, "body": "@memories you can use <a href=\"https://en.cppreference.com/w/cpp/algorithm/partition\" rel=\"nofollow noreferrer\"><code>std::partition</code></a> as a drop-in replacement for <code>remove_if</code> to achieve the behavior you expected"}], "owner": {"user_type": "does_not_exist", "display_name": "user11267896"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "closed_date": 1553708279, "answer_count": 0, "score": 0, "last_activity_date": 1553710905, "creation_date": 1553708133, "last_edit_date": 1553710905, "question_id": 55383381, "link": "https://stackoverflow.com/questions/55383381/stdremove-if-leaves-elements-after-the-returned-iterator-that-should-not-have", "closed_reason": "Duplicate", "title": "std::remove_if leaves elements after the returned iterator that should not have been removed", "body": "<p>I've encountered a strange problem: <code>std::remove_if</code> does not arrange all elements matching a specified predicate correctly. For example, the following</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;algorithm&gt;\n#include &lt;ctime&gt;\n#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nstruct Test {\n    std::string name;\n    double finalScore = 0;\n\n    Test( double k ) : finalScore( k ) {}\n};\n\nint main() {\n    std::srand( static_cast&lt;unsigned int&gt;( std::time( nullptr ) ) );\n\n    std::vector&lt;Test&gt; vec;\n    for ( unsigned i = 0; 50 != i; ++i ) {\n        vec.push_back( Test( rand() % 10 + 1 ) );\n    }\n\n    auto rem = std::remove_if( vec.begin(), vec.end(), []( const Test &amp;s ) {\n        return s.finalScore &lt; 5.0;\n    } );\n\n    std::cout &lt;&lt; \"item with below 5.0 finalScore count: \"\n              &lt;&lt; ( vec.end() - rem ) &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"items with below 5.0 finalScore: \" &lt;&lt; std::endl;\n\n    for ( auto it = rem; vec.end() != it; ++it ) {\n        std::cout &lt;&lt; it-&gt;finalScore;\n\n        if ( it-&gt;finalScore &gt;= 5.0 ) {\n            std::cout &lt;&lt; \" | incorrect; should not be present after rem.\";\n        }\n\n        std::cout &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>produces</p>\n\n<pre><code>item with below 5.0 finalScore count: 16\nitems with below 5.0 finalScore:\n3\n9 | incorrect; should not be present after rem.\n8 | incorrect; should not be present after rem.\n1\n5 | incorrect; should not be present after rem.\n6 | incorrect; should not be present after rem.\n6 | incorrect; should not be present after rem.\n7 | incorrect; should not be present after rem.\n3\n4\n4\n5 | incorrect; should not be present after rem.\n6 | incorrect; should not be present after rem.\n2\n8 | incorrect; should not be present after rem.\n10 | incorrect; should not be present after rem.\n</code></pre>\n\n<p>The problem is clearly visible: there are elements, whos' <code>finalScore</code> data member is <code>&gt;= 5</code>, which there shouldn't be. The expected result should be something along the lines of</p>\n\n<pre><code>item with below 5.0 finalScore count: 6\nitems with below 5.0 finalScore:\n3\n1\n3\n4\n4\n2\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "producer-consumer", "condition-variable"], "comments": [{"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "edited": false, "score": 0, "creation_date": 1553709238, "post_id": 55383367, "comment_id": 97489187, "body": "It&#39;s generally a good idea to isolate the synchronization bits with a good abstraction.  What you&#39;re looking for here is a bounded buffer."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553709488, "post_id": 55383367, "comment_id": 97489334, "body": "Now that you sneakily integrated my changes, does it still deadlock?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1553709700, "post_id": 55383367, "comment_id": 97489444, "body": "Your code would not compile. Post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "edited": false, "score": 0, "creation_date": 1553709851, "post_id": 55383367, "comment_id": 97489521, "body": "@PeterRuderman The code uses <i>unbounded</i> queue, why do you suggest a <i>bounded</i> buffer?"}, {"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "edited": false, "score": 1, "creation_date": 1553710087, "post_id": 55383367, "comment_id": 97489644, "body": "I don&#39;t want to get too far off topic, but in general we don&#39;t want to allow an algorithm to eat up all system resources.  We should think about and set a suitable upper limit (which can be quite large, if appropriate).  But my main point is that the bounded buffer abstraction isolates all the locking and waiting.  All the producer has to do is make items and call push().  All the consumer has to do is call pop() and deal with the items.  (I was also hoping that the OP would look up bounded buffer to see what it is.)"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "edited": false, "score": 0, "creation_date": 1553710559, "post_id": 55383367, "comment_id": 97489905, "body": "@PeterRuderman Makes sense, yes."}, {"owner": {"reputation": 179, "user_id": 10558944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8e82fca23ac024affb697fcf8e5c96?s=128&d=identicon&r=PG&f=1", "display_name": "adamlowlife", "link": "https://stackoverflow.com/users/10558944/adamlowlife"}, "edited": false, "score": 1, "creation_date": 1553711575, "post_id": 55383367, "comment_id": 97490445, "body": "I&#39;ve included the minimal, complete and verifiable example. There are few simplifications, for example the condition in producer is different (it&#39;s supposed to be triggered by a different class), but the deadlock (or some other issue) remains."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 10558944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8e82fca23ac024affb697fcf8e5c96?s=128&d=identicon&r=PG&f=1", "display_name": "adamlowlife", "link": "https://stackoverflow.com/users/10558944/adamlowlife"}, "edited": false, "score": 0, "creation_date": 1553709697, "post_id": 55383456, "comment_id": 97489441, "body": "I might have confused you with the variable names - orders and products are supposed to be one thing - products. I&#39;ve included your suggestions and the program works even wierder now - sometimes ends in a deadlock, sometimes it ends, but consumers don&#39;t consume the products."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 179, "user_id": 10558944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8e82fca23ac024affb697fcf8e5c96?s=128&d=identicon&r=PG&f=1", "display_name": "adamlowlife", "link": "https://stackoverflow.com/users/10558944/adamlowlife"}, "edited": false, "score": 0, "creation_date": 1553709721, "post_id": 55383456, "comment_id": 97489457, "body": "@adamlowlife Post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "edited": false, "score": 1, "creation_date": 1553710428, "post_id": 55383456, "comment_id": 97489819, "body": "Stack overflow isn&#39;t really a good site for interactive debugging.  If Maxim has solved your original problem, then please accept the answer and come back later if you have another question.  (Also, please restore the example to its original form.)"}, {"owner": {"reputation": 360, "user_id": 11663962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e738fd7dc3717eb7528a25ddba2c65e0?s=128&d=identicon&r=PG&f=1", "display_name": "SPD", "link": "https://stackoverflow.com/users/11663962/spd"}, "edited": false, "score": 0, "creation_date": 1584534047, "post_id": 55383456, "comment_id": 107464519, "body": "The statement of &quot;When people use std::atomic along with std::mutex and std::condition_variable that results in deadlock in almost 100% of cases.&quot; seems to be overly generalized. Not necessarily always the case. If you check the revision history and read the original code, the bug is fairly simple: the termination flag is not checked in the condition variable condition. atomic + mutex + condition_variable ==&gt; deadlock seems an over statement to me."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1553711573, "last_edit_date": 1553711573, "creation_date": 1553708394, "answer_id": 55383456, "question_id": 55383367, "link": "https://stackoverflow.com/questions/55383367/c-producer-consumer-stuck-in-deadlock/55383456#55383456", "title": "C++ Producer Consumer stuck in deadlock", "body": "<p>When people use <code>std::atomic</code> along with <code>std::mutex</code> and <code>std::condition_variable</code> that results in deadlock in almost 100% of cases. This is because modifications to that atomic variable are not protected by the mutex and hence condition variable notifications get lost when that variable is updated after the mutex is locked but before condition variable wait in the consumer.</p>\n\n<p>A fix would be to not use <code>std::atomic</code> and only modify and read <code>producers_done</code> while the mutex is held. E.g.:</p>\n\n<pre><code>void Company::consumer(){\n    for(;;){\n        unique_lock&lt;mutex&gt; lock(mut);\n        while(products.empty() &amp;&amp; !producers_done)\n            cond.wait(lock);\n        if(products.empty())\n            break;\n        orders.pop();\n    }   \n}\n</code></pre>\n\n<hr>\n\n<p>Another error in the code is that in <code>while(!products.empty())</code> it calls <code>products.empty()</code> without holding the mutex, resulting in a race condition.</p>\n\n<hr>\n\n<p>The next error is keeping the mutex locked while waiting for the consumer threads to terminate. Fix:</p>\n\n<pre><code>{\n    unique_lock&lt;mutex&gt; lock(mut);\n    producers_done = true;\n    // mutex gets unlocked here.\n}\ncond.notify_all();\n\nfor(auto &amp;consumer_thread : consumers_threads)\n    consumer_thread.join();\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 10558944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8e82fca23ac024affb697fcf8e5c96?s=128&d=identicon&r=PG&f=1", "display_name": "adamlowlife", "link": "https://stackoverflow.com/users/10558944/adamlowlife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 922, "favorite_count": 0, "accepted_answer_id": 55383456, "answer_count": 1, "score": 0, "last_activity_date": 1553711573, "creation_date": 1553708071, "last_edit_date": 1553711284, "question_id": 55383367, "link": "https://stackoverflow.com/questions/55383367/c-producer-consumer-stuck-in-deadlock", "title": "C++ Producer Consumer stuck in deadlock", "body": "<p>I'm trying to create a producer-consumer program, where the consumers must keep running until all the producers are finished, then consume what's left in the queue (if there's anything left) and then end. You can check my code bellow, I think I know where the problem (probably deadlock) is, but I don't know how to make it work properly. </p>\n\n<pre><code>  #include&lt;iostream&gt;\n  #include&lt;cstdlib&gt;\n  #include &lt;queue&gt;\n  #include &lt;thread&gt;\n  #include &lt;mutex&gt;\n  #include &lt;condition_variable&gt;\n\n  using namespace std;\n\n  class Company{\n    public:\n        Company() : producers_done(false) {}\n        void start(int n_producers, int n_consumers); // start customer&amp;producer threads\n        void stop(); // join all threads\n        void consumer();\n        void producer();\n        /* some other stuff */\n    private:\n        condition_variable cond;\n        mutex mut;\n        bool producers_done;\n        queue&lt;int&gt; products;\n        vector&lt;thread&gt; producers_threads;\n        vector&lt;thread&gt; consumers_threads;\n        /* some other stuff */\n  };\n\nvoid Company::consumer(){\n    while(!products.empty()){\n        unique_lock&lt;mutex&gt; lock(mut);\n        while(products.empty() &amp;&amp; !producers_done){\n            cond.wait(lock); // &lt;- I think this is where the deadlock happens\n        }\n        if (products.empty()){\n            break;\n        }\n        products.pop();\n        cout &lt;&lt; \"Removed product \" &lt;&lt; products.size() &lt;&lt; endl;\n    }\n}\n\nvoid Company::producer(){\n    while(true){\n        if((rand()%10) == 0){\n          break;\n        }\n        unique_lock&lt;mutex&gt; lock(mut);\n        products.push(1);\n        cout &lt;&lt; \"Added product \" &lt;&lt; products.size() &lt;&lt; endl;\n        cond.notify_one();\n    }\n}\n\nvoid Company::stop(){\n    for(auto &amp;producer_thread : producers_threads){\n        producer_thread.join();\n    }\n    unique_lock&lt;mutex&gt; lock(mut);\n    producers_done = true;\n    cout &lt;&lt; \"producers done\" &lt;&lt; endl;\n    cond.notify_all();\n    for(auto &amp;consumer_thread : consumers_threads){\n        consumer_thread.join();\n    }\n    cout &lt;&lt; \"consumers done\" &lt;&lt; endl;\n}\n\nvoid Company::start(int n_producers, int n_consumers){\n  for(int i = 0; i&lt;n_producers; ++i){\n    producers_threads.push_back(thread(&amp;Company::producer, this));\n  }\n\n  for(int i = 0; i&lt;n_consumers; ++i){\n    consumers_threads.push_back(thread(&amp;Company::consumer, this));\n  }\n}\n\nint main(){\n  Company c;\n  c.start(2, 2);\n  c.stop();\n\n  return true;\n}\n</code></pre>\n\n<p>I know, there are a lot of producer-consumer related questions here, and I've scrolled through at least 10 of them, but none provided answer to my issue.</p>\n"}, {"tags": ["c++", "operator-overloading", "overloading", "new-operator", "delete-operator"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553708130, "post_id": 55383289, "comment_id": 97488575, "body": "You are not passing the parameter Numbers to delete ()"}, {"owner": {"reputation": 15, "user_id": 11024824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/016415ffd5f6f9358e6df0991e399241?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/11024824/programmer"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553708353, "post_id": 55383289, "comment_id": 97488711, "body": "If I do it like this<code>DeleteWithDebug (Numbers); </code>, I get this error, <code>error: &#39;(0, __FUNCTION__)&#39; cannot be used as a function</code>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553708423, "post_id": 55383289, "comment_id": 97488757, "body": "That is why I deleted my second comment. I thought about it for a few seconds and saw my mistake."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553709181, "post_id": 55383289, "comment_id": 97489160, "body": "BTW, You are not calling the constructor / destructor in your new / delete. you probably want to use ::new and ::delete instead of malloc() / free."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553709610, "post_id": 55383289, "comment_id": 97489394, "body": "Related: <a href=\"https://stackoverflow.com/questions/438515/how-to-track-memory-allocations-in-c-especially-new-delete\" title=\"how to track memory allocations in c especially new delete\">stackoverflow.com/questions/438515/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11024824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/016415ffd5f6f9358e6df0991e399241?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/11024824/programmer"}, "edited": false, "score": 0, "creation_date": 1553708739, "post_id": 55383439, "comment_id": 97488935, "body": "So you are saying I can&#39;t do something like this? <code>void operator delete(void *p, const char *file, int line, const char *function);</code>, I really wanted to track the deallocation in the code. Any other ways?"}, {"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "reply_to_user": {"reputation": 15, "user_id": 11024824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/016415ffd5f6f9358e6df0991e399241?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/11024824/programmer"}, "edited": false, "score": 0, "creation_date": 1553721945, "post_id": 55383439, "comment_id": 97495332, "body": "To achieve what you want, you don&#39;t need to overload the operators, since you&#39;re having to use macros anyway. Just write a functional macro that inserts your debug prints before doing the actual <code>new</code> or <code>delete</code>"}], "tags": [], "owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "is_accepted": false, "score": 0, "last_activity_date": 1553708334, "creation_date": 1553708334, "answer_id": 55383439, "question_id": 55383289, "link": "https://stackoverflow.com/questions/55383289/global-overloading-new-and-delete-operators-in-c/55383439#55383439", "title": "Global overloading New and Delete operators in c++", "body": "<p>Your problem is that you're not allowed to use a placement delete operator with a delete expression: <a href=\"https://en.wikipedia.org/wiki/Placement_syntax#Placement_delete\" rel=\"nofollow noreferrer\">see here</a>.  They are only called when a placement new expression encounters an exception in the constructor.</p>\n\n<p>From the above</p>\n\n<blockquote>\n  <p>If the constructor throws an exception, it is necessary to deallocate that storage before propagating the exception back to the code that executed the placement new expression, and that is the purpose of the placement delete functions.</p>\n</blockquote>\n"}], "owner": {"reputation": 15, "user_id": 11024824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/016415ffd5f6f9358e6df0991e399241?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/11024824/programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1402, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1553708334, "creation_date": 1553707779, "question_id": 55383289, "link": "https://stackoverflow.com/questions/55383289/global-overloading-new-and-delete-operators-in-c", "title": "Global overloading New and Delete operators in c++", "body": "<p>I have overloaded the <code>new</code> and <code>delete</code> operators to track where we allocate and deallocate memory. The overloaded <code>new</code> operator works fine but I get an error when I try to use the overloaded <code>delete</code> operator. I'm hoping someone can shed some lights. It's probably something minor.</p>\n\n<p><strong>Header File Code</strong></p>\n\n<pre><code>void *operator new[] (size_t size, const char *file, int line, const char *function);\nvoid operator delete(void *p, const char *file, int line, const char *function);\n\n// other operators\n\n#define NewWithDebug new (__FILE__, __LINE__, __FUNCTION__)\n#define DeleteWithDebug delete (__FILE__, __LINE__, __FUNCTION__)\n</code></pre>\n\n<p><strong>Source File Code</strong></p>\n\n<pre><code>void *operator new (size_t size, const char *file, int line, const char *function)\n{\n    printf(\"Memory Allocated (Size %zu): file= %s , function = %s , line =%d \\n\", size, file, function, line );\n    return malloc(size);\n}\n\nvoid *operator new[] (size_t size, const char *file, int line, const char *function)\n{\n    printf (\"Memory Allocated (Size %zu): file= %s , function = %s , line =%d \\n\", size, file, function, line);\n    return malloc(size);\n}\n\n\nvoid operator delete(void *p, const char *file, int line, const char *function)\n{\n    printf(\"Memory Deallocated: file= %s , function = %s , line =%d \\n\", file, function, line);\n    free(p);\n}\n</code></pre>\n\n<p><strong>Main</strong></p>\n\n<pre><code>int* Numbers = NewWithDebug int(5);\nDeleteWithDebug Numbers; // &lt;---- Error Here;\n</code></pre>\n\n<p><strong>Error Message</strong> </p>\n\n<p><code>error: expected `;' before 'Numbers</code></p>\n"}, {"tags": ["c++", "matlab", "arduino"], "comments": [{"owner": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 1, "creation_date": 1553708352, "post_id": 55383153, "comment_id": 97488710, "body": "a) what is your actual question? b) how do you interface Matlab and the accelerometer?"}, {"owner": {"reputation": 11, "user_id": 11267798, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457484337643756/picture?type=large", "display_name": "Jo&#227;o Carvalho", "link": "https://stackoverflow.com/users/11267798/jo%c3%a3o-carvalho"}, "reply_to_user": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 0, "creation_date": 1553717265, "post_id": 55383153, "comment_id": 97493148, "body": "a) my question is how I rewrite that piece of code into matlab language. There are several structures, such as &quot;u_val  = this-&gt;readReg(reg[0]) &amp; mask[0];&quot;  that I don&#39;t understand how it works and how I rewrite.  b)I&#39;m using an arduino board and the matlab library for arduino"}, {"owner": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 0, "creation_date": 1553725406, "post_id": 55383153, "comment_id": 97496608, "body": "like with any translation job you have to know both languages very well. stackoverflow is not a code translation service. the mentioned expression is very basic C++. An assignment with a function call and a bitwise or. it&#39;s part  of reading a value from registers. you read a high and a low byte and combine it to the 16bit sensor output."}], "owner": {"reputation": 11, "user_id": 11267798, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457484337643756/picture?type=large", "display_name": "Jo&#227;o Carvalho", "link": "https://stackoverflow.com/users/11267798/jo%c3%a3o-carvalho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553707351, "creation_date": 1553707351, "question_id": 55383153, "link": "https://stackoverflow.com/questions/55383153/how-to-rewrite-an-arduino-library-code-into-a-matlab-script", "title": "How to rewrite an arduino library code into a matlab script?", "body": "<p>Good Morning everyone!</p>\n\n<p>I'm working on a college project which i'm trying to read the data from an accelerometer (MMA7455) using a matlab script. I wasn't able to find much information about how to work with this device except an arduino library.</p>\n\n<p>I did convert some of the code, which is in C/C++, but now i'm stuck in this part because i'm not familiarized with C/C++ language.</p>\n\n<p>Here's some of the code that I need to convert. </p>\n\n<p>This part is supposed to read the 10 bits information provided by the sensor, which works with I2C protocol. </p>\n\n<pre><code>int16_t MMA_7455::readAxis10(char axis)\n{\n  uint8_t  reg[2]  = {0};\n  uint8_t  mask[2] = {0};\n  uint16_t u_val   = 0;\n  int16_t  s_val   = 0;\n\n  switch(axis)\n  {\n    case 'x':\n    case 'X':\n      reg[0] = XOUTL_OFF; mask[0] = XOUTL_MASK;\n      reg[1] = XOUTH_OFF; mask[1] = XOUTH_MASK;\n      break;\n    case 'y':\n    case 'Y':\n      reg[0] = YOUTL_OFF; mask[0] = YOUTL_MASK;\n      reg[1] = YOUTH_OFF; mask[1] = YOUTH_MASK;\n      break;\n    case 'z':\n    case 'Z':\n      reg[0] = ZOUTL_OFF; mask[0] = ZOUTL_MASK;\n      reg[1] = ZOUTH_OFF; mask[1] = ZOUTH_MASK;\n      break;\n    default:\n      return 0;\n  }\n\n  u_val  = this-&gt;readReg(reg[0]) &amp; mask[0];\n  u_val |= (this-&gt;readReg(reg[1]) &amp; mask[1]) &lt;&lt; 8;\n  s_val  = (int16_t)u_val;\n\n  /* fill of ones if negative value\n   * to make it valid in 16 bit format */\n  if(s_val &amp; (1 &lt;&lt; 9))\n  {\n    s_val |= 0xFC00;\n  }\n\n  return s_val;\n}\n</code></pre>\n\n<p>This is what a got so far:</p>\n\n<pre><code>function s_val = readAxis10(dev, axis)\n    reg = zeros(1,3);\n    mask = zeros(1,3);\n\n    switch(axis)\n        case 'x'\n            reg(1) = hex2dec(\"00\"); mask(1) = hex2dec(\"FF\"); %10bits Output X LBS\n            reg(2) = hex2dec(\"01\"); mask(2) = hex2dec(\"03\"); %10bits Output X MBS\n        case 'y'\n            reg(1) = hex2dec(\"02\"); mask(1) = hex2dec(\"FF\"); %10bits Output Y LBS\n            reg(2) = hex2dec(\"03\"); mask(2) = hex2dec(\"03\"); %10bits Output Y MBS\n        case 'z'\n            reg(1) = hex2dec(\"04\"); mask(1) = hex2dec(\"FF\"); %10bits Output Z LBS\n            reg(2) = hex2dec(\"05\"); mask(2) = hex2dec(\"03\"); %10bits Output Z MBS\n    end\n    u_val = bitand(readRegister(dev, reg(1)),mask(1));\n    u_val = bitor(u_val, bitshift(bitand(readRegister(dev, reg(2)),mask(2)),-8));\n    s_val = uint16(u_val);\n\n    if (bitand(s_val, bitshift(1,9)))\n        s_val = bitor(s_val, hex2dec(\"FC00\"));\n    end\nend\n</code></pre>\n\n<p>Hope you people can help me!</p>\n"}, {"tags": ["c++", "opencl"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 1, "creation_date": 1553707879, "post_id": 55383011, "comment_id": 97488421, "body": "You can use host memory instead i.e. <code>clCreateBuffer(  ... | CL_MEM_USE_HOST_PTR , ..., size, host_ptr, ...);</code>"}, {"owner": {"reputation": 2281, "user_id": 1524511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/iyH0t.jpg?s=128&g=1", "display_name": "Vuwox", "link": "https://stackoverflow.com/users/1524511/vuwox"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1553708968, "post_id": 55383011, "comment_id": 97489054, "body": "@VictorGubin By using Host memory, I need to provide a pointer on the host, but If I want to allocate it only on the device, because I never need it on host (aka host_ptr == NULL) what should I do ? I would like to avoid the transfer as much as possible."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1553773099, "post_id": 55383011, "comment_id": 97513539, "body": "pointer is a memory address aka size_t (unsigned long or unsigned long long depending on CPU arch ). When you creating a cl buffer using a host ptr - it means GPU will use existing memory ( i.e. RAM) at the address of pointer, and nothing will be copied from RAM to VRAM. Otherwise clCreateBuffer will allocate a memory block in VRAM, and return you a pointer on the memory block allocated."}, {"owner": {"reputation": 2281, "user_id": 1524511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/iyH0t.jpg?s=128&g=1", "display_name": "Vuwox", "link": "https://stackoverflow.com/users/1524511/vuwox"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1553779047, "post_id": 55383011, "comment_id": 97517369, "body": "Yes, I understand all of this. But by allocating using CL_MEM_USE_HOST_PTR, I first need to allocate something on CPU to point onto, and when calling the buffer, I need to wait the bandwitdh for the transfer of that memory on the GPU device, but by allocating without the flag, and NULL pointer, its allocating it directly on the device without any transfer requires, which is super fast, specially when you need memory to reside on the device and never query on the host. But Im just wondering if there is a way to tell when to stop allocate like that, and switch to CL_MEM_USE_HOST_PTR  maybe."}], "answers": [{"tags": [], "owner": {"reputation": 1128, "user_id": 1267222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44f5d723bf2ef2dac40327bfa9815989?s=128&d=identicon&r=PG", "display_name": "Jan-Gerd", "link": "https://stackoverflow.com/users/1267222/jan-gerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1554051391, "creation_date": 1554051391, "answer_id": 55443229, "question_id": 55383011, "link": "https://stackoverflow.com/questions/55383011/opencl-pipeline-failed-to-allocate-buffer-with-cl-mem-object-allocation-failure/55443229#55443229", "title": "OpenCL Pipeline failed to allocate buffer with cl_mem_object_allocation_failure", "body": "<p>Some parts of your device's VRAM may be used for the pixel buffer, constant memory, or other uses. For AMD cards, you can set the environment variables <code>GPU_MAX_HEAP_SIZE</code> and <code>GPU_MAX_ALLOC_PERCENT</code> to use a larger part of the VRAM, though this may have unintended side-effects. Both are expressed as percentages of your physically available memory on the card. Additionally, there is a limit on the size for each memory allocation. You can get the maximum size for a single memory allocation by querying <code>CL_DEVICE_MAX_MEM_ALLOC_SIZE</code>, which may be less than <code>CL_DEVICE_GLOBAL_MEM_SIZE</code>. For AMD cards, this size can be controlled with <code>GPU_SINGLE_ALLOC_PERCENT</code>. This requires no changes to your code, simply set the variables before you call your executable:</p>\n\n<pre><code>GPU_MAX_ALLOC_PERCENT=\"100\"\nGPU_MAX_HEAP_SIZE=\"100\"\nGPU_SINGLE_ALLOC_PERCENT=\"100\"\n./your_program\n</code></pre>\n"}], "owner": {"reputation": 2281, "user_id": 1524511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/iyH0t.jpg?s=128&g=1", "display_name": "Vuwox", "link": "https://stackoverflow.com/users/1524511/vuwox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 499, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1554051391, "creation_date": 1553706881, "last_edit_date": 1553712911, "question_id": 55383011, "link": "https://stackoverflow.com/questions/55383011/opencl-pipeline-failed-to-allocate-buffer-with-cl-mem-object-allocation-failure", "title": "OpenCL Pipeline failed to allocate buffer with cl_mem_object_allocation_failure", "body": "<p>I have an OpenCL pipeline that process image/video and it can be greedy with the memory sometimes. It is crashing on cl::Buffer() allocation like this:</p>\n\n<pre><code>cl_int err = CL_SUCCESS;\ncl::Buffer tmp = cl::Buffer(m_context, CL_MEM_READ_WRITE, sizeData, NULL, &amp;err);\n</code></pre>\n\n<p>with the error <code>-4 - cl_mem_object_allocation_failure</code>.</p>\n\n<p>This occurs at a fix point in my pipeline by using very large images. If I just downscale the image a bit, it pass through the pipeline at this very memory intensive part.</p>\n\n<p>I have access to a Nvidia card with 4go that bust at a certain point, and also tried on an AMD GPU with 2go which bust earlier.</p>\n\n<p>According to this <a href=\"https://stackoverflow.com/questions/3568115/how-do-i-determine-available-device-memory-in-opencl\">thread</a>, there is no need to know the current allocation due to swapping with VRAM, but it seems that my pipeline bust the memory of my device.</p>\n\n<p>So here are my question:</p>\n\n<p><strong>1) Is there any settings on my computer, or pipeline to set to allow more VRAM ?</strong></p>\n\n<p><strong>2) Is it okay to use <code>CL_DEVICE_GLOBAL_MEM_SIZE</code> as reference of the maximum size to allocate, or I need to do <code>CL_DEVICE_GLOBAL_MEM_SIZE</code> - (local memory + private), or something like that ?</strong></p>\n\n<p>According to my own memory profiler, I have 92% of the <code>CL_DEVICE_GLOBAL_MEM_SIZE</code> allocated at the crash. And by resizing a bit, the pipeline says that I used 89% on the resized image and it passed, so I assume that my large image is on the edge to pass.</p>\n"}, {"tags": ["c++", "c", "x86", "profiling", "intel-pin"], "answers": [{"comments": [{"owner": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "edited": false, "score": 0, "creation_date": 1553709266, "post_id": 55383529, "comment_id": 97489199, "body": "Thanks @Hadi. But, is there any way to detect the rsp instruction in the analysis routine. What would you suggest? is this okay if I add a condition in the instrumentation routine instead, to detect such an instruction? or shall I detect <code>ah</code> instead in the analysis routine. What is more reliable?"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "edited": false, "score": 2, "creation_date": 1553709444, "post_id": 55383529, "comment_id": 97489298, "body": "@Ruturaj Yes, but it depends on what you want to do. If the analysis routine only cares about instructions whose first operand is <code>RSP</code>, then perform the check in the instrumentation routine (where <code>INS</code> is valid). Otherwise, you have to either copy the bytes of the instruction or pass the address of the instruction so it can be inspected in the analysis routine."}], "tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": true, "score": 3, "last_activity_date": 1553708646, "creation_date": 1553708646, "answer_id": 55383529, "question_id": 55382659, "link": "https://stackoverflow.com/questions/55382659/intel-pin-analysis-routine-detects-ah-register-instead-of-rsp-reg-stack-ptr/55383529#55383529", "title": "intel Pin: analysis routine detects ah register instead of rsp (REG_STACK_PTR)", "body": "<p>The <code>INS</code> objects are only valid inside instrumentation routines, such as your <code>Instruction</code> routine. The <code>INS</code> type is nothing but a 32-bit integer that identifies an instruction. The Pin runtime internally maintains a table that maps these 32-bit integers to specific static instructions. It creates such a table whenever it's about to call an instrumentation routine. When the instrumentation routine returns, there is no guarantee that any of these identifiers map to the same static instructions and they may not even be valid. So when you save a copy of an <code>INS</code> object in the following line of code:</p>\n\n<pre><code>insstack.insert(std::make_pair(INS_Address(ins), new Insr(string(INS_Disassemble(ins)),\n    ins)));\n</code></pre>\n\n<p>that copy is only useful in the same instance of the <code>Instruction</code> routine. The next time the <code>Instruction</code> routine is called (or any other instrumentation routine), an instruction identifier might be reused for other instructions.</p>\n\n<p>If you really want to pass an instruction to an analysis routine, you have two options:</p>\n\n<ul>\n<li>Copy the actual bytes of the instruction to a buffer and pass the address of the buffer and later decode it using the XED API.</li>\n<li>Pass the address of the instruction and later decode it using the XED API. This works if the instruction is guaranteed to be available at the same location later.</li>\n</ul>\n"}], "owner": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 55383529, "answer_count": 1, "score": 2, "last_activity_date": 1596536963, "creation_date": 1553705749, "last_edit_date": 1596536963, "question_id": 55382659, "link": "https://stackoverflow.com/questions/55382659/intel-pin-analysis-routine-detects-ah-register-instead-of-rsp-reg-stack-ptr", "title": "intel Pin: analysis routine detects ah register instead of rsp (REG_STACK_PTR)", "body": "<p>I asked <a href=\"https://stackoverflow.com/questions/55264577/stack-allocation-size-using-intel-pin-tool\">this</a> question few days ago.</p>\n<p>I wanted to get the stack allocation size (after the function creation). The answer suggests to do:</p>\n<blockquote>\n<pre><code>if((INS_Opcode(ins) == XED_ICLASS_ADD || INS_Opcode(ins) == XED_ICLASS_SUB) &amp;&amp; \n   REG(INS_OperandReg(ins, 0)) == REG_STACK_PTR &amp;&amp; INS_OperandIsImmediate(ins, 1)\n</code></pre>\n</blockquote>\n<p>Which in theory is correct and does make sense. But, it doesn't work in practice (correct me if I'm wrong here). It works perfectly fine if I remove <code>REG(INS_OperandReg(ins, 0)) == REG_STACK_PTR</code> check. Why? Because pin doesn't detect the <code>REG_STACK_PTR</code> register when <code>REG(INS_OperandReg(ins, 0))</code> is used to detect it. rather, it detects <code>ah</code> (which I believe is RAX), when I do check against <code>add rsp, 0xffffffffffffff80</code> instruction (so, every time it gives: <code>register: ah</code>), as can be seen in my output below:</p>\n<pre><code>in\nregister: rbp\n40051e  push rbp\nregister: *invalid*\nvalue: -128\n40051f  mov rbp, rsp\nregister: ah\n400522  add rsp, 0xffffffffffffff80\nregister: *invalid*\n400526  mov dword ptr [rbp-0x28], 0x7\nregister: *invalid*\n40052d  mov dword ptr [rbp-0x64], 0x9\nregister: eax\n400534  mov eax, 0x0\nregister: *invalid*\n400539  call 0x4004e6\nregister: rbp\n4004e6  push rbp\nregister: *invalid*\nvalue: 64\n4004e7  mov rbp, rsp\nregister: ah\n4004ea  sub rsp, 0x40\nregister: *invalid*\n4004ee  mov dword ptr [rbp-0xc], 0x4\nregister: rax\n4004f5  lea rax, ptr [rbp-0xc]\nregister: *invalid*\n4004f9  mov qword ptr [rbp-0x8], rax\nregister: rax\n4004fd  mov rax, qword ptr [rbp-0x8]\nregister: eax\n400501  mov eax, dword ptr [rax]\nregister: *invalid*\n400503  mov esi, eax\nregister: edi\n400505  mov edi, 0x4005d0\nregister: eax\n40050a  mov eax, 0x0\nregister: rdi\n40050f  call 0x4003f0\nregister: rdi\n4003f0  jmp qword ptr [rip+0x200c22]\nregister: *invalid*\n4003f6  push 0x0\nregister: *invalid*\n4003fb  jmp 0x4003e0\nregister: *invalid*\n4003e0  push qword ptr [rip+0x200c22]\nregister: rdi\n4003e6  jmp qword ptr [rip+0x200c24]\n4\nregister: *invalid*\n400514  mov dword ptr [rbp-0x3c], 0x3\n40051b  nop\nregister: *invalid*\n40051c  leave \nregister: *invalid*\n40051d  ret \nregister: eax\n40053e  mov eax, 0x0\nregister: *invalid*\n400543  leave \nout\n</code></pre>\n<p>Well, interestingly it does this for every occurrences of <code>rsp</code> (i.e. it detects <code>ah</code> instead of <code>rsp</code>). Also, it always prints the instruction <code>400522 add rsp, 0xffffffffffffff80</code>, including <code>rsp</code> (So, why it doesn't print <code>ah</code> here?)</p>\n<p>If <code>ah</code> represents <code>rsp</code> in some way, then I can always detect <code>ah</code> using: <code>REG(INS_OperandReg(ins, 0)) == REG_AH</code>. But, I want to understand what is going on here.</p>\n<p>My code:</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &quot;pin.H&quot;\n#include &lt;unordered_map&gt;\n\n// key to open the main Routine\nstatic uint32_t key = 0;\n\n// Ins object mapping\nclass Insr\n{\nprivate:\n  // Disassembled instruction\n    string insDis;\n  INS ins;\n\npublic:\n    Insr(string insDis, INS ins) { this-&gt;insDis = insDis; this-&gt;ins = ins;}\n    string get_insDis() { return insDis;}\n  INS get_ins() { return ins;}\n};\n\n// Stack for the Insr structure\nstatic std::unordered_map&lt;ADDRINT, Insr*&gt; insstack;\n\n// This function is called before every instruction is executed\nVOID protect(uint64_t addr)\n{\n  if (addr &gt; 0x700000000000)\n        return;\n    if (!key)\n        return;\n  // Initialize the diassembled instruction\n  string insdis = insstack[addr]-&gt;get_insDis();\n  INS ins = insstack[addr]-&gt;get_ins();\n    if (INS_OperandCount(ins) &gt; 0)\n    {\n        if (REG(INS_OperandReg(ins, 0)) == REG_AH)\n            std::cout &lt;&lt; &quot;register: &quot; &lt;&lt; REG_StringShort(REG(INS_OperandReg(ins, 0))) &lt;&lt; '\\n';\n    }\n\n  if((INS_Opcode(ins) == XED_ICLASS_ADD || INS_Opcode(ins) == XED_ICLASS_SUB) &amp;&amp;\n   INS_OperandIsImmediate(ins, 1))\n    {\n      int value = INS_OperandImmediate(ins, 1);\n        std::cout &lt;&lt; &quot;value: &quot; &lt;&lt; dec&lt;&lt;value &lt;&lt; '\\n';\n    }\n  std::cout &lt;&lt; hex &lt;&lt;addr &lt;&lt; &quot;\\t&quot; &lt;&lt; insdis &lt;&lt; std::endl;\n}\n\n// Pin calls this function every time a new instruction is encountered\nVOID Instruction(INS ins, VOID *v)\n{\n        if (INS_Address(ins) &gt; 0x700000000000)\n        return;\n\n    insstack.insert(std::make_pair(INS_Address(ins), new Insr(string(INS_Disassemble(ins)),\n    ins)));\n    // if (REG_valid_for_iarg_reg_value(INS_MemoryIndexReg(ins)))\n    //   std::cout &lt;&lt; &quot;true&quot; &lt;&lt; '\\n';\n    // Insert a call to docount before every instruction, no arguments are passed\n    INS_InsertCall(ins, IPOINT_BEFORE, (AFUNPTR)protect, IARG_ADDRINT, INS_Address(ins),\n  IARG_END);\n}\n\n// Lock Routine\nvoid mutex_lock()\n{\nkey = 0;\nstd::cout&lt;&lt;&quot;out\\n&quot;;\n}\nvoid mutex_unlock()\n{\n    key = 1;\n    std::cout&lt;&lt;&quot;in\\n&quot;;\n}\n\nvoid Routine(RTN rtn, VOID *V)\n{\n    if (RTN_Name(rtn) == &quot;main&quot;)\n    {\n        RTN_Open(rtn);\n        RTN_InsertCall(rtn, IPOINT_BEFORE, (AFUNPTR)mutex_unlock, IARG_END);\n        RTN_InsertCall(rtn, IPOINT_AFTER, (AFUNPTR)mutex_lock, IARG_END);\n        RTN_Close(rtn);\n    }\n}\n\nINT32 Usage()\n{\n    cerr &lt;&lt; &quot;This tool counts the number of dynamic instructions executed&quot; &lt;&lt; endl;\n    cerr &lt;&lt; endl &lt;&lt; KNOB_BASE::StringKnobSummary() &lt;&lt; endl;\n    return -1;\n}\n\nint main(int argc, char * argv[])\n{\n    // Initialize the symbol table\n    PIN_InitSymbols();\n\n    // Initialize pin\n    if (PIN_Init(argc, argv)) return Usage();\n\n    PIN_SetSyntaxIntel();\n\n    // Routine instrumentation\n    RTN_AddInstrumentFunction(Routine, 0);\n\n    // Register Instruction to be called to instrument instructions\n    INS_AddInstrumentFunction(Instruction, 0);\n\n    // Start the program, never returns\n    PIN_StartProgram();\n\n    return 0;\n}\n</code></pre>\n<p>I have few questions regarding that.</p>\n<p>How can I understand such a behavior? And how can I detect rsp if I want to? Lastly, how does the instruction prints <code>rsp</code>, but <code>REG(INS_OperandReg(ins, 0)) == REG_STACK_PTR</code> can not detect it?</p>\n"}, {"tags": ["c++", "visual-studio-code", "arduino", "arduino-uno"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1553706169, "post_id": 55382556, "comment_id": 97487535, "body": "So if you locate where they&#39;re defined - and put the #include to that file at the top - does it fix things?"}, {"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1553707112, "post_id": 55382556, "comment_id": 97488049, "body": "It does not. I do have the #include in the source of where they are defined. Technically, the avr library prefers that you use avr/io.h and then #define the chip (which I have done). That include the correct header file."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553707266, "post_id": 55382556, "comment_id": 97488116, "body": "Arduino is weird. It&#39;s some hand-holdy &quot;version&quot; of C++ that tries to manage the dependencies for you in a &quot;sketch&quot;. I&#39;ve never used the visual studio extensions. But can you make sure your proper board is selected? And make sure to #include &lt;Arduino.h&gt; at the top?"}, {"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1553707470, "post_id": 55382556, "comment_id": 97488215, "body": "Yes, Arduino.h is defined at the top and the Uno board is selected"}, {"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1553710198, "post_id": 55382556, "comment_id": 97489702, "body": "Also, I should note that I tested this in the Arduino IDE and the build also failed"}, {"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1553711355, "post_id": 55382556, "comment_id": 97490334, "body": "Ok, so here is another data point, when I change the reference from timer 3 to timer 1, the project builds. What gives?"}], "answers": [{"tags": [], "owner": {"reputation": 3239, "user_id": 5271927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTJYf.jpg?s=128&g=1", "display_name": "KIIV", "link": "https://stackoverflow.com/users/5271927/kiiv"}, "is_accepted": true, "score": 1, "last_activity_date": 1553766147, "creation_date": 1553766147, "answer_id": 55394406, "question_id": 55382556, "link": "https://stackoverflow.com/questions/55382556/can-not-compile-arduino-code-with-atmel-registers/55394406#55394406", "title": "Can not compile Arduino code with Atmel registers", "body": "<p>The main issue is that the Arduino UNO doesn't have <code>Timer/Counter 3</code> as it uses <code>ATMega328A</code>. The <code>T/C 3</code> is available for example on Adruino Micro/Leonardo (based on <code>ATMega32U4</code>) and Arduino MEGA 2560 (<code>ATMega2560</code>).</p>\n\n<p>And different MCUs also might have different register names. That's why the Arduino Core is full of <code>#ifdefs</code></p>\n\n<p>Also you might be getting those error because of wrong target MCU.</p>\n\n<p>At least it usually perfectly corresponds with register names used in MCUs datasheet. It's also the first place you should study when you are trying to configure something on your own.</p>\n"}], "owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 55394406, "answer_count": 1, "score": 2, "last_activity_date": 1553766147, "creation_date": 1553705439, "last_edit_date": 1553711606, "question_id": 55382556, "link": "https://stackoverflow.com/questions/55382556/can-not-compile-arduino-code-with-atmel-registers", "title": "Can not compile Arduino code with Atmel registers", "body": "<p>I am using the VSCode editor with the Arudino extension installed. Basically, I have a simple program where I calling a function that will setup a timer for 5 ms and then run. However, in the editor, I am getting the error: </p>\n\n<p>\"error: 'OCR3A' was not declared in this scope\"</p>\n\n<p>Any thoughts on how to fix it? </p>\n\n<p>I should note that intellisense can see the definitions for the registers. I am also using the Arduino Uno R3 board. Also, here is the code:</p>\n\n<pre><code>void isr_int1(void) {\n    if(TCCR3B == 0)// Debug code if the timer is not running\n    {\n        startTimerValue = millis();\n\n        TCNT3 = 0;\n        OCR3A = 5000;\n        sei();\n\n        bitSet(TCCR3B, WGM32);\n        bitSet(TCCR3B, CS31);\n        bitSet(TIMSK3, OCIE3A);\n\n        detachInterrupt(1);\n    }\n}\n\nISR(TIMER3_COMPA_vect)\n{\n    TCCR3A = 0;\n    TCCR3B = 0\n    TCNT3 = 0;\n    OCR3A = 0;\n\n    lcd.setCursor(0,0);\n    lcd.print(millis() - startTimerValue);\n\n    attachInterrupt(1, isr_int1, FALLING);\n}\n\nvoid loop()\n{\n    isr_int1();\n}\n</code></pre>\n"}, {"tags": ["c++", "constructor", "constants", "member-initialization"], "comments": [{"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553706834, "post_id": 55382549, "comment_id": 97487910, "body": "Have you considered making the members private, and non-const, and only making accessors? That&#39;s the normal way to enable this kind of functionality."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1180790"}, "reply_to_user": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553707163, "post_id": 55382549, "comment_id": 97488072, "body": "I want to use <code>const</code> as I will be storing those values until program exits (<i>eg</i> for many hours), not because I don&#39;t want them to be edited/visible, so getters/setters is not my goal here."}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553707341, "post_id": 55382549, "comment_id": 97488155, "body": "Duration of the variables will be the duration of the class instance, regardless of them being <code>const</code> or non-<code>const</code>. were you thinking of <code>static</code>?"}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553707872, "post_id": 55382549, "comment_id": 97488417, "body": "Also, have you considered that you may not have C++11 enabled? your code works fine for me when I put <code>Init init(1,2); X x(init); std::cout &lt;&lt; x.A &lt;&lt; &quot; &quot; &lt;&lt; x.B &lt;&lt; std::endl;</code> in my main, the output is <code>2 3</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1180790"}, "reply_to_user": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1553708202, "post_id": 55382549, "comment_id": 97488625, "body": "There will be many instances of this class in my code, so <code>static</code> in not an option. I have <code>std::latest</code> in my code, and it utilizies many C++17 and one C++20 feautures right now, so I do, definitelly, have C++11 enabled. My problem is solved already btw, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1553706548, "post_id": 55382710, "comment_id": 97487747, "body": "I feel like it would be cleaner by using a delegating constructor rather than a friend function?"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 2, "creation_date": 1553706574, "post_id": 55382710, "comment_id": 97487767, "body": "You can also make it a static member <code>make(int, int)</code>, and write <code>X::make(a,b)</code> instead of <code>make_X(a,b)</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1553707323, "post_id": 55382710, "comment_id": 97488141, "body": "@chtz Yep.  I&#39;ve added that.  Thanks."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1553707476, "post_id": 55382710, "comment_id": 97488217, "body": "@Borgleader I feel you&#39;re right.  The more I look at R Sahu&#39;s answer the more I like it."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1553707309, "last_edit_date": 1553707309, "creation_date": 1553705918, "answer_id": 55382710, "question_id": 55382549, "link": "https://stackoverflow.com/questions/55382549/how-to-initialize-multiple-constant-member-variables-that-shares-complex-initial/55382710#55382710", "title": "How to initialize multiple constant member variables that shares complex initialization code?", "body": "<p>You can solve this by using a factory function.  You make the constructor of <code>X</code> private and then use a friend/static function to get objects of <code>X</code>.  Then you can do the complex code in the body of the function and then pass those values to the constructor of X.  That would look something like</p>\n\n<pre><code>class X\n{\npublic:\n    const int A;\n    const int B;\n    friend X make_X(int a, int b)\n    {\n        // do complex stuff\n        return X(complex_result1, complex_result2);\n    }\n    // or\n    static X make(int a, int b)\n    {\n        // do complex stuff\n        return X(complex_result1, complex_result2);\n    }\nprivate:\n    X(const int  A, const int  B) : A(A), B(B) {}\n};\n</code></pre>\n\n<p>and would be used like</p>\n\n<pre><code>X foo = make_x(a, b);\n//or\nX foo = X::make(a, b);\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1180790"}, "edited": false, "score": 0, "creation_date": 1553707573, "post_id": 55382974, "comment_id": 97488271, "body": "This is exactly what I&#39;ve missed, thanks :)  Rationale: While NathanOliver&#39;s answer solves problem too, it adds requirement to use different name to initialize class (<i>ie</i> <code>X::make</code> instead of just <code>X</code>). I&#39;ve marked your answer as solution as it adds no such requirements."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 5, "last_activity_date": 1553707841, "last_edit_date": 1553707841, "creation_date": 1553706729, "answer_id": 55382974, "question_id": 55382549, "link": "https://stackoverflow.com/questions/55382549/how-to-initialize-multiple-constant-member-variables-that-shares-complex-initial/55382974#55382974", "title": "How to initialize multiple constant member variables that shares complex initialization code?", "body": "<p>Using a <a href=\"http://www.stroustrup.com/C++11FAQ.html#delegating-ctor\" rel=\"nofollow noreferrer\">delegating constructor</a> is a good option for such cases.</p>\n\n<pre><code>class X\n{\n   public: // Members\n\n      /// A ^ B + A\n      const int A;\n\n      /// A ^ B + B\n      const int B;\n\n   public:\n\n      X(int a, int b) : X(a, b, func1(a, b)) {}\n\n   private:\n\n      X(int a, int b, int c) : A(func2(a, b, c)), B(func3(a, b, c)) {}\n\n      static int func1(int a, int b) { return std::pow(a,b); }\n      static int func2(int a, int b, int c) { return (a + c); }\n      static int func3(int a, int b, int c) { return (b + c); }\n};\n</code></pre>\n\n<p>The logic/computation in <code>func1</code>, <code>func2</code>, and <code>func3</code> can be as simple or as complex as you need.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1180790"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 55382974, "answer_count": 2, "score": 1, "last_activity_date": 1566373372, "creation_date": 1553705422, "last_edit_date": 1566373372, "question_id": 55382549, "link": "https://stackoverflow.com/questions/55382549/how-to-initialize-multiple-constant-member-variables-that-shares-complex-initial", "title": "How to initialize multiple constant member variables that shares complex initialization code?", "body": "<h3>Introduction</h3>\n\n<p>Let's introduce this simple example:</p>\n\n<pre><code>#include &lt;cmath&gt;\n\nclass X\n{\npublic: // Members\n\n    /// A ^ B + A\n    int A;\n\n    /// A ^ B + B\n    int B;\n\npublic: // Specials\n\n    X(\n        const int &amp; A,\n        const int &amp; B\n    )\n        : A(A)\n        , B(B)\n    {\n        const auto Pow = static_cast&lt;int&gt;(std::pow(A, B));\n\n        this-&gt;A += Pow;\n        this-&gt;B += Pow;\n    }\n};\n</code></pre>\n\n<h3>Trivia</h3>\n\n<ul>\n<li>Introduced class has two member variables: <code>A</code> and <code>B</code>.</li>\n<li>They take value of <code>A ^ B + A</code> and <code>A ^ B + B</code>, respectively.</li>\n<li>Both of them shares common complex initialization code (let's assume <code>std::pow</code> is complex).</li>\n</ul>\n\n<h3>Problem</h3>\n\n<p>I'd like to make both <code>A</code> and <code>B</code> members <code>const</code>.</p>\n\n<h3>Question</h3>\n\n<p>How to do that without repeating complex initialization (<em>ie</em> avoid calling <code>std::pow</code> twice)?</p>\n\n<h3>What I've tried</h3>\n\n<pre><code>#include &lt;cmath&gt;\n\nclass X\n{\npublic: // Members\n\n    /// A ^ B + A\n    const int A;\n\n    /// A ^ B + B\n    const int B;\n\npublic: // Helpers\n\n    struct Init\n    {\n    public: // Members\n\n        int A;\n        int B;\n\n    public: // Specials\n\n        Init(\n            const int &amp; A,\n            const int &amp; B\n        )\n            : A(A)\n            , B(B)\n        {\n            const auto Pow = static_cast&lt;int&gt;(std::pow(A, B));\n\n            this-&gt;A += Pow;\n            this-&gt;B += Pow;\n        }\n    };\n\npublic: // Specials\n\n    X(\n        const Init&amp; Init\n    )\n        : A(Init.A)\n        , B(Init.B)\n    {};\n\n    X(\n        const int &amp; A,\n        const int &amp; B\n    )\n        : X(Init(\n            A,\n            B\n        ))\n    {};\n};\n</code></pre>\n\n<ol>\n<li>Create <code>struct Init</code> that takes role of past version of class <code>X</code>.</li>\n<li>Make <code>X</code> members <code>const</code> while keep <code>Init</code> members non <code>const</code>.</li>\n<li>Use constructor delegation to redirect constructor arguments to <code>Init</code>.</li>\n<li>Move non <code>const</code> member variables from <code>Init</code> to <code>X</code> and make them <code>const</code>.\n\n<ul>\n<li>Note there is no <code>std::move</code> as <code>int</code> is <a href=\"https://en.cppreference.com/w/cpp/named_req/TriviallyCopyable\" rel=\"nofollow noreferrer\"><em>TriviallyCopyable</em></a>.</li>\n</ul></li>\n</ol>\n\n<p>However, my solution seems overcomplicated. Any help would be appreciated.</p>\n\n<h3>No goals</h3>\n\n<ul>\n<li>Make another <code>X</code> member variable that will store common code result (<em>ie</em> <code>std::pow</code>).</li>\n<li>Add another level of indirection outside <code>X</code> class (<em>eg</em> introduce base class for <code>X</code>).</li>\n</ul>\n\n<h3>Note</h3>\n\n<p>Solutions can use newer versions of C++ than C++11.</p>\n"}, {"tags": ["c++", "rounding", "avr", "constexpr"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553707393, "post_id": 55382890, "comment_id": 97488180, "body": "&quot;Rounding floating point values can always be done by simply adding or subtracting 0.5 and then casting back to integer&quot; - No! That&#39;s <i>not</i> correct. There are multiple situations where that will produce the wrong answer. For example; negative numbers, numbers <i>just</i> below <code>0.5</code> and more. <code>std::round</code> (and friends) does it right, adding <code>0.5</code> and then truncating to <code>int</code> does <i>not</i>."}, {"owner": {"reputation": 940, "user_id": 5840652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELL15.png?s=128&g=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/5840652/vinci"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553707569, "post_id": 55382890, "comment_id": 97488269, "body": "Thats true yes. Feel free to add further checks to prevent that. In this case you&#39;re safe though because the baudrate register won&#39;t be 0."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553707611, "post_id": 55382890, "comment_id": 97488288, "body": "@JesperJuhl Technically correct, irrelevant in this concrete scenario. I guess the answer should discuss that/not make such broad claims."}], "tags": [], "owner": {"reputation": 940, "user_id": 5840652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELL15.png?s=128&g=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/5840652/vinci"}, "is_accepted": false, "score": 0, "last_activity_date": 1553707907, "last_edit_date": 1553707907, "creation_date": 1553706437, "answer_id": 55382890, "question_id": 55382543, "link": "https://stackoverflow.com/questions/55382543/is-it-possible-to-write-a-constexpr-rounding-function-for-avr/55382890#55382890", "title": "Is it possible to write a constexpr rounding function for AVR?", "body": "<p>Rounding floating point values can always be done by simply adding or subtracting 0.5 and then casting back to integer. There is no need to invoke anything from std:: namespace.</p>\n\n<pre><code>constexpr int round(double x) {\n  return (x &gt;= 0.0) ? int(x + 0.5) : int(x - 0.5);\n}\n\nconstexpr int UBRRValue(int c, int b) {\n  return round(static_cast&lt;double&gt;(c) / (16 * b) - 1);\n}\n\nint main() {\n  constexpr auto val = UBRRValue(2000, 25);\n  return val;\n}\n</code></pre>\n\n<p>In case you're sure that the functions are always const-evaluated you can safely use doubles instead of floats since they won't end up in flash memory anyway.</p>\n\n<p>/edit\nAs mentioned in the comments the claim that this \"always\" works isn't true. It's sufficient for this situation however as the baudrate register will be neither negative nor 0.</p>\n"}, {"comments": [{"owner": {"reputation": 70803, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 2, "creation_date": 1553708473, "post_id": 55383200, "comment_id": 97488787, "body": "I&#39;d get rid of the <code>- 1</code> and change the plus to a minus.  Also, using regular arguments instead of template parameters seems to work just fine since this thing can be evaluated at compile time anyway.  <a href=\"https://godbolt.org/z/-8Ld9H\" rel=\"nofollow noreferrer\">godbolt.org/z/-8Ld9H</a>"}, {"owner": {"reputation": 43, "user_id": 11221049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d177a0e04a721b0656f1f9fe815efec?s=128&d=identicon&r=PG&f=1", "display_name": "fmiz", "link": "https://stackoverflow.com/users/11221049/fmiz"}, "edited": false, "score": 0, "creation_date": 1553713066, "post_id": 55383200, "comment_id": 97491164, "body": "Unfortunately I can&#39;t use regular arguments, I&#39;ve made a small pile of template functions that use the intermediate results as parameters, this is why I need it it be constexpr. I would need to discard constexpr and templates in all the functions I have. This is the whole thing, it is ugly: <a href=\"https://godbolt.org/z/oJJQr5\" rel=\"nofollow noreferrer\">godbolt.org/z/oJJQr5</a>"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 2, "last_activity_date": 1553708124, "last_edit_date": 1553708124, "creation_date": 1553707480, "answer_id": 55383200, "question_id": 55382543, "link": "https://stackoverflow.com/questions/55382543/is-it-possible-to-write-a-constexpr-rounding-function-for-avr/55383200#55383200", "title": "Is it possible to write a constexpr rounding function for AVR?", "body": "<p>What you are trying to compute is the correctly rounded result of <code>(c / (16 * b)) - 1</code>. You are casting to float to avoid integer division, but this is almost pointless if you're going to round afterwards anyway.</p>\n\n<p>Notice that we can move the <code>-1</code> outside the rounding safely (will only change the result if you were discarding the <code>-1</code> due to lack of float precision, which you don't seem to intend). So all we need is the correctly rounded result of <code>c / (16*b)</code>. If we do this as integer division we get the rounded-down result. We can get a midway-rounded result by just adding half the divisor to the dividend (assuming that both are positive):</p>\n\n<pre><code>template&lt;int c, int b&gt;\nconstexpr int UBRRValue() {\n   // return the value for UBRR register to get close to the desired baud rate\n    return (c + 8*b) / (16 * b) - 1;\n}\n</code></pre>\n\n<p>Here are some test cases it passes: <a href=\"https://godbolt.org/z/Va6qDT\" rel=\"nofollow noreferrer\">https://godbolt.org/z/Va6qDT</a></p>\n"}], "owner": {"reputation": 43, "user_id": 11221049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d177a0e04a721b0656f1f9fe815efec?s=128&d=identicon&r=PG&f=1", "display_name": "fmiz", "link": "https://stackoverflow.com/users/11221049/fmiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "accepted_answer_id": 55383200, "answer_count": 2, "score": 1, "last_activity_date": 1553708124, "creation_date": 1553705391, "question_id": 55382543, "link": "https://stackoverflow.com/questions/55382543/is-it-possible-to-write-a-constexpr-rounding-function-for-avr", "title": "Is it possible to write a constexpr rounding function for AVR?", "body": "<p>I am writing a class to setup a serial port on an AVR microcontroller. I have a template function that takes as parameters a cpu clock value and a desired baud rate, does a quick calculation, verifies if the actual value is within 1.5% margin from the desired value with static asserts, then returns the actual value to set inside an 8 bit register. I need to use std::round and its return value needs to be constexpr to have everything evaluated at compile time. This is the problematic bit:</p>\n\n<pre><code>#include &lt;cmath&gt;\n\ntemplate&lt;int c, int b&gt;\nconstexpr int UBRRValue() {\n   // return the value for UBRR register to get close to the desired baud rate\n   // avoid integer division\n    return std::round( static_cast&lt;float&gt;(c) / ( 16 * b ) - 1 );\n}\n\nint main() {\n    constexpr auto val = UBRRValue&lt;2000,25&gt;();\n    return val;\n}\n</code></pre>\n\n<p>This works fine for x86 on compiler explorer, it returns 4.\nOn AVR there is no cmath, float round(float) is defined in math.h and implemented in assembly, so probably not constexpr. After a quick search I found this: <a href=\"https://stackoverflow.com/a/24348037/11221049\">https://stackoverflow.com/a/24348037/11221049</a>\nI made a few adjustments, to then have gcc point out that this function is non-constexpr. I made it constexpr, but then its result will never be constexpr because it requires access to a union member that has not been initialized. Union tricks are not constexpr.\nSo... is it possible to make a constexpr round function (knowing that anything from math.h is written directly in assembly)?\nHow is it done in gnu libc++?</p>\n"}, {"tags": ["c++", "qt", "qtreewidget"], "comments": [{"owner": {"reputation": 1380, "user_id": 1809260, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/5T88E.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/1809260/simon"}, "edited": false, "score": 0, "creation_date": 1553705481, "post_id": 55382523, "comment_id": 97487192, "body": "Do you want to expend the last column? something like this <code>tw-&gt;horizontalHeader()-&gt;setStretchLastSection(true);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "is_accepted": true, "score": 0, "last_activity_date": 1553706405, "creation_date": 1553706405, "answer_id": 55382880, "question_id": 55382523, "link": "https://stackoverflow.com/questions/55382523/how-to-keep-the-size-of-second-column-of-a-qtreewidget-with-more-than-2-columns/55382880#55382880", "title": "How to keep the size of second column of a QtreeWidget (with more than 2 columns) dynamic?", "body": "<p>Using <code>header()</code>funtion of <code>QTreeWidget</code>, you can get the <code>QHeaderView</code> object.</p>\n\n<p>In the document link(<a href=\"https://doc.qt.io/qt-5/qtreeview.html#sizeHintForColumn\" rel=\"nofollow noreferrer\">https://doc.qt.io/qt-5/qtreeview.html#sizeHintForColumn</a>),  you notice that</p>\n\n<blockquote>\n  <p>If you need to set the width of a given column to a fixed value, call\n  QHeaderView::resizeSection() on the view's header.</p>\n</blockquote>\n\n<pre><code>void QHeaderView::resizeSection(int logicalIndex, int size)\n</code></pre>\n\n<p>So the rough code could be:</p>\n\n<pre><code>QHeaderView* headerView = treeWidget-&gt;header();\nheaderView-&gt;resizeSection(COLUMN_INDEX, FIXEDSIZE); //Calculate the required size and do this for required columns.\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11123038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665035837620acc15cf822671768ae0d?s=128&d=identicon&r=PG&f=1", "display_name": "annie5", "link": "https://stackoverflow.com/users/11123038/annie5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 55382880, "answer_count": 1, "score": 1, "last_activity_date": 1553706405, "creation_date": 1553705300, "question_id": 55382523, "link": "https://stackoverflow.com/questions/55382523/how-to-keep-the-size-of-second-column-of-a-qtreewidget-with-more-than-2-columns", "title": "How to keep the size of second column of a QtreeWidget (with more than 2 columns) dynamic?", "body": "<p>I have a mainwindow with Qtreewidget(having 3 columns) as central widget. I want to keep the size of first and second column fixed, but the size of second column should be equal to the size of qtreewidget minus the size of other two columns. Since the size of mainwindow (also, treewidget) can be changed, how to keep the second column size changing as well?</p>\n"}, {"tags": ["c++", "xcode", "macos"], "comments": [{"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 0, "creation_date": 1553704571, "post_id": 55382235, "comment_id": 97486656, "body": "is your CustomerData class defined and included in the project?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553704653, "post_id": 55382235, "comment_id": 97486698, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18408531/xcode-build-failure-undefined-symbols-for-architecture-x86-64\">Xcode build failure &quot;Undefined symbols for architecture x86_64&quot;</a>"}, {"owner": {"reputation": 1, "user_id": 11267614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/542fa2646e1ffc5eb8f86956b7567bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Colby W", "link": "https://stackoverflow.com/users/11267614/colby-w"}, "edited": false, "score": 0, "creation_date": 1553704682, "post_id": 55382235, "comment_id": 97486709, "body": "Yes, I have that along with a PersonData class and a PreferredCustomer class."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553706832, "post_id": 55382235, "comment_id": 97487905, "body": "Error message says &quot;use -v to see invocation&quot; and I agree. Please <i>do</i> that and put the result in your question as extra details."}, {"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553706972, "post_id": 55382235, "comment_id": 97487974, "body": "The linker isn&#39;t finding a <i>definition</i> for the constructor <code>CustomerData::CustomerData()</code>, but the compiler did find a <i>delcaration</i> for it (otherwise that would be your error). The most likely cause is that you haven&#39;t properly added a file to your project that contains definitions for the <code>CustomerData</code> class (or, if you have, that class is missing a definition for this particular constructor)."}, {"owner": {"reputation": 1158, "user_id": 4956078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44600007f35ab98b7badbf1110df0687?s=128&d=identicon&r=PG&f=1", "display_name": "JMAA", "link": "https://stackoverflow.com/users/4956078/jmaa"}, "edited": false, "score": 0, "creation_date": 1553707114, "post_id": 55382235, "comment_id": 97488051, "body": "In general, you&#39;d do yourself a huge favour to read up on exactly how you go from source code files to a complete compiled binary with C++. This knowledge is pretty essential for understanding errors like this one."}, {"owner": {"reputation": 1, "user_id": 11267614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/542fa2646e1ffc5eb8f86956b7567bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Colby W", "link": "https://stackoverflow.com/users/11267614/colby-w"}, "edited": false, "score": 0, "creation_date": 1553807381, "post_id": 55382235, "comment_id": 97534312, "body": "I had a problem with the default constructors. After fixing that problem it compiled fine. Thanks for the help."}], "owner": {"reputation": 1, "user_id": 11267614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/542fa2646e1ffc5eb8f86956b7567bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Colby W", "link": "https://stackoverflow.com/users/11267614/colby-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553704832, "creation_date": 1553704401, "last_edit_date": 1553704832, "question_id": 55382235, "link": "https://stackoverflow.com/questions/55382235/c-on-mac-linker-command-failed-with-exit-code-1-use-v-to-see-invocation", "title": "C++ on Mac: linker command failed with exit code 1 (use -v to see invocation)", "body": "<p>I get this error message when trying to build my program</p>\n\n<p>Undefined symbols for architecture x86_64:\n  \"CustomerData::CustomerData()\", referenced from:\n      PreferredCustomer::PreferredCustomer() in main.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)</p>\n\n<p>How do i fix this error? I am running c++ on xcode. </p>\n"}, {"tags": ["c++", "c++14", "variadic-templates"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553704532, "post_id": 55381966, "comment_id": 97486627, "body": "How do you want to handle (as in, forbid) temporaries for this? Note that if any of <code>args</code> is a temporary then you have no way of keeping it alive (because unlike <i>local</i> <code>const T&amp;</code>, <i>class member</i> <code>const T&amp;</code> do not provide lifetime extension, see <a href=\"https://stackoverflow.com/questions/2784262/does-a-const-reference-class-member-prolong-the-life-of-a-temporary\" title=\"does a const reference class member prolong the life of a temporary\">stackoverflow.com/questions/2784262/&hellip;</a>). I mean, you can require everything to be copyable (and/or moveable) but doing so won&#39;t (and cannot) preserve the full semantics of <code>make_unique</code>."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1553704903, "post_id": 55381966, "comment_id": 97486854, "body": "Also note that <code>Args &amp;&amp;... args</code> only works as forwarding reference when <i>the function itself</i> is templated on <code>...Args</code>. You&#39;ve already lost perfect forwarding in your constructor&#39;s signature."}, {"owner": {"reputation": 205, "user_id": 6208613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2aae9b18c813001cf4c913f732bf2bc?s=128&d=identicon&r=PG", "display_name": "Lazward", "link": "https://stackoverflow.com/users/6208613/lazward"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553704932, "post_id": 55381966, "comment_id": 97486878, "body": "I&#39;m unsure std::bind is the proper way to go. I would like the class to store a copy and not a reference of the parameters for later make_unique invocation."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553705053, "post_id": 55381966, "comment_id": 97486954, "body": "The point of using <code>make_unique</code> is the perfect forwarding that it provides (see my forwarding reference comment for why it is a separate function). If you don&#39;t care about that, there&#39;s no need to use <code>make_unique</code>, just create a <code>std::unique_ptr</code> directly."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1553705190, "post_id": 55381966, "comment_id": 97487022, "body": "<code>make_unique</code> function template has been added only in C++14 so this can&#39;t be achieved in C++11. You will probably need to write your own <code>make_unique</code> substitution."}, {"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553708152, "post_id": 55381966, "comment_id": 97488591, "body": "@MaxLanghof As an aside, you probably want"}], "answers": [{"comments": [{"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1553704741, "post_id": 55382317, "comment_id": 97486751, "body": "You can capture the arguments by value, but of course that might change their types, and obviously changes the perfect forwarding behaviour."}], "tags": [], "owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "is_accepted": false, "score": -1, "last_activity_date": 1553706966, "last_edit_date": 1553706966, "creation_date": 1553704639, "answer_id": 55382317, "question_id": 55381966, "link": "https://stackoverflow.com/questions/55381966/deferred-make-unique-with-variadic-templates/55382317#55382317", "title": "Deferred make_unique with variadic templates", "body": "<p>You can use a lambda but it is <strong>undefined behavior</strong> as you are saving a reference to temporary</p>\n\n<pre><code>    factory = [&amp;]() {\n        return std::make_unique&lt;T&gt;(std::forward&lt;Args&gt;(args)...);\n    };\n</code></pre>\n\n<hr>\n\n<p>For saving the arguments but also preserve original types they were called with, it is more complicated and involves a lot of casts/variadic template magic. I didn't figure out yet but don't see why it is not possible. </p>\n\n<pre><code>template&lt;class... Args&gt;\nConstructLater(Args &amp;&amp;... args)\n{\n  std::tuple&lt;TODO...&gt; tup = remove_const_remove_ref&lt;Args...&gt;(args);\n  factory = [=]() {\n      return std::make_unique&lt;T&gt;(cast_tuple&lt;Args...&gt;(tup)...);\n  };\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553706123, "post_id": 55382759, "comment_id": 97487510, "body": "Ok this is a better solution than mine. I didn&#39;t catch the intended use with <code>std::function</code> in there."}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 1, "creation_date": 1553707827, "post_id": 55382759, "comment_id": 97488391, "body": "This is not preserving the original types passed to the constructor. <code>make_unique</code> is always called with lvalue reference. So the whole thing is useless and the constructor can be changed to take copies instead and captured in the lambda using <code>[=]</code>. ref: <a href=\"https://gcc.godbolt.org/z/xuW7Am\" rel=\"nofollow noreferrer\">gcc.godbolt.org/z/xuW7Am</a>"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1553737338, "post_id": 55382759, "comment_id": 97499581, "body": "@balki There, uselessness fixed."}], "tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": true, "score": 0, "last_activity_date": 1553737282, "last_edit_date": 1553737282, "creation_date": 1553706020, "answer_id": 55382759, "question_id": 55381966, "link": "https://stackoverflow.com/questions/55381966/deferred-make-unique-with-variadic-templates/55382759#55382759", "title": "Deferred make_unique with variadic templates", "body": "<p>This is the signature of <code>std::make_unique</code> </p>\n\n<pre><code>template&lt;typename T, typename... Args&gt;\nstd::unique_ptr&lt;T&gt; make_unique(Args&amp;&amp;...);\n</code></pre>\n\n<p>When you specified <code>Args</code> like you did, <code>std::make_unique</code> may only accept rvalues. However, <code>std::bind</code> passes its bound arguments as lvalues, which is why you get an error.</p>\n\n<p>Instead of <code>std::bind</code>, use lambdas instead</p>\n\n<pre><code>template&lt;typename...&gt;\nstruct pack {};\n\ntemplate&lt;typename T, typename Tup, typename... TArgs, std::size_t... Is&gt;\nstd::unique_ptr&lt;T&gt; helper(Tup&amp;&amp; tup, pack&lt;TArgs...&gt;, std::index_sequence&lt;Is...&gt;)\n{\n    return std::make_unique&lt;T&gt;(static_cast&lt;TArgs&gt;(std::get&lt;Is&gt;(tup))...);\n}\n\ntemplate &lt;typename T&gt;\nclass ConstructLater\n{\npublic:\n    template&lt;typename... Args&gt;\n    ConstructLater(Args&amp;&amp;... args)\n        : factory{[tup = std::make_tuple(std::forward&lt;Args&gt;(args)...)]() mutable {\n            return helper&lt;T&gt;(std::move(tup), pack&lt;Args&amp;&amp;...&gt;{}, std::index_sequence_for&lt;Args...&gt;{});\n        }}\n    {\n    }\n\n    std::unique_ptr&lt;T&gt; Later()\n    {\n         return factory();\n    }\n\nprivate:\n    std::function&lt;std::unique_ptr&lt;T&gt;(void)&gt; factory;\n};\n</code></pre>\n\n<p>Note also <code>ConstructLater</code> shouldn't be templated by <code>Args</code>, it defeats the entire purpose of <code>std::function</code>. Either way, the constructor itself will need to be templated in order to perfectly forward its arguments.</p>\n"}, {"tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1553706050, "creation_date": 1553706050, "answer_id": 55382767, "question_id": 55381966, "link": "https://stackoverflow.com/questions/55381966/deferred-make-unique-with-variadic-templates/55382767#55382767", "title": "Deferred make_unique with variadic templates", "body": "<p>If you're ok with every argument being copied, then you can skip <code>std::bind</code> and <code>std::make_unique</code>:</p>\n\n<pre><code>template &lt;typename T, typename ... Args&gt;\nclass ConstructLater\n{\npublic:\n    ConstructLater(Args... args) : _storedArgs(args...)\n    {\n    }\n\n    std::unique_ptr&lt;T&gt; later()\n    {\n        return laterHelper(std::make_index_sequence&lt;sizeof...(Args)&gt;{});\n    }\n\nprivate:\n    template&lt;std::size_t... I&gt;\n    std::unique_ptr&lt;T&gt; laterHelper(std::index_sequence&lt;I...&gt;)\n    {\n        return std::unique_ptr&lt;T&gt;(new T(std::get&lt;I&gt;(_storedArgs)...));\n    }\n\n    std::tuple&lt;Args...&gt; _storedArgs;\n};\n\nclass Foo { public: Foo(int) { } };\n\nint f()\n{\n    ConstructLater&lt;Foo, int&gt; cl(6);\n\n    auto foo = cl.later();\n}\n</code></pre>\n\n<p>This compiles just fine in C++14: <a href=\"https://godbolt.org/z/owgoXc\" rel=\"nofollow noreferrer\">https://godbolt.org/z/owgoXc</a></p>\n"}], "owner": {"reputation": 205, "user_id": 6208613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2aae9b18c813001cf4c913f732bf2bc?s=128&d=identicon&r=PG", "display_name": "Lazward", "link": "https://stackoverflow.com/users/6208613/lazward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 55382759, "answer_count": 3, "score": 2, "last_activity_date": 1553737282, "creation_date": 1553703533, "last_edit_date": 1553705341, "question_id": 55381966, "link": "https://stackoverflow.com/questions/55381966/deferred-make-unique-with-variadic-templates", "title": "Deferred make_unique with variadic templates", "body": "<p>I need a class which will work as a deferred factory, saving the parameters to create another class and invoking make_unique later in time. So far I'm not having any luck getting a variadic template version to work. Any help would be appreciated (minimal non-working version below).</p>\n\n<pre><code>template &lt;typename T, typename ... Args&gt;\nclass ConstructLater\n{\npublic:\n    ConstructLater(Args &amp;&amp;... args)\n    {\n        factory = std::bind(std::make_unique&lt;T, Args...&gt;, std::forward&lt;Args&gt;(args)...);\n    }\n\n    std::unique_ptr&lt;T&gt; Later()\n    {\n         return factory();\n    }\n\nprivate:\n    std::function&lt;std::unique_ptr&lt;T&gt;(void)&gt; factory;\n};\n\nclass Foo { public: Foo(int) { } };\n\nint f()\n{\n    // None of these work\n    ConstructLater&lt;Foo&gt;(3);\n    ConstructLater&lt;Foo, int&gt;(6);\n}\n</code></pre>\n\n<p>EDIT: To clarify, I do not need to use std::bind, and in fact I would like the class to store a copy of the arguments by value to avoid problems with temporary objects. Also updated label to C++14.</p>\n"}, {"tags": ["c++", "optimization"], "comments": [{"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 1, "creation_date": 1553703272, "post_id": 55381808, "comment_id": 97485870, "body": "What&#39;s wrong about <a href=\"https://en.cppreference.com/w/cpp/numeric/complex/sqrt\" rel=\"nofollow noreferrer\">std::sqrt(std::complex&lt;&gt;)</a>?"}, {"owner": {"reputation": 682, "user_id": 5436259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84f0035c8c02b5ca04d3675ff63f3937?s=128&d=identicon&r=PG&f=1", "display_name": "infinitezero", "link": "https://stackoverflow.com/users/5436259/infinitezero"}, "reply_to_user": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 0, "creation_date": 1553703355, "post_id": 55381808, "comment_id": 97485922, "body": "I didn&#39;t know that existed. I&#39;ve actually written my own ComplexNumber Class and now wanted to implement this feature."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553703592, "post_id": 55381808, "comment_id": 97486063, "body": "you didnt know about <code>std::sqrt</code> or about <code>std::complex</code> ? ;)"}, {"owner": {"reputation": 682, "user_id": 5436259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84f0035c8c02b5ca04d3675ff63f3937?s=128&d=identicon&r=PG&f=1", "display_name": "infinitezero", "link": "https://stackoverflow.com/users/5436259/infinitezero"}, "edited": false, "score": 0, "creation_date": 1553705022, "post_id": 55381808, "comment_id": 97486934, "body": "I didn&#39;t expect complex numbers to be available in the standard libarary, so I didn&#39;t know about neither."}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 5436259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84f0035c8c02b5ca04d3675ff63f3937?s=128&d=identicon&r=PG&f=1", "display_name": "infinitezero", "link": "https://stackoverflow.com/users/5436259/infinitezero"}, "edited": false, "score": 0, "creation_date": 1553704995, "post_id": 55382011, "comment_id": 97486919, "body": "Ah yes, this is actually straightforward. Thank you."}], "tags": [], "owner": {"reputation": 134, "user_id": 11209337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LQgOlyFPQrA/AAAAAAAAAAI/AAAAAAAAAAk/5mSg0xIU2Ek/photo.jpg?sz=128", "display_name": "CodeoftheWarrior", "link": "https://stackoverflow.com/users/11209337/codeofthewarrior"}, "is_accepted": true, "score": 2, "last_activity_date": 1553703677, "creation_date": 1553703677, "answer_id": 55382011, "question_id": 55381808, "link": "https://stackoverflow.com/questions/55381808/fastest-way-to-find-complex-roots/55382011#55382011", "title": "Fastest way to find complex roots", "body": "<p>Yes there is! I'm going to link a good explanation of the process here, but it looks like this can be accomplished by only calculating the magnitude of the original number and subtracting out the real portion of the original number and finally taking the square root of that to find the imaginary part of the square root. The real part can be found by dividing the imaginary part of the original number by 2 * the imaginary part of the root to get your final answer.\n<a href=\"https://www.qc.edu.hk/math/Advanced%20Level/Finding%20the%20square%20root%20of%20a%20complex%20number.htm\" rel=\"nofollow noreferrer\">https://www.qc.edu.hk/math/Advanced%20Level/Finding%20the%20square%20root%20of%20a%20complex%20number.htm</a>\nLet me know if you need more help with the code but this requires no trig functions.</p>\n"}], "owner": {"reputation": 682, "user_id": 5436259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84f0035c8c02b5ca04d3675ff63f3937?s=128&d=identicon&r=PG&f=1", "display_name": "infinitezero", "link": "https://stackoverflow.com/users/5436259/infinitezero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55382011, "answer_count": 1, "score": 0, "last_activity_date": 1553703677, "creation_date": 1553703010, "question_id": 55381808, "link": "https://stackoverflow.com/questions/55381808/fastest-way-to-find-complex-roots", "title": "Fastest way to find complex roots", "body": "<p>Using <code>a + i b = sqrt(a*a + b*b) * exp(i arctan2(a,b))</code> I arrive at the following way to compute complex roots. However, I heard that trigonometric functions rather use up performance so I wonder if there is a better way in vanilla c++ (no external libaries).</p>\n\n<p>Example: Let <code>u+iv = sqrt(a+i b)</code></p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;iostream&gt;\n\nint main(){\n    double a = -1.;\n    double b = 0;    \n\n    double r = sqrt(sqrt(a*a+b*b));\n    double phi = 0.5 * atan2(b, a);\n    double u = r * cos(phi);\n    double v = r * sin(phi);\n\n    std::cout &lt;&lt; u &lt;&lt; std::endl;\n    std::cout &lt;&lt; v &lt;&lt; \"i\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>This is just meant as a MWE, so it's not written in a class or method.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1553703190, "post_id": 55381797, "comment_id": 97485818, "body": "Yes.  This is how RAII types work.  It would be pointless to have <code>unique_ptr</code> if you still had to manually do something."}, {"owner": {"reputation": 494, "user_id": 1383880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258c2172c30ab4b732d6fb83ffb2c586?s=128&d=identicon&r=PG", "display_name": "CannedMoose", "link": "https://stackoverflow.com/users/1383880/cannedmoose"}, "edited": false, "score": 1, "creation_date": 1553703238, "post_id": 55381797, "comment_id": 97485848, "body": "Also see <a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/memory/unique_ptr</a>"}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 1, "creation_date": 1553703426, "post_id": 55381797, "comment_id": 97485972, "body": "destructor in <code>ResourceManager</code> is not necessary. map&#39;s destructor is called by default which clears it."}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 4, "creation_date": 1553703998, "post_id": 55381797, "comment_id": 97486310, "body": "As others already stated, yes. But you should definitely become familiar with <a href=\"https://en.wikipedia.org/wiki/Resource_acquisition_is_initialization\" rel=\"nofollow noreferrer\">RAII</a>, as this plays an extremely important role here (and everywhere else in C++, in particular when it comes to exception safety)."}], "answers": [{"tags": [], "owner": {"reputation": 661, "user_id": 10813159, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BXhwfYsmsLU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hIK7rxjqqyrdnqOUavqE7ZftIyWA/mo/photo.jpg?sz=128", "display_name": "Inon Peled", "link": "https://stackoverflow.com/users/10813159/inon-peled"}, "is_accepted": false, "score": 3, "last_activity_date": 1553703184, "creation_date": 1553703184, "answer_id": 55381856, "question_id": 55381797, "link": "https://stackoverflow.com/questions/55381797/does-unique-ptr-get-unallocated-when-the-object-containing-it-gets-its-destructo/55381856#55381856", "title": "Does unique_ptr get unallocated when the object containing it gets its destructor called?", "body": "<p>The unique_ptr member of each <code>Resource()</code> instance will be destroyed properly without you adding any extra code. </p>\n\n<p>For this reason too, you do not need to explicitly call <code>clear()</code>, as this will happen automatically when the instance of <code>ResourceManager</code> is destroyed.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553718723, "post_id": 55381890, "comment_id": 97493784, "body": "Nobody is creating <code>unique_ptr</code>s on the heap here. What are you talking about?"}, {"owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1553764155, "post_id": 55381890, "comment_id": 97507907, "body": "@JesperJuhl That&#39;s what I&#39;m saying. There is no point. And if it is defined normally it will be destructed when it gets out of scope as well as the object allocated with the <code>unique_ptr</code>"}], "tags": [], "owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "is_accepted": false, "score": 1, "last_activity_date": 1553763988, "last_edit_date": 1553763988, "creation_date": 1553703303, "answer_id": 55381890, "question_id": 55381797, "link": "https://stackoverflow.com/questions/55381797/does-unique-ptr-get-unallocated-when-the-object-containing-it-gets-its-destructo/55381890#55381890", "title": "Does unique_ptr get unallocated when the object containing it gets its destructor called?", "body": "<p>There is not point to create an <code>std::unique_ptr</code> on the heap (<em>new std::unique_ptr</em>).</p>\n\n<p>It acts the same as a simple <code>int</code>. It will be removed when it gets out of scope.\nWith the removing of the <code>std::unique_ptr</code> the destructor of the object in the <code>unique_ptr</code> will be called</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 6, "last_activity_date": 1553704373, "last_edit_date": 1553704373, "creation_date": 1553703696, "answer_id": 55382018, "question_id": 55381797, "link": "https://stackoverflow.com/questions/55381797/does-unique-ptr-get-unallocated-when-the-object-containing-it-gets-its-destructo/55382018#55382018", "title": "Does unique_ptr get unallocated when the object containing it gets its destructor called?", "body": "<blockquote>\n  <p>Does unique_ptr get unallocated when the object containing it gets its destructor called?</p>\n</blockquote>\n\n<p>In short; Yes.</p>\n\n<p><code>resources.clear();</code> in the destructor is redundant. The <code>unordered_map</code> will be cleared automatically when it is destroyed (when <code>ResourceManager</code> is destroyed) and this will automatically destroy all the <code>unique_ptr</code>s which will in turn deallocate their resources. You don't need to do <em>anything</em>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11244708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 55382018, "answer_count": 3, "score": 2, "last_activity_date": 1553763988, "creation_date": 1553702977, "last_edit_date": 1553703053, "question_id": 55381797, "link": "https://stackoverflow.com/questions/55381797/does-unique-ptr-get-unallocated-when-the-object-containing-it-gets-its-destructo", "title": "Does unique_ptr get unallocated when the object containing it gets its destructor called?", "body": "<p>Suppose I have these classes.</p>\n\n<p>Resource.h</p>\n\n<pre><code>template&lt;typename T&gt;\nclass Resource\n{\n      protected:\n              // bunch of member variable\n              std::unique_ptr&lt;T&gt; resource;\n      public: \n              Resource();\n              ~Resource();\n };\n</code></pre>\n\n<p>ResourceManager.h</p>\n\n<pre><code>template&lt;typename T&gt;\nclass ResourceManager\n{\n    protected:\n        std::unordered_map&lt;std::string, Resource&lt;T&gt;&gt; resources;\n    public:\n        ResourceManager();\n        ~ResourceManager()\n        {\n               resources.clear();\n        }\n };\n</code></pre>\n\n<p><code>resources.clear()</code> removes all the elements from the map, and calls the objects' destructors. My question is, do the unique_ptr get unallocated on their own, or if not, do we have to do something to unallocate them?</p>\n"}, {"tags": ["c++", "recursion"], "comments": [{"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1553702622, "post_id": 55381624, "comment_id": 97485442, "body": "From your snippet, it seems you misinterpreted the question. Do user input in separate loop (without recursion)."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1553702756, "post_id": 55381624, "comment_id": 97485543, "body": "@seccpur I don\u2019t think you\u2019re right."}, {"owner": {"reputation": 703, "user_id": 9753452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Michael Surette", "link": "https://stackoverflow.com/users/9753452/michael-surette"}, "edited": false, "score": 0, "creation_date": 1553702808, "post_id": 55381624, "comment_id": 97485579, "body": "This may be helpful <a href=\"https://stackoverflow.com/questions/55043688/trying-to-reverse-a-string-in-c-but-getting-the-same-string-back/55044586#55044586\" title=\"trying to reverse a string in c but getting the same string back\">stackoverflow.com/questions/55043688/&hellip;</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1553703146, "post_id": 55381624, "comment_id": 97485797, "body": "You&#39;re supposed to return a <i>string</i> not one character. If you have a <code>std::string</code>, how do you append a character to that string? What would happen if you, for example, did something like <code>funct() + some_character</code> (assuming that <code>funct</code> returns a <code>std::string</code>)?"}], "answers": [{"tags": [], "owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "is_accepted": true, "score": 4, "last_activity_date": 1553703542, "creation_date": 1553703542, "answer_id": 55381972, "question_id": 55381624, "link": "https://stackoverflow.com/questions/55381624/a-recursive-function-that-retrieves-characters-and-returns-in-reverse-order-c/55381972#55381972", "title": "A recursive function that retrieves characters and returns in reverse order c++", "body": "<p>There are two stumbling blocks in what you\u2019ve shown us:</p>\n\n<ol>\n<li>Your function takes an argument; why? Nothing in the problem description suggests doing so.</li>\n<li>Your function returns <code>char</code> rather than <code>std::string</code> (as requested).</li>\n</ol>\n\n<p>If you adapt these two points you end up with the following function signature<sup>1</sup>:</p>\n\n<pre><code>std::string magic();\n</code></pre>\n\n<p>Now, how to implement this function? Well, the problem description hints at it:</p>\n\n<ul>\n<li>read a single character</li>\n<li>if the character is <code>'*'</code>, return (an empty string) immediately</li>\n<li>otherwise, recursively call the function and concatenate the current character to its return value.</li>\n</ul>\n\n<hr>\n\n<p><sup>1</sup> This is the intuitive, na\u00efve solution. There\u2019s a better solution, which requires a changed signature. But this probably isn\u2019t asked here and the reason <em>why</em> that signature is better isn\u2019t trivial to explain.</p>\n"}, {"comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1553704107, "post_id": 55382014, "comment_id": 97486375, "body": "This would work, except the assignment explicitly asks for the result to be <i>returned</i>."}], "tags": [], "owner": {"reputation": 46, "user_id": 11234238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc2cf511cb54d0ec9bf5e495214a64a?s=128&d=identicon&r=PG&f=1", "display_name": "th3hunter", "link": "https://stackoverflow.com/users/11234238/th3hunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1553703689, "creation_date": 1553703689, "answer_id": 55382014, "question_id": 55381624, "link": "https://stackoverflow.com/questions/55381624/a-recursive-function-that-retrieves-characters-and-returns-in-reverse-order-c/55382014#55382014", "title": "A recursive function that retrieves characters and returns in reverse order c++", "body": "<p>Why don't you make the function return type void, when you encounter * you just return.\nand you call the function recursively without putting a return before your recursive call\nand then you print the character that you got and then you return.</p>\n"}], "owner": {"reputation": 13, "user_id": 11267339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-34uSYkPHJxQ/AAAAAAAAAAI/AAAAAAAAAJQ/O0dBWBj7pk4/photo.jpg?sz=128", "display_name": "EviDX", "link": "https://stackoverflow.com/users/11267339/evidx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55381972, "answer_count": 2, "score": 0, "last_activity_date": 1553708533, "creation_date": 1553702467, "last_edit_date": 1553708533, "question_id": 55381624, "link": "https://stackoverflow.com/questions/55381624/a-recursive-function-that-retrieves-characters-and-returns-in-reverse-order-c", "title": "A recursive function that retrieves characters and returns in reverse order c++", "body": "<p>I have a homework with which I cannot cope.\n\"Write a recursive function that retrieves characters from the user until it encounters an star and returns a string of user-entered characters (without an star - *) in reverse order than they were entered.\"</p>\n\n<p>I tried to write a code that gets characters until the star appears, but I do not know how to display the characters in reverse.</p>\n\n<blockquote>\n  <p><b> Solution </b></p>\n</blockquote>\n\n<pre><code>string recursiveReverse()\n{\n    cout &lt;&lt; \"Enter a new character\" &lt;&lt; endl;\n    char text;\n    cin &gt;&gt; text;\n\n    if(text == '*')\n        return std::string();\n    else\n        recursiveReverse();\n        cout &lt;&lt; text;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++14", "dry", "variadic"], "comments": [{"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 0, "creation_date": 1553702374, "post_id": 55381537, "comment_id": 97485288, "body": "Do you know the size of the vector at compile time?"}, {"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 2, "creation_date": 1553702377, "post_id": 55381537, "comment_id": 97485291, "body": "&quot;I have a std::vector of arguments and I would like to call a function with them. Is there any way to do this?&quot; Yes. By calling the function, passing the vector as its argument and creating the SQL statement by looping over the vector."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 3, "creation_date": 1553702391, "post_id": 55381537, "comment_id": 97485298, "body": "Can you add some code to show what you&#39;re trying to achieve?"}, {"owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "reply_to_user": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 1, "creation_date": 1553702476, "post_id": 55381537, "comment_id": 97485344, "body": "@Artyer No, the vector will have different sizes."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553702642, "post_id": 55381537, "comment_id": 97485454, "body": "whats wrong with <code>foo(vec[0],vec[1],vec[2]);</code> ? Please elaborate, if possible with some example of what code you would like to write"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553702713, "post_id": 55381537, "comment_id": 97485512, "body": "or do you mean <code>foo(vec[0]); foo(vec[1]);...</code> ? The question really isnt 100% clear"}, {"owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553702775, "post_id": 55381537, "comment_id": 97485557, "body": "@user463035818 The vector will have variable length, and I need to pass exactly the number of arguments given."}, {"owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553702839, "post_id": 55381537, "comment_id": 97485607, "body": "@user463035818 So <code>foo()</code> if the vector is of length 0, <code>foo(vec[0])</code> if it is of length 1, <code>foo(vec[0], vec[1])</code> if it is of length 2, and so on."}, {"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1553703021, "post_id": 55381537, "comment_id": 97485716, "body": "Whats the problem with vector&lt;vector&lt;&gt;&gt; ? Something like this <code>typedef std::vector&lt;std::string&gt; args; \tstd::vector&lt;args&gt; arg_repo;</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553703054, "post_id": 55381537, "comment_id": 97485737, "body": "unfortunately turning a vector to a tuple seems only possible for fixed sized vectors (see <a href=\"https://stackoverflow.com/questions/28410697/c-convert-vector-to-tuple\">here</a>) otherwise you could use <code>std::apply</code>. Is <code>foo</code> &quot;truly variadic&quot; (ie any number of arguments) or only up to some N (eg 0 up to 5 arguments)?"}, {"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 0, "creation_date": 1553703058, "post_id": 55381537, "comment_id": 97485740, "body": "@Charles For what reason you cannot call the function just as <code>foo(vec)</code>? If the vector length is not fixed during compile time, there is no way you can use variadic parameters <b>by design</b>."}, {"owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "reply_to_user": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 0, "creation_date": 1553703317, "post_id": 55381537, "comment_id": 97485898, "body": "@Jodocus It&#39;s not my function, it&#39;s a library function (from mysqlx, as linked above)."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1553703605, "post_id": 55381537, "comment_id": 97486074, "body": "Are the parts of your code that populate these vectors using fixed amounts, or is it run-time all the way up?"}, {"owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1553704017, "post_id": 55381537, "comment_id": 97486319, "body": "@Caleth I&#39;m only just starting to DRY the code out and find all the places where this paradigm is used. It&#39;s entirely possible that it would not be called with more than a dozen arguments. Certainly 8-10 arguments is fairly common."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1553704172, "post_id": 55381537, "comment_id": 97486415, "body": "I mean are you only doing <code>std::vector&lt;ArgT&gt; args = { A, B, C };</code>, vs ever doing <code>std::vector&lt;ArgT&gt; args = fromUi()</code>? In the first case you have the compile time number 3, you just need to retain it. In the second case you don&#39;t"}, {"owner": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 0, "creation_date": 1553704552, "post_id": 55381537, "comment_id": 97486642, "body": "why not index through the vector with a range based for loop and call the function in the body of the loop with the index value as the argument?"}], "answers": [{"comments": [{"owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "edited": false, "score": 0, "creation_date": 1553720834, "post_id": 55382395, "comment_id": 97494799, "body": "What is this syntax <code>= [](args_type args)</code>? My compiler seems to be confused. (I have <code>args_type</code> as <code>const std::vector&lt;std::string&gt; &amp;</code>.)"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "edited": false, "score": 0, "creation_date": 1553721653, "post_id": 55382395, "comment_id": 97495173, "body": "Oops, variable templates are C++17. It was a variable template initialised from a lambda. Turns out a plain function template is sufficient there"}, {"owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "edited": false, "score": 0, "creation_date": 1553778989, "post_id": 55382395, "comment_id": 97517332, "body": "Now it&#39;s choking on <code>return { { Is, call_apply_vector&lt;Is&gt;... } }</code> with <code>error: parameter packs not expanded with \u2018...\u2019</code>. I tweaked it a few ways but haven&#39;t managed to get it to compile."}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 3, "last_activity_date": 1553779478, "last_edit_date": 1553779478, "creation_date": 1553704838, "answer_id": 55382395, "question_id": 55381537, "link": "https://stackoverflow.com/questions/55381537/calling-a-function-with-a-vector-of-arguments/55382395#55382395", "title": "Calling a function with a vector of arguments", "body": "<p>You can do it, up to a compile time maximum number of arguments. It isn't pretty.</p>\n\n<pre><code>using result_type = // whatever\nusing arg_type = // whatever\nusing args_type = const std::vector&lt;arg_type&gt; &amp;;\nusing function_type = std::function&lt;result_type(args_type)&gt;;\n\ntemplate &lt;size_t... Is&gt;\nresult_type apply_vector_static(args_type args, std::index_sequence&lt;Is...&gt;)\n{\n    return select(args[Is]...);\n}\n\ntemplate&lt;size_t N&gt;\nresult_type call_apply_vector(args_type args)\n{ \n    return apply_vector_static(args, std::make_index_sequence&lt;N&gt;()); \n}\n\ntemplate &lt;size_t... Is&gt;\nstd::map&lt;size_t, function_type&gt; make_funcs(std::index_sequence&lt;Is...&gt;)\n{\n    return { { Is, call_apply_vector&lt;Is&gt; }... };\n}\n\nresult_type apply_vector(args_type args)\n{\n    // Some maximum limit\n    static const auto limit = std::make_index_sequence&lt;50&gt;();\n    static const auto funcs = make_funcs(limit);\n    return funcs.at(args.size())(args);\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/34e53c608a14d87f\" rel=\"nofollow noreferrer\">See it live</a></p>\n"}], "owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1553779478, "creation_date": 1553702251, "question_id": 55381537, "link": "https://stackoverflow.com/questions/55381537/calling-a-function-with-a-vector-of-arguments", "title": "Calling a function with a vector of arguments", "body": "<p>I have a <code>std::vector</code> of arguments and I would like to call a function with them. Is there any way to do this?</p>\n\n<p>In particular the function is the <code>mysqlx</code> <a href=\"https://dev.mysql.com/doc/dev/connector-cpp/8.0/classmysqlx_1_1_table.html#a24da70a98a65ba2110e35e5fd8b0fc89\" rel=\"nofollow noreferrer\">select</a> function and the arguments are the columns I'm trying to query; they will all be of type <code>std::string</code>. The purpose of the function is to reduce duplication in the codebase.</p>\n\n<p>(This seems like a generally useful topic, but I could not find an answer through search. If I missed it and this has already been answered, please point me to the question and close this as a duplicate, thanks.)</p>\n"}, {"tags": ["c++", "function", "math", "expression", "evaluate"], "comments": [{"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 0, "creation_date": 1553702693, "post_id": 55381513, "comment_id": 97485496, "body": "You will get into trouble with your approach when trying to implement rules like &quot;multiplication/division before addition/substraction&quot;. A better approach would be to use recursion, as it has been done in Stroustrup&#39;s books."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 1, "creation_date": 1553704963, "post_id": 55381513, "comment_id": 97486896, "body": "You described what the code should do, which is good. Please also state what it actually does. (You imply that <code>result_stack</code> is not what you expect when the second loop starts. So what is it?)"}, {"owner": {"reputation": 11, "user_id": 5637213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99d4398d97e0a9c805f21a8622dcc2f?s=128&d=identicon&r=PG", "display_name": "martymcfly", "link": "https://stackoverflow.com/users/5637213/martymcfly"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1553706772, "post_id": 55381513, "comment_id": 97487877, "body": "I added what you want. @JaMiT"}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1553711045, "post_id": 55381513, "comment_id": 97490195, "body": "This has been asked and answered many times.  You need a grammar, lexer/parser and a stack.  You should also acknowledge that these are simple arithmetic problems, not very heavy duty mathematics.  There are probably libraries for symbolic math.  I would recommend searching for one unless you are trying to learn how to do it for yourself."}, {"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 0, "creation_date": 1553716965, "post_id": 55381513, "comment_id": 97493002, "body": "<a href=\"https://gist.github.com/jweyrich/4bd1d4556069f3d49d73\" rel=\"nofollow noreferrer\">This gist</a> may give you more ideas on the implementation of an arithmetic expression evaluator."}, {"owner": {"reputation": 11, "user_id": 5637213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99d4398d97e0a9c805f21a8622dcc2f?s=128&d=identicon&r=PG", "display_name": "martymcfly", "link": "https://stackoverflow.com/users/5637213/martymcfly"}, "edited": false, "score": 0, "creation_date": 1553717133, "post_id": 55381513, "comment_id": 97493086, "body": "I will read it, thank you. Actually I thought may be the best solution is expression tree. But now, I&#39;ve been far away from that topic."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5637213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99d4398d97e0a9c805f21a8622dcc2f?s=128&d=identicon&r=PG", "display_name": "martymcfly", "link": "https://stackoverflow.com/users/5637213/martymcfly"}, "edited": false, "score": 0, "creation_date": 1553704375, "post_id": 55381722, "comment_id": 97486539, "body": "This is true. But operations in the first loop is more important for me. I want to know where is the extra pop i am doing."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 0, "last_activity_date": 1553702766, "creation_date": 1553702766, "answer_id": 55381722, "question_id": 55381513, "link": "https://stackoverflow.com/questions/55381513/implementation-of-a-function-that-evaluates-simple-mathematical-expressions-c/55381722#55381722", "title": "Implementation of a function that evaluates simple mathematical expressions. (C++)", "body": "<p>Your operands for the subtraction operation are swapped.  This because when you process the stack for the <code>+</code> and <code>-</code> operations you're parsing the equation from right-to-left.</p>\n\n<p>With your example, when the <code>-</code> is found in the stack, <code>result</code> is <code>12</code>.  You pop the <code>-</code>, then subtract the <code>6</code>, leaving <code>6</code> in result when it should be <code>-6</code>.</p>\n\n<p>You should use</p>\n\n<pre><code>result = stod(result_stack.top()) - result;\n</code></pre>\n\n<p>for subtraction.</p>\n\n<p>There is also no error checking in your code for invalid equations.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5637213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99d4398d97e0a9c805f21a8622dcc2f?s=128&d=identicon&r=PG", "display_name": "martymcfly", "link": "https://stackoverflow.com/users/5637213/martymcfly"}, "is_accepted": true, "score": 0, "last_activity_date": 1553824100, "last_edit_date": 1553824100, "creation_date": 1553711523, "answer_id": 55384275, "question_id": 55381513, "link": "https://stackoverflow.com/questions/55381513/implementation-of-a-function-that-evaluates-simple-mathematical-expressions-c/55384275#55384275", "title": "Implementation of a function that evaluates simple mathematical expressions. (C++)", "body": "<p>Answered here: <a href=\"https://www.dreamincode.net/forums/topic/415514-a-function-that-evaluates-simple-mathematical-expressions/page__view__findpost__p__2394180\" rel=\"nofollow noreferrer\">answer of the question</a></p>\n\n<p>Completed code is here:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;stack&gt;\n\nusing namespace std;\n\nstring trim(const string&amp; str)\n{\n    size_t first = str.find_first_not_of(' ');\n    if (string::npos == first)\n    {\n        return str;\n    }\n    size_t last = str.find_last_not_of(' ');\n    return str.substr(first, (last - first + 1));\n}\n\nvector&lt;string&gt; split(const std::string&amp; str, char delim = ' ')\n{\n    vector&lt;string&gt; elements;\n    stringstream ss(str);\n    string token;\n    while (getline(ss, token, delim)) {\n        elements.push_back(token);\n    }\n\n    return elements;\n}\n\ndouble evaluate(string operation)\n{\n    vector&lt;string&gt; values = split(operation, ' ');\n    vector&lt;string&gt; result_vector;\n    double result = 0;\n\n    for(unsigned int i = 0; i &lt; values.size(); i++){\n        if(values[i] == \"*\"){\n            double mini_result = stod(result_vector.back()) * stod(values[i+1]);\n            result_vector.pop_back();\n            i++;\n            result_vector.push_back(to_string(mini_result));\n        }\n        else if(values[i] == \"/\"){\n            double mini_result = stod(result_vector.back()) / stod(values[i+1]);\n            result_vector.pop_back();\n            i++;\n            result_vector.push_back(to_string(mini_result));\n        }\n        else{\n            result_vector.push_back(values[i]);\n        }\n    }\n\n    auto iterator = result_vector.begin();\n    while(iterator != result_vector.end()){\n        if(*iterator == \"-\"){\n            iterator++;\n            result -= stod(*iterator);\n        }\n        else if(*iterator == \"+\"){\n            iterator++;\n            result += stod(*iterator);\n        }\n        else{\n            result += stod(*iterator);\n        }\n        iterator++;\n    }\n    return result;\n}\n\n\nint main()\n{\n    cout&lt;&lt;evaluate(\"5 * 44 + 3 / 2 * 4 - 12\");\n}\n\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5637213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99d4398d97e0a9c805f21a8622dcc2f?s=128&d=identicon&r=PG", "display_name": "martymcfly", "link": "https://stackoverflow.com/users/5637213/martymcfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 55384275, "answer_count": 2, "score": 0, "last_activity_date": 1553824100, "creation_date": 1553702176, "last_edit_date": 1553706700, "question_id": 55381513, "link": "https://stackoverflow.com/questions/55381513/implementation-of-a-function-that-evaluates-simple-mathematical-expressions-c", "title": "Implementation of a function that evaluates simple mathematical expressions. (C++)", "body": "<p>I am trying to write a function that evaluates simple mathematical expressions (only four operations). I used stack and vector to do this. But stack operations don't behave as I expect. I couldn't find the cause. I am open to different solutions.</p>\n\n<p>The function should take a string like this:</p>\n\n<blockquote>\n  <p>\"5 * 44 + 3 / 2 * 4 - 12\"</p>\n</blockquote>\n\n<p>And return the result as a double.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;stack&gt;\n#include &lt;string&gt;\n#include &lt;cstdlib&gt;\n\nusing namespace std;\n\nvector&lt;string&gt; split(const std::string&amp; str, char delim = ' ')\n{\n    vector&lt;string&gt; elements;\n    stringstream ss(str);\n    string token;\n    while (getline(ss, token, delim)) {\n        elements.push_back(token);\n    }\n\n    return elements;\n}\n\n\ndouble evaluate(string operation)\n{\n    vector&lt;string&gt; values = split(operation, ' ');\n    stack&lt;string&gt; result_stack;\n    double result = 0;\n\n    for(unsigned int i = 0; i &lt; values.size(); i++){\n        if(values[i] == \"*\"){\n            double mini_result = stod(result_stack.top()) * stod(values[i+1]);\n            result_stack.pop();\n            i++;\n            result_stack.push(to_string(mini_result));\n        }\n        else if(values[i] == \"/\"){\n            double mini_result = stod(result_stack.top()) / stod(values[i+1]);\n            result_stack.pop();\n            i++;\n            result_stack.push(to_string(mini_result));\n        }\n        else{\n            result_stack.push(values[i]);\n        }\n    }\n\n    for(unsigned int i = 0; i&lt;result_stack.size(); i++){\n        if(result_stack.top() == \"-\"){\n            result_stack.pop();\n            result = stod(result_stack.top()) - result;\n            result_stack.pop();\n        }\n        else if(result_stack.top() == \"+\"){\n            result_stack.pop();\n            result += stod(result_stack.top());\n            result_stack.pop();\n        }\n        else{\n            result += stod(result_stack.top());\n            result_stack.pop();\n        }\n    }\n\n    return result;\n\n}\n\n\n\n\nint main()\n{\n\n    cout&lt;&lt;evaluate(\"5 * 44 + 3 / 2 * 4 - 12\");\n}\n\n</code></pre>\n\n<p>Before the second for loop, values in the result_stack should be like this for this example. \"12 | - | 6 | + | 220\" . And the returning value should be 214.</p>\n\n<p>But before the second for loop, stack contains only \"12 | - | 6\" values. \"+\" and \"220\" values are not there. Some extra pops occur which I don't expect.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zCSf8.jpg\" rel=\"nofollow noreferrer\">stack content should be like this for this example</a></p>\n"}, {"tags": ["c++", "qt", "qml", "qt-linguist"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1553702350, "post_id": 55381157, "comment_id": 97485268, "body": "Typo: change <code>selectLanguage(&quot;fr&quot;);</code> to <code>translator.selectLanguage(&quot;fr&quot;);</code>"}, {"owner": {"reputation": 9, "user_id": 11267250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c78fd3f5b2b2f3e2547cdf2a39beb718?s=128&d=identicon&r=PG&f=1", "display_name": "wissou", "link": "https://stackoverflow.com/users/11267250/wissou"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1553707264, "post_id": 55381157, "comment_id": 97488115, "body": "I get the same error : /usr/bin/ld: CMakeFiles/project.dir/src/main.cpp.o: in function <code>Translator::Translator(QQmlEngine*)&#39;: main.cpp:(.text._ZN18TranslatorC2EP10QQmlEngine[_ZN18Transla&zwnj;&#8203;torC5EP10QQmlEngine]&zwnj;&#8203;+0x27): undefined reference to </code>vtable for Translator&#39; /usr/bin/ld: CMakeFiles/projectdir/src/main.cpp.o: in function <code>Translator::~Translator()&#39;: main.cpp:(.text._ZN18TranslatorD2Ev[_ZN18TranslatorD5Ev]+0xf&zwnj;&#8203;): undefined reference to </code>vtable for Translator&#39; Is my problem not about binding ?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1553707651, "post_id": 55381157, "comment_id": 97488314, "body": "The error indicates that you are not running the MOC. If you are a beginner I recommend you use qmake instead of cmake"}, {"owner": {"reputation": 9, "user_id": 11267250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c78fd3f5b2b2f3e2547cdf2a39beb718?s=128&d=identicon&r=PG&f=1", "display_name": "wissou", "link": "https://stackoverflow.com/users/11267250/wissou"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1553708486, "post_id": 55381157, "comment_id": 97488794, "body": "Thank you for your fast answers. I just tried with qcreator so that it doesn&#39;t use cmake, and it gives me the same error."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1553708575, "post_id": 55381157, "comment_id": 97488840, "body": "<b><i>CMakeFiles</b> /project.dir/src/main.cpp.o</i>, that&#39;s why I pointed out that you use cmake, if you upload your code to a repo like github I could test it, maybe the problem is in another side"}], "owner": {"reputation": 9, "user_id": 11267250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c78fd3f5b2b2f3e2547cdf2a39beb718?s=128&d=identicon&r=PG&f=1", "display_name": "wissou", "link": "https://stackoverflow.com/users/11267250/wissou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553701171, "creation_date": 1553701171, "question_id": 55381157, "link": "https://stackoverflow.com/questions/55381157/qt-connect-translator-with-a-qml-object", "title": "Qt : Connect translator with a qml object", "body": "<p>I start to have quite a decent software but I would like to translate it, so I added a combobox in my settings menu. I would like the program to translate when the user selects his language inside the combobox. I already translated using Linguist and generated TS and QM files. I linked the ts file in my .pro.</p>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    QGuiApplication app(argc, argv);\n\n    QQmlApplicationEngine engine;\n    Translator translator(&amp;engine);\n\n    engine.rootContext()-&gt;setContextProperty(\"translator\", &amp;translator);\n    engine.load(QUrl(QStringLiteral(\"qrc:/main.qml\")));\n\n    return app.exec();\n}\n</code></pre>\n\n<p><strong>translator.h</strong></p>\n\n<pre><code>class Translator : public QObject\n{\nQ_OBJECT\n    Q_PROPERTY(QString emptyString READ getEmptyString NOTIFY languageChanged)\n\npublic:\n    explicit Translator(QQmlEngine *engine)\n    {\n        translator = new QTranslator(this);\n        engine = engine;\n    }\n\n    QString getEmptyString()\n    {\n        return \"\";\n    }\n\n    Q_INVOKABLE void selectLanguage(QString language)\n    {\n        if(language == QString(\"en\"))\n        {\n            translator-&gt;load(\":/translation/lang_en.qm\");\n            qGuiApp-&gt;installTranslator(translator);\n            engine-&gt;retranslate();\n        }\n        if(language == QString(\"fr\"))\n        {\n            qGuiApp-&gt;removeTranslator(translator);\n            engine-&gt;retranslate();\n        }\n        emit languageChanged();\n    }\n\nsignals:\n    void languageChanged();\n\nprivate:\n    QTranslator *translator;\n    QQmlEngine *engine;\n};\n</code></pre>\n\n<p><strong>main.qml</strong></p>\n\n<pre><code>ComboBox {\n    id: comboLangage\n    currentIndex: 0\n    model: [ qsTr(\"Fran\u00e7ais\"), qsTr(\"Anglais\") ]\n    width: 200\n    onActivated: {\n        if(comboLangage.currentIndex == 0){\n            selectLanguage(\"fr\"); // how do i call this method ?\n        }\n        else if(comboLangage.currentIndex == 1){\n            selectLanguage(\"en\")\n        }\n    }\n }\n</code></pre>\n\n<p>I tried using qmlRegisterType(\"issou.translator\", 1, 0, \"Translator\"); then importing it in the qml. Then i could create a Translator object in my qml and call some functions. But that didn't work. Any suggestions ?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "arrays", "string"], "comments": [{"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1553701485, "post_id": 55381116, "comment_id": 97484664, "body": "<code>int StrSize = rand() % 8 + 3;</code> you aren&#39;t resizing your string to match this.  In other words, you have Undefined Behavior because you will write into memory that is outside of the allocated bounds of your string object."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1553701604, "post_id": 55381116, "comment_id": 97484748, "body": "Plus we can add that <code>cin &gt;&gt; ArrSize;     string StringArr[ArrSize];</code> is not legal C++ (array bounds must be constants, not variables). It you are going to use strings you might as well use vectors <code>cin &gt;&gt; ArrSize;     vector&lt;string&gt; StringArr(ArrSize);</code>. Now it&#39;s legal."}], "answers": [{"comments": [{"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1553701612, "post_id": 55381203, "comment_id": 97484752, "body": "Note that overriding will still work, but only if the string buffer is large enough to fit all of your writes.  By using <code>push_back</code> you don&#39;t need to care about the buffer size before doing the writes; it will resize itself automatically."}, {"owner": {"reputation": 12501, "user_id": 2038768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a5649dd767843ed7a69851ea5cbaf6?s=128&d=identicon&r=PG", "display_name": "Mikhail Vladimirov", "link": "https://stackoverflow.com/users/2038768/mikhail-vladimirov"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 1, "creation_date": 1553701682, "post_id": 55381203, "comment_id": 97484800, "body": "Overriding does not increase length, so strings remain empty, despite the fact that their buffers become dirty."}], "tags": [], "owner": {"reputation": 12501, "user_id": 2038768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a5649dd767843ed7a69851ea5cbaf6?s=128&d=identicon&r=PG", "display_name": "Mikhail Vladimirov", "link": "https://stackoverflow.com/users/2038768/mikhail-vladimirov"}, "is_accepted": false, "score": 2, "last_activity_date": 1553701268, "creation_date": 1553701268, "answer_id": 55381203, "question_id": 55381116, "link": "https://stackoverflow.com/questions/55381116/random-string-generator-doesnt-edit-my-string-array-c/55381203#55381203", "title": "Random string generator doesn&#39;t edit my string array (C++)", "body": "<p>You should append characters to strings rather than trying to override them:</p>\n\n<pre><code>Arr[i].push_back (rand() % 74 + 48);\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>(Arr[i])[j] = rand() % 74 + 48;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 0, "last_activity_date": 1553702534, "creation_date": 1553702534, "answer_id": 55381653, "question_id": 55381116, "link": "https://stackoverflow.com/questions/55381116/random-string-generator-doesnt-edit-my-string-array-c/55381653#55381653", "title": "Random string generator doesn&#39;t edit my string array (C++)", "body": "<p>Most efficient, especially for longer strings, might be:</p>\n\n<pre><code>void random(string Arr[], int ArrSize){\n    for(int i = 0; i &lt; ArrSize; i++){\n        int StrSize = rand() % 8 + 3;\n        Arr [i].append (StrSize, 0);\n        for(int j = 0; j &lt; StrSize; j++){\n           (Arr[i])[j] = rand() % 74 + 48;\n        }\n    }\n}\n</code></pre>\n\n<p>since it avoids potential multiple allocations in <code>push_back</code>.</p>\n\n<p><a href=\"https://wandbox.org/permlink/IjOh9uDik0NNqoYd\" rel=\"nofollow noreferrer\">Live demo</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11267303, "user_type": "registered", "profile_image": "https://graph.facebook.com/2140439132932940/picture?type=large", "display_name": "Luka Krsti\u0107", "link": "https://stackoverflow.com/users/11267303/luka-krsti%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1553702534, "creation_date": 1553701055, "question_id": 55381116, "link": "https://stackoverflow.com/questions/55381116/random-string-generator-doesnt-edit-my-string-array-c", "title": "Random string generator doesn&#39;t edit my string array (C++)", "body": "<p>My string randomizing function outputs empty strings.</p>\n\n<p>I've already seen that inputting it manually works perfectly, I've tried using pointers but it only gives me error outputs.</p>\n\n<pre><code>\nvoid random(string Arr[], int ArrSize){\n    for(int i = 0; i &lt; ArrSize; i++){\n        int StrSize = rand() % 8 + 3;\n        for(int j = 0; j &lt; StrSize; j++){\n           (Arr[i])[j] = rand() % 74 + 48;\n        }\n    }\n}\n\n\n\nint main(){\n    int ArrSize;\n    cout &lt;&lt; \"Input string array length: \\n\";\n    cin &gt;&gt; ArrSize;\n    string StringArr[ArrSize];\n    random(StringArr, ArrSize);\n    lexCombSort(StringArr, ArrSize);\n    for(int i = 0; i &lt; ArrSize; i++) cout &lt;&lt; StringArr[i] &lt;&lt; \" \\n\";\n\n    return 0;\n}\n</code></pre>\n\n<p>I wanted the code to output an array of strings (and sort it in another function), but it doesn't output anything.</p>\n"}, {"tags": ["c++", "memory", "heap"], "comments": [{"owner": {"reputation": 480, "user_id": 6948160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129c8f620f47a08105f596962677b4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gojita", "link": "https://stackoverflow.com/users/6948160/gojita"}, "edited": false, "score": 0, "creation_date": 1553701001, "post_id": 55380944, "comment_id": 97484360, "body": "If I well understand RSS, this is the amout of RAM used at a certain point of time. So, this only means that all the address space of your program is not loaded all in RAM. There&#39;s surely some part of it on the swap"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553701008, "post_id": 55380944, "comment_id": 97484367, "body": "<a href=\"https://en.wikipedia.org/wiki/Resident_set_size\" rel=\"nofollow noreferrer\">Wiki page for RSS explains this quite well</a>. RSS is how much of your memory is actually in RAM. There are many reasons why memory allocated by your program may not be in RAM yet or anymore."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1553701130, "post_id": 55380944, "comment_id": 97484450, "body": "It is all about the <a href=\"https://en.wikipedia.org/wiki/Paging#Terminology\" rel=\"nofollow noreferrer\">paging</a> i.e. some pages are on swapping partition when peek period, since they are more likely not used by the code (cold zone) and kernel understanding this and moving it from RAM to HDD."}, {"owner": {"reputation": 501, "user_id": 7108533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0b781bb694192775542ee9d1375247?s=128&d=identicon&r=PG", "display_name": "alsora", "link": "https://stackoverflow.com/users/7108533/alsora"}, "edited": false, "score": 0, "creation_date": 1553701397, "post_id": 55380944, "comment_id": 97484621, "body": "@SergeiKurenkov The <code>SWAP</code> column from <code>top</code> always shows <code>0</code> during my application execution."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1553701554, "post_id": 55380944, "comment_id": 97484716, "body": "Memory allocated but not yet used will not yet have main memory assigned. If you allocate a huge array, you may not see an increase in RSS. If you access the first and last element in the array, you may only see the pages that contain the first and last elements, and nothing between, in RSS."}, {"owner": {"reputation": 501, "user_id": 7108533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0b781bb694192775542ee9d1375247?s=128&d=identicon&r=PG", "display_name": "alsora", "link": "https://stackoverflow.com/users/7108533/alsora"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553702630, "post_id": 55380944, "comment_id": 97485449, "body": "@user4581301 Ok so, if I <code>malloc</code> a 100Kb array, but then I always access only the same 10Kb, will the RSS only show 10Kb? And what about the full 100Kb size, is it counted in both Heap and VSZ?"}, {"owner": {"reputation": 501, "user_id": 7108533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0b781bb694192775542ee9d1375247?s=128&d=identicon&r=PG", "display_name": "alsora", "link": "https://stackoverflow.com/users/7108533/alsora"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553705964, "post_id": 55380944, "comment_id": 97487434, "body": "@user4581301 Ok, I tested with a simple program and it is exactly like this: memory which is allocated, but not initialized will be counted in the Heap and in the VSZ, while not being part of the RSS. You can answer the question so I can accept the answer."}], "answers": [{"tags": [], "owner": {"reputation": 501, "user_id": 7108533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0b781bb694192775542ee9d1375247?s=128&d=identicon&r=PG", "display_name": "alsora", "link": "https://stackoverflow.com/users/7108533/alsora"}, "is_accepted": true, "score": 0, "last_activity_date": 1554891568, "creation_date": 1554891568, "answer_id": 55610118, "question_id": 55380944, "link": "https://stackoverflow.com/questions/55380944/how-can-a-c-application-use-more-heap-than-rss-memory/55610118#55610118", "title": "How can a C++ application use more Heap than RSS Memory?", "body": "<p>As @user4581301 pointed out in the comments, there was a problem in my idea of RSS.</p>\n\n<p><code>HEAP = DynamicMemoryAllocated</code></p>\n\n<p><code>RSS = DynamicMemoryInitialized + Stack + Shared + CodeSize</code></p>\n\n<p>So it is not true that all the heap size is contained in the RSS, but only the part of it which has been initialized.</p>\n\n<p>If you allocate space for a 10Mb array, this is HEAP.\nIf you start initializing it, then the initialized parts will be counted as RSS.</p>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 0, "last_activity_date": 1554893454, "creation_date": 1554893454, "answer_id": 55610743, "question_id": 55380944, "link": "https://stackoverflow.com/questions/55380944/how-can-a-c-application-use-more-heap-than-rss-memory/55610743#55610743", "title": "How can a C++ application use more Heap than RSS Memory?", "body": "<p>RSS is the <em>Resident</em> Set Size.</p>\n\n<p>Not all the heap is necessarily resident - it may be swapped out, for example.</p>\n\n<p>However, the <em>Virtual</em> memory usage will include all of the heap (both resident and non-resident portions).</p>\n"}], "owner": {"reputation": 501, "user_id": 7108533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0b781bb694192775542ee9d1375247?s=128&d=identicon&r=PG", "display_name": "alsora", "link": "https://stackoverflow.com/users/7108533/alsora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 55610118, "answer_count": 2, "score": 1, "last_activity_date": 1554893454, "creation_date": 1553700576, "last_edit_date": 1553700681, "question_id": 55380944, "link": "https://stackoverflow.com/questions/55380944/how-can-a-c-application-use-more-heap-than-rss-memory", "title": "How can a C++ application use more Heap than RSS Memory?", "body": "<p>I have a C++ executable for a multithreads application which involves the opening of UDP ports.</p>\n\n<p>I'm measuring the memory usage of this application using different tools.</p>\n\n<p>From my understanding of Linux memory usage, <code>RSS = Heap + Stack + Shared + CodeSize</code>.</p>\n\n<p>However, now I think that the equation is wrong, because my application has:</p>\n\n<ul>\n<li>Peak Heap usage: 40Mb</li>\n<li>Peak RSS: 30Mb</li>\n</ul>\n\n<p>I measured the numbers with different tools (<code>valgrind</code>, <code>heaptrack</code>, <code>top</code>..) so I can say that they are correct.</p>\n\n<p>How can it be possible?\nWhat are the causes and the consequences of this situation?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c++11", "uniform-initialization", "aggregate-initialization"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 3, "creation_date": 1553700092, "post_id": 55380720, "comment_id": 97483744, "body": "Why <code>std::string name {&quot;&quot;};</code>, instead of <code>std::string name;</code>?"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553700161, "post_id": 55380720, "comment_id": 97483800, "body": "@AlgirdasPreid\u017eius just to give it a default value i guess.... but actually that probably is not required... :o"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553700197, "post_id": 55380720, "comment_id": 97483821, "body": "@AlgirdasPreid\u017eius oh wait... and that makes it work! ...errr, confused!"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553700357, "post_id": 55380720, "comment_id": 97483923, "body": "@code_fodder 1) &quot;<i>to give it a default value i guess</i>&quot; But, <code>std::string</code> has default constructor, which constructs an empty string.. 2) &quot;<i>and that makes it work!</i>&quot; That&#39;s why I asked such a question :)"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553700434, "post_id": 55380720, "comment_id": 97483985, "body": "@AlgirdasPreid\u017eius ahhh, cool - please add as an answer (maybe with a short explanation why its wrong?) and I&#39;ll mark it up : )"}, {"owner": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1553700919, "post_id": 55380720, "comment_id": 97484310, "body": "@code_fodder Before asking a question here, please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You don&#39;t need <code>std::function</code>, sub class and lot other code to ask this question. e.g. <a href=\"https://gcc.godbolt.org/z/Sjl7um\" rel=\"nofollow noreferrer\">gcc.godbolt.org/z/Sjl7um</a>"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553701930, "post_id": 55380720, "comment_id": 97484974, "body": "@code_fodder &quot;<i>please add as an answer (maybe with a short explanation why its wrong?)</i>&quot; And this is why I didn&#39;t write an answer: I found a way to fix it, but I don&#39;t have an explanation, of why it wasn&#39;t working, with your default initialization."}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "reply_to_user": {"reputation": 22312, "user_id": 463758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/105689a9cb392f18c1d0b27ed0cf657f?s=128&d=identicon&r=PG&f=1", "display_name": "balki", "link": "https://stackoverflow.com/users/463758/balki"}, "edited": false, "score": 0, "creation_date": 1553756034, "post_id": 55380720, "comment_id": 97504174, "body": "@balki ....ehh, you just can&#39;t please everyone - I think this is minimal, I made this example from sratch, I put the time in to make it as small as possible. For example: I did not know it was the std::string blah {&quot;&quot;} that was causing the problem, for all I knew it had somthing to do with the std::function. With hind site, now that I know the answer - yeah, sure I could make it smaller - but then if I knew that I would not be asking the qusetion ; )"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553756059, "post_id": 55380720, "comment_id": 97504187, "body": "@AlgirdasPreid\u017eius haha, fair point - just thought you deserved some credit : )"}], "answers": [{"comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1553713688, "post_id": 55380862, "comment_id": 97491475, "body": "Maybe use the <a href=\"https://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">cppreference</a> link instead (or in addition).  N3337 is a bit old."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1553714063, "post_id": 55380862, "comment_id": 97491625, "body": "@1201ProgramAlarm I linked to the old one since the Q is tagged as C++11.  That way they can see the C++11 language."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 5, "last_activity_date": 1553714173, "last_edit_date": 1553714173, "creation_date": 1553700335, "answer_id": 55380862, "question_id": 55380720, "link": "https://stackoverflow.com/questions/55380720/c11-struggling-to-understand-why-i-cant-uniform-init-a-structure-but-i-can-i/55380862#55380862", "title": "c++11 struggling to understand why I can&#39;t uniform init a structure, but I can init a std::pair of similar type", "body": "<p>The problem here is</p>\n\n<pre><code>std::string name {\"\"};\n</code></pre>\n\n<p>You use a in class member initializer, and in C++11, that is not allowed if you want the object to be an aggregate (per <a href=\"https://timsong-cpp.github.io/cppwp/n3337/dcl.init.aggr#1\" rel=\"nofollow noreferrer\">[dcl.init.aggr]/1</a>).  To get this to compile in C++11 you have to remove it.</p>\n\n<p>In C++14 and above that constraint was removed (updated <a href=\"https://timsong-cpp.github.io/cppwp/n4140/dcl.init.aggr#1\" rel=\"nofollow noreferrer\">[dcl.init.aggr]/1</a>) and in class member initializers are allowed in aggregates and the code will compile as is.</p>\n"}], "owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 55380862, "answer_count": 1, "score": 0, "last_activity_date": 1553714173, "creation_date": 1553699898, "last_edit_date": 1553700441, "question_id": 55380720, "link": "https://stackoverflow.com/questions/55380720/c11-struggling-to-understand-why-i-cant-uniform-init-a-structure-but-i-can-i", "title": "c++11 struggling to understand why I can&#39;t uniform init a structure, but I can init a std::pair of similar type", "body": "<p>Given the following code:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nclass test\n{\npublic:\n    struct info\n    {\n        std::string name {\"\"};\n        std::function&lt;bool()&gt; func;\n    };\n\n    //info my_info { \"test_name\", [&amp;]{return member_func();} }; // &lt;------ ERROR HERE\n\n    std::pair&lt;std::string, std::function&lt;bool()&gt;&gt; my_info_pair { \"test_name\", [&amp;]{return member_func();} };\n\n    bool member_func()\n    {\n        std::cout &lt;&lt; \"member_func\\n\";\n        return true;\n    };\n\n};\n\nint main() {\n    std::cout &lt;&lt; \"start\\n\";\n    test t;\n    std::cout &lt;&lt; t.my_info_pair.first &lt;&lt; std::endl;\n    t.my_info_pair.second();\n    std::cout &lt;&lt; \"end\\n\";\n}\n</code></pre>\n\n<p>This code works. But if I uncomment the commented-out line - which is trying to initialise a <code>info</code> struct in the same way that the std::pair is initialsing then it fails. I can't figure out why...</p>\n\n<p>The error get is:</p>\n\n<pre><code>prog.cc:15:60: error: could not convert '{\"test_name\", &lt;lambda closure\nobject&gt;test::&lt;lambda()&gt;{((test*)this)}}' from '&lt;brace-enclosed\ninitializer list&gt;' to 'test::info'\n     info my_info { \"test_name\", [&amp;]{return member_func();} };\n                                                             ^\n</code></pre>\n\n<p>Link to my test code: <a href=\"https://wandbox.org/permlink/6bwE4NdntRtXpRQK\" rel=\"nofollow noreferrer\">here (wandbox)</a></p>\n"}, {"tags": ["c++", "performance", "graphics", "directx"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1553700032, "post_id": 55380376, "comment_id": 97483706, "body": "Approach 1 looks simpler and more efficient to me as there is no sorting whatsoever involved. Why don&#39;t you try? How many vertexes do you have?"}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 1, "creation_date": 1553701099, "post_id": 55380376, "comment_id": 97484421, "body": "<b>Approach 3</b>: Compute the bounding volumes (box and sphere) offline and store them in a file along with compact forms of your geometry and materials."}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 7091352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82948456f4daf102b32c41f60a617260?s=128&d=identicon&r=PG", "display_name": "Florian Schut", "link": "https://stackoverflow.com/users/7091352/florian-schut"}, "is_accepted": false, "score": 0, "last_activity_date": 1553699259, "creation_date": 1553699259, "answer_id": 55380490, "question_id": 55380376, "link": "https://stackoverflow.com/questions/55380376/when-should-i-find-the-min-and-max-for-a-boundingbox-attached-to-a-model/55380490#55380490", "title": "When should I find the min and max for a BoundingBox attached to a Model", "body": "<p>Sorting generally is not a cheap operation especially as your models are getting larger. Therefore it to me like Approach 1 is more efficient but if unsure I suggest measuring it see which one takes longer. </p>\n\n<p>If you are using a library like Asspimp I believe the library takes care of bounding boxes but this might not be an option if you create the pipeline as a learning opportunity.</p>\n"}, {"tags": [], "owner": {"reputation": 5185, "user_id": 6202327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AFtrB.png?s=128&g=1", "display_name": "Makogan", "link": "https://stackoverflow.com/users/6202327/makogan"}, "is_accepted": true, "score": 0, "last_activity_date": 1553724042, "creation_date": 1553724042, "answer_id": 55387135, "question_id": 55380376, "link": "https://stackoverflow.com/questions/55380376/when-should-i-find-the-min-and-max-for-a-boundingbox-attached-to-a-model/55387135#55387135", "title": "When should I find the min and max for a BoundingBox attached to a Model", "body": "<h1>Approach 1</h1>\n\n<p>Time complexity is in O(n) and memory complexity is O(1). </p>\n\n<p>It is simple to implement.</p>\n\n<h1>Approach 2</h1>\n\n<p>Time complexity is O(nLogn) memory complexity is potentially at least linear (if you make a copy of the arrays or if you use merge sort) or O(1) if you use an in place sorting algorithm like quicksort.</p>\n\n<p>This has to be done 3 times one for each dimension.</p>\n\n<p>All in all Approach 1 is best in all scenarios I can think of.</p>\n"}], "owner": {"reputation": 145, "user_id": 9442094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61fdea5580aba4a8a620d6d5a8c341a?s=128&d=identicon&r=PG&f=1", "display_name": "Natalo77", "link": "https://stackoverflow.com/users/9442094/natalo77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55387135, "answer_count": 2, "score": 1, "last_activity_date": 1553724042, "creation_date": 1553698859, "question_id": 55380376, "link": "https://stackoverflow.com/questions/55380376/when-should-i-find-the-min-and-max-for-a-boundingbox-attached-to-a-model", "title": "When should I find the min and max for a BoundingBox attached to a Model", "body": "<p>I'm working on implementing a ModelClass for any 3D model in my DirectX 11/12 pipeline.</p>\n\n<p>My specific problem lies within calculating the min and max for the BoundingBox structure I wish to use as a member of the ModelClass.</p>\n\n<p>I have two approaches to calculating them.</p>\n\n<p><strong>Approach 1.</strong>\nWhen each vertex is being read from file, store a current minx,y,z and maxx,y,z and check each vertex as it is loaded in against the current min/max x,y,z.</p>\n\n<p><strong>Approach 2.</strong>\nAfter all the vertices have been loaded, sort them by x, then y, then z, finding the lowest and highest value at each point.</p>\n\n<p>Which Approach would you recommend and why?</p>\n"}, {"tags": ["c++", "graph-algorithm"], "comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 2, "creation_date": 1553699120, "post_id": 55380343, "comment_id": 97483040, "body": "You have undefined behavoir. Once you call <code>s.erase(it);</code> then you can no-longer use <code>it</code> yet you continue using <code>it</code> as part of the for loop."}, {"owner": {"reputation": 102, "user_id": 10246216, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T8INWg4XQfo/AAAAAAAAAAI/AAAAAAAAKEA/hOQz9QPOAe0/photo.jpg?sz=128", "display_name": "Nikhil Jagtap", "link": "https://stackoverflow.com/users/10246216/nikhil-jagtap"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553699345, "post_id": 55380343, "comment_id": 97483202, "body": "Can you please specify where?"}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553699657, "post_id": 55380343, "comment_id": 97483418, "body": "in <code>tsp</code> you do <code>s.erase(it)</code>. This removes the element it is referencing and so it is no longer valid to access <code>it</code> in any way after that. Yet when the loop gets back to the top it does <code>++it</code> and <code>it != blah</code> of which neither are allowed as <code>it</code> no longer references a valid item."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553699766, "post_id": 55380343, "comment_id": 97483502, "body": "See <a href=\"https://en.cppreference.com/w/cpp/container/set/erase\" rel=\"nofollow noreferrer\">here</a> which mentions <code>set::erase</code> does: <i>References and iterators to the erased elements are invalidated. Other references and iterators are not affected.</i>"}, {"owner": {"reputation": 102, "user_id": 10246216, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T8INWg4XQfo/AAAAAAAAAAI/AAAAAAAAKEA/hOQz9QPOAe0/photo.jpg?sz=128", "display_name": "Nikhil Jagtap", "link": "https://stackoverflow.com/users/10246216/nikhil-jagtap"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553699974, "post_id": 55380343, "comment_id": 97483659, "body": "then how should i delete the elements 1 by 1 and pass the reduced set to tsp?"}], "owner": {"reputation": 102, "user_id": 10246216, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T8INWg4XQfo/AAAAAAAAAAI/AAAAAAAAKEA/hOQz9QPOAe0/photo.jpg?sz=128", "display_name": "Nikhil Jagtap", "link": "https://stackoverflow.com/users/10246216/nikhil-jagtap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553698761, "creation_date": 1553698761, "question_id": 55380343, "link": "https://stackoverflow.com/questions/55380343/why-did-this-tsp-code-fail-in-the-case-mentioned-but-worked-else-where", "title": "Why did this TSP code fail in the case mentioned but worked else where?", "body": "<p>I am implementing Travelling Salesman Problem with Dynamic approach. I have added my attempt below. The code compiled and gave correct output for most of the cases. However, it failed when I had matrix representation: [[0,10,1],[1,0,10],[10,1,0]]. I expect the result to be 3 but it is showing me 30 as the output. </p>\n\n<p>I have done recursion calls and dict map stores the keys for memorization.</p>\n\n<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n\nint v;\nint G[10][10];\nint parent[10];\nmap&lt;pair&lt;int,set&lt;int&gt; &gt;, int &gt; dict;\nvoid solve(int,set&lt;int&gt;);\nint tsp(int,set&lt;int&gt;);\n\nint main(){\n    set&lt;int&gt; s,s_o;\n    set&lt;int&gt;::iterator it;\n    cout&lt;&lt;\"Give number of vertices\"&lt;&lt;endl;\n    cin&gt;&gt;v;\n    for(int i=0;i&lt;v;i++)\n        s.insert(i);\n    //cout&lt;&lt;\"Give number of edges\"&lt;&lt;endl;\n    //cin&gt;&gt;e;\n    s_o=s;\n    cout&lt;&lt;\"Give edges\"&lt;&lt;endl;\n    for(int i=0;i&lt;v;i++){\n        for(int j=0;j&lt;v;j++){\n            cin&gt;&gt;G[i][j];\n        }\n    }\n    solve(0,s);\n    return 0;\n}\n\nvoid solve(int i,set&lt;int&gt; s){\n    parent[i]=-1;\n    set&lt;int&gt;::iterator it;\n    it=s.find(i);\n    s.erase(it);\n    // for(it=s.begin();it!=s.end();++it)\n    //   cout&lt;&lt;*it&lt;&lt;\" \";\n    int ans=tsp(0,s);\n    cout&lt;&lt;ans&lt;&lt;endl;\n    for(int i=0;i&lt;v;i++)\n        cout&lt;&lt;parent[i]&lt;&lt;\" \";\n    cout&lt;&lt;endl;\n}\n\nint tsp(int a,set&lt;int&gt;s){\n    set&lt;int&gt;::iterator it;\n    int min_cost=1000000;\n    int k,min_k;\n    if(s.empty()){\n        return G[a][0];\n    }\n    for(it=s.begin();it!=s.end();++it){\n        k=*it;\n        s.erase(it);\n        if(dict.find(pair&lt;int, set&lt;int&gt; &gt;(k,s))!=dict.end()){\n            //cout&lt;&lt;\"here\"&lt;&lt;endl;\n            return G[a][k]+ dict.at(pair&lt;int, set&lt;int&gt; &gt;(k,s));\n        }\n        else{\n            if(tsp(k,s)&lt;min_cost){\n                min_cost=tsp(k,s);\n                min_k=k;\n            }\n            pair&lt;int,set&lt;int&gt; &gt; x(k,s);\n            dict.insert(pair&lt;pair&lt;int, set&lt;int&gt; &gt;,int &gt;(x,min_cost));\n            parent[a]=min_k; //i must admit that this is accidental, but \n            //it worked xD\n            return G[a][k]+min_cost;\n        }\n    }\n}\n</code></pre>\n\n<p>Also the parent array I expect to hold parent of vertex and -1 for source(0 in case). \nIs there anything wrong in the tsp() function? If not, why did it give answer as 30?\nAlso, what is wrong in the parent array use?</p>\n\n<p>Thank you for your help! :)</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 5, "creation_date": 1553698272, "post_id": 55380141, "comment_id": 97482411, "body": "Create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1553698569, "post_id": 55380141, "comment_id": 97482642, "body": "Isn&#39;t that error clear enough? You declared a member function in <code>AddClass</code> which expects <b>two</b> arguments. You called this member function with <code>NewObject.setNumbers(&quot;answer: \\n&quot;);</code> - that&#39;s <b>one</b> argument. (The compiler didn&#39;t complain explicitly that the type of argument isn&#39;t matching but it will as soon as you provide the correct number of arguments.)"}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553698648, "post_id": 55380141, "comment_id": 97482703, "body": "Also this is wrong: <code>void setNumbers(int a, int b){int answer = a + b;}</code> as it declares and sets a new <i>local</i> called <code>answer</code> instead of the relevant member."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553698736, "post_id": 55380141, "comment_id": 97482780, "body": "The beauty of the MCVE is it reduces the code to the bug, the whole bug, and nothing but the bug. When your program gets down to the few lines required to reproduce a bug, it&#39;s usually easy to see and be able to fix the error."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1553698777, "post_id": 55380141, "comment_id": 97482801, "body": "May be, it was confusing to you that it didn&#39;t say: That doesn&#39;t match! but something with &quot;candidates&quot;. That&#39;s because there could be multiple functions with same name where the number and types of arguments is used to choose the right one."}], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 11209337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LQgOlyFPQrA/AAAAAAAAAAI/AAAAAAAAAAk/5mSg0xIU2Ek/photo.jpg?sz=128", "display_name": "CodeoftheWarrior", "link": "https://stackoverflow.com/users/11209337/codeofthewarrior"}, "is_accepted": false, "score": 0, "last_activity_date": 1553698588, "creation_date": 1553698588, "answer_id": 55380291, "question_id": 55380141, "link": "https://stackoverflow.com/questions/55380141/related-to-classes-and-why-the-code-is-giving-an-error/55380291#55380291", "title": "Related to classes and why the code is giving an error", "body": "<p>Yep so your function setNumbers() expects two integer arguments provided, i.e. NewObject.setNumbers(5, 10); which would set the number to 15. You have provided a string literal \"answer: \\n\" which is not the same and therefore will not compile. </p>\n"}, {"tags": [], "owner": {"reputation": 465, "user_id": 11241587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bea334bb29226f73a25b431b3e48b5?s=128&d=identicon&r=PG&f=1", "display_name": "Theodor Badea", "link": "https://stackoverflow.com/users/11241587/theodor-badea"}, "is_accepted": true, "score": 1, "last_activity_date": 1553699112, "last_edit_date": 1553699112, "creation_date": 1553698727, "answer_id": 55380336, "question_id": 55380141, "link": "https://stackoverflow.com/questions/55380141/related-to-classes-and-why-the-code-is-giving-an-error/55380336#55380336", "title": "Related to classes and why the code is giving an error", "body": "<p>In main, your are passing a string as parameter to your setNumbers method. This line is wrong in main:</p>\n\n<pre><code>     NewObject.setNumbers(\"answer: \\n\");\n</code></pre>\n\n<p>Your setNumbers function neeeds 2 integers as it is declared. Try:</p>\n\n<pre><code>    int a = 10;\n    int b = 5;\n    NewObject.setNumbers(a, b);\n</code></pre>\n\n<p>Good luck in your OOP learning journey!</p>\n\n<p><strong>EDIT</strong>: \nAlso, in your setNumbers function, you must not redeclare answer because this variable is a class member. Remove int, just use answer inside setNumbers.</p>\n"}], "owner": {"reputation": 69, "user_id": 10653474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-el5zRrhWlno/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbADj_Dz2kV9riKuQw307BJ2cy6DpA/mo/photo.jpg?sz=128", "display_name": "y_1234", "link": "https://stackoverflow.com/users/10653474/y-1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55380336, "answer_count": 2, "score": -3, "last_activity_date": 1553699112, "creation_date": 1553698156, "last_edit_date": 1553698398, "question_id": 55380141, "link": "https://stackoverflow.com/questions/55380141/related-to-classes-and-why-the-code-is-giving-an-error", "title": "Related to classes and why the code is giving an error", "body": "<p>I want to add two numbers using OOP way. I am a complete newbie in C++ and hence need your help.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nclass RunwalsClass{\n\n    public: // public function\n        void setName(string x){\n            name = x;\n        }\n        string getName(){\n            return name;\n        };\n\n    private: // good programming practice to make it private\n        string name;\n\n};\n\nclass MyClass{\n\n    public:\n        void setSaying(string y){\n            CoolSaying = y;\n        }\n        string getSaying(){\n            return CoolSaying;\n        }\n\n    private:\n        string CoolSaying;\n};\n\nclass FavSitcom{\n\n    public:\n        void setSitcom(string z){\n            BreakingBad = z;\n        }\n\n        string getSitcom(){\n            return BreakingBad;\n        }\n\n    private:\n        string BreakingBad;\n};\n\nclass AddClass{\n\n    public:\n        void setNumbers(int a, int b){\n            int answer = a + b;\n        }\n\n        int getAddition(){\n            return answer;\n        }\n\n    private:\n        int answer;\n\n};\n\nint main(){\n\n    RunwalsClass RunwalsObject;\n    RunwalsObject.setName(\"Sir Buckey Wallace\");\n    cout &lt;&lt; RunwalsObject.getName() &lt;&lt; endl;\n\n    MyClass MyObject;\n    MyObject.setSaying(\"Preaching to the choir! \\n\");\n    cout &lt;&lt; MyObject.getSaying();\n\n    FavSitcom MyNewObject;\n    MyNewObject.setSitcom(\"My favorite Sitcom is: Breaking Bad \\n\");\n    cout &lt;&lt; MyNewObject.getSitcom();\n\n    AddClass NewObject;\n    NewObject.setNumbers(\"answer: \\n\");\n    cout &lt;&lt; AddObject.getAddition();\n\n    return 0;\n}\n\n\nerror: #include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nclass RunwalsClass{\n\n    public: // public function\n        void setName(string x){\n            name = x;\n        }\n        string getName(){\n            return name;\n        };\n\n    private: // good programming practice to make it private\n        string name;\n\n};\n\nclass MyClass{\n\n    public:\n        void setSaying(string y){\n            CoolSaying = y;\n        }\n        string getSaying(){\n            return CoolSaying;\n        }\n\n    private:\n        string CoolSaying;\n};\n\nclass FavSitcom{\n\n    public:\n        void setSitcom(string z){\n            BreakingBad = z;\n        }\n\n        string getSitcom(){\n            return BreakingBad;\n        }\n\n    private:\n        string BreakingBad;\n};\n\nclass AddClass{\n\n    public:\n        void setNumbers(int a, int b){\n            int answer = a + b;\n        }\n\n        int getAddition(){\n            return answer;\n        }\n\n    private:\n        int answer;\n\n};\n\nint main(){\n\n    RunwalsClass RunwalsObject;\n    RunwalsObject.setName(\"Sir Buckey Wallace\");\n    cout &lt;&lt; RunwalsObject.getName() &lt;&lt; endl;\n\n    MyClass MyObject;\n    MyObject.setSaying(\"Preaching to the choir! \\n\");\n    cout &lt;&lt; MyObject.getSaying();\n\n    FavSitcom MyNewObject;\n    MyNewObject.setSitcom(\"My favorite Sitcom is: Breaking Bad \\n\");\n    cout &lt;&lt; MyNewObject.getSitcom();\n\n    AddClass NewObject;\n    NewObject.setNumbers(\"answer: \\n\");\n    cout &lt;&lt; AddObject.getAddition();\n\n    return 0;\n}\n</code></pre>\n\n<p>Reported error:</p>\n\n<pre>\nerror: no matching function for call to 'AddClass::setNumbers(const char [10])\nnote: candidate: void AddClass::setNumbers(int, int)\nnote: candidate expects 2 arguments, 1 provided.\n</pre>\n"}, {"tags": ["c++", "linux", "performance", "cin", "mmap"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1553697451, "post_id": 55379852, "comment_id": 97481791, "body": "Please reformat your code with logical indentation. In its current shape it&#39;s mostly unreadable."}, {"owner": {"reputation": 1154, "user_id": 10410363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5yYJ.gif?s=128&g=1", "display_name": "cccnrc", "link": "https://stackoverflow.com/users/10410363/cccnrc"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1553697513, "post_id": 55379852, "comment_id": 97481839, "body": "Sorry, it&#39;s passage through bash that removes indentation, I&#39;m editing"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1553697561, "post_id": 55379852, "comment_id": 97481880, "body": "Why does bash need to do anything directly to C++ code?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1553697613, "post_id": 55379852, "comment_id": 97481929, "body": "Try this to format: <a href=\"http://format.krzaq.cc/\" rel=\"nofollow noreferrer\">format.krzaq.cc</a> then paste the result back select it an hit the {} button (which will format it in a code block)."}, {"owner": {"reputation": 1154, "user_id": 10410363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5yYJ.gif?s=128&g=1", "display_name": "cccnrc", "link": "https://stackoverflow.com/users/10410363/cccnrc"}, "edited": false, "score": 0, "creation_date": 1553697624, "post_id": 55379852, "comment_id": 97481938, "body": "to print the 4 spaces, if I do with atom (my editor) it pass the code further away. I&#39; editing anyway"}, {"owner": {"reputation": 1154, "user_id": 10410363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5yYJ.gif?s=128&g=1", "display_name": "cccnrc", "link": "https://stackoverflow.com/users/10410363/cccnrc"}, "edited": false, "score": 0, "creation_date": 1553698670, "post_id": 55379852, "comment_id": 97482725, "body": "edited, hope this helps and thanks for suggestion"}], "owner": {"reputation": 1154, "user_id": 10410363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5yYJ.gif?s=128&g=1", "display_name": "cccnrc", "link": "https://stackoverflow.com/users/10410363/cccnrc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553700304, "creation_date": 1553697386, "last_edit_date": 1553700304, "question_id": 55379852, "link": "https://stackoverflow.com/questions/55379852/fast-file-reading-in-c-comparison-of-different-strategies-with-mmap-and-std", "title": "fast file reading in C++, comparison of different strategies with mmap() and std::cin() performance results interpretation", "body": "<p>After advises on a question I made to close mmapped files (<a href=\"https://stackoverflow.com/questions/55344174/c-close-a-open-file-read-with-mmap\">c++ close a open() file read with mmap</a>) I made some comparisons and I noticed that, as suggested by some users, std::cin buffer approach is performing similar to my mmapped approach. </p>\n\n<p>I decided to make a performance comparison: every script opens a file that contains other files path (about 3500), read the file and takes 10 random paths and opening all these 10 files (of 500 lines every, about 700 characters each line) and read the number of newlines in it, for 1000 times randomly.</p>\n\n<p>My original version was a mapped approach (but it did not close the file at the end and it gives you an error after 300-400 file openings, not reached in this case  (<a href=\"https://stackoverflow.com/questions/55344174/c-close-a-open-file-read-with-mmap\">c++ close a open() file read with mmap</a>)).</p>\n\n<p><strong>MMAP.OPEN (v0)</strong>:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n#include &lt;vector&gt;\n#include &lt;set&gt;\n#include &lt;typeinfo&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;unistd.h&gt;\n\nconst char* map_file(const char* fname, size_t&amp; length);\nvoid  gnomadIndex( std::string &amp;nomeFileIndex,\n                    std::vector&lt;std::string&gt; &amp;vSubfileNames,\n                    std::vector&lt;int&gt; &amp;vSubfileStarts,\n                    std::vector&lt;int&gt; &amp;vSubfileStops,\n                    std::vector&lt;std::vector&lt;int&gt;&gt; &amp;vSubfilePosizioniVector);\nvoid gnomadSubfileAnalysis( std::string &amp;nomeFile );\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n );\nint generateRandInt( int l0, int u0 );\n\nint main() {\n\n      //this take the INDEX file (with the paths to the athor) and populate these vectors\n      std::string gnomadSplitDir = \"/Volumes/enrico/gnomad/exomes/splitted_5c/\";\n      std::string nomeChr = \"1\";\n      std::stringstream streamNomeGnomadChrDir;\n      streamNomeGnomadChrDir &lt;&lt; gnomadSplitDir &lt;&lt; \"ex_\" &lt;&lt; nomeChr &lt;&lt; \"_5c/\" &lt;&lt; \"chr_\" &lt;&lt; nomeChr &lt;&lt; \"/\";\n      std::string pathGnomadChrDir = streamNomeGnomadChrDir.str();\n      std::stringstream streamNomeGnomadChrIndex;\n      streamNomeGnomadChrIndex &lt;&lt; pathGnomadChrDir &lt;&lt; \"chr_\" &lt;&lt; nomeChr &lt;&lt; \".txt\";\n      std::string pathGnomadChrIndex = streamNomeGnomadChrIndex.str();\n      std::vector&lt;std::string&gt; vSubfileNames;\n      std::vector&lt;int&gt; vSubfileStarts;\n      std::vector&lt;int&gt; vSubfileStops;\n      std::vector&lt;std::vector&lt;int&gt;&gt; vSubfilePosizioniVector;\n      gnomadIndex(pathGnomadChrIndex,\n                  vSubfileNames,\n                  vSubfileStarts,\n                  vSubfileStops,\n                  vSubfilePosizioniVector\n                );\n      std::vector&lt;std::string&gt; vGnomadSubfilePaths;\n      srand((unsigned)time(NULL)); //seeds the pseudo random number generator that rand() uses (http://www.cplusplus.com/forum/beginner/29699/)\n      int size0 = 10;\n      std::vector&lt;int&gt; v0;\n      populateVector(v0, size0);\n\n      //the vector with the file names is converted in file paths and then opened and line counted for each file\n       std::vector&lt;std::string&gt; vSubfileNames2;\n       for (auto si : v0) vSubfileNames2.push_back(vSubfileNames[si]);\n       for ( int subCount = 0; subCount &lt; vSubfileNames2.size(); subCount++ ) {\n        std::stringstream streamNomeSubfileGnomad;\n        streamNomeSubfileGnomad &lt;&lt; pathGnomadChrDir &lt;&lt; vSubfileNames2[subCount];\n        std::string pathGnomadSubfile = streamNomeSubfileGnomad.str();\n        gnomadSubfileAnalysis(pathGnomadSubfile);\n      }\n\n}\n\n\n\n\nvoid gnomadSubfileAnalysis( std::string &amp;nomeFile ) {\n  size_t length;\n  auto f = map_file(nomeFile.c_str(), length);\n  auto l = f + length;\n  std::vector&lt;int&gt; v0;\n  for (int i=0; i&lt;length; i++) if (f[i] == '\\n') v0.push_back(i);\n  std::cout &lt;&lt; \"subfile: \" &lt;&lt; nomeFile &lt;&lt; \", has: \" &lt;&lt; v0.size() &lt;&lt; \" rows in: \" &lt;&lt; length &lt;&lt; \" bytes.\" &lt;&lt; '\\n';\n}\n\nvoid  gnomadIndex( std::string &amp;nomeFileIndex,\n                    std::vector&lt;std::string&gt; &amp;vSubfileNames,\n                    std::vector&lt;int&gt; &amp;vSubfileStarts,\n                    std::vector&lt;int&gt; &amp;vSubfileStops,\n                    std::vector&lt;std::vector&lt;int&gt;&gt; &amp;vSubfilePosizioniVector\n                  ) {\n  size_t length;\n  auto f = map_file(nomeFileIndex.c_str(), length);\n  auto l = f + length;\n\n  std::vector&lt;int&gt; v0;\n\n  v0.push_back(0); \n  for (int i=0; i&lt;length; i++) {\n    if (f[i] == '\\n') v0.push_back(i+1);\n  }\n  v0.pop_back();\n  for (int nl = 0; nl &lt; v0.size(); nl++) {\n    int ncol = 0;\n    std::vector&lt;char&gt; vSubfile;\n    std::vector&lt;char&gt; vSubStart;\n    std::vector&lt;char&gt; vSubStop;\n    std::vector&lt;char&gt; vSubPos;\n    std::vector&lt;int&gt; vSubfilePosVector;\n\n    for( int start=v0[nl]; start&lt;v0[nl+1]; start++  ) {\n      if (f[start] == ',') ncol++;\n\n      if (ncol == 0) {\n        if ( f[start] != ',' ) {\n          vSubfile.push_back(f[start]);\n        }\n      }\n\n      if (ncol == 1) {\n        if ( f[start] != ',' ) {\n          vSubStart.push_back(f[start]);\n        }\n      }\n\n      if (ncol == 2) {\n        if ( f[start] != ',' ) {\n          vSubStop.push_back(f[start]);\n        }\n      }\n\n      if (ncol == 3) {\n        if ( f[start] != ',' ) {\n          if ( f[start] != ':' ) {\n            vSubPos.push_back(f[start]);\n          }\n          if ( f[start] == ':' || f[start] == '\\n' ) {\n\n              std::string subfilePosValue ( vSubPos.begin(), vSubPos.end() );\n              vSubPos.clear();\n\n              vSubfilePosVector.push_back( stoi(subfilePosValue) );\n              subfilePosValue.erase();\n            }\n          }\n        }\n      }\n\n  std::string subFileValue ( vSubfile.begin(), vSubfile.end() );\n  vSubfile.clear();\n  std::string subfileStartValue ( vSubStart.begin(), vSubStart.end() );\n  vSubStart.clear();\n  std::string subfileStopValue ( vSubStop.begin(), vSubStop.end() );\n  vSubStop.clear();\n\n  vSubfileNames.push_back( subFileValue );\n  vSubfileStarts.push_back( stoi( subfileStartValue ) );\n  vSubfileStops.push_back( stoi(subfileStopValue) );\n  vSubfilePosizioniVector.push_back( vSubfilePosVector );\n  }\n}\n\nvoid handle_error(const char* msg) {\n    perror(msg);\n    exit(255);\n}\n\nconst char* map_file(const char* fname, size_t&amp; length) {\n\n    int fd = open(fname, O_RDONLY);\n\n    if (fd == -1)\n        handle_error(\"open\");\n\n    struct stat sb;\n\n    if (fstat(fd, &amp;sb) == -1)\n        handle_error(\"fstat\");\n\n    length = sb.st_size;\n\n    const char* addr = static_cast&lt;const char*&gt;(mmap(NULL, length, PROT_READ, MAP_PRIVATE, fd, 0u));\n    if (addr == MAP_FAILED)\n        handle_error(\"mmap\");\n\n    return addr;\n}\n\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n ) {\n  for( int i = 0 ; i &lt; n ; ++i ) vec.push_back( 0 + rand() % (3000 - 1 + 1)); //gli ultimi due num sono upper e lower range limits\n  sort( vec.begin(), vec.end() );\n}\n\nint generateRandInt( int l0, int u0 ) {\n  int n0 = l0 + rand() % (u0 - l0 + 1);\n  return n0;\n}\n</code></pre>\n\n<p>As suggested, I then tried with <strong>CIN (v1)</strong>, here the code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;vector&gt;\n#include &lt;sstream&gt;\n\n\nvoid read_file_cin( std::string &amp;nomeFile );\nvoid read_gnomad_index_cin( std::string &amp;nomeFile, char &amp;separator, std::vector&lt;std::string&gt; &amp;vectorName );\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n );\nint generateRandInt( int l0, int u0 );\nstd::vector&lt;int&gt; sovrapposizioniVectorsInt( std::vector&lt;int&gt; &amp;v0, std::vector&lt;int&gt; &amp;v1 );\n\nint main() {\n\n  std::string pathGnomadChrIndex = \"/Volumes/enrico/gnomad/exomes/splitted_5c/ex_1_5c/chr_1/chr_1.txt\";\n  char separator = ',';\n  std::vector&lt;std::string&gt; vSubfileNames;\n\n  read_gnomad_index_cin(pathGnomadChrIndex, separator, vSubfileNames);\n\n  srand((unsigned)time(NULL)); //seeds the pseudo random number generator that rand() uses (http://www.cplusplus.com/forum/beginner/29699/)\n  int size0 = 10;\n  std::vector&lt;int&gt; v0;\n  populateVector(v0, size0);\n\n   std::vector&lt;std::string&gt; vSubfileNames2;\n   for (auto si : v0) vSubfileNames2.push_back(vSubfileNames[si]);\n\n   std::string gnomadSplitDir = \"/Volumes/enrico/gnomad/exomes/splitted_5c/ex_1_5c/chr_1/\";\n   for ( auto vi : vSubfileNames2 ) {\n     std::cout &lt;&lt; vi &lt;&lt; '\\n';\n     std::stringstream streamNomeGnomadChrDir;\n     streamNomeGnomadChrDir &lt;&lt; gnomadSplitDir &lt;&lt; vi;\n     std::string pathSubfile = streamNomeGnomadChrDir.str();\n     read_file_cin( pathSubfile );\n   }\n}\n\nvoid first_column_cin( char &amp;separator, std::vector&lt;std::string&gt; &amp;vectorName) {\n    std::string line;\n    int lineCount = 0;\n    while(std::getline(std::cin, line)) {\n      std::string filename;\n      std::istringstream iss(line); \n      getline(iss, filename, separator); \n      vectorName.push_back(filename);\n      lineCount++;\n    }\n}\n\nvoid read_gnomad_index_cin( std::string &amp;nomeFile, char &amp;separator, std::vector&lt;std::string&gt; &amp;vectorName ) {\n    std::ifstream in(nomeFile.c_str());\n    std::streambuf *cinbuf = std::cin.rdbuf(); \n    std::cin.rdbuf(in.rdbuf());\n\n    first_column_cin( separator, vectorName );\n\n    std::cin.rdbuf(cinbuf); \n}\n\nvoid file_countline_cin() {\n    std::string line;\n    int lineCount = 0;\n    while(std::getline(std::cin, line)) lineCount++;\n    std::cout &lt;&lt; \"file has: \" &lt;&lt; lineCount &lt;&lt; \" rows.\" &lt;&lt; '\\n';\n}\nvoid read_file_cin( std::string &amp;nomeFile ) {\n    std::ifstream in(nomeFile.c_str());\n    std::streambuf *cinbuf = std::cin.rdbuf(); //save old buf\n    std::cin.rdbuf(in.rdbuf()); //redirect std::cin to in.txt!\n    file_countline_cin(); //call function\n    std::cin.rdbuf(cinbuf);   //reset to standard input again\n}\n\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n ) {\n  for( int i = 0 ; i &lt; n ; ++i ) vec.push_back( 0 + rand() % (3000 - 1 + 1)); //gli ultimi due num sono upper e lower range limits\n  sort( vec.begin(), vec.end() );\n}\n\nint generateRandInt( int l0, int u0 ) {\n  int n0 = l0 + rand() % (u0 - l0 + 1);\n  return n0;\n}\n</code></pre>\n\n<p>I then tried to speed up CIN (<a href=\"https://www.geeksforgeeks.org/fast-io-for-competitive-programming/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/fast-io-for-competitive-programming/</a>) with:</p>\n\n<pre><code>std::ios_base::sync_with_stdio(false);\nstd::cin.tie(NULL);\n</code></pre>\n\n<p>here the <strong>CIN.SPEED (v2)</strong> version:</p>\n\n<pre><code>void read_file_cin( std::string &amp;nomeFile );\nvoid read_gnomad_index_cin( std::string &amp;nomeFile, char &amp;separator, std::vector&lt;std::string&gt; &amp;vectorName );\n\n\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n );\nint generateRandInt( int l0, int u0 );\n\nstd::vector&lt;int&gt; sovrapposizioniVectorsInt( std::vector&lt;int&gt; &amp;v0, std::vector&lt;int&gt; &amp;v1 );\n\nint main() {\n\n  std::string pathGnomadChrIndex = \"/Volumes/enrico/gnomad/exomes/splitted_5c/ex_1_5c/chr_1/chr_1.txt\";\n  char separator = ',';\n  std::vector&lt;std::string&gt; vSubfileNames;\n\n  read_gnomad_index_cin(pathGnomadChrIndex, separator, vSubfileNames);\n\n  srand((unsigned)time(NULL));\n  int size0 = 10;\n  std::vector&lt;int&gt; v0;\n  populateVector(v0, size0);\n\n   std::vector&lt;std::string&gt; vSubfileNames2;\n   for (auto si : v0) vSubfileNames2.push_back(vSubfileNames[si]);\n\n   std::string gnomadSplitDir = \"/Volumes/enrico/gnomad/exomes/splitted_5c/ex_1_5c/chr_1/\";\n   for ( auto vi : vSubfileNames2 ) {\n     std::cout &lt;&lt; vi &lt;&lt; '\\n';\n     std::stringstream streamNomeGnomadChrDir;\n     streamNomeGnomadChrDir &lt;&lt; gnomadSplitDir &lt;&lt; vi;\n     std::string pathSubfile = streamNomeGnomadChrDir.str();\n     read_file_cin( pathSubfile );\n   }\n}\n\nvoid first_column_cin( char &amp;separator, std::vector&lt;std::string&gt; &amp;vectorName) {\n  /* SPEEDUP */\n  std::ios_base::sync_with_stdio(false);\n  std::cin.tie(NULL);\n  /* SPEEDUP */\n  std::string line;\n    int lineCount = 0;\n    while(std::getline(std::cin, line)) {\n      std::string filename;\n      std::istringstream iss(line); // string stream\n      getline(iss, filename, separator); // read first part up to comma, ignore the comma\n      vectorName.push_back(filename);\n      lineCount++;\n    }\n}\n\nvoid read_gnomad_index_cin( std::string &amp;nomeFile, char &amp;separator, std::vector&lt;std::string&gt; &amp;vectorName ) {\n  /* SPEEDUP */\n  std::ios_base::sync_with_stdio(false);\n  std::cin.tie(NULL);\n  /* SPEEDUP */\n    std::ifstream in(nomeFile.c_str());\n    std::streambuf *cinbuf = std::cin.rdbuf(); //save old buf\n    std::cin.rdbuf(in.rdbuf()); //redirect std::cin to in.txt!\n\n    first_column_cin( separator, vectorName ); //call function\n\n    std::cin.rdbuf(cinbuf);   //reset to standard input again\n}\n\nvoid file_countline_cin() {\n  /* SPEEDUP */\n  std::ios_base::sync_with_stdio(false);\n  std::cin.tie(NULL);\n  /* SPEEDUP */\n    std::string line;\n    int lineCount = 0;\n    while(std::getline(std::cin, line)) lineCount++;\n    std::cout &lt;&lt; \"file has: \" &lt;&lt; lineCount &lt;&lt; \" rows.\" &lt;&lt; '\\n';\n}\n\n\nvoid read_file_cin( std::string &amp;nomeFile ) {\n  /* SPEEDUP */\n  std::ios_base::sync_with_stdio(false);\n  std::cin.tie(NULL);\n  /* SPEEDUP */\n    std::ifstream in(nomeFile.c_str());\n    std::streambuf *cinbuf = std::cin.rdbuf(); //save old buf\n    std::cin.rdbuf(in.rdbuf()); //redirect std::cin to in.txt!\n\n    file_countline_cin(); //call function\n    std::cin.rdbuf(cinbuf);   //reset to standard input again\n}\n</code></pre>\n\n<p>I then tried with a version of mmap that munmapped() and close() the file that pushed all file content in a vector and then return the vector to analyze file (just counting newline in this test) content while it was munmap and closing the mmap and file.</p>\n\n<p>Here <strong>MMAP.VECTOR (v3):</strong></p>\n\n<pre><code>const char* map_file(const char* fname, size_t&amp; length);\n\nvoid mmap_file( std::string &amp;filename, std::vector&lt;char&gt; &amp;vFile);\n\nvoid  gnomadIndex( std::string &amp;nomeFileIndex,\n                    std::vector&lt;std::string&gt; &amp;vSubfileNames,\n                    std::vector&lt;int&gt; &amp;vSubfileStarts,\n                    std::vector&lt;int&gt; &amp;vSubfileStops,\n                    std::vector&lt;std::vector&lt;int&gt;&gt; &amp;vSubfilePosizioniVector\n                  );\nvoid gnomadSubfileAnalysis( std::string &amp;nomeFile );\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n );\nint generateRandInt( int l0, int u0 );\n\nint main() {\n\n      std::string gnomadSplitDir = \"/Volumes/enrico/gnomad/exomes/splitted_5c/\";\n      std::string nomeChr = \"1\";\n\n      std::stringstream streamNomeGnomadChrDir;\n      streamNomeGnomadChrDir &lt;&lt; gnomadSplitDir &lt;&lt; \"ex_\" &lt;&lt; nomeChr &lt;&lt; \"_5c/\" &lt;&lt; \"chr_\" &lt;&lt; nomeChr &lt;&lt; \"/\";\n      std::string pathGnomadChrDir = streamNomeGnomadChrDir.str();\n      std::stringstream streamNomeGnomadChrIndex;\n      streamNomeGnomadChrIndex &lt;&lt; pathGnomadChrDir &lt;&lt; \"chr_\" &lt;&lt; nomeChr &lt;&lt; \".txt\";\n      std::string pathGnomadChrIndex = streamNomeGnomadChrIndex.str();\n\n      std::vector&lt;std::string&gt; vSubfileNames;\n      std::vector&lt;int&gt; vSubfileStarts;\n      std::vector&lt;int&gt; vSubfileStops;\n      std::vector&lt;std::vector&lt;int&gt;&gt; vSubfilePosizioniVector;\n\n      gnomadIndex(pathGnomadChrIndex,\n                  vSubfileNames,\n                  vSubfileStarts,\n                  vSubfileStops,\n                  vSubfilePosizioniVector\n                );\n\n      std::vector&lt;std::string&gt; vGnomadSubfilePaths;\n\n\n     srand((unsigned)time(NULL));\n      int size0 = 10;\n      std::vector&lt;int&gt; v0;\n      populateVector(v0, size0);\n\n       std::vector&lt;std::string&gt; vSubfileNames2;\n       for (auto si : v0) vSubfileNames2.push_back(vSubfileNames[si]);\n\n      for ( int subCount = 0; subCount &lt; vSubfileNames2.size(); subCount++ ) {\n\n        std::stringstream streamNomeSubfileGnomad;\n        streamNomeSubfileGnomad &lt;&lt; pathGnomadChrDir &lt;&lt; vSubfileNames2[subCount];\n        std::string pathGnomadSubfile = streamNomeSubfileGnomad.str();\n\n        gnomadSubfileAnalysis(pathGnomadSubfile);\n      }\n\n}\n\nvoid gnomadSubfileAnalysis( std::string &amp;nomeFile ) {\n\n  std::vector&lt;char&gt; f;\n  mmap_file(nomeFile, f);\n\n  std::vector&lt;int&gt; v0;\n\n  for (int i=0; i&lt;f.size(); i++) if (f[i] == '\\n') v0.push_back(i);\n\n  std::cout &lt;&lt; \"subfile: \" &lt;&lt; nomeFile &lt;&lt; \", has: \" &lt;&lt; v0.size() &lt;&lt; \" rows in: \" &lt;&lt; f.size() &lt;&lt; \" bytes.\" &lt;&lt; '\\n';\n}\n\nvoid  gnomadIndex( std::string &amp;nomeFileIndex,\n                    std::vector&lt;std::string&gt; &amp;vSubfileNames,\n                    std::vector&lt;int&gt; &amp;vSubfileStarts,\n                    std::vector&lt;int&gt; &amp;vSubfileStops,\n                    std::vector&lt;std::vector&lt;int&gt;&gt; &amp;vSubfilePosizioniVector\n                  ) {\n\n\n  std::vector&lt;char&gt; f;\n  mmap_file(nomeFileIndex, f);\n  std::vector&lt;int&gt; v0;\n\n  v0.push_back(0); //la prima riga mi serve qui\n  for (int i=0; i&lt;f.size(); i++) {\n    if (f[i] == '\\n') v0.push_back(i+1);\n  }\n  v0.pop_back();\n\n  for (int nl = 0; nl &lt; v0.size(); nl++) {\n\n    int ncol = 0;\n\n    std::vector&lt;char&gt; vSubfile;\n    std::vector&lt;char&gt; vSubStart;\n    std::vector&lt;char&gt; vSubStop;\n    std::vector&lt;char&gt; vSubPos;\n    std::vector&lt;int&gt; vSubfilePosVector;\n\n    for( int start=v0[nl]; start&lt;v0[nl+1]; start++  ) {\n\n      if (f[start] == ',') ncol++;\n\n      if (ncol == 0) {\n        if ( f[start] != ',' ) {\n          vSubfile.push_back(f[start]);\n        }\n      }\n\n      if (ncol == 1) {\n        if ( f[start] != ',' ) {\n          vSubStart.push_back(f[start]);\n        }\n      }\n\n      if (ncol == 2) {\n        if ( f[start] != ',' ) {\n          vSubStop.push_back(f[start]);\n        }\n      }\n\n      if (ncol == 3) {\n        if ( f[start] != ',' ) {\n          if ( f[start] != ':' ) {\n            vSubPos.push_back(f[start]);\n          }\n          if ( f[start] == ':' || f[start] == '\\n' ) {\n\n              std::string subfilePosValue ( vSubPos.begin(), vSubPos.end() );\n              vSubPos.clear();\n\n              vSubfilePosVector.push_back( stoi(subfilePosValue) );\n              subfilePosValue.erase();\n            }\n          }\n        }\n      }\n\n  std::string subFileValue ( vSubfile.begin(), vSubfile.end() );\n  vSubfile.clear();\n  std::string subfileStartValue ( vSubStart.begin(), vSubStart.end() );\n  vSubStart.clear();\n  std::string subfileStopValue ( vSubStop.begin(), vSubStop.end() );\n  vSubStop.clear();\n\n  vSubfileNames.push_back( subFileValue );\n  vSubfileStarts.push_back( stoi( subfileStartValue ) );\n  vSubfileStops.push_back( stoi(subfileStopValue) );\n  vSubfilePosizioniVector.push_back( vSubfilePosVector );\n  }\n}\n\n\nvoid handle_error(const char* msg) {\n    perror(msg);\n    exit(255);\n}\n\nconst char* map_file(const char* fname, size_t&amp; length) {\n\n    int fd = open(fname, O_RDONLY);\n\n    if (fd == -1)\n        handle_error(\"open\");\n\n    struct stat sb;\n\n    if (fstat(fd, &amp;sb) == -1)\n        handle_error(\"fstat\");\n\n    length = sb.st_size;\n\n    const char* addr = static_cast&lt;const char*&gt;(mmap(NULL, length, PROT_READ, MAP_PRIVATE, fd, 0u));\n    if (addr == MAP_FAILED)\n        handle_error(\"mmap\");\n\n    return addr;\n}\n\n\n\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n ) {\n  for( int i = 0 ; i &lt; n ; ++i ) vec.push_back( 0 + rand() % (3000 - 1 + 1)); //gli ultimi due num sono upper e lower range limits\n  sort( vec.begin(), vec.end() );\n}\n\nint generateRandInt( int l0, int u0 ) {\n  int n0 = l0 + rand() % (u0 - l0 + 1);\n  return n0;\n}\n\n\nsize_t getFilesize(const char* filename) {\n    struct stat st;\n    stat(filename, &amp;st);\n    return st.st_size;\n}\n\n\nvoid mmap_file( std::string &amp;filename, std::vector&lt;char&gt; &amp;vFile) {\n    size_t filesize = getFilesize(filename.c_str());\n    int fd = open(filename.c_str(), O_RDONLY, 0);\n    assert(fd != -1);\n    void* mmappedData = mmap(NULL, filesize, PROT_READ, MAP_PRIVATE, fd, 0);\n    assert(mmappedData != MAP_FAILED);\n\n    const char* f = static_cast&lt;const char*&gt;(mmappedData);\n\n    for ( int i = 0; i &lt; filesize; i++ ) vFile.push_back(f[i]);\n\n    int rc = munmap(mmappedData, filesize);\n    assert(rc == 0);\n    close(fd);\n\n}\n</code></pre>\n\n<p>But I immediatedly saw it was slower, I thought it could be due to the further passage of filling the vector so I tried a version that counted newlines while mmap was open and then closed it.</p>\n\n<p><strong>MMAP.CLOSE (v4)</strong>:</p>\n\n<pre><code> const char* map_file(const char* fname, size_t&amp; length);\n\nvoid mmap_file( std::string &amp;filename, std::vector&lt;char&gt; &amp;vFile);\nint mmap_file_nlines( std::string &amp;filename );\nvoid  gnomadIndex( std::string &amp;nomeFileIndex,\n                    std::vector&lt;std::string&gt; &amp;vSubfileNames,\n                    std::vector&lt;int&gt; &amp;vSubfileStarts,\n                    std::vector&lt;int&gt; &amp;vSubfileStops,\n                    std::vector&lt;std::vector&lt;int&gt;&gt; &amp;vSubfilePosizioniVector\n                  );\nvoid gnomadSubfileAnalysis( std::string &amp;nomeFile );\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n );\nint generateRandInt( int l0, int u0 );\n\nint main() {\n\n      std::string gnomadSplitDir = \"/Volumes/enrico/gnomad/exomes/splitted_5c_text/\";\n      std::string nomeChr = \"1\";\n\n      std::stringstream streamNomeGnomadChrDir;\n      streamNomeGnomadChrDir &lt;&lt; gnomadSplitDir &lt;&lt; \"chr_\" &lt;&lt; nomeChr &lt;&lt; \"/\";\n      std::string pathGnomadChrDir = streamNomeGnomadChrDir.str();\n      std::stringstream streamNomeGnomadChrIndex;\n      streamNomeGnomadChrIndex &lt;&lt; pathGnomadChrDir &lt;&lt; \"chr_\" &lt;&lt; nomeChr &lt;&lt; \".txt\";\n      std::string pathGnomadChrIndex = streamNomeGnomadChrIndex.str();\n\n      std::vector&lt;std::string&gt; vSubfileNames;\n      std::vector&lt;int&gt; vSubfileStarts;\n      std::vector&lt;int&gt; vSubfileStops;\n      std::vector&lt;std::vector&lt;int&gt;&gt; vSubfilePosizioniVector;\n\n      gnomadIndex(pathGnomadChrIndex,\n                  vSubfileNames,\n                  vSubfileStarts,\n                  vSubfileStops,\n                  vSubfilePosizioniVector\n                );\n\n      std::vector&lt;std::string&gt; vGnomadSubfilePaths;\n\n\n      srand((unsigned)time(NULL));\n      int size0 = 10;\n      std::vector&lt;int&gt; v0;\n      populateVector(v0, size0);\n       std::vector&lt;std::string&gt; vSubfileNames2;\n       for (auto si : v0) vSubfileNames2.push_back(vSubfileNames[si]);\n\n      for ( int subCount = 0; subCount &lt; vSubfileNames2.size(); subCount++ ) {\n        std::stringstream streamNomeSubfileGnomad;\n        streamNomeSubfileGnomad &lt;&lt; pathGnomadChrDir &lt;&lt; vSubfileNames2[subCount];\n        std::string pathGnomadSubfile = streamNomeSubfileGnomad.str();\n        gnomadSubfileAnalysis(pathGnomadSubfile);\n      }\n\n}\n\nvoid gnomadSubfileAnalysis( std::string &amp;nomeFile ) {\n  int nLinee = mmap_file_nlines(nomeFile);\n\n  std::cout &lt;&lt; \"subfile: \" &lt;&lt; nomeFile &lt;&lt; \", has: \" &lt;&lt; nLinee &lt;&lt; \" rows\" &lt;&lt; '\\n';\n}\n\nvoid  gnomadIndex( std::string &amp;nomeFileIndex,\n                    std::vector&lt;std::string&gt; &amp;vSubfileNames,\n                    std::vector&lt;int&gt; &amp;vSubfileStarts,\n                    std::vector&lt;int&gt; &amp;vSubfileStops,\n                    std::vector&lt;std::vector&lt;int&gt;&gt; &amp;vSubfilePosizioniVector\n                  ) {\n\n  size_t length;\n  auto f = map_file(nomeFileIndex.c_str(), length);\n  auto l = f + length;\n  std::vector&lt;int&gt; v0;\n  v0.push_back(0); //la prima riga mi serve qui\n  for (int i=0; i&lt;length; i++) {\n    if (f[i] == '\\n') v0.push_back(i+1);\n  }\n  v0.pop_back();\n\n  for (int nl = 0; nl &lt; v0.size(); nl++) {\n\n    int ncol = 0;\n    std::vector&lt;char&gt; vSubfile;\n    std::vector&lt;char&gt; vSubStart;\n    std::vector&lt;char&gt; vSubStop;\n    std::vector&lt;char&gt; vSubPos;\n    std::vector&lt;int&gt; vSubfilePosVector;\n\n    for( int start=v0[nl]; start&lt;v0[nl+1]; start++  ) {\n      if (f[start] == ',') ncol++;\n      if (ncol == 0) {\n        if ( f[start] != ',' ) {\n          vSubfile.push_back(f[start]);\n        }\n      }\n      if (ncol == 1) {\n        if ( f[start] != ',' ) {\n          vSubStart.push_back(f[start]);\n        }\n      }\n      if (ncol == 2) {\n        if ( f[start] != ',' ) {\n          vSubStop.push_back(f[start]);\n        }\n      }\n      if (ncol == 3) {\n        if ( f[start] != ',' ) {\n          if ( f[start] != ':' ) {\n            vSubPos.push_back(f[start]);\n          }\n          if ( f[start] == ':' || f[start] == '\\n' ) {\n              std::string subfilePosValue ( vSubPos.begin(), vSubPos.end() );\n              vSubPos.clear();\n              vSubfilePosVector.push_back( stoi(subfilePosValue) );\n              subfilePosValue.erase();\n            }\n          }\n        }\n      }\n\n  std::string subFileValue ( vSubfile.begin(), vSubfile.end() );\n  vSubfile.clear();\n  std::string subfileStartValue ( vSubStart.begin(), vSubStart.end() );\n  vSubStart.clear();\n  std::string subfileStopValue ( vSubStop.begin(), vSubStop.end() );\n  vSubStop.clear();\n  vSubfileNames.push_back( subFileValue );\n  vSubfileStarts.push_back( stoi( subfileStartValue ) );\n  vSubfileStops.push_back( stoi(subfileStopValue) );\n  vSubfilePosizioniVector.push_back( vSubfilePosVector );\n  }\n}\n\nvoid handle_error(const char* msg) {\n    perror(msg);\n    exit(255);\n}\nconst char* map_file(const char* fname, size_t&amp; length) {\n\n    int fd = open(fname, O_RDONLY);\n    if (fd == -1)\n        handle_error(\"open\");\n    struct stat sb;\n    if (fstat(fd, &amp;sb) == -1)\n        handle_error(\"fstat\");\n    length = sb.st_size;\n\n    const char* addr = static_cast&lt;const char*&gt;(mmap(NULL, length, PROT_READ, MAP_PRIVATE, fd, 0u));\n    if (addr == MAP_FAILED)\n        handle_error(\"mmap\");\n    return addr;\n}\n\nvoid populateVector( std::vector&lt;int&gt; &amp;vec, int n ) {\n  for( int i = 0 ; i &lt; n ; ++i ) vec.push_back( 0 + rand() % (3000 - 1 + 1)); //gli ultimi due num sono upper e lower range limits\n  sort( vec.begin(), vec.end() );\n}\n\nint generateRandInt( int l0, int u0 ) {\n  int n0 = l0 + rand() % (u0 - l0 + 1);\n  return n0;\n}\n\nsize_t getFilesize(const char* filename) {\n    struct stat st;\n    stat(filename, &amp;st);\n    return st.st_size;\n}\n\nvoid mmap_file( std::string &amp;filename, std::vector&lt;char&gt; &amp;vFile) {\n    size_t filesize = getFilesize(filename.c_str());\n    int fd = open(filename.c_str(), O_RDONLY, 0);\n    assert(fd != -1);\n    void* mmappedData = mmap(NULL, filesize, PROT_READ, MAP_PRIVATE, fd, 0);\n    assert(mmappedData != MAP_FAILED);\n\n    const char* f = static_cast&lt;const char*&gt;(mmappedData);\n\n    for ( int i = 0; i &lt; filesize; i++ ) vFile.push_back(f[i]);\n    int rc = munmap(mmappedData, filesize);\n    assert(rc == 0);\n    close(fd);\n}\n\nint mmap_file_nlines( std::string &amp;filename ) {\n    size_t filesize = getFilesize(filename.c_str());\n    int fd = open(filename.c_str(), O_RDONLY, 0);\n    assert(fd != -1);\n    void* mmappedData = mmap(NULL, filesize, PROT_READ, MAP_PRIVATE, fd, 0);\n    assert(mmappedData != MAP_FAILED);\n\n    const char* f = static_cast&lt;const char*&gt;(mmappedData);\n    int lineCount =0 ;\n    for ( int i = 0; i &lt; filesize; i++ ) if( f[i] == '\\n' ) lineCount++;\n    int rc = munmap(mmappedData, filesize);\n    assert(rc == 0);\n    close(fd);\n\n    return lineCount;\n\n}\n</code></pre>\n\n<p>Here the means in seconds for 1000 tries with each approach:</p>\n\n<pre><code>          cin 0.983380\n    cin.speed 0.989011\n   mmap.close 2.863860\n    mmap.open 0.915395\n  mmap.vector 4.683976\n</code></pre>\n\n<p>I was someway surprised that the \"speed-up\" for CIN changed nothing, (maybe I got something wrong?) and that closing the file was so time consuming for mmap!</p>\n\n<p>Here the plot of the results.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hwY2Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hwY2Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any comments by more experts people are really welcomed!</p>\n\n<p>PS: my machine is a <em>iMac (Retina 5K, 27-inch, Late 2014), 4 GHz Intel Core i7, 16 GB 1600 MHz DDR3</em></p>\n"}, {"tags": ["c++", "mysql", "visual-studio"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1553697201, "post_id": 55379723, "comment_id": 97481607, "body": "Not that it matters, but why are you passing <code>x.c_str()</code> instead of just <code>x</code> to <code>mysql_query()</code> ?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1553697314, "post_id": 55379723, "comment_id": 97481702, "body": "Because, @TimBiegeleisen mysql_query() is a C library function that knows absolutely nothing whatsoever about C++ classes like <code>std::string</code>."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1553697481, "post_id": 55379723, "comment_id": 97481814, "body": "@SamVarshavchik I sort of suspected something like this.  So, do you have an answer here then?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1553697528, "post_id": 55379723, "comment_id": 97481852, "body": "An answer here, unfortunately, is not possible because the shown code fails to meet the requirements for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, as explained in stackoverflow.com&#39;s <a href=\"https://stackoverflow.com/help\">help center</a>."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 1, "creation_date": 1553697586, "post_id": 55379723, "comment_id": 97481904, "body": "at a guess <code>mysql_real_connect</code> is returning null"}], "answers": [{"tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": true, "score": 0, "last_activity_date": 1554107262, "creation_date": 1554107262, "answer_id": 55450844, "question_id": 55379723, "link": "https://stackoverflow.com/questions/55379723/how-to-do-a-sql-query-with-a-variable-in-c/55450844#55450844", "title": "How to do a sql_query with a variable in C++?", "body": "<p><code>mysql_real_connect</code> is probably returning null. You need to check whether the result is null then call <code>mysql_error</code> to discover the error code.</p>\n"}], "owner": {"reputation": 3, "user_id": 11260632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kDn7-6zzswo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfN4hcaaV2p83ZrC3gkU4AhYpv3aQ/mo/photo.jpg?sz=128", "display_name": "Hugo Saunier", "link": "https://stackoverflow.com/users/11260632/hugo-saunier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55450844, "answer_count": 1, "score": -1, "last_activity_date": 1554107262, "creation_date": 1553697012, "question_id": 55379723, "link": "https://stackoverflow.com/questions/55379723/how-to-do-a-sql-query-with-a-variable-in-c", "title": "How to do a sql_query with a variable in C++?", "body": "<p>I'm trying to get different values from my database dynamically so i need to put a variable in my mysql_query.</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n#include &lt;mysql.h&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n\nusing namespace std;\n\nMYSQL* ConnexionSql()\n{\n    MYSQL* conn;\n    conn = mysql_init(0);\n    conn = mysql_real_connect(conn, \"localhost\", \"root\", \"ADAI1819\", \"projetADAI\", 3306, NULL, 0);\n    return conn;\n}\n\nint NbCompo() //Without any variable this work perfectly\n{\n    MYSQL* conn = ConnexionSql();\n    MYSQL_RES *res_set;\n    MYSQL_ROW row;\n    mysql_query(conn, \"select NbCompo from Envoi\");\n    res_set = mysql_store_result(conn);\n    row = mysql_fetch_row(res_set);\n    string chaine = row[0];\n    int result = std::stoi(chaine);\n    return result;\n}\n\nint NbProduit(string x) //And here is my problem\n{\n    MYSQL* conn = ConnexionSql();\n    MYSQL_RES *res_set;\n    MYSQL_ROW row;\n\n    x = \"Select \" + x + \" from Envoi\";\n    mysql_query(conn, x.c_str());\n    res_set = mysql_store_result(conn);\n    row = mysql_fetch_row(res_set);\n    string chaine = row[0];\n    int result = std::stoi(chaine);\n    return result;\n}\n</code></pre>\n\n<p>It Build perfectly but when i run it i get this message \"Exception thrown at 0x00007FFFF7C1BD66 (libmysql.dll) in ProjectADAI.exe: 0xC0000005: Access Violation while reading location 0x0000000000000010.\" (it's a translation i'm french excuse my english).</p>\n"}, {"tags": ["c++", "floating-point", "language-lawyer"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1553697286, "post_id": 55379715, "comment_id": 97481677, "body": "In your example with a literal probably equal. However, I once fixed a bug in code using the x87 FPU in 32-bit mode where the code compared an 80-bit precision in-register version of the &quot;same number&quot; to its 64-bit double representation. The comparison failed of course."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1553697482, "post_id": 55379715, "comment_id": 97481815, "body": "Also, the general rule in floating point is that more precision is always better. If you want to compare floats always round both of them to whatever their useful precision is. Otherwise on future hardware with 256-bit floats or whatever, comparing one to a 64-bit float would be obviously wrong."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1553697634, "post_id": 55379715, "comment_id": 97481945, "body": "Beware that it&#39;s undefined behavior to read from any member of a union unless it was the last one written to. Since you last write to <code>convert.bits</code> the <code>expression n = convert.d;</code> is undefined behavior. Though I seem to remember that VC++ allows it as an extension."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1553697856, "post_id": 55379715, "comment_id": 97482113, "body": "Following Fran&#231;ois Andrieux comment, if you use <code>memcpy</code> you can copy the bit representation into a <code>content</code> in a portable way."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 2, "creation_date": 1553698376, "post_id": 55379715, "comment_id": 97482485, "body": "@Stack Danny No - that is still undefined behavoir as it breaks the strict aliasing rules. <code>memcpy</code> is the only real portable way to do this. (And all modern compilers should optimise it away)"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1553699017, "post_id": 55379715, "comment_id": 97482966, "body": "You&#39;ll get away with it as long as you use VS2017 and you don&#39;t expose the variables beyond module bounds, it no longer generates FPU code so you have little to fear from the optimizer.  That&#39;s not necessarily the case for older versions or different compilers."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1564998091, "post_id": 55380273, "comment_id": 101198862, "body": "&quot;IEEE-754 requires that non-NaN floats compare equal if and only if they have the same bit pattern.&quot;  - I don&#39;t think this is true; positive zero and negative zero are allowed to compare equal (I believe the IEEE754 standard recommends that languages&#39; equality operator should report <code>true</code> for such a comparison)."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1564999005, "post_id": 55380273, "comment_id": 101199318, "body": "@M.M Yeah you&#39;re right. This is one of the exceptions made by the standard. See chapter 5.11 in e.g. <a href=\"http://irem.univ-reunion.fr/IMG/pdf/ieee-754-2008.pdf\" rel=\"nofollow noreferrer\">irem.univ-reunion.fr/IMG/pdf/ieee-754-2008.pdf</a>."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 7, "last_activity_date": 1564999078, "last_edit_date": 1564999078, "creation_date": 1553698540, "answer_id": 55380273, "question_id": 55379715, "link": "https://stackoverflow.com/questions/55379715/is-assigning-two-doubles-guaranteed-to-yield-the-same-bitset-patterns/55380273#55380273", "title": "is assigning two doubles guaranteed to yield the same bitset patterns?", "body": "<p>The C++ standard clearly specifies  in <a href=\"http://eel.is/c++draft/basic.types#3\" rel=\"nofollow noreferrer\">[basic.types]#3</a>:</p>\n\n<blockquote>\n  <p>For any trivially copyable type <code>T</code>, if two pointers to <code>T</code> point to distinct <code>T</code> objects <code>obj1</code> and <code>obj2</code>, where neither <code>obj1</code> nor <code>obj2</code> is a potentially-overlapping subobject, if the underlying bytes ([intro.memory]) making up <code>obj1</code> are copied into <code>obj2</code>, <code>obj2</code> shall subsequently hold the same value as <code>obj1</code>.</p>\n</blockquote>\n\n<p>It gives this example:</p>\n\n<pre><code>T* t1p;\nT* t2p;\n// provided that t2p points to an initialized object ...\nstd::memcpy(t1p, t2p, sizeof(T));\n// at this point, every subobject of trivially copyable type in *t1p contains\n// the same value as the corresponding subobject in *t2p\n</code></pre>\n\n<p>The remaining question is what a <code>value</code> is. We find in <a href=\"http://eel.is/c++draft/basic.fundamental#12.sentence-4\" rel=\"nofollow noreferrer\">[basic.fundamental]#12</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>There are three floating-point types: <code>float</code>, <code>double</code>, and <code>long double</code>.\n  The type <code>double</code> provides at least as much precision as <code>float</code>, and the type <code>long double</code> provides at least as much precision as <code>double</code>.\n  The set of values of the type <code>float</code> is a subset of the set of values of the type <code>double</code>; the set of values of the type <code>double</code> is a subset of the set of values of the type <code>long double</code>.\n  <strong>The value representation of floating-point types is implementation-defined.</strong></p>\n</blockquote>\n\n<p>Since the C++ standard has no further requirements on how floating point values are represented, this is all you will find as guarantee from the standard, as assignment is only required to preserve <em>values</em> (<a href=\"http://eel.is/c++draft/expr.ass#2\" rel=\"nofollow noreferrer\">[expr.ass]#2</a>):</p>\n\n<blockquote>\n  <p>In simple assignment (<code>=</code>), the object referred to by the left operand is modified by replacing its value with the result of the right operand.</p>\n</blockquote>\n\n<p>As you correctly observed, IEEE-754 requires that non-NaN, non-zero floats compare equal if and only if they have the same bit pattern. So <strong>if your compiler uses IEEE-754-compliant floats, you should find that assignment of non-NaN, non-zero floating point numbers preserves bit patterns.</strong></p>\n\n<hr>\n\n<p>And indeed, your code</p>\n\n<pre><code>double a = 5.4;\ndouble b = a;\n</code></pre>\n\n<p>should never allow <code>(a == b)</code> to return false. But as soon as you replace <code>5.4</code> with a more complicated expression, most of this nicety vanishes. It's not the exact subject of the article, but <a href=\"https://randomascii.wordpress.com/2013/07/16/floating-point-determinism/\" rel=\"nofollow noreferrer\">https://randomascii.wordpress.com/2013/07/16/floating-point-determinism/</a> mentions several possible ways in which innocent looking code can yield different results (which breaks \"identical to the bit pattern\" assertions). In particular, you might be comparing an 80 bit intermediate result with a 64 bit rounded result, possibly yielding inequality.</p>\n"}, {"comments": [{"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 0, "creation_date": 1553758227, "post_id": 55384736, "comment_id": 97505142, "body": "I thought that the two questions are exchangeable as IEEE-754 says that equal == same bit pattern. Thanks for the answer, so as long as it stays at a simple assignment I should be fine to compare them using <code>==</code>."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1553788410, "post_id": 55384736, "comment_id": 97524464, "body": "I&#39;m pretty certain that if the architecture has FPU registers with higher precision and the compiler selects one for a variable, it can assign 80 bits or more from a literal. If a second variable is in 64-bit RAM, it will NOT be equal even if both use the same literal in code."}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1553846530, "post_id": 55384736, "comment_id": 97545026, "body": "@ZanLynx that&#39;s pretty interesting and also terrifying."}], "tags": [], "owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 3, "last_activity_date": 1553713447, "creation_date": 1553713447, "answer_id": 55384736, "question_id": 55379715, "link": "https://stackoverflow.com/questions/55379715/is-assigning-two-doubles-guaranteed-to-yield-the-same-bitset-patterns/55384736#55384736", "title": "is assigning two doubles guaranteed to yield the same bitset patterns?", "body": "<p>There are some complications here. First, note that the title asks a different question than the question. The title asks:</p>\n\n<blockquote>\n  <p>is assigning two doubles guaranteed to yield the same bitset patterns?</p>\n</blockquote>\n\n<p>while the question asks:</p>\n\n<blockquote>\n  <p>can a == b ever be false?</p>\n</blockquote>\n\n<p>The first of these asks whether different bits might occur from an assignment (which could be due to either the assignment not recording the same value as its right operand or due to the assignment using a different bit pattern that represents the same value), while the second asks whether, whatever bits are written by an assignment, the stored value must compare equal to the operand.</p>\n\n<p>In full generality, the answer to the first question is no. Using IEEE-754 binary floating-point formats, there is a one-to-one map between non-zero numeric values and their encodings in bit patterns. However, this admits several cases where an assignment could produce a different bit pattern:</p>\n\n<ul>\n<li>The right operand is the IEEE-754 \u22120 entity, but +0 is stored. This is not a proper IEEE-754 operation, but C++ is not required to conform to IEEE 754. Both \u22120 and +0 represent mathematical zero and would satisfy C++ requirements for assignment, so a C++ implementation could do this.</li>\n<li>IEEE-754 decimal formats have one-to-many maps between numeric values and their encodings. By way of illustration, three hundred could be represented with bits whose direct meaning is 3\u202210<sup>2</sup> or bits whose direct meaning is 300\u202210<sup>0</sup>. Again, since these represent the same mathematical value, it would be permissible under the C++ standard to store one in the left operand of an assignment when the right operand is the other.</li>\n<li>IEEE-754 includes many non-numeric entities called NaNs (for Not a Number), and a C++ implementation might store a NaN different from the right operand. This could include either replacing any NaN with a \u201ccanonical\u201d NaN for the implementation or, upon assignment of a signaling Nan, indicating the signal in some way and then converting the signaling NaN to a quiet NaN and storing that.</li>\n<li>Non-IEEE-754 formats may have similar issues.</li>\n</ul>\n\n<p>Regarding the latter question, can <code>a == b</code> be false after <code>a = b</code>, where both <code>a</code> and <code>b</code> have type <code>double</code>, the answer is no. The C++ standard does require that an assignment replace the value of the left operand with the value of the right operand. So, after <code>a = b</code>, <code>a</code> must have the value of <code>b</code>, and therefore they are equal.</p>\n\n<p>Note that the C++ standard does not impose any restrictions on the accuracy of floating-point operations (although I see this only stated in non-normative notes). So, theoretically, one might interpret assignment or comparison of floating-point values to be floating-point operations and say that they do not need to be accuracy, so the assignment could change the value or the comparison could return an inaccurate result. I do not believe this is a reasonable interpretation of the standard; the lack of restrictions on floating-point accuracy is intended to allow latitude in expression evaluation and library routines, not simple assignment or comparison.</p>\n\n<p>One should note the above applies specifically to a <code>double</code> object that is assigned from a simple <code>double</code> operand. This should not lull readers into complacency. Several similar but different situations can result in failure of what might seem intuitive mathematically, such as:</p>\n\n<ul>\n<li>After <code>float x = 3.4;</code>, the expression <code>x == 3.4</code> will generally evaluate as false, since <code>3.4</code> is a <code>double</code> and has to be converted to a <code>float</code> for the assignment. That conversion reduces precision and alters the value.</li>\n<li>After <code>double x = 3.4 + 1.2;</code>, the expression <code>x == 3.4 + 1.2</code> is permitted by the C++ standard to evaluate to false. This is because the standard permits floating-point expressions to be evaluated with more precision than the nominal type requires. Thus, <code>3.4 + 1.2</code> might be evaluated with the precision of <code>long double</code>. When the result is assigned to <code>x</code>, the standard requires that the excess precision be \u201cdiscarded,\u201d so the value is converted to a <code>double</code>. As with the <code>float</code> example above, this conversion may change the value. Then the comparison <code>x == 3.4 + 1.2</code> may compare a <code>double</code> value in <code>x</code> to what is essentially a <code>long double</code> value produced by <code>3.4 + 1.2</code>.</li>\n</ul>\n"}], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 1, "accepted_answer_id": 55380273, "answer_count": 2, "score": 5, "last_activity_date": 1564999078, "creation_date": 1553696998, "last_edit_date": 1555504317, "question_id": 55379715, "link": "https://stackoverflow.com/questions/55379715/is-assigning-two-doubles-guaranteed-to-yield-the-same-bitset-patterns", "title": "is assigning two doubles guaranteed to yield the same bitset patterns?", "body": "<p>There are several posts here about floating point numbers and their nature. It is clear that <a href=\"https://stackoverflow.com/questions/4915462/how-should-i-do-floating-point-comparison\">comparing floats and doubles</a> must always be done cautiously. <a href=\"https://stackoverflow.com/questions/4682889/is-floating-point-ever-ok\">Asking for equality</a> has also been discussed and the recommendation is clearly to stay away from it. </p>\n\n<p>But what if there is a direct assignement:</p>\n\n<pre><code>double a = 5.4;\ndouble b = a;\n</code></pre>\n\n<p>assumg <code>a</code> is any non-<a href=\"https://en.wikipedia.org/wiki/NaN\" rel=\"nofollow noreferrer\">NaN</a> value - can <code>a == b</code> ever be false?</p>\n\n<p>It seems that the answer is obviously no, yet I can't find any standard defining this behaviour in a C++ environment. <strong>IEEE-754 states that two floating point numbers with equal (non-NaN) bitset patterns are equal</strong>. Does it now mean that I can continue comparing my doubles this way without having to worry about maintainability? Do I have to worried about other compilers / operating systems and their implementation regarding these lines? Or maybe a compiler that optimizes some bits away and ruins their equality? </p>\n\n<p>I wrote a little program that generates and compares non-NaN random doubles forever - until it finds a case where <code>a == b</code> yields <code>false</code>. Can I compile/run this code anywhere and anytime in the future without having to expect a halt? (ignoring endianness and assuming sign, exponent and mantissa bit sizes / positions stay the same).</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;random&gt;\n\nstruct double_content {\n    std::uint64_t mantissa : 52;\n    std::uint64_t exponent : 11;\n    std::uint64_t sign : 1;\n};\nstatic_assert(sizeof(double) == sizeof(double_content), \"must be equal\");\n\n\nvoid set_double(double&amp; n, std::uint64_t sign, std::uint64_t exponent, std::uint64_t mantissa) {\n    double_content convert;\n    memcpy(&amp;convert, &amp;n, sizeof(double));\n    convert.sign = sign;\n    convert.exponent = exponent;\n    convert.mantissa = mantissa;\n    memcpy(&amp;n, &amp;convert, sizeof(double_content));\n}\n\nvoid print_double(double&amp; n) {\n    double_content convert;\n    memcpy(&amp;convert, &amp;n, sizeof(double));\n    std::cout &lt;&lt; \"sign: \" &lt;&lt; convert.sign &lt;&lt; \", exponent: \" &lt;&lt; convert.exponent &lt;&lt; \", mantissa: \" &lt;&lt; convert.mantissa &lt;&lt; \" --- \" &lt;&lt; n &lt;&lt; '\\n';\n}\n\nint main() {\n    std::random_device rd;\n    std::mt19937_64 engine(rd());\n    std::uniform_int_distribution&lt;std::uint64_t&gt; mantissa_distribution(0ull, (1ull &lt;&lt; 52) - 1);\n    std::uniform_int_distribution&lt;std::uint64_t&gt; exponent_distribution(0ull, (1ull &lt;&lt; 11) - 1);\n    std::uniform_int_distribution&lt;std::uint64_t&gt; sign_distribution(0ull, 1ull);\n\n    double a = 0.0;\n    double b = 0.0;\n\n    bool found = false;\n\n    while (!found){\n        auto sign = sign_distribution(engine);\n        auto exponent = exponent_distribution(engine);\n        auto mantissa = mantissa_distribution(engine);\n\n        //re-assign exponent for NaN cases\n        if (mantissa) {\n            while (exponent == (1ull &lt;&lt; 11) - 1) {\n                exponent = exponent_distribution(engine);\n            }\n        }\n        //force -0.0 to be 0.0\n        if (mantissa == 0u &amp;&amp; exponent == 0u) {\n            sign = 0u;\n        }\n\n\n        set_double(a, sign, exponent, mantissa);\n        b = a;\n\n        //here could be more (unmodifying) code to delay the next comparison\n\n        if (b != a) { //not equal!\n            print_double(a);\n            print_double(b);\n            found = true;\n        }\n    }\n}\n</code></pre>\n\n<p><em>using Visual Studio Community 2017 Version 15.9.5</em></p>\n"}, {"tags": ["c++", "gcc", "g++"], "comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 3, "creation_date": 1553697303, "post_id": 55379684, "comment_id": 97481692, "body": "Reading a <i>non-active</i> member of a union is and has always been undefined behavoir. See <a href=\"http://eel.is/c++draft/class.union#1\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 940, "user_id": 5840652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELL15.png?s=128&g=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/5840652/vinci"}, "edited": false, "score": 2, "creation_date": 1553697352, "post_id": 55379684, "comment_id": 97481726, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/union\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/union</a>  No need to open the standard, even cppreference tells you it&#39;s UB."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553697579, "post_id": 55379684, "comment_id": 97481896, "body": "<a href=\"https://stackoverflow.com/questions/2310483/purpose-of-unions-in-c-and-c\">This</a> answer isn&#39;t quite a dupe but its close enough to be relevant"}, {"owner": {"reputation": 53, "user_id": 11266883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-g0YQ1nF-Wf4/AAAAAAAAAAI/AAAAAAAAAPM/lIEq7M4NrdU/photo.jpg?sz=128", "display_name": "Wei LIU", "link": "https://stackoverflow.com/users/11266883/wei-liu"}, "edited": false, "score": 0, "creation_date": 1553697601, "post_id": 55379684, "comment_id": 97481916, "body": "Aha. Thank you all!"}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553697758, "post_id": 55379684, "comment_id": 97482020, "body": "And finally <a href=\"https://stackoverflow.com/questions/25664848/unions-and-type-punning\">this</a> is a dupe and has some relevant info."}, {"owner": {"reputation": 53, "user_id": 11266883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-g0YQ1nF-Wf4/AAAAAAAAAAI/AAAAAAAAAPM/lIEq7M4NrdU/photo.jpg?sz=128", "display_name": "Wei LIU", "link": "https://stackoverflow.com/users/11266883/wei-liu"}, "edited": false, "score": 0, "creation_date": 1553698484, "post_id": 55379684, "comment_id": 97482585, "body": "I&#39;ve updated the question with union usage removed. Still unexpected result. :("}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1553698707, "post_id": 55379684, "comment_id": 97482759, "body": "Huh, strange. The problem appears to disappear if you remove <code>__attribute__((noinline))</code> from <code>func</code>. Or if you remove call to <code>printx1x2(x1, x2)</code>."}, {"owner": {"reputation": 53, "user_id": 11266883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-g0YQ1nF-Wf4/AAAAAAAAAAI/AAAAAAAAAPM/lIEq7M4NrdU/photo.jpg?sz=128", "display_name": "Wei LIU", "link": "https://stackoverflow.com/users/11266883/wei-liu"}, "edited": false, "score": 0, "creation_date": 1553699015, "post_id": 55379684, "comment_id": 97482964, "body": "Yeah. I noticed that also. But I think my function call to <code>printx1x2</code> and the noinline attribute is perfectly legal. :)"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1553699099, "post_id": 55379684, "comment_id": 97483026, "body": "I think I see the UB :) Writing an answer."}, {"owner": {"reputation": 53, "user_id": 11266883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-g0YQ1nF-Wf4/AAAAAAAAAAI/AAAAAAAAAPM/lIEq7M4NrdU/photo.jpg?sz=128", "display_name": "Wei LIU", "link": "https://stackoverflow.com/users/11266883/wei-liu"}, "edited": false, "score": 0, "creation_date": 1553699391, "post_id": 55379684, "comment_id": 97483235, "body": "Wow! Highly appreciated!"}], "answers": [{"comments": [{"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553699977, "post_id": 55380631, "comment_id": 97483660, "body": "I think hi/low should just return a <code>uint32_t</code> which would fix this in (possibly? imo?) a more elegant way."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 0, "creation_date": 1553700090, "post_id": 55380631, "comment_id": 97483740, "body": "@MikeVine Technically, <code>uint32_t</code> would still result in promotion to <code>int</code> on systems with 64 bit int. But for these calculations, a 64 bit <code>int</code> would not overflow, so maybe it would be OK. I did mention that returning the larger type is an option. Whether it is more elegant is subjective. The user of the function might not necessarily always need the larger type for their purposes."}, {"owner": {"reputation": 53, "user_id": 11266883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-g0YQ1nF-Wf4/AAAAAAAAAAI/AAAAAAAAAPM/lIEq7M4NrdU/photo.jpg?sz=128", "display_name": "Wei LIU", "link": "https://stackoverflow.com/users/11266883/wei-liu"}, "edited": false, "score": 0, "creation_date": 1553700092, "post_id": 55380631, "comment_id": 97483745, "body": "You saved my life! Thanks for the highly compact and informative explanation!"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 7, "last_activity_date": 1553699636, "creation_date": 1553699636, "answer_id": 55380631, "question_id": 55379684, "link": "https://stackoverflow.com/questions/55379684/strange-behavior-between-g-8-and-earlier-versions/55380631#55380631", "title": "Strange behavior between g++-8 and earlier versions", "body": "<p>The problem (besides the union-punning in original example) is this expression:</p>\n\n<pre><code>myunion2(a).lo() * myunion2(b).hi();\n</code></pre>\n\n<p>The values of the operands are 65535 * 65535. The types of the operands are <code>uint16_t</code>.</p>\n\n<p>Arithmetic operations are not performed on types smaller than <code>int</code>. Smaller types are promoted first. Since <code>uint16_t</code> is smaller than <code>int</code>, and the range of values representable by <code>uint16_t</code> can be represented by <code>int</code>, those operands are promoted to <code>int</code>. But the operation 65535 * 65535 overflows <code>int</code>, which is a signed type. And signed overflow has undefined behaviour.</p>\n\n<p>Solution: Convert to larger unsigned before multiply (or return larger unsigned in the first place):</p>\n\n<pre><code>const uint32_t x1 = (unsigned)myunion2(a).hi() * myunion2(b).lo();\nconst uint32_t x2 = x1 + (unsigned)myunion2(a).lo() * myunion2(b).hi();\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11266883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-g0YQ1nF-Wf4/AAAAAAAAAAI/AAAAAAAAAPM/lIEq7M4NrdU/photo.jpg?sz=128", "display_name": "Wei LIU", "link": "https://stackoverflow.com/users/11266883/wei-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 55380631, "answer_count": 1, "score": 5, "last_activity_date": 1553699636, "creation_date": 1553696873, "last_edit_date": 1553698236, "question_id": 55379684, "link": "https://stackoverflow.com/questions/55379684/strange-behavior-between-g-8-and-earlier-versions", "title": "Strange behavior between g++-8 and earlier versions", "body": "<p>Recently while porting our application from gcc-5.3 to 8.2, we noticed a strange behavior that breaks our application. </p>\n\n<p>In short, it seems gcc-8.2 removed one of our \"if branch which compares 2 unsigned integers\" without even producing a warning.</p>\n\n<p>We tried g++ 5.3, g++ 7.4 and g++ 8.2 with the same compile options and only g++ 8.2 has this problem. Will show a short example below.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdint&gt;\n#include &lt;cstdlib&gt;\n#include &lt;cstring&gt;\n\nusing namespace std;\n\nstruct myunion {\n    myunion(uint32_t x) {\n        _data.u32 = x;\n    }\n    uint16_t hi() const { return _data.u16[1]; }\n    uint16_t lo() const { return _data.u16[0]; }\n    union {\n        uint16_t u16[2];\n        uint32_t u32;\n    } _data;\n};\n\n __attribute__((noinline)) void printx1x2(uint32_t x1, uint32_t x2) {\n    cout &lt;&lt; \"x1: \" &lt;&lt; x1 &lt;&lt; endl;\n    cout &lt;&lt; \"x2: \" &lt;&lt; x2 &lt;&lt; endl;\n}\n\n__attribute__((noinline)) int func(uint32_t a, uint32_t b) {\n    const uint32_t x1 = myunion(a).hi() * myunion(b).lo();\n    const uint32_t x2 = x1 + myunion(a).lo() * myunion(b).hi();\n    printx1x2(x1, x2);\n    int ret = 0;\n    if ( x2 &lt; x1 ) {\n        ret = 0x10000;\n    }\n    return ret;\n}\n\nint main(int argc, char** argv) {\n    cout &lt;&lt; func(4294967295, 4294917296) &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>The above code is compiled as below:</p>\n\n<pre><code>$ g++-7 --version\ng++-7 (GCC) 7.4.1 20181207\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n$ g++-7 -Wall -std=c++14 -O3 a.cxx -o 7.out\n$ ./7.out\nx1: 1018151760\nx2: 1018020689\n65536\n\n$ g++ --version\ng++ (GCC) 8.2.1 20181127\nCopyright (C) 2018 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n$ g++ -Wall -std=c++14 -O3 a.cxx -o 8.out\n$ ./8.out\nx1: 1018151760\nx2: 1018020689\n0\n</code></pre>\n\n<p>I'm expecting the output of <code>7.out</code> to be correct. </p>\n\n<p>Is this actually something UB ( undefined behavior ) or it can be a g++ bug?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Looks like removing the union access UB still processes unwanted results:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdint&gt;\n#include &lt;cstdlib&gt;\n#include &lt;cstring&gt;\n\nusing namespace std;\n\nstruct myunion2 {\n    myunion2(uint32_t x) {\n        _data = x;\n    }\n    uint16_t hi() const { return (uint16_t)((_data &amp; 0xFFFF0000) &gt;&gt; 16); }\n    uint16_t lo() const { return (uint16_t)((_data &amp; 0xFFFF)); }\n    uint32_t _data;\n};\n\n __attribute__((noinline)) void printx1x2(uint32_t x1, uint32_t x2) {\n    cout &lt;&lt; \"x1: \" &lt;&lt; x1 &lt;&lt; endl;\n    cout &lt;&lt; \"x2: \" &lt;&lt; x2 &lt;&lt; endl;\n}\n\n__attribute__((noinline)) int func(uint32_t a, uint32_t b) {\n    const uint32_t x1 = myunion2(a).hi() * myunion2(b).lo();\n    const uint32_t x2 = x1 + myunion2(a).lo() * myunion2(b).hi();\n    printx1x2(x1, x2);\n    int ret = 0;\n    if ( x2 &lt; x1 ) {\n        ret = 0x10000;\n    }\n    return ret;\n}\n\nint main(int argc, char** argv) {\n    cout &lt;&lt; func(4294967295, 4294917296) &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ g++-7 -Wall -std=c++14 -O3 a.cxx -o 7.out\n[2019-03-27 22:48:30][wliu@wliu-arch-vm1 ~/tests]\n$ ./7.out\nx1: 1018151760\nx2: 1018020689\n65536\n[2019-03-27 22:48:32][wliu@wliu-arch-vm1 ~/tests]\n$ g++ -Wall -std=c++14 -O3 a.cxx -o 8.out\n[2019-03-27 22:49:11][wliu@wliu-arch-vm1 ~/tests]\n$ ./8.out\nx1: 1018151760\nx2: 1018020689\n0\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1553696712, "post_id": 55379591, "comment_id": 97481298, "body": "There are almost no guaranties on the randomness of <code>rand()</code>. Your behavior may be due to the fact that <code>srand</code> is seeded with slightly larger values (the current time) each time you test. It might just be returning the seed on the first call each time, or something closely related to it."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1553697013, "post_id": 55379591, "comment_id": 97481489, "body": "you say &quot;the next generated random number is always bigger&quot; but you only look at <code>rand()%500</code>, hence you dont really know if the next number is bigger or smaller. <code>rand()</code> is known to be of poor quality and naively taking <code>%</code> is one way to observe that"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1553697036, "post_id": 55379591, "comment_id": 97481510, "body": "<code>time(NULL)</code> gives you the time in seconds as an integer, so if you call the program twice in the same second, you will get the same number twice. If you call it in the next second, you will get completely different numbers: <a href=\"https://ideone.com/McE7CD\" rel=\"nofollow noreferrer\">ideone.com/McE7CD</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1553697087, "post_id": 55379591, "comment_id": 97481542, "body": "moreover you seem to compare random numbers where each is generated with a different seed, where the seed have a strong relation. To get anything meaning full you would have to look at lots of random numbers generated from the same seed"}, {"owner": {"reputation": 1603, "user_id": 5879698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/564d578a2912894d68ed1f822ab5c9c4?s=128&d=identicon&r=PG&f=1", "display_name": "William D. Irons", "link": "https://stackoverflow.com/users/5879698/william-d-irons"}, "edited": false, "score": 2, "creation_date": 1553697250, "post_id": 55379591, "comment_id": 97481647, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/13445688/how-to-generate-a-random-number-in-c\" title=\"how to generate a random number in c\">stackoverflow.com/questions/13445688/&hellip;</a> ?"}, {"owner": {"reputation": 97, "user_id": 5882534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E97GU.png?s=128&g=1", "display_name": "bashburak", "link": "https://stackoverflow.com/users/5882534/bashburak"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1553753933, "post_id": 55379591, "comment_id": 97503398, "body": "I think my question have nothing to do with ill-formed main definiton @eerorika"}, {"owner": {"reputation": 97, "user_id": 5882534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E97GU.png?s=128&g=1", "display_name": "bashburak", "link": "https://stackoverflow.com/users/5882534/bashburak"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1553754245, "post_id": 55379591, "comment_id": 97503517, "body": "@mch As I already mentioned above, &quot;When I put `x = rand()%500; part in a loop ... it works properly&quot;. But the problem arises from execution of the program I guess."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1553759016, "post_id": 55379591, "comment_id": 97505487, "body": "@bashburak did you see the <code>+ i</code> in <code>srand(time(NULL) + i);</code> in my example? It will simulate 100 program calls each with a  1 second gap."}, {"owner": {"reputation": 97, "user_id": 5882534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E97GU.png?s=128&g=1", "display_name": "bashburak", "link": "https://stackoverflow.com/users/5882534/bashburak"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1553759790, "post_id": 55379591, "comment_id": 97505792, "body": "@mch it also works if you do not put +i in srand(rime(NULL)). It still works properly when you do with loops. Because execution happens one time only. Check here : <a href=\"https://ideone.com/Tkha11\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 2, "creation_date": 1553772976, "post_id": 55379591, "comment_id": 97513468, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13445688/how-to-generate-a-random-number-in-c\">How to generate a random number in C++?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 5882534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E97GU.png?s=128&g=1", "display_name": "bashburak", "link": "https://stackoverflow.com/users/5882534/bashburak"}, "is_accepted": false, "score": -1, "last_activity_date": 1553766924, "creation_date": 1553766924, "answer_id": 55394658, "question_id": 55379591, "link": "https://stackoverflow.com/questions/55379591/rand-function-generates-the-next-number-by-ascending-to-the-previous-number/55394658#55394658", "title": "rand() function generates the next number by ascending to the previous number", "body": "<p>Actually I found a way to solve my problem but still it might not be an answer to my question. \nAnyway the problem is not about <code>srand()</code> or <code>rand()</code> functions but it is about the function <code>time(NULL)</code>. Since I am trying to run this code on Windows, instead of using <code>time(NULL)</code> as a parameter for <code>srand()</code>, I used <code>GetTickCount()</code> and now it generates random numbers properly for each execution. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;windows.h&gt;\n\nusing namespace std;\n\nint main()\n{\n    srand(GetTickCount());\n\n    cout&lt;&lt;\"\\n Random Number : \"&lt;&lt;rand();\n\n    cout&lt;&lt;\"\\n\";\n    cin.get();\n    return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 5882534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E97GU.png?s=128&g=1", "display_name": "bashburak", "link": "https://stackoverflow.com/users/5882534/bashburak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553766924, "creation_date": 1553696616, "last_edit_date": 1553759990, "question_id": 55379591, "link": "https://stackoverflow.com/questions/55379591/rand-function-generates-the-next-number-by-ascending-to-the-previous-number", "title": "rand() function generates the next number by ascending to the previous number", "body": "<p>Please check code given below. The random number it generates for each execution is the increment of the previous generated number in the previous execution.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;cstdlib&gt;\n\nusing namespace std;\n\nint main()\n{\n    srand(time(NULL));\n\n    cout&lt;&lt;\"\\n Random Number : \"&lt;&lt;rand()&lt;&lt;endl;\n\n    cin.get();\n    return 1;\n}\n</code></pre>\n\n<p>Please executeit for 5-6 times and you will see that the random numbers are increasing for each execution and they are very close to each other.</p>\n\n<p>Note : Please use CodeBlocks or Visual studio to check it, not the online compilers.</p>\n"}, {"tags": ["c++", "gif", "maze", "fltk"], "comments": [{"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1553948880, "post_id": 55379424, "comment_id": 97580560, "body": "What is resized_buffer?  Is it a vector?  Have you used vector.reserve to set aside the space so it does not keep allocating?"}], "answers": [{"tags": [], "owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "is_accepted": false, "score": 0, "last_activity_date": 1553953566, "creation_date": 1553953566, "answer_id": 55432065, "question_id": 55379424, "link": "https://stackoverflow.com/questions/55379424/figuring-out-best-solution-for-a-maze-solver-with-animated-output/55432065#55432065", "title": "Figuring out best solution for a Maze solver, with animated output", "body": "<p>Whatever graphics package you use, the performance will be similar.  It depends on how you handle the internals.  For instance,</p>\n\n<ol>\n<li>If you write it to a buffer and BLT it to the screen, it would be faster than writing to the screen directly.</li>\n<li>If you only BLT on the paint event, it would be faster than forcing and update every time the screen data changes.</li>\n<li>If you preallocate the buffers then the system does not have to keep on reallocating whenever the buffer space runs out.</li>\n<li>Assuming that the space is preallocated, it can be written to without clearing first.  Every cell it going to be written to so no need to clear, allocate and and reallocate.</li>\n</ol>\n"}], "owner": {"reputation": 25, "user_id": 11067196, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zYrq78WtFgg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOgvVFm8q7mpS64sbVqdhzlY0Bi9w/mo/photo.jpg?sz=128", "display_name": "Kent Odde", "link": "https://stackoverflow.com/users/11067196/kent-odde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553953566, "creation_date": 1553696142, "last_edit_date": 1592644375, "question_id": 55379424, "link": "https://stackoverflow.com/questions/55379424/figuring-out-best-solution-for-a-maze-solver-with-animated-output", "title": "Figuring out best solution for a Maze solver, with animated output", "body": "<h1>Abstract</h1>\n<p>My ultimate goal is to use Fltk to take user inputs of pixels, display a generated maze (either my own, or fetch it from the website mentioned in the details), and then show the animated solution.</p>\n<p>This is what i've managed so far:\n<a href=\"https://giant.gfycat.com/VioletWelloffHatchetfish.webm\" rel=\"nofollow noreferrer\">https://giant.gfycat.com/VioletWelloffHatchetfish.webm</a></p>\n<h1>Details</h1>\n<p>I'm in my first c++/algorithm class of a bachelors in CE.</p>\n<p>As we've been learning about graphs, dijkstra etc. the last weeks i decided after watching Computerphile's video about Maze solving, to try to put the theory into &quot;practice&quot;.</p>\n<p>At first i wanted to output a maze from this site, <a href=\"http://hereandabove.com/maze/mazeorig.form.html\" rel=\"nofollow noreferrer\">http://hereandabove.com/maze/mazeorig.form.html</a>, with the plotted solution. I chose that walls and paths should be 1x1 pixel, to make it easier to make into a 2D-vector, and then a graph.</p>\n<p>This went well, and my program outputs a solved .png file, using dijkstra to find the shortest path.</p>\n<p>I then wanted to put the entire solution in an animated gif.</p>\n<p>This also works well. For each pixel it colors green/yellow, it passes an RGBA-vector to a gif-library, and in the end i end up with an animated step by step solution.</p>\n<p>I also for each RGBA-vector passed to the gif-library, scale it up first, using this function:</p>\n<pre><code>//Both the buffer and resized buffer are member variables, and for each //plotted pixel in the path it updates 'buffer', and in this function makes a //larger version of it to 'resized_buffer'\n// HEIGHT and WIDTH are the original size\n// nHeight and nWidth are the new size.\nbool Maze_IMG::resample(int nWidth, int nHeight)\n{\n    if (buffer.size() == 0) return false;\n        \n    resized_buffer.clear();\n    \n    \n    for (int i = 0; i &lt; nWidth * nHeight * 4; i++) resized_buffer.push_back(-1);\n\n    double scaleWidth = (double)nWidth / (double)WIDTH;\n    double scaleHeight = (double)nHeight / (double)HEIGHT;\n\n    for (int cy = 0; cy &lt; nHeight; cy++)\n    {\n        for (int cx = 0; cx &lt; nWidth; cx++)\n        {\n            int pixel = (cy * (nWidth * 4)) + (cx * 4);\n            int nearestMatch = (((int)(cy / scaleHeight) * (WIDTH * 4)) + ((int)(cx / scaleWidth) * 4));\n\n            resized_buffer[pixel] = buffer[nearestMatch];\n            resized_buffer[pixel + 1] = buffer[nearestMatch + 1];\n            resized_buffer[pixel + 2] = buffer[nearestMatch + 2];\n            resized_buffer[pixel + 3] = buffer[nearestMatch + 3];\n        }\n    }\n    return true;\n}\n</code></pre>\n<h1>Problems</h1>\n<p>The problem is that it takes a looong time to do this while scaling them up, even with &quot;small&quot; mazes at 50x50 pixels, when trying to scale them to say 300x300. I've spent a lot of time to make code as efficient and fast as possible, but after i added the scaling, stuff that used to take 10 minutes, now takes hours.</p>\n<p>In fltk i use the Fl_Anim_Gif-library to display animated gifs, but it wont load the maze gifs that has been scaled up (still troubleshooting this).</p>\n<h1>My real questions</h1>\n<p>Is it possible to improve the scaling function, so that it does not take forever? Or is this a totally wrong approach?</p>\n<p>Is it a stupid idea to try to display it as a gif in fltk, would it be easier to just draw it directly in fltk, or should i rather try to display the images one after another i fltk?</p>\n<p>I'm just familiarizing myself with fltk. Would it be easier now to use something like Qt instead. Would that be more beneficial in the long run as far as learning a GUI-library goes?</p>\n<p>I'm mainly doing this for learning, and to start building some sort of portfolio for when i graduate. Is it beneficial at all to make a gui for this, or is this a waste of time?</p>\n<p>Any thoughts or input would be greatly appreciated.</p>\n"}, {"tags": ["c++", "class", "c++98", "mbed"], "comments": [{"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1553696130, "post_id": 55379348, "comment_id": 97480910, "body": "If you&#39;re only reading, you are ok. You just have to make sure that you don&#39;t try to read while another thread tries to write. This is often refered to as read/write locks. The idea is that you can let as many threads as you want read at the same time, but as soon as one thread needs to write, you must stop all the reading before writing. <a href=\"https://en.cppreference.com/w/cpp/thread/shared_mutex\" rel=\"nofollow noreferrer\">std::shared_mutex</a> could be useful."}, {"owner": {"reputation": 3641, "user_id": 4400820, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-zJIsBHmva1w/AAAAAAAAAAI/AAAAAAAAAFA/VyUtonEauos/photo.jpg?sz=128", "display_name": "D. Ben Knoble", "link": "https://stackoverflow.com/users/4400820/d-ben-knoble"}, "edited": false, "score": 1, "creation_date": 1553705261, "post_id": 55379348, "comment_id": 97487061, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/40651592/use-mutex-or-not-in-a-concurrent-reading\">Use mutex or not in a concurrent reading</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24757, "user_id": 107642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/672b033bf66f18d40cff3278f12f8f90?s=128&d=identicon&r=PG", "display_name": "Jan Jongboom", "link": "https://stackoverflow.com/users/107642/jan-jongboom"}, "edited": false, "score": 0, "creation_date": 1553763819, "post_id": 55379571, "comment_id": 97507734, "body": "FYI, here is the Mutex documentation for Mbed OS 5: <a href=\"https://os.mbed.com/docs/mbed-os/v5.11/apis/mutex.html\" rel=\"nofollow noreferrer\">Mutex</a>."}], "tags": [], "owner": {"reputation": 21, "user_id": 11171211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/768a7f3016f87dc02a4798054ac60591?s=128&d=identicon&r=PG&f=1", "display_name": "aleci", "link": "https://stackoverflow.com/users/11171211/aleci"}, "is_accepted": false, "score": 1, "last_activity_date": 1553696570, "creation_date": 1553696570, "answer_id": 55379571, "question_id": 55379348, "link": "https://stackoverflow.com/questions/55379348/how-to-share-a-global-object-between-threads/55379571#55379571", "title": "How to share a global object between threads?", "body": "<p>This question is similar to <a href=\"https://stackoverflow.com/questions/40651592/use-mutex-or-not-in-a-concurrent-reading\">this one</a></p>\n\n<p>If all your threads will only read the variable then you don't need mutex (or similar), but if any thread performs a writing operation you should use mutex.</p>\n"}], "owner": {"reputation": 369, "user_id": 11056439, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g3tlsyx5lws/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPhBsyz7HoFGIxxeXVFJsyiV-BZPw/mo/photo.jpg?sz=128", "display_name": "Tryb Ghost", "link": "https://stackoverflow.com/users/11056439/tryb-ghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553696570, "creation_date": 1553695902, "last_edit_date": 1553696018, "question_id": 55379348, "link": "https://stackoverflow.com/questions/55379348/how-to-share-a-global-object-between-threads", "title": "How to share a global object between threads?", "body": "<p>I have created a class, which has many public functions, some which write data and some that only read data. </p>\n\n<p>It's required that I do this within 3 threads, I have no other option.</p>\n\n<p>I know if I accessed a shared resource just to read, then I don't have to protect, but I don't know if it is any different when I am using a function to read a private variable of the shared resource.</p>\n\n<p>E.g. I am trying to do...</p>\n\n<pre><code>globalObject.readColour();\n</code></pre>\n\n<p>which is a function that reads the colour of the global object. </p>\n\n<p>Does it mean that I have to secure the thread at this point, or is it okay to just read the value without any risks? </p>\n\n<p>I'm working on mbed, which supports c and c++98.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1553694661, "post_id": 55378782, "comment_id": 97479880, "body": "<code>std::unique_ptr&lt;std::unique_ptr&lt;int&gt;[]&gt;</code> is not a 2D matrix. You want <code>std::unique_ptr&lt;std::unique_ptr&lt;int[]&gt;[]&gt;</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1553694712, "post_id": 55378782, "comment_id": 97479912, "body": "<code>std::vector&lt;std::vector&lt;int&gt;&gt;</code> possibly wrapped in class. (and if wrapped, flat the vector and do index computation manually for cache friendly)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1553694791, "post_id": 55378782, "comment_id": 97479968, "body": "And you miss the initialization of inner (smart) pointers."}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 2, "creation_date": 1553694792, "post_id": 55378782, "comment_id": 97479970, "body": "You don&#39;t benefit from using <code>std::unique_ptr</code> in this case."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1553694828, "post_id": 55378782, "comment_id": 97479991, "body": "If you do this you might a well do <code>std::vector&lt;std::vector&lt;int&gt;&gt;</code> which would be better all round, though still not the most efficient solution."}, {"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "edited": false, "score": 1, "creation_date": 1553694913, "post_id": 55378782, "comment_id": 97480054, "body": "&quot;There are plenty ways to do this, but I decided not to go with returning the matrix by value for efficiency.&quot;  This assumption is wrong - please understand <i>return value optimization</i> and <i>guarenteed copy elision</i>.   <b>Morale here:</b> premature optimization is the root of all evil"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1553694939, "post_id": 55378782, "comment_id": 97480081, "body": "This may be a useful approach to consider: <a href=\"https://stackoverflow.com/questions/53038457/what-is-the-best-modern-c-approach-to-construct-and-manipulate-a-2d-array/53038618#53038618\" title=\"what is the best modern c approach to construct and manipulate a 2d array\">stackoverflow.com/questions/53038457/&hellip;</a>"}, {"owner": {"reputation": 319, "user_id": 9022303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f859bade263d222643ef6cfc2de9836d?s=128&d=identicon&r=PG&f=1", "display_name": "Elgirhath", "link": "https://stackoverflow.com/users/9022303/elgirhath"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1553694975, "post_id": 55378782, "comment_id": 97480106, "body": "@vahancho could you please explain why?"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 2, "creation_date": 1553695355, "post_id": 55378782, "comment_id": 97480369, "body": "Both copy-elision and move-semantics makes it better to use a plain <code>std::vector</code> here and return it by value."}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1553695981, "post_id": 55378782, "comment_id": 97480818, "body": "You are not allocating enough memory for a square matrix.  If you want a 4x4 matrix, you must allocate space for 16 integers = n*n."}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1553696166, "post_id": 55378782, "comment_id": 97480932, "body": "The call <code>matrix[i].get()[j]</code> does not make sense.  get() returns the managed object.  However, by incrementing the pointer first, <code>matrix[i]</code> before calling .get(), and then adding j to it, you are venturing into undefinfed beahvior.  The correct call is &#39;matrix.get()[n*i + j]`.  The managed object is a 1d array and should be treated as such."}], "answers": [{"comments": [{"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "edited": false, "score": 0, "creation_date": 1553695224, "post_id": 55378995, "comment_id": 97480288, "body": "The issue for perfomance with this solution is that it doesn&#39;t store the data contigously in memory."}], "tags": [], "owner": {"reputation": 1519, "user_id": 9373509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee85b2e77da0aaa34e30c9cf7749f2e1?s=128&d=identicon&r=PG&f=1", "display_name": "aafulei", "link": "https://stackoverflow.com/users/9373509/aafulei"}, "is_accepted": false, "score": 1, "last_activity_date": 1553694989, "creation_date": 1553694989, "answer_id": 55378995, "question_id": 55378782, "link": "https://stackoverflow.com/questions/55378782/how-to-initialize-a-matrix-in-a-function-and-return-it-efficiently-in-c/55378995#55378995", "title": "How to initialize a matrix in a function and return it efficiently in C++?", "body": "<p>Why not just make your life easier by</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>vector&lt;vector&lt;int&gt;&gt; generate (int m, int n)\n{\n    return vector&lt;vector&lt;int&gt;&gt;(m ,vector&lt;int&gt;(n));\n}\n\nint main()\n{\n    int m = 3, n = 4;\n    auto matrix = generate(m, n);  // a 3-by-4 matrix of zeros\n    return 0;\n}\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1519, "user_id": 9373509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee85b2e77da0aaa34e30c9cf7749f2e1?s=128&d=identicon&r=PG&f=1", "display_name": "aafulei", "link": "https://stackoverflow.com/users/9373509/aafulei"}, "edited": false, "score": 0, "creation_date": 1553695500, "post_id": 55379048, "comment_id": 97480470, "body": "It seems you are wrong with the order of arguments with <code>std::vector&lt;int&gt;(0, n*n)</code>."}, {"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "reply_to_user": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1553696408, "post_id": 55379048, "comment_id": 97481107, "body": "@Bob__ I have added you comment ...  as a comment :)"}], "tags": [], "owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "is_accepted": false, "score": 1, "last_activity_date": 1553696306, "last_edit_date": 1553696306, "creation_date": 1553695136, "answer_id": 55379048, "question_id": 55378782, "link": "https://stackoverflow.com/questions/55378782/how-to-initialize-a-matrix-in-a-function-and-return-it-efficiently-in-c/55379048#55379048", "title": "How to initialize a matrix in a function and return it efficiently in C++?", "body": "<p>Just rely on <em>guarenteed copy elision</em> or <em>return value optimization</em>:</p>\n\n<pre><code>std::vector&lt;int&gt; GenerateMatrix(const int &amp;n) {\n    return std::vector&lt;int&gt;(n*n, 0);//, 0 can be omitted (as elements will then be zero-initialized)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "is_accepted": false, "score": -2, "last_activity_date": 1553695898, "last_edit_date": 1553695898, "creation_date": 1553695222, "answer_id": 55379086, "question_id": 55378782, "link": "https://stackoverflow.com/questions/55378782/how-to-initialize-a-matrix-in-a-function-and-return-it-efficiently-in-c/55379086#55379086", "title": "How to initialize a matrix in a function and return it efficiently in C++?", "body": "<p>You are not allocating enough memory for your matrix.  Change this line:</p>\n\n<p><code>std::unique_ptr&lt;std::unique_ptr&lt;int&gt;[] &gt; matrix(new std::unique_ptr&lt;int&gt;[n*n]);</code></p>\n\n<p>Also, I would just use <code>i*n + j</code> for your accesses since you are really dealing with a 1D array:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nstd::unique_ptr&lt;std::unique_ptr&lt;int&gt;[] &gt; GenerateMatrix(const int &amp;n) {\n  std::unique_ptr&lt;std::unique_ptr&lt;int&gt;[] &gt; matrix(new std::unique_ptr&lt;int&gt;[n*n]);\n  for (int i = 0; i &lt; n; i++) {\n    for (int j = 0; j &lt; n; j++) {\n      matrix.get()[i*n+j] = 0;\n    }\n  }\n\n  return matrix;\n}\n\nint main() {\n  int n = 4;\n  auto matrix = GenerateMatrix(n);\n  for (int i = 0; i &lt; n; i++) {\n    for (int j = 0; j &lt; n; j++) {\n      std::cout&lt;&lt;matrix.get()[i*n+j]&lt;&lt;\" \";\n    }\n    std::cout&lt;&lt;std::endl;\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1553740001, "post_id": 55380528, "comment_id": 97500109, "body": "Or just <code>std::array&lt;std::array&lt;T, N&gt;, N&gt;</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1553740066, "post_id": 55380528, "comment_id": 97500121, "body": "Notice that your default value only is for <code>matrix[x][0]</code>, matrix[x][1] would be <code>0</code>."}], "tags": [], "owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "is_accepted": false, "score": 0, "last_activity_date": 1553699364, "creation_date": 1553699364, "answer_id": 55380528, "question_id": 55378782, "link": "https://stackoverflow.com/questions/55378782/how-to-initialize-a-matrix-in-a-function-and-return-it-efficiently-in-c/55380528#55380528", "title": "How to initialize a matrix in a function and return it efficiently in C++?", "body": "<p>You might create and initialize a matrix at compile time. For example:</p>\n\n<pre><code>template&lt;int RowCount, int ColumnCount, int DefaultValue = 0&gt;\nstruct Matrix\n{\n  static_assert(RowCount &gt;= 0 &amp;&amp; ColumnCount &gt;=0,\n                \"The number of rows and columns should be positive\");\n  struct Row\n  {\n    int column[ColumnCount] = { DefaultValue };\n  };\n  Row row[RowCount];\n};\n</code></pre>\n\n<p>And use it like:</p>\n\n<pre><code>Matrix&lt;2, 2, 33&gt; matrix;\nauto val = matrix.row[0].column[0]; // val == 33\nmatrix.row[0].column[0] = 55;\nval = matrix.row[0].column[0]; // val == 55\n</code></pre>\n\n<p>Beware the matrix dimensions, when refer to its elements by row and column.</p>\n"}], "owner": {"reputation": 319, "user_id": 9022303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f859bade263d222643ef6cfc2de9836d?s=128&d=identicon&r=PG&f=1", "display_name": "Elgirhath", "link": "https://stackoverflow.com/users/9022303/elgirhath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1553699364, "creation_date": 1553694405, "question_id": 55378782, "link": "https://stackoverflow.com/questions/55378782/how-to-initialize-a-matrix-in-a-function-and-return-it-efficiently-in-c", "title": "How to initialize a matrix in a function and return it efficiently in C++?", "body": "<p>My task is to generate a square matrix of zeros in a function and return it. There are plenty ways to do this, but I decided not to go with returning the matrix by value for efficiency. I went for a pointer approach like <a href=\"https://stackoverflow.com/a/8618617/9022303\">in this answer</a>, but since it requires manual cleaning memory (and also as far as I know it's better to use smart pointers), I decided to turn it into <code>std::unique_ptr</code>, but I can't get it to work. This is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nstd::unique_ptr&lt;std::unique_ptr&lt;int&gt;[] &gt; GenerateMatrix(const int &amp;n) {\n    std::unique_ptr&lt;std::unique_ptr&lt;int&gt;[] &gt; matrix(new std::unique_ptr&lt;int&gt;[n]);\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = 0; j &lt; n; j++) {\n            matrix[i].get()[j] = 0;\n        }\n    }\n\n    return matrix;\n}\n\nint main() {\n    int n = 4;\n    auto matrix = GenerateMatrix(n);\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = 0; j &lt; n; j++) {\n            std::cout&lt;&lt;matrix[j].get()[i]&lt;&lt;\" \";\n        }\n        std::cout&lt;&lt;std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>What do I do wrong here? Is this approach even correct?</p>\n"}, {"tags": ["c++", "qt", "qtreewidget"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1553694558, "post_id": 55378540, "comment_id": 97479795, "body": "Maybe consider using <code>QFontMetrics::elidedText()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1553705718, "creation_date": 1553705718, "answer_id": 55382647, "question_id": 55378540, "link": "https://stackoverflow.com/questions/55378540/how-to-align-the-text-in-qtreewidget-column-in-this-manner-qtreewidgetitem/55382647#55382647", "title": "How to align the text in qtreewidget column in this manner : &quot;...qtreewidgetitemdata&quot; instead of &quot;qtreewidgetitemdata...&quot;?", "body": "<p>You have to establish the elide mode with a delegate:</p>\n\n<pre><code>#include &lt;QtWidgets&gt;\n\nclass ElideLeftDelegate: public QStyledItemDelegate\n{\npublic:\n    using QStyledItemDelegate::QStyledItemDelegate;\nprotected:\n    void initStyleOption(QStyleOptionViewItem *option, const QModelIndex &amp;index) const{\n        QStyledItemDelegate::initStyleOption(option, index);\n        option-&gt;textElideMode = Qt::ElideLeft;\n    }\n};\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    QTreeWidget w;\n    w.setItemDelegateForColumn(0, new ElideLeftDelegate{&amp;w});\n    w.setColumnCount(2);\n    new QTreeWidgetItem(&amp;w, {\"abcdefghijklmnopqrdstuvwxyz\", \"AVCDEFGHIJKLMNOPQRSTUVWXYZ\"});\n    new QTreeWidgetItem(&amp;w, {\"AVCDEFGHIJKLMNOPQRSTUVWXYZ\", \"abcdefghijklmnopqrdstuvwxyz\"});\n    w.show();\n    return a.exec();\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/618cI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/618cI.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 11123038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665035837620acc15cf822671768ae0d?s=128&d=identicon&r=PG&f=1", "display_name": "annie5", "link": "https://stackoverflow.com/users/11123038/annie5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 55382647, "answer_count": 1, "score": 1, "last_activity_date": 1553705718, "creation_date": 1553693710, "question_id": 55378540, "link": "https://stackoverflow.com/questions/55378540/how-to-align-the-text-in-qtreewidget-column-in-this-manner-qtreewidgetitem", "title": "How to align the text in qtreewidget column in this manner : &quot;...qtreewidgetitemdata&quot; instead of &quot;qtreewidgetitemdata...&quot;?", "body": "<p>How to align data in column 1 of qtreewidget in this manner:</p>\n\n<pre><code>|Column1 |Column2|\n|+...abcd|efgh   |\n|+...ijkl|mnop   |\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>|Column1 |Column2|\n|+xyab...|efgh   |\n|+pqij...|mnop   |\n</code></pre>\n"}, {"tags": ["c++", "dll", "com"], "comments": [{"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1553693750, "post_id": 55378416, "comment_id": 97479213, "body": "Hopefully someone knows a better way. But if not you could possibly approach it like I believe the debugger does when showing stack traces etc., even without pdb. On Windows / COM the <code>vtable</code> layout for virtual C++ methods is well defined (allowing other compilers, MSVC,GCC,Intel,etc. even languages to use them). Get the actual implementation address of a function and you can find which module owns that code segment (assuming no runtime code gen) using <code>VirtualQuery</code> and the <code>AllocationBase</code>."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1553694646, "post_id": 55378416, "comment_id": 97479865, "body": "If the author of the COM component did it right then there is no way to get that DLL loaded if you guessed at the wrong version since CoCreateInstance() and/or QueryInterface() won&#39;t work.  If he didn&#39;t do it right then only God can help you.  Hopefully he answers the phone."}, {"owner": {"reputation": 11788, "user_id": 2360169, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/x8M06.jpg?s=128&g=1", "display_name": "Michael Gunter", "link": "https://stackoverflow.com/users/2360169/michael-gunter"}, "edited": false, "score": 0, "creation_date": 1553705816, "post_id": 55378416, "comment_id": 97487363, "body": "If you have the CLSID handy, you might be able to look in the registry for the path, and then get the version number from the file on disk."}], "owner": {"reputation": 3, "user_id": 2433499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4f5332868d231d66e329a42ee4b6aa?s=128&d=identicon&r=PG", "display_name": "Craftiii4", "link": "https://stackoverflow.com/users/2433499/craftiii4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553693339, "creation_date": 1553693339, "question_id": 55378416, "link": "https://stackoverflow.com/questions/55378416/get-versioning-information-of-a-dll-loaded-through-com-c", "title": "Get versioning information of a DLL loaded through COM c++", "body": "<p>I have an external DLL that has to be loaded as a CComPtr. It contains multiple interfaces but the content of these interfaces can change between versions of the DLL. </p>\n\n<p>Is it possible to determine the version of the DLL that was loaded? After calling the CoCreateInstance the DLL then appears in Visual Studios 'Modules' tab (which contains the version), but I'm unsure how to get this information programmatically. AfxGetModuleState does not seem to contain any information about the DLL. </p>\n\n<p>I've looked at <a href=\"https://docs.microsoft.com/en-us/windows/desktop/psapi/enumerating-all-modules-for-a-process\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/psapi/enumerating-all-modules-for-a-process</a> but none of these appear to be the module/dll I am looking for. </p>\n\n<p>Any help or suggestions would be appreciated.\nThanks</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1553693033, "post_id": 55378280, "comment_id": 97478746, "body": "C or C++?  <code>#include &lt;iostream&gt;</code> and <code>operator[]</code> are both C++, but you tagged the question C.  Which is it?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553693594, "post_id": 55378280, "comment_id": 97479114, "body": "<code>char nom</code> is a single character not a string. I&#39;d recommend getting a good C programming book, you can&#39;t learn by trial &amp; error."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1553693688, "post_id": 55378280, "comment_id": 97479165, "body": "Don&#39;t mix apples and oranges. <code>stdio.h</code> is a C header file. <code>iostream</code> is a C++ header file. Restrict yourself to one language as the two are quite different."}, {"owner": {"reputation": 43, "user_id": 10835731, "user_type": "registered", "profile_image": "https://graph.facebook.com/2022364254545023/picture?type=large", "display_name": "Ghaith Zghidi", "link": "https://stackoverflow.com/users/10835731/ghaith-zghidi"}, "edited": false, "score": 0, "creation_date": 1553693785, "post_id": 55378280, "comment_id": 97479234, "body": "sorry guys miss click its c++"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10835731, "user_type": "registered", "profile_image": "https://graph.facebook.com/2022364254545023/picture?type=large", "display_name": "Ghaith Zghidi", "link": "https://stackoverflow.com/users/10835731/ghaith-zghidi"}, "edited": false, "score": 0, "creation_date": 1553694003, "post_id": 55378585, "comment_id": 97479381, "body": "Thanks im a beginner in c++ and im learning by my self so i face many problems i usually google the problem and i get the solution but not this time however thank you"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1553694142, "last_edit_date": 1553694142, "creation_date": 1553693825, "answer_id": 55378585, "question_id": 55378280, "link": "https://stackoverflow.com/questions/55378280/is-there-a-way-to-fix-this-error-no-match-for-operator-operand-types-are/55378585#55378585", "title": "Is there a way to fix this error : no match for &#39;operator[]&#39; (operand types are &#39;empl&#39; and &#39;int&#39;)", "body": "<p>There are many issues in your code.</p>\n\n<p>Starting reading a good C textbook is advised.</p>\n\n<p>You probably want this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n\nstruct empl {\n  char nom[30];\n  char pre[30];\n  float salaire;\n  double cin;\n}empl;\n\nstruct empl t[50];\nstruct empl E;\n\nint taille(int &amp; n)\n{\n  printf(\"saisie la taille de tableaux\\n\");\n  scanf(\"%d\", &amp;n);\n  return 0;\n}\n\nvoid remplire(int n, struct empl *t)\n{\n  for (int i = 0; i &lt; n; i++)\n  {\n    printf(\"t[%d].nom= \", i);\n    scanf(\"%s\", &amp;t[i].nom);\n    printf(\"t[%d].prenom= \", i);\n    scanf(\"%s\", &amp;t[i].pre);\n    printf(\"t[%d].salaire= \", i);\n    scanf(\"%f\", &amp;t[i].salaire);\n    printf(\"t[%d].CIN= \", i);\n    scanf(\"%lf\", &amp;t[i].cin);\n  }\n}\n\nint main()\n{\n  int n;\n  taille(n);\n  remplire(n, t);\n}\n</code></pre>\n\n<p>It's still poor code and it's written mostly in C style, but it compiles and works as intended.</p>\n\n<p>In C++ you'd do this totally differently.</p>\n"}, {"tags": [], "owner": {"reputation": 652, "user_id": 11224588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2898ec4197f20a99d75710d96ad85c3?s=128&d=identicon&r=PG&f=1", "display_name": "Diodacus", "link": "https://stackoverflow.com/users/11224588/diodacus"}, "is_accepted": false, "score": 2, "last_activity_date": 1553693856, "creation_date": 1553693856, "answer_id": 55378598, "question_id": 55378280, "link": "https://stackoverflow.com/questions/55378280/is-there-a-way-to-fix-this-error-no-match-for-operator-operand-types-are/55378598#55378598", "title": "Is there a way to fix this error : no match for &#39;operator[]&#39; (operand types are &#39;empl&#39; and &#39;int&#39;)", "body": "<p>First of all <code>iostream</code> is C++ header coming from standard library and will not work for C program. And now issues:</p>\n\n<pre><code>int taille (int n)\n{\n  printf(\"saisie la taille de tableaux\\n\");\n  scanf(\"%d\\n\",&amp;n);\n  return 0;\n}\n</code></pre>\n\n<p>This function is called with an input parameter - that means you can pass a value into a function, but not access the parameter and hope it will be used in other places. To correct this you should declare the function should look like this:</p>\n\n<pre><code>int taille (int * n)\n{\n  printf(\"saisie la taille de tableaux\\n\");\n  scanf(\"%d\\n\", n);\n  return 0;\n}\n</code></pre>\n\n<p>Next function - similar problem, it should look like this:</p>\n\n<pre><code>int remplire (int n , struct empl * t ,int i)\n{\n  for (i=1;i&lt;=n;i++)\n  {\n    printf(\"t[%d].nom= \",i);\n    scanf(\"%s\\n\",&amp;t[i].nom);\n    printf(\"t[%d].prenom= \",i);\n    scanf(\"%s\\n\",&amp;t[i].pre);\n    printf(\"t[%d].salaire= \",i);\n    scanf(\"%f\\n\",&amp;t[i].salaire);\n    printf(\"t[%d].CIN= \",i);\n    scanf(\"%lf\\n\",&amp;t[i].cin);\n  }\n}\n</code></pre>\n\n<p>Or even like this:</p>\n\n<pre><code>int remplire (int n , int i)\n</code></pre>\n\n<p>as <code>t</code> is global variable. Also this function should return some value as it is declared to return <code>int</code>.</p>\n\n<p>And now the <code>main</code> function:</p>\n\n<pre><code>int main()\n{       \n  int i,n;\n  int taille(int n),\n      taille(n);\n  int remplire(int n,struct empl t,int i);\n  remplire(n,t,i);\n}\n</code></pre>\n\n<p>Don't redeclare functions inside another function, even if it is permissible it does not mean you should do it. Also main function should return 0 if everything works fine. To correct the function write it like this:</p>\n\n<pre><code>int main()\n{       \n  int i,n;\n  taille(&amp; n);\n  remplire(n,&amp; t,i);\n}\n</code></pre>\n\n<p>Some good advice, please read some books to learn how to program in C if you want to go that way.</p>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1553693857, "creation_date": 1553693857, "answer_id": 55378600, "question_id": 55378280, "link": "https://stackoverflow.com/questions/55378280/is-there-a-way-to-fix-this-error-no-match-for-operator-operand-types-are/55378600#55378600", "title": "Is there a way to fix this error : no match for &#39;operator[]&#39; (operand types are &#39;empl&#39; and &#39;int&#39;)", "body": "<p>You've declared this global array variable <code>t</code></p>\n\n<pre><code>struct empl t[50];\n</code></pre>\n\n<p>and also declared a parameter <code>t</code> in this function</p>\n\n<pre><code>int remplire (int n , struct empl t ,int i)\n</code></pre>\n\n<p>Inside the function it's going to treat any instance of <code>t</code> as to be the parameter as that is nearer in scope than the global variable. So when you have code like this...</p>\n\n<pre><code>scanf(\"%s\\n\",&amp;t[i].nom);\n</code></pre>\n\n<p>...it's going to throw up errors because <code>t</code> isn't an array.</p>\n\n<p>The solution is to use variable names that have meaning like \"employee_array\" rather than single letters.</p>\n\n<p>Also that call to <code>scanf</code> is wrong as for strings you don't need to pass in a pointer to the variable, so it should look like</p>\n\n<pre><code>scanf(\"%s\\n\",t[i].nom);\n</code></pre>\n\n<p>But you'd also need to make <code>nom</code> be a string too - currently it's only a char.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1553699209, "last_edit_date": 1553699209, "creation_date": 1553694064, "answer_id": 55378676, "question_id": 55378280, "link": "https://stackoverflow.com/questions/55378280/is-there-a-way-to-fix-this-error-no-match-for-operator-operand-types-are/55378676#55378676", "title": "Is there a way to fix this error : no match for &#39;operator[]&#39; (operand types are &#39;empl&#39; and &#39;int&#39;)", "body": "<p>Although your code is written mostly in C style, you seem to be compiling it with a C++ compiler, as it accepts <code>#include &lt;iostream&gt;</code> (though you do not appear to use anything from it), and it has a notion of operator overloading.  C and C++ are distinct languages, and the distinction is somewhat relevant here.</p>\n\n<p>In either language, however, the code you have presented is flawed.  The problem is with the several expressions in function <code>remplire</code> that follow this pattern: <code>&amp;t[i].nom</code>.  Absent any operator overloading (which is not available in C anyway), the <code>[]</code> operator in those expressions requires one of its operands to designate either a pointer or an array, and the other to designate an integer.  Although there is a file-scope variable <code>t</code> that is an array, inside <code>remplire()</code> that is <em>shadowed</em> by a function parameter with the same name.  Inside that function, then, <code>t</code> refers the the parameter, which is a <code>struct empl</code>, not an array or pointer (or integer).</p>\n\n<p>Your compiler ought to be giving you another clue, too, where you <em>call</em> that function ...</p>\n\n<blockquote>\n<pre><code>    remplire(n,t,i);\n</code></pre>\n</blockquote>\n\n<p>..., passing the global <code>t</code> as an argument. The compiler very much should complain about a type mismatch between the second argument (<code>t</code>) and the corresponding function parameter.</p>\n\n<p>Perhaps what you wanted to do is simply to declare <code>remplire()</code> to accept a structure <em>pointer</em> as its second parameter:</p>\n\n<pre><code>int remplire(int n, struct empl *t, int i)\n</code></pre>\n\n<p>While you're at it, do remove the redundant local declaration of that function inside <code>main()</code>.  You don't need that as long as <code>remplire()</code> is defined before <code>main()</code>, and if you want to have a separate declaration of that function then it would best be placed at file scope, and probably in a header file.</p>\n"}], "owner": {"reputation": 43, "user_id": 10835731, "user_type": "registered", "profile_image": "https://graph.facebook.com/2022364254545023/picture?type=large", "display_name": "Ghaith Zghidi", "link": "https://stackoverflow.com/users/10835731/ghaith-zghidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1792, "favorite_count": 0, "accepted_answer_id": 55378676, "answer_count": 4, "score": -3, "last_activity_date": 1616955992, "creation_date": 1553692962, "last_edit_date": 1616955992, "question_id": 55378280, "link": "https://stackoverflow.com/questions/55378280/is-there-a-way-to-fix-this-error-no-match-for-operator-operand-types-are", "title": "Is there a way to fix this error : no match for &#39;operator[]&#39; (operand types are &#39;empl&#39; and &#39;int&#39;)", "body": "<p>Im getting homework done but i faced this problem i tried everything changing variables name, changing function ....\nI looked into this problem on google still no idea how to fix this error.</p>\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;iostream&gt;\n\nstruct empl {\n    char nom;\n    char pre;\n    float salaire;\n    double cin;\n}empl;\nstruct empl t[50];\nstruct empl E;\n\nint taille(int n)\n{\n    printf(&quot;saisie la taille de tableaux\\n&quot;);\n    scanf(&quot;%d\\n&quot;, &amp;n);\n    return 0;\n}\n\nint remplire(int n, struct empl t, int i)\n\n{\n    for (i = 1; i &lt;= n; i++)\n    {\n        printf(&quot;t[%d].nom= &quot;, i);\n        scanf(&quot;%s\\n&quot;, &amp;t[i].nom);\n        printf(&quot;t[%d].prenom= &quot;, i);\n        scanf(&quot;%s\\n&quot;, &amp;t[i].pre);\n        printf(&quot;t[%d].salaire= &quot;, i);\n        scanf(&quot;%f\\n&quot;, &amp;t[i].salaire);\n        printf(&quot;t[%d].CIN= &quot;, i);\n        scanf(&quot;%lf\\n&quot;, &amp;t[i].cin);\n    }\n}\nint main()\n{\n    int i, n;\n    int taille(int n),\n        taille(n);\n    int remplire(int n, struct empl t, int i);\n    remplire(n, t, i);\n}\n</code></pre>\n"}, {"tags": ["c++", "object", "initialization"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 6, "creation_date": 1553692792, "post_id": 55378196, "comment_id": 97478578, "body": "<code>WayPointStack wps = *(new WayPointStack());</code> Wonderful! (sarcasm). Please, read this: <a href=\"https://stackoverflow.com/q/6500313/5470596\">stackoverflow.com/q/6500313/5470596</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 7, "creation_date": 1553692818, "post_id": 55378196, "comment_id": 97478597, "body": "Sounds like a possible rule of three violation, or a bug in your special member functions.  Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1553692928, "post_id": 55378196, "comment_id": 97478681, "body": "<code>WayPointStack wps = *(new WayPointStack());</code> What&#39;s wrong with simple <code>WayPointStack wps;</code>?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1553692939, "post_id": 55378196, "comment_id": 97478691, "body": "@NathanOliver indeed, if <code>WayPointStack::~WayPointStack()</code> <code>delete</code>s <code>_wp</code>, there&#39;s UB right here <code>WayPointStack wps = *(new WayPointStack());</code>. (well, there&#39;s potential for UB)"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1553693039, "post_id": 55378196, "comment_id": 97478752, "body": "also <code>return *(new WPCommand(_END, 10000));</code>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553693279, "post_id": 55378196, "comment_id": 97478927, "body": "oh, that code comes from an other question : <a href=\"https://stackoverflow.com/questions/55375221/parsing-array-in-library-constructor-pointer-problem-c\" title=\"parsing array in library constructor pointer problem c\">stackoverflow.com/questions/55375221/&hellip;</a>"}, {"owner": {"reputation": 467, "user_id": 9236660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d9baf27175b35aa23984ed4fb4f3b6?s=128&d=identicon&r=PG&f=1", "display_name": "Kruspe", "link": "https://stackoverflow.com/users/9236660/kruspe"}, "edited": false, "score": 0, "creation_date": 1553693286, "post_id": 55378196, "comment_id": 97478933, "body": "Those replacements indeed fixed the problem. Thank you all so much."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 2, "creation_date": 1553693370, "post_id": 55378196, "comment_id": 97478976, "body": "I think it&#39;s <b>hiding</b> the problem. Read about the <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">rule of zero/three/fire</a>"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1553693562, "post_id": 55378196, "comment_id": 97479092, "body": "@YSC The rule of fire is a mythical and untamed beast. Be careful as you proceed."}], "answers": [{"tags": [], "owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "is_accepted": false, "score": 0, "last_activity_date": 1553693820, "creation_date": 1553693820, "answer_id": 55378581, "question_id": 55378196, "link": "https://stackoverflow.com/questions/55378196/creating-a-second-instance-of-an-object-changes-whole-class-behavior-c/55378581#55378581", "title": "Creating a second instance of an object changes whole class behavior (C++)", "body": "<p>It looks like you have a memory leak on this line:</p>\n\n<p><code>return *(new WPCommand(_END, 10000))</code>;</p>\n\n<p>It looks like you are creating WPCommand on heap, then throw away pointer and return a copy !!!</p>\n\n<p>The example is not minimal and complete so it is hard to give better pointers. </p>\n"}, {"comments": [{"owner": {"reputation": 467, "user_id": 9236660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d9baf27175b35aa23984ed4fb4f3b6?s=128&d=identicon&r=PG&f=1", "display_name": "Kruspe", "link": "https://stackoverflow.com/users/9236660/kruspe"}, "edited": false, "score": 0, "creation_date": 1553694695, "post_id": 55378787, "comment_id": 97479903, "body": "It is not really an error, it is expected behaviour. Thank you so much. Really."}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 2, "last_activity_date": 1553707647, "last_edit_date": 1553707647, "creation_date": 1553694414, "answer_id": 55378787, "question_id": 55378196, "link": "https://stackoverflow.com/questions/55378196/creating-a-second-instance-of-an-object-changes-whole-class-behavior-c/55378787#55378787", "title": "Creating a second instance of an object changes whole class behavior (C++)", "body": "<blockquote>\n<pre><code>WayPointStack wps = *(new WayPointStack());\n</code></pre>\n</blockquote>\n\n<p>must be</p>\n\n<pre><code>WayPointStack wps;\n</code></pre>\n\n<p>because it is enough and that removes the memory leak</p>\n\n<hr>\n\n<p>In      </p>\n\n<blockquote>\n<pre><code> WPCommand WayPointStack::GetNextWP()\n {\n     ...\n     return *(new WPCommand(_END, 10000));\n }\n</code></pre>\n</blockquote>\n\n<p>you create an other memory leak, may be do not return the element but its address allowing you to return nullptr on error ?</p>\n\n<pre><code> /*const ?*/ WPCommand * WayPointStack::GetNextWP()\n {\n     Serial.println(\"Pointer = \");\n     Serial.println(pointer);\n     Serial.println(\"Length = \");\n     Serial.println(_length);\n     if (pointer &lt; _length){\n       return &amp;_wp[pointer++];\n     }\n     return nullptr;\n }\n</code></pre>\n\n<p>else use a static var :</p>\n\n<pre><code>  WPCommand WayPointStack::GetNextWP()\n  {\n      ...\n      static WPCommand error(_END, 10000);\n      return error;\n  }\n</code></pre>\n\n<hr>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>void WayPointStack::AddWP(int target, int time)\n{\n    if (_length == arrSize)\n        return;\n    _wp[_length] = *(new WPCommand(target, time));\n    _length++;\n}\n</code></pre>\n</blockquote>\n\n<p>you create an other memory leak, you just need to initialize the entry :</p>\n\n<pre><code> void WayPointStack::AddWP(int target, int time)\n {\n     if (_length == arrSize)\n         return;\n     _wp[_length]._target = target, time));\n     _wp[_length]._time = time;\n     _length++;\n }\n</code></pre>\n\n<p>you do not signal the error when you cannot add a new element, what about to return a <em>bool</em> valuing false on error and true when you can add :</p>\n\n<pre><code> bool WayPointStack::AddWP(int target, int time)\n {\n     if (_length == arrSize)\n         return false;\n     _wp[_length]._target = target;\n     _wp[_length]._time = time;\n     _length++;\n     return true;\n }\n</code></pre>\n\n<hr>\n\n<p>Finally Why do you not use a <code>std::vector</code> for <code>_wp</code></p>\n"}], "owner": {"reputation": 467, "user_id": 9236660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d9baf27175b35aa23984ed4fb4f3b6?s=128&d=identicon&r=PG&f=1", "display_name": "Kruspe", "link": "https://stackoverflow.com/users/9236660/kruspe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55378787, "answer_count": 2, "score": -3, "last_activity_date": 1553707647, "creation_date": 1553692715, "question_id": 55378196, "link": "https://stackoverflow.com/questions/55378196/creating-a-second-instance-of-an-object-changes-whole-class-behavior-c", "title": "Creating a second instance of an object changes whole class behavior (C++)", "body": "<p>I have written an Arduino library in C++ that contains an iterator class. If I iterate through it using the same instance all the time, it works as expected. If I create a second instance to do so, it will double the amount of stored objects.</p>\n\n<pre><code>WayPointStack wps = *(new WayPointStack());\nwps.AddWP(1, 20);\nwps.AddWP(2, 420);\n\nWPCommand c1 = wps.GetNextWP(); //  Stack length: 2, correct\nc1 = wps.GetNextWP();           //\n\nWPCommand c1 = wps.GetNextWP(); //  Stack length: 4, not correct\nWPCommand c2 = wps.GetNextWP(); //\n\n\n  WPCommand WayPointStack::GetNextWP()\n{\n    Serial.println(\"Pointer = \");\n    Serial.println(pointer);\n    Serial.println(\"Length = \");\n    Serial.println(_length);\n    if (pointer &lt; _length){\n        pointer++;\n        return _wp[pointer-1];\n    }\n    return *(new WPCommand(_END, 10000));\n}\n\nvoid WayPointStack::AddWP(int target, int time)\n{\n    if (_length == arrSize)\n        return;\n    _wp[_length] = *(new WPCommand(target, time));\n    _length++;\n}\n\nWayPointStack::WayPointStack()\n{\n  _wp = new WPCommand[arrSize];\n  _length = 0;\n  pointer = 0;\n}\n\nWPCommand::WPCommand(int target, int time)\n{\n    _target = target;\n    _time = time;\n}\n</code></pre>\n\n<p>Can someone explain this to me?</p>\n"}, {"tags": ["c++", "visual-studio-2013", "cmake", "msbuild", "shared-libraries"], "comments": [{"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1553694305, "post_id": 55378056, "comment_id": 97479592, "body": "Can&#39;t recall at all in CMake, but if at the msbuild/vcxproj/sln level project <code>A</code> depends on <code>B</code>, then rebuilding B should cause project A to build, which will include any post build or &quot;Custom Build Tool&quot; items with relevant inputs/dependencies. I also haven&#39;t used 2013 for years, but I don&#39;t recall any bugs with this."}, {"owner": {"reputation": 118, "user_id": 9134198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03e97add71a53fed1bdd30f943c31fc?s=128&d=identicon&r=PG&f=1", "display_name": "Cubimon", "link": "https://stackoverflow.com/users/9134198/cubimon"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1553696292, "post_id": 55378056, "comment_id": 97481023, "body": "@Fire Lancer it should, but somehow it doesn&#39;t. Linker and project dependencies are set. In my case it is linked, but in general it could be a module/plugin that is loaded at runtime. I still don&#39;t understand how msbuild decides if a project needs to be built. After building, Visual Studio says one successful and the other projects are up-to-date. It did build only the dependency and of course I have project <code>A</code> as startproject and selected in project explorer. If I build again it says all are up-to-date."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553703549, "post_id": 55378056, "comment_id": 97486038, "body": "You can set target dependencies in <code>CMake</code>. <a href=\"https://cmake.org/cmake/help/v3.14/command/add_dependencies.html\" rel=\"nofollow noreferrer\">cmake.org/cmake/help/v3.14/command/add_dependencies.html</a>"}, {"owner": {"reputation": 118, "user_id": 9134198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03e97add71a53fed1bdd30f943c31fc?s=128&d=identicon&r=PG&f=1", "display_name": "Cubimon", "link": "https://stackoverflow.com/users/9134198/cubimon"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1553716475, "post_id": 55378056, "comment_id": 97492763, "body": "@drescherjm I did, this creates dependencies in MSBuild/Visual Studio, but that doesn&#39;t solve the problem"}, {"owner": {"reputation": 14371, "user_id": 321866, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/25e93a50d485eca289f887868e1bcea5?s=128&d=identicon&r=PG", "display_name": "C Johnson", "link": "https://stackoverflow.com/users/321866/c-johnson"}, "edited": false, "score": 0, "creation_date": 1553879916, "post_id": 55378056, "comment_id": 97564180, "body": "Or you can simply stop using the old dinosaur cmake."}, {"owner": {"reputation": 118, "user_id": 9134198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03e97add71a53fed1bdd30f943c31fc?s=128&d=identicon&r=PG&f=1", "display_name": "Cubimon", "link": "https://stackoverflow.com/users/9134198/cubimon"}, "edited": false, "score": 0, "creation_date": 1553884548, "post_id": 55378056, "comment_id": 97566352, "body": "cmake is the standard build tool and this is also a msbuild issue so idk"}], "owner": {"reputation": 118, "user_id": 9134198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03e97add71a53fed1bdd30f943c31fc?s=128&d=identicon&r=PG&f=1", "display_name": "Cubimon", "link": "https://stackoverflow.com/users/9134198/cubimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1553692249, "creation_date": 1553692249, "question_id": 55378056, "link": "https://stackoverflow.com/questions/55378056/copy-required-dlls-with-cmake-msbuild", "title": "Copy required dlls with CMake/MSBuild", "body": "<h2>Problem</h2>\n\n<p>I use Visual Studio 12 (2013) with MSBuild 12.0.40629.0. \nI have two projects, <code>A</code> and <code>B</code>. <code>A</code> depends on the shared library built by project <code>B</code>.\nAt the moment I use something like the following <code>cmake</code> code to copy my required shared libraries (dlls):</p>\n\n<pre><code>project(A)\n\nadd_custom_command(TARGET ${PROJECT_NAME} POST_BUILD\n    COMMAND ${CMAKE_COMMAND} -E copy_if_different\n    ${CMAKE_BINARY_DIR}/bin/B.dll\n    ${CMAKE_CURRENT_BINARY_DIR}/bin)\n</code></pre>\n\n<p>This generally works, but if I modify code of project <code>B</code> without modifying project <code>A</code>, the post build command of project <code>A</code> isn't called (I didn't modify the project) and I am stuck with a old shared library. At the moment I add a space character and remove it to force build project <code>A</code>/run post build.</p>\n\n<h2>Stupid solution</h2>\n\n<p>I could copy the shared library with a post build command in project <code>B</code> to project <code>A</code>, but that means I have two locations, where dlls are copied.</p>\n\n<h2>More elegant solution</h2>\n\n<p>While writing this I came to another better solution. Copying shared library in post build of <code>B</code> to project <code>A</code> is sufficient, but makes the project structure more intertwined.</p>\n\n<h2>Question</h2>\n\n<p>How do I make CMake or MSBuild copy dlls in a more elegant way, so this edge case is solved.</p>\n"}, {"tags": ["c++", "algorithm", "binary"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553692592, "post_id": 55378046, "comment_id": 97478428, "body": "Is <code>char</code> signed or unsigned on your platform? If it&#39;s unsigned you&#39;re in for some fun with your assertions. Since it&#39;s recommended to only perform shifts on unsigned quantities but you want tests with signed inputs, you kind of need to figure out which one you want to use."}, {"owner": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553692741, "post_id": 55378046, "comment_id": 97478537, "body": "@Max Langhof The algorithm also fails equivalently for <code>using T = unsigned long long int</code>, which was the type used when we originally developed this method."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553692855, "post_id": 55378046, "comment_id": 97478627, "body": "I&#39;m just trying to help you improve the question. I understand that these nitpicks are not <i>your</i> main concern, but it&#39;s irritating for others to get stuck on these problems when they aren&#39;t what you care about."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1553693063, "post_id": 55378046, "comment_id": 97478773, "body": "In any case, what did you find when debugging this? <i>Which</i> test case fails, and what are the steps your search is taking?"}], "answers": [{"tags": [], "owner": {"reputation": 6120, "user_id": 9214517, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uHHGLaUqJK4/AAAAAAAAAAI/AAAAAAAAAAA/EMWzo-f2N9c/photo.jpg?sz=128", "display_name": "adrtam", "link": "https://stackoverflow.com/users/9214517/adrtam"}, "is_accepted": false, "score": 0, "last_activity_date": 1553693206, "creation_date": 1553693206, "answer_id": 55378363, "question_id": 55378046, "link": "https://stackoverflow.com/questions/55378046/trouble-with-finding-floorlog2int-using-binary-search-in-olog2amount-bits/55378363#55378363", "title": "Trouble with finding floor(log2(int)) using binary search in O(log2(amount_bits))", "body": "<p>Endless loop is due to this line:</p>\n\n<pre><code> mid = (low + ((high - low) / 2));\n</code></pre>\n\n<p>if <code>high</code> and <code>low</code> is differ by 1, the result could be <code>mid == low</code> and then at the condition that cause <code>low = mid</code> inside the while loop, you resulted in checking the same condition forever. My suggestion would be, if you have <code>low = mid</code> in the loop, you have to make sure your <code>mid != low</code> in that case. So just check this before the assignment and do <code>low = mid+1</code> instead if that happens.</p>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 0, "creation_date": 1553694043, "post_id": 55378462, "comment_id": 97479405, "body": "<code>if (value &lt; guess) { high = mid; } else { low = mid + 1; }</code> causes lgfloor(1) to fail. <code>if (value &lt; guess) { high = mid - 1; } else { low = mid; }</code> causes an endless loop in lgfloor(2): <code>high: 2, mid: 1, low: 1</code>. Fixing one case causes others to fail. We suspect that this is not the average binary search application, but has an additional difficulty which we constantly seem to miss. We debugged various variations of this method, but seem to constantly fail one test or another."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 0, "creation_date": 1553694245, "post_id": 55378462, "comment_id": 97479541, "body": "@MartenBE In that case just add a check for <code>guess == value</code> and return <code>mid</code>. Note that <code>low</code> can never reach <code>high</code> in your implementation, so if at any point <code>high</code> is the correct guess then you currently have no way of returning <code>high</code> (you only ever return <code>low</code>). Alternatively, did you try <code>high = mid</code> and <code>low = mid</code> yet? Again, the correct solution should be really obvious if you sit down with a piece of paper and do it by hand once (which I admit to not having done myself)."}, {"owner": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 0, "creation_date": 1553694463, "post_id": 55378462, "comment_id": 97479715, "body": "We&#39;ve tried that, but such a solution fails lgfloor(100): <code>if (value == guess) { return mid; } else if (value &lt; guess) { high = mid - 1; } else { low = mid + 1; }</code>. Additionally: <code>if (value &lt; guess) { high = mid; } else { low = mid; }</code> also gives an endless loop: <code>high: 7, mid: 6, low: 6</code>. It&#39;s really tricky :p"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 1, "creation_date": 1553695122, "post_id": 55378462, "comment_id": 97480209, "body": "Ok <code>value == guess</code> is of course wrong. What you&#39;d need to check is if you are at the leftmost bit. That is, <code>if ((guess ^ value) &lt; guess) return mid;</code>."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 1, "creation_date": 1553695308, "post_id": 55378462, "comment_id": 97480344, "body": "Also note that there is an intrinsic that does this whole job instruction for you (in essentially O(1)): <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#cats=Bit%2525252520Manipulation\" rel=\"nofollow noreferrer\"><code>_BitScanReverse</code></a>. Doesn&#39;t qualify for the assignment (I mean, you could argue that the inbuilt operations for addition, division shifts and comparisons are all O(numBits) just the same), but just in case you ever have to do this in practice, you know."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 0, "creation_date": 1553696667, "post_id": 55378462, "comment_id": 97481264, "body": "@MartenBE I wrote it down on paper now and what do you know, the answer became clear."}, {"owner": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 0, "creation_date": 1553697461, "post_id": 55378462, "comment_id": 97481796, "body": "<code>if ((guess ^ value) &lt; guess) { return mid; } else if (value &lt; guess) { high = mid - 1; } else { low = mid + 1; }</code> did the trick for the 3-way branch solution! It was indeed a problem with the comparison. I see you added a 2-way branch solution also: I&#39;ve marked it as the right answer, thank you for your help! I&#39;m also interested on what you wrote on that paper :)"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1553699784, "post_id": 55378462, "comment_id": 97483522, "body": "This solution doesn&#39;t satisfy the <code>O(log(n))</code> constraint."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1553700009, "post_id": 55378462, "comment_id": 97483686, "body": "@YvesDaoust The question does not unambiguously specify, but I recall (from an earlier, now deleted version of the question) that the author asked for <code>O(log(representationBits))</code>, not <code>O(log(log(x)))</code>. Or in other words, please source your claim that <code>n = lg2(x)</code> and not <code>n = sizeof(x)</code> (if it was the former, why would the question go out of its way to say &quot;<code>O(log(n))</code> where n is the number of bits&quot;?)"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1553700485, "post_id": 55378462, "comment_id": 97484025, "body": "@MaxLanghof: the question is indeed quite ambiguous. The title says <code>log(amount_bits)</code>, while the body says <code>log(n)</code> for an int of <code>n</code> bits. None of these expressions is explained. If the &quot;simple&quot; interpretation is taken, it would make sense to pass <code>n</code> as a parameter."}, {"owner": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 0, "creation_date": 1553729369, "post_id": 55378462, "comment_id": 97497813, "body": "amount_bits is the amount of bits used for the datatype of T (which is why sizeof is used in the code). E.g. T = uint64_t, means that n = 64."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 1, "last_activity_date": 1553700509, "last_edit_date": 1553700509, "creation_date": 1553693460, "answer_id": 55378462, "question_id": 55378046, "link": "https://stackoverflow.com/questions/55378046/trouble-with-finding-floorlog2int-using-binary-search-in-olog2amount-bits/55378462#55378462", "title": "Trouble with finding floor(log2(int)) using binary search in O(log2(amount_bits))", "body": "<p>You need a proper exit condition. Let's say <code>y = floor(lg2(x))</code>. You should exit the loop when <code>2^low &lt;= x</code> and <code>x &lt; 2^(low+1)</code>. But if <code>high == low+1</code> then this is fulfilled, yet you do not currently exit. Just do:</p>\n\n<pre><code>while (high &gt; low+1)\n{\n</code></pre>\n\n<p>It is good to look at invariants in your loop. For example, we could try to maintain <code>x &lt; 2^high</code> (that would require starting at <code>sizeof(T)*8</code>, not <code>sizeof(T)*8 - 1</code>). Then all you need to do is bisecting until <code>low == high-1</code> and you are done.</p>\n\n<p>We can maintain this invariant by only changing <code>high</code> to <code>mid</code> if <code>x &lt; 2^mid</code>, i.e. if <code>value &lt; guess</code>. That's the first case:</p>\n\n<pre><code>if (value &lt; guess)\n  high = mid;\n</code></pre>\n\n<p>We further must maintain <code>2^low &lt;= x = value</code>. So, in the else branch (which requires <code>2^mid == guess &lt; value</code>, we can safely set <code>low = mid</code>.</p>\n\n<pre><code>else\n  low = mid;\n</code></pre>\n\n<p>All that is left is to prove that the loop always progresses. Since <code>high &gt; low+1</code>, we have <code>high - low &gt;= 2</code> and thus <code>mid != low</code> and <code>mid != high</code>. Clearly, we are reducing the interval (by half) each iteration.</p>\n\n<p>So there you go:</p>\n\n<pre><code>int lgfloor(T value)\n{\n    assert(value &gt; 0);\n\n    int high = (sizeof(value) * 8);\n    int low = 0;\n\n    while (high &gt; low+1)\n    {\n        int mid = (low + ((high - low) / 2));\n        T guess = static_cast&lt;T&gt;(1) &lt;&lt; mid;\n\n        printf(\"high: %d, mid: %d, low: %d\\n\", high, mid, low);\n\n        if (value &lt; guess)\n            high = mid;\n        else\n            low = mid;\n    }\n\n    return low;\n}\n</code></pre>\n\n<hr>\n\n<p>I should of course note that there are dedicated intrinsics for this exact purpose in modern hardware. For example, search <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#cats=Bit%2525252520Manipulation\" rel=\"nofollow noreferrer\">Intel's intrinsics guide</a> for <code>_BitScanReverse</code> which will complete in a fraction of the cycles the above code would take.</p>\n\n<p>One way or another, asymptotic runtimes that depend on bit-width are pretty meaningless when dealing with fixed-width types such as C++' integral ones (although the question has educational value still).</p>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "edited": false, "score": 2, "creation_date": 1553697280, "post_id": 55379774, "comment_id": 97481670, "body": "This solution is O(amount_bits) instead of O(log2(amount_bits))."}], "tags": [], "owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "is_accepted": false, "score": -1, "last_activity_date": 1553697166, "creation_date": 1553697166, "answer_id": 55379774, "question_id": 55378046, "link": "https://stackoverflow.com/questions/55378046/trouble-with-finding-floorlog2int-using-binary-search-in-olog2amount-bits/55379774#55379774", "title": "Trouble with finding floor(log2(int)) using binary search in O(log2(amount_bits))", "body": "<p>Seems like you just have to shift if to the right 'log' times, until you have a '1'.</p>\n\n<pre><code>using T = unsigned char;\n\nint lgfloor(T value)\n{\n  assert(value &gt; 0);\n\n  int log = 0;\n  while(value != 1) {\n    value &gt;&gt; 1;\n    log++;\n  }\n  return log;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 0, "last_activity_date": 1553699632, "last_edit_date": 1553699632, "creation_date": 1553698083, "answer_id": 55380107, "question_id": 55378046, "link": "https://stackoverflow.com/questions/55378046/trouble-with-finding-floorlog2int-using-binary-search-in-olog2amount-bits/55380107#55380107", "title": "Trouble with finding floor(log2(int)) using binary search in O(log2(amount_bits))", "body": "<p>The solution must be found in <code>lg(n)</code> steps, which means that an initialisation such as <code>low= 0</code>, <code>high= 32</code> won't work, because it would take <code>5</code> steps in every case and wouldn't work for <code>x</code> larger than <code>2^32</code>. A correct solution must combine a first <em>geometric</em> search where you double the exponent, then a standard dichotomic search.</p>\n\n<pre><code># Geometric search\nlow= 0\nhigh= 1\nwhile (1 &lt;&lt; high) &lt;= x:\n    low= high\n    high+= high\n\n# Dichotomic search\nwhile high - low &gt; 1:\n    mid= (high + low) &gt;&gt; 1\n    if x &lt; mid:\n        high= mid\n    else:\n        low= mid\n</code></pre>\n"}], "owner": {"reputation": 575, "user_id": 1842286, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f68c476964ae3af4af263810691eb54a?s=128&d=identicon&r=PG", "display_name": "MartenBE", "link": "https://stackoverflow.com/users/1842286/martenbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55378462, "answer_count": 4, "score": -1, "last_activity_date": 1553729512, "creation_date": 1553692227, "last_edit_date": 1553729512, "question_id": 55378046, "link": "https://stackoverflow.com/questions/55378046/trouble-with-finding-floorlog2int-using-binary-search-in-olog2amount-bits", "title": "Trouble with finding floor(log2(int)) using binary search in O(log2(amount_bits))", "body": "<p>In our algorithms class, we've got an extra question in the lab session by the professor. Find the floor(log2(x)) for an int of n bits in log2(n) steps (e.g. when T = uint64_t, then n = 64).</p>\n\n<p>We've found that we should be able to solve this with binary search, but we get an off by 1 result or an endless loop in certain edge cases. We're scratching our heads for some time, but cannot seem to get this right. How do we best deal with this? We've tried to reason with the invariant trick as discussed <a href=\"https://zhu45.org/posts/2018/Jan/12/how-to-write-binary-search-correctly/\" rel=\"nofollow noreferrer\">here</a>, but it seems to be a little more complex than. E.g. for a decimal number, when choosing between bit 7 or 6 is difficult as 128 is larger than 100, but 64 is smaller. Unfortunately, when mitigating this, we break some edge cases.</p>\n\n<p>EDIT: As noted below, this is purely an academic question with low to none usability in real-life scenario's.</p>\n\n<p>Here is our code so far:</p>\n\n<pre><code>//\n//   h      l\n//   76543210\n// 0b01000001 = 65\n//\n\nusing T = unsigned char;\n\nint lgfloor(T value)\n{\n    assert(value &gt; 0);\n\n    int high = ((sizeof(value) * 8) - 1);\n    int low = 0;\n    int mid = 0;\n    T guess = 0;\n\n    while (high &gt; low)\n    {\n        mid = (low + ((high - low) / 2));\n        guess = static_cast&lt;T&gt;(1) &lt;&lt; mid;\n\n        printf(\"high: %d, mid: %d, low: %d\\n\", high, mid, low);\n\n        if (value &lt; guess)\n        {\n            high = mid - 1;\n        }\n        else\n        {\n            low = mid;\n        }\n    }\n\n    return low;\n}\n</code></pre>\n\n<p>We have created the following unit tests (using GoogleTest):</p>\n\n<pre><code>TEST(LgFloor, lgfloor)\n{\n    ASSERT_DEATH(lgfloor(-1), \"Assertion `value &gt; 0' failed.\");\n    ASSERT_DEATH(lgfloor(0), \"Assertion `value &gt; 0' failed.\");\n\n    ASSERT_EQ(lgfloor(1), 0);\n    ASSERT_EQ(lgfloor(2), 1);\n    ASSERT_EQ(lgfloor(64), 6);\n    ASSERT_EQ(lgfloor(100), 6);\n}\n</code></pre>\n\n<p>Thanks in advance,\nwith kind regards,</p>\n\n<p>Marten</p>\n"}, {"tags": ["c++", "class", "oop", "object", "constructor"], "comments": [{"owner": {"reputation": 628, "user_id": 1192700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e582c508859b2fe285f938ea7ffb01?s=128&d=identicon&r=PG", "display_name": "Cristian Bidea", "link": "https://stackoverflow.com/users/1192700/cristian-bidea"}, "edited": false, "score": 0, "creation_date": 1553692375, "post_id": 55378035, "comment_id": 97478259, "body": "Can you please describe in pseudo-code what is it that you expect? It&#39;s hard to infer what you want just from your description. Thank you!"}, {"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1553692406, "post_id": 55378035, "comment_id": 97478280, "body": "just use a std::vector of pointer."}], "owner": {"reputation": 101, "user_id": 6130280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1416f9854560b353a9d731806151f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Anubhab Das", "link": "https://stackoverflow.com/users/6130280/anubhab-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 14, "favorite_count": 0, "closed_date": 1553692716, "answer_count": 0, "score": 0, "last_activity_date": 1553692778, "creation_date": 1553692183, "last_edit_date": 1553692778, "question_id": 55378035, "link": "https://stackoverflow.com/questions/55378035/array-of-objects-with-parameterised-constructors", "closed_reason": "Duplicate", "title": "Array of Objects with Parameterised Constructors", "body": "<p>Is it possible to create an array of objects of a class having paramaterised public constructors in C++? \nThe actual parameters for each object can be same or different.\nHere is an example : </p>\n\n<pre><code>class Test{\n        int A;\npublic:\nTest (int i)\n{ A=i;}\n};\nint main()\n{\nTest Array[10]; //Error\n}\n</code></pre>\n"}, {"tags": ["c++", "ffmpeg"], "answers": [{"tags": [], "owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "is_accepted": false, "score": 0, "last_activity_date": 1553693895, "creation_date": 1553693895, "answer_id": 55378612, "question_id": 55377589, "link": "https://stackoverflow.com/questions/55377589/av-buffersink-get-frame-return-error-averroreagain-11/55378612#55378612", "title": "av_buffersink_get_frame() return error AVERROR(EAGAIN) -11", "body": "<p>Try to call it again until it succeed, as error says. It's worth adding a delay between calls using some sleep function to wait like 20ms.</p>\n"}], "owner": {"reputation": 11, "user_id": 11134055, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_PDlJQFKl9I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfKNBSLBRCsIBXXYnH-Nv24lg6VUQ/mo/photo.jpg?sz=128", "display_name": "Junqson", "link": "https://stackoverflow.com/users/11134055/junqson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553693895, "creation_date": 1553690877, "last_edit_date": 1553693790, "question_id": 55377589, "link": "https://stackoverflow.com/questions/55377589/av-buffersink-get-frame-return-error-averroreagain-11", "title": "av_buffersink_get_frame() return error AVERROR(EAGAIN) -11", "body": "<p>I convert some other format to AVFrame and call: </p>\n\n<pre><code>av_buffersrc_add_frame_flags(buffersrc_ctx, frame, AV_BUFFERSRC_FLAG_KEEP_REF) \n</code></pre>\n\n<p>to add the frame to filter graph, it success.</p>\n\n<p>When it turns to:</p>\n\n<pre><code>int ret = av_buffersink_get_frame(buffersink_ctx, filt_frame);\n</code></pre>\n\n<p>I got an AVERROR(EAGAIN) that show there is no frame available at this point.</p>\n\n<p>What can I do to fix this?</p>\n"}, {"tags": ["java", "c++", "api", "twitter", "twitter4j"], "comments": [{"owner": {"reputation": 4793, "user_id": 2136795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2aa2525743dbdf65634cc11fae3b6ed?s=128&d=identicon&r=PG", "display_name": "Gyro Gearless", "link": "https://stackoverflow.com/users/2136795/gyro-gearless"}, "edited": false, "score": 2, "creation_date": 1553691138, "post_id": 55377530, "comment_id": 97477362, "body": "Why on earth are you doing this in C++?? And you should understand the very basics of java commandline stuff before automating things (Hint: you are searching for your compiled class in a directory named &quot;TwitterDataCrawler.java&quot;"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1553691956, "post_id": 55377530, "comment_id": 97477963, "body": "this seems to be not a problem of calling <code>system</code> but of the parameters you pass to it. Do this commands work if you type them by hand on the command line?"}, {"owner": {"reputation": 75, "user_id": 10400228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86c7e02aacebe755f113ad99db03c20?s=128&d=identicon&r=PG&f=1", "display_name": "Sam T", "link": "https://stackoverflow.com/users/10400228/sam-t"}, "reply_to_user": {"reputation": 4793, "user_id": 2136795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2aa2525743dbdf65634cc11fae3b6ed?s=128&d=identicon&r=PG", "display_name": "Gyro Gearless", "link": "https://stackoverflow.com/users/2136795/gyro-gearless"}, "edited": false, "score": 0, "creation_date": 1553706431, "post_id": 55377530, "comment_id": 97487688, "body": "I see what you mean. @GyroGearless Changing the code to: system(&quot;java -cp TwitterDataCrawler&quot;);  Gave me this message: <a href=\"https://imgur.com/a/wNwcolI\" rel=\"nofollow noreferrer\">imgur.com/a/wNwcolI</a> Am i still lacking something? Yes, this is my first time meddling with java commandline, I should have read up on it first before I began."}, {"owner": {"reputation": 1147, "user_id": 5769952, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh3.googleusercontent.com/-CkW6_YIdXlY/AAAAAAAAAAI/AAAAAAAAAN8/5DK37lfUwJg/photo.jpg?sz=128", "display_name": "RoiEX", "link": "https://stackoverflow.com/users/5769952/roiex"}, "edited": false, "score": 0, "creation_date": 1553707358, "post_id": 55377530, "comment_id": 97488162, "body": "Then go ahead and check how to compile java code from the commandline, your updated command tries to invoke java without a main class, just setting a classpath to an invalid file called &quot;TwitterDataCrawler&quot;. Apart from that I&#39;m with Gyro: Why the hell are you using C++ to invoke java? If you just want a simple program that automates this process for you, you can just add the shell commands into a bash or batch file and run that instead."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 10400228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86c7e02aacebe755f113ad99db03c20?s=128&d=identicon&r=PG&f=1", "display_name": "Sam T", "link": "https://stackoverflow.com/users/10400228/sam-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1553749127, "creation_date": 1553749127, "answer_id": 55390454, "question_id": 55377530, "link": "https://stackoverflow.com/questions/55377530/unable-to-load-main-class-when-compiling-and-running-a-java-file-using-c/55390454#55390454", "title": "Unable to load main class when compiling and running a java file using C++", "body": "<p>Solved!</p>\n\n<pre><code>system(javac -cp twitter4j-core-4.0.7.jar TwitterDataCrawler.java);\nsystem(java -cp .;twitter4j-core-4.0.7.jar TwitterDataCrawler);\n</code></pre>\n\n<p>Since the class created from using javac is dependent on a jar API(both residing in the same directory), \".;twitter4j-core-4.0.7.jar\" is included in order to execute TwitterDataCrawler.</p>\n"}], "owner": {"reputation": 75, "user_id": 10400228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86c7e02aacebe755f113ad99db03c20?s=128&d=identicon&r=PG&f=1", "display_name": "Sam T", "link": "https://stackoverflow.com/users/10400228/sam-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55390454, "answer_count": 1, "score": 0, "last_activity_date": 1553749127, "creation_date": 1553690687, "question_id": 55377530, "link": "https://stackoverflow.com/questions/55377530/unable-to-load-main-class-when-compiling-and-running-a-java-file-using-c", "title": "Unable to load main class when compiling and running a java file using C++", "body": "<p>I've been trying to compile and execute a java file from C++ but I am currently getting this error. The java file works fine when executed separately in java. </p>\n\n<p>This is the error code received:</p>\n\n<pre><code>Error: Could not find or load main class TwitterDataCrawler\nCaused by: java.lang.ClassNotFoundException: TwitterDataCrawler\n</code></pre>\n\n<p>In my C++ file:</p>\n\n<p>(TwitterDataCrawler.java is the file i wish to run \\ twitter4j-core-4.0.7.jar is the twitter API that is required to run)</p>\n\n<pre><code>int main()\n{\n    system(\"javac -cp twitter4j-core-4.0.7.jar TwitterDataCrawler.java\");\n    system(\"java -cp TwitterDataCrawler.java TwitterDataCrawler arg1\");\n    return 0;\n}\n</code></pre>\n\n<p>The structure of my java file looks something like this:</p>\n\n<pre><code>public class TwitterDataCrawler {\n    public TwitterDataCrawler() {\n    }   \n    public static void viewAccident(int x) throws TwitterException, IOException{\n    }\n    public static void main(String[] args) throws TwitterException, IOException {\n            viewAccident(5000);\n    }\n}\n</code></pre>\n\n<p>I have to call the public static void main function from within the class TwitterDataCrawler. I assume that since the class does contains a main function, targeting the class with an argument should work. Could someone point me in the right direction?</p>\n"}, {"tags": ["c++", "struct", "language-lawyer", "standards", "default-constructor"], "answers": [{"tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": false, "score": 6, "last_activity_date": 1553691405, "last_edit_date": 1553691405, "creation_date": 1553691060, "answer_id": 55377651, "question_id": 55377407, "link": "https://stackoverflow.com/questions/55377407/stdvector-of-struct-what-will-be-the-initial-values-of-the-members-of-the-str/55377651#55377651", "title": "std::vector of struct: what will be the initial values of the members of the struct after a vector resize?", "body": "<p>Yes, you're correct. You didn't use a specialized (customized) allocator. At last the elememts get <a href=\"https://en.cppreference.com/w/cpp/language/value_initialization\" rel=\"noreferrer\">value initialized</a>. From <a href=\"https://en.cppreference.com/w/cpp/named_req/DefaultInsertable\" rel=\"noreferrer\">DefaultInsertable</a>:</p>\n\n<blockquote>\n  <p>By default, this will call placement-new, as by <code>::new((void*)p) T()</code> (that is, value-initialize the object pointed to by <code>p</code>). </p>\n</blockquote>\n\n<p>And as the result of <a href=\"https://en.cppreference.com/w/cpp/language/value_initialization\" rel=\"noreferrer\">value initialization</a>, all the members of <code>T</code> will be zero-initialized.</p>\n\n<p>(emphasis mine)</p>\n\n<blockquote>\n  <p>if T is a class type with a default constructor that is neither user-provided nor deleted (that is, it may be a class with an implicitly-defined or defaulted default constructor), <strong>the object is zero-initialized</strong> and then it is default-initialized if it has a non-trivial default constructor;</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1553691091, "creation_date": 1553691091, "answer_id": 55377664, "question_id": 55377407, "link": "https://stackoverflow.com/questions/55377407/stdvector-of-struct-what-will-be-the-initial-values-of-the-members-of-the-str/55377664#55377664", "title": "std::vector of struct: what will be the initial values of the members of the struct after a vector resize?", "body": "<blockquote>\n  <p>Am I fine?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>Does my snippet use a specialized allocators?</p>\n</blockquote>\n\n<p>No. You use the default allocator which is <code>std::allocator</code>. </p>\n\n<blockquote>\n  <p>I think that at the end my snippet will call new T() and now, according to <a href=\"https://stackoverflow.com/a/8280207\">https://stackoverflow.com/a/8280207</a> I think a, b and c, will be 0, am I correct?</p>\n</blockquote>\n\n<p>Correct. </p>\n"}, {"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1553691195, "creation_date": 1553691195, "answer_id": 55377711, "question_id": 55377407, "link": "https://stackoverflow.com/questions/55377407/stdvector-of-struct-what-will-be-the-initial-values-of-the-members-of-the-str/55377711#55377711", "title": "std::vector of struct: what will be the initial values of the members of the struct after a vector resize?", "body": "<blockquote>\n  <p>Am I fine? Does my snippet use a specialized allocators?</p>\n</blockquote>\n\n<p>Yes you are, no the allocator is not specialized. The default allocator used by <code>std::vector&lt;T&gt;</code> is <code>std::allocator&lt;T&gt;</code>. Currently <code>std::allocator&lt;T&gt;</code> is <a href=\"https://timsong-cpp.github.io/cppwp/n4659/depr.default.allocator\" rel=\"nofollow noreferrer\">still specified to have a <code>construct</code> member</a> which does the same thing. But that is a deprecated member. Regardless, even if it's removed in the future entirely, the call via <code>std::allocator_traits</code> is still going to behave the same.</p>\n\n<blockquote>\n  <p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/allocator.traits.members\" rel=\"nofollow noreferrer\"><strong>[allocator.traits.members]</strong></a></p>\n\n<pre><code>template &lt;class T, class... Args&gt;\n  static void construct(Alloc&amp; a, T* p, Args&amp;&amp;... args);\n</code></pre>\n  \n  <p><em>Effects</em>: Calls <code>a.construct(p, std\u200b::\u200bforward&lt;Args&gt;(args)...)</code> if that call is well-formed; otherwise, invokes <code>\u200b::\u200bnew(static_\u00adcast&lt;void*&gt;(p)) T(std\u200b::\u200bforward&lt;Args&gt;(args)...)</code>.</p>\n</blockquote>\n\n<p>As for what <code>new T()</code> does, you are 100% correct.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 4, "last_activity_date": 1553703726, "last_edit_date": 1553703726, "creation_date": 1553691562, "answer_id": 55377828, "question_id": 55377407, "link": "https://stackoverflow.com/questions/55377407/stdvector-of-struct-what-will-be-the-initial-values-of-the-members-of-the-str/55377828#55377828", "title": "std::vector of struct: what will be the initial values of the members of the struct after a vector resize?", "body": "<p>The default behavior of </p>\n\n<pre><code>allocator_traits&lt;A&gt;::construct(m, p)\n</code></pre>\n\n<p>is defined in <a href=\"https://timsong-cpp.github.io/cppwp/allocator.traits#members-5\" rel=\"nofollow noreferrer\">[allocator.traits.members]/5</a> it it states it does</p>\n\n<blockquote>\n  <p>Effects: Calls <code>a.construct(p, std::forward&lt;Args&gt;(args)...)</code> if that call is well-formed; otherwise, invokes <code>::new (static_\u00adcast&lt;void*&gt;(p)) T(std::forward&lt;Args&gt;(args)...)</code>.</p>\n</blockquote>\n\n<p>Since <code>std::vector&lt;T&gt; v;</code> use the default allocator <code>std::allocator</code>, and <code>std::allocator</code> lacks a <code>construct</code> member, you fall back to the placement new initialization and if you expand it out you'll have</p>\n\n<pre><code>::new (static_\u00adcast&lt;void*&gt;(p)) T();\n</code></pre>\n\n<p>and if we look up what <code>T()</code> does we get from <a href=\"https://timsong-cpp.github.io/cppwp/dcl.init#11\" rel=\"nofollow noreferrer\">[dcl.init]/11</a> that</p>\n\n<blockquote>\n  <p>An object whose initializer is an empty set of parentheses, i.e., (), shall be value-initialized.</p>\n</blockquote>\n\n<p>and <a href=\"https://timsong-cpp.github.io/cppwp/dcl.init#8\" rel=\"nofollow noreferrer\">[dcl.init]/8</a> states that value initialization will</p>\n\n<blockquote>\n  <p>if T is a (possibly cv-qualified) class type without a user-provided or deleted default constructor, then the object is zero-initialized and the semantic constraints for default-initialization are checked, and if T has a non-trivial default constructor, the object is default-initialized;</p>\n</blockquote>\n\n<p>So all of the members of each newly created object will be zero initialized which means in this case they will all have the value of <code>0</code> since they are built in types.</p>\n"}], "owner": {"reputation": 16103, "user_id": 15485, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/NoiuG.png?s=128&g=1", "display_name": "Alessandro Jacopson", "link": "https://stackoverflow.com/users/15485/alessandro-jacopson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 55377828, "answer_count": 4, "score": 3, "last_activity_date": 1553703726, "creation_date": 1553690313, "question_id": 55377407, "link": "https://stackoverflow.com/questions/55377407/stdvector-of-struct-what-will-be-the-initial-values-of-the-members-of-the-str", "title": "std::vector of struct: what will be the initial values of the members of the struct after a vector resize?", "body": "<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\ntypedef struct {\n   unsigned short a;\n   unsigned short b;\n   unsigned long  c;\n}T;\n\nint main(int,char**)\n{\n    std::vector&lt;T&gt; v;\n    v.resize(256);\n    std::cout &lt;&lt; \"a=\" &lt;&lt; v[0].a &lt;&lt; \" b=\" &lt;&lt; v[0].b &lt;&lt; \" c=\" &lt;&lt; v[0].c &lt;&lt; \"\\n\";\n    return 0;\n}\n</code></pre>\n\n<p>What will be <code>v[0].a</code> (and <code>b</code> and <code>c</code>)?</p>\n\n<p>I am starting looking at the draft <a href=\"http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2017/n4659.pdf\" rel=\"nofollow noreferrer\">N4659 Working Draft, Standard for Programming\nLanguage C++</a> searching for <code>vector::resize</code>:</p>\n\n<blockquote>\n  <p><strong>26.3.11.3 vector capacity [vector.capacity]</strong> (at clause 13)</p>\n  \n  <p><code>void resize(size_type sz);</code> </p>\n  \n  <p><em>Effects</em>: If <code>sz &lt; size()</code>, erases the last\n  <code>size() - sz</code> elements from the sequence. Otherwise, appends <code>sz - size()</code>\n  default-inserted elements to the sequence.</p>\n</blockquote>\n\n<p>from there I need to know what <em>default-inserted</em> means and I arrive at:</p>\n\n<blockquote>\n  <p><strong>26.2.1 General container requirements [container.requirements.general]</strong> (at clause 15.2)</p>\n  \n  <p>\u2014 An element of <code>X</code> is <em>default-inserted</em> if it is initialized by\n  evaluation of the expression</p>\n  \n  <p><code>allocator_traits&lt;A&gt;::construct(m, p)</code></p>\n  \n  <p>where <code>p</code> is the address of the uninitialized storage for the element\n  allocated within <code>X</code>.</p>\n</blockquote>\n\n<p>Now, I need to know what happen inside <code>construct</code>, I found this note</p>\n\n<blockquote>\n  <p><strong>26.2.1 General container requirements [container.requirements.general]</strong> (at the end of clause 15)</p>\n  \n  <p>[ <em>Note</em>: A container calls <code>allocator_traits&lt;A&gt;::construct(m, p, args)</code>\n  to construct an element at <code>p</code> using <code>args</code>, with <code>m == get_allocator()</code>.\n  The default construct in allocator will call <code>::new((void*)p) T(args)</code>,\n  but specialized allocators may choose a different definition. \u2014 <em>end\n  note</em> ]</p>\n</blockquote>\n\n<p>Am I fine? Does my snippet use a <em>specialized allocators</em>? I think that at the end my snippet will call <code>new T()</code> and now, according to <a href=\"https://stackoverflow.com/a/8280207\">https://stackoverflow.com/a/8280207</a> I think <code>a</code>, <code>b</code> and <code>c</code>, will be <code>0</code>, am I correct?</p>\n"}, {"tags": ["c++", "typetraits"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1553690090, "post_id": 55377316, "comment_id": 97476680, "body": "All standard library iterators have certain well defined members, like <code>value_type</code>. You should be able to come up with some SFINAE-based approach that checks for their existence. Or, make use of <code>std::iterator_traits</code>."}, {"owner": {"reputation": 652, "user_id": 11224588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2898ec4197f20a99d75710d96ad85c3?s=128&d=identicon&r=PG&f=1", "display_name": "Diodacus", "link": "https://stackoverflow.com/users/11224588/diodacus"}, "edited": false, "score": 1, "creation_date": 1553690432, "post_id": 55377316, "comment_id": 97476891, "body": "Check this: <a href=\"https://stackoverflow.com/a/49904914/11224588\">stackoverflow.com/a/49904914/11224588</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "is_accepted": false, "score": 0, "last_activity_date": 1553691376, "creation_date": 1553691376, "answer_id": 55377754, "question_id": 55377316, "link": "https://stackoverflow.com/questions/55377316/how-to-check-whether-variable-of-given-type-can-be-dereferenced/55377754#55377754", "title": "How to check whether variable of given type can be dereferenced?", "body": "<p>You might do it in this way using compile time function overload resolution and SFINAE:</p>\n\n<pre><code>template&lt;class T, typename = std::enable_if_t&lt;std::is_pointer&lt;T&gt;::value&gt;&gt;\nvoid func(T var)\n{\n  // a pointer\n}\n\ntemplate&lt;class T, typename = std::enable_if_t&lt;!std::is_pointer&lt;T&gt;::value&gt;,\n         typename = T::value_type&gt;\nvoid func(T var)\n{\n  // possibly an iterator\n}\n\nint main()\n{\n  int *i = new int(11);\n  func(i); // Calls the first overload\n\n  std::vector&lt;int&gt; v;\n  std::vector&lt;int&gt;::const_iterator it = v.begin();\n\n  func(it); // Calls the second overload\n\n  func(2); // Fail, as there is no function for this argument.\n  [..]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10932191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/937a97761c2ba2ef6ae652db5797a0f2?s=128&d=identicon&r=PG&f=1", "display_name": "dinpin", "link": "https://stackoverflow.com/users/10932191/dinpin"}, "edited": false, "score": 0, "creation_date": 1553694133, "post_id": 55377775, "comment_id": 97479467, "body": "This is exactly what I needed. Thanks a lot!"}], "tags": [], "owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "is_accepted": true, "score": 3, "last_activity_date": 1553691430, "creation_date": 1553691430, "answer_id": 55377775, "question_id": 55377316, "link": "https://stackoverflow.com/questions/55377316/how-to-check-whether-variable-of-given-type-can-be-dereferenced/55377775#55377775", "title": "How to check whether variable of given type can be dereferenced?", "body": "<p>You basically want to check if <code>*var</code> is valid. This is the perfect use case for a SFINAE check:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;utility&gt;\n\nnamespace detail {\n    // If `*(object of type T)` is valid, this is selected and\n    // the return type is `std::true_type`\n    template&lt;class T&gt;\n    decltype(static_cast&lt;void&gt;(*std::declval&lt;T&gt;()), std::true_type{})\n    can_be_dereferenced_impl(int);\n\n    // Otherwise the less specific function is selected,\n    // and the return type is `std::false_type`\n    template&lt;class&gt;\n    std::false_type can_be_dereferenced_impl(...);\n}\n\ntemplate&lt;class T&gt;\nstruct can_be_dereferenced : decltype(detail::can_be_dereferenced_impl&lt;T&gt;(0)) {};\n\ntemplate&lt;class T&gt;\nvoid func(T var)\n{\n    if constexpr (can_be_dereferenced&lt;T&amp;&gt;::value)\n    // Or         can_be_dereferenced&lt;decltype((var))&gt;::value\n    {\n        auto&amp;&amp; dereferenced = *var;\n        // Use dereferenced\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10932191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/937a97761c2ba2ef6ae652db5797a0f2?s=128&d=identicon&r=PG&f=1", "display_name": "dinpin", "link": "https://stackoverflow.com/users/10932191/dinpin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 1, "accepted_answer_id": 55377775, "answer_count": 2, "score": 0, "last_activity_date": 1553691430, "creation_date": 1553690024, "question_id": 55377316, "link": "https://stackoverflow.com/questions/55377316/how-to-check-whether-variable-of-given-type-can-be-dereferenced", "title": "How to check whether variable of given type can be dereferenced?", "body": "<p>Is there way in C++ to determine whether type of variable is pointer or any iterator with overloaded <code>operator*</code>?</p>\n\n<p>There is standard <code>std::is_pointer</code>, but it say nothing about iterators. </p>\n\n<p>I wanna use it in code like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;class T&gt;\nvoid func(T var)\n{\n    if constexpr (can_be_dereferenced&lt;T&gt;::value)\n    {\n        // do something with *var;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "cuda", "nvidia", "return-type", "nvml"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 2, "creation_date": 1553700357, "post_id": 55377048, "comment_id": 97483922, "body": "&quot;In each case the device is identified with an nvmlDevice_t handle. This handle is obtained by calling one of nvmlDeviceGetHandleByIndex(), nvmlDeviceGetHandleBySerial(), nvmlDeviceGetHandleByPciBusId(). or nvmlDeviceGetHandleByUUID().&quot;"}, {"owner": {"reputation": 51, "user_id": 6646645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd1a62d1e1b506ed4b2e648dc010c07?s=128&d=identicon&r=PG&f=1", "display_name": "arm", "link": "https://stackoverflow.com/users/6646645/arm"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1553702032, "post_id": 55377048, "comment_id": 97485034, "body": "Thanks.You helped me a lot."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1553702341, "post_id": 55377048, "comment_id": 97485263, "body": "I will add that as an answer if you would like to accept it"}], "answers": [{"tags": [], "owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "is_accepted": true, "score": 1, "last_activity_date": 1553702507, "creation_date": 1553702507, "answer_id": 55381640, "question_id": 55377048, "link": "https://stackoverflow.com/questions/55377048/which-function-returns-nvmldevice-t-type-variable-in-cuda-nvml-library/55381640#55381640", "title": "Which function returns &quot;nvmlDevice_t&quot; type variable in cuda/nvml library?", "body": "<p>Quoting from the <a href=\"https://docs.nvidia.com/deploy/nvml-api/group__nvmlDeviceQueries.html\" rel=\"nofollow noreferrer\">documentation</a> preamble:</p>\n\n<blockquote>\n  <p>This chapter describes that queries that NVML can perform against each\n  device. In each case the device is identified with an nvmlDevice_t\n  handle. This handle is obtained by calling one of\n  <a href=\"https://docs.nvidia.com/deploy/nvml-api/group__nvmlDeviceQueries.html#group__nvmlDeviceQueries_1g52677ecb45f937c5005124608780a3f4\" rel=\"nofollow noreferrer\">nvmlDeviceGetHandleByIndex()</a>, <a href=\"https://docs.nvidia.com/deploy/nvml-api/group__nvmlDeviceQueries.html#group__nvmlDeviceQueries_1g3e4b72c1aef967266930ba0388a76628\" rel=\"nofollow noreferrer\">nvmlDeviceGetHandleBySerial()</a>,\n  <a href=\"https://docs.nvidia.com/deploy/nvml-api/group__nvmlDeviceQueries.html#group__nvmlDeviceQueries_1g3e4b72c1aef967266930ba0388a76628\" rel=\"nofollow noreferrer\">nvmlDeviceGetHandleByPciBusId()</a>. or <a href=\"https://docs.nvidia.com/deploy/nvml-api/group__nvmlDeviceQueries.html#group__nvmlDeviceQueries_1g72710fb20f30f0c2725ce31579832654\" rel=\"nofollow noreferrer\">nvmlDeviceGetHandleByUUID()</a>.</p>\n</blockquote>\n\n<p>With that, it should be fairly self-explanatory to get the handle you require.</p>\n"}], "owner": {"reputation": 51, "user_id": 6646645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd1a62d1e1b506ed4b2e648dc010c07?s=128&d=identicon&r=PG&f=1", "display_name": "arm", "link": "https://stackoverflow.com/users/6646645/arm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 55381640, "answer_count": 1, "score": 1, "last_activity_date": 1555414943, "creation_date": 1553689169, "last_edit_date": 1555414943, "question_id": 55377048, "link": "https://stackoverflow.com/questions/55377048/which-function-returns-nvmldevice-t-type-variable-in-cuda-nvml-library", "title": "Which function returns &quot;nvmlDevice_t&quot; type variable in cuda/nvml library?", "body": "<p>I am working with gpu's and want to get the serial numbers of the gpu's.In NVIDIA Management Library there is a function that I can use. The function prototype is. \n<code>nvmlReturn_t nvmlDeviceGetSerial ( nvmlDevice_t device, char* serial, unsigned int  length );</code>\nThe first parameter is \"nvmlDevice_t device\".I have searched a lot but does not find any function which returns this type.So how can I get this?</p>\n"}, {"tags": ["c++", "variadic-templates", "variadic-functions"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1553689886, "post_id": 55377013, "comment_id": 97476539, "body": "You can&#39;t use double values as template parameters, see the linked question for background information. There&#39;s no way around it, you will have to come up with some alternative approach that does not involve double template parameters."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1553690181, "post_id": 55377013, "comment_id": 97476746, "body": "@SamVarshavchik Can we not close this as a dupe but instead acknowledge they can&#39;t do what they have because of the dupe so how can they work around it."}, {"owner": {"reputation": 12965, "user_id": 245416, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2dd35668d8f2c8931d75793fc3a52cf6?s=128&d=identicon&r=PG", "display_name": "Abruzzo Forte e Gentile", "link": "https://stackoverflow.com/users/245416/abruzzo-forte-e-gentile"}, "edited": false, "score": 0, "creation_date": 1553691453, "post_id": 55377013, "comment_id": 97477595, "body": "I see..so is like using literals string for template..interesting. I didn&#39;t think about it at all.Thanks for pointing me to the right response; I googled for similar questions but I was not able to find anything like that."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553691670, "post_id": 55377013, "comment_id": 97477750, "body": "@AbruzzoForteeGentile FWIW, you could write the code like <a href=\"http://coliru.stacked-crooked.com/a/7de9a391d49ce51d\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 12965, "user_id": 245416, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2dd35668d8f2c8931d75793fc3a52cf6?s=128&d=identicon&r=PG", "display_name": "Abruzzo Forte e Gentile", "link": "https://stackoverflow.com/users/245416/abruzzo-forte-e-gentile"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553694276, "post_id": 55377013, "comment_id": 97479568, "body": "@Nathan. Wow! That&#39;s pretty hard-core! I never seen using the &#39;...&#39; like that? In fact I don&#39;t understand much how your function works (sorry). I am used to  recursively call of a variadic template with less argument...I have no idea how your  function is expanding.   Can you point me to some useful tip for further reading or investigation?  I found this usage truly amazing."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553694445, "post_id": 55377013, "comment_id": 97479700, "body": "@AbruzzoForteeGentile I used a <a href=\"https://en.cppreference.com/w/cpp/language/fold\" rel=\"nofollow noreferrer\">fold expression</a>.  It makes life soooooooo much easier.  The gist of it is that <code>(find == in)</code> is the expression we want to do, and then we will or that with each additional <code>in</code>, so it expands out to <code>(find == in1) || (find == in2) || ... || (find == inN)</code>"}, {"owner": {"reputation": 12965, "user_id": 245416, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2dd35668d8f2c8931d75793fc3a52cf6?s=128&d=identicon&r=PG", "display_name": "Abruzzo Forte e Gentile", "link": "https://stackoverflow.com/users/245416/abruzzo-forte-e-gentile"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1553699252, "post_id": 55377013, "comment_id": 97483135, "body": "@NathanOliver Sir, I thank you very much for this input. It is a very interesting topic I was not aware and worth to explore. Have a great day!"}], "owner": {"reputation": 12965, "user_id": 245416, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2dd35668d8f2c8931d75793fc3a52cf6?s=128&d=identicon&r=PG", "display_name": "Abruzzo Forte e Gentile", "link": "https://stackoverflow.com/users/245416/abruzzo-forte-e-gentile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1553695916, "creation_date": 1553689065, "question_id": 55377013, "link": "https://stackoverflow.com/questions/55377013/error-while-generalizing-my-variadic-template-function", "title": "error while generalizing my variadic template function", "body": "<p>I implemented the template function below using variadic, but I am having difficulties in making it more generic. I am using MS VS C++ 2017.</p>\n\n<p>This function essentially checks if an integer value is one of the values provided int templates argument. In theory should be equivalent to a list of logical OR.</p>\n\n<pre><code>template&lt;int TFirst, int...TArgs&gt;\nconstexpr bool foo(int&amp;&amp; a)\n{\n    if constexpr (sizeof...(TArgs) &gt; 0)         \n        return a == TFirst || foo&lt;TArgs...&gt;(std::forward&lt;int&gt;(a));    \n    return a == TFirst;\n}\n\nint iii = 3;\nassert(foo&lt;1, 2, 3&gt;(std::forward&lt;int&gt;(iii)); // ok!\n</code></pre>\n\n<p>I would like to make this function even more generic using other numeric types like double or class enums or even objects.</p>\n\n<p>I tried the code below. It builds  with integers, but NOT with doubles.</p>\n\n<pre><code> template&lt;typename T&gt;\n struct check\n {\n     template&lt;T TFirst, T...TArgs&gt;\n     static constexpr bool foo(T&amp;&amp; a)\n     {\n         if constexpr (sizeof...(TArgs) &gt; 0)\n            return a == TFirst || foo&lt;TArgs...&gt;(std::forward&lt;T&gt;(a));\n         return a == TFirst;\n     }\n };\n\n// test\nint iii = 3;\ndouble ddd = 4.0;\n\ncheck&lt;int&gt;::foo&lt;1, 2, 3&gt;(std::forward&lt;int&gt;(iii));  // ok\ncheck&lt;double&gt;::foo&lt;1.0, 2.0, 3.0&gt;(std::forward &lt; double &gt;(ddd )); // non ok\n</code></pre>\n\n<p>Error I have with double is</p>\n\n<pre><code> error C2993: 'T': illegal type for non-type template parameter 'TFirst'\n error C2672: 'check&lt;double&gt;::foo': no matching overloaded function found\n</code></pre>\n\n<p>Is there any fix this or better way to make my function more generic?</p>\n"}, {"tags": ["c++", "auto"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 3, "creation_date": 1553688593, "post_id": 55376824, "comment_id": 97475730, "body": "Please <i>never</i> paste errors as pictures."}, {"owner": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "edited": false, "score": 0, "creation_date": 1553688666, "post_id": 55376824, "comment_id": 97475779, "body": "please format your code properly."}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1553688679, "post_id": 55376824, "comment_id": 97475788, "body": "In the second code, each constructed <code>conv::des</code> will be destructed at the end of each if-block."}, {"owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 0, "creation_date": 1553688694, "post_id": 55376824, "comment_id": 97475803, "body": "<code>conv_desc</code> is a pointer why not just define it as <code>conv::des conv_desc</code> type and assign based on your if/else logic."}, {"owner": {"reputation": 498, "user_id": 9197735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yz9UH.jpg?s=128&g=1", "display_name": "\u51af\u5251\u9f99", "link": "https://stackoverflow.com/users/9197735/%e5%86%af%e5%89%91%e9%be%99"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1553688782, "post_id": 55376824, "comment_id": 97475855, "body": "@PasserBy, So How do you express the errors. If you have an idea, please help me edit it."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1553689442, "post_id": 55376824, "comment_id": 97476258, "body": "@\u51af\u5251\u9f99 &quot;<i>So How do you express the errors.</i>&quot; In the same way, as you have provided your code (or, at least, one version of it). By copy-pasting it. One cannot copy-paste from screenshot."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1553689601, "post_id": 55376824, "comment_id": 97476359, "body": "By copy-pasting it <i>as text</i> to be precise. Also I must say that for some reason text on these images is even less readable than on usual images of text. It seems so blurry..."}], "answers": [{"comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1553690357, "post_id": 55377003, "comment_id": 97476844, "body": "<code>null</code> does not exist in C++, use <code>nullptr</code> and you don&#39;t have to check if a variable is null before deleting."}, {"owner": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1553691357, "post_id": 55377003, "comment_id": 97477521, "body": "I&#39;m pretty sure i got tossed an segfault last time I tried to delete a ptr with value \\x00"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1553691439, "post_id": 55377003, "comment_id": 97477582, "body": "You got UB somewhere else then."}, {"owner": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1553757558, "post_id": 55377003, "comment_id": 97504848, "body": "@GuillaumeRacicot everyone in the post you linked uses <code>NULL</code> instead of <code>nullptr</code>"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1553775490, "post_id": 55377003, "comment_id": 97514950, "body": "This is a good opportunity to suggest edits then. Most of these response are from 9 years ago. <code>nullptr</code> did not exist back then."}, {"owner": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1553778076, "post_id": 55377003, "comment_id": 97516709, "body": "@GuillaumeRacicot I guess I&#39;m not up to date with the fancy new c++11 and 17 then. Never had much reason to anyway. I find it weird how a programming language like c++ is expanded and changed. Who determines what happens anyway? Someone has to write the specifications and the compilers have to keep up with it?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "edited": false, "score": 0, "creation_date": 1553781230, "post_id": 55377003, "comment_id": 97518972, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/190845/discussion-between-guillaume-racicot-and-falcoger\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "is_accepted": false, "score": 2, "last_activity_date": 1553843912, "last_edit_date": 1553843912, "creation_date": 1553689034, "answer_id": 55377003, "question_id": 55376824, "link": "https://stackoverflow.com/questions/55376824/is-it-possible-to-declare-auto-variables-with-an-if/55377003#55377003", "title": "Is it possible to declare auto variables with an if?", "body": "<p>Don't use auto. If you need to declare a variable and can't assign a value yet, then auto can't be used.</p>\n\n<pre><code>int main(int argc, const char * argv[]) {\n    // ...\n    conv::des conv_desc; // calls default constructor.\n\n    if (a &gt; 1)\n    {\n        conv_desc = conv::des(1, 2, 3);\n    } else if(b &gt; 1) {\n        conv_desc = conv::des(1, 2);\n    } else {\n        conv_desc = conv::des(1);\n    }\n    // conv_desc is initialized at this point.\n    return 0;\n}\n</code></pre>\n\n<p>You can't use a pointer like this</p>\n\n<pre><code>int *a;\n{ // new scope\n    int b = 5;\n    a = &amp;b; // error.\n}\n// b is no longer in scope here\n</code></pre>\n\n<p>When <code>b</code> goes out of scope, then <code>a</code> will be pointing at the address where <code>b</code> used to be, which is now no longer valid.</p>\n\n<p>If you want to use a pointer then you can use new. However in that case you <em>must</em> release the memory afterwards.</p>\n\n<pre><code>int main(int argc, const char** argv)\n{\n    conv::des *conv_desc = nullptr; // does not call default constructor.\n\n    if (a &gt; 1)\n    {\n        conv_desc = new conv::des(1, 2, 3);\n    } else if(b &gt; 1) {\n        conv_desc = new conv::des(1, 2);\n    } else {\n        conv_desc = new conv::des(1);\n    }\n    if (conv_desc == nullptr) { /* memory allocation failed */ }\n    // conv_desc is initialized at this point.\n    // ...\n    // remember to delete conv_desc\n    if (conv_desc != nullptr) { delete conv_desc; conv_desc = nullptr; }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 839, "user_id": 1135979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59464968f70aff62c07a7da3a0f6ba80?s=128&d=identicon&r=PG", "display_name": "yachoor", "link": "https://stackoverflow.com/users/1135979/yachoor"}, "is_accepted": true, "score": 4, "last_activity_date": 1553689168, "creation_date": 1553689168, "answer_id": 55377047, "question_id": 55376824, "link": "https://stackoverflow.com/questions/55376824/is-it-possible-to-declare-auto-variables-with-an-if/55377047#55377047", "title": "Is it possible to declare auto variables with an if?", "body": "<p>Move your <code>if</code> code into separate function:</p>\n\n<pre><code>conv::des make_des(int a, int b) {\n  if (a &gt; 1) {\n    return conv::des(1, 2, 3);\n  } else if(b &gt; 1) {\n    return conv::des(1, 2);\n  } else {\n    return conv::des(1);\n  }\n}\n\nint main(int argc, const char * argv[]) {\n  int a = 1;\n  int b = 1;\n  int c = 1;\n  auto conv_desc = make_des(a, b);\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "edited": false, "score": 0, "creation_date": 1553689264, "post_id": 55377070, "comment_id": 97476142, "body": "someone beat you to it"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "edited": false, "score": 1, "creation_date": 1553689352, "post_id": 55377070, "comment_id": 97476198, "body": "@FalcoGer Now people keeping <code>{</code> on the same line will brag that it is faster. DDD"}, {"owner": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "edited": false, "score": 0, "creation_date": 1553689895, "post_id": 55377070, "comment_id": 97476544, "body": "how is that faster? it generates the same assembly... in fact white spaces have no bearing on anything in c/c++ (except to seperate words of course)"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 1790, "user_id": 10263660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02f3119d15c8c155ff25968fdf5a145?s=128&d=identicon&r=PG&f=1", "display_name": "FalcoGer", "link": "https://stackoverflow.com/users/10263660/falcoger"}, "edited": false, "score": 0, "creation_date": 1553690172, "post_id": 55377070, "comment_id": 97476739, "body": "@FalcoGer I mean that it allows to write answers faster and beat people putting <code>{</code> on the separate line."}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 1, "last_activity_date": 1553689265, "last_edit_date": 1553689265, "creation_date": 1553689241, "answer_id": 55377070, "question_id": 55376824, "link": "https://stackoverflow.com/questions/55376824/is-it-possible-to-declare-auto-variables-with-an-if/55377070#55377070", "title": "Is it possible to declare auto variables with an if?", "body": "<p>If you move the <code>if ... else</code> chain into a separate function, you can use <code>return</code></p>\n\n<pre><code>struct conv\n{\n    struct des\n    {\n        des(int a) {\n        }\n\n        des(int a, int b) {\n        }\n\n        des(int a, int b, int c) {\n        }\n    };\n};\n\nconv::des make_conv_des(int a, int b)\n{\n    if (a &gt; 1) {\n        return conv::des(1, 2, 3);\n    } else if(b &gt; 1) {\n        return conv::des(1, 2);\n    } else {\n        return conv::des(1);\n    }\n}\n\nint main(int argc, const char * argv[]) {\n\n    int a = 1;\n    int b = 1;\n\n    auto conv_des = make_conv_des(a, b);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1553689948, "post_id": 55377161, "comment_id": 97476580, "body": "You don&#39;t need any capture here, just pass <code>a</code> and <code>b</code> as ordinary parameters"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1553696080, "post_id": 55377161, "comment_id": 97480878, "body": "@Caleth passing by capture is clearer for this idiom I think. There is a really high chance of comple optimisation, for both parameter passing and captures"}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 2, "last_activity_date": 1553689536, "creation_date": 1553689536, "answer_id": 55377161, "question_id": 55376824, "link": "https://stackoverflow.com/questions/55376824/is-it-possible-to-declare-auto-variables-with-an-if/55377161#55377161", "title": "Is it possible to declare auto variables with an if?", "body": "<p>You also can use an immediately called lambda. This is a common pattern to make some variables const when they could not otherwise.</p>\n\n<p>This solution is very similar to @yachoor answer but uses a lambda.</p>\n\n<pre><code>int main(int argc, const char * argv[]) {\n    int a = 1;\n    int b = 1;\n    int c = 1;\n\n    // Kind of an inline function that is called immediately\n    auto const conv_desc = [&amp;]{\n        if (a &gt; 1) {\n            return conv::des(1, 2, 3);\n        } else if(b &gt; 1) {\n            return conv::des(1, 2);\n        } else {\n            return conv::des(1);\n        }\n    }();\n    // Parens calls the function\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "is_accepted": false, "score": 2, "last_activity_date": 1553689913, "creation_date": 1553689913, "answer_id": 55377280, "question_id": 55376824, "link": "https://stackoverflow.com/questions/55376824/is-it-possible-to-declare-auto-variables-with-an-if/55377280#55377280", "title": "Is it possible to declare auto variables with an if?", "body": "<p>Seems like you are making the code overly-complicated.  It is not clear why you would want to differentiate between these three constructors in this way.  Why not hide the complexity inside the object by using default values like this?</p>\n\n<pre><code>struct conv{\n    struct des\n    {\n        des(int a, int b = 0, int c = 0) {\n          if(a &gt; 1) {\n            /// do some logic\n          } else if(b &gt; 1) {\n            // do some logic\n          } else {\n            // do some logic\n          }\n\n        }\n    };\n};\nint main(int argc, const char * argv[]) {\n\n  int a = 1;\n  int b = 1;\n  int c = 1;\n\n  auto conv_desc = conv::des(a, b, c);\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 498, "user_id": 9197735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yz9UH.jpg?s=128&g=1", "display_name": "\u51af\u5251\u9f99", "link": "https://stackoverflow.com/users/9197735/%e5%86%af%e5%89%91%e9%be%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 1, "accepted_answer_id": 55377047, "answer_count": 5, "score": -4, "last_activity_date": 1553843912, "creation_date": 1553688458, "last_edit_date": 1553689637, "question_id": 55376824, "link": "https://stackoverflow.com/questions/55376824/is-it-possible-to-declare-auto-variables-with-an-if", "title": "Is it possible to declare auto variables with an if?", "body": "<p>My Code is below.</p>\n\n<pre><code>struct conv{\n    struct des\n    {\n        des(int a) {}\n        des(int a, int b) {}\n        des(int a, int b, int c) {}\n    };\n};\nint main(int argc, const char * argv[]) {\n\nint a = 1;\nint b = 1;\nint c = 1;\n\nif (a &gt; 1)\n{\n    auto conv_desc = conv::des(1, 2, 3);\n} else if(b &gt; 1) {\n    auto conv_desc = conv::des(1, 2);\n} else {\n    auto conv_desc = conv::des(1);\n}\n    return 0;\n}\n</code></pre>\n\n<p>The code's pattern is extracted from mkldnn. The only thing I want to do is take auto conv_desc out of the if-else statement. \nI tried to declare auto conv_desc out of the if-else statement. \nIt occurred an error:\nDeclaration of</p>\n\n<blockquote>\n  <p>variable 'conv_desc' with deduced type 'auto' requires an initializer</p>\n</blockquote>\n\n<p>Or if I used the pointer like below, I got a null pointer.\n<a href=\"https://i.stack.imgur.com/RQXLH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RQXLH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Another way got an error:\n<a href=\"https://i.stack.imgur.com/TMgAO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TMgAO.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>Taking the address of a temporary object of type 'conv::des'</p>\n</blockquote>\n\n<p>If I can't solve this problem, I will have to write a large piece of duplicate code in each branch.</p>\n"}, {"tags": ["c++", "move"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1553687804, "post_id": 55376494, "comment_id": 97475240, "body": "With <code>move</code>, you have undefined behavior, because your destructor accesses <code>_name</code> which is in an unspecified state."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 3, "creation_date": 1553687849, "post_id": 55376494, "comment_id": 97475279, "body": "It looks like that implementation of <code>std::string</code> does a swap when moving. Hence <code>Destructor T1</code> is really the destructor of <code>B(&quot;T2&quot;)</code> after it has been moved from. Testing on my side produced <code>Destructor </code> (empty string)."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 4, "creation_date": 1553687900, "post_id": 55376494, "comment_id": 97475310, "body": "@Eljay unspecified <i>but valid</i> state, so it doesn&#39;t go as far as UB."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1553687983, "post_id": 55376494, "comment_id": 97475362, "body": "Wasn&#39;t saying it was UB, just saying it is unspecified state.  As Quentin clarified, unspecified but valid state.  There is very little one can do with it in that state.  It can be assigned to, it can be destructed."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 2, "creation_date": 1553689681, "post_id": 55376494, "comment_id": 97476415, "body": "@Eljay &quot;<i>Wasn&#39;t saying it was UB, just saying it is unspecified state.</i>&quot; But, you said &quot;<i>With <code>move</code>, you have undefined behavior</i>&quot; So did you say it, or did you not say it?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1553693762, "post_id": 55376494, "comment_id": 97479221, "body": "When you have <code>_name</code> in a valid-but-unspecified state you can do two things with it:  you can initialize it, or you can destruct it.  The code is doing <code>std::cout &lt;&lt; &quot;Destructor &quot; &lt;&lt; _name &lt;&lt; std::endl;</code> with it, which is undefined behavior when it is done with <code>_name</code> while <code>_name</code> is in a valid-but-unspecified state.  (I was confused as to which thing was being referred, my fault.)"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1553695743, "post_id": 55376494, "comment_id": 97480646, "body": "@Eljay With an object in valid a state, you can do all things that don&#39;t have preconditions. UB happens when the preconditions are not satisfied. Does there exist for a string any valid state in which it would not be well defined to insert into a stream?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1553709861, "post_id": 55376494, "comment_id": 97489529, "body": "@eerorika \u2022 My understanding -- based on what I was told by my coworker Sean Parent in his Better C++ lectures -- in general an object that is moved from is in a valid-but-unspecified-state in which the only two operations that can be performed on it are initialization (assignment), or destruction.  <code>std::vector</code> has a slightly stronger guarantee, but in general that&#39;s it.  He did not cite the relevant passages in the standard (and I no longer feign to be a language lawyer after C++11 came out)."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 5, "last_activity_date": 1553689140, "last_edit_date": 1553689140, "creation_date": 1553688794, "answer_id": 55376938, "question_id": 55376494, "link": "https://stackoverflow.com/questions/55376494/default-move-assignment-calls-destructor-copy-assignment-doesnt/55376938#55376938", "title": "Default move assignment calls destructor, copy assignment doesn&#39;t", "body": "<blockquote>\n  <p>Default move assignment calls destructor, copy assignment doesn't</p>\n</blockquote>\n\n<p>Both assignments result in the destruction of a temporary <code>B</code> object, so the destructor is called.</p>\n\n<blockquote>\n  <p>replace with a new instance using assignment</p>\n</blockquote>\n\n<p>Pedantic note: Assignment doesn't replace instances. The instance remains the same; the value of the instance is modified. This distinction may be subtle, but may also be relevant to your confusion.</p>\n\n<blockquote>\n  <p>When Test doesn't have move assignment (thus its copy assignment is called) the destructor of T1 object isn't explicitely called.</p>\n</blockquote>\n\n<p>It's somewhat unclear what you mean by \"T1 object\". The variable <code>b</code> that you initialised with <code>\"T1\"</code> is destroyed. But when it is destroyed, it's value has previously been assigned to <code>\"T2\"</code>, so that's what the destructor inserts into <code>cout</code>. This happens in both move and copy cases, and this is the second <code>Destructor TX</code> line in the output.</p>\n\n<blockquote>\n  <p>Why is it different when move assignment is there (and called), however?</p>\n</blockquote>\n\n<p>The difference is when the temporary object from the line <code>b = B(\"T2\")</code> is destroyed. This is the first <code>Destructor TX</code> line in the output.</p>\n\n<p>After copy assignment, this temporary will still hold the <code>\"T2\"</code> value, so that's what you see in the destructor.</p>\n\n<p>After move assignment, the temporary is no longer guaranteed to contain <code>\"T2\"</code>, but rather it is left in a valid but unspecified state (as described in specification of <code>std::string</code>), so output could be anything. In this case it happened to be <code>\"T1\"</code>. (Based on this result, we might make a guess that the move assignment operator of the string may have been implemented by swapping the internal buffers. This observation is not a guaranteed behaviour).</p>\n\n<blockquote>\n  <p>The documentation specifies that the other after move assignment can be left in whatever state. How come the destructor for T2's temporal rvalue (i.e. the right side of =B(\"T2\")) isn't called in case B's member doesn't have move assignment? </p>\n</blockquote>\n\n<p>The destructor of the temporary <em>is</em> called. The temporary simply is no longer in the state described by \"contains <code>\"T2\"</code>\" after it has been moved from.</p>\n"}], "owner": {"reputation": 671, "user_id": 915609, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cd843ae30df85b70bef2f208afb8ced?s=128&d=identicon&r=PG", "display_name": "Petrroll", "link": "https://stackoverflow.com/users/915609/petrroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 1, "accepted_answer_id": 55376938, "answer_count": 1, "score": 0, "last_activity_date": 1553689140, "creation_date": 1553687414, "question_id": 55376494, "link": "https://stackoverflow.com/questions/55376494/default-move-assignment-calls-destructor-copy-assignment-doesnt", "title": "Default move assignment calls destructor, copy assignment doesn&#39;t", "body": "<p>I'm observing a strange behavior I don't quite understand with respect to destructors and (default) copy and move assignments. </p>\n\n<p>Let's say I have a class <code>B</code> that has default everything and a class <code>Test</code> that has custom destructor, default copy assignment, and (potentially) default move assignment. </p>\n\n<p>Then we create an instance of <code>B</code>, assign it to a variable, and replace with a new instance using assignment (where the right side is rvalue).</p>\n\n<p>Two things seems weird to me and I can't see the reason for them in documentation. </p>\n\n<ol>\n<li>When <code>Test</code> doesn't have <code>move assignment</code> (thus its copy assignment is called) the destructor of <code>T1</code> object isn't explicitely called. I assume that in this case the idiomatic thing to do is to clean the resources as part of the <code>copy assignment</code>. Why is it different when <code>move assignment</code> is there (and called), however? If its there the <code>Test</code>'s destructor is called explicitely (?by the operator).</li>\n<li>The documentation specifies that the <code>other</code> after move assignment can be left in whatever state. How come the destructor for T2's temporal rvalue (i.e. the right side of <code>=B(\"T2\")</code>) isn't called in case B's member doesn't have <code>move assignment</code>? </li>\n</ol>\n\n<p>Playground code: <a href=\"https://onlinegdb.com/S1lCYmkKOV\" rel=\"nofollow noreferrer\">https://onlinegdb.com/S1lCYmkKOV</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nclass Test\n{\npublic:\n    std::string _name;\n\n    Test(std::string name) : _name(name) { }\n    ~Test()\n    {\n        std::cout &lt;&lt; \"Destructor \" &lt;&lt; _name &lt;&lt; std::endl;\n    }\n    Test&amp; operator=(const Test&amp; fellow) = default;\n    //Test &amp; operator= ( Test &amp;&amp; ) = default;\n\n};\n\nclass B {\npublic:\nTest t;\n\nB() : t(\"T0\") {}\n\nB(std::string n) : t(n) {}\n};\n\nint fce(B&amp; b)\n{\n   std::cout &lt;&lt; \"b = B(T2)\\n\";\n   b = B(\"T2\");\n   std::cout &lt;&lt; \"return 0\\n\";\n\n   return 0;\n}\n\n\nint main() {\n    B b(\"T1\");\n    std::cout &lt;&lt; \"fce call\\n\";\n    fce(b);\n    std::cout &lt;&lt; \"fce end \" &lt;&lt; b.t._name &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Output with move: </p>\n\n<pre><code>fce call\nb = B(T2)\nDestructor T1\nreturn 0\nfce end T2\nDestructor T2\n</code></pre>\n\n<p>Output without move: </p>\n\n<pre><code>fce call\nb = B(T2)\nDestructor T2\nreturn 0\nfce end T2\nDestructor T2\n</code></pre>\n"}, {"tags": ["python", "c++", "boost", "boost-python"], "comments": [{"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1553715539, "post_id": 55376475, "comment_id": 97492323, "body": "When I have a c++ class object that I need to use from python code, I provide an identifier string, and pass that string to a module function which does whatever I need it to do in c++. So instead of returning a map, I&#39;ll just have the python code pass in the map key, so the c++ function can look it up in the map (internal to the c++ extension module) and do whatever it needs to do. (sometimes the identifier is just the pointer, but python doesn&#39;t know or care about that)"}, {"owner": {"reputation": 530, "user_id": 2904770, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fvre9.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/2904770/phil"}, "reply_to_user": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1553719951, "post_id": 55376475, "comment_id": 97494359, "body": "Thanks. So you wrap the C++ method that returns the map with a C++ function taking the key and returning the value only? This is how my original code worked.  You can even have your C++ helper return a dict of the whole map. Nothing wrong with this. My reason for looking beyond is to minimize any C++ middleware component I&#39;ll need to maintain between the 3rd party library and my python, also for debugging I like to be able to iterate over the whole map in pdb in python without worrying (so much) if there is a bug in my middleware... and lastly, I was just curious to see if it was possible :)"}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 2904770, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fvre9.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/2904770/phil"}, "is_accepted": true, "score": 0, "last_activity_date": 1553826951, "creation_date": 1553826951, "answer_id": 55409718, "question_id": 55376475, "link": "https://stackoverflow.com/questions/55376475/boost-python-when-c-method-returns-stdmapstring-x/55409718#55409718", "title": "boost-python when C++ method returns std::map&lt;string,X*&gt;", "body": "<p>Slightly cleaner implementation from the cut-and-paste is to inherit map_indexing_suite - a few tweaks are needed to make this work.</p>\n\n<p>This seems reasonably sensible - if someone chimes in with a neater solution or can better explain <code>DerivedPolicies</code> then great, otherwise I'll accept the below as the answer in a few days or so...</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>using namespace boost;\nusing namespace boost::python;\n\n//Forward declaration\ntemplate &lt;class Container, bool NoProxy, class DerivedPolicies&gt;\nclass mapptr_indexing_suite;\n\ntemplate &lt;class Container, bool NoProxy&gt;\nclass final_mapptr_derived_policies\n    : public mapptr_indexing_suite&lt;Container,\n        NoProxy, final_mapptr_derived_policies&lt;Container, NoProxy&gt; &gt; {};\n\ntemplate &lt;\n    class Container,\n    bool NoProxy = false,\n    class DerivedPolicies\n        = final_mapptr_derived_policies&lt;Container, NoProxy&gt; &gt;\nclass mapptr_indexing_suite\n    : public map_indexing_suite&lt;\n    Container,\n    NoProxy,\n    DerivedPolicies\n    &gt;\n{\npublic:\n    // Must be explicit if the compiler is\n    // going to take from the base class\n    using typename map_indexing_suite&lt;\n        Container,NoProxy,DerivedPolicies&gt;::data_type;\n    using typename map_indexing_suite&lt;\n        Container,NoProxy,DerivedPolicies&gt;::value_type;\n\n    // Only one class needs to be overridden from the base\n    template &lt;class Class&gt;\n    static void\n    extension_def(Class&amp; cl)\n    {\n        //  Wrap the map's element (value_type)\n        std::string elem_name = \"mapptr_indexing_suite_\";\n        object class_name(cl.attr(\"__name__\"));\n        extract&lt;std::string&gt; class_name_extractor(class_name);\n        elem_name += class_name_extractor();\n        elem_name += \"_entry\";\n\n        // use of is_pointer here is the only\n        // difference to the base map_indexing_suite\n        typedef typename mpl::if_&lt;\n            mpl::and_&lt;std::is_pointer&lt;data_type&gt;, mpl::bool_&lt;!NoProxy&gt; &gt;\n            , return_internal_reference&lt;&gt;\n            , default_call_policies\n            &gt;::type get_data_return_policy;\n\n        class_&lt;value_type&gt;(elem_name.c_str())\n            .def(\"__repr__\", &amp;DerivedPolicies::print_elem)\n            .def(\"data\", &amp;DerivedPolicies::get_data, get_data_return_policy())\n            .def(\"key\", &amp;DerivedPolicies::get_key)\n            ;\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 530, "user_id": 2904770, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fvre9.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/2904770/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 1, "accepted_answer_id": 55409718, "answer_count": 1, "score": 3, "last_activity_date": 1553826951, "creation_date": 1553687332, "last_edit_date": 1553826919, "question_id": 55376475, "link": "https://stackoverflow.com/questions/55376475/boost-python-when-c-method-returns-stdmapstring-x", "title": "boost-python when C++ method returns std::map&lt;string,X*&gt;", "body": "<p>I'm exposing an API to Python, written in C++ that I have no access to change, using Boost Python.</p>\n\n<p>I have successfully exposed methods returning references to a std:map where the key,value pairs are value types - eg:</p>\n\n<pre><code>class_&lt; std::map&lt;std::string, std::string&gt; &gt;(\"StringMap\")\n    .def(map_indexing_suite&lt; std::map&lt;std::string, std::string&gt;, true &gt;());\n</code></pre>\n\n<p>This works seamlessly.  But when trying to achieve a similar result where the map values are pointers to classes I've exposed within the API doesn't work:</p>\n\n<pre><code>struct X_wrap : X, wrapper&lt;X&gt;\n{\n     X_wrap(int i): X(i) {}\n    // virtual methods here, omitted for brevity - as unlikely to be the issue\n}\n\nBOOST_PYTHON_MODULE(my_py_extension)\n{\n\n    class_&lt; std::map&lt;std::string, X*&gt; &gt;(\"XPtrMap\")\n        .def(map_indexing_suite&lt; std::map&lt;std::string, X*&gt; &gt;());\n\n    class_&lt;X_wrap, boost::noncopyable, bases&lt;XBase&gt; &gt;(\"X\", init&lt;int&gt;())\n\n   // other definitions omitted\n}\n</code></pre>\n\n<p>Error seen in g++ 7.3.0:</p>\n\n<pre><code>/usr/include/boost/python/detail/caller.hpp:100:98: error: \u2018struct boost::python::detail::specify_a_return_value_policy_to_wrap_functions_returning&lt;X*&gt;\u2019 has no member named \u2018get_pytype\u2019\n</code></pre>\n\n<p>I understand why the compiler is complaining - the <code>X*</code> in the map needs to be wrapped in a call policy so that it can be returned to Python, just like with a basic method that returns a raw pointer.</p>\n\n<p>My question is what is the best way to do this?</p>\n\n<p>From Googling it strikes that I can perhaps specify a <code>DerivedPolicies</code> child class of <code>map_indexing_suite</code> that will overload the necessary parts to wrap the X* in an appropriate <code>return_value_policy</code>.  However so far I've be unsuccessful in putting anything together that the compiler doesn't bawk at!</p>\n\n<p>I also suspect I can literally copy-and-paste the whole <code>map_indexing_suite</code> and rename it, and make the changes therein to produce a new <code>indexing_suite</code> with the right <code>return_value_policy</code>, but this seems ugly compared to the solution using <code>DerviedPolicies</code> - assuming I'm right that <code>DeriviedPolicies</code> can be used at all!</p>\n\n<p>Any help, pointers, or examples gratefully received!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have proved that the cut-and-paste option works with a single trivial change of <code>is_class</code> to <code>is_pointer</code>.  It's curious that <code>is_pointer</code> is not allowed in the original as the target policy can handle pointers.  I'm yet to convince myself that it's an object lifetime restriction that means pointers are not allowed in the original?</p>\n\n<p>The whole class is public so I suspect it's possible to avoid the full cut-and-paste by simply inheriting from <code>map_indexing_suite</code> or perhaps by using the mysterious <code>DerivedPolicies</code> parameter?</p>\n\n<pre><code>    extension_def(Class&amp; cl)\n    {\n        //  Wrap the map's element (value_type)\n        std::string elem_name = \"mapptr_indexing_suite_\";\n        object class_name(cl.attr(\"__name__\"));\n        extract&lt;std::string&gt; class_name_extractor(class_name);\n        elem_name += class_name_extractor();\n        elem_name += \"_entry\";\n\n        typedef typename mpl::if_&lt;\n            mpl::and_&lt;is_pointer&lt;data_type&gt;, mpl::bool_&lt;!NoProxy&gt; &gt;\n          , return_internal_reference&lt;&gt;\n          , default_call_policies\n        &gt;::type get_data_return_policy;\n\n        class_&lt;value_type&gt;(elem_name.c_str())\n            .def(\"__repr__\", &amp;DerivedPolicies::print_elem)\n            .def(\"data\", &amp;DerivedPolicies::get_data, get_data_return_policy())\n            .def(\"key\", &amp;DerivedPolicies::get_key)\n        ;\n    }\n</code></pre>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>Now see answer</p>\n"}]