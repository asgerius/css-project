[{"tags": ["c++"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 2, "creation_date": 1534981038, "post_id": 51976497, "comment_id": 90903224, "body": "This will not do what you want: the statements in the constructor body create temporary variables of the same type <code>Window</code>, which are then immediately discarded, and the members of the object being constructed are still in their default-initialized state."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1534982212, "post_id": 51976497, "comment_id": 90903418, "body": "<b>\u22121</b> You should ask a new question with your actual <code>ValueContainer</code> problem, because the <code>Window</code> analogy in the main question is nothing like it. A reasonable answer to that doesn&#39;t apply to your problem."}, {"owner": {"reputation": 71, "user_id": 10186426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af0be89a518b6d4e55b733d29eb033d?s=128&d=identicon&r=PG&f=1", "display_name": "JulSe", "link": "https://stackoverflow.com/users/10186426/julse"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1534982424, "post_id": 51976497, "comment_id": 90903456, "body": "@Cheersandhth.-Alf Actually, the posted answers apply to my problem, and solve it."}, {"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1534982507, "post_id": 51976497, "comment_id": 90903471, "body": "@JulSe: I fail to see that they do."}, {"owner": {"reputation": 71, "user_id": 10186426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af0be89a518b6d4e55b733d29eb033d?s=128&d=identicon&r=PG&f=1", "display_name": "JulSe", "link": "https://stackoverflow.com/users/10186426/julse"}, "reply_to_user": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1534982687, "post_id": 51976497, "comment_id": 90903504, "body": "@Cheersandhth.-Alf Yes, they use the artificial example I posted originally (for which I am really sorry; didn&#39;t mean to offend anyone), but they solved my problem, because it is still the same, no matter if I strip down my code from unnecessary information or not."}], "answers": [{"comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 2, "creation_date": 1534981331, "post_id": 51976549, "comment_id": 90903276, "body": "Maybe - this assumes it&#39;s possible and reasonably cheap to default construct all base classes and members."}], "tags": [], "owner": {"reputation": 3331, "user_id": 8038186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ac0cc4d0f1414caf2172751b2ded50?s=128&d=identicon&r=PG&f=1", "display_name": "KoralK", "link": "https://stackoverflow.com/users/8038186/koralk"}, "is_accepted": true, "score": 2, "last_activity_date": 1534981254, "creation_date": 1534981254, "answer_id": 51976549, "question_id": 51976497, "link": "https://stackoverflow.com/questions/51976497/calling-a-constructor-from-the-body-of-another-constructor/51976549#51976549", "title": "Calling a constructor from the body of another constructor", "body": "<p>For your first example, this might be the way it can be done:</p>\n\n<pre><code>class Window\n{\nprivate:\n    void constructor_method(int a);\n    void constructor_method(int a, void *b);\n    void constructor_method(string a);\n\npublic:\n  Window(int a) {\n      constructor_method(a);\n  }\n  Window(int a, void *b) {\n      constructor_method(a, b);\n  }\n  Window(string a) {\n      constructor_method(a);\n  }\n\n  Window(double a, double b)\n  {\n    if (a * b == 0.0)\n    {\n        constructor_method(\"ZERO\");\n    }\n    else if (a * b &gt; 100.0)\n    {\n        constructor_method((int) (a + b), x);\n    }\n    else\n    {\n        constructor_method((int) (a + b));\n    }\n  }\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 10186426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af0be89a518b6d4e55b733d29eb033d?s=128&d=identicon&r=PG&f=1", "display_name": "JulSe", "link": "https://stackoverflow.com/users/10186426/julse"}, "edited": false, "score": 0, "creation_date": 1534982370, "post_id": 51976646, "comment_id": 90903442, "body": "Actually, yours and @KorelK &#39;s solutions are very clever, and solve the problem nicely :) I might go for extracting the assignment portion to a separate <code>SetValue(const VOID *, ULONG)</code> method. Apparently, I didn&#39;t catch that what I did was actually creating a new instance of the class rather than calling a constructor (I&#39;m still not quite at home with C++, coming from C# and Java)."}], "tags": [], "owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "is_accepted": false, "score": 2, "last_activity_date": 1534982072, "creation_date": 1534982072, "answer_id": 51976646, "question_id": 51976497, "link": "https://stackoverflow.com/questions/51976497/calling-a-constructor-from-the-body-of-another-constructor/51976646#51976646", "title": "Calling a constructor from the body of another constructor", "body": "<p>I think the short answer to this question is \"simplify your code.\"  But if that's not an option, I think the next best alternative is a factory method:</p>\n\n<pre><code>class Window\n{\nprivate:\n    Window(int a);\n    Window(int a, void *b);\n    Window(string a);\n\npublic:\n    static Window Create(double a, double b)\n    {\n        if (a * b == 0.0)\n        {\n            return Window(\"ZERO\");\n        }\n        else if (a * b &gt; 100.0)\n        {\n            return Window((int) (a + b), x);\n        }\n        else\n        {\n            return Window((int) (a + b));\n        }\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10186426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af0be89a518b6d4e55b733d29eb033d?s=128&d=identicon&r=PG&f=1", "display_name": "JulSe", "link": "https://stackoverflow.com/users/10186426/julse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1534982931, "accepted_answer_id": 51976549, "answer_count": 2, "score": 0, "last_activity_date": 1534982072, "creation_date": 1534980797, "last_edit_date": 1534981726, "question_id": 51976497, "link": "https://stackoverflow.com/questions/51976497/calling-a-constructor-from-the-body-of-another-constructor", "closed_reason": "Duplicate", "title": "Calling a constructor from the body of another constructor", "body": "<p>The typical way (and the only one widely used) to delegate some part of the object initialization to another constructor is to call it using the initializer list, like so:</p>\n\n<pre><code>class Window\n{\n  Window(int a);\n  Window(int a, void *b);\n  Window(string a);\n\n  Window(double a, double b) : Window((int) (a + b))\n  {\n  }\n};\n</code></pre>\n\n<p>But sometimes there is a necessity to do some prep work or branch constructor calls.</p>\n\n<p>Is this how it should be done?</p>\n\n<pre><code>class Window\n{\n  Window(int a);\n  Window(int a, void *b);\n  Window(string a);\n\n  Window(double a, double b)\n  {\n    if (a * b == 0.0)\n    {\n      Window(\"ZERO\");\n    }\n    else if (a * b &gt; 100.0)\n    {\n      Window((int) (a + b), x);\n    }\n    else\n    {\n      Window((int) (a + b));\n    }\n  }\n};\n</code></pre>\n\n<p>I have never seen anything like this; this is just my guess of how it could look (which appears to be working).</p>\n\n<p>Are there any side effects or any undefined behavior to calling other constructors from the constructor body (and not from the initializer list)?</p>\n\n<p>@Edit: I'm including the code I'm having a problem with below. Basically, I have an object that is a container for some data, and I store it in a <code>std::map&lt;CString, ValueContainer&gt;</code>. I employ a copy constructor, and an overloaded assignment operator. The insertion works fine when I add an instance to the map using the <code>[]</code> operator, but it doesn't when I use the <code>insert_or_assign</code> method, because it uses the copy constructor (which uses the branching that is the problem here). Here's a simplification of the class.</p>\n\n<pre><code>class ValueContainer\n{\n  ValueContainer(const VOID *p_data, ULONG p_size)\n  {\n    if (p_data != NULL)\n    {\n      if (p_size &gt; 0)\n      {\n        if (p_size &lt;= sizeof(shortData))\n        {\n          memcpy(shortData, p_data, p_size);\n        }\n        else\n        {\n          longData = new BYTE[p_size];\n\n          memcpy(longData, p_data, p_size);\n        }\n      }\n\n      hasValue = TRUE;\n      size = p_size;\n    }\n    else\n    {\n      hasValue = FALSE;\n      size = 0;\n    }\n  }\n\n  ValueContainer(const ValueContainer &amp;p_value)\n  {\n    if (p_value.HasValue())\n    {\n      if (p_value.size &lt;= sizeof(shortData))\n      {\n        ValueContainer(p_value.shortData, p_value.size);\n      }\n      else\n      {\n        ValueContainer(p_value.longData, p_value.size);\n      }\n    }\n    else\n    {\n      ValueContainer();\n    }\n  }\n\n  ValueContainer(VOID) : ValueContainer(NULL, 0)\n  {\n  }\n\n  ValueContainer &amp;operator =(const ValueContainer &amp;p_value);\n  {\n    if (p_value.hasValue)\n    {\n      if (p_value.size &lt;= sizeof(shortData))\n      {\n        if (longData != NULL)\n        {\n          free(longData);\n\n          longData = NULL;\n        }\n\n        memcpy(shortData, p_value.shortData, p_value.size);\n      }\n      else\n      {\n        if (p_value.size &gt; size)\n        {\n          longData = (BYTE *) realloc(longData, p_value.size);\n        }\n\n        memcpy(longData, p_value.longData, p_value.size);\n      }\n\n      hasValue = TRUE;\n      size = p_value.size;\n    }\n    else\n    {\n      if (longData != NULL)\n      {\n        free(longData);\n\n        longData = NULL;\n      }\n\n      hasValue = FALSE;\n      size = 0;\n    }\n\n    return *this;\n  }\n\nprivate:\n  BYTE  shortData[16];\n  BYTE *longData = NULL;\n  BOOL  hasValue;\n  ULONG size;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++builder", "c++builder-5", "tcheckbox"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "edited": false, "score": 0, "creation_date": 1535045547, "post_id": 51978042, "comment_id": 90932287, "body": "Thank you for your help.  I modified the code as you indicated.  I also modified the header to add the TForm1 scope but it did not compile, giving an error message E2316: &#39;CBoxClick&#39; is not a member of &#39;TForm1&#39;  How can I make CBoxClick a member of TForm1?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "edited": false, "score": 0, "creation_date": 1535046497, "post_id": 51978042, "comment_id": 90932758, "body": "Do not add <code>TForm1::</code> in the header file. <code>CBoxClick</code> needs to actually be <b>inside</b> the Form&#39;s <code>class</code> declaration.  See the update to my answer."}, {"owner": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "edited": false, "score": 0, "creation_date": 1535481902, "post_id": 51978042, "comment_id": 91079283, "body": "I&#39;ve been unsuccessful so far so I went back to your original suggestion as I noticed that I had not implemented it correctly.  Below is code from the header file, the event handler code and a simplified test routine which creates only a single checkbox, not an array of checkboxes.  It still does not work, giving a build error of E2034 Cannot convert &#39;void (_fastcall TForm1::*)(TObject *)&#39; to &#39;void (_fastcall * (_closure )(TObject *))(TObject *)&#39; at the line which assigns the OnClick event to CBoxClick."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "edited": false, "score": 0, "creation_date": 1535489252, "post_id": 51978042, "comment_id": 91082387, "body": "@Doug the code I gave in my answer works fine, so you must not be applying it to your code correctly. Please edit your question to show your latest code"}, {"owner": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "edited": false, "score": 0, "creation_date": 1535496755, "post_id": 51978042, "comment_id": 91084701, "body": "Sorry, I tried to do that but ran into problems with the editor and it submitted my comment before I was done.  Anyway, in the meantime I found a similar solution which I tried with success.  The change to your code was in the assignment of the OnClick event to the CBoxClick event handler as follows:               ChkBx[i] -&gt; OnClick = Form1 -&gt; CBoxClick;    //Assign OnClick event to Event Handler (CBoxClick)"}, {"owner": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "edited": false, "score": 0, "creation_date": 1535563124, "post_id": 51978042, "comment_id": 91116182, "body": "Remy, thanks again for your help.  Below is the working code.  It is based on your first response with 1 modification to the event handler.  &lt;br/&gt;"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "edited": false, "score": 0, "creation_date": 1535567248, "post_id": 51978042, "comment_id": 91118217, "body": "@Doug please stop trying to put code in comments.  <a href=\"https://stackoverflow.com/posts/51976382/edit\">Edit your question</a> instead, or post an answer if you have something that works."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1535505438, "last_edit_date": 1535505438, "creation_date": 1534995909, "answer_id": 51978042, "question_id": 51976382, "link": "https://stackoverflow.com/questions/51976382/event-handler-for-dynamically-created-checkbox/51978042#51978042", "title": "Event Handler for Dynamically Created CheckBox", "body": "<h2><code>CBoxClick()</code> is not a member of your Form class.</h2>\n\n<p>Within your cpp file, the compiler sees it as a standalone function.  That is what the error message is complaining about when the assignment of the <code>OnClick</code> event fails (non-static class methods have the <code>__closure</code> attribute, non-members do not).</p>\n\n<p>Make sure <code>CBoxClick()</code> is declared <strong>inside</strong> your Form class in the header file:</p>\n\n<pre><code>class TForm1 : public TForm\n{\n    ...\npublic:\n    ...\n    void __fastcall CBoxClick(TObject *Sender); // &lt;-- add this\n    ...\n};\n</code></pre>\n\n<p>And then change this line in your cpp file:</p>\n\n<pre><code>void __fastcall CBoxClick(TObject *Sender){\n</code></pre>\n\n<p>To this instead:</p>\n\n<pre><code>void __fastcall TForm1::CBoxClick(TObject *Sender){\n</code></pre>\n\n<p>And then change your assignment of the <code>OnClick</code> event from this:</p>\n\n<pre><code>ChkBx[i]-&gt;OnClick = CBoxClick;\n</code></pre>\n\n<p>To this instead (since <code>ChkBoxInit()</code> itself appears to not be a member of the Form class, either):</p>\n\n<pre><code>ChkBx[i]-&gt;OnClick = Form1-&gt;CBoxClick;\n</code></pre>\n\n<p>The first syntax you tried (<code>OnClick = CBoxClick(ChkBx[i]);</code>) is just plain wrong, as you are actually <em>calling</em> <code>CBoxClick()</code> and then trying to assign its <code>void</code> return value to <code>OnClick</code>, which obviously will not work.  You need to assign the <em>address</em> of <code>CBoxClick()</code> to <code>OnClick</code>, and that will work only for non-static class methods, not for standalone functions (well, it CAN be done, but it requires different code involving a type-cast hack utilizing the <code>TMethod</code> struct).</p>\n\n<p>Also, you should not be using <code>dynamic_cast</code>.  Since you know the <code>Sender</code> will always be a <code>TCheckBox</code>, use <code>static_cast</code> instead:</p>\n\n<pre><code>void __fastcall TForm1::CBoxClick(TObject *Sender){\n    TCheckBox *cb = static_cast&lt;TCheckBox*&gt;(Sender);\n    //Do stuff with cb...\n}\n</code></pre>\n\n<p><strong>UPDATE</strong>: Now, with that said, a better option is to get rid of <code>ChkBoxInit()</code> altogether and do the array initialization inside the Form's own constructor instead:</p>\n\n<pre><code>class TForm1 : public TForm\n{\n    ...\nprivate:\n    ...\n    void __fastcall CBoxClick(TObject *Sender); // &lt;-- moved here\n    ...\npublic:\n    __fastcall TForm1(TComponent *Owner); // &lt;-- constructor\n    ...\n};\n</code></pre>\n\n<p></p>\n\n<pre><code>__fastcall TForm1::TForm1(TComponent *Owner)\n    : TForm(Owner)\n{\n    TCheckBox* ChkBx[NCARDS];                         //Define array of type checkboxes\n    for(int i = 0; i &lt; NCARDS; i++){                  //Initalize each checkbox\n        ChkBx[i] = new TCheckBox(this);               //Create a new checkbox\n        ChkBx[i] -&gt; Parent = this;                    //Define parent of checkbox\n        ChkBx[i] -&gt; Tag = i;                          //Set value of Tag to index\n        //  Other CheckBox parameters here such as Height, Width, Top, Left, Name are here\n        //  Next, setup event handler\n        ChkBx[i]-&gt;OnClick = CBoxClick;\n    }                                                 //End of for loop\n}        \n\nvoid __fastcall TForm1::CBoxClick(TObject *Sender)\n{\n    TCheckBox *cb = static_cast&lt;TCheckBox*&gt;(Sender);\n    // Do stuff with cb...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "is_accepted": false, "score": 0, "last_activity_date": 1535568367, "creation_date": 1535568367, "answer_id": 52084233, "question_id": 51976382, "link": "https://stackoverflow.com/questions/51976382/event-handler-for-dynamically-created-checkbox/52084233#52084233", "title": "Event Handler for Dynamically Created CheckBox", "body": "<p>Remy - I'm still having trouble using the editor.  Here is the working code which is based on your first response with one small change.  Thank you for your help.</p>\n\n<p>`//  .h File----------------</p>\n\n<pre><code>class TForm1 : public TForm\n{\n__published:    // IDE-managed Components\n        TButton *Deal;\n        TButton *Reset;\n        TButton *Help;\n        TButton *Quit;\n        TEdit *Debug;\n        void __fastcall QuitClick(TObject *Sender);\n        void __fastcall ResetClick(TObject *Sender);\nprivate:    // User declarations\npublic:     // User declarations\n  __fastcall TForm1(TComponent* Owner);\n  void __fastcall CBoxClick(TObject *Sender);  //CheckBox Event Handler prototype\n};\n</code></pre>\n\n<p>// .cpp File ----------------</p>\n\n<pre><code>  void ChkBoxInit(void){\n    int i;                                         //Loop counter index\n    TCheckBox* ChkBx[NCARDS];                      //Define array of type checkbox\n    for(i = 0; i &lt; NCARDS; i++){                   //Initalize each checkbox\n      ChkBx[i] = new TCheckBox(Form1);             //Create a new checkbox\n      ChkBx[i] -&gt; Parent = Form1;                  //Define parent of checkbox\n\n// ..... Various parameters of ChkBx[i] go here (height, Width, Top, Left, etc.)\n\n      ChkBx[i] -&gt; Tag = i;                         //Use index value as tag\n`     ChkBx[i] -&gt; OnClick = Form1 -&gt; CBoxClick;    //Assign OnClick event to CBoxClick\n    }                                              //End of for loop\n  }                                                //End of function\n\n\n//  Event Handler ------------------\n\n void __fastcall TForm1::CBoxClick(TObject *Sender){\n   if (static_cast&lt;TCheckBox*&gt;(Sender)!=NULL){\n     Form1 -&gt; Debug -&gt; Text =  (static_cast&lt;TCheckBox*&gt;(Sender) -&gt; Name);\n   }\n   else{\n     Form1 -&gt; Debug -&gt; Text = \"Object is not a TCheckBox\";\n   }\n }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af7fa356bda853e01646cc8491e6771?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/10216468/doug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 752, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1535568367, "creation_date": 1534979734, "last_edit_date": 1534995575, "question_id": 51976382, "link": "https://stackoverflow.com/questions/51976382/event-handler-for-dynamically-created-checkbox", "title": "Event Handler for Dynamically Created CheckBox", "body": "<p>I wrote a C++ program using Borland C++ Builder 5.  The program dynamically creates an array of <code>TCheckBox</code> objects.  I have tried to write an <code>OnClick</code> event handler that would identify which checkbox is being clicked and execute some instructions based on that.  My event handler is based on similar posts to this website, but I cannot seem to make it work.</p>\n\n<p>Here is the (abbreviated) code</p>\n\n<pre><code>// Header declaration\nvoid __fastcall CBoxClick(TObject *Sender); \n// End Header\n</code></pre>\n\n<p></p>\n\n<pre><code>// CBoxClick function (the event handler)\n\nvoid __fastcall CBoxClick(TObject *Sender){\n    if (dynamic_cast&lt;TCheckBox*&gt;(Sender)!=NULL){\n        //Do stuff\n    }\n    else{\n        Form1 -&gt; Debug -&gt; Text = \"Object is not a TCheckBox\";         \n    }\n}\n\nvoid ChkBoxInit(void){\n    int i;                                            //Loop counter index\n    TCheckBox* ChkBx[NCARDS];                         //Define array of type checkboxes\n    for(i = 0; i &lt; NCARDS; i++){                      //Initalize each checkbox\n        ChkBx[i] = new TCheckBox(Form1);              //Create a new checkbox\n        ChkBx[i] -&gt; Parent = Form1;                   //Define parent of checkbox\n        ChkBx[i] -&gt; Tag = i;                          //Set value of Tag to index\n        //  Other CheckBox parameters here such as Height, Width, Top, Left, Name are here\n        //  Next, call event handler. I've tried the following 2 statements with the comment results\n        ChkBx[i] -&gt; OnClick = CBoxClick(ChkBx[i]);    //  Results in E2109: Not an allowed type\n        ChkBx[i] -&gt; OnClick = CBoxClick;              /* Alternate try - Results in E2034: Cannot convert\n                                                        'void (_fastcall *)(TObject *)' to \n                                                        'void (_fastcall * (_closure )(TObject *))(TObject *)'  */\n    }                                                 //End of for loop\n}                                                     //End of function\n</code></pre>\n"}, {"tags": ["c++", "gcc", "stl", "abi"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1535644856, "post_id": 51976376, "comment_id": 91153197, "body": "&quot;basically defining two different classes with the same name&quot; to maintain compatibility, gcc barely modifies the classes, only in ways it knows won&#39;t cause problems. Some bugs are kept for decades because fixing them would break the ABI."}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536247502, "post_id": 52137792, "comment_id": 91364142, "body": "Sorry for the long delay in response; I&#39;ve been on vacation.  I think that this answer mostly makes sense except for one major terminology question: What does &quot;library API&quot; actually mean, then?  This must have a different meaning in the context of gcc and ABI compatibility than it does in the wider world of programming.  To me, with the definition of &quot;API&quot; that I am used to, it is completely possible to add a private data member to a class and not change the API!"}, {"owner": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536247710, "post_id": 52137792, "comment_id": 91364261, "body": "My previous comment is the main remaining conceptual issue, but just for completeness, let me recap my understanding at this point.  In order for things to work, we really only need the data members to be the same, because objects actually only contain data members.  Methods are implemented somewhere else by the compiler.  Generally speaking, it doesn&#39;t really matter if one copy of a string calls one compiled version of a method and another copy calls another version, as long as those two versions do the same thing.  So the only point that things can go wrong is in copying the data members."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536251531, "post_id": 52137792, "comment_id": 91366446, "body": "@sasquires I can&#39;t swear I have the terminology down.  But I would say that  in C++, the library API changes if you add a private data member.   It&#39;s also not quite the case that you need just the  data members to be the same (and in the same order).  Two different compilers are allowed to  generate different memory layouts for the same struct with the same members, and indeed  a single compiler can generate different  memory layouts if you fiddle with the switches that affect packing.   Also, there is something called the virtual function table  which is generated for a class and ..."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536251655, "post_id": 52137792, "comment_id": 91366496, "body": "the contents of that table will change if you add a new virtual function.  Have a read of <a href=\"https://en.wikipedia.org/wiki/Virtual_method_table\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Virtual_method_table</a> .   That will also affect  binary compatibility.   There are probably other cases as well;  I don&#39;t think about this often enough  to be able to  list things exhaustively."}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536251731, "post_id": 52137792, "comment_id": 91366521, "body": "It&#39;s hard to fit too much information into comments, so let me give you some links and  you can ask more specific questions after reading them.   <a href=\"https://opensource.apple.com/source/gcc/gcc-5026.1/libstdc++-v3/docs/html/abi.html\" rel=\"nofollow noreferrer\">opensource.apple.com/source/gcc/gcc-5026.1/libstdc++-v3/docs&zwnj;&#8203;/&hellip;</a> (just read the very first section, up to &quot;versioning&quot;)"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536251797, "post_id": 52137792, "comment_id": 91366556, "body": "<a href=\"https://stackoverflow.com/questions/99297/how-are-virtual-functions-and-vtable-implemented\" title=\"how are virtual functions and vtable implemented\">stackoverflow.com/questions/99297/&hellip;</a>"}, {"owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "reply_to_user": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536251850, "post_id": 52137792, "comment_id": 91366576, "body": "<a href=\"https://stackoverflow.com/questions/2171177/what-is-an-application-binary-interface-abi\" title=\"what is an application binary interface abi\">stackoverflow.com/questions/2171177/&hellip;</a>"}, {"owner": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536595742, "post_id": 52137792, "comment_id": 91470993, "body": "I had seen the first link before, but when I just re-read it, I noticed a very interesting definition: &quot;The C++ Standard Library has many include files, types defined in those include files, specific named functions, and other behavior. The text of these behaviors, as written in source include files, is called the Application Programing Interface, or API.&quot;  If I am reading this correctly, it basically means that any change to the source include files may be considered a change to the API.  This definition is very poor and vague, but this resolves my confusion at least."}], "tags": [], "owner": {"reputation": 4564, "user_id": 1908650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f316929a9cb85ac26281f87cae2f56f3?s=128&d=identicon&r=PG", "display_name": "Mohan", "link": "https://stackoverflow.com/users/1908650/mohan"}, "is_accepted": true, "score": 4, "last_activity_date": 1535967403, "last_edit_date": 1535967403, "creation_date": 1535897402, "answer_id": 52137792, "question_id": 51976376, "link": "https://stackoverflow.com/questions/51976376/why-is-library-api-compiler-abi-enough-to-ensure-compatibility-between-objects/52137792#52137792", "title": "Why is library API + compiler ABI enough to ensure compatibility between objects with different versions of gcc?", "body": "<blockquote>\n  <p>It seems like it is possible that gcc can change the header implementing std::string</p>\n</blockquote>\n\n<p>It can't make arbitrary changes. That would (as you surmise) break things. But only some changes to <code>std::string</code> will affect the memory layout of the class, and those are the ones that matter. </p>\n\n<p>For an example of an optimisation that  wouldn't affect the memory layout: they could change the code inside </p>\n\n<p><code>size_t string::find (const string&amp; str, size_t pos = 0) const;</code></p>\n\n<p>to use a more efficient algorithm. That  wouldn't change the memory layout of the string.  </p>\n\n<p>In fact,  <em>if you temporarily ignore the fact that everything is templated and so has to be in header files</em>, you can imagine <code>string</code> as being defined in a <code>.h</code> file and implemented in a <code>.cpp</code> file. The memory layout is  determined <strong>only from the contents of the header file</strong>. Anything in the .cpp file could be safely changed. </p>\n\n<p>An example of something they couldn't do is to add a new data member to string. That would definitely break things. </p>\n\n<p>You mentioned the dual ABI case. What happened there is that they needed to make a breaking change, and so they had to introduce a new string class. One of the classes is std::string and the other std::_cxx11::string.  (Messy things happen under the hood so most users don't realise they are using std::_cxx11::string on newer versions of the  compiler/standard library.)</p>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536247784, "post_id": 52138126, "comment_id": 91364308, "body": "This is a great explanation of the dual ABI system, but it doesn&#39;t really address the conceptual issue that I have with how all of this works at the binary level."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "edited": false, "score": 0, "creation_date": 1536249162, "post_id": 52138126, "comment_id": 91365200, "body": "@sasquires The dual ABI mechanism makes reasonably sure that <b>either</b> version_a and version_b are binary compatible, <b>or</b> your code will fail to build. If you are using two incompatible versions with no dual ABI mechanism in place, then <b>you</b> are breaking the rules and your code won&#39;t work. If you still have a conceptual issue, you may want to explain in greater detail what it is exactly, because I have no idea whatsoever."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1535899972, "creation_date": 1535899972, "answer_id": 52138126, "question_id": 51976376, "link": "https://stackoverflow.com/questions/51976376/why-is-library-api-compiler-abi-enough-to-ensure-compatibility-between-objects/52138126#52138126", "title": "Why is library API + compiler ABI enough to ensure compatibility between objects with different versions of gcc?", "body": "<p>GCC has to do whatever it takes so that our programs work. If using different implementations of <code>std::string</code> in different translation units means our programs are broken, then gcc is not allowed to do that.</p>\n\n<p>This is applicable to any given version of GCC.</p>\n\n<p>GCC goes out of its way to remain backwards compatible. That is, it strives that the above remains applicable across different version of GCC and not just within a given version. It however cannot guarantee that all its versions up to eternity will remain compatible. When there's no longer a possibility to keep backward compatibility, an ABI change is introduced. </p>\n\n<p>Since the big GCC-5 ABI change, it is introduced in such a way so that it tries to deliberately break your builds if you combine old and new binaries. It does so by renaming <code>std::string</code> and <code>std::list</code> classes at the binary level. This propagates to all functions and templates that have <code>std::string</code> or <code>std::list</code> parameters. If you try to pass e.g. an <code>std::string</code> between translation units compiled against incompatible ABI versions, your program will fail to link. The mechanism is not 100% foolproof but it catches many common cases.</p>\n\n<p>The alternative would be to silently produce broken executables, which no one wants. </p>\n\n<p>The dual ABI is a way for the newer versions of GCC standard library <em>binary</em> to remain compatible with older executables. Basically it has two versions of everything that involves <code>std::string</code> and <code>std::list</code>, with different symbol names for the linker, so older programs that use the old versions of names can still be loaded and ran.</p>\n\n<p>There's also a compilation flag that allows the newer versions of GCC to produce binaries compatible with the older ABI (and incompatible with newer binaries produced without the compatibility flag). It is not recommended to use it unless you absolutely have to.</p>\n"}], "owner": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 3, "accepted_answer_id": 52137792, "answer_count": 2, "score": 6, "last_activity_date": 1536595902, "creation_date": 1534979659, "last_edit_date": 1536595902, "question_id": 51976376, "link": "https://stackoverflow.com/questions/51976376/why-is-library-api-compiler-abi-enough-to-ensure-compatibility-between-objects", "title": "Why is library API + compiler ABI enough to ensure compatibility between objects with different versions of gcc?", "body": "<p>I've encountered a case where I may want to use a C++ shared object library compiled with one version of gcc with some code that will be compiled with another version of gcc.  In particular, I want to use methods that return some STL containers like <code>std::string</code> and <code>std::map</code>.</p>\n\n<p>The <a href=\"http://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html\" rel=\"nofollow noreferrer\">gcc website</a> and many old stackoverflow posts (e.g. <a href=\"https://stackoverflow.com/questions/33958773/gcc-compatibility-of-shared-libraries-with-stl-objects-in-their-interface\">here</a>) discuss this issue.  My current understanding is that</p>\n\n<ul>\n<li><p>Most of the concern and most of the posts on this issue are about cross-compatibility between .so files and .dll files.  This is very difficult, due to different compiler ABIs.</p></li>\n<li><p>For cross-compatibility between .so files compiled with different versions of gcc (at least with gcc version >= 3.4), all you need to ensure is that the standard library API hasn't changed (and, if it has, there is <a href=\"http://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html\" rel=\"nofollow noreferrer\">dual ABI</a> support).</p></li>\n</ul>\n\n<p>My question has to do with how this works at a machine level.  It seems like it is possible that gcc can change the header implementing <code>std::string</code>, even if the library API has not changed, in order to make it more efficient or for other reasons.  If so, then two different pieces of code are compiled with two different <code>std::string</code> headers, and are basically defining two different classes with the same name.  How can we be guaranteed that, when we pass a <code>std::string</code> from code that uses one header to code that uses another, the object won't be mangled or misread somehow?</p>\n\n<p>For example, suppose that I have the following files:</p>\n\n<pre><code>// File a.h:\n\n#ifndef FILE_A\n#define FILE_A\n\n#include &lt;string&gt;\n\nclass X {\n  public:\n    std::string f();\n};\n\n#endif  // FILE_A\n\n\n// File a.cpp:\n\n#include \"a.h\"\n\nstd::string X::f() {\n  return \"hello world\";\n}\n\n\n// File b.cpp:\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include \"a.h\"\n\nint main() {\n  std::string x = X().f();\n  std::cout &lt;&lt; x &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>(The only purpose of the class <code>X</code> here is to introduce a bit more name-mangling into the shared object library while I am testing how this works.)</p>\n\n<p>Now I compile these as follows:</p>\n\n<pre><code>/path/to/gcc/version_a/bin/g++ -fPIC -shared a.cpp -o liba.so\n/path/to/gcc/version_b/bin/g++ -L. -la -o b b.cpp\n</code></pre>\n\n<p>When I execute <code>b</code>, then <code>b</code> has a definition of <code>std::string</code> that comes from the header in <code>version_b</code>.  But the object that is produced by <code>X().f()</code> relies on machine code that was compiled using a copy of the header that came from <code>version_a</code> of gcc.</p>\n\n<p>I don't understand very much about the low-level mechanics of compilers, linkers, and machine instructions.  But it seems to me like we are breaking a fundamental rule here, which is that the definition of a class has to be the same every time it is used, and if not, we have no guarantee that the scenario above will work.</p>\n\n<p><strong>Edit:</strong> I think that the main resolution to my confusion is that the phrase \"library API\" means something much more general in this context than it does in the uses of the term \"API\" that I am used to.  The gcc documentation seems to indicate, in a very vague way, that pretty much any change to the include files that implement the standard library can be considered a change in the library API.  See the discussion in the comments on Mohan's answer for details. </p>\n"}, {"tags": ["python", "c++", "64-bit", "ctypes"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8835328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86bc1c057be853dd91adb0c0924d81d8?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn S", "link": "https://stackoverflow.com/users/8835328/shawn-s"}, "edited": false, "score": 0, "creation_date": 1535029995, "post_id": 51976360, "comment_id": 90922724, "body": "Thanks for the heads up. It was actually my bad to post the code mid-changes. Infact I have ordered the variables similarily and also ensured that types match: for example (&quot;lais&quot;, float*6 ). Still the same problem ..."}, {"owner": {"reputation": 1, "user_id": 8835328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86bc1c057be853dd91adb0c0924d81d8?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn S", "link": "https://stackoverflow.com/users/8835328/shawn-s"}, "edited": false, "score": 0, "creation_date": 1535051728, "post_id": 51976360, "comment_id": 90935240, "body": "Ah found the issue thanks to your suggestion @abarnert, turns out I declared the same variable twice in the python structure. I&#39;ve fixed the code in the above question so now it should work. Thanks again for the recommendations."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "reply_to_user": {"reputation": 1, "user_id": 8835328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86bc1c057be853dd91adb0c0924d81d8?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn S", "link": "https://stackoverflow.com/users/8835328/shawn-s"}, "edited": false, "score": 0, "creation_date": 1535051974, "post_id": 51976360, "comment_id": 90935347, "body": "@ShawnS I did exactly the same thing with a WIn32 API struct, and spent a whole weekend hunting down pretty much the same bug you&#39;re seeing, and it was so annoying that I still vividly remember it a decade later, which is exactly why I always write a script to generate the code. :)"}], "tags": [], "owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "is_accepted": false, "score": 0, "last_activity_date": 1534979531, "creation_date": 1534979531, "answer_id": 51976360, "question_id": 51976302, "link": "https://stackoverflow.com/questions/51976302/ctypes-structure-contains-garbage-not-correct-data/51976360#51976360", "title": "ctypes - structure contains garbage / not correct data", "body": "<p>Your two structures have at least two mismatches. </p>\n\n<p>I don't know which, if either, is relevant, because your garbage seems to be in a field named <code>spic</code>, which doesn't appear in either the C++ struct or the ctypes one\u2026</p>\n\n<hr>\n\n<p>First, you get two fields out of order:</p>\n\n<pre><code>double threshold;\nint isMesh;\ndouble mVol;\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>(\"threshold\", c_double),\n(\"mVol\", c_double),\n(\"isMesh\", c_int),\n</code></pre>\n\n<p>This might seem like no big deal, but once you put alignment-driven padding into the mix, it's conceivable that this could cause all of the subsequent fields to be 4 bytes off.</p>\n\n<hr>\n\n<p>And then, you use the wrong types for all of these arrays:</p>\n\n<pre><code>float lais[6];  \nfloat sais[6];  \nfloat la3D[6];      \n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>(\"lais\", c_double*6),   \n(\"said\", c_double*6), \n(\"la3D\", c_double*6),       \n</code></pre>\n\n<p>A <code>float</code> is 32 bits; a <code>c_double</code> is 64 bits. <code>lais[0]</code> is a garbage double consisting of <code>lais[0]</code> and <code>lais[1]</code> packed together as a double, <code>lais[4]</code> is <code>sais[2]</code> and <code>sais[3]</code> packaged together, <code>la3D[4]</code> is 64 random bits out of the heap past the end of the structure. If you're lucky, you get a segfault when you try to read that, but if not, you get hard-to-debug garbage.</p>\n\n<hr>\n\n<p>For really complicated structs like this, I usually don't trust myself to write the ctypes version manually without making at least three times as many mistakes as you did. Instead, I write a quick script to parse the header (or, occasionally, the docs) and generate the Python code. For things like CoreFoundation and Win32 headers, that have thousands of ridiculously huge structs all written in a very rigid and reliable style, I have scripts that I use over and over again.</p>\n"}], "owner": {"reputation": 1, "user_id": 8835328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86bc1c057be853dd91adb0c0924d81d8?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn S", "link": "https://stackoverflow.com/users/8835328/shawn-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535036309, "creation_date": 1534979043, "last_edit_date": 1535036309, "question_id": 51976302, "link": "https://stackoverflow.com/questions/51976302/ctypes-structure-contains-garbage-not-correct-data", "title": "ctypes - structure contains garbage / not correct data", "body": "<p>I have a C++ DLL (64bit) that takes as input a double pointer to a structure (i.e. a pointer to an array of structures). The function dynamically allocates the array of structures and 'then populates each structures elements (elements include: integers, floats, doubles, static arrays, another structure, and dynamically allocated arrays). </p>\n\n<p>I've created a python class to mimic the structure (all data elements). However, when I call the C++ function - CreateROIs( .. ) - from python , I get garbage / wrong values for some of the elements in the structure. </p>\n\n<p>Example, I'll get ppMem[0].spic=24609435234</p>\n\n<p>Interestingly, if I pass that same data structure back to the C++ DLL and print out the elements in C++ they are still correct (function / code not provided for this part below). </p>\n\n<p>I'm assuming it's an issue with data types (doubles / floats) when moving data between 64Bit python and C++ DLLs. Or maybe not having contiguous memory for the structure? I can't seem to track it down... Anyways, any help is much appreciated!</p>\n\n<p>Here's my code and thanks for the help!</p>\n\n<p>C++ DLL code:</p>\n\n<pre><code>// TriangleMesh struct where mesh is defined by vertices connected via triangles\n// &lt;summary&gt;\nextern \"C\"\n\nstruct MyDLL_API TriangleMesh\n{\n    int nbrVertices;\n    int nbrTriangles;\n\n    float* vertices;\n    int* triangles;\n};\n\nextern \"C\"\nstruct MyDLL_API ROI \n{\n    double xmm;\n    double ymm;\n    double zmm;\n    double diameter;\n    double level;\n    double volume;\n    double threshold;\n    int isMesh;\n    double mVol;\n    double mass;\n    double meanD;\n    double dve;\n    double dla;\n    double dsa;\n    double dla3D;\n    double spike; \n    float sphere;\n\n    float lais[6];  \n    float sais[6];  \n    float la3D[6];      \n\n    TriangleMesh mesh;\n};\n\nextern \"C\" MyDLL_API\nvoid CreateROIs(ROI** ppMem, int* NumROIs);\n\nvoid CreateROIs(ROI** ppMem, int* NumROIs)\n{\n    *ppMem = (ROI *)malloc(sizeof(ROI) * (*NumROIs));\n\n    for (int i = 0; i &lt; *nbrNodules; i++)\n    {\n        (*ppMem)[i].xmm = double(i + 1.0);\n        (*ppMem)[i].ymm = double(i + 1.0);\n        (*ppMem)[i].zmm = double(i + 1.0);\n        (*ppMem)[i].diameter = double(i + 1.0);\n        (*ppMem)[i].level = double(i + 1.0);\n        (*ppMem)[i].volume= double(i + 1.0);\n        (*ppMem)[i].threshold = double(i + 1.0);\n        (*ppMem)[i].mVol= double(i + 1.0);\n        (*ppMem)[i].mass = double(i + 1.0);\n        (*ppMem)[i].meanD= double(i + 1.0);\n        (*ppMem)[i].dve = double(i + 1.0);\n        (*ppMem)[i].dla = double(i + 1.0);\n        (*ppMem)[i].dsa = double(i + 1.0);\n        (*ppMem)[i].dla3D = double(i + 10.0);\n        (*ppMem)[i].spike = double(i + 1.0);\n        (*ppMem)[i].sphere = double(i + 1.0);\n\n        int arr_size = sizeof((*ppMem)[i].longAxis3D) / sizeof((*ppMem)[i].longAxis3D[0]);\n\n        for (int j = 0; j &lt; arr_size; j++)\n        {\n            float val = arr_size * i + j;\n            (*ppMem)[i].lais[j] = val;\n            (*ppMem)[i].sais[j] = val;\n            (*ppMem)[i].la3D[j] = val;\n        }\n\n\n        (*ppMem)[i].meshWasCreatedByDll = int(i+1);\n        (*ppMem)[i].segMesh.nbrVertices = int(rand() % 10 + 1);\n        (*ppMem)[i].segMesh.nbrTriangles = int(rand() % 10 + 1);\n\n        (*ppMem)[i].segMesh.vertices = (float *)malloc(sizeof(float) * (*ppMem)[i].segMesh.nbrVertices);\n        (*ppMem)[i].segMesh.triangles = (int *)malloc(sizeof(int) * (*ppMem)[i].segMesh.nbrTriangles);\n\n        for (int j = 0; j &lt; (*ppMem)[i].segMesh.nbrVertices; j++)\n        {\n            (*ppMem)[i].segMesh.vertices[j] = float(j + 1);\n        }\n\n        for (int j = 0; j &lt; (*ppMem)[i].segMesh.nbrTriangles; j++)\n        {\n            (*ppMem)[i].segMesh.triangles[j] = int(j + 1);\n        }\n\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Python Code:</p>\n\n<pre><code>from ctypes import *\nimport numpy as np\nfrom numpy.ctypeslib import ndpointer\n\nndDLL = cdll.LoadLibrary(\"./MyDll.dll\")\n\n# Triangle Mesh Structure\nclass TriangleMesh(Structure):\n    _fields_ = [\n        (\"nbrVertices\", c_int),\n        (\"nbrTriangles\", c_int),\n        (\"vertices\", POINTER(c_float)),\n        (\"triangles\",POINTER(c_int))]\n\n# LCSNoduleEx Structure\nclass ROI(Structure):\n    _fields_ = [\n        (\"xmm\", c_double),\n        (\"ymm\", c_double),\n        (\"zmm\", c_double),\n        (\"diameter\", c_double),\n        (\"level\", c_double),\n        (\"volume\", c_double),\n        (\"threshold\", c_double),\n        (\"isMesh\", c_int),\n        (\"mVol\", c_double),\n        (\"mass\", c_double),\n        (\"meanD\", c_double),\n        (\"dve\", c_double),\n        (\"dla\", c_double),\n        (\"dsa\", c_double),\n        (\"dla3D\", c_double),\n        (\"spike\", c_double), \n        (\"sphere\", c_float),\n\n        (\"lais\", c_float*6),   \n        (\"said\", c_float*6), \n        (\"la3D\", c_float*6),       \n\n        (\"mesh\", TriangleMesh)\n     ]\n\n\ndef PrintROI(pMem, NumROI):\n\n    for i in range():):\n        print(\"ROI %d\"%(i), flush=True)\n        print(\"\\tlevel %f\"%(pMem[i].level), flush=True)\n        print(\"\\tdiameter %f\"%(pMem[i].diameter), flush=True)\n        print(\"\\tdla3D %f\"%(pMem[i].dla3D), flush=True)\n        print(\"\\tddla %f\"%(pMem[i].dla), flush=True)\n        print(\"\\tmeanD %f\"%(pMem[i].meanD), flush=True)\n        print(\"\\tdai %f\"%(pMem[i].dai), flush=True)\n        print(\"\\tdve %f\"%(pMem[i].dve), flush=True)\n\n        print(\"\\tmass %f\"%(pMem[i].mass), flush=True)\n\n        print(\"\\tthreshold %f\"%(pMem[i].threshold), flush=True)\n\n        print(\"\\tspiculation %f\"%(pMem[i].spike), flush=True)\n        print(\"\\tspiculation2 %f\"%(pMem[i].sphere), flush=True)\n\n        print(\"\\tvolume %f\"%(pMem[i].volume), flush=True)\n        print(\"\\tmVol %f\"%(pMem[i].mVol), flush=True)\n        print(\"\\txmm %f\"%(pMem[i].xmm), flush=True)\n        print(\"\\tymm %f\"%(pMem[i].ymm), flush=True)\n        print(\"\\tzmm %f\"%(pMem[i].zmm), flush=True)\n\n        print(\"\\tla3D %f, %f, %f, %f, %f, %f\"%(pMem[i].la3D[0],\n                                                    pMem[i].la3D[1],\n                                                    pMem[i].la3D[2],\n                                                    pMem[i].la3D[3],\n                                                    pMem[i].la3D[4],\n                                                    pMem[i].la3D[5]), flush=True)\n\n        print(\"\\tsais %f, %f, %f, %f, %f, %f\"%(pMem[i].sais[0],\n                                                           pMem[i].sais[1],\n                                                           pMem[i].sais[2],\n                                                           pMem[i].sais[3],\n                                                           pMem[i].sais[4],\n                                                           pMem[i].sais[5]), flush=True)\n\n        print(\"\\tLAIS %f, %f, %f, %f, %f, %f\"%(pMem[i].lais[0],\n                                                            pMem[i].lais[1],\n                                                            pMem[i].lais[2],\n                                                            pMem[i].lais[3],\n                                                            pMem[i].lais[4],\n                                                            pMem[i].lais[5]), flush=True)\n\n        print(\"\\tisMesh %d\"%(pMem[i].isMesh), flush=True)\n\n\n        print(\"\\tnbrVertices %d\"%(pMem[i].mesh.nbrVertices))\n        print(\"\\tnbrTriangles %d\"%(pMem[i].mesh.nbrTriangles))\n\n\n        for j in range(pMem[i].mesh.nbrVertices):\n            print(\"\\t\\tVertices %d) %f\"%(j,pMem[i].mesh.vertices[j]), flush=True)\n\n        for j in range(pMem[i].mesh.nbrTriangles):\n            print(\"\\t\\tTriangle %d) %d\"%(j,pMem[i].mesh.triangles[j]), flush=True)\n\nndDLL.CreateROI.argtypes  = [POINTER(POINTER(ROI)), POINTER(c_int)]\n\npMem= POINTER(LCSNoduleEx)()\nNumROI = c_int(1)\n\nndDLL.CreateROI(byref(pMem),byref(NumROI) )\n\n\nPrintROI(pMem, NumROI.value)\n</code></pre>\n"}, {"tags": ["c++", "segmentation-fault", "smart-pointers"], "comments": [{"owner": {"reputation": 5386, "user_id": 121035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd9eafda960d5054d63ad2c2cf9ecf9?s=128&d=identicon&r=PG", "display_name": "steve", "link": "https://stackoverflow.com/users/121035/steve"}, "edited": false, "score": 0, "creation_date": 1534997083, "post_id": 51976268, "comment_id": 90906117, "body": "The posted code won&#39;t even compile. G1 g1 = h_3-&gt;g1; will get an access violation. Any reason why you don&#39;t use std::vector? Seeing the code for the constructor and copy constructors is required to find the memory corruption."}, {"owner": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "edited": false, "score": 0, "creation_date": 1535004567, "post_id": 51976268, "comment_id": 90908254, "body": "Let&#39;s put it this way: The code you are showing falls in the category &quot;you can write C++ this way if you know what you are doing&quot;. I.e., what you show is not wrong per se. But you are hiding a lot of code behind the words <code>constructors</code> and <code>copy_constructors</code>, and the source of your problems is <i>very</i> likely there."}, {"owner": {"reputation": 67, "user_id": 9663060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/522d34af932b3761f4e5502780e5c92b?s=128&d=identicon&r=PG&f=1", "display_name": "iesiyok", "link": "https://stackoverflow.com/users/9663060/iesiyok"}, "edited": false, "score": 0, "creation_date": 1535013039, "post_id": 51976268, "comment_id": 90912529, "body": "I edited the code based on your comments. I still get &quot;Thread 1: EXC_BAD_ACCESS (code=EXC_I386_GPFLT) &quot; on Xcode and segmentation fault on gcc compiler. Where do you want me to use std::vector?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1535015173, "post_id": 51976268, "comment_id": 90913756, "body": "The conceptual mistake is to use raw pointers in the first place."}, {"owner": {"reputation": 67, "user_id": 9663060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/522d34af932b3761f4e5502780e5c92b?s=128&d=identicon&r=PG&f=1", "display_name": "iesiyok", "link": "https://stackoverflow.com/users/9663060/iesiyok"}, "edited": false, "score": 1, "creation_date": 1535015338, "post_id": 51976268, "comment_id": 90913873, "body": "That is unfortunately not my choice, I am using a library and those objects are coming from it. It&#39;s very complicated and not very easy to change."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1535026472, "post_id": 51976268, "comment_id": 90920466, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 9663060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/522d34af932b3761f4e5502780e5c92b?s=128&d=identicon&r=PG&f=1", "display_name": "iesiyok", "link": "https://stackoverflow.com/users/9663060/iesiyok"}, "edited": false, "score": 0, "creation_date": 1535013110, "post_id": 51978930, "comment_id": 90912570, "body": "If you mean this assignment here : unique_ptr&lt;H3&gt; p_h3 = create_ptr(); The compiler doesn&#39;t even complain about this."}, {"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 2, "creation_date": 1535015240, "post_id": 51978930, "comment_id": 90913794, "body": "You can definitily &quot;assign&quot; a <code>unique_ptr</code>. You cannot &quot;CopyAssign&quot;, but you can &quot;MoveAssign&quot;."}, {"owner": {"reputation": 197, "user_id": 1312193, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/af28167176a3d6578307d92c49dd99bf?s=128&d=identicon&r=PG", "display_name": "kaps", "link": "https://stackoverflow.com/users/1312193/kaps"}, "edited": false, "score": 0, "creation_date": 1535037146, "post_id": 51978930, "comment_id": 90927574, "body": "Assign as in unique_ptr&lt;..&gt; a= b; // where b is another unique pointer."}], "tags": [], "owner": {"reputation": 197, "user_id": 1312193, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/af28167176a3d6578307d92c49dd99bf?s=128&d=identicon&r=PG", "display_name": "kaps", "link": "https://stackoverflow.com/users/1312193/kaps"}, "is_accepted": false, "score": -2, "last_activity_date": 1535515551, "last_edit_date": 1535515551, "creation_date": 1535002498, "answer_id": 51978930, "question_id": 51976268, "link": "https://stackoverflow.com/questions/51976268/c-smart-pointers-for-objects-containing-raw-pointers/51978930#51978930", "title": "C++ smart pointers for objects containing raw pointers", "body": "<p>You cannot copy assign the <code>std::unique_ptr</code> from another unique pointer. Its not CopyConstructible or CopyAssignable.</p>\n\n<p>However, you can transfer ownership using <code>std::move</code>:</p>\n\n<pre><code>std::unique_ptr iptr1{new int{1}};\nstd::unique_ptr iptr2 = std::move(iptr1); // iptr1 now null \n</code></pre>\n\n<p>If you whish to have multiple owners of the pointer use <code>std::shared_ptr</code> instead.</p>\n\n<p>Read more about it on the cppreference page <a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\"><code>std::unique_ptr</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 9663060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/522d34af932b3761f4e5502780e5c92b?s=128&d=identicon&r=PG&f=1", "display_name": "iesiyok", "link": "https://stackoverflow.com/users/9663060/iesiyok"}, "is_accepted": true, "score": 0, "last_activity_date": 1535554917, "creation_date": 1535554917, "answer_id": 52080654, "question_id": 51976268, "link": "https://stackoverflow.com/questions/51976268/c-smart-pointers-for-objects-containing-raw-pointers/52080654#52080654", "title": "C++ smart pointers for objects containing raw pointers", "body": "<p>The problem was in destructor of foreign class like (G1 in this example) which was trying to delete raw pointer objects. When I remove those delete processes it works fine, but I believe this is still a bad idea.  </p>\n"}], "owner": {"reputation": 67, "user_id": 9663060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/522d34af932b3761f4e5502780e5c92b?s=128&d=identicon&r=PG&f=1", "display_name": "iesiyok", "link": "https://stackoverflow.com/users/9663060/iesiyok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 1, "accepted_answer_id": 52080654, "answer_count": 2, "score": 1, "last_activity_date": 1535554917, "creation_date": 1534978718, "last_edit_date": 1535350819, "question_id": 51976268, "link": "https://stackoverflow.com/questions/51976268/c-smart-pointers-for-objects-containing-raw-pointers", "title": "C++ smart pointers for objects containing raw pointers", "body": "<p>I have a class having an element which contains a raw pointer of another object as following. Note that the example I simplified from my actual work may probably work, but I am trying to get conceptual mistake if I am doing here, because in the perfectly same structure and scenario I am getting segmentation fault error.</p>\n\n<pre><code>    /*This doesn't have a raw pointer of another object*/\n       class H1 {\n         private:\n          int x, y;\n         public:\n          constructors;\n          copy_constructor;\n        }\n    /*This has a h1_ptr element which is a raw pointer of H1*/\n       class G1 {\n         private:\n          int count;\n          H1* h1_ptr;\n         public:\n          G1(int c, H1* lst){\n           count = 0;\n           h1_ptr = lst;\n         }\n         G1(const G1&amp; g) {\n           count = g.count;\n           h1_ptr = g.h1_ptr;\n         }\n         G1&amp; operator=(const G1&amp; g)\n         {\n           count = g.count;\n           h1_ptr = g.h1_ptr;\n         }\n        }\n    /*The class that I create unique_ptr from*/\nclass H3 {\n         private:\n          H1 h1, h2;\n          G1 g1;\n         public:\n          H3(H1 _h1, H1 _h2, G1 _g1){\n             h1 = _h1; h2 = _h2; g1 = _g1;\n          }\n        }\n</code></pre>\n\n<p>I create a <code>unique_ptr</code> from the class <code>H3</code> in a function and return it to another function:</p>\n\n<pre><code>unique_ptr&lt;H3&gt; create_ptr(){\n      H1 h1(5, 10);\n      H1 h2(50, 100);\n\n      H1* h1_lst = new H1[20];\n      H1 ls;\n      for (int i=0;i&lt;20;i++)\n      {\n        H1 ls(i, i*2);\n        h1_lst[i] = ls;\n      } \n      G1 g1(200, h1_lst);\n      unique_ptr&lt;H3&gt; p_h3(new H3(h1, h2, g1));\n      return p_h3;\n    }\n int main(){\n   unique_ptr&lt;H3&gt; p_h3 = create_ptr();\n   H3* h_3 = p_h3.get();//to get the raw pointer\n   G1 g1(h_3-&gt;g1);//corrected\n   H1* h1_lst = g1.h1_ptr;\n   for (int i=0;i&lt; 5; i++){\n     //I just want 5 of them even if there is more\n     H1 ls = h1_lst[i];\n     cout &lt;&lt; ls.x &lt;&lt; \":\" &lt;&lt; ls.y &lt;&lt; endl;\n   }\n   return 0;\n }\n</code></pre>\n\n<p>This will just write 1 or 2 lines, then it will crash with segmentation fault. If I didn't return the unique pointer, but get the raw pointer and write the result in the <code>create_ptr</code> function instead, it would work perfectly fine. </p>\n"}, {"tags": ["c++", "c++11"], "answers": [{"comments": [{"owner": {"reputation": 723, "user_id": 3103767, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ed95681c885749b1f972a5959d873644?s=128&d=identicon&r=PG&f=1", "display_name": "Diederick C. Niehorster", "link": "https://stackoverflow.com/users/3103767/diederick-c-niehorster"}, "edited": false, "score": 0, "creation_date": 1535055837, "post_id": 51976290, "comment_id": 90937134, "body": "Beautiful solution! Using C++17 I could shorten it, see my question for the edited version."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 1, "last_activity_date": 1534978961, "creation_date": 1534978961, "answer_id": 51976290, "question_id": 51976201, "link": "https://stackoverflow.com/questions/51976201/function-parameter-pack-for-member-variable-pointer/51976290#51976290", "title": "function parameter pack for member variable pointer", "body": "<p>There may be a cleaner way to do this, but you can certainly take the \"throw it at the wall and see what sticks\" approach that C++ templates love so much.</p>\n\n<pre><code>template &lt;typename T&gt;\nauto test2(const T&amp; obj) -&gt; T {\n  return obj;\n}\n\ntemplate &lt;typename T, typename S, typename... Ss&gt;\nauto test2(const T&amp; obj, S field1, Ss... fields)\n  -&gt; decltype(test2(obj.*field1, fields...)) {\n  return test2(obj.*field1, fields...);\n}\n</code></pre>\n\n<p>The base case is pretty straightforward. If we don't pass any fields, we just return the original object itself. The recursive case is just that: we recurse. The return type is declared to be... the declared type of the return value. The argument types are simply variables. They'll be instantiated fully as needed. If you pass arguments that don't make sense or don't type check, you'll get some wonderfully ugly error messages.</p>\n"}, {"comments": [{"owner": {"reputation": 723, "user_id": 3103767, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ed95681c885749b1f972a5959d873644?s=128&d=identicon&r=PG&f=1", "display_name": "Diederick C. Niehorster", "link": "https://stackoverflow.com/users/3103767/diederick-c-niehorster"}, "edited": false, "score": 0, "creation_date": 1535055806, "post_id": 51977956, "comment_id": 90937116, "body": "Sadly this didn&#39;t compile on an up to date VS2017 for me, but thanks!"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1534995061, "creation_date": 1534995061, "answer_id": 51977956, "question_id": 51976201, "link": "https://stackoverflow.com/questions/51976201/function-parameter-pack-for-member-variable-pointer/51977956#51977956", "title": "function parameter pack for member variable pointer", "body": "<p>This requires <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a> support for folding expressions.</p>\n\n<pre><code>namespace utils {\n  template&lt;class T&gt;struct tag_t{ using type=T; };\n\n  template&lt;class...Ts&gt;\n  using last = typename std::tuple_element_t&lt; sizeof...(Ts)-1, std::tuple&lt;tag_t&lt;Ts&gt;...&gt; &gt;::type;\n\n  template&lt;class Lhs, class F&gt;\n  struct fold_invoker_t;\n  template&lt;class Lhs, class F&gt;\n  fold_invoker_t&lt;Lhs, F&gt; fold_invoker(Lhs&amp;&amp;lhs, F&amp;&amp; f);\n\n  template&lt;class Lhs, class F&gt;\n  struct fold_invoker_t {\n    Lhs lhs;  \n    F f;\n    template&lt;class Rhs&gt;\n    auto operator*( Rhs&amp;&amp; rhs )&amp;&amp; {\n      return fold_invoker(std::forward&lt;F&gt;(f)(std::forward&lt;Lhs&gt;(lhs), std::forward&lt;Rhs&gt;(rhs)), static_cast&lt;F&gt;(f));\n    }\n  };\n  template&lt;class Lhs, class F&gt;\n  fold_invoker_t&lt;Lhs, F&gt; fold_invoker(Lhs&amp;&amp;lhs, F&amp;&amp; f){ return {std::forward&lt;Lhs&gt;(lhs), std::forward&lt;F&gt;(f)}; }\n}  \n</code></pre>\n\n<p>then we write:</p>\n\n<pre><code>template &lt;typename Obj, class ...C, typename... T&gt;\nutils::last&lt;Obj, T...&gt; const&amp; test2(const Obj&amp; obj, T C::*... field)\n{\n  auto get_member=[](auto&amp;&amp; elem, auto&amp;&amp; memptr)-&gt;decltype(auto){ return elem.*memptr; };\n  return (utils::fold_invoker( obj, get_member ) * ... * field).lhs;\n}\n</code></pre>\n\n<p>and it is all expanded on that one line.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/e25bca76c9411e06\" rel=\"nofollow noreferrer\">live example</a>.</p>\n\n<p>No idea if this will work in MSVC's C++17 support.</p>\n"}], "owner": {"reputation": 723, "user_id": 3103767, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ed95681c885749b1f972a5959d873644?s=128&d=identicon&r=PG&f=1", "display_name": "Diederick C. Niehorster", "link": "https://stackoverflow.com/users/3103767/diederick-c-niehorster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 51976290, "answer_count": 2, "score": 1, "last_activity_date": 1535056067, "creation_date": 1534978245, "last_edit_date": 1535056067, "question_id": 51976201, "link": "https://stackoverflow.com/questions/51976201/function-parameter-pack-for-member-variable-pointer", "title": "function parameter pack for member variable pointer", "body": "<p>I am trying to access variables in a struct thru nested member pointers:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntypedef struct {\n    int a;\n    int b;\n} bar;\n\ntypedef struct {\n    int c;\n    bar d;\n} baz;\n\ntemplate &lt;typename obj, class C1, class C2, typename T1, typename T2&gt;\nT2 test1(const obj&amp; obj_, T1 C1::* field1_, T2 C2::* field2_)\n{\n    return (obj_.*field1_).*field2_;\n}\n\nint main()\n{\n    baz myObj;\n    test1(myObj, &amp;baz::d, &amp;bar::b);\n}\n</code></pre>\n\n<p>How would I turn the function test into a variadic function, so that i can access variables at variable \"depths\" into the struct?\nI've tried to follow the second example in the Function parameter list section <a href=\"https://en.cppreference.com/w/cpp/language/parameter_pack\" rel=\"nofollow noreferrer\">here</a>, but am not getting it it seems:</p>\n\n<pre><code>template &lt;typename obj, class ...C, typename... T&gt;\nvoid test2(const obj&amp; obj_, T C...::* field_)\n{\n    // ??\n    // and what about the function return parameter?\n}\n\nint main()\n{\n    baz myObj;\n    test2(obj,&amp;baz::d,&amp;bar::b);\n    test2(obj,&amp;baz::c);\n}\n</code></pre>\n\n<p>With this, the definition of <code>test2()</code> already doesn't compile.\nAny (latest) version of C++ can be used (with MSVC though).\nFor tests purpose, here is a <a href=\"http://coliru.stacked-crooked.com/a/d27d7dda563620c8\" rel=\"nofollow noreferrer\">complete program on coliru</a>.</p>\n\n<hr>\n\n<h2>Solution</h2>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/a/51976290/3103767\">Silvio's answer</a>, I was able to solve it. Taking advantage of C++17, it can be made slightly shorter still:</p>\n\n<pre><code>template &lt;typename T, typename S, typename... Ss&gt;\nauto inline test2(const T&amp; obj, S field1, Ss... fields)\n{\n    if constexpr (!sizeof...(fields))\n        return obj.*field1;\n    else\n        return test2(obj.*field1, fields...);\n}\n</code></pre>\n"}, {"tags": ["c++", "sdl"], "answers": [{"tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": false, "score": 1, "last_activity_date": 1534979153, "last_edit_date": 1534979153, "creation_date": 1534978763, "answer_id": 51976272, "question_id": 51976073, "link": "https://stackoverflow.com/questions/51976073/sdl-c-how-do-i-move-a-rectangle-smoothly-but-randomly/51976272#51976272", "title": "SDL/C++: How do I move a rectangle smoothly but randomly?", "body": "<p>Apply the random perturbations to your velocity or acceleration vectors instead of directly on the position.</p>\n\n<p>Or choose random random positions within a certain radius of your location and accelerate towards those.</p>\n"}], "owner": {"reputation": 185, "user_id": 9469747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fda9d670cba233d35a97b33df1eb393?s=128&d=identicon&r=PG&f=1", "display_name": "merija", "link": "https://stackoverflow.com/users/9469747/merija"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1534979153, "creation_date": 1534977270, "question_id": 51976073, "link": "https://stackoverflow.com/questions/51976073/sdl-c-how-do-i-move-a-rectangle-smoothly-but-randomly", "title": "SDL/C++: How do I move a rectangle smoothly but randomly?", "body": "<p>So I have a rectangle in a 640x480 window, and I'd like it to just move about randomly. I don't want it to <em>skip</em> to a different spot, it needs to be continuous movement.</p>\n\n<p>I know I need random numbers for this, but doing something like</p>\n\n<pre><code>rect.x += rand() % 2*stepsize - stepsize;\nrect.y += rand() % 2*stepsize - stepsize;\n</code></pre>\n\n<p>to get random movements doesn't really make the rectangle move about on the screen smoothly, it just kind of jitters back and forth in the same place. </p>\n\n<p>What's an efficient way of doing this?</p>\n"}, {"tags": ["c++", "boost", "vcpkg"], "comments": [{"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1534979000, "post_id": 51976014, "comment_id": 90902835, "body": "Visual Studio has nothing to do with boost. You are in control of <code>additional include folders</code> and <code>additional libs</code> I&#39;ve been working with the latest boost with 2017 and 2017 Preview, and my workhorse 2015. Get the updates and have had no issues. Try a simple console app with a minimum of code to see if it is really some kind of VS problem."}, {"owner": {"reputation": 21, "user_id": 3060256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTaW.jpg?s=128&g=1", "display_name": "KyrioZ", "link": "https://stackoverflow.com/users/3060256/kyrioz"}, "reply_to_user": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1535066814, "post_id": 51976014, "comment_id": 90940541, "body": "@lakeweb Thank you for the response. I have deleted all the links to boost and try to rebuild and reinstall boost via vcpkg. It seems fine for now. I still wonder how vcpkg link its libs to vs. I am new in msvc but I will keep learning."}, {"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1535120540, "post_id": 51976014, "comment_id": 90962875, "body": "Hi, I&#39;m sorry, I miss understood what vcpkg was. I did some reading. Personally, I would not use it to install boost. Boost &#39;installs&#39; very simply on its own. I think one would be better off understanding includes and linking rather than depending on an installer."}, {"owner": {"reputation": 21, "user_id": 3060256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTaW.jpg?s=128&g=1", "display_name": "KyrioZ", "link": "https://stackoverflow.com/users/3060256/kyrioz"}, "reply_to_user": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1535673813, "post_id": 51976014, "comment_id": 91164551, "body": "I haven&#39;t resolved it. This error comes back while I didn&#39;t change any project properties"}], "owner": {"reputation": 21, "user_id": 3060256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTaW.jpg?s=128&g=1", "display_name": "KyrioZ", "link": "https://stackoverflow.com/users/3060256/kyrioz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1105, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534976907, "creation_date": 1534976907, "question_id": 51976014, "link": "https://stackoverflow.com/questions/51976014/e0145-member-boostfilesystempathseparator-may-not-be-initialized-link2", "title": "E0145 member &quot;boost::filesystem::path::separator&quot; may not be initialized &amp; LINK2019 error in VS2017 using vcpkg", "body": "<p>I start using vcpkg in my msvc C++ project recently.</p>\n\n<p>I built the boost 1.67 and referred it in my vs project. After I installed vcpkg, I added some lib and vcpkg seems installed another boost for me and link it to my project. Unfortunately, that boost does't work. I am now having tens of error in building project. Most of them are E0145 and LINK2019. I'm new in c++ programming. I want to know how I can use the boost I built instead of the one vcpkg installed for me.</p>\n\n<p>eg. one of the error is because it changes my BOOST_NO_CXX11_CONSTEXPR and try to use constexpr while it's not supported on my pc. The error is:</p>\n\n<pre><code>E0145 member \"boost::filesystem::path::separator\" may not be initialized    c:\\Users\\admin\\Libraries\\boost_1_67_0\\boost_1_67_0\\boost\\filesystem\\path.hpp    65  \n</code></pre>\n\n<p>this is my own boost file but all refer is to c:\\Users\\xxx\\vcpkg\\vcpkg\\installed\\x86-windows\\include\\boost\\config\\detail\\suffix.hpp</p>\n\n<p>instead of</p>\n\n<p>C:\\Users\\xxx\\Libraries\\boost_1_67_0\\boost_1_67_0\\include\\boost-1_67\\boost\\config\\detail\\suffix.hpp</p>\n\n<p>What can I do to correct this? \nThe file structure of vcpkg-boost is differ from the boost 1.67 I used before. If I replace the files with 1.67 ones, I'm afraid it will be reset when I upgrade the vcpkg and its libraries. Please give me some advice on this.</p>\n\n<p>And I also got error like,</p>\n\n<pre><code>LNK2019 unresolved external symbol \"__declspec(dllimport) void __cdecl boost::filesystem::path_traits::convert(char const *,char const *,class std::basic_string&lt;wchar_t,struct std::char_traits&lt;wchar_t&gt;,class std::allocator&lt;wchar_t&gt; &gt; &amp;,class std::codecvt&lt;wchar_t,char,struct _Mbstatet&gt; const &amp;)\"......\n</code></pre>\n"}, {"tags": ["c++", "design-patterns", "c++98"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1534975735, "post_id": 51975762, "comment_id": 90902066, "body": "You seem to be asking about the factory pattern - <a href=\"https://en.wikipedia.org/wiki/Factory_method_pattern\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Factory_method_pattern</a>"}, {"owner": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "edited": false, "score": 0, "creation_date": 1534975931, "post_id": 51975762, "comment_id": 90902120, "body": "Your example about your desired goal is very unclear. Also, what is framework? (I can guess it&#39;s a Channel base object)."}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1534976192, "post_id": 51975762, "comment_id": 90902197, "body": "Are you sure you must cast the result of getChannel? It seems awkward."}, {"owner": {"reputation": 4928, "user_id": 474535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f54c3710aa8eaf12685fbf4a6153aa45?s=128&d=identicon&r=PG", "display_name": "bart s", "link": "https://stackoverflow.com/users/474535/bart-s"}, "edited": false, "score": 0, "creation_date": 1535002564, "post_id": 51975762, "comment_id": 90907545, "body": "@NeilButterworth AFAIK I get a Channel object from the factory pattern, while I would like to have a Digital or Analog object."}, {"owner": {"reputation": 4928, "user_id": 474535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f54c3710aa8eaf12685fbf4a6153aa45?s=128&d=identicon&r=PG", "display_name": "bart s", "link": "https://stackoverflow.com/users/474535/bart-s"}, "reply_to_user": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "edited": false, "score": 0, "creation_date": 1535002596, "post_id": 51975762, "comment_id": 90907555, "body": "@CaptainGiraffe the framework is a custom c++ framework providing functionality for their hardware. I tried to explain a little better what I would like to achieve."}, {"owner": {"reputation": 4928, "user_id": 474535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f54c3710aa8eaf12685fbf4a6153aa45?s=128&d=identicon&r=PG", "display_name": "bart s", "link": "https://stackoverflow.com/users/474535/bart-s"}, "reply_to_user": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1535002632, "post_id": 51975762, "comment_id": 90907567, "body": "@ZDF Digital and Analog derive from Channel but have different functionalities. If I get an Cannel object, I cannot use the extra functionalities from Digital or Analog"}], "answers": [{"comments": [{"owner": {"reputation": 4928, "user_id": 474535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f54c3710aa8eaf12685fbf4a6153aa45?s=128&d=identicon&r=PG", "display_name": "bart s", "link": "https://stackoverflow.com/users/474535/bart-s"}, "edited": false, "score": 0, "creation_date": 1535005910, "post_id": 51975830, "comment_id": 90908801, "body": "Would it be possible to have another class e.g. <code>MyIO</code> which can behave line Analog -or- Digital, so that   <code>MyIO*  a = MyApp::getChannel&lt;Analog&gt;(framework, &quot;name1&quot;); MyIO*  d = MyApp::getChannel&lt;Digital&gt;(framework, &quot;name2&quot;);</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 4928, "user_id": 474535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f54c3710aa8eaf12685fbf4a6153aa45?s=128&d=identicon&r=PG", "display_name": "bart s", "link": "https://stackoverflow.com/users/474535/bart-s"}, "edited": false, "score": 0, "creation_date": 1535008049, "post_id": 51975830, "comment_id": 90909839, "body": "@barts, sure it&#39;s possible. What&#39;s the relationship between <code>MyIO</code> and the other classes?"}, {"owner": {"reputation": 4928, "user_id": 474535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f54c3710aa8eaf12685fbf4a6153aa45?s=128&d=identicon&r=PG", "display_name": "bart s", "link": "https://stackoverflow.com/users/474535/bart-s"}, "edited": false, "score": 0, "creation_date": 1535009622, "post_id": 51975830, "comment_id": 90910645, "body": "<code>MyIO</code> is a class that I still have to create, so I can relate it in any required way to the Channel, Digital and/or Analog class, however I cannot change the Channel, Digital and Analog classes."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1534976126, "last_edit_date": 1534976126, "creation_date": 1534975743, "answer_id": 51975830, "question_id": 51975762, "link": "https://stackoverflow.com/questions/51975762/c-base-class-called-but-returning-derived-class/51975830#51975830", "title": "c++ base class called but returning derived class", "body": "<p>You can accomplish that using a function template. </p>\n\n<pre><code>namespace MyApp\n{\n    template &lt;typename T&gt;\n    T* getChannel(Framework* framework, std::string const&amp; cname)\n    {\n       return dynamic_cast&lt;T*&gt;(framework-&gt;getChannel(cname));\n    }\n}\n</code></pre>\n\n<p>and use</p>\n\n<pre><code>Analog*  a = MyApp::getChannel&lt;Analog&gt;(framework, \"name\");\n</code></pre>\n"}], "owner": {"reputation": 4928, "user_id": 474535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f54c3710aa8eaf12685fbf4a6153aa45?s=128&d=identicon&r=PG", "display_name": "bart s", "link": "https://stackoverflow.com/users/474535/bart-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535002132, "creation_date": 1534975309, "last_edit_date": 1535002132, "question_id": 51975762, "link": "https://stackoverflow.com/questions/51975762/c-base-class-called-but-returning-derived-class", "title": "c++ base class called but returning derived class", "body": "<p>Before all, I am tied to C++98, how I wish our supplier (and their supplier) would update</p>\n\n<p>I am working with a 3rd party framework from which I do have sources. I do not want to change the sources to make sure I am upwards and downwards compatible.</p>\n\n<p>That framework has a base class <code>Channel</code> and derived classes <code>Digital</code> and <code>Analog</code></p>\n\n<pre><code>class Channel\n{\n    getChannel(std::string chName)\n    {\n        //returns a Channel  \n    }\n    bool IsDigital()\n    {\n       //returns true for digital otherwise false\n    }\n}\n\nclass Digital : public Channel\n{\n    // functionality for Digital\n}\n\nclass Analog : public Channel\n{\n    // functionality for Analog\n}\n</code></pre>\n\n<p>The base class allows me to find a 'Channel' by calling the <code>getChannel(std::string chName)</code> method. the base class also has a method <code>IsDigital()</code>. That method returns true when the channel is Digital otherwise it is Analog.</p>\n\n<p>Is there a way (or pattern) that I can use to request the channel from the base class and get returned a <code>Digital</code> or <code>Analog</code> (derived class) ? If I need to build classes in between to get it done it is ok for me.  I would like to prevent from loads of getting channels in the program and casting them and ending up with multiple variables. </p>\n\n<pre><code>Digital* d;\nAnalog*  a;\nChannel* c;\n\nc = framework-&gt;getChannel(\"name\");\nif (c-&gt;IsDigital())\n{\n   d = dynamic_cast&lt;Digital&gt;(c);       \n}\nelse\n{\n   a = dynamic_cast&lt;Analog&gt;(c);       \n}\n</code></pre>\n\n<p>I hope there is something possible like this. In my main code I use my IO class and helper class, where the helper class works with the framework to determine if it is a Digital or Analog channel, and the IO class can be either Digital or Analog. </p>\n\n<pre><code>MyInBetweenClass* helper;\nMyOwnClass *ioD;\nMyOwnClass *ioA;\n\nioD = helper(framework-&gt;getChannel(\"digitalname\"));\nioA = helper(framework-&gt;getChannel(\"analogname\"));\n\n// here do something with ioD acting on the digital IO\n//   or do something with ioA acting on the analog IO\n</code></pre>\n"}, {"tags": ["c++", "windows", "registry", "uninstallation", "uninstallstring"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9767143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a3f34505e12abb88b8ac8a6ce5fcfe?s=128&d=identicon&r=PG&f=1", "display_name": "RGarland", "link": "https://stackoverflow.com/users/9767143/rgarland"}, "edited": false, "score": 0, "creation_date": 1535471491, "post_id": 51975971, "comment_id": 91074060, "body": "Is there a way to search out the uninstall key by looking in the registry for a matching DisplayName? Then, if you find the GUID by DisplayName, run the uninstall string like above?"}], "tags": [], "owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "is_accepted": false, "score": 0, "last_activity_date": 1534976656, "creation_date": 1534976656, "answer_id": 51975971, "question_id": 51975745, "link": "https://stackoverflow.com/questions/51975745/run-msiexec-exe-from-c-windows/51975971#51975971", "title": "Run MsiExec.exe from c++? Windows", "body": "<p>One of the simplest ways is to use the <a href=\"https://en.cppreference.com/w/cpp/utility/program/system\" rel=\"nofollow noreferrer\">system</a> function.</p>\n\n<p>I.e.:</p>\n\n<pre><code>int result = system(\"MsiExec.exe /X{9BA100BF-B59D-4657-9530-891B6EE24E31}\");\n</code></pre>\n\n<p>Other more Windows specific ways involve the use of <a href=\"https://docs.microsoft.com/it-it/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessw\" rel=\"nofollow noreferrer\">CreateProcess</a> or <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/nf-shellapi-shellexecutew\" rel=\"nofollow noreferrer\">ShellExecute</a> Windows Win32 API functions.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2385605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7lzl.jpg?s=128&g=1", "display_name": "m4x1m1l14n", "link": "https://stackoverflow.com/users/2385605/m4x1m1l14n"}, "is_accepted": false, "score": 0, "last_activity_date": 1547629389, "creation_date": 1547629389, "answer_id": 54213500, "question_id": 51975745, "link": "https://stackoverflow.com/questions/51975745/run-msiexec-exe-from-c-windows/54213500#54213500", "title": "Run MsiExec.exe from c++? Windows", "body": "<blockquote>\n  <p>Is there a way to search out the uninstall key by looking in the registry for a matching DisplayName? Then, if you find the GUID by DisplayName, run the uninstall string like above? \u2013 RGarland</p>\n</blockquote>\n\n<p>Of course there is. You can use native Windows API for manipulating registry or if you prefer you can use some existing C++ wrapper around that API.</p>\n\n<p>I wrote small easy to use <a href=\"https://github.com/m4x1m1l14n/Registry\" rel=\"nofollow noreferrer\">Registry wrapper</a> which supports enumerating registry keys.</p>\n\n<p>I  think you may find it useful to solve your problem.</p>\n\n<pre><code>#include &lt;Registry.hpp&gt;\n\nusing namespace m4x1m1l14n;\n\nstd::wstring GetProductCodeByDisplayName(const std::wstring&amp; displayName)\n{\n    std::wstring productCode;\n\n    auto key = Registry::LocalMachine-&gt;Open(L\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\");\n\n    key-&gt;EnumerateSubKeys([&amp;](const std::wstring&amp; subKeyName) -&gt; bool\n    {\n        auto subKey = key-&gt;Open(subKeyName);\n        if (subKey-&gt;HasValue(L\"DisplayName\"))\n        {\n            if (displayName == subKey-&gt;GetString(L\"DisplayName\"))\n            {\n                // Product found! Store product code\n                productCode = subKeyName;\n\n                // Return false to stop processing\n                return false;\n            }\n        }\n\n        // Return true to continue processing subkeys\n        return true;\n    });\n\n    return productCode;\n}\n\nint main()\n{\n    try\n    {\n        auto productCode = GetProductCodeByDisplayName(L\"VMware Workstation\");\n        if (!productCode.empty())\n        {\n            //  Uninstall package\n        }\n    }\n    catch (const std::exception&amp; ex)\n    {\n        std::cout &lt;&lt; ex.what() &lt;&lt; std::endl;\n    }\n\n    return 0;\n</code></pre>\n\n<p>Also <strong>you should be aware</strong>, that some packages is not stored by its package code under Uninstall registry key, but by their names and to uninstall them you must search for UninstallString value within specific subkey and call this package instead.</p>\n"}], "owner": {"reputation": 31, "user_id": 9767143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a3f34505e12abb88b8ac8a6ce5fcfe?s=128&d=identicon&r=PG&f=1", "display_name": "RGarland", "link": "https://stackoverflow.com/users/9767143/rgarland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547629389, "creation_date": 1534975195, "question_id": 51975745, "link": "https://stackoverflow.com/questions/51975745/run-msiexec-exe-from-c-windows", "title": "Run MsiExec.exe from c++? Windows", "body": "<p>MsiExec.exe /X{9BA100BF-B59D-4657-9530-891B6EE24E31};</p>\n\n<p>I need to run this command through my cpp project in main. This is a new version of a piece of software that needs to remove the older version before installing. I want to do this using the Uninstall String from the application's registry. Is there a way to do this in cpp? I'm using Qt 5.5. Thanks.</p>\n"}, {"tags": ["c++", "image-processing", "sfml", "canny-operator", "sobel"], "comments": [{"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1534975194, "post_id": 51975721, "comment_id": 90901907, "body": "Your thinning process generates double edges (even for Scharr); in fact more than double. Where did you get this weird thinning code ?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1534975200, "post_id": 51975721, "comment_id": 90901912, "body": "That is quite a mountain of code you expect us to read through, plus a heap of milks, plus no well-defined question. Please try and make this more <i>minimal</i>."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1534975383, "post_id": 51975721, "comment_id": 90901961, "body": "The problem is in your &quot;thinning&quot;, so post that code, with suitable inputs and a <code>main()</code>, so we can try to reproduce your problem. By the way, the Canny edge detector uses <b>non-maximum suppression</b>, not <b>thinning</b>. Thinning is a whole different concept."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1534975853, "post_id": 51975721, "comment_id": 90902092, "body": "Yeah, you should probably rewrite that &quot;thinning&quot; algorithm of yours from scratch. See the <a href=\"https://en.wikipedia.org/wiki/Canny_edge_detector#Non-maximum_suppression\" rel=\"nofollow noreferrer\">wikipedia article</a> for how this algorithm should work. You don&#39;t need the loops over <code>l</code> and <code>t</code>."}, {"owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1534976009, "post_id": 51975721, "comment_id": 90902146, "body": "@YvesDaoust hmm, this is purely my invention. I created it after reading the basics from wikipedia and a book. Could you indicate, what are the problems with this solution?"}, {"owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1534976070, "post_id": 51975721, "comment_id": 90902160, "body": "@CrisLuengo added main. I just used wikipedia to create this from scratch, I couldn&#39;t really think of the mistakes here myself. I know that it is non-maximum suppression, jsut calling this &quot;thinning&quot; :D"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1534976705, "post_id": 51975721, "comment_id": 90902344, "body": "@TomaszMa\u0142achowski: sorry, I don&#39;t intend to reverse engineer your code."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1534986539, "post_id": 51976035, "comment_id": 90904227, "body": "Thank you sir, it helped with Lena picture. I added new code in the post above with your suggestions applied. I also posted new Lena and a result from another image which looks quite strange. Somehow, it draws two edges &#39;around&#39; the proper one. Could you explain that?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1534996850, "post_id": 51976035, "comment_id": 90906068, "body": "@Tomasz: Does the output of the non-maximum suppression look better now, or does this one also show these double edges?"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1535012231, "post_id": 51976035, "comment_id": 90912095, "body": "@TomaszMa\u0142achowski: you must show the results of the thinning (obviously still wrong), not after binarization as this hides all information."}, {"owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1535023360, "post_id": 51976035, "comment_id": 90918600, "body": "@CrisLuengo it looks better for Lena but it looks very weird for another image - the double edges are now moved aside from each other. I attached 3 new images to the post, so you can see the results"}, {"owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1535023396, "post_id": 51976035, "comment_id": 90918622, "body": "@YvesDaoust I attached image of Lena before binarization/hysteresis. Gears image looks all the same before/after binarization"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1535025938, "post_id": 51976035, "comment_id": 90920141, "body": "@TomaszMa\u0142achowski: ok, your choice not to show it. Your thinning is abnormal."}, {"owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1535027412, "post_id": 51976035, "comment_id": 90921000, "body": "@YvesDaoust I attached the image"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1535028088, "post_id": 51976035, "comment_id": 90921434, "body": "@TomaszMa\u0142achowski: your thinning behaves as another edge detector: It creates edges... on both sides of the edges, i.e. where there are large variations."}, {"owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1535031782, "post_id": 51976035, "comment_id": 90923973, "body": "@CrisLuengo thank you so much, it helped :) I created the array of gradients (&#39;garray&#39;) previously but didn&#39;t think about using this instead of getting the color magnitude. So I chose the (1) solution. I uploaded image of the gears with now correct algorithm so you could see the result :) Thanks again :)"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1535032038, "post_id": 51976035, "comment_id": 90924153, "body": "@Tomasz: excellent! Glad it helped. There are other refinements you can look into if interested. For example, it is best to use Gaussian gradients, rather than Gaussian smoothing and some other gradient. Most people implement it as you did, but the original Canny paper goes to great lengths to show that Gaussian gradients are the best choice!"}, {"owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "edited": false, "score": 0, "creation_date": 1535032560, "post_id": 51976035, "comment_id": 90924497, "body": "@CrisLuengo of course, I will further improve this program and thanks to you, now I have a working base to work with as a newbie to image processing &amp; computer vision. OpenCV&#39;s waiting for me :D Best regards!"}], "tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": true, "score": 0, "last_activity_date": 1535030003, "last_edit_date": 1535030003, "creation_date": 1534977033, "answer_id": 51976035, "question_id": 51975721, "link": "https://stackoverflow.com/questions/51975721/sfml-c-canny-edge-detection-double-edges/51976035#51976035", "title": "SFML C++ Canny edge detection double edges", "body": "<p>I haven't read your whole code in detail, there is much too much code there. But obviously your non-maximum suppression code is wrong. Let's look at what it does for one pixel in the middle of the image, where the gradient is close to 0 degrees:</p>\n\n<pre><code>leftBound = i - radius;\nrightBound = i + radius;\n// ...\nfor (int t = leftBound; t &lt;= rightBound; t++)\n{\n   if ((image.getPixel(t, j).r &gt;= image.getPixel(i, j).r) &amp;&amp; (t != i))\n   {\n      judgeandjury = false; // it's not a maximum: suppress\n   }\n}\n// ...\nif (judgeandjury == false)\n{\n   image.setPixel(i, j, sf::Color::Black);\n}\n</code></pre>\n\n<p>Here, <code>radius</code> is set to 1 by the calling code. Any other value would be bad, so this is OK. I would remove that as a parameter altogether. Now your loop is:</p>\n\n<pre><code>for (int t = i-1; t &lt;= t+1; t++)\n   if (t != i)\n</code></pre>\n\n<p>This means that you hit exactly two values of <code>t</code>. So this should of course be replaced with simpler code that does not loop, it will be more readable.</p>\n\n<p>This is what it now does:</p>\n\n<pre><code>if (   (image.getPixel(i-1, j).r &gt;= image.getPixel(i, j).r)\n    || (image.getPixel(i+1, j).r &gt;= image.getPixel(i, j).r)) {\n   judgeandjury = false; // it's not a maximum: suppress\n}\n</code></pre>\n\n<p>So you suppress the pixel if it is not strictly larger than its neighbors. Looking back at the <a href=\"https://en.wikipedia.org/wiki/Canny_edge_detector#Non-maximum_suppression\" rel=\"nofollow noreferrer\">Wikipedia article</a>, it seems that they suggest the same. But in fact, this is not correct, you want the point to be strictly larger than one of the two neighbors, and larger or equal to the other. This prevents the situation where the gradient happens to be equally strong on two neighboring pixels. The actual maximum can fall right in the middle of two pixels, yielding two pixels on this local maximum gradient with exactly the same value. But let's ignore this case for now, it is possible but not all that likely.</p>\n\n<p>Next, you suppress the maximum... <strong>in the input image</strong>! This means that, when you reach the next pixel on this line, you will compare its value to this value that was just suppressed. Of course it will be larger, even though it was smaller than the original value at that location. That is, non-maxima will look like maxima because you put a neighboring pixel to 0.</p>\n\n<p>So: write the result of the algorithm to an output image:</p>\n\n<pre><code>if (judgeandjury == true)\n{\n   output.setPixel(i, j, image.getPixel(i, j));\n}\n</code></pre>\n\n<p>...which of course you need to allocate, but you already know that.</p>\n\n<hr>\n\n<p>Your second problem is in the <code>sobel</code> function, where you compute the gradient magnitude. It clips (saturates) the output. By cutting values of the output above 255 to 255, you create very broad lines along the edges of a constant value. The test of the non-maximum suppression is satisfied at the two edges of this line, but not in the middle, where pixels have the same value as both its neighbors.</p>\n\n<p>To solve this, either:</p>\n\n<ol>\n<li><p>Use a floating-point buffer to store the gradient magnitude. Here you don\u2019t need to worry about data ranges.</p></li>\n<li><p>Divide the magnitude by some value such that it will never exceed 255. Now you\u2019re quantifying the magnitude rather than clipping it. Quantizing <em>should</em> be fine in this case.</p></li>\n</ol>\n\n<p>I strongly recommend that you follow (1). I typically use floating-point\u2014values images for everything, and only convert to 8-bit ints for display. This simplified a lot of things!</p>\n"}], "owner": {"reputation": 17, "user_id": 3983509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23bce5005c8d4f199fa7c7829d7381ee?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Ma\u0142achowski", "link": "https://stackoverflow.com/users/3983509/tomasz-ma%c5%82achowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 51976035, "answer_count": 1, "score": 1, "last_activity_date": 1535031548, "creation_date": 1534975022, "last_edit_date": 1535031548, "question_id": 51975721, "link": "https://stackoverflow.com/questions/51975721/sfml-c-canny-edge-detection-double-edges", "title": "SFML C++ Canny edge detection double edges", "body": "<p>So, I decided to create a simple Canny edge detector just as exercise before biting harder topics with image processing.</p>\n\n<p>I tried to follow the typical path of Canny:\n 1. Grayscaling the image\n 2. Gaussian filter to blur the noise\n 3. Edge detection - I use both Sobel and Scharr\n 4. Edge thinning - I used non-maximum suppression in direction depending on gradient direction - vertical, horizontal, 45 diagonal or 135 diagonal\n 5. Hysteresis</p>\n\n<p>I somehow managed to get it working with Scharr's detection but I have recurring problem with double or multiple edges, espacially with Sobel. I can't really find a set of parameters which will make it work.</p>\n\n<p>My algorithm for Sobel:</p>\n\n<pre><code>void sobel(sf::Image &amp;image, pixldata **garray, float division)\n{\nint t1 = 0, t2 = 0, t3 = 0, t4 = 0;\nsf::Color color;\nsf::Image bufor;\nbufor.create(image.getSize().x, image.getSize().y, sf::Color::Cyan);\n\nfor (int i = 1;i &lt; image.getSize().y - 1;i++)\n{\n    for (int j = 1;j &lt; image.getSize().x - 1;j++)\n    {\n\n        t1 = (- image.getPixel(j - 1, i - 1).r - 2 * image.getPixel(j - 1, i).r - image.getPixel(j - 1, i + 1).r + image.getPixel(j + 1, i - 1).r + 2 * image.getPixel(j + 1, i).r + image.getPixel(j + 1, i + 1).r) / division;\n        t2 = (- image.getPixel(j - 1, i).r - 2 * image.getPixel(j - 1, i + 1).r - image.getPixel(j, i + 1).r + image.getPixel(j + 1, i).r + 2 * image.getPixel(j + 1, i - 1).r + image.getPixel(j, i - 1).r) / division;\n        t3 = (- image.getPixel(j - 1, i + 1).r - 2 * image.getPixel(j, i + 1).r - image.getPixel(j + 1, i + 1).r + image.getPixel(j - 1, i - 1).r + 2 * image.getPixel(j, i - 1).r + image.getPixel(j + 1, i - 1).r) / division;\n        t4 = (- image.getPixel(j, i + 1).r - 2 * image.getPixel(j + 1, i + 1).r - image.getPixel(j + 1, i).r + image.getPixel(j - 1, i).r + 2 * image.getPixel(j - 1, i - 1).r + image.getPixel(j, i - 1).r) / division;\n\n        color.r = (abs(t1) + abs(t2) + abs(t3) + abs(t4));\n        color.g = (abs(t1) + abs(t2) + abs(t3) + abs(t4));\n        color.b = (abs(t1) + abs(t2) + abs(t3) + abs(t4));\n\n        garray[j][i].gx = t1;\n        garray[j][i].gy = t3;\n        garray[j][i].gtrue = sqrt(t1*t1 + t2*t2 + t3*t3 + t4*t4);\n        garray[j][i].gsimpl = sqrt(t1*t1 + t2*t2);\n\n        t1 = abs(t1);\n        t2 = abs(t2);\n        t3 = abs(t3);\n        t4 = abs(t4);\n\n        if (t1 &gt; t4 &amp;&amp; t1 &gt; t3 &amp;&amp; t1 &gt; t2)\n            garray[j][i].fi = 0;\n        else if (t2 &gt; t4 &amp;&amp; t2 &gt; t3 &amp;&amp; t2 &gt; t1)\n            garray[j][i].fi = 45;\n        else if (t3 &gt; t4 &amp;&amp; t3 &gt; t2 &amp;&amp; t3 &gt; t1)\n            garray[j][i].fi = 90;\n        else if (t4 &gt; t3 &amp;&amp; t4 &gt; t2 &amp;&amp; t4 &gt; t1)\n            garray[j][i].fi = 135;\n        else\n            garray[j][i].fi = 0;\n\n        if (sqrt(t1*t1 + t2*t2 + t3*t3 + t4*t4) &lt; 0)\n        {\n            color.r = 0;\n            color.g = 0;\n            color.b = 0;\n        }\n        else if (sqrt(t1*t1 + t2*t2 + t3*t3 + t4*t4) &gt; 255)\n        {\n            color.r = 255;\n            color.g = 255;\n            color.b = 255;\n        }\n        else\n        {\n            color.r = sqrt(t1*t1 + t2*t2 + t3*t3 + t4*t4);\n            color.g = sqrt(t1*t1 + t2*t2 + t3*t3 + t4*t4);\n            color.b = sqrt(t1*t1 + t2*t2 + t3*t3 + t4*t4);\n        }\n        bufor.setPixel(j, i, color);\n    }\n}\nimage.copy(bufor, 0, 0);\n}\n</code></pre>\n\n<p>Code for Scharr differs only in multiplying the pixels' values.</p>\n\n<pre><code>        t1 = (-3 * image.getPixel(j - 1, i - 1).r - 10 * image.getPixel(j - 1, i).r - 3 * image.getPixel(j - 1, i + 1).r + 3 * image.getPixel(j + 1, i - 1).r + 10 * image.getPixel(j + 1, i).r + 3 * image.getPixel(j + 1, i + 1).r) / division;\n        t2 = (-3 * image.getPixel(j - 1, i).r - 10 * image.getPixel(j - 1, i + 1).r - 3 * image.getPixel(j, i + 1).r + 3 * image.getPixel(j + 1, i).r + 10 * image.getPixel(j + 1, i - 1).r + 3 * image.getPixel(j, i - 1).r) / division;\n        t3 = (-3 * image.getPixel(j - 1, i + 1).r - 10 * image.getPixel(j, i + 1).r - 3 * image.getPixel(j + 1, i + 1).r + 3 * image.getPixel(j - 1, i - 1).r + 10 * image.getPixel(j, i - 1).r + 3 * image.getPixel(j + 1, i - 1).r) / division;\n        t4 = (-3 * image.getPixel(j, i + 1).r - 10 * image.getPixel(j + 1, i + 1).r - 3 * image.getPixel(j + 1, i).r + 3 * image.getPixel(j - 1, i).r + 10 * image.getPixel(j - 1, i - 1).r + 3 * image.getPixel(j, i - 1).r) / division;\n</code></pre>\n\n<p>Thinning code:</p>\n\n<pre><code>void intelligentThin(sf::Image &amp;image, int radius, pixldata **garray)\n{\nint xmax = image.getSize().x;\nint ymax = image.getSize().y;\nbool judgeandjury = true;\n\nfor (int i = 0;i &lt; xmax;i++)\n{\n    int leftBound = 0, rightBound = 0, ceilBound = 0, bottomBound = 0;\n\n    if (i &lt; radius)\n    {\n        leftBound = 0;\n        rightBound = i + radius;\n    }\n    else if (i &gt;= xmax - radius)\n    {\n        leftBound = i - radius;\n        rightBound = xmax - 1;\n    }\n    else\n    {\n        leftBound = i - radius;\n        rightBound = i + radius;\n    }\n\n    for (int j = 0;j &lt; ymax;j++)\n    {\n        if (j &lt; radius)\n        {\n            ceilBound = 0;\n            bottomBound = j + radius;\n        }\n        else if (j &gt;= ymax - radius)\n        {\n            ceilBound = j - radius;\n            bottomBound = ymax - 1;\n        }\n        else\n        {\n            ceilBound = j - radius;\n            bottomBound = j + radius;\n        }\n\n        if (garray[i][j].fi == 0)\n        {\n            for (int t = leftBound; t &lt;= rightBound; t++)\n            {\n                if ((image.getPixel(t, j).r &gt;= image.getPixel(i, j).r) &amp;&amp; (t != i))\n                {\n                    judgeandjury = false;\n                }\n            }\n        }\n        else if (garray[i][j].fi == 135)\n        {\n            for (int l = leftBound, t = ceilBound; (l &lt;= rightBound &amp;&amp; t &lt;= bottomBound); l++, t++)\n            {\n                if ((image.getPixel(l, t).r &gt;= image.getPixel(i, j).r) &amp;&amp; (t != j))\n                {\n                    judgeandjury = false;\n                }\n            }\n        }\n        else if (garray[i][j].fi == 90)\n        {\n            for (int t = ceilBound; t &lt;= bottomBound; t++)\n            {\n                if ((image.getPixel(i, t).r &gt;= image.getPixel(i, j).r) &amp;&amp; (t != j))\n                {\n                    judgeandjury = false;\n                }\n            }\n        }\n        else if (garray[i][j].fi == 45)\n        {\n            for (int l = rightBound, t = ceilBound; (l &gt;= leftBound &amp;&amp; t &lt;= bottomBound); l--, t++)\n            {\n                if ((image.getPixel(l, t).r &gt;= image.getPixel(i, j).r) &amp;&amp; (t != j))\n                {\n                    judgeandjury = false;\n                }\n            }\n        }\n\n        if (judgeandjury == false)\n        {\n            image.setPixel(i, j, sf::Color::Black);\n        }\n\n        judgeandjury = true;\n\n    }\n    leftBound = rightBound = 0;\n}\n}\n</code></pre>\n\n<p>Hysteresis code:</p>\n\n<pre><code>void hysteresis(sf::Image &amp;image, int radius, int uplevel, int lowlevel)\n{\n\nint xmax = image.getSize().x;\nint ymax = image.getSize().y;\nbool judgeandjury = false;\n\nsf::Image bufor;\nbufor.create(image.getSize().x, image.getSize().y, sf::Color::Cyan);\n\nfor (int i = 0;i &lt; xmax;i++)\n{\n    int leftBound = 0, rightBound = 0, ceilBound = 0, bottomBound = 0;\n\n    if (i &lt; radius)\n    {\n        leftBound = 0;\n        rightBound = i + radius;\n    }\n    else if (i &gt;= xmax - radius)\n    {\n        leftBound = i - radius;\n        rightBound = xmax - 1;\n    }\n    else\n    {\n        leftBound = i - radius;\n        rightBound = i + radius;\n    }\n\n    for (int j = 0;j &lt; ymax;j++)\n    {\n        int currentPoint = image.getPixel(i, j).r;\n\n        if (j &lt; radius)\n        {\n            ceilBound = 0;\n            bottomBound = j + radius;\n        }\n        else if (j &gt;= ymax - radius)\n        {\n            ceilBound = j - radius;\n            bottomBound = ymax - 1;\n        }\n        else\n        {\n            ceilBound = j - radius;\n            bottomBound = j + radius;\n        }\n\n        if (currentPoint &gt; uplevel)\n        {\n            judgeandjury = true;\n        }\n        else if (currentPoint &gt; lowlevel)\n        {\n            for (int t = leftBound; t &lt;= rightBound; t++)\n            {\n                for (int l = ceilBound; l &lt;= bottomBound; l++)\n                {\n                    if (image.getPixel(t, l).r &gt; uplevel)\n                    {\n                        judgeandjury = true;\n                    }\n\n                }\n            }\n        }\n        else judgeandjury = false;\n\n        if (judgeandjury == true)\n        {\n            bufor.setPixel(i, j, sf::Color::White);\n        }\n        else\n        {\n            bufor.setPixel(i, j, sf::Color::Black);\n        }\n\n        judgeandjury = false;\n        currentPoint = 0;\n\n    }\n    leftBound = rightBound = 0;\n}\nimage.copy(bufor, 0, 0);\n}\n</code></pre>\n\n<p>The results are quite unsatisfactionary for Sobel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/B1AM5.png\" rel=\"nofollow noreferrer\">Thinning the Sobel</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Sy4i9.png\" rel=\"nofollow noreferrer\">Sobel after hysteresis</a></p>\n\n<p>With Scharr the results are way better:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gZIVm.png\" rel=\"nofollow noreferrer\">Thinned Scharr</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/JL2mS.png\" rel=\"nofollow noreferrer\">Scharr after hysteresis</a></p>\n\n<p>Set of parameters:</p>\n\n<pre><code>#define thinsize 1                  \n#define scharrDivision 1        \n#define sobelDivision 1                 \n#define hysteresisRadius 1          \n#define level 40                    \n#define hysteresisUpperLevelSobel 80        \n#define hysteresisLowerLevelSobel 60        \n#define hysteresisUpperLevelScharr 200      \n#define hysteresisLowerLevelScharr 100      \n</code></pre>\n\n<p>As you can see, there is a problem with Sobel, which generate double edges. Scharr also generates some noise but I think it's acceptable. Of course, it always can get better, if someone could give some advice :)</p>\n\n<p>What is the cause of this behaviour? Does it result from my mistakes or poor algorithms or maybe is it just a case of parameters?</p>\n\n<p>EDIT:\nposting main()</p>\n\n<pre><code>sf::Image imydz;\nimydz.loadFromFile(\"lena.jpg\");\nint x = imydz.getSize().x;\nint y = imydz.getSize().y;\n\n\npixldata **garray = new pixldata *[x];\nfor (int i = 0;i &lt; x;i++)\n{\ngarray[i] = new pixldata[y];\n}\n\n\nmonochrome(imydz);\ngauss(imydz, radius, sigma);\n\n//sobel(imydz, garray, sobelDivision);\n\nscharr(imydz, garray, scharrDivision);\n\nintelligentThin(imydz, thinsize, garray);\nhysteresis(imydz, hysteresisRadius, hysteresisUpperLevel, hysteresisLowerLevel);\n</code></pre>\n\n<p>Second edit - repaired suppression:</p>\n\n<pre><code>sf::Image bufor;\nbufor.create(image.getSize().x, image.getSize().y, sf::Color::Black);\nfor (int i = 1;i &lt; xmax - 1;i++)\n{\n    for (int j = 1;j &lt; ymax - 1;j++)\n    {\n        if (garray[i][j].fi == 0)\n        {\n            if (((image.getPixel(i, j).r &gt;= image.getPixel(i + 1, j).r) &amp;&amp; (image.getPixel(i, j).r &gt; image.getPixel(i - 1, j).r)) ||\n                ((image.getPixel(i, j).r &gt; image.getPixel(i + 1, j).r) &amp;&amp; (image.getPixel(i, j).r &gt;= image.getPixel(i - 1, j).r)))\n            {\n                judgeandjury = true;\n            }\n            else judgeandjury = false;\n        }\n...\n if (judgeandjury == false)\n        {\n            bufor.setPixel(i, j, sf::Color::Black);\n        }\n        else bufor.setPixel(i, j, image.getPixel(i, j));\n        judgeandjury = false;\n    }\n}\nimage.copy(bufor, 0, 0);\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9XGxf.png\" rel=\"nofollow noreferrer\">Repaired Scharr on Lena</a>\nIt seems strange\n<a href=\"https://i.stack.imgur.com/9C0rN.png\" rel=\"nofollow noreferrer\">Another test image - strange results</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/a0CZN.png\" rel=\"nofollow noreferrer\">Before binarization</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/QFisi.png\" rel=\"nofollow noreferrer\">Ready gears</a></p>\n"}, {"tags": ["c++", "bit-manipulation", "x86-64", "avx", "micro-optimization"], "comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1534976488, "post_id": 51975720, "comment_id": 90902286, "body": "Ryzen unfortunately doesn&#39;t have efficient <a href=\"http://felixcloutier.com/x86/PDEP.html\" rel=\"nofollow noreferrer\"><code>pdep</code></a> (6 uops, 18c latency/throughput, unlike Intel where it&#39;s 3c latency / 1c throughput: <a href=\"https://agner.org/optimize/\" rel=\"nofollow noreferrer\">agner.org/optimize</a>), so your best bet is probably to expand bits to SIMD vector elements you can shuffle with <code>pshufb</code> or interleave with <code>punpcklbw</code>.  See <a href=\"https://stackoverflow.com/q/21622212\">How to perform the inverse of _mm256_movemask_epi8 (VPMOVMSKB)?</a>.  (but maybe use four 16-bit chunks instead of AVX2 32-bit vectors, if you mostly care about Ryzen).  Then shuffle and use <code>_mm_movemask_epi8</code>"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1534980619, "post_id": 51975720, "comment_id": 90903159, "body": "This is in danger of being closed as a request for a library or similar.  See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>.  Just ask what the best way to do it is.  google is where you ask if you only want to find an implementation that already exists.  Stack Overflow is where you ask what the actual best / most-efficient way to implement it is."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 4, "creation_date": 1534991449, "post_id": 51975720, "comment_id": 90905119, "body": "there are already many questions about 8x8 rotation <a href=\"https://stackoverflow.com/q/6930667/995714\">What is the fastest way to rotate the bits in an 8x8 block on bits?</a>, <a href=\"https://stackoverflow.com/q/41778362/995714\">How to efficiently transpose a 2D bit matrix</a>, <a href=\"https://stackoverflow.com/q/21745008/995714\">Flip bits of byte array - performance improvement</a>. Now you need to implement the 6x6 one"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1534995482, "post_id": 51975720, "comment_id": 90905802, "body": "to rotate left 90&#176; a row in a 6x6 matrix or its minor around the secondary diagonal use <code>mat*0x810204081 &amp; 0x820820820</code> like <a href=\"https://stackoverflow.com/a/51653145/995714\">what I used for 8x8</a>"}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "edited": false, "score": 2, "creation_date": 1535024111, "post_id": 51975720, "comment_id": 90919059, "body": "Did you consider to store the 7x7 bits as <code>0, 0, ..., 0, 0, b48, ...b42,...,0, b20, ...,b14, 0, b13, ..., b7, 0, b6, ... , b0</code>, i.e. with padding of 7 times 1 zero bit in between and 8 extra zero bits at the end. Then you can reuse all the existing 8x8 code on the internet for the 7x7 case as well. You only need one extra bit shift at the end, to get the bits at the right position."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "edited": false, "score": 1, "creation_date": 1535037211, "post_id": 51975720, "comment_id": 90927617, "body": "@wim: I was thinking the same thing.  Your best bet for 6x6 and 7x7 is unpacking to a row-stride of 8 bits to set up for SIMD byte-manipulation.  e.g. <code>_mm_shuffle_epi8</code>  for 180-degree rotations or mirroring, for the bit-reverse within each byte (using 4-bit lookup tables) + a right-shift by 1 or 2.  Scalar <code>bswap</code> + shift can byte-reverse, so you probably want to combine the shifts together.  Unpacking to that format without pext/pdep sucks. <a href=\"https://godbolt.org/z/6cUhIL\" rel=\"nofollow noreferrer\">godbolt.org/z/6cUhIL</a> design notes for scalar and/andn(BMI1) + ADD or LEA.  (masking to move some bits using <code>x+x = x&lt;&lt;1</code>, but <code>x+ (x&amp;mask)</code>."}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1535065101, "post_id": 51975720, "comment_id": 90940190, "body": "@PeterCordes Yes indeed. I don&#39;t see an efficient way for packing/unpacking from 64 to 36 or 49 bits either, without fast (Intel) pext/pdep. At fmb: Note that a row-stride of 8 bits throughout the whole code would only have a very minor impact on the storage requirements: one 6x6 bit matrix takes 6 bytes in that case instead of 5 bytes for the packed case. In the 7x7 case there is no difference at all."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "edited": false, "score": 0, "creation_date": 1535066520, "post_id": 51975720, "comment_id": 90940488, "body": "@wim: AMD <code>pdep</code> is 6 uops (but 18c latency/throughput), and might possible be optimal if front-end throughput is the bottleneck.  My idea needs maybe 9 uops and 9c latency (including a 3c LEA) for 7x7, but has not port-pressure bottlenecks.  So yeah, we definitely want row stride=8 for efficient operations.  Interesting point about packing them more tightly;  My understanding was that the OP was already padding them out to <code>uint64_t</code>, just with all the padding at the end."}, {"owner": {"reputation": 801, "user_id": 5458023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78d0c57307f229f203c5e8abc108601?s=128&d=identicon&r=PG&f=1", "display_name": "fmb", "link": "https://stackoverflow.com/users/5458023/fmb"}, "edited": false, "score": 0, "creation_date": 1535090467, "post_id": 51975720, "comment_id": 90945735, "body": "Thanks a lot for all the responses, this is more content than I can digest at short notice and will keep me busy for a while. Just for the minutes, I hereby ask &quot;what the actual best / most-efficient way to implement it is.&quot; - I thought I had expressed this already by asking for a &quot;more clever way&quot; even without disclosing my approach."}], "answers": [{"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1535036788, "post_id": 51988761, "comment_id": 90927341, "body": "Can you use the same mask twice, with AND and ANDN, then compare against zero vs. compare against the mask?"}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1535048842, "post_id": 51988761, "comment_id": 90933845, "body": "@PeterCordes Indeed ANDN and compare against zero is an alternative, but I don&#39;t see a way to get rid of the second mask."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1535049018, "post_id": 51988761, "comment_id": 90933949, "body": "Oh silly me, those masks aren&#39;t the inverse of each other.  They&#39;re selecting different single bits in different nibbles, not opposite nibbles.  I&#39;d just been looking at unpacking row-stride=7 bits to row-stride = 8 bits, like I commented on the question, where I did need to mask something both ways.  (I wish compilers were better at compressing constants, like generating one from the other with a shift instead of loading them both.)"}], "tags": [], "owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "is_accepted": false, "score": 2, "last_activity_date": 1535049105, "last_edit_date": 1535049105, "creation_date": 1535036334, "answer_id": 51988761, "question_id": 51975720, "link": "https://stackoverflow.com/questions/51975720/rotating-by-90-a-bit-matrix-up-to-8x8-bits-within-a-64-bit-integer/51988761#51988761", "title": "Rotating (by 90&#176;) a bit matrix (up to 8x8 bits) within a 64-bit integer", "body": "<p>In principle AVX2 can be quite useful here. For example, to rotate 90 degrees, you can do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;immintrin.h&gt;\n#include &lt;stdint.h&gt;\n/*     gcc -O3 -Wall -m64 -mfma -mavx2 -march=skylake rot_bit_mat.c    */ \n\nint print_bitmat(uint64_t k);\n\nuint64_t bitmat_rot_90(uint64_t x){   /*  0xFEDCBA9876543210     */\n    __m256i   mask1   = _mm256_set_epi64x(0x1010101010101010, 0x2020202020202020, 0x4040404040404040, 0x8080808080808080);\n    __m256i   mask2   = _mm256_set_epi64x(0x0101010101010101, 0x0202020202020202, 0x0404040404040404, 0x0808080808080808);\n    __m256i   x_bc    = _mm256_set1_epi64x(x);                  /* Broadcast x                         */\n\n    __m256i   r_lo    = _mm256_and_si256(x_bc,mask1);           /* Extract the right bits within bytes */\n              r_lo    = _mm256_cmpeq_epi8(r_lo,mask1);          /* Test if bits within bytes are set   */\n    uint64_t  t_lo    = _mm256_movemask_epi8(r_lo);             /* Move 32 bytes to 32 bit mask        */\n\n    __m256i   r_hi    = _mm256_and_si256(x_bc,mask2);\n              r_hi    = _mm256_cmpeq_epi8(r_hi,mask2);\n    uint64_t  t_hi    = _mm256_movemask_epi8(r_hi);\n              return t_lo | (t_hi &lt;&lt; 32);\n}\n\n\nint main(int argc, char **argv){\n           /*  0xFEDCBA9876543210 */\n  uint64_t k = 0xA49B17E63298D5C3;\n\n  print_bitmat(k);\n  printf(\"\\n\");\n  print_bitmat(bitmat_rot_90(k));\n  printf(\"\\n\\n\");\n\n  return 0;\n}\n\nint print_bitmat(uint64_t k){\n    uint64_t i,j;\n    for (i = 0; i &lt; 8; i++){\n        for (j = 0; j &lt; 8; j++){\n            printf(\"%llu\",1ull &amp; (k &gt;&gt; (i * 8ull + j)));\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>$ ./a.out\n11000011\n10101011\n00011001\n01001100\n01100111\n11101000\n11011001\n00100101\n\n11101011\n11001000\n00011001\n01110110\n00100010\n01001101\n10011110\n11000110\n</code></pre>\n\n<p>It is likely that similar techniques can be used for other transformations. Although it may take some time to figure out the right bit masks.</p>\n\n<p>The comments on the question give directions for other transformations:\nAVX2 bit reversal of bytes is of interest here, see <a href=\"https://stackoverflow.com/a/24058332/2439725\">here</a> \nand <a href=\"https://stackoverflow.com/a/46318399/2439725\">here</a>. Although the latter answer bit reverses \n32 bit ints, while in your case bit reversal of 64 bit ints is relevant; so, it needs some modifications.\nThe <code>_bswap64()</code> intrinsic can be used to mirror the bit matrix upside down.</p>\n"}], "owner": {"reputation": 801, "user_id": 5458023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78d0c57307f229f203c5e8abc108601?s=128&d=identicon&r=PG&f=1", "display_name": "fmb", "link": "https://stackoverflow.com/users/5458023/fmb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1535049105, "creation_date": 1534975015, "last_edit_date": 1534976645, "question_id": 51975720, "link": "https://stackoverflow.com/questions/51975720/rotating-by-90-a-bit-matrix-up-to-8x8-bits-within-a-64-bit-integer", "title": "Rotating (by 90&#176;) a bit matrix (up to 8x8 bits) within a 64-bit integer", "body": "<p>I have a bit matrix (of size 6x6, or 7x7, or 8x8) stored within one single 64-bit integer.</p>\n\n<p>I am looking for c++ code that rotates these matrices by 90, 180, 270 degrees, as well as c++ code for shifting (horizontally and vertically) and mirroring these matrices. The output must be again a 64-bit integer.</p>\n\n<p>Using some of the advanced CPU instruction sets would probably be okay, as well as using hash tables or similar techniques - speed is of highest importance, and RAM is available. I will run this on an AMD Ryzen 7 1700 eight-core PC. I am not familiar with these instruction sets (e.g. SSE2), but I have used __popcnt64() and _rotl64() within C++.</p>\n\n<p>Can anybody point me in the right direction? I have written my own code for the 7x7 matrix but I now need the code for 6x6 and 8x8 and wonder whether anybody has published anything on this topic, perhaps in a more clever way than my 7x7 approach.</p>\n\n<p>By the way, the 6x6 and 7x7 matrices are stored in the least significant 36 and 49 bits, respectively, with the remaining bits set to zero.</p>\n"}, {"tags": ["c++", "decltype"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1534974832, "post_id": 51975660, "comment_id": 90901775, "body": "You misread the parentheses, the <code>decltype</code> only encapsulates the <code>sizeof</code>, the <code>n</code> is just a function parameter name"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 1, "last_activity_date": 1534975056, "creation_date": 1534975056, "answer_id": 51975729, "question_id": 51975660, "link": "https://stackoverflow.com/questions/51975660/c-decltype-explanation/51975729#51975729", "title": "C++ decltype explanation", "body": "<p><code>decltype(sizeof(0)) n</code> does not mean <code>decltype(4 n)</code>.  In</p>\n\n<pre><code>void * operator new(decltype(sizeof(0)) n) noexcept(false)\n</code></pre>\n\n<p>the <code>decltype(sizeof(0)) n</code> part means the parameter is named <code>n</code> and it has the type of what <code>sizeof(0)</code> returns.  You could replace this with</p>\n\n<pre><code>void * operator new(std::size_t n) noexcept(false)\n</code></pre>\n\n<p>since <code>sizeof</code> is guaranteed to return a <code>std::size_t</code> per <a href=\"https://timsong-cpp.github.io/cppwp/expr.sizeof#6\" rel=\"nofollow noreferrer\">[expr.sizeof]/6</a> but doing it the first way means you don't need to include <code>&lt;cstddef&gt;</code></p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1534975067, "creation_date": 1534975067, "answer_id": 51975731, "question_id": 51975660, "link": "https://stackoverflow.com/questions/51975660/c-decltype-explanation/51975731#51975731", "title": "C++ decltype explanation", "body": "<p><code>n</code> needs a type.</p>\n\n<p>The type is deduced by <code>decltype(sizeof(0))</code>.</p>\n\n<p><code>sizeof(0)</code> evaluates to a value of <code>4</code> but its type is <code>std::size_t</code>. It's as if you had used</p>\n\n<pre><code>std::size_t s = sizeof(0);\nusing type = decltype(s); // Only the type is important here, not the value.\nvoid * operator new(type n) noexcept(false)\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 8694474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97659a955c605478604ad5252e73a28?s=128&d=identicon&r=PG&f=1", "display_name": "JuliusCaesar", "link": "https://stackoverflow.com/users/8694474/juliuscaesar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 51975729, "answer_count": 2, "score": 0, "last_activity_date": 1534975398, "creation_date": 1534974616, "last_edit_date": 1534975398, "question_id": 51975660, "link": "https://stackoverflow.com/questions/51975660/c-decltype-explanation", "title": "C++ decltype explanation", "body": "<p>I found the following declaration on StackOverflow to replace the <code>new</code> / <code>delete</code> operator. But i would like to understand this notation\n<a href=\"https://stackoverflow.com/questions/8186018/how-to-properly-replace-global-new-delete-operators\">How to properly replace global new &amp; delete operators</a></p>\n\n<pre><code>void * operator new(decltype(sizeof(0)) n) noexcept(false)\n</code></pre>\n\n<p>Now let's split up: New obviusly needs to return a Pointer. And <code>new</code> is used as an operator. So far so good. It is also clear to me the <code>n</code> must represent the number of bytes to allocate.\nThe unclear part is the argument:</p>\n\n<p><code>sizeof(0)</code> (on a 32bit machine) evaluates to <code>sizeof(int) = 4</code>\nThen I got <code>decltype(4 n)</code>??? \nWhat does this mean?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1534975275, "post_id": 51975598, "comment_id": 90901931, "body": "<code>what():  std::bad_alloc</code> -- 1) Running out of heap memory or  2) An allocation function was given a wild (maybe negative) number of bytes to allocate.  What does the call stack say?"}, {"owner": {"reputation": 571, "user_id": 4096272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345c800d1d42a321a26ce5033e75f437?s=128&d=identicon&r=PG&f=1", "display_name": "Tony J", "link": "https://stackoverflow.com/users/4096272/tony-j"}, "edited": false, "score": 0, "creation_date": 1534976442, "post_id": 51975598, "comment_id": 90902271, "body": "Instead of using copy assignment <code>m_device = QPixmap(iconPath);</code> have you tried to use load? <code>m_device.load(iconPath);</code>? Copy assignment could potentially allocate more memory. Also make sure the file you are loading actually exists, is a reasonable size and is valid image."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1534999699, "post_id": 51975598, "comment_id": 90906644, "body": "One other possibility (in addition to the ones mentioned in the comments above) is that some buggy code that ran earlier in your program corrupted the heap in such a way that the heap allocator only &quot;noticed&quot; the corruption when the QPixmap constructor tried to allocate memory.  If that&#39;s the case, it can be tough to track down, since the problem could be anywhere from the top of main() onwards.  You can probably find it by moving your calls to updateDecoration() to various places in the program until you find the boundary between crash and no-crash (or on Linux, try valgrind to find the bug)"}, {"owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "reply_to_user": {"reputation": 571, "user_id": 4096272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345c800d1d42a321a26ce5033e75f437?s=128&d=identicon&r=PG&f=1", "display_name": "Tony J", "link": "https://stackoverflow.com/users/4096272/tony-j"}, "edited": false, "score": 0, "creation_date": 1535041452, "post_id": 51975598, "comment_id": 90930208, "body": "@Tony J I tried what you suggested to no avail unfortunately, thanks though."}, {"owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1535041502, "post_id": 51975598, "comment_id": 90930250, "body": "@Jeremy Friesner I tried using valgrind as you suggested. I have made an EDIT to my original post with regards to that, thank you for the suggestion."}, {"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1535041880, "post_id": 51975598, "comment_id": 90930470, "body": "Note the libpng failures. They are what most likely leads to <code>QPixmap</code>&#39;s code attempting to do some funny allocation."}, {"owner": {"reputation": 571, "user_id": 4096272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345c800d1d42a321a26ce5033e75f437?s=128&d=identicon&r=PG&f=1", "display_name": "Tony J", "link": "https://stackoverflow.com/users/4096272/tony-j"}, "edited": false, "score": 0, "creation_date": 1535042430, "post_id": 51975598, "comment_id": 90930764, "body": "With the libpng errors and not working on only two machines, I would suggest to check the libpng version see if there is any difference."}, {"owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "reply_to_user": {"reputation": 571, "user_id": 4096272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345c800d1d42a321a26ce5033e75f437?s=128&d=identicon&r=PG&f=1", "display_name": "Tony J", "link": "https://stackoverflow.com/users/4096272/tony-j"}, "edited": false, "score": 0, "creation_date": 1535054752, "post_id": 51975598, "comment_id": 90936605, "body": "@Tony J Along those same lines. The other machines capable of building are using an older version of gcc. Specifically, the other machines are using gcc98 whereas these two new machines are using gcc11. An attempt at trying to force Qt to compile with gcc98 was made but it was unsuccessful."}, {"owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "reply_to_user": {"reputation": 571, "user_id": 4096272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345c800d1d42a321a26ce5033e75f437?s=128&d=identicon&r=PG&f=1", "display_name": "Tony J", "link": "https://stackoverflow.com/users/4096272/tony-j"}, "edited": false, "score": 0, "creation_date": 1535061431, "post_id": 51975598, "comment_id": 90939284, "body": "@Tony J What would I be check the version of libpng against?"}], "owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535041407, "creation_date": 1534974346, "last_edit_date": 1535041407, "question_id": 51975598, "link": "https://stackoverflow.com/questions/51975598/stdbad-alloc-trouble-with-qpixmap", "title": "std::bad_alloc trouble with QPixmap()", "body": "<p>I am attempting a build of one of our GUI projects. This build works on every machine in the office save the two new machines. Here is the terminal output of the error:</p>\n\n<pre><code>viewPriorityChanged( 11, 0 )\nviewPriorityChanged( 12, 0 )\nviewPriorityChanged( 13, 0 )\nMainWindow.cpp debug print #5\nterminate called after throwing an instance of 'std::bad_alloc'\n  what():  std::bad_alloc\n./runlp_common: line 320: 11123 Aborted  (core dumped) $3\n</code></pre>\n\n<p>As you can see I have traced it down in the code with print statements. Here is the method that is erring in the code:</p>\n\n<pre><code>void MainWindow::updateDecoration()\n{\n  Geometry::DisplayTypes closest = Geometry::closestDisplayType();\n  QString closestStr = Geometry::displayTypeString(closest).toLower();\n  QString iconPath  = QString(QLatin1String(\":/images/device_skin_%1.png\")).\n                              arg(closestStr);\n\n  Messages::conout() &lt;&lt; \"MainWindow.cpp debug print #5\" &lt;&lt; std::endl;\n\n  m_device = QPixmap(iconPath); &lt;-- not making it past here\n\n  Messages::conout() &lt;&lt; \"MainWindow.cpp debug print #6\" &lt;&lt; std::endl;\n\n  QBitmap clBitmap = m_device.createHeuristicMask();\n  setFixedSize(m_device.size());\n  setMask(clBitmap);\n  update();\n}\n</code></pre>\n\n<p>It is the strangest thing (in my opinion) that this line would be causing just a few machines trouble. Any ideas what could be going on here?</p>\n\n<p>EDIT:</p>\n\n<p>I wanted to give a more detailed description of the terminal output:</p>\n\n<pre><code>MainWindow.cpp debug print #1\nMainWindow.cpp debug print #2\nToolsViewConfigTip_Series: Preloading tip images\nToolsViewConfigTip_Capacity: Preloading tip images.\nln: cannot remove '/etc/localtime': Permission denied\nUsing QGLBridge\nUsing QGLBridge\nQThread::start: Thread creation error: Resource temporarily unavailable\nlibpng error: Read Error\nlibpng error: Read Error\nlibpng error: Read Error\nlibpng error: Read Error\nlibpng error: Read Error\nlibpng error: Read Error\nlibpng error: Read Error\nlibpng error: Read Error\nQImage::scaled: Image is a null image\nviewPriorityChanged( 0, 0 )\nviewPriorityChanged( 1, 0 )\nviewPriorityChanged( 2, 0 )\nviewPriorityChanged( 3, 0 )\nviewPriorityChanged( 4, 0 )\nviewPriorityChanged( 5, 0 )\nviewPriorityChanged( 6, 0 )\nviewPriorityChanged( 7, 0 )\nviewPriorityChanged( 10, 0 )\nviewPriorityChanged( 11, 0 )\nviewPriorityChanged( 12, 0 )\nviewPriorityChanged( 13, 0 )\nMainWindow.cpp debug print #4\nMainWindow.cpp debug print #5\nterminate called after throwing an instance of 'std::bad_alloc'\n  what():  std::bad_alloc\n./runlp_common: line 320: 22676 Aborted                 (core dumped) $3\n----------- KillAllApps -----------\nIsobusMuxServer::clientDisconnected() Client 1 is now disconnected and destroyed\nIsobusMuxServer::clientDisconnected() Client 0 is now disconnected and destroyed\n-----------------------------------\n</code></pre>\n\n<p>I took the suggestion about using valgrind in the comments. Prior to this point in the program there actually are no alllocs, frees and no bytes are allocated. I tried running the other various tools in the valgrind package without any luck. The only other error I get is when running helgrind:</p>\n\n<pre><code>ProprietarySocketServer::startServer() bind: Address already in use\nProprietarySocketServer::startServer() Could not bind on port 41263\n</code></pre>\n"}, {"tags": ["c++", "visual-studio"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1534974403, "post_id": 51975573, "comment_id": 90901618, "body": "What changes are you making? Nothing changes in the code here. That&#39;s an empty <code>std::map</code> container. Please don&#39;t include videos, do your best to describe what the problem is in the body of your question. External links are nothing but trouble for many users."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 3, "creation_date": 1534974444, "post_id": 51975573, "comment_id": 90901629, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is what you need.  Failing that, you need a debugging tutorial?  Not sure what you want us to do with this."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 2, "creation_date": 1534974720, "post_id": 51975573, "comment_id": 90901733, "body": "In your video I keep seeing the message &quot;Compilation non success&quot; appear -- so the most likely explanation as to why the executable&#39;s behavior isn&#39;t changing is that the compile is failing, and thus the old executable (from the last version of the source code that did compile) is the one you are running, and it doesn&#39;t contain your recent changes.  (You might want to find your program&#39;s .exe file and delete it; that way the next time you run your program, you&#39;ll know it was something freshly compiled and not an old version)"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1534975490, "post_id": 51975573, "comment_id": 90902002, "body": "To expand on @JeremyFriesner&#39;s comment, in Visual Studio, use &lt;Ctrl&gt;-&lt;Alt&gt;-F7 to do a full clean and rebuild.  That&#39;ll make sure your executable is completely up to date."}, {"owner": {"reputation": 792, "user_id": 9382127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EMHsr.png?s=128&g=1", "display_name": "Foxy", "link": "https://stackoverflow.com/users/9382127/foxy"}, "edited": false, "score": 0, "creation_date": 1534977583, "post_id": 51975573, "comment_id": 90902532, "body": "Thanks for your answers, I edited the original message to get more information. I hope you understand my problem."}, {"owner": {"reputation": 792, "user_id": 9382127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EMHsr.png?s=128&g=1", "display_name": "Foxy", "link": "https://stackoverflow.com/users/9382127/foxy"}, "edited": false, "score": 0, "creation_date": 1534977925, "post_id": 51975573, "comment_id": 90902618, "body": "I also try to clean  and rebuild, but the problem seems stay..."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1534980690, "post_id": 51975573, "comment_id": 90903170, "body": "I like the term <i>&quot;My program is rebelling&quot;</i>.  I&#39;ve had programs and system that rebelling and seemed they had tempers too."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1534986148, "post_id": 51975573, "comment_id": 90904154, "body": "If it&#39;s not a problem with the program failing to compile, then perhaps it is a problem with a different source/header-file being read instead of the file that you are editing.  Try temporarily inserting a <code>#error hey_man_are_you_even_reading_this</code> line into the file that you are editing, right above (or below) the line(s) you are trying to change, and then do a full recompile of your program.  If you don&#39;t see the compiler trip over that <code>#error</code> directive, that is a good clue that your file isn&#39;t being read (and presumably some other file with the same name is being read instead)"}], "owner": {"reputation": 792, "user_id": 9382127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EMHsr.png?s=128&g=1", "display_name": "Foxy", "link": "https://stackoverflow.com/users/9382127/foxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534977544, "creation_date": 1534974234, "last_edit_date": 1534977544, "question_id": 51975573, "link": "https://stackoverflow.com/questions/51975573/my-program-is-rebelling-changes-are-not-made", "title": "My program is rebelling? Changes are not made", "body": "<p>I have an annoying problem with Visual Studio. Indeed, I am in the design of a compiler, and I have a file reserved for error messages. It works with a dictionary (std::map): code \u2192 message.</p>\n\n<p>However, the changes made to the dictionary do not seem to affect the program, which reacts as if no changes had been made.</p>\n\n<p>It would be difficult for me to explain more clearly with words, so I recorded <a href=\"https://streamable.com/xehke\" rel=\"nofollow noreferrer\">a video</a>. (It does not belong to the site, sorry, I did not find how to include it i, this post).</p>\n\n<p>As you can see, we use a function that displays the error message as it gets it from the dictionary :</p>\n\n<pre><code>std::map&lt;ErrorCodes, std::string&gt; Messages;\n...\nstd::string ErrMessage = Messages[code];\n</code></pre>\n\n<p>I do not understand why the changes made do not affect the program as intended. It seems that Visual Studio no longer compiles part of the code...</p>\n\n<p>Indeed, in the recording, we can see that the error message displayed in the console is the [E29] (the old one before the [E80]), and that the message displayed is not the one that corresponds with the enumeration either.</p>\n\n<p>The problem may seem simple, but I honestly do not see where it might lie...</p>\n\n<p>EDIT:</p>\n\n<p>Here is a more detailed explanation:</p>\n\n<p>In the video, the program running in the console is mine. \"Compilation not success\" is my own error message, and it is normal that it is displayed.</p>\n\n<p>Here is the call code of the error call display:</p>\n\n<pre><code>exception.ThrowError(exception.E0080);\n</code></pre>\n\n<p>E0080 is the error listing code, here are the error message files :</p>\n\n<p>*.hpp:</p>\n\n<pre><code>class Exception {\npublic:\n    enum ErrorCodes {\n        E0000,\n        E0001, //  Can't load file\n        E0002, //  Can't find header file\n        E0003, //  Expected file name\n        E0004, //  Unexpected token\n        E0005, //  Expected Identifier\n        E0006, //  Value without storage object\n        E0007, //  Already existing object\n        E0008, //  Redefined preprocessor definition\n        E0009, //  Redefined variable\n        E0010, //  Redefined function\n        E0011, //  Redefined object\n        E0012, //  Redefined rule\n        E0013, //  Redefined value\n        E0014, //  Undefined identifier\n        E0015, //  Buoyage symbol missing\n        E0016, //  Expected end of line symbol (';')\n        E0017, //  Unexpected character\n        E0018, //  Unknown token\n        E0019, //  Non-close comment\n        E0020, //  Non-compliant typing\n        E0021, //  Use of uninitialized data\n        E0022, //  Unacceptable suffix\n        E0023, //  Invalid keyword combination\n        E0024, //  Declaration not in accordance with non-local use\n        E0025, //  Incompatible value with type / object defined\n        E0026, //  Constant value too wide\n        E0027, //  Too much initialization value in a static size array\n        E0028, //  Non-conforming identifier\n        E0029, //  Expected statement\n        E0030, //  Wrong identifier format (the expected format is ASCII)\n        E0031, //  Wrong pointer initialization\n        E0032, //  Non-valid literal suffix\n        E0033, //  No object can have the identifier 'vanaur'\n        E0034, //  Non-existent object field\n        E0035, //  Non-existent object method\n        E0036, //  Missing function call arguments\n        E0037, //  A rvalue cannot be accessed via the pointers\n        E0038, //  The use of a pointer is unacceptable in this context\n        E0039, //  A reference cannot be made to a constant value\n        E0040, //  Invalid assembler code in external expression\n        E0041, //  The types of the two objects do not match in the image assignment\n        E0042, //  Only a defined object can be destroyed by the delete operator\n        E0043, //  Empty template\n        E0044, //  Object not existing in this namespace\n        E0045, //  Typage temptation with a non-instanciated structure\n        E0046, //  Temptation to access a private field of the object\n        E0047, //  Temptation to access a private method of the object\n        E0048, //  Invalid operator\n        E0049, //  Reserved identifier\n        E0050, //  Wrong usage of postfix and prefix operator\n        E0051, //  Temptation to access an inaccessible element in a table\n        E0052, //  The main function can only have 3 arguments variation\n        E0053, //  This function is not defined as being able to return an array\n        E0054, //  A non-instanciated structure cannot be used as an object instance with the keyword 'new'.\n        E0055, //  Wrong choice of the anonymous string concatenation operator (between '^' and'+')\n        E0056, //  An object can only inherit from one other object\n        E0057, //  Incorrect 'typename' value\n        E0058, //  Incorrect 'typesize' value\n        E0059, //  The identifier of a process ('proc') cannot contain spaces\n        E0060, //  The identifier of a process ('proc') cannot contain balises\n        E0061, //  An exception cannot be thrown out of a function\n        E0062, //  Syntax error\n        E0063, //  The increment value of an iteration (with step) must be numerical\n        E0064, //  An anonymous array serving as an iterator to a for loop cannot be empty\n        E0065, //  Wrong ternary condition format\n        E0066, //  A 'ret' instruction must only fit on one instruction (one line = one ';')\n        E0067, //  Division by zero\n        E0068, //  Wrong enumeration value\n        E0069, //  'Upon' block members cannot contain expressions other than 'it'\n        E0070, //  A match/case expression must contain at least one 'case' expression before using 'default'\n        E0071, //  Unknown error\n        E0072, //  Undefined object\n        E0073, //  Not a valid math expression\n        E0074, //  Expected character\n        E0075, //  Unbalanced brackets\n        E0076, //  Non-ascii character detected\n        E0077, //  The current version of Arlia only accepts constant values as optional function parameters\n        E0078, //  Undefined type\n        E0079, //  Statement not recognised in this context\n        E0080, //  Invalid statement\n    };\n    void ThrowError(ErrorCodes, char);\n    void ThrowError(ErrorCodes, std::string);\n    void ThrowError(ErrorCodes, token_t);\n    void ThrowError(ErrorCodes, token_t, Expr);\n    void ThrowError(ErrorCodes, Expr);\nprivate:\n    std::map&lt;ErrorCodes, std::string&gt; Messages =\n    {\n        { E0001, \" Can't load file\" },\n    { E0002, \" Can't find header file\" },\n    { E0003, \" Expected file name\" },\n    { E0004, \" Unexpected token\" },\n    { E0005, \" Expected Identifier\" },\n    { E0006, \" Value without storage object\" },\n    { E0007, \" Already existing object\" },\n    { E0008, \" Redefined preprocessor definition\" },\n    { E0009, \" Redefined variable\" },\n    { E0010, \" Redefined function\" },\n    { E0011, \" Redefined object\" },\n    { E0012, \" Redefined rule\" },\n    { E0013, \" Redefined value\" },\n    { E0014, \" Undefined identifier\" },\n    { E0015, \" Buoyage symbol missing\" },\n    { E0016, \" Expected end of line symbol (';')\" },\n    { E0017, \" Unexpected character\" },\n    { E0018, \" Unknown token\" },\n    { E0019, \" Non-close comment\" },\n    { E0020, \" Non-compliant typing\" },\n    { E0021, \" Use of uninitialized data\" },\n    { E0022, \" Unacceptable suffix\" },\n    { E0023, \" Invalid keyword combination\" },\n    { E0024, \" Declaration not in accordance with non-local use\" },\n    { E0025, \" Incompatible value with type / object defined\" },\n    { E0026, \" Constant value too wide\" },\n    { E0027, \" Too much initialization value in a static size array\" },\n    { E0028, \" Non-conforming identifier\" },\n    { E0029, \" Expected statement\" },\n    { E0030, \" Wrong identifier format (the expected format is ASCII)\" },\n    { E0031, \" Wrong pointer initialization\" },\n    { E0032, \" Non-valid literal suffix\" },\n    { E0033, \" No object can have the identifier 'vanaur'\" },\n    { E0034, \" Non-existent object field\" },\n    { E0035, \" Non-existent object method\" },\n    { E0036, \" Missing function call arguments\" },\n    { E0037, \" A rvalue cannot be accessed via the pointers\" },\n    { E0038, \" The use of a pointer is unacceptable in this context\" },\n    { E0039, \" A reference cannot be made to a constant value\" },\n    { E0040, \" Invalid assembler code in external expression\" },\n    { E0041, \" The types of the two objects do not match in the image assignment\" },\n    { E0042, \" Only a defined object can be destroyed by the delete operator\" },\n    { E0043, \" Empty template\" },\n    { E0044, \" Object not existing in this namespace\" },\n    { E0045, \" Typage temptation with a non-instanciated structure\" },\n    { E0046, \" Temptation to access a private field of the object\" },\n    { E0047, \" Temptation to access a private method of the object\" },\n    { E0048, \" Invalid operator\" },\n    { E0049, \" Reserved identifier\" },\n    { E0050, \" Wrong usage of postfix and prefix operator\" },\n    { E0051, \" Temptation to access an inaccessible element in a table\" },\n    { E0052, \" The main function can only have 3 arguments variation\" },\n    { E0053, \" This function is not defined as being able to return an array\" },\n    { E0054, \" A non-instanciated structure cannot be used as an object instance with the keyword 'new'\" },\n    { E0055, \" Wrong choice of the anonymous string concatenation operator (between '^' and'+')\" },\n    { E0056, \" An object can only inherit from one other object\" },\n    { E0057, \" Incorrect 'typename' value\" },\n    { E0058, \" Incorrect 'typesize' value\" },\n    { E0059, \" The identifier of a process ('proc') cannot contain spaces\" },\n    { E0060, \" The identifier of a process ('proc') cannot contain balises\" },\n    { E0061, \" An exception cannot be thrown out of a function\" },\n    { E0062, \" Syntax error\" },\n    { E0063, \" The increment value of an iteration (with step) must be numerical\" },\n    { E0064, \" An anonymous array serving as an iterator to a for loop cannot be empty\" },\n    { E0065, \" Wrong ternary condition format\" },\n    { E0066, \" A 'ret' instruction must only fit on one instruction (one line = one ';')\" },\n    { E0067, \" Division by zero\" },\n    { E0068, \" Wrong enumeration value\" },\n    { E0069, \" 'Upon' block members cannot contain expressions other than 'it'\" },\n    { E0070, \" A match/case expression must contain at least one 'case' expression before using 'default'\" },\n    { E0071, \" Unknown error\" },\n    { E0072, \" Undefined object\" },\n    { E0073, \" Not a valid math expression\" },\n    { E0074, \" Expected character\" },\n    { E0075, \" Unbalanced brackets\" },\n    { E0076, \" Non-ascii character detected\" },\n    { E0077, \" The current version of Arlia only accepts constant values as optional function parameters\" },\n    { E0078, \" Undefined type\" },\n    { E0079, \" Statement not recognised in this context\" },\n    { E0080, \" Invalid statement\" },\n\n    { E0000, \" ... \" }\n    };\n};\n</code></pre>\n\n<p>The *.cpp just implements the functions as follows :</p>\n\n<pre><code>ThrowError(ErrorCodes code) {\n    colored_message_error(\"[ E\" + std::to_string(code) + \" ]\" + Messages[code], Color::yellow);\n}\n</code></pre>\n\n<p>As you can see, the list contains 80 + 1 elements. And E0080 has 80 as index in the enumeration.</p>\n\n<p>When I try to access it: </p>\n\n<pre><code>exception.ThrowError(exception.E0080);\n</code></pre>\n\n<p>my program doesn't seem to want to update the information. That is, the enumeration constant sent to the function: in fact, the program displays the value I set before it (E29).</p>\n\n<p>It's exactly like I'm doing this:</p>\n\n<pre><code>exception.ThrowError(exception.E0029);\n</code></pre>\n\n<p>So, no, it's most likely not a stupid debugging or compiling problem (I still know how to use a compiler ^^). It seems strange that Visual Studio does not update this new data (how ? why ? is it ?).</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1534973673, "post_id": 51975420, "comment_id": 90901342, "body": "<i>Sams Teach Yourself C++ in 24 hours</i> That&#39;s a false promise. If you can, invest in <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">a good book</a> and learn the language properly."}, {"owner": {"reputation": 11, "user_id": 9035012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8970b2385d942d3fe50e00a61c0a7d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xmitten", "link": "https://stackoverflow.com/users/9035012/xmitten"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1534973848, "post_id": 51975420, "comment_id": 90901414, "body": "In other words i&#39;m wasting my time reading Sams Teach Yourself C++ in 24 hours"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1534973875, "post_id": 51975420, "comment_id": 90901423, "body": "See the section in your book about gathering user input. It will probably be in the I/O section of the text. If they don&#39;t cover <i>that</i> in their 24 hours, its not worth the paper it&#39;s printed on. Regardless, I concur with @RSahu. there are some great books out there. Do some browsing and read some reviews."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1534973897, "post_id": 51975420, "comment_id": 90901430, "body": "You should declare a <a href=\"https://en.cppreference.com/w/cpp/language/initializer_list\" rel=\"nofollow noreferrer\">constructor</a>. The first 24h are certainly the 24h where you will learn the most. But 20 years later I am still learning every day!"}, {"owner": {"reputation": 11, "user_id": 9035012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8970b2385d942d3fe50e00a61c0a7d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xmitten", "link": "https://stackoverflow.com/users/9035012/xmitten"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1534973961, "post_id": 51975420, "comment_id": 90901454, "body": "I just went to a local Barnes and Noble.  I definitely will look at the books @RSahu posted.  Thank you"}, {"owner": {"reputation": 2238, "user_id": 3810510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/65Qrj.jpg?s=128&g=1", "display_name": "Denis Sablukov", "link": "https://stackoverflow.com/users/3810510/denis-sablukov"}, "edited": false, "score": 0, "creation_date": 1534974242, "post_id": 51975420, "comment_id": 90901548, "body": "Basically, for changing private data you create setter method, like setHeight(int h) in your case. If you want to change it by user input, you could use additional variable and setter or overload operator &gt;&gt;."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1534974273, "post_id": 51975420, "comment_id": 90901567, "body": "These &quot;learn X fast&quot; books are usually the worst. You&#39;re going to want to take your time to absorb the concepts and have a solid, complete reference book as a foundation for your learning. <a href=\"http://www.stroustrup.com/4th.html\" rel=\"nofollow noreferrer\"><i>The C++ Programming Language</i></a> is really indispensable. The <a href=\"https://www.aristeia.com/books.html\" rel=\"nofollow noreferrer\"><i>Effective C++</i></a> series is worth considering."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 3, "last_activity_date": 1534974194, "creation_date": 1534974194, "answer_id": 51975565, "question_id": 51975420, "link": "https://stackoverflow.com/questions/51975420/taking-user-input-from-a-created-class/51975565#51975565", "title": "Taking user input from a created class", "body": "<p>You need to read the user's input, and then expose public access to assign new values to the class's private members.  For example:</p>\n\n<pre><code>class Trapezoid\n{\n    //assigns a number to a variable\nprivate:\n    int a = 20;\n    int b = 25;\n    int height = 30;\npublic:\n    int getArea();\n\n    void setA(int value);\n    void setB(int value);\n    void setHeight(int value);\n};\n\nint Trapezoid::getArea()\n{\n    // calculates the area and returns it.\n    return (a + b) / 2 + height;\n}\n\nvoid Trapezoid::setA(int value)\n{\n    a = value;\n}\n\nvoid Trapezoid::setB(int value);\n{\n    b = value;\n}\n\nvoid Trapezoid::setHeight(int value)\n{\n    height = value;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;limits&gt;\n#include &lt;cstdlib&gt;\n#include \"AreaTrapezoid.hpp\"\n\nint main()\n{\n    Trapezoid areaT;\n    int value;\n\n    // get the user's input and apply it to the Trapeziod.\n\n    std::cout &lt;&lt; \"Enter A: \";\n    std::cin &gt;&gt; value;\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n    areaT.setA(value);\n\n    std::cout &lt;&lt; \"Enter B: \";\n    std::cin &gt;&gt; value;\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n    areaT.setB(value);\n\n    std::cout &lt;&lt; \"Enter Height: \";\n    std::cin &gt;&gt; value;\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n    areaT.setHeight(value);\n\n    // displays the area result\n\n    std::cout &lt;&lt; \"The area of the Trapezoid: \" &lt;&lt; areaT.getArea() &lt;&lt; std::endl; \n    std::system(\"pause\"); \n\n    return 0;\n}\n</code></pre>\n\n<p>Alternatively, use a constructor instead:</p>\n\n<pre><code>class Trapezoid\n{\n    //assigns a number to a variable\nprivate:\n    int a;\n    int b;\n    int height;\npublic:\n    Trapezoid(int a, int b, int height);\n\n    int getArea();\n};\n\nTrapezoid::Trapezoid(int a, int b, int height)\n    : a(a), b(b), height(height)\n{\n}\n\nint Trapezoid::getArea()\n{\n    // calculates the area and returns it.\n    return (a + b) / 2 + height;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;limits&gt;\n#include &lt;cstdlib&gt;\n#include \"AreaTrapezoid.hpp\"\n\nint main()\n{\n    int a, b, h;\n\n    // get the user's input and apply it to the Trapeziod.\n\n    std::cout &lt;&lt; \"Enter A: \";\n    std::cin &gt;&gt; a;\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n\n    std::cout &lt;&lt; \"Enter B: \";\n    std::cin &gt;&gt; b;\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n    areaT.setB(value);\n\n    std::cout &lt;&lt; \"Enter Height: \";\n    std::cin &gt;&gt; h;\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n\n    // displays the area result\n\n    Trapezoid areaT(a, b, h);\n    std::cout &lt;&lt; \"The area of the Trapezoid: \" &lt;&lt; areaT.getArea() &lt;&lt; std::endl; \n    std::system(\"pause\"); \n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9035012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8970b2385d942d3fe50e00a61c0a7d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xmitten", "link": "https://stackoverflow.com/users/9035012/xmitten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534974194, "creation_date": 1534973472, "question_id": 51975420, "link": "https://stackoverflow.com/questions/51975420/taking-user-input-from-a-created-class", "title": "Taking user input from a created class", "body": "<p>I'm new to programming, I have been reading Sams Teach Yourself C++ in 24 hours.  I just started learning classes and am confused on how to allow user input on private data.  I created the following class that returns the area of a Trapezoid. Any suggestions would be greatly appreciated.  </p>\n\n<pre><code>    class Trapezoid\n{\n    //assigns a number to a variable\nprivate:\n    int a = 20;\n    int b = 25;\n    int height = 30;\n    int area;\npublic:\n    int getArea();\n};\n\nint Trapezoid::getArea()\n{\n    // calculates the area and returns it.\n    area = (a + b) / 2 + height;\n    return area;\n}\n\n#include \"AreaTrapezoid.hpp\"\n#include &lt;iostream&gt;\n\nint main()\n{\n    // accesses area inside the Trapeziod class.\n    Trapezoid areaT;\n    areaT.getArea();\n\n\n    // displays the area result\n    std::cout &lt;&lt; \"The area of a Trapezoid: \" &lt;&lt; areaT.getArea() &lt;&lt; std::endl; \n    std::cout &lt;&lt; system(\"pause\"); \n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1534971629, "post_id": 51974999, "comment_id": 90900539, "body": "Are you asking if this will &quot;generally&quot; work, or if it is defined behaviour or not?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534971686, "post_id": 51974999, "comment_id": 90900557, "body": "@NeilButterworth The code illustrates the question. The question isn&#39;t precisely about the code."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1534971735, "post_id": 51974999, "comment_id": 90900583, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25638770/reinterpret-castcharp-or-static-castcharvoidp-for-bytewise-pointer\">reinterpret_cast&lt;char*&gt;(p) or static_cast&lt;char*&gt;((void*)p)) for bytewise pointer difference, which is better?</a>"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1534971800, "post_id": 51974999, "comment_id": 90900603, "body": "Not directly the question but <a href=\"https://stackoverflow.com/a/51228315/1708801\">note strict aliasing issues</a>"}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 0, "last_activity_date": 1534972660, "creation_date": 1534972660, "answer_id": 51975268, "question_id": 51974999, "link": "https://stackoverflow.com/questions/51974999/reinterpret-cast-and-static-cast-what-is-the-difference-here/51975268#51975268", "title": "reinterpret_cast and static_cast - What is the difference here?", "body": "<p>Static casting to/from <code>void*</code> of another pointer is the same as <code>reinterpret_cast</code>ing.</p>\n\n<p>Using a pointer to a non-float as a pointer to a float can be UB, including things as innocuous as comparing one pointer value to another.</p>\n\n<p>A hardware reason behind this is that on some platforms, floats have mandatory alignment, and <code>==</code> on two <code>float*</code> may assume that they are pointing to aligned values.  On at least one platform, both <code>char*</code> and <code>void*</code> take up more memory than a <code>float*</code> because there is no byte-addressing on the platform; byte addressing is emulated by storing an additional \"offset\" and doing bitmasking operations under the hood.</p>\n\n<p>On other platforms, different address spaces entirely are used for different types of pointers.  One I'm aware of has function and value address spaces being distinct.</p>\n\n<p>The standard, mindful of such quirks and in order to permit certain optimizations, does not fully define what happens when you use incorrectly typed pointers.  Implementations are free to document that they behave like a flat memory model that you might expect but are not mandated to.</p>\n\n<p>I cannot remember if this is implementation defined (which means they must document if it is defined or UB) or just UB here (which means compilers are free to define its behavior, but do not have to).</p>\n\n<p>For types that where the <code>T*</code> is fully valid and proper (ie, there is actually an object of type <code>T</code> there, we just had a pointer to <code>void*</code> or <code>char*</code> to it, or somesuch), then <code>static_cast&lt;T*&gt;(static_cast&lt;void*&gt;(addy)) == reinterpret_cast&lt;T*&gt;(addy)</code> in every case.</p>\n\n<p>Aliasing issues -- having pointers to the wrong type -- are very tricky.</p>\n"}], "owner": {"reputation": 475, "user_id": 5699669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b09e5582c4459539142d4c3b5184df8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel ", "link": "https://stackoverflow.com/users/5699669/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 51975268, "answer_count": 1, "score": 0, "last_activity_date": 1534972660, "creation_date": 1534971357, "question_id": 51974999, "link": "https://stackoverflow.com/questions/51974999/reinterpret-cast-and-static-cast-what-is-the-difference-here", "title": "reinterpret_cast and static_cast - What is the difference here?", "body": "<p>Does it generally hold true that <code>static_cast&lt;T*&gt;(static_cast&lt;void*&gt;(a)) == reinterpret_cast&lt;T*&gt;(a)</code> for some type a that can be casted to T*. What cases will this not be true? I have an example below that shows a case where this holds true:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main() {\n  std::string a = \"Hello world\";\n  float* b = static_cast&lt;float*&gt;(static_cast&lt;void *&gt;(&amp;a[0]));\n  float* c = reinterpret_cast&lt;float*&gt;(&amp;a[0]);\n  std::cout &lt;&lt; (b == c) &lt;&lt; std::endl; // &lt;-- This prints 1 \n}\n</code></pre>\n\n<p>Please let me know if my question is unclear.</p>\n"}, {"tags": ["c++", "cmake", "vcpkg"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1534970957, "post_id": 51974813, "comment_id": 90900267, "body": "The include paths are automatically set. <code>target_link_libraries</code> handles all usage requirements, not just linked libraries"}, {"owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 1, "creation_date": 1534971329, "post_id": 51974813, "comment_id": 90900431, "body": "You can provide CMake a hint where to find the SDL package and its config file by adding its installation path to CMAKE_PREFIX_PATH on the command line, e.g. <code>cmake .. -G &quot;Visual Studio 15 2017 Win64&quot; -DCMAKE_PREFIX_PATH=C:&#47;SDL2</code> Mostly packages are installing their config files under &lt;installdir&gt;/lib/cmake/ . And regarding to the include files: SDL2::SDL2 and SDL2::SDL2main are symbolic targets and also carry information about the include path. Adding a target_link_library dependency also adds their include paths to the target being build."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 1, "creation_date": 1534971456, "post_id": 51974813, "comment_id": 90900474, "body": "@vre With <code>vcpkg</code> the folder structure is not the same. It won&#39;t be c:/SDL2."}, {"owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1534971626, "post_id": 51974813, "comment_id": 90900536, "body": "@drescherjm Did not know that, thanks. The installation path <code>C:&#47;SDL2</code> was a rough guess by me, so adapt that if necessary."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1534971707, "post_id": 51974813, "comment_id": 90900569, "body": "vcpkg creates binaries in vcpkg/installed/x64-windows/bin. Here is some info on integration with CMake. <a href=\"https://blog.kitware.com/vcpkg-a-tool-to-build-open-source-libraries-on-windows/\" rel=\"nofollow noreferrer\">blog.kitware.com/&hellip;</a>"}, {"owner": {"reputation": 9560, "user_id": 2023370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4840a671d94ce5df0818cce059cab62b?s=128&d=identicon&r=PG&f=1", "display_name": "user2023370", "link": "https://stackoverflow.com/users/2023370/user2023370"}, "edited": false, "score": 0, "creation_date": 1534972893, "post_id": 51974813, "comment_id": 90901033, "body": "Thank you all. Any thoughts on the errors on Ubuntu?"}, {"owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 0, "creation_date": 1534975986, "post_id": 51974813, "comment_id": 90902136, "body": "Are you including the vcpkg.cmake toolchain file on the CMake command line in Ubuntu too?"}, {"owner": {"reputation": 9560, "user_id": 2023370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4840a671d94ce5df0818cce059cab62b?s=128&d=identicon&r=PG&f=1", "display_name": "user2023370", "link": "https://stackoverflow.com/users/2023370/user2023370"}, "edited": false, "score": 0, "creation_date": 1534976821, "post_id": 51974813, "comment_id": 90902369, "body": "No. As <code>find_package</code> (in normal &quot;module&quot; mode) find SDL2 on Ubuntu, I had thought it might also work in &quot;Config&quot; mode too? I&#39;d rather not install vcpkg on Ubuntu, so perhaps I must resort to <code>if</code> clauses for Ubuntu/Windows?"}], "owner": {"reputation": 9560, "user_id": 2023370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4840a671d94ce5df0818cce059cab62b?s=128&d=identicon&r=PG&f=1", "display_name": "user2023370", "link": "https://stackoverflow.com/users/2023370/user2023370"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 735, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534970571, "creation_date": 1534970571, "question_id": 51974813, "link": "https://stackoverflow.com/questions/51974813/query-on-cmake-double-colon-in-target-name-after-vcpkg-install-of-sdl2", "title": "Query on CMake double colon in target name after vcpkg install of SDL2", "body": "<p>Installing SDL2 using vcpkg on Windows concludes by advising that CMake's <code>find_package</code> should be used in \"Config\" mode; and shows an example <code>target_link_libraries</code> invocation using <code>SDL2::SDL2</code> and <code>SDL2::SDL2main</code>. I'm not familiar with \"Config\" mode, nor these double colon names. I'm typically looking for <code>PACKAGE_INCLUDE_DIRS</code> and <code>PACKAGE_LIBRARIES</code>. So my first question is, assuming the double colon names somehow provide the <code>target_link_libraries</code> with the library paths, <em>how do I provide the include paths</em> to the compiler?</p>\n\n<p>Secondly, on Ubuntu, CMake warns that policy CMP0028 is not set; which relates to the double colon names. Using Make then produces two errors - that it cannot find <code>-lSDL2::SDL2</code> and <code>-lSDL2::SDL2main</code>.</p>\n\n<p>I'm looking to use vcpkg to prepare a range of libraries across a Windows lab for my C++ graphics students. A number of students also appreciate it if our example project codes can also work on Linux. </p>\n\n<p>My CMake version on Windows is 3.12.1; 3.10.2 on Ubuntu; and vcpkg was built from the github repo clone yesterday (21/08/18).</p>\n"}, {"tags": ["c++", "language-lawyer"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1534977416, "post_id": 51974783, "comment_id": 90902491, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/178570/discussion-on-question-by-poweredbyrice-why-is-the-destructor-called-for-an-obje\">moved to chat</a>."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1534985679, "post_id": 51974783, "comment_id": 90904040, "body": "Note that <a href=\"https://tio.run/##Sy4o0E3OScxL//8fSBUXKzhWcxUUZZYllqRacXHWOWpoVtdac3GmFWWm5qUolOVnpiikpOaklqTGO2o4amlacwFl0UUVKjSrIVyFCutarsy8EoXcxMw8oFFcnCBZ27zUcqA9IHPhuipARv3/DwA\" rel=\"nofollow noreferrer\">it&#39;s possible to reproduce the bug without causing memory leak</a>. The example in the question is not really practical, as it doesn&#39;t <code>delete</code> a <code>new</code>&#39;ed object."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1534971247, "post_id": 51974964, "comment_id": 90900391, "body": "Not enough answer in <code>language-lawyer</code>, sorry. You need to add way more Standarteese to make it a proper answer in this tag."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534974540, "post_id": 51974964, "comment_id": 90901670, "body": "@SergeyA I&#39;ve looked up the standard rule from [class.dtor] which I believe is most relevant."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1534974880, "last_edit_date": 1592644375, "creation_date": 1534971199, "answer_id": 51974964, "question_id": 51974783, "link": "https://stackoverflow.com/questions/51974783/why-is-the-destructor-called-for-an-object-that-is-not-deleted/51974964#51974964", "title": "Why is the destructor called for an object that is not deleted?", "body": "<p>As far as I can tell, no objects are destroyed in the example, and it happens to compile if the expression is changed to <code>new A;</code></p>\n<p>I think that the example code not compiling is is a bug in GCC. <a href=\"http://coliru.stacked-crooked.com/a/2adabd07b3c483af\" rel=\"nofollow noreferrer\">Clang compiles it just fine</a>.</p>\n<hr />\n<p>Answer for the newly added language-lawyer tag.</p>\n<p>The crucial standard rule is this in [class.dtor]:</p>\n<blockquote>\n<p>A destructor is invoked implicitly</p>\n<p>... cases that don't apply involving other storage durations than dynamic ...</p>\n<p>... A destructor\nis also invoked implicitly through use of a delete-expression (5.3.5) for a constructed object allocated by\na new-expression (5.3.4); the context of the invocation is the delete-expression. [ Note: An array of class\ntype contains several subobjects for each of which the destructor is invoked. \u2014 end note ] A destructor can\nalso be invoked explicitly.  A destructor is potentially invoked if it is invoked or as specified in 5.3.4, 12.6.2,\nand 15.1.</p>\n</blockquote>\n<p>5.3.4 is [expr.new] which only specifies</p>\n<blockquote>\n<p>... If the\nnew-expression creates an array of objects of class type, the destructor is potentially invoked (12.4).</p>\n</blockquote>\n<p>which doesn't apply.</p>\n<p>12.6.2 is [class.base.init] which only specifies</p>\n<blockquote>\n<p>In a non-delegating constructor, the destructor for each potentially constructed subobject of class type is\npotentially invoked (12.4).</p>\n</blockquote>\n<p>Which doesn't apply</p>\n<p>15.1 is [except.throw] which specifies how an exception object is destroyed, which doesn't apply</p>\n<p>Conclusion: None of sections 5.3.4, 12.6.2, and 15.1. contain a rule that applies to this case, and the destructor isn't invoked, nor is there a delete-expression. Therefore the destructor isn't potentially invoked, so it is well formed for the destructor to be deleted.</p>\n"}, {"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1534972190, "post_id": 51975097, "comment_id": 90900767, "body": "Technically, the quoted rule doesn&#39;t say that the example program isn&#39;t ill-formed. It does seem like a good hint to why the bug might occur."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1534972508, "post_id": 51975097, "comment_id": 90900882, "body": "@RicharCritten And in this case clang reject the code: <a href=\"https://godbolt.org/z/xMMrKh\" rel=\"nofollow noreferrer\">godbolt.org/z/xMMrKh</a>. Maybe just an extra ! character inside gcc code!!"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534972570, "post_id": 51975097, "comment_id": 90900901, "body": "Yup looking like a bug"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534972591, "post_id": 51975097, "comment_id": 90900911, "body": "The fact that <code>new A[10]</code> compiles is puzzling, because what if <code>A()</code>throws? Generated code in this case pretends no destructor needs to be called, which is incorrect. Strongly looks like a bug in gcc."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534972703, "post_id": 51975097, "comment_id": 90900949, "body": "Live with A() throwing: <a href=\"https://godbolt.org/z/7f7CFG\" rel=\"nofollow noreferrer\">godbolt.org/z/7f7CFG</a>  How about because <code>A</code> is POD no destructor is needed?  Making <code>A</code> non-POD gives the expected error: <a href=\"https://godbolt.org/z/7P-4Ph\" rel=\"nofollow noreferrer\">godbolt.org/z/7P-4Ph</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534972976, "post_id": 51975097, "comment_id": 90901063, "body": "@RichardCritten I have a very similar example, and compiler is not allowed to generate such code. Destructor is guaranteed to be called for objects already constructed if one of constructor throws."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534973274, "post_id": 51975097, "comment_id": 90901187, "body": "If the compiler can analyse an object to be POD (destructor would be a NOP) and the standard says <i>&quot;...potentially invoked...&quot;</i>; is the compiler allowed to not require the destructor?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534974118, "post_id": 51975097, "comment_id": 90901506, "body": "Making <code>A</code> non-POD and not allocating an array compiles:  <a href=\"https://godbolt.org/z/BhyfFY\" rel=\"nofollow noreferrer\">godbolt.org/z/BhyfFY</a>"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534974126, "post_id": 51975097, "comment_id": 90901513, "body": "@RichardCritten I have just found out this: [basic.def.odr] <i>A destructor for a class is odr-used if it is potentially invoked</i> (thank you pdf search!)"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534974179, "post_id": 51975097, "comment_id": 90901528, "body": "@Oliv thanks for that and also for not telling that I should be asking in a new question."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534974952, "post_id": 51975097, "comment_id": 90901816, "body": "@RichardCritten Maybe with the erroneous array: <a href=\"https://godbolt.org/z/E8Qpqk\" rel=\"nofollow noreferrer\">godbolt.org/z/E8Qpqk</a>. Looking inside the bug reported by Barry it seems to have been linked to this other <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=78469\" rel=\"nofollow noreferrer\">bug</a> which was declared fixed. I wonder if in this case we should report a new bug?"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534976303, "post_id": 51975097, "comment_id": 90902231, "body": "@RichardCritten I posted this <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=87066\" rel=\"nofollow noreferrer\">bug</a>. I hope it will help."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534976449, "post_id": 51975097, "comment_id": 90902274, "body": "Thanks for putting in the effort to write the report"}], "tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": false, "score": 4, "last_activity_date": 1534973011, "last_edit_date": 1534973011, "creation_date": 1534971836, "answer_id": 51975097, "question_id": 51974783, "link": "https://stackoverflow.com/questions/51974783/why-is-the-destructor-called-for-an-object-that-is-not-deleted/51975097#51975097", "title": "Why is the destructor called for an object that is not deleted?", "body": "<p>Probably a gcc bug here. </p>\n\n<p>The standard specifies that the destructor is potentially invoked when the new expression create an array <a href=\"https://timsong-cpp.github.io/cppwp/n4659/expr.new#20\" rel=\"nofollow noreferrer\">[expr.new]</a>:</p>\n\n<blockquote>\n  <p>If the new-expression creates an object or an array of objects of class type, access and ambiguity control are done for the allocation function, the deallocation function, and the constructor.\n  <strong>If the new-expression creates an array of objects of class type, the destructor is potentially invoked.</strong></p>\n</blockquote>\n\n<p><sup>emphasis mine</sup></p>\n\n<p><s>gcc applies also this rule when creating a non array, which is implicitly not a standard rule.</s> Thanks to below comments it seems gcc do the exact opposite: when creating a non array, it considers the destructor to be potentialy invoked and when creating an array it just don't check the destructor.</p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1534973044, "post_id": 51975338, "comment_id": 90901090, "body": "You missed a case of destructor invoked for elements of the array when one of the elements throws in constructor (discussed extensively in other answer)"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534973158, "post_id": 51975338, "comment_id": 90901139, "body": "@SergeyA According to the standard even if the constructor is noexcept the destructor is potentially invoked."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1534973214, "post_id": 51975338, "comment_id": 90901157, "body": "@Oliv, sure, you nailed it in your answer. I am just showing a (simplified) case to Barry."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534973285, "post_id": 51975338, "comment_id": 90901196, "body": "@Barry, fair enough, you were referring to a specific case. Ironically, looks like it might be relevant :)"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1534973318, "post_id": 51975338, "comment_id": 90901214, "body": "@Barry On the other hand neither a static storage duration nor a thread storage duration,... is created here!!"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1534973569, "post_id": 51975338, "comment_id": 90901299, "body": "It is becoming funny, so neither a static storage duration, ... nor an array are created here! The problem seems to be that gcc has some how inverted the rule I quote in [expr.new]. gcc accepts new A[10] while it should not and reject new A{} while it should accept it! Our answer are complementary."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1534973714, "post_id": 51975338, "comment_id": 90901358, "body": "@user2079303 Okay yeah, I don&#39;t know what I was thinking earlier."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 37, "last_activity_date": 1534974295, "last_edit_date": 1592644375, "creation_date": 1534972957, "answer_id": 51975338, "question_id": 51974783, "link": "https://stackoverflow.com/questions/51974783/why-is-the-destructor-called-for-an-object-that-is-not-deleted/51975338#51975338", "title": "Why is the destructor called for an object that is not deleted?", "body": "<p>This is <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=57082\" rel=\"noreferrer\">gcc bug 57082</a>.</p>\n<hr />\n<p>Let's go from the bottom up.</p>\n<p><a href=\"http://eel.is/c++draft/dcl.dcl#dcl.fct.def.delete-2.sentence-1\" rel=\"noreferrer\">[dcl.fct.def.delete]/2</a>:</p>\n<blockquote>\n<p>A program that refers to a deleted function implicitly or explicitly, other than to declare it, is ill-formed.</p>\n</blockquote>\n<p>Clearly, we're not referring to <code>~A()</code> explicitly. Are we referring to it implicitly? <a href=\"http://eel.is/c++draft/class.dtor#12\" rel=\"noreferrer\">[class.dtor]/12</a>:</p>\n<blockquote>\n<p>A destructor is invoked implicitly</p>\n<ul>\n<li>for a constructed object with static storage duration ([basic.stc.static]) at program termination ([basic.start.term]),</li>\n<li>for a constructed object with thread storage duration ([basic.stc.thread]) at thread exit,</li>\n<li>for a constructed object with automatic storage duration ([basic.stc.auto]) when the block in which an object is created exits ([stmt.dcl]),</li>\n<li>for a constructed temporary object when its lifetime ends ([conv.rval], [class.temporary]).</li>\n</ul>\n</blockquote>\n<p>Or in <a href=\"http://eel.is/c++draft/expr.new#20.sentence-2\" rel=\"noreferrer\">[expr.new]/20</a>:</p>\n<blockquote>\n<p>If the <em>new-expression</em> creates an array of objects of class type, the destructor is potentially invoked.</p>\n</blockquote>\n<p>Do we have any of those things? No, there is no object with automatic, static, or thread storage duration here, nor is there a constructed temporary object, nor is our <em>new-expression</em> creating an array. There is only one object here at all, the one <code>A</code> with dynamic storage duration that we're aggregate-initializing.</p>\n<p>Since we're neither explicitly nor implicitly referring to <code>~A()</code>, we can't be tripping over that rule. Hence, gcc bug. Note also that gcc accepts <code>new A;</code> and <code>new A();</code>, which have the same meaning as far as this rule is concerned.</p>\n"}], "owner": {"reputation": 2279, "user_id": 2288628, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8e7edd8267abc525a6c48d87d7f7fcf5?s=128&d=identicon&r=PG", "display_name": "PoweredByRice", "link": "https://stackoverflow.com/users/2288628/poweredbyrice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2615, "favorite_count": 5, "accepted_answer_id": 51975338, "answer_count": 3, "score": 57, "last_activity_date": 1534974880, "creation_date": 1534970455, "last_edit_date": 1534971131, "question_id": 51974783, "link": "https://stackoverflow.com/questions/51974783/why-is-the-destructor-called-for-an-object-that-is-not-deleted", "title": "Why is the destructor called for an object that is not deleted?", "body": "<pre><code>struct A\n{\n    ~A() = delete;\n};\n\nint main()\n{\n    new A{};\n}\n</code></pre>\n\n<p>This fails to compile with error message: </p>\n\n<blockquote>\n  <p>error: use of deleted function 'A::~A()'\n            new A{};</p>\n</blockquote>\n\n<p>As I understand I'm not destroying the object so why is it trying to call the destructor?</p>\n\n<p>Compiled with\nGCC 8.1.0 </p>\n\n<pre><code>g++ -std=c++17 -O2\n</code></pre>\n"}, {"tags": ["c++", "encryption", "unicode", "char", "wchar"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1534973656, "post_id": 51974780, "comment_id": 90901333, "body": "Of course they&#39;re different. You&#39;re hashing different data. In the <code>char</code> case you&#39;re hashing 14 bytes of data, in the <code>wchar_t</code> case it&#39;s 28 bytes of data. Which one you want is entirely up to you and your usage case. If your intent is to digest a 14-character narrow string, the former is correct. If the intent is to digest a 14-character wide string then it&#39;s the latter. We have no idea which of those <i>your situation needs</i> so we can&#39;t answer that."}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1534996235, "post_id": 51975760, "comment_id": 90905930, "body": "UTF-16 will take up less space if the data contain mostly codepoints above 2048"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1534975301, "creation_date": 1534975301, "answer_id": 51975760, "question_id": 51974780, "link": "https://stackoverflow.com/questions/51974780/should-i-use-wchar-or-char-to-encrypt/51975760#51975760", "title": "Should I use wchar or char to encrypt?", "body": "<blockquote>\n  <p>which should I use to hash the key, char string or wchar_t string?</p>\n</blockquote>\n\n<p>That is a matter of personal choice.  Use whichever one suits your needs.  Encryption operates on raw bytes, it doesn't care what those bytes represent.</p>\n\n<blockquote>\n  <p>UTF-8 in my apps means to use always char and UTF-16 means the use of wchar_t?</p>\n</blockquote>\n\n<p>On windows, yes.  <code>wchar_t</code> is not 2 bytes on most other platforms, so not UTF-16.</p>\n\n<blockquote>\n  <p>I use always UNICODE in Visual Studio 2017 then should I use wchar since WindowsAPI's outputs seems to be wchar_t?</p>\n</blockquote>\n\n<p>Yes, Windows is a Unicode-based OS, and most of its string-based APIs expect/return UTF-16.  But encryption APIs do not care about that.  Though, in your case, you should probably consider converting UTF-16 to UTF-8 before encrypting, and then convert UTF-8 to UTF-16 after decrypting.  That way, your encrypted data takes up less storage space, at least.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8554358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 51975760, "answer_count": 1, "score": 0, "last_activity_date": 1534975301, "creation_date": 1534970438, "last_edit_date": 1534970747, "question_id": 51974780, "link": "https://stackoverflow.com/questions/51974780/should-i-use-wchar-or-char-to-encrypt", "title": "Should I use wchar or char to encrypt?", "body": "<p>I have this code working to create a hash of the key to encrypt a string using Wincrypt:</p>\n\n<pre><code>wchar_t key[] = L\"123456789AFA11\";\nwchar_t *key_str = key;\nsize_t len = lstrlenW(key_str);\n\n\nDWORD dwStatus = 0;\nBOOL bResult = FALSE;\nwchar_t info[] = L\"Microsoft Enhanced RSA and AES Cryptographic Provider\";\nHCRYPTPROV hProv;\n\nif (!CryptAcquireContextW(&amp;hProv, NULL, info, PROV_RSA_AES, CRYPT_VERIFYCONTEXT)) {\n    dwStatus = GetLastError();\n    printf(\"CryptAcquireContext failed: %x\\n\", dwStatus);\n    CryptReleaseContext(hProv, 0);\n    system(\"pause\");\n    return dwStatus;\n}\n\nHCRYPTHASH hHash;\n\nif (!CryptCreateHash(hProv, CALG_SHA_256, 0, 0, &amp;hHash)) {      // Note that we will truncate the SHA265 hash to the first 128 bits because we are using AES128.\n    dwStatus = GetLastError();\n    printf(\"CryptCreateHash failed: %x\\n\", dwStatus);\n    CryptReleaseContext(hProv, 0);\n    system(\"pause\");\n    return dwStatus;\n}\n\nif (!CryptHashData(hHash, (BYTE*)key_str, len * sizeof(wchar_t), 0)) {\n    DWORD err = GetLastError();\n    printf(\"CryptHashData Failed : %#x\\n\", err);\n    system(\"pause\");\n    return (-1);\n}\n</code></pre>\n\n<p>If I use char instead wchar as key the encrypted text is totally different since wchar is 2 bytes per character:</p>\n\n<pre><code>char key[] = \"123456789AFA11\";\nchar *key_str = key;\nsize_t len = lstrlenA(key_str);\n\n\nDWORD dwStatus = 0;\nBOOL bResult = FALSE;\nwchar_t info[] = \"Microsoft Enhanced RSA and AES Cryptographic Provider\";\nHCRYPTPROV hProv;\n\nif (!CryptAcquireContextA(&amp;hProv, NULL, info, PROV_RSA_AES, CRYPT_VERIFYCONTEXT)) {\n    dwStatus = GetLastError();\n    printf(\"CryptAcquireContext failed: %x\\n\", dwStatus);\n    CryptReleaseContext(hProv, 0);\n    system(\"pause\");\n    return dwStatus;\n}\n\nHCRYPTHASH hHash;\n\nif (!CryptCreateHash(hProv, CALG_SHA_256, 0, 0, &amp;hHash)) {      // Note that we will truncate the SHA265 hash to the first 128 bits because we are using AES128.\n    dwStatus = GetLastError();\n    printf(\"CryptCreateHash failed: %x\\n\", dwStatus);\n    CryptReleaseContext(hProv, 0);\n    system(\"pause\");\n    return dwStatus;\n}\n\nif (!CryptHashData(hHash, (BYTE*)key_str, len, 0)) {\n    DWORD err = GetLastError();\n    printf(\"CryptHashData Failed : %#x\\n\", err);\n    system(\"pause\");\n    return (-1);\n}\n</code></pre>\n\n<p>My question is which should I use to hash the key, char string or wchar_t string? </p>\n\n<p>Also another question is UTF-8 in my apps means to use always char and UTF-16 means the use of wchar_t? I use always UNICODE in Visual Studio 2017 then should I use wchar since WindowsAPI's outputs seems to be wchar_t?</p>\n"}, {"tags": ["c++", "c++11", "templates", "template-templates", "using-declaration"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1534971268, "post_id": 51974758, "comment_id": 90900405, "body": "If it were translated to <code>X&lt; Y &lt; T &gt; &gt;</code>, you&#39;d get an error because <code>T</code> is undefined (and another error because <code>Y&lt;T&gt;</code> is not a template (as required by <code>X</code>), it&#39;s a class)."}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 0, "last_activity_date": 1534971156, "creation_date": 1534971156, "answer_id": 51974950, "question_id": 51974758, "link": "https://stackoverflow.com/questions/51974758/template-template-parameters-what-rule-is-applied-in-the-following-example/51974950#51974950", "title": "Template Template Parameters: What rule is applied in the following example", "body": "<blockquote>\n  <p>The second one is strange. Doing analysis the <code>X&lt;Z&gt;</code> is translated to <code>X&lt; Y &lt; T &gt; &gt;</code>. I expect to print \"1\" . But running the code this prints \"2\".</p>\n</blockquote>\n\n<p>No.</p>\n\n<p>You have that <code>Z&lt;T&gt;</code> is defined as <code>Y&lt;T&gt;</code> so <code>Y</code> and <code>Z</code> are the same thing.</p>\n\n<p>And isn't true that <code>X&lt;Z&gt;</code> is translated to <code>X&lt;Y&lt;T&gt;&gt;</code> (and <code>X&lt;Y&lt;T&gt;&gt;</code> can't match because <code>Y&lt;T&gt;</code> is a type where <code>X</code> accept only template-template arguments).</p>\n"}], "owner": {"reputation": 631, "user_id": 2057014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1958eadc7b381d4e81e174be61cfd3e?s=128&d=identicon&r=PG", "display_name": "getsoubl", "link": "https://stackoverflow.com/users/2057014/getsoubl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1534973932, "accepted_answer_id": 51974950, "answer_count": 1, "score": 0, "last_activity_date": 1534972105, "creation_date": 1534970366, "last_edit_date": 1534972105, "question_id": 51974758, "link": "https://stackoverflow.com/questions/51974758/template-template-parameters-what-rule-is-applied-in-the-following-example", "closed_reason": "Duplicate", "title": "Template Template Parameters: What rule is applied in the following example", "body": "<p>Assume the following example</p>\n\n<pre><code>using namespace std;\ntemplate &lt;template &lt;typename&gt; class&gt;\nstruct X \n{\n   X() \n   { \n      std::cout &lt;&lt; \"1\"; \n   }\n};\n\ntemplate &lt;typename&gt;\nstruct Y {};\n\ntemplate &lt;typename T&gt;\nusing Z = Y&lt;T&gt;;\n\n template &lt;&gt;\n struct X&lt;Y&gt; \n {\n   X() \n   { \n      std::cout &lt;&lt; \"2\"; \n    }\n };\n\n int main() \n {\n   X&lt;Y&gt; x1;\n   X&lt;Z&gt; x2;\n }\n</code></pre>\n\n<p>The expression  <code>X&lt;Y&gt; x1</code> it is clear that is use the specialization that prints \"2\"</p>\n\n<p>The second one is strange. Doing analysis the <code>X&lt;Z&gt;</code> is translated to <code>X&lt; Y &lt; T &gt; &gt;</code>. I expect to print \"1\" . But running the code this prints \"2\". Which rule is applied in the second one?</p>\n"}, {"tags": ["c++", "singleton", "crtp"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534970135, "post_id": 51974670, "comment_id": 90899917, "body": "Have you considered <i>not</i> implementing the singleton anti-pattern and saving yourself a lot of grief down the line?"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534970347, "post_id": 51974670, "comment_id": 90900020, "body": "@JesperJuhl, hm, have you considered reading the &quot;<i>yes, I know - it&#39;s just for practice and research</i>&quot; part? I have no intention of using this in real code. Besides, the usefulness of Singleton pattern is not the topic of this question. I encourage you to read the 6th comment below the linked answer - the one with 45 upvotes."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534970604, "post_id": 51974670, "comment_id": 90900137, "body": "I still consider it a bad choice of practice problem."}], "answers": [{"comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1534970764, "post_id": 51974831, "comment_id": 90900195, "body": "It also makes creating objects of a type <code>A</code> possible, which is the very thing I want to avoid while implementing a singleton"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1534970811, "post_id": 51974831, "comment_id": 90900213, "body": "@Fureeish You just need to make <code>A</code>&#39;s constructor <code>protected</code> as well."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1534971253, "post_id": 51974831, "comment_id": 90900394, "body": "If I do so, your code stops compiling with <code>&#39;constexpr A::A()&#39; is protected within this context</code> error."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1534971484, "post_id": 51974831, "comment_id": 90900486, "body": "@Fureeish I forgot about that.  You&#39;d also have to add <code>friend class Singleton&lt;A&gt;;</code> to <code>A</code>."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1534971707, "post_id": 51974831, "comment_id": 90900568, "body": "So that means that the originally linked answer <i>does</i> have mistakes in it? It lacks both the <code>protected</code> constructor in derived class and the <code>friend</code> declaration. Does the <code>&#47;&#47; Rest of functionality for class A</code> imply them? Nonetheless, thank you, you&#39;ve been very helpful"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1534971797, "post_id": 51974831, "comment_id": 90900602, "body": "@Fureeish The linked answer does have a protected default constructor in <code>Singleton</code>.  The friend part was probably a missed observation like I did."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1534971918, "post_id": 51974831, "comment_id": 90900656, "body": "But it does not have the protected constructor in the derived class, which makes the code pointless"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1534970650, "creation_date": 1534970650, "answer_id": 51974831, "question_id": 51974670, "link": "https://stackoverflow.com/questions/51974670/implementing-singleton-with-crtp/51974831#51974831", "title": "Implementing Singleton with CRTP", "body": "<p>The issue with your first block of code is <code>Singleton(){}</code> is marked private.  This means <code>A</code> has no access to it so <code>A</code> cannot be default construct.  Making the constructor <code>protected</code> will fix that</p>\n\n<pre><code>template &lt;class ActualClass&gt; \nclass Singleton\n{\n   public:\n     static ActualClass&amp; GetInstance()\n     {\n       if(p == nullptr)\n         p = new ActualClass;\n       return *p; \n     }\n\n   protected:\n     static ActualClass* p;\n     Singleton(){}\n   private:\n     Singleton(Singleton const &amp;);\n     Singleton&amp; operator = (Singleton const &amp;); \n};\ntemplate &lt;class T&gt;\nT* Singleton&lt;T&gt;::p = nullptr;\n\nclass A: public Singleton&lt;A&gt;\n{\n    //Rest of functionality for class A\n};\n\nint main()\n{\n    auto&amp; x = Singleton&lt;A&gt;::GetInstance();\n}\n</code></pre>\n\n<p>Your second code bock has a similar issue but instead of the default construct being <code>private</code> you have marked it as <code>delete</code> so it is not =default constructable meaning <code>A</code> will also not be default constructable.  defaulting the constructor are making it <code>protected</code> like the first example will fix that</p>\n\n<pre><code>template &lt;class T&gt;\nclass Singleton {\npublic:\n\n    Singleton(const Singleton&amp;)              = delete;\n    Singleton(Singleton&amp;&amp;)                   = delete;\n    Singleton&amp; operator = (const Singleton&amp;) = delete;\n    Singleton&amp; operator = (Singleton&amp;&amp;)      = delete;\n\n    static T&amp; get_instance() {\n        if(!instance)\n            instance = new T;\n        return *instance;\n    }\n\nprotected:\n    Singleton()                              = default;\n    static inline T* instance = nullptr;\n};\n\nclass A: public Singleton&lt;A&gt; {\n    //Rest of functionality for class A\n};\n\nint main()\n{\n    auto&amp; x = Singleton&lt;A&gt;::get_instance();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1535017860, "post_id": 51976202, "comment_id": 90915395, "body": "Regarding your first snippet of code, uncommenting the <code>auto z = A();</code> <b>does not</b> result in a compilation error. Regarding your second snippet, I fail to see how that&#39;s a singleton. Regarding your third snippet, pretty much the same"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1535021145, "post_id": 51976202, "comment_id": 90917287, "body": "@Fureeish you&#39;re right, the default constructor is inherited by A. The point of snippets 2 and 3 is that the singleton nature of the implementation is an irrelevsnt detail from the point of view of all users of the object, since all copies of the (stateless) object are equivalent and refer to the same implementation."}, {"owner": {"reputation": 81, "user_id": 3092979, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ksSqN.jpg?s=128&g=1", "display_name": "Stranger1399", "link": "https://stackoverflow.com/users/3092979/stranger1399"}, "edited": false, "score": 0, "creation_date": 1563359098, "post_id": 51976202, "comment_id": 100670939, "body": "Visual Studio 2015 fails to compile the first snippet with <code>error C2248: &#39;A::A&#39;: cannot access protected member declared in class &#39;A&#39;</code> on line 8 in <code>get_instance</code>. Changing the <code>Singleton(allow)</code> access modifier to public fixes the error and <code>auto z = A();</code> still fails to compile as intended. Also tested in <a href=\"https://godbolt.org\" rel=\"nofollow noreferrer\">godbolt</a>."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 81, "user_id": 3092979, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ksSqN.jpg?s=128&g=1", "display_name": "Stranger1399", "link": "https://stackoverflow.com/users/3092979/stranger1399"}, "edited": false, "score": 0, "creation_date": 1563385011, "post_id": 51976202, "comment_id": 100685761, "body": "@Stranger1399 the code at the link you have given does not seem to relate to this answer?"}, {"owner": {"reputation": 81, "user_id": 3092979, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ksSqN.jpg?s=128&g=1", "display_name": "Stranger1399", "link": "https://stackoverflow.com/users/3092979/stranger1399"}, "edited": false, "score": 0, "creation_date": 1563975469, "post_id": 51976202, "comment_id": 100879033, "body": "@RichardHodges I just gave a link to the main page of the website. I copy pasted the code from the answer as is (commenting the <code>auto z = A();</code>). Here is a <a href=\"https://godbolt.org/z/6XPnRX\" rel=\"nofollow noreferrer\">link</a> with the code. Fails to compile only on msvc compiler."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 1, "last_activity_date": 1535021333, "last_edit_date": 1535021333, "creation_date": 1534978249, "answer_id": 51976202, "question_id": 51974670, "link": "https://stackoverflow.com/questions/51974670/implementing-singleton-with-crtp/51976202#51976202", "title": "Implementing Singleton with CRTP", "body": "<p>Smallest possible (I think) implementation.</p>\n\n<p>Features:</p>\n\n<ul>\n<li>A is neither copyable, constructible or movable. (move operators implicitly deleted by deleting copy ops)</li>\n<li>construction of the implementation is thread-safe.</li>\n<li>destruction of the implementation is assured at program end.</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<pre><code>template &lt;class T&gt;\nstruct Singleton \n{\n    Singleton(const Singleton&amp;)              = delete;\n    Singleton&amp; operator = (const Singleton&amp;) = delete;\n\n    static T&amp; get_instance() {\n        static T _{allow()};\n        return _;\n    }\n\nprivate:\n    struct allow {};\n\nprotected:\n    Singleton(allow) {}\n};\n\nclass A: public Singleton&lt;A&gt; {\n    using Singleton&lt;A&gt;::Singleton;\n    //Rest of functionality for class A\n};\n\nint main()\n{\n    auto&amp; x = Singleton&lt;A&gt;::get_instance();\n    auto&amp; y = A::get_instance();\n\n// compiler error\n    auto z = A();\n}\n</code></pre>\n\n<p>But why not make 'singleton-ness' an implementation detail? Why should users need to know that the object is a singleton?</p>\n\n<pre><code>template &lt;class T&gt;\nstruct Singleton \n{\nprotected:\n    static T&amp; get_impl() {\n        static T _;\n        return _;\n    }\n};\n\n// the real implementation of A\nstruct AImpl\n{\n    void foo();\n};\n\n// A is a value-type which just happens to be implemented in terms of a\n// single instance\nstruct A: public Singleton&lt;AImpl&gt; \n{\n    auto foo() { return get_impl().foo(); }\n};\n\nvoid bar(A a)\n{\n    a.foo();\n}\n\nint main()\n{\n    auto x = A();\n    x.foo();\n\n    auto y = A();\n    y.foo();\n\n    x = y;\n\n    bar(x);\n}\n</code></pre>\n\n<p>Then later, if you decide that the type should not be a singleton, you don't need to change its interface (and therefore the rest of your program):</p>\n\n<p>Example - A is a singleton and B is not. The interfaces are identical.</p>\n\n<pre><code>#include &lt;memory&gt;\n\ntemplate &lt;class T&gt;\nstruct Singleton \n{\nprotected:\n    static T&amp; get_impl() {\n        static T _;\n        return _;\n    }\n};\n\ntemplate&lt;class T&gt;\nstruct CopyableIndirect\n{\n    CopyableIndirect() = default;\n\n    CopyableIndirect(CopyableIndirect const&amp; r)\n    : impl_(std::make_unique&lt;T&gt;(*r.impl_))\n    {\n\n    }\n\n    CopyableIndirect(CopyableIndirect&amp;&amp; r)\n    : impl_(std::move(r.impl_))\n    {\n\n    }\n\n    CopyableIndirect&amp; operator=(CopyableIndirect const&amp; r)\n    {\n        auto temp = r;\n        swap(temp);\n        return *this;\n    }\n\n    CopyableIndirect&amp; operator=(CopyableIndirect &amp;&amp; r)\n    {\n        auto temp = std::move(r);\n        swap(temp);\n        return *this;\n    }\n\n    void swap(CopyableIndirect&amp; r)\n    {\n        std::swap(impl_, r.impl_);\n    }\nprotected:\n    T&amp; get_impl() {\n        return *impl_;\n    }\n\n    T const&amp; get_impl() const {\n        return *impl_;\n    }\n\n   std::unique_ptr&lt;T&gt; impl_ = std::make_unique&lt;T&gt;();\n};\n\nstruct AImpl\n{\n    void foo() const;\n};\n\nstruct A: public Singleton&lt;AImpl&gt; \n{\n    auto foo() const { return get_impl().foo(); }\n};\n\nstruct B: public CopyableIndirect&lt;AImpl&gt; \n{\n    auto foo() const { return get_impl().foo(); }\n};\n\nvoid bar(A const&amp; a)\n{\n    a.foo();\n}\n\nvoid bar(B const&amp; a)\n{\n    a.foo();\n}\n\nint main()\n{\n    auto x = A();\n    x.foo();\n\n    auto y = B();\n    y.foo();\n\n    bar(x);\n    bar(y);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1507, "user_id": 1161273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3b7e863645e1461848874b3c7f1018d?s=128&d=identicon&r=PG", "display_name": "pixelgrease", "link": "https://stackoverflow.com/users/1161273/pixelgrease"}, "is_accepted": true, "score": 2, "last_activity_date": 1556691259, "last_edit_date": 1556691259, "creation_date": 1556690949, "answer_id": 55932298, "question_id": 51974670, "link": "https://stackoverflow.com/questions/51974670/implementing-singleton-with-crtp/55932298#55932298", "title": "Implementing Singleton with CRTP", "body": "<p>Here's mods to the \"modernized\" snippet: </p>\n\n<pre><code>template &lt;class T&gt;\nclass Singleton {\npublic:\n    Singleton&amp; operator = (const Singleton&amp;) = delete;\n    Singleton&amp; operator = (Singleton&amp;&amp;)      = delete;\n\n    static T&amp; get_instance() {\n        if(!instance)\n            instance = new T_Instance;\n        return *instance;\n    }\n\nprotected:\n    Singleton() {}\n\nprivate:\n    struct T_Instance : public T {\n        T_Instance() : T() {}\n    };\n\n    static inline T* instance = nullptr;\n};\n\nclass A : public Singleton&lt;A&gt; {\nprotected:\n    A() {}\n};\n\nint main()\n{\n    auto&amp; x = A::get_instance();\n}\n</code></pre>\n\n<p>Summary of changes from snippet:</p>\n\n<ul>\n<li><code>protected</code> default constructor in singleton</li>\n<li><code>private</code> nested struct to access derived class's protected constructor</li>\n<li><code>protected</code> constructor in derived class to prevent instantiation</li>\n</ul>\n\n<p>Also, no need to <code>delete</code> constructors that are implicitly deleted by adding default ctor implementation to Singleton class.</p>\n\n<p>Not so small as <a href=\"https://stackoverflow.com/users/2015579/richard-hodges\">Richard Hodges</a>' example, but the static <code>instance</code> member makes it easy to add a delete_instance() method for use in automated unit tests.</p>\n"}], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1262, "favorite_count": 2, "accepted_answer_id": 55932298, "answer_count": 3, "score": 4, "last_activity_date": 1556691259, "creation_date": 1534969882, "question_id": 51974670, "link": "https://stackoverflow.com/questions/51974670/implementing-singleton-with-crtp", "title": "Implementing Singleton with CRTP", "body": "<p>After reading <a href=\"https://stackoverflow.com/a/4173298/7151494\">this answer</a> I have tried implementing some simple CRTP usage. I figured I'd try to implement the Singleton (yes, I know - it's just for practice and research) pattern, given the fact that the linked answer <em>kind of</em> already does it... except for the fact that it does not compile.</p>\n\n<p>The quoted code is as follows:</p>\n\n<pre><code>template &lt;class ActualClass&gt; \nclass Singleton\n{\n   public:\n     static ActualClass&amp; GetInstance()\n     {\n       if(p == nullptr)\n         p = new ActualClass;\n       return *p; \n     }\n\n   protected:\n     static ActualClass* p;\n   private:\n     Singleton(){}\n     Singleton(Singleton const &amp;);\n     Singleton&amp; operator = (Singleton const &amp;); \n};\ntemplate &lt;class T&gt;\nT* Singleton&lt;T&gt;::p = nullptr;\n\nclass A: public Singleton&lt;A&gt;\n{\n    //Rest of functionality for class A\n};\n</code></pre>\n\n<p>Which I then 'modernized' to:</p>\n\n<pre><code>template &lt;class T&gt;\nclass Singleton {\npublic:\n    Singleton()                              = delete;\n    Singleton(const Singleton&amp;)              = delete;\n    Singleton(Singleton&amp;&amp;)                   = delete;\n    Singleton&amp; operator = (const Singleton&amp;) = delete;\n    Singleton&amp; operator = (Singleton&amp;&amp;)      = delete;\n\n    static T&amp; get_instance() {\n        if(!instance)\n            instance = new T;\n        return *instance;\n    }\n\n   protected:\n     static inline T* instance = nullptr;\n};\n\nclass A: public Singleton&lt;A&gt; {\n    //Rest of functionality for class A\n};\n</code></pre>\n\n<p>I then tried to create a reference to the instance:</p>\n\n<pre><code>auto&amp; x = A::get_instance();\n</code></pre>\n\n<p>which obviously did not compile.</p>\n\n<p>It's worth mentioning that I get very similar error messages, notably:</p>\n\n<blockquote>\n  <p>note: 'A::A()' is implicitly deleted because the default definition would be ill-formed: <code>class A : public Singleton&lt;A&gt;</code>.</p>\n</blockquote>\n\n<p>Obviously, the second snippet of code <em>cannot</em> compile, since we deleted the default constructor and try to use it with <code>new T</code> in the <code>get_instance</code> method.</p>\n\n<p>What surprises me is that the first snippet doesn't compile either, with similar error messages. Does the linked answer has a mistake? How would I implement a <em>generic base class / interface for Singletons</em> using CRTP?</p>\n"}, {"tags": ["c++", "math", "geometry"], "answers": [{"tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 2, "last_activity_date": 1534975787, "creation_date": 1534975787, "answer_id": 51975842, "question_id": 51974668, "link": "https://stackoverflow.com/questions/51974668/nurbs-curve-2d-length-linear-sampling/51975842#51975842", "title": "Nurbs curve (2D) Length &amp; Linear Sampling", "body": "<p>The curve length follows the equation</p>\n\n<pre><code>ds / dt = \u221a(x'\u00b2(t) + y'\u00b2(t))\n</code></pre>\n\n<p>where <code>s</code> is the curvilinear abscissa, <code>t</code> the curve parameter and the derivatives are taken on <code>t</code>.</p>\n\n<p>What you are willing to do amounts to constructing the function <code>t(s)</code> and imposing your values of <code>s</code>. This is conveniently done by writing the differential equation</p>\n\n<pre><code>dt / ds = 1 / \u221a(x'\u00b2(t) + y'\u00b2(t))\n</code></pre>\n\n<p>and integrating it numerically, for example with Runge-Kutta.</p>\n"}, {"comments": [{"owner": {"reputation": 2795, "user_id": 1201507, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09d736757447fe10ccc7650179dd4f32?s=128&d=identicon&r=PG", "display_name": "Ram", "link": "https://stackoverflow.com/users/1201507/ram"}, "edited": false, "score": 0, "creation_date": 1535038230, "post_id": 51975870, "comment_id": 90928291, "body": "Only problem with using maple / Wolfram is that you get a result but not in C++ :)"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "reply_to_user": {"reputation": 2795, "user_id": 1201507, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09d736757447fe10ccc7650179dd4f32?s=128&d=identicon&r=PG", "display_name": "Ram", "link": "https://stackoverflow.com/users/1201507/ram"}, "edited": false, "score": 1, "creation_date": 1535038647, "post_id": 51975870, "comment_id": 90928550, "body": "I mean use maple or wolfram to get the exact formula for the length L with a specific C(u) by doing symbolic calculus and then recode or use code conversion to produce c++ code."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1535043667, "post_id": 51975870, "comment_id": 90931400, "body": "calculating C(u), C&#39;(u) from basis functions is not numerically stable though."}], "tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": false, "score": 1, "last_activity_date": 1534975971, "creation_date": 1534975971, "answer_id": 51975870, "question_id": 51974668, "link": "https://stackoverflow.com/questions/51974668/nurbs-curve-2d-length-linear-sampling/51975870#51975870", "title": "Nurbs curve (2D) Length &amp; Linear Sampling", "body": "<p>To compute the length of a parametrized curve c(u)=(x(u), y(u)) you can use the general formula. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Cdkxe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cdkxe.png\" alt=\"enter image description here\"></a></p>\n\n<p>see <a href=\"https://fr.wikipedia.org/wiki/Abscisse_curviligne\" rel=\"nofollow noreferrer\">curvilinear abscissa from wikipedia</a></p>\n\n<p>You explicitly know x(u) and y(u) since\n<a href=\"https://i.stack.imgur.com/lmnVX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lmnVX.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Non-uniform_rational_B-spline\" rel=\"nofollow noreferrer\">NURBS from wikipedia</a></p>\n\n<p>I believe you have the formula of the derivative of the rational basis functions. Therefore you have x'(u) and y'(u). Then you can either integrate using simpson's rule or use gauss points specifically to integrate rational polynomial or better yet use your favorite symbolic calculus tool (maple, wolfram,...) to compute exactly the integral.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1534984057, "creation_date": 1534984057, "answer_id": 51976830, "question_id": 51974668, "link": "https://stackoverflow.com/questions/51974668/nurbs-curve-2d-length-linear-sampling/51976830#51976830", "title": "Nurbs curve (2D) Length &amp; Linear Sampling", "body": "<p>Yes. Sampling as you do, instead of pairs, work by the triples of points, interpreting them as arcs <em>passing through</em> those three points. </p>\n\n<p>You will get much smaller approximation error with the same spacing of the sampling points, vs. the straight line segments.</p>\n"}], "owner": {"reputation": 2795, "user_id": 1201507, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09d736757447fe10ccc7650179dd4f32?s=128&d=identicon&r=PG", "display_name": "Ram", "link": "https://stackoverflow.com/users/1201507/ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1534984057, "creation_date": 1534969880, "question_id": 51974668, "link": "https://stackoverflow.com/questions/51974668/nurbs-curve-2d-length-linear-sampling", "title": "Nurbs curve (2D) Length &amp; Linear Sampling", "body": "<p>I have a Nurbs curve (Ctrl Points, Knot Vector, Weights &amp; 3rd or 4th degree). I am able to compute the length by sampling along the curve using a parameter t [0, 1]. Computing the sum of the distances along the curve gives an approximate length of the curve. </p>\n\n<ol>\n<li>Is there a better way to compute the length of the curve?</li>\n<li>Linear sampling: I would like to sample the curve linearly such that the distance between the first sample t = t0 = 0 to t = t1 is S1 and the last sample between t n-1 to tn = 1 is S2 and all the samples in between have lengths that interpolate linearly from S1 to S2.</li>\n</ol>\n\n<p>S1 and S2 are fixed.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 6, "creation_date": 1534969862, "post_id": 51974635, "comment_id": 90899782, "body": "C++08? Do you mean C++03 or C++98?"}, {"owner": {"reputation": 15, "user_id": 8354870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8765c996660058af98ecb89eb4e8ba?s=128&d=identicon&r=PG&f=1", "display_name": "cpoole", "link": "https://stackoverflow.com/users/8354870/cpoole"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1534973197, "post_id": 51974635, "comment_id": 90901152, "body": "I&#39;m not super familiar with the nomenclature to be perfectly honest. My searching seems to indicate the compiler I use is essentially the same as MSVS08 (which I am using because this is ultimately part of a Windows based cython package and this was the only compiler that would work that I could find.) I essentially just mean compatible with the most recent version of C++ as of 2008."}], "answers": [{"comments": [{"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1534969972, "post_id": 51974674, "comment_id": 90899839, "body": "Set the parameter defaults to Zero : <code>coordinate( int ax=0, int ay=0 ) : x(ax), y(ay) {}</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 2, "creation_date": 1534970060, "post_id": 51974674, "comment_id": 90899875, "body": "@James Why do you think that is desirable? Why do so many people seem to think that zero is a magic &quot;ok&quot; value? There is nothing in the OP&#39;s question that indicates that he wants this, and default constructors a source of many hard-to-find bugs."}, {"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1534970071, "post_id": 51974674, "comment_id": 90899879, "body": "Because of the Vector."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1534970157, "post_id": 51974674, "comment_id": 90899925, "body": "@James vectors do not require the things they contain to be default constructible."}, {"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1534970247, "post_id": 51974674, "comment_id": 90899977, "body": "<code>std::vector&lt;coordinate&gt; myVec; myVec.resize(10);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 1, "creation_date": 1534970619, "post_id": 51974674, "comment_id": 90900144, "body": "@James <code>std::vector&lt;coordinate&gt; myVec; myVec.resize(10, coordinate(0,0));</code>"}, {"owner": {"reputation": 15, "user_id": 8354870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8765c996660058af98ecb89eb4e8ba?s=128&d=identicon&r=PG&f=1", "display_name": "cpoole", "link": "https://stackoverflow.com/users/8354870/cpoole"}, "edited": false, "score": 0, "creation_date": 1534973402, "post_id": 51974674, "comment_id": 90901243, "body": "This is precisely the sort of thing I was looking for although, many thanks."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": true, "score": 4, "last_activity_date": 1534969898, "creation_date": 1534969898, "answer_id": 51974674, "question_id": 51974635, "link": "https://stackoverflow.com/questions/51974635/what-is-the-preferred-syntax-for-initializing-an-object-to-pass-as-an-argument-i/51974674#51974674", "title": "What is the preferred syntax for initializing an object to pass as an argument in C++08?", "body": "<p>Just give your struct a constructor:</p>\n\n<pre><code>  struct coordinate {\n        int x, y;\n        coordinate( int ax, int ay ) : x(ax), y(ay) {}\n  };\n</code></pre>\n\n<p>You can then say things like:</p>\n\n<pre><code> myVec.push_back( coordinate( 12, 42 ) );\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8354870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8765c996660058af98ecb89eb4e8ba?s=128&d=identicon&r=PG&f=1", "display_name": "cpoole", "link": "https://stackoverflow.com/users/8354870/cpoole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51974674, "answer_count": 1, "score": 1, "last_activity_date": 1534969898, "creation_date": 1534969727, "question_id": 51974635, "link": "https://stackoverflow.com/questions/51974635/what-is-the-preferred-syntax-for-initializing-an-object-to-pass-as-an-argument-i", "title": "What is the preferred syntax for initializing an object to pass as an argument in C++08?", "body": "<p>Let's say I have a struct that I am just using as an aggregate data holding device. As an example, a struct below holds two integer values. Let's assume I have a vector of these structs called myVec and I want to add a new struct to the vector with push_back. My understanding is that in C++11 and after one can achieve this without needing to make a named variable and passing that variable as an argument but instead can do the following.</p>\n\n<pre><code>struct coordinate {\n    int y;\n    int x;\n};\n//assume an initialized vector&lt;coordinate&gt; myVec \n//and two ints newY, newX not known at compile time\nmyVec.push_back( {newY,newX});\n</code></pre>\n\n<p>Based on the Notes section of <a href=\"https://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/aggregate_initialization</a>, \nIt seems like this is an example of using aggregate initialization in a constructor initializer list but I might be wrong about that. That source indicates that this syntax doesn't work pre-C++11 and while it works with MSVS2017 it doesn't with Visiual C++ for Python which is what I am targeting. Is there a syntax pre-C++11 that would allow me to add another struct to the vector without first making a named struct variable and passing that named variable to the push_back function? While this is a single example of what I'm trying to accomplish, I will have several such vectors in my project and the structs won't always be simple pairs of ints. I would prefer to avoid having several \"temp\" dummy variables floating around as placeholders for arguments simply because it feels cleaner to avoid having them floating around. An example of what I would prefer to avoid but will use if necessary is given below. The example adds the list of all coordinates where both the x and y values are between 0 and 9 inclusive to the vector.</p>\n\n<pre><code>coordinate temp = {0,0};\nfor (int r = 0; r &lt; 10; ++r){\n    for (int c = 0; c &lt; 10; ++c){\n        temp.y = r;\n        temp.x = c;\n        myVec.push_back(temp);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "string", "libconfig"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 8, "creation_date": 1534968439, "post_id": 51974333, "comment_id": 90899136, "body": "If you need an array of unknown size you want a <code>std::vector</code>"}, {"owner": {"reputation": 950, "user_id": 999986, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/552c507622e61c693fb2368a0d9db4d2?s=128&d=identicon&r=PG", "display_name": "Nir", "link": "https://stackoverflow.com/users/999986/nir"}, "edited": false, "score": 0, "creation_date": 1534969046, "post_id": 51974333, "comment_id": 90899388, "body": "Since you don&#39;t know the number of elements consider using a container such as std::vector. For configuration it is common to use a container with fast lookup such as std::map or std::unordered_map."}, {"owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 0, "creation_date": 1534971784, "post_id": 51974333, "comment_id": 90900600, "body": "I will also add to what everyone else has said already and use a vector. Whenever you do not know the size, always use vector. In most cases you also want to use vector. Also, don\u2019t say, \u201cI know that this isn\u2019t really possible in C++.\u201d C++ is a huge and powerful language and you are just barely scraping the top of what C++ can do."}], "answers": [{"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 0, "last_activity_date": 1534969515, "creation_date": 1534969515, "answer_id": 51974592, "question_id": 51974333, "link": "https://stackoverflow.com/questions/51974333/dynamically-creating-and-storing-data-in-a-string-array/51974592#51974592", "title": "Dynamically creating and storing data in a string array", "body": "<p>I believe your code can be made to behave the way you need with only minimal changes. All you need is a <code>std::vector&lt;std::string&gt;</code> to contain all the fields you record from your loop:</p>\n\n<pre><code>std::vector&lt;std::string&gt; filetypes;\n\ntry {\n    for (int i = 0; i &lt; cfg.getRoot()[\"files\"].getLength(); ++i) {\n        // Only output the record if all of the expected fields are present.\n        std::string filetype;\n        if (!(cfg.getRoot()[\"files\"][i].lookupValue(\"filetype\", filetype)))\n            continue;\n\n        //The use of std::move is optional, it only helps improve performance.\n        //Code will be logically correct if you omit it.\n        filetypes.emplace_back(std::move(filetype));\n    }\n}\ncatch (const SettingNotFoundException &amp;nfex) {\n    // Ignore.\n}\n\n//Proof that all values have been properly stored.\nfor(std::string const&amp; filetype : filetypes) {\n    std::cout &lt;&lt; filetype &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>I don't know what the return type on <code>cfg.getRoot()[\"files\"]</code> is, but it may be worthwhile to store that object to improve the readability of your code:</p>\n\n<pre><code>std::vector&lt;std::string&gt; filetypes;\n\ntry {\n    //One of these is correct for your code; I don't know which.\n    //auto &amp; files = cfg.getRoot()[\"files\"];\n    //auto const&amp; files = cfg.getRoot()[\"files\"];\n    //I'm assuming this is correct\n    auto files = cfg.getRoot()[\"files\"];\n\n    for (auto const&amp; entry : files) {\n        // Only output the record if all of the expected fields are present.\n        std::string filetype;\n        if (!(entry.lookupValue(\"filetype\", filetype)))\n            continue;\n\n        //The use of std::move is optional, it only helps improve performance.\n        //Code will be logically correct if you omit it.\n        filetypes.emplace_back(std::move(filetype));\n    }\n}\ncatch (const SettingNotFoundException &amp;nfex) {\n    // Ignore.\n}\n\n//Proof that all values have been properly stored.\nfor(std::string const&amp; filetype : filetypes) {\n    std::cout &lt;&lt; filetype &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10261585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76a63b616e64c54bc0182001fbab1cc6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin Fuller", "link": "https://stackoverflow.com/users/10261585/gavin-fuller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 51974592, "answer_count": 1, "score": 1, "last_activity_date": 1534969515, "creation_date": 1534968317, "question_id": 51974333, "link": "https://stackoverflow.com/questions/51974333/dynamically-creating-and-storing-data-in-a-string-array", "title": "Dynamically creating and storing data in a string array", "body": "<p>I am using the libconfig c++ library to grab stored data, and need to store that data in a string array in c++ without knowing the number of variables that will be passed through a config file. I know that this isn't really possible in c++, but I am trying to find the best practice to do this, and other solutions don't seem to make practical sense for what I am doing. Below is the portion of the code where I am trying to take the string filetype and store all of the results individually in a string array.</p>\n\n<pre><code>    try {\n    for (int i = 0; i &lt; cfg.getRoot()[\"files\"].getLength(); ++i) {\n        // Only output the record if all of the expected fields are present.\n        string filetype;\n        if (!(cfg.getRoot()[\"files\"][i].lookupValue(\"filetype\", filetype)))\n            continue;\n\n        cout &lt;&lt; filetype &lt;&lt; endl;\n    }\n}\ncatch (const SettingNotFoundException &amp;nfex) {\n    // Ignore.\n}\n</code></pre>\n\n<p>Apologies for the probable facepalm you are having right now, I'm a college student still learning the ropes, and am working well ahead of my course at the moment on a personal project.</p>\n"}, {"tags": ["c++", "polymorphism", "game-engine", "software-design", "game-development"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1534967310, "post_id": 51974105, "comment_id": 90898672, "body": "what do you think dynamic_cast does if its not a Weapon?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1534967318, "post_id": 51974105, "comment_id": 90898675, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/dynamic_cast\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/dynamic_cast</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1534967414, "post_id": 51974105, "comment_id": 90898723, "body": "casting is normally a design flaw.  You could solve this by using an enum that has the different classes of items you can have then then have a <code>virtual getItemType()</code> function that returns the type.  This way you don&#39;t have to cast and deal with all of the pitfalls."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1534967785, "post_id": 51974105, "comment_id": 90898874, "body": "I think you don&#39;t need to know the exact class. I think that all you want to know is whether the item can be equipped. So, one alternative approach is to have all objects inherit an <code>Equip()</code> method from <code>Item</code>. Defining this as a virtual function allows <code>Weapon</code> objects to respond in one way, and (say) <code>Talisman</code> objects to do something else, while the base class <code>Equip()</code> does nothing (or prints a hint/error for the user)."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534968647, "post_id": 51974105, "comment_id": 90899222, "body": "Cast fails, you get a <code>nullptr</code>, you dereference the return value without checking, bad things ensue."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1534969040, "post_id": 51974105, "comment_id": 90899385, "body": "Consider adding a polymorphic method &quot;is_weapon()&quot;, that returns bool.  Derived classes implement their own answer uniquely, and  in a single line of code. To reduce effort, all the non-weapons could use the base-class defined &quot;is_weapon()&quot; which returns false.  Perhaps your weapon&#39;s have grades (tank, etc.)  is_weapon() could return the grade enum.  non-weapons would be valid, but clearly not a weapon.  So many way to avoid dynamic-casting.  I agree with Nathan, casting is a design flaw."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": false, "score": 3, "last_activity_date": 1534967436, "creation_date": 1534967436, "answer_id": 51974160, "question_id": 51974105, "link": "https://stackoverflow.com/questions/51974105/polymorphism-and-dynamic-casting/51974160#51974160", "title": "Polymorphism and Dynamic Casting", "body": "<p>dynamic_cast will return nullptr if the pointer cast cannot be performed (for reference casts it will throw an exception), so your code should read something like:</p>\n\n<pre><code>Weapon *maybeWeapon = dynamic_cast&lt;Weapon*&gt;(chosenWeapon);\nif ( maybeWeapon  ) {\n   cout &lt;&lt; maybeWeapon-&gt;getName() &lt;&lt; endl;\nelse {\n   // it's not a weapon\n}\n</code></pre>\n\n<p>If you don't perform that test, and try to dereference the pointer containing nullptr, you are off in Undefined Behaviour Land.</p>\n"}, {"comments": [{"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 1, "creation_date": 1534969447, "post_id": 51974399, "comment_id": 90899586, "body": "The slice is indeed the root of the problem, which other answer miss."}, {"owner": {"reputation": 396, "user_id": 5799793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6GkCY.jpg?s=128&g=1", "display_name": "Little Boy Blue", "link": "https://stackoverflow.com/users/5799793/little-boy-blue"}, "edited": false, "score": 0, "creation_date": 1534986023, "post_id": 51974399, "comment_id": 90904122, "body": "Thank you very much! One thing I don&#39;t understand here, however: why do you have the if statement as if (maybeWeapon); it doesn&#39;t seem like it should be a true/false statement here... would you mind elaborating? Thanks!"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 396, "user_id": 5799793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6GkCY.jpg?s=128&g=1", "display_name": "Little Boy Blue", "link": "https://stackoverflow.com/users/5799793/little-boy-blue"}, "edited": false, "score": 0, "creation_date": 1535001698, "post_id": 51974399, "comment_id": 90907230, "body": "@TheMachoMuchacho the if statement takes for true every expression that is not null. So if(maybeWeapon) will have exactly the same behavior than if(maybeWeapon!=nullptr)."}, {"owner": {"reputation": 396, "user_id": 5799793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6GkCY.jpg?s=128&g=1", "display_name": "Little Boy Blue", "link": "https://stackoverflow.com/users/5799793/little-boy-blue"}, "edited": false, "score": 0, "creation_date": 1535029455, "post_id": 51974399, "comment_id": 90922377, "body": "Ah, I see! Well thank you so much for your time and your help!"}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 8, "last_activity_date": 1534969552, "last_edit_date": 1534969552, "creation_date": 1534968624, "answer_id": 51974399, "question_id": 51974105, "link": "https://stackoverflow.com/questions/51974105/polymorphism-and-dynamic-casting/51974399#51974399", "title": "Polymorphism and Dynamic Casting", "body": "<h2>The problem</h2>\n\n<p>The problem is that you try to make a dynamic cast to a <code>Weapon</code> but in reality the object pointed to is a true copy constructed <code>Item</code> and not a subclass.  This is results in a <code>nullptr</code> and UB when you dereference it ! </p>\n\n<h2>Why ?</h2>\n\n<p>Let's suppose that you have only <code>Weapon</code> objects in your inventory.  The first instruction in your snippet is the root of your evil:  </p>\n\n<pre><code>    Item tempChosenWeapon = myInventory.chooseItem();\n</code></pre>\n\n<p>This is statement <strong>is a copy construction of an <code>Item</code> object</strong>. If the source object was a <code>Weapon</code>, it will be <strong><a href=\"https://www.geeksforgeeks.org/object-slicing-in-c/\" rel=\"noreferrer\">sliced</a></strong>.</p>\n\n<p>Later you take a pointer to this object:  </p>\n\n<pre><code>    Item *chosenWeapon = &amp;tempChosenWeapon;\n</code></pre>\n\n<p>But this <code>Item*</code> doesn't point to a <code>Weapon</code> object as you think.  It points to a real crude <code>Item</code> object ! So when you do the dynamic cast here:  </p>\n\n<pre><code>    Weapon *maybeWeapon = dynamic_cast&lt;Weapon*&gt;(chosenWeapon);\n</code></pre>\n\n<p>the code will find out that <code>choosenWeapon</code> is not a <code>Weapon*</code>, and the result of <code>dynamic_cast</code> will be a <code>nullptr</code>. Until now it's not necessarily a catastrophe.  But when you then derefence this pointer you get UB: </p>\n\n<pre><code>    maybeWeapon-&gt;getName()     // OUCH !!!!!! \n</code></pre>\n\n<h2>Solution</h2>\n\n<p>Checking if the <code>dynamic_cast</code> was successful (i.e. result not <code>nullptr</code>) is a protection against the crash, but will not solve your root problem.  </p>\n\n<p>It is even possible that the problem is even deeper than expected: what type does the <code>myInventory.chooseItem()</code> return in reality ?  Is it a plain Item ?  Then you might have the slicing problem already in the inventory ! </p>\n\n<p>If you want to use polymorphism: </p>\n\n<ul>\n<li>you have to work with pointers (preferably smart pointers) or with references, in order not to loose the original type of an object, like it happened here.  </li>\n<li>If you need to copy polymorphic objects, you can't just use an assignment with an <code>Item</code>: you'd need to invoke a polymorphic <code>clone()</code> function and ensure that the target of this cloning has a compatible type.  </li>\n</ul>\n\n<p>To start with a solution, it's something like this:  </p>\n\n<pre><code>Item* chosenWeapon = myInventory.chooseItem();  // refactor choosItem() to return a pointer.\ncout &lt;&lt; chosenWeapon-&gt;getName() &lt;&lt; endl; \nWeapon *maybeWeapon = dynamic_cast&lt;Weapon*&gt;(chosenWeapon);\nif (maybeWeapon) \n    cout &lt;&lt; maybeWeapon-&gt;getName() &lt;&lt; endl;\nelse cout &lt;&lt; \"Oops the chosen item was not a weapon\" &lt;&lt;endl; \n</code></pre>\n\n<p>If this still not work, then your inventory container would be flawed.   In this case, look at <a href=\"https://stackoverflow.com/q/41045/3723423\">this question</a> before opening a separate question with the code of your container</p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1534969109, "creation_date": 1534969109, "answer_id": 51974503, "question_id": 51974105, "link": "https://stackoverflow.com/questions/51974105/polymorphism-and-dynamic-casting/51974503#51974503", "title": "Polymorphism and Dynamic Casting", "body": "<pre><code>Item tempChosenWeapon = myInventory.chooseItem();\n</code></pre>\n\n<p>this is an <code>Item</code>.  Not a type descended from <code>Item</code>.  It is an <code>Item</code>.</p>\n\n<p>Values in C++ have known types.</p>\n\n<pre><code>cout &lt;&lt; tempChosenWeapon.getName() &lt;&lt; endl;\n</code></pre>\n\n<p>all good, but please stop <code>using namespace std;</code></p>\n\n<pre><code>Item *chosenWeapon = &amp;tempChosenWeapon;\n</code></pre>\n\n<p>This is a pointer to an <code>Item</code>.  I can prove it is not polymorphic, because it is a pointer to a instance of type <code>Item</code>.  The compiler can probably prove it to.</p>\n\n<pre><code>cout &lt;&lt; chosenWeapon-&gt;getName() &lt;&lt; endl;//THE CODE WORKS UP TO HERE\n</code></pre>\n\n<p>ok, this repeats the previous call.</p>\n\n<pre><code>Weapon *maybeWeapon = dynamic_cast&lt;Weapon*&gt;(chosenWeapon);\n</code></pre>\n\n<p>This deterministically returns <code>nullptr</code>.  <code>chosenWeapon</code> is an <code>Item*</code> that we know points to an <code>Item</code>, and an <code>Item</code> is not a <code>Weapon</code>.</p>\n\n<pre><code>cout &lt;&lt; maybeWeapon-&gt;getName() &lt;&lt; endl;\n</code></pre>\n\n<p>this dereferences <code>nullptr</code>.</p>\n\n<hr>\n\n<p>There are a number of ways to handle polymorphism in C++.  But you have to think about it.</p>\n\n<p>First, do you want value semantics?  Value sematnics means that a copy of something is a copy of it.  Things don't refer to other things; they are those things.</p>\n\n<p>You can do value semantics with polymorphic values, but it takes a bit of work.  You write two classes; the value wrapper, and the internal <code>pImpl</code>.</p>\n\n<p>The internal <code>pImpl</code> has a <code>std::unique_ptr&lt;Impl&gt; Impl-&gt;clone() const</code> method, and the value wrapper calls it when you copy it.</p>\n\n<p>You write your interface like this:</p>\n\n<pre><code>template&lt;class D&gt;\nstruct clonable {\n  std::unique_ptr&lt;D&gt; clone() const = 0;\n};\nstruct ITarget;\nstruct IItem:clonable&lt;IItem&gt; {\n  virtual std::string get_name() const = 0;\n  virtual bool can_equip( ITarget const&amp; ) const = 0;\n  ~virtual IItem() {}\n};\nstruct Target;\nstruct Item {\n  using Impl = IItem;\n  explicit operator bool() const { return (bool)pImpl; }\n  IItem* get_impl() { return pImpl.get(); }\n  IItem const* get_impl() const { return pImpl.get(); }\n  template&lt;class D&gt;\n  D copy_and_downcast() const&amp; {\n    auto* ptr = dynamic_cast&lt;typename D::Impl const*&gt;( pImpl.get() );\n    if (!ptr) return {};\n    return D(ptr-&gt;clone());\n  }\n  template&lt;class D&gt;\n  D copy_and_downcast() &amp;&amp; {\n    auto* ptr = dynamic_cast&lt;typename D::Impl*&gt;( pImpl.get() );\n    if (!ptr) return {};\n    pImpl.release();\n    return D(std::unique_ptr&lt;typename D::Impl&gt;(ptr));\n  }\n  std::string get_name() const {\n    if (!*this) return {};\n    return pImpl-&gt;get_name();\n  }\n  bool can_equip(Target const&amp; target)const{\n    if (!*this) return false;\n    if (!target) return false;\n    return pImpl-&gt;can_equip( *target.get_impl() );\n  }\n  Item() = default;\n  Item(Item&amp;&amp;) = default;\n  Item&amp; operator=(Item&amp;&amp;) = default;\n  Item(std::unique_ptr&lt;IItem&gt; o):pImpl(std::move(o)) {}\n  Item(Item const&amp; o):\n    Item( o?Item(o.pImpl-&gt;clone()):Item{} )\n  {}\n  Item&amp; operator=( Item const&amp; o ) {\n    Item tmp(o);\n    std::swap(pImpl, tmp.pImpl);\n    return *this;\n  }\nprivate:\n  std::unique_ptr&lt;IItem&gt; pImpl;\n};\n</code></pre>\n\n<p>which probably has bugs and is maybe too complex for you.</p>\n\n<hr>\n\n<p>Second, you can go with reference semantics.</p>\n\n<p>In this case, you want to return <code>shared_ptr&lt;const T&gt;</code> or <code>shared_ptr&lt;T&gt;</code> from your data.  Or you can go half way and return a <code>unique_ptr&lt;T&gt;</code> copy from your <code>chooseItem</code> functions.</p>\n\n<p>Reference semantics is really hard to get right.  But you do get to use <code>dynamic_cast</code> or <code>dynamic_pointer_cast</code> directly.</p>\n\n<pre><code>std::shared_ptr&lt;Item&gt; chosenWeapon = myInventory.chooseItem();\nif (!chosenWeapon) return;\nstd::cout &lt;&lt; chosenWeapon-&gt;getName() &lt;&lt; std::endl;\n\nauto maybeWeapon = dynamic_pointer_cast&lt;Weapon&gt;(chosenWeapon);\nif (maybeWeapon)\n  std::cout &lt;&lt; maybeWeapon-&gt;getName() &lt;&lt; std::endl;\nelse\n  std::cout &lt;&lt; \"Not a weapon\" &lt;&lt; std::endl;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1534970169, "last_edit_date": 1534970169, "creation_date": 1534969798, "answer_id": 51974653, "question_id": 51974105, "link": "https://stackoverflow.com/questions/51974105/polymorphism-and-dynamic-casting/51974653#51974653", "title": "Polymorphism and Dynamic Casting", "body": "<p>You cannot cast an object of type <code>Item</code> to an object of a subclass of <code>Item</code>.\nNote that with <code>Item tempChosenWeapon = myInventory.chooseItem()</code>, you will get an Item-object, even if <code>chooseItem</code> might return a <code>Weapon</code>-object. This is called \"slicing\" and cuts out an <code>Item</code>-subobject of any <code>Weapon</code>-object. Note that variables that are not references or pointers are not polymorphic:</p>\n\n<pre><code>struct A {\n    int a = 0;\n    virtual void print() const {\n        std::cout &lt;&lt; \"a:\" &lt;&lt; a &lt;&lt; std::endl;\n    }\n};\n\nstruct B : public A {\n    int b = 1;\n    void print() const override {\n        std::cout &lt;&lt; \"a:\" &lt;&lt; a &lt;&lt; \"; b:\" &lt;&lt; b &lt;&lt; std::endl;\n    }\n};\n\nB b;\n\nA get_b() {  // will slice b;\n    return b;\n}\n\nA&amp; getRefTo_b() {  // reference to b; polymorphic\n    return b;\n}\n\nA* getPointerTo_b() {  // pointer to b; polymorphic.\n    return &amp;b;\n}\n\nint main() {\n\n    A a1 = get_b(); // copy of A-subobject of b; not polymorphic\n    a1.print();\n    // a:0\n\n    A a2 = getRefTo_b();  // copy of A-subobject of referenced b-object; not polymorphic\n    a2.print();\n    // a:0\n\n    A &amp;a3 = getRefTo_b(); // storing reference to b-object; polymorphic\n    a3.print();\n    // a:0; b:1\n\n    A *a4 = getPointerTo_b();  // pointer to b-object; polymorphic\n    a4-&gt;print();\n    // a:0; b:1\n\n    B* b1 = dynamic_cast&lt;B*&gt;(&amp;a1);  // fails (nullptr); a1 is not a B\n    B* b2 = dynamic_cast&lt;B*&gt;(&amp;a2);  // fails (nullptr); a2 is not a B\n    B* b3 = dynamic_cast&lt;B*&gt;(&amp;a3);  // OK; a3 refers to a B-object\n    B* b4 = dynamic_cast&lt;B*&gt;(a4);   // OK; a4 points to a B-object\n\n    return 0;\n}\n</code></pre>\n\n<p>So your signature should probably be </p>\n\n<pre><code>Item &amp;Inventory::chooseItem() {\n   static Weapon weapon;\n   ...\n   return weapon;\n};\n\nint main() {\n   Item &amp;myWeapon = myInventory.chooseItem();\n   Weapon* w = dynamic_cast&lt;Weapon*&gt;(&amp;myWeapon);\n   ...\n}\n</code></pre>\n"}], "owner": {"reputation": 396, "user_id": 5799793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6GkCY.jpg?s=128&g=1", "display_name": "Little Boy Blue", "link": "https://stackoverflow.com/users/5799793/little-boy-blue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 1, "accepted_answer_id": 51974399, "answer_count": 4, "score": 2, "last_activity_date": 1534970173, "creation_date": 1534967164, "last_edit_date": 1534970173, "question_id": 51974105, "link": "https://stackoverflow.com/questions/51974105/polymorphism-and-dynamic-casting", "title": "Polymorphism and Dynamic Casting", "body": "<p>So I'm working on a text-based RPG, and I've run into an issue. I am currently working on equipping weapons from the character's inventory. I am trying to make it so that my program can tell if the item they want to equip is of class <code>Weapon</code> or not. Here is the clip of relevant code:</p>\n\n<pre><code> Item tempChosenWeapon = myInventory.chooseItem();\ncout &lt;&lt; tempChosenWeapon.getName() &lt;&lt; endl;\nItem *chosenWeapon = &amp;tempChosenWeapon;\ncout &lt;&lt; chosenWeapon-&gt;getName() &lt;&lt; endl;//THE CODE WORKS UP TO HERE\n\nWeapon *maybeWeapon = dynamic_cast&lt;Weapon*&gt;(chosenWeapon);\ncout &lt;&lt; maybeWeapon-&gt;getName() &lt;&lt; endl;\n</code></pre>\n\n<p>Now, <code>Weapon</code> is a child class of <code>Item</code>, which is why I am using dynamic cast -- in an attempt to change <code>chosenWeapon</code>, which is of type <code>Item</code>, to type <code>Weapon</code> in order to compare the two classes. (I am using these <code>cout&lt;&lt;</code>s in or to test whether or not calling a function from these objects works). </p>\n\n<p>My program compiles, and everything runs fine until we come to <code>maybeWeapon-&gt;getName()</code>, in which the program crashes. I've researched quite a bit, but I just don't understand what I am doing wrong. Any answer or alternative suggestion is much appreciated! Thanks! </p>\n"}, {"tags": ["c++", "inheritance"], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 0, "last_activity_date": 1534967339, "creation_date": 1534967339, "answer_id": 51974136, "question_id": 51974030, "link": "https://stackoverflow.com/questions/51974030/multiple-inheritance-same-method-name-and-no-ambiguity/51974136#51974136", "title": "Multiple inheritance same method name and no ambiguity", "body": "<p>In the case you have <code>virtual</code> there are two <code>foo</code>s in your vtable.</p>\n\n<p>The first one is <code>A0::foo</code> the second one is <code>A1::foo</code>.</p>\n\n<p>When you override <code>foo</code> in <code>B</code>, you override <em>both</em>, and instruct it to call <code>A1::foo()</code>.</p>\n\n<p>If you don't override <code>foo</code> in <code>B</code>, the two <code>foo</code>s remain in the vtable, unrelated except by name.</p>\n\n<p>In <code>A0::bar</code>, when you call <code>foo()</code> it looks locally for a <code>foo</code>.  It sees one -- <code>A0::foo</code> -- which is virtual.  So it encodes a call into the vtable to execute <code>A0::foo</code>.</p>\n\n<p>Without the override in <code>B</code> the invokes <code>A0::foo</code>.  With the override in <code>B</code> this invokes <code>B::foo</code> when then calls <code>A1::foo</code> instead.</p>\n\n<p>In the case you don't have <code>virtual</code>, well, the same holds except the <code>vtable</code> bit.</p>\n\n<p>You have two functions <code>A0::foo</code> and <code>A1::foo</code>.  With a pointer to <code>A0</code>, <code>-&gt;foo()</code> invokes <code>A0::foo</code>.</p>\n\n<p>With a pointer to <code>B</code>, <code>-&gt;foo()</code> is ambiguous.</p>\n\n<p>If you write a <code>B::foo</code> method (does not matter if it is virtual), then <code>B-&gt;foo()</code> invokes it.</p>\n\n<hr>\n\n<p>The fact that two things share a name doesn't mean they are the same thing, nor does it make all calls ambiguous.</p>\n\n<p>The calls are ambiguous only if you cannot tell which one is being named from context.</p>\n"}], "owner": {"reputation": 270, "user_id": 1156580, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723a3388694475db06baf745955b8481?s=128&d=identicon&r=PG", "display_name": "David Levy", "link": "https://stackoverflow.com/users/1156580/david-levy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 51974136, "answer_count": 1, "score": 0, "last_activity_date": 1534967339, "creation_date": 1534966766, "question_id": 51974030, "link": "https://stackoverflow.com/questions/51974030/multiple-inheritance-same-method-name-and-no-ambiguity", "title": "Multiple inheritance same method name and no ambiguity", "body": "<p>I have two classes (A0 and A1) that have a function foo() and a A0 has a function bar() that just calls foo(). And a class B that inherits from A0 and A1.</p>\n\n<p>B does nothing beside inheriting from A0 and A1.</p>\n\n<p>Why is there no ambiguity when calling <code>B-&gt;bar()</code> ?</p>\n\n<p>A small code sample</p>\n\n<pre><code>class A0\n{\nprotected:\n    /*virtual*/ void foo() {std::cout &lt;&lt; \"A0\" &lt;&lt; std::endl; }\npublic:\n    void bar() {foo(); }\n};\n\nclass A1\n{\nprotected:\n    /*virtual*/ void foo() {std::cout &lt;&lt; \"A1\" &lt;&lt; std::endl; }\n};\n\nclass B : public A0, public A1\n{\nprotected:\n    //virtual void foo() override {A1::foo(); }\n};\n\nint main()\n{\n    B *lPtr = new B;\n    lPtr-&gt;bar(); //\"A0\" without the override, \"A1\" with the override\n    delete lPtr;\n\n    return 0;\n}\n</code></pre>\n\n<p>And if I uncomment the virtual and the function override, there is still no ambiguity but it calls the other foo.</p>\n\n<p>Why is there still no ambiguity and why does it call the other one?</p>\n"}, {"tags": ["c++", "eclipse", "qt"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534966540, "post_id": 51973959, "comment_id": 90898321, "body": "Have you told it <i>where</i> to find the headers?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1534966650, "post_id": 51973959, "comment_id": 90898376, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/1351712/how-to-add-a-library-to-an-eclipse-project\" title=\"how to add a library to an eclipse project\">stackoverflow.com/questions/1351712/&hellip;</a>"}, {"owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534966823, "post_id": 51973959, "comment_id": 90898457, "body": "@Jesper Juhl No I don&#39;t believe so. Tbh I am not sure where they are located."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1534966906, "post_id": 51973959, "comment_id": 90898490, "body": "And there&#39;s your problem."}, {"owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534967040, "post_id": 51973959, "comment_id": 90898554, "body": "@Jesper Juhl So I think I have found them in Qt-4.72/include/QtGui but how do I tell Eclipse where to go looking for them?"}, {"owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534967684, "post_id": 51973959, "comment_id": 90898828, "body": "@NathanOliver Yeah I saw that but I can&#39;t seem to find anything related to Qt in: The Eclipse Project Updates - ttp://download.eclipse.org/eclipse/updates/4.8 or Photon - ttp://download.eclipse.org/releases/photon"}], "owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534966428, "creation_date": 1534966428, "question_id": 51973959, "link": "https://stackoverflow.com/questions/51973959/include-at-packages-are-marked-unresolved-conclusions", "title": "#include At packages are marked unresolved conclusions", "body": "<p>I have a fairly large Qt Gui application that I want to try debugging using the Eclipse IDE. I have all the source code loaded up into Eclipse but the includes for Qt are erring out:</p>\n\n<pre><code>#include &lt;QAbstractItemView&gt;\n#include &lt;QApplication&gt;\n#include &lt;QFile&gt;\n#include &lt;QString&gt;\n#include &lt;QSplashScreen&gt;\n#include &lt;QPlastiqueStyle&gt;\n#include &lt;QResource&gt;\n#include &lt;QWSEvent&gt;\n</code></pre>\n\n<p>When highlighting the errors the IDE is telling me that the includes above are unresolved conclusions. I am new to Eclipse but I am assuming this means that the compiler can't find the packages?</p>\n\n<p>So that leads me into my question. How do I include these packages or how do I get Eclipse to communicate with Qt?</p>\n"}, {"tags": ["c++", "lcm"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 3, "creation_date": 1534966356, "post_id": 51973896, "comment_id": 90898244, "body": "<i>i</i> is same in both multiplications, so products are equal when <i>num1 == num2</i>..."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1534966998, "post_id": 51973896, "comment_id": 90898530, "body": "<a href=\"https://www.geeksforgeeks.org/program-to-find-lcm-of-two-numbers/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/program-to-find-lcm-of-two-numbers</a>"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8106571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9dc2f692de89e305104489be5004de8b?s=128&d=identicon&r=PG&f=1", "display_name": "Njgardner90", "link": "https://stackoverflow.com/users/8106571/njgardner90"}, "edited": false, "score": 0, "creation_date": 1534969516, "post_id": 51974124, "comment_id": 90899619, "body": "Seems to work fine. Thank you :) Where does LCM come from? Is this a &#39;special&#39; variable, as I don&#39;t see it declared anywhere?"}, {"owner": {"reputation": 325, "user_id": 10146626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s5VPjbei54w/AAAAAAAAAAI/AAAAAAAAAWA/6LEwafLl2xw/photo.jpg?sz=128", "display_name": "Mostafa Ayaz", "link": "https://stackoverflow.com/users/10146626/mostafa-ayaz"}, "reply_to_user": {"reputation": 61, "user_id": 8106571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9dc2f692de89e305104489be5004de8b?s=128&d=identicon&r=PG&f=1", "display_name": "Njgardner90", "link": "https://stackoverflow.com/users/8106571/njgardner90"}, "edited": false, "score": 0, "creation_date": 1534969731, "post_id": 51974124, "comment_id": 90899734, "body": "You&#39;re welcome. I declared it where you declared num_limit variable (at the end of the line)..."}], "tags": [], "owner": {"reputation": 325, "user_id": 10146626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s5VPjbei54w/AAAAAAAAAAI/AAAAAAAAAWA/6LEwafLl2xw/photo.jpg?sz=128", "display_name": "Mostafa Ayaz", "link": "https://stackoverflow.com/users/10146626/mostafa-ayaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1616498234, "last_edit_date": 1616498234, "creation_date": 1534967304, "answer_id": 51974124, "question_id": 51973896, "link": "https://stackoverflow.com/questions/51973896/lcm-program-in-c/51974124#51974124", "title": "LCM program in C++", "body": "<p>Try this out</p>\n<pre><code>//#include &quot;stdafx.h&quot;\n#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\nusing std::cout;\nusing std::cin;\n\nint main()\n{\n\n    int num1 = 0;\n    int num2 = 0;\n\n    cout &lt;&lt; &quot;Please enter two numbers (remember to put a space between them):\\n&quot;;\n\n    cin &gt;&gt; num1 &gt;&gt; num2;\n\n    int num_limit = num1 * num2,LCM;\n    for (int i = 1; i &lt;= num_limit; i++)\n    {\n        LCM = num1 * i;\n\n        // test for when multiples are equal\n        if (LCM%num2==0) break;\n    }\n    cout &lt;&lt; &quot;The LCM of &quot; &lt;&lt; num1 &lt;&lt; &quot; and &quot; &lt;&lt; num2 &lt;&lt; &quot; is: &quot; &lt;&lt; LCM;\n    _getch();// replace with getch(); if didn't work\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1127, "user_id": 11993121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6d838d88ef60caa2eefd94e172026c?s=128&d=identicon&r=PG&f=1", "display_name": "nielsen", "link": "https://stackoverflow.com/users/11993121/nielsen"}, "edited": false, "score": 0, "creation_date": 1616499748, "post_id": 66758420, "comment_id": 118015633, "body": "This is the correct solution based on the Euclidean algorithm. If anyone is in doubt, try running this and the accepted answer on a couple of 6-digit numbers."}], "tags": [], "owner": {"reputation": 9, "user_id": 14651946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53ac6ee205c9c3dd16f158782ab0577?s=128&d=identicon&r=PG&f=1", "display_name": "Amisha Sahu", "link": "https://stackoverflow.com/users/14651946/amisha-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1616482544, "last_edit_date": 1616482544, "creation_date": 1616481889, "answer_id": 66758420, "question_id": 51973896, "link": "https://stackoverflow.com/questions/51973896/lcm-program-in-c/66758420#66758420", "title": "LCM program in C++", "body": "<pre><code>int gcd(int a,int b)\n{\n    if(b==0)\n        return a;\n    else\n        return gcd(b,a%b);  \n}\n\nint lcm(int a,int b)\n{\n    //Efficient Solution\n    // a*b=gcd(a,b)*lcm(a,b)\n\n    return (a*b)/gcd(a,b);\n}\n\nint main()\n{\n    ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n    int a,b;\n    cin&gt;&gt;a&gt;&gt;b;\n    cout&lt;&lt;lcm(a,b);\n    return 0;\n}\n</code></pre>\n<p>Output</p>\n<pre><code>15 12\n60\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8106571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9dc2f692de89e305104489be5004de8b?s=128&d=identicon&r=PG&f=1", "display_name": "Njgardner90", "link": "https://stackoverflow.com/users/8106571/njgardner90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 1, "accepted_answer_id": 51974124, "answer_count": 2, "score": -2, "last_activity_date": 1616498234, "creation_date": 1534966162, "question_id": 51973896, "link": "https://stackoverflow.com/questions/51973896/lcm-program-in-c", "title": "LCM program in C++", "body": "<pre><code>#include &lt;iostream&gt;\nusing std::cout;\nusing std::cin;\n\nint main()\n{\n\n    int num1 = 0;\n    int num2 = 0;\n\n    cout &lt;&lt; \"Please enter two numbers (remember to put \na space between them):\\n\";\n\n    cin &gt;&gt; num1 &gt;&gt; num2;\n\n    const int num_limit = num1 * num2;\n\n    for (int i = 1; i &lt;= num_limit; i++)\n    {\n        int product = num1 * i;\n        int product2 = num2 * i;\n\n        // test for when multiples are equal\n        if (product == product2)\n        {\n        cout &lt;&lt; \"The LCM of \" &lt;&lt; num1 &lt;&lt; \" and \" &lt;&lt; \nnum2 &lt;&lt; \" is: \"; \n        }\n\n     }\n}\n</code></pre>\n\n<p>I'm trying to get the LCM from two integers which the user enters. The if statement within the for loop isn't doing what I intended it to do, as nothing prints when product and product2 are equal. What is the solution to this little problem?</p>\n"}, {"tags": ["c++", "assembly", "x86", "arm"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 8, "creation_date": 1534965701, "post_id": 51973740, "comment_id": 90897950, "body": "IIRC everything about <code>asm</code> in the standard says it has implementation defined behavior."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1534965706, "post_id": 51973740, "comment_id": 90897952, "body": "With optimization enabled, the asm will be removed so no harm done. Without optimization, code will compile but not assemble. That&#39;s assuming your compiler at least understands the <code>asm</code>."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1534965774, "post_id": 51973740, "comment_id": 90897981, "body": "So from my understanding, this sort of thing <i>must</i> be gated with a preprocessor check.  And compile time checks like SFINAE, <code>if constexpr</code> are basically &quot;implementation defined&quot;?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1534965831, "post_id": 51973740, "comment_id": 90898007, "body": "<code>if constexpr</code> should be fine as it will discard the statement (won&#39;t compile it)."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1534965849, "post_id": 51973740, "comment_id": 90898010, "body": "So I guess the same applies for SFINAE?"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534965869, "post_id": 51973740, "comment_id": 90898019, "body": "@NathanOliver could you link to a section in the standard that explains this?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1534967247, "post_id": 51973740, "comment_id": 90898633, "body": "@Jester: turns out that it&#39;s fine even with <code>-O0</code> on gcc and clang.  Apparently they don&#39;t generate code inside an <code>if(false)</code>, so you can&#39;t <code>jump</code> to those source lines in GDB."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1548051402, "post_id": 51973740, "comment_id": 95390029, "body": "@PeterCordes Even on conditions that aren&#39;t clearly false, I&#39;m pretty sure that GCC doesn&#39;t support jumping in the middle of a section."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1548075578, "post_id": 51973740, "comment_id": 95401572, "body": "@curiousguy: yes it does, that&#39;s part of why <code>-O0</code> code-gen is such garbage: each C statement is compiled to a separate block of asm, exactly so that GDB&#39;s <code>jump</code> command will have the same effect as jumping in the C abstract machine <i>within the same function</i>.  (As well modification of any variable by the debugger when stopped at a breakpoint on any source line).    <a href=\"https://stackoverflow.com/a/46043760\">Is it possible to &quot;jump&quot;/&quot;skip&quot; in GDB debugger?</a> and <a href=\"https://stackoverflow.com/q/53366394\">Why does clang produce inefficient asm for this simple floating point sum (with -O0)?</a>"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1548075741, "post_id": 51973740, "comment_id": 95401663, "body": "The only restriction is that you jump to/from asm addresses that correspond to C source lines, not the middle of a block that implements one statement, and not to the middle of the function prologue or something."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534966151, "post_id": 51973845, "comment_id": 90898132, "body": "If <code>asm</code> is not supported, it it still recognized a keyword?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534966229, "post_id": 51973845, "comment_id": 90898171, "body": "@Fran&#231;oisAndrieux It is still a keyword: <a href=\"https://timsong-cpp.github.io/cppwp/lex.key\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/lex.key</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1534969250, "post_id": 51973845, "comment_id": 90899489, "body": "Visual Studio recognizes <code>asm</code> but invariably produces a compilation error (<code>error C2290: C++ &#39;asm&#39; syntax ignored. Use __asm.</code>) when it&#39;s encountered. I couldn&#39;t test <code>if constexpr</code> but putting it behind a <code>enable_if_t</code> disabled function worked fine. I was actually surprised at how much nonsense I could pack into that function without causing any compilation errors."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534969420, "post_id": 51973845, "comment_id": 90899573, "body": "@Fran&#231;oisAndrieux That&#39;s MSVS for you.  Their conformance is a lot better than it used to be but it still has some holes.  I do love it&#39;s debugger though.  What version are you using?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534969622, "post_id": 51973845, "comment_id": 90899673, "body": "I tried with 2015 and 2017 and got the same result with both."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534969786, "post_id": 51973845, "comment_id": 90899750, "body": "@Fran&#231;oisAndrieux Yep.  Looks like MSVS doesn&#39;t support <code>asm</code> at all."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1548052630, "post_id": 51973845, "comment_id": 95390398, "body": "@Fran&#231;oisAndrieux Historically some C++ compilers were known to accept nearly anything made of valid tokens in a template that wasn&#39;t instantiated, as long as the {} balance was good. (Accented characters outside a literal would cause a parse error obviously.)"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 5, "last_activity_date": 1548077548, "last_edit_date": 1548077548, "creation_date": 1534966001, "answer_id": 51973845, "question_id": 51973740, "link": "https://stackoverflow.com/questions/51973740/behavior-of-unused-asm-on-unsupported-architectures/51973845#51973845", "title": "Behavior of unused asm() on unsupported architectures", "body": "<p>It is up to the implementation on how this will be handled.  From <a href=\"https://timsong-cpp.github.io/cppwp/dcl.asm\" rel=\"nofollow noreferrer\">[dcl.asm]</a></p>\n\n<blockquote>\n  <p>An <code>asm</code> declaration has the form</p>\n\n<pre><code>asm-definition:\n    attribute-specifier-seq opt asm ( string-literal ) ;\n</code></pre>\n  \n  <p>The <code>asm</code> declaration is conditionally-supported; <strong>its meaning is implementation-defined.</strong> The optional attribute-specifier-seq in an asm-definition appertains to the asm declaration. [\u2009Note: Typically it is used to pass information through the implementation to an assembler. \u2014\u2009end note\u2009]</p>\n</blockquote>\n\n<p><sup>emphasis mine</sup></p>\n\n<p>That said you can put the code in a <code>#if #endif</code> , use SFINAE, or use <code>if constexpr</code>.  All of those will remove the code from compiling if the condition is not satisfied.</p>\n"}, {"tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 2, "last_activity_date": 1534967316, "last_edit_date": 1534967316, "creation_date": 1534966965, "answer_id": 51974068, "question_id": 51973740, "link": "https://stackoverflow.com/questions/51973740/behavior-of-unused-asm-on-unsupported-architectures/51974068#51974068", "title": "Behavior of unused asm() on unsupported architectures", "body": "<p><strong>Yes, it's fine on gcc and clang, as long as the <code>false</code> is definitely a compile-time constant.  It won't compile on compilers like MSVC that don't support <code>asm(\"\");</code> at all</strong>.</p>\n\n<p>I wouldn't recommend it, though.  It's much more normal to use the preprocessor for arch-specific and implementation-specific code selection.</p>\n\n<hr>\n\n<p>ISO C++ has basically nothing to say about it.  <code>asm</code> is an implementation-specific extension, so yes an implementation would be free to reject asm that didn't assemble, even in dead code.  But the question is whether the compilers we actually use are like that.</p>\n\n<p>The only meaningful question is what happens on actual compilers you care about.</p>\n\n<hr>\n\n<p>On MSVC for example, <code>asm(\"\");</code> is not supported syntax, regardless of the contents of the string literal.  So it's a syntax error at compile time everywhere.  <strong>You can't use <code>if(false){}</code> to protect code that doesn't even compile,</strong> just like you can't do so in template metaprogramming (unfortunately).</p>\n\n<hr>\n\n<p><strong>On compilers that support GNU extensions</strong> (the most widely used extensions to ISO C or C++ that include an <code>asm(\"\")</code> style of syntax), <strong>let's have a look <a href=\"https://godbolt.org/#z:OYLghAFBqd5TKALEBjA9gEwKYFFMCWALugE4A0BIEAZugHZEDKqAhgDbYgCMAdAAwB2ACwBOAKzCATAGZR8haIAc5AFY9y7VvVCoApFIBCBw%2BQDO6AK6lUXAOQFGAamDt0AIz0zj/AIJ6/ADd0Akwneg9WUlICbFIIAEonPUEfXycMpwB6LMciJwx6QiICBmSZABEnfi9DDIIaCELi0voknKcAdyt2THowO3zu0gBrJ1Z8gFoAeRq/TKcG2g4zbCSUtIWFjoZ2AE9x%2Bic40jIu4iQnAFkmADUAYQD0rYzWMwBbCAMpd5psels3ycIBBySkP2w7zIe2%2BCVqTxeGVcHnKVW48PmmRSFSe2NxfgMMgaOBoTgAqgA5e7TCkVACSABU6TTfAAZJ7BUJOdxRGJxRLJVIIzIdYCoVAFdDvAAOBE4Zicq2lUQm2H2Thop3e4zMq3e7nYjmAwoyHVQWh0WVZrNuVwGCvcljlREmjh1eoNcQKSHQI2wComkplcuwThK72wJp1n2%2Bv3%2BgPBwNBsch0NhGP8ghxBNk/0INCedgSmhAdnEdnI9FL/Ar6FLjyMJkVVhsocJ3ArRGrReLIxAwkEvEE3AAbDJhGOZEpwfxRCW7MIK%2B8QOJ%2BJXu%2BQ63YK2YQGuu3Ya8W4LAUBhg5wKFQmlLZZe0OxuKIAPpRd7kGjOuK7iDuDfuRwoj2UsO3Ic8I0YaZ6H2DccHebRXHsGtyEIUhsFQEpAn9DdsAAD3QywiHsUC8jVEDOxiZc7A7YsLV0EwTE0Ah3F3SBi3QaUSgYXc7BmXCdxbWweFo0ty3XQ9a1LXwACUrmuO57icKR%2BG4QQnGkhkAHUnAgfBiDOdtyCce5bxDUgwRkbgkgbYwjE7bsEmLJBsFYHBSGoESFyXFc1yrCTN1LHc93IA8j17EApFEXhRH4GRBEEadhCUcQlEEcRBHnGQKz85Ct3siTj0QE9kDQUzL0oahzzvOIQDfYc10/dgiNIH8/38gD6CA8iwKlCCiCgmD/LghDOFggg0IwggsJ45C8IIojutI9huqISjyNohC0AYowmJY%2BB2M41oeJmGQMkmd5UGlSwvAqDBSCI3DJlYdKBOsISrPnMScskuwZLksUJUHKReG4HSInoNYdL0khzMM4yyq9QkpGs7bDHysLyGc1yasSedF3IZcZBHARuH4cQUv4EdRCnUduHE3LAvMYLQqLchiogM8EavSqudq0h3hHYRgDHBqvxa6g2uQjquuoitwP%2BfroOAobIRGpCK1Q9DMOw/y5tQQjiIrJaVrW2WNp0LbGx2w09rYzdDu40sZmQiw3q4D7lrLbKNy3P7BZccUnGJmQBB0w16EsXCkl04oDNkOn4YvRHZBkFGrbRkKHKcly3I88g%2B1JtdPfxwn%2BF4EdxBHUnktEQQpGSoQR3pn6gv3By2aKzmk%2B5m9u75gWhZFj8xda/9ANIZXQPlyCldg1WdFGobxq1qaddm/D9YW2XKEYMjt9WggqJozRNv0dPdtY3GOK4%2BhjtmJxJgqSlqVpRlmQpNlXtbYTPu9/zfdkv7AGQdeAh34GHRwkdo7QzjpZIyJlu4WRHGnWyGcWaOTxt5GQIdsG4Lwfg5uAVtxMzbgVcKU5ooqRUrTQWKk0qZT/gzYh6CO7wHZl3aqPcqpmQfAhEc/BRZNW/BLMenUJ7dWnorQayFhoL3VihZek1po4Q3gbRau9PagQPkfVmdFLaoIvvte2N877gMmEQKIwBsD5HeAQaUZgv7vU8l9H2pZcJKBHJMf25oEIgLLuAmO%2BlYbx3gVzCywgUEmHRj2TGOccbkPEAIJK3Bq5pUEJTcEmCCb9mELwSQYha5JSroIOQ5NCF5RIZnAqrDTylW7hVXunDeE6H4YI5qo92rj0nnLXqCsBrKxkfPRCY0JraxmhWPWajt7G33qbY%2Beiz4GJtpfA6Jinb33MZY6xThbH2Ifk/KkNJ6RMhZKyRx7tnGMJ%2Bu4zx3i6J%2BNDoEmGFkE4IM4RZcQkS7JVIxljXOuNi7eXBCDKQo4qbcCUPwMQUhhwyHKYzXcpCjw1JKlYIgV0iANO4fecQ5BsCx3cnTTopBWDSnWr/eFdhCTiHOEQS4NyvHCAKPc4m/jokYMBdk7BoD8G8uwZS1uPyYl9ksiDCQoKVIyFXKTKmwgGECqFRy0sUgrlEPZcWLCLVWj9iAA%3D\" rel=\"nofollow noreferrer\">on the Godbolt compiler explorer</a></strong>.</p>\n\n<p>I picked <a href=\"http://felixcloutier.com/x86/MFENCE.html\" rel=\"nofollow noreferrer\"><code>mfence</code></a> because it's a valid instruction that doesn't need any input or output operands to make sense, because it doesn't modify any registers.  And unlike <code>nop</code> or something, it won't assemble on non-x86.  (<code>volatile</code> is implicit for <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow noreferrer\">a GNU extended-asm statement</a> with no output operands.)</p>\n\n<pre><code>void nobarrier() {\n    //int condition = 0;  if(condition) // wouldn't work at -O0\n    if(false) {\n        // only an error with MSVC\n        asm(\"mfence\" ::: \"memory\");\n    }\n}\n\n#ifdef UNCONDITIONAL\nvoid barrier() {\n    // gcc compiles separately from assembling\n    // clang/LLVM's built-in assembler chokes at compile time\n    asm(\"mfence\" ::: \"memory\");\n}\n#endif\n</code></pre>\n\n<p><strong>GCC and clang don't even try to assemble the <code>asm()</code> statement inside the <code>if(false)</code>, even with optimization disabled.</strong></p>\n\n<p>Of course, <code>-O0</code> stops them from treating <code>int cond=0;</code>  <code>if(cond){}</code> as always false, because for consistent debugging they make asm that assumes every variable was modified in memory (by a debugger) between every statement.  (All the stores/reloads is partly why un-optimized code is so slow).</p>\n\n<p>With ARM or AArch64 gcc, <code>nobarrier()</code> compiles just fine, to asm that will assemble just fine.  e.g.</p>\n\n<pre><code>@ gcc7.2 -O3 for ARM32.  Similar output with -O0\nnobarrier():\n    bx      lr\n</code></pre>\n\n<p>GCC doesn't even try to parse the contents of the <code>asm</code> template, so it will <em>compile</em> <code>barrier()</code> for AArch64, but it includes an instruction that won't assemble.</p>\n\n<pre><code>@ gcc6.3 -O0 -DUNCONDITIONAL\nbarrier():\n    mfence\n    nop\n    ret\n</code></pre>\n\n<hr>\n\n<p>If you care about the distinction between compiling and assembling, clang is different.</p>\n\n<p>clang6.0 <code>-O0 -target mips -DUNCONDITIONAL</code> says</p>\n\n<pre><code>&lt;source&gt;:13:9: error: unknown instruction\n    asm(\"mfence\" ::: \"memory\");\n        ^\n\n&lt;inline asm&gt;:1:2: note: instantiated into assembly here\n        mfence\n        ^\n1 error generated.\nCompiler returned: 1\n</code></pre>\n\n<p>This doesn't matter if you only care about C++ -> object file, not making <code>.s</code> asm source output.  For that, it behaves the same as gcc.  <code>if(false)</code> does protect an <code>asm</code> statement with non-MIPS instructions from being parsed:</p>\n\n<pre><code>@ clang6.0 -O0 -target mips\nnobarrier():                          # @nobarrier()\n    addiu   $sp, $sp, -8\n    sw      $fp, 4($sp)             # 4-byte Folded Spill\n    move    $fp, $sp\n    move    $sp, $fp\n    lw      $fp, 4($sp)             # 4-byte Folded Reload\n    addiu   $sp, $sp, 8\n    jr      $ra\n    nop\n</code></pre>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1548077548, "creation_date": 1534965570, "last_edit_date": 1534966418, "question_id": 51973740, "link": "https://stackoverflow.com/questions/51973740/behavior-of-unused-asm-on-unsupported-architectures", "title": "Behavior of unused asm() on unsupported architectures", "body": "<p>What is the behavior of a <code>asm()</code> block of code in architectures where it is unused but not supported?  For example, what would happen if I compile the following code on ARM</p>\n\n<pre><code>if (false) {\n    asm volatile(\"x86specificinstruction\" ...);\n}\n</code></pre>\n\n<p>Is this valid C++?  Will the code compile?  Does the standard say anything about situations like this?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1534963040, "post_id": 51973151, "comment_id": 90896731, "body": "If ZfooName has a default constructor taking no arguments, this calls it. It is not a C++11 feature. (NVM, it is C++11, I just thought it wasn&#39;t)."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1534963300, "post_id": 51973151, "comment_id": 90896842, "body": "Possible dupe? <a href=\"https://stackoverflow.com/questions/26199431/why-did-c11-introduce-delegating-constructors\" title=\"why did c11 introduce delegating constructors\">stackoverflow.com/questions/26199431/&hellip;</a> It&#39;s not the same question, but the answers contain good info?"}, {"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 1, "creation_date": 1534986493, "post_id": 51973151, "comment_id": 90904219, "body": "Also good information: <a href=\"https://stackoverflow.com/questions/308276/can-i-call-a-constructor-from-another-constructor-do-constructor-chaining-in-c\" title=\"can i call a constructor from another constructor do constructor chaining in c\">stackoverflow.com/questions/308276/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 21, "last_activity_date": 1534963717, "last_edit_date": 1534963717, "creation_date": 1534963097, "answer_id": 51973186, "question_id": 51973151, "link": "https://stackoverflow.com/questions/51973151/what-does-classname-mean-in-a-constructor-for-classname/51973186#51973186", "title": "What does :className() mean in a constructor for className?", "body": "<p>This is a new feature in C++11. It's called a delegating constructor.</p>\n\n<p>The constructor calls the default constructor first (the constructor that is being delegated to). After the default constructor returns, the body of the delegating constructor is executed.</p>\n\n<p>See <a href=\"http://www.stroustrup.com/C++11FAQ.html#delegating-ctor\" rel=\"noreferrer\">http://www.stroustrup.com/C++11FAQ.html#delegating-ctor</a> and <a href=\"https://en.cppreference.com/w/cpp/language/initializer_list#Delegating_constructor\" rel=\"noreferrer\">https://en.cppreference.com/w/cpp/language/initializer_list#Delegating_constructor</a> for additional information.</p>\n"}], "owner": {"reputation": 1222, "user_id": 1115716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/22KiX.jpg?s=128&g=1", "display_name": "easythrees", "link": "https://stackoverflow.com/users/1115716/easythrees"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 2, "accepted_answer_id": 51973186, "answer_count": 1, "score": 11, "last_activity_date": 1534972810, "creation_date": 1534962912, "last_edit_date": 1534972810, "question_id": 51973151, "link": "https://stackoverflow.com/questions/51973151/what-does-classname-mean-in-a-constructor-for-classname", "title": "What does :className() mean in a constructor for className?", "body": "<p>I see some code in a codebase I'm working on that looks like:</p>\n\n<pre><code> ZfooName::ZfooName(int magoo)\n    : ZfooName()\n {\n    fGoo = magoo;\n }\n</code></pre>\n\n<p>I'm assuming this is a C++11 feature, since it breaks in VS2012, but what does it mean?</p>\n"}, {"tags": ["c++", "winapi", "visual-c++", "ghostscript"], "answers": [{"tags": [], "owner": {"reputation": 27865, "user_id": 701996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hx9ep.jpg?s=128&g=1", "display_name": "KenS", "link": "https://stackoverflow.com/users/701996/kens"}, "is_accepted": true, "score": 3, "last_activity_date": 1534963728, "creation_date": 1534963728, "answer_id": 51973356, "question_id": 51972827, "link": "https://stackoverflow.com/questions/51972827/hide-window-created-by-winapi-call/51973356#51973356", "title": "Hide window created by WinAPI call", "body": "<p>It <strong>is</strong> in the documentation, look <a href=\"https://www.ghostscript.com/doc/9.23/Devices.htm#Win\" rel=\"nofollow noreferrer\">here</a> under section 10.2 Supported Options (device properties)</p>\n\n<blockquote>\n  <p>The following options are available:</p>\n\n<pre><code>/NoCancel boolean\n    Disables (hides) the progress dialog when set to true or show the progress dialog if not set or set to false.\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 325, "user_id": 8082093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d7ec27f9cfd4e67f422ed9c88cd5f6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/8082093/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 51973356, "answer_count": 1, "score": 0, "last_activity_date": 1534963728, "creation_date": 1534961542, "question_id": 51972827, "link": "https://stackoverflow.com/questions/51972827/hide-window-created-by-winapi-call", "title": "Hide window created by WinAPI call", "body": "<p>I'm trying to call GhostScript(GS) command line tool from C++ code. Unfortunately, GS creates window with progress bar. I was wondering is there a way to hide this window? Code listed below. I will be grateful for any advice.</p>\n\n<pre><code>std::string cmd = (\"gswin32c.exe -sDEVICE=mswinpr2 -dBATCH -dNOPAUSE -dNOSAFER -sOutputFile=\\\"%printer%HPLJ2000\\\" \\\"1.pdf\\\"\");\nSECURITY_ATTRIBUTES sa;\nsa.nLength = sizeof(SECURITY_ATTRIBUTES);\nsa.lpSecurityDescriptor = NULL;\nsa.bInheritHandle = TRUE;\nauto dwFlags = FILE_ATTRIBUTE_NORMAL;\nSTARTUPINFOW si;\nGetStartupInfoW(&amp;si);\nPROCESS_INFORMATION pi;\nZeroMemory(&amp;si, sizeof(si));\nsi.cb = sizeof(si);\nsi.dwFlags = STARTF_USESHOWWINDOW;\nsi.wShowWindow = SW_HIDE;\nZeroMemory(&amp;pi, sizeof(pi));\n\nif (!CreateProcess(NULL, cmd.c_str(), NULL, NULL, TRUE, CREATE_NO_WINDOW, NULL, NULL, &amp;si, &amp;pi)) {\n    std::err &lt;&lt; \"Something went wrong\" &lt;&lt; std::endl;\n}\n\nWaitForSingleObject(pi.hProcess, INFINITE);\nCloseHandle(pi.hProcess);\nCloseHandle(pi.hThread);\n</code></pre>\n"}, {"tags": ["c++", "boost-spirit", "boost-spirit-qi"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1534973501, "post_id": 51972790, "comment_id": 90901277, "body": "Please simplify the code to be self-contained, minimal. Right now, we don&#39;t know nothing about your lexer, little about your grammar, and nothing about the namespaces involved. Also, you describe nothing relevant to the separation of the translation units (cpp files)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1534973670, "post_id": 51972790, "comment_id": 90901341, "body": "To be honest, maybe you should share the grammar and example inputs you want to parse, and we&#39;d be able to help write a (simpler) parser for it."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1535016796, "post_id": 51972790, "comment_id": 90914741, "body": "That edit is excellent. I will give this some attention, probably over the weekend"}], "owner": {"reputation": 31, "user_id": 6570585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a86b3f50e096f0cb0868b3df726a24?s=128&d=identicon&r=PG&f=1", "display_name": "tupanu", "link": "https://stackoverflow.com/users/6570585/tupanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1535008275, "creation_date": 1534961410, "last_edit_date": 1535008275, "question_id": 51972790, "link": "https://stackoverflow.com/questions/51972790/boost-spirit-split-rules-into-different-headers", "title": "Boost spirit split rules into different headers", "body": "<p>I want to parse the following structure (for the sake of simplicity I will show only the half of it but the rest of the structure is the same as the one presented):</p>\n\n<pre><code>*Point, name=1, mission=mission2, inherit_point=bla\n*Sn\n    22,-22.5\n    22,22.5\n    22,22.5\n    22,22.5\n    22,22.5\n    22,22.5\n\n*Material\n    22.55,22.55,22.55\n    22.55,22.55,22.55\n*Kt\n 1\n\n*Output\n    sequiv_fat, sequiv_propa\n\n*End Point\n</code></pre>\n\n<p>Each section (starting with *) will be parsed into a structure. The main section Point will contain the sub-sections Sn,Material and Output. It will also have the attributes name, mission and inherit_point.</p>\n\n<ul>\n<li><p>Sn section will be parsed into a \n<br><code>struct Sn {\n  std::string name // \"Sn\"\n  std::map&lt;int,double&gt; data;\n}</code></p></li>\n<li><p>material into</p>\n\n<p><code>struct material {\n   std::string name // \"material\"\n   std::vector&lt;double&gt; data;\n}</code></p></li>\n<li><p>Kt </p>\n\n<p><code>struct Kt {\n  std::string name; // \"kt\"\n  int value;\n}</code></p></li>\n<li><p>Output </p>\n\n<p><code>struct Output {\n  std::string name; //\"output\"\n  std::vector&lt;std::string&gt; data;\n }</code></p></li>\n</ul>\n\n<p>To parse this section, I've taken the an example from Boost Spirit which I've modified.</p>\n\n<p>Having a large section to be parsed,I was thinking to split the grammar rules into separated classes. My thoughts were to have a rule for each sub section to be parsed and a main rule to parse the Point section. \n<br>Each <code>sub rule</code> will be parse into its corresponding structure.\n<br>To do this, I need to be able to pass the lexer to each \"sub rule\" but I don't know to do that.</p>\n\n<p>Here is what I've done sofar. </p>\n\n<p>As you can see from the grammar definition, the rule Assigment_Rule2 is defined in a separated file but I don't know how to pass the the lexer to this rule. Moreover it doesn't compile.</p>\n\n<pre><code>    #define BOOST_VARIANT_USE_RELAXED_GET_BY_DEFAULT\n#define BOOST_SPIRIT_DEBUG\n\n#include &lt;boost/fusion/include/adapt_struct.hpp&gt;\n#include &lt;boost/config/warning_disable.hpp&gt;\n#include &lt;boost/spirit/include/qi.hpp&gt;\n#include &lt;boost/spirit/include/lex_lexertl.hpp&gt;\n#include &lt;boost/spirit/include/phoenix_operator.hpp&gt;\n#include &lt;boost/spirit/include/qi_real.hpp&gt;\n#include &lt;boost/spirit/include/qi_eol.hpp&gt;\n#include &lt;boost/spirit/include/phoenix.hpp&gt;\n\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;map&gt;\n\n#include \"example.hpp\"\n\n\nusing namespace boost::spirit;\nusing boost::phoenix::val;\n\n///////////////////////////////////////////////////////////////////////////////\n//  class definition\n///////////////////////////////////////////////////////////////////////////////\n\nnamespace client {\n    namespace qi = boost::spirit::qi;\n\n    struct point\n    {\n        std::string name;\n        std::string name2;\n        std::string mission;\n        std::string parent_point;\n    };\n}\n\nBOOST_FUSION_ADAPT_STRUCT(client::point,\n    (std::string, name),\n    (std::string, name2),\n    (std::string, mission),\n    (std::string, parent_point)\n)\n\nnamespace client {\n    ///////////////////////////////////////////////////////////////////////////////\n    //  Token id definitions\n    ///////////////////////////////////////////////////////////////////////////////\n    enum token_ids\n    {\n        ID_CONSTANT = 1000,\n        ID_START_POINT,\n        ID_END_POINT,\n        ID_SN,\n        ID_MATERIAL,\n        ID_IDENTIFIER,\n        ID_INTEGER,\n        ID_FLOAT\n    };\n\n    ///////////////////////////////////////////////////////////////////////////////\n    //  Token definitions\n    ///////////////////////////////////////////////////////////////////////////////\n    template &lt;typename Lexer&gt;\n    struct example6_tokens : lex::lexer&lt;Lexer&gt;\n    {\n        example6_tokens()\n        {\n            // define the tokens to match\n            identifier = \"[a-zA-Z_][a-zA-Z0-9_]*\";\n            constant = \"[0-9]+\";\n            float_value = \"-?\\\\d+(\\\\.\\\\d+)?\";\n\n            this-&gt;self = lex::token_def&lt;&gt;('(') | ')' | '=' | ',' | '*';\n\n            this-&gt;self.add\n            (constant, ID_CONSTANT)\n                (\"Point\", ID_START_POINT)\n                (\"End Point\", ID_END_POINT)\n                (\"Sn\", ID_SN)\n                (\"Material\", ID_MATERIAL)\n                (identifier, ID_IDENTIFIER)\n                (float_value, ID_FLOAT)\n                ;\n\n            this-&gt;self(\"WS\")\n                = lex::token_def&lt;&gt;(\"[ \\\\t\\\\n]+\")\n                | \"\\\\/\\\\*[^*]*\\\\*+([^/*][^*]*\\\\*+)*\\\\/\"\n                ;\n        }\n\n        lex::token_def&lt;std::string&gt; identifier;\n        lex::token_def&lt;unsigned int&gt; constant;\n        lex::token_def&lt;double&gt; float_value;\n    };\n}\n\n///////////////////////////////////////////////////////////////////////////////\n//  Grammar definition\n///////////////////////////////////////////////////////////////////////////////\n\nnamespace client {\n\n    template &lt;typename Iterator, typename Lexer&gt;\n    struct example6_grammar\n        : qi::grammar&lt;Iterator, point(), qi::in_state_skipper&lt;Lexer&gt; &gt;\n    {\n        template &lt;typename TokenDef&gt;\n        example6_grammar(TokenDef const&amp; tok)\n            : example6_grammar::base_type(start)\n        {\n            using boost::spirit::_val;\n            using boost::spirit::qi::eol;\n            using qi::on_error;\n            using qi::fail;\n            using qi::debug;\n\n\n            start\n                =   '*' \n                    &gt;&gt; token(ID_START_POINT)\n                    &gt;&gt; ','\n                    &gt;&gt; assignment2\n                    &gt;&gt; ','\n                    &gt;&gt; assignment2\n                    &gt;&gt; ','\n                    &gt;&gt; assignment2\n                    &gt;&gt; *statement \n                    &gt;&gt; '*' \n                    &gt;&gt; token(ID_END_POINT)\n                ;\n\n            statement\n                = sn_stmt\n                | material_stmt\n                ;\n\n            assignment\n                = tok.identifier &gt;&gt; '=' &gt;&gt; expression\n            ;\n\n            sn_stmt = ('*' &gt;&gt; token(ID_SN) &gt;&gt; +pair)\n                [\n                    std::cout &lt;&lt; val(\"sn statement to: \")\n                    &lt;&lt; _1 &lt;&lt; \"\\n\"\n                ]\n            ;\n\n            material_stmt = ('*' &gt;&gt; token(ID_MATERIAL) &gt;&gt; +list)\n                [\n                    std::cout &lt;&lt; val(\"material statement to: \")\n                    &lt;&lt; _1 &lt;&lt; \"\\n\"\n                ]\n            ;\n\n            list = token(ID_FLOAT) % ',';\n\n            pair\n                = token(ID_CONSTANT) &gt;&gt; ',' &gt;&gt; token(ID_FLOAT)\n                ;\n\n            expression\n                = tok.identifier[_val = _1]\n                | tok.constant[_val = _1]\n                ;\n\n            sn_stmt.name(\"sn_stmt\");\n            material_stmt.name(\"material_stmt\");\n            debug(sn_stmt);\n            debug(material_stmt);\n        }\n\n        typedef boost::variant&lt;unsigned int, std::string&gt; expression_type;\n\n        qi::rule&lt;Iterator, point(), qi::in_state_skipper&lt;Lexer&gt; &gt; start;\n        qi::rule&lt;Iterator, qi::in_state_skipper&lt;Lexer&gt; &gt; statement, material_stmt, pair, list, assignment;\n        qi::rule&lt;Iterator, qi::in_state_skipper&lt;Lexer&gt;&gt; sn_stmt;\n\n        qi::rule&lt;Iterator, expression_type(), qi::in_state_skipper&lt;Lexer&gt; &gt;  expression;\n        Assigment_Rule2&lt;Iterator&gt; assignment2;\n    };\n}\n\n///////////////////////////////////////////////////////////////////////////////\nint main()\n{\n    typedef std::string::iterator base_iterator_type;\n\n    typedef lex::lexertl::token&lt;\n        base_iterator_type, boost::mpl::vector&lt;unsigned int, std::string, double&gt;\n    &gt; token_type;\n\n    typedef lex::lexertl::lexer&lt;token_type&gt; lexer_type;\n    typedef client::example6_tokens&lt;lexer_type&gt; example6_tokens;\n    typedef example6_tokens::iterator_type iterator_type;\n\n    typedef client::example6_grammar&lt;iterator_type, example6_tokens::lexer_def&gt; example6_grammar;\n\n    example6_tokens tokens;                         // Our lexer\n    example6_grammar calc(tokens);                  // Our parser\n\n    std::string str(read_from_file(\"ReadMe.txt\"));\n\n    std::string::iterator it = str.begin();\n    iterator_type iter = tokens.begin(it, str.end());\n    iterator_type end = tokens.end();\n\n    std::string ws(\"WS\");\n    client::point my_point;\n\n    bool r = qi::phrase_parse(iter, end, calc, qi::in_state(ws)[tokens.self], my_point);\n\n    if (r &amp;&amp; iter == end)\n    {\n        std::cout &lt;&lt; \"-------------------------\\n\";\n        std::cout &lt;&lt; \"Parsing succeeded\\n\";\n        std::cout &lt;&lt; \"-------------------------\\n\";\n    }\n    else\n    {\n        std::cout &lt;&lt; \"-------------------------\\n\";\n        std::cout &lt;&lt; \"Parsing failed\\n\";\n        std::cout &lt;&lt; \"-------------------------\\n\";\n    }\n\n    std::cout &lt;&lt; \"Bye... :-) \\n\\n\";\n    return 0;\n}\n</code></pre>\n\n<p>File BasicRules.hpp</p>\n\n<pre><code>#include &lt;boost/config/warning_disable.hpp&gt;\n#include &lt;boost/spirit/include/qi.hpp&gt;\n#include &lt;boost/spirit/include/lex_lexertl.hpp&gt;\n#include &lt;boost/spirit/include/phoenix_operator.hpp&gt;\n#include &lt;boost/spirit/include/qi_real.hpp&gt;\n#include &lt;boost/spirit/include/qi_eol.hpp&gt;\n#include &lt;boost/spirit/include/phoenix.hpp&gt;\n#include &lt;boost/spirit/include/qi_char_.hpp&gt;\n#include &lt;boost/spirit/include/qi_lexeme.hpp&gt;\n\nusing namespace boost::spirit;\nusing boost::phoenix::val;\n\nnamespace client {\n    template &lt;typename Iterator&gt;\n    struct Assigment_Rule2\n        : qi::grammar&lt;Iterator, std::string()&gt;\n    {\n        Assigment_Rule2()\n            : Assigment_Rule2::base_type(start)\n        {\n            using boost::spirit::double_;\n            using boost::spirit::lexeme;\n            using boost::spirit::ascii::char_;\n\n            start = ( \"2\"&gt;&gt; '=' &gt;&gt; \"2\" )\n                [\n                    _val = _2\n                ]\n            ;\n        }\n\n        qi::rule&lt;Iterator, std::string()&gt; start;\n    };\n}\n</code></pre>\n\n<p>I would appreciate if anybody can give me some ideas and some starting points.\nThanks.</p>\n"}, {"tags": ["c++", "winapi", "console", "c++17"], "comments": [{"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534961478, "post_id": 51972771, "comment_id": 90896044, "body": "There is some code executed before. But this only prints lines by using std::cout. I won&#39;t post the whole project, it&#39;s a tcp socket project."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1534961511, "post_id": 51972771, "comment_id": 90896056, "body": "Which of those programs generates the error you quoted?"}, {"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1534961533, "post_id": 51972771, "comment_id": 90896067, "body": "@Yakk-AdamNevraumont The C-style function."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1534961589, "post_id": 51972771, "comment_id": 90896101, "body": "1) &quot;<i>There is some code executed before. But this only prints lines by using std::cout.</i>&quot; Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, that reproduces your issue. If such &quot;some code&quot; invokes undefined behavior: it could explain such behavior. 2) Did you read the documentation of <a href=\"https://msdn.microsoft.com/en-us/library/w40768et.aspx\" rel=\"nofollow noreferrer\"><code>scanf_s</code></a>? &quot;<i>Unlike scanf and wscanf, scanf_s and wscanf_s require the buffer size to be specified for all input parameters of type c, C, s, S, or string control sets that are enclosed in [].</i>&quot;"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 2, "creation_date": 1534961689, "post_id": 51972771, "comment_id": 90896156, "body": "<code>scanf_s</code> <a href=\"https://msdn.microsoft.com/en-us/library/w40768et.aspx#Anchor_2\" rel=\"nofollow noreferrer\">needs an explicit buffer size</a>."}, {"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1534961905, "post_id": 51972771, "comment_id": 90896250, "body": "@AlgirdasPreid\u017eius I tried these methods above and commented out any console operations before. So my example above is the code concerning the console to be executed."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1534962266, "post_id": 51972771, "comment_id": 90896405, "body": "This doesn&#39;t address the question, but in the C-style code you don&#39;t need <code>new[]</code> and <code>delete[]</code>. Just define <code>str</code> as <code>char str[20];</code>."}, {"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1534962352, "post_id": 51972771, "comment_id": 90896443, "body": "@PeteBecker Uh, you&#39;re right, thanks!"}, {"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534962909, "post_id": 51972771, "comment_id": 90896672, "body": "It&#39;s crazy but after playing aroung with &#180;scanf_s()&#180; and &#180;scanf()&#180; there are no errors anymore but the problem that the cursor jumps to the first column of the line and a second key down on enter is required."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534961975, "post_id": 51972874, "comment_id": 90896276, "body": "Now, scanf_s works! Didn&#39;t see that. But when I press enter once, the cursor jumps to the first character in the same line again. I have to press it twice to get it work. Is it possible to fix this issue?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534962086, "post_id": 51972874, "comment_id": 90896323, "body": "I can&#39;t think of any reason why you need to do that."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534962173, "post_id": 51972874, "comment_id": 90896363, "body": "Are you running the program from the normal command prompt, or an IDE window? It sounds like an issue with your IDE (Visual Studio Code?)"}, {"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534962245, "post_id": 51972874, "comment_id": 90896395, "body": "I ran it using Visual Studio 2017 but I also tried to run it as external program."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534962488, "post_id": 51972874, "comment_id": 90896498, "body": "Does it happen if you use ordinary <code>scanf()</code>? I can&#39;t test <code>scanf_s()</code> since it&#39;s Microsoft-specific and I don&#39;t have a Windows system."}, {"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534962734, "post_id": 51972874, "comment_id": 90896606, "body": "It appears to cause the same issue although I used <code>scanf()</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534962933, "post_id": 51972874, "comment_id": 90896690, "body": "Cursor movement is not something you can control with stdio. I have no idea how to fix the problem you&#39;re seeing."}, {"owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "edited": false, "score": 0, "creation_date": 1534963527, "post_id": 51972874, "comment_id": 90896950, "body": "Well, I got the reason of the problem as posted one answer below. But I think you couldn&#39;t help me since you don&#39;t use Windows."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 5, "last_activity_date": 1534961764, "creation_date": 1534961764, "answer_id": 51972874, "question_id": 51972771, "link": "https://stackoverflow.com/questions/51972771/console-not-reading-input-string-correctly/51972874#51972874", "title": "Console not reading input string correctly", "body": "<p>You're not calling <code>scanf_s()</code> correctly, you're calling it as if it were ordinary <code>scanf()</code>. From the <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l\" rel=\"noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>Unlike <code>scanf</code> and <code>wscanf</code>, <code>scanf_s</code> and <code>wscanf_s</code> require the buffer size to be specified for all input parameters of type <code>c</code>, <code>C</code>, <code>s</code>, <code>S</code>, or string control sets that are enclosed in <code>[]</code>. The buffer size in characters is passed as an additional parameter immediately following the pointer to the buffer or variable. For example, if you are reading a string, the buffer size for that string is passed as follows:</p>\n\n<pre><code>char s[10];\nscanf_s(\"%9s\", s, (unsigned)_countof(s)); // buffer size is 10, width specification is 9\n</code></pre>\n</blockquote>\n\n<p>So in your case, you need to write:</p>\n\n<pre><code>scanf_s(\"%s\", str, 20);\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8893205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e8e733d6238be691682696342d2eca?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/8893205/daniel-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1534965585, "creation_date": 1534961334, "last_edit_date": 1592644375, "question_id": 51972771, "link": "https://stackoverflow.com/questions/51972771/console-not-reading-input-string-correctly", "title": "Console not reading input string correctly", "body": "<p>I tried to read a console input by executing C++-style</p>\n<pre><code>int main()\n{\n    std::string str;\n    std::getline(std::cin, str);\n    // also tested: std::cin &gt;&gt; str;\n    return 0;\n}\n</code></pre>\n<p>and C-style</p>\n<pre><code>int main()\n{\n    char* str = new char[20];\n    scanf_s(&quot;%s&quot;, str);\n    delete[] str;\n    return 0;\n}\n</code></pre>\n<p>But if I enter a string and press enter, the cursor in console won't jump to the next line, it jumps to the first column of the line where the entered command is located. A second key down on enter will cause an error:</p>\n<p><strong>Error message box after executing C++-style code:</strong></p>\n<blockquote>\n<pre><code>Debug Assertion Failed!\n\nProgram: D:\\_extern\\Test\\Test.exe\nFile: minkernel\\crts\\ucrt\\src\\appcrt\\lowio\\read.cpp\nLine: 259\n\nExpression: static_cast&lt;void const*&gt;(source_buffer) == static_cast&lt;void const*&gt;(result_buffer)\n\nFor information on how your program can cause an assertion\nfailure, see the Visual C++ documentation on asserts.\n</code></pre>\n</blockquote>\n<p><strong>Error after executing C-style code:</strong></p>\n<blockquote>\n<pre><code>Exception triggered at 0x00007FF95C9398E9 (ucrtbased.dll) in Test.exe: 0xC0000005: Access violation when writing at position 0x0000019155DF1000.\n</code></pre>\n</blockquote>\n<p>What could be the problem?</p>\n"}, {"tags": ["c++", "templates", "type-conversion", "ambiguous"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1534961623, "post_id": 51972738, "comment_id": 90896117, "body": "Why does the conversion operator need to be a template? Why not just <code>operator Foo()</code>?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1534961685, "post_id": 51972738, "comment_id": 90896153, "body": "@Justin, because it is an illustration (MCVE) which is not the actual problem?"}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "edited": false, "score": 0, "creation_date": 1534961702, "post_id": 51972738, "comment_id": 90896165, "body": "Because <code>Foo</code> is not the only type I&#39;ll be casting it to. This templated conversion operator gives really nice semantics (see nlohmann/json)."}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "reply_to_user": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1534961948, "post_id": 51972738, "comment_id": 90896269, "body": "@Evgeny that defeats the purpose of the implicit conversion :P"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1534962028, "post_id": 51972738, "comment_id": 90896300, "body": "What would you actually like to be called in this example? Your Bar is convertable to both..."}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534962497, "post_id": 51972738, "comment_id": 90896502, "body": "@SergeyA I&#39;d like <code>Foo(int*)</code> to be called once and then the new <code>Foo</code> object be moved to <code>f</code>."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1534963802, "post_id": 51972738, "comment_id": 90897076, "body": "Goes to show unrestricted conversion is nearly always a mistake."}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1534964660, "post_id": 51972738, "comment_id": 90897478, "body": "@DanielLangr That&#39;s a good guess. When I disable the conversion for references, though, i.e., <code>std::enable_if_t&lt;!std::is_reference&lt;T&gt;{}&gt;</code>, I still get the same errors."}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1534964813, "post_id": 51972738, "comment_id": 90897550, "body": "@PasserBy well, how would I go about making it implicit only in the right context?"}, {"owner": {"reputation": 56338, "user_id": 4573247, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JHd9a.png?s=128&g=1", "display_name": "dfrib", "link": "https://stackoverflow.com/users/4573247/dfrib"}, "edited": false, "score": 0, "creation_date": 1534964955, "post_id": 51972738, "comment_id": 90897607, "body": "Related: <a href=\"https://stackoverflow.com/questions/26949290/\">SFINAE enable_if explicit constructor</a>."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1535012414, "post_id": 51972738, "comment_id": 90912187, "body": "Might be interested in: <a href=\"https://stackoverflow.com/q/51980680/580083\">Implicit conversions and different behavior of compilers</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "edited": false, "score": 0, "creation_date": 1534964333, "post_id": 51973180, "comment_id": 90897327, "body": "This is nice, as it resolves the constructor problem, but it disables other useful implicit conversions, e.g.<code>void fn(Foo)</code> will not be callable with <code>fn(Bar{})</code>, it will insteam require <code>static_cast</code>. So if there were a way to differenciate between construction and function call, that would be awesome"}, {"owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "edited": false, "score": 0, "creation_date": 1534967084, "post_id": 51973180, "comment_id": 90898569, "body": "Okay, I finally got it. For fundamental types I use the implicit conversion operator and for the rest I use the explicit one. It took me a while, because I mistook <code>std::is_abstract</code> for <code>std::is_fundamental</code>"}], "tags": [], "owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "is_accepted": true, "score": 11, "last_activity_date": 1538411338, "last_edit_date": 1538411338, "creation_date": 1534963078, "answer_id": 51973180, "question_id": 51972738, "link": "https://stackoverflow.com/questions/51972738/how-to-disambiguate-this-construction-in-a-templated-conversion-operator/51973180#51973180", "title": "How to disambiguate this construction in a templated conversion operator?", "body": "<p>To resolve the ambiguity, add <code>explicit</code> to the conversion operator declaration:</p>\n\n<pre><code>struct Bar\n{    \n    template&lt;typename T&gt;\n    explicit operator T()\n    {\n        return Foo{nullptr}; \n    }\n};\n</code></pre>\n\n<p>Why is it necessary? Because <code>Foo</code> has a constructor taking a <code>int*</code>, and so a <code>operator int*()</code> instantiation of <code>operator T()</code> <em>template</em> is being considered as part of overload resolution for the initialization of <code>f</code>. See under <a href=\"http://eel.is/c++draft/over.match.copy\" rel=\"nofollow noreferrer\">[over.match.copy]</a>:</p>\n\n<blockquote>\n  <p><strong>1</strong> [...] Assuming that <strong>\u201c<code>cv1 T</code>\u201d</strong> is the type of the object being initialized,\n  with <code>T</code> a class type, the candidate functions are selected as follows:</p>\n  \n  <ul>\n  <li><p><strong>(1.1)</strong> The converting constructors of <code>T</code> are candidate functions. </p></li>\n  <li><p><strong>(1.2)</strong> When the type of the initializer expression is a class type \u201c<code>cv S</code>\u201d,\n  <strong>the non-explicit conversion functions of <code>S</code> and its base classes are\n  considered.</strong> When initializing a temporary object ([class.mem]) to be\n  bound to the first parameter of a constructor where the parameter is\n  of type \u201creference to possibly cv-qualified <code>T</code>\u201d and the constructor is\n  called with a single argument <strong>in the context of direct-initialization\n  of an object of type \u201c<code>cv2 T</code>\u201d, explicit conversion functions are also\n  considered.</strong></p></li>\n  </ul>\n</blockquote>\n\n<p>From (1.2) it follows that only implicit conversion functions are considered for the initialization, hence the ambiguity -- as the compiler cannot decide between constructing <code>f</code> using a reference to <code>Foo</code> or, as already mentioned, using a <code>int*</code> (obtained by way of <em>copy-initializing</em>) from the return value of <code>operator int*</code>. <strong>However,</strong> when the <em>initializer expression</em> is a <em>temporary object</em>, we also consider <em>explicit</em> conversions -- but only if they match a constructor taking a reference to <code>Foo</code>, our <em>\"possibly cv-qualified <code>T</code>\"</em>, i.e. our <em>copy</em> and <em>move constructor</em>s. This entire behavior is being consistent with <a href=\"http://eel.is/c++draft/class.conv#fct-2\" rel=\"nofollow noreferrer\">[class.conv.fct\u00b62]</a>:</p>\n\n<blockquote>\n  <p>A conversion function may be explicit ([dcl.fct.spec]), in which case\n  it is only considered as a user-defined conversion for\n  direct-initialization ([dcl.init]). <strong>Otherwise, user-defined\n  conversions are not restricted to use in assignments and\n  initializations.</strong></p>\n</blockquote>\n\n<p>And so, saying the same thing here for the 3rd time: if it isn't marked as <code>explicit</code>, there's nothing stopping the compiler from trying to <em>copy-initialize</em> an <code>int*</code> to be used for construction.</p>\n"}, {"tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": false, "score": 0, "last_activity_date": 1535006530, "last_edit_date": 1535006530, "creation_date": 1534967298, "answer_id": 51974122, "question_id": 51972738, "link": "https://stackoverflow.com/questions/51972738/how-to-disambiguate-this-construction-in-a-templated-conversion-operator/51974122#51974122", "title": "How to disambiguate this construction in a templated conversion operator?", "body": "<p>My best guess after some digging: I get the same error with the following code:</p>\n\n<pre><code>struct Foo { Foo(int*) {} };\n\nstruct Bar {    \n   operator Foo(); // { return Foo{nullptr}; }\n   /* explicit */ operator int*();\n};\n\nint main() { Foo f{Bar{}}; }\n</code></pre>\n\n<p>And, when I uncomment the commented code, then the problem disappears. It seems to me that, in OP's original templated version, when implicit conversion is required from <code>Bar</code> to <code>Foo</code>, GCC only \"instantiates\" conversion operator declarations and then resolves overload before instantiating of their bodies.</p>\n\n<p>As for why <code>explicit</code> helps, it is because in the second case, there is one more conversion required (<code>Bar</code>\u2192<code>int*</code> and then <code>int*</code>\u2192<code>Foo</code>).</p>\n"}], "owner": {"reputation": 1074, "user_id": 3560202, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/091b39f1456adeef5a255321f850e27a?s=128&d=identicon&r=PG&f=1", "display_name": "Post Self", "link": "https://stackoverflow.com/users/3560202/post-self"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 3, "accepted_answer_id": 51973180, "answer_count": 2, "score": 12, "last_activity_date": 1538411338, "creation_date": 1534961173, "last_edit_date": 1534962229, "question_id": 51972738, "link": "https://stackoverflow.com/questions/51972738/how-to-disambiguate-this-construction-in-a-templated-conversion-operator", "title": "How to disambiguate this construction in a templated conversion operator?", "body": "<p>After being confused why my code gave me an ambiguity error on GCC but no errors on Clang, I simplified the code. It can be seen below.</p>\n\n<pre><code>struct Foo\n{\n    // Foo(Foo&amp;&amp;) = delete;\n    // Foo(const Foo&amp;) = delete;\n    Foo(int*) {}\n};\n\nstruct Bar\n{    \n    template&lt;typename T&gt;\n    operator T()\n    {\n        return Foo{nullptr};\n    }\n};\n\nint main() { Foo f{Bar{}}; }\n</code></pre>\n\n<p>The errors are as follows.</p>\n\n<pre><code>main.cpp:17:18: error: call to constructor of 'Foo' is ambiguous\nint main() { Foo f{Bar{}}; }\n                 ^~~~~~~~\nmain.cpp:1:8: note: candidate is the implicit move constructor\nstruct Foo\n       ^\nmain.cpp:1:8: note: candidate is the implicit copy constructor\nmain.cpp:5:1: note: candidate constructor\nFoo(int*) {}\n^\n</code></pre>\n\n<p>I was unable to make it successfullycompile for Clang this time, so I suppose that was just a Clang bug and this is the intended behavior.</p>\n\n<p>When I explicitly delete the copy and move constructors (i.e. uncomment the top two lines of code), I instead get</p>\n\n<pre><code>note: candidate constructor has been explicitly deleted\n</code></pre>\n\n<p>but still an error. How would I go about disambiguating the construction here, then?</p>\n\n<p>Note that I specifically added the <code>Foo{nullptr}</code> instead of just <code>nullptr</code>, but there is no difference. Same with marking the <code>Foo</code> ctor explicit. This ambiguity error only occurs when <code>Bar</code>'s conversion operator is templated.</p>\n\n<p>I can add some SFINAE to the conversion operator, but I am unsure of what I would exclude. For example, this would make it work:</p>\n\n<pre><code>template&lt;typename T, std::enable_if_t&lt;std::is_same&lt;T, Foo&gt;{}&gt;* = nullptr&gt;\n</code></pre>\n\n<p>This is another one that I found and this might be my answer:</p>\n\n<pre><code>template&lt;typename T, std::enable_if_t&lt;!std::is_same&lt;T, int*&gt;{}&gt;* = nullptr&gt; \n</code></pre>\n"}, {"tags": ["c++", "string", "text", "codeblocks"], "comments": [{"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1534959202, "post_id": 51972259, "comment_id": 90895018, "body": "Welcome to Stack Overflow! Can you talk us through some of the approaches you&#39;ve tried so far and why they didn&#39;t work? If you post sample code that you&#39;ve written, we can look over it and see whether there&#39;s an easy fix to one of the strategies you&#39;ve attmpted."}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 3, "creation_date": 1534959223, "post_id": 51972259, "comment_id": 90895032, "body": "What is a notepad? Do you mean a text file? Please, state explicitly what methods you have tried and in what exact way did they fail."}, {"owner": {"reputation": 33, "user_id": 10261018, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xD5MKtJwZKk/AAAAAAAAAAI/AAAAAAAAACk/1XSwntKyY00/photo.jpg?sz=128", "display_name": "Fusi Flag", "link": "https://stackoverflow.com/users/10261018/fusi-flag"}, "edited": false, "score": 0, "creation_date": 1534959473, "post_id": 51972259, "comment_id": 90895139, "body": "1. They failed because whenever I was trying to run the code, the output was 0 or nothing. Yes, I meant a text file."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 1, "creation_date": 1534959563, "post_id": 51972259, "comment_id": 90895184, "body": "For future context, &quot;10000 characters&quot; is not what most modern programmers would consider a &quot;very long&quot; text file. That&#39;s only 10kb, after all. There are lots of good solutions to reading a 10kb file, but they wouldn&#39;t be what the average programmer would come up with for reading a &quot;very long text&quot;, which would intuitively suggest file sizes in the multi-GB range."}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1534959627, "post_id": 51972259, "comment_id": 90895215, "body": "Can you show us the exact code that you were running? Without seeing the code, we can&#39;t tell whether the issue is something really simple (as in, the file is in the wrong place) or more nuanced (you&#39;re using a function in the wrong way.)"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1534959831, "post_id": 51972259, "comment_id": 90895302, "body": "Now after you added the code, my guess is you have your text file in the wrong folder so it was not read at all."}, {"owner": {"reputation": 33, "user_id": 10261018, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xD5MKtJwZKk/AAAAAAAAAAI/AAAAAAAAACk/1XSwntKyY00/photo.jpg?sz=128", "display_name": "Fusi Flag", "link": "https://stackoverflow.com/users/10261018/fusi-flag"}, "edited": false, "score": 0, "creation_date": 1534959952, "post_id": 51972259, "comment_id": 90895358, "body": "The text is in the correct folder. I will try deleting it and putting it back, though."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1534960019, "post_id": 51972259, "comment_id": 90895399, "body": "Your program should check if the file is opened and print an error message if it is not able to be read."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10261018, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xD5MKtJwZKk/AAAAAAAAAAI/AAAAAAAAACk/1XSwntKyY00/photo.jpg?sz=128", "display_name": "Fusi Flag", "link": "https://stackoverflow.com/users/10261018/fusi-flag"}, "edited": false, "score": 0, "creation_date": 1534960714, "post_id": 51972581, "comment_id": 90895726, "body": "EDIT: I managed to make it work, there was a problem with CodeBlocks. Thx."}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": true, "score": 1, "last_activity_date": 1534960425, "creation_date": 1534960425, "answer_id": 51972581, "question_id": 51972259, "link": "https://stackoverflow.com/questions/51972259/how-do-i-read-a-very-long-text-from-a-notepad-using-c/51972581#51972581", "title": "How do I read a very long text from a notepad using C++?", "body": "<p>The code that you've posted will open the file <code>export_descr_buildings.txt</code> from the program's working directory and print out its contents (mostly - more on that later.) If you're not seeing anything at all, it likely means that the file couldn't be opened properly. You can check whether the file opened by writing something to this effect:</p>\n\n<pre><code>ifstream file(\"export_descr_buildings.txt\");\nif (!file) {\n    // Report an error, and (probably) exit the program.\n}\n</code></pre>\n\n<p>I'd start off by trying this to see whether the issue is whether the file can be opened at all. If not, that's the real issue, and then the question is why. The most likely culprit would be that the file is in the wrong directory, and you can try to fix that by moving the file around to different candidate locations until you can open it.</p>\n\n<p>There's another issue here, and that's that the way that you're reading the file probably won't do what you want it to do. By default, if you write</p>\n\n<pre><code>file &gt;&gt; content;\n</code></pre>\n\n<p>the input will consume whitespace and only read up to whitespace. Therefore, if you have a file that contains the text</p>\n\n<pre><code>A B C D\n</code></pre>\n\n<p>you'll see printed as output</p>\n\n<pre><code>ABCD\n</code></pre>\n\n<p>because all the whitespace will be removed. If that's what you want to do, great! On the other hand, if you want to literally read the contents of the file and print them out, I'd recommend using this idiom:</p>\n\n<pre><code>for (string line; getline(file, line); ) {\n    cout &lt;&lt; line &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Without knowing more about what you're trying to do, though, I can't say for sure that this is the right pattern. That will depend on your use case.</p>\n"}], "owner": {"reputation": 33, "user_id": 10261018, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xD5MKtJwZKk/AAAAAAAAAAI/AAAAAAAAACk/1XSwntKyY00/photo.jpg?sz=128", "display_name": "Fusi Flag", "link": "https://stackoverflow.com/users/10261018/fusi-flag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51972581, "answer_count": 1, "score": -3, "last_activity_date": 1534960425, "creation_date": 1534959083, "last_edit_date": 1534959778, "question_id": 51972259, "link": "https://stackoverflow.com/questions/51972259/how-do-i-read-a-very-long-text-from-a-notepad-using-c", "title": "How do I read a very long text from a notepad using C++?", "body": "<p>I have a notepad with a lot of characters <em>(around 10000, numbers, letters, quotation marks, etc)</em> and I want to read them all. I have tried several methods found online but none worked so far. </p>\n\n<p>After I read the text, I also want to modify it by replacing one specific word. <em>(I know how to do this)</em></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nint main() {\n\nifstream file(\"export_descr_buildings.txt\");\nstring content;\n\nwhile(file &gt;&gt; content) {\ncout &lt;&lt; content ;\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1534959223, "post_id": 51972237, "comment_id": 90895033, "body": "1) Why are you writing <code>ArrayList</code>, if <code>std::vector</code> is exactly that? 2) Typically, container classes manage their own memory, hence you know how memory for <code>array</code> was allocated. Hint: you should avoid using <code>malloc</code> where possible, due to the fact, that it doesn&#39;t invoke constructors, where <code>new</code> does. 3) Typically, classes shouldn&#39;t care how they were allocated. It changes nothing for class internal structure."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1534959263, "post_id": 51972237, "comment_id": 90895052, "body": "<code>malloc</code>/<code>free</code> don&#39;t construct or destruct objects and are not appropriate for most class types. <code>new</code>/<code>delete</code> does."}, {"owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "edited": false, "score": 0, "creation_date": 1534959357, "post_id": 51972237, "comment_id": 90895088, "body": "As mentioned in the original post, I&#39;m doing it for practice. I don&#39;t expect <code>malloc</code> to invoke constructors, I&#39;m assuming that the <code>ArrayList</code>, will store pointers to pre-constructed objects/primitives."}, {"owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "edited": false, "score": 0, "creation_date": 1534959396, "post_id": 51972237, "comment_id": 90895101, "body": "Yes, that&#39;s why the class interface doesn&#39;t use <code>malloc&#47;free</code>, I&#39;m using it internally to build a resizable array class."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1534959470, "post_id": 51972237, "comment_id": 90895136, "body": "<i>deconstructor</i> -- The term is <i>destructor</i>, not <i>deconstructor</i>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534959472, "post_id": 51972237, "comment_id": 90895138, "body": "@Carpetfizz There&#39;s no reason to use <code>malloc</code> to create arrays, <code>new</code> is perfectly capable of it as well."}, {"owner": {"reputation": 427, "user_id": 3546642, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/38cfc4c9e1ec179dd7af2f49aa28f45b?s=128&d=identicon&r=PG&f=1", "display_name": "Chad K", "link": "https://stackoverflow.com/users/3546642/chad-k"}, "edited": false, "score": 0, "creation_date": 1534959650, "post_id": 51972237, "comment_id": 90895226, "body": "cant you just do a for loop and then <code>delete arraylist[i]</code> ?"}, {"owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "reply_to_user": {"reputation": 427, "user_id": 3546642, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/38cfc4c9e1ec179dd7af2f49aa28f45b?s=128&d=identicon&r=PG&f=1", "display_name": "Chad K", "link": "https://stackoverflow.com/users/3546642/chad-k"}, "edited": false, "score": 0, "creation_date": 1534959701, "post_id": 51972237, "comment_id": 90895247, "body": "@ChadK sure, but that&#39;s only assuming that the <code>T*</code> point to an object created using the <code>new</code> keyword. What if I&#39;m storing pointers to blocks that were <code>malloc</code>&#39;d?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1534959731, "post_id": 51972237, "comment_id": 90895261, "body": "@Carpetfizz <i>But I don&#39;t know if the T that it&#39;s holding were created using a new or a malloc-type, so how do I dealloc them?</i>  -- You don&#39;t know, unless the client tells you how to deallocate.  The client could have just stored an address of a non-dynamically created object, or an object created with an operating system API call (i.e. LocalAlloc from Windows)."}, {"owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1534959805, "post_id": 51972237, "comment_id": 90895289, "body": "@PaulMcKenzie would you suggest that it&#39;s good design to restrict the usage of <code>ArrayList</code> to objects that were created using the <code>new</code> keyword? What are they called? What about primitives?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1534959905, "post_id": 51972237, "comment_id": 90895330, "body": "@Carpetfizz -- You can do what the smart pointer classes <code>std::shared_ptr</code> and <code>std::unique_ptr</code> do.  Assume that the &quot;deleter&quot; is <code>delete</code>, and have your class have a custom deleter supplied by the client.  <a href=\"https://stackoverflow.com/questions/12340810/using-custom-deleter-with-stdshared-ptr\">See here</a>"}, {"owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "edited": false, "score": 0, "creation_date": 1534960067, "post_id": 51972237, "comment_id": 90895422, "body": "Do you mind linking to how to accomplish the last part with the template?"}], "answers": [{"comments": [{"owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "edited": false, "score": 0, "creation_date": 1534959623, "post_id": 51972368, "comment_id": 90895213, "body": "Thank you for clearing the confusion! I have a question about your first point. What do you mean by handing the allocations myself? A user is constructing the objects however they wish and just giving it to <code>ArrayList</code> to store."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "edited": false, "score": 1, "creation_date": 1534960359, "post_id": 51972368, "comment_id": 90895561, "body": "@Carpetfizz  If objects are being given to <code>ArrayList</code> then you need to store them by copy constructing them into the <code>ArrayList</code> .The <code>ArrayList</code> is now responsible for deleting the copies."}, {"owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534960409, "post_id": 51972368, "comment_id": 90895582, "body": "@RichardCritten  gotcha thanks! Is this what the standard libraries do (in Java and std::vector)?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "edited": false, "score": 1, "creation_date": 1534960563, "post_id": 51972368, "comment_id": 90895667, "body": "@Carpetfizz  That is how <code>std::vector</code> works.  Java however has a completely different mechanism based on every object being a reference (with reference counting) and storing the reference in the container. and using garbage collection in-place of explicit destruction."}, {"owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534960665, "post_id": 51972368, "comment_id": 90895710, "body": "@RichardCritten  thanks again. So if someone stores objects in std::vector and destroys std::vector they should expect to manually delete all the objects they ended up storing in std::vector right?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "edited": false, "score": 1, "creation_date": 1534960888, "post_id": 51972368, "comment_id": 90895797, "body": "@Carpetfizz If you have a <code>std::vector&lt;Foo&gt;</code>, then the vector will take care of destroying any <code>Foo</code> objects in its destructor. If you have a <code>std::vector&lt;Foo*&gt;</code>, then when that vector is destroyed, the pointed-to <code>Foo</code> objects will not be."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "edited": false, "score": 1, "creation_date": 1534960895, "post_id": 51972368, "comment_id": 90895802, "body": "@Carpetfizz last comment (cos I think you need to read a book).  Objects are put into a <code>std::vector</code> by copying them.  The <code>std::vector</code> is responsible for deleting these copies.  What happens to the originals is the responsibility of the caller. Book list: <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list/388282#388282\" title=\"the definitive c book guide and list\">stackoverflow.com/questions/388242/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534961022, "post_id": 51972368, "comment_id": 90895857, "body": "@RichardCritten FWIW, Java does not use reference counting (or at least not exclusively). Reference counting cannot handle circular references, but Java does handle them."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1534961228, "post_id": 51972368, "comment_id": 90895935, "body": "@hvd I had a few lines to describe the differences in memory model between Java and C++ and how this affects the containers in each language.  Please cut me some slack."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": true, "score": 1, "last_activity_date": 1534959515, "creation_date": 1534959515, "answer_id": 51972368, "question_id": 51972237, "link": "https://stackoverflow.com/questions/51972237/destructor-for-a-template-container/51972368#51972368", "title": "Destructor for a template container", "body": "<blockquote>\n  <p>The deconstructor should be responsible for freeing all the memory stored in the <code>ArrayList</code>. But I don't know if the <code>T*</code>s that it's holding were created using a new or a <code>malloc</code>-type, so how do I dealloc them? I feel like running into this problem is a sign of an anti-pattern, so any advice would be appreciated!</p>\n</blockquote>\n\n<p>You should not be taking in any <code>T*</code>s. You are correct that you have no way to determine how such pointers should be freed. You should handle the allocations yourself (as <code>std::vector</code> does), in which case you no longer have this problem.</p>\n\n<blockquote>\n  <p>If it was initialized on the stack, I don't have to worry about managing <code>arr</code>'s memory, but can I assume that its deconstructor will be called before the <code>arr</code> itself is somehow deallocated?</p>\n</blockquote>\n\n<p>Yes. When a local variable goes out of scope, the object (if any) is destroyed. This involves calling its destructor (again, if any).</p>\n\n<blockquote>\n  <p>If it was initialized on the heap, does calling <code>delete arr</code> call its deconstructor and deallocate <code>arr</code> itself?</p>\n</blockquote>\n\n<p>Yes. <code>delete arr</code> calls <code>arr</code>'s destructor (again, if any) and frees the reserved memory.</p>\n"}], "owner": {"reputation": 7377, "user_id": 896112, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af5a028afcb5ffe89e19a3a9f9454695?s=128&d=identicon&r=PG", "display_name": "Carpetfizz", "link": "https://stackoverflow.com/users/896112/carpetfizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 51972368, "answer_count": 1, "score": 1, "last_activity_date": 1534964126, "creation_date": 1534958964, "last_edit_date": 1534964126, "question_id": 51972237, "link": "https://stackoverflow.com/questions/51972237/destructor-for-a-template-container", "title": "Destructor for a template container", "body": "<p>I'm building a Java-like ArrayList class in C++ just for practice (yes, I know <code>std::vector</code> and other great alternatives exist).</p>\n\n<p>I understand that the <code>new</code> keyword is paired with the <code>delete</code> keyword and <code>malloc, calloc, realloc</code> is paired with <code>free</code>.</p>\n\n<p>So, let's say I have a class <code>ArrayList</code> that contains pointers to some generic type <code>T</code>. In other words, the underlying array in my <code>ArrayList</code> looks like this</p>\n\n<p><code>T* array</code> where <code>T</code> is some <code>template &lt;typename T&gt;</code>.</p>\n\n<p>I'm defining my destructor for <code>ArrayList</code> and I have a few questions..</p>\n\n<ol>\n<li><p>The destructor should be responsible for freeing all the memory stored in the <code>ArrayList</code>. But I don't know if the <code>T*</code>s that it's holding  were created using a <code>new</code> or a <code>malloc</code>-type, so how do I dealloc them? I feel like running into this problem is a sign of an anti-pattern, so any advice would be appreciated!</p></li>\n<li><p>The <code>ArrayList</code> itself can be instantiated in two ways</p></li>\n</ol>\n\n<p>On the stack...</p>\n\n<pre><code>ArrayList arr;\n</code></pre>\n\n<p>or on the heap...</p>\n\n<pre><code>ArrayList arr = new ArrayList();\n</code></pre>\n\n<p>If it was initialized on the stack, I don't have to worry about managing <code>arr</code>'s memory, but can I assume that its destructor will be called before the <code>arr</code> itself is somehow deallocated?</p>\n\n<p>If it was initialized on the heap, does calling <code>delete arr</code> call its destructor <em>and</em> deallocate <code>arr</code> itself?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "linux", "opengl", "valgrind"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1534959521, "post_id": 51972226, "comment_id": 90895162, "body": "How did you compile and link the library? How did you compile and link you program to the library? Also see <a href=\"http://valgrind.org/docs/manual/quick-start.html#quick-start.prepare\" rel=\"nofollow noreferrer\">The Valgrind Quick Start Guide</a> and pay attention to <i>&quot;Use of -O2 and above is not recommended as Memcheck occasionally reports uninitialised-value errors which don&#39;t really exist&quot;</i>."}, {"owner": {"reputation": 769, "user_id": 9200394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/bM4Ra.png?s=128&g=1", "display_name": "congard", "link": "https://stackoverflow.com/users/9200394/congard"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 1, "creation_date": 1534962484, "post_id": 51972226, "comment_id": 90896496, "body": "@Rabbid76 it returns pointer to the content of the file with null-terminator"}, {"owner": {"reputation": 761, "user_id": 7050476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c2df49356fac6994f4b447eb135c37?s=128&d=identicon&r=PG&f=1", "display_name": "afarah", "link": "https://stackoverflow.com/users/7050476/afarah"}, "edited": false, "score": 0, "creation_date": 1534965395, "post_id": 51972226, "comment_id": 90897818, "body": "Unrelated to your question, but I suggest checking for return codes instead of assuming that all functions succeed (for instance the IO functions)."}, {"owner": {"reputation": 769, "user_id": 9200394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/bM4Ra.png?s=128&g=1", "display_name": "congard", "link": "https://stackoverflow.com/users/9200394/congard"}, "edited": false, "score": 0, "creation_date": 1534965801, "post_id": 51972226, "comment_id": 90897992, "body": "It strange that the error message links to standard libraries"}, {"owner": {"reputation": 769, "user_id": 9200394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/bM4Ra.png?s=128&g=1", "display_name": "congard", "link": "https://stackoverflow.com/users/9200394/congard"}, "edited": false, "score": 1, "creation_date": 1534967929, "post_id": 51972226, "comment_id": 90898931, "body": "I tested it, and all the programs that use OpenGL have the same errors. But in that case, how can I find a leak specifically in my code? Are there any analogues of Valgrind?"}], "owner": {"reputation": 769, "user_id": 9200394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/bM4Ra.png?s=128&g=1", "display_name": "congard", "link": "https://stackoverflow.com/users/9200394/congard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 759, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1534962680, "creation_date": 1534958929, "last_edit_date": 1534962680, "question_id": 51972226, "link": "https://stackoverflow.com/questions/51972226/valgrind-and-opengl", "title": "Valgrind and OpenGL", "body": "<p>I wrote a simple OpenGL application and decided to test it using valgrind. And received the following messages:</p>\n\n<pre><code>==14679== Memcheck, a memory error detector\n==14679== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==14679== Using Valgrind-3.12.0.SVN and LibVEX; rerun with -h for copyright info\n==14679== Command: ./out/main.o\n==14679==\nStarting GLFW context, OpenGL 3.3\n==14679== Conditional jump or move depends on uninitialised value(s)\n==14679==    at 0x4C32EA6: rawmemchr (vg_replace_strmem.c:1402)\n==14679==    by 0x63283C1: _IO_str_init_static_internal (strops.c:41)\n==14679==    by 0x631BB96: vsscanf (iovsscanf.c:40)\n==14679==    by 0x6316306: sscanf (sscanf.c:32)\n==14679==    by 0x94B9E4A: ??? (in /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0)\n==14679==    by 0x94BA182: ??? (in /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0)\n==14679==    by 0x94BDBF8: drmGetDevice (in /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0)\n==14679==    by 0x57EE2D6: ??? (in /usr/lib/mesa-diverted/x86_64-linux-gnu/libGL.so.1.2.0)\n==14679==    by 0x57ED694: ??? (in /usr/lib/mesa-diverted/x86_64-linux-gnu/libGL.so.1.2.0)\n==14679==    by 0x57C1988: ??? (in /usr/lib/mesa-diverted/x86_64-linux-gnu/libGL.so.1.2.0)\n==14679==    by 0x57BCF10: glXQueryVersion (in /usr/lib/mesa-diverted/x86_64-linux-gnu/libGL.so.1.2.0)\n==14679==    by 0x50943F9: ??? (in /usr/lib/x86_64-linux-gnu/libglfw.so.3.2)\n==14679==\n==14679==\n==14679== HEAP SUMMARY:\n==14679==     in use at exit: 45,107 bytes in 460 blocks\n==14679==   total heap usage: 18,068 allocs, 17,608 frees, 30,350,802 bytes allocated\n==14679==\n==14679== LEAK SUMMARY:\n==14679==    definitely lost: 448 bytes in 1 blocks\n==14679==    indirectly lost: 1,773 bytes in 14 blocks\n==14679==      possibly lost: 0 bytes in 0 blocks\n==14679==    still reachable: 42,886 bytes in 445 blocks\n==14679==         suppressed: 0 bytes in 0 blocks\n==14679== Rerun with --leak-check=full to see details of leaked memory\n==14679==\n==14679== For counts of detected and suppressed errors, rerun with: -v\n==14679== Use --track-origins=yes to see where uninitialised values come from\n==14679== ERROR SUMMARY: 9 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>With what it can be connected, and whether it is necessary to me to worry?</p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>My C++ code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"utils/shader_utils.h\"\n\n#include &lt;GL/glew.h&gt;\n#include &lt;GLFW/glfw3.h&gt;\n\n#include &lt;glm/vec4.hpp&gt;\n\n// Window dimensions\nconst GLuint WIDTH = 800, HEIGHT = 600;\n\n// Shaders\nconst char *vertexShader = \"src/resources/shaders/vertex_shader.glsl\";\nconst char *fragmentShader = \"src/resources/shaders/fragment_shader.glsl\";\nconst char *vertexShaderSource, *fragmentShaderSource;\n\nint main() {\n    std::cout &lt;&lt; \"Starting GLFW context, OpenGL 3.3\" &lt;&lt; std::endl;\n    // Init GLFW\n    glfwInit();\n    // Set all the required options for GLFW\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);\n    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\n    glfwWindowHint(GLFW_RESIZABLE, GL_FALSE);\n\n    // Create a GLFWwindow object that we can use for GLFW's functions\n    GLFWwindow* window = glfwCreateWindow(WIDTH, HEIGHT, \"OpenGL\", nullptr, nullptr);\n    glfwMakeContextCurrent(window);\n\n    // Set the required callback functions\n    glfwSetKeyCallback(window, key_callback);\n\n    glewInit();\n\n    glEnable(GL_DEPTH_TEST);\n    glDepthMask(true);\n\n    int width, height;\n    glfwGetFramebufferSize(window, &amp;width, &amp;height);\n    glViewport(0, 0, width, height);\n\n    vertexShaderSource = readShader(vertexShader);\n    fragmentShaderSource = readShader(fragmentShader);\n\n    GLuint vertexShader = compileShader(vertexShaderSource, GL_VERTEX_SHADER);\n    // Fragment shader\n    GLuint fragmentShader = compileShader(fragmentShaderSource, GL_FRAGMENT_SHADER);\n    // Link shaders\n    GLuint shaderProgram = createProgram(vertexShader, fragmentShader);\n    glLinkProgram(shaderProgram);\n    // Check for linking errors\n    //getProgramInfoLog(shaderProgram, GL_LINK_STATUS);\n    glDeleteShader(vertexShader);\n    glDeleteShader(fragmentShader);\n\n    GLuint VertexArrayID;\n    glGenVertexArrays(1, &amp;VertexArrayID);\n    glBindVertexArray(VertexArrayID);\n\n    static const GLfloat vertices[] = {\n        -1.0f, -1.0f, -0.5f,\n        1.0f, -1.0f, -0.5f,\n        0.0f,  1.0f, -0.5f,\n\n        -0.5f, -0.5f, -0.6f,\n        0.5f, -0.5f, -0.6f,\n        1,  0.0f, -0.6f,\n    };\n\n    GLuint vertexbuffer;\n    glGenBuffers(1, &amp;vertexbuffer);\n    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n\n    while (!glfwWindowShouldClose(window)) {\n        glfwPollEvents();\n\n        glClearColor(0.2f, 0.3f, 0.3f, 1.0f);\n        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\n        glUseProgram(shaderProgram);\n        glEnableVertexAttribArray(0);\n\n        su::pointer(0, 3, vertexbuffer);\n\n        su::setVec3(glGetUniformLocation(shaderProgram, \"in_color\"), glm::vec3(1, 0, 0));\n        glDrawArrays(GL_TRIANGLES, 0, 3);\n        su::setVec3(glGetUniformLocation(shaderProgram, \"in_color\"), glm::vec3(0, 1, 0));\n        glDrawArrays(GL_TRIANGLES, 3, 3);\n\n        glDisableVertexAttribArray(0);\n\n        glfwSwapBuffers(window);\n    }\n    // Properly de-allocate all resources once they've outlived their purpose\n    glDeleteBuffers(1, &amp;vertexbuffer);\n    glDeleteVertexArrays(1, &amp;VertexArrayID);\n    // Terminate GLFW, clearing any resources allocated by GLFW.\n    glfwTerminate();\n\n    delete[] vertexShaderSource;\n    delete[] fragmentShaderSource;\n\n    return 0;\n}\n</code></pre>\n\n<p>Also, when I try get info log (using <code>glGetShaderInfoLog(shader, size, NULL, buff)</code>) I've got messages:</p>\n\n<pre><code>==16571== Conditional jump or move depends on uninitialised value(s)\n==16571==    at 0x4C2EDA9: strlen (vg_replace_strmem.c:454)\n==16571==    by 0x5B22888: std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::operator&lt;&lt; &lt;std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.22)\n==16571== Conditional jump or move depends on uninitialised value(s)\n==16571==    at 0x6324F29: _IO_file_xsputn@@GLIBC_2.2.5 (fileops.c:1309)\n==16571==    by 0x631A0AA: fwrite (iofwrite.c:39)\n==16571==    by 0x5B2258D: std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::__ostream_insert&lt;char, std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;, char const*, long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.22)\n==16571==    by 0x5B22896: std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::operator&lt;&lt; &lt;std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;, char const*) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.22)\n</code></pre>\n\n<p>And other similar errors</p>\n\n<p>Compilation: </p>\n\n<pre><code>g++ src/main.cpp -o out/main.o `pkg-config --libs glfw3 glew`\n</code></pre>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>How do I get real data about a memory leak in my application? Accept <strong>448</strong> as zero?</p>\n\n<p><strong>EDIT 3:</strong></p>\n\n<p>My <code>readShader</code> function:</p>\n\n<pre><code>char *readShader(const char *path) {\n    FILE *file = fopen(path, \"rb\");\n    fseek(file, 0, SEEK_END);\n    size_t size = ftell(file);\n    fseek(file, 0, SEEK_SET);\n    char *result = new char[size + 1];\n    fseek(file, 0, SEEK_SET);\n    fread(result, 1, size, file);\n    fclose(file);\n    result[size] = '\\0';\n    return result;\n}\n</code></pre>\n\n<p>I will be grateful for help</p>\n"}, {"tags": ["c++", "boost", "buffer", "polygon", "boost-geometry"], "answers": [{"comments": [{"owner": {"reputation": 959, "user_id": 888379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/14e6b3a51d70f73bfb9ff0c91046aa20?s=128&d=identicon&r=PG", "display_name": "user888379", "link": "https://stackoverflow.com/users/888379/user888379"}, "edited": false, "score": 0, "creation_date": 1534968186, "post_id": 51973023, "comment_id": 90899034, "body": "That&#39;s very helpful, thank you! I&#39;m going to wait a little longer before accepting this answer, in case there&#39;s an approach that doesn&#39;t create the extraneous points."}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 2, "last_activity_date": 1534962369, "creation_date": 1534962369, "answer_id": 51973023, "question_id": 51972119, "link": "https://stackoverflow.com/questions/51972119/redundant-vertices-when-scaling-polygon-with-boost-geometry-buffer/51973023#51973023", "title": "Redundant vertices when scaling polygon with boost geometry buffer", "body": "<p>Boost contains <code>simplify</code> algorithm (it uses <a href=\"https://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm\" rel=\"nofollow noreferrer\">Ramer\u2013Douglas\u2013Peucker algorithm</a>). For example in your polygon there are 3 points <code>p1,p2,p3</code>, we calculate the distance between point <code>p2</code> and the line <code>|p1p3|</code> , if this distance is less than the given <code>epsilon</code> value , <code>p2</code> point is removed from polygon. So if you use this function with very small value of <code>epsilon</code> (to remove <em>collinear points</em>) you can remove all redundant points from all edges your polygon. Try this</p>\n\n<pre><code>mpolygon_t out; // to hold new geometry\nboost::geometry::simplify(expanded_mpoly,out,0.00001); // very small epsilon value\nauto list_coordinates = [](const point_t&amp; pt) {\n                            std::cout.precision(std::numeric_limits&lt;double&gt;::max_digits10);\n                            std::cout &lt;&lt; \"vertex(\" &lt;&lt; get&lt;0&gt;(pt)\n                                      &lt;&lt; \", \" &lt;&lt; get&lt;1&gt;(pt) &lt;&lt; \")\" &lt;&lt; std::endl;\n                        };\nboost::geometry::for_each_point(out, list_coordinates); // print out\n</code></pre>\n\n<p>as output you see</p>\n\n<pre><code>vertex(9, 9)\nvertex(9, 4)\nvertex(4, 4)\nvertex(4, 9)\nvertex(9, 9)\n</code></pre>\n"}], "owner": {"reputation": 959, "user_id": 888379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/14e6b3a51d70f73bfb9ff0c91046aa20?s=128&d=identicon&r=PG", "display_name": "user888379", "link": "https://stackoverflow.com/users/888379/user888379"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 51973023, "answer_count": 1, "score": 1, "last_activity_date": 1556217624, "creation_date": 1534958459, "last_edit_date": 1556217624, "question_id": 51972119, "link": "https://stackoverflow.com/questions/51972119/redundant-vertices-when-scaling-polygon-with-boost-geometry-buffer", "title": "Redundant vertices when scaling polygon with boost geometry buffer", "body": "<p>I'm using boost geometry to manage some polygons, and I need to both expand and shrink them by given amounts. I'm using boost::geometry::buffer to accomplish this, and I'm wondering if there's a better alternative. My concern is that if I expand, say, a rectangle I end up with a polygon with 12 vertices (8 of them being irrelevant). Here's some sample code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/geometry.hpp&gt;\n#include &lt;boost/geometry/geometries/geometries.hpp&gt;\n#include &lt;boost/geometry/geometries/point_xy.hpp&gt;\n\nusing point_t = boost::geometry::model::d2::point_xy&lt;double&gt;;\nusing polygon_t = boost::geometry::model::polygon&lt;point_t&gt;;\nusing mpolygon_t = boost::geometry::model::multi_polygon&lt;polygon_t&gt;;\n\nmpolygon_t expand_polygon(const polygon_t&amp; polygon,\n                          const double distance) {\n    mpolygon_t scaled_polygon;\n    // DistanceStrategy is symmetric; want straight lines (no curves)\n    boost::geometry::strategy::buffer::distance_symmetric&lt;double&gt;\n      distance_strategy{distance};\n\n    // SideStrategy is straight; grow equally on all sides\n    boost::geometry::strategy::buffer::side_straight side_strategy;\n\n    // JoinStrategy is miter; 1.0 as limit; Sharp (not rounded) joins\n    boost::geometry::strategy::buffer::join_miter join_strategy;\n\n    // EndStrategy is flat; flat (not rounded) ends\n    boost::geometry::strategy::buffer::end_flat end_strategy;\n\n    // PointStrategy is square; squares, not circles, if poly is just a point\n    boost::geometry::strategy::buffer::point_square point_strategy;\n\n    boost::geometry::buffer(polygon, scaled_polygon,\n                            distance_strategy,\n                            side_strategy,\n                            join_strategy,\n                            end_strategy,\n                            point_strategy);\n\n    // return scaled polygon offset by supplied distance\n    return scaled_polygon;\n}\n\nint main() {\n    using boost::geometry::get;\n    polygon_t rect;\n    boost::geometry::read_wkt(\"POLYGON((5 5,5 8,8 8,8 5, 5 5))\", rect);\n    mpolygon_t expanded_mpoly = expand_polygon(rect, 1.0);\n    auto list_coordinates = [](const point_t&amp; pt) {\n                                std::cout.precision(std::numeric_limits&lt;double&gt;::max_digits10);\n                                std::cout &lt;&lt; \"vertex(\" &lt;&lt; get&lt;0&gt;(pt)\n                                          &lt;&lt; \", \" &lt;&lt; get&lt;1&gt;(pt) &lt;&lt; \")\" &lt;&lt; std::endl;\n                            };\n    boost::geometry::for_each_point(expanded_mpoly, list_coordinates);\n\n    return 0;\n}\n</code></pre>\n\n<p>And here's the output:</p>\n\n<pre><code>vertex(4, 5)\nvertex(4, 8)\nvertex(4, 9)\nvertex(5, 9)\nvertex(8, 9)\nvertex(9, 9)\nvertex(9, 8)\nvertex(9, 5)\nvertex(9, 4)\nvertex(8, 4)\nvertex(5, 4)\nvertex(4, 4)\nvertex(4, 5)\n</code></pre>\n\n<p>Is there a strategy argument that I need to provide? Some other fiefdom of boost I should be looking at?</p>\n"}, {"tags": ["c++", "eigen", "spectra"], "answers": [{"comments": [{"owner": {"reputation": 110, "user_id": 1756478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e76b7ad3cd5be460f858b1febd6a4d21?s=128&d=identicon&r=PG", "display_name": "gsarret", "link": "https://stackoverflow.com/users/1756478/gsarret"}, "edited": false, "score": 0, "creation_date": 1615404874, "post_id": 51974484, "comment_id": 117683245, "body": "It has changed further since 2018. Now, the correct syntax is <code>Spectra::SparseGenMatProd&lt;double, Eigen::Lower, Eigen::RowMajor&gt; op(M)</code>. See this <a href=\"https://github.com/yixuan/spectra/issues/97\" rel=\"nofollow noreferrer\">issue</a>.  Same goes for <code>Spectra::SparseSymMatProd</code> etc."}], "tags": [], "owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "is_accepted": true, "score": 2, "last_activity_date": 1534969036, "creation_date": 1534969036, "answer_id": 51974484, "question_id": 51972117, "link": "https://stackoverflow.com/questions/51972117/c-spectra-with-rowmajor-sparse-matrix/51974484#51974484", "title": "C++ Spectra with RowMajor sparse matrix", "body": "<p>The API of <code>SparseGenMatProd</code> seems to be quite misleading. Looks like you have to specify you are dealing with row-major matrices through the second template parameter:</p>\n\n<pre><code>SparseGenMatProd&lt;double,RowMajor&gt; op(M);\n</code></pre>\n\n<p>otherwise <code>M</code> is implicitly converted to a temporary column-major matrix which is then stored by const reference by <code>op</code> but this temporary is dead right after that line of code.</p>\n"}], "owner": {"reputation": 23, "user_id": 9932663, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SCp_WRn7hoc/AAAAAAAAAAI/AAAAAAAAACg/6pp84KJOVcM/photo.jpg?sz=128", "display_name": "Jorge Barreras Cortes", "link": "https://stackoverflow.com/users/9932663/jorge-barreras-cortes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 1, "accepted_answer_id": 51974484, "answer_count": 1, "score": 2, "last_activity_date": 1534969036, "creation_date": 1534958435, "question_id": 51972117, "link": "https://stackoverflow.com/questions/51972117/c-spectra-with-rowmajor-sparse-matrix", "title": "C++ Spectra with RowMajor sparse matrix", "body": "<p>I'm trying to use the Spectra 3.5 Library on my Linux machine, and the SparseGenMatProd wrapper for the Matrix-Vector multiplication only seems to work when the sparse matrix is in ColMajor format. Is this normal behavior and if so, how can I fix it to take RowMajor format? I've included a basic example where the output is \"Segmentation fault (core dumped)\". I've gone through several other posts and the documentation, but can't seem to find an answer.</p>\n\n<pre><code>#include &lt;Eigen/Core&gt;\n#include &lt;Eigen/SparseCore&gt;\n#include &lt;GenEigsSolver.h&gt;\n#include &lt;MatOp/SparseGenMatProd.h&gt;\n#include &lt;iostream&gt;\n\nusing namespace Spectra;\n\nint main()\n{\n    // A band matrix with 1 on the main diagonal, 2 on the below-main subdiagonal,\n    // and 3 on the above-main subdiagonal\n    const int n = 10;\n    Eigen::SparseMatrix&lt;double, Eigen::RowMajor&gt; M(n, n);\n    M.reserve(Eigen::VectorXi::Constant(n, 3));\n    for(int i = 0; i &lt; n; i++)\n    {\n        M.insert(i, i) = 1.0;\n        if(i &gt; 0)\n            M.insert(i - 1, i) = 3.0;\n        if(i &lt; n - 1)\n            M.insert(i + 1, i) = 2.0;\n    }\n\n    // Construct matrix operation object using the wrapper class SparseGenMatProd\n    SparseGenMatProd&lt;double&gt; op(M);\n\n    // Construct eigen solver object, requesting the largest three eigenvalues\n    GenEigsSolver&lt; double, LARGEST_MAGN, SparseGenMatProd&lt;double&gt; &gt; eigs(&amp;op, 3, 6);\n\n    // Initialize and compute\n    eigs.init();\n    int nconv = eigs.compute();\n\n    // Retrieve results\n    Eigen::VectorXcd evalues;\n    if(eigs.info() == SUCCESSFUL)\n        evalues = eigs.eigenvalues();\n\n    std::cout &lt;&lt; *emphasized text*\"Eigenvalues found:\\n\" &lt;&lt; evalues &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>If you change line 15 to:</p>\n\n<pre><code>Eigen::SparseMatrix&lt;double, Eigen::ColMajor&gt; M(n, n);\n</code></pre>\n\n<p>it will work as expected.  </p>\n\n<p>Currently I'm working around this and converting my matrices to ColMajor, but I'd like to understand what's going on. Any help is much appreciated. </p>\n"}, {"tags": ["c++", "boost"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8565751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014c67e23b2b05e2652dd73b41e78f50?s=128&d=identicon&r=PG&f=1", "display_name": "Knotwood V", "link": "https://stackoverflow.com/users/8565751/knotwood-v"}, "edited": false, "score": 0, "creation_date": 1534958875, "post_id": 51972123, "comment_id": 90894864, "body": "Thank you, this help a lot, am just getting to grip with boost and c++ ,"}, {"owner": {"reputation": 51, "user_id": 8565751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014c67e23b2b05e2652dd73b41e78f50?s=128&d=identicon&r=PG&f=1", "display_name": "Knotwood V", "link": "https://stackoverflow.com/users/8565751/knotwood-v"}, "edited": false, "score": 0, "creation_date": 1534959382, "post_id": 51972123, "comment_id": 90895096, "body": "is there a way to iterator only for folders / directory in boost  could i do something like :  directory_iterator it{is_directory(p)};"}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "reply_to_user": {"reputation": 51, "user_id": 8565751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014c67e23b2b05e2652dd73b41e78f50?s=128&d=identicon&r=PG&f=1", "display_name": "Knotwood V", "link": "https://stackoverflow.com/users/8565751/knotwood-v"}, "edited": false, "score": 0, "creation_date": 1534959568, "post_id": 51972123, "comment_id": 90895187, "body": "@KnotwoodV I doubt such a thing exists in boost::filesystem. What&#39;s wrong with iterating using a <code>directory_iterator</code> and checking for <code>is_directory(it-&gt;status())</code>?"}, {"owner": {"reputation": 51, "user_id": 8565751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014c67e23b2b05e2652dd73b41e78f50?s=128&d=identicon&r=PG&f=1", "display_name": "Knotwood V", "link": "https://stackoverflow.com/users/8565751/knotwood-v"}, "edited": false, "score": 0, "creation_date": 1534959871, "post_id": 51972123, "comment_id": 90895317, "body": "oh nothing, just though it would be smart to exclude any unwanted files from the outset rather than from within the iterator."}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "reply_to_user": {"reputation": 51, "user_id": 8565751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014c67e23b2b05e2652dd73b41e78f50?s=128&d=identicon&r=PG&f=1", "display_name": "Knotwood V", "link": "https://stackoverflow.com/users/8565751/knotwood-v"}, "edited": false, "score": 0, "creation_date": 1534960198, "post_id": 51972123, "comment_id": 90895482, "body": "@KnotwoodV If you are concerned about performance, I doubt it would make any difference - most low-level filesystem API&#39;s don&#39;t have the corresponding options, and the filesystems themselves are not optimized for that. From the code quality point of view, you could use a <code>filter_iterator</code> from Boost: <a href=\"https://www.boost.org/doc/libs/1_68_0/libs/iterator/doc/html/iterator/specialized/filter.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_68_0/libs/iterator/doc/html/iterator/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 8565751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014c67e23b2b05e2652dd73b41e78f50?s=128&d=identicon&r=PG&f=1", "display_name": "Knotwood V", "link": "https://stackoverflow.com/users/8565751/knotwood-v"}, "edited": false, "score": 0, "creation_date": 1534960400, "post_id": 51972123, "comment_id": 90895579, "body": "thank you, you have given me quite a lot to think about ! , much appreciated thanks again"}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "reply_to_user": {"reputation": 51, "user_id": 8565751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014c67e23b2b05e2652dd73b41e78f50?s=128&d=identicon&r=PG&f=1", "display_name": "Knotwood V", "link": "https://stackoverflow.com/users/8565751/knotwood-v"}, "edited": false, "score": 0, "creation_date": 1534960515, "post_id": 51972123, "comment_id": 90895643, "body": "@KnotwoodV Always happy to help."}], "tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": true, "score": 10, "last_activity_date": 1534958794, "last_edit_date": 1534958794, "creation_date": 1534958469, "answer_id": 51972123, "question_id": 51972061, "link": "https://stackoverflow.com/questions/51972061/c-boost-if-extension-this-would-mean-this-file-is-a-folder/51972123#51972123", "title": "c++ Boost if .extension() == &quot;&quot; this would mean this file is a folder?", "body": "<p>Files can exist without any extension, so this won't work.</p>\n\n<p>Have a look at <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/filesystem/doc/reference.html#is_directory\" rel=\"noreferrer\"><code>boost::filesystem::is_directory</code></a>.</p>\n\n<hr>\n\n<p>By the way, Boost.Filesystem library was <a href=\"https://en.cppreference.com/w/cpp/filesystem\" rel=\"noreferrer\">merged into C++17 standard</a>. So, if your compiler supports C++17, consider using the standard library for filesystem operations.</p>\n"}], "owner": {"reputation": 51, "user_id": 8565751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014c67e23b2b05e2652dd73b41e78f50?s=128&d=identicon&r=PG&f=1", "display_name": "Knotwood V", "link": "https://stackoverflow.com/users/8565751/knotwood-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 51972123, "answer_count": 1, "score": 2, "last_activity_date": 1534958794, "creation_date": 1534958219, "last_edit_date": 1534958415, "question_id": 51972061, "link": "https://stackoverflow.com/questions/51972061/c-boost-if-extension-this-would-mean-this-file-is-a-folder", "title": "c++ Boost if .extension() == &quot;&quot; this would mean this file is a folder?", "body": "<p>I just want to confirm that this would be a good method to allow me to only work only on folders, as i can see a way to just look for folder rather that files and folders .  </p>\n\n<pre><code>boost::filesystem::directory_iterator iterator(string(\".\"));\nfor (; iterator != boost::filesystem::directory_iterator(); ++iterator)\n{\n    if ((iterator-&gt;path().extension()) == \"\") { \n        cout &lt;&lt; (iterator-&gt;path().stem()) &lt;&lt;   endl; \n    };\n}\n</code></pre>\n"}, {"tags": ["c++", "linux", "compilation", "sdl"], "comments": [{"owner": {"reputation": 13904, "user_id": 106140, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/f976af5e820922c8ebc645e42f8e17a4?s=128&d=identicon&r=PG", "display_name": "Olivier Pons", "link": "https://stackoverflow.com/users/106140/olivier-pons"}, "edited": false, "score": 2, "creation_date": 1534957281, "post_id": 51971681, "comment_id": 90894128, "body": "Duplicate? Seriously? I thought Stackoverflow was here to help. If I have to check <b>each 12 suggestions</b> on the answer you redirect, I could do this on my own. Right now this is of 0/20 use. <b>0/20</b>. Even though it&#39;s very clean &amp; precise, this answer here <a href=\"https://stackoverflow.com/a/12573818/106140\">stackoverflow.com/a/12573818/106140</a> is of no use to me. Like someone said &quot;<b>And how to define where is my case?!</b>&quot;."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 6, "creation_date": 1534957343, "post_id": 51971681, "comment_id": 90894159, "body": "You are using symbols not defined by whatever you link with. That is your problem. The linked dupe explains that. Link with whatever implements what you use. And (<i>IMHO</i>) reading 20 answers and doing a little thinking yourself is pretty much equal to a solution. But <i>fine</i>, I&#39;ll retract it."}, {"owner": {"reputation": 4058, "user_id": 754407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1b5c51ae68d0d76ce0e178f777f1742d?s=128&d=identicon&r=PG", "display_name": "hauron", "link": "https://stackoverflow.com/users/754407/hauron"}, "edited": false, "score": 0, "creation_date": 1534957426, "post_id": 51971681, "comment_id": 90894213, "body": "@OlivierPons - try this: <a href=\"http://lazyfoo.net/tutorials/SDL/01_hello_SDL/linux/index.php\" rel=\"nofollow noreferrer\">lazyfoo.net/tutorials/SDL/01_hello_SDL/linux/index.php</a> (it&#39;s a pretty popular SDL tutorial, this exact link is to the setup part for Linux)"}, {"owner": {"reputation": 13904, "user_id": 106140, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/f976af5e820922c8ebc645e42f8e17a4?s=128&d=identicon&r=PG", "display_name": "Olivier Pons", "link": "https://stackoverflow.com/users/106140/olivier-pons"}, "edited": false, "score": 0, "creation_date": 1534957802, "post_id": 51971681, "comment_id": 90894393, "body": "I tried to move the link information at the end of the command: I changed <code>$(CXX) $(LNFLAGS) $(OBJECTS) -o $(TARGET)</code> to <code>$(CXX) $(OBJECTS) -o $(TARGET) $(LNFLAGS)</code> and it worked. I did like all my students do: <a href=\"https://en.wikipedia.org/wiki/Infinite_monkey_theorem\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Infinite_monkey_theorem</a> Trying random stuff..."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534958026, "post_id": 51971681, "comment_id": 90894494, "body": "@Olivier Pons Link order matters. You should always mention whatever <i>needs</i> a symbol before what <i>defines</i> the symbol. Otherwise the linker will just throw away the symbol since it is (to its mind) unused at that point. That&#39;s pretty basic and something that should be taught in an <i>introduction</i> C++ class (IMHO)."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 3, "creation_date": 1534958644, "post_id": 51971681, "comment_id": 90894772, "body": "@Oliver - Based on your problem description the dup was a good choice. All you provided was a lot of <i><code>undefined reference to Xxx</code></i> and <i><code>.....blabla.....</code></i>. You should be able to get better help if you provide more details. You are lacking compile and link commands and relevant makefile recipes. So you should not be surprised the suggestions were just as bad. If you just want to discuss things then maybe you should use <a href=\"https://chat.stackoverflow.com/\">chat.stackoverflow.com</a> until you are closer to your problem."}, {"owner": {"reputation": 13904, "user_id": 106140, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/f976af5e820922c8ebc645e42f8e17a4?s=128&d=identicon&r=PG", "display_name": "Olivier Pons", "link": "https://stackoverflow.com/users/106140/olivier-pons"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534959224, "post_id": 51971681, "comment_id": 90895034, "body": "@JesperJuhl Thank you very much for your answer. I&#39;m new to CPP world and I really dont want to go further than &quot;trying to compile, and understand what has been done to make the same in Python&quot;. I&#39;m sorry if I sound aggressive."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534960231, "post_id": 51971681, "comment_id": 90895500, "body": "Possible dupe (In <i>My</i> Opinion): <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix#12573818\" title=\"what is an undefined reference unresolved external symbol error and how do i fix%2312573818\">stackoverflow.com/questions/12573816/&hellip;</a>"}, {"owner": {"reputation": 595, "user_id": 8955213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a3d58041804424b289740eb0bf4cb6b?s=128&d=identicon&r=PG&f=1", "display_name": "Shades", "link": "https://stackoverflow.com/users/8955213/shades"}, "edited": false, "score": 0, "creation_date": 1534960546, "post_id": 51971681, "comment_id": 90895660, "body": "@OlivierPons If it is of any help at all, when I set up SDL, none of the tutorials worked for me either. So I screwed them, sat down on my IDE and tried to figure it out without them. I found out that you don&#39;t have to compile any of the libraries. In Xcode at least, you just make sure that the required SDL frameworks are under &quot;Linked Libraries and Frameworks&quot; include the SDL header files and then you&#39;re done and ready to start coding."}], "answers": [{"comments": [{"owner": {"reputation": 13904, "user_id": 106140, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/f976af5e820922c8ebc645e42f8e17a4?s=128&d=identicon&r=PG", "display_name": "Olivier Pons", "link": "https://stackoverflow.com/users/106140/olivier-pons"}, "edited": false, "score": 0, "creation_date": 1535053377, "post_id": 51975642, "comment_id": 90935969, "body": "Thank you very much indeed! That&#39;s more than I could expect!! Did you try to share/apply this patch on the github repo?"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "reply_to_user": {"reputation": 13904, "user_id": 106140, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/f976af5e820922c8ebc645e42f8e17a4?s=128&d=identicon&r=PG", "display_name": "Olivier Pons", "link": "https://stackoverflow.com/users/106140/olivier-pons"}, "edited": false, "score": 0, "creation_date": 1535053776, "post_id": 51975642, "comment_id": 90936149, "body": "@OlivierPons: Nope, didn&#39;t try to upstream it.  Feel free!"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "reply_to_user": {"reputation": 13904, "user_id": 106140, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/f976af5e820922c8ebc645e42f8e17a4?s=128&d=identicon&r=PG", "display_name": "Olivier Pons", "link": "https://stackoverflow.com/users/106140/olivier-pons"}, "edited": false, "score": 0, "creation_date": 1535054086, "post_id": 51975642, "comment_id": 90936290, "body": "@OlivierPons: Looks like Debian already <a href=\"https://sources.debian.org/patches/einstein/2.0.dfsg.2-9/01_sdl.diff/\" rel=\"nofollow noreferrer\">has</a> some <a href=\"https://sources.debian.org/patches/einstein/2.0.dfsg.2-9/15_ld-as-needed.diff/\" rel=\"nofollow noreferrer\">patches</a> for the issues I identified.  Looks like <a href=\"https://github.com/ptitSeb/einstein-puzzle\" rel=\"nofollow noreferrer\">ptitSeb&#39;s fork</a> already has a lot of them applied, as well as some SDL2 porting effort."}, {"owner": {"reputation": 13904, "user_id": 106140, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/f976af5e820922c8ebc645e42f8e17a4?s=128&d=identicon&r=PG", "display_name": "Olivier Pons", "link": "https://stackoverflow.com/users/106140/olivier-pons"}, "edited": false, "score": 0, "creation_date": 1535054472, "post_id": 51975642, "comment_id": 90936469, "body": "Wow, didn&#39;t notice that, and the <code>make</code> did work right out of the box! Thank you very much for all the work here, that&#39;s much appreciated!"}], "tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": true, "score": 1, "last_activity_date": 1534974839, "last_edit_date": 1534974839, "creation_date": 1534974525, "answer_id": 51975642, "question_id": 51971681, "link": "https://stackoverflow.com/questions/51971681/how-to-link-with-sdl-library/51975642#51975642", "title": "How to link with SDL library?", "body": "<p>That appears to be a SDL 1.2 project.  No need for all of those SDL2 packages.</p>\n\n<p>Multiple problems with that project:</p>\n\n<ul>\n<li><p>The <code>Makefile</code> should be using <a href=\"https://en.wikipedia.org/wiki/Pkg-config\" rel=\"nofollow noreferrer\"><code>pkg-config</code></a> on Linux (or generated by something more meta like CMake) instead of a mishmash of <code>sdl-config</code> and raw <code>-l</code> flags.  Fixed:</p>\n\n<pre><code>CXXFLAGS=-pipe -Wall $(OPTIMIZE) $(DEBUG) `pkg-config --cflags sdl SDL_mixer SDL_ttf zlib` -DPREFIX=L\\\"$(PREFIX)\\\" $(PROFILER)\nLNFLAGS=`pkg-config --libs sdl SDL_mixer SDL_ttf zlib` $(PROFILER)\n</code></pre></li>\n<li><p>The <code>$(TARGET)</code> linker options were in the wrong location (before <code>$(OBJECTS)</code>).  Fixed:</p>\n\n<pre><code>$(TARGET): $(OBJECTS)\n    $(CXX) $(OBJECTS) $(LNFLAGS) -o $(TARGET)\n</code></pre></li>\n<li><p>All of the <code>#include &lt;SDL/*&gt;</code> lines should have the leading <code>SDL/</code> stripped; <code>pkg-config --cflags</code> generates <code>-I/usr/include/SDL</code>, not <code>-I/usr/include</code>.</p></li>\n</ul>\n\n<p>With all of those fixes applied it builds on this Ubuntu 16.04 install.</p>\n\n<p>Full patch:</p>\n\n<pre><code>diff --git a/Makefile b/Makefile\nindex e682bb1..08f5463 100644\n--- a/Makefile\n+++ b/Makefile\n@@ -16,8 +16,8 @@ PREFIX=/usr/local\n OPTIMIZE=#-O6 -march=pentium4 -mfpmath=sse -fomit-frame-pointer -funroll-loops\n PROFILER=#-pg\n DEBUG=#-ggdb\n-CXXFLAGS=-pipe -Wall $(OPTIMIZE) $(DEBUG) `sdl-config --cflags` -DPREFIX=L\\\"$(PREFIX)\\\" $(PROFILER)\n-LNFLAGS=-pipe -lSDL_ttf -lfreetype `sdl-config --libs` -lz -lSDL_mixer $(PROFILER)\n+CXXFLAGS=-pipe -Wall $(OPTIMIZE) $(DEBUG) `pkg-config --cflags sdl SDL_mixer SDL_ttf zlib` -DPREFIX=L\\\"$(PREFIX)\\\" $(PROFILER)\n+LNFLAGS=`pkg-config --libs sdl SDL_mixer SDL_ttf zlib` $(PROFILER)\n INSTALL=install\n\n TARGET=einstein\n@@ -49,7 +49,7 @@ all: $(TARGET)\n\n\n $(TARGET): $(OBJECTS)\n-   $(CXX) $(LNFLAGS) $(OBJECTS) -o $(TARGET)\n+   $(CXX) $(OBJECTS) $(LNFLAGS) -o $(TARGET)\n\n clean:\n    rm -f $(OBJECTS) core* *core $(TARGET) *~\ndiff --git a/font.h b/font.h\nindex 40d617b..2e8e44d 100644\n--- a/font.h\n+++ b/font.h\n@@ -3,7 +3,7 @@\n\n\n #include &lt;string&gt;\n-#include &lt;SDL/SDL_ttf.h&gt;\n+#include &lt;SDL_ttf.h&gt;\n\n\n class Font\ndiff --git a/iconset.h b/iconset.h\nindex 4faf055..0f971ac 100644\n--- a/iconset.h\n+++ b/iconset.h\n@@ -2,7 +2,7 @@\n #define __ICONSET_H__\n\n\n-#include &lt;SDL/SDL.h&gt;\n+#include &lt;SDL.h&gt;\n\n\n class IconSet\ndiff --git a/main.cpp b/main.cpp\nindex d103861..2d4c33f 100644\n--- a/main.cpp\n+++ b/main.cpp\n@@ -1,8 +1,8 @@\n #include &lt;stdlib.h&gt;\n #include &lt;iostream&gt;\n-#include &lt;SDL/SDL.h&gt;\n-#include &lt;SDL/SDL_main.h&gt;\n-#include &lt;SDL/SDL_ttf.h&gt;\n+#include &lt;SDL.h&gt;\n+#include &lt;SDL_main.h&gt;\n+#include &lt;SDL_ttf.h&gt;\n #include \"main.h\"\n #include \"utils.h\"\n #include \"storage.h\"\ndiff --git a/screen.cpp b/screen.cpp\nindex a64dd31..7e48934 100644\n--- a/screen.cpp\n+++ b/screen.cpp\n@@ -1,4 +1,4 @@\n-#include &lt;SDL/SDL.h&gt;\n+#include &lt;SDL.h&gt;\n #include \"screen.h\"\n #include \"exceptions.h\"\n #include \"unicode.h\"\ndiff --git a/screen.h b/screen.h\nindex 12e99ab..2b5253d 100644\n--- a/screen.h\n+++ b/screen.h\n@@ -2,7 +2,7 @@\n #define __SCREEN_H__\n\n\n-#include \"SDL/SDL.h\"\n+#include \"SDL.h\"\n #include &lt;vector&gt;\n #include &lt;list&gt;\n\ndiff --git a/sound.cpp b/sound.cpp\nindex 3725245..998245f 100644\n--- a/sound.cpp\n+++ b/sound.cpp\n@@ -1,7 +1,7 @@\n #include \"sound.h\"\n\n #include &lt;iostream&gt;\n-#include &lt;SDL/SDL_events.h&gt;\n+#include &lt;SDL_events.h&gt;\n #include \"resources.h\"\n\n\ndiff --git a/sound.h b/sound.h\nindex 44e587e..dc2a449 100644\n--- a/sound.h\n+++ b/sound.h\n@@ -4,7 +4,7 @@\n\n #include &lt;string&gt;\n #include &lt;map&gt;\n-#include &lt;SDL/SDL_mixer.h&gt;\n+#include &lt;SDL_mixer.h&gt;\n\n\n class Sound\ndiff --git a/utils.h b/utils.h\nindex f4188cb..9ce7cb1 100644\n--- a/utils.h\n+++ b/utils.h\n@@ -1,7 +1,7 @@\n #ifndef __UTILS_H__\n #define __UTILS_H__\n\n-#include &lt;SDL/SDL.h&gt;\n+#include &lt;SDL.h&gt;\n #include &lt;string&gt;\n #ifdef WIN32\n #include &lt;sys/time.h&gt;\ndiff --git a/widgets.h b/widgets.h\nindex ce417ba..0bd7753 100644\n--- a/widgets.h\n+++ b/widgets.h\n@@ -4,7 +4,7 @@\n #include &lt;string&gt;\n #include &lt;list&gt;\n #include &lt;set&gt;\n-#include &lt;SDL/SDL.h&gt;\n+#include &lt;SDL.h&gt;\n #include \"font.h\"\n</code></pre>\n"}], "owner": {"reputation": 13904, "user_id": 106140, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/f976af5e820922c8ebc645e42f8e17a4?s=128&d=identicon&r=PG", "display_name": "Olivier Pons", "link": "https://stackoverflow.com/users/106140/olivier-pons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 51975642, "answer_count": 1, "score": -2, "last_activity_date": 1534974839, "creation_date": 1534956736, "question_id": 51971681, "link": "https://stackoverflow.com/questions/51971681/how-to-link-with-sdl-library", "title": "How to link with SDL library?", "body": "<p>Under Linux/Mint, I'm trying to compile this source code <a href=\"https://github.com/lksj/einstein-puzzle\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I got a lot of \"<code>undefined reference to Xxx</code>\" so after googling for a while, here are all the things I've installed:</p>\n\n<pre><code>sudo apt-get install libboost-all-dev libsdl1.2-dev libsdl-image1.2-dev libsdl-net1.2-dev\nsudo apt-get install libsdl-ttf2.0-dev libspeexdsp-dev libzzip-dev\nsudo apt-get install libavcodec-dev libavformat-dev libavutil-dev libswscale-dev\nsudo apt-get install libsdl-mixer1.2-dev libsdl2-dev libsdl2-mixer-dev libsdl2-image-dev\n</code></pre>\n\n<p>After this, when I try to launch <code>make</code> I <em>still</em> get tons of <code>undefined reference</code>:</p>\n\n<pre><code>.....blabla..........\nfont.cpp:(.text+0x388): undefined reference to `TTF_RenderUNICODE_Blended'\nfont.cpp:(.text+0x3ec): undefined reference to `SDL_UpperBlit'\nfont.cpp:(.text+0x3f8): undefined reference to `SDL_FreeSurface'\nfont.cpp:(.text+0x42a): undefined reference to `TTF_RenderUNICODE_Blended'\nfont.cpp:(.text+0x488): undefined reference to `SDL_UpperBlit'\nfont.cpp:(.text+0x494): undefined reference to `SDL_FreeSurface'\nfont.o: In function `Font::getWidth(std::__cxx11::basic_string&lt;wchar_t, std::char_traits&lt;wchar_t&gt;, std::allocator&lt;wchar_t&gt; &gt; const&amp;)':\nfont.cpp:(.text+0x566): undefined reference to `TTF_SizeUNICODE'\nfont.o: In function `Font::getWidth(wchar_t)':\nfont.cpp:(.text+0x5cc): undefined reference to `TTF_GlyphMetrics'\nfont.o: In function `Font::getHeight(std::__cxx11::basic_string&lt;wchar_t, std::char_traits&lt;wchar_t&gt;, std::allocator&lt;wchar_t&gt; &gt; const&amp;)':\nfont.cpp:(.text+0x634): undefined reference to `TTF_SizeUNICODE'\nfont.o: In function `Font::getSize(std::__cxx11::basic_string&lt;wchar_t, std::char_traits&lt;wchar_t&gt;, std::allocator&lt;wchar_t&gt; &gt; const&amp;, int&amp;, int&amp;)':\nfont.cpp:(.text+0x691): undefined reference to `TTF_SizeUNICODE'\ntopscores.o: In function `ScoresWindow::ScoresWindow(int, int, TopScores*, int)':\ntopscores.cpp:(.text+0xc85): undefined reference to `SDL_SetClipRect'\ntopscores.cpp:(.text+0xce9): undefined reference to `SDL_SetClipRect'\nsound.o: In function `Sound::Sound()':\nsound.cpp:(.text+0x48): undefined reference to `Mix_OpenAudio'\nsound.o: In function `Sound::~Sound()':\nsound.cpp:(.text+0xd1): undefined reference to `Mix_CloseAudio'\nsound.cpp:(.text+0x128): undefined reference to `Mix_FreeChunk'\nsound.cpp:(.text+0x140): undefined reference to `Mix_CloseAudio'\nsound.o: In function `Sound::play(std::__cxx11::basic_string&lt;wchar_t, std::char_traits&lt;wchar_t&gt;, std::allocator&lt;wchar_t&gt; &gt; const&amp;)':\nsound.cpp:(.text+0x269): undefined reference to `SDL_RWFromMem'\nsound.cpp:(.text+0x276): undefined reference to `Mix_LoadWAV_RW'\nsound.cpp:(.text+0x2d5): undefined reference to `Mix_VolumeChunk'\nsound.cpp:(.text+0x2f0): undefined reference to `Mix_PlayChannelTimed'\nsound.cpp:(.text+0x2f5): undefined reference to `SDL_PumpEvents'\ncollect2: error: ld returned 1 exit status\nMakefile:52: recipe for target 'einstein' failed\nmake: *** [einstein] Error 1\n</code></pre>\n\n<p>Watching the Makefile (which is quite easy to understand), when I launch <code>sdl-config --libs</code> I get <code>-L/usr/lib/x86_64-linux-gnu -lSDL</code></p>\n\n<p>If I do <code>ls -alh /usr/lib/x86_64-linux-gnu</code> I get tons of file (i.e. this directory exists)</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c++", "arrays", "vector", "sdl-2"], "comments": [{"owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "edited": false, "score": 0, "creation_date": 1534958221, "post_id": 51971676, "comment_id": 90894583, "body": "in absence of other relevant parts of your code I&#39;ve made an attempt to help based solely on what&#39;s in the original question. Let me know if this helps."}, {"owner": {"reputation": 259, "user_id": 4565161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLs4I.jpg?s=128&g=1", "display_name": "boxcartenant", "link": "https://stackoverflow.com/users/4565161/boxcartenant"}, "reply_to_user": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "edited": false, "score": 0, "creation_date": 1534959113, "post_id": 51971676, "comment_id": 90894975, "body": "@SkepticalEmpiricist Yeah, feel free to let me know what part you&#39;d like to know more about (for example, if you think it would be valuable to see the full render function in LTexture, the actual error message, etc). I tried to give everything leading up to this part, directly. I&#39;ll help where I can. And thanks!"}, {"owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "edited": false, "score": 0, "creation_date": 1534959694, "post_id": 51971676, "comment_id": 90895242, "body": "maybe just see how <code>mAnimations</code> is declared in your code. In the meantime let me know if my edited answer helps any."}, {"owner": {"reputation": 259, "user_id": 4565161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLs4I.jpg?s=128&g=1", "display_name": "boxcartenant", "link": "https://stackoverflow.com/users/4565161/boxcartenant"}, "reply_to_user": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "edited": false, "score": 0, "creation_date": 1534959998, "post_id": 51971676, "comment_id": 90895387, "body": "@SkepticalEmpiricist I made an ETA. I&#39;ll take a look at your edited answer and come back to you in a bit."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 4565161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLs4I.jpg?s=128&g=1", "display_name": "boxcartenant", "link": "https://stackoverflow.com/users/4565161/boxcartenant"}, "edited": false, "score": 0, "creation_date": 1534960628, "post_id": 51972042, "comment_id": 90895693, "body": "This compiled. I&#39;ll come back in a few hours when I&#39;ve been able to test it more. Thanks!"}, {"owner": {"reputation": 259, "user_id": 4565161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLs4I.jpg?s=128&g=1", "display_name": "boxcartenant", "link": "https://stackoverflow.com/users/4565161/boxcartenant"}, "edited": false, "score": 0, "creation_date": 1534973907, "post_id": 51972042, "comment_id": 90901431, "body": "I got my character rendering! Thanks a lot for the help!"}], "tags": [], "owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "is_accepted": true, "score": 2, "last_activity_date": 1534960017, "last_edit_date": 1534960017, "creation_date": 1534958126, "answer_id": 51972042, "question_id": 51971676, "link": "https://stackoverflow.com/questions/51971676/passing-pointer-to-single-item-in-vector-of-multidimensional-array-to-function-c/51972042#51972042", "title": "Passing pointer to single item in Vector of Multidimensional Array to Function c++", "body": "<p>Change your global array definition like this:</p>\n\n<pre><code>using SdlRectArray = std::array&lt;std::array&lt;std::array&lt;SDL_Rect, ANIMATION_FRAMES&gt;, TOTAL_DIRECTIONS&gt;, TOTAL_ACTIVITIES&gt;;\nstd::vector&lt;SdlRectArray&gt; gPersonSpriteClips;\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/4612318/2754173\">See here</a> for why not to <em>store arrays in a <code>std::vector</code> or any other container</em>.</p>\n\n<p>Accordingly, define your <code>Character::render()</code> method like this:</p>\n\n<pre><code>void render(LTexture&amp; characterSpriteSheetTexture, SdlRectArray&amp; spriteClips)\n{\n    characterSpriteSheetTexture.render( mPosition.x, mPosition.y, &amp;spriteClips[mActivity][mDirection][mAnimations[mActivity][mCurrentFrame]] );\n}\n</code></pre>\n\n<p>And then you can call it like this:</p>\n\n<pre><code>myCharacter.render(bodySpritesheetTexture, gPersonSpriteClips[myCharacter.getBody()]);\n</code></pre>\n\n<p>as there's no need for doing <code>&amp;*</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": false, "score": 1, "last_activity_date": 1534962308, "last_edit_date": 1534962308, "creation_date": 1534960270, "answer_id": 51972545, "question_id": 51971676, "link": "https://stackoverflow.com/questions/51971676/passing-pointer-to-single-item-in-vector-of-multidimensional-array-to-function-c/51972545#51972545", "title": "Passing pointer to single item in Vector of Multidimensional Array to Function c++", "body": "<p>It is difficult to tell from your question what the exact error is, but it seems likely that the root cause is \"array decay\".</p>\n\n<p>In C++ (and in C), array arguments are almost always treated as pointers to the start of the array.  For a multidimensional array, this means that the multiple-indexing you expect can't work, because the language has stripped away the size and shape information necessary.</p>\n\n<p>The sole exception is that <a href=\"https://stackoverflow.com/questions/8767166/passing-a-2d-array-to-a-c-function/17569578\"><em>reference</em> parameters</a> do not decay in this way.  However, if you rely on this, you (and anyone else who works on your code) will need to remember to use that exact reference parameter every time they pass the multidimensional array to another function.</p>\n\n<p>In modern C++, this issue is typically fixed using <code>std::array&lt;&gt;</code>, which was designed for the purpose.  In your case, that would be very verbose, so I'd suggest a type alias:</p>\n\n<pre><code>typedef std::array&lt; std::array&lt; std::array&lt;SDL_Rect,\n  ANIMATION_FRAMES&gt;, TOTAL_DIRECTIONS&gt;, TOTAL_ACTIVITIES&gt; SpriteClip;\n\nstd::vector&lt;SpriteClip&gt; gSpriteClips;\n</code></pre>\n\n<p>Alternatively, you could write a short class:</p>\n\n<pre><code>class SpriteClip {\n  SDL_Rect m_data[TOTAL_ACTIVITIES][TOTAL_DIRECTIONS][ANIMATION_FRAMES];\npublic:\n  SDL_Rect&amp; get(activity, direction, frame) {\n    return m_data[activity][direction][frame];\n  }\n};\n</code></pre>\n\n<p>This would let you change the representation easily -- for example, if you decided that you wanted different sprites to have different numbers of activities and frames.</p>\n"}], "owner": {"reputation": 259, "user_id": 4565161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLs4I.jpg?s=128&g=1", "display_name": "boxcartenant", "link": "https://stackoverflow.com/users/4565161/boxcartenant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 51972042, "answer_count": 2, "score": 2, "last_activity_date": 1534962308, "creation_date": 1534956716, "last_edit_date": 1534959951, "question_id": 51971676, "link": "https://stackoverflow.com/questions/51971676/passing-pointer-to-single-item-in-vector-of-multidimensional-array-to-function-c", "title": "Passing pointer to single item in Vector of Multidimensional Array to Function c++", "body": "<p>I'm working on a program using SDL. I have the following variable instantiated outside of my main function:</p>\n\n<pre><code>std::vector&lt;SDL_Rect[TOTAL_ACTIVITIES][TOTAL_DIRECTIONS][ANIMATION_FRAMES]&gt; gPersonSpriteClips;\n</code></pre>\n\n<p>(where the all-caps items are constant integers). It's a vector of arrays, because I intend to do a lot of sprite development later. For now, I just have a few placeholder sprites. So, the 3D array captures all aspects of a single human body-type spritesheet, and when I pull in the sheet I'll have the code split it up into multiple body types...</p>\n\n<p>I have a class, \"Character\", which makes use of the array when it is preparing to render. Here is the call to render myCharacter in main:</p>\n\n<pre><code>myCharacter.render(bodySpritesheetTexture, &amp;*gPersonSpriteClips[myCharacter.getBody()]);\n</code></pre>\n\n<p>Character.getBody() returns the vector index for the body type used by this instance of character. Here is the function declaration in Character.h:</p>\n\n<pre><code>void render(LTexture&amp; characterSpriteSheetTexture, SDL_Rect spriteClips[TOTAL_ACTIVITIES][TOTAL_DIRECTIONS][ANIMATION_FRAMES]);\n</code></pre>\n\n<p>Here is the function itself in Character.cpp:</p>\n\n<pre><code>void Character::render(LTexture&amp; characterSpriteSheetTexture, SDL_Rect spriteClips[TOTAL_PERSON_ACTIVITIES][TOTAL_CARDINAL_DIRECTIONS][PERSON_ANIMATION_FRAMES])\n{\n    characterSpriteSheetTexture.render( mPosition.x, mPosition.y, &amp;spriteClips[mActivity][mDirection][mAnimations[mActivity][mCurrentFrame]] );\n}\n</code></pre>\n\n<p>mActivity is the enum for \"which activity is presently being performed\" by the character. mDirection is which direction he's facing. mAnimations lists frame orders (because some of these animations use the same sprites several times in various orders).</p>\n\n<p>Finally, the render function for LTexture is taken right out of LazyFoo's SDL tutorials.</p>\n\n<p>characterSpriteSheetTexture.render() is calling a function with the following declaration (in LTexture.h):</p>\n\n<pre><code>void render( int x, int y, SDL_Rect* clip = NULL, int targetHeight = NULL, int targetWidth = NULL, double angle = 0.0, SDL_Point* center = NULL, SDL_RendererFlip flip = SDL_FLIP_NONE );\n</code></pre>\n\n<p>So it's expecting an argument of type SDL_Rect* clip. That function makes a call to:</p>\n\n<pre><code>SDL_RenderCopyEx( gRenderer, mTexture, clip, &amp;renderQuad, angle, center, flip );\n</code></pre>\n\n<p>I get an error when I compile the code, pointing me to a place inside the SDL libraries. I've successfully employed LTexture's render function by passing indexes from one-dimensional arrays of SDL_Rect into it, so I'm very confident that the problem exists in my vector argument.</p>\n\n<p>Ignoring disagreements about naming conventions...... what am I doing wrong here, and what's the proper way to achieve what I'm trying to do? </p>\n\n<p>Granted, I'll probably simplify my scheme for animating things significantly in the future; this is my first shot at generating a player character. Anyway, I'd like to know the mechanics of what's going wrong in this case.</p>\n\n<p>Last thing, please don't suggest that I use boost. I'd really like to avoid boost for this program.</p>\n\n<p>ETA:</p>\n\n<p>Here is the declaration of mAnimations in Character.h:</p>\n\n<pre><code>std::vector&lt;int&gt; mAnimations[TOTAL_ACTIVITIES];\n</code></pre>\n\n<p>Here is the initialization of it in the default constructor:</p>\n\n<pre><code>for (int i = 0; i &lt; TOTAL_ACTIVITIES; i++)\n    {\n        mAnimations[i].resize(ANIMATION_FRAMES);\n        for (int j = 0; j &lt; ANIMATION_FRAMES; j++)\n        {\n            mAnimations[i][j] = j;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++", "matlab", "eigen"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534956551, "post_id": 51971562, "comment_id": 90893753, "body": "Possibly relevant: <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1534959966, "post_id": 51971562, "comment_id": 90895369, "body": "I presume that MATLAB uses a different algorithm than <code>ColPivHouseholderQr()</code> to solve this?"}, {"owner": {"reputation": 1241, "user_id": 2364295, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/80d06d9b68aecf42c630b6adc86c3fec?s=128&d=identicon&r=PG", "display_name": "Mastiff", "link": "https://stackoverflow.com/users/2364295/mastiff"}, "edited": false, "score": 0, "creation_date": 1534961316, "post_id": 51971562, "comment_id": 90895979, "body": "I&#39;m not certain what MATLAB has under the hood.  Quite possibly they look at the matrix and choose the best algorithm to use.  The disturbing thing here is the inability to invert a matrix that I wouldn&#39;t consider that badly conditioned.  Incidentally, if I change from ColPivHouseholderQr()  to llt(), I can get it to work here, but still can&#39;t invert it using that method."}, {"owner": {"reputation": 2721, "user_id": 4372237, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/3XqU1.jpg?s=128&g=1", "display_name": "Mikhail Genkin", "link": "https://stackoverflow.com/users/4372237/mikhail-genkin"}, "edited": false, "score": 2, "creation_date": 1534965751, "post_id": 51971562, "comment_id": 90897969, "body": "Are you sure that you use doubles (not floats) in C++/Eigen ?"}, {"owner": {"reputation": 1241, "user_id": 2364295, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/80d06d9b68aecf42c630b6adc86c3fec?s=128&d=identicon&r=PG", "display_name": "Mastiff", "link": "https://stackoverflow.com/users/2364295/mastiff"}, "edited": false, "score": 0, "creation_date": 1534968195, "post_id": 51971562, "comment_id": 90899039, "body": "Everything is MatrixXd and VectorXd. I&#39;m assuming that carries through to all the internal computations."}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 1, "creation_date": 1534970776, "post_id": 51971562, "comment_id": 90900200, "body": "Have you tried the simpler: <code>x.transpose() * P.colPivHouseholderQr().solve(x)</code>?? Since it&#39;s doing column-pivoting, working on <code>P</code> or <code>P&#39;</code> might be quite different. Nonetheless, with <code>3e7</code> as condition number even an explicit computation of <code>P.ibverse()</code> should produce a correct result. Have you check the condition number on the C++ side? ( e.g., <code>BDVSVD&lt;MatrixXd&gt; svd(P); cout &lt;&lt; P.singularValues()(0)&#47;P.singularValues()(P.cols()-1) &lt;&lt; &quot;\\n&quot;;</code>)"}, {"owner": {"reputation": 1241, "user_id": 2364295, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/80d06d9b68aecf42c630b6adc86c3fec?s=128&d=identicon&r=PG", "display_name": "Mastiff", "link": "https://stackoverflow.com/users/2364295/mastiff"}, "edited": false, "score": 0, "creation_date": 1534971721, "post_id": 51971562, "comment_id": 90900576, "body": "In this particular case, P is symmetric anyway (a covariance matrix), so the transpose shouldn&#39;t matter, unless it&#39;s somehow lossy, which I sure hope it isn&#39;t.  I&#39;ll ask Eigen what it thinks the condition number is..."}], "answers": [{"comments": [{"owner": {"reputation": 1241, "user_id": 2364295, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/80d06d9b68aecf42c630b6adc86c3fec?s=128&d=identicon&r=PG", "display_name": "Mastiff", "link": "https://stackoverflow.com/users/2364295/mastiff"}, "edited": false, "score": 0, "creation_date": 1534983845, "post_id": 51975979, "comment_id": 90903702, "body": "Thanks for the reply.  I think just a misunderstanding regarding the wrongness.  My implementation of x/P is as described (I overloaded forward slash).  For finding x&#39;/P, replace x with x.transpose() in the messy expression. I&#39;ll try your suggestion for reduced fragility."}], "tags": [], "owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "is_accepted": true, "score": 3, "last_activity_date": 1534976680, "creation_date": 1534976680, "answer_id": 51975979, "question_id": 51971562, "link": "https://stackoverflow.com/questions/51971562/c-eigen-linear-system-solve-numerical-issues/51975979#51975979", "title": "C++ Eigen linear system solve, numerical issues?", "body": "<p>The following is wrong (besides the <code>()</code> you missed in your question):</p>\n\n<pre><code>(P.transpose()).ColPivHouseholderQr().solve(x.transpose()).transpose();\n</code></pre>\n\n<p>because </p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>x'*inv(P) = ((x'    *inv(P))')'\n          = (inv(P)'* (x')'  )'\n          = (inv(P) *  x     )'  % Note: P=P'\n</code></pre>\n\n<p>Your expression should actually raise an assertion in Eigen when built without <code>-DNDEBUG</code>, since <code>x.transpose()</code> has only one row but <code>P</code> has (usually) more.</p>\n\n<p>To compute <code>x'*inv(P)*x</code> for symmetric positive definite <code>P</code>, I suggest using the Cholesky decomposition <code>L*L'=P</code> which gives you <code>x'*inv(P)*x = (L\\x)'*(L\\x)</code> which in Eigen is:</p>\n\n<pre><code>typedef Eigen::LLT&lt;Eigen::MatrixXd&gt; Chol;\nChol chol(P); // Can be reused if x changes but P stays the same\n// Handle non positive definite covariance somehow:\nif(chol.info()!=Eigen::Success) throw \"decomposition failed!\";\nconst Chol::Traits::MatrixL&amp; L = chol.matrixL();\ndouble quadform = (L.solve(x)).squaredNorm();\n</code></pre>\n\n<p>For the matrix Eigen failed to invert (which Matlab does invert), it would be interesting to see it.</p>\n"}], "owner": {"reputation": 1241, "user_id": 2364295, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/80d06d9b68aecf42c630b6adc86c3fec?s=128&d=identicon&r=PG", "display_name": "Mastiff", "link": "https://stackoverflow.com/users/2364295/mastiff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 1, "accepted_answer_id": 51975979, "answer_count": 1, "score": 1, "last_activity_date": 1534976680, "creation_date": 1534956258, "last_edit_date": 1534959821, "question_id": 51971562, "link": "https://stackoverflow.com/questions/51971562/c-eigen-linear-system-solve-numerical-issues", "title": "C++ Eigen linear system solve, numerical issues?", "body": "<p>I'm getting unexpected and invalid results from a linear solve computation in Eigen.  I have a vector <code>x</code> and matrix <code>P</code>.</p>\n\n<p>In MATLAB notation, I'm doing this:</p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>x'/P*x\n</code></pre>\n\n<p>(similar to <code>x'*inv(P)*x</code>, but no direct inversion)</p>\n\n<p>which is quadratic form and should yield a positive result.  The matrix <code>P</code> is positive definite and not ill conditioned.  In MATLAB the result is positive though large.</p>\n\n<p>In C++ Eigen, my slash operator is like this:</p>\n\n<p><code>x/P</code> is implemented as: </p>\n\n<pre><code>(P.transpose()).ColPivHouseholderQr().solve(x.transpose).transpose()\n</code></pre>\n\n<p>This gives the correct answer in general, but appears to be more fragile than MATLAB.  In the case I'm looking at now, it gives a very large negative number for <code>x'/P*x</code> as though there was overflow and wraparound or somesuch.</p>\n\n<p>Is there a way to defragilize this?</p>\n\n<p>EDIT: Doing some experimentation I see that Eigen also fails to invert this matrix, where MATLAB has no problem. The matrix condition number is 3e7, which is not bad.  Eigen gives the same (wrong) answer with the linear solve and a simple <code>x.transpose() * P.inverse() * x</code>.  What's going on?</p>\n"}, {"tags": ["c++", "qt", "clang"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 6, "creation_date": 1534956089, "post_id": 51971439, "comment_id": 90893512, "body": "I <i>guess</i> you could just explicitly declare them <code>= default</code> (or <code>= delete</code>) to shut the compiler up. Being explicit is usually a good thing regardless of compiler warnings btw."}, {"owner": {"reputation": 12853, "user_id": 356726, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PhH4C.gif?s=128&g=1", "display_name": "Horst Walter", "link": "https://stackoverflow.com/users/356726/horst-walter"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534958571, "post_id": 51971439, "comment_id": 90894743, "body": "But would that not mean I cannot copy a object if I define a virtual dtor (unless I explicitly write a copy assignment operator). Why would that make sense?"}, {"owner": {"reputation": 2142, "user_id": 1689504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af4a48f5ed0d4a54a43844ea1ecc395?s=128&d=identicon&r=PG", "display_name": "HerrJoebob", "link": "https://stackoverflow.com/users/1689504/herrjoebob"}, "edited": false, "score": 3, "creation_date": 1534960267, "post_id": 51971439, "comment_id": 90895513, "body": "Related: <a href=\"https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\" title=\"what is the rule of three\">stackoverflow.com/questions/4172722/what-is-the-rule-of-thre&zwnj;&#8203;e</a>"}, {"owner": {"reputation": 12853, "user_id": 356726, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PhH4C.gif?s=128&g=1", "display_name": "Horst Walter", "link": "https://stackoverflow.com/users/356726/horst-walter"}, "edited": false, "score": 0, "creation_date": 1534960927, "post_id": 51971439, "comment_id": 90895817, "body": "Are you saying the warning is there to enforce the rule of three? As I do not deal with resources the rule of three does not make really sense here. As I remember it the rule is a guideline, not a must. Still not really understand what the warning means by <code>deprecated</code> in that very scenario. Also wonder why that is new since C++11. But good hint!"}], "answers": [{"tags": [], "owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "is_accepted": true, "score": 1, "last_activity_date": 1535027491, "last_edit_date": 1535027491, "creation_date": 1535016330, "answer_id": 51982463, "question_id": 51971439, "link": "https://stackoverflow.com/questions/51971439/conflicting-clang-virtual-dtor-and-deprecated-copy-operator-warnings/51982463#51982463", "title": "Conflicting CLANG `virtual dtor` and `deprecated copy operator` warnings", "body": "<blockquote>\n  <p>As of How to disable implicitly-defined copy constructor generation when there is user defined destructor it looks like I have to accept the \"deprecated\" warning, but I am not sure.</p>\n</blockquote>\n\n<p>You don't have to accept the \"deprecated\" warning. You have 3 options here, <strong>implement</strong> the operator, <strong>explicit default</strong> the operator or <strong>delete</strong> the operator.</p>\n\n<p>First of all, this warning is trigger because you actually use the <code>copy assignment operator</code> somewhere. Maybe not even on purpose (see <code>//unfortunate mistake</code> in the example below). You should actually get a note in addition to the warning where you use the operator, something like:</p>\n\n<pre><code>note: in implicit copy assignment operator for 'CDbMappingComponentAware' first required here\n</code></pre>\n\n<p>Consider the following example (<a href=\"http://coliru.stacked-crooked.com/a/62b451559d76f5ae\" rel=\"nofollow noreferrer\">running version</a>):</p>\n\n<pre><code>class foo {\npublic:\n    virtual ~foo() {}\n\n    // options\n    // implement\n    //foo&amp; operator=(foo const&amp;) {return *this;}\n    // default\n    //foo&amp; operator=(foo const&amp;) = default;\n    // delete\n    //foo&amp; operator=(foo const&amp;) = delete;\n};\n\nclass bar : public foo {\npublic:\n    ~bar() override {};\n};\n\n// stupid mistake... should be defined\n// void fn(bar const&amp;)\nvoid fn(bar) {}\n\n\nint main(int, char*[]) {\n    foo* f1 = new bar;\n    foo* f2 = new bar;\n\n    // triggers warning\n    *f1 = *f2;\n\n    // unfortunate mistake\n    bar b;\n    // triggers warning twice since bar inherits from foo\n    fn(b);\n\n    return 0;\n}\n</code></pre>\n\n<p>In the case, you are really using the <code>copy assignment operator</code>, you should either <strong>implement</strong> it, or <strong>default</strong> it if it is really <em>plain vanilla</em>. See below why you eventually should not default it. If you don't want to be able to copy the instance at all, <strong>delete</strong> the operator/ctor.</p>\n\n<p>By the way, it is the same for copy constructor, not only assignment operator. It is described in <strong>\u00a715.8.1/6</strong> for copy constructor and <strong>\u00a715.8.2/2</strong> for copy assignment operator in the draft <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/n4727.pdf\" rel=\"nofollow noreferrer\">n4727</a>.</p>\n\n<p>However:</p>\n\n<blockquote>\n  <p>But would that not mean I cannot copy a object if I define a virtual dtor (unless I explicitly write a copy assignment operator).</p>\n</blockquote>\n\n<p>No, you can still use the generated copy ctor/assignment as long as it is a warning. Depreacated means it will (probably) become an error in the future (in case of C++ maybe in about 40 years or more, if at all). So if you don't want your code to spit this warning as an error, when it is not supported by the compiler anymore, you should fix it now.</p>\n\n<hr>\n\n<blockquote>\n  <p>But why is that? I mean, why is the dtor affecting the copy operator? </p>\n</blockquote>\n\n<p>Hypothetical answer here:</p>\n\n<p>One purpose I can think of, is to prevent some mistakes. Consider the example (taken from <a href=\"https://isocpp.org/wiki/faq/ctors#ctor-work-right\" rel=\"nofollow noreferrer\">Why doesn\u2019t my constructor work right?</a>  ):</p>\n\n<pre><code>class Handle {\nprivate:\n    string name;\n    X* p;\npublic:\n    Handle(string n)\n        :name(n), p(0) { /* acquire X called \"name\" and let p point to it */ }\n    ~Handle() { delete p; /* release X called \"name\" */ }\n};\nvoid f(const string&amp; hh)\n{\n    Handle h1(hh);\n    Handle h2 = h1; // leads to disaster!\n}\n</code></pre>\n\n<blockquote>\n  <p>Here, the default copy gives us h2.name==h1.name and h2.p==h1.p. This leads to disaster: when we exit f() the destructors for h1 and h2 are invoked and the object pointed to by h1.p and h2.p is deleted twice.    </p>\n</blockquote>\n\n<p>To prevent the double deletion, you have to be explicit and not rely on the <strong>generated</strong>/ <strong>defaulted</strong> copy constructor/assignment.</p>\n\n<blockquote>\n  <p>Are you saying the warning is there to enforce the rule of three?</p>\n</blockquote>\n\n<p>In this particular case: <strong>Yes</strong>, I would say so.</p>\n\n<blockquote>\n  <p>As I do not deal with resources the rule of three does not make really sense here.</p>\n</blockquote>\n\n<p>This would require the compiler to take the members in account. Pretty much effort for such an unmature warning.</p>\n\n<h2>Personal thoughts:</h2>\n\n<p>IMHO, I do not belive this will ever become an error in C++. There is way to much code out there, relying on the auto-generated ctor/assignment. Making this an error would break (literally) tousands of projects. -> Not going to happen...</p>\n"}], "owner": {"reputation": 12853, "user_id": 356726, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PhH4C.gif?s=128&g=1", "display_name": "Horst Walter", "link": "https://stackoverflow.com/users/356726/horst-walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 51982463, "answer_count": 1, "score": 1, "last_activity_date": 1535027491, "creation_date": 1534955798, "last_edit_date": 1534957672, "question_id": 51971439, "link": "https://stackoverflow.com/questions/51971439/conflicting-clang-virtual-dtor-and-deprecated-copy-operator-warnings", "title": "Conflicting CLANG `virtual dtor` and `deprecated copy operator` warnings", "body": "<p>In my Qt project I have a class like below. I get the following warning (understood), and add a virtual dtor.</p>\n\n<p><code>dbmappingcomponentaware.h:25: warning: CDbMappingComponentAware has virtual functions but non-virtual destructor</code></p>\n\n<p>Now I get</p>\n\n<p><code>warning: definition of implicit copy assignment operator for 'CDbMappingComponentAware' is deprecated because it has a user-declared destructor</code> </p>\n\n<p>The class is a plain vanilla class and I have not declared any operators. How would I resolve that conflict?</p>\n\n<p>As of <a href=\"https://stackoverflow.com/q/26253652/356726\">How to disable implicitly-defined copy constructor generation when there is user defined destructor</a> it looks like I have to accept the \"deprecated\" warning, but I am not sure.</p>\n\n<p>Code snippet:</p>\n\n<pre><code>//! Allows subcomponents to gain access to model component\nclass CDbMappingComponentAware {\n  public:\n    //! Destructor (added for 1st warning)\n    // virtual ~CDbMappingComponentAware() {}\n\n    //! Set the corresponding component\n    virtual void setMappingComponent(CDbMappingComponent *component);\n...\n...\n</code></pre>\n\n<p>-- Edit, based on comment --</p>\n\n<p>Reading <a href=\"https://en.cppreference.com/w/cpp/language/copy_assignment\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/copy_assignment</a> it says,</p>\n\n<blockquote>\n  <p>The generation of the implicitly-defined copy assignment operator is\n  deprecated(since C++11) if T has a user-declared destructor or\n  user-declared copy constructor.</p>\n</blockquote>\n\n<p>But why is that? I mean, why is the dtor affecting the copy operator? </p>\n"}, {"tags": ["c++", "inheritance"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1534955402, "post_id": 51971300, "comment_id": 90893126, "body": "Did you find code like this somewhere and wondering why they did that?  If you did that code might have some context for why they did that.  Otherwise we could only guess why they provided that constructor."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 2, "creation_date": 1534955653, "post_id": 51971300, "comment_id": 90893274, "body": "Obviously the <code>object</code> instance passed in is a <i>different</i> instance than what is currently being constructed, so presumably the constructor here calls methods on the instance passed in to get information used in the construction of the current instance."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 3, "creation_date": 1534956126, "post_id": 51971300, "comment_id": 90893532, "body": "Do you want us to just make up a list of reasons why a person might hypothetically want to do this? It will be long and many of them will be specific."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1534956081, "last_edit_date": 1534956081, "creation_date": 1534955760, "answer_id": 51971428, "question_id": 51971300, "link": "https://stackoverflow.com/questions/51971300/c-why-would-you-pass-a-reference-to-a-base-class-to-a-constructor-of-a-derived/51971428#51971428", "title": "c++ why would you pass a reference to a base class to a constructor of a derived class", "body": "<p>Typically, arguments are passed to constructors because the state of the arguments can be used to initialize the state of the object that is being constructed. Same applies to this case.</p>\n\n<p>Non-const reference arguments can be (and nearly always are) used to modify the referred object.</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 1, "last_activity_date": 1534956502, "creation_date": 1534956502, "answer_id": 51971628, "question_id": 51971300, "link": "https://stackoverflow.com/questions/51971300/c-why-would-you-pass-a-reference-to-a-base-class-to-a-constructor-of-a-derived/51971628#51971628", "title": "c++ why would you pass a reference to a base class to a constructor of a derived class", "body": "<blockquote>\n  <p>In c++ is there a reason why you would pass a reference to a base class to a constructor of a derived class? </p>\n</blockquote>\n\n<p>There is usually one reason why reference to an object would be passed to a constructor, does not really matter if that object type related to consttructed one or not - to construct this type you need information from that object. Using lvalue reference instead of const one could mean either bad design or ctor would need to modify passed object or keep non-const reference/pointer to it.</p>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 10175853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0l0VB5YyXT4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qdCq8vE8WiSMZt3wtjs9d4OC-hxw/mo/photo.jpg?sz=128", "display_name": "pelican brady", "link": "https://stackoverflow.com/users/10175853/pelican-brady"}, "edited": false, "score": 0, "creation_date": 1534962892, "post_id": 51972369, "comment_id": 90896667, "body": "thank you, so you are saying that the reason for passing <code>Base&amp;</code> is that it gives you flexibility to pass references to any derived classes in the future if you so required?"}, {"owner": {"reputation": 184, "user_id": 5704797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035220a4e16c5f51ea5447a11f76d987?s=128&d=identicon&r=PG&f=1", "display_name": "ARentalTV", "link": "https://stackoverflow.com/users/5704797/arentaltv"}, "reply_to_user": {"reputation": 155, "user_id": 10175853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0l0VB5YyXT4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qdCq8vE8WiSMZt3wtjs9d4OC-hxw/mo/photo.jpg?sz=128", "display_name": "pelican brady", "link": "https://stackoverflow.com/users/10175853/pelican-brady"}, "edited": false, "score": 0, "creation_date": 1534982817, "post_id": 51972369, "comment_id": 90903532, "body": "Yes, that&#39;s the idea"}], "tags": [], "owner": {"reputation": 184, "user_id": 5704797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035220a4e16c5f51ea5447a11f76d987?s=128&d=identicon&r=PG&f=1", "display_name": "ARentalTV", "link": "https://stackoverflow.com/users/5704797/arentaltv"}, "is_accepted": true, "score": 0, "last_activity_date": 1534959515, "creation_date": 1534959515, "answer_id": 51972369, "question_id": 51971300, "link": "https://stackoverflow.com/questions/51971300/c-why-would-you-pass-a-reference-to-a-base-class-to-a-constructor-of-a-derived/51972369#51972369", "title": "c++ why would you pass a reference to a base class to a constructor of a derived class", "body": "<p>I would think the question is \"why pass the base class reference instead of the derived class reference?\". If so, the reason  <code>Base&amp;</code> is passed instead of <code>Derived&amp;</code> is that the former allows you to pass an <code>OtherDerived&amp;</code> reference, given that <code>OtherDerived</code> inherits <code>Base</code>. This is called polymorphism and is quite a thing in C++.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/7192069/polymorphic-c-references\">Here's</a> pretty much the same question, but with a function instead of a constructor.</p>\n"}], "owner": {"reputation": 155, "user_id": 10175853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0l0VB5YyXT4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qdCq8vE8WiSMZt3wtjs9d4OC-hxw/mo/photo.jpg?sz=128", "display_name": "pelican brady", "link": "https://stackoverflow.com/users/10175853/pelican-brady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "closed_date": 1534998389, "accepted_answer_id": 51972369, "answer_count": 3, "score": -1, "last_activity_date": 1534959515, "creation_date": 1534955250, "question_id": 51971300, "link": "https://stackoverflow.com/questions/51971300/c-why-would-you-pass-a-reference-to-a-base-class-to-a-constructor-of-a-derived", "closed_reason": "Needs more focus", "title": "c++ why would you pass a reference to a base class to a constructor of a derived class", "body": "<p>In c++ is there a reson why you would pass a reference to a base class to a constructor of a derived class? Why would you want to do this?</p>\n\n<p>Here is a basic example:</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nclass Base\n{\n   int x;\npublic:\n    virtual void fun() = 0;\n    int getX() { return x; }\n};\n\n// This class ingerits from Base and implements fun()\nclass Derived: public Base\n{\n    int y;\npublic:\n    Derived(Base&amp; object);\n    void fun() { cout &lt;&lt; \"fun() called\"; }\n};\n</code></pre>\n"}, {"tags": ["c++", "linux", "boost", "cmake"], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 410083, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb3c65d26e9f1eeb2a69feef51ea2df2?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/410083/dave-f"}, "edited": false, "score": 0, "creation_date": 1534971930, "post_id": 51971886, "comment_id": 90900667, "body": "I added symlinks in /usr/lib to the libraries located in /usr/lib/x86_64-linux-gnu."}], "tags": [], "owner": {"reputation": 296, "user_id": 2712622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b96b57737792ec7db573124ae6cf8f?s=128&d=identicon&r=PG&f=1", "display_name": "zaen", "link": "https://stackoverflow.com/users/2712622/zaen"}, "is_accepted": false, "score": 1, "last_activity_date": 1534957484, "creation_date": 1534957484, "answer_id": 51971886, "question_id": 51971271, "link": "https://stackoverflow.com/questions/51971271/cmake-3-11-on-linux-mint-19-is-unable-to-find-static-boost-libraries/51971886#51971886", "title": "CMake 3.11 on Linux Mint 19 is unable to find static Boost libraries", "body": "<p>Verify that the libraries are in the include path. This may be a bug in your cmake package or your Boost package.</p>\n\n<p>For me, on Fedora, these libraries are in /usr/lib64. On Ubuntu (and from <a href=\"https://stackoverflow.com/questions/29810979/cannot-find-boost-with-cmake-on-linux-mint\">what I could find</a>, Linux Mint) they should be in /usr/lib/x86_64-linux-gnu.</p>\n\n<p>A temporary solution would be to add the directory to the <code>include_directories</code> statement. You might also find <a href=\"https://stackoverflow.com/questions/3808775/cmake-doesnt-find-boost\">this question</a> helpful.</p>\n"}], "owner": {"reputation": 593, "user_id": 410083, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb3c65d26e9f1eeb2a69feef51ea2df2?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/410083/dave-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534957896, "creation_date": 1534955157, "last_edit_date": 1534957493, "question_id": 51971271, "link": "https://stackoverflow.com/questions/51971271/cmake-3-11-on-linux-mint-19-is-unable-to-find-static-boost-libraries", "title": "CMake 3.11 on Linux Mint 19 is unable to find static Boost libraries", "body": "<p>I am working on a project and using CMake to build the project.  The project works flawlessly on Windows but I want to make a Linux variant using the same CMakeLists.txt file.</p>\n\n<p>Here is the relevant part of my CMakeLists.txt file:</p>\n\n<pre><code>if(WIN32)\n    set(BOOST_ROOT \"C:\\\\Boost\")\n    set(BOOST_INCLUDEDIR \"C:\\\\Boost\\\\include\\\\boost-1_68\")\nendif(WIN32)\nif(UNIX)\n    set(Boost_DEBUG ON)\n    set(Boost_NAMESPACE \"libboost\")\n    set(Boost_USE_STATIC_RUNTIME OFF)\nendif(UNIX)\nset(Boost_USE_STATIC_LIBS ON)\nset(Boost_USE_DEBUG_LIBS OFF)\nfind_package(Boost REQUIRED random filesystem serialization)\ninclude_directories(${Boost_INCLUDE_DIRS})\n</code></pre>\n\n<p>I installed Boost using the command <code>sudo apt install libboost_all-dev</code>.</p>\n\n<p>I get the errors shown below when I try to configure the project.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>CMake Error at /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/\n  FindBoost.cmake:2044 (message):\nUnable to find the requested Boost libraries.\n\nBoost version: 1.65.1\n\nBoost include path: /usr/include\n\nCould not find the following static Boost libraries:\n\n      libboost_random\n      libboost_filesystem\n      libboost_serialization\n\nSome (but not all) of the required Boost libraries were found.  You may\nneed to install these additional Boost libraries.  Alternatively, set\nBOOST_LIBRARYDIR to the directory containing Boost libraries or BOOST_ROOT\nto the location of Boost.\nCall Stack (most recent call first):\n  CMakeLists.txt:49 (find_package)\n...\n</code></pre>\n\n<hr>\n\n<p>Here is the full output.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>/opt/clion-2018.2/bin/cmake/linux/bin/cmake -DCMAKE_BUILD_TYPE=Debug -G \"CodeBlocks - Unix Makefiles\" /home/dave/CLionProjects/FNDice-win\n-- The C compiler identification is GNU 7.3.0\n-- The CXX compiler identification is GNU 7.3.0\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: /usr/bin/c++\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1121 ] _boost_TEST_VERSIONS = 1.68.0;1.68;1.67.0;1.67;1.66.0;1.66;1.65.1;1.65.0;1.65;1.64.0;1.64;1.63.0;1.63;1.62.0;1.62;1.61.0;1.61;1.60.0;1.60;1.59.0;1.59;1.58.0;1.58;1.57.0;1.57;1.56.0;1.56;1.55.0;1.55;1.54.0;1.54;1.53.0;1.53;1.52.0;1.52;1.51.0;1.51;1.50.0;1.50;1.49.0;1.49;1.48.0;1.48;1.47.0;1.47;1.46.1;1.46.0;1.46;1.45.0;1.45;1.44.0;1.44;1.43.0;1.43;1.42.0;1.42;1.41.0;1.41;1.40.0;1.40;1.39.0;1.39;1.38.0;1.38;1.37.0;1.37;1.36.1;1.36.0;1.36;1.35.1;1.35.0;1.35;1.34.1;1.34.0;1.34;1.33.1;1.33.0;1.33\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1123 ] Boost_USE_MULTITHREADED = TRUE\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1125 ] Boost_USE_STATIC_LIBS = ON\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1127 ] Boost_USE_STATIC_RUNTIME = OFF\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1129 ] Boost_ADDITIONAL_VERSIONS = \n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1131 ] Boost_NO_SYSTEM_PATHS = \n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1199 ] Declared as CMake or Environmental Variables:\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1201 ]   BOOST_ROOT = \n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1203 ]   BOOST_INCLUDEDIR = \n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1205 ]   BOOST_LIBRARYDIR = \n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1207 ] _boost_TEST_VERSIONS = 1.68.0;1.68;1.67.0;1.67;1.66.0;1.66;1.65.1;1.65.0;1.65;1.64.0;1.64;1.63.0;1.63;1.62.0;1.62;1.61.0;1.61;1.60.0;1.60;1.59.0;1.59;1.58.0;1.58;1.57.0;1.57;1.56.0;1.56;1.55.0;1.55;1.54.0;1.54;1.53.0;1.53;1.52.0;1.52;1.51.0;1.51;1.50.0;1.50;1.49.0;1.49;1.48.0;1.48;1.47.0;1.47;1.46.1;1.46.0;1.46;1.45.0;1.45;1.44.0;1.44;1.43.0;1.43;1.42.0;1.42;1.41.0;1.41;1.40.0;1.40;1.39.0;1.39;1.38.0;1.38;1.37.0;1.37;1.36.1;1.36.0;1.36;1.35.1;1.35.0;1.35;1.34.1;1.34.0;1.34;1.33.1;1.33.0;1.33\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1282 ] Include debugging info:\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1284 ]   _boost_INCLUDE_SEARCH_DIRS = PATHS;C:/boost/include;C:/boost;/sw/local/include\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1286 ]   _boost_PATH_SUFFIXES = boost-1_68_0;boost_1_68_0;boost/boost-1_68_0;boost/boost_1_68_0;boost-1_68;boost_1_68;boost/boost-1_68;boost/boost_1_68;boost-1_67_0;boost_1_67_0;boost/boost-1_67_0;boost/boost_1_67_0;boost-1_67;boost_1_67;boost/boost-1_67;boost/boost_1_67;boost-1_66_0;boost_1_66_0;boost/boost-1_66_0;boost/boost_1_66_0;boost-1_66;boost_1_66;boost/boost-1_66;boost/boost_1_66;boost-1_65_1;boost_1_65_1;boost/boost-1_65_1;boost/boost_1_65_1;boost-1_65_0;boost_1_65_0;boost/boost-1_65_0;boost/boost_1_65_0;boost-1_65;boost_1_65;boost/boost-1_65;boost/boost_1_65;boost-1_64_0;boost_1_64_0;boost/boost-1_64_0;boost/boost_1_64_0;boost-1_64;boost_1_64;boost/boost-1_64;boost/boost_1_64;boost-1_63_0;boost_1_63_0;boost/boost-1_63_0;boost/boost_1_63_0;boost-1_63;boost_1_63;boost/boost-1_63;boost/boost_1_63;boost-1_62_0;boost_1_62_0;boost/boost-1_62_0;boost/boost_1_62_0;boost-1_62;boost_1_62;boost/boost-1_62;boost/boost_1_62;boost-1_61_0;boost_1_61_0;boost/boost-1_61_0;boost/boost_1_61_0;boost-1_61;boost_1_61;boost/boost-1_61;boost/boost_1_61;boost-1_60_0;boost_1_60_0;boost/boost-1_60_0;boost/boost_1_60_0;boost-1_60;boost_1_60;boost/boost-1_60;boost/boost_1_60;boost-1_59_0;boost_1_59_0;boost/boost-1_59_0;boost/boost_1_59_0;boost-1_59;boost_1_59;boost/boost-1_59;boost/boost_1_59;boost-1_58_0;boost_1_58_0;boost/boost-1_58_0;boost/boost_1_58_0;boost-1_58;boost_1_58;boost/boost-1_58;boost/boost_1_58;boost-1_57_0;boost_1_57_0;boost/boost-1_57_0;boost/boost_1_57_0;boost-1_57;boost_1_57;boost/boost-1_57;boost/boost_1_57;boost-1_56_0;boost_1_56_0;boost/boost-1_56_0;boost/boost_1_56_0;boost-1_56;boost_1_56;boost/boost-1_56;boost/boost_1_56;boost-1_55_0;boost_1_55_0;boost/boost-1_55_0;boost/boost_1_55_0;boost-1_55;boost_1_55;boost/boost-1_55;boost/boost_1_55;boost-1_54_0;boost_1_54_0;boost/boost-1_54_0;boost/boost_1_54_0;boost-1_54;boost_1_54;boost/boost-1_54;boost/boost_1_54;boost-1_53_0;boost_1_53_0;boost/boost-1_53_0;boost/boost_1_53_0;boost-1_53;boost_1_53;boost/boost-1_53;boost/boost_1_53;boost-1_52_0;boost_1_52_0;boost/boost-1_52_0;boost/boost_1_52_0;boost-1_52;boost_1_52;boost/boost-1_52;boost/boost_1_52;boost-1_51_0;boost_1_51_0;boost/boost-1_51_0;boost/boost_1_51_0;boost-1_51;boost_1_51;boost/boost-1_51;boost/boost_1_51;boost-1_50_0;boost_1_50_0;boost/boost-1_50_0;boost/boost_1_50_0;boost-1_50;boost_1_50;boost/boost-1_50;boost/boost_1_50;boost-1_49_0;boost_1_49_0;boost/boost-1_49_0;boost/boost_1_49_0;boost-1_49;boost_1_49;boost/boost-1_49;boost/boost_1_49;boost-1_48_0;boost_1_48_0;boost/boost-1_48_0;boost/boost_1_48_0;boost-1_48;boost_1_48;boost/boost-1_48;boost/boost_1_48;boost-1_47_0;boost_1_47_0;boost/boost-1_47_0;boost/boost_1_47_0;boost-1_47;boost_1_47;boost/boost-1_47;boost/boost_1_47;boost-1_46_1;boost_1_46_1;boost/boost-1_46_1;boost/boost_1_46_1;boost-1_46_0;boost_1_46_0;boost/boost-1_46_0;boost/boost_1_46_0;boost-1_46;boost_1_46;boost/boost-1_46;boost/boost_1_46;boost-1_45_0;boost_1_45_0;boost/boost-1_45_0;boost/boost_1_45_0;boost-1_45;boost_1_45;boost/boost-1_45;boost/boost_1_45;boost-1_44_0;boost_1_44_0;boost/boost-1_44_0;boost/boost_1_44_0;boost-1_44;boost_1_44;boost/boost-1_44;boost/boost_1_44;boost-1_43_0;boost_1_43_0;boost/boost-1_43_0;boost/boost_1_43_0;boost-1_43;boost_1_43;boost/boost-1_43;boost/boost_1_43;boost-1_42_0;boost_1_42_0;boost/boost-1_42_0;boost/boost_1_42_0;boost-1_42;boost_1_42;boost/boost-1_42;boost/boost_1_42;boost-1_41_0;boost_1_41_0;boost/boost-1_41_0;boost/boost_1_41_0;boost-1_41;boost_1_41;boost/boost-1_41;boost/boost_1_41;boost-1_40_0;boost_1_40_0;boost/boost-1_40_0;boost/boost_1_40_0;boost-1_40;boost_1_40;boost/boost-1_40;boost/boost_1_40;boost-1_39_0;boost_1_39_0;boost/boost-1_39_0;boost/boost_1_39_0;boost-1_39;boost_1_39;boost/boost-1_39;boost/boost_1_39;boost-1_38_0;boost_1_38_0;boost/boost-1_38_0;boost/boost_1_38_0;boost-1_38;boost_1_38;boost/boost-1_38;boost/boost_1_38;boost-1_37_0;boost_1_37_0;boost/boost-1_37_0;boost/boost_1_37_0;boost-1_37;boost_1_37;boost/boost-1_37;boost/boost_1_37;boost-1_36_1;boost_1_36_1;boost/boost-1_36_1;boost/boost_1_36_1;boost-1_36_0;boost_1_36_0;boost/boost-1_36_0;boost/boost_1_36_0;boost-1_36;boost_1_36;boost/boost-1_36;boost/boost_1_36;boost-1_35_1;boost_1_35_1;boost/boost-1_35_1;boost/boost_1_35_1;boost-1_35_0;boost_1_35_0;boost/boost-1_35_0;boost/boost_1_35_0;boost-1_35;boost_1_35;boost/boost-1_35;boost/boost_1_35;boost-1_34_1;boost_1_34_1;boost/boost-1_34_1;boost/boost_1_34_1;boost-1_34_0;boost_1_34_0;boost/boost-1_34_0;boost/boost_1_34_0;boost-1_34;boost_1_34;boost/boost-1_34;boost/boost_1_34;boost-1_33_1;boost_1_33_1;boost/boost-1_33_1;boost/boost_1_33_1;boost-1_33_0;boost_1_33_0;boost/boost-1_33_0;boost/boost_1_33_0;boost-1_33;boost_1_33;boost/boost-1_33;boost/boost_1_33\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1306 ] location of version.hpp: /usr/include/boost/version.hpp\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1330 ] version.hpp reveals boost 1.65.1\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1416 ] guessed _boost_COMPILER = -gcc73\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1426 ] _boost_MULTITHREADED = -mt\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1502 ] _boost_RELEASE_ABI_TAG = -\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1504 ] _boost_DEBUG_ABI_TAG = -d\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1567 ] _boost_LIBRARY_SEARCH_DIRS_RELEASE = /usr/include/lib;/usr/include/../lib;/usr/include/stage/lib;PATHS;C:/boost/lib;C:/boost;/sw/local/lib_boost_LIBRARY_SEARCH_DIRS_DEBUG   = /usr/include/lib;/usr/include/../lib;/usr/include/stage/lib;PATHS;C:/boost/lib;C:/boost;/sw/local/lib\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1756 ] Searching for RANDOM_LIBRARY_RELEASE: libboost_random-gcc73-mt-1_65_1;libboost_random-gcc73-mt;libboost_random-mt-1_65_1;libboost_random-mt;libboost_random\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1809 ] Searching for RANDOM_LIBRARY_DEBUG: libboost_random-gcc73-mt-d-1_65_1;libboost_random-gcc73-mt-d;libboost_random-mt-d-1_65_1;libboost_random-mt-d;libboost_random-mt;libboost_random\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1756 ] Searching for FILESYSTEM_LIBRARY_RELEASE: libboost_filesystem-gcc73-mt-1_65_1;libboost_filesystem-gcc73-mt;libboost_filesystem-mt-1_65_1;libboost_filesystem-mt;libboost_filesystem\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1809 ] Searching for FILESYSTEM_LIBRARY_DEBUG: libboost_filesystem-gcc73-mt-d-1_65_1;libboost_filesystem-gcc73-mt-d;libboost_filesystem-mt-d-1_65_1;libboost_filesystem-mt-d;libboost_filesystem-mt;libboost_filesystem\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1756 ] Searching for SERIALIZATION_LIBRARY_RELEASE: libboost_serialization-gcc73-mt-1_65_1;libboost_serialization-gcc73-mt;libboost_serialization-mt-1_65_1;libboost_serialization-mt;libboost_serialization\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1809 ] Searching for SERIALIZATION_LIBRARY_DEBUG: libboost_serialization-gcc73-mt-d-1_65_1;libboost_serialization-gcc73-mt-d;libboost_serialization-mt-d-1_65_1;libboost_serialization-mt-d;libboost_serialization-mt;libboost_serialization\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1756 ] Searching for SYSTEM_LIBRARY_RELEASE: libboost_system-gcc73-mt-1_65_1;libboost_system-gcc73-mt;libboost_system-mt-1_65_1;libboost_system-mt;libboost_system\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1809 ] Searching for SYSTEM_LIBRARY_DEBUG: libboost_system-gcc73-mt-d-1_65_1;libboost_system-gcc73-mt-d;libboost_system-mt-d-1_65_1;libboost_system-mt-d;libboost_system-mt;libboost_system\n-- [ /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:1883 ] Boost_FOUND = 1\nCMake Error at /opt/clion-2018.2/bin/cmake/linux/share/cmake-3.12/Modules/FindBoost.cmake:2044 (message):\n  Unable to find the requested Boost libraries.\n\n  Boost version: 1.65.1\n\n  Boost include path: /usr/include\n\n  Could not find the following static Boost libraries:\n\n          libboost_random\n          libboost_filesystem\n          libboost_serialization\n\n  Some (but not all) of the required Boost libraries were found.  You may\n  need to install these additional Boost libraries.  Alternatively, set\n  BOOST_LIBRARYDIR to the directory containing Boost libraries or BOOST_ROOT\n  to the location of Boost.\nCall Stack (most recent call first):\n  CMakeLists.txt:49 (find_package)\n\n\n-- Found wxWidgets: -L/usr/local/lib;-pthread;;;-lwx_baseu_net-3.1;-lwx_gtk3u_gl-3.1;-lwx_gtk3u_core-3.1;-lwx_baseu-3.1;-lwx_gtk3u_webview-3.1;-lwx_gtk3u_adv-3.1 (found version \"3.1.1\") \n-- Configuring incomplete, errors occurred!\nSee also \"/home/dave/CLionProjects/FNDice-win/cmake-build-debug/CMakeFiles/CMakeOutput.log\".\n\n[Failed to reload]\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1534955567, "post_id": 51971189, "comment_id": 90893226, "body": "Search <a href=\"https://softwarerecs.stackexchange.com\">Software Recommendations</a> for &quot;big number c++&quot;."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1534957124, "post_id": 51971189, "comment_id": 90894042, "body": "Use a bignum library. <a href=\"https://gmplib.org\" rel=\"nofollow noreferrer\">GMP</a> is <i>one</i> such. Many others exist."}], "owner": {"reputation": 1, "user_id": 6364594, "user_type": "registered", "profile_image": "https://graph.facebook.com/1761871454046464/picture?type=large", "display_name": "Fatma Hamdy", "link": "https://stackoverflow.com/users/6364594/fatma-hamdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1534954973, "answer_count": 0, "score": 0, "last_activity_date": 1534954878, "creation_date": 1534954878, "question_id": 51971189, "link": "https://stackoverflow.com/questions/51971189/big-numbers-and-integers-with-100-digits-how-can-i-deal-with-it", "closed_reason": "Duplicate", "title": "Big numbers and integers with 100 digits how can I deal with it", "body": "<p>I am trying to do some operations on an integer which is smaller than or equal to 10^100 so how can I read this number and store it </p>\n"}, {"tags": ["c++", "c++14"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1534954670, "post_id": 51971003, "comment_id": 90892714, "body": "Are you asking if it&#39;s better to refactor common code so that you can just call a function instead of copying the same code in multiple places? Yes."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1534954888, "post_id": 51971003, "comment_id": 90892842, "body": "@Barry Probably I am asking about the difference between std::tie and std::forward_as_tuple."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 4, "creation_date": 1534955018, "post_id": 51971003, "comment_id": 90892916, "body": "What do you mean &quot;probably&quot;? If the question is &quot;what is the difference between <code>tie</code> and <code>forward_as_tuple</code>?&quot; can you make that the question?"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1534955590, "post_id": 51971003, "comment_id": 90893236, "body": "@Barry Saying more exactly, I did not quite understand what std::forward_as_tuple is. Currently my idea is that I should better implement as_tuple() with std::tie, at least it works fine."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1534956292, "post_id": 51971003, "comment_id": 90893615, "body": "Does that rewrite of your question match what you&#39;re trying to figure out?"}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1534956692, "post_id": 51971003, "comment_id": 90893822, "body": "@Barry Yes. Currently I replaced std::forward_as_tuple() with std::tie() in my code, but I am not 100% sure yet."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534956805, "post_id": 51971003, "comment_id": 90893875, "body": "Would this code with <code>std::tie()</code> compile? Method is const but <code>tie</code> builds lvalue references."}, {"owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534956943, "post_id": 51971003, "comment_id": 90893942, "body": "@Slava Yes, the code compiles and works. I do not see a reason why I should avoid const lvalue references. They are something like const A &amp;, that are good things, aren&#39;t they?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534957032, "post_id": 51971003, "comment_id": 90893996, "body": "@AlexeyStarinsky I did not say they are bad, I had doubt it would compile, as <code>std::tie</code> should make lvalue refs. I could be wrong."}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534956920, "post_id": 51971629, "comment_id": 90893936, "body": "&quot;If all of your inputs are lvalues&quot; there are no lvalues here, am I wrong?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1534957169, "post_id": 51971629, "comment_id": 90894070, "body": "@Slava We&#39;re doing like <code>tie(a, b, c)</code> where those are member names, which are lvalues."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534957217, "post_id": 51971629, "comment_id": 90894093, "body": "That method is const, so <code>this-&gt;a</code> is not an lvalue and so on, is it?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 4, "creation_date": 1534957290, "post_id": 51971629, "comment_id": 90894133, "body": "@Slava It&#39;s still an lvalue... it&#39;s just <code>const</code>. Those concepts are orthogonal."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534957348, "post_id": 51971629, "comment_id": 90894164, "body": "Yea got it, this terminology became so confusing over time. lvalue used to be what you can put on the left of <code>=</code> and now it all mess."}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 5, "creation_date": 1534959202, "post_id": 51971629, "comment_id": 90895020, "body": "@Slava lvalue stopped meaning &quot;left of assignment&quot; somewhere in the 1970s, when it got into C"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 1, "creation_date": 1534959530, "post_id": 51971629, "comment_id": 90895164, "body": "@Cubbi they should stop using term &quot;lvalue&quot; at the same time."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 4, "creation_date": 1535024199, "post_id": 51971629, "comment_id": 90919108, "body": "@slava think of them as <b>L</b>ovely values and pi<b>rrrr</b>ate values if that helps."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 8, "last_activity_date": 1534956502, "creation_date": 1534956502, "answer_id": 51971629, "question_id": 51971003, "link": "https://stackoverflow.com/questions/51971003/what-is-the-difference-between-stdtie-and-stdforward-as-tuple/51971629#51971629", "title": "What is the difference between std::tie and std::forward_as_tuple", "body": "<p>Let's just look at the signatures. <a href=\"https://en.cppreference.com/w/cpp/utility/tuple/tie\" rel=\"noreferrer\"><code>std::tie()</code></a> is:</p>\n\n<blockquote>\n<pre><code>template&lt; class... Types &gt;\nconstexpr tuple&lt;Types&amp;...&gt; tie( Types&amp;... args ) noexcept;\n</code></pre>\n</blockquote>\n\n<p>whereas <a href=\"https://en.cppreference.com/w/cpp/utility/tuple/forward_as_tuple\" rel=\"noreferrer\"><code>std::forward_as_tuple()</code></a> is:</p>\n\n<blockquote>\n<pre><code>template&lt; class... Types &gt;\nconstexpr tuple&lt;Types&amp;&amp;...&gt; forward_as_tuple( Types&amp;&amp;... args ) noexcept;\n</code></pre>\n</blockquote>\n\n<p>The only difference is that the former accepts only lvalues whereas the latter accepts lvalues and rvalues. If all of your inputs are lvalues, as they are in your use-case, they are exactly equivalent. </p>\n\n<p><code>std::tie()</code> is largely intended as the left-hand side of assignment (e.g. <code>std::tie(a, b) = foo;</code> to unpack a <code>pair</code>), whereas <code>std::forward_as_tuple()</code> is largely intended to pass things around in functions to avoid copies. But they can both be used to solve this problem. <code>tie</code> is obviously quite a bit shorter, and arguably more well-known (the cppreference example for <code>tie</code> uses it to implement <code>operator&lt;</code>), so that would get my vote.</p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 3351974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b8332bfceadbfb18ad4a04f542a1d7?s=128&d=identicon&r=PG", "display_name": "Prashant Nidgunde", "link": "https://stackoverflow.com/users/3351974/prashant-nidgunde"}, "is_accepted": false, "score": 0, "last_activity_date": 1609652126, "last_edit_date": 1609652126, "creation_date": 1609642557, "answer_id": 65546240, "question_id": 51971003, "link": "https://stackoverflow.com/questions/51971003/what-is-the-difference-between-stdtie-and-stdforward-as-tuple/65546240#65546240", "title": "What is the difference between std::tie and std::forward_as_tuple", "body": "<p><a href=\"https://www.fluentcpp.com/2020/10/16/tie-make_tuple-forward_as_tuple-how-to-build-a-tuple-in-cpp/\" rel=\"nofollow noreferrer\">Here</a> is a nice post on the same subject.</p>\n<p>From the article in the link:</p>\n<p>In summary, when you need to build a tuple, use:</p>\n<ol>\n<li><code>std::make_tuple</code> if you need values in the returned tuple,</li>\n<li><code>std::tie</code> if you need lvalue references in the returned tuple,</li>\n<li><code>std::forward_as_tuple</code> if you need to keep the types of references of the inputs to build the tuple.</li>\n</ol>\n"}], "owner": {"reputation": 2463, "user_id": 9261322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b650360d7c40aefdce125dcf8eb3ac37?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Starinsky", "link": "https://stackoverflow.com/users/9261322/alexey-starinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 2, "accepted_answer_id": 51971629, "answer_count": 2, "score": 13, "last_activity_date": 1609652126, "creation_date": 1534954198, "last_edit_date": 1534956248, "question_id": 51971003, "link": "https://stackoverflow.com/questions/51971003/what-is-the-difference-between-stdtie-and-stdforward-as-tuple", "title": "What is the difference between std::tie and std::forward_as_tuple", "body": "<p>For a given class, if I want to write all the comparison operators, to avoid code duplication, I would write them something like this:</p>\n\n<pre><code>class B {\npublic:\n    bool operator==(Type const&amp; rhs) const {\n        return as_tuple() == rhs.as_tuple();\n    }\n\n    bool operator!=(Type const&amp; rhs) const {\n        return as_tuple() != rhs.as_tuple();\n    }\n\n    // .. and same for other operators ..\n\nprivate:\n    auto as_tuple() const {\n        return std::tie(a, b, c); // all the members\n    }\n};\n</code></pre>\n\n<p>I could implement <code>as_tuple()</code> there with <code>std::tie()</code> or I could implement it with <code>std::forward_as_tuple()</code>. Is there a difference? Which should I prefer?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534954305, "post_id": 51970988, "comment_id": 90892473, "body": "What do you mean by <code>calling heap pointers</code>?"}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1534954306, "post_id": 51970988, "comment_id": 90892475, "body": "Why do you feel the need to do this? Are you worried that by not &quot;removing an array that was on the stack declared in main()&quot; you&#39;d have a memory leak? If so, why do you think this?"}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1534954619, "post_id": 51970988, "comment_id": 90892679, "body": "Why do you want to do this anyway?  If you want to destroy something on the stack, you need to let it go out of scope."}, {"owner": {"reputation": 183, "user_id": 9830530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a39ca606d760383b2876130c9533234?s=128&d=identicon&r=PG&f=1", "display_name": "TrevorLee", "link": "https://stackoverflow.com/users/9830530/trevorlee"}, "edited": false, "score": 0, "creation_date": 1534955127, "post_id": 51970988, "comment_id": 90892975, "body": "If someone was writing code for an embedded system that would be running for a very long time and used stack variables overlooking a destructor wouldnt it be a bad?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 4, "creation_date": 1534955175, "post_id": 51970988, "comment_id": 90893002, "body": "You <i>could</i> wrap it in a scope (<code>{}</code>). It&#39;ll be destroyed when the scope ends."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1534955365, "post_id": 51970988, "comment_id": 90893110, "body": "Destructors work on arrays, just like they work on structs (except of course the destructor will be called multiple times, once for each item in the array)."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1534955549, "post_id": 51970988, "comment_id": 90893212, "body": "If you want control over when it&#39;s destroyed, don&#39;t create it on the stack. If it&#39;s created on the stack, it gets destroyed when the stack is destroyed."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1534955668, "post_id": 51970988, "comment_id": 90893290, "body": "Reminder:  Compiler may remove &quot;stack&quot; variables through optimization.  Also, the compiler may use registers instead of declaring variables on the stack.  Register memory area is usually different than stack space on most processors."}, {"owner": {"reputation": 481, "user_id": 6713871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d0cf46b08a63241386786e74ae4b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Rollins", "link": "https://stackoverflow.com/users/6713871/chris-rollins"}, "edited": false, "score": 0, "creation_date": 1534955694, "post_id": 51970988, "comment_id": 90893310, "body": "Keep in mind that the stack is... literally a stack. You can&#39;t simply pick and choose variables to free. You have to free whatever is above the variable on the stack as well. This is also true in assembly. So if you want assembly level control of the stack, you basically have it with a scope."}], "answers": [{"comments": [{"owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "edited": false, "score": 1, "creation_date": 1534957855, "post_id": 51971041, "comment_id": 90894417, "body": "Why are you saying that? Of course you can clear a local variable. You just need to create another local scope within your current scope, and declare your variable there. In fact, a lot of RAII idiom functionality hinges scope locality."}], "tags": [], "owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "is_accepted": true, "score": 2, "last_activity_date": 1534954350, "creation_date": 1534954350, "answer_id": 51971041, "question_id": 51970988, "link": "https://stackoverflow.com/questions/51970988/clearing-stack-memory-allocated-in-main/51971041#51971041", "title": "Clearing stack memory allocated in main()?", "body": "<p>No, you can't really remove a variable out of the current, local scope.</p>\n\n<p>It's not something you should be concerned with - the compiler takes care of everything there.</p>\n\n<p>If you are concerned about privacy, you can of course blank the variable out after use.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1534955139, "last_edit_date": 1534955139, "creation_date": 1534954643, "answer_id": 51971126, "question_id": 51970988, "link": "https://stackoverflow.com/questions/51970988/clearing-stack-memory-allocated-in-main/51971126#51971126", "title": "Clearing stack memory allocated in main()?", "body": "<blockquote>\n  <p>I wanted to remove an array that was on the stack declared in main() is it possible? </p>\n</blockquote>\n\n<p>Simply let the execution go out of the scope where the automatic variable is declared:</p>\n\n<pre><code>int main() {\n    {\n        int arr[10];\n    }\n    // arr is destroyed, and further local variables can reuse its memory\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "is_accepted": false, "score": 4, "last_activity_date": 1534956039, "last_edit_date": 1534956039, "creation_date": 1534955647, "answer_id": 51971402, "question_id": 51970988, "link": "https://stackoverflow.com/questions/51970988/clearing-stack-memory-allocated-in-main/51971402#51971402", "title": "Clearing stack memory allocated in main()?", "body": "<blockquote>\n  <p>I wanted to remove an array that was on the stack declared in main()\n  is it possible?</p>\n</blockquote>\n\n<p>Yes.  </p>\n\n<p>In main() (and most anywhere you use an automatic variable), you can trigger a dtor by closing the containing scope.</p>\n\n<p>Example:</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n   int retVal = 0;\n   int arr[10];\n   T610_t  t610;\n   retVal = t610.exec(argc, argv);\n   // ...\n   // ...  // t610 exists to end of main() scope.\n   // ...  // arr[10] exists to end of main() scope\n   return retVal;\n}\n</code></pre>\n\n<p>Instance t610 (of the user defined T610_t type) lasts the life-time of the program, even when not used after the exec() returns retVal;</p>\n\n<hr>\n\n<p>In contrast:</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n   int retVal = 0;\n   {\n      int arr[10];\n      T610_t  t610;\n      retVal = t610.exec(argc, argv);\n   }\n   // ...   // no t610 instance exists, and arr[] is no longer accessible\n   // ...\n   // ...\n   // ...\n   return retVal;\n}\n</code></pre>\n\n<p>The dtor of instance t610 is called at the close-brace after exec() returns retVal.  arr[10] also no longer exists.</p>\n\n<p>All the lines after the close brace do not have access to T610_t, nor arr[10], and any automatic memory grabbed in the 'small scope' is 'released' for re-use.  (for instance, another T610_t instance...)</p>\n\n<p>Any 'clearing' of the space used by T610_t is dependent on what the dtor does and what you mean by clearing.  Thus, for instance, an array data attribute of T610_t can be filled with 0's (to 'clear' it), and the dtor also releases the memory for re-use.  Remember, do no delete when you did no 'new'.  </p>\n"}, {"tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 2, "last_activity_date": 1534956100, "last_edit_date": 1534956100, "creation_date": 1534955754, "answer_id": 51971425, "question_id": 51970988, "link": "https://stackoverflow.com/questions/51970988/clearing-stack-memory-allocated-in-main/51971425#51971425", "title": "Clearing stack memory allocated in main()?", "body": "<p>A semi-answer to demonstrate a trick the actual answers neglected. (Edit: Neglect changed by the time this was posted)</p>\n\n<p>If you have a large block of memory that you allocated on the stack (an Automatic allocation) and you need that memory back without returning from the function, you can introduce a new scope by calling another function </p>\n\n<pre><code>int get_and_compute()\n{ \n    int array[1024*1024];\n    read_in_a_lot_of_inputs(array);\n    return compute_stuff_with__array(array);\n} \n\nint main()\n{\n    int result = get_and_compute();\n    // now you have enough memory to call \n    job_that_takes_a_lot_of_RAM(result);\n}\n</code></pre>\n\n<p>Or by surrounding the code in question with a set of braces</p>\n\n<pre><code>int main()\n{\n    int result = 0;\n    { //introduce a new scope\n        int array[1024*1024];\n        read_in_a_lot_of_inputs(array);\n        result = compute_stuff_with__array(array);\n    } // array goes out of scope here\n    // now you have enough memory to call \n    job_that_takes_a_lot_of_RAM(result);\n}\n</code></pre>\n\n<p>Most of the time I prefer option 1, adding a function, but there are times where the extra function doesn't make much sense. Pick the option that is easiest to read, write, and maintain.</p>\n"}], "owner": {"reputation": 183, "user_id": 9830530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a39ca606d760383b2876130c9533234?s=128&d=identicon&r=PG&f=1", "display_name": "TrevorLee", "link": "https://stackoverflow.com/users/9830530/trevorlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 51971041, "answer_count": 4, "score": -1, "last_activity_date": 1534956100, "creation_date": 1534954154, "question_id": 51970988, "link": "https://stackoverflow.com/questions/51970988/clearing-stack-memory-allocated-in-main", "title": "Clearing stack memory allocated in main()?", "body": "<p>I've been calling heap pointers now for as long as I can remember, which in turn has caused me to think about their implications while writing and what I realised was I have no knowledge on how or even if it is possible to clear a stack variable declared within main() from memory once it has been allocated. </p>\n\n<p>Clearly I can just use a struct and destructor or similar, which I would but lets for say I wanted to remove an array that was on the stack declared in main()  is it possible? </p>\n"}, {"tags": ["c++", "math", "boost", "odeint"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1534954467, "post_id": 51970947, "comment_id": 90892567, "body": "Impossible to answer without MCVE."}, {"owner": {"reputation": 1117, "user_id": 918337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4619908b1aba55646776b672219312bf?s=128&d=identicon&r=PG", "display_name": "pbx", "link": "https://stackoverflow.com/users/918337/pbx"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534954743, "post_id": 51970947, "comment_id": 90892759, "body": "Well in fact I thought this to be a MCVE. Am I wrong? Just include blaze and boost into the source code and compile it. Then the error should show up. I might be wrong. If yes, please narrow what is needed further."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534954786, "post_id": 51970947, "comment_id": 90892783, "body": "An MCVE is something which can be copied from your example and pasted into  editor and than compiled."}, {"owner": {"reputation": 1117, "user_id": 918337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4619908b1aba55646776b672219312bf?s=128&d=identicon&r=PG", "display_name": "pbx", "link": "https://stackoverflow.com/users/918337/pbx"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1534955207, "post_id": 51970947, "comment_id": 90893018, "body": "I might miss something but I think it should work now as long as blaze and boost are available on the system"}], "answers": [{"tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": false, "score": 0, "last_activity_date": 1534955273, "creation_date": 1534955273, "answer_id": 51971305, "question_id": 51970947, "link": "https://stackoverflow.com/questions/51970947/why-cant-the-template-argument-be-deduced/51971305#51971305", "title": "Why can&#39;t the template argument be deduced?", "body": "<p>With certain changes this compiles fine</p>\n\n<pre><code>#include &lt;complex&gt;\n#include &lt;vector&gt;\n#include &lt;boost/numeric/odeint.hpp&gt;\n\nclass ODESystem {\npublic:\n    using Complex =  float ;\n    using StateVector = std::vector&lt;Complex&gt;;\n    void operator()(const StateVector &amp;x, StateVector &amp;dxdt, const double t)\n    {}\n};\nbool operator&gt;(const std::complex&lt; float &gt; &amp; f, const std::complex&lt; float &gt; &amp; d)\n{\n    return false;\n}\nint main(int argc, char *argv[])\n{\n    ODESystem sys;\n    ODESystem::StateVector h(3UL, 7.0F);\n    // ODESystem sys is properly initialized beforehand\n    boost::numeric::odeint::integrate(sys, h, 0., 10., .1);\n}\n</code></pre>\n\n<p>just changing to </p>\n\n<pre><code>using Complex =  std::complex&lt;float&gt; ;\n</code></pre>\n\n<p>and you get into trouble because you will have to refine operator> for complex and pow...</p>\n\n<p>As for your compilation error have you forgot any blaze header ?</p>\n"}], "owner": {"reputation": 1117, "user_id": 918337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4619908b1aba55646776b672219312bf?s=128&d=identicon&r=PG", "display_name": "pbx", "link": "https://stackoverflow.com/users/918337/pbx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534955273, "creation_date": 1534954026, "last_edit_date": 1534955087, "question_id": 51970947, "link": "https://stackoverflow.com/questions/51970947/why-cant-the-template-argument-be-deduced", "title": "Why can&#39;t the template argument be deduced?", "body": "<p>I use odeint from the boost library and as a beginner in C++ do not understand the issue at hand. Given the following source code within a file called ODESystem.hpp</p>\n\n<pre><code>#include \"blaze/Math.h\"\nclass ODESystem {\n    public:\n        using Complex = std::complex&lt; Float &gt;;\n        using StateVector = blaze::DynamicVector&lt; Complex,\n                                                  blaze::columnVector &gt;;\n\n\n        void operator()(const StateVector &amp;x, StateVector &amp;dxdt, const double t);\n};\n\nvoid ODESystem::operator()(const ODESystem::StateVector &amp;x, ODESystem::StateVector &amp;dxdt, const double t) {\n        // don't do anything here.\n    }\n</code></pre>\n\n<p>as well as a simple call in main.cpp to odeint via</p>\n\n<pre><code>#include &lt;boost/numeric/odeint.hpp&gt;\nint main(int argc, char** argv) {\n    ODESystem::StateVector h( 3UL, 7.0F );\n    // ODESystem sys is properly initialized beforehand\n    boost::numeric::odeint::integrate(sys, h,0.,10.,.1);\n}\n</code></pre>\n\n<p>I cannot see why the compiler tells me </p>\n\n<blockquote>\n  <p>/usr/local/include/boost/numeric/odeint/integrate/integrate.hpp(53): note: this candidate was rejected because at least one template argument could not be deduced\n    integrate( System system , State &amp;start_state , Time start_time , Time end_time , Time dt , Observer observer )</p>\n</blockquote>\n\n<p>From what I have read here in similar posts it has to be connected to non-deducible context but I simply do not know enough to see where it applies here.</p>\n"}, {"tags": ["c++", "queue", "edx"], "comments": [{"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1534954136, "post_id": 51970898, "comment_id": 90892371, "body": "You should add the description as text; not as a link."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1534957139, "post_id": 51970898, "comment_id": 90894051, "body": "I think your detection for a full queue is wrong. Specifically, <code>if( size_&gt; (finish_time_.back() - request.arrival_time))</code>. The latter expressions shouldn&#39;t have anything to do with whether the buffer queue is full or not. Rather, shouldn&#39;t that be simply, <code>if (size_&gt; finish_time_.size())</code> (meaning, there is still room to buffer the request). Doing that, the expected output is achieved."}, {"owner": {"reputation": 72, "user_id": 10205270, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t_1QwVxo-0s/AAAAAAAAAAI/AAAAAAAAABk/xQMVIHe6lIU/photo.jpg?sz=128", "display_name": "Gokberk Yar", "link": "https://stackoverflow.com/users/10205270/gokberk-yar"}, "edited": false, "score": 0, "creation_date": 1534957678, "post_id": 51970898, "comment_id": 90894336, "body": "Really Thanks A lot it works, it was bugging me more than 2 hours."}], "owner": {"reputation": 72, "user_id": 10205270, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t_1QwVxo-0s/AAAAAAAAAAI/AAAAAAAAABk/xQMVIHe6lIU/photo.jpg?sz=128", "display_name": "Gokberk Yar", "link": "https://stackoverflow.com/users/10205270/gokberk-yar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534957631, "creation_date": 1534953863, "last_edit_date": 1534957631, "question_id": 51970898, "link": "https://stackoverflow.com/questions/51970898/queue-a-server-banner-behavior", "title": "Queue- a Server Banner Behavior", "body": "<p>This Question is from Edx-UCSanDiegoX: ALGS201x Data Structure\nFundamentals Programming Challenge 1-3: Network packet processing\nsimulation</p>\n\n<p>Hi Everyone, I have a very long question, I sincerely appreciate anyone who spend his/her precious time. Only <strong>Response Process(const Request &amp;request)</strong> implementation is asked in the question, rest is given.\nI having difficulty why Failing Test Case, I found the same answer with trying paper and pen :), maybe I made a silly mistake. Thank You. </p>\n\n<p><strong>Problem Description Task:</strong></p>\n\n<p>You are given a series of incoming network packets and your task is to simulate their processing. Packets arrive in some order. For each packet i , you know when it arrived Ai and the time it takes the processor to process it Pi (both in milliseconds). There is only one processor, and it processes the incoming packets in the order of their arrival. Of the processor started to process some packet, it doesn\u2019t interrupt or stop until it finishes the processing of this packet, and the processing of packet I takes exactly Pi milliseconds. </p>\n\n<p>The computer processing the packets has a network buffer of fixed size S. When packets arrive, they are stored in the buffer before being processed. However, if the buffer is full when a packet arrives (there are S packets which are arrived before this packet, and the computer hasn\u2019t finished processing any of them), it is dropped and won\u2019t be processed at all. If several packets arrive at the same time, they are all stored in the buffer (some of them may dropped because of their arrival, and it starts processing the next available packet from the buffer as soon as it finishes processing the previous one. If at some point the computer is not busy, and there are no packets in the buffer, the computer just waits for the next packet to arrive. Note that a packet leaves the buffer and free the space in the buffer as soon as computer finishes processing it.</p>\n\n<p><strong>Input Format:</strong></p>\n\n<p>The First line of input contains the size S of the buffer and the number n of incoming network packets. Each of the next n lines contains two numbers I-th line contains the time of arrival Ai and processing tine Pi (both in ms) of the the I-th packet. It is guaranteed that the sequence of arrival times is non-decreasing. (However, it can contain the exact same times of arrival in milliseconds in this case the packet which is earlier in the input is considered to have arrived earlier.</p>\n\n<p><strong>Output Format:</strong> For each packet output either the moment of the time when the processor began processing it or -1 if the packet was dropped. (output is same order as input packets are given)</p>\n\n<p><strong>Sample Runs</strong></p>\n\n<p><strong><em>Sample 1</em></strong>\nInput:</p>\n\n<pre><code>1 0 \n</code></pre>\n\n<p>Output:</p>\n\n<p>If there are no packets, you should not output anything</p>\n\n<hr>\n\n<p><strong><em>Sample 2</em></strong></p>\n\n<p>Input:</p>\n\n<pre><code>1 1\n0 0 \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0\n</code></pre>\n\n<p>The only packet arrived at time 0. And computer started processing it. </p>\n\n<hr>\n\n<p><strong><em>Sample 3</em></strong></p>\n\n<p>Input:</p>\n\n<pre><code>1 2\n0 1\n0 1\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 \n1\n</code></pre>\n\n<p>The first packet arrived at time 0. the second packet also arrived at time 0 , but was dropped. Because the network buffer has size 1 and it was full with first packet already. The first packet started processing at time 0 , second was not processed at all.</p>\n\n<hr>\n\n<p><strong><em>Sample 4</em></strong></p>\n\n<p>Input :</p>\n\n<pre><code>1 2\n0 1\n1 1\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0\n1\n</code></pre>\n\n<p>The first packet arrived at time 0 , the computer started processing it immediately and finished at time 1 .The second packet arrived at time 1  and the computer started processing it immediately.</p>\n\n<hr>\n\n<p><strong><em>Failing Test Case:</em></strong></p>\n\n<p>Inputs:</p>\n\n<pre><code>3 6\n0 2\n1 2\n2 2\n3 2\n4 2\n5 2\n</code></pre>\n\n<p>My Output:</p>\n\n<pre><code>0\n2\n4\n-1\n6\n-1\n</code></pre>\n\n<p>Correct Output:</p>\n\n<pre><code>0\n2\n4\n6\n8\n-1\n</code></pre>\n\n<hr>\n\n<p><strong>The Code</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;queue&gt;\n#include &lt;vector&gt;\n\nstruct Request {\n    Request(int arrival_time, int process_time) :\n        arrival_time(arrival_time),\n        process_time(process_time)\n    {}\n\n    int arrival_time;\n    int process_time;\n};\n\nstruct Response {\n    Response(bool dropped, int start_time) :\n        dropped(dropped),\n        start_time(start_time)\n    {}\n\n    bool dropped;\n    int start_time;\n};\n\nclass Buffer {\npublic:\n    Buffer(int size) :\n        size_(size),\n        finish_time_()\n    {}\n\n    Response Process(const Request &amp;request)\n    {\n        while (!finish_time_.empty() &amp;&amp; finish_time_.front() &lt;= request.arrival_time)\n            finish_time_.pop();\n\n        if (finish_time_.empty())\n        {\n            finish_time_.push(request.arrival_time + request.process_time);\n            return Response(false, request.arrival_time);\n        }\n        else\n        {\n            if (size_&gt; (finish_time_.back() - request.arrival_time))\n            {\n                int before = finish_time_.back();\n                finish_time_.push(before + request.process_time);\n                return Response(false, before);\n            }\n            else\n            {\n                return Response(true, 5);\n            }\n        }\n\n\n    }\nprivate:\n    int size_;\n    std::queue &lt;int&gt; finish_time_;\n};\n\nstd::vector &lt;Request&gt; ReadRequests()\n{\n    std::vector &lt;Request&gt; requests;\n    int count;\n    std::cin &gt;&gt; count;\n    for (int i = 0; i &lt; count; ++i) {\n        int arrival_time, process_time;\n        std::cin &gt;&gt; arrival_time &gt;&gt; process_time;\n        requests.push_back(Request(arrival_time, process_time));\n    }\n    return requests;\n}\n\nstd::vector &lt;Response&gt; ProcessRequests(const std::vector &lt;Request&gt; &amp;requests, Buffer *buffer)\n{\n    std::vector &lt;Response&gt; responses;\n    for (int i = 0; i &lt; requests.size(); ++i)\n        responses.push_back(buffer-&gt;Process(requests[i]));\n    return responses;\n}\n\nvoid PrintResponses(const std::vector &lt;Response&gt; &amp;responses)\n{\n    for (int i = 0; i &lt; responses.size(); ++i)\n        std::cout &lt;&lt; (responses[i].dropped ? -1 : responses[i].start_time) &lt;&lt; std::endl;\n}\n\nint main() {\n    int size;\n    std::cin &gt;&gt; size;\n    std::vector &lt;Request&gt; requests = ReadRequests();\n\n    Buffer buffer(size);\n    std::vector &lt;Response&gt; responses = ProcessRequests(requests, &amp;buffer);\n\n    PrintResponses(responses);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9635979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f1e03e5696667cfaf4943fc5398f1fb?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyY", "link": "https://stackoverflow.com/users/9635979/jimmyy"}, "edited": false, "score": 0, "creation_date": 1535011251, "post_id": 51971081, "comment_id": 90911569, "body": "By the way. Maybe you know why I have difference between C# and C++ array data? I use: google::protobuf::FileDescriptorProto proto; ... proto.SerializeToArray(arr, size); arr differs from c# array."}, {"owner": {"reputation": 21, "user_id": 9635979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f1e03e5696667cfaf4943fc5398f1fb?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyY", "link": "https://stackoverflow.com/users/9635979/jimmyy"}, "edited": false, "score": 0, "creation_date": 1535011360, "post_id": 51971081, "comment_id": 90911628, "body": "Actually diff is small. C++ data size is 110, C# data size is 107. Most symbols are equals. In the middle of sequence I have difference."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 21, "user_id": 9635979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f1e03e5696667cfaf4943fc5398f1fb?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyY", "link": "https://stackoverflow.com/users/9635979/jimmyy"}, "edited": false, "score": 0, "creation_date": 1535013038, "post_id": 51971081, "comment_id": 90912528, "body": "Try deserializing the proto, then serializing it to text format (<a href=\"https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.text_format#TextFormat.PrintToString.details\" rel=\"nofollow noreferrer\"><code>TextFormat::PrintToString</code></a>), so you can see what the actual difference is. <code>protoc</code> can also do this conversion for you, when passed the path to the original <code>.proto</code> files that describe the message (<code>FileDescriptorProto</code> etc.)."}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1534954485, "creation_date": 1534954485, "answer_id": 51971081, "question_id": 51970851, "link": "https://stackoverflow.com/questions/51970851/c-protobuf-serializeddata/51971081#51971081", "title": "C++ protobuf SerializedData", "body": "<p>You can use <a href=\"https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.descriptor#FileDescriptor.CopyTo.details\" rel=\"nofollow noreferrer\"><code>FileDescriptor::CopyTo(FileDescriptorProto * proto)</code></a> to copy the contents to a <a href=\"https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.descriptor.pb#FileDescriptorProto\" rel=\"nofollow noreferrer\"><code>FileDescriptorProto</code></a>, which is a regular <code>Message</code> that you can serialize using any of the <a href=\"https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.message_lite#MessageLite\" rel=\"nofollow noreferrer\"><code>SerializeTo...</code></a> functions.</p>\n"}], "owner": {"reputation": 21, "user_id": 9635979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f1e03e5696667cfaf4943fc5398f1fb?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyY", "link": "https://stackoverflow.com/users/9635979/jimmyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592091625, "creation_date": 1534953666, "last_edit_date": 1536138321, "question_id": 51970851, "link": "https://stackoverflow.com/questions/51970851/c-protobuf-serializeddata", "title": "C++ protobuf SerializedData", "body": "<p>I need to get <code>serializedData</code> (like in C#) in C++ for <code>google::protobuf::FileDescriptor</code> object.</p>\n\n<p>In C++ code I have <code>google::protobuf::FileDescriptor</code> object. And I need to get something like <code>ByteString SerializedData</code> in C# (The original serialized binary form of this descriptor.)</p>\n\n<p>Does anyone know how to do it? Thank you.</p>\n"}, {"tags": ["c++", "usage-statistics"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 2, "creation_date": 1534954250, "post_id": 51970835, "comment_id": 90892442, "body": "I don&#39;t see why third thread is necessary. When second thread removes all entries which are older than current time - 60 s, why it cannot report the size when done with this? Actually, when watched function adds a new entry it could clean-up old entries directly afterwards, and report the size of vector when it&#39;s done. So, this could work even without any extra threads. (I see a potential problem source in any extra thread. So, I try to prevent multi-threading whenever there are no urgent reasons for this. May be, I&#39;m a bit paranoid...) ;-)"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1534954779, "post_id": 51970835, "comment_id": 90892780, "body": "do you care about the number of calls to this function within the last 1000ms; whatever the time might be, or do you care about the number of calls to this function in each 1000ms chunk?  The latter being much, much easier to do, and just as good for most purposes."}, {"owner": {"reputation": 521, "user_id": 3138095, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/645de30b4865f3b191d11b6a25385999?s=128&d=identicon&r=PG&f=1", "display_name": "charlesw", "link": "https://stackoverflow.com/users/3138095/charlesw"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1534954943, "post_id": 51970835, "comment_id": 90892880, "body": "@UKMonkey I am more concerned with a rolling total for the last 1000ms. Yes, the 1000ms chunks would be easier, but I need to be able to react quickly (within ~10ms range) if the rolling total gets to high."}, {"owner": {"reputation": 521, "user_id": 3138095, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/645de30b4865f3b191d11b6a25385999?s=128&d=identicon&r=PG&f=1", "display_name": "charlesw", "link": "https://stackoverflow.com/users/3138095/charlesw"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1534955161, "post_id": 51970835, "comment_id": 90892989, "body": "@Scheff You are right, I can cut down the number of threads.  The function that I&#39;m tracking in the first thread is called pretty frequently, so I was thinking about trying to minimize the amount of work in it. After thinking about it, doing everything in the main thread shouldn&#39;t add too much overhead."}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1534955207, "post_id": 51970835, "comment_id": 90893019, "body": "What granularity do you need (is +/-10ms okay)? And do you expect to be calling this function a lot (say more than 1000 times/second)?"}, {"owner": {"reputation": 521, "user_id": 3138095, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/645de30b4865f3b191d11b6a25385999?s=128&d=identicon&r=PG&f=1", "display_name": "charlesw", "link": "https://stackoverflow.com/users/3138095/charlesw"}, "reply_to_user": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1534955362, "post_id": 51970835, "comment_id": 90893109, "body": "@BenJones +/- 10ms is fine, and the function may be called between 50-2000 times/second"}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 1, "creation_date": 1534956583, "post_id": 51970835, "comment_id": 90893775, "body": "Perhaps you could hold a histogram of the calls holding number of calls in millisecond divisions of the second.  Then tracking the value would just involve summing the histogram.  The complicated part would be clearing out the bins, but that could be implemented by &quot;remembering&quot;  the timepoint of the previous function call, and updating whenever you &quot;touch&quot; the histogram."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1534966519, "post_id": 51970835, "comment_id": 90898311, "body": "This would be fun to do with Redis, then you could query independently of the running program and set keys with 60s timeouts."}], "owner": {"reputation": 521, "user_id": 3138095, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/645de30b4865f3b191d11b6a25385999?s=128&d=identicon&r=PG&f=1", "display_name": "charlesw", "link": "https://stackoverflow.com/users/3138095/charlesw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534953625, "creation_date": 1534953625, "question_id": 51970835, "link": "https://stackoverflow.com/questions/51970835/what-is-an-efficient-way-to-track-the-number-of-times-a-function-has-been-called", "title": "What is an efficient way to track the number of times a function has been called within the last minute?", "body": "<p>I am looking for a way to track the number of times that a function has been called within the last minute.</p>\n\n<p>Every second, I would like to know how many times a function has been called within the last 60 seconds. What is an efficient way to do this?</p>\n\n<p>I thought about using several threads and a vector of timestamps.  Every time the function is called in the first thread, a timestamp item is added to the vector. Another thread watches the end of the vector and removes the last item whenever it is older than 60 seconds.  A third thread would then check the size of the vector every second.  </p>\n\n<p>However, this seems like it may be inefficient. What is a better way to track this value?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1534952926, "post_id": 51970314, "comment_id": 90891640, "body": "Worth reading: David&#39;s <i>stellar</i> answer to this question: <a href=\"https://stackoverflow.com/a/4661372/1322972\">overloading friend operator&lt;&lt; for template class</a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1534953220, "post_id": 51970314, "comment_id": 90891822, "body": "You&#39;re describing the LAST error message emitted by your compiler, and ignoring errors that precede it.   <code>get_a()</code> and <code>get_b()</code> member functions of (templated) <code>Test</code> are not  <code>const</code>.  Second argument of <code>operator&lt;&lt;()</code> is a <code>const</code> reference, so the calls <code>t0.get_a()</code> and <code>t0.get_b()</code> are invalid.   This will result in error messages you are ignoring.  This prevents instantiating the <code>operator&lt;&lt;()</code> - and the last error message you see.   Voting to close as a typo  (since leaving out a <code>const</code> is not much more than a typo)."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9721723, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozT2YQIueL8/AAAAAAAAAAI/AAAAAAAABS0/1vuoHoKKvGQ/photo.jpg?sz=128", "display_name": "Huy V\u0169", "link": "https://stackoverflow.com/users/9721723/huy-v%c5%a9"}, "edited": false, "score": 2, "creation_date": 1534952330, "post_id": 51970387, "comment_id": 90891277, "body": "why do you remove the friend function, sir?"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "reply_to_user": {"reputation": 45, "user_id": 9721723, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozT2YQIueL8/AAAAAAAAAAI/AAAAAAAABS0/1vuoHoKKvGQ/photo.jpg?sz=128", "display_name": "Huy V\u0169", "link": "https://stackoverflow.com/users/9721723/huy-v%c5%a9"}, "edited": false, "score": 0, "creation_date": 1534952822, "post_id": 51970387, "comment_id": 90891575, "body": "@HuyV\u0169 I trust he removed it because you declared it but defined entirely different function."}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "edited": false, "score": 0, "creation_date": 1534952938, "post_id": 51970387, "comment_id": 90891651, "body": "It does not serve any purpose in this case. operator&lt;&lt; needs to be static and you do not use any private methods of your class"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 45, "user_id": 9721723, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozT2YQIueL8/AAAAAAAAAAI/AAAAAAAABS0/1vuoHoKKvGQ/photo.jpg?sz=128", "display_name": "Huy V\u0169", "link": "https://stackoverflow.com/users/9721723/huy-v%c5%a9"}, "edited": false, "score": 0, "creation_date": 1534953184, "post_id": 51970387, "comment_id": 90891802, "body": "@HuyV\u0169 Make <code>operator &lt;&lt;</code> utilize the private <code>a</code> and <code>b</code> members of <code>Test</code> directly and the friending becomes <i>highly</i> relevant (and required)."}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "edited": false, "score": 0, "creation_date": 1534953470, "post_id": 51970387, "comment_id": 90891959, "body": "In that case you define your friend function in your class: friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; output, const Test&lt;T1, T2&gt;&amp; t0)     {         output &lt;&lt; t0.get_a() &lt;&lt; &quot;, &quot; &lt;&lt; t0.get_b() &lt;&lt; std::endl;         return output;     }"}, {"owner": {"reputation": 45, "user_id": 9721723, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozT2YQIueL8/AAAAAAAAAAI/AAAAAAAABS0/1vuoHoKKvGQ/photo.jpg?sz=128", "display_name": "Huy V\u0169", "link": "https://stackoverflow.com/users/9721723/huy-v%c5%a9"}, "edited": false, "score": 0, "creation_date": 1534953753, "post_id": 51970387, "comment_id": 90892156, "body": "Thank you for your support"}], "tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": false, "score": 0, "last_activity_date": 1534952201, "creation_date": 1534952201, "answer_id": 51970387, "question_id": 51970314, "link": "https://stackoverflow.com/questions/51970314/print-out-a-class-using-template/51970387#51970387", "title": "Print out a class using template", "body": "<p>Here is an edit of the compiling code. I added const to get methods and removed the friend std::ostream&amp; operator&lt;&lt;</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nconst int LENGTH = 5;\n\ntemplate &lt;typename T1, typename T2&gt;\nclass Test {\nprivate:\n    T1 a;\n    T2 b;\n\npublic:\n    void setData(T1 a, T2 b)\n    {\n        this-&gt;a = a;\n        this-&gt;b = b;\n    }\n    T1 get_a() const { return a; }\n    T2 get_b() const { return b; }\n    T2 sum() const;\n    Test operator*(const Test&amp; t0);\n};\n\ntemplate &lt;typename T1, typename T2&gt;\nT2 Test&lt;T1, T2&gt;::sum() const\n{\n    return a + b;\n}\n\ntemplate &lt;typename T1, typename T2&gt;\nTest&lt;T1, T2&gt; Test&lt;T1, T2&gt;::operator*(const Test&amp; t0)\n{\n    Test&lt;T1, T2&gt; t;\n    t.a = this-&gt;a * t0.a;\n    t.b = this-&gt;b * t0.b;\n    return t;\n}\n\ntemplate &lt;typename T1, typename T2&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; output, const Test&lt;T1, T2&gt;&amp; t0)\n{\n    output &lt;&lt; t0.get_a() &lt;&lt; \", \" &lt;&lt; t0.get_b() &lt;&lt; std::endl;\n    return output;\n}\n\nint main(int argc, char *argv[])\n{\n    Test&lt;int, float&gt; t1;\n    t1.setData(3, 4.5);\n    Test&lt;int, float&gt; t2;\n    t2.setData(5, 6.7);\n    Test&lt;int, float&gt; t3 = t1 * t2;\n    std::cout &lt;&lt; t1;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 2, "last_activity_date": 1534952642, "creation_date": 1534952642, "answer_id": 51970536, "question_id": 51970314, "link": "https://stackoverflow.com/questions/51970314/print-out-a-class-using-template/51970536#51970536", "title": "Print out a class using template", "body": "<p>What your friend declaration says is that for any particular instantiation of <code>Test</code> with types <code>T1</code> and <code>T2</code>, there is a <em>non-template</em> <code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; output, const Test&lt;T1, T2&gt;&amp; t0);</code>.\n(g++ provides a helpful warning about this.)</p>\n\n<p>But you defined a template function, which is not the same thing as what you declared.  </p>\n\n<p>You <em>could</em> define the operator inside the class, or make it a template, but you don't need a <code>friend</code> here at all since you're only using public members, so you can remove the whole friend declaration.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 9721723, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozT2YQIueL8/AAAAAAAAAAI/AAAAAAAABS0/1vuoHoKKvGQ/photo.jpg?sz=128", "display_name": "Huy V\u0169", "link": "https://stackoverflow.com/users/9721723/huy-v%c5%a9"}, "edited": false, "score": 0, "creation_date": 1534953331, "post_id": 51970619, "comment_id": 90891889, "body": "Thank you very much, sir :)"}], "tags": [], "owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1534953253, "last_edit_date": 1534953253, "creation_date": 1534952901, "answer_id": 51970619, "question_id": 51970314, "link": "https://stackoverflow.com/questions/51970314/print-out-a-class-using-template/51970619#51970619", "title": "Print out a class using template", "body": "<p>this complies</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nconst int LENGTH = 5;\n\ntemplate &lt;typename T1, typename T2&gt;\nclass Test;\n\ntemplate &lt;typename T1, typename T2&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; output, const Test&lt;T1, T2&gt;&amp; t0)\n{\n  output &lt;&lt; t0.get_a() &lt;&lt; \", \" &lt;&lt; t0.get_b() &lt;&lt; std::endl;\n  return output;\n}\n\ntemplate &lt;typename T1, typename T2&gt;\nclass Test {\nprivate:\n  T1 a;\n  T2 b;\n\npublic:\n  void setData(T1 a, T2 b)\n  {\n   this-&gt;a = a;\n   this-&gt;b = b;\n  }\n  T1 get_a() const { return a; }\n  T2 get_b() const { return b; }\n  T2 sum() const;\n  Test operator*(const Test&amp; t0);\n  friend std::ostream&amp; operator&lt;&lt; &lt;T1, T2&gt;(std::ostream&amp; output, const Test&lt;T1, T2&gt;&amp; t0);\n};\n\ntemplate &lt;typename T1, typename T2&gt;\nT2 Test&lt;T1, T2&gt;::sum() const\n{\n  return a + b;\n}\n\ntemplate &lt;typename T1, typename T2&gt;\nTest&lt;T1, T2&gt; Test&lt;T1, T2&gt;::operator*(const Test&amp; t0)\n{\n Test&lt;T1, T2&gt; t;\n t.a = this-&gt;a * t0.a;\n t.b = this-&gt;b * t0.b;\n return t;\n}\n\nint main(int argc, char *argv[])\n{\n  Test&lt;int, float&gt; t1;\n  t1.setData(3, 4.5);\n  Test&lt;int, float&gt; t2;\n  t2.setData(5, 6.7);\n  Test&lt;int, float&gt; t3 = t1 * t2;\n  std::cout &lt;&lt; t1;\n}\n</code></pre>\n\n<p>the issue was that the class was expecting a non template function so the template function wasn't instantiated and consequantly not found at link-time.</p>\n\n<p>modifications:</p>\n\n<p>explicitly specified in the friend declaration that it is a specialization with the <code>&lt;T1, T2&gt;</code></p>\n\n<p>put the template declaration above otherwise it won't be find to be instantiated</p>\n\n<p>forward declare above the <code>operator&lt;&lt;</code>'s definition.</p>\n\n<p>add the missing const on the getters.</p>\n"}], "owner": {"reputation": 45, "user_id": 9721723, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozT2YQIueL8/AAAAAAAAAAI/AAAAAAAABS0/1vuoHoKKvGQ/photo.jpg?sz=128", "display_name": "Huy V\u0169", "link": "https://stackoverflow.com/users/9721723/huy-v%c5%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1534953253, "creation_date": 1534951960, "question_id": 51970314, "link": "https://stackoverflow.com/questions/51970314/print-out-a-class-using-template", "title": "Print out a class using template", "body": "<p>I've got a problem when printing out all the values of the class</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nconst int LENGTH = 5;\n\ntemplate &lt;typename T1, typename T2&gt;\nclass Test {\nprivate:\n  T1 a;\n  T2 b;\n\npublic:\n  void setData(T1 a, T2 b)\n  {\n   this-&gt;a = a;\n   this-&gt;b = b;\n  }\n  T1 get_a() { return a; }\n  T2 get_b() { return b; }\n  T2 sum() const;\n  Test operator*(const Test&amp; t0);\n  friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; output, const Test&lt;T1, T2&gt;&amp; t0);\n};\n\ntemplate &lt;typename T1, typename T2&gt;\nT2 Test&lt;T1, T2&gt;::sum() const\n{\n  return a + b;\n}\n\ntemplate &lt;typename T1, typename T2&gt;\nTest&lt;T1, T2&gt; Test&lt;T1, T2&gt;::operator*(const Test&amp; t0)\n{\n Test&lt;T1, T2&gt; t;\n t.a = this-&gt;a * t0.a;\n t.b = this-&gt;b * t0.b;\n return t;\n}\n\ntemplate &lt;typename T1, typename T2&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; output, const Test&lt;T1, T2&gt;&amp; t0)\n{\n  output &lt;&lt; t0.get_a() &lt;&lt; \", \" &lt;&lt; t0.get_b() &lt;&lt; std::endl;\n  return output;\n}\n\nint main(int argc, char *argv[])\n{\n  Test&lt;int, float&gt; t1;\n  t1.setData(3, 4.5);\n  Test&lt;int, float&gt; t2;\n  t2.setData(5, 6.7);\n  Test&lt;int, float&gt; t3 = t1 * t2;\n  std::cout &lt;&lt; t1;\n}\n</code></pre>\n\n<p>The last line it show me an error \"undefined reference to operator&lt;&lt; ...\". I think the error comes from the friend function of the class but i don't know how to fix it.\nAnyone can help me, please. I appreciate for your support, thank you!</p>\n"}, {"tags": ["c++", "unit-testing"], "comments": [{"owner": {"reputation": 1174, "user_id": 1703915, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/3AnAB.png?s=128&g=1", "display_name": "Mark Davies", "link": "https://stackoverflow.com/users/1703915/mark-davies"}, "edited": false, "score": 2, "creation_date": 1534951855, "post_id": 51970212, "comment_id": 90891020, "body": "SO is probably not the place to ask this question, there are plenty of good resources out there for unit testing. SO is more for specific software problems, show us example and we can help."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1534951868, "post_id": 51970212, "comment_id": 90891030, "body": "Possible dup of: <a href=\"https://stackoverflow.com/questions/652292/what-is-unit-testing-and-how-do-you-do-it\" title=\"what is unit testing and how do you do it\">stackoverflow.com/questions/652292/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": -1, "last_activity_date": 1534952042, "creation_date": 1534952042, "answer_id": 51970340, "question_id": 51970212, "link": "https://stackoverflow.com/questions/51970212/how-to-write-a-unit-test/51970340#51970340", "title": "How to write a unit test", "body": "<blockquote>\n  <p>But what if inside calculateSmth() there are lots of formulas.</p>\n</blockquote>\n\n<p>Refactor the code and break out those formulas to separate functions and test them individually.</p>\n"}], "owner": {"reputation": 5, "user_id": 8784730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c376c3dbdcf85a50cfc9dfc92ed7da02?s=128&d=identicon&r=PG&f=1", "display_name": "qwerty62525", "link": "https://stackoverflow.com/users/8784730/qwerty62525"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1535035611, "creation_date": 1534951590, "last_edit_date": 1535035611, "question_id": 51970212, "link": "https://stackoverflow.com/questions/51970212/how-to-write-a-unit-test", "title": "How to write a unit test", "body": "<p>everyone.</p>\n\n<p>I'm new to unit testing and can't get the idea of it.</p>\n\n<p>I have a module that have a process() function. Inside process() function module does a lot of non-trivial job. The task is to check module's output.</p>\n\n<p>For example, there is a method calculateDistance() inside process() method that calculates distance value. Test requirement sounds like \"check that module calculates distance...\" </p>\n\n<p>As I understand I have to:</p>\n\n<ol>\n<li>Prepare input data</li>\n<li>Call module's process() method </li>\n<li>Calculate distance by hands </li>\n<li>Get module's output value for distance</li>\n<li>Compare this value to value calculated.</li>\n</ol>\n\n<p>But it is easy for some trivial cases, for example some ariphmetical operations. But what if inside calculateDistance() there are lots of formulas. How should I calculate this distance's value? Should I just copy all source code from calculateDistance() function to the test's code to calculate this value from step 3?</p>\n\n<p>Here is the source code example:</p>\n\n<pre><code>void process(PropertyList&amp; propList)\n{\n    m_properties = &amp;propList;\n    ...\n    for (int i = 0; i &lt; m_properties.propertiesCount; i++)\n    {\n        calculateDistance();\n    }\n}\n\nvoid calculateDistance(int indx)\n{\n    Property&amp; property = m_properties-&gt;properties[indx];\n    property.distance = 0;\n\n    for (int i = 0; i &lt; property.objectsCount - 1; i++)\n    {\n        property.distance += getDistanceBetweenObjs(i, i + 1);\n    }\n}\n\nint getDistanceBetweenObjects(indx1, indx2)\n{\n    // here is some complex algorithm of calculating the distance\n}\n</code></pre>\n\n<p>So, my question is: should I prepare input data where I know the resulting distance value and just compare this value to the output value? Or should I get input data structures, calculate distance value the same way as calculateDistance() method does (here is code duplication) and compare this value to the output distance? </p>\n"}, {"tags": ["c++", "c++11", "warnings", "compiler-warnings", "static-analysis"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 2, "creation_date": 1534951853, "post_id": 51970117, "comment_id": 90891017, "body": "What compiler are you using?"}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 2, "creation_date": 1534951925, "post_id": 51970117, "comment_id": 90891064, "body": "Declaring the main constructor <code>default</code> is a syntax error you need to correct. Only Default, Copy, and Move constructors may be declared <code>default</code>, non-Default Constructors may not."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 3, "creation_date": 1534952072, "post_id": 51970117, "comment_id": 90891146, "body": "I doubt there would be a compiler warning for this. Defaulted member being deleted is quite often desired behaviour."}, {"owner": {"reputation": 6220, "user_id": 750378, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c2411ebeac78356652778daf47107db7?s=128&d=identicon&r=PG", "display_name": "DaveFar", "link": "https://stackoverflow.com/users/750378/davefar"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1535028217, "post_id": 51970117, "comment_id": 90921531, "body": "Thanks YSC, Xirema and @user2079303 (+3). I have updated my question accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 4, "last_activity_date": 1535038053, "last_edit_date": 1535038053, "creation_date": 1534952647, "answer_id": 51970537, "question_id": 51970117, "link": "https://stackoverflow.com/questions/51970117/warning-when-an-explicitly-defaulted-function-declaration-is-deleted/51970537#51970537", "title": "Warning when an explicitly defaulted function declaration is deleted", "body": "<p>What you need to do is move the definition of the default member out of the class: </p>\n\n<pre><code>class NotMoveA\n{\npublic:\n  NotMoveA() = default;\n  ~NotMoveA() = default;\n  NotMoveA(const NotMoveA &amp;) = delete;\n  NotMoveA(NotMoveA &amp;&amp;other) = default;\n  NotMoveA &amp;operator=(const NotMoveA &amp;) = delete;\n  //will B deleted w/o warning:\n  NotMoveA &amp;operator=(NotMoveA &amp;&amp;other); \n  // ...\nprivate:\n  const std::string badDataMemberDisallowingMoveAssignment;\n  // ...\n};\n\nNotMoveA &amp; NotMoveA::operator=(NotMoveA &amp;&amp;other) = default;\n</code></pre>\n\n<p>Once you make it an out of line definition then you will get a compiler error as you cannot define the member function via <code>= default</code> if it would be deleted:</p>\n\n<blockquote>\n  <p>error: defaulting this move assignment operator would delete it after\n  its first\n        declaration NotMoveA &amp; NotMoveA::operator=(NotMoveA &amp;&amp;other) = default;</p>\n</blockquote>\n"}], "owner": {"reputation": 6220, "user_id": 750378, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c2411ebeac78356652778daf47107db7?s=128&d=identicon&r=PG", "display_name": "DaveFar", "link": "https://stackoverflow.com/users/750378/davefar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1695, "favorite_count": 1, "accepted_answer_id": 51970537, "answer_count": 1, "score": 2, "last_activity_date": 1535038053, "creation_date": 1534951285, "last_edit_date": 1535027842, "question_id": 51970117, "link": "https://stackoverflow.com/questions/51970117/warning-when-an-explicitly-defaulted-function-declaration-is-deleted", "title": "Warning when an explicitly defaulted function declaration is deleted", "body": "<p>Is there a diagnostic flag or tool that can <strong>warn me if I have an explicitly defaulted function declaration that the compiler deletes</strong>? </p>\n\n<p>If not, then why? Can a defaulted member being deleted be a desired behaviour? When and how often is this the case?</p>\n\n<hr>\n\n<p><strong>Details</strong></p>\n\n<p>I am using clang version 5.0.1, but a warning via a recent MSVC or gcc version would also be fine.</p>\n\n<p>A simplified example of what I had:</p>\n\n<pre><code>class NotMoveA\n{\npublic:\n  explicit NotMoveA(Foo f);\n  ~NotMoveA() = default;\n  NotMoveA(const NotMoveA &amp;) = delete;\n  NotMoveA(NotMoveA &amp;&amp;other) = default;\n  NotMoveA &amp;operator=(const NotMoveA &amp;) = delete;\n  //will B deleted w/o warning:\n  NotMoveA &amp;operator=(NotMoveA &amp;&amp;other) = default; \n  // ...\nprivate:\n  const std::string badDataMemberDisallowingMoveAssignment;\n  // ...\n}\n</code></pre>\n\n<p>and used <code>NotMoveA</code> in a <code>std::vector</code>. Since <code>NotMoveA</code> is not MoveAssignable, I got some errors whose cause took me quite a while to figure out. A warning directly at the cause, i.e. at the deleted <code>= default</code> function, would have helped.</p>\n"}, {"tags": ["python", "c++", "opencv"], "comments": [{"owner": {"reputation": 90163, "user_id": 10897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/csXHX.png?s=128&g=1", "display_name": "Martin Beckett", "link": "https://stackoverflow.com/users/10897/martin-beckett"}, "edited": false, "score": 0, "creation_date": 1534950926, "post_id": 51969992, "comment_id": 90890456, "body": "There isn&#39;t a direct one you can use cv::sqrt() and cv::pow()"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "reply_to_user": {"reputation": 90163, "user_id": 10897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/csXHX.png?s=128&g=1", "display_name": "Martin Beckett", "link": "https://stackoverflow.com/users/10897/martin-beckett"}, "edited": false, "score": 0, "creation_date": 1534951017, "post_id": 51969992, "comment_id": 90890514, "body": "Would you be able to give me a code example please?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1534951256, "post_id": 51969992, "comment_id": 90890662, "body": "How about using <a href=\"https://docs.opencv.org/2.4/modules/core/doc/operations_on_arrays.html#norm\" rel=\"nofollow noreferrer\"><code>norm</code></a>, or just directly doing <a href=\"https://docs.opencv.org/2.4/modules/core/doc/operations_on_arrays.html#normalize\" rel=\"nofollow noreferrer\"><code>normalize</code></a>?"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1534951673, "post_id": 51969992, "comment_id": 90890901, "body": "Thanks, can I do this?: <code>cv::Vec3d tvecNorm(tvecBest); \t\t\tcv::normalize(tvecNorm, tvecNorm);</code>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1534952982, "post_id": 51969992, "comment_id": 90891674, "body": "@anti Yes, that should work."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1534953470, "post_id": 51969992, "comment_id": 90891958, "body": "(0 &lt; R.at&lt;double&gt;(1, 1) &lt; 1) should be ((0 &lt; R...) &amp;&amp; (R... &lt; 1))"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1534953615, "post_id": 51969992, "comment_id": 90892061, "body": "could you explain that last comment please? Do you mean loop through each element of teh Mat and check it?"}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1534954265, "post_id": 51969992, "comment_id": 90892452, "body": "(0 &lt; R.at&lt;double&gt;(1, 1) &lt; 1) result is ((0 &lt; R.at&lt;double&gt;(1,1))  &lt; 1), note extra parenthesis, I think this is not what you want.   (0 &lt; R.at&lt;double&gt;(1, 1) &lt; 1)  should be written as the &amp;&amp; of two bools:  (0 &lt; R.at&lt;double&gt;(1, 1)) &amp;&amp; (R.at&lt;double&gt;(1, 1) &lt; 1)"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1574343396, "post_id": 51969992, "comment_id": 104205526, "body": "Also see <a href=\"https://stackoverflow.com/q/4650243/608639\">Convert Python program to C/C++ code?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1534952196, "post_id": 51970304, "comment_id": 90891214, "body": "Thank you! So that gives me:  <code>cv::Vec3d forward(0, 0, 1); \t\t\tcv::Vec3d T(tvecBest); \t\t\tcv::Vec3d tnorm = sqrt(T[0] * T[0] + T[1] * T[1] + T[2] * T[2]); \t\t\tcv::Vec3d axis; \t\t\taxis[0] = tnorm[1] * forward[2] - tnorm[2] * forward[1]; \t\t\taxis[1] = -tnorm[0] * forward[2] + tnorm[2] * forward[0]; \t\t\taxis[2] = tnorm[0] * forward[1] - tnorm[1] * forward[0];</code>"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1534952257, "post_id": 51970304, "comment_id": 90891240, "body": "What is the c++ for : <code>cv::Vec3d angle = -2 * math.acos(tnorm @ forward)</code> ?"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "reply_to_user": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1534952787, "post_id": 51970304, "comment_id": 90891557, "body": "the @ is not a mathematical operator in python. Was it / operator ?"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1534952865, "post_id": 51970304, "comment_id": 90891608, "body": "it is written as @, strangely. It is from here: <code>https:&#47;&#47;github.com&#47;opencv&#47;opencv&#47;issues&#47;8813#issuecomment-39&zwnj;&#8203;0462446</code>"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1534952996, "post_id": 51970304, "comment_id": 90891682, "body": "aha, there is actually a matlab implementation also, it looks like it should be: <code>cv::Vec3d angle = -2 * acos(forward*tnorm); </code> However, the acos function does not like cv::Vec3d. Do I need to split it out and get three values?"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "reply_to_user": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 1, "creation_date": 1534953092, "post_id": 51970304, "comment_id": 90891740, "body": "from what I read they meant @ to be a dot product : tnorm @ forward -&gt; tnorm[0]*forward [0]+ tnorm[1]*forward [1]+ tnorm[2]*forward [2]"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "reply_to_user": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 1, "creation_date": 1534953227, "post_id": 51970304, "comment_id": 90891825, "body": "and angle must be a double : double angle = -2 * acos( tnorm[0]*forward [0]+ tnorm[1]*forward [1]+ tnorm[2]*forward [2])"}], "tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": true, "score": 1, "last_activity_date": 1534951926, "creation_date": 1534951926, "answer_id": 51970304, "question_id": 51969992, "link": "https://stackoverflow.com/questions/51969992/converting-math-functions-from-python-to-c/51970304#51970304", "title": "Converting Math functions from Python to c++", "body": "<p>the np.linalg.norm(T) is just the L2 norm :</p>\n\n<pre><code>sqrt(T[0]*T[0]+T[1]*T[1]+T[2]*T[2]) \n</code></pre>\n\n<p>np.cross(tnorm, forward) is the cross product:</p>\n\n<pre><code>axis[0] = tnorm[1]*forward[2]-tnorm[2]*forward[1]\naxis[1] = -tnorm[0]*forward[2]+tnorm[2]*forward[0]\naxis[2] = tnorm[0]*forward[1]-tnorm[1]*forward[0]\n</code></pre>\n"}], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 51970304, "answer_count": 1, "score": 0, "last_activity_date": 1534951926, "creation_date": 1534950846, "question_id": 51969992, "link": "https://stackoverflow.com/questions/51969992/converting-math-functions-from-python-to-c", "title": "Converting Math functions from Python to c++", "body": "<p>I am attempting to convert some opencv code from python to c++, and am a little lost. The python is:</p>\n\n<pre><code>if 0 &lt; R[1,1] &lt; 1:\n    # If it gets here, the pose is flipped.\n\n    # Flip the axes. E.g., Y axis becomes [-y0, -y1, y2].\n    R *= np.array([\n        [ 1, -1,  1],\n        [ 1, -1,  1],\n        [-1,  1, -1],\n    ])\n\n    # Fixup: rotate along the plane spanned by camera's forward (Z) axis and vector to marker's position\n    forward = np.array([0, 0, 1])\n    tnorm = T / np.linalg.norm(T)\n    axis = np.cross(tnorm, forward)\n    angle = -2*math.acos(tnorm @ forward)\n    R = cv2.Rodrigues(angle * axis)[0] @ R\n</code></pre>\n\n<p>So far i have:</p>\n\n<pre><code>cv::Mat R;\nif (0 &lt; R.at&lt;double&gt;(1, 1) &lt; 1) {\n\n            // Flip the axes.E.g., Y axis becomes[-y0, -y1, y2].\n            float mult[9] = { 1, -1, 1, 1, -1, 1,-1, 1, -1 };\n\n            cv::Mat FlipAxes = cv::Mat(3, 3, CV_32F, mult);\n\n            R *= FlipAxes;\n\n                //# Fixup: rotate along the plane spanned by camera's forward (Z) axis and vector to marker's position\n            cv::Vec3d forward(0, 0, 1);\n            double tnorm = tvecBest / np.linalg.norm(T)\n            axis = np.cross(tnorm, forward)\n            angle = -2 * math.acos(tnorm @ forward)\n            R = cv2.Rodrigues(angle * axis)[0] * R\n\n\n        }\n</code></pre>\n\n<p>I am lost on these lines:</p>\n\n<pre><code>double tnorm = tvecBest / np.linalg.norm(T)\naxis = np.cross(tnorm, forward)\nangle = -2 * math.acos(tnorm @ forward)\n</code></pre>\n\n<p>what is the equivalent of <code>np.linalg.norm</code> in c++ opencv?</p>\n"}, {"tags": ["c++", "c++11", "initialization", "destructor", "unions"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1534950617, "post_id": 51969900, "comment_id": 90890258, "body": "Isn&#39;t <code>type</code> there specifically to tell you which field is active?"}, {"owner": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534951025, "post_id": 51969900, "comment_id": 90890521, "body": "@Fran&#231;oisAndrieux the problem happens when i want to assign to object with different active type than the one i&#39;m assigning"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534951067, "post_id": 51969900, "comment_id": 90890549, "body": "Can you show the assignment you believe to UB?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534951196, "post_id": 51969900, "comment_id": 90890625, "body": "Why not to use <code>boost::variant</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1534951547, "last_edit_date": 1534951547, "creation_date": 1534951195, "answer_id": 51970092, "question_id": 51969900, "link": "https://stackoverflow.com/questions/51969900/assignment-to-deleted-uninitialized-object/51970092#51970092", "title": "Assignment to deleted/uninitialized object", "body": "<p>Firstly, anonymous structs are ill-formed in C++. You could use instead for example:</p>\n\n<pre><code>union {\n    std::string s;\n    std::function&lt;std::string(void)&gt; f;\n};\n</code></pre>\n\n<blockquote>\n  <p>My guess is that such assignment is undefined behaviour</p>\n</blockquote>\n\n<p>Correct.</p>\n\n<blockquote>\n  <p>How can i do this correctly without invoking any undefined behaviour?</p>\n</blockquote>\n\n<p>You could use the tagged union pattern. You appear to already have a <code>type</code> member. You could use that to designate which member is active. If you had other plans for that member, simply add a new one.</p>\n\n<p>Once you can use a struct member to check which union member is active, you can destroy the active member and then copy construct a previous inactive union member, and finally update <code>type</code> to signify the new active member.</p>\n\n<hr>\n\n<p>That said, you can save some time by using a pre-existing generic implementation of a tagged union. There's one in <a href=\"https://www.boost.org/doc/libs/release/doc/html/variant.html\" rel=\"nofollow noreferrer\">Boost</a> for example.</p>\n"}, {"comments": [{"owner": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "edited": false, "score": 0, "creation_date": 1534951430, "post_id": 51970093, "comment_id": 90890757, "body": "Im wrapping types in structs because either c++11 or just vs2012 doesn&#39;t allow me to make union with types that have copy constructor"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "edited": false, "score": 0, "creation_date": 1534951615, "post_id": 51970093, "comment_id": 90890863, "body": "@Ryba vs2012 is not very C++11 complaint.  You should upgrade to get better conformance."}, {"owner": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534952405, "post_id": 51970093, "comment_id": 90891321, "body": "@NathanOliver i would use gcc and c++17 and proper std::variant if i wasn&#39;t stuck with vs2012"}, {"owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "reply_to_user": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "edited": false, "score": 0, "creation_date": 1534952499, "post_id": 51970093, "comment_id": 90891372, "body": "@Ryba you got locked out by c++03 restriction supported by MS. Funny enough you cheat here, because struct that contain nontrivial members is non-trivial, but anonymous struct, a non-standard feature of MS C++, is one that is not. That sound like bug\\misfeature use."}, {"owner": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "reply_to_user": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "edited": false, "score": 0, "creation_date": 1534953030, "post_id": 51970093, "comment_id": 90891706, "body": "@Swift-FridayPie so is there a proper c++11 way to make a variant that supports non-trivial members?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "edited": false, "score": 0, "creation_date": 1534953172, "post_id": 51970093, "comment_id": 90891797, "body": "@Ryba Yes, you use a union - you just explicitly provide a constructor and destructor for that union that does nothing."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1534953252, "last_edit_date": 1534953252, "creation_date": 1534951198, "answer_id": 51970093, "question_id": 51969900, "link": "https://stackoverflow.com/questions/51969900/assignment-to-deleted-uninitialized-object/51970093#51970093", "title": "Assignment to deleted/uninitialized object", "body": "<blockquote>\n  <p>My guess is that such assignment is undefined behavior, since I don't know if assignment of string or function doesn't reuse some fields.</p>\n</blockquote>\n\n<p>Good guess! Assignment always has as its precondition that the left-hand side is actually an object of that type. If we don't have an object on the left-hande side, all bets are off.</p>\n\n<blockquote>\n  <p>How can I do this correctly without invoking any undefined behavior?</p>\n</blockquote>\n\n<p>Construction! When you don't have an object, the only way to get an one is to create it. And since we want to create it in a specific location, that's placement new. </p>\n\n<p>I am not sure why you are wrapping your types in an extra struct, you want to do this:</p>\n\n<pre><code>union U {\n    U() { }\n    ~U() { }\n\n    std::string s;\n    std::function&lt;std::string(void)&gt; f;\n} u;\n</code></pre>\n\n<p>With that, your assignment operator would be:</p>\n\n<pre><code>foo&amp; operator=(foo const&amp; rhs) {\n    if (type) {\n        if (rhs.type) {\n            u.s = rhs.u.s;\n        } else {\n            u.s.~string();\n            new (&amp;u.f) std::function&lt;std::string(void)&gt;(rhs.u.f);\n        }\n    } else {\n        if (!rhs.type) {\n            u.f = rhs.u.f;\n        } else {\n            u.f.~function();\n            new (&amp;u.s) std::string(rhs.u.s);\n        }\n    }\n\n    return *this;\n}\n</code></pre>\n\n<p>You'll want to refactor some of that to support move-assignment without lots of duplication, but that's the rough idea. </p>\n"}, {"comments": [{"owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "edited": false, "score": 0, "creation_date": 1535005669, "post_id": 51970460, "comment_id": 90908701, "body": "Nah, first what you should get <code>anonymous types declared in an anonymous union are an extension [-Wnested-anon-types]</code> because standard doesn&#39;t allow that. With <code>-std=c++11 -pedantic</code> code should work without anonymous structs."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1534952396, "creation_date": 1534952396, "answer_id": 51970460, "question_id": 51969900, "link": "https://stackoverflow.com/questions/51969900/assignment-to-deleted-uninitialized-object/51970460#51970460", "title": "Assignment to deleted/uninitialized object", "body": "<p>C++11 is kind enough to not even allow this. As your union contains fields with non trivial constructors and destructors, <code>struct foo</code> has implicitely deleted default constructor and destructor.</p>\n\n<p>My old  clang version 3.4.1 (with option std=c++11) chokes when I try to create a <code>struct foo</code> with:</p>\n\n<pre><code>error: call to implicitly-deleted \n</code></pre>\n\n<p>and</p>\n\n<pre><code> note: default constructor of 'foo' is implicitly deleted because variant field has a non-trivial default constructor.\n</code></pre>\n\n<p>And if I try to manually initialize a <code>struct foo</code> with (I slightly changed <code>foo</code> to avoid anonymous fields):</p>\n\n<pre><code>...\nstruct foo {\n    bool type;\n    union {\n        struct { std::string s; } s;\n        struct { std::function&lt;std::string(void)&gt; f; } f;\n    };\n};\n\nint main() {\n    foo bar { .s = {\"a\"}};\n    ...\n</code></pre>\n\n<p>I get another error (as expected):</p>\n\n<pre><code>error: attempt to use a deleted function\n    foo bar { .s = {\"a\"}};\n</code></pre>\n\n<p>and </p>\n\n<pre><code>note: destructor of 'foo' is implicitly deleted because variant field 's' has a non-trivial destructor\n        struct { std::string s; } s;\n                                  ^\n</code></pre>\n"}], "owner": {"reputation": 509, "user_id": 3134946, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/198952b24b7de8ec7329d3a3f46d7bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryba", "link": "https://stackoverflow.com/users/3134946/ryba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 51970093, "answer_count": 3, "score": 0, "last_activity_date": 1541635824, "creation_date": 1534950537, "last_edit_date": 1541635824, "question_id": 51969900, "link": "https://stackoverflow.com/questions/51969900/assignment-to-deleted-uninitialized-object", "title": "Assignment to deleted/uninitialized object", "body": "<p>I have a class like this</p>\n\n<pre><code>struct foo {\n    bool type;\n    union {\n        struct { std::string s; };\n        struct { std::function&lt;std::string(void)&gt; f; };\n    };\n};\n</code></pre>\n\n<p>I need to have assignment operators defined, but when I'm assigning different type I'm basicly assigning to uninitialized field (I know I have to explicitly call destructor first). </p>\n\n<p>My guess is that such assignment is undefined behavior, since I don't know if assignment of string or function doesn't reuse some fields.</p>\n\n<p>How can I do this correctly without invoking any undefined behavior?</p>\n\n<p>I am limited to C++11.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 1, "creation_date": 1534950667, "post_id": 51969851, "comment_id": 90890286, "body": "this code does not compile for me, what is <code>type1</code>?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1534950809, "post_id": 51969851, "comment_id": 90890383, "body": "@rtpax Probably a missing template parameter for that <code>using</code>."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1534950892, "post_id": 51969851, "comment_id": 90890438, "body": "What&#39;s wrong with just using <a href=\"https://en.cppreference.com/w/cpp/container/multiset\" rel=\"nofollow noreferrer\">std::multiset</a>?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1534952748, "post_id": 51969851, "comment_id": 90891532, "body": "std::set, std::map, or std::multi_map are the recommended approaches in the stl. If you are really concerned about maintaining insert order, or some other arbitrary order for value entries at the same key, perhaps a <code>std::map&lt;Index,std::vector&lt;Value&gt;&gt;</code> or <code>std::map&lt;Index,std::list&lt;Value&gt;&gt;</code> would give you the behaviours you need vs. multi_map? Iterating is a slight pain, but usually turns into 2 loops instead of 1."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534953250, "post_id": 51969851, "comment_id": 90891842, "body": "@JesperJuhl <code>std::multiset</code> lacks logarithmic <code>find_by_order</code> and <code>order_of_key</code> functions."}, {"owner": {"reputation": 13, "user_id": 10260016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c05953887fff1b57856f798c791a2472?s=128&d=identicon&r=PG&f=1", "display_name": "botanich", "link": "https://stackoverflow.com/users/10260016/botanich"}, "reply_to_user": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 0, "creation_date": 1534958742, "post_id": 51969851, "comment_id": 90894805, "body": "@rtpax sorry for mistakes, code edited"}, {"owner": {"reputation": 13, "user_id": 10260016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c05953887fff1b57856f798c791a2472?s=128&d=identicon&r=PG&f=1", "display_name": "botanich", "link": "https://stackoverflow.com/users/10260016/botanich"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1534959065, "post_id": 51969851, "comment_id": 90894954, "body": "@GemTaylor i need fast inserting, erasing and finding number of elements less that some &quot;x&quot;. And I have no idea how to replace that multiset with map. Please, explain me how to do all that functions in logarithmic time. Now I think about writing Cartesian tree, but I don&#39;t like to code such structures"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1534962896, "post_id": 51969851, "comment_id": 90896669, "body": "Then your question is not about c++ but about your particular library. If it is a commercial or public library there may be a tag for it that will draw some more relevant experts. A 5-minute browse in google gave me no clues what your <code>find_by_order</code> and <code>order_of_key</code> functions actually should do, so I can&#39;t advise how they map onto std::map or std::set. Certainly std::map has a find() method, but I can&#39;t teach you how to transfer it all to stl. Some of your counting methods may not be trivially answered using stl."}, {"owner": {"reputation": 13, "user_id": 10260016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c05953887fff1b57856f798c791a2472?s=128&d=identicon&r=PG&f=1", "display_name": "botanich", "link": "https://stackoverflow.com/users/10260016/botanich"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1534964548, "post_id": 51969851, "comment_id": 90897433, "body": "@GemTaylor this functions included to MinGW c++ compiler libraries. <code>find_by_order(i)</code> returns iterator to set element, which would have index <i><b>i</b></i> in sorted array. <code>order_of_key(x)</code> returns index, which would have <i><b>x</b></i>, if would be inserted into this set. In other words, returns count of elements of set, which less than <i><b>x</b></i>"}, {"owner": {"reputation": 13, "user_id": 10260016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c05953887fff1b57856f798c791a2472?s=128&d=identicon&r=PG&f=1", "display_name": "botanich", "link": "https://stackoverflow.com/users/10260016/botanich"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1534964649, "post_id": 51969851, "comment_id": 90897476, "body": "@GemTaylor <a href=\"https://codeforces.com/blog/entry/11080?locale=en\" rel=\"nofollow noreferrer\">link</a> here more info about this data structure"}, {"owner": {"reputation": 13, "user_id": 10260016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c05953887fff1b57856f798c791a2472?s=128&d=identicon&r=PG&f=1", "display_name": "botanich", "link": "https://stackoverflow.com/users/10260016/botanich"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1534965180, "post_id": 51969851, "comment_id": 90897718, "body": "@GemTaylor the question is not only in ordered_set structure, <code>find()</code> doesn&#39;t work even in <code>std::set</code> with <code>less_equal</code> comparator. For example: <a href=\"https://pastebin.com/Fd91dJSL\" rel=\"nofollow noreferrer\">click</a>"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1534965523, "post_id": 51969851, "comment_id": 90897873, "body": "Would that be because it needs a less-than operator, not a less-equal, as documented here: <a href=\"http://www.cplusplus.com/reference/set/set/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/set/set</a> ?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1534965720, "post_id": 51969851, "comment_id": 90897957, "body": "That is far more that I am willing to digest, sorry."}, {"owner": {"reputation": 13, "user_id": 10260016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c05953887fff1b57856f798c791a2472?s=128&d=identicon&r=PG&f=1", "display_name": "botanich", "link": "https://stackoverflow.com/users/10260016/botanich"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1534965917, "post_id": 51969851, "comment_id": 90898033, "body": "@GemTaylor yes, but my task needs saving dublicates of elements, but with <code>less</code> comparator they are automatically deleted."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1535018398, "post_id": 51969851, "comment_id": 90915717, "body": "That is why multi_map/multi_set or map of vector. If the items with the same index are identical, then you just need a count, so map&lt;Item,int&gt; may be enough. If the items contain non-indexing members (payload you need to preserve) then multi_set. If the index can be separated from the payload, then multi_map; or map&lt;vector&gt; if you need to control the order of matching members."}], "answers": [{"tags": [], "owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "is_accepted": true, "score": 0, "last_activity_date": 1535039735, "creation_date": 1535039735, "answer_id": 51989825, "question_id": 51969851, "link": "https://stackoverflow.com/questions/51969851/creating-ordered-multiset-with-correctly-working-find/51989825#51989825", "title": "Creating ordered multiset with correctly working find()", "body": "<p>From the gnu docs <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/policy_data_structures_design.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<blockquote>\n  <p>Brace onself: this library does not contain containers like\n  std::multimap or std::multiset. Instead, these data structures can be\n  synthesized via manipulation of the Mapped template parameter.</p>\n</blockquote>\n\n<p>There is no way to use this data structure for a multiset without some boiler plate of your own. For example your might do something like the following (though this is an unsafe incomplete implementation)</p>\n\n<pre><code>template &lt;class T&gt;\nclass multiset_equal_list {\n    friend operator&lt;(const multiset_equal_list&lt;T&gt;&amp;, const T&amp;);\nprivate:\n    mutable std::vector&lt;T&gt; equals;\npublic:\n    bool operator&lt;(const T&amp; arg) const { return equals[0] &lt; arg; }\n    void add_equal(const T&amp; arg) const { equals.push_back(arg); }\n}\n\n\ntemplate &lt;class T&gt;\nclass my_multiset {\nprivate:\n    std::set&lt;multiset_equal_list&lt;T&gt;&gt; values; //instead of set, you can use the __gnu_pbds tree\npublic:\n    void insert(const T&amp; arg) {\n        auto it = values.lower_bound(arg);\n        if (it == values.end() || (*it &lt; arg)) {\n            multiset_equal_list&lt;T&gt; to_add;\n            to_add.add_equal(arg);\n            values.insert(it, to_add);\n        } else { //they are equal\n            it-&gt;add_equal(arg);\n        }\n    }\n}\n</code></pre>\n\n<p>The link goes more into how you might approach the problem in different ways, but you are likely better off rolling your own or using an existing library that has all the functionality you want in a more portable standard way. </p>\n\n<p>Note that the reason using <code>std::less_equal</code> does not work for you is because <code>tree</code> (and <code>set</code> and <code>multiset</code> etc.) determine equivalence if the comparison evaluates false for both. eg. <code>a</code> is equivalent to <code>b</code> if <code>!(a &lt; b) &amp;&amp; !(b &lt; a)</code>. So using <code>less_equal</code> that can never be the case (barring overloading)</p>\n"}], "owner": {"reputation": 13, "user_id": 10260016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c05953887fff1b57856f798c791a2472?s=128&d=identicon&r=PG&f=1", "display_name": "botanich", "link": "https://stackoverflow.com/users/10260016/botanich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 51989825, "answer_count": 1, "score": 1, "last_activity_date": 1535039735, "creation_date": 1534950352, "last_edit_date": 1534958676, "question_id": 51969851, "link": "https://stackoverflow.com/questions/51969851/creating-ordered-multiset-with-correctly-working-find", "title": "Creating ordered multiset with correctly working find()", "body": "<p>I tried to create ordered multiset with such code:</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\n#include &lt;ext/pb_ds/assoc_container.hpp&gt;\n#include &lt;ext/pb_ds/tree_policy.hpp&gt;\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\ntypedef long long ll;\n\ntemplate &lt;class type1&gt;\nusing ordered_multiset = tree &lt;type1, null_type, less_equal &lt;type1&gt;, rb_tree_tag, tree_order_statistics_node_update&gt;;\n\nordered_multiset &lt;ll&gt; kek;\n\nint main()\n{\n    kek.insert(1); kek.insert(1);\n    kek.insert(2); kek.insert(2); kek.insert(2);\n    kek.insert(3);\n    cout &lt;&lt; (kek.find(2) == kek.end()) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>But <code>find()</code> cant find any number because of using <code>less_equal &lt; ll &gt;</code> comparator instead of <code>less &lt; ll &gt;</code>. So, how to save dublicates in sorted set with working right <code>find()</code>?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1534950242, "post_id": 51969785, "comment_id": 90890031, "body": "There isn&#39;t one.  You&#39;ll have to find a library or build it yourself."}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 3, "creation_date": 1534950339, "post_id": 51969785, "comment_id": 90890099, "body": "Does this question address your need? <a href=\"https://stackoverflow.com/questions/19071268/function-composition-in-c-c11\" title=\"function composition in c c11\">stackoverflow.com/questions/19071268/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "is_accepted": false, "score": 0, "last_activity_date": 1534950347, "creation_date": 1534950347, "answer_id": 51969847, "question_id": 51969785, "link": "https://stackoverflow.com/questions/51969785/c-equivalent-of-javas-andthen-function-to-composite-new-function/51969847#51969847", "title": "C++ equivalent of Java&#39;s andThen() function to composite new function", "body": "<p>Why not keep things simple?</p>\n\n<pre><code>int times2thenSquared(int x) {\n    x = times2(x);\n    return squared(x);\n}\n</code></pre>\n\n<p>(can do it with lambda as well, if you want)</p>\n"}, {"tags": [], "owner": {"reputation": 1923, "user_id": 3033441, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5128fcd3a14587660ea0cb737aa54143?s=128&d=identicon&r=PG&f=1", "display_name": "lakshayg", "link": "https://stackoverflow.com/users/3033441/lakshayg"}, "is_accepted": true, "score": 2, "last_activity_date": 1534951375, "creation_date": 1534951375, "answer_id": 51970143, "question_id": 51969785, "link": "https://stackoverflow.com/questions/51969785/c-equivalent-of-javas-andthen-function-to-composite-new-function/51970143#51970143", "title": "C++ equivalent of Java&#39;s andThen() function to composite new function", "body": "<p>If you are open to using Boost, then Boost.HOF is what you need. HOF (Higher order functions) provides the <code>compose</code> function adapter with the following semantics</p>\n\n<pre><code>assert(compose(f, g)(xs...) == f(g(xs...)));\n</code></pre>\n\n<p>In your case, you will do</p>\n\n<pre><code>auto composed = compose(squared, times2);\nauto result = composed(4);\n</code></pre>\n\n<p>Have a look at the documentation for details <a href=\"https://www.boost.org/doc/libs/1_68_0/libs/hof/doc/html/include/boost/hof/compose.html\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_68_0/libs/hof/doc/html/include/boost/hof/compose.html</a></p>\n"}], "owner": {"reputation": 874, "user_id": 6858550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbd1aac23957d00bfb620319ddd38a13?s=128&d=identicon&r=PG&f=1", "display_name": "Han XIAO", "link": "https://stackoverflow.com/users/6858550/han-xiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 51970143, "answer_count": 2, "score": 3, "last_activity_date": 1534951375, "creation_date": 1534950140, "last_edit_date": 1534950532, "question_id": 51969785, "link": "https://stackoverflow.com/questions/51969785/c-equivalent-of-javas-andthen-function-to-composite-new-function", "title": "C++ equivalent of Java&#39;s andThen() function to composite new function", "body": "<p>In Java, you can do the following code:</p>\n\n<pre><code>Function&lt;Integer, Integer&gt; times2 = e -&gt; e * 2;\nFunction&lt;Integer, Integer&gt; squared = e -&gt; e * e; \ntimes2.andThen(squared).apply(4);  \n</code></pre>\n\n<p>What's C++'s equivalent of <code>andThen()</code> to coin/composite new functors? Thanks.  </p>\n"}, {"tags": ["c++", "cuda"], "comments": [{"owner": {"reputation": 2594, "user_id": 3237438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832f4d1b3dcad6c4049fb9ae49b17f07?s=128&d=identicon&r=PG&f=1", "display_name": "hkchengrex", "link": "https://stackoverflow.com/users/3237438/hkchengrex"}, "edited": false, "score": 1, "creation_date": 1534950180, "post_id": 51969703, "comment_id": 90889990, "body": "It would be easier to read if you can translate the comment to English..."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1534950230, "post_id": 51969703, "comment_id": 90890022, "body": "please provide a complete code, we would like to know what <code>N</code>, <code>THREADS_PER_BLOCK</code>, <code>BLOCK_SIZE</code>, <code>RADIUS</code>, <code>random_ints</code>  etc. are.  Provide a code that someone else could compile,without having to add anything."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1534950362, "post_id": 51969703, "comment_id": 90890114, "body": "&quot; I&#39;ve a problem with the <i>whatever</i> method from <i>whatever_library</i>, i think it&#39;s doesn&#39;t work&quot; - that&#39;s a common misunderstanding by beginners. Usually whatever library/API you use works just fine - you <i>can</i> of course be the first person to spot a problem, but that&#39;s a lot rarer than you simply not understanding how to use the library/API properly. The bug is <i>much more</i> likely to be in your code / your usage of the lib, than in the lib."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1534950509, "post_id": 51969703, "comment_id": 90890209, "body": "This is not correct:  <code>for(int i=0; i&lt;size; i++)</code> it should be: <code>for(int i=0; i&lt;N; i++)</code>.  Also, this: <code>in[gindex - RADIUS]</code> will index out-of-bounds for the first <code>RADIUS</code> threads in the grid."}, {"owner": {"reputation": 3, "user_id": 10260281, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kgk0iIhVjjE/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNYjD7IbVROIZIyTT_RiyQJSpoqlQ/mo/photo.jpg?sz=128", "display_name": "Yoann clot", "link": "https://stackoverflow.com/users/10260281/yoann-clot"}, "edited": false, "score": 0, "creation_date": 1534950913, "post_id": 51969703, "comment_id": 90890446, "body": "I just updated the post"}, {"owner": {"reputation": 3, "user_id": 10260281, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kgk0iIhVjjE/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNYjD7IbVROIZIyTT_RiyQJSpoqlQ/mo/photo.jpg?sz=128", "display_name": "Yoann clot", "link": "https://stackoverflow.com/users/10260281/yoann-clot"}, "edited": false, "score": 0, "creation_date": 1534951056, "post_id": 51969703, "comment_id": 90890540, "body": "Thx Robert, but i do the change and its not the problem..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10260281, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kgk0iIhVjjE/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNYjD7IbVROIZIyTT_RiyQJSpoqlQ/mo/photo.jpg?sz=128", "display_name": "Yoann clot", "link": "https://stackoverflow.com/users/10260281/yoann-clot"}, "edited": false, "score": 0, "creation_date": 1535007335, "post_id": 51970363, "comment_id": 90909493, "body": "Thx so much for your help, i fix those things and its working ! sorry for my beginner level."}], "tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 2, "last_activity_date": 1534983543, "last_edit_date": 1534983543, "creation_date": 1534952127, "answer_id": 51970363, "question_id": 51969703, "link": "https://stackoverflow.com/questions/51969703/cuda-stencil-code-not-working/51970363#51970363", "title": "CUDA : stencil code not working", "body": "<p><a href=\"https://www.nvidia.com/docs/IO/116711/sc11-cuda-c-basics.pdf\" rel=\"nofollow noreferrer\">This code</a> was originally designed for teaching; it has some defects in it.</p>\n\n<p>First, any time you are having trouble with a CUDA code, I recommend <a href=\"https://stackoverflow.com/questions/14038589/what-is-the-canonical-way-to-check-for-errors-using-the-cuda-runtime-api\">proper CUDA error checking</a> and run your code with <code>cuda-memcheck</code> (see my example use of <code>cuda-memcheck</code> below).  If you do this before asking others for help, and provide the error info in your question, it may help others help you.</p>\n\n<p>If you run this code with <code>cuda-memcheck</code> it will indicate errors both in access of global memory and shared memory.</p>\n\n<ol>\n<li><p>Your choice of <code>BLOCK_SIZE</code> is not correct.  This should be set equal to <code>THREADS_PER_BLOCK</code>, not <code>(N/THREADS_PER_BLOCK)</code>.  It appears you intended to run this kernel with 3 blocks of 10 threads each, so we'll work with that.</p></li>\n<li><p>These lines will index out-of-bounds:</p>\n\n<pre><code>if (threadIdx.x &lt; RADIUS) {\n    temp[lindex - RADIUS] = in[gindex - RADIUS]; // R\u00e9cupr\u00e8re le Halo avant les valeurs du block\n    temp[lindex + BLOCK_SIZE] = in[gindex + BLOCK_SIZE]; // R\u00e9cup\u00e8re le Halo apr\u00e8s les valeurs du block\n</code></pre>\n\n<p>for example, in the first block, with the first thread (<code>threadIdx.x</code> is 0), <code>gindex</code> is 0, so the calculation <code>gindex - RADIUS</code> will be -3.  That can't be correct.</p></li>\n<li><p>This for-loop is incorrect:</p>\n\n<pre><code>for(int i=0; i&lt;size; i++)\n</code></pre>\n\n<p>it should be:</p>\n\n<pre><code>for(int i=0; i&lt;N; i++)\n</code></pre></li>\n</ol>\n\n<p>When I fix those things, your code runs without error and produces a sensible result for me:</p>\n\n<pre><code>$ cat t280.cu\n#define N 30\n#define THREADS_PER_BLOCK 10\n#define BLOCK_SIZE THREADS_PER_BLOCK\n#define RADIUS 3\n\n#include &lt;stdio.h&gt;\n\nvoid random_ints(int *var, int n) // Attribue une valeur \u00e0 toutes le composantes des variables\n{\n    int i;\n    for (i = 0; i &lt; n; i++)\n        var[i] = 1;\n}\n\n__global__ void stencil_1d(int *in, int *out) {\n    __shared__ int temp[BLOCK_SIZE + 2 * RADIUS];   // Cr\u00e9ation de la m\u00e9moire partag\u00e9e avec tout les threads d'un m\u00eame block\n\n    int gindex = threadIdx.x + blockIdx.x * blockDim.x;\n    int lindex = threadIdx.x + RADIUS;\n\n    /*for (int i = 0; i &lt; N*sizeof(int); i++)\n        printf(\"%i ---i=%i \\n\", in[i], i);*/\n\n    // D\u00e9placer les \u00e9l\u00e9ments d'entr\u00e9es sur la m\u00e9moire partag\u00e9e\n    temp[lindex] = in[gindex];\n    if (threadIdx.x &lt; RADIUS) {\n        temp[lindex - RADIUS] = (gindex &gt;= RADIUS)?in[gindex - RADIUS]:0; // R\u00e9cupr\u00e8re le Halo avant les valeurs du block\n        temp[lindex + BLOCK_SIZE] = ((gindex + BLOCK_SIZE)&lt;N)?in[gindex + BLOCK_SIZE]:0; // R\u00e9cup\u00e8re le Halo apr\u00e8s les valeurs du block\n    }\n\n    __syncthreads(); // Synchronisation des Threads d'un m\u00eame Block\n\n    int result = 0;\n    for (int offset = -RADIUS; offset &lt;= RADIUS ; offset++)\n        result += temp[lindex + offset];\n\n    out[gindex] = result;\n}\n\nint main()\n{\n    int size = N * sizeof(int);\n\n    /******************** Utilisation de la fonction GPU stencil_1d ********************/\n\n    int *in, *out; // Variable sur la m\u00e9moire Host\n    int *d_in, *d_out;  //Variable sur la m\u00e9moire Device\n\n    // Allocation de la m\u00e9more aux variables sur le Device\n    cudaMalloc((void**)&amp;d_in, size);\n    cudaMalloc((void**)&amp;d_out, size);\n\n    // Allocation de la m\u00e9moire aux variables de Host\n    in = (int*)malloc(size); random_ints(in, N);\n    out = (int*)malloc(size);\n\n    // Copie des valeurs des variables de Host vers Device\n    cudaMemcpy(d_in, in, size, cudaMemcpyHostToDevice);\n    cudaMemcpy(d_out, out, size, cudaMemcpyHostToDevice);\n\n    // Ex\u00e9cution de la fonction sur le Device (ici 3 Blocks, 10 Threads)\n    stencil_1d &lt;&lt;&lt;N/THREADS_PER_BLOCK, THREADS_PER_BLOCK&gt;&gt;&gt;(d_in, d_out);\n\n    // R\u00e9cup\u00e9ration de la variable out de Device vers Host\n    cudaMemcpy(out, d_out, size, cudaMemcpyDeviceToHost);\n\n    // Affichage du r\u00e9sultat\n    for(int i=0; i&lt;N; i++)\n        printf(\"%i ---i=%i \\n\", out[i], i);\n\n    // Lib\u00e9ration de la m\u00e9moire prise par les variables sur Host\n    free(in); free(out);\n\n    // Lib\u00e9ration de la m\u00e9moire prise par les variables sur le Device\n    cudaFree(d_in); cudaFree(d_out);\n\n    return 0;\n}\n$ nvcc -o t280 t280.cu\n$ cuda-memcheck ./t280\n========= CUDA-MEMCHECK\n4 ---i=0\n5 ---i=1\n6 ---i=2\n7 ---i=3\n7 ---i=4\n7 ---i=5\n7 ---i=6\n7 ---i=7\n7 ---i=8\n7 ---i=9\n7 ---i=10\n7 ---i=11\n7 ---i=12\n7 ---i=13\n7 ---i=14\n7 ---i=15\n7 ---i=16\n7 ---i=17\n7 ---i=18\n7 ---i=19\n7 ---i=20\n7 ---i=21\n7 ---i=22\n7 ---i=23\n7 ---i=24\n7 ---i=25\n7 ---i=26\n6 ---i=27\n5 ---i=28\n4 ---i=29\n========= ERROR SUMMARY: 0 errors\n$\n</code></pre>\n\n<p>The reason we get 4,5,6 at each end of the stencil output is due to the limitations we placed in the kernel for item 2 above, to avoid out-of-bounds indexing.  You could change this boundary behavior, if you want.</p>\n\n<p>One more comment: Right now your code chooses <code>N</code> and <code>THREADS_PER_BLOCK</code> so that it is evenly divisible.  As long as you do that (and adhere to other limits such as maximum threads per block of 1024) you should be OK with this code.  For full flexibility <a href=\"https://stackoverflow.com/a/20364446/1695960\">other changes should be made</a>, however what I've described here should be enough to get you past these errors.</p>\n"}], "owner": {"reputation": 3, "user_id": 10260281, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kgk0iIhVjjE/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNYjD7IbVROIZIyTT_RiyQJSpoqlQ/mo/photo.jpg?sz=128", "display_name": "Yoann clot", "link": "https://stackoverflow.com/users/10260281/yoann-clot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 51970363, "answer_count": 1, "score": 0, "last_activity_date": 1534983543, "creation_date": 1534949874, "last_edit_date": 1534953477, "question_id": 51969703, "link": "https://stackoverflow.com/questions/51969703/cuda-stencil-code-not-working", "title": "CUDA : stencil code not working", "body": "<p>First : I'm sorry if this topic is not well done (it's my first topic)\nI'm currently trying to learn the GPU compute on NVIDIA but\n I've a problem with the __syncthreads() method from CUDA, i think it's doesn't work. I've try to shearch on web and I've not found a fix. </p>\n\n<pre><code>__global__ void stencil_1d(int *in, int *out) {\n    __shared__ int temp[BLOCK_SIZE + 2 * RADIUS];   // Cr\u00e9ation de la m\u00e9moire partag\u00e9e avec tout les threads d'un m\u00eame block\n\n    int gindex = threadIdx.x + blockIdx.x * blockDim.x;\n    int lindex = threadIdx.x + RADIUS;\n\n    /*for (int i = 0; i &lt; N*sizeof(int); i++)\n        printf(\"%i ---i=%i \\n\", in[i], i);*/\n\n    // D\u00e9placer les \u00e9l\u00e9ments d'entr\u00e9es sur la m\u00e9moire partag\u00e9e\n    temp[lindex] = in[gindex];\n    if (threadIdx.x &lt; RADIUS) {\n        temp[lindex - RADIUS] = in[gindex - RADIUS]; // R\u00e9cupr\u00e8re le Halo avant les valeurs du block\n        temp[lindex + BLOCK_SIZE] = in[gindex + BLOCK_SIZE]; // R\u00e9cup\u00e8re le Halo apr\u00e8s les valeurs du block\n    }\n\n    __syncthreads(); // Synchronisation des Threads d'un m\u00eame Block\n\n    int result = 0;\n    for (int offset = -RADIUS; offset &lt;= RADIUS ; offset++)\n        result += temp[lindex + offset];\n\n    out[gindex] = result;\n}\n</code></pre>\n\n<p>When I uncomment the <code>for</code> the program work properly, but currently without the <code>for</code> my pogramm return -842150451 in the <code>out</code> variable.</p>\n\n<p>The main code : </p>\n\n<pre><code>int main()\n{\n    int size = N * sizeof(int);\n\n    /******************** Utilisation de la fonction GPU stencil_1d ********************/\n\n    int *in, *out; // Variable sur la m\u00e9moire Host\n    int *d_in, *d_out;  //Variable sur la m\u00e9moire Device\n\n    // Allocation de la m\u00e9more aux variables sur le Device\n    cudaMalloc((void**)&amp;d_in, size);\n    cudaMalloc((void**)&amp;d_out, size);\n\n    // Allocation de la m\u00e9moire aux variables de Host\n    in = (int*)malloc(size); random_ints(in, N);\n    out = (int*)malloc(size);\n\n    // Copie des valeurs des variables de Host vers Device\n    cudaMemcpy(d_in, in, size, cudaMemcpyHostToDevice);\n    cudaMemcpy(d_out, out, size, cudaMemcpyHostToDevice);\n\n    // Ex\u00e9cution de la fonction sur le Device (ici 3 Blocks, 10 Threads)\n    stencil_1d &lt;&lt;&lt;N/THREADS_PER_BLOCK, THREADS_PER_BLOCK&gt;&gt;&gt;(d_in, d_out);\n\n    // R\u00e9cup\u00e9ration de la variable out de Device vers Host\n    cudaMemcpy(out, d_out, size, cudaMemcpyDeviceToHost);\n\n    // Affichage du r\u00e9sultat\n    for(int i=0; i&lt;size; i++)\n        printf(\"%i ---i=%i \\n\", out[i], i);\n\n    // Lib\u00e9ration de la m\u00e9moire prise par les variables sur Host\n    free(in); free(out);\n\n    // Lib\u00e9ration de la m\u00e9moire prise par les variables sur le Device\n    cudaFree(d_in); cudaFree(d_out);\n\n    return 0;\n}\n</code></pre>\n\n<p>If forgot that :\nThe define : </p>\n\n<pre><code>#define N 30\n#define THREADS_PER_BLOCK 10\n#define BLOCK_SIZE (N/THREADS_PER_BLOCK)\n#define RADIUS 3\n</code></pre>\n\n<p>The random_ints code:</p>\n\n<pre><code>void random_ints(int *var, int n) // Attribue une valeur \u00e0 toutes le composantes des variables\n{\n    int i;\n    for (i = 0; i &lt; n; i++)\n        var[i] = 1;\n}\n</code></pre>\n\n<p>Thanks by advance for your answers.</p>\n"}, {"tags": ["c++", "bind", "stdbind"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1534949151, "post_id": 51969417, "comment_id": 90889359, "body": "Have you considered not using <code>std::bind</code> at all?  By <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b17\">c++17</a>, I am unaware of any convincing reason to use it over lambdas.  <code>std::bind</code> was added in parallel with lambdas and initially could do some things lambdas could not; now, that isn&#39;t true.  Using <code>std::bind</code> means you have to learn a whole pile of really arcane corner cases (like the above); using lambda has similar corner cases, but you&#39;ll want to learn lambdas anyhow so why not just learn one?"}, {"owner": {"reputation": 874, "user_id": 6858550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbd1aac23957d00bfb620319ddd38a13?s=128&d=identicon&r=PG&f=1", "display_name": "Han XIAO", "link": "https://stackoverflow.com/users/6858550/han-xiao"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1534949210, "post_id": 51969417, "comment_id": 90889395, "body": "@Yakk-AdamNevraumont I was just wondering if <code>bind</code> handle this perfectly."}, {"owner": {"reputation": 874, "user_id": 6858550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbd1aac23957d00bfb620319ddd38a13?s=128&d=identicon&r=PG&f=1", "display_name": "Han XIAO", "link": "https://stackoverflow.com/users/6858550/han-xiao"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1534949915, "post_id": 51969417, "comment_id": 90889842, "body": "@Yakk-AdamNevraumont As for <code>java</code>, when trying to coin a new functor, it has the member function like <code>andThen</code> to coin a new functor with one functor executed before another. That&#39;s why I asked this question."}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1534950138, "post_id": 51969417, "comment_id": 90889968, "body": "Pretty sure this is just a regular function call and the order of evaluation of each parameter is undefined. <code>5.2.2&#47;8</code>.."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1534950902, "post_id": 51969417, "comment_id": 90890442, "body": "@Brandon The function calls in a chained bind are deferred until the outermost bind is evaluated.  When you pass the result of bind to bind it acts really strange.  So you&#39;d have to find something in 20.10.9."}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1534955325, "post_id": 51969417, "comment_id": 90893091, "body": "@Yakk-AdamNevraumont; I don&#39;t see how that would work.. to me, the inner binds must be evaluated first and the results would be passed to the outer bind.. I can&#39;t see how the outer bind can bind anything without knowing what it&#39;s binding (inner binds).."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 1, "creation_date": 1534958212, "post_id": 51969417, "comment_id": 90894577, "body": "@Brandon The inner binds are only evaluated when the outer bind is called; the bind (when std::bind is called) the inner binds are left unevaluated (their operator() is deferred until the outer bind&#39;s operator() is evaluated).  <code>std::bind</code> is in many ways a strange beast, see my comment above.  Part of the problem is lanuage related; there is the &quot;point of binding&quot; and &quot;evaluation of bind&quot;.  Inner binds are bound first.  Then outer binds are bound to inner.  Then when outer is evaluated, the arguments are also passed to inner to get arguments passed to outer-bound callable."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 0, "last_activity_date": 1534951658, "creation_date": 1534951658, "answer_id": 51970226, "question_id": 51969417, "link": "https://stackoverflow.com/questions/51969417/execution-order-of-functors-in-stdbind-parameter-list-maybe-not-related-to/51970226#51970226", "title": "execution order of functors in std::bind() parameter list (maybe not related to evaluation order of function parameter)", "body": "<p>Using <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3690.pdf\" rel=\"nofollow noreferrer\">this draft</a> as reference.</p>\n\n<p><strong>func.bind.bind</strong> [20.10.9.1.3] doesn't specify when the bind sub-expressions are evaluated or their order.</p>\n\n<p>It simply states that if one of the arguments to bind is a bind-expression result, the return value of the outer bind expression uses the result of calling the inner bind-expression with the arguments passed to the outer bind expression.  It gives no sequencing information for when those values are evaluated; one may presume that it \"must\" happen after the outer bind expression is passed arguments, but that (as far as I can tell) only something I can conclude with common sense, not from the standard text itself.</p>\n"}], "owner": {"reputation": 874, "user_id": 6858550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbd1aac23957d00bfb620319ddd38a13?s=128&d=identicon&r=PG&f=1", "display_name": "Han XIAO", "link": "https://stackoverflow.com/users/6858550/han-xiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 51970226, "answer_count": 1, "score": 1, "last_activity_date": 1534951658, "creation_date": 1534948973, "last_edit_date": 1534950358, "question_id": 51969417, "link": "https://stackoverflow.com/questions/51969417/execution-order-of-functors-in-stdbind-parameter-list-maybe-not-related-to", "title": "execution order of functors in std::bind() parameter list (maybe not related to evaluation order of function parameter)", "body": "<p>I was just wondering and write the following code: (I am not asking for work arounds, I just want to know whether <code>bind()</code> handles this perfectly or not). Besides, I think <code>bind</code> can handle this and define an order for it, but I am not sure or maybe it is just a parameter evaluation order issue.</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;utility&gt;\n#include &lt;iostream&gt;\nusing namespace std;\nclass increment{\npublic : \n    string operator()(int&amp; x)\n    {\n        ++x;\n        return string {\"dumb_return_value\"};\n    }\n};\n\nclass multiply{\npublic : \n    string operator()(int&amp; x)\n    {\n        x = x * 2;\n        return string {\"dumb_return_value\"};\n    }\n};\n\ntemplate &lt;typename A, typename B&gt;\nclass do_nothing{\npublic : \n    void operator()(A , B)\n    {\n        return;\n    }\n};\n\n\nint main()\n{\n    int x = 0;\n    increment increment_object;\n    multiply multiply_object;\n    do_nothing&lt;string,string&gt; do_nothing_object;\n\n    bind(do_nothing_object,bind(increment_object,ref(x)),bind(multiply_object,ref(x)))();\n    cout &lt;&lt; x &lt;&lt; endl;//output 2\n\n    x = 0;\n    bind(do_nothing_object,bind(multiply_object,ref(x)),bind(increment_object,ref(x)))();\n    cout &lt;&lt; x &lt;&lt; endl;//output 1\n}\n</code></pre>\n\n<p>compilation option : <code>std=c++1z</code>\nSo, I use the reference semantics to amplify the difference here. What is the execution order of these sub-functions <code>increment</code> and <code>multiply</code>? Does <code>bind</code> handle this providently and define an order, or it is dependent on function parameter evaluation sequence, which is compiler-specific? If <code>std::bind()</code> handles this providently, please cite it, thanks!</p>\n\n<p>PS: one reason why I ask this question is here: <a href=\"https://stackoverflow.com/questions/51969785/c-equivalent-of-javas-andthen-function-to-composite-new-function\">c++ equivalent of java's andThen function to composite new function?</a></p>\n"}, {"tags": ["c++", "sdl"], "comments": [{"owner": {"reputation": 1824, "user_id": 8704463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fbfeed2e9c309c1c5d030eb9fe75707?s=128&d=identicon&r=PG&f=1", "display_name": "R zu", "link": "https://stackoverflow.com/users/8704463/r-zu"}, "edited": false, "score": 0, "creation_date": 1534948824, "post_id": 51969337, "comment_id": 90889116, "body": "treat it as a sprite? <a href=\"https://stackoverflow.com/questions/48087300/rendering-sprites-with-sdl2\" title=\"rendering sprites with sdl2\">stackoverflow.com/questions/48087300/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 3, "creation_date": 1534948961, "post_id": 51969337, "comment_id": 90889217, "body": "Modern graphics cards and APIs are optimized for the clear/draw/display cycle. It&#39;s what they are good at. Just embrace it. Clear the screen every frame, draw everything, then display the result."}], "owner": {"reputation": 185, "user_id": 9469747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fda9d670cba233d35a97b33df1eb393?s=128&d=identicon&r=PG&f=1", "display_name": "merija", "link": "https://stackoverflow.com/users/9469747/merija"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534948787, "creation_date": 1534948718, "last_edit_date": 1534948787, "question_id": 51969337, "link": "https://stackoverflow.com/questions/51969337/in-sdl-how-do-i-move-a-rectangle-without-clearing-screen", "title": "In SDL, how do I move a rectangle without clearing screen?", "body": "<p>If I draw a rectangle, and render it to the screen, then change the position of the rectangle, and render it to the screen, it draws two rectangles: the previous one is still there.</p>\n\n<p>I could clear the window in-between these two actions, but that seems a bit silly. Imagine having a million points and only needing to move one of them. Would I then have to redraw the entire image again? </p>\n\n<p>How do I just move ONE object? From x,y to x+1, y+1 say?</p>\n"}, {"tags": ["c++", "macos", "debugging"], "comments": [{"owner": {"reputation": 91, "user_id": 9319361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab714c69e3541755dbca404bd1c47d6?s=128&d=identicon&r=PG&f=1", "display_name": "Camden Weaver", "link": "https://stackoverflow.com/users/9319361/camden-weaver"}, "reply_to_user": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1534948088, "post_id": 51968977, "comment_id": 90888588, "body": "@HighPerformanceMark i want to create my own using c++, not use xcode"}, {"owner": {"reputation": 1342, "user_id": 1574374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6f66f66b0b5781a51040183831d6403?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Harris", "link": "https://stackoverflow.com/users/1574374/mike-harris"}, "edited": false, "score": 0, "creation_date": 1534948153, "post_id": 51968977, "comment_id": 90888630, "body": "@CamdenWeaver Create your own what? Your own debugger?"}, {"owner": {"reputation": 91, "user_id": 9319361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab714c69e3541755dbca404bd1c47d6?s=128&d=identicon&r=PG&f=1", "display_name": "Camden Weaver", "link": "https://stackoverflow.com/users/9319361/camden-weaver"}, "reply_to_user": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1534948478, "post_id": 51968977, "comment_id": 90888868, "body": "@HighPerformanceMark thanks, i updated my question"}, {"owner": {"reputation": 2173, "user_id": 6577680, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BNh_9G6Q-1M/AAAAAAAAAAI/AAAAAAAAAA8/uTxVAAioLfw/photo.jpg?sz=128", "display_name": "Matthew Fisher", "link": "https://stackoverflow.com/users/6577680/matthew-fisher"}, "edited": false, "score": 0, "creation_date": 1535506901, "post_id": 51968977, "comment_id": 91086701, "body": "Have a look here for a simple debugger idea. <a href=\"http://uninformed.org/index.cgi?v=4&amp;a=3&amp;p=14\" rel=\"nofollow noreferrer\">uninformed.org/index.cgi?v=4&amp;a=3&amp;p=14</a>"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 9319361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab714c69e3541755dbca404bd1c47d6?s=128&d=identicon&r=PG&f=1", "display_name": "Camden Weaver", "link": "https://stackoverflow.com/users/9319361/camden-weaver"}, "edited": false, "score": 0, "creation_date": 1534947952, "post_id": 51969052, "comment_id": 90888474, "body": "i know that, but i want to do that in c++, automatically."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 91, "user_id": 9319361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab714c69e3541755dbca404bd1c47d6?s=128&d=identicon&r=PG&f=1", "display_name": "Camden Weaver", "link": "https://stackoverflow.com/users/9319361/camden-weaver"}, "edited": false, "score": 0, "creation_date": 1534948159, "post_id": 51969052, "comment_id": 90888636, "body": "@Camden Weaver then use one of the <code>exec</code> family runctions to launch your preferred debugger and provide it the arguments it needs, then connect <code>pipe</code>s to its stdin/stdout so you can communicate with it. <code>gdb</code> even has a MI (Machine parsable Interface) you can enable to make it easier to interact with the debugger programmatically."}, {"owner": {"reputation": 91, "user_id": 9319361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab714c69e3541755dbca404bd1c47d6?s=128&d=identicon&r=PG&f=1", "display_name": "Camden Weaver", "link": "https://stackoverflow.com/users/9319361/camden-weaver"}, "edited": false, "score": 0, "creation_date": 1534948465, "post_id": 51969052, "comment_id": 90888853, "body": "thats a little hackish, i really want to make my own debugger rather than read from one"}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 0, "last_activity_date": 1534948532, "last_edit_date": 1534948532, "creation_date": 1534947839, "answer_id": 51969052, "question_id": 51968977, "link": "https://stackoverflow.com/questions/51968977/how-to-develop-a-debugger/51969052#51969052", "title": "How to develop a debugger", "body": "<p>Use a debugger. Such as <code>gdb</code> or <code>lldb</code> for example. They have plenty of documentation to teach you the <em>how</em> bit, but for example <code>gdb -p &lt;pid of process&gt;</code> will attach gdb to a running process.</p>\n\n<p>If you want to drive <code>gdb</code> for example <em>from</em> a C++ program, then launch it in a separate process (see <code>fork</code> and <code>exec</code>) with the aguments it needs (probably including the one to enable its machine parsable interface). Make sure you set up <code>pipe</code>s to its <code>stdin</code>/<code>stdout</code> so you can read its output and send it commands.</p>\n\n<p>If instead you want to write your own debugger from scratch then that is a <em>huge</em> undertaking. I suggest starting by reading the source of an existing open source debugger.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 9319361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab714c69e3541755dbca404bd1c47d6?s=128&d=identicon&r=PG&f=1", "display_name": "Camden Weaver", "link": "https://stackoverflow.com/users/9319361/camden-weaver"}, "edited": false, "score": 0, "creation_date": 1534948579, "post_id": 51969214, "comment_id": 90888934, "body": "thanks, i might look into that. It might be kind of hard to find what i exactly need because of gdb&#39;s complexity, though"}], "tags": [], "owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "is_accepted": false, "score": 1, "last_activity_date": 1534948337, "creation_date": 1534948337, "answer_id": 51969214, "question_id": 51968977, "link": "https://stackoverflow.com/questions/51968977/how-to-develop-a-debugger/51969214#51969214", "title": "How to develop a debugger", "body": "<p>Well, if you want to write a debugger, take a look at the <a href=\"https://sourceware.org/git/?p=gdb.git\" rel=\"nofollow noreferrer\">gdb</a>/<a href=\"https://lldb.llvm.org/source.html\" rel=\"nofollow noreferrer\">lldb</a> source code. I'd suggest the latter, due to historical legacy in gdb that might cloud whatever is actually going on. </p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 9319361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab714c69e3541755dbca404bd1c47d6?s=128&d=identicon&r=PG&f=1", "display_name": "Camden Weaver", "link": "https://stackoverflow.com/users/9319361/camden-weaver"}, "edited": false, "score": 0, "creation_date": 1534948709, "post_id": 51969286, "comment_id": 90889050, "body": "That sounds like a good idea, but the documentation for the LLDB API is pretty small"}], "tags": [], "owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "is_accepted": false, "score": 2, "last_activity_date": 1534948553, "creation_date": 1534948553, "answer_id": 51969286, "question_id": 51968977, "link": "https://stackoverflow.com/questions/51968977/how-to-develop-a-debugger/51969286#51969286", "title": "How to develop a debugger", "body": "<p>LLDB has an API that can be consumed from <a href=\"https://lldb.llvm.org/cpp_reference/html/index.html\" rel=\"nofollow noreferrer\">C++</a> or <a href=\"https://lldb.llvm.org/python_reference/index.html\" rel=\"nofollow noreferrer\">Python</a>. Maybe this is what you\u2019re looking for.</p>\n\n<p>Unfortunately the documentation is fairly threadbare, and there don\u2019t seem to be usage examples. This will therefore entail some reading of the source and a lot of trial and error.</p>\n"}, {"tags": [], "owner": {"reputation": 25560, "user_id": 2068642, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DYTnZ.jpg?s=128&g=1", "display_name": "TheDarkKnight", "link": "https://stackoverflow.com/users/2068642/thedarkknight"}, "is_accepted": false, "score": 0, "last_activity_date": 1534954061, "creation_date": 1534954061, "answer_id": 51970958, "question_id": 51968977, "link": "https://stackoverflow.com/questions/51968977/how-to-develop-a-debugger/51970958#51970958", "title": "How to develop a debugger", "body": "<p>Whilst you could look at source code of another debugger, you may find it difficult to understand without the knowledge of the underlying concepts. Therefore, I recommend you start by obtaining a good grounding of the concepts with the following resources:</p>\n\n<p><a href=\"https://rads.stackoverflow.com/amzn/click/com/0134426541\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Mac OS X Sys Internals</a>\nRather outdated now, but the original bible for the internals of Mac</p>\n\n<p><a href=\"http://newosxbook.com/MOXiI.pdf\" rel=\"nofollow noreferrer\">Mac OS X and iOS Internals</a>\nAgain, outdated but useful. This link is Jonathan Levin's (the author's) own site and he's now providing it for free, due to issues he had with the publisher. He's since purchased back the rights, making it available to all.</p>\n\n<p><a href=\"http://newosxbook.com/index.php\" rel=\"nofollow noreferrer\">*OS Internals</a>\nThe current bible of Mac Internals, also by Jonathan Levin. Books III and I have been published, with book II to follow shortly!</p>\n"}, {"tags": [], "owner": {"reputation": 20083, "user_id": 2465073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f7ba796598ce99fe9d17b66c119b00?s=128&d=identicon&r=PG", "display_name": "Jim Ingham", "link": "https://stackoverflow.com/users/2465073/jim-ingham"}, "is_accepted": false, "score": 2, "last_activity_date": 1535504595, "creation_date": 1535504595, "answer_id": 52068112, "question_id": 51968977, "link": "https://stackoverflow.com/questions/51968977/how-to-develop-a-debugger/52068112#52068112", "title": "How to develop a debugger", "body": "<p>If you really want to make your own debugger, another way to start would be to figure out how to cons up and parse the gdb-remote protocol packets (e.g. <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Remote-Protocol.html\" rel=\"nofollow noreferrer\">https://sourceware.org/gdb/onlinedocs/gdb/Remote-Protocol.html</a>).  That's the protocol gdb uses when remote debugging and lldb uses for everything but Windows debugging.  On MacOS, lldb spawns a debugserver instance which does the actual debugging and controls it with gdb-remote protocol packets.  On Linux, it uses the lldb-server tool that's part of the Linux lldb distribution for the same purpose.  </p>\n\n<p>The gdb-remote protocol has primitives for most of the operations you want to perform, launch a process, attach to a process, set breakpoints, read memory &amp; registers and isolates you from a lot of the low-level details of controlling processes.</p>\n\n<p>You can help yourself out by observing how lldb uses this protocol by running an lldb debug session with:</p>\n\n<p>(lldb) log enable gdb-remote packets</p>\n\n<p>But you might also have a look at the SB API's in lldb.  The documentation is not as advanced as it should be but there are a bunch of examples in the examples/python directory of the lldb sources to get you started, and in general the API's are pretty straightforward and self-explanatory.  </p>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 871119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/279200995348b680d50a074a204a898b?s=128&d=identicon&r=PG", "display_name": "Zorg", "link": "https://stackoverflow.com/users/871119/zorg"}, "is_accepted": false, "score": 1, "last_activity_date": 1535992698, "creation_date": 1535992698, "answer_id": 52153615, "question_id": 51968977, "link": "https://stackoverflow.com/questions/51968977/how-to-develop-a-debugger/52153615#52153615", "title": "How to develop a debugger", "body": "<p>If you want to write your own debugger, you'll need to obtain a task port to the process (<code>task_for_pid</code>), then you can read/write/iterate to virtual memory (<code>mach_vm_read</code>, <code>mach_vm_write</code>, <code>mach_vm_region</code>). To do breakpoints, you need to first set up an <a href=\"https://www.mikeash.com/pyblog/friday-qa-2013-01-11-mach-exception-handlers.html\" rel=\"nofollow noreferrer\">exception handler</a> then you can manipulate the <a href=\"https://en.wikipedia.org/wiki/X86_debug_register\" rel=\"nofollow noreferrer\">debug registers</a> on threads (<code>task_threads</code>, <code>thread_get_state</code>, <code>thread_set_state</code>) and handle them in the exception handler.</p>\n\n<p><a href=\"https://github.com/zorgiepoo/Bit-Slicer/blob/master/Bit%20Slicer/ZGBreakPointController.m#L925\" rel=\"nofollow noreferrer\">Reference</a> to some not all that correct debugger code I've written because breakpoints (especially instruction ones) are a bit involved.</p>\n\n<p><a href=\"https://github.com/blankwall/MacDBG\" rel=\"nofollow noreferrer\">MacDBG</a> may be another lightweight reference but I haven't used it myself.</p>\n"}], "owner": {"reputation": 91, "user_id": 9319361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab714c69e3541755dbca404bd1c47d6?s=128&d=identicon&r=PG&f=1", "display_name": "Camden Weaver", "link": "https://stackoverflow.com/users/9319361/camden-weaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2989, "favorite_count": 1, "answer_count": 6, "score": 5, "last_activity_date": 1535992698, "creation_date": 1534947643, "last_edit_date": 1534951573, "question_id": 51968977, "link": "https://stackoverflow.com/questions/51968977/how-to-develop-a-debugger", "title": "How to develop a debugger", "body": "<p>I am looking for a way to do things such as attach to a process, set breakpoints, view memory, and other things that gdb/lldb can do. I cannot, however, find a way to do these things. </p>\n\n<p>This question is similar to <a href=\"https://stackoverflow.com/questions/16534397/breakpoint-handling-in-another-process\">this one</a>, but for MacOS instead of Windows. Any help is appreciated!</p>\n\n<p><strong>Note: I want to make a debugger, not use one.</strong></p>\n\n<p>Another thing is that i dont want this debugger to be super complicated, all i need is just reading/writing memory, breakpoint handling, and viewing the GPR</p>\n"}, {"tags": ["java", "c++", "apache-kafka", "protocol-buffers", "kafka-consumer-api"], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 9911256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ad7e1b38689a2155d0cb4123e54e65d?s=128&d=identicon&r=PG&f=1", "display_name": "RodolfoAP", "link": "https://stackoverflow.com/users/9911256/rodolfoap"}, "edited": false, "score": 0, "creation_date": 1535009661, "post_id": 51979031, "comment_id": 90910661, "body": "I think I&#39;ve already tried that: it gives <b>Exception in thread &quot;main&quot; com.google.protobuf.InvalidProtocolBufferException: Protocol message contained an invalid tag (zero).</b>"}], "tags": [], "owner": {"reputation": 21, "user_id": 7183189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa3525738b7e827bcd49aaabc646da5?s=128&d=identicon&r=PG&f=1", "display_name": "AstureS", "link": "https://stackoverflow.com/users/7183189/astures"}, "is_accepted": false, "score": 1, "last_activity_date": 1535003106, "creation_date": 1535003106, "answer_id": 51979031, "question_id": 51968968, "link": "https://stackoverflow.com/questions/51968968/kafka-protobuf-c-serialization-to-java/51979031#51979031", "title": "Kafka Protobuf: C++ serialization to java", "body": "<p>You can read kafka as <code>ConsumerRecords&lt;Long, String&gt;</code>. And then <code>SolidList.parseFrom(ByteBuffer.wrap(record.value().getBytes(\"UTF-8\")));</code></p>\n"}, {"comments": [{"owner": {"reputation": 259, "user_id": 9911256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ad7e1b38689a2155d0cb4123e54e65d?s=128&d=identicon&r=PG&f=1", "display_name": "RodolfoAP", "link": "https://stackoverflow.com/users/9911256/rodolfoap"}, "edited": false, "score": 0, "creation_date": 1535011110, "post_id": 51979441, "comment_id": 90911479, "body": "Great! it works! (the deserializer is required, my mistake on a previous comment); thanks, that made the trick. Peace. \u2013 RodolfoAP 9 mins ago"}], "tags": [], "owner": {"reputation": 18486, "user_id": 143585, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5dcaecb4780c8bb5af9873d32235c701?s=128&d=identicon&r=PG", "display_name": "Denis Tulskiy", "link": "https://stackoverflow.com/users/143585/denis-tulskiy"}, "is_accepted": true, "score": 1, "last_activity_date": 1535005273, "creation_date": 1535005273, "answer_id": 51979441, "question_id": 51968968, "link": "https://stackoverflow.com/questions/51968968/kafka-protobuf-c-serialization-to-java/51979441#51979441", "title": "Kafka Protobuf: C++ serialization to java", "body": "<p>Try implementing a <a href=\"https://kafka.apache.org/0102/javadoc/org/apache/kafka/common/serialization/Deserializer.html\" rel=\"nofollow noreferrer\">Deserializer</a> and pass it to <a href=\"https://kafka.apache.org/0100/javadoc/index.html?org/apache/kafka/clients/consumer/KafkaConsumer.html\" rel=\"nofollow noreferrer\">KafkaConsumer</a> constructor as value deserializer. It could look like this:</p>\n\n<pre><code>class SolidListDeserializer implements Deserializer&lt;SolidList&gt; {\n  public SolidList deserialize(final String topic, byte[] data) {\n    return SolidList.parseFrom(data);\n  }\n  ...\n}\n\n...\n\nKafkaConsumer&lt;Long, SolidList&gt; consumer = new KafkaConsumer&lt;&gt;(props, new LongDeserializer(), new SolidListDeserializer())\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 9911256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ad7e1b38689a2155d0cb4123e54e65d?s=128&d=identicon&r=PG&f=1", "display_name": "RodolfoAP", "link": "https://stackoverflow.com/users/9911256/rodolfoap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 1, "accepted_answer_id": 51979441, "answer_count": 2, "score": 4, "last_activity_date": 1535005273, "creation_date": 1534947610, "last_edit_date": 1535002546, "question_id": 51968968, "link": "https://stackoverflow.com/questions/51968968/kafka-protobuf-c-serialization-to-java", "title": "Kafka Protobuf: C++ serialization to java", "body": "<p>I've developed a couple of C++ apps that produce and consume Kafka messages (using cppkafka) embedding Protobuf3 messages. Both work fine. The producer's relevant code is:</p>\n\n<pre><code>std::string kafkaString;\ncppkafka::MessageBuilder *builder;\n...\nsolidList-&gt;SerializeToString(&amp;kafkaString);\nbuilder-&gt;payload(kafkaString);\n</code></pre>\n\n<p>Protobuf objects are serialized to string and inserted as Kafka payload. Everything works fine up to this point. Now, I'm trying to develop a consumer for that in Java. The relevant code should be:</p>\n\n<pre><code>KafkaConsumer&lt;Long, String&gt; consumer=new KafkaConsumer&lt;Long, String&gt;(properties);\n....\nConsumerRecords&lt;Long, String&gt; records = consumer.poll(100);\n  for (ConsumerRecord&lt;Long, String&gt; record : records) {\n    SolidList solidList = SolidList.parseFrom(record.value());\n    ...\n</code></pre>\n\n<p>but that fails at compile time: parseFrom complains: <strong>The method parseFrom(ByteBuffer) in the type Solidlist.SolidList is not applicable for the arguments (String)</strong>. So, I try using a ByteBuffer:</p>\n\n<pre><code>KafkaConsumer&lt;Long, ByteBuffer&gt; consumer=new KafkaConsumer&lt;Long, ByteBuffer&gt;(properties);\n....\nConsumerRecords&lt;Long, ByteBuffer&gt; records = consumer.poll(100);\n  for (ConsumerRecord&lt;Long, ByteBuffer&gt; record : records) {\n    SolidList solidList = SolidList.parseFrom(record.value());\n    ...\n</code></pre>\n\n<p>Now, the error is on execution time, still on parseFrom(): <strong>Exception in thread \"main\" java.lang.ClassCastException: java.lang.String cannot be cast to java.nio.ByteBuffer</strong>. I know it is a java.lang.String!!! So, I get back to the original, and try using it as a byte array:</p>\n\n<pre><code>    SolidList solidList = SolidList.parseFrom(record.value().getBytes());\n</code></pre>\n\n<p>Now, the error is on execution time: <strong>Exception in thread \"main\" com.google.protobuf.InvalidProtocolBufferException$InvalidWireTypeException: Protocol message tag had invalid wire type.</strong>.</p>\n\n<p>The protobuf documentation states for the C++ serialization: <em>bool SerializeToString(string</em> output) const;: serializes the message and stores the bytes in the given string. <strong>Note that the bytes are binary, not text</strong>; we only use the string class as a convenient container.* </p>\n\n<p>TL;DR: In consequence, how should I interpret the protobuf C++ \"binary bytes\" in Java?</p>\n\n<p>This seems related (it is the opposite) but doesn't help: <a href=\"https://stackoverflow.com/questions/32509208/protobuf-java-to-c-serialization-binary\">Protobuf Java To C++ Serialization [Binary]</a></p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "lambda", "function-pointers", "variadic-functions"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1534947532, "post_id": 51968880, "comment_id": 90888189, "body": "Not exactly sure, do you want to bind arguments (with lambda) ? Do you want <code>std::function&lt;void()&gt;</code> ?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534947669, "post_id": 51968880, "comment_id": 90888281, "body": "Does <code>setHandler</code> have to take a function pointer?  If it does you can&#39;t use a capturing lambda."}, {"owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1534948064, "post_id": 51968880, "comment_id": 90888571, "body": "@Jarod42 I want a behaviour like in JS were you don&#39;t need to define exactly what arguments you have in your declared function"}, {"owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534948068, "post_id": 51968880, "comment_id": 90888575, "body": "@NathanOliver I&#39;m not exactly sure, but I need to save that function in something like a variable to execute it later on when an event happens"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534948157, "post_id": 51968880, "comment_id": 90888632, "body": "@Panakotta00 Do you want to accept lambdas that capture?  Returns from <code>std::bind</code> where you bind a object to a member function?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1534948387, "post_id": 51968880, "comment_id": 90888801, "body": "Do I understand correctly that you want a function pointer to a variadic function? That is not possible as-is."}, {"owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534948389, "post_id": 51968880, "comment_id": 90888804, "body": "@NathanOliver It doesn&#39;t need that, but it is good when it can do that. This will go into a library, so I don&#39;t exactly know if the user needs that or not."}, {"owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1534948483, "post_id": 51968880, "comment_id": 90888871, "body": "@MaxLanghof It must not be a function pointer, It needs to be any kind of storage to save that function"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1534955926, "post_id": 51968880, "comment_id": 90893434, "body": "A lambda evaluates to a <i>closure</i>, and an function pointer is not a closure (because it has no closed variables)"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534947917, "post_id": 51969011, "comment_id": 90888446, "body": "@NathanOliver: OP&#39;s lambda actually doesn&#39;t capture. Not sure if it is intended BTW."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1534948029, "post_id": 51969011, "comment_id": 90888539, "body": "@Jarod42 Oh, I missed that.  I saw the <code>[=]</code> and assumed it did.  Thanks for pointing that out"}, {"owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "edited": false, "score": 0, "creation_date": 1534948242, "post_id": 51969011, "comment_id": 90888694, "body": "Yeah, that goes into that direction, but there you don&#39;t have the arguments which are kind of important."}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "reply_to_user": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "edited": false, "score": 0, "creation_date": 1534949032, "post_id": 51969011, "comment_id": 90889270, "body": "@Panakotta00  I extend my answer for your use case. Does it solves your question?"}, {"owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "edited": false, "score": 0, "creation_date": 1534949092, "post_id": 51969011, "comment_id": 90889312, "body": "@Korni the problem is that I need a variadic argument in the foo function"}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "reply_to_user": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "edited": false, "score": 0, "creation_date": 1534949922, "post_id": 51969011, "comment_id": 90889844, "body": "@Panakotta00 I change my answer. Is it suitable now ?:D"}, {"owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "edited": false, "score": 0, "creation_date": 1534950397, "post_id": 51969011, "comment_id": 90890134, "body": "@Korni we are getting closer but... I need not only integers... as I said I need a variadic function"}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "reply_to_user": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "edited": false, "score": 0, "creation_date": 1535012260, "post_id": 51969011, "comment_id": 90912114, "body": "@Panakotta00 I figured it out, see my edited anwer :)"}], "tags": [], "owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "is_accepted": false, "score": 2, "last_activity_date": 1535109647, "last_edit_date": 1535109647, "creation_date": 1534947732, "answer_id": 51969011, "question_id": 51968880, "link": "https://stackoverflow.com/questions/51968880/how-to-combine-lambda-vairadic-functions-and-function-pointers/51969011#51969011", "title": "How to combine lambda, vairadic functions and function pointers?", "body": "<p><strong>Variadic Arguments</strong></p>\n\n<p>I figured it out, how to do it with an variadic argument list. The trick is to use an wrapper around the changeable function and use <code>va_copy</code>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include &lt;cstdarg&gt;\n\nstd::function&lt;void (int, va_list)&gt; foo = [] (int numargs, va_list args)\n{\n     va_list args_copy;\n     va_copy(args_copy, args);\n     std::cout &lt;&lt; \"Old Foo \" &lt;&lt;va_arg(args_copy,int) &lt;&lt; std::endl;\n     va_end(args_copy);\n};\n\nvoid set_foo(std::function&lt;void (int, va_list)&gt; new_foo)\n{\n    foo = new_foo;\n}\n\nvoid wrapper(int numargs, ...)\n{\n    va_list args;\n    va_start(args, numargs);\n    foo(numargs, args);\n    va_end(args);\n}\n\nint main() {\n\n    wrapper(123,456);\n\n    set_foo([](int numargs, va_list args)\n    {\n         va_list args_copy;\n         va_copy(args_copy, args);\n         std::cout &lt;&lt; \"New Foo \" &lt;&lt; va_arg(args_copy,int) &lt;&lt; std::endl;\n         va_end(args_copy);\n     });\n\n    wrapper(123,456);\n    return 0;\n}\n</code></pre>\n\n<p>This results in:</p>\n\n<pre><code>Old Foo 456\nNew Foo 456\n</code></pre>\n\n<blockquote>\n  <p>I don't why the wrapper is needed, maybe someone knows. But it works :P</p>\n</blockquote>\n\n<hr>\n\n<p><strong>Known Arguments</strong></p>\n\n<p>You can use an <code>initializer_list</code> to pass variadic argument of an specific type to an variable lambda.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include &lt;initializer_list&gt;\n\nstd::function&lt;void (std::initializer_list&lt;int&gt;)&gt; foo = [](std::initializer_list&lt;int&gt; args) \n  {\n    for (auto i: args) std::cout &lt;&lt; \"Old Foo: \"&lt;&lt; i &lt;&lt; '\\n';\n  };\n\nvoid setFoo(std::function&lt;void (std::initializer_list&lt;int&gt;)&gt; new_foo) {\n    foo = new_foo;\n};\n\n\nint main()\n{\n  foo({2, 4, 5});\n  std::cout &lt;&lt; std::endl;\n  setFoo([](std::initializer_list&lt;int&gt; args) \n  {\n    for (auto i: args) std::cout &lt;&lt; \"New Foo: \"&lt;&lt; i &lt;&lt; '\\n';\n  });\n  foo({2, 4});\n}\n</code></pre>\n\n<p>This will return:</p>\n\n<pre><code>Old Foo: 2\nOld Foo: 4\nOld Foo: 5\n\nNew Foo: 2\nNew Foo: 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "is_accepted": false, "score": -1, "last_activity_date": 1534953034, "last_edit_date": 1534953034, "creation_date": 1534952297, "answer_id": 51970422, "question_id": 51968880, "link": "https://stackoverflow.com/questions/51968880/how-to-combine-lambda-vairadic-functions-and-function-pointers/51970422#51970422", "title": "How to combine lambda, vairadic functions and function pointers?", "body": "<p>I'm imagining you <em>want</em> to do something which looks like this: </p>\n\n<pre><code>Delegator delegator;\ndelegator.set_handler(handler);\n</code></pre>\n\n<p>Unfortunately, either the type of <code>handler</code> OR it's type signature (with <code>std::function</code>) have to be known when <code>Delegator</code> is declared.  Depending on what you want to do, this isn't so bad.  If it's okay for the user of your library to define a bunch of handlers in one go, and if it's okay for you to enumerate to the user which types the handlers should handle, e.g.</p>\n\n<pre><code>//The library user defines this\nstruct MyHandlers {\n  void operator()(int){ \n    std::cout &lt;&lt; \"Event with i=\" &lt;&lt; i &lt;&lt; std::endl;\n  }\n\n  template&lt;class T&gt;\n  void operator()(std::string str, T t_){  \n    std::cout &lt;&lt; \"Event with str=\" &lt;&lt; str &lt;&lt; \" and some class=\" &lt;&lt; t_ &lt;&lt; \"!\" &lt;&lt; std::endl;\n  }\n\n  void operator()(std::string str){ /** more code **/ }\n};\n</code></pre>\n\n<p>Then you can do something similar to what you originally wanted to do.</p>\n\n<pre><code>//This would go in the library\ntemplate&lt;class Handlers&gt;\nstruct Delegator_t {\n  Handlers handlers;\n\n  template&lt;class T&gt;\n  void do_stuff_which_eventually_calls_handlers(T t_) {\n    std::string string = \"string\";\n    if (/** condition **/) {\n      handlers(5);\n    } else {\n      handlers(string, t_);\n    }\n    //The user's third overload never gets called.\n  }\n}\ntemplate&lt;class Handlers&gt;\nDelegator_t&lt;Handlers&gt; Delegator(Handlers handlers){ return{std::move(handlers)}; }\n</code></pre>\n\n<p>And finally, the user can use your library and their <code>MyHandlers</code> class with the following</p>\n\n<pre><code>auto delegator = Delegator(MyHandlers{});\nSomeClass some_class(/** some args **/);\ndelegator.do_stuff_which_eventually_calls_handlers(some_class);\n</code></pre>\n\n<p>Of course, if the user has to register various handlers at <em>different</em> points in time to the <em>same</em> delegator, the above method is useless.</p>\n"}, {"tags": [], "owner": {"reputation": 1018, "user_id": 1312320, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebf28b20dae6510720e69b1310422fd2?s=128&d=identicon&r=PG", "display_name": "sardok", "link": "https://stackoverflow.com/users/1312320/sardok"}, "is_accepted": false, "score": -1, "last_activity_date": 1534954929, "creation_date": 1534954929, "answer_id": 51971200, "question_id": 51968880, "link": "https://stackoverflow.com/questions/51968880/how-to-combine-lambda-vairadic-functions-and-function-pointers/51971200#51971200", "title": "How to combine lambda, vairadic functions and function pointers?", "body": "<p>Some of the things you may do</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\nvoid exec_handler(std::function&lt;void(int, std::string)&gt; cb) {\n        static int cnt = 0;\n        cb(cnt++, \"from_exec_handler\");\n}\n\nvoid handler1(int count, std::string name) {\n        std::cout &lt;&lt; \"handler1\\t\" &lt;&lt; count &lt;&lt; \" \" &lt;&lt; name &lt;&lt; std::endl;\n}\n\nvoid handler2(int count, std::string name, std::string name2) {\n        std::cout &lt;&lt; \"handler2\\t\" &lt;&lt; count &lt;&lt; \" \" &lt;&lt; name &lt;&lt; \" \" &lt;&lt; name2 &lt;&lt; std::endl;\n}\n\n\nint main(int argc, char *argv[]) {\n        auto handler_lambda = [](int count, std::string name) {\n                        std::cout &lt;&lt; \"lambda\\t\\t\" &lt;&lt; count &lt;&lt; \" \" &lt;&lt; name &lt;&lt; std::endl;\n                        };\n        auto clojure = [](int count, std::string name) {\n                return handler2(count, name, \"clojure\");\n        };\n        auto partial = std::bind(handler2, std::placeholders::_1, std::placeholders::_2, \"partial\");\n        exec_handler(handler1);\n        exec_handler(handler_lambda);\n        exec_handler(clojure);\n        exec_handler(partial);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>handler1        0 from_exec_handler\nlambda          1 from_exec_handler\nhandler2        2 from_exec_handler clojure\nhandler2        3 from_exec_handler partial\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "is_accepted": false, "score": 0, "last_activity_date": 1535029867, "last_edit_date": 1535029867, "creation_date": 1535026757, "answer_id": 51985676, "question_id": 51968880, "link": "https://stackoverflow.com/questions/51968880/how-to-combine-lambda-vairadic-functions-and-function-pointers/51985676#51985676", "title": "How to combine lambda, vairadic functions and function pointers?", "body": "<p>I have, in my opinion found the best solution.</p>\n\n<p>I use this class as a container for the function:</p>\n\n<pre><code>#define C(...) __VA_ARGS__\n#define F(a, ...) (std::function&lt;void(__VA_ARGS__)&gt;)[ a ](__VA_ARGS__)\n\n#pragma once\n\n#include &lt;memory&gt;\n#include &lt;functional&gt;\n\nclass HandlerFunc {\nprivate:\n    struct function_b {\n        virtual ~function_b() {};\n    };\n\n    template&lt;typename... Args&gt;\n    struct func : function_b {\n        typedef std::function&lt;void(Args...)&gt; func_t;\n        func_t funct;\n        func(func_t f) : funct(f) {};\n    };\n\n    std::unique_ptr&lt;function_b&gt; fb;\npublic:\n    template &lt;typename... Args&gt;\n    HandlerFunc(std::function&lt;void(Args...)&gt; f) : fb(new func&lt;Args...&gt;(f)) { };\n\n    template &lt;typename... Args&gt;\n    HandlerFunc&amp; operator=(std::function&lt;void(Args...)&gt; f) {\n        fb = std::unique_ptr&lt;function_b&gt;(new func&lt;Args...&gt;(f));\n        return *this;\n    };\n\n    template &lt;typename... Args&gt;\n    void operator()(Args... args) const {\n        func&lt;Args...&gt;* f = dynamic_cast&lt;func&lt;Args...&gt;*&gt;(fb.get());\n        if (f)\n            f-&gt;funct(args...);\n        else\n            throw std::runtime_error(\"Invalid arguments to function object call!\");\n    };\n};\n</code></pre>\n\n<p>And now it is possible to write code like this:</p>\n\n<pre><code>std::vector&lt;HandlerFunc&gt; funcs;\n\ntemplate&lt;typename... Args&gt;\nvoid add(std::function&lt;void(Args...)&gt; func) {\n    funcs.push_back(func);\n}\n\nint main() {\n    int a = 321;\n    int b = 123;\n\n    add(F(C(a, b), int i){\n        std::cout &lt;&lt; a &lt;&lt; b &lt;&lt; i &lt;&lt; std::endl;\n    });\n    add(F(C(=), std::string str){\n        std::cout &lt;&lt; b &lt;&lt; a &lt;&lt; str &lt;&lt; std::endl;\n    });\n\n    int i = 0;\n    for (auto&amp; func : funcs) {\n        if (i &lt; 1) func(1234);\n        else func(\"meep\");\n    }\n}\n</code></pre>\n\n<p>The only one thing i want to have, is a #define that converts something like this</p>\n\n<pre><code>add(F([=], int i, std::string str){\n    ...\n});\n</code></pre>\n\n<p>into this</p>\n\n<pre><code>add((std::function&lt;void(int, std::string))[=](int i, std::string str){\n    ...\n});\n</code></pre>\n\n<p>I'm very new to preprocessor stuff like that ^^</p>\n"}], "owner": {"reputation": 145, "user_id": 8559298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rXCCrIzQq14/AAAAAAAAAAI/AAAAAAAAAAs/LdvngLMZlDM/photo.jpg?sz=128", "display_name": "Panakotta00", "link": "https://stackoverflow.com/users/8559298/panakotta00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 1, "answer_count": 4, "score": 4, "last_activity_date": 1535109647, "creation_date": 1534947350, "last_edit_date": 1534948523, "question_id": 51968880, "link": "https://stackoverflow.com/questions/51968880/how-to-combine-lambda-vairadic-functions-and-function-pointers", "title": "How to combine lambda, vairadic functions and function pointers?", "body": "<p>I have a nice idea which simplifies (for me) a lot of things.</p>\n\n<p>Imagine you have a function that takes a function with x arguments which will be executed if an event happens. And to simplify this you have defined a new type with typedef, that is a function pointer.</p>\n\n<pre><code>typedef void (*HandlerFunction)(...);\n\nvoid setHandler(HandlerFunction fun) {...}\n</code></pre>\n\n<p>now you use the setHandler function to... set the handler with a lambda function with additional sepcific arguments because you know that this function will always be called with these specific arguments.</p>\n\n<pre><code>setHandler([](int i, std::string arg) {\n    std::cout &lt;&lt; \"Event with i=\" &lt;&lt; i &lt;&lt; \" and arg=\" &lt;&lt; arg &lt;&lt; \"!\" &lt;&lt; std::endl;\n});\n</code></pre>\n\n<p>Now the question is... is this even possible in C++ and when yes, how?</p>\n"}, {"tags": ["c++", "eclipse", "poco-libraries"], "answers": [{"comments": [{"owner": {"reputation": 283, "user_id": 5098635, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0f9d6fff1055088b8cc14f5039aa9219?s=128&d=identicon&r=PG&f=1", "display_name": "Roham Amini", "link": "https://stackoverflow.com/users/5098635/roham-amini"}, "edited": false, "score": 0, "creation_date": 1534951265, "post_id": 51969712, "comment_id": 90890670, "body": "Thank you for your answer. Looking at the library now I understood that PocoMySQL has been renamed to PocoDataMySQL in the latest version of the library. Using -lPocoDataMySQL resolved the issue."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1534949907, "creation_date": 1534949907, "answer_id": 51969712, "question_id": 51968841, "link": "https://stackoverflow.com/questions/51968841/conflict-between-libraries/51969712#51969712", "title": "Conflict Between Libraries", "body": "<p>The error message says that <code>-lPocoMySQL</code> comes from <code>/usr/lib/gcc/x86_64-linux-gnu/5/../../../../lib/libPocoMySQL.so</code>, not from <code>/home/{username}/poco-1.9.0-all/lib</code>. </p>\n\n<p>Make sure that:</p>\n\n<ul>\n<li>you have built <code>libPocoMySQL.so</code>, and</li>\n<li><code>/home/{username}/poco-1.9.0-all</code> is a valid path (it does not look like one).</li>\n</ul>\n"}], "owner": {"reputation": 283, "user_id": 5098635, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0f9d6fff1055088b8cc14f5039aa9219?s=128&d=identicon&r=PG&f=1", "display_name": "Roham Amini", "link": "https://stackoverflow.com/users/5098635/roham-amini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "accepted_answer_id": 51969712, "answer_count": 1, "score": 0, "last_activity_date": 1534949907, "creation_date": 1534947207, "last_edit_date": 1534948575, "question_id": 51968841, "link": "https://stackoverflow.com/questions/51968841/conflict-between-libraries", "title": "Conflict Between Libraries", "body": "<p>I know this question has been asked few number of times but after searching for a day I still cannot resolve it. I am trying to use the POCO C++ LIBRARIES and ubuntu 16.0.4 LTS comes with POCO 1.3 installed. I downloaded the latest version of POCO and built and installed it to /home/{username}/poco-1.9.0-all. But when I build my project using eclipse I get the following error:</p>\n\n<pre><code>Building target: AuthorizationServer\nInvoking: GCC C++ Linker\ng++ -L/home/{username}/poco-1.9.0-all/lib -o \"AuthorizationServer\"  ./src/entity/ResourceOwner.o  ./src/database/MySQL.o  ./main.o   -lPocoFoundation -lPocoData -lPocoMySQL\n/usr/bin/ld: warning: libPocoData.so.9, needed by /usr/lib/gcc/x86_64-linux-gnu/5/../../../../lib/libPocoMySQL.so, may conflict with libPocoData.so.60\n/usr/bin/ld: warning: libPocoFoundation.so.9, needed by /usr/lib/gcc/x86_64-linux-gnu/5/../../../../lib/libPocoMySQL.so, may conflict with libPocoFoundation.so.60\nFinished building target: AuthorizationServer\n</code></pre>\n\n<p>But following the instructions from <a href=\"https://stackoverflow.com/a/44393801\">link1</a> I can see that my project has been properly configured and uses -L/home/{username}/poco-1.9.0-all/lib. Can anyone help me with this issue. Thanks in advance.<br>\nMy eclipse project properties is as follow:  </p>\n\n<p>C/C++ Build->Settings->Tool Settings->GCC C++ Compiler->Includes->Include paths(-I) contains /home/{username}/poco-1.9.0-all/include  </p>\n\n<p>C/C++ Build->Settings->Tool Settings->GCC C++ Linker->Libraries->Libraries (-l) contains PocoFoundation, PocoData, PocoMySQL  </p>\n\n<p>C/C++ Build->Settings->Tool Settings->GCC C++ Linker->Libraries->Library search path(-L) contains /home/{username}/poco-1.9.0-all/lib</p>\n"}, {"tags": ["java", "c++", "parsing", "wrapper"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10260109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9183056f01dc6d2e2f60eca4869771d?s=128&d=identicon&r=PG&f=1", "display_name": "MrMarnic", "link": "https://stackoverflow.com/users/10260109/mrmarnic"}, "edited": false, "score": 0, "creation_date": 1534975556, "post_id": 51974925, "comment_id": 90902020, "body": "There was something I did wrong but now a Invalid memory access Expection is thrown when i run the method"}, {"owner": {"reputation": 172, "user_id": 6846232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb26ac2eb21db23f9c20416979cd319e?s=128&d=identicon&r=PG&f=1", "display_name": "Mano176", "link": "https://stackoverflow.com/users/6846232/mano176"}, "reply_to_user": {"reputation": 23, "user_id": 10260109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9183056f01dc6d2e2f60eca4869771d?s=128&d=identicon&r=PG&f=1", "display_name": "MrMarnic", "link": "https://stackoverflow.com/users/10260109/mrmarnic"}, "edited": false, "score": 0, "creation_date": 1553009745, "post_id": 51974925, "comment_id": 97222429, "body": "@MrMarnic Can you explain for me how you fixed it? I try to use the ShGetImageList function with this IImagelist as a parameter but it also gives me an invalid memory access exception"}, {"owner": {"reputation": 23, "user_id": 10260109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9183056f01dc6d2e2f60eca4869771d?s=128&d=identicon&r=PG&f=1", "display_name": "MrMarnic", "link": "https://stackoverflow.com/users/10260109/mrmarnic"}, "edited": false, "score": 0, "creation_date": 1553009857, "post_id": 51974925, "comment_id": 97222493, "body": "I don\u2019t remember how I did it but here is the source the library that I made that does exactly that : <a href=\"https://github.com/MrMarnic/JIconExtract\" rel=\"nofollow noreferrer\">github.com/MrMarnic/JIconExtract</a>"}], "tags": [], "owner": {"reputation": 5374, "user_id": 1161484, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lg24v.png?s=128&g=1", "display_name": "Daniel Widdis", "link": "https://stackoverflow.com/users/1161484/daniel-widdis"}, "is_accepted": true, "score": 0, "last_activity_date": 1555854379, "last_edit_date": 1555854379, "creation_date": 1534971045, "answer_id": 51974925, "question_id": 51968763, "link": "https://stackoverflow.com/questions/51968763/jna-how-to-wrap-interface-written-in-c/51974925#51974925", "title": "JNA How to wrap interface written in C++", "body": "<p>This can be done, but you will need access to the header file.  The <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/commoncontrols/nn-commoncontrols-iimagelist\" rel=\"nofollow noreferrer\">IImageList</a> documentation tells you this comes from <a href=\"https://github.com/tpn/winsdk-10/blob/master/Include/10.0.16299.0/um/commoncontrols.h\" rel=\"nofollow noreferrer\">commoncontrols.h</a>.  Refer to this source file for the following discussion.</p>\n\n<p>Although not mandatory, for organization you will want to create a Java class for the header file, e.g., <code>CommonControls.java</code>.  Inside that create a class for the interface, extending JNA's <a href=\"https://static.javadoc.io/net.java.dev.jna/jna/4.5.2/com/sun/jna/platform/win32/COM/Unknown.html\" rel=\"nofollow noreferrer\"><code>Unknown</code></a> class and add the method(s) you want. The methods should use <a href=\"https://static.javadoc.io/net.java.dev.jna/jna/4.5.2/com/sun/jna/platform/win32/COM/COMInvoker.html#Z:Z_invokeNativeObject-int-java.lang.Object:A-java.lang.Class-\" rel=\"nofollow noreferrer\"><code>_invokeNativeObject()</code></a> (or the <code>void</code> or <code>int</code> variants).  The key point here is that you'll need the <code>vtableId</code>.  This is where you go back to the header file listed earlier.  Find the <code>IImageListVtbl</code> entry in the header (it's on line 322) and count the methods (0-indexed) to find which ID corresponds to the method you want.  vtableID = 0 would be <code>QueryInterface</code>.  Id 1 is <code>AddRef</code>.  And so on.</p>\n\n<p>See, as an example, how I implemented several interfaces from wbemcli.h in <a href=\"https://github.com/oshi/oshi/blob/master/oshi-core/src/main/java/oshi/jna/platform/windows/Wbemcli.java\" rel=\"nofollow noreferrer\">this Wbemcli.java class</a>.  One example implements the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/wbemcli/nf-wbemcli-ienumwbemclassobject-next\" rel=\"nofollow noreferrer\"><code>IEnumWbemClassObject::Next</code></a> method thus:</p>\n\n<pre><code>class IEnumWbemClassObject extends Unknown {\n\n    public IEnumWbemClassObject(Pointer pvInstance) {\n        super(pvInstance);\n    }\n\n    public HRESULT Next(int lTimeOut, int uCount, PointerByReference ppObjects, IntByReference puReturned) {\n        // Next is 5th method of IEnumWbemClassObjectVtbl in\n        // WbemCli.h\n        return (HRESULT) _invokeNativeObject(4,\n                new Object[] { getPointer(), lTimeOut, uCount, ppObjects, puReturned }, HRESULT.class);\n    }\n}\n</code></pre>\n\n<p>You can add multiple methods (or all of them) in the same class.</p>\n"}, {"tags": [], "owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "is_accepted": false, "score": -1, "last_activity_date": 1555855732, "creation_date": 1555855732, "answer_id": 55783465, "question_id": 51968763, "link": "https://stackoverflow.com/questions/51968763/jna-how-to-wrap-interface-written-in-c/55783465#55783465", "title": "JNA How to wrap interface written in C++", "body": "<p>This ended up being the solution:</p>\n\n<pre><code>class IImageList extends Unknown {\n    public IImageList(Pointer pvInstance) {\n        super(pvInstance);\n    }\n\n    public WinNT.HRESULT GetIcon(int i, int flags, PointerByReference picon) {\n        return (WinNT.HRESULT) _invokeNativeObject(10,\n                new Object[]{this.getPointer(), i, flags, picon},WinNT.HRESULT.class);\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Solution pulled from <a href=\"https://stackoverflow.com/q/51968763/3002139\">question</a>; written by <a href=\"https://stackoverflow.com/users/10260109/mrmarnic\">mrmarnic</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 10260109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9183056f01dc6d2e2f60eca4869771d?s=128&d=identicon&r=PG&f=1", "display_name": "MrMarnic", "link": "https://stackoverflow.com/users/10260109/mrmarnic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 51974925, "answer_count": 2, "score": 1, "last_activity_date": 1555855790, "creation_date": 1534946979, "last_edit_date": 1555855790, "question_id": 51968763, "link": "https://stackoverflow.com/questions/51968763/jna-how-to-wrap-interface-written-in-c", "title": "JNA How to wrap interface written in C++", "body": "<p>I already know how to wrap an Structure , but I need some help with interfaces.\nThe interface I want to wrap is the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/commoncontrols/nn-commoncontrols-iimagelist\" rel=\"nofollow noreferrer\">IImageList</a>.</p>\n\n<p>But I have now clue how to create an java class out of it.</p>\n"}, {"tags": ["c++", "std", "precision", "stringstream"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1534947104, "post_id": 51968579, "comment_id": 90887909, "body": "Quoting <a href=\"https://en.cppreference.com/w/cpp/io/ios_base/precision\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/ios_base/precision</a> &quot;The default precision, as established by std::basic_ios::init, is 6.&quot;. I&#39;m sure you can find the other defaults you are interested in with a little digging through the site."}, {"owner": {"reputation": 881, "user_id": 9254404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17947ccbc8b0336e68ec69063d81789e?s=128&d=identicon&r=PG&f=1", "display_name": "leiyc", "link": "https://stackoverflow.com/users/9254404/leiyc"}, "edited": false, "score": 0, "creation_date": 1534947898, "post_id": 51968579, "comment_id": 90888435, "body": "Also can use a simple program to check the precision: <a href=\"http://coliru.stacked-crooked.com/a/365269145e1c1378\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/365269145e1c1378</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 881, "user_id": 9254404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17947ccbc8b0336e68ec69063d81789e?s=128&d=identicon&r=PG&f=1", "display_name": "leiyc", "link": "https://stackoverflow.com/users/9254404/leiyc"}, "edited": false, "score": 0, "creation_date": 1534947969, "post_id": 51968579, "comment_id": 90888484, "body": "@leiyc While that gives you an answer it is by no means the answer.  If it was implantation defined then you could get any result and you wouldn&#39;t know if that was truly &quot;correct&quot;"}, {"owner": {"reputation": 881, "user_id": 9254404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17947ccbc8b0336e68ec69063d81789e?s=128&d=identicon&r=PG&f=1", "display_name": "leiyc", "link": "https://stackoverflow.com/users/9254404/leiyc"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1534948436, "post_id": 51968579, "comment_id": 90888835, "body": "@NathanOliver, yes, I just take it as an example to verify the answer posted."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1534947415, "post_id": 51968753, "comment_id": 90888107, "body": "you manually created this list? or is the some trick to get it?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1534947489, "post_id": 51968753, "comment_id": 90888157, "body": "@user463035818 Follow the <a href=\"https://en.cppreference.com/w/cpp/io/basic_ios/init\" rel=\"nofollow noreferrer\">std::basic_ios::init</a> link. It&#39;s right there on cppreference.com"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1534947496, "post_id": 51968753, "comment_id": 90888161, "body": "@user463035818 I copied it from the standard and just added tabs to get the second column to line up.  IIRC there is a user script out there to build tables.  The DB people use it."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 6, "last_activity_date": 1534946942, "creation_date": 1534946942, "answer_id": 51968753, "question_id": 51968579, "link": "https://stackoverflow.com/questions/51968579/what-are-the-default-format-flags-and-widths-for-double-output-in-a-stdstrin/51968753#51968753", "title": "What are the default Format Flags (and widths) for double output in a std::stringstream?", "body": "<p>The defaults are setup by <a href=\"https://en.cppreference.com/w/cpp/io/basic_ios/init\" rel=\"noreferrer\"><code>std::basic_ios::init</code></a> and are the same for all streams derived from <code>ios_base</code>.  The defaults are:</p>\n\n<pre><code>rdbuf()         sb\ntie()           0\nrdstate()       goodbit if sb is not a null pointer, otherwise badbit.\nexceptions()    goodbit\nflags()         skipws | dec\nwidth()         0\nprecision()     6\nfill()          widen(\u2019 \u2019)\ngetloc()        a copy of the value returned by locale()\niarray          a null pointer\nparray          a null pointer\n</code></pre>\n\n<p>So the default precision is 6</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1534949320, "last_edit_date": 1534949320, "creation_date": 1534948032, "answer_id": 51969124, "question_id": 51968579, "link": "https://stackoverflow.com/questions/51968579/what-are-the-default-format-flags-and-widths-for-double-output-in-a-stdstrin/51969124#51969124", "title": "What are the default Format Flags (and widths) for double output in a std::stringstream?", "body": "<blockquote>\n  <p>Where can I find a list of the default format setup for a stringstream?</p>\n</blockquote>\n\n<p>The authoritative source for all standard library behaviour is the standard document. In this case, the table labeled <code>basic_ios::init() effects</code> in the section [basic.ios.members].</p>\n\n<pre><code>+--------------+--------------------------------------------------------+\n|   Element    |                         Value                          |\n+--------------+--------------------------------------------------------+\n| rdbuf()      | sb                                                     |\n| tie()        | 0                                                      |\n| rdstate()    | goodbit if sb is not a null pointer, otherwise badbit. |\n| exceptions() | goodbit                                                |\n| flags()      | skipws | dec                                           |\n| width()      | 0                                                      |\n| precision()  | 6                                                      |\n| fill()       | widen(\u2019 \u2019)                                             |\n| getloc()     | a copy of the value returned by locale()               |\n| iarray       | a null pointer                                         |\n| parray       | a null pointer                                         |\n+--------------+--------------------------------------------------------+\n</code></pre>\n\n<p>Formatting floating point numbers depends on the <code>floatfield</code> flag, which is unset in the default <code>flags()</code>. The behaviour is defined in the table <code>Floating-point conversions</code> in section [facet.num.put.virtuals].</p>\n\n<pre><code>+----------------------------------------------------------------------+-----------------+\n|                                State                                 | stdioequivalent |\n+----------------------------------------------------------------------+-----------------+\n| floatfield == ios_base::fixed                                        | %f              |\n| floatfield == ios_base::scientific &amp;&amp; !uppercase                     | %e              |\n| floatfield == ios_base::scientific                                   | %E              |\n| floatfield == (ios_base::fixed | ios_base::scientific) &amp;&amp; !uppercase | %a              |\n| floatfield == (ios_base::fixed | ios_base::scientific)               | %A              |\n| !uppercase                                                           | %g              |\n| otherwise                                                            | %G              |\n+----------------------------------------------------------------------+-----------------+\n</code></pre>\n\n<p>So, formatting in the initial state should match stdio format flag <code>%G</code>. The stdio format flags are specified in the C standard in the section [Formatted input/output functions]:</p>\n\n<blockquote>\n  <p>f,F</p>\n  \n  <p>A <strong>double</strong> argument representing a floating-point number is converted to decimal notation in style [\u2212]ddd.ddd, where the number of digits after the decimal-point character is equal to the precision specification. If the precision is missing, it is taken as 6; if the precision is zero and the <strong>#</strong> flag is not specified, no decimal-point character appears. If a decimal-point character appears, at least one digit appears before it. The value is rounded to the appropriate number of digits.</p>\n  \n  <p>e,E</p>\n  \n  <p>A <strong>double</strong> argument representing a floating-point number is converted in the style [-]d.ddde\u00b1dd, where there is one digit (which is nonzero if the argument is nonzero) before the decimal-point character and the number of digits after it is equal to the precision; if the precision is missing, it is taken as 6; if the precision is zero and the <strong>#</strong> flag is not specified, no decimal-point character appears. The value is rounded to the appropriate number of digits. The <strong>E</strong> conversion specifier produces a number with <strong>E</strong> instead of <strong>e</strong> introducing the exponent. The exponent always contains at least two digits, and only as many more digits as necessary to represent the exponent. If the value is zero, the exponent is zero.</p>\n  \n  <p>A <strong>double</strong> argument representing an infinity is converted in one of the styles <strong>[-]inf</strong> or <strong>[-]infinity</strong> - which style is implementation-defined. A double argument representing a NaN is converted in one of the styles <strong>[-]nan* or **[-nan]</strong>(n-char-sequence) - which style, and the meaning of any n-char-sequence, is implementation-defined. The F conversion specifier produces <strong>INF</strong>,<strong>INFINITY</strong>, or <strong>NAN</strong> instead of <strong>inf</strong>,<strong>infinity</strong> ,or <strong>nan</strong>, respectively.</p>\n  \n  <p>g,G</p>\n  \n  <p>A <strong>double</strong> argument representing a floating-point number is converted in style <strong>f</strong> or <strong>e</strong> (or in style <strong>F</strong> or <strong>E</strong> in the case of <strong>G</strong> conversion specifier), depending on the value converted and the precision. Let <code>P</code> equal the precision if nonzero, 6 if the precision is omitted, or 1 if the precision is zero. Then, if a conversion with style <strong>E</strong> would have an exponent of <code>X</code>:</p>\n  \n  <ul>\n  <li>if <code>P &gt; X \u2265 -4</code>, the conversion is with style <strong>f</strong> (or <strong>F</strong>) and precision <code>P - (X + 1)</code>.</li>\n  <li>otherwise, the conversion is with style <strong>e</strong> (or <strong>E</strong>) and precision <code>P - 1</code>.</li>\n  </ul>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>Is the default format the same for all derived classes of std::istream (within the stdlib)?</p>\n</blockquote>\n\n<p>Yes, the defaults are the same.</p>\n"}], "owner": {"reputation": 1995, "user_id": 2718002, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a1ed8371bd619c1d0297cea4efbf984b?s=128&d=identicon&r=PG&f=1", "display_name": "powerpete", "link": "https://stackoverflow.com/users/2718002/powerpete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 3, "accepted_answer_id": 51968753, "answer_count": 2, "score": 3, "last_activity_date": 1534949320, "creation_date": 1534946394, "last_edit_date": 1534947742, "question_id": 51968579, "link": "https://stackoverflow.com/questions/51968579/what-are-the-default-format-flags-and-widths-for-double-output-in-a-stdstrin", "title": "What are the default Format Flags (and widths) for double output in a std::stringstream?", "body": "<p>What is the default format, when I'm writting a double to a <code>stringstream</code>?</p>\n\n<pre><code>double v = 3.0;\nstd::stringstream ss;\nss &lt;&lt; v;\n</code></pre>\n\n<p>Where can I find a list of the default format setup for a <code>stringstream</code>? Is the default format the same for all derived classes of <code>std::istream</code> (within the stdlib)?</p>\n"}, {"tags": ["c++", "linux", "multithreading", "sockets", "udp"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1534945063, "post_id": 51968131, "comment_id": 90886550, "body": "You probably want to do that in a poll() loop rather than using different threads."}, {"owner": {"reputation": 1, "user_id": 10259766, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NOpAPKeQWa8/AAAAAAAAAAI/AAAAAAAAAFk/TR0NdbQEQBI/photo.jpg?sz=128", "display_name": "AlsApps", "link": "https://stackoverflow.com/users/10259766/alsapps"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1535032631, "post_id": 51968131, "comment_id": 90924550, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6, <a href=\"https://stackoverflow.com/questions/51986477/polling-recvfrom-sendto\" title=\"polling recvfrom sendto\">stackoverflow.com/questions/51986477/polling-recvfrom-sendto</a>"}], "owner": {"reputation": 1, "user_id": 10259766, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NOpAPKeQWa8/AAAAAAAAAAI/AAAAAAAAAFk/TR0NdbQEQBI/photo.jpg?sz=128", "display_name": "AlsApps", "link": "https://stackoverflow.com/users/10259766/alsapps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534944888, "creation_date": 1534944888, "question_id": 51968131, "link": "https://stackoverflow.com/questions/51968131/sendto-recvfrom-simultaneously", "title": "sendto(), recvfrom() simultaneously", "body": "<p>I have two detached threads in server: for receiving and sending data. \nAll work fine, until setting client's sending frequency to 16 ms (&lt; ~200 ms). In this state one thread always wins the race and answers to only one client with ~1 us ping. What I need to do to send and receive data in separate threads with two (or one) UDP sockets?</p>\n\n<p><strong>Part of server's code:</strong></p>\n\n<pre><code>void Server::receive() {\n    while(true) {\n        if (recvfrom(getReceiver()-&gt;getSocketDesc(), buffer, getBufferLength(), 0, (struct sockaddr *) &amp;currentClient, getReceiver()-&gt;getLength()) &lt; 0) {\n        // add message to client's own thread-safe buffer\n        }\n    }\n}\n\nvoid Server::send() {\n    while(true) {\n        // get message from thread-safe general buffer after processing\n        // dequeue one\n        if (message != nullptr)\n            sendto(getDispatcher()-&gt;getSocketDesc(), \"hi\", 2, 0, message-&gt;_addr, *getDispatcher()-&gt;getLength());\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "multithreading", "visual-studio", "debugging"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1534944813, "post_id": 51968097, "comment_id": 90886395, "body": "Stepping shouldn&#39;t change to another thread. Perhaps you have a breakpoint that the other thread is hitting."}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 1, "creation_date": 1534945470, "post_id": 51968097, "comment_id": 90886817, "body": "It shouldn&#39;t switch threads, but you can always select the thread of interest in the &quot;Thread&quot; dropdown on the debug toolbar."}], "answers": [{"tags": [], "owner": {"reputation": 815, "user_id": 10219720, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BJLRpxdJZH8/AAAAAAAAAAI/AAAAAAAABig/hW2vzxeXmC4/photo.jpg?sz=128", "display_name": "Impurity", "link": "https://stackoverflow.com/users/10219720/impurity"}, "is_accepted": false, "score": 1, "last_activity_date": 1534952575, "creation_date": 1534952575, "answer_id": 51970516, "question_id": 51968097, "link": "https://stackoverflow.com/questions/51968097/visual-studio-debug-in-only-one-thread/51970516#51970516", "title": "Visual Studio Debug in only one thread", "body": "<p><strong>Breakpoints</strong></p>\n\n<p>You can configure VS2017 debugger to filter only a specific thread. Follow <a href=\"https://blogs.msdn.microsoft.com/devops/2013/10/09/filter-breakpoints/\" rel=\"nofollow noreferrer\">this msdn</a> blog to apply one to a breakpoint. You want to filter on <strong>ThreadId</strong>.</p>\n\n<hr>\n\n<p><strong>Thread Window</strong></p>\n\n<p>Another way is through the <a href=\"https://msdn.microsoft.com/en-us/library/w15yf86f.aspx\" rel=\"nofollow noreferrer\">Threads Window</a>. Here you can view all active threads in the application.</p>\n\n<ol>\n<li>Debug > Windows > Threads</li>\n<li>Right click desired thread</li>\n<li>Click <em>switch to thread</em></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 5606, "user_id": 6601554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d8e70907365c8fce9135ffe1e5868f?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Zhai-MSFT", "link": "https://stackoverflow.com/users/6601554/jack-zhai-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1535772157, "creation_date": 1535772157, "answer_id": 52124597, "question_id": 51968097, "link": "https://stackoverflow.com/questions/51968097/visual-studio-debug-in-only-one-thread/52124597#52124597", "title": "Visual Studio Debug in only one thread", "body": "<p>You could try to use this extension tool:</p>\n\n<p><a href=\"https://marketplace.visualstudio.com/items?itemName=mayerwin.DebugSingleThread\" rel=\"nofollow noreferrer\">https://marketplace.visualstudio.com/items?itemName=mayerwin.DebugSingleThread</a></p>\n\n<p>Actually other members also post this feature request and shared some suggestions with comments here:</p>\n\n<p><a href=\"https://visualstudio.uservoice.com/forums/121579-visual-studio-ide/suggestions/8543248-make-the-debugger-stick-to-the-current-thread-inst\" rel=\"nofollow noreferrer\">https://visualstudio.uservoice.com/forums/121579-visual-studio-ide/suggestions/8543248-make-the-debugger-stick-to-the-current-thread-inst</a></p>\n\n<p>If possible, you could view it, but if all suggestions or workaround are not what you want to get, you could also vote and add your comment for above feature requests.</p>\n"}], "owner": {"reputation": 355, "user_id": 10108544, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Gx1IH-UzV3I/AAAAAAAAAAI/AAAAAAAAAAc/ztW3RHbeRT4/photo.jpg?sz=128", "display_name": "Gordon", "link": "https://stackoverflow.com/users/10108544/gordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2008, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1535772157, "creation_date": 1534944783, "last_edit_date": 1534964445, "question_id": 51968097, "link": "https://stackoverflow.com/questions/51968097/visual-studio-debug-in-only-one-thread", "title": "Visual Studio Debug in only one thread", "body": "<p>I use VS2017 to debug my C++ app. However, when I utilize <em>single-step debug</em>, it will switch to some thread automatically and I only want to debug one specific thread. How could I go about doing this?</p>\n"}, {"tags": ["c++", ".net", "mapping"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1534944181, "post_id": 51967831, "comment_id": 90885918, "body": "Depends on the OS. Which one are you using?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1534946922, "post_id": 51967831, "comment_id": 90887800, "body": "The quantity may also depend on the available memory on the platform."}, {"owner": {"reputation": 11, "user_id": 7033585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a5b1bbf6f90c2e74116ac0037c1c52?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Eagle", "link": "https://stackoverflow.com/users/7033585/richard-eagle"}, "edited": false, "score": 0, "creation_date": 1534947931, "post_id": 51967831, "comment_id": 90888454, "body": "Thanks for the replies. From what I was already able to gather there is some variances between machines. What I am looking for is a way to know ahead of time what the limit it. This way instead of my process breaking down I can better handle failing to create the mapped memory file."}, {"owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "edited": false, "score": 1, "creation_date": 1534975700, "post_id": 51967831, "comment_id": 90902055, "body": "@RichardEagle Why you need to know the limit in advance? What if it&#39;s a moving target? Isn&#39;t it better to detect failure at creation time and handle the case appropriately?"}], "owner": {"reputation": 11, "user_id": 7033585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a5b1bbf6f90c2e74116ac0037c1c52?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Eagle", "link": "https://stackoverflow.com/users/7033585/richard-eagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534943895, "creation_date": 1534943895, "question_id": 51967831, "link": "https://stackoverflow.com/questions/51967831/max-number-of-open-mapped-memory-files", "title": "Max number of open mapped memory files", "body": "<p>I am working on a process that utilizes mapped memory files for cross application communication.</p>\n\n<p>I have some users who are seeing errors that appear to be caused by the OS not allowing anymore mapped memory files.</p>\n\n<p>My question is, what is the max number of mapped memory files you can have open? Is there a way to query and get this number?</p>\n\n<p>From what I can tell it varies machine to machine. One user saw the error at about 15 while another at 40.</p>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1534943614, "post_id": 51967446, "comment_id": 90885504, "body": "Please include all text generated by the compiler not just the part you think is important.  The notes/extra information is often key.  Also, <a href=\"http://coliru.stacked-crooked.com/a/93381d152fc017f0\" rel=\"nofollow noreferrer\">cannot reproduce</a>: what is your exact compiler version and flags?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1534943745, "post_id": 51967446, "comment_id": 90885596, "body": "cannot reproduce: <a href=\"https://godbolt.org/z/WJkv_1\" rel=\"nofollow noreferrer\">godbolt.org/z/WJkv_1</a>"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 3, "creation_date": 1534944213, "post_id": 51967446, "comment_id": 90885937, "body": "@YSC can repro: <a href=\"https://godbolt.org/z/fDLsi3\" rel=\"nofollow noreferrer\">godbolt.org/z/fDLsi3</a> (with MSVC) /cc Adam"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1534944307, "post_id": 51967446, "comment_id": 90886010, "body": "@Borgleader well done. So once again, MSVC is broken..."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1534944547, "post_id": 51967446, "comment_id": 90886183, "body": "Stab in the dark: put <code>()</code>s around <code>(base::create&lt;derived&gt;)</code>.  (Theory: preprocessor is doing something messed up)"}, {"owner": {"reputation": 2636, "user_id": 4635560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv67d.jpg?s=128&g=1", "display_name": "Manthan Tilva", "link": "https://stackoverflow.com/users/4635560/manthan-tilva"}, "edited": false, "score": 0, "creation_date": 1534944590, "post_id": 51967446, "comment_id": 90886213, "body": "Yes I think so, <a href=\"http://coliru.stacked-crooked.com/a/50904d080de0d8b9\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/50904d080de0d8b9</a> Seems working fine."}, {"owner": {"reputation": 2636, "user_id": 4635560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv67d.jpg?s=128&g=1", "display_name": "Manthan Tilva", "link": "https://stackoverflow.com/users/4635560/manthan-tilva"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1534944710, "post_id": 51967446, "comment_id": 90886309, "body": "@Yakk-AdamNevraumont No luck with  <code>(base::create&lt;derived&gt;)</code>"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1534945141, "post_id": 51967446, "comment_id": 90886605, "body": "Is <a href=\"https://stackoverflow.com/questions/5277547/directly-casting-from-pointer-to-a-template-function\">this</a> no longer applicable?"}, {"owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "edited": false, "score": 0, "creation_date": 1534948566, "post_id": 51967446, "comment_id": 90888930, "body": "@ManthanTilva So far I like the solution with the std::function, but in lack of the rest of your code, I cannot be fully sure it serves what you needed as a whole. Let me know if it works for you!"}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 2, "last_activity_date": 1534945749, "last_edit_date": 1534945749, "creation_date": 1534945438, "answer_id": 51968302, "question_id": 51967446, "link": "https://stackoverflow.com/questions/51967446/reinterpret-cast-cannot-convert-from-overloaded-function-to-intptr-t-with/51968302#51968302", "title": "&#39;reinterpret_cast&#39;: cannot convert from &#39;overloaded-function&#39; to &#39;intptr_t&#39; with boost.dll", "body": "<pre><code>// this really does nothing:\ntemplate&lt;class R, class...Args&gt;\nR(*to_fptr( R(*f)(Args...) ))(Args...) {\n    return f;\n}\n// except avoid the bug in MSVC:\nBOOST_DLL_ALIAS(to_fptr(base::create&lt;derived&gt;),\n            create_plugin\n)\n</code></pre>\n\n<p>that should fix it.</p>\n\n<p>MSVC seems to break when you try to cast from the name of a template function to a intptr_t.  This is a bug.</p>\n\n<p>The above workaround changes it from directly dealing with the name of a template function to just a function pointer.  By breaking the overload resolution and the cast to intptr_t apart, MSVC no longer chokes.</p>\n\n<p>You could probably also do:</p>\n\n<pre><code>template&lt;class T&gt;\nT identity( T t ) { return std::move(t); }\n</code></pre>\n\n<p>instead of <code>to_fptr</code>.</p>\n\n<p><code>to_fptr</code> is a function that takes a function pointer and returns it.  The syntax to return a function pointer from a function is a bit ridiculous, which is why it is hard to read.</p>\n"}, {"tags": [], "owner": {"reputation": 5319, "user_id": 2754173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b0a0fd9004b29fa441e5bbf6904e69?s=128&d=identicon&r=PG&f=1", "display_name": "Geezer", "link": "https://stackoverflow.com/users/2754173/geezer"}, "is_accepted": false, "score": 1, "last_activity_date": 1534945991, "last_edit_date": 1534945991, "creation_date": 1534945592, "answer_id": 51968352, "question_id": 51967446, "link": "https://stackoverflow.com/questions/51967446/reinterpret-cast-cannot-convert-from-overloaded-function-to-intptr-t-with/51968352#51968352", "title": "&#39;reinterpret_cast&#39;: cannot convert from &#39;overloaded-function&#39; to &#39;intptr_t&#39; with boost.dll", "body": "<p>This should do the trick:</p>\n\n<pre><code>BOOST_DLL_ALIAS(std::function&lt;std::shared_ptr&lt;base&gt;(void)&gt;(base::create&lt;derived&gt;), // &lt;-- this function is exported with...\n    create_plugin          // &lt;-- ...this alias name\n)\n</code></pre>\n\n<p>Indeed it seems MSVC has a bug here, as there should be no problem taking such an expression <code>base::create&lt;derived&gt;</code> and treating it directly as a function pointer. So instead, we \"feed it a function pointer\" ourselves using the magic of std::function.</p>\n\n<p>I've chosen to use <code>std::function</code> as it involves no writing of any kind of wrapping code and relies directly on intent-delivering standard c++ code.</p>\n\n<p>And of course don't forget to <code>#include &lt;functional&gt;</code> : )</p>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1534946671, "post_id": 51968426, "comment_id": 90887629, "body": "This makes me want to do a <code>#define DECAY_TO_VALUE(...)</code> macro to remove the DRY.  Also, that decay cast should be a <code>static_cast</code> I think."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1534947398, "post_id": 51968426, "comment_id": 90888089, "body": "Yeah, probably. I just found the triple <code>reinterpret_cast</code> hilarious. On that note, just a single <code>reinterpret_cast&lt;const void*&gt;(&amp;base::create&lt;derived&gt;)</code> apparently makes MSVC happy, too. Then again, I have no idea what casting to <code>intptr_t</code> first would accomplish in the first place."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1534945831, "creation_date": 1534945831, "answer_id": 51968426, "question_id": 51967446, "link": "https://stackoverflow.com/questions/51967446/reinterpret-cast-cannot-convert-from-overloaded-function-to-intptr-t-with/51968426#51968426", "title": "&#39;reinterpret_cast&#39;: cannot convert from &#39;overloaded-function&#39; to &#39;intptr_t&#39; with boost.dll", "body": "<p>Inspired by <a href=\"https://stackoverflow.com/questions/37860819/template-instantiation-error-in-msvs-2015\">this</a> tangentially related answer, I found another solution:</p>\n\n<pre><code>const void * create_plugin =\n    reinterpret_cast&lt;const void*&gt;(\n        reinterpret_cast&lt;std::intptr_t&gt;(\n            reinterpret_cast&lt;std::decay_t&lt;decltype(&amp;base::create&lt;derived&gt;)&gt; &gt;(\n                &amp;base::create&lt;derived&gt;\n            )\n        )\n    );\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/NVGz_0\" rel=\"nofollow noreferrer\">https://godbolt.org/z/NVGz_0</a></p>\n"}], "owner": {"reputation": 2636, "user_id": 4635560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv67d.jpg?s=128&g=1", "display_name": "Manthan Tilva", "link": "https://stackoverflow.com/users/4635560/manthan-tilva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1019, "favorite_count": 1, "accepted_answer_id": 51968302, "answer_count": 3, "score": 6, "last_activity_date": 1534945991, "creation_date": 1534942669, "last_edit_date": 1592644375, "question_id": 51967446, "link": "https://stackoverflow.com/questions/51967446/reinterpret-cast-cannot-convert-from-overloaded-function-to-intptr-t-with", "title": "&#39;reinterpret_cast&#39;: cannot convert from &#39;overloaded-function&#39; to &#39;intptr_t&#39; with boost.dll", "body": "<p>I am working on plugin system using <a href=\"https://www.boost.org/doc/libs/1_68_0/doc/html/boost_dll.html\" rel=\"nofollow noreferrer\">Boost.dll</a></p>\n<pre><code>#include &lt;boost/config.hpp&gt;\n#include &lt;boost/dll/alias.hpp&gt;\n#include &lt;memory&gt;\n\nclass base {\npublic:\n  base(){};\n  ~base(){};\n  template &lt;typename T&gt;\n  static std::shared_ptr&lt;base&gt; create() {\n    return std::make_shared&lt;T&gt;();\n  }\n  virtual void do1() = 0;\n};\n\nclass derived : public base {\npublic:\n  derived(){};\n  ~derived(){};\n  virtual void do1() override {}\n};\n\nBOOST_DLL_ALIAS(base::create&lt;derived&gt;, // &lt;-- this function is exported with...\n                create_plugin          // &lt;-- ...this alias name\n)\n\n// auto a = base::create&lt;derived&gt;();\n</code></pre>\n<p>When I trying use factory method inside BOOST_DLL_ALIAS macro getting error like below.</p>\n<blockquote>\n<pre><code>cl /c /ID:\\Download\\Compressed\\boost_1_67_0 a.cpp\n\nMicrosoft (R) C/C++ Optimizing Compiler Version 19.12.25834 for x86\n\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\na.cpp\n\na.cpp(27): error C2440: 'reinterpret_cast': cannot convert from 'overloaded-function' to 'intptr_t'\n\na.cpp(27): note: Context does not allow for disambiguation of overloaded function\n</code></pre>\n</blockquote>\n<p>Without BOOST_DLL_ALIAS macro when calling factory method (as shown in last commented line), it get compiled fine.</p>\n"}, {"tags": ["c++", "class", "namespaces"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1534943413, "post_id": 51967111, "comment_id": 90885374, "body": "If you want to use functions <code>A</code>, <code>B</code>and <code>C</code> without an instance of the <code>c</code> class, the implementation of these functions potentially needs to change significantly. It&#39;s somewhat hard to tell you what to do because it depends on how these functions are implemented."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 0, "creation_date": 1534941907, "post_id": 51967156, "comment_id": 90884338, "body": "and how i include that in my main.cpp?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 2, "creation_date": 1534941944, "post_id": 51967156, "comment_id": 90884364, "body": "@YoavLinder In the same way as you would include the class definition."}, {"owner": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 0, "creation_date": 1534942188, "post_id": 51967156, "comment_id": 90884514, "body": "i triedd, but it doesnt recognize that. its matked in red"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 0, "creation_date": 1534942265, "post_id": 51967156, "comment_id": 90884561, "body": "@YoavLinder You also need to use the same syntax (using the &quot;scope resolution&quot; operator, <code>::</code>) as when you access things in the <code>std</code> namespace - <code>c::A();</code>, and so on."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 0, "creation_date": 1534942349, "post_id": 51967156, "comment_id": 90884628, "body": "@YoavLinder   Did you <i>try</i> compiling it. Your IDE is <i>*not</i> the compiler, just because it colours the code a certain way does not necessarily mean the compiler won&#39;t accept it."}, {"owner": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 0, "creation_date": 1534942514, "post_id": 51967156, "comment_id": 90884746, "body": "yes, that gives an error DSP.h: No such file or directory"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 0, "creation_date": 1534942687, "post_id": 51967156, "comment_id": 90884866, "body": "@YoavLinder That&#39;s a completely unrelated issue. It means that your compiler can&#39;t find that file. You may need to check the settings in your IDE."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 1, "creation_date": 1534942696, "post_id": 51967156, "comment_id": 90884872, "body": "@YoavLinder you need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "edited": false, "score": 0, "creation_date": 1534942860, "post_id": 51967156, "comment_id": 90884992, "body": "if i change it to class  instead of namespace it doesnt find that also, you know what can be the problem?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1534942948, "post_id": 51967156, "comment_id": 90885069, "body": "This change doesn&#39;t work since the member functions weren&#39;t originally <code>static</code>. Without evidence to the contrary you have to assume <code>this</code> is meaningful. The meaning or usage of those functions must be significantly altered for this change to be applicable."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1534944086, "post_id": 51967156, "comment_id": 90885843, "body": "@Fran&#231;oisAndrieux That depends on whether these objects have any state (and whether there is more than one). Stateless objects (&quot;quasiobjects?&quot;) are fairly common, in particular among those who have learned a little bit about OOP and nothing about anything else, or had an object-obsessed teacher."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 6, "last_activity_date": 1534941733, "creation_date": 1534941733, "answer_id": 51967156, "question_id": 51967111, "link": "https://stackoverflow.com/questions/51967111/how-can-i-convert-my-class-into-a-namespace/51967156#51967156", "title": "how can i convert my class into a namespace", "body": "<p>It's much easier than you think.</p>\n\n<pre><code>namespace c\n{\n    void A();\n    void B();\n    void X();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1534942388, "post_id": 51967323, "comment_id": 90884654, "body": "only recommendable if you want to still be able to have instances of  <code>MyClass</code>"}, {"owner": {"reputation": 318, "user_id": 9913960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1671b1a81da1037f6c800da77d270f7?s=128&d=identicon&r=PG&f=1", "display_name": "user30701", "link": "https://stackoverflow.com/users/9913960/user30701"}, "reply_to_user": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1534942629, "post_id": 51967323, "comment_id": 90884826, "body": "Of course ! If you never intended to instanciate MyClass then use a namespace (molbdnilo answer)."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 2, "creation_date": 1534942730, "post_id": 51967323, "comment_id": 90884897, "body": "@Korni Or if you need it as a type parameter for a template."}], "tags": [], "owner": {"reputation": 318, "user_id": 9913960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1671b1a81da1037f6c800da77d270f7?s=128&d=identicon&r=PG&f=1", "display_name": "user30701", "link": "https://stackoverflow.com/users/9913960/user30701"}, "is_accepted": false, "score": 1, "last_activity_date": 1534942284, "creation_date": 1534942284, "answer_id": 51967323, "question_id": 51967111, "link": "https://stackoverflow.com/questions/51967111/how-can-i-convert-my-class-into-a-namespace/51967323#51967323", "title": "how can i convert my class into a namespace", "body": "<p>You may want to use static functions</p>\n\n<pre><code>class MyClass\n{\npublic:\n    static void A();\n}\n</code></pre>\n\n<p>You then may call those functions like this :</p>\n\n<pre><code>MyClass::A();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1534943108, "creation_date": 1534943108, "answer_id": 51967591, "question_id": 51967111, "link": "https://stackoverflow.com/questions/51967111/how-can-i-convert-my-class-into-a-namespace/51967591#51967591", "title": "how can i convert my class into a namespace", "body": "<p>You probably want something like this:</p>\n\n<p><strong>foo.cpp</strong></p>\n\n<pre><code>#include \"bar.h\"\n\nint main()\n{\n  bar::A();\n  bar::B();\n}\n</code></pre>\n\n<p><strong>bar.h</strong></p>\n\n<pre><code>namespace bar\n{\n  void A();\n  void B();\n}\n</code></pre>\n\n<p><strong>bar.cpp</strong></p>\n\n<pre><code>#include \"bar.h\"\n\nnamespace bar\n{\n  void A()\n  {\n    ...\n  }\n\n  void B()\n  {\n     ..\n  }\n}\n</code></pre>\n\n<p>This is a minimal example without header guards for brevity.</p>\n"}], "owner": {"reputation": 23, "user_id": 6333701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082605621813296/picture?type=large", "display_name": "Yoav Linder", "link": "https://stackoverflow.com/users/6333701/yoav-linder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1534943108, "creation_date": 1534941598, "question_id": 51967111, "link": "https://stackoverflow.com/questions/51967111/how-can-i-convert-my-class-into-a-namespace", "title": "how can i convert my class into a namespace", "body": "<p>i have a class in c++ that i want to convert to a namespace\ni have tried to look around in google but i couldn't find any solution that will make my class a namespace.\nhow do i do that? its a class that contains 3 functions.\nfor example:</p>\n\n<pre><code>class c\n{\npublic:\n    void A();\n    void B();\n    void X();\n}\n</code></pre>\n\n<p>i want to be able to use these functions without creating a new object of the class, i want to to be a namespace.\nclass C that has functions a(),b(),x(), will turn into a namespace.\np.s, i have CLion 2017\nty</p>\n"}, {"tags": ["c++", "adtf", "adtf3"], "answers": [{"tags": [], "owner": {"reputation": 236, "user_id": 7441271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TSYnQ.jpg?s=128&g=1", "display_name": "C-3PFLO", "link": "https://stackoverflow.com/users/7441271/c-3pflo"}, "is_accepted": true, "score": 1, "last_activity_date": 1535363152, "creation_date": 1535363152, "answer_id": 52036633, "question_id": 51966878, "link": "https://stackoverflow.com/questions/51966878/are-there-structured-properties-like-in-adtf2/52036633#52036633", "title": "Are there structured properties like in ADTF2?", "body": "<p>Yes, you can group properties in ADTF 3.x by seperate them with slashes, for example:</p>\n\n<pre><code>adtf::base::property_variable&lt;tBool&gt; m_bPropOne = tFalse;    \nadtf::base::property_variable&lt;tBool&gt; m_bPropTwo = tFalse;\n\ncMyADTF3Filter::cMyADTF3Filter()\n{\n    // ...\n\n    RegisterPropertyVariable(\"Foo/Property1\", m_bPropOne);\n    RegisterPropertyVariable(\"Foo/Property2\", m_bPropTwo);\n\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 936, "user_id": 1378135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3137f046f5050aefa819a8eb8fe8da29?s=128&d=identicon&r=PG&f=1", "display_name": "krase", "link": "https://stackoverflow.com/users/1378135/krase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 52036633, "answer_count": 1, "score": 2, "last_activity_date": 1539614633, "creation_date": 1534940782, "last_edit_date": 1535393835, "question_id": 51966878, "link": "https://stackoverflow.com/questions/51966878/are-there-structured-properties-like-in-adtf2", "title": "Are there structured properties like in ADTF2?", "body": "<p>In ADTF2 it was possible to create nested properties by concatenating the names with \"::\".\nSo property names \"Foo::Property1\" and \"Foo::Property2\" would create following structure:</p>\n\n<pre><code>Foo\n   Property1\n   Property2\n</code></pre>\n\n<p>Is something like this also possible in ADTF3?</p>\n"}, {"tags": ["c++", "opencv", "ocr", "tesseract"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1534943276, "post_id": 51966871, "comment_id": 90885293, "body": "OCR from on-screen text is just about as good as it gets - consistent font size, everything at a consistent angle, all characters the same size, no noise, excellent contrast.  Your licence plate has noise, the contrast in the original is quite poor, the text isn&#39;t aligned to the box.  Your biggest problem seems to be that it is trying to OCR the frame - and this is confusing it.  Can you remove the frame somehow?"}, {"owner": {"reputation": 129, "user_id": 10134831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a1b167b9f36ea7d8d631541ae6410e?s=128&d=identicon&r=PG&f=1", "display_name": "begginer", "link": "https://stackoverflow.com/users/10134831/begginer"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1534949136, "post_id": 51966871, "comment_id": 90889347, "body": "I was hoping that you help me a liitle bit with it. I am thinking about remove frame, use a littile bit perspective transformation and maybe some better filter? But it is not so easy for me :/"}], "answers": [{"tags": [], "owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "is_accepted": true, "score": 1, "last_activity_date": 1534951485, "creation_date": 1534951485, "answer_id": 51970174, "question_id": 51966871, "link": "https://stackoverflow.com/questions/51966871/improve-ocr-result/51970174#51970174", "title": "Improve OCR result", "body": "<p>Here's a simplified snippet how you can manually change the boundRect parameters to achieve the desired ROI in openCV :</p>\n\n<pre><code>int main()\n{\n    cv::Mat image = cv::imread(\"car.jpg\",0);\n\n    cv::Rect boundRect{ 200,164,140,25 };\n    cv::Mat cropped_image = image(boundRect);\n\n    cv::namedWindow(\"Image\");\n    cv::imshow(\"Image\", image);\n\n    cv::namedWindow(\"Original cropped Image\");\n    cv::imshow(\"Original cropped Image\", cropped_image);\n\n    cv::Rect new_boundRect = boundRect;\n    new_boundRect.x += 10;\n    new_boundRect.y += 2;\n    new_boundRect.width -= 10;\n    new_boundRect.height -= 10;\n\n    cv::Mat new_cropped_image = image(new_boundRect);\n    cv::namedWindow(\"New cropped Image\");\n    cv::imshow(\"New cropped Image\", new_cropped_image);\n\n    cv::waitKey();\n    return 0;\n}\n</code></pre>\n\n<p>Picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UjOSL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UjOSL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 129, "user_id": 10134831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a1b167b9f36ea7d8d631541ae6410e?s=128&d=identicon&r=PG&f=1", "display_name": "begginer", "link": "https://stackoverflow.com/users/10134831/begginer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 51970174, "answer_count": 1, "score": 0, "last_activity_date": 1534951485, "creation_date": 1534940756, "last_edit_date": 1534941769, "question_id": 51966871, "link": "https://stackoverflow.com/questions/51966871/improve-ocr-result", "title": "Improve OCR result", "body": "<p>I am working on project which base on detecton of license plates from video.</p>\n\n<p>This is how it looks like:\n<a href=\"https://i.stack.imgur.com/2grWg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2grWg.png\" alt=\"enter image description here\"></a></p>\n\n<p>My problem starts when I want to use OCR on the car plate. I was testing it on some pictures and it works really nice. Here is some example:\n<a href=\"https://i.stack.imgur.com/91EZv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/91EZv.png\" alt=\"enter image description here\"></a> </p>\n\n<p>But when I put my detected plate the result is very bad:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EQLGs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EQLGs.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I want to ask you if you have some advise for me how improve OCR results? </p>\n\n<p>Here is how I get binary image:</p>\n\n<pre><code>cv::Mat equalized;\n    cv::equalizeHist(gray, equalized);\n    cv::imshow(\"Hist. Eq.\", equalized);\n\n    /* Bilateral filter helps to improve the segmentation process */\n\n    cv::Mat blur;\n    cv::bilateralFilter(equalized, blur, 9, 75, 75);\n    cv::imshow(\"Filter\", blur);\n\n\n    /* Threshold to binarize the image */\n\n    cv::Mat thres;\n    cv::adaptiveThreshold(blur, thres, 255, cv::ADAPTIVE_THRESH_GAUSSIAN_C, cv::THRESH_BINARY, 15, 2); //15, 2\n    cv::imshow(\"Threshold\", thres);\n</code></pre>\n\n<p>Maybe some more filters? If it will be helpful I can put more code. </p>\n\n<p>My first idea was getting a little bit bigger rect with my plate. </p>\n\n<p>Here is how I get vector with my rects:</p>\n\n<pre><code>std::vector&lt; std::vector&lt; cv::Point&gt; &gt; LP_contours;\n    cv::findContours(img_threshold, LP_contours, 0, 1);\n    std::vector&lt;std::vector&lt;cv::Point&gt; &gt; contours_poly(LP_contours.size());\n    for (int ii = 0; ii &lt; LP_contours.size(); ii++)\n        if (LP_contours[ii].size() &gt; 100 &amp;&amp; contourArea(LP_contours[ii]) &gt; 3000 &amp;&amp; contourArea(LP_contours[ii]) &lt; 10000) \n        {\n            cv::approxPolyDP(cv::Mat(LP_contours[ii]), contours_poly[ii], 3, true);\n            cv::Rect appRect(boundingRect(cv::Mat(contours_poly[ii])));\n\n            if (appRect.width &gt; appRect.height &amp;&amp; appRect.width&gt;160 &amp;&amp; appRect.width &lt; 190 &amp;&amp; appRect.height&gt;40 &amp;&amp; appRect.height &lt; 60)\n                boundRect.push_back(appRect);\n        }\n</code></pre>\n\n<p>I want change size of appRect by simple code:</p>\n\n<pre><code>appRect.height += 10;\nappRect.width += 10;\n</code></pre>\n\n<p>But it doesn't work. I am new in openCV and I have problem with this kind of staff. Have you some advise how to get bigger rect?</p>\n\n<p>Thank you for all your time and help.</p>\n"}, {"tags": ["c++", "winapi", "localization", "mfc", "popup"], "comments": [{"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 2, "creation_date": 1534940338, "post_id": 51966587, "comment_id": 90883337, "body": "What about looking for popup menu by its first child MENUITEM ID?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1534943719, "post_id": 51966587, "comment_id": 90885571, "body": "Do you have a &quot;strings&quot; section in your resource DLL?  If so, you could make the comparison be against a translated string (either by making the caller responsible for loading the right string, or by changing the API to pass in a string ID, and then loading the string in the function.)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1534944509, "post_id": 51966587, "comment_id": 90886152, "body": "@MartinBonner this would work, but it&#39;s brittle, because if you change the name of the menu and you forget to change the corresponding string, your break the app. I think Alex F&#39;s idea is better."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 7014286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb7b5ef4819e2e0b9b69d046b9cf87c?s=128&d=identicon&r=PG&f=1", "display_name": "rSir", "link": "https://stackoverflow.com/users/7014286/rsir"}, "is_accepted": false, "score": 0, "last_activity_date": 1535531055, "creation_date": 1535531055, "answer_id": 52072808, "question_id": 51966587, "link": "https://stackoverflow.com/questions/51966587/get-id-for-popup-resource-menu-item-in-c-mfc-vs2015/52072808#52072808", "title": "Get id for popup resource menu item in c++ mfc vs2015", "body": "<p>Just want to give an update and that I was able to solve my problem with with Alex F's idea. Thanks Alex! However I would like to add that I do not really find the solution that satisfying but I guess that is a problem with mfc.</p>\n"}], "owner": {"reputation": 73, "user_id": 7014286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb7b5ef4819e2e0b9b69d046b9cf87c?s=128&d=identicon&r=PG&f=1", "display_name": "rSir", "link": "https://stackoverflow.com/users/7014286/rsir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 705, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1535531055, "creation_date": 1534939864, "last_edit_date": 1534940406, "question_id": 51966587, "link": "https://stackoverflow.com/questions/51966587/get-id-for-popup-resource-menu-item-in-c-mfc-vs2015", "title": "Get id for popup resource menu item in c++ mfc vs2015", "body": "<p>I am in the process of localizing a mfc application. My approach has been to create an resource only dll which contains a translated copy of the gui. My problem is that there are places in the source code were popup resources are found by their string name. Since I've translated those strings into another language these functions do no longer work. My intended solution to this was to find these elements by ID instead, however when I tried this I found out that they do not appear to have a unique ID. </p>\n\n<p>See below for snippet of the .rc file I am working with and note that the popup resource &amp; Action do not have an id:</p>\n\n<pre><code>IDR_MAINFRAME MENU\nBEGIN\n    POPUP \"&amp;Action\"\n    BEGIN\n        MENUITEM \"&amp;Tracking Start\\tF2\",         ID_TRACKING_START\n        MENUITEM \"Record...\\tCtrl+R\",           ID_RECORDING_STREAMTOFILE\n        MENUITEM \"Mouse Control Start\\tF9\",     ID_ACTION_MOUSECONTROL\n        MENUITEM \"Reflex Reduction\\tF12\",       ID_REFLEXREDUCTION_TOGGLE\n        POPUP \"Text &amp;Log\"\n        BEGIN\n            MENUITEM \"Select Log&amp;file...\",          ID_LOGGING_FILE\n            MENUITEM \"Start &amp;Logging\\tF6\",          ID_LOGGING_LOG\n        END\n        MENUITEM SEPARATOR\n        MENUITEM \"E&amp;xit\\tAlt+F4\",               ID_APP_EXIT\n    END\nEND\n</code></pre>\n\n<p>And a snippet below for the code which finds the UI element by string name</p>\n\n<pre><code>int CMainFrame::FindMenuItem(CMenu* Menu, LPCTSTR MenuString)\n{\n  ASSERT(Menu);\n  ASSERT(::IsMenu(Menu-&gt;GetSafeHmenu()));\n\n  int count = Menu-&gt;GetMenuItemCount();\n  for (int i = 0; i &lt; count; i++)\n  {\n    CString str;\n    if (Menu-&gt;GetMenuString(i, str, MF_BYPOSITION) &amp;&amp; (strcmp(str, \nMenuString) == 0))\n   {\n     return i;\n   }\n }\nreturn -1;\n}\n</code></pre>\n\n<p>After some googling I've found something called MENUEX <a href=\"https://docs.microsoft.com/en-us/windows/desktop/menurc/menuex-resource\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/menurc/menuex-resource</a> were it seems that you can add ID to popup resource elements. Again however when I tried to change the .rc file to use MENUEX instead of MENU my vs2015 compiler did not approve at all and now I am kind of stuck.</p>\n\n<p>Thanks in advance for anyone who has any idea on how to solve my problem!</p>\n"}, {"tags": ["c++", "qt", "drag-and-drop"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 1, "creation_date": 1534941550, "post_id": 51966584, "comment_id": 90884116, "body": "What have you tried so far?  The <a href=\"http://doc.qt.io/qt-5/dnd.html\" rel=\"nofollow noreferrer\"><code>Qt</code> documentation</a> has numerous drag-and-drop examples."}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1534945386, "post_id": 51966584, "comment_id": 90886766, "body": "I will try everything like mousePressEvent(QMouseEvent *event), mousePressEvent(QMouseEvent *event), mouseMoveEvent(QMouseEvent *event), dropEvent(QDropEvent *event). But, Its not working for me"}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1535001669, "post_id": 51966584, "comment_id": 90907217, "body": "first, I will enable(acceptDrop()) method for all the 4 viewports. Then I will apply all the method related to drag and drop event."}, {"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 0, "creation_date": 1535005218, "post_id": 51966584, "comment_id": 90908497, "body": "Suggest put the description <i>I will enable(acceptDrop()) method for all the 4 viewports...</i> into your question with code instead comment."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1535024981, "post_id": 51966584, "comment_id": 90919541, "body": "@AmarKumar, from your code I see that you reimplement the MainWindow&#39;s Drag/Drop events. Shouldn&#39;t you reimplement the QOpenGlWidget&#39;s Drag/Drop events instead? Let me prepare an example for you to show you what I mean."}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1535026140, "post_id": 51966584, "comment_id": 90920278, "body": "ok, thanks. i will try this one"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1535031893, "post_id": 51985817, "comment_id": 90924055, "body": "we need to create separate .cpp file for Drag/Drop Or we can take this inside the mainwindow.cpp file."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1535033802, "post_id": 51985817, "comment_id": 90925354, "body": "@AmarKumar, yes, you need to subclass <i>QOpenGLWidget</i> and then handle the events there. Please see the additional example I&#39;ve just posted."}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1535360341, "post_id": 51985817, "comment_id": 91021578, "body": "When I try to create a new file. I am getting error( QVTKOpenGlWidget have some other used)"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1535361931, "post_id": 51985817, "comment_id": 91022541, "body": "@AmarKumar, what do you mean by <i>when I try to create a new file</i>? Your question does not mention the creation of files. If this worked for you, but you have another problem, please accept the answer (and consider upvoting it if you like it) and ask another question about the next problem you have."}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1536057094, "post_id": 51985817, "comment_id": 91277854, "body": "I will go through the github link and try to execute the all model in Qt. But i am facing the problem in loading the image inside the list. Name show but image not uploaded . so, i am not able to check drag and drop are working or not. Please check it once."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1536065221, "post_id": 51985817, "comment_id": 91283043, "body": "@AmarKumar 1. Follow the link; 2. Click <i>Clone or download</i>; 3. Extract to a folder of choice; 4. Navigate to <i>src</i> and double click <i>DragDrop.pro</i>. 5. In QtCreator go to <i>Projects</i> and click <i>Configure project</i>. 6. Build and run the project."}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1536139297, "post_id": 51985817, "comment_id": 91313041, "body": "image are selected only corner of the QVTKOpenGlWidget . But i want to display image in center"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1536140847, "post_id": 51985817, "comment_id": 91314041, "body": "@AmarKumar, change the coordinates <code>(0, 0)</code> in <code>painter.drawPixmap(0, 0, m_pixmap);</code> to whatever position you want to show the image in."}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1536241424, "post_id": 51985817, "comment_id": 91360029, "body": "when i change coordinate (0,0) to (100,100). in the full viewer image will be show but in the minimze view it will not show. Just check it once again"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1536241560, "post_id": 51985817, "comment_id": 91360106, "body": "@AmarKumar, aparently you have to take the window size into account."}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1538721766, "post_id": 51985817, "comment_id": 92249616, "body": "Hello sir I will ask another question related to what u said to me. Please see once"}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1543228292, "post_id": 51985817, "comment_id": 93828206, "body": "hello sir @scopchanov i have some problem with this code."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1543353229, "post_id": 51985817, "comment_id": 93886327, "body": "@AmarKumar, how can I help you?"}, {"owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "edited": false, "score": 0, "creation_date": 1544425396, "post_id": 51985817, "comment_id": 94256537, "body": "thank you for your help @scopchanov.. now i am able to drag and drop thumbnails image inside the view port"}], "tags": [], "owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "is_accepted": true, "score": 1, "last_activity_date": 1537924740, "last_edit_date": 1592644375, "creation_date": 1535027319, "answer_id": 51985817, "question_id": 51966584, "link": "https://stackoverflow.com/questions/51966584/qt-drag-and-drop-image-from-thumbnail-to-gridlayout-qvtkopenglwidget/51985817#51985817", "title": "QT drag and drop image from thumbnail to gridlayout (QVTKOpenGLWidget)?", "body": "<h1>Cause</h1>\n<p>You are reimplementing the drag/drop event handlers of <em>mainwindow</em>. However the four OpenGL widgets are on top of the main window, hence no drag/drop events will be generated for it.</p>\n<h1>Solution</h1>\n<p>My solution would be to inherit from <em>QOpenGLWidget</em> and reimplement its event handlers:</p>\n<pre><code>#include &quot;OpenGlWidget.h&quot;\n#include &lt;QDragEnterEvent&gt;\n\nOpenGlWidget::OpenGlWidget(QWidget *parent) :\n    QOpenGLWidget(parent)\n{\n    setAcceptDrops(true);\n}\n\nvoid OpenGlWidget::dragEnterEvent(QDragEnterEvent *event)\n{\n    event-&gt;accept();\n}\n\nvoid OpenGlWidget::dropEvent(QDropEvent *event)\n{\n    // do something\n}\n</code></pre>\n<p><strong>Note:</strong> <code>setAcceptDrops(true);</code> and <code>event-&gt;accept();</code> are important in order to allow the widget to accept drop events.</p>\n<h1>Example</h1>\n<p>I have made an example for you, according to the task description you have provided. It allows icons from a <em>QListWidget</em> on the left to be dragged and dropped on one of the four OpenGL widgets arranged in a grid layout on the right. The dragged and dropped icon is then displayed in the corresponding OpenGL widget.</p>\n<p>The full code is available on <a href=\"https://github.com/scopchanov/SO-DragDrop\" rel=\"nofollow noreferrer\">GitHub</a>.</p>\n"}], "owner": {"reputation": 45, "user_id": 10159792, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RKYI3O0MS7g/AAAAAAAAAAI/AAAAAAAAABI/wifeP_ZJ7oI/photo.jpg?sz=128", "display_name": "Amar Kumar", "link": "https://stackoverflow.com/users/10159792/amar-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 51985817, "answer_count": 1, "score": -1, "last_activity_date": 1544425325, "creation_date": 1534939855, "last_edit_date": 1544425325, "question_id": 51966584, "link": "https://stackoverflow.com/questions/51966584/qt-drag-and-drop-image-from-thumbnail-to-gridlayout-qvtkopenglwidget", "title": "QT drag and drop image from thumbnail to gridlayout (QVTKOpenGLWidget)?", "body": "<p>I want to do drag and drop functionality inside my project. Where I have a list widget as( Thumbnails). And, I want to drag an image from the thumbnail and drop the image inside the grid layout as (QVTKOpenGlWidget). I have used this one code. But unfortunately i am not able to drag and drop.</p>\n\n<p>code:</p>\n\n<pre><code>void mainwindow::dragEnterEvent(QDragEnterEvent *e)\n{\n    if (e-&gt;mimeData()-&gt;hasFormat(\"application/x-dnditemdata\")) {\n        if (e-&gt;source() == this) {\n            e-&gt;setDropAction(Qt::MoveAction);\n            e-&gt;accept();\n        }\n        else {\n            e-&gt;acceptProposedAction();\n        }\n    }\n    else {\n        e-&gt;ignore();\n    }\n}\n\nvoid mainwindow::dragMoveEvent(QDragMoveEvent *event)\n{\n    if (event-&gt;mimeData()-&gt;hasFormat(\"application/x-dnditemdata\")) {\n        if (event-&gt;source() == this) {\n            event-&gt;setDropAction(Qt::MoveAction);\n            event-&gt;accept();\n        }\n        else {\n            event-&gt;acceptProposedAction();\n        }\n    }\n    else {\n        event-&gt;ignore();\n    }\n}\n\nvoid mainwindow::dropEvent(QDropEvent *e)\n{\n\n    if (e-&gt;mimeData()-&gt;hasFormat(\"application/x-dnditemdata\")) {\n        QByteArray itemData = e-&gt;mimeData()-&gt;data(\"application/x-dnditemdata\");\n        QDataStream dataStream(&amp;itemData, QIODevice::ReadOnly);\n\n        QPalette pixmap;\n        QPoint offset;\n        dataStream &gt;&gt; pixmap &gt;&gt; offset;\n\n        this-&gt;ui-&gt;view1-&gt;setPalette(pixmap);\n        this-&gt;ui-&gt;view1-&gt;move(e-&gt;pos() - offset);\n        this-&gt;ui-&gt;view1-&gt;show();\n        this-&gt;ui-&gt;view1-&gt;setAttribute(Qt::WA_DeleteOnClose);\n        if (e-&gt;source() == this) {\n            e-&gt;setDropAction(Qt::MoveAction);\n            e-&gt;accept();\n        }\n        else {\n            e-&gt;acceptProposedAction();\n        }\n    }\n    else {\n        e-&gt;ignore();\n    }\n}\n</code></pre>\n\n<p>Any help is very useful for me.\nThank you in advance</p>\n"}, {"tags": ["c++", "arrays", "pointers", "dynamic", "memory-address"], "comments": [{"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 2, "creation_date": 1534939922, "post_id": 51966551, "comment_id": 90883044, "body": "Just a note: input is not fed into the compiler.  The compilation process happens <i>before</i> the program is ever run."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1534940020, "post_id": 51966551, "comment_id": 90883122, "body": "<a href=\"//stackoverflow.com/q/7769998\">How to return local array in C++?</a>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1534940214, "post_id": 51966551, "comment_id": 90883248, "body": "Use <code>std::array&lt;int, 10&gt;</code> or <code>std::vector&lt;int&gt;</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1534941164, "post_id": 51966551, "comment_id": 90883873, "body": "The words &quot;dynamically allocated&quot; in the description are very important. You must have either missed that detail or didn&#39;t realise their significance."}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1534940115, "post_id": 51966641, "comment_id": 90883182, "body": "The <code>[]</code> after <code>delete</code> is very important!"}], "tags": [], "owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "is_accepted": false, "score": 2, "last_activity_date": 1534940118, "last_edit_date": 1534940118, "creation_date": 1534940015, "answer_id": 51966641, "question_id": 51966551, "link": "https://stackoverflow.com/questions/51966551/displaying-values-of-an-array-using-pointers/51966641#51966641", "title": "Displaying values of an array using pointers", "body": "<p>In your function, you allocate a array of size 10 statically, hence it only exists until the function exits. After that, you get undefined behaviour since you're reading random bytes from memory that no longer belongs to you. </p>\n\n<p>What you want is to allocate the array dynamically, this can easily be done using <code>new</code></p>\n\n<pre><code>int* arr = new int[10];\n</code></pre>\n\n<p>Then you simply <code>return arr;</code></p>\n\n<p>Of course, don't forget to clear the memory once you're done using it, by calling <code>delete[]</code> (and not <code>delete</code> without the braces). </p>\n\n<p>As a side note, calling <code>return arrPtr</code> is the same as calling <code>return arr</code> which will naturally decay to a pointer. It's only wrong because that pointer ends up pointing to something that is no longer there. </p>\n"}, {"tags": [], "owner": {"reputation": 358, "user_id": 8775332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb14841797feb1c4821a5b070bcddd4?s=128&d=identicon&r=PG&f=1", "display_name": "kaspiotr", "link": "https://stackoverflow.com/users/8775332/kaspiotr"}, "is_accepted": false, "score": 1, "last_activity_date": 1576924387, "last_edit_date": 1576924387, "creation_date": 1535020780, "answer_id": 51983894, "question_id": 51966551, "link": "https://stackoverflow.com/questions/51966551/displaying-values-of-an-array-using-pointers/51983894#51983894", "title": "Displaying values of an array using pointers", "body": "<p>I've modified your code slightly so that it does what was demanded in your assignment <a href=\"https://i.stack.imgur.com/x5VQW.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/x5VQW.png</a></p>\n\n<p><strong>My code:</strong></p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nint *readNumbers() {\n   int *arr = new int[10];\n   for (int i = 0; i &lt; 10; i++) //asking for 10 values\n   {\n      cout &lt;&lt; \"Enter an element: \";\n      cin &gt;&gt; arr[i];\n   }\n   return arr;\n}\n\nvoid printNumbers(int *numbers, int length) {\n\n   for (int i = 0; i &lt; length; i++) {\n      cout &lt;&lt; i &lt;&lt; \" \" &lt;&lt; numbers[i] &lt;&lt; endl;\n   }\n   delete[]numbers;\n}\n\nint main() {\n   printNumbers(readNumbers(), 10);\n   return 0;\n}\n</code></pre>\n\n<p><strong>Answer to your first question:</strong>\nLocal arrays, such as this <code>int array[10];</code>, are allocated on the stack, and get destroyed when the function they're in ends. That is why you are reading random bytes from memory when you are trying to print out the content of your array later.</p>\n\n<p>When we write <code>int *arr = new int[10];</code> we allocate our array on a heap. The address of that array is returned and assigned to the pointer called <code>arr</code>. The pointer <code>arr</code> is allocated on the stack in turn.\nHowever, when you are allocating something (e.g. an array) on the heap using the <code>new</code> operator you should use <code>delete</code> operator when you no longer need it to deallocate your array. Otherwise, you will run out of space in your heap and your program will crash if you keep on using <code>new</code> without using <code>delete</code> later.</p>\n\n<p><strong>Answer to your second question:</strong>\nWhen you are using <code>delete</code> operator (or <code>delete[]</code> in case of arrays) you are actually deleting what <code>arr</code> pointer was pointing to on the heap. The pointer <code>arr</code> won't be deleted itself from the stack after using the <code>delete</code> operator. It becomes so-called 'dangling pointer' - a pointer that no longer points to something valid on the heap. It will be deleted from the stack when we terminate from the function (scope) it was declared in, along with the other local variables we may have. However, after you delete something that pointer was pointing to, you can assign a NULL to it (<code>arr = NULL;</code>), to indicate that it is not referencing anything anymore.</p>\n"}], "owner": {"reputation": 121, "user_id": 9732828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ba3c3d305444bb55ba37aec48e477d?s=128&d=identicon&r=PG&f=1", "display_name": "Michel", "link": "https://stackoverflow.com/users/9732828/michel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576924387, "creation_date": 1534939765, "question_id": 51966551, "link": "https://stackoverflow.com/questions/51966551/displaying-values-of-an-array-using-pointers", "title": "Displaying values of an array using pointers", "body": "<p>Image of my question: <a href=\"https://i.stack.imgur.com/x5VQW.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/x5VQW.png</a></p>\n\n<p>To summarise, in one function, readNumbers, I will make an array of size 10, and return a pointer to this array.\nI then have a second function, printNumbers, that takes the pointer from the above function (and the length of the array, 10) and prints the index and corresponding value in the array.</p>\n\n<p>My function file:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint *readNumbers() \n{\n    int arr[10];\n    for (int i=0; i&lt;10; i++) //asking for 10 values\n    {\n        cout&lt;&lt;\"Enter an element: \";\n        cin&gt;&gt;arr[i];\n    }\n\n    int *arrPtr;\n    arrPtr=&amp;arr[0];\n\n    return arrPtr;\n\n}\n\n\n\n\n void printNumbers(int *numbers,int length) \n{\n\n\n    for (int i=0; i&lt;length; i++)\n    {\n        cout&lt;&lt;i&lt;&lt;\" \"&lt;&lt;*(numbers+1)&lt;&lt;endl;\n    }\n    delete numbers;\n\n}\n</code></pre>\n\n<p>Main file:</p>\n\n<pre><code>int *readNumbers() ;\nvoid printNumbers(int *numbers,int length) ;\n\nint main (void)\n{\n\n\n\n    printNumbers(readNumbers(), 10) ;\n\n\n}\n</code></pre>\n\n<p>The code compiles, however, the elements of the array printed are not what has been fed into the compiler.</p>\n\n<p>Also, the question days to delete the array. Is this related to clearing the heap space? Is this achieved by deleting the pointer to the array, as I have done in the second function?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "visual-c++", "c++17", "abseil"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1534939728, "post_id": 51966426, "comment_id": 90882891, "body": "1) Note, correct namespace is <code>std::literals::string_view_literals</code>. 2) Related: <a href=\"https://developercommunity.visualstudio.com/content/problem/17172/c17-stdstring-view-does-not-have-the-stdliteralsst.html\" rel=\"nofollow noreferrer\">developercommunity.visualstudio.com/content/problem/17172/&hellip;</a>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1534939898, "post_id": 51966426, "comment_id": 90883025, "body": "You need to change a setting, neither godbolt nor your VS version seem to be aware yet that C++17 was approved.  Use Project &gt; Properties &gt; C/C++ &gt; Language &gt; &quot;C++ Language Standard&quot; = ISO C++17 Standard (/std:c++17)."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1534940726, "post_id": 51966426, "comment_id": 90883587, "body": "@HansPassant thanks I updated question. Still there is one more bug error left."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1534940806, "post_id": 51966426, "comment_id": 90883638, "body": "@AlgirdasPreid\u017eius Thanks. There is still one more bug left here."}], "answers": [{"comments": [{"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 0, "creation_date": 1534962552, "post_id": 51967390, "comment_id": 90896530, "body": "Thanks. Unfortunately, they just <i>intend</i> to comment out line <a href=\"https://github.com/abseil/abseil-cpp/blob/fefc83638fb69395d259ed245699310610429064/absl/base/config.h#L424\" rel=\"nofollow noreferrer\">424</a> perhaps because of MSVC incompatiblity of aliasing <code>absl::string_view</code> to <code>std::string_view</code>. You are totally right <code>absl::string_view</code> which they intend not to alias <code>string_view</code> on MSVC just work =&gt; <a href=\"https://godbolt.org/z/yHnQ7B\" rel=\"nofollow noreferrer\">godbolt</a>. However my clang-target-msvc still has issue which is the same issue if  on aliasing <code>std::string_view</code> (comment out 424 doesn&#39;t help)"}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1534942527, "creation_date": 1534942527, "answer_id": 51967390, "question_id": 51966426, "link": "https://stackoverflow.com/questions/51966426/where-does-this-abslstrcat-bug-occur-in-abseil-or-msvc/51967390#51967390", "title": "Where does this absl::StrCat bug occur, in Abseil or MSVC?", "body": "<p><code>absl::AlphaNum</code> can be created from an <code>absl::string_view</code>. But not from <code>std::string_view</code>. Your code cannot build because at the moment those are distinct <code>string_view</code> types.</p>\n\n<p>The reason is that as of writing this answer, the feature test macro <a href=\"https://github.com/abseil/abseil-cpp/blob/fefc83638fb69395d259ed245699310610429064/absl/base/config.h#L424\" rel=\"nofollow noreferrer\"><code>ABSL_HAVE_STD_STRING_VIEW</code></a> is commented out. Under that macro, <a href=\"https://github.com/abseil/abseil-cpp/blob/fefc83638fb69395d259ed245699310610429064/absl/strings/string_view.h#L33-L41\" rel=\"nofollow noreferrer\"><code>absl::string_view</code> stands for <code>std::string_view</code></a>. Under the macro, your code would build. So one can say the \"fault\" is with the Abesil team for not updating the library yet.</p>\n\n<p>Right now, the future proof solution is to use <code>absl::string_view</code>.</p>\n"}], "owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534942527, "creation_date": 1534939274, "last_edit_date": 1534940548, "question_id": 51966426, "link": "https://stackoverflow.com/questions/51966426/where-does-this-abslstrcat-bug-occur-in-abseil-or-msvc", "title": "Where does this absl::StrCat bug occur, in Abseil or MSVC?", "body": "<p>I creat string_view from char array</p>\n\n<pre><code>  // creat sv from vector;\n  std::vector&lt;char&gt; vec = { 'w', 'h', 'a', 't' };\n  char* char_ptr = vec.data();\n  size_t sz = vec.size();\n  std::string_view sview_obj = std::string_view(char_ptr, sz);\n</code></pre>\n\n<p>If you write:</p>\n\n<pre><code>  using namespace std::string_view_literals;\n\n  std::cout &lt;&lt; absl::StrCat(sview_obj, \"ever\")    // Error\n            &lt;&lt; absl::StrCat(sview_obj, sview_obj) // Error\n            &lt;&lt; absl::StrCat(\"what\", \"ever\"sv)     // Error\n            &lt;&lt; absl::StrCat(\"what\"sv, \"ever\"sv)   // Error\n            &lt;&lt; absl::StrCat(\"what\", \"ever\");      // Okey\n</code></pre>\n\n<p>MSVC error:</p>\n\n<pre><code>&lt;source&gt;(16): error C2039: 'string_view_literals': is not a member of 'std'\n/opt/compiler-explorer/libs/abseil\\absl/numeric/int128.h(231): note: see declaration of 'std'\n&lt;source&gt;(16): error C2871: 'string_view_literals': a namespace with this name does not exist\n&lt;source&gt;(18): error C2665: 'absl::StrCat': none of the 5 overloads could convert all the argument types\n/opt/compiler-explorer/libs/abseil\\absl/strings/str_cat.h(310): note: could be 'std::string absl::StrCat(const absl::AlphaNum &amp;,const absl::AlphaNum &amp;)'\n&lt;source&gt;(18): note: while trying to match the argument list '(std::string_view, const char [5])'\n&lt;source&gt;(19): error C2665: 'absl::StrCat': none of the 5 overloads could convert all the argument types\n/opt/compiler-explorer/libs/abseil\\absl/strings/str_cat.h(310): note: could be 'std::string absl::StrCat(const absl::AlphaNum &amp;,const absl::AlphaNum &amp;)'\n&lt;source&gt;(19): note: while trying to match the argument list '(std::string_view, std::string_view)'\n&lt;source&gt;(20): error C3688: invalid literal suffix 'sv'; literal operator or literal operator template 'operator \"\"sv' not found\n&lt;source&gt;(21): error C3688: invalid literal suffix 'sv'; literal operator or literal operator template 'operator \"\"sv' not found\n</code></pre>\n\n<p>Other than <code>operator\"\"sv</code> seems missing in MSVC,\n<a href=\"https://godbolt.org/z/UR04EI\" rel=\"nofollow noreferrer\">line 18 and 19</a> have a thing in common:</p>\n\n<pre><code>  std::cout &lt;&lt; absl::StrCat(sview_obj, \"ever\")    // Error\n            &lt;&lt; absl::StrCat(sview_obj, sview_obj) // Error\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>&lt;source&gt;(18): error C2665: 'absl::StrCat': none of the 5 overloads could convert all the argument types\n/opt/compiler-explorer/libs/abseil\\absl/strings/str_cat.h(310): note: could be 'std::string absl::StrCat(const absl::AlphaNum &amp;,const absl::AlphaNum &amp;)'\n&lt;source&gt;(18): note: while trying to match the argument list '(std::string_view, const char [5])'\n</code></pre>\n\n<hr>\n\n<p>When I compile on my VC BuildTool (with clang 8 target msvc), it gives additional clues here.</p>\n\n<pre><code>In file included from C:/Program Files/C++ Source/abseil-cpp/absl/strings/ascii.cc:15:\nC:\\Program Files\\C++ Source\\abseil-cpp\\absl/strings/ascii.h(198,10):  error: no matching constructor for initialization of 'absl::string_view' (aka 'basic_string_view&lt;char&gt;')\n  return absl::string_view(it, str.end() - it);\n         ^                 ~~~~~~~~~~~~~~~~~~\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\BuildTools\\VC\\Tools\\MSVC\\14.13.26128\\include\\xstring(809,12):  note: candidate constructor not viable: no known conversion from 'std::_String_view_iterator&lt;std::char_traits&lt;char&gt; &gt;' to 'const std::basic_string_view&lt;char, std::char_traits&lt;char&gt; &gt;::const_pointer' (aka 'const char *const') for 1st argument\n        constexpr basic_string_view(_In_reads_(_Count) const const_pointer _Cts, const size_type _Count)\n                  ^\n</code></pre>\n\n<p>It seems conversion from <code>std::_String_view_iterator&lt;std::char_traits&lt;char&gt; &gt;</code> to <code>const std::basic_string_view&lt;char, std::char_traits&lt;char&gt; &gt;::const_pointer</code> (aka <code>const char *const</code>) is impossible in current MSVC <code>include\\xstring</code></p>\n\n<p>Clang and gcc are okey with this.</p>\n\n<p><a href=\"https://godbolt.org/z/UR04EI\" rel=\"nofollow noreferrer\">godbolt</a></p>\n\n<hr>\n\n<h2>Update</h2>\n\n<p>According to <em>Algirdas Preid\u017eius</em> and <em>Hans Passant</em>'s comment below, after change godbolt compiler from MSVC 2017 RTM into MSVC Pre 2018, <code>sv</code> literals are now all okey.</p>\n\n<p>Still there is one more bug mentioned above.</p>\n\n<pre><code>std::cout &lt;&lt; absl::StrCat(sview_obj, \"ever\")    // Error\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>&lt;source&gt;(18): error C2665: 'absl::StrCat': none of the 5 overloads could convert all the argument types\n/opt/compiler-explorer/libs/abseil\\absl/strings/str_cat.h(310): note: could be 'std::string absl::StrCat(const absl::AlphaNum &amp;,const absl::AlphaNum &amp;)'\n&lt;source&gt;(18): note: while trying to match the argument list '(std::string_view, const char [5])'\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/TwFTBB\" rel=\"nofollow noreferrer\">goldbolt 2</a></p>\n"}, {"tags": ["c++", "unit-testing", "refactoring"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1534938615, "post_id": 51966187, "comment_id": 90882129, "body": "Singletons have always been a pain when it comes to tests. The subject is (too?) broad, and well treated on the web... <a href=\"https://stackoverflow.com/a/2085988/5470596\">and on SO</a>."}, {"owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1534940046, "post_id": 51966187, "comment_id": 90883137, "body": "@YSC I saw those answers before I asked my question, and I don&#39;t think the question on <b>WHAT</b> to cover before refactoring has been answered in the duplicate - but since you and Martin Bonner already closed the question I won&#39;t bother SO with that anymore."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1534942660, "post_id": 51966187, "comment_id": 90884845, "body": "@CharonX Feel free to edit your question and explain why it isn&#39;t a duplicate.  If you ping me, I can reopen it.  (Note that YSC actually voted to close as &quot;too broad&quot; - so please try to narrow the question down too.)"}, {"owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1534945471, "post_id": 51966187, "comment_id": 90886818, "body": "@MartinBonner I&#39;ve gutted the question and edited into something that still asks what I want to know (but asks in a different way)"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1534945758, "post_id": 51966187, "comment_id": 90887040, "body": "@CharonX - That&#39;s <i>much</i> better.  The simplification is worthwhile, and not referring to singletons helps.  I still wonder if it is going to get closed as &quot;too broad&quot; or &quot;primarily opinion based&quot; (and you might want to ask on the QA site too)."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534945887, "post_id": 51966187, "comment_id": 90887118, "body": "The corner cases are the <i>most</i> important to test since those are the easiest to get wrong when initially implementing the class and also the easiest to break when refactoring."}, {"owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534946802, "post_id": 51966187, "comment_id": 90887724, "body": "@JesperJuhl I feel that too, but in this specific case the corner case is further down the line - i.e. <code>OffsetProvider</code> <b>must</b> verify that the results of <code>applyOffset()</code> and <code>getOffset()</code> are correct in all cases (leap year or not, Monday 13th or not). The thing I am struggling with is if/when to rely in the result of a called function (if it does not create a new execution path)."}, {"owner": {"reputation": 2032, "user_id": 218441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BKhf0.jpg?s=128&g=1", "display_name": "Jocke", "link": "https://stackoverflow.com/users/218441/jocke"}, "edited": false, "score": 0, "creation_date": 1534958499, "post_id": 51966187, "comment_id": 90894705, "body": "How much should you cover, you ask? as much as possible. And if that is easily done it is a no-brainer. Just do it. Write all test you can and then make the refactoring. I can recommend the book &quot;working with legacy code&quot;. If your question is more philosophical then the answer all boils down to opinions..."}], "answers": [{"tags": [], "owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "is_accepted": true, "score": 0, "last_activity_date": 1535012675, "creation_date": 1535012675, "answer_id": 51981316, "question_id": 51966187, "link": "https://stackoverflow.com/questions/51966187/unit-testing-how-much-should-you-cover-when-whitebox-testing/51981316#51981316", "title": "Unit testing: How much should you cover (when whitebox testing)?", "body": "<p>Looking through the comments and sleeping over the issue I came to the following conclusion (at least for me):</p>\n\n<p>If a function call has direct impact on your function under test (e.g. provides a return value), then you need to cover it. For example:</p>\n\n<pre><code>int indirectIsOdd(int a)\n{\n    //Please ignore the fact that I could just write \"return Calculator::isOdd(a)\" here\n    if (Calculator::isOdd(a))\n        return true;\n    else\n        return false;\n}\n</code></pre>\n\n<p>It is obvious that you need to cover both possible results of <code>Calculator::isOdd()</code> - otherwise you don't cover your entire code.</p>\n\n<pre><code>int indirectAdd(int a, int b)\n{\n    int result = Calculator::add(a, b);\n    return result;\n}\n</code></pre>\n\n<p>You may want to plug in a few example values for <code>a</code> and <code>b</code> here, but - to be honest - what you REALLY want to do is <em>mock</em> Calculator::add() so you can verify that <code>indirectAdd()</code> both calls <code>Calculator::add()</code> and uses the value <code>Calculator::add()</code> returns.</p>\n"}], "owner": {"reputation": 1705, "user_id": 9103250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c613d7186c7314ee818673ea4c79fd?s=128&d=identicon&r=PG&f=1", "display_name": "CharonX", "link": "https://stackoverflow.com/users/9103250/charonx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 51981316, "answer_count": 1, "score": 0, "last_activity_date": 1535012675, "creation_date": 1534938436, "last_edit_date": 1534945383, "question_id": 51966187, "link": "https://stackoverflow.com/questions/51966187/unit-testing-how-much-should-you-cover-when-whitebox-testing", "title": "Unit testing: How much should you cover (when whitebox testing)?", "body": "<p>Assume I have the following class:</p>\n\n<pre><code>class WeirdCalculator\n{\n  public:\n    WeirdCalculator() { };\n\n    int addWithOffset(int a, int b)\n    {\n        OffsetProvider provider;\n        if (provider.applyOffset())\n            return a + b + provider.getOffset();\n        else\n            return a + b;\n    };\n}\n</code></pre>\n\n<p>Further assume that <code>OffsetProvider::applyOffset()</code> and <code>OffsetProvider::getOffset()</code> not necessary <strong>always</strong> return the same values (<code>applyOffset()</code> is <code>false</code> on leap-years, and <code>getOffset()</code> normally returns <code>42</code> but yields a different value on Monday 13th).</p>\n\n<p>Putting this class under unit-test (so you can refactor it), you will quickly notice that it is hard to cover the <code>else</code> path (but you can do it with some trickery). Looking closer you also notice that the result of <code>addWithOffset()</code> is dependent on the result of <code>getOffset()</code>.</p>\n\n<p>Should your test coverage include those possible divergence points (i.e. also simulate a test in leap years and on Monday 13th)? The impending refactorings might render those tests soon obsolete, but if you do not cover them you might not spot that you accidently hardcoded that <code>42</code> instead of using the value from <code>getOffset()</code>.</p>\n"}, {"tags": ["c++", "qt", "optional-parameters"], "answers": [{"comments": [{"owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "reply_to_user": {"reputation": 1805, "user_id": 5413817, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YJ0qD.png?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/5413817/marcus"}, "edited": false, "score": 0, "creation_date": 1534938935, "post_id": 51966215, "comment_id": 90882355, "body": "@Marcus: What is your Qt version? And, which C++ standard are you using?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1534938995, "post_id": 51966215, "comment_id": 90882401, "body": "Can&#39;t you use a <code>std::set</code> instead? That one <i>does</i> have an <a href=\"https://en.cppreference.com/w/cpp/container/set/set\" rel=\"nofollow noreferrer\">initializer list constructor</a>."}, {"owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1534939076, "post_id": 51966215, "comment_id": 90882461, "body": "@JesperJuhl: QSet also has a the ctor with initializer-list (<a href=\"http://doc.qt.io/qt-5/qset.html#QSet-1\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qset.html#QSet-1</a>)."}, {"owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "reply_to_user": {"reputation": 1805, "user_id": 5413817, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YJ0qD.png?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/5413817/marcus"}, "edited": false, "score": 1, "creation_date": 1534939263, "post_id": 51966215, "comment_id": 90882577, "body": "@Marcus: With Qt 5.10.1 and C++11 works just fine. Can you post that part along with the compiler message in your question? That would be helpful."}, {"owner": {"reputation": 1805, "user_id": 5413817, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YJ0qD.png?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/5413817/marcus"}, "edited": false, "score": 0, "creation_date": 1534939303, "post_id": 51966215, "comment_id": 90882605, "body": "I don&#39;t think it is important but i don&#39;t use <b>int</b> as datatype but a <b>Enum</b> , sorry"}, {"owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "reply_to_user": {"reputation": 1805, "user_id": 5413817, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YJ0qD.png?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/5413817/marcus"}, "edited": false, "score": 0, "creation_date": 1534939415, "post_id": 51966215, "comment_id": 90882685, "body": "@Marcus: An <code>enum</code> or <code>enum class</code>? Can you update your question with your use-case? Because with for <code>int</code> it is working just fine."}, {"owner": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "reply_to_user": {"reputation": 1805, "user_id": 5413817, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YJ0qD.png?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/5413817/marcus"}, "edited": false, "score": 1, "creation_date": 1534940431, "post_id": 51966215, "comment_id": 90883392, "body": "@Marcus, the solution worked for me pretty well (whether I am using ints or enums) on Qt 5.9.1. According to the documentation, QSet&#39;s constructor that takes a <code>std::initializer_list</code> has been there since Qt5.1. This means that it should for you (at least for the example in your question). Can you prepare an MCVE that shows the new error you are getting when you use this solution?"}, {"owner": {"reputation": 1805, "user_id": 5413817, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YJ0qD.png?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/5413817/marcus"}, "edited": false, "score": 1, "creation_date": 1534940866, "post_id": 51966215, "comment_id": 90883680, "body": "with <b>int</b> it works ... so i switch to <b>int</b> and cast it to <b>enum</b> when needed, thx"}, {"owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "reply_to_user": {"reputation": 1805, "user_id": 5413817, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YJ0qD.png?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/5413817/marcus"}, "edited": false, "score": 1, "creation_date": 1534944824, "post_id": 51966215, "comment_id": 90886401, "body": "@Marcus: I&#39;ve added an example with <code>enum class</code> also. It works fine. You won&#39;t have to do any type-casting."}], "tags": [], "owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "is_accepted": true, "score": 5, "last_activity_date": 1534944766, "last_edit_date": 1534944766, "creation_date": 1534938541, "answer_id": 51966215, "question_id": 51966067, "link": "https://stackoverflow.com/questions/51966067/already-filled-qset-as-optional-parameter/51966215#51966215", "title": "Already filled QSet as optional parameter", "body": "<p>You can use initializer-list for default parameter like this:</p>\n\n<pre><code>void function(int i, QSet&lt;int&gt; MySet = { 1, 2, 3 });\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE</strong>:</p>\n\n<p>With <code>enum class</code>, it also works fine.</p>\n\n<p>Here's the example:</p>\n\n<pre><code>enum class MyEnum : unsigned int\n{\n    ONE = 1,\n    TWO,\n    THREE,\n    FOUR\n};\n\nvoid function(int i, QSet&lt;MyEnum&gt; MySet = { MyEnum::ONE, MyEnum::TWO });\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1534940524, "post_id": 51966699, "comment_id": 90883453, "body": "Python-style mutable default arguments :)"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 2, "last_activity_date": 1534942512, "last_edit_date": 1534942512, "creation_date": 1534940161, "answer_id": 51966699, "question_id": 51966067, "link": "https://stackoverflow.com/questions/51966067/already-filled-qset-as-optional-parameter/51966699#51966699", "title": "Already filled QSet as optional parameter", "body": "<p>Imho it is not nice to have the initialization in the function signature (especially if you put the declaration in a header and the implementation in a source file it can be annoying). You can use <code>std::optional</code>. Simpler example (as I dont have Qt available atm): </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;optional&gt;\n\nvoid foo(std::optional&lt;int&gt; x = {}) {\n    if (!x) { x = 3; } // or get the default value from somewhere\n    std::cout &lt;&lt; x.value();\n}\n\nint main()\n{\n    foo(23);\n    foo();\n}\n</code></pre>\n"}], "owner": {"reputation": 1805, "user_id": 5413817, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YJ0qD.png?s=128&g=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/5413817/marcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 51966215, "answer_count": 2, "score": 1, "last_activity_date": 1534944934, "creation_date": 1534938053, "last_edit_date": 1534944934, "question_id": 51966067, "link": "https://stackoverflow.com/questions/51966067/already-filled-qset-as-optional-parameter", "title": "Already filled QSet as optional parameter", "body": "<p>How to write a function signature to use a optional <code>QSet</code> parameter with a already filled <code>QSet</code> as default value.</p>\n\n<p>I've tried this but it won't work! :(</p>\n\n<pre><code>enum MyEnum {\n    One,\n    Two,\n    Three,\n    Four\n};\n\nvoid function(int i, QSet&lt;MyEnum&gt; MySet = QSet&lt;MyEnum&gt;() &lt;&lt; One &lt;&lt; Two &lt;&lt; Four);\n</code></pre>\n\n<p>I also found this approach:</p>\n\n<pre><code>QSet&lt;MyEnum&gt; const&amp; foo();\nvoid function(int i, QSet&lt;MyEnum&gt; MySet = foo());\n</code></pre>\n\n<p>But, I'm not happy this this.</p>\n\n<hr>\n\n<p><strong>Environment:</strong></p>\n\n<blockquote>\n  <p>Qt: 5.9.6<br>\n  C++: 11</p>\n</blockquote>\n"}, {"tags": ["c++", "operator-overloading", "stdmap", "user-defined-types"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 5, "creation_date": 1534937997, "post_id": 51965992, "comment_id": 90881794, "body": "you cant modify keys. the value_type of a map is <code>std::pair&lt;const KEY,VALUE&gt;</code>. you can erase the element and insert it with the updated key"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1534938443, "post_id": 51965992, "comment_id": 90882045, "body": "Hi jwide87, if you wanted to increase your chances to have a useful and complete answer, you should definitely provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1534939018, "post_id": 51965992, "comment_id": 90882424, "body": "if you only want to modify the <code>addr</code> and not the <code>priority</code> and you only use <code>priority</code> for sorting, then you might want to consider to put the <code>addr</code> in the value instead of the key"}, {"owner": {"reputation": 33, "user_id": 10258777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760e64104de4b3276bcb8ede1c398b0f?s=128&d=identicon&r=PG&f=1", "display_name": "jwilde87", "link": "https://stackoverflow.com/users/10258777/jwilde87"}, "edited": false, "score": 0, "creation_date": 1534942037, "post_id": 51965992, "comment_id": 90884416, "body": "Thanks for the suggestions. I can sort of see why <code>[]</code> is not going to work now, but still unclear on why <code>find()</code> would not work in my case. From the literature std::map::find &quot;Two keys are considered equivalent if the container&#39;s comparison object returns false reflexively (i.e., no matter the order in which the elements are passed as arguments).&quot; Which I think my overloaded operator handles?"}, {"owner": {"reputation": 406, "user_id": 2102925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/582cb201d06c59f1521cbe4e2a5667c3?s=128&d=identicon&r=PG", "display_name": "AdityaG", "link": "https://stackoverflow.com/users/2102925/adityag"}, "edited": false, "score": 0, "creation_date": 1534942318, "post_id": 51965992, "comment_id": 90884598, "body": "add a overload for == operator also .. then you will see the find returning what you want .. !"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534942849, "post_id": 51966755, "comment_id": 90884979, "body": "<code>std::tuple</code> would not work here as intended as OP has special comparison operator, which is different that one provided by tuple. Also this answer does not really address issue asked."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534945045, "post_id": 51966755, "comment_id": 90886539, "body": "@Slava I assumed that the original comparison was not implemented correctly."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1534945162, "post_id": 51966755, "comment_id": 90886615, "body": "Then sorting would not work they way OP wants and that is the whole point of the question. OP wants to have only one key with the same address in the map. You did not really look into question and also downvoted my answer just for revenge, nice."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1534944945, "last_edit_date": 1534944945, "creation_date": 1534940349, "answer_id": 51966755, "question_id": 51965992, "link": "https://stackoverflow.com/questions/51965992/how-to-control-and-modify-the-stdmap-ordering-using-a-user-defined-key/51966755#51966755", "title": "How to control and modify the std::map ordering using a user-defined key", "body": "<p>Instead of <code>MyKey</code> you can use <code>std::tuple&lt;int, std::string&gt;</code>, it defines the relational operators for you:</p>\n\n<pre><code>using MyKey = std::tuple&lt;int, std::string&gt;;\n</code></pre>\n\n<p>Saves you a dozen of lines.</p>\n\n<hr>\n\n<p>You cannot modify keys of elements in any associative containers. Instead, you need to remove the element using the old key and re-insert it with a new key.</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": 0, "last_activity_date": 1534946151, "last_edit_date": 1534946151, "creation_date": 1534944184, "answer_id": 51967915, "question_id": 51965992, "link": "https://stackoverflow.com/questions/51965992/how-to-control-and-modify-the-stdmap-ordering-using-a-user-defined-key/51967915#51967915", "title": "How to control and modify the std::map ordering using a user-defined key", "body": "<p>The problem is that your comparison operator implemented incorrectly, it does not provide <a href=\"https://en.wikipedia.org/wiki/Weak_ordering\" rel=\"nofollow noreferrer\">strict weak</a> ordering hence undefined behavior of the <code>std::map</code>, lets say you have 3 objects of <code>MyKey</code>:</p>\n\n<pre><code>MyKey mk1{ \"a\",3 }, mk2{ \"b\", 2 }, mk3 { \"a\", 1 };\nmk1 &lt; mk2 -&gt; true as 3 &gt; 2\nmk2 &lt; mk3 -&gt; true as 2 &gt; 1\nmk1 &lt; mk3 -&gt; false as addr is the same, but must be true\n</code></pre>\n\n<p><a href=\"https://ideone.com/21ZjJK\" rel=\"nofollow noreferrer\">live example</a></p>\n\n<p>I do not think your problem is easily solvable with <code>std::map</code>. Possible solution is to use <a href=\"https://www.boost.org/doc/libs/1_62_0/libs/multi_index/doc/index.html\" rel=\"nofollow noreferrer\"><code>boost::multi_index</code></a> with address as one index and priority as another. To change priority of existing element <code>boost::multi_index</code> provides method to replace data.</p>\n"}], "owner": {"reputation": 33, "user_id": 10258777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760e64104de4b3276bcb8ede1c398b0f?s=128&d=identicon&r=PG&f=1", "display_name": "jwilde87", "link": "https://stackoverflow.com/users/10258777/jwilde87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 51967915, "answer_count": 2, "score": 2, "last_activity_date": 1534946151, "creation_date": 1534937790, "last_edit_date": 1534939022, "question_id": 51965992, "link": "https://stackoverflow.com/questions/51965992/how-to-control-and-modify-the-stdmap-ordering-using-a-user-defined-key", "title": "How to control and modify the std::map ordering using a user-defined key", "body": "<p>I started out by using a <code>std::string</code> as my map key, as each item in my map can be uniquely identified by a string alone.</p>\n\n<p>Then I realised that it would be a lot more useful to me to have the map ordered in a certain way, based on another parameter, so I added an <code>int</code> called priority to my key to help with ordering. The idea is that I iterate over the map and process the higher priority items first. I now have the following user-defined <code>struct</code> as my map key :</p>\n\n<pre><code>struct MyKey {\n\n    // key data\n    std::string addr;\n    int priority;\n\n    // constructor\n    MyKey(const std::string &amp; s, const int p) \n        : addr(s), priority(p) {}\n\n    // overloaded operator\n    bool operator&lt;(const MyKey &amp;that) const {\n\n        // same key if addr is the same\n        if (that-&gt;addr == this.addr)\n            return false;\n\n        // not same key so look at priorities to determine order\n        if (that.priority &lt; this-&gt;priority)\n            return true;\n        if (that.priority &gt; this-&gt;priority)\n            return false;\n\n        // priorities are the same so use the string compare\n        return (that.addr &gt; this-&gt;addr);\n    }\n};\n</code></pre>\n\n<p>The map ordering appears to be working correctly, and when new items are added they are entered at the expected position automatically if you were to iterate over the map. For instance for a map of <code>std::string</code> values:</p>\n\n<pre><code>std::map&lt;myKey, std::string&gt; myMap;\n\nmyKey key1 = myKey(std::string(\"key1\"), 1);\nmyKey key2 = myKey(std::string(\"key2\"), 2);\nmyKey key3 = myKey(std::string(\"key3\"), 3);\nmyKey key4 = myKey(std::string(\"key4\"), 4);\n\nmyMap[key1] = std::string(\"value1\");\nmyMap[key2] = std::string(\"value2\");\nmyMap[key3] = std::string(\"value3\");\nmyMap[key4] = std::string(\"value4\");\n</code></pre>\n\n<p>Would result in the following map key-value pairs at respective indexes:</p>\n\n<pre><code>[0] { addr = \"key4\", priority = 4 }, { \"value4\" }\n[1] { addr = \"key3\", priority = 3 }, { \"value3\" }\n[2] { addr = \"key2\", priority = 2 }, { \"value2\" }\n[3] { addr = \"key1\", priority = 1 }, { \"value1\" }\n</code></pre>\n\n<p>However...I am having problems when it comes to modifying an existing priority of a key that is already present in the map.</p>\n\n<p>In this situation, <code>find()</code> and <code>[]</code> (with respect to <code>std::map</code>) don't work as I want them to: </p>\n\n<pre><code>myKey modified_key1 = myKey(std::string(\"key1\"), 5);\n\n// problem 1 - this does not return iterator to \"key1\", \n// but instead to end of the map\nauto &amp; foundKey = myMap.find(modified_key1);\n\n// problem 2 - this adds a brand new item to the map\nmyMap[modified_key1] = std::string(\"value1\");\n</code></pre>\n\n<p>After <code>problem 2</code> as mentioned above, I am getting a new item added to the map with the same <code>addr</code> of an existing item. The new item appears to be added in the expected position based on the new (modified) <code>priority</code>, but the existing item to be updated remains as it was. So I end up with 2 items in the map with the same <code>addr</code> in their keys:</p>\n\n<pre><code>[0] { addr = \"key1\", priority = 5 }, { \"value1\" }\n[1] { addr = \"key4\", priority = 4 }, { \"value4\" }\n[2] { addr = \"key3\", priority = 3 }, { \"value3\" }\n[3] { addr = \"key2\", priority = 2 }, { \"value2\" }\n[4] { addr = \"key1\", priority = 1 }, { \"value1\" }\n</code></pre>\n\n<p>This is a problem for me as I would like to still rely on the notion that the <code>addr</code> of the map item key is unique.</p>\n\n<p>What I want is the map to realise it already has an item with the same key (or more to the point the same key <code>addr</code>) and to re-order the item accordingly. </p>\n\n<p>I have tried experimenting with compare functors as part of the map definition, and also overloading the keys <code>==</code> operator, but the same problem persists.</p>\n\n<p>What am I missing or should I be approaching this differently?</p>\n"}, {"tags": ["c++", "tensorflow"], "comments": [{"owner": {"reputation": 2381, "user_id": 980129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wZPWQ.jpg?s=128&g=1", "display_name": "Manuel", "link": "https://stackoverflow.com/users/980129/manuel"}, "edited": false, "score": 0, "creation_date": 1534937471, "post_id": 51965775, "comment_id": 90881517, "body": "I may be even if you have installed the protobuf the system is getting it from another place. Check your <code>PATH</code> to see which protobuf it is taking."}, {"owner": {"reputation": 1, "user_id": 6024699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rjZfT.jpg?s=128&g=1", "display_name": "crushiii", "link": "https://stackoverflow.com/users/6024699/crushiii"}, "reply_to_user": {"reputation": 2381, "user_id": 980129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wZPWQ.jpg?s=128&g=1", "display_name": "Manuel", "link": "https://stackoverflow.com/users/980129/manuel"}, "edited": false, "score": 0, "creation_date": 1534938040, "post_id": 51965775, "comment_id": 90881821, "body": "Thank you for your comment. Unfortunately there is just one installation of protobuf inside this system. That is which I installed following step 5!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10340743, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EB4i57AYKqQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMIx9cdtw2rzmBCnEEiTjhQ-BhinA/mo/photo.jpg?sz=128", "display_name": "Raiden", "link": "https://stackoverflow.com/users/10340743/raiden"}, "is_accepted": false, "score": 0, "last_activity_date": 1536578873, "last_edit_date": 1536578873, "creation_date": 1536571247, "answer_id": 52254623, "question_id": 51965775, "link": "https://stackoverflow.com/questions/51965775/c-compiling-project-with-shared-object-libtensorflow-cc-so-failed/52254623#52254623", "title": "C++ compiling project with shared object (libtensorflow_cc.so) failed", "body": "<p>I meet this problem before, following is my solution:</p>\n\n<p>I  successfully built <code>tensorflow-r1.8</code> with <code>bazel</code>. And I found <code>protoc</code> in following path is 3.5.0:</p>\n\n<pre><code>/home/zsb/.cache/bazel/_bazel_zsb/1372f28eb0671f692e7ac38330377d8c/execroot/org_tensorflow/bazel-out/host/bin/external/protobuf_archive/protoc --version\n</code></pre>\n\n<p>but actually my system config is using <code>protoc</code> version <code>3.4.0</code>\nI confirmed this by type <code>\"protoc --version\"</code> directly.</p>\n\n<p>So finally I update system <code>protobuffer</code> version to <code>3.5.0</code> and this problem fixed.</p>\n"}, {"comments": [{"owner": {"reputation": 1029, "user_id": 7878485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15dabd902549f21699b86daa04ecaeed?s=128&d=identicon&r=PG&f=1", "display_name": "nitronoid", "link": "https://stackoverflow.com/users/7878485/nitronoid"}, "edited": false, "score": 0, "creation_date": 1540310243, "post_id": 52536893, "comment_id": 92814338, "body": "Thanks for this! I also needed to copy across <code>sudo cp -r tensorflow&#47;contrib&#47;makefile&#47;downloads&#47;absl &#47;usr&#47;local&#47;tensorflow&#47;include</code>"}], "tags": [], "owner": {"reputation": 31, "user_id": 10004432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcE7.jpg?s=128&g=1", "display_name": "biying wang", "link": "https://stackoverflow.com/users/10004432/biying-wang"}, "is_accepted": false, "score": 1, "last_activity_date": 1538050834, "creation_date": 1538050834, "answer_id": 52536893, "question_id": 51965775, "link": "https://stackoverflow.com/questions/51965775/c-compiling-project-with-shared-object-libtensorflow-cc-so-failed/52536893#52536893", "title": "C++ compiling project with shared object (libtensorflow_cc.so) failed", "body": "<p>First, I checked on github, tensorflow r1.9 requires protobuf >=3.6.0. With download_dependencies.sh script, you always get protobuf 3.5.0, in which lack of inlined_string_field.h and some other headers.</p>\n\n<p>Second, some errors that ask you to update protobuf version. I tried many versions of protobuf too. Only version 3.6.0 works well, rather than version 3.6.1 or older ones.</p>\n\n<p>For these errors,</p>\n\n<blockquote>\n  <p>error This file was generated by a newer version of protoc which is</p>\n  \n  <p>fatal error: google/protobuf/inlined_string_field.h: No such file or directory</p>\n</blockquote>\n\n<p>It is a mismatch version problem. My solutions is that manually download protobuf 3.6.0 from\n<a href=\"https://github.com/protocolbuffers/protobuf/releases/download/v3.6.0/protoc-3.6.0-linux-x86_64.zip\" rel=\"nofollow noreferrer\">https://github.com/protocolbuffers/protobuf/releases/download/v3.6.0/protoc-3.6.0-linux-x86_64.zip</a></p>\n\n<p>install it and <code>cp /usr/local/include/google to somewhere/tf/include</code>. It works quite well for me. I don't know if you tried version 3.6.0.</p>\n\n<blockquote>\n  <p>download_dependencies.sh script would provide a mismatch version of\n  protobuf. See the issue I posted on github\n  <a href=\"https://github.com/tensorflow/tensorflow/issues/22536\" rel=\"nofollow noreferrer\">https://github.com/tensorflow/tensorflow/issues/22536</a></p>\n</blockquote>\n\n<p>Also, I noticed your copied files are different from mine. I did in this way.</p>\n\n<pre><code>sudo mkdir /usr/local/tensorflow/include\nsudo cp -r tensorflow/contrib/makefile/downloads/eigen/Eigen /usr/local/tensorflow/include/\nsudo cp -r tensorflow/contrib/makefile/downloads/eigen/unsupported /usr/local/tensorflow/include/\nsudo cp -r tensorflow/contrib/makefile/gen/protobuf/include/google /usr/local/tensorflow/include/\nsudo cp tensorflow/contrib/makefile/downloads/nsync/public/* /usr/local/tensorflow/include/\nsudo cp -r bazel-genfiles/tensorflow /usr/local/tensorflow/include/\nsudo cp -r tensorflow/cc /usr/local/tensorflow/include/tensorflow\nsudo cp -r tensorflow/core /usr/local/tensorflow/include/tensorflow\nsudo mkdir /usr/local/tensorflow/include/third_party\nsudo cp -r third_party/eigen3 /usr/local/tensorflow/include/third_party/\nsudo mkdir /usr/local/tensorflow/lib\nsudo cp bazel-bin/tensorflow/libtensorflow_*.so /usr/local/tensorflow/lib\n</code></pre>\n\n<p>Btw, I run build_all_linux.sh instead of download_dependencies.sh.</p>\n\n<p>I hope it will be helpful for you. </p>\n"}], "owner": {"reputation": 1, "user_id": 6024699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rjZfT.jpg?s=128&g=1", "display_name": "crushiii", "link": "https://stackoverflow.com/users/6024699/crushiii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538050834, "creation_date": 1534936986, "last_edit_date": 1534965326, "question_id": 51965775, "link": "https://stackoverflow.com/questions/51965775/c-compiling-project-with-shared-object-libtensorflow-cc-so-failed", "title": "C++ compiling project with shared object (libtensorflow_cc.so) failed", "body": "<p>at the moment I'm facing some problems compiling (and running) a (huge) own project with support of Tensorflow. On my own system (Ubuntu 16.04 LTS) everything works fine. Same procedure on a cluster leads to a compile error and I'm not able to find a solution yet.</p>\n\n<h3>System information</h3>\n\n<ul>\n<li><strong>Have I written custom code</strong>: YES</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: CentOS 7.4.1708</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source (using the git repo)</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.9</li>\n<li><strong>Python version</strong>: 2.7.15</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.16</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 7.30</li>\n<li><strong>CUDA/cuDNN version</strong>: not used</li>\n<li><strong>GPU model and memory</strong>: Tesla K20m</li>\n<li><p><strong>Exact command to reproduce</strong>:</p>\n\n<ol>\n<li>Cloned tensorflow repo from github</li>\n<li>Configure Bazel <em>(./configure in tensorflow repo)</em></li>\n<li>Built libtensorflow_cc.so with bazel <em>(worked fine!!!)</em></li>\n<li>Downloaded dependencies with delivered script <strong>tensorflow/contrib/makefile/download_dependencies.sh</strong>\n(tried installing protobuf &amp; eigen manually, too)!</li>\n<li>Installed <strong>protobuf</strong> with ./autogen.sh &amp;&amp; ./configure &amp;&amp; make &amp;&amp; make install</li>\n<li>Installed Eigen from downloaded dependencies</li>\n<li><p>Copied libraries, headers and includes into own project:</p>\n\n<pre><code>$ cp bazel-bin/tensorflow/libtensorflow_cc.so ../tf_project/lib/\n$ cp bazel-bin/tensorflow/libtensorflow_framework.so ../tf_project/lib/\n$ cp /tmp/proto/lib/libprotobuf.a ../tf_project/lib/\n$ mkdir -p ../tf_project/include/tensorflow\n$ cp -r bazel-genfiles/ * ../tf_project/include/\n$ cp -r tensorflow/cc ../tf_project/include/tensorflow\n$ cp -r tensorflow/core ../tf_project/include/tensorflow\n$ cp -r third_party ../tf_project/include\n$ cp -r /tmp/proto/include/ * ../tf_project/include\n$ cp -r /tmp/eigen/include/eigen3/ * ../tf_project/include\n</code></pre></li>\n</ol></li>\n</ul>\n\n<p><strong>Remark:</strong> On <strong>my own</strong> system it works this way for weeks now. I can use tensorflow in my own project with an exported model trained with keras inside a python project. I make predictions using client_sessions and many other functions of the tensorflow framework and it works properly.</p>\n\n<p><strong>Problem:</strong> At the cluster I can compile tensorflow as dynamic library, install protobuf and eigen. \nWhen I try to compile my project (similar process regarding my own system) without significant changes it doesn't work and stops with following error message:</p>\n\n<pre><code>.../tensorflow/include/tensorflow/core/framework/tensor.pb.h:12:2: error: #error This file was generated by a newer version of protoc which is\n #error This file was generated by a newer version of protoc which is\n  ^~~~~\n.../include/tensorflow/core/framework/tensor.pb.h:13:2: error: #error incompatible with your Protocol Buffer headers. Please update\n #error incompatible with your Protocol Buffer headers.  Please update\n  ^~~~~\n.../include/tensorflow/core/framework/tensor.pb.h:14:2: error: #error your headers.\n #error your headers.\n  ^~~~~\n.../include/tensorflow/core/framework/tensor.pb.h:27:10: fatal error: google/protobuf/inlined_string_field.h: No such file or directory\n #include &lt;google/protobuf/inlined_string_field.h&gt;\n          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\ncompilation terminated.\n</code></pre>\n\n<p>So, clearly this should be the issue:</p>\n\n<p>This file was generated by a newer version of protoc which is incompatible with your Protocol Buffer headers.  Please update your headers.</p>\n\n<p>and</p>\n\n<p><strong>fatal error:</strong> google/protobuf/inlined_string_field.h: No such file or directory</p>\n\n<p>Tried solutions:</p>\n\n<ol>\n<li>I tried different versions of <strong>protobuf</strong> but there was an error every single try. </li>\n<li>I tried installing <strong>protobuf</strong> and <strong>eigen</strong> manually (without the download_dependencies.sh script)</li>\n</ol>\n\n<p>I'm wondering because my own installation following exact the same steps works properly. Maybe there is an issue with one of the components unless I tried different versions to make sure that these aren't \"new\" issues. </p>\n\n<p>Can someone help me solving this error that I can compile and run this project at the other machine?</p>\n\n<p>Looking forward to get helpful solutions :) Thank you very much for the support!</p>\n\n<p>Best regards from Germany!</p>\n"}, {"tags": ["c++", "multithreading", "x86"], "comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1534937975, "post_id": 51965481, "comment_id": 90881786, "body": "Compiling with optimization disabled is usually not a good idea.  Look how nasty the asm is, keeping the loop counter in memory so it can run <i>at best</i> 1 iteration per ~6 cycles, bottlenecked on store-forwarding.  This slows down the no-contention case, so you underestimate the slowdown from cache misses / contention."}, {"owner": {"reputation": 2381, "user_id": 980129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wZPWQ.jpg?s=128&g=1", "display_name": "Manuel", "link": "https://stackoverflow.com/users/980129/manuel"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1534938473, "post_id": 51965481, "comment_id": 90882065, "body": "@PeterCordes Yeah, I know. I was just worried about gcc optimizing out some of the code. I just wanted a rough idea and didn&#39;t want to use memory barriers, as I don&#39;t really know how they work."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 4, "creation_date": 1534938740, "post_id": 51965481, "comment_id": 90882222, "body": "<code>-O0</code> often doesn&#39;t even give you a rough idea.  It often bottlenecks on <i>different</i> things than real code would.  Your thread can&#39;t inline because it&#39;s a thread function (passed by function pointer to a library function).  You should just compile with optimization and look at the resulting asm.  (And make sure time taken scales ~linearly with <code>TOTAL</code> to check that it didn&#39;t optimize away the repeat-loop.)"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1534939211, "post_id": 51965481, "comment_id": 90882552, "body": "<i>I&#39;ve guessed if I have two threads, one making the first calculus, and the other the second</i>.  Normally you&#39;d want to have both threads work on the first calculation, the first thread on the first half of your input, and the 2nd on the 2nd half.  Then have both threads run the 2nd calculation.  So the same thread touches the same memory multiple times, letting it benefit from L1 / L2 cache.  Work in small chunks that fit in cache (cache-blocking).  Or better, do both calculations in one pass to increase computation : memory ratio (computational intensity)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1534939304, "post_id": 51965481, "comment_id": 90882609, "body": "See <a href=\"https://stackoverflow.com/a/47714514\">What Every Programmer Should Know About Memory?</a> for more about cache-blocking.  <a href=\"https://software.intel.com/en-us/articles/how-to-use-loop-blocking-to-optimize-memory-use-on-32-bit-intel-architecture\" rel=\"nofollow noreferrer\">software.intel.com/en-us/articles/&hellip;</a>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1534939988, "post_id": 51965481, "comment_id": 90883093, "body": "You also forgot to align your buffers.  So both threads are actually touching every cache line, instead of your intended alternating cache liens.  (See <a href=\"https://stackoverflow.com/questions/51965481/why-is-l1-write-access-access-worst-with-two-threads-in-the-same-core-hyperthre?noredirect=1#comment90882904_51965859\">this comment</a>.  You might be getting <a href=\"https://stackoverflow.com/q/45602699\">some memory-order mis-speculation pipeline clears with hyperthreading</a>.  But mostly just competing for load/store ports on one core.  Use <code>perf stat</code> to check."}], "answers": [{"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1534938474, "post_id": 51965859, "comment_id": 90882066, "body": "The front-end isn&#39;t duplicated either, if that&#39;s what you mean by &quot;instruction pipelines&quot;.  The front-end (decode/rename+issue) alternates between logical cores, so the physical pipeline width is still only 4 fused-domain uops per clock.  The OP&#39;s un-optimized code (compiled with <code>-O0</code>) bottlenecks on store/reload latency (keeping the loop counter in memory), so there is room for hyperthreading to gain total throughput, but I guess there are so many wasted instructions that the threads compete some."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1534938984, "post_id": 51965859, "comment_id": 90882395, "body": "@PeterCordes I was just reading up and noticed that mistake, thanks for the correction!"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1534939746, "post_id": 51965859, "comment_id": 90882904, "body": "L2 is private per-core in Intel Sandybridge-family.  But the OP didn&#39;t <i>align</i> their buffer (and they print the address, so we can see that <code>malloc</code> kept the first 16 bytes for metadata), so touching alternating 64-byte blocks in each thread means they do have to bounce between cores because each thread touches every cache line.  Presumably one will get behind and fall further behind until it&#39;s not a problem anymore.  If they were aligned, the adjacent-line L2 spatial prefetcher would maybe cause a problem.  (of course assuming this used 16-byte stores instead of 1 byte to saturate mem b/w.)"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 10, "last_activity_date": 1534939006, "last_edit_date": 1534939006, "creation_date": 1534937300, "answer_id": 51965859, "question_id": 51965481, "link": "https://stackoverflow.com/questions/51965481/why-is-l1-write-access-access-worst-with-two-threads-in-the-same-core-hyperthre/51965859#51965859", "title": "Why is L1 write access access worst with two threads in the same core (hyperthreading) than two cores?", "body": "<blockquote>\n  <p>Apparently, there is no difference in taking data from L1, L2, L3 or RAM in order to do the calculations.</p>\n</blockquote>\n\n<p>You are fully traversing each cache line at each level (and each page) before requesting the next. Memory accesses are slow, but they're not so slow that you can traverse an entire page before the next arrives. If you were to access a different L3 cache line or a different RAM page every access, you would certainly notice a difference. But the way you are doing it, you make your CPU churn through a ton of instructions between each L2, L3 or RAM request, completely hiding any kind of cache miss latency.</p>\n\n<p>As such, you are not memory bound in the slightest. You have basically he most benign usage pattern possible: <strong>All your data is already cached almost all the time.</strong> Sometimes you will get a cache miss, but the fetch time for that pales in comparison to the time you spend working with cached data. Also, your CPU is likely to predict your (extremely predictable) usage pattern and already prefetch memory well before you access it.</p>\n\n<blockquote>\n  <p>So 10 seconds slower.<br>\n  How's that possible? I've understood if the cache line isn't dirty, it wouldn't be fetched from memory (either, L1, 2, 3 or RAM). </p>\n</blockquote>\n\n<p>As shown above, you are not memory bound. You are bound by how fast your CPU can churn through the instructions (edit: this is compounded by disabling optimizations, which will bloat the number of instructions), and it should not be a surprise that two hyperthreaded threads won't be as good at that as two threads on separate physical cores.</p>\n\n<p>Of particular importance for this observation is that not all resources are duplicated for each pair of hyperthreaded cores. For example, the execution ports (e.g. adder, divider, floating point unit etc.) are not - those are shared. Here is a diagram of the Skylake scheduler to demonstrate the concept:</p>\n\n<p><a href=\"https://en.wikichip.org/w/images/thumb/3/32/skylake_scheduler.svg/580px-skylake_scheduler.svg.png\" rel=\"noreferrer\"><img src=\"https://en.wikichip.org/w/images/thumb/3/32/skylake_scheduler.svg/580px-skylake_scheduler.svg.png\" alt=\"Execution ports on Intel Haswell\"></a></p>\n\n<p>While hyperthreading, both threads have to contend over these resources (and even a single-threaded program will be affected by this design due to out-of-order execution). There are four simple integer ALUs in this design, but only one <code>Store Data</code> port. So two threads on the same core (in this Haswell CPU) cannot simultaneously store data, but they can compute several integer operations concurrently (note: No guarantee that it is actually port 4 that is the source of contention - some Intel tools may be able to figure this out for you). This limitation does not exist when splitting the load between two different physical cores.</p>\n\n<p>There might be some overhead in synchronizing L2 cache lines between different physical cores (since L2 cache is apparently not shared between all cores for your CPU), but that's hard to gauge from here.</p>\n\n<p>I found the above picture in this page, which gives a much more in-depth explanation of the above (and more): <a href=\"https://en.wikichip.org/wiki/intel/microarchitectures/skylake_(client)\" rel=\"noreferrer\">https://en.wikichip.org/wiki/intel/microarchitectures/skylake_(client)</a></p>\n"}], "owner": {"reputation": 2381, "user_id": 980129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wZPWQ.jpg?s=128&g=1", "display_name": "Manuel", "link": "https://stackoverflow.com/users/980129/manuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 4, "accepted_answer_id": 51965859, "answer_count": 1, "score": 5, "last_activity_date": 1535016170, "creation_date": 1534935970, "last_edit_date": 1535016170, "question_id": 51965481, "link": "https://stackoverflow.com/questions/51965481/why-is-l1-write-access-access-worst-with-two-threads-in-the-same-core-hyperthre", "title": "Why is L1 write access access worst with two threads in the same core (hyperthreading) than two cores?", "body": "<p>I've made a c/c++ program (mix of <code>printf</code> and <code>std::</code>) to get an idea of different cache performance.\nI would like to parallelize a process that's calculating over a big chunk of memory. I have to do several calculations on the same memory locations, so I've write the results on place, overwriting source data. When the first calculus is done, I do another one with previous results.</p>\n\n<p>I've guessed if I have two threads, one making the first calculus, and the other the second, I would improve performance because each thread does half the work, thus making the process twice as fast.\nI've read how caches work, so I know if this isn't done well, it may be even worse, so I've write a small program to measure everything.</p>\n\n<p>(See below for machine topology, CPU type and flags and source code.)</p>\n\n<p>I've seen some strange results.\nApparently, there is no difference in taking data from <code>L1</code>, <code>L2</code>, <code>L3</code> or <code>RAM</code> in order to do the calculations. I doesn't matter if I'm working in the same buffer or two different buffers (with distance in memory between them) unless they are in the same core.\nI mean: the worst results are when the two threads are in the same core (hyper-threading). I set them with CPU affinity</p>\n\n<p>There are some options for my program, but they are self explanatory.</p>\n\n<p>These are the commands and the results:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>./main --loops 200 --same-buffer --flush\n\n200000 loops.\nFlushing caches.\nCache size: 32768\nUsing same buffer.\nRunning in cores 0 and 1.\nWaiting 2 seconds just for threads to be ready.\nPost threads to begin work 200000 iterations.\nThread two created, pausing.\nGo ahead and calculate in 2...\nBuffer address: 0x7f087c156010.\nWaiting for thread semaphores.\nThread one created, pausing.\nGo ahead and calculate in 1...\nBuffer address: 0x7f087c156010.\nTime 1 18.436685\nTime 2 18.620263\nWe don't wait anymore.\nJoining threads.\nDumping data.\nExiting from main thread.\n</code></pre>\n\n<p>We can see it is running in cores 0 and 1, according to my topology, different cores. The buffer address is the same: <code>0x7f087c156010</code>.</p>\n\n<p>The time: 18secs.</p>\n\n<p>Now in the same core:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>./main --loops 200 --same-buffer --same-core --flush\n\n200000 loops.\nFlushing caches.\nCache size: 32768\nUsing same buffer.\nUsing same core. (HyperThreading)\nThread one created, pausing.\nThread two created, pausing.\nRunning in cores 0 and 6.\nWaiting 2 seconds just for threads to be ready.\nPost threads to begin work 200000 iterations.\nWaiting for thread semaphores.\nGo ahead and calculate in 1...\nBuffer address: 0x7f0a6bbe1010.\nGo ahead and calculate in 2...\nBuffer address: 0x7f0a6bbe1010.\nTime 1 26.572419\nTime 2 26.951195\nWe don't wait anymore.\nJoining threads.\nDumping data.\nExiting from main thread.\n</code></pre>\n\n<p>We can see it is running in cores 0 and 6, according to my topology, same core, two hyper-threads. Same buffer.</p>\n\n<p>The time: 26secs.</p>\n\n<p>So 10 seconds slower.</p>\n\n<p>How's that possible? I've understood if the cache line isn't dirty, it wouldn't be fetched from memory (either, L1, 2, 3 or RAM). I've made the program writing alternative 64 byte arrays, so same as one cache line. If one thread writes cache line 0, the other writes cache line 1, so there is no cache line clash.</p>\n\n<p>Does this means two hyper-threads, even if they share the L1 cache, can't write to it at the same time?</p>\n\n<p>Apparently, working in two distinct cores does better than one alone.</p>\n\n<p><strong>-- Edit --</strong></p>\n\n<p>As suggested by commenters and <a href=\"https://stackoverflow.com/users/9528746/max-langhof\">Max Langhof</a>, I've included code to align buffers. I've also added an option to misalign the buffers only to see the difference.</p>\n\n<p><strong>I'm not sure about the align and misaling code, but I've copied from <a href=\"https://stackoverflow.com/questions/227897/how-to-allocate-aligned-memory-only-using-the-standard-library\">here</a></strong></p>\n\n<p>Just like they told me, it's a waste of time to measure non optimized code.</p>\n\n<p>And for optimized code the results are pretty interesting. What I found surprising is that it takes the same time, even misaligning data and with two cores, but I suppose that's because the small amount of work in the inner loop. (And I guess that shows how well designed are today processors.)</p>\n\n<p>Numbers (taken with perf stat -d -d -d):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>*** Same core\n\nNo optimization\n---------------\nNo aligment\n    39.866.074.445      L1-dcache-loads           # 1485,716 M/sec                    (21,75%)\n        10.746.914      L1-dcache-load-misses     #    0,03% of all L1-dcache hits    (20,84%)\nAligment\n    39.685.928.674      L1-dcache-loads           # 1470,627 M/sec                    (22,77%)\n        11.003.261      L1-dcache-load-misses     #    0,03% of all L1-dcache hits    (27,37%)\nMisaligment\n    39.702.205.508      L1-dcache-loads           # 1474,958 M/sec                    (24,08%)\n        10.740.380      L1-dcache-load-misses     #    0,03% of all L1-dcache hits    (29,05%)\n\n\nOptimization\n------------\nNo aligment\n    39.702.205.508      L1-dcache-loads           # 1474,958 M/sec                    (24,08%)\n        10.740.380      L1-dcache-load-misses     #    0,03% of all L1-dcache hits    (29,05%)\n       2,390298203 seconds time elapsed\nAligment\n        19.450.626      L1-dcache-loads           #   25,108 M/sec                    (23,21%)\n         1.758.012      L1-dcache-load-misses     #    9,04% of all L1-dcache hits    (22,95%)\n       2,400644369 seconds time elapsed\nMisaligment\n         2.687.025      L1-dcache-loads           #    2,876 M/sec                    (24,64%)\n           968.413      L1-dcache-load-misses     #   36,04% of all L1-dcache hits    (12,98%)\n       2,483825841 seconds time elapsed\n\n*** Two cores\n\nNo optimization\n---------------\nNo aligment\n    39.714.584.586      L1-dcache-loads           # 2156,408 M/sec                    (31,17%)\n       206.030.164      L1-dcache-load-misses     #    0,52% of all L1-dcache hits    (12,55%)\nAligment\n    39.698.566.036      L1-dcache-loads           # 2129,672 M/sec                    (31,10%)\n       209.659.618      L1-dcache-load-misses     #    0,53% of all L1-dcache hits    (12,54%)\nMisaligment\n         2.687.025      L1-dcache-loads           #    2,876 M/sec                    (24,64%)\n           968.413      L1-dcache-load-misses     #   36,04% of all L1-dcache hits    (12,98%)\n\n\nOptimization\n------------\nNo aligment\n        16.711.148      L1-dcache-loads           #    9,431 M/sec                    (31,08%)\n       202.059.646      L1-dcache-load-misses     # 1209,13% of all L1-dcache hits    (12,87%)\n       2,898511757 seconds time elapsed\nAligment\n        18.476.510      L1-dcache-loads           #   10,484 M/sec                    (30,99%)\n       202.180.021      L1-dcache-load-misses     # 1094,25% of all L1-dcache hits    (12,83%)\n       2,894591875 seconds time elapsed\nMisaligment\n        18.663.711      L1-dcache-loads           #   11,041 M/sec                    (31,28%)\n       190.887.434      L1-dcache-load-misses     # 1022,77% of all L1-dcache hits    (13,22%)\n       2,861316941 seconds time elapsed\n</code></pre>\n\n<p><strong>-- End edit --</strong></p>\n\n<p>The program creates log files with buffer dumps, so I've verified it works as expected (you can see below).</p>\n\n<p>Also I have the ASM where we can see the loop is doing something.</p>\n\n<pre class=\"lang-asm prettyprint-override\"><code> 269:main.cc       ****             for (int x = 0; x &lt; 64; ++x)\n 1152                   .loc 1 269 0 is_stmt 1\n 1153 0c0c C745F000         movl    $0, -16(%rbp)   #, x\n 1153      000000\n 1154               .L56:\n 1155                   .loc 1 269 0 is_stmt 0 discriminator 3\n 1156 0c13 837DF03F         cmpl    $63, -16(%rbp)  #, x\n 1157 0c17 7F26             jg  .L55    #,\n 270:main.cc       ****                 th-&gt;cache-&gt;cache[i].data[x] = '2';\n 1158                   .loc 1 270 0 is_stmt 1 discriminator 2\n 1159 0c19 488B45E8         movq    -24(%rbp), %rax # th, tmp104\n 1160 0c1d 488B4830         movq    48(%rax), %rcx  # th_9-&gt;cache, _25\n 1161 0c21 8B45F0           movl    -16(%rbp), %eax # x, tmp106\n 1162 0c24 4863D0           movslq  %eax, %rdx  # tmp106, tmp105\n 1163 0c27 8B45F4           movl    -12(%rbp), %eax # i, tmp108\n 1164 0c2a 4898             cltq\n 1165 0c2c 48C1E006         salq    $6, %rax    #, tmp109\n 1166 0c30 4801C8           addq    %rcx, %rax  # _25, tmp109\n 1167 0c33 4801D0           addq    %rdx, %rax  # tmp105, tmp110\n 1168 0c36 C60032           movb    $50, (%rax) #, *_25\n 269:main.cc       ****             for (int x = 0; x &lt; 64; ++x)\n</code></pre>\n\n<p>This is part of the dump:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>== buffer ==============================================================================================================\n00000001 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 \n00000002 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 \n00000003 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 \n00000004 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 0x31 \n00000005 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 \n00000006 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 \n00000007 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 \n00000008 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 0x32 \n</code></pre>\n\n<p>My machine topology:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bTqqP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bTqqP.png\" alt=\"Intel(R) Xeon(R) CPU E5-2640 0 @ 2.50GHz\"></a></p>\n\n<p>This is the CPU type and flags.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>processor   : 11\nvendor_id   : GenuineIntel\ncpu family  : 6\nmodel       : 45\nmodel name  : Intel(R) Xeon(R) CPU E5-2640 0 @ 2.50GHz\nstepping    : 7\nmicrocode   : 0x70b\ncpu MHz     : 1504.364\ncache size  : 15360 KB\nphysical id : 0\nsiblings    : 12\ncore id     : 5\ncpu cores   : 6\napicid      : 11\ninitial apicid  : 11\nfpu     : yes\nfpu_exception   : yes\ncpuid level : 13\nwp      : yes\nflags       : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm epb kaiser tpr_shadow vnmi flexpriority ept vpid xsaveopt dtherm ida arat pln pts\nbugs        : cpu_meltdown spectre_v1 spectre_v2\nbogomips    : 4987.77\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 46 bits physical, 48 bits virtual\npower management:\n</code></pre>\n\n<p>This is the complete source code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>//\n//\n//\n//\n#include &lt;emmintrin.h&gt;\n#include &lt;x86intrin.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;ctime&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;string.h&gt;\n#include &lt;string&gt;\n\n\nstruct cache_line {\n    char data[64];\n};\n\n//\n// 32768 = 32 Kb = 512 64B cache lines\nstruct cache_l1 {\n    struct cache_line cache[512];\n};\n\nsize_t TOTAL = 100000;\n\nvoid * thread_one (void * data);\nvoid * thread_two (void * data);\n\nvoid dump (FILE * file, char * buffer, size_t size);\n\nclass thread {\npublic:\n    sem_t sem;\n    sem_t * glob;\n    pthread_t thr;\n    struct cache_l1 * cache;\n};\n\nbool flush = false;\n\nint main (int argc, char ** argv)\n{\n    bool same_core = false;\n    bool same_buffer = false;\n    bool align = false;\n    bool misalign = false;\n    size_t reserve_mem = 32768; // 15MB 15.728.640\n    std::string file_name (\"pseudobench_\");\n    std::string core_option (\"diffcore\");\n    std::string buffer_option (\"diffbuff\");\n    std::string cache_option (\"l1\");\n\n    for (int i = 1; i &lt; argc; ++i) {\n        if (::strcmp(\"--same-core\", argv[i]) == 0) {\n\n            same_core = true;\n            core_option = \"samecore\";\n\n        } else if (::strcmp(\"--same-buffer\", argv[i]) == 0) {\n\n            same_buffer = true;\n            buffer_option = \"samebuffer\";\n\n        } else if (::strcmp(\"--l1\", argv[i]) == 0) {\n\n            // nothing already L1 cache size\n\n        } else if (::strcmp(\"--l2\", argv[i]) == 0) {\n\n            reserve_mem *= 8; // 256KB, L2 cache size\n            cache_option = \"l2\";\n\n        } else if (::strcmp(\"--l3\", argv[i]) == 0) {\n\n            reserve_mem *= 480; // 15MB, L3 cache size\n            cache_option = \"l3\";\n\n        } else if (::strcmp(\"--ram\", argv[i]) == 0) {\n\n            reserve_mem *= 480; // 15MB, plus two times L1 cache size\n            reserve_mem += sizeof(struct cache_l1) * 2;\n            cache_option = \"ram\";\n\n        } else if (::strcmp(\"--loops\", argv[i]) == 0) {\n\n            TOTAL = ::strtol(argv[++i], nullptr, 10) * 1000;\n            printf (\"%ld loops.\\n\", TOTAL);\n\n        } else if (::strcmp(\"--align\", argv[i]) == 0) {\n\n            align = true;\n            printf (\"Align memory to 16 bytes.\\n\");\n\n        } else if (::strcmp(\"--misalign\", argv[i]) == 0) {\n\n            misalign = true;\n            printf (\"Misalign memory.\\n\");\n\n        } else if (::strcmp(\"--flush\", argv[i]) == 0) {\n\n            flush = true;\n            printf (\"Flushing caches.\\n\");\n\n        } else if (::strcmp(\"-h\", argv[i]) == 0) {\n\n            printf (\"There is no help here. Please put loops in units, \"\n                    \"they will be multiplicated by thousands. (Default 100.000 EU separator)\\n\");\n        } else {\n            printf (\"Unknown option: '%s', ignoring it.\\n\", argv[i]);\n        }\n    }\n\n    char * ch = new char[(reserve_mem * 2) + (sizeof(struct cache_l1) * 2) + 16];\n    struct cache_l1 * cache4 = nullptr;\n    struct cache_l1 * cache5 = nullptr;\n\n    if (align) {\n        // Align memory (void *)(((uintptr_t)ch+15) &amp; ~ (uintptr_t)0x0F);\n        cache4 = (struct cache_l1 *) (((uintptr_t)ch + 15) &amp; ~(uintptr_t)0x0F);\n        cache5 = (struct cache_l1 *) &amp;cache4[reserve_mem - sizeof(struct cache_l1)];\n        cache5 = (struct cache_l1 *)(((uintptr_t)cache5) &amp; ~(uintptr_t)0x0F);\n    } else {\n        cache4 = (struct cache_l1 *) ch;\n        cache5 = (struct cache_l1 *) &amp;ch[reserve_mem - sizeof(struct cache_l1)];\n    }\n\n    if (misalign) {\n        cache4 = (struct cache_l1 *) ((char *)cache4 + 5);\n        cache5 = (struct cache_l1 *) ((char *)cache5 + 5);\n    }\n\n    (void)cache4;\n    (void)cache5;\n\n    printf (\"Cache size: %ld\\n\", sizeof(struct cache_l1));\n\n    if (cache_option == \"l1\") {\n        // L1 doesn't allow two buffers, so same buffer\n        buffer_option = \"samebuffer\";\n    }\n\n    sem_t globsem;\n\n    thread th1;\n    thread th2;\n\n    if (same_buffer) {\n        printf (\"Using same buffer.\\n\");\n        th1.cache = cache5;\n    } else {\n        th1.cache = cache4;\n    }\n    th2.cache = cache5;\n\n    sem_init (&amp;globsem, 0, 0);\n\n    if (sem_init(&amp;th1.sem, 0, 0) &lt; 0) {\n        printf (\"There is an error with the 1 semaphore.\\n\");\n    }\n    if (sem_init(&amp;th2.sem, 0, 0) &lt; 0) {\n        printf (\"There is an error with the 2 semaphore.\\n\");\n    }\n\n    th1.glob = &amp;globsem;\n    th2.glob = &amp;globsem;\n\n    cpu_set_t cpuset;\n    int rc = 0;\n\n    pthread_create (&amp;th1.thr, nullptr, thread_one, &amp;th1);\n    CPU_ZERO (&amp;cpuset);\n    CPU_SET (0, &amp;cpuset);\n    rc = pthread_setaffinity_np(th1.thr,\n                                sizeof(cpu_set_t),\n                                &amp;cpuset);\n    if (rc != 0) {\n        printf (\"Can't change affinity of thread one!\\n\");\n    }\n\n    pthread_create (&amp;th2.thr, nullptr, thread_two, &amp;th2);\n    CPU_ZERO (&amp;cpuset);\n    int cpu = 1;\n\n    if (same_core) {\n        printf (\"Using same core. (HyperThreading)\\n\");\n        cpu = 6; // Depends on CPU topoglogy (see that with lstopo)\n    }\n\n    CPU_SET (cpu, &amp;cpuset);\n    rc = pthread_setaffinity_np(th2.thr,\n                                sizeof(cpu_set_t),\n                                &amp;cpuset);\n    if (rc != 0) {\n        printf (\"Can't change affinity of thread two!\\n\");\n    }\n\n    printf (\"Running in cores 0 and %d.\\n\", cpu);\n\n    fprintf (stderr, \"Waiting 2 seconds just for threads to be ready.\\n\");\n    struct timespec time;\n    time.tv_sec = 2;\n    nanosleep (&amp;time, nullptr);\n\n    fprintf (stderr, \"Post threads to begin work %ld iterations.\\n\", TOTAL);\n\n    sem_post (&amp;globsem);\n    sem_post (&amp;globsem);\n\n    printf (\"Waiting for thread semaphores.\\n\");\n\n    sem_wait (&amp;th1.sem);\n    sem_wait (&amp;th2.sem);\n\n    printf (\"We don't wait anymore.\\n\");\n\n    printf (\"Joining threads.\\n\");\n    pthread_join (th1.thr, nullptr);\n    pthread_join (th2.thr, nullptr);\n\n    printf (\"Dumping data.\\n\");\n    file_name += core_option;\n    file_name += \"_\";\n    file_name += buffer_option;\n    file_name += \"_\";\n    file_name += cache_option;\n    file_name += \".log\";\n    FILE * file = ::fopen(file_name.c_str(), \"w\");\n    if (same_buffer)\n        dump (file, (char *)cache5, sizeof(struct cache_l1));\n    else {\n        dump (file, (char *)cache4, sizeof(struct cache_l1));\n        dump (file, (char *)cache5, sizeof(struct cache_l1));\n    }\n    printf (\"Exiting from main thread.\\n\");\n    return 0;\n}\n\nvoid * thread_one (void * data)\n{\n    thread * th = (thread *) data;\n    printf (\"Thread one created, pausing.\\n\");\n    if (flush)\n        _mm_clflush (th-&gt;cache);\n    sem_wait (th-&gt;glob);\n\n    printf (\"Go ahead and calculate in 1...\\n\");\n    printf (\"Buffer address: %p.\\n\", th-&gt;cache);\n    clock_t begin, end;\n    double time_spent;\n    register uint64_t counter = 0;\n    begin = clock();\n    for (size_t z = 0; z &lt; TOTAL; ++z ) {\n        ++counter;\n        for (int i = 0; i &lt; 512; i += 2) {\n            ++counter;\n            for (int x = 0; x &lt; 64; ++x) {\n                ++counter;\n                th-&gt;cache-&gt;cache[i].data[x] = '1';\n            }\n        }\n    }\n    end = clock();\n    time_spent = (double)(end - begin) / CLOCKS_PER_SEC;    \n    printf (\"Time 1 %f %ld\\n\", time_spent, counter);\n\n    sem_post (&amp;th-&gt;sem);\n\n    return nullptr;\n}\n\nvoid * thread_two (void * data)\n{\n    thread * th = (thread *) data;\n    printf (\"Thread two created, pausing.\\n\");\n    if (flush)\n        _mm_clflush (th-&gt;cache);\n    sem_wait (th-&gt;glob);\n\n    printf (\"Go ahead and calculate in 2...\\n\");\n    printf (\"Buffer address: %p.\\n\", th-&gt;cache);\n    clock_t begin, end;\n    double time_spent;\n    register uint64_t counter = 0;\n    begin = clock();\n    for (size_t z = 0; z &lt; TOTAL; ++z ) {\n        ++counter;\n        for (int i = 1; i &lt; 512; i += 2) {\n            ++counter;;\n            for (int x = 0; x &lt; 64; ++x) {\n                ++counter;\n                th-&gt;cache-&gt;cache[i].data[x] = '2';\n            }\n        }\n    }\n    end = clock();\n    time_spent = (double)(end - begin) / CLOCKS_PER_SEC;    \n    printf (\"Time 2 %f  %ld\\n\", time_spent, counter);\n\n    sem_post (&amp;th-&gt;sem);\n\n    return nullptr;\n}\n\nvoid dump (FILE * file, char * buffer, size_t size)\n{\n    size_t lines = 0;\n    fprintf (file, \"\\n\");\n    fprintf (file, \"== buffer ==================================================\"\n             \"============================================================\\n\");\n\n    for (size_t i = 0; i &lt; size; i += 16) {\n        fprintf (file, \"%08ld %p \", ++lines, &amp;buffer[i]);\n        for (size_t x = i; x &lt; (i+16); ++x) {\n            if (buffer[x] &gt;= 32 &amp;&amp; buffer[x] &lt; 127)\n                fprintf (file, \"%c \", buffer[x]);\n            else\n                fprintf (file, \". \");\n        }\n        for (size_t x = i; x &lt; (i+16); ++x) {\n            fprintf (file, \"0x%02x \", buffer[x]);\n        }\n        fprintf (file, \"\\n\");\n    }\n    fprintf (file, \"== buffer ==================================================\"\n             \"============================================================\\n\");\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers", "double-pointer"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1534935904, "post_id": 51965450, "comment_id": 90880671, "body": "C# and C are not the same language. Please try to only use tags relevant to your question."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1534936044, "post_id": 51965450, "comment_id": 90880751, "body": "Speaking of relevant tags... I think you meant to tag C++."}, {"owner": {"reputation": 7, "user_id": 10259319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81dea408110057df12642064ddf8d321?s=128&d=identicon&r=PG&f=1", "display_name": "Madare", "link": "https://stackoverflow.com/users/10259319/madare"}, "edited": false, "score": 0, "creation_date": 1534936241, "post_id": 51965450, "comment_id": 90880844, "body": "Yes, my bad. I meant to add C++."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1534936429, "post_id": 51965450, "comment_id": 90880926, "body": "Speaking of your example. Did you actually compile and run the code you posted? For one comments are made with <code>&#47;&#47;</code>, and not <code>\\\\ </code>. Also, you print everything on a single line. So that would not produce two different lines. And finally, when I fixed those mistakes. I got the expected results. <a href=\"http://coliru.stacked-crooked.com/a/a13ef45d32b36202\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/a13ef45d32b36202</a>"}, {"owner": {"reputation": 1751, "user_id": 3536140, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fcc1b905bfd7fe58a60cbf8bc991408a?s=128&d=identicon&r=PG&f=1", "display_name": "vdavid", "link": "https://stackoverflow.com/users/3536140/vdavid"}, "edited": false, "score": 2, "creation_date": 1534936926, "post_id": 51965450, "comment_id": 90881206, "body": "I get 56565 as expected <a href=\"https://ideone.com/A8elMA\" rel=\"nofollow noreferrer\">ideone.com/A8elMA</a> how did you come up with 56665? What compiler/platform?"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1534936728, "creation_date": 1534936728, "answer_id": 51965692, "question_id": 51965450, "link": "https://stackoverflow.com/questions/51965450/assigning-a-pointer-through-a-double-pointers/51965692#51965692", "title": "Assigning a Pointer through a Double Pointers", "body": "<blockquote>\n  <p>Shouldn't the output be 56565 as when you give *r = &amp;m, p gets the address of m and *p should print the value of m (5)?</p>\n</blockquote>\n\n<p>Yes, it should; your reasoning is spot on. Furthermore, the <a href=\"http://coliru.stacked-crooked.com/a/c759976e3b6f5222\" rel=\"nofollow noreferrer\">output <strong>is</strong> 56565</a>, as it should be.</p>\n"}, {"tags": [], "owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "is_accepted": false, "score": 0, "last_activity_date": 1534936754, "creation_date": 1534936754, "answer_id": 51965701, "question_id": 51965450, "link": "https://stackoverflow.com/questions/51965450/assigning-a-pointer-through-a-double-pointers/51965701#51965701", "title": "Assigning a Pointer through a Double Pointers", "body": "<p>This is the way pointers works.</p>\n\n<p>if <code>r=&amp;p</code> and you set <code>*r=&amp;m</code> it is exactly the same as <code>p=&amp;m</code>.</p>\n"}], "owner": {"reputation": 7, "user_id": 10259319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81dea408110057df12642064ddf8d321?s=128&d=identicon&r=PG&f=1", "display_name": "Madare", "link": "https://stackoverflow.com/users/10259319/madare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1534936754, "creation_date": 1534935850, "last_edit_date": 1534936067, "question_id": 51965450, "link": "https://stackoverflow.com/questions/51965450/assigning-a-pointer-through-a-double-pointers", "title": "Assigning a Pointer through a Double Pointers", "body": "<pre><code>int m = 5, n = 6;\nint *p,*q,**r;\np = &amp;n, q = &amp;n;\nr = &amp;p;\ncout&lt;&lt;m&lt;&lt;n&lt;&lt;*p&lt;&lt;*q&lt;&lt;**r; \\\\Gives output 56666\n*r = &amp;m;\ncout&lt;&lt;m&lt;&lt;n&lt;&lt;*p&lt;&lt;*q&lt;&lt;**r;  \\\\Gives output 56665\n</code></pre>\n\n<p>Shouldn't the output be 56565 as when you give *r = &amp;m, p gets the address of m and *p should print the value of m (5)?</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534935760, "post_id": 51965349, "comment_id": 90880611, "body": "How do you not get an error for not using a fixed value, or <code>const int</code> to define array size?"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1534935781, "post_id": 51965349, "comment_id": 90880617, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs?</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1534935864, "post_id": 51965349, "comment_id": 90880655, "body": "@SusmitAgrawal VLA&#39;s are a compiler extension, not C++ standard tho."}, {"owner": {"reputation": 39, "user_id": 10154187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985066cfef053b6bb79c2926f69c6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Sharma", "link": "https://stackoverflow.com/users/10154187/yash-sharma"}, "edited": false, "score": 0, "creation_date": 1534936802, "post_id": 51965349, "comment_id": 90881136, "body": "I used powershell to compile and it didn&#39;t give any warning, Is it wrong to use fixed  value to define array size  using int?? I seriously don&#39;t know."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1534939042, "post_id": 51965349, "comment_id": 90882440, "body": "Pointer arithmetic is a mess to read and understand - use indexing instead."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1534939171, "post_id": 51965349, "comment_id": 90882527, "body": "When <code>i</code> is <code>size - 1</code>, <code>(size-1)-(i+1)</code> is <code>-1</code>, so your code has undefined behaviour."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1534939865, "post_id": 51965349, "comment_id": 90882996, "body": "Nothing to do with your question but why do you write <code>*(arr + i)</code> instead of <code>arr[i]</code>? It makes your code hard to read."}, {"owner": {"reputation": 39, "user_id": 10154187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985066cfef053b6bb79c2926f69c6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Sharma", "link": "https://stackoverflow.com/users/10154187/yash-sharma"}, "edited": false, "score": 0, "creation_date": 1534940264, "post_id": 51965349, "comment_id": 90883277, "body": "yeah I did not get how pointers worked.so, I thought maybe I will try and learn by using them."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1534947832, "post_id": 51965349, "comment_id": 90888389, "body": "@YashSharma <i>I just debugged the code using visual studio</i> -- This code could never had compiled with this: <code>int arr[size];</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1534948291, "post_id": 51965349, "comment_id": 90888732, "body": "@YashSharma You also should be using <code>std::vector</code> if you want to resize.   Arrays cannot be resized by definition, so what you&#39;re doing is hacking a fake resize instead of actually resizing.  In addition <code>std::vector&lt;int&gt; arr(size);</code> replaces the syntax mentioned in the earlier comment, where Visual C++ (and standard C++) does not allow variable-length arrays."}, {"owner": {"reputation": 39, "user_id": 10154187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985066cfef053b6bb79c2926f69c6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Sharma", "link": "https://stackoverflow.com/users/10154187/yash-sharma"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1534951587, "post_id": 51965349, "comment_id": 90890850, "body": "@PaulMcKenzie thanks mate, I was having problem understanding why vectors were used instead of arrays in all the solutions. I will write the code using vectors now. Also I don&#39;t get what is wrong with using &#39;arr[size]&#39; ."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1535290387, "post_id": 51965349, "comment_id": 91003659, "body": "@YashSharma <i>Also I don&#39;t get what is wrong with using &#39;arr[size]&#39;</i> -- It&#39;s just plain wrong.  Pretend it doesn&#39;t exist, it is fake C++.  The problem is that new programmers get fooled into thinking it is ok because the compiler defaults into allowing such syntax."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10154187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985066cfef053b6bb79c2926f69c6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Sharma", "link": "https://stackoverflow.com/users/10154187/yash-sharma"}, "edited": false, "score": 0, "creation_date": 1534936405, "post_id": 51965473, "comment_id": 90880913, "body": "I just did the correction but its still not working, and I used powershell to compile but didn&#39;t get a warning earlier."}, {"owner": {"reputation": 39, "user_id": 10154187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985066cfef053b6bb79c2926f69c6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Sharma", "link": "https://stackoverflow.com/users/10154187/yash-sharma"}, "edited": false, "score": 0, "creation_date": 1534936962, "post_id": 51965473, "comment_id": 90881233, "body": "I will also edit the question and initialize &#39;i&#39; because I did that in my code"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 39, "user_id": 10154187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985066cfef053b6bb79c2926f69c6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Sharma", "link": "https://stackoverflow.com/users/10154187/yash-sharma"}, "edited": false, "score": 0, "creation_date": 1534937136, "post_id": 51965473, "comment_id": 90881330, "body": "@YashSharma normally it isnt good to edit the question to incorporate fixes from answers (it makes the answer pointless). However, if the actual problem really persists and if this fix really does not change the behaviour/output of your code then it is fine imho. Just note that johns effort to write this answer is then kinda wasted"}, {"owner": {"reputation": 39, "user_id": 10154187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985066cfef053b6bb79c2926f69c6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Sharma", "link": "https://stackoverflow.com/users/10154187/yash-sharma"}, "edited": false, "score": 0, "creation_date": 1534937515, "post_id": 51965473, "comment_id": 90881531, "body": "sorry but the problem still persisits, so that&#39;s why edited but  won&#39;t do it again in the future."}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 2, "last_activity_date": 1534935943, "creation_date": 1534935943, "answer_id": 51965473, "question_id": 51965349, "link": "https://stackoverflow.com/questions/51965349/my-code-for-rotating-arrays-gives-error-for-large-array-size/51965473#51965473", "title": "My code for rotating arrays gives error for large array size", "body": "<p>This is a problem</p>\n\n<pre><code>void initialize_array(int *arr,int size)\n{\n   for(int  i ; i &lt; size; ++i)\n   {\n        cin&gt;&gt;*(arr +i);\n   }\n}\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>void initialize_array(int *arr,int size)\n{\n   for(int i = 0; i &lt; size; ++i)\n   {\n        cin&gt;&gt;*(arr +i);\n   }\n}\n</code></pre>\n\n<p>Your compiler should have wanred you about the uninitialised variable. Pay attention to compiler warnings.</p>\n"}], "owner": {"reputation": 39, "user_id": 10154187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985066cfef053b6bb79c2926f69c6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Sharma", "link": "https://stackoverflow.com/users/10154187/yash-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1534949663, "creation_date": 1534935510, "last_edit_date": 1534949663, "question_id": 51965349, "link": "https://stackoverflow.com/questions/51965349/my-code-for-rotating-arrays-gives-error-for-large-array-size", "title": "My code for rotating arrays gives error for large array size", "body": "<p><strong>Problem</strong>: I was trying to solve this problem from geeksforgeeks on array rotation. The code seems to be working fine for small array size but for large array size it displays some garbage values and then stops working.</p>\n\n<p>The question is on this link: <a href=\"https://practice.geeksforgeeks.org/problems/rotate-and-delete/0\" rel=\"nofollow noreferrer\">https://practice.geeksforgeeks.org/problems/rotate-and-delete/0</a></p>\n\n<p>and my code is:</p>\n\n<pre><code># include&lt;iostream&gt;\n\nusing namespace std;\n\nvoid rotate_clockwise(int *arr, int size)\n{\n    int temp = *(arr + size -1);\n    for(int i = 0;i &lt; size;++i )\n    {\n        *(arr +(size -1) - i) = *(arr + (size-1) -(i+1));//*(arr +(size -1)) \n    }\n    *arr = temp;\n}\n\nvoid initialize_array(int *arr,int size)\n{\n\n   for(int  i= 0; i &lt; size; ++i)\n   {\n        cin&gt;&gt;*(arr +i);\n   }\n\n\n}\n\nvoid print_array(int *arr,int size)\n{\n    for(int i = 0; i&lt; size; i++)\n    {\n        cout&lt;&lt;*(arr + i)&lt;&lt;\" \";\n    }\n    cout&lt;&lt;endl;\n}\n\nvoid remove_ith_fend(int i, int *arr, int *ptr_size)\n{   \n    int size = *ptr_size;\n\n    int *last = (arr + size -1);\n\n    i = i-1;\n\n    if(i &lt; size)\n    {\n        for(int j =0 ;j&lt;size;j++)\n        {\n            *(last - i + j) = *(last -i + j+1);\n        }\n    }\n    else\n    {\n        for(int j = 0;j&lt;size;++j)\n        {\n            *(arr + j) = *(arr + j +1);\n        }\n    }\n    --size;\n    *ptr_size = size;\n    }\n\nint main()\n{\n    int size;\n\n    cout&lt;&lt;\"Enter size of array: \";\n\n    cin&gt;&gt;size;\n    int *ptr_size;\n    ptr_size = &amp;size;\n\n    int arr[size];\n\n    initialize_array(arr, size);\n\n    print_array(arr, size);\n\n    for(int i =1;size!=1;++i)\n    {\n        cout&lt;&lt;\"rotating\"&lt;&lt;endl;\n\n        rotate_clockwise(arr,size);\n\n        print_array(arr,size);\n\n        remove_ith_fend(i, arr, ptr_size);\n\n        cout&lt;&lt;\"removing \"&lt;&lt;i&lt;&lt;\"th element from the end\"&lt;&lt;endl;\n\n        print_array(arr,size);\n    }\n\n    return 0;\n} \n</code></pre>\n\n<p>I was only trying this out so I don't take input for test cases which they are giving in the question.\nSorry I have not commented the code but I was in the process of solving this and \nwas going to do it later after getting the solution right.</p>\n\n<p>Here is the error I was getting when I entered the array size: 54</p>\n\n<pre><code>Enter size of array: 54\n4741824 0 -1 0 4744768 0 4503683 0 1 0 4745728 0 8 0 4751362 0 4744784 0 \n7339432 0 7339436 0 1 0 0 0 -1 0 4741824 0 -1 0 4741824 0 10 0 4254288 \n16777216 0 54 8390488 0 224 0 -1 0 4200452 0 0 0 0 0 8 0\nrotating\n0 4741824 0 -1 0 4744768 0 4503683 0 1 0 4745728 0 8 0 4751362 0 4744784 0 \n7339432 0 7339436 0 1 0 0 0 -1 0 4741824 0 -1 0 4741824 0 10 0 4254288 \n16777216 0 54 8390488 0 224 0 -1 0 4200452 0 0 0 0 0 8\nremoving 1th element from the end\n</code></pre>\n\n<p>It didn't asked for any input and just exited after printing this thing above.\nAlso please point out some issues that I have with the way code is written as I am new to programming and like to learn the better way of writing.</p>\n\n<p>I just debugged the code using visual studio and it showed this message</p>\n\n<pre><code>Unhandled exception at 0x0000000000401632 in second.exe: 0xC0000005: Access \nviolation reading location 0x0000000000000000. occurred\n</code></pre>\n\n<p>name of the file is second.</p>\n\n<p>also the correct output should look like this:</p>\n\n<pre><code>Enter size of array: 6\n1 2 3 4 5 6\n1 2 3 4 5 6\nrotating\n6 1 2 3 4 5\nremoving 1th element from the end\n6 1 2 3 4\nrotating\n4 6 1 2 3\nremoving 2th element from the end\n4 6 1 3\nrotating\n3 4 6 1\nremoving 3th element from the end\n3 6 1\nrotating\n1 3 6\nremoving 4th element from the end\n3 6\nrotating\n6 3\nremoving 5th element from the end\n3\n</code></pre>\n\n<p>Did some more testing and found that it works for array size 8 and 10 but not for 7 and 9 and stops working for values greater than 10.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1534934435, "post_id": 51964963, "comment_id": 90879894, "body": "<i>&quot;My doubts is how am i calling a function on the &#39;b&#39; object which is not yet created in the constructor.&quot;</i> What makes you think it wasn&#39;t created?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 2, "creation_date": 1534934470, "post_id": 51964963, "comment_id": 90879918, "body": "For completeness also consider this alternative: <code>B() : s(fun()) {}</code>"}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1534935167, "post_id": 51964963, "comment_id": 90880289, "body": "Memory for local variables and objects in methods are created on the stack, a push operation occurs when entering the method and pop&#39;s when leaving the method.  Main is just another method.  Global data is created on the heap.  If a reference to &#39;new&#39; or one of the alloc functions is used then the returned pointer is created on the heap and its up to you to free or delete it when done."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1534935233, "post_id": 51964963, "comment_id": 90880328, "body": "If by &#39;Object&#39; you mean an artificial base class like in Java or Python, there is no such thing in C++"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 3, "creation_date": 1534935396, "post_id": 51964963, "comment_id": 90880419, "body": "@SPlatten 1) C++ standard doesn&#39;t define <code>stack</code>, nor <code>heap</code>. It&#39;s just a implementation detail, which, technically, can be different between compilers. 2) &quot;<i>Global data is created on the heap.</i>&quot; What makes you to say so?"}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1534935483, "post_id": 51964963, "comment_id": 90880464, "body": "@AlgirdasPreid\u017eius, yes it does, C++ is just C with bells on."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 2, "creation_date": 1534935658, "post_id": 51964963, "comment_id": 90880553, "body": "@SPlatten - C doesn&#39;t define it either..."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 1, "creation_date": 1534935868, "post_id": 51964963, "comment_id": 90880657, "body": "@SPlatten No it doesn&#39;t. And, no, it isn&#39;t. C++ standard only defines &quot;storage duration&quot;, and the expected behavior for each storage duration. How, exactly, it is implemented, is up to a specific compiler. If you are certain that it defines what a stack, and heap is (without talking about <code>std::stack</code> and family), please, provide me with a chapter in a standard, where it is done so."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1534937921, "post_id": 51964963, "comment_id": 90881749, "body": "Are you perhaps recovering from C# or Java, and assuming that there must be a <code>B()</code> somewhere for an object to be constructed? If so, you have a lot to unlearn."}], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 5, "last_activity_date": 1534934573, "creation_date": 1534934573, "answer_id": 51965069, "question_id": 51964963, "link": "https://stackoverflow.com/questions/51964963/how-memory-is-allocated-for-a-c-program/51965069#51965069", "title": "how memory is allocated for a c++ program", "body": "<p>By the moment object's constructor body starts executing, all the object's bases, direct, or, consequently, indirect, and members have already been initialized, either explicitly or implicitly. So <code>s</code> is a valid string object that can be quite legally a LHS of an assignment.</p>\n\n<p>One thing should probably be noticed here is, if you call a polymorphic class's virtual method from your constructor, then this, current, type's implementation is chosen, as any derived type has not been initialized yet so its overloads, if any, would be illegal to call.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1534936185, "last_edit_date": 1534936185, "creation_date": 1534934990, "answer_id": 51965200, "question_id": 51964963, "link": "https://stackoverflow.com/questions/51964963/how-memory-is-allocated-for-a-c-program/51965200#51965200", "title": "how memory is allocated for a c++ program", "body": "<blockquote>\n  <ol>\n  <li>In which sequence memory is allocated for data members('s' in this case).</li>\n  </ol>\n</blockquote>\n\n<p>Objects are always stored in a contiguous block of memory that cannot be resized. Therefore all sub-objects are allocated simultaneously when the super-object is allocated.</p>\n\n<p>Note that an object like <code>std::string</code> may also allocate a dynamic memory buffer which is separate from the memory of the object itself. The earliest time this memory can be allocated is within the constructor of the string. That said, an empty string needs no buffer, so that allocation can be delayed until later.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Does Object exist while calling fun() in the constructor.</li>\n  </ol>\n</blockquote>\n\n<p>No. The object doesn't exist completely yet. All of its memory has been before the constructor, and all of the sub objects will have been completely constructed before the constructor of the object. But the life time of an object starts when the constructor has finished. That said:</p>\n\n<blockquote>\n  <p>My doubt is how I am calling a function on the b object which is not yet created by the constructor.</p>\n</blockquote>\n\n<p>It is fine to call member functions within the constructor.</p>\n\n<p>You just have to make sure to not do anything that would rely on the constructor having been already executed, since it hasn't yet been executed. For example, if you specify a class invariant, that is established by the constructor, you then mustn't call any function that relies on that invariant before the invariant has been established.</p>\n\n<p>Note that member functions can also be called from the member initialization list. There, some sub-objects have not been initialized yet, so great care must be taken to not call such member functions that would access the uninitialized sub-objects.</p>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1534935678, "last_edit_date": 1534935678, "creation_date": 1534935359, "answer_id": 51965313, "question_id": 51964963, "link": "https://stackoverflow.com/questions/51964963/how-memory-is-allocated-for-a-c-program/51965313#51965313", "title": "how memory is allocated for a c++ program", "body": "<blockquote>\n  <ol>\n  <li>In which sequence memory is allocated for data members('s' in this case).</li>\n  <li>Does Object exist while calling fun() in the constructor.</li>\n  </ol>\n</blockquote>\n\n<p>To answer your questions, let us consult the CPP standard (N4713).\nSee the highlighted portion below:</p>\n\n<blockquote>\n  <p><strong>15.6.2 Initializing bases and members</strong><br>\n  ...<br>\n  13. In a non-delegating constructor, initialization proceeds in the following order:<br>\n  (13.1) \u2014 First, and only for the constructor of the most derived class (6.6.2), virtual base classes are initialized in the order they appear on a depth-first left-to-right traversal of the directed acyclic graph of base classes, where \u201cleft-to-right\u201d is the order of appearance of the base classes in the derived class base-specifier-list.<br>\n  (13.2) \u2014 Then, direct base classes are initialized in declaration order as they appear in the base-specifier-list (regardless of the order of the mem-initializers).<br>\n  (13.3) \u2014 <strong>Then, non-static data members are initialized in the order they were declared in the class definition (again regardless of the order of the mem-initializers)</strong>.<br>\n  (13.4) \u2014 <strong>Finally, the compound-statement of the constructor body is executed.</strong></p>\n</blockquote>\n\n<p>(13.3) answers 1. and (13.4) answers 2. By the time the constructor body is entered all non-static data members are initialized.</p>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1534937021, "creation_date": 1534937021, "answer_id": 51965783, "question_id": 51964963, "link": "https://stackoverflow.com/questions/51964963/how-memory-is-allocated-for-a-c-program/51965783#51965783", "title": "how memory is allocated for a c++ program", "body": "<blockquote>\n  <p>My doubt is how I am calling a function on the b object which is not yet created by the constructor.</p>\n</blockquote>\n\n<p>It <em>is</em> already created.</p>\n\n<p>All members are created before your constructor body begins.</p>\n\n<p>Otherwise the constructor body would be useless!</p>\n\n<p>On a philosophical point, this is why we should never say that <code>B b</code> \"calls the constructor\" (and this is particularly important when you're creating a temporary, like <code>B()</code>, which sort of <em>looks like</em> calling a function/constructor) &hellip; because, although the constructor is obviously involved, other stuff happens too, and some/most of it happens <em>first</em>.</p>\n"}], "owner": {"reputation": 105, "user_id": 6786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/decc4b5013e976e6511b9b38c000b278?s=128&d=identicon&r=PG&f=1", "display_name": "arvind", "link": "https://stackoverflow.com/users/6786120/arvind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "answer_count": 4, "score": 3, "last_activity_date": 1534943691, "creation_date": 1534934200, "last_edit_date": 1534943691, "question_id": 51964963, "link": "https://stackoverflow.com/questions/51964963/how-memory-is-allocated-for-a-c-program", "title": "how memory is allocated for a c++ program", "body": "<p>Consider the below program:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nclass B {\n  private:\n    std::string s;\n\n  public:\n    B() { s = fun(); }\n    std::string fun() { return \"hello\"; }\n    void print() {\n        std::cout &lt;&lt; s;\n    }\n};\n\nint main(){\n    B b;\n    b.print();\n}\n</code></pre>\n\n<p>The output is <code>Hello</code>  </p>\n\n<p>My Questions are:</p>\n\n<ol>\n<li>In which sequence memory is allocated for data members('s' in this case).</li>\n<li>Does Object exist while calling fun() in the constructor.</li>\n</ol>\n\n<p>My doubt is how I am calling a function on the <code>b</code> object which is not yet created by the constructor.</p>\n"}, {"tags": ["c++", "forward-declaration"], "answers": [{"comments": [{"owner": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "edited": false, "score": 1, "creation_date": 1534945910, "post_id": 51965076, "comment_id": 90887132, "body": "This solves the initial problem. However, there is another serious problem in the OP&#39;s code: it leaks memory quite badly. Every time there is a change of state, there is a new object being allocated on the heap, with the old object not being freed. It is worth pointing this serious issue out to the OP because it seems they&#39;re learning C++ (probably coming over from a language with garbage collection like Java or C#) and it would be better to set them straight while they&#39;re still in the learning stage."}, {"owner": {"reputation": 11, "user_id": 9274635, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--lYzLjm8S8k/AAAAAAAAAAI/AAAAAAAAAPo/Pxr3pNToW84/photo.jpg?sz=128", "display_name": "Gabi B", "link": "https://stackoverflow.com/users/9274635/gabi-b"}, "edited": false, "score": 0, "creation_date": 1535007298, "post_id": 51965076, "comment_id": 90909482, "body": "Thx, actualy I knew about that, but i was trying to follow  this <a href=\"http://www.cplusplus.com/articles/zAqpX9L8/\" rel=\"nofollow noreferrer\">this</a> tutorial and learning one pattern at time. And here comes the second question. What is better, using a singleton pattern for states or creating and destroying objects every time? I think first look way better but..."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1534934597, "creation_date": 1534934597, "answer_id": 51965076, "question_id": 51964931, "link": "https://stackoverflow.com/questions/51964931/why-doesnt-this-code-work-i-got-an-error-incomplete-type-or-does-not-name-a-t/51965076#51965076", "title": "Why doesn&#39;t this code work? I got an error: incomplete type or does not name a type", "body": "<p>To create an instance of a class (like you do with <code>new on</code>) you need the <em>full</em> definition. But at that point in the source code you don't have the full definition of the class <code>on</code>, only the forward declaration.</p>\n\n<p>The common solution is to split the class into the class definition, and the member function definitions.</p>\n\n<p>Like e.g.</p>\n\n<pre><code>// Define the class\nclass off:public state{\npublic:\n    void t_on();\n    void t_off();\n    void handle();\n};\n\n// Define the class and its member functions\nclass on:public state{\n    public:\n    void t_on(){\n        std::cout &lt;&lt; \"cant is on\\n\";\n    }\n    void t_off(){\n        std::cout &lt;&lt; \"off\\n\";\n    }\n    void handle(){\n        std::cout &lt;&lt; \"handle to off\";\n        _context-&gt;setState( new off );  // Can use off because it's fully defined\n    }\n};\n\n// Define the member function of the class off\ninline void off::t_on(){\n    std::cout &lt;&lt; \"on\\n\";\n}\n\ninline void off::t_off(){\n    std::cout &lt;&lt; \"cant is off\\n\";\n}\n\ninline void off::handle(){\n    std::cout &lt;&lt; \"handle to on\";\n    _context-&gt;setState( new on );  // Can use on because it's fully defined\n}\n</code></pre>\n\n<p>With the above code, when the class <code>on</code> and its member functions are defined, the class <code>off</code> will be fully defined. Then later when defining the member functions of <code>off</code> then you will also have the full definition of the <code>on</code> class.</p>\n"}], "owner": {"reputation": 11, "user_id": 9274635, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--lYzLjm8S8k/AAAAAAAAAAI/AAAAAAAAAPo/Pxr3pNToW84/photo.jpg?sz=128", "display_name": "Gabi B", "link": "https://stackoverflow.com/users/9274635/gabi-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534944697, "creation_date": 1534934071, "last_edit_date": 1534944697, "question_id": 51964931, "link": "https://stackoverflow.com/questions/51964931/why-doesnt-this-code-work-i-got-an-error-incomplete-type-or-does-not-name-a-t", "title": "Why doesn&#39;t this code work? I got an error: incomplete type or does not name a type", "body": "<p>Why don't forward declarations work? I didn't implement any pointers in the constructor so it should work. So why doesn't it?</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nclass foo;\n/*if i use this 2 lines i got first error if not the second one. How do i solve this? */\nclass on;\nclass off;\n\nclass state{\nprotected:    \n    foo *_context;\npublic:\n    virtual void t_on() = 0;\n    virtual void t_off() = 0;\n    virtual void handle() = 0;\n};\n\nclass foo{\n    private:\n        state *_current;\n    public:\n    void setState( state* st){\n        _current = st;\n    }\n    void on(){\n        _current-&gt;t_on();\n    }\n    void off(){\n        _current-&gt;t_off();\n    }\n\n    void handle(){\n        _current-&gt;handle();\n    }\n};\nclass off:public state{\n      void t_on(){\n        std::cout &lt;&lt; \"on\\n\";\n    }\n    void t_off(){\n        std::cout &lt;&lt; \"cant is off\\n\";\n    }\n     void handle(){\n        std::cout &lt;&lt; \"handle to on\";\n        _context-&gt;setState( new on );\n    }\n};\nclass on:public state{\n    public:\n    void t_on(){\n        std::cout &lt;&lt; \"cant is on\\n\";\n    }\n    void t_off(){\n        std::cout &lt;&lt; \"off\\n\";\n    }\n    void handle(){\n        std::cout &lt;&lt; \"handle to off\";\n        _context-&gt;setState( new off );\n    }\n};\n\n\nint main ()\n{\n    foo asd;\n    asd.setState(new on);\n    asd.on();\n    asd.off();\n    return 0;\n}\n</code></pre>\n\n<p>I tried to implement state pattern in c++ but I can't understand how these pointers work.</p>\n\n<h2>with</h2>\n\n<pre><code>class on; \nclass off; \n</code></pre>\n\n<hr>\n\n<p>this is happening when i try to use forward declaration. </p>\n\n<pre><code>main.cpp: In member function 'virtual void off::handle()':\nmain.cpp:45:28: error: invalid use of incomplete type 'class on'\n    _context-&gt;setState( new on );\n                            ^\nmain.cpp:6:8: note: forward declaration of 'class on'\n  class on;\n</code></pre>\n\n<p>If I got this error for class on then why does class off work? </p>\n\n<h2>without</h2>\n\n<p>and this when I'm now</p>\n\n<pre><code>main.cpp: In member function 'virtual void off::handle()':\nmain.cpp:53:28: error: 'on' does not name a type\n    _context-&gt;setState( new on );\n                            ^\n</code></pre>\n"}, {"tags": ["c++", "operators", "shared-ptr", "realsense", "c-api"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1534934172, "post_id": 51964924, "comment_id": 90879773, "body": "It&#39;s a <a href=\"https://en.cppreference.com/w/cpp/language/cast_operator\" rel=\"nofollow noreferrer\"><i>user-defined conversion operator</i></a>, also known as a &quot;cast operator&quot;."}, {"owner": {"reputation": 19, "user_id": 7259491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0efa2490c60b085fc2c828ca8db7fea6?s=128&d=identicon&r=PG&f=1", "display_name": "daKenpachi", "link": "https://stackoverflow.com/users/7259491/dakenpachi"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1534947170, "post_id": 51964924, "comment_id": 90887956, "body": "Thanks, now I know what it is! =) In fact, my first try was just writing <code>config.can_resolve(pipeline)</code> without fully understanding what it is. But it didnt&#180;work because my <code>pipline</code> was a pointer, so so the compiler said the types are incompetible....   Now it works with <code>config.can_resolve(*pipline)</code>"}], "owner": {"reputation": 19, "user_id": 7259491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0efa2490c60b085fc2c828ca8db7fea6?s=128&d=identicon&r=PG&f=1", "display_name": "daKenpachi", "link": "https://stackoverflow.com/users/7259491/dakenpachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1534934142, "answer_count": 0, "score": 0, "last_activity_date": 1534934161, "creation_date": 1534934053, "question_id": 51964924, "link": "https://stackoverflow.com/questions/51964924/operator-shared-ptr-method-access-librealsense", "closed_reason": "Duplicate", "title": "&quot;operator shared_ptr&quot; method access? (librealsense)", "body": "<p>I\u00b4m currently trying to wrap the <a href=\"https://github.com/IntelRealSense/librealsense/tree/master/include\" rel=\"nofollow noreferrer\">LibRealsense</a> into a Unreal 4 Plugin. This lib provides some C API as well as some C++ API (wrapping it\u00b4s C API), so I\u00b4m doing C++ (which makes sense for Unreal).</p>\n\n<p>But there is a kind of operator overloading I\u00b4ve never seen before (in <a href=\"https://github.com/IntelRealSense/librealsense/blob/master/include/librealsense2/hpp/rs_pipeline.hpp#L508\" rel=\"nofollow noreferrer\">rs_pipeline.hpp</a>):</p>\n\n<pre><code>class pipeline\n{\npublic:\n\n    pipeline(context ctx = context())\n...\n    operator std::shared_ptr&lt;rs2_pipeline&gt;() const\n    {\n        return _pipeline;\n    }\n\nprivate:\n    context _ctx;\n    std::shared_ptr&lt;rs2_pipeline&gt; _pipeline;\n}\n</code></pre>\n\n<p><code>rs2_pipeline</code> is the C-type of a pipeline, it is accessed in all the c++ classes as a shared pointer. E.g:</p>\n\n<pre><code> class config\n {\n public:\n ...\n     bool can_resolve(std::shared_ptr&lt;rs2_pipeline&gt; p) const\n ...\n }\n</code></pre>\n\n<p>So when I\u00b4m trying to call <code>config.can_resolve</code> with my C++ \u00b4pipeline\u00b4\n object, I need to get the internal <code>shared_ptr&lt;rs_pipline&gt;</code>. But how do I call <code>operator shared_ptr&lt;rs_pipline()</code>?? And what kind of operator is it exactly? </p>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 2, "creation_date": 1534933976, "post_id": 51964693, "comment_id": 90879675, "body": "use a larger range for the H value"}, {"owner": {"reputation": 103, "user_id": 9534874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/9534874/james"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1534936485, "post_id": 51964693, "comment_id": 90880952, "body": "@Miki thanks, much better."}, {"owner": {"reputation": 289, "user_id": 1553872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0f74dc62b1c07d1fcf04f5519b4e34?s=128&d=identicon&r=PG", "display_name": "seokrae.kim", "link": "https://stackoverflow.com/users/1553872/seokrae-kim"}, "edited": false, "score": 0, "creation_date": 1534993805, "post_id": 51964693, "comment_id": 90905491, "body": "how about LAB colorspace?"}], "owner": {"reputation": 103, "user_id": 9534874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/9534874/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534933122, "creation_date": 1534933122, "question_id": 51964693, "link": "https://stackoverflow.com/questions/51964693/opencv-can-not-detect-specific-color-well", "title": "OpenCV can not detect specific color well", "body": "<p><a href=\"https://i.stack.imgur.com/YQUcc.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YQUcc.gif\" alt=\"before\"></a></p>\n\n<p>this is the one not applying the mask</p>\n\n<p><a href=\"https://i.stack.imgur.com/3UlHz.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3UlHz.gif\" alt=\"after\"></a></p>\n\n<p>this is the one applying the mask</p>\n\n<p>Even though it detects vaguely, I want to make it more clear.</p>\n\n<pre><code>void MainWindow::updatePicture(){\n    Mat frame;\n    Mat blurred;\n    Mat grayBlurred;\n    Mat hsvBlurred;\n    Mat diff;\n    Mat movingObjectMask;\n    Mat colorMask;\n    Mat result;\n    this-&gt;cap.read(frame);\n    blur(frame, blurred, Size(this-&gt;kernel, this-&gt;kernel)); // blur the frame\n    cvtColor(blurred, grayBlurred, COLOR_BGR2GRAY); // convert to gray\n    /* make a mask that finds a moving object */\n    absdiff(this-&gt;previous, grayBlurred, diff); // compare it with previous frame which was blurred and converted to gray\n    threshold(diff, movingObjectMask, this-&gt;thresholdVal, 255, THRESH_BINARY); // binarize it\n    cvtColor(movingObjectMask, movingObjectMask, COLOR_GRAY2BGR);\n    /* make a mask that finds a specific color */\n    cvtColor(blurred, hsvBlurred, COLOR_BGR2HSV); // convert to HSV to track a color\n    inRange(hsvBlurred, this-&gt;hsvLowerBound, this-&gt;hsvUpperBound, colorMask); // track the color\n    cvtColor(colorMask, colorMask, COLOR_GRAY2BGR);\n    /* apply the masks */\n    bitwise_and(frame, movingObjectMask, result);\n    bitwise_and(result, colorMask, result);\n    cvtColor(result, result, COLOR_BGR2RGB);\n    /* end */\n    this-&gt;myLabel-&gt;setPixmap(mat2QPixmap(result, QImage::Format_RGB888));\n    this-&gt;previous = grayBlurred;\n}\n</code></pre>\n\n<p>As you can see in the code, I make two masks that detect a moving object and a specific color(technically colors in a specific range).</p>\n\n<p>Upper and lower hsv range were calculated like below.</p>\n\n<pre><code>void MainWindow::refreshRgb(){\n    Scalar lowerBound = hsvMult(this-&gt;currentHsv, 1 - this-&gt;ratio);\n    Scalar upperBound = hsvMult(this-&gt;currentHsv, 1 + this-&gt;ratio);\n    this-&gt;hsvLowerBound = lowerBound;\n    this-&gt;hsvUpperBound = upperBound;\n}\n\nScalar hsvMult(const Scalar&amp; scalar, double ratio){\n    int s = static_cast&lt;int&gt;(scalar[1]*ratio);\n    int v = static_cast&lt;int&gt;(scalar[2]*ratio);\n    if(s &gt; 255)\n        s = 255;\n    if(v &gt; 255)\n        v = 255;\n    return Scalar(static_cast&lt;int&gt;(scalar[0]), s, v);\n}\n</code></pre>\n\n<p>How can I make it more clear?</p>\n"}, {"tags": ["c++", "opencv", "image-processing"], "comments": [{"owner": {"reputation": 2932, "user_id": 7212809, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VlOyJEUeeSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jExBae7iJ2ALFtcMj_6BCoHGTMgw/mo/photo.jpg?sz=128", "display_name": "nz_21", "link": "https://stackoverflow.com/users/7212809/nz-21"}, "edited": false, "score": 0, "creation_date": 1534932718, "post_id": 51964523, "comment_id": 90878977, "body": "If you have a large dataset of images you want to match against, you could train a CNN."}, {"owner": {"reputation": 846, "user_id": 385390, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b41a2fc080cdea0887394c53f4108dfb?s=128&d=identicon&r=PG", "display_name": "bliako", "link": "https://stackoverflow.com/users/385390/bliako"}, "reply_to_user": {"reputation": 2932, "user_id": 7212809, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VlOyJEUeeSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jExBae7iJ2ALFtcMj_6BCoHGTMgw/mo/photo.jpg?sz=128", "display_name": "nz_21", "link": "https://stackoverflow.com/users/7212809/nz-21"}, "edited": false, "score": 0, "creation_date": 1534933313, "post_id": 51964523, "comment_id": 90879316, "body": "I do have a very large dataset but it is not labelled. Is there CNN flavour which is self-organised?"}], "answers": [{"comments": [{"owner": {"reputation": 846, "user_id": 385390, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b41a2fc080cdea0887394c53f4108dfb?s=128&d=identicon&r=PG", "display_name": "bliako", "link": "https://stackoverflow.com/users/385390/bliako"}, "edited": false, "score": 0, "creation_date": 1535034869, "post_id": 51964887, "comment_id": 90926088, "body": "Thanks for the hints. Maybe I can cut N random, small patches from each image and try template-matching them with every other image. The number of matches would give me an indication of similarity. WITHOUT having to create any labels for a training set. What worries me is the computational burden of the above for 13,000 images."}], "tags": [], "owner": {"reputation": 491, "user_id": 5772210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXwRX.jpg?s=128&g=1", "display_name": "Spoonless", "link": "https://stackoverflow.com/users/5772210/spoonless"}, "is_accepted": false, "score": 1, "last_activity_date": 1534933919, "creation_date": 1534933919, "answer_id": 51964887, "question_id": 51964523, "link": "https://stackoverflow.com/questions/51964523/find-similar-large-patterns-in-images/51964887#51964887", "title": "Find similar (large) patterns in images", "body": "<p>If you know patterns you're looking for a priori, you can do old school template matching. It may not be as trendy as deep learning techniques but for constrained problems can be effective.</p>\n\n<ol>\n<li>Load in your N templates </li>\n<li>Load in the image you want to test against. </li>\n<li>Normalise the image and templates (possibly including\nconversion to grayscale and some histogram and white balance\nequilisation) </li>\n<li>Create some M perturbations of each template (ie,\ndifferent scales, rotations, and perspective transforms) </li>\n<li>Do template between between your NxM templates and your image.</li>\n</ol>\n\n<p>You can optimise the above slightly by doing the <a href=\"https://stackoverflow.com/questions/6944775/template-matching-using-fft\">template matching in the Fourier domain</a> since you only need to do the 2D FFT of the image once. You can also precalculate and store the pertubations - or better yet: store their Fourier transforms.</p>\n"}], "owner": {"reputation": 846, "user_id": 385390, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b41a2fc080cdea0887394c53f4108dfb?s=128&d=identicon&r=PG", "display_name": "bliako", "link": "https://stackoverflow.com/users/385390/bliako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1534933919, "creation_date": 1534932522, "question_id": 51964523, "link": "https://stackoverflow.com/questions/51964523/find-similar-large-patterns-in-images", "title": "Find similar (large) patterns in images", "body": "<p>I have images with repeated patterns in them. I would like to find similar images based on having similar patterns.</p>\n\n<p>The patterns are made of crosses, triangles, squares which are combined to form more complicated structures made of those \"primitive shapes\". For example, imagine a cross made of triangles or hexagons etc.</p>\n\n<p>These decorations are found in wallpapers, carpets, kilims, wool sweaters and even some paintings.</p>\n\n<p>An example image from wikipedia is <a href=\"https://en.wikipedia.org/wiki/Sweater#/media/File:Selburose-sweater.jpg\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>My typical application is to find, say, sweaters with similar patterns in them. Ignoring colour for the moment.</p>\n\n<p>I have tried to extract SIFT descriptors (using C++ and OpenCV) and match these between two images. However, they match tiny areas e.g. the vertex of a hexagon and a triangle but ideally I would like to match the actual shapes of the triangle and rectangle.</p>\n\n<p>It works a bit better if I scaled down the images but still I sense I need a different approach than SIFT and friends.</p>\n\n<p>Can anyone suggest other methods for these kind of problems?</p>\n"}, {"tags": ["c++", "visual-studio", "cmake"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1534932578, "post_id": 51964461, "comment_id": 90878915, "body": "Hi. Once a CMake-using library is built &amp; installed, it does not differ from any other non-CMake library (at least when the consuming project doesn&#39;t use CMake). Can you elaborate on why CMake is causing issues for you, and how you feel it differs from using a non-CMake library?"}, {"owner": {"reputation": 3874, "user_id": 9624452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Konrad Botor", "link": "https://stackoverflow.com/users/9624452/konrad-botor"}, "edited": false, "score": 0, "creation_date": 1534932940, "post_id": 51964461, "comment_id": 90879106, "body": "I get the feeling that OP wants to add the Cmake project to a pre-existing VS solution rather than simply use a pre-built library."}, {"owner": {"reputation": 340, "user_id": 10259066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZVBX.png?s=128&g=1", "display_name": "DaanV", "link": "https://stackoverflow.com/users/10259066/daanv"}, "edited": false, "score": 0, "creation_date": 1534944093, "post_id": 51964461, "comment_id": 90885847, "body": "well either, I get the part that Visual studio cant add it to another solution just yet, maybe in the future. but visual studio is not allowing me to add the .lib that is generated or add the &lt;name.h&gt; is that is usually available for C++ projects"}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 3903733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333498948680f972d15f44f749e16bc4?s=128&d=identicon&r=PG&f=1", "display_name": "amida", "link": "https://stackoverflow.com/users/3903733/amida"}, "is_accepted": false, "score": 0, "last_activity_date": 1534940741, "creation_date": 1534940741, "answer_id": 51966864, "question_id": 51964461, "link": "https://stackoverflow.com/questions/51964461/how-to-include-cmake-lib-projects-in-other-visual-studio-projects/51966864#51966864", "title": "How to include CMake lib/projects in other Visual Studio projects?", "body": "<p>You could use cmake to generate a Visual Studio project and then add that project to your solution.</p>\n"}], "owner": {"reputation": 340, "user_id": 10259066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZVBX.png?s=128&g=1", "display_name": "DaanV", "link": "https://stackoverflow.com/users/10259066/daanv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534940741, "creation_date": 1534932325, "last_edit_date": 1534932676, "question_id": 51964461, "link": "https://stackoverflow.com/questions/51964461/how-to-include-cmake-lib-projects-in-other-visual-studio-projects", "title": "How to include CMake lib/projects in other Visual Studio projects?", "body": "<p>I don't have any experience with CMake, but I downloaded an API from Github that was CMake-based.</p>\n\n<p>I can build it in Visual Studio and I did the Install in CMake menu. \nBut can I cannot seem to add the CMake library in any of my other projects (C++ projects). I have tried looking all around but in all documentation there seems to be no answer (or at least simple answer).</p>\n"}, {"tags": ["c++", "algorithm", "c++11", "hash", "hashmap"], "comments": [{"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1534932808, "post_id": 51964419, "comment_id": 90879031, "body": "What would be the answer for your example? <code>1=&gt;1</code>?"}, {"owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "reply_to_user": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1534933059, "post_id": 51964419, "comment_id": 90879170, "body": "The answer here is <code>false</code> since all of the keys and their corresponding values are not identical in any of the two elements."}, {"owner": {"reputation": 1830, "user_id": 1927794, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b7b26bda58eac7f333cc428421a711cd?s=128&d=identicon&r=PG", "display_name": "Arkady", "link": "https://stackoverflow.com/users/1927794/arkady"}, "edited": false, "score": 0, "creation_date": 1534933403, "post_id": 51964419, "comment_id": 90879363, "body": "create fast simple hash for each set. And if hashes are equal -- do pairwise comparation. You can&#39;t avoid checking each value of each set (because it may violate the answer), so you will do it: by hash creation. But you will avoid pairwise comparation for most of the cases, doing it just when hash is equal.\\"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 5, "creation_date": 1534933479, "post_id": 51964419, "comment_id": 90879403, "body": "Note that you can specify a custom hasher and/or equality comparator as template arguments to both <code>std::set</code> and <code>std::unordered_map</code>, so inheritance is unnecessary."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1534934185, "post_id": 51964419, "comment_id": 90879782, "body": "(publicly) inheriting from <code>std</code> containers is almost never a good idea. Its lots of text and I find it hard to follow, but I think all you need is a custom comparator. &quot;the problem here is that the object to be inserted into the set must have the comparison operators overloaded&quot; - thats not true, you can use any comparator you like, its the second template parameter of <code>std::set</code>"}, {"owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1534936989, "post_id": 51964419, "comment_id": 90881246, "body": "How can I specify a custom hasher and/or equality comparator as template arguments?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1534937666, "post_id": 51964419, "comment_id": 90881614, "body": "@anilbey hash functor is the second template argument of unordered set. Comparison functor is the second template argument of the ordered set."}], "answers": [{"comments": [{"owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1534949861, "post_id": 51969215, "comment_id": 90889809, "body": "Could you give me some ideas about how to compute the hash for multiple keys?"}, {"owner": {"reputation": 406, "user_id": 2102925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/582cb201d06c59f1521cbe4e2a5667c3?s=128&d=identicon&r=PG", "display_name": "AdityaG", "link": "https://stackoverflow.com/users/2102925/adityag"}, "reply_to_user": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1534950262, "post_id": 51969215, "comment_id": 90890048, "body": "if u are using boost .. boost hash combine exist .. otherwise look here <a href=\"https://stackoverflow.com/questions/17016175/c-unordered-map-using-a-custom-class-type-as-the-key\" title=\"c unordered map using a custom class type as the key\">stackoverflow.com/questions/17016175/&hellip;</a>"}, {"owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1535016718, "post_id": 51969215, "comment_id": 90914692, "body": "One detail: since the order is not preserved in unordered_maps, the maps a and d below will result in different hash values unless I sort them. Maybe I should use std::map instead. <code>unordered_map&lt;u_int,int&gt; a = { {1,1}, {2,4}, {3,5} }; unordered_map&lt;u_int,int&gt; d = { {2,4}, {1,1}, {3,5} };</code>"}, {"owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1535016789, "post_id": 51969215, "comment_id": 90914739, "body": "Actually, if I hash an unordered map twice. Then I am sure I will get different hash values because the ordering of the keys will be different each time I iterate over the keys."}, {"owner": {"reputation": 406, "user_id": 2102925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/582cb201d06c59f1521cbe4e2a5667c3?s=128&d=identicon&r=PG", "display_name": "AdityaG", "link": "https://stackoverflow.com/users/2102925/adityag"}, "reply_to_user": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1535028051, "post_id": 51969215, "comment_id": 90921408, "body": "good point ... yes ... you will get a different hash .. then the way as you said is use a set .. !"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 1, "creation_date": 1546470644, "post_id": 51969215, "comment_id": 94865851, "body": "@anilbey Just to be extremely pedantic: It&#39;s not at all guaranteed that &quot;the ordering of the keys will be different each time&quot;. The <code>unordered</code> does not mean &#39;<i>elements are guaranteed <b>never</b> to be in the same order</i>&#39;... It means &#39;<i>elements are <b>not</b> guaranteed to be in any specific/repeatable order</i>&#39;."}, {"owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1546512050, "post_id": 51969215, "comment_id": 94877250, "body": "@underscore_d you&#39;re right. The order does not necessarily have to be different each time."}], "tags": [], "owner": {"reputation": 406, "user_id": 2102925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/582cb201d06c59f1521cbe4e2a5667c3?s=128&d=identicon&r=PG", "display_name": "AdityaG", "link": "https://stackoverflow.com/users/2102925/adityag"}, "is_accepted": false, "score": 1, "last_activity_date": 1534948341, "creation_date": 1534948341, "answer_id": 51969215, "question_id": 51964419, "link": "https://stackoverflow.com/questions/51964419/how-to-detect-duplicates-in-a-vector-of-unordered-map/51969215#51969215", "title": "How to detect duplicates in a vector of unordered_map?", "body": "<p>you can something similar to the following : </p>\n\n<pre><code>typedef unordered_map&lt;u_int,int&gt; int_map;\n\nstruct my_map_comparator\n{\n    bool operator()(const int_map&amp; a, const int_map&amp; b) \n    { \n      a_hash = compute_hash_for_a(all keys of a)\n      b_hash = compute_hash_for_b(all keys of b)\n\n      return a_hash == b_hash; \n    }\n};\n\nstd::unordered_set&lt;int_map,std::hash&lt;int_map&gt;, my_map_comparator&gt; map_list();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1535016961, "post_id": 51974197, "comment_id": 90914849, "body": "But even if I have a good hash function, each time I hash the <code>unordered_map</code>, I am sure I will get a different hash value because the keys are not ordered. e.g. each time I iterate over the keys, I see a different order."}, {"owner": {"reputation": 956, "user_id": 6449949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a920ba06a595d7137a076ab1de7425?s=128&d=identicon&r=PG&f=1", "display_name": "paler123", "link": "https://stackoverflow.com/users/6449949/paler123"}, "reply_to_user": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1535017490, "post_id": 51974197, "comment_id": 90915171, "body": "Well, since the map is unordered then ordering should not really affect the hashes you get. In other words if two maps are considered equal (by explicit check with == op) then they must have equal hashes. A valid hash function needs to produce equal hashes for equal elements, a good hash function should produce different hashes for different elements."}, {"owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1535038795, "post_id": 51974197, "comment_id": 90928657, "body": "I cannot think of an efficient way of implementing a hash function achieving this without having to sort the keys. If the sorting is inevitable, then I prefer storing the data in a <code>map</code> in the first place (instead of <code>unordered_map</code>). What do you think?"}, {"owner": {"reputation": 956, "user_id": 6449949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a920ba06a595d7137a076ab1de7425?s=128&d=identicon&r=PG&f=1", "display_name": "paler123", "link": "https://stackoverflow.com/users/6449949/paler123"}, "reply_to_user": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "edited": false, "score": 0, "creation_date": 1535049355, "post_id": 51974197, "comment_id": 90934108, "body": "You would then need to order the maps (e.g. implement comparison operator of some sort). Equality is quite straightforward to define for unordered_maps, I don&#39;t see however a universally good approach to ordering them. As for the hash function... You could use any hash on key / value pairs from the map and then accumulate them in a way that does not depend on the ordereing (e.g. product or sum have that property)."}], "tags": [], "owner": {"reputation": 956, "user_id": 6449949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a920ba06a595d7137a076ab1de7425?s=128&d=identicon&r=PG&f=1", "display_name": "paler123", "link": "https://stackoverflow.com/users/6449949/paler123"}, "is_accepted": false, "score": 1, "last_activity_date": 1535010123, "last_edit_date": 1535010123, "creation_date": 1534967635, "answer_id": 51974197, "question_id": 51964419, "link": "https://stackoverflow.com/questions/51964419/how-to-detect-duplicates-in-a-vector-of-unordered-map/51974197#51974197", "title": "How to detect duplicates in a vector of unordered_map?", "body": "<p>If you can get a good hash function for std::unordered_map then you should do it like this probably:</p>\n\n<pre><code>bool has_distinct_values(const std::vector&lt;std::unordered_map&lt;u_int, int&gt;&gt; v)\n{\n  std::unordered_map&lt;int, std::list&lt;int&gt;&gt; hash_to_indexes_map; \n  for(auto i = 0u; i &lt; v.size(); ++i)\n  {\n    auto empl_result = hash_to_index_map.emplace(custom_hash(v[i]), {i});\n    if (!empl_result.second)\n    {  \n       for (auto index : empl_result.first-&gt;second)\n       {\n         if (v[index] == v[i]) return false;\n       }\n       epmpl_result.first-&gt;second.push_back(i);\n    }\n  }\n  return true;\n}\n</code></pre>\n\n<p>The algorithm is straightforward: map hashes to list indexes, doing pairwise map comparison whenever hashes are equal.\nThis way you avoid copying the entire maps, get O(N) (depending mostly on the quality of the hash function you provide) time complexity and generally are good to go.</p>\n"}], "owner": {"reputation": 1286, "user_id": 1935611, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1abf5b5c23043f42b90b10252fc236f3?s=128&d=identicon&r=PG", "display_name": "anilbey", "link": "https://stackoverflow.com/users/1935611/anilbey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1751, "favorite_count": 4, "answer_count": 2, "score": 1, "last_activity_date": 1535010123, "creation_date": 1534932176, "last_edit_date": 1534933340, "question_id": 51964419, "link": "https://stackoverflow.com/questions/51964419/how-to-detect-duplicates-in-a-vector-of-unordered-map", "title": "How to detect duplicates in a vector of unordered_map?", "body": "<p>Given a <code>vector</code> of <code>unordered_map&lt;u_int,int&gt;</code>,\nI would like to check if the <code>vector</code> contains any duplicated values. Two unordered_maps are considered duplicated if all of their keys and their corresponding values are equal. \nI know the comparison operator exists for <code>unordered_maps</code>, but I would like to avoid the pairwise comparison of each element with each other. One classical solution is to insert the values of the <code>vector</code> into a <code>set</code>, then to compare the number of elements in the <code>set</code> and the <code>vector</code>.\nHowever, the problem here is that the object to be inserted into the <code>set</code> must have the comparison operators overloaded. In case of the <code>unordered_set</code>, the hash function to be used must be overloaded for the complex object. In order to overload, I need to derive a class from the <code>std::unordered_map</code>. Then I need to overload either the comparison operator or the hash function. Another solution that I could think of is to concatenate all of the key value pairs into a string, then sort the string by the keys and detect the duplicates on those strings. I wonder what would be the best solution for this problem.\n<br> Example data:</p>\n\n<pre><code>using namespace std;\ntypedef unordered_map&lt;u_int,int&gt; int_map;\nint_map a = { {1,1}, {2,4}, {3,5} };\nint_map b = { {1,1}, {2,-1}, {4,-2} };\nint_map c = { {1,1}, {3,5} };\n\nvector&lt;unordered_map&lt;u_int,int&gt;&gt; my_vec;\n\nmy_vec.push_back(a);\nmy_vec.push_back(b);\nmy_vec.push_back(c);\n</code></pre>\n\n<p>The contents of <code>my_vec</code> is:</p>\n\n<pre><code> { { 1 =&gt; 1, 2 =&gt; 4, 3 =&gt; 5 }, \n { 1 =&gt; 1, 2 =&gt; -1, 4 =&gt; -2 }, \n { 1 =&gt; 1, 3 =&gt; 5 } }\n</code></pre>\n\n<p>Please feel free to ask/commend/edit if the question is not clear enough.\nAny help would be appreciated. Thank you in advance!</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "edited": false, "score": 3, "creation_date": 1534931841, "post_id": 51964230, "comment_id": 90878509, "body": "<a href=\"https://stackoverflow.com/questions/2769174/determining-if-an-unordered-vectort-has-all-unique-elements\" title=\"determining if an unordered vectort has all unique elements\">stackoverflow.com/questions/2769174/&hellip;</a>"}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "reply_to_user": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "edited": false, "score": 0, "creation_date": 1534931958, "post_id": 51964230, "comment_id": 90878568, "body": "@EdgarRokj\u0101n: I suppose this means the answer is &quot;No there isn&#39;t&quot;...;-)"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1534931965, "post_id": 51964230, "comment_id": 90878573, "body": "Such a function would be O(n^2), that&#39;s probably why there is none."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 2, "creation_date": 1534932210, "post_id": 51964230, "comment_id": 90878716, "body": "@alain Do you mean naive implementation? For with additional hashset it runs in average O(N), with O(N) space."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1534932270, "post_id": 51964230, "comment_id": 90878750, "body": "@JesperJuhl That is one option, not the best in time but the best in space, albeit destructive."}, {"owner": {"reputation": 16382, "user_id": 5507349, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IaCUb.jpg?s=128&g=1", "display_name": "Edgar Rokj\u0101n", "link": "https://stackoverflow.com/users/5507349/edgar-rokj%c4%81n"}, "edited": false, "score": 0, "creation_date": 1534937205, "post_id": 51964230, "comment_id": 90881362, "body": "@jpo38 yes, precisely :)"}, {"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1534943926, "post_id": 51964230, "comment_id": 90885732, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2769174/determining-if-an-unordered-vectort-has-all-unique-elements\">Determining if an unordered vector&lt;T&gt; has all unique elements</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 1, "creation_date": 1534932509, "post_id": 51964476, "comment_id": 90878881, "body": "I&#39;m not asking how to &quot;check if a container has duplicates&quot;....there&#39;s many ways to do that (using adjacent_find is one of them). I&#39;m looking for a function taking two iterators and returning true/false...."}, {"owner": {"reputation": 121, "user_id": 8640175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb1f63ff92e59ffd12ea9fd75a17308?s=128&d=identicon&r=PG", "display_name": "Ch1v1", "link": "https://stackoverflow.com/users/8640175/ch1v1"}, "reply_to_user": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1534932798, "post_id": 51964476, "comment_id": 90879023, "body": "Then I will say there are any like you are looking for."}], "tags": [], "owner": {"reputation": 121, "user_id": 8640175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb1f63ff92e59ffd12ea9fd75a17308?s=128&d=identicon&r=PG", "display_name": "Ch1v1", "link": "https://stackoverflow.com/users/8640175/ch1v1"}, "is_accepted": false, "score": 2, "last_activity_date": 1534933323, "last_edit_date": 1534933323, "creation_date": 1534932365, "answer_id": 51964476, "question_id": 51964230, "link": "https://stackoverflow.com/questions/51964230/c-stl-which-algorithm-should-i-use-to-check-if-a-container-has-duplicates/51964476#51964476", "title": "C++/STL which algorithm should I use to check if a container has duplicates?", "body": "<p>The only thing I can thing is <a href=\"https://en.cppreference.com/w/cpp/algorithm/adjacent_find\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/algorithm/adjacent_find</a>, but it requires that the elements are sorted as it will check in the adjacent element.</p>\n\n<p>EDIT:</p>\n\n<p>There is no stl algorithm that can do that as you ask, the other alternative is use std::any_of.</p>\n"}, {"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1534933085, "post_id": 51964666, "comment_id": 90879178, "body": "You could simplify by passing the iterators directly into the constructor of the set."}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 1, "creation_date": 1534933308, "post_id": 51964666, "comment_id": 90879311, "body": "That&#39;s what I said in the &quot;Note&quot; of my question."}], "tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": false, "score": 0, "last_activity_date": 1534933341, "last_edit_date": 1534933341, "creation_date": 1534933018, "answer_id": 51964666, "question_id": 51964230, "link": "https://stackoverflow.com/questions/51964230/c-stl-which-algorithm-should-i-use-to-check-if-a-container-has-duplicates/51964666#51964666", "title": "C++/STL which algorithm should I use to check if a container has duplicates?", "body": "<p>One way of doing this is to use std::set.</p>\n\n<p>Copy your vector into the set and compare if the number of elements are the same.</p>\n\n<p>If yes you have no duplicate, if no you can guess the number of duplicates.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;vector&gt;\n#include &lt;set&gt;\nint has_duplicate(const std::vector&lt;int&gt; &amp; v)\n{\n    std::set&lt;int&gt; s(v.begin(), v.end());\n    return v.size() - s.size();\n}\n\nint\nmain()\n{\n\n    std::vector&lt;int&gt; v1{ 1, 2, 3 };\n    std::vector&lt;int&gt; v2{ 1, 2, 1 };\n    std::cout &lt;&lt; has_duplicate(v1) &lt;&lt; std::endl;\n    std::cout &lt;&lt; has_duplicate(v2) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>for v1 the output is 0 -> you have no duplicate\nfor v2 the output is 1 -> you have one duplicate</p>\n\n<p>The algorithm costs O(N*log(N))</p>\n"}, {"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 3, "last_activity_date": 1534933345, "creation_date": 1534933345, "answer_id": 51964753, "question_id": 51964230, "link": "https://stackoverflow.com/questions/51964230/c-stl-which-algorithm-should-i-use-to-check-if-a-container-has-duplicates/51964753#51964753", "title": "C++/STL which algorithm should I use to check if a container has duplicates?", "body": "<p>One way of implementing your STL-like <code>is_exclusive</code> template function would be by using a <code>std::unordered_map</code> which keeps the counting of the elements in the range. The function template could return <code>false</code> as soon as the count for any element is over one:</p>\n\n<pre><code>#include &lt;unordered_map&gt;\n\ntemplate&lt;typename ForwardIt&gt;\nbool is_exclusive(ForwardIt first, ForwardIt last) {\n    std::unordered_map&lt;typename ForwardIt::value_type, unsigned&gt; count;\n\n    for (auto it = first; it != last; ++it)\n        if (++count[*it] &gt; 1)\n            return false;\n\n    return true;\n}\n</code></pre>\n\n<p>For your example:</p>\n\n<pre><code>int main() {\n    std::vector&lt;int&gt; v1{ 1, 2, 3 };\n    std::vector&lt;int&gt; v2{ 1, 2, 1 };\n\n\n    assert(is_exclusive(v1.begin(), v1.end()));\n    assert(!is_exclusive(v2.begin(), v2.end()));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 1, "creation_date": 1534944438, "post_id": 51965088, "comment_id": 90886101, "body": "Err, <code>unordered_set</code> would work fine in most cases and gives average O(n) complexity (requires hash and equality comparison, and possibly copy c&#39;tor). Another possibility with worst case O(n log n) complexity, for forward iterator ranges, is to make a vector of iterators or pointers and sort these (requires less-than-comparable type). A generic solution has to allocate O(N) additional memory, though, and impose certain constraints on types, which is the more likely reason there is no such algorithm yet."}], "tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": true, "score": 2, "last_activity_date": 1534934638, "creation_date": 1534934638, "answer_id": 51965088, "question_id": 51964230, "link": "https://stackoverflow.com/questions/51964230/c-stl-which-algorithm-should-i-use-to-check-if-a-container-has-duplicates/51965088#51965088", "title": "C++/STL which algorithm should I use to check if a container has duplicates?", "body": "<p>STL is about efficiency and universality. There seems to be no universal and efficient way to check if a container has duplicates without modifying it. Hence, no wonder that no such algorithm exists in STL.</p>\n"}], "owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 1, "accepted_answer_id": 51965088, "answer_count": 4, "score": 4, "last_activity_date": 1534934638, "creation_date": 1534931706, "question_id": 51964230, "link": "https://stackoverflow.com/questions/51964230/c-stl-which-algorithm-should-i-use-to-check-if-a-container-has-duplicates", "title": "C++/STL which algorithm should I use to check if a container has duplicates?", "body": "<p>Is there any STL algorithm that would tell if a container has duplicated elements (using the <code>operator==</code> or a given predicate)?</p>\n\n<p>Let's consider those two vectors:</p>\n\n<pre><code>std::vector&lt;int&gt; v1{ 1, 2, 3 };\nstd::vector&lt;int&gt; v2{ 1, 2, 1 };\n</code></pre>\n\n<p>I would expect a function like that:</p>\n\n<pre><code>std::is_exclusive( v1.begin(), v1.end() ); // returning true\nstd::is_exclusive( v2.begin(), v2.end() ); // returning false\n</code></pre>\n\n<p>Is there such a simple function? I could not find any (found <code>std::unique</code>, but this modifies the vector...)</p>\n\n<p>Note: I'm not asking how to \"check if a container has duplicates\", I know how I can do that (basically, I can do <code>( std::set&lt;int&gt;( v1.begin(), v1.end() ).size() == v1.size() )</code> and there may exist many other options. I'm asking if there is a STL algorithm function that would do it in a smarter way because I'm surprised I could not find any...</p>\n"}, {"tags": ["c++", "qt", "visual-c++", "linker-errors", "armadillo"], "comments": [{"owner": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "edited": false, "score": 1, "creation_date": 1534932215, "post_id": 51964151, "comment_id": 90878722, "body": "This is a linkage error but the most probable cause is the fact that one library is compiled against MinGW. Have you installed the correct qt MSVC and recompiled arma?"}, {"owner": {"reputation": 243, "user_id": 10196418, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgi7q7YzJ9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p8ah7tLe3qK9N0zInl0TBV_z8A5A/mo/photo.jpg?sz=128", "display_name": "Mariam", "link": "https://stackoverflow.com/users/10196418/mariam"}, "reply_to_user": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "edited": false, "score": 0, "creation_date": 1534933637, "post_id": 51964151, "comment_id": 90879482, "body": "@DragosPop sorry, but what is arma? and what defines MSVC as correct? The MSVC compiles other qt projects successfully. if this means it is correct, then yes, it is."}, {"owner": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "edited": false, "score": 0, "creation_date": 1534936246, "post_id": 51964151, "comment_id": 90880847, "body": "I see that you use a library in the error message arma::blas::... I did a quick search and found it on the internet. Don&#39;t know how you are using it but search your includes and linker settings."}, {"owner": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "edited": false, "score": 0, "creation_date": 1534936896, "post_id": 51964151, "comment_id": 90881186, "body": "I found it here: <a href=\"http://arma.sourceforge.net/docs.html\" rel=\"nofollow noreferrer\">arma.sourceforge.net/docs.html</a>, it might be that you are not using it directly, but indirectly. For example mlpack is using it. Any way it seems to be a low level mat lib, so if you are using a library that could do a lot of calculations, that could depend on this Armadillo or whatever it&#39;s name."}, {"owner": {"reputation": 243, "user_id": 10196418, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgi7q7YzJ9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p8ah7tLe3qK9N0zInl0TBV_z8A5A/mo/photo.jpg?sz=128", "display_name": "Mariam", "link": "https://stackoverflow.com/users/10196418/mariam"}, "reply_to_user": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "edited": false, "score": 0, "creation_date": 1534937526, "post_id": 51964151, "comment_id": 90881537, "body": "yeah, actually I am building on a project that was started by someone else, and he uses the library for some calculations (just found out now). So I am suspecting this library is made for a specific compiler version or something like that and that&#39;s why it doesnt work with the new compiler? @DragosPop"}, {"owner": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "edited": false, "score": 0, "creation_date": 1534940014, "post_id": 51964151, "comment_id": 90883117, "body": "No, it is compiled for that specific compiler. You just have to compile it again, for Visual Studio. This however might not be so simple, you need to configure it&#39;s build system to compile to visual studio. However from the documentation VS seems to be supported: <a href=\"http://arma.sourceforge.net/download.html\" rel=\"nofollow noreferrer\">arma.sourceforge.net/download.html</a> read the Windows part."}, {"owner": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "edited": false, "score": 1, "creation_date": 1534940166, "post_id": 51964151, "comment_id": 90883214, "body": "It seems that it also has a CMake file, this means it should be easy enough to open in QtCreator and build it to target visual studio. Don&#39;t know exactly how since I haven&#39;t used QtCreator in a while"}, {"owner": {"reputation": 243, "user_id": 10196418, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgi7q7YzJ9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p8ah7tLe3qK9N0zInl0TBV_z8A5A/mo/photo.jpg?sz=128", "display_name": "Mariam", "link": "https://stackoverflow.com/users/10196418/mariam"}, "reply_to_user": {"reputation": 398, "user_id": 4461389, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2zo0ylRwOwE/AAAAAAAAAAI/AAAAAAAAIG8/8fmGYstxAFU/photo.jpg?sz=128", "display_name": "Dragos Pop", "link": "https://stackoverflow.com/users/4461389/dragos-pop"}, "edited": false, "score": 0, "creation_date": 1534941170, "post_id": 51964151, "comment_id": 90883875, "body": "@DragosPop thanks, yeah I definitely got a better understanding of the problem now. Just need to find out how to solve it!"}], "owner": {"reputation": 243, "user_id": 10196418, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgi7q7YzJ9s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p8ah7tLe3qK9N0zInl0TBV_z8A5A/mo/photo.jpg?sz=128", "display_name": "Mariam", "link": "https://stackoverflow.com/users/10196418/mariam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1535618984, "creation_date": 1534931400, "last_edit_date": 1535618984, "question_id": 51964151, "link": "https://stackoverflow.com/questions/51964151/re-linking-external-library-when-changing-compiler-in-qt", "title": "Re-linking external library when changing compiler in Qt", "body": "<p>I know this error has been addressed a lot, but until now I couldn't solve it for my project. I am doing a Qt application and want to compile it with the MSVC compiler instead of MinGW (<a href=\"https://stackoverflow.com/questions/51787036/alternatives-to-qtbluetooth-on-windows\">here</a> is the reason). </p>\n\n<p>When I built the programm, I get loads of errors of this kind (just an excerpt):</p>\n\n<pre><code>error: LNK2019: unresolved external symbol sdot_ referenced in function \"double __cdecl arma::blas::dot&lt;double&gt;(unsigned int,double const *,double const *)\" (??$dot@N@blas@arma@@YANIPEBN0@Z)\nerror: LNK2019: unresolved external symbol sgemv_ referenced in function \"void __cdecl arma::blas::gemv&lt;double&gt;(char const *,int const *,int const *,double const *,double const *,int const *,double const *,int const *,double const *,double *,int const *)\" (??$gemv@N@blas@arma@@YAXPEBDPEBH1PEBN21212PEAN1@Z)\n</code></pre>\n\n<p>and this warning: <code>LNK4272: library machine type 'x86' conflicts with target machine type 'x64'</code>. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/27807500/lnk1112-module-machine-type-x64-conflicts-with-target-machine-type-x86-qt\">This</a> thread suggests running qmake and re-building the project, but this didn't change anything. </p>\n\n<p>From <a href=\"https://stackoverflow.com/questions/3563756/fatal-error-lnk1112-module-machine-type-x64-conflicts-with-target-machine-typ\">here</a> and <a href=\"https://stackoverflow.com/questions/9214345/x86-conflicts-with-target-machine-type-x64\">here</a> and as the warning suggests, I figured I have to change the target machine for the linker. However, everything I found explained it in Visual Studio. How do I do this in Qt Creator? </p>\n\n<p>I would be very thankful for any hints. </p>\n\n<p><strong>EDIT:</strong> So my program uses the armadillo library and this is the cause of the problems. When I change compilers, I need to compile or link this library in a new way (right?). This <a href=\"http://gernotklingler.com/blog/creating-using-shared-libraries-different-compilers-different-operating-systems/\" rel=\"nofollow noreferrer\">blog post</a> summarized the problem in 2 points (the second point is the cause of the errors):</p>\n\n<blockquote>\n  <ol>\n  <li><p>MSVC cannot directly link to a dll -> we need a so-called \u201cimport library\u201d.</p></li>\n  <li><p>Symbol Visibility: GCC/MinGW exports all symbols by default, MSVC exports no symbol by default.</p></li>\n  </ol>\n</blockquote>\n\n<p>So when using MSVC I have to link the import library (.lib) instead of the .dll in the case of MinGW. How can I do this in QtCreator? </p>\n\n<p>This is my first time going deep with compilers and linkers, so I am very open for corrections, suggestions and solutions!</p>\n"}, {"tags": ["c++", "gstreamer"], "comments": [{"owner": {"reputation": 1004, "user_id": 2038709, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e65b1bc98b25269963ef4373a58f6e69?s=128&d=identicon&r=PG", "display_name": "gst", "link": "https://stackoverflow.com/users/2038709/gst"}, "edited": false, "score": 1, "creation_date": 1535022952, "post_id": 51963980, "comment_id": 90918325, "body": "How about using <code>tee</code> element, splitting into two branches/sinks, and restricting the output at one sink using element <code>identity</code>or <code>valve</code> ? I have never worked with <code>output-selector</code>, but I am sure the one with <code>tee</code> &amp; <code>identity</code> will work."}, {"owner": {"reputation": 4392, "user_id": 5215131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2C8rv6T-3m8/AAAAAAAAAAI/AAAAAAAAAP0/ALwPPtWwxac/photo.jpg?sz=128", "display_name": "Florian Zwoch", "link": "https://stackoverflow.com/users/5215131/florian-zwoch"}, "edited": false, "score": 0, "creation_date": 1535023937, "post_id": 51963980, "comment_id": 90918948, "body": "Perhaps the selector behaves similar to a tee? Then you would need a <code>queue</code> after all output pads from the selector."}, {"owner": {"reputation": 984, "user_id": 7322100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d535f0625b6537caf1380aa0a61083?s=128&d=identicon&r=PG", "display_name": "ErniBrown", "link": "https://stackoverflow.com/users/7322100/ernibrown"}, "reply_to_user": {"reputation": 4392, "user_id": 5215131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2C8rv6T-3m8/AAAAAAAAAAI/AAAAAAAAAP0/ALwPPtWwxac/photo.jpg?sz=128", "display_name": "Florian Zwoch", "link": "https://stackoverflow.com/users/5215131/florian-zwoch"}, "edited": false, "score": 0, "creation_date": 1535027430, "post_id": 51963980, "comment_id": 90921016, "body": "@FlorianZwoch, no, it doesn&#39;t seem to help..."}, {"owner": {"reputation": 984, "user_id": 7322100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d535f0625b6537caf1380aa0a61083?s=128&d=identicon&r=PG", "display_name": "ErniBrown", "link": "https://stackoverflow.com/users/7322100/ernibrown"}, "reply_to_user": {"reputation": 1004, "user_id": 2038709, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e65b1bc98b25269963ef4373a58f6e69?s=128&d=identicon&r=PG", "display_name": "gst", "link": "https://stackoverflow.com/users/2038709/gst"}, "edited": false, "score": 0, "creation_date": 1535101728, "post_id": 51963980, "comment_id": 90951171, "body": "@VenkateshKuppan, not sure what do you mean: where should i put the tee? I tried with a configuration like videotestsrc-&gt;valve-&gt;autovideosink, and everything started correctly. After a couple of second I switched property drop to true, the video freezed. But after a few second again I switched again drop to false, and the video still freezes."}, {"owner": {"reputation": 1004, "user_id": 2038709, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e65b1bc98b25269963ef4373a58f6e69?s=128&d=identicon&r=PG", "display_name": "gst", "link": "https://stackoverflow.com/users/2038709/gst"}, "edited": false, "score": 1, "creation_date": 1535134856, "post_id": 51963980, "comment_id": 90970463, "body": "The <code>valve</code> element has an issue with replaying the video once it&#39;s paused. There is already a bug raised by me in the GStreamer gnome system. But as an alternative , you can use element <code>identity</code> and toggle the property <code>drop-probability</code> as per your requirements.  Place a <code>tee</code>, instead of <code>output-selector</code> that splits your output. But in this case, both the branches will be active all the time. Ofcourse you can restrict one output using the <code>identity</code> as I mentioned, but in reality both the branches of tee will be active. You must analyse your system requirements if you can afford this."}, {"owner": {"reputation": 1004, "user_id": 2038709, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e65b1bc98b25269963ef4373a58f6e69?s=128&d=identicon&r=PG", "display_name": "gst", "link": "https://stackoverflow.com/users/2038709/gst"}, "edited": false, "score": 0, "creation_date": 1535134888, "post_id": 51963980, "comment_id": 90970478, "body": "Here is an example of using <a href=\"https://gstreamer.freedesktop.org/data/doc/gstreamer/head/gstreamer-plugins/html/gstreamer-plugins-tee.html\" rel=\"nofollow noreferrer\">tee</a>"}], "owner": {"reputation": 984, "user_id": 7322100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d535f0625b6537caf1380aa0a61083?s=128&d=identicon&r=PG", "display_name": "ErniBrown", "link": "https://stackoverflow.com/users/7322100/ernibrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534930841, "creation_date": 1534930841, "question_id": 51963980, "link": "https://stackoverflow.com/questions/51963980/gstreamer-pipeline-with-output-selector-does-not-start", "title": "Gstreamer pipeline with output selector does not start", "body": "<p>I created a pipeline where the source is always running, but I want to disable the output under conditions. As suggested in another thead i used an output-selector, so that I have the following pipeline\n<a href=\"https://i.stack.imgur.com/KrH1Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KrH1Q.png\" alt=\"Pipeline\"></a></p>\n\n<p>When I change pipeline status to \"playing\" I can see only the first frame. From the pipeline graph it seems to me that fakesink is not able to switch to \"ready\" state, but I do not understand why. Can someone help me with this?</p>\n\n<p>Minimal code is:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;unistd.h&gt;\n#include &lt;gst/gst.h&gt;\n\n\nint main(int argc, char* argv[])\n{\n    bool running = true;\n\n    gst_init(&amp;argc,&amp;argv);\n\n    GstElement* pipeline = gst_pipeline_new(\"main-pipeline\");\n    GstElement* source = gst_element_factory_make(\"videotestsrc\",\"mysource\");\n    GstElement* selector = gst_element_factory_make(\"output-selector\",\"myselector\");\n    GstElement* realsink = gst_element_factory_make(\"autovideosink\",\"realsink\");\n    GstElement* fakesink = gst_element_factory_make(\"fakesink\",\"fakesink\");\n\n    GstPad* osel_src1 = gst_element_get_request_pad(selector, \"src_%u\");\n    GstPad* osel_src2 = gst_element_get_request_pad(selector, \"src_%u\");\n    GstPad* realsinkpad = gst_element_get_static_pad(realsink, \"sink\");\n    GstPad* fakesinkpad = gst_element_get_static_pad(fakesink, \"sink\");\n\n    if(pipeline == NULL ||\n       source == NULL ||\n       selector == NULL ||\n       realsink == NULL ||\n       fakesink == NULL ||\n       osel_src1 == NULL ||\n       osel_src2 == NULL ||\n       realsinkpad == NULL ||\n       fakesinkpad == NULL)\n    {\n        g_printerr (\"Not all elements could be created.\\n\");\n        return -1;\n    }\n\n    gst_bin_add_many(GST_BIN(pipeline), source , selector, realsink, fakesink, NULL);\n\n    if ((gst_element_link(source, selector) != TRUE) ||\n        (gst_pad_link(osel_src1, fakesinkpad) != GST_PAD_LINK_OK) ||\n        (gst_pad_link(osel_src2, realsinkpad) != GST_PAD_LINK_OK) )\n    {\n        g_printerr(\"Failed linking.\\n\");\n        gst_object_unref(pipeline);\n        return -1;\n    }\n\n    g_object_set(G_OBJECT (selector), \"active-pad\", osel_src2, NULL);\n\n    /* Start playing */\n    GstStateChangeReturn ret = gst_element_set_state(pipeline, GST_STATE_PLAYING);\n    if(ret == GST_STATE_CHANGE_FAILURE)\n    {\n        g_printerr (\"Unable to set the pipeline to the playing state.\\n\");\n        gst_object_unref(pipeline);\n        return -1;\n    }\n\n    std::thread pipelineThread = std::thread( [&amp;] { \n        GstBus *bus;\n        GstMessage *msg;\n\n        /* Wait until error or EOS */\n        bus = gst_element_get_bus(pipeline);\n        while(running)\n        {\n            msg = gst_bus_timed_pop_filtered(bus, 100 * GST_MSECOND, (GstMessageType)(GST_MESSAGE_ERROR | GST_MESSAGE_EOS));\n\n            if (msg != NULL)\n                gst_message_unref (msg);\n        }\n\n        gst_object_unref (bus);\n     } );\n\n    sleep(1);\n\n    GST_DEBUG_BIN_TO_DOT_FILE((GstBin*)pipeline, GST_DEBUG_GRAPH_SHOW_ALL, \"pipeline\");\n\n    std::cin.get();\n    running = false;\n\n    if(pipelineThread.joinable())\n        pipelineThread.join();\n\n    /* Free resources */\n    gst_element_set_state (pipeline, GST_STATE_NULL);\n    gst_object_unref(pipeline);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++14"], "comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1534931779, "post_id": 51963957, "comment_id": 90878475, "body": "The first one may be more canonical. The optimizer will make these two versions similar at assembly level. So the answers will be opinion based."}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 1, "creation_date": 1534948929, "post_id": 51963957, "comment_id": 90889194, "body": "<a href=\"https://stackoverflow.com/questions/926752/why-should-i-prefer-to-use-member-initialization-list\">Member initialization lists are generally preferred.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 5063316, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-4cqXOIOh0/AAAAAAAAAAI/AAAAAAAAFa4/rGw3d3vZ2sc/photo.jpg?sz=128", "display_name": "ChrisG", "link": "https://stackoverflow.com/users/5063316/chrisg"}, "edited": false, "score": 0, "creation_date": 1535031251, "post_id": 51964294, "comment_id": 90923589, "body": "This, along with @Ben Jones&#39; comment, answer my question. Thanks!"}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 4, "last_activity_date": 1534934593, "last_edit_date": 1534934593, "creation_date": 1534931852, "answer_id": 51964294, "question_id": 51963957, "link": "https://stackoverflow.com/questions/51963957/c-vector-set-size-in-initialization-list-or-resize/51964294#51964294", "title": "C++ vector set size in initialization list or resize", "body": "<p>The latter will generally first default-construct the vector, then reallocate the vector's storage to accommodate the new length (if larger than the default) (see here for <a href=\"https://gcc.godbolt.org/z/pt3uUU\" rel=\"nofollow noreferrer\">assembly code</a>). In contrast, there will be only one allocation for the first variant (less  <a href=\"https://gcc.godbolt.org/z/xQiUNH\" rel=\"nofollow noreferrer\">assembly code</a>).</p>\n\n<p>Note that compiler optimizations may well see through this, but there is another reason (other than avoiding premature pessimization) to prefer the first: By explicitly initializing all members in the constructor initialization list (or inline), you can have tooling that informs you when you leave something uninitialized by accident.</p>\n"}], "owner": {"reputation": 161, "user_id": 5063316, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-4cqXOIOh0/AAAAAAAAAAI/AAAAAAAAFa4/rGw3d3vZ2sc/photo.jpg?sz=128", "display_name": "ChrisG", "link": "https://stackoverflow.com/users/5063316/chrisg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "accepted_answer_id": 51964294, "answer_count": 1, "score": 2, "last_activity_date": 1534934593, "creation_date": 1534930769, "last_edit_date": 1534931446, "question_id": 51963957, "link": "https://stackoverflow.com/questions/51963957/c-vector-set-size-in-initialization-list-or-resize", "title": "C++ vector set size in initialization list or resize", "body": "\n\n<p>Which one of the following is preferred/more efficient?</p>\n\n<ul>\n<li><p>Initialization list:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Trial {\nprivate:\n    std::vector&lt;int&gt; _vec;\n\npublic:\n    Trial(size_t length) : _vec(length) {\n    }\n};\n</code></pre></li>\n<li><p>Resize:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Trial {\nprivate:\n    std::vector&lt;int&gt; _vec;\n\npublic:\n    Trial(size_t length) {\n        _vec.resize(length);\n    }\n};\n</code></pre></li>\n</ul>\n\n<p>I've seen both in production code, but I've also heard that if you can delegate some work to the compiler, you should, so I always preferred the first one.</p>\n\n<p>Is one of them better than the other?</p>\n"}, {"tags": ["c++", "udp", "ip", "winsock", "nic"], "comments": [{"owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "edited": false, "score": 0, "creation_date": 1534935352, "post_id": 51963611, "comment_id": 90880392, "body": "Windows documentation say that paramater type of IP_DONTFRAGMENT should be DWORD. Maybe sizeof int is different than sizeof DWORD in the env. And setsockopt fails because the latest parameter is not sizeof(DWORD). So try: <code>DWORD val = 1</code>"}, {"owner": {"reputation": 450, "user_id": 4292309, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Msp6k.jpg?s=128&g=1", "display_name": "moonraker", "link": "https://stackoverflow.com/users/4292309/moonraker"}, "reply_to_user": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "edited": false, "score": 0, "creation_date": 1534936727, "post_id": 51963611, "comment_id": 90881094, "body": "Thanks, still nothing. I currently looking at <a href=\"https://docs.microsoft.com/en-us/windows/desktop/winsock/ipproto-ip-socket-options\" rel=\"nofollow noreferrer\">This MS Documentaion</a> which has the IP_MTU_DISCOVER flag which looks promising but i can&#39;t seem to find it anywhere in my include files."}, {"owner": {"reputation": 450, "user_id": 4292309, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Msp6k.jpg?s=128&g=1", "display_name": "moonraker", "link": "https://stackoverflow.com/users/4292309/moonraker"}, "reply_to_user": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "edited": false, "score": 0, "creation_date": 1534937306, "post_id": 51963611, "comment_id": 90881422, "body": "Ah,  IP_MTU_DISCOVER isn&#39;t listed in the Windows supported ones!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1534938014, "post_id": 51963611, "comment_id": 90881805, "body": "As for the differing behaviour, <a href=\"https://serverfault.com/a/84981\">this flag is often autonomously determined by complex and intelligent algorithms that are trying to make your network run as fast as possible</a>. I would caution you against trying to beat that system."}], "owner": {"reputation": 450, "user_id": 4292309, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Msp6k.jpg?s=128&g=1", "display_name": "moonraker", "link": "https://stackoverflow.com/users/4292309/moonraker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534935295, "creation_date": 1534929686, "last_edit_date": 1534935295, "question_id": 51963611, "link": "https://stackoverflow.com/questions/51963611/winsock-udp-ip-dontfragment", "title": "WinSock UDP IP_DONTFRAGMENT", "body": "<p>I have some software written in C++ which acts differently on 2 separate machines. The software sends UDP packets out using:</p>\n\n<pre><code>m_socketHandle = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)\n</code></pre>\n\n<p>Both machines are using WIN 7 SP1</p>\n\n<p>According to Wireshark:</p>\n\n<p>Machine 1: the Don't fragment section of the IP header is set to 0 \"Don't Fragment: Not SET\".</p>\n\n<p>Machine 2: it is set to 1 \"Don't Fragment: SET\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/YlbT1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YlbT1.png\" alt=\"enter image description here\"></a></p>\n\n<p>So this led me to try and explicitly set it myself using:\n<a href=\"https://stackoverflow.com/questions/973439/how-to-set-the-dont-fragment-df-flag-on-a-socket\">This Stack Question</a></p>\n\n<p>and </p>\n\n<pre><code>int val = 1;\nsetsockopt(sd, IPPROTO_IP, IP_DONTFRAGMENT, (char *)&amp;val, sizeof(val));\n</code></pre>\n\n<p>But it has no effect what so ever with the result always being \"Don't Fragment: Not SET\".</p>\n\n<p>Am i missing something here, why would it be different on different machines even though the code wasn't explicitly setting it? </p>\n"}]