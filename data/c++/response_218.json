[{"tags": ["c++", "vtk", "molecule"], "answers": [{"tags": [], "owner": {"reputation": 1419, "user_id": 10219194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d7e5056fe03b3747a726fcdd79005af?s=128&d=identicon&r=PG&f=1", "display_name": "Nico Vuaille", "link": "https://stackoverflow.com/users/10219194/nico-vuaille"}, "is_accepted": false, "score": 0, "last_activity_date": 1552560032, "creation_date": 1552560032, "answer_id": 55160430, "question_id": 55152710, "link": "https://stackoverflow.com/questions/55152710/vtkmolecule-remove-atom/55160430#55160430", "title": "vtkMolecule - remove atom", "body": "<p>You're right, there is no simple method to do that.</p>\n\n<p>Protected means that it is usable from a child class but not externally that's why you need to create a new public method, like <code>RemoveAtom(id)</code>, that call <code>RemoveVertexInternal(id)</code>.\nYou should either subclass <code>vtkMolecule</code> or just patch it.</p>\n\n<p>Is suggest you to patch and to contribute upstream: <a href=\"https://gitlab.kitware.com/vtk/vtk/merge_requests\" rel=\"nofollow noreferrer\">https://gitlab.kitware.com/vtk/vtk/merge_requests</a></p>\n"}], "owner": {"reputation": 31, "user_id": 5931961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9882679267221247f19b96cb61625c7?s=128&d=identicon&r=PG&f=1", "display_name": "john.d", "link": "https://stackoverflow.com/users/5931961/john-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552560032, "creation_date": 1552519920, "last_edit_date": 1552542654, "question_id": 55152710, "link": "https://stackoverflow.com/questions/55152710/vtkmolecule-remove-atom", "title": "vtkMolecule - remove atom", "body": "<p>I am working on program which builds molecule from scratch. My intention is to use <code>vtkMolecule</code> for it. However, while it is easy to add Atom to molecule by <code>AppendAtom</code> method, there seems to be no function for removal.</p>\n\n<p><strong>Here is my code:</strong></p>\n\n<pre><code>int main(int, char *[]) {\n  vtkSmartPointer&lt;vtkMolecule&gt; molecule =\n    vtkSmartPointer&lt;vtkMolecule&gt;::New();   \n  molecule-&gt;AppendAtom(12, 0.0, 0.0, 0.0);\n  molecule-&gt;AppendAtom(12, 1.0, 1.0, 1.0);\n  molecule-&gt;AppendAtom(12, 2.0, 2.0, 2.0);\n\n  molecule-&gt;AppendBond(molecule-&gt;GetAtom(0), molecule-&gt;GetAtom(1), 1);\n  molecule-&gt;AppendBond(molecule-&gt;GetAtom(1), molecule-&gt;GetAtom(2), 1);\n\n  //hypothetical code, I want something like this - remove atom by id:\n  molecule-&gt;RemoveAtom(2)\n\n  vtkSmartPointer&lt;vtkMoleculeMapper&gt; moleculeMapper =\n    vtkSmartPointer&lt;vtkMoleculeMapper&gt;::New();\n  moleculeMapper-&gt;SetInputData(molecule);\n  //...rendering etc.\n}\n</code></pre>\n\n<p><a href=\"https://vtk.org/doc/nightly/html/classvtkMolecule.html\" rel=\"nofollow noreferrer\">vtkMolecule Class Reference</a></p>\n\n<p>I was thinking of some <code>vtkGraph</code> method like <code>vtkGraph::RemoveVertexInternal</code>, but it is (probably for some reason) protected  and therefore not usable in child of child class.</p>\n\n<p><strong>My question is:</strong> </p>\n\n<p>Is there a simple way to delete atom from molecule other than creating child class of <code>vtkMolecule</code> with specialized method?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 2, "creation_date": 1552519676, "post_id": 55152606, "comment_id": 97045694, "body": "the <code>std::cin</code> call to take user input is outside the loop which evaluates it. I also recommend you change the <code>for(;;)</code> to a <code>while(flag)</code>, and set the <code>flag</code> to <code>false</code> instead of making the <code>exit(0)</code> call in the loop so you have proper control of the loop."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7816607, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vG5vzJPnayg/AAAAAAAAAAI/AAAAAAAAAMY/LQWrrCb0TCw/photo.jpg?sz=128", "display_name": "Oliwier Piasecki", "link": "https://stackoverflow.com/users/7816607/oliwier-piasecki"}, "edited": false, "score": 0, "creation_date": 1552520036, "post_id": 55152677, "comment_id": 97045779, "body": "Can you write for me part of code which should I write using std::vector? I don\u2019t understand it at all"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 21, "user_id": 7816607, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vG5vzJPnayg/AAAAAAAAAAI/AAAAAAAAAMY/LQWrrCb0TCw/photo.jpg?sz=128", "display_name": "Oliwier Piasecki", "link": "https://stackoverflow.com/users/7816607/oliwier-piasecki"}, "edited": false, "score": 0, "creation_date": 1552521403, "post_id": 55152677, "comment_id": 97046128, "body": "@OliwierPiasecki no <code>vector</code> needed, I updated my answer"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1552521916, "last_edit_date": 1552521916, "creation_date": 1552519710, "answer_id": 55152677, "question_id": 55152606, "link": "https://stackoverflow.com/questions/55152606/give-the-smallest-number-from-the-for-loop-and-make-switch-infinite/55152677#55152677", "title": "Give the smallest number from the for loop and make switch infinite", "body": "<ol>\n<li><p>The simplest way is to just look at the lowest number the user has entered.  If it is even, it is already the smallest even number.  If it is odd, increment it by 1 (if it does not exceed the highest number the user has entered) and that is the smallest even number.</p></li>\n<li><p>you need to move your menu output and prompt for user input INSIDE the <code>for</code> loop, instead of BEFORE the <code>for</code> loop.</p></li>\n</ol>\n\n<p>Try something like this:</p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n\nint sumOfEvens(int lowest, int highest)\n{\n    int sum = 0;\n    for (int i = lowest; i &lt;= highest; i++) {\n        if (i % 2 == 0) sum += i;\n    }\n    return sum;\n}\n\nint quantityOfEvens(int lowest, int highest)\n{\n    if (lowest == highest) return (lowest % 2 == 0) ? 1 : 0;\n    int quantity = diff / 2;\n    if (diff % 2 != 0) ++quantity;\n    return quantity;\n}\n\nint smallestEven(int lowest, int highest)\n{\n    if (lowest % 2 == 0) return lowest;\n    if (lowest &lt; highest) return lowest + 1;\n    return -1;\n}\n\nint main()\n{\n    int number1, number2, lowest, highest;\n    int choice, quantity, smallest;\n\n    std::cout &lt;&lt; \"Give first number: \";\n    std::cin &gt;&gt; number1;\n\n    std::cout &lt;&lt; \"Give second number: \";\n    std::cin &gt;&gt; number2;\n\n    lowest = (number1 &lt; number2) ? number1 : number2;\n    highest = (number1 &lt; number2) ? number2 : number1;\n\n    do\n    {\n        std::cout &lt;&lt; \"MENU:\\n\";\n        std::cout &lt;&lt; \"1. Show even numbers from the smallest to the largest.\\n\";\n        std::cout &lt;&lt; \"2. Show even numbers from the largest to the smallest.\\n\";\n        std::cout &lt;&lt; \"3. Show the amount of even numbers.\\n\";\n        std::cout &lt;&lt; \"4. Show the sum of even numbers.\\n\";\n        std::cout &lt;&lt; \"5. Show the average of even numbers.\\n\";\n        std::cout &lt;&lt; \"6. Show the smallest number of even numbers.\\n\";\n        std::cout &lt;&lt; \"7. Exit.\\n\";\n        std::cout &lt;&lt; \"Choose number: \";\n        std::cin &gt;&gt; choice; \n\n        std::cout &lt;&lt; std::endl;\n\n        switch (choice) {\n        case 1: \n            for (int i = lowest; i &lt;= highest; i++) {\n                if (i % 2 == 0) std::cout &lt;&lt; i &lt;&lt; std::endl;\n            }\n            break;\n\n        case 2: \n            for (int i = highest; i &gt;= lowest; i--) {\n                if (i % 2 == 0) std::cout &lt;&lt; i &lt;&lt; std::endl;\n            }\n            break;\n\n        case 3:\n            std::cout &lt;&lt; quantityOfEvens(lowest, highest) &lt;&lt; std::endl;\n            break;\n\n        case 4:\n            std::cout &lt;&lt; sumOfEvens(lowest, highest) &lt;&lt; std::endl;\n            break;\n\n        case 5:\n            quantity = quantityOfEvens(lowest, highest);\n            if (quantity != 0) std::cout &lt;&lt; sumOfEvens(lowest, highest) / quantity;\n            std::cout &lt;&lt; std::endl;\n            break;\n\n        case 6:\n            smallest = smallestEven(lowest, highest);\n            if (smallest != -1) std:cout &lt;&lt; smallest;\n            cout &lt;&lt; std::endl;\n            break;\n    }\n    while (choice != 7);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7816607, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vG5vzJPnayg/AAAAAAAAAAI/AAAAAAAAAMY/LQWrrCb0TCw/photo.jpg?sz=128", "display_name": "Oliwier Piasecki", "link": "https://stackoverflow.com/users/7816607/oliwier-piasecki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55152677, "answer_count": 1, "score": -2, "last_activity_date": 1552521916, "creation_date": 1552519202, "question_id": 55152606, "link": "https://stackoverflow.com/questions/55152606/give-the-smallest-number-from-the-for-loop-and-make-switch-infinite", "title": "Give the smallest number from the for loop and make switch infinite", "body": "<ol>\n<li>I don't know how to show the smallest number from the range which user has given and remember that these numbers must be even.   </li>\n<li>Before switch I added for(;;) to make this switch infinite but as a result it gives me infinite answers to one of the cases. I want to go back to the beggining of the case and have option to choose.</li>\n</ol>\n\n<p>Here is the code:</p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int number1, number2;\n    std::cout &lt;&lt; \"Give first number: \";\n    std::cin &gt;&gt; number1;\n    std::cout &lt;&lt; \"Give second number: \";\n    std::cin &gt;&gt; number2;\n\n    while (number1 &gt; number2) {\n        std::cout &lt;&lt; std::endl;\n        std::cout &lt;&lt; \"First number must be smaller than the second number!\\n\";\n        std::cout &lt;&lt; std::endl;\n        std::cout &lt;&lt; \"Give first number: \";\n        std::cin &gt;&gt; number1;\n        std::cout &lt;&lt; \"Give second number \";\n        std::cin &gt;&gt; number2;\n    }\n\n    std::cout &lt;&lt; std::endl;\n\n    int choice, quantity = 0, sum = 0, table[1000];\n\n    std::cout &lt;&lt; \"MENU:\\n\";\n    std::cout &lt;&lt; \"1. Show even numbers from the smallest to the largest.\\n\";\n    std::cout &lt;&lt; \"2. Show even numbers from the largest to the smallest.\\n\";\n    std::cout &lt;&lt; \"3. Show the amount of even numbers.\\n\";\n    std::cout &lt;&lt; \"4. Show the sum of even numbers.\\n\";\n    std::cout &lt;&lt; \"5. Show the average of even numbers.\\n\";\n    std::cout &lt;&lt; \"6. Show the smallest number of even numbers.\\n\";\n    std::cout &lt;&lt; \"7. Exit.\\n\";\n    std::cout &lt;&lt; \"Choose number: \";\n    std::cin &gt;&gt; choice;\n\n    std::cout &lt;&lt; std::endl;\n\n    for(;;) {\n\n        switch (choice) {\n        case 1: \n            for (int i = number1; i &lt;= number2; i++) {\n                if (i % 2 == 0) std::cout &lt;&lt; i &lt;&lt; std::endl;\n            }\n            break;\n        case 2: \n            for (int i = number2; i &gt;= number1; i--) {\n                if (i % 2 == 0) std::cout &lt;&lt; i &lt;&lt; std::endl;\n            }\n            break;\n        case 3:\n            quantity = (number2 - number1) / 2;\n            quantity++;\n            std::cout &lt;&lt; quantity &lt;&lt; std::endl;\n            break;\n        case 4:\n            for (int i = number1; i &lt;= number2; i++) {\n                if (i % 2 == 0) sum = sum + i;\n            }\n            std::cout &lt;&lt; sum &lt;&lt; std::endl;\n            break;\n        case 5:\n            quantity = (number2 - number1) / 2;\n            quantity++;\n            for (int i = number1; i &lt;= number2; i++) {\n                if (i % 2 == 0) sum = sum + i;\n            }\n            std::cout &lt;&lt; sum / quantity &lt;&lt; std::endl;\n            break;\n        case 6:\n            for (int i = number1; i &lt;= number2; i++) {\n                if (i % 2 == 0) {\n                    table[i];\n                }\n            }\n            std::cout &lt;&lt; table[1] &lt;&lt; std::endl;\n        case 7:\n            exit(0);    \n            break;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "stl", "containers", "c++-standard-library", "requirements"], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552519148, "creation_date": 1552519148, "question_id": 55152598, "link": "https://stackoverflow.com/questions/55152598/general-purpose-generic-test-for-container-requirements-compliance", "title": "General-purpose/generic test for container requirements compliance?", "body": "<p>Suppose you're writing a container, to meet the <a href=\"https://en.cppreference.com/w/cpp/named_req/Container\" rel=\"nofollow noreferrer\">C++ container requirements</a>. What should I do to make sure it's properly compliant? And Is it possible to have some general-purpose compliance \"torture\" test into which you plug any container's code and it passes compilation if and only if you actually meet the requirements?</p>\n\n<p>PS - Let's assume C++14 or C++17, no C++20 and no concepts involved please.</p>\n"}, {"tags": ["c++", "visual-studio", "c++17"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1552519626, "post_id": 55152552, "comment_id": 97045682, "body": "&quot;but it doesn&#39;t on visual studio.&quot; - if so, you could at least post what compilation error you get."}, {"owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "edited": false, "score": 0, "creation_date": 1552520407, "post_id": 55152552, "comment_id": 97045889, "body": "ops, sorry. edited the question"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1552523142, "post_id": 55152552, "comment_id": 97046561, "body": "<i>Any ideas why it doesn&#39;t compile?</i> -- You should address this to Microsoft if you are certain this should compile."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1552531523, "post_id": 55152552, "comment_id": 97048499, "body": "Yes, it should compile in C++17. VS is known for lagging in implementing the latest C++ standard, however in the last years they have put a considerable effort on this."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1552540617, "post_id": 55152552, "comment_id": 97050514, "body": "@David: which version of MSVC and VS you are using?"}, {"owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "edited": false, "score": 0, "creation_date": 1552573700, "post_id": 55152552, "comment_id": 97069264, "body": "okay, thanks everybody. I&#39;ll report on VS and update here when I get an update."}, {"owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1552573742, "post_id": 55152552, "comment_id": 97069294, "body": "@P.W I&#39;m using VS17, 15.9.8 more specifically."}], "answers": [{"comments": [{"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "reply_to_user": {"reputation": 3754, "user_id": 4732082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781cea048e688814961606ddf35c5881?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/4732082/anonymous"}, "edited": false, "score": 1, "creation_date": 1552602068, "post_id": 55172057, "comment_id": 97084836, "body": "I clarified my answer and addressed section 15.8.3 of the standard, which only applies to named return value optimization."}, {"owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "edited": false, "score": 0, "creation_date": 1552606607, "post_id": 55172057, "comment_id": 97086035, "body": "Thanks a lot, accepted your answer!  I reported it, will post a link to that thread here tomorrow (once I get back to work)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558450063, "post_id": 55172057, "comment_id": 99100567, "body": "MS has very poor C++17 elision support overall."}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "reply_to_user": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "edited": false, "score": 0, "creation_date": 1558450126, "post_id": 55172057, "comment_id": 99100616, "body": "@David did the MSVC people ever reply?"}, {"owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "edited": false, "score": 0, "creation_date": 1558459005, "post_id": 55172057, "comment_id": 99105424, "body": "@J.AntonioPerez , It&#39;s &quot;Under Investigation&quot; here is the link: <a href=\"https://developercommunity.visualstudio.com/content/problem/489863/c-copy-elision-not-performed-when-using-ternary-op.html\" rel=\"nofollow noreferrer\">developercommunity.visualstudio.com/content/problem/489863/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": true, "score": 5, "last_activity_date": 1552680336, "last_edit_date": 1592644375, "creation_date": 1552597779, "answer_id": 55172057, "question_id": 55152552, "link": "https://stackoverflow.com/questions/55152552/visual-studio-not-performing-rvo-when-ternary-operator-is-used-and-move-copy-cto/55172057#55172057", "title": "Visual Studio not performing RVO when ternary operator is used and move/copy ctors are deleted", "body": "<h1>Is it a bug?</h1>\n<p><strong>Yes. This is a bug in MSVC.</strong> Pretty much every other compiler that supports C++17 compiles it. Below we have the assembly produced by:</p>\n<ul>\n<li>ellcc <a href=\"https://godbolt.org/z/PfzDTs\" rel=\"noreferrer\">https://godbolt.org/z/PfzDTs</a></li>\n<li>gcc <a href=\"https://godbolt.org/z/oXpDyk\" rel=\"noreferrer\">https://godbolt.org/z/oXpDyk</a></li>\n<li>clang <a href=\"https://godbolt.org/z/KX99Yc\" rel=\"noreferrer\">https://godbolt.org/z/KX99Yc</a></li>\n<li>power64 AT12.0 <a href=\"https://godbolt.org/z/XvWiEa\" rel=\"noreferrer\">https://godbolt.org/z/XvWiEa</a></li>\n<li>icc 19.0.1 <a href=\"https://godbolt.org/z/pZWBJ5\" rel=\"noreferrer\">https://godbolt.org/z/pZWBJ5</a></li>\n</ul>\n<p>And all of them compile it with <code>-std=c++17</code> or <code>-std=c++1z</code> (for ellcc).</p>\n<h1>What does the standard say?</h1>\n<p>Conditional expressions (the ones formed by the ternary operator) produce values according to <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4713.pdf\" rel=\"noreferrer\">these rules</a> (see section 8.5.16).</p>\n<p>Paragraph 1 of 8.5.16 describes sequencing, and parts 2 through 7 describe the value category of the resulting expression (see section 8.2.1 for a description of value categories).</p>\n<ul>\n<li>Paragraph 2 covers the case that either the second or third operands are void.</li>\n<li>Paragraph 3 covers the case that both the second and third operands are glvalued bitfields (i.e., not prvalues)</li>\n<li>Paragraph 4 covers the case the second and third operands have different types</li>\n<li>Paragraph 5 covers the case that the second and third operands are glvalues of the same type (also not prvalues)</li>\n<li>Paragraph 6:</li>\n</ul>\n<blockquote>\n<p>Otherwise, the result is a prvalue. If the second and third operands do not have the same type, and either has (possibly cv-qualified) class type, overload resolution is used to determine the conversions (if any) to be applied to the operands (16.3.1.2, 16.6). If the overload resolution fails, the program is ill-formed. Otherwise, the conversions thus determined are applied, and the converted operands are used in place of the original operands for the remainder of this subclause.</p>\n</blockquote>\n<p>This gives us our answer. The result is a prvalue, so it's unnecessary to use the copy or move constructors, as the value will be instantiated in the memory provided by the calling function (this memory location is passed as a &quot;hidden&quot; parameter to your function).</p>\n<h2>Does your program implicitly refer to the move constructor or the copy constructor?</h2>\n<p>Jon Harper was kind enough to point out that the standard states:</p>\n<blockquote>\n<p>A program that refers to a deleted function implicitly or explicitly, other than to declare it, is ill-formed. (11.4.3.2)</p>\n</blockquote>\n<p>This begs the question: does your program implicitly refer to the move constructor or the copy constructor?</p>\n<p><strong>The answer to this is no.</strong> Because the result of the conditional expression is a prvalue, no temporary is materialized, and as a result neither the move constructor or the copy constructor is referenced, either explicitly or implicitly. To quote <a href=\"https://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"noreferrer\">cppreference</a> (emphasis mine):</p>\n<blockquote>\n<p>Under the following circumstances, the compilers are required to omit the copy and move construction of class objects, even if the copy/move constructor and the destructor have observable side-effects. The objects are constructed directly into the storage where they would otherwise be copied/moved to. <strong>The copy/move constructors need not be present or accessible</strong>, as the language rules ensure that no copy/move operation takes place, even conceptually:</p>\n<ul>\n<li><p>In a return statement, when the operand is a prvalue of the same class type (ignoring cv-qualification) as the function return type:</p>\n<p><code>T f() { return T(); }</code></p>\n<p><code>f(); // only one call to default constructor of T</code></p>\n</li>\n<li><p>In the initialization of a variable, when the initializer expression is a prvalue of the same class type (ignoring cv-qualification) as the variable type:</p>\n</li>\n</ul>\n<p><code>T x = T(T(f())); // only one call to default constructor of T, to initialize x</code></p>\n</blockquote>\n<h1>Distinguishing between NRVO and RVO</h1>\n<p>One source of contention is whether or not Copy Elision is guaranteed. It is important to distinguish between Named Return Value Optimization, and pure Return Value Optimization.</p>\n<p>If you return a local variable, it's not guaranteed. This is Named Return Value Optimization. If your return statement is an expression that's a prvalue, it is guaranteed.</p>\n<p>For example:</p>\n<pre><code>NoCopyOrMove foo() {\n    NoCopyOrMove myVar{}; //Initialize\n    return myVar; //Error: Move constructor deleted\n}\n</code></pre>\n<p>I am returning a an expression (<code>myVar</code>) that is the name of an object of automatic storage. In this case, return value optimization is permitted but <em>not</em> guaranteed. Section 15.8.3 of the standard applies here.</p>\n<p>On the other hand, if I write:</p>\n<pre><code>NoCopyOrMove foo() {\n    return NoCopyOrMove(); // No error (C++17 and above)\n}\n</code></pre>\n<p>Copy Elision <em>is</em> guaranteed, and no copy or move takes place. Similarly, if I write:</p>\n<pre><code>NoCopyOrMove foo(); //declare foo\nNoCopyOrMove bar() {\n    return foo(); //Returns what foo returns\n}\n</code></pre>\n<p>Copy Elision <em>is still guaranteed</em> because the result of <code>foo()</code> is a prvalue.</p>\n<h1>Conclusion</h1>\n<p>MSVC does, in fact, have a bug.</p>\n"}], "owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 1, "accepted_answer_id": 55172057, "answer_count": 1, "score": 5, "last_activity_date": 1552680336, "creation_date": 1552518807, "last_edit_date": 1552660678, "question_id": 55152552, "link": "https://stackoverflow.com/questions/55152552/visual-studio-not-performing-rvo-when-ternary-operator-is-used-and-move-copy-cto", "title": "Visual Studio not performing RVO when ternary operator is used and move/copy ctors are deleted", "body": "<p>Looking at below code sample I would expect it to perform mandatory copy elision as part of Return Value Optimization (RVO) and compile with C++17 (/std:c++17) but it compiles with an error on Visual Studio 2017 (I'm using VS17, 15.9.8 more specifically).</p>\n\n<pre><code>class NoCopyOrMove\n{\npublic:\n    NoCopyOrMove() = default;\n    NoCopyOrMove(int a, int b){}\n\n    NoCopyOrMove(const NoCopyOrMove&amp;) = delete;\n    NoCopyOrMove&amp; operator=(const NoCopyOrMove&amp;) = delete;\n\n    NoCopyOrMove(NoCopyOrMove&amp;&amp;) = delete;\n    NoCopyOrMove&amp; operator=(NoCopyOrMove&amp;&amp;) = delete;\n\n\nprivate:\n    int a, b;\n};\n\nNoCopyOrMove get(bool b) \n{\n    return b ? NoCopyOrMove(1,2) : NoCopyOrMove();\n\n    //if (b)\n    //    return NoCopyOrMove(1, 2);\n\n    //return NoCopyOrMove();\n}\n\nint main()\n{\n    NoCopyOrMove m = get(true);\n}\n</code></pre>\n\n<p>Error is:</p>\n\n<pre><code>error C2280: 'NoCopyOrMove::NoCopyOrMove(NoCopyOrMove &amp;&amp;)': attempting to reference a deleted function\nnote: see declaration of 'NoCopyOrMove::NoCopyOrMove'\nnote: 'NoCopyOrMove::NoCopyOrMove(NoCopyOrMove &amp;&amp;)': function was explicitly deleted\n</code></pre>\n\n<p>NOTE: seems to compile on GCC and the the version with if/else compiles fine on both so not sure what I am missing.</p>\n\n<p>I found a few other questions on stackoverflow, but they were from pre-c17 era and were mostly referring to \"copy is called instead of move\", hence asking again.</p>\n\n<p>based on cppreference Copy elision happens:</p>\n\n<blockquote>\n  <p>In a return statement, when the operand is a prvalue of the same class\n  type (ignoring cv-qualification) as the function return type:</p>\n</blockquote>\n\n<p>and result of ternary operator should be a prvalue:</p>\n\n<blockquote>\n  <p>a ? b : c, the ternary conditional expression for some b and c (see\n  definition for detail);</p>\n</blockquote>\n\n<p>Any ideas why it doesn't compile?</p>\n\n<hr>\n\n<p>Edit to use a simpler code:</p>\n\n<p>given the NoCopyOrMove above, below code is also attempting to call move-ctor.</p>\n\n<pre><code>int main()\n{\n    volatile bool b = true;\n    NoCopyOrMove m = b ? NoCopyOrMove(1,2) : NoCopyOrMove();\n}\n</code></pre>\n\n<hr>\n\n<p>Update: <a href=\"https://developercommunity.visualstudio.com/content/problem/489863/c-copy-elision-not-performed-when-using-ternary-op.html\" rel=\"nofollow noreferrer\">report link</a> </p>\n"}, {"tags": ["c++", "opencv", "cmake"], "comments": [{"owner": {"reputation": 1574, "user_id": 10911905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/464f9d95f48b6f1d2ab156181e59c05a?s=128&d=identicon&r=PG&f=1", "display_name": "Nuzhny", "link": "https://stackoverflow.com/users/10911905/nuzhny"}, "edited": false, "score": 0, "creation_date": 1552547762, "post_id": 55152442, "comment_id": 97052930, "body": "Here: <a href=\"https://stackoverflow.com/questions/12204820/cmake-and-order-dependent-linking-of-shared-libraries\" title=\"cmake and order dependent linking of shared libraries\">stackoverflow.com/questions/12204820/&hellip;</a>"}, {"owner": {"reputation": 69, "user_id": 2385408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71fe9cff4ce79f6a208045984852e5ad?s=128&d=identicon&r=PG", "display_name": "user2385408", "link": "https://stackoverflow.com/users/2385408/user2385408"}, "reply_to_user": {"reputation": 1574, "user_id": 10911905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/464f9d95f48b6f1d2ab156181e59c05a?s=128&d=identicon&r=PG&f=1", "display_name": "Nuzhny", "link": "https://stackoverflow.com/users/10911905/nuzhny"}, "edited": false, "score": 0, "creation_date": 1552581852, "post_id": 55152442, "comment_id": 97075100, "body": "Thanks @nuzhny, unfortunately this does not fix my problem. I tried both the link orders in <code>target_link_libraries</code> and making a list, but as you can see above, cmake is still linking libraries after FOO."}], "owner": {"reputation": 69, "user_id": 2385408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71fe9cff4ce79f6a208045984852e5ad?s=128&d=identicon&r=PG", "display_name": "user2385408", "link": "https://stackoverflow.com/users/2385408/user2385408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552518132, "creation_date": 1552518132, "question_id": 55152442, "link": "https://stackoverflow.com/questions/55152442/cmake-adding-opencv-libs-out-of-order", "title": "CMake adding OpenCV libs out of order", "body": "<p>I need to control the library order during linking, but CMake is doing weird things with OpenCV libs. See the following CMakeLists.txt:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.13)\nproject(cvtest)\n\nset( CMAKE_VERBOSE_MAKEFILE on )\n\nadd_executable(cvtest \"test.cpp\")\n\nfind_package(OpenCV 3 REQUIRED core)\ntarget_link_libraries(cvtest ${OpenCV_LIBS} FOO)\n</code></pre>\n\n<p>When building the resulting makefile, libraries are linked in the following order: </p>\n\n<pre><code>libopencv_core.3.4.2.dylib -lFOO\n</code></pre>\n\n<p>All good so far (FOO needs to go last). However, if I add another opencv lib: </p>\n\n<pre><code>cmake_minimum_required(VERSION 3.13)\nproject(cvtest)\n\nset( CMAKE_VERBOSE_MAKEFILE on )\n\nadd_executable(cvtest \"test.cpp\")\n\nfind_package(OpenCV 3 REQUIRED core highgui)\ntarget_link_libraries(cvtest ${OpenCV_LIBS} FOO)\n</code></pre>\n\n<p>Then the linker recieves libraries in the following order:</p>\n\n<pre><code>libopencv_highgui.3.4.2.dylib -lFOO libopencv_videoio.3.4.2.dylib libopencv_imgcodecs.3.4.2.dylib libopencv_imgproc.3.4.2.dylib libopencv_core.3.4.2.dylib\n</code></pre>\n\n<p>Importantly, FOO is not last anymore! I tried everything but I cannot make FOO appear at the end of the linking list. Does anyone know how this can be done? </p>\n\n<p>Thanks,</p>\n"}, {"tags": ["c++", "installation", "jupyter-notebook"], "answers": [{"tags": [], "owner": {"reputation": 507, "user_id": 3132457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bfaadad46e8e709dc96a52d9d34d60?s=128&d=identicon&r=PG&f=1", "display_name": "user3132457", "link": "https://stackoverflow.com/users/3132457/user3132457"}, "is_accepted": false, "score": 2, "last_activity_date": 1583002506, "last_edit_date": 1583002506, "creation_date": 1583001872, "answer_id": 60468449, "question_id": 55152440, "link": "https://stackoverflow.com/questions/55152440/c-on-jupyter-notebook-for-windows/60468449#60468449", "title": "C++ on Jupyter Notebook for Windows", "body": "<p>The \"issue\" is that <code>conda-forge/xeus-cling</code> isn't available for Windows (yet?) (as indicated on <a href=\"https://anaconda.org/conda-forge/xeus-cling\" rel=\"nofollow noreferrer\">this</a> page of <code>conda-forge/xeus-cling</code> on anaconda.org). You can instead use <a href=\"https://anaconda.org/gouarin/xeus-cling\" rel=\"nofollow noreferrer\">gouarin/xeus-cling</a> (you still have to have the compatible environment, though). Of course, the online <a href=\"https://hub.gke.mybinder.org/user/quantstack-xeus-cling-ncemy5jv/notebooks/notebooks/xcpp.ipynb\" rel=\"nofollow noreferrer\">C++ Jupyter Notebook</a> is available too.</p>\n"}], "owner": {"reputation": 99, "user_id": 6877248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b549880e485212be913fb7db298c41?s=128&d=identicon&r=PG&f=1", "display_name": "user6877248", "link": "https://stackoverflow.com/users/6877248/user6877248"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2519, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1583002506, "creation_date": 1552518124, "last_edit_date": 1558592417, "question_id": 55152440, "link": "https://stackoverflow.com/questions/55152440/c-on-jupyter-notebook-for-windows", "title": "C++ on Jupyter Notebook for Windows", "body": "<p>Has anyone successfully installed and used C++ on Jupyter Notebook on a windows machine? The installation instruction <a href=\"https://github.com/QuantStack/xeus-cling\" rel=\"noreferrer\">here</a> never worked for me. </p>\n\n<pre><code>conda install -c conda-forge xeus-cling\n</code></pre>\n\n<p>gives me</p>\n\n<blockquote>\n  <p>\"PackagesNotFoundError: The following packages are not available from current channels:\"</p>\n</blockquote>\n\n<p>If anyone has succeeded in installing on Windows, could you please share your instructions? Thanks.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1552516119, "post_id": 55152092, "comment_id": 97044663, "body": "Are you trying to perform <code>9-6</code> and output the result (i.e. <code>3</code>)?"}, {"owner": {"reputation": 13, "user_id": 10977063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ed8c089cd3cda0c0086a9fec63036?s=128&d=identicon&r=PG", "display_name": "Delta", "link": "https://stackoverflow.com/users/10977063/delta"}, "reply_to_user": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1552516204, "post_id": 55152092, "comment_id": 97044698, "body": "yup, but just having trouble"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1552516260, "post_id": 55152092, "comment_id": 97044719, "body": "I have no idea what is the question. Please explain this more carefully."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 8, "creation_date": 1552516320, "post_id": 55152092, "comment_id": 97044736, "body": "You cannot &quot;execute&quot; variables in C++ - you need to write the code for it yourself (e.g.: use a <code>switch(x)</code> to check what operator was entered by the user)"}], "answers": [{"tags": [], "owner": {"reputation": 553, "user_id": 1445986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b4d1041fb9cb5fb2ccf2caaf977567e?s=128&d=identicon&r=PG", "display_name": "ComDubh", "link": "https://stackoverflow.com/users/1445986/comdubh"}, "is_accepted": false, "score": 1, "last_activity_date": 1552516338, "creation_date": 1552516338, "answer_id": 55152154, "question_id": 55152092, "link": "https://stackoverflow.com/questions/55152092/how-do-i-evaluate-an-expression-with-variables-read-from-cin/55152154#55152154", "title": "How do I evaluate an expression with variables read from cin", "body": "<p>You need to test the character that the user enters and use this to determine which operation to apply. So if e.g. '-' is entered, you perform the operation <code>y-z</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "is_accepted": true, "score": 3, "last_activity_date": 1552518009, "last_edit_date": 1552518009, "creation_date": 1552516786, "answer_id": 55152223, "question_id": 55152092, "link": "https://stackoverflow.com/questions/55152092/how-do-i-evaluate-an-expression-with-variables-read-from-cin/55152223#55152223", "title": "How do I evaluate an expression with variables read from cin", "body": "<p>I think the easiest way to solve this issue is just start small. Make a calculator with a single function: one that adds numbers together. Suddenly your code is:</p>\n\n<pre><code>cout &lt;&lt; \"What will be the first integer?\\n\";\ncin &gt;&gt; y;\n\ncout &lt;&lt; \"What will be the second?\\n\";\ncin &gt;&gt; z;\n\nauto result = y + z;\nstd::cout &lt;&lt; result &lt;&lt; \"\\n\";\n</code></pre>\n\n<p>Nice and easy. Now think about how you'd add the ability to allow minusing. Well we need to ask which operation:</p>\n\n<pre><code>std::cout &lt;&lt; \"Would you like to add or subtract numbers? \";\nchar operation;\nstd::cin &gt;&gt; operation;\n\nint result;\nif (operation == '+')\n{\n    result = y + z;\n}\nelse\n{\n    result = y - z;\n}\n</code></pre>\n\n<p>And you can expand from there, by adding more via <code>if else if</code> or just a <code>switch</code></p>\n\n<pre><code>int result;\nswitch (operation)\n{\n    case '+': result = y + z; break;\n    case '-': result = y - z; break;\n    case '*':\n    case 'x':\n        result = y * z; break;\n}\n</code></pre>\n\n<p>Plus you would want to add handling for invalid operations entered.</p>\n"}], "owner": {"reputation": 13, "user_id": 10977063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ed8c089cd3cda0c0086a9fec63036?s=128&d=identicon&r=PG", "display_name": "Delta", "link": "https://stackoverflow.com/users/10977063/delta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1552529291, "accepted_answer_id": 55152223, "answer_count": 2, "score": -4, "last_activity_date": 1553830068, "creation_date": 1552516012, "last_edit_date": 1553830068, "question_id": 55152092, "link": "https://stackoverflow.com/questions/55152092/how-do-i-evaluate-an-expression-with-variables-read-from-cin", "closed_reason": "Needs details or clarity", "title": "How do I evaluate an expression with variables read from cin", "body": "<p>I'm trying to make a basic calculator, but I'm not getting the answer as I expect.  This is my code:</p>\n\n<pre><code>char x;\nint y;\nint z;\n\ncout &lt;&lt; \"Welcome to the Calculator!\\n\";\ncout &lt;&lt; \"What operation would you like to use?\\n\";\ncin &gt;&gt; x;\n\ncout &lt;&lt; \"What will be the first integer?\\n\";\ncin &gt;&gt; y;\n\ncout &lt;&lt; \"What will be the second?\\n\";\ncin &gt;&gt; z;\n\ncout &lt;&lt; \"Computing...\\n\";\ncout &lt;&lt; y &lt;&lt; x &lt;&lt; z;\n</code></pre>\n\n<p>When I execute it, if I enter <code>-</code>, <code>9</code>, and <code>6</code> for each respective prompt, I get the following output:</p>\n\n<pre><code>9-6\n</code></pre>\n\n<p>Likewise, if I enter <code>+</code>, <code>8</code>, and <code>4</code>, I get:</p>\n\n<pre><code>8+4\n</code></pre>\n\n<p>I was expecting the output to be <code>3</code> and <code>12</code>, respectively.</p>\n"}, {"tags": ["c++", "string", "function"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1552516053, "post_id": 55152080, "comment_id": 97044640, "body": "What does your compiler have to say about it?"}, {"owner": {"reputation": 445, "user_id": 4582609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WZ1XW.jpg?s=128&g=1", "display_name": "Jovibor", "link": "https://stackoverflow.com/users/4582609/jovibor"}, "edited": false, "score": 0, "creation_date": 1552516122, "post_id": 55152080, "comment_id": 97044666, "body": "Try path.data() instead."}], "answers": [{"tags": [], "owner": {"reputation": 3538, "user_id": 2464381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/N8MjC.png?s=128&g=1", "display_name": "shrewmouse", "link": "https://stackoverflow.com/users/2464381/shrewmouse"}, "is_accepted": true, "score": 4, "last_activity_date": 1552519293, "last_edit_date": 1552519293, "creation_date": 1552516879, "answer_id": 55152238, "question_id": 55152080, "link": "https://stackoverflow.com/questions/55152080/why-cant-i-pass-a-string-into-the-function-getdrivetypesa/55152238#55152238", "title": "Why can&#39;t I pass a string into the function GetDriveTypesA()?", "body": "<p>Because <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-getdrivetypea\" rel=\"nofollow noreferrer\"><code>GetDriveTypeA()</code></a> takes a <a href=\"https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/f8d4fe46-6be8-44c9-8823-615a21d17a61\" rel=\"nofollow noreferrer\">C string</a>, not a C++ <code>std::string</code>.</p>\n\n<pre><code>UINT GetDriveTypeA(\n  LPCSTR lpRootPathName\n);\n</code></pre>\n\n<p>Use the <a href=\"http://www.cplusplus.com/reference/string/string/c_str/\" rel=\"nofollow noreferrer\"><code>std::string.c_str()</code></a> method:</p>\n\n<pre><code>driveType = GetDriveTypeA(path.c_str());\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11199854, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TiKOJBZ6m44/AAAAAAAAAAI/AAAAAAAAAFU/56iXxSM1-MM/photo.jpg?sz=128", "display_name": "Ginger", "link": "https://stackoverflow.com/users/11199854/ginger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55152238, "answer_count": 1, "score": 0, "last_activity_date": 1552519293, "creation_date": 1552515913, "last_edit_date": 1552516559, "question_id": 55152080, "link": "https://stackoverflow.com/questions/55152080/why-cant-i-pass-a-string-into-the-function-getdrivetypesa", "title": "Why can&#39;t I pass a string into the function GetDriveTypesA()?", "body": "<p>So the aim of the program is to find out what drives are available and what they are. However, I cannot seem to pass a string variable straight into <code>GetDriveTypesA()</code>. But, if I just do <code>GetDriveTypesA(\"C:\\\\\")</code> it works successfully.</p>\n\n<p>Please can someone help me find a solution to this problem the program is below. Thank you :)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;windows.h&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nint main() {\n    int i;\n    int driveType;\n    std::string path;\n    int binary[26] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}; //To save the binary number of the GetLogicalDrives\n    std::string  actualDrives[26];\n    std::string letters[26] = {\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"}; //letters of the alphabet\n    DWORD drives = GetLogicalDrives(); //finds the bit mask of logical drives\n\n    for(i=0; drives&gt;0; i++) { //changes the integer into a binary number\n        binary[i]=drives%2;\n        drives= drives/2;\n    }\n    for (i=0; i&lt;26; i++){ //finds out what drive letters are available\n        if (binary[i]==1){\n            actualDrives[i] = letters[i];\n        }\n    }\n    for (i=0; i&lt;26; i++){ \\trying to find the drive type\n        if (actualDrives[i] != \"\"){\n        cout &lt;&lt; \"Actual drive:\";\n        cout&lt;&lt; actualDrives[i] &lt;&lt;endl;\n        path = actualDrives[i] + \":\\\\\";\n        cout &lt;&lt; path &lt;&lt;endl;\n        driveType = GetDriveTypeA(path); //the part of the code that does not work but does work if a string is just entered\n        cout&lt;&lt; driveType &lt;&lt; endl;\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "templates", "language-lawyer", "type-deduction"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1552515121, "post_id": 55151917, "comment_id": 97044324, "body": "The deduction rules are not easy to follow and make sense of but your code behaves like it should. There is nothing to worry."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1552515254, "post_id": 55151917, "comment_id": 97044370, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/overload_resolution\" rel=\"nofollow noreferrer\">The page on overload resolution at cppreference.com</a>"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 1, "creation_date": 1552519159, "post_id": 55151917, "comment_id": 97045554, "body": "From <a href=\"https://en.cppreference.com/w/cpp/language/function_template#Function_template_overloading\" rel=\"nofollow noreferrer\">cppreference</a> <code>partial ordering selects ... as more specialized</code> and <code>Informally &quot;A is more specialized than B&quot; means &quot;A accepts fewer types than B&quot;.</code>"}, {"owner": {"reputation": 1103, "user_id": 3847255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5ae0e1317d8f367da0af2a68990222?s=128&d=identicon&r=PG&f=1", "display_name": "pooya13", "link": "https://stackoverflow.com/users/3847255/pooya13"}, "reply_to_user": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1552542177, "post_id": 55151917, "comment_id": 97050953, "body": "Thanks guys. @super that was exactly what I was looking for!"}], "answers": [{"comments": [{"owner": {"reputation": 1103, "user_id": 3847255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5ae0e1317d8f367da0af2a68990222?s=128&d=identicon&r=PG&f=1", "display_name": "pooya13", "link": "https://stackoverflow.com/users/3847255/pooya13"}, "edited": false, "score": 0, "creation_date": 1552542096, "post_id": 55151985, "comment_id": 97050922, "body": "Thanks! I just added the language lawyer tag. Do you know if this behaviour is guaranteed according to the deduction rules?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 1103, "user_id": 3847255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5ae0e1317d8f367da0af2a68990222?s=128&d=identicon&r=PG&f=1", "display_name": "pooya13", "link": "https://stackoverflow.com/users/3847255/pooya13"}, "edited": false, "score": 1, "creation_date": 1552542154, "post_id": 55151985, "comment_id": 97050945, "body": "@pooya13, yes, it is."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 4, "last_activity_date": 1552515403, "creation_date": 1552515403, "answer_id": 55151985, "question_id": 55151917, "link": "https://stackoverflow.com/questions/55151917/c-ambiguous-overloaded-template-resolution-deduction/55151985#55151985", "title": "C++ - Ambiguous Overloaded Template Resolution/Deduction", "body": "<p><code>const std::vector&lt;T&gt;&amp; x</code> is a more specialized type than <code>const T&amp; x</code>. A more specialized type is considered a better match for overload resolution. Hence, your code behaves like it should.</p>\n"}], "owner": {"reputation": 1103, "user_id": 3847255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5ae0e1317d8f367da0af2a68990222?s=128&d=identicon&r=PG&f=1", "display_name": "pooya13", "link": "https://stackoverflow.com/users/3847255/pooya13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55151985, "answer_count": 1, "score": 0, "last_activity_date": 1552542471, "creation_date": 1552514948, "last_edit_date": 1552542471, "question_id": 55151917, "link": "https://stackoverflow.com/questions/55151917/c-ambiguous-overloaded-template-resolution-deduction", "title": "C++ - Ambiguous Overloaded Template Resolution/Deduction", "body": "<p>Running the following code snippet, I do not receive any errors and I get my expected result. However, since the second template instantiation is ambiguous (<a href=\"https://www.oreilly.com/library/view/effective-modern-c/9781491908419/ch01.html\" rel=\"nofollow noreferrer\">both type specifiers are references</a>), I am worried that this might not be defined behavior.<br>\n<strong>Is this behavior (that the compiler instantiates the most specific overloaded template) guaranteed?</strong></p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\ntemplate&lt;typename T&gt;\nvoid Print(const T&amp; x)\n{\n    std::cout &lt;&lt; x &lt;&lt; std::endl;\n}\n\ntemplate&lt;typename T&gt;\nvoid Print(const std::vector&lt;T&gt;&amp; x)\n{\n    for(auto it = x.begin(); it != x.end(); ++it)\n    {\n        std::cout &lt;&lt; *it &lt;&lt; \" \";\n    }\n    std::cout &lt;&lt; std::endl;\n}\n\nint main(int argc, char const *argv[])\n{\n    std::vector&lt;int&gt; v = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };\n\n    Print(5); // 5\n    Print(v); // 0 1 2 3 4 5 6 7 8 9\n\n    return 0;\n}\n\n</code></pre>\n\n<p>I am not sure where to look so a good reference is also greatly appreciated.</p>\n"}, {"tags": ["c++", "windows", "cryptoapi", "certificate-store"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1568753913, "post_id": 55151904, "comment_id": 102373062, "body": "Also see <a href=\"https://stackoverflow.com/q/23864214/608639\">Get RSA public key from CRYPT_BIT_BLOB</a>. (The WinHTTP part does not matter for the question and answer)."}], "answers": [{"comments": [{"owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "edited": false, "score": 0, "creation_date": 1552746897, "post_id": 55190427, "comment_id": 97133057, "body": "Thanks for posting this. I adapted the code you posted, but when I dump the memory at <code>pbPKEY</code> it does not look anything like the Public Key shown for the certificate when displaying it in CertMgr.msc.  Am I missing something?"}, {"owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "reply_to_user": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "edited": false, "score": 0, "creation_date": 1552749116, "post_id": 55190427, "comment_id": 97133803, "body": "@NeilWeicher What is the format in which CertMgr.msc display the Public Key? <code>RSA_CSP_PUBLICKEYBLOB</code> is a binary blob format."}, {"owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "edited": false, "score": 0, "creation_date": 1552749780, "post_id": 55190427, "comment_id": 97134033, "body": "The PK in CertMgr is 140 bytes and begins like this: <code>30 81 89 02 81 81 00 E2 84 F5 B5 F2 28 15 AE FE</code>. The blob is 150 bytes and begins like this: <code>06 02 00 00 00 A4 00 00 52 53 41 31 00 04 00 00</code>. The bytes in the PK do not match any sequence in the blob. I assume i have to convert the blob in some way to get the &quot;real&quot; PK?"}, {"owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "edited": false, "score": 0, "creation_date": 1552750304, "post_id": 55190427, "comment_id": 97134231, "body": "Sorry, I meant that the blob is 148 bytes."}, {"owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "reply_to_user": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "edited": false, "score": 0, "creation_date": 1552750651, "post_id": 55190427, "comment_id": 97134359, "body": "@NeilWeicher The PK in CertMgr looks like it is in an ASN encoding. To make the <code>pbKey</code> it is reversed, a header added to it, etc. I think that if you dump the <code>pCertContext-&gt;pCertInfo-&gt;SubjectPublicKeyInfo.PublicKey.pbDa&zwnj;&#8203;ta</code> it should be equal to the value CertMgr shows. I&#39;m curious now."}, {"owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "edited": false, "score": 0, "creation_date": 1552750784, "post_id": 55190427, "comment_id": 97134401, "body": "Yes, I had thought of the reversed bytes too, but that still didn&#39;t match in any way."}], "tags": [], "owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "is_accepted": true, "score": 3, "last_activity_date": 1552682618, "creation_date": 1552682618, "answer_id": 55190427, "question_id": 55151904, "link": "https://stackoverflow.com/questions/55151904/how-to-get-the-public-key-from-a-certificate-in-windows-system-certstore/55190427#55190427", "title": "How to get the public key from a certificate in windows system certstore", "body": "<p>So I found the solution below. With all non-essential for understanding code omitted.</p>\n\n<p>Iterate through the certificates in the store and through its properties to find my certificate, then use the <code>CryptDecodeObjectEx()</code> function to convert the key to the <code>RSA_CSP_PUBLICKEYBLOB</code> format. </p>\n\n<p>The key is kept at this location <code>pCertContext-&gt;pCertInfo-&gt;SubjectPublicKeyInfo.PublicKey.pbData</code> and its size at <code>pCertContext-&gt;pCertInfo-&gt;SubjectPublicKeyInfo.PublicKey.cbData</code>.</p>\n\n<pre><code>HCERTSTORE hCertStore = NULL;\nPCCERT_CONTEXT pCertContext = NULL;\nPBYTE pbPKEY = NULL;\nDWORD iPKEYSize;\n\nhCertStore = CertOpenSystemStore(NULL, L\"MY\");\n\nwhile(pCertContext = CertEnumCertificatesInStore(\n    hCertStore,\n    pCertContext))\n{\n    DWORD dwPropId = 0;\n    while(dwPropId = CertEnumCertificateContextProperties(\n        pCertContext, // The context whose properties are to be listed.\n        dwPropId))    // Number of the last property found.  \n    {\n        // ...\n        // here I compare the properties to see if it is the certificate that I want.\n        // ...\n        CryptDecodeObjectEx((PKCS_7_ASN_ENCODING | X509_ASN_ENCODING), \n            RSA_CSP_PUBLICKEYBLOB, \n            pCertContext-&gt;pCertInfo-&gt;SubjectPublicKeyInfo.PublicKey.pbData, \n            pCertContext-&gt;pCertInfo-&gt;SubjectPublicKeyInfo.PublicKey.cbData, \n            CRYPT_ENCODE_ALLOC_FLAG, \n            NULL, \n            &amp;pbPKEY, \n            &amp;iPKEYSize);\n\n            // pbData and pcbDataLen are output parameters of the function\n            *pcbDataLen = iPKEYSize;\n            memcpy(pbData, pbPKEY, *pcbDataLen);\n            LocalFree((HANDLE)pbPKEY);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1655, "favorite_count": 1, "accepted_answer_id": 55190427, "answer_count": 1, "score": 3, "last_activity_date": 1552682618, "creation_date": 1552514827, "question_id": 55151904, "link": "https://stackoverflow.com/questions/55151904/how-to-get-the-public-key-from-a-certificate-in-windows-system-certstore", "title": "How to get the public key from a certificate in windows system certstore", "body": "<p>I have added a certificate to the system store with something like this:</p>\n\n<pre><code>PCCERT_CONTEXT pCertContext;\nHCERTSTORE hCertStore;\nCRYPT_KEY_PROV_INFO provInfo;\n\nif (pCertContext = CertCreateCertificateContext(MY_ENCODING_TYPE, certDER, certSize)) {\n    provInfo.pwszContainerName = idCert;\n    provInfo.pwszProvName = provName;\n    provInfo.dwProvType = provType;\n    provInfo.dwFlags = 0;\n    provInfo.cProvParam = 0;\n    provInfo.rgProvParam = NULL;\n    provInfo.dwKeySpec = AT_SIGNATURE;\n\n    if (!CertSetCertificateContextProperty(pCertContext, CERT_KEY_PROV_INFO_PROP_ID, 0, &amp;provInfo)) Error(TEXT(\"CertSetCertificateContextProperty\"));\n\n    if (!(hCertStore = CertOpenSystemStore(NULL, L\"MY\"))) Error(TEXT(\"CertOpenSystemStore\"));\n    if (!CertAddCertificateContextToStore(hCertStore, pCertContext, CERT_STORE_ADD_REPLACE_EXISTING, NULL)) Error(TEXT(\"CertAddCertificateContextToStore\"));\n    CertFreeCertificateContext(pCertContext);\n} else Error(TEXT(\"CertCreateCertificateContext\"));\n</code></pre>\n\n<p>Now I'm making a Cryptographyc Service Provider and need to get the public key from this certificate to implement the CPExportKey() function.</p>\n\n<p>Is this possible? If it is, how can I do it?</p>\n\n<p>Also, if someone could point me at a kind of guide, or howto, of CSP drivers implementation it would be great! I'm having a bad time searching documentation for these things.</p>\n"}, {"tags": ["c++", "visual-studio-2017", "dynamic-arrays"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1552514383, "post_id": 55151782, "comment_id": 97044067, "body": "I don&#39;t mean to sound rude, but the compiler errors are telling you the <i>exact</i> problems.  what about them don&#39;t you understand?"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552514435, "post_id": 55151782, "comment_id": 97044093, "body": "Please give the filenames of the shown contents and indicate which lines are those mentioned by the error messages. Add a <code>&#47;&#47; this line error 1&#47;2&#47;3</code> to do so."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1552514468, "post_id": 55151782, "comment_id": 97044100, "body": "You <i>declared</i> <code>void setName(string&amp; new_name);</code> but <i>defined</i> <code>void Player::setName(const string&amp; new_name)</code> - the <code>const</code> means they are different functions"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1552514946, "post_id": 55151782, "comment_id": 97044246, "body": "An aside: <code>bool isSkipTurn()</code> should probably be <code>bool isSkipTurn() const</code>"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1552514997, "post_id": 55151782, "comment_id": 97044269, "body": "Please don&#39;t use snippets. They&#39;re for HTML/CSS/JavaScript, not C++."}, {"owner": {"reputation": 3, "user_id": 9661565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/89fCy.png?s=128&g=1", "display_name": "Luis92", "link": "https://stackoverflow.com/users/9661565/luis92"}, "edited": false, "score": 0, "creation_date": 1552515577, "post_id": 55151782, "comment_id": 97044473, "body": "This is my first time using this site guys. How about show some respect."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9661565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/89fCy.png?s=128&g=1", "display_name": "Luis92", "link": "https://stackoverflow.com/users/9661565/luis92"}, "edited": false, "score": 0, "creation_date": 1552515626, "post_id": 55151909, "comment_id": 97044485, "body": "Thank you I get it now. It fixes the errors, but it now has this: Run-Time Check Failure #3 - The variable &#39;N&#39; is being used without being initialized. occurred"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 3, "user_id": 9661565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/89fCy.png?s=128&g=1", "display_name": "Luis92", "link": "https://stackoverflow.com/users/9661565/luis92"}, "edited": false, "score": 0, "creation_date": 1552518111, "post_id": 55151909, "comment_id": 97045262, "body": "@Luis Look at your code. First you declare <code>N</code>, then you use <code>N</code> then you read <code>N</code>. That&#39;s the wrong order, it should be declare <code>N</code>, read <code>N</code>, use <code>N</code>. Now think about the error message again. Does it make sense now? You can&#39;t use a variable before you&#39;ve given it a value."}, {"owner": {"reputation": 3, "user_id": 9661565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/89fCy.png?s=128&g=1", "display_name": "Luis92", "link": "https://stackoverflow.com/users/9661565/luis92"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1552597726, "post_id": 55151909, "comment_id": 97083300, "body": "@john I get it now. I just declare  int N = 0;"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 3, "user_id": 9661565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/89fCy.png?s=128&g=1", "display_name": "Luis92", "link": "https://stackoverflow.com/users/9661565/luis92"}, "edited": false, "score": 0, "creation_date": 1552598535, "post_id": 55151909, "comment_id": 97083652, "body": "@Luis No, because that gives <code>N</code> a value so the error goes away, but you&#39;ve given it the wrong value, the correct value is not zero its that value you read from the file. The order that things occur in your program is important, in particular you have to give variables the values that you want <b>before</b> you use those variables in other calculations, so <code>file1 &gt;&gt; N;</code> must be before <code>player = new Player[N];</code> and <code>names = new string[N];</code> not afterwards."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 3, "user_id": 9661565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/89fCy.png?s=128&g=1", "display_name": "Luis92", "link": "https://stackoverflow.com/users/9661565/luis92"}, "edited": false, "score": 0, "creation_date": 1552598774, "post_id": 55151909, "comment_id": 97083751, "body": "@Luis Your program is a sequence of instructions that are executed in the order they are given. What you have is like a recipe that says 1) Mix the sugar and the butter, 2) weigh out a 1/4 pound of sugar. The order is back to front."}], "tags": [], "owner": {"reputation": 481, "user_id": 2863895, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100001494632024/picture?type=large", "display_name": "Da Teng", "link": "https://stackoverflow.com/users/2863895/da-teng"}, "is_accepted": true, "score": 0, "last_activity_date": 1552517835, "last_edit_date": 1552517835, "creation_date": 1552514866, "answer_id": 55151909, "question_id": 55151782, "link": "https://stackoverflow.com/questions/55151782/simple-race-game-with-dynamic-array-in-c/55151909#55151909", "title": "simple race game with dynamic array in c++", "body": "<p>Let's look at the compiler error.</p>\n\n<pre><code>Error C2664 'void Player::setName(std::string &amp;)': cannot convert argument 1 from 'const std::string' to 'std::string &amp;' player.cpp 7\n</code></pre>\n\n<p>It is complaining that it cannot convert <code>const std::string</code> to <code>std::string</code> when calling the <code>setName()</code> function at line 7 of player.cpp. But we have a <code>setName</code> function in the player class, right? What's wrong?</p>\n\n<p>If you look at it more carefully in your Player.h, the declaration of the function <code>setName</code> is missing the <code>const</code> attribute.</p>\n\n<pre><code>void setName(string&amp; new_name);\n</code></pre>\n\n<p>If you add <code>const</code> to this that will solve it.</p>\n"}], "owner": {"reputation": 3, "user_id": 9661565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/89fCy.png?s=128&g=1", "display_name": "Luis92", "link": "https://stackoverflow.com/users/9661565/luis92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 55151909, "answer_count": 1, "score": -2, "last_activity_date": 1552517901, "creation_date": 1552514131, "last_edit_date": 1552517901, "question_id": 55151782, "link": "https://stackoverflow.com/questions/55151782/simple-race-game-with-dynamic-array-in-c", "title": "simple race game with dynamic array in c++", "body": "<p>I was doing homework for a C++ game that we have to do from CO SCI 136 class and the instructions states:</p>\n\n<p>Modify your Homework 4 Problem 1 solution thus: </p>\n\n<ol>\n<li>Replace the array with a dynamic array</li>\n<li>Read the winning points M from a file</li>\n<li>Read the number of players N from a file</li>\n<li>Read the player names from a file.</li>\n</ol>\n\n<p>I am using Visual Studio 2017 and I am having trobule with these errors:</p>\n\n<pre><code>Error   C2664   'void Player::setName(std::string &amp;)': cannot convert argument 1 from 'const std::string' to 'std::string &amp;'    player.cpp  7   \nError   C2511   'void Player::setName(const std::string &amp;)': overloaded member function not found in 'Player'   player.cpp  18  \nError   C2597   illegal reference to non-static member 'Player::name'   player.cpp  19  \n</code></pre>\n\n<p>Is there any way to fix these errors?</p>\n\n<p>Here are my codes of </p>\n\n<p>player.h</p>\n\n<pre><code>#pragma once\n#include &lt;string&gt;\nusing namespace std;\n\nclass Player\n{\nprivate:\n    string name;\n    int points;\n    bool skipturn = false;\n\npublic:\n    Player(const string&amp; new_name = \"No Name\");\n    string getName() const;\n    int getPoints() const;\n    void setName(string&amp; new_name);\n    void setPoints(int new_points);\n    void setLossHalfPoints();\n    void setSkipTurn(bool isSkip);\n    bool isSkipTurn();\n};\n</code></pre>\n\n<p>player.cpp</p>\n\n<pre><code>#include &lt;string&gt;\nusing namespace std;\n#include \"player.h\"\n\nPlayer::Player(const string&amp; new_name)\n{\n    setName(new_name);\n}\nstring Player::getName() const\n{\n    return name;\n}\nint Player::getPoints() const\n{\n    return points;\n}\nvoid Player::setName(const string&amp; new_name)\n{\n    name = new_name;\n}\nvoid Player::setPoints(int new_points)\n{\n    points = new_points;\n}\n\nvoid Player::setLossHalfPoints()\n{\n    this-&gt;points /= 2;\n}\n\nvoid Player::setSkipTurn(bool isSkip)\n{\n    this-&gt;skipturn = isSkip;\n}\n\nbool Player::isSkipTurn()\n{\n    return this-&gt;skipturn;\n}\n</code></pre>\n\n\n\n<p>source.cpp</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;ctime&gt;\n#include &lt;iomanip&gt;\n#include &lt;random&gt;\n#include&lt;fstream&gt;\n#include \"player.h\"\nusing namespace std;\n\nint main()\n{\n    int M;\n    int N;\n\n    Player *player; //Declaring as a dynamic array\n    player = new Player[N];\n    string *names;\n    names = new string[N];\n    ifstream file, file1, file2; //opening the file in read mode\n    string line;\n    file.open(\"Mdata.dat\");\n    file &gt;&gt; M; //Reading the M data from the file\n    file.close();\n    file1.open(\"Ndata.dat\");\n    file1 &gt;&gt; N; //Reading the N data from the file\n    file1.close();\n\n    file2.open(\"names.dat\");\n    if (file2.is_open()) //if the file is open\n    {\n        while (!file2.eof()) //while the end of file is NOT reached\n        {\n            getline(file2, line); //get one line from the file\n            for (int i = 0; i&lt;N; i++)\n            {\n                names[i] = line; //reading names from file into names array\n            }\n        }\n        file2.close();\n    }\n\n    for (int i = 0; i &lt; N; i++) //setting the player names from names array\n    {\n        player[i].setName(names[i]); player[i].setPoints(0);\n    }\n\n    default_random_engine dre(17890714);\n    uniform_int_distribution&lt;int&gt; player_uid(0, N - 1);\n    uniform_int_distribution&lt;int&gt; dice_uid(1, 6);\n    int index = player_uid(dre);\n    do\n    {\n        index = (index + 1) % N;//implements circular array\n        if (player[index].isSkipTurn())\n        {\n            cout &lt;&lt; player[index].getName() &lt;&lt; '/' &lt;&lt; setw(2) &lt;&lt; \"skip turn\" &lt;&lt; endl;\n            player[index].setSkipTurn(false);// clear skip turn\n            index = (index + 1) % N;//implements circular array\n        }\n        int die1 = dice_uid(dre);\n        int die2 = dice_uid(dre);\n        int points = player[index].getPoints();\n        player[index].setPoints(points + die1 + die2);\n        if (player[index].getPoints() &gt; M)\n        {\n            player[index].setLossHalfPoints();// set half of then points\n            player[index].setSkipTurn(true);// set skip turn   \n            cout &lt;&lt; player[index].getName() &lt;&lt; '/' &lt;&lt; setw(2) &lt;&lt; player[index].getPoints() &lt;&lt; '/' &lt;&lt; setw(2) &lt;&lt; player[index].getPoints() * 2 &lt;&lt; endl;\n        }\n        else {\n            cout &lt;&lt; player[index].getName() &lt;&lt; '/' &lt;&lt; setw(2) &lt;&lt; die1 + die2 &lt;&lt; '/' &lt;&lt; setw(2) &lt;&lt; player[index].getPoints() &lt;&lt; endl;\n        }\n    } while (player[index].getPoints() != M);\n    cout &lt;&lt; player[index].getName() &lt;&lt; \" wins\" &lt;&lt; endl;\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "loops", "for-loop"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1552514245, "post_id": 55151761, "comment_id": 97044014, "body": "Presumably <code>engine_tick</code> returns a value that can be evaluated to <code>true</code> or <code>false</code>. Also this is pretty awful code"}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 2, "creation_date": 1552514248, "post_id": 55151761, "comment_id": 97044015, "body": "This is equivalent to <code>while (true) { if (!engine_tick()) break; kRuntimeStatistics::INSTANCE.FramesSinceStart++; }</code>. Presumably the <code>engine_tick()</code> function call is what&#39;s doing all the work, and it returns a <code>bool</code>-ish type that will stop the loop if it ever returns <code>false</code>y."}, {"owner": {"reputation": 127, "user_id": 10826121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cMQw7ELRuk/AAAAAAAAAAI/AAAAAAAAACQ/lB4jTdi0goI/photo.jpg?sz=128", "display_name": "xX_EASY HD LP MC AWP GOD_Xx", "link": "https://stackoverflow.com/users/10826121/xx-easy-hd-lp-mc-awp-god-xx"}, "edited": false, "score": 0, "creation_date": 1552514338, "post_id": 55151761, "comment_id": 97044046, "body": "that makes sence! but whats that 0xaull"}, {"owner": {"reputation": 127, "user_id": 10826121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cMQw7ELRuk/AAAAAAAAAAI/AAAAAAAAACQ/lB4jTdi0goI/photo.jpg?sz=128", "display_name": "xX_EASY HD LP MC AWP GOD_Xx", "link": "https://stackoverflow.com/users/10826121/xx-easy-hd-lp-mc-awp-god-xx"}, "edited": false, "score": 0, "creation_date": 1552514397, "post_id": 55151761, "comment_id": 97044075, "body": "but the code was written by a professional and it is not wrong or is it? with awful you mean readability right?"}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1552514433, "post_id": 55151761, "comment_id": 97044092, "body": "<code>0xaull</code> is <code>0xa</code> (hex for 10) with the <a href=\"https://en.cppreference.com/w/c/language/integer_constant\" rel=\"nofollow noreferrer\">literal suffix</a> <code>ull</code> (<code>unsigned long long</code>). The code is &quot;right&quot; in the sense that it&#39;s not wrong, but it&#39;s difficult to read and overcomplicated."}], "answers": [{"comments": [{"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1552521039, "post_id": 55151803, "comment_id": 97046027, "body": "I would recommend not using an empty statement for a <code>for()</code> loop. I would rather use the empty block <code>{ &#47;* do nothing *&#47; }</code>"}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 4, "last_activity_date": 1552517744, "last_edit_date": 1552517744, "creation_date": 1552514264, "answer_id": 55151803, "question_id": 55151761, "link": "https://stackoverflow.com/questions/55151761/can-somebody-explain-this-weird-loop-for-me/55151803#55151803", "title": "Can somebody explain this weird loop for me?", "body": "<h3>General case</h3>\n\n<p>No the <a href=\"https://en.cppreference.com/w/cpp/language/for\" rel=\"nofollow noreferrer\"><code>for</code> loop</a> is for any kind of iterative processing. Not only for numbers.</p>\n\n<p>The statement </p>\n\n<pre><code>for (a;b;c) \n   d; \n</code></pre>\n\n<p>is (almost) the same as</p>\n\n<pre><code>{\n    a;\n    while (b) {\n        d; \n        c; \n    }\n}\n</code></pre>\n\n<p>The empty body means that the main benefit is already in the a,b and c.  </p>\n\n<h3>Application to your statement</h3>\n\n<p>So  for your statement:  </p>\n\n<pre><code>for (register unsigned long long i = 0xaull; engine_tick(); kRuntimeStatistics::INSTANCE.FramesSinceStart++, ++ i); \n</code></pre>\n\n<p>it's the same as </p>\n\n<pre><code>{\n    register unsigned long long i = 0xaull;\n    while (engine_tick()) {\n        kRuntimeStatistics::INSTANCE.FramesSinceStart++; \n        ++ i;  \n    }\n}\n</code></pre>\n\n<h3>Several remarks:</h3>\n\n<ul>\n<li>the empty for body, with semicolon at the end of the line is extremely error prone (I spent a whole night debugging some code once, just to figure out that I didn't see the semicolumn, so that I was mislead by the indentation).  I'd therefore recommend to put the <a href=\"https://stackoverflow.com/a/10097230/3723423\">semicolumn on the next line</a> with proper indentation, just to draw attention on the potential trap.</li>\n<li>the <a href=\"https://en.cppreference.com/w/cpp/language/storage_duration\" rel=\"nofollow noreferrer\"><code>register</code></a> has no longer added value, since the compiler's optimizer do much better job than the manual selection of register variables. It is even deprecated now.   </li>\n<li>the <a href=\"https://en.cppreference.com/w/cpp/language/operator_other\" rel=\"nofollow noreferrer\">comma operator</a> allows to combine two expression in one. I've translated this in a semi-column for the sake of clarity. Note that the <code>++i</code> could have been moved to the for body in the original code for the same reason.  </li>\n<li><code>0xaull</code> means that it is an hexadecimal <a href=\"https://en.cppreference.com/w/cpp/language/integer_literal\" rel=\"nofollow noreferrer\">literal</a> (<code>0x</code>) of value <code>a</code> (A in hexadecimal is 10) of type <code>unsigned long long</code>. </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 9301209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858c777efaf3e214794653dc699aa6a1?s=128&d=identicon&r=PG&f=1", "display_name": "aokellermann", "link": "https://stackoverflow.com/users/9301209/aokellermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1552514313, "creation_date": 1552514313, "answer_id": 55151812, "question_id": 55151761, "link": "https://stackoverflow.com/questions/55151761/can-somebody-explain-this-weird-loop-for-me/55151812#55151812", "title": "Can somebody explain this weird loop for me?", "body": "<p>It will exit when engine_tick() returns false. A while statement doesn't need a body.\nThe ull on the end of 0xa just specifies that its an unsigned long long, while the 0x specifies that its in hex.</p>\n"}], "owner": {"reputation": 127, "user_id": 10826121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cMQw7ELRuk/AAAAAAAAAAI/AAAAAAAAACQ/lB4jTdi0goI/photo.jpg?sz=128", "display_name": "xX_EASY HD LP MC AWP GOD_Xx", "link": "https://stackoverflow.com/users/10826121/xx-easy-hd-lp-mc-awp-god-xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 55151803, "answer_count": 2, "score": -1, "last_activity_date": 1552517744, "creation_date": 1552514019, "last_edit_date": 1552515111, "question_id": 55151761, "link": "https://stackoverflow.com/questions/55151761/can-somebody-explain-this-weird-loop-for-me", "title": "Can somebody explain this weird loop for me?", "body": "<p>im newer to c++ and today i looked at a game engine main render loop wich looked like this:</p>\n\n<pre><code>for (register unsigned long long i = 0xaull; engine_tick(); kRuntimeStatistics::INSTANCE.FramesSinceStart++, ++ i); \n</code></pre>\n\n<p>Why did it have any body and when it is exitting? I tought for loops ar for numbers only :/ And what does 0xaull mean behind the long i?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1552513875, "post_id": 55151628, "comment_id": 97043876, "body": "try changing <code>run();</code> to <code>QTimer::singleShot(0, this, &amp;GameLoop::run);</code> and have that <code>run()</code> be a slot."}, {"owner": {"reputation": 77, "user_id": 11126897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hfkL5.jpg?s=128&g=1", "display_name": "black_gay", "link": "https://stackoverflow.com/users/11126897/black-gay"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1552514375, "post_id": 55151628, "comment_id": 97044064, "body": "But my interest is in why the infinite loop in the separate thread is still disrupring the signal slot system."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1552514424, "post_id": 55151628, "comment_id": 97044087, "body": "I do not know what are you talking about."}, {"owner": {"reputation": 77, "user_id": 11126897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hfkL5.jpg?s=128&g=1", "display_name": "black_gay", "link": "https://stackoverflow.com/users/11126897/black-gay"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1552514690, "post_id": 55151628, "comment_id": 97044156, "body": "I meant to ask, why in the code above, the QTimer fires mySlot whenconsole-&gt;loop(); is commented out. Isnt it that putting something into a separate thread gives it &quot;own life&quot;? Yet calling console-&gt;loop() prvents mySlot from being fired"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1552515008, "post_id": 55151628, "comment_id": 97044274, "body": "Is that the run method  is not executed in the thread where GameLoop lives but in the thread where GameLoop was created that is very different since you are using moveToThread. I assume that the GameLoop was created in the main thread so the run method is blocking the event-loop, the event-loop of Qt is what allows the operation of signals, timers, events, etc. For that reason it does not work, instead with my suggestion the run method would be executed in the thread where the GameLoop lives. Have you tried my suggestion?"}, {"owner": {"reputation": 77, "user_id": 11126897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hfkL5.jpg?s=128&g=1", "display_name": "black_gay", "link": "https://stackoverflow.com/users/11126897/black-gay"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1552593189, "post_id": 55151628, "comment_id": 97081114, "body": "I&#39;ve found solution and described in the answer. Kiss Kiss."}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 11126897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hfkL5.jpg?s=128&g=1", "display_name": "black_gay", "link": "https://stackoverflow.com/users/11126897/black-gay"}, "is_accepted": false, "score": 0, "last_activity_date": 1552593087, "creation_date": 1552593087, "answer_id": 55170940, "question_id": 55151628, "link": "https://stackoverflow.com/questions/55151628/qthread-dedicated-to-infinite-loop/55170940#55170940", "title": "QThread dedicated to infinite loop", "body": "<p>The solution that solved my problem is as follows in the code below, this way the infinite loop is in a thread decicated to it:</p>\n\n<pre><code>#include \"gameloop.h\"\n#include &lt;QThread&gt;\nGameLoop::GameLoop(QObject *parent) : QObject(parent)\n{\n    std::cout &lt;&lt; \"GameLoop thread: \" &lt;&lt; QThread::currentThreadId()  &lt;&lt; \"\\n\";\n    timer = new QTimer;\n    timer-&gt;start(3000);\n    connect(timer, SIGNAL(timeout()), this, SLOT(mySlot())); //timers\n\n    thread1 = new QThread;\n\n    console.moveToThread(thread1);\n    thread1-&gt;start();\n    connect(thread1, SIGNAL(started()), &amp;console, SLOT(mySlotActivationLoop()));\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 11126897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hfkL5.jpg?s=128&g=1", "display_name": "black_gay", "link": "https://stackoverflow.com/users/11126897/black-gay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1552593087, "creation_date": 1552513291, "last_edit_date": 1552513672, "question_id": 55151628, "link": "https://stackoverflow.com/questions/55151628/qthread-dedicated-to-infinite-loop", "title": "QThread dedicated to infinite loop", "body": "<p>So i want to create a separared thread for my infinite while loop. How to fix the code below so it doesnt break the signal slot connection?</p>\n\n<pre><code>#include \"gameloop.h\"\n\nGameLoop::GameLoop(QObject *parent) : QObject(parent)\n{\n    timer = new QTimer;\n    connect(timer, SIGNAL(timeout()), this, SLOT(mySlot()));\n    timer-&gt;start(500);\n    thread = new QThread();\n    console = new Console;\n    console-&gt;moveToThread(thread);\n    thread-&gt;start();\n\n    run();\n}\n\nGameLoop::~GameLoop()\n{\n    std::cout &lt;&lt; \"GameLoop() Destructor\" &lt;&lt; \"\\n\";\n}\n\nvoid GameLoop::run()\n{\n     console-&gt;loop();\n}\n\n\n\nvoid GameLoop::mySlot()\n{\n    std::cout &lt;&lt; \"mySlot\" &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Member function loop() in the class Console contains while(1).</p>\n"}, {"tags": ["android", "c++", "cmake", "poco-libraries", "conan"], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 2842405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2DZvj.jpg?s=128&g=1", "display_name": "Bo\u0161tjan Biber", "link": "https://stackoverflow.com/users/2842405/bo%c5%a1tjan-biber"}, "is_accepted": true, "score": 0, "last_activity_date": 1552995581, "creation_date": 1552995581, "answer_id": 55240174, "question_id": 55151574, "link": "https://stackoverflow.com/questions/55151574/building-poco-c-libraries-with-conan-profiles-for-android/55240174#55240174", "title": "Building Poco C++ libraries with Conan profiles for Android", "body": "<p>While this issue is not yet solved by the way exposed above, I figured out that it works with conan packages by using the following combination:</p>\n\n<p>conanfile.py:</p>\n\n<pre><code>requires = \"OpenSSL/1.0.2r@conan/stable\", \"Poco/1.9.0@pocoproject/stable\"\n</code></pre>\n\n<p>~/.conan/profiles/android</p>\n\n<pre><code># ------------------------------------------------------------------------------\n# PARAMETERS\n\n    target_host=armv7a-linux-androideabi\n    ar_host=arm-linux-androideabi\n\n    api_level=21\n    cc_compiler=clang\n    cxx_compiler=clang++\n\n# ------------------------------------------------------------------------------\n\n[settings]\n\n    os_build=Linux\n    arch_build=x86_64\n\n    compiler=clang\n    compiler.version=8\n    compiler.libcxx=libc++\n    os=Android\n    os.api_level=$api_level\n    arch=armv7\n\n    build_type=Release\n\n# ------------------------------------------------------------------------------\n\n[build_requires]\n\n    android_ndk_installer/r19b@bincrafters/stable\n\n# ------------------------------------------------------------------------------\n\n[options]\n\n    OpenSSL:shared=False\n\n    OpenSSL:no_threads=False\n    OpenSSL:no_zlib=False\n    OpenSSL:no_asm=True\n    OpenSSL:386=False\n    OpenSSL:no_sse2=False\n    OpenSSL:no_bf=False\n    OpenSSL:no_cast=False\n    OpenSSL:no_des=False\n    OpenSSL:no_dh=False\n    OpenSSL:no_cast=False\n    OpenSSL:no_dsa=False\n    OpenSSL:no_hmac=False\n    OpenSSL:no_md2=False\n    OpenSSL:no_md5=False\n    OpenSSL:no_rc2=False\n    OpenSSL:no_rc4=False\n    OpenSSL:no_rc5=False\n    OpenSSL:no_rsa=False\n    OpenSSL:no_sha=False\n\n    Poco:shared=False\n\n    Poco:enable_tests=False\n    Poco:cxx_14=True\n    Poco:force_openssl=True\n\n    Poco:enable_xml=True\n    Poco:enable_json=True\n    Poco:enable_mongodb=False\n    Poco:enable_pdf=False\n    Poco:enable_util=True\n    Poco:enable_net=True\n    Poco:enable_netssl=True\n    Poco:enable_netssl_win=False\n    Poco:enable_crypto=True\n    Poco:enable_data=False\n    Poco:enable_data_sqlite=False\n    Poco:enable_data_mysql=False\n    Poco:enable_data_odbc=False\n    Poco:enable_sevenzip=False\n    Poco:enable_zip=True\n    Poco:enable_sevenzip=True\n    Poco:enable_apacheconnector=False\n    Poco:enable_cppparser=True\n    Poco:enable_pocodoc=False\n    Poco:enable_pagecompiler=False\n    Poco:enable_pagecompiler_file2page=False\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2842405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2DZvj.jpg?s=128&g=1", "display_name": "Bo\u0161tjan Biber", "link": "https://stackoverflow.com/users/2842405/bo%c5%a1tjan-biber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 1, "accepted_answer_id": 55240174, "answer_count": 1, "score": 0, "last_activity_date": 1552995581, "creation_date": 1552512956, "question_id": 55151574, "link": "https://stackoverflow.com/questions/55151574/building-poco-c-libraries-with-conan-profiles-for-android", "title": "Building Poco C++ libraries with Conan profiles for Android", "body": "<p>I am trying to use Poco C++ Libraries in the project and I ran into some problems when building for Android.</p>\n\n<p>I am using Conan C++ package manager as a base but I included Poco sources into the project and including its subdirectory into project's top level CMakeLists.txt to make the process more transparent.</p>\n\n<p>If I build project with Poco libraries which don't depend on OpenSSL it builds fine. If I add Poco's NetSSL then I get some math.h related problems:</p>\n\n<pre><code>In file included from /home/uname/storage/projects/-some-project-/thirdparty/poco/Crypto/src/Cipher.cpp:15:\nIn file included from /home/uname/storage/projects/-some-project-/thirdparty/poco/Crypto/include/Poco/Crypto/Cipher.h:22:\nIn file included from /home/uname/storage/projects/-some-project-/thirdparty/poco/Foundation/include/Poco/RefCountedObject.h:22:\nIn file included from /home/uname/storage/projects/-some-project-/thirdparty/poco/Foundation/include/Poco/MemoryPool.h:24:\nIn file included from /home/uname/storage/projects/-some-project-/thirdparty/poco/Foundation/include/Poco/NestedDiagnosticContext.h:24:\nIn file included from /home/uname/storage/projects/-some-project-/thirdparty/poco/Foundation/include/Poco/OrderedMap.h:28:\nIn file included from /home/uname/storage/projects/-some-project-/thirdparty/poco/Foundation/include/Poco/ordered_hash.h:31:\n/home/uname/.conan/data/android-ndk/r18/theodelrieu/testing/package/2296cbf988942dec6e0ebdfef682b5c678acade8/sources/cxx-stl/llvm-libc++/include/cmath:313:9: error: no member named 'signbit' in the global\n      namespace; did you mean '__signbit'?\nusing ::signbit;\n      ~~^\n/usr/include/bits/mathcalls-helper-functions.h:25:20: note: '__signbit' declared here\n__MATHDECL_1 (int, __signbit,, (_Mdouble_ __value))\n</code></pre>\n\n<p>As far as I know this is due to the C-only math.h beeing included earlier in path as libc++ math.h . Does anyone have an idea how to solve that problem?</p>\n\n<p>Actually I am trying to find a solution to build and link Poco libraries which do not build correctly for Android (due to some build issues with OpenSSL dependency) when using Conan dependencies and build requirements android-ndk/r18@theodelrieu/testing or android_ndk_installer/r19b@bincrafters/stable on Ubuntu 18.04. Therefore I'm trying to build Poco libraries and OpenSSL it without using Conan packages.</p>\n\n<p>Thank you in advance for any hint or idea!</p>\n\n<p>This is my Conan profile for Android:</p>\n\n<pre><code># --------------------------------------------------------------------------------------------------------------------\n# PARAMETERS\n\n    #standalone_toolchain=/home/uname/Android/ndk/android-ndk-r19b/toolchains/llvm/prebuilt/linux-x86_64\n\n    target_host=armv7a-linux-androideabi\n    ar_host=arm-linux-androideabi\n\n    api_level=21\n    cc_compiler=clang\n    cxx_compiler=clang++\n\n# --------------------------------------------------------------------------------------------------------------------\n\n[settings]\n\n    os_build=Linux\n    arch_build=x86_64\n\n    compiler=clang\n    compiler.version=7.0\n    compiler.libcxx=libc++\n    os=Android\n    os.api_level=$api_level\n    arch=armv7\n\n    #Debug/Release\n    build_type=Debug\n\n# --------------------------------------------------------------------------------------------------------------------\n\n[build_requires]\n\n    android-ndk/r18@theodelrieu/testing\n    #android_ndk_installer/r19b@bincrafters/stable\n\n# --------------------------------------------------------------------------------------------------------------------\n\n[options]\n\n    *:shared=False\n    #Poco:no_asm=True\n\n# --------------------------------------------------------------------------------------------------------------------\n\n[env]\n\n    CONAN_CMAKE_FIND_ROOT_PATH=$standalone_toolchain/sysroot\n    PATH=[$standalone_toolchain/bin]\n    CHOST=$target_host\n\n    # Flags can be also appended after the path to the compiler\n    CC=$target_host$api_level-$cc_compiler\n    CXX=$target_host$api_level-$cxx_compiler\n\n    CMAKE_C_COMPILER=$CC\n    CMAKE_CXX_COMPILER=$CXX\n\n    AR=$ar_host-ar\n    AS=$ar_host-as\n\n    RANLIB=$target_host-ranlib\n    LD=$target_host-ld\n    STRIP=$target_host-strip\n    CFLAGS= -fPIE -fPIC -I$standalone_toolchain/include/c++/4.9.x\n    CXXFLAGS= -fPIE -fPIC -I$standalone_toolchain/include/c++/4.9.x\n    LDFLAGS= -pie\n\n    export ANDROID_API=$api_level\n\n    OpenSSL:compiler=clang\n    OpenSSL:options.no_zlib=True\n</code></pre>\n\n<p>And root CMakeLists.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(-some-project-)\n\ninclude(${CMAKE_BINARY_DIR}/conanbuildinfo.cmake)\nconan_basic_setup()\n\n## Experimental POCO\n\ninclude_directories(${CMAKE_CURRENT_SOURCE_DIR}/thirdparty/openssl/include) # Path whererever the openssl-dev headers are present\n\n# When compiling the POCO C++ Libraries for a Android target, as well as when including POCO C++ Libraries headers in a project for a Android target, the preprocessor macro POCO_ANDROID must be defined. This is because the Android NDK GCC compiler does not provide a predefined macro that allows for reliable detection of an Android target.\nIF(ANDROID)\nSET(POCO_ANDROID)\nENDIF()\n\nSET(ENABLE_ENCODINGS OFF)\nSET(ENABLE_ENCODINGS_COMPILER OFF)\nSET(ENABLE_XML OFF)\nSET(ENABLE_JSON ON)\nSET(ENABLE_MONGODB OFF)\nSET(ENABLE_REDIS OFF)\nSET(ENABLE_PDF OFF)\nSET(ENABLE_UTIL OFF)\nSET(ENABLE_NET ON)\nSET(ENABLE_NETSSL ON)\nSET(ENABLE_NETSSL_WIN OFF)\nSET(ENABLE_CRYPTO OFF)\nSET(ENABLE_DATA OFF)\nSET(ENABLE_DATA_SQLITE OFF)\nSET(ENABLE_DATA_MYSQL OFF)\nSET(ENABLE_DATA_ODBC OFF)\nSET(ENABLE_SEVENZIP OFF)\nSET(ENABLE_ZIP OFF)\nSET(ENABLE_APACHECONNECTOR OFF)\nSET(ENABLE_CPPPARSER OFF)\nSET(ENABLE_POCODOC OFF)\nSET(ENABLE_PAGECOMPILER OFF)\nSET(ENABLE_PAGECOMPILER_FILE2PAGE OFF)\n\nSET(FORCE_OPENSSL OFF)      # Force usage of OpenSSL even under windows\nSET(ENABLE_TESTS OFF)       # Set to OFF|ON (default is OFF) to control build of POCO tests &amp; samples\nSET(POCO_STATIC ON)         # Set to OFF|ON (default is OFF) to control build of POCO as STATIC library\nSET(POCO_UNBUNDLED OFF)     # Set to OFF|ON (default is OFF) to control linking dependencies as external\n\nSET(POCO_BUILD_TYPE \"Release\")\n\nadd_subdirectory(thirdparty/poco)\n\n#SET(OPENSSL_INCLUDE_DIR \"${CMAKE_CURRENT_SOURCE_DIR}/thirdparty/openssl\")\n\n## \\Experimental POCO\n\nadd_subdirectory(src)\n\nIF(CMAKE_BUILD_TYPE STREQUAL \"Debug\")\nadd_subdirectory(test)\nENDIF()\n</code></pre>\n\n<p>PS: Am I using the right approach or should I try to include and build Poco libraries and OpenSSL for Android differently? Main targets are Android and iOS devices and local macOS or Linux for development and testing.</p>\n"}, {"tags": ["c++", "while-loop", "text-files", "ifstream"], "comments": [{"owner": {"reputation": 23, "user_id": 6169779, "user_type": "registered", "profile_image": "https://graph.facebook.com/1252451331449284/picture?type=large", "display_name": "javaNoob", "link": "https://stackoverflow.com/users/6169779/javanoob"}, "edited": false, "score": 0, "creation_date": 1552512324, "post_id": 55151394, "comment_id": 97043201, "body": "wow, I can&#39;t believe I didn&#39;t see this. So then I need to change it to tempLine.erase"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1552512462, "post_id": 55151394, "comment_id": 97043258, "body": "@javaNoob please don&#39;t edit the question like you did. You changed the semantics of the code, invalidating the comments given.  I have reverted your edit.  If you want, you can post your own answer instead."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1552513002, "last_edit_date": 1552513002, "creation_date": 1552512669, "answer_id": 55151518, "question_id": 55151394, "link": "https://stackoverflow.com/questions/55151394/program-never-gets-to-the-part-where-i-can-input-information/55151518#55151518", "title": "Program never gets to the part where I can input information", "body": "<p>The following line of code is wrong:</p>\n\n<pre><code> while ((pos = tempLine.find(delimiter2)) != string::npos) {\n    token = tempLine.substr(0, pos);\n    storeTokenPairs.push_back(token);\n    line.erase(0, pos + delimiter2.length()); // &lt;-- HERE\n}\n</code></pre>\n\n<p>You are never modifying <code>tempLine</code>, so the loop runs endlessly if <code>delimiter2</code> is found in <code>tempLine</code>.</p>\n\n<p>You need to replace <code>line</code> with <code>tempLine</code> instead:</p>\n\n<pre><code>tempLine.erase(0, pos + delimiter2.length());\n</code></pre>\n\n<p>Alternatively, you don't actually need to modify <code>tempLine</code> at all, as <code>find()</code> takes an optional start index as input:</p>\n\n<pre><code>size_t start = 0, pos;\n\nwhile ((pos = tempLine.find(delimiter2, start)) != string::npos) {\n    token = tempLine.substr(start, pos-start);\n    storeTokenPairs.push_back(token);\n    start = pos + delimiter2.length();\n}\n\nif (start &lt; tempLine.length()) {\n    token = tempLine.substr(start);\n    storeTokenPairs.push_back(token);\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6169779, "user_type": "registered", "profile_image": "https://graph.facebook.com/1252451331449284/picture?type=large", "display_name": "javaNoob", "link": "https://stackoverflow.com/users/6169779/javanoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55151518, "answer_count": 1, "score": 0, "last_activity_date": 1552513683, "creation_date": 1552512068, "last_edit_date": 1552512422, "question_id": 55151394, "link": "https://stackoverflow.com/questions/55151394/program-never-gets-to-the-part-where-i-can-input-information", "title": "Program never gets to the part where I can input information", "body": "<p>When I run the program the output window prints out the line \"! Loading Data...\" but it seems it's stuck in a loop endlessly. As far as I can tell the while loop is set up correctly, but after plugging away I am at a loss.</p>\n\n<pre><code>ifstream myfile(\"Data.CS.txt\");\n\nif (!myfile) { //Always test the file open. \n    cout &lt;&lt; \"Error opening output file\" &lt;&lt; endl;\n    system(\"pause\");\n    return -1;\n}\ncout &lt;&lt; endl;\ncout &lt;&lt; \"! Loading Data...\";\nwhile (getline(myfile, line)) {\n    string delimiter = \"|\";\n    string delimiter2 = \"-=&gt;\";\n\n    size_t pos = 0;\n    string tempLine;\n    string tokenName;\n\n    string token;\n    string token2;\n\n    vector &lt;string&gt; storeTokenPairs;\n\n    tokenName = line.substr(0, pos);\n    tempLine = line.erase(0, pos + delimiter.length());\n\n    while ((pos = tempLine.find(delimiter2)) != string::npos) {\n        token = tempLine.substr(0, pos);\n        storeTokenPairs.push_back(token);\n        line.erase(0, pos + delimiter2.length());\n\n    }\n    for (int i=0; i&lt;storeTokenPairs.size(); i++)\n        dictionary.emplace(tokenName, make_pair(storeTokenPairs[i], storeTokenPairs[i+1]));\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "qt", "user-interface", "cmake"], "answers": [{"comments": [{"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1552514861, "post_id": 55151776, "comment_id": 97044216, "body": "he doesn&#39;t define any own <code>QObject</code> or any UI so this has not impact on this issue."}], "tags": [], "owner": {"reputation": 71, "user_id": 9301209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858c777efaf3e214794653dc699aa6a1?s=128&d=identicon&r=PG&f=1", "display_name": "aokellermann", "link": "https://stackoverflow.com/users/9301209/aokellermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1552514085, "creation_date": 1552514085, "answer_id": 55151776, "question_id": 55151277, "link": "https://stackoverflow.com/questions/55151277/unable-to-link-clion-to-qt-on-windows-10/55151776#55151776", "title": "Unable to link CLion to QT On Windows 10", "body": "<p>Try this under project(helloqt):</p>\n\n<pre><code>set(CMAKE_AUTOMOC ON)\nset(CMAKE_AUTOUIC ON)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11199614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-a365ksFCKt0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recQjvt7p3szPYeLFTg5d1k8b3jFA/mo/photo.jpg?sz=128", "display_name": "user11199614", "link": "https://stackoverflow.com/users/11199614/user11199614"}, "edited": false, "score": 0, "creation_date": 1552943032, "post_id": 55151849, "comment_id": 97194467, "body": "Like this? <code>cmake_minimum_required(VERSION 3.5) project(helloqt)  set(CMAKE_AUTOMOC ON) set(CMAKE_AUTOUIC ON)  set(SOURCE_FILES main.cpp)  find_package(Qt5Widgets REQUIRED) find_package(Qt5Core REQUIRED)  add_executable(helloqt ${SOURCE_FILES}) target_link_libraries(helloqt Qt5::Widgets Qt5::Core) </code> Sorry I&#39;m not sure how to make this comment look cleaner."}], "tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1552514532, "creation_date": 1552514532, "answer_id": 55151849, "question_id": 55151277, "link": "https://stackoverflow.com/questions/55151277/unable-to-link-clion-to-qt-on-windows-10/55151849#55151849", "title": "Unable to link CLion to QT On Windows 10", "body": "<p>It can't find symbol like <a href=\"https://doc.qt.io/qt-5/qmessagelogger.html\" rel=\"nofollow noreferrer\">QMessageLogger</a> which is part of  <a href=\"https://doc.qt.io/qt-5/qtcore-index.html\" rel=\"nofollow noreferrer\">Qt Core</a>. Note you have used <code>qDebug()</code> which refers to this symbols!</p>\n\n<p>Conclusion is simple add this to your <code>CMakeLists.txt</code>:</p>\n\n<pre><code>find_package(Qt5Core REQUIRED) # this might be not needed\ntarget_link_libraries(helloqt Qt5::Widgets Qt5::Core) \n</code></pre>\n\n<p><strong>Offtopic</strong>: trash this:</p>\n\n<pre><code>set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS}\")\n</code></pre>\n\n<p>since it doesn't do anything.</p>\n"}], "owner": {"reputation": 11, "user_id": 11199614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-a365ksFCKt0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recQjvt7p3szPYeLFTg5d1k8b3jFA/mo/photo.jpg?sz=128", "display_name": "user11199614", "link": "https://stackoverflow.com/users/11199614/user11199614"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1552514532, "creation_date": 1552511486, "question_id": 55151277, "link": "https://stackoverflow.com/questions/55151277/unable-to-link-clion-to-qt-on-windows-10", "title": "Unable to link CLion to QT On Windows 10", "body": "<p>Im trying to link Qt Creator to Clion so i can use it for creating GUI elements but the only information I was able to find on doing this was this thread </p>\n\n<p><a href=\"https://stackoverflow.com/questions/30235175/how-to-configure-clion-ide-for-qt-framework\">How to configure CLion IDE for Qt Framework?</a></p>\n\n<p>I tried to follow this as closely as possible but one of the major differences is that on windows there is no clang_64 file instead it is msvc2017_64 and that is what seems to be showing up in the error im getting.</p>\n\n<p>My CmakeLists.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.5)\nproject(helloqt)\n\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS}\")\n\nset(SOURCE_FILES main.cpp)\nfind_package(Qt5Widgets REQUIRED)\n\nadd_executable(helloqt ${SOURCE_FILES})\n\ntarget_link_libraries(helloqt Qt5::Widgets)\n</code></pre>\n\n<p>my main.cpp</p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;QDebug&gt;\n\nusing namespace std;\n\nint main() {\n    qDebug() &lt;&lt; QT_VERSION_STR;\n    return 1;\n}\n</code></pre>\n\n<p>under Settings>Build, Execution, Deployment > CMake my Cmake Options has the path</p>\n\n<pre><code>-DCMAKE_PREFIX_PATH=C:/Qt/5.12.1/msvc2017_64/lib/cmake\n</code></pre>\n\n<p>and it results in this error which I have not been able to find a fix to.</p>\n\n<pre><code>\"C:\\Program Files\\JetBrains\\CLion 2018.3.4\\bin\\cmake\\win\\bin\\cmake.exe\" --build C:\\Users\\Uncorropto\\CLionProjects\\helloqt\\cmake-build-debug --target helloqt --\nScanning dependencies of target helloqt\n[ 50%] Building CXX object CMakeFiles/helloqt.dir/main.cpp.obj\nmain.cpp\n[100%] Linking CXX executable helloqt.exe\nLINK Pass 1: command \"C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1414~1.264\\bin\\Hostx86\\x86\\link.exe /nologo @CMakeFiles\\helloqt.dir\\objects1.rsp /out:helloqt.exe /implib:helloqt.lib /pdb:C:\\Users\\Uncorropto\\CLionProjects\\helloqt\\cmake-build-debug\\helloqt.pdb /version:0.0 /machine:X86 /debug /INCREMENTAL /subsystem:console C:\\Qt\\5.12.1\\msvc2017_64\\lib\\Qt5Widgetsd.lib C:\\Qt\\5.12.1\\msvc2017_64\\lib\\Qt5Guid.lib C:\\Qt\\5.12.1\\msvc2017_64\\lib\\Qt5Cored.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTFILE:CMakeFiles\\helloqt.dir/intermediate.manifest CMakeFiles\\helloqt.dir/manifest.res\" failed (exit code 1120) with the following output:\nmain.cpp.obj : error LNK2019: unresolved external symbol \"__declspec(dllimport) public: __thiscall QMessageLogger::QMessageLogger(char const *,int,char const *)\" (__imp_??0QMessageLogger@@QAE@PBDH0@Z) referenced in function _main\nmain.cpp.obj : error LNK2019: unresolved external symbol \"__declspec(dllimport) public: class QDebug __thiscall QMessageLogger::debug(void)const \" (__imp_?debug@QMessageLogger@@QBE?AVQDebug@@XZ) referenced in function _main\nmain.cpp.obj : error LNK2019: unresolved external symbol \"__declspec(dllimport) public: __thiscall QDebug::~QDebug(void)\" (__imp_??1QDebug@@QAE@XZ) referenced in function _main\nmain.cpp.obj : error LNK2019: unresolved external symbol \"__declspec(dllimport) public: class QDebug &amp; __thiscall QDebug::operator&lt;&lt;(char const *)\" (__imp_??6QDebug@@QAEAAV0@PBD@Z) referenced in function _main\nC:\\Qt\\5.12.1\\msvc2017_64\\lib\\Qt5Widgetsd.lib : warning LNK4272: library machine type 'x64' conflicts with target machine type 'x86'\nC:\\Qt\\5.12.1\\msvc2017_64\\lib\\Qt5Guid.lib : warning LNK4272: library machine type 'x64' conflicts with target machine type 'x86'\nC:\\Qt\\5.12.1\\msvc2017_64\\lib\\Qt5Cored.lib : warning LNK4272: library machine type 'x64' conflicts with target machine type 'x86'\nhelloqt.exe : fatal error LNK1120: 4 unresolved externals\nNMAKE : fatal error U1077: '\"C:\\Program Files\\JetBrains\\CLion 2018.3.4\\bin\\cmake\\win\\bin\\cmake.exe\"' : return code '0xffffffff'\nStop.\nNMAKE : fatal error U1077: '\"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.14.26428\\bin\\HostX86\\x86\\nmake.exe\"' : return code '0x2'\nStop.\nNMAKE : fatal error U1077: '\"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.14.26428\\bin\\HostX86\\x86\\nmake.exe\"' : return code '0x2'\nStop.\nNMAKE : fatal error U1077: '\"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.14.26428\\bin\\HostX86\\x86\\nmake.exe\"' : return code '0x2'\nStop.\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 2, "creation_date": 1552511408, "post_id": 55151222, "comment_id": 97042808, "body": "You&#39;re not including <code>&lt;iostream&gt;</code> in <code>Computer.cpp</code> or any of it&#39;s headers. <code>std::cout</code> is declared in <code>&lt;iostream&gt;</code> and this include is needed for it to work."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552511414, "post_id": 55151222, "comment_id": 97042809, "body": "Did you try including appropriate headers?"}, {"owner": {"reputation": 703, "user_id": 9753452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Michael Surette", "link": "https://stackoverflow.com/users/9753452/michael-surette"}, "edited": false, "score": 4, "creation_date": 1552511541, "post_id": 55151222, "comment_id": 97042858, "body": "Side note: you shouldn&#39;t include a cpp file."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1552511717, "post_id": 55151222, "comment_id": 97042940, "body": "Note even though it is all part of one project, each <code>.cpp</code> file is compiled individually before they are linked together, so even though you are including <code>&lt;iostream&gt;</code> in <code>Main.cpp</code>, it will not be seen by <code>Computer.cpp</code> when it is it&#39;s turn to be compiled. Also you should not include a <code>.cpp</code> file within another, as pointed out. Even if this compiled, it would lead to linker errors because you have the same interfaces being implemented multiple times due to this include loop."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 10939189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b67eae7a554f38bf69013f0c597e9a6?s=128&d=identicon&r=PG&f=1", "display_name": "sosa067", "link": "https://stackoverflow.com/users/10939189/sosa067"}, "is_accepted": false, "score": 1, "last_activity_date": 1552511614, "creation_date": 1552511614, "answer_id": 55151304, "question_id": 55151222, "link": "https://stackoverflow.com/questions/55151222/cout-is-not-a-member-of-std-progect-file-c/55151304#55151304", "title": "&#39;cout&#39; is not a member of &#39;std&#39; (Progect File c++)", "body": "<p>You need to include iostream header in your Computer.cpp file as such:</p>\n\n<pre><code>include &lt;iostream&gt;\n</code></pre>\n\n<p>and to make your life easier, you can also add:</p>\n\n<pre><code>using std::cout;\nusing std::endl;\n</code></pre>\n\n<p>right at the bottom of your include, that way you don't have to keep adding \"std::cout\" everytime, you can just use \"cout\"</p>\n\n<p>Also want to add:</p>\n\n<p>You can remove the include computer.cpp from your main.cpp and just leave the header. The C++ linker will automatically link your computer.h and computer.cpp together since .cpp includes the header, and your main includes the computer.h</p>\n"}], "owner": {"reputation": 21, "user_id": 11199616, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bBDl-T1W5Ec/AAAAAAAAAAI/AAAAAAAAAsU/_FATXaikqOU/photo.jpg?sz=128", "display_name": "Arashi", "link": "https://stackoverflow.com/users/11199616/arashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552511614, "creation_date": 1552511259, "question_id": 55151222, "link": "https://stackoverflow.com/questions/55151222/cout-is-not-a-member-of-std-progect-file-c", "title": "&#39;cout&#39; is not a member of &#39;std&#39; (Progect File c++)", "body": "<p>I created a new project in c++ but i keep getting the same error</p>\n\n<h1>Main.cpp</h1>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n\n\n#include \"Computer.cpp\"\n#include \"Computer.h\"\n\nusing namespace std;\n\nint main() \n{\n\ncout &lt;&lt; \"Hello World!\" &lt;&lt; endl;\nreturn 0;\n}\n</code></pre>\n\n<h1>Computer.h</h1>\n\n<pre><code>#ifndef COMPUTER_H_INCLUDED\n#define COMPUTER_H_INCLUDED\n#include &lt;string&gt;\nclass Computer\n{\npublic:\n    std::string marca;\n    float prezzo;\n    bool acceso;\n\n    Computer();\n\n    void Accenditi();\n    void Spegniti();\n    void ImpostaMarca(std::string m);\n    void ImpostaPrezzo(float p);\n\n};\n\n#endif\n</code></pre>\n\n<h1>Computer.cpp</h1>\n\n<pre><code>#include \"Computer.h\"\n\nComputer::Computer()\n{\n\n}\nvoid Computer::Accenditi()\n{\nif(!acceso)\n{\n    acceso = true;\n}\nelse\n{\n    std::cout &lt;&lt; \"Sono gi\u00e0 acceso\";\n}\n}\nvoid Computer::Spegniti()\n{\nif(acceso)\n{\n    acceso = false;\n}\nelse\n{\n    std::cout &lt;&lt; \"Sono gi\u00e0 spento\";\n}\n}\nvoid Computer::ImpostaMarca(std::string m)\n{\nmarca = m;\n}\nvoid Computer::ImpostaPrezzo(float p)\n{\nprezzo = p;\n}\n</code></pre>\n\n<h1>The Problem</h1>\n\n<p>i don't understand what's wrong with Computer.cpp, i keep getting \"cout is not a member of std\". I tryed to add \"using namespace std\" and i also tryed to add the library #include but i get a new file called \"makefile.win\". How can i fix this error ?</p>\n"}, {"tags": ["c++", "security", "certificate"], "answers": [{"tags": [], "owner": {"reputation": 252, "user_id": 3887847, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/92c58d99c48f715bd8d14aa4d7551380?s=128&d=identicon&r=PG&f=1", "display_name": "aks", "link": "https://stackoverflow.com/users/3887847/aks"}, "is_accepted": false, "score": 2, "last_activity_date": 1552686375, "creation_date": 1552686375, "answer_id": 55191073, "question_id": 55151055, "link": "https://stackoverflow.com/questions/55151055/certfindcertificateinstore-fails-to-find-certificate-if-the-application-launched/55191073#55191073", "title": "CertFindCertificateInStore fails to find certificate if the application launched with different user credentials", "body": "<p>I found the root cause. The personnel certificates of CURRENT_USER is not available to other user. I imported the certificates to LOCAL MACHINE and used below updated code to solve the issue.</p>\n\n<pre><code>HCERTSTORE hMy = CertOpenStore(CERT_STORE_PROV_SYSTEM, 0, NULL, CERT_SYSTEM_STORE_LOCAL_MACHINE, L\"MY\");\n</code></pre>\n"}], "owner": {"reputation": 252, "user_id": 3887847, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/92c58d99c48f715bd8d14aa4d7551380?s=128&d=identicon&r=PG&f=1", "display_name": "aks", "link": "https://stackoverflow.com/users/3887847/aks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 795, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552686375, "creation_date": 1552510526, "question_id": 55151055, "link": "https://stackoverflow.com/questions/55151055/certfindcertificateinstore-fails-to-find-certificate-if-the-application-launched", "title": "CertFindCertificateInStore fails to find certificate if the application launched with different user credentials", "body": "<p>I have certificates in my windows user certificates->Personal folder and its CA in Trusted Root folder.</p>\n\n<p>I have a windows service application which tries to get the certificate using CertFindCertificateInStore() API.</p>\n\n<pre><code>HCERTSTORE hMy = CertOpenSystemStore(0, _T(\"MY\"));\nCString cert = _T(\"1.2.3.4\");\nPCCERT_CONTEXT context =  CertFindCertificateInStore( hMy, X509_ASN_ENCODING | PKCS_7_ASN_ENCODING, 0, CERT_FIND_SUBJECT_STR, cert ,    NULL ); \n</code></pre>\n\n<p>It is working fine if I run the service with current log in windows user credentials.</p>\n\n<p>I created a local user (say TEST) and added to Administrator group. \nAlso added to  LocayPolicies->User Rights Management->'Replace a process level tocken' and 'Logo on as service policies'.</p>\n\n<p>I started the service with TEST user credentials. The service is started.\nBut the same code, CertFindCertificateInStore() API, fails to find the certificate and the API returns NULL.</p>\n\n<p>I will appreciate your help!</p>\n"}, {"tags": ["c++", "cmake", "external-project"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1552510482, "post_id": 55150944, "comment_id": 97042391, "body": "It seems that those other questions are about <i>external</i> projects while your project has internal library (that is it is inside of directory tree of app project) so I guess <code>add_subdirectory</code> should be sufficient. I personally would object such a project organization though."}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 1, "creation_date": 1552511976, "post_id": 55150944, "comment_id": 97043048, "body": "I&#39;m a big fan of <code>cmake --build .</code> rather than <code>make</code>, it&#39;s more portable."}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 7706917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GPqbH.png?s=128&g=1", "display_name": "patyx", "link": "https://stackoverflow.com/users/7706917/patyx"}, "edited": false, "score": 0, "creation_date": 1552512953, "post_id": 55151266, "comment_id": 97043494, "body": "I want the entire process to be done at once. I do not want to CMake and build the <code>mylib</code> separately from <code>myapp</code>. The project is required to be 110% self-contained."}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "reply_to_user": {"reputation": 148, "user_id": 7706917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GPqbH.png?s=128&g=1", "display_name": "patyx", "link": "https://stackoverflow.com/users/7706917/patyx"}, "edited": false, "score": 0, "creation_date": 1552517198, "post_id": 55151266, "comment_id": 97045005, "body": "When I say it does it first, I refer to the compilation order of a single build. My project builds off one config call and one build call."}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "reply_to_user": {"reputation": 148, "user_id": 7706917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GPqbH.png?s=128&g=1", "display_name": "patyx", "link": "https://stackoverflow.com/users/7706917/patyx"}, "edited": false, "score": 0, "creation_date": 1552517357, "post_id": 55151266, "comment_id": 97045047, "body": "I have a script that does this. Specifically, it makes a <code>_build</code> directory, <code>cd</code>s into it, calls <code>cmake ..</code>, then calls <code>cmake --build .</code>, I just sit back and wait for the compilation to finish."}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "reply_to_user": {"reputation": 148, "user_id": 7706917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GPqbH.png?s=128&g=1", "display_name": "patyx", "link": "https://stackoverflow.com/users/7706917/patyx"}, "edited": false, "score": 0, "creation_date": 1552593408, "post_id": 55151266, "comment_id": 97081227, "body": "@paddycakes I&#39;m sorry if I haven&#39;t been completely clear, this answer is the standard, correct way to build a library and add it to your project, I learned it directly from the cmake documentation."}, {"owner": {"reputation": 148, "user_id": 7706917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GPqbH.png?s=128&g=1", "display_name": "patyx", "link": "https://stackoverflow.com/users/7706917/patyx"}, "edited": false, "score": 0, "creation_date": 1553020495, "post_id": 55151266, "comment_id": 97228434, "body": "I have worked through the tutorials, but I was looking for further elaboration on each line&#39;s purpose. I figured out my issue was not properly adding the include directories to <code>mylib</code> with <code>target_include_directories</code>.I&#39;ve added an all encompassing answer."}], "tags": [], "owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "is_accepted": false, "score": 0, "last_activity_date": 1552511424, "creation_date": 1552511424, "answer_id": 55151266, "question_id": 55150944, "link": "https://stackoverflow.com/questions/55150944/cmake-build-and-install-locally-stored-submodule/55151266#55151266", "title": "CMake: Build and install locally stored submodule", "body": "<p>So, I actually do this in one of my projects.</p>\n\n<p>First, the library needs to be built with ADD_LIBRARY(), but I'm assuming you do that. Something like </p>\n\n<p><code>ADD_LIBRARY (${MyLibName} ${SOURCES})</code> in the library's CMakeLists.txt</p>\n\n<p>That adds the library into cmake's list of libraries.</p>\n\n<p>Second, you add the library to your project with </p>\n\n<p><code>target_link_libraries (${PROJECT_NAME} ${MyLibName})</code> in the executable's CMakeLists.txt, the same one where you have your <code>add_executable (${PROJECT_NAME} ${SOURCES})</code></p>\n\n<p>That will set up the dependency chain to force MyLibName to explicitly build before PROJECT_NAME.</p>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 7706917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GPqbH.png?s=128&g=1", "display_name": "patyx", "link": "https://stackoverflow.com/users/7706917/patyx"}, "is_accepted": true, "score": 1, "last_activity_date": 1553020132, "creation_date": 1553020132, "answer_id": 55247788, "question_id": 55150944, "link": "https://stackoverflow.com/questions/55150944/cmake-build-and-install-locally-stored-submodule/55247788#55247788", "title": "CMake: Build and install locally stored submodule", "body": "<p>Assuming in the project described, only header files in the <code>mylib/include</code> directory are to be considered public:</p>\n\n<p>The top-level <code>CMakeLists.txt</code> for <code>mylib</code> needs to contain:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.13 FATAL_ERROR)\nproject(mylib VERSION 0.1 LANGUAGES CXX)\n\nadd_library(${MyLibName} ${MyLib_SOURCES})\n\ntarget_include_directories(${MyLibName}\n    PUBLIC\n        $&lt;INSTALL_INTERFACE:include&gt;\n        $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include&gt;\n    PRIVATE\n        ${CMAKE_CURRENT_SOURCE_DIR}/src\n)\n</code></pre>\n\n<p>This ensures that projects including <code>mylib</code> will only have access to files in the <code>include/</code> directory. Files in <code>include/</code> can be used like <code>#include &lt;myfile.h&gt;</code> and files in <code>include/mylib</code> (the general convention) can be used like <code>#include &lt;mylib/myfile.h&gt;</code>.</p>\n\n<p>The top-level <code>CMakeLists.txt</code> for <code>myapp</code> should include:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.13 FATAL_ERROR)\nproject(myapp VERSION 0.1 LANGUAGES CXX)\n\nadd_subdirectory(libs/mylib)\n\nadd_executable(${MyAppName} ${MyApp_SOURCES})\ntarget_link_libraries(${MyAppName} ${MyLibName}\n</code></pre>\n\n<p>The use of <code>add_subdirectory</code> ensures that <code>mylib</code> will be built before <code>myapp</code> and <code>target_link_libraries</code> adds <code>mylib</code> to the executable.</p>\n\n<p>As mentioned by Tzalumen, make sure you take a look at the <a href=\"https://cmake.org/cmake-tutorial/\" rel=\"nofollow noreferrer\">CMake tutorials</a> and prefer the use of <code>cmake --build .</code> instead of <code>make</code>.</p>\n"}], "owner": {"reputation": 148, "user_id": 7706917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GPqbH.png?s=128&g=1", "display_name": "patyx", "link": "https://stackoverflow.com/users/7706917/patyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 55247788, "answer_count": 2, "score": 0, "last_activity_date": 1553020132, "creation_date": 1552509964, "last_edit_date": 1553009895, "question_id": 55150944, "link": "https://stackoverflow.com/questions/55150944/cmake-build-and-install-locally-stored-submodule", "title": "CMake: Build and install locally stored submodule", "body": "<p>There are numerous similar questions on Stack Overflow, but none come near to answering my question.</p>\n\n<p>I have a C++ library built using CMake:</p>\n\n<pre><code>mylib\n| - CMakeLists.txt\n| - src/\n|   | - m.h\n|   | - m.cpp\n| - include/\n|   | - mylib/\n|   |   | - a.h\n|   |   | - something/\n|   |   |   | - some.h\n| - cmake/\n|   - mylibConfig.cmake.in\n|   - mylibConfigVersion.cmake.in\n</code></pre>\n\n<p>I then create another library or executable which includes the aforementioned library:</p>\n\n<pre><code>myapp\n| - CMakeLists.txt\n| - src/\n|   | - main.cpp\n| - include/\n|   | - myapp/\n|   |   | - b.h\n| - libs\n|   | - mylib\n</code></pre>\n\n<p>And would like to use <code>mylib</code> within <code>myapp</code> like so. Please take notice how <code>mylib</code> headers are included in a directory like format:</p>\n\n<pre><code>#include &lt;mylib/a.h&gt;\n#include &lt;mylib/something/some.h&gt;\n</code></pre>\n\n<p><code>mylib</code> should be built when building <code>myapp</code> so that the following works <em>without any other build steps</em>:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ cd myapp/build\n$ cmake ..\n$ make\n</code></pre>\n\n<p>Here is a list of some of the Stack Overflow posts I have reviewed. I have attempted each, and they simply do not work:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/15175318/cmake-how-to-build-external-projects-and-include-their-targets\">CMake: How to build external projects and include their targets</a></li>\n<li><a href=\"https://stackoverflow.com/questions/17446981/cmake-externalproject-add-and-findpackage?noredirect=1&amp;lq=1\">CMake ExternalProject_Add() and FindPackage()</a></li>\n</ul>\n"}, {"tags": ["c++", "memory"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1552509984, "post_id": 55150917, "comment_id": 97042148, "body": "Remember, each <code>new</code> has to have exactly one matching <code>delete</code>. So you need a loop that does <code>delete t[i];</code>."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 2, "creation_date": 1552509988, "post_id": 55150917, "comment_id": 97042153, "body": "You&#39;d do it in reverse order.  But I wouldn&#39;t do that at all.  I don&#39;t think I&#39;ve needed a <code>new</code> or <code>delete</code> in C++ in the last 8 years."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1552510035, "creation_date": 1552510035, "answer_id": 55150956, "question_id": 55150917, "link": "https://stackoverflow.com/questions/55150917/how-would-i-de-allocate-this/55150956#55150956", "title": "How would I de-allocate this?", "body": "<p>Like this:</p>\n\n<pre><code>TicTacNode *t[nodenum] = {};\n\nfor (int i = 0; i &lt; nodenum; ++i)\n{\n  t[i] = new TicTacNode();\n}\n\n...\n\nfor (int i = 0; i &lt; nodenum; ++i)\n{\n  delete t[i];\n}\n</code></pre>\n\n<p>Though, you really should use smart pointers instead, then you don't need to worry about calling <code>delete</code> manually at all:</p>\n\n<pre><code>#include &lt;memory&gt;\n\nstd::unique_ptr&lt;TicTacNode&gt; t[nodenum];\n\nfor (int i = 0; i &lt; nodenum; ++i)\n{\n  t[i].reset(new TicTacNode);\n\n  // or, in C++14 and later:\n  // t[i] = std::make_unique&lt;TicTacNode&gt;();\n}\n</code></pre>\n\n<p>Or, you could simply not use dynamic allocation at all:</p>\n\n<pre><code>TicTacNode t[nodenum];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1552510119, "creation_date": 1552510119, "answer_id": 55150976, "question_id": 55150917, "link": "https://stackoverflow.com/questions/55150917/how-would-i-de-allocate-this/55150976#55150976", "title": "How would I de-allocate this?", "body": "<blockquote>\n  <p>Would any pointers that are assigned with values in <code>t</code> need to be deleted as well?</p>\n</blockquote>\n\n<p>No. However, you have to make sure that you don't use those pointers any more after the memory have been deallocated.</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 0, "last_activity_date": 1552510147, "creation_date": 1552510147, "answer_id": 55150986, "question_id": 55150917, "link": "https://stackoverflow.com/questions/55150917/how-would-i-de-allocate-this/55150986#55150986", "title": "How would I de-allocate this?", "body": "<blockquote>\n  <p>Just curious as to how I would delete this once it is done being used.</p>\n</blockquote>\n\n<p>As simple as this:</p>\n\n<pre><code>std::unique_ptr&lt;TicTacNode&gt; t[nodenum];\nfor (int i = 0; i &lt; nodenum; ++i)\n{\n  t[i] = std::make_unique&lt;TicTacNode&gt;();\n}\n// as soon as scope for t ends all data will be cleaned properly \n</code></pre>\n\n<p>or even simpler as looks like there is no reason to allocate them dynamically:</p>\n\n<pre><code>TicTacNode t[nodenum]; // default ctor is called for each object and all will be deleted when t destroyed\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 11103630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RDv7pXmuWiA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMxYgjwyuWluSn_VmIWSlKtv4Aayw/mo/photo.jpg?sz=128", "display_name": "Redone R", "link": "https://stackoverflow.com/users/11103630/redone-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1552512382, "creation_date": 1552512382, "answer_id": 55151470, "question_id": 55150917, "link": "https://stackoverflow.com/questions/55150917/how-would-i-de-allocate-this/55151470#55151470", "title": "How would I de-allocate this?", "body": "<p>Actual you don't have to explicitly allocate and deallocate memory. All you need is the right data structure for the job.</p>\n\n<p>In your case either std::vector or std::list might do the job very well</p>\n\n<p>Using std::vector the whole code might be replaced by</p>\n\n<pre><code>auto t = std::vector&lt;TicTacNode&gt;(nodenum)\n</code></pre>\n\n<p>or using std::list</p>\n\n<pre><code>auto t = std::list&lt;TicTacNode&gt;(nodenum)\n</code></pre>\n\n<p><strong>Benefits</strong>:</p>\n\n<ul>\n<li><p>Less and clear code.</p>\n\n<p>No need for std::new, since both containers will allocate and\ninitialise nodenum of objects.</p>\n\n<p>No need for std::delete, since containers will free memory\nautomatically when they go out of scope.</p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 11199359, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qu-Pcu_aTC8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd40vuuP-GjltgJvj6cSGw7amDOpw/mo/photo.jpg?sz=128", "display_name": "freddrr.t", "link": "https://stackoverflow.com/users/11199359/freddrr-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1552512382, "creation_date": 1552509851, "question_id": 55150917, "link": "https://stackoverflow.com/questions/55150917/how-would-i-de-allocate-this", "title": "How would I de-allocate this?", "body": "<p>Just curious as to how I would delete this once it is done being used. </p>\n\n<pre><code>TicTacNode *t[nodenum];\nfor (int i = 0; i &lt; nodenum; ++i)\n{\n  t[i] = new TicTacNode();\n}\n</code></pre>\n\n<p>Would any pointers that are assigned with values in t need to be deleted as well?? For example, </p>\n\n<pre><code>TicTacNode * m = (t[i + 1]);\n</code></pre>\n"}, {"tags": ["c++", "qt", "qtimer"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 4, "creation_date": 1552509331, "post_id": 55150748, "comment_id": 97041859, "body": "The line <code>while (1) {&#47;&#47; it&#39;s only for test</code> is the one that can cause the error since an infinite loop blocks the event loop of Qt."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 3, "creation_date": 1552509618, "post_id": 55150748, "comment_id": 97041990, "body": "You also delete your <code>UsingBKS</code> object before you execute the application. That won&#39;t work well."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1552510152, "post_id": 55150748, "comment_id": 97042222, "body": "You don&#39;t need to have that destructor there. Those QObjects have a parent, and will be deleted by the parent. You don&#39;t even need to create them with <code>new</code>, because their lifetime ends before QObject destructor gets called, so they could be just plain member variables, saving a tiny bit of memory and processing overhead of using <code>new</code>."}], "owner": {"reputation": 1, "user_id": 11199434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac1d323a1b36cc5919cefb1d6bb1acd?s=128&d=identicon&r=PG&f=1", "display_name": "Gusya", "link": "https://stackoverflow.com/users/11199434/gusya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1552509137, "creation_date": 1552509137, "question_id": 55150748, "link": "https://stackoverflow.com/questions/55150748/qtimer-doesnt-work-i-think-it-is-not-updated", "title": "Qtimer doesn`t work. I think it is not updated", "body": "<p>I want send udp packet every 10ms.\nI created QTimer, but SLOT doesn`t work. \nI created infinite loop with the output is timer->remainingTime() and it looks like the timer doesn't want to reset.\nIn output:\n10\n10\n10\n...\n9\n9\n9\n...\n...\n...\n1\n1\n1\n...\n0\n0\n0\n0\n0\n0\nand then some zeros. Maybe this method is absolutely wrong. How can I still do it?</p>\n\n<p>It`s my code:</p>\n\n<p>usingbks.h</p>\n\n<pre><code>#ifndef USINGBKS_H\n#define USINGBKS_H\n#include \"bks.h\"\n#include \"sendtimer.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;QtNetwork&gt;\n#include &lt;thread&gt;\n\n\nclass UsingBKS : public QObject\n{\nQ_OBJECT\n\n\nprivate slots:\n    void sendPackets();\n\nprivate:\n    QTimer* timer = new QTimer(this);\n    QUdpSocket* socket = new QUdpSocket(this);\n\n...\n\n    int TrandmissionStart(QString ip, quint16 port);\n    int SendBKSOutBKSCond();\n    int SendBKSOutPrimaKVCond2();\n};\n\n#endif // USINGBKS_H\n</code></pre>\n\n<p>usingbks.cpp</p>\n\n<pre><code>UsingBKS::UsingBKS()\n{\n\n}\n\nUsingBKS::~UsingBKS()\n{\n    delete socket;\n    delete timer;\n}\n\nvoid UsingBKS::sendPackets() {\n    SendBKSOutBKSCond();\n    SendBKSOutPrimaKVCond2();\n}\n\n\n...\n\nint UsingBKS::TrandmissionStart(QString ip, quint16 port)\n{\n    socket-&gt;connectToHost(QHostAddress(ip), port);\n    connect(timer, SIGNAL(timeout()), this, SLOT(sendPackets()));\n    timer-&gt;start(1000);\n    while(1) { //it`s only for test\n        std::cout &lt;&lt; timer-&gt;remainingTime() &lt;&lt; \" \" &lt;&lt; timer-&gt;isActive() &lt;&lt; std::endl; \n    }\n    return 1;\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;QCoreApplication&gt;\n#include &lt;QObject&gt;\n#include &lt;QTimer&gt;\n#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n#include \"usingbks.h\"\n\nusing namespace std;\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication a(argc, argv);\n\n\n    unsigned int Hz100 = 0, kHz1, kHz10, kHz100, MHz1, MHz10 ;\n        Hz100 = 1;\n        kHz1 = 1;\n        kHz10 = 1;\n        kHz100 = 1;\n        MHz1 = 1;\n        MHz10 = 1;\n    UsingBKS* bks = new UsingBKS ();\n    bks-&gt;SetBKSOutBKSCond(4, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0);\n    bks-&gt;SetBKSOutPrimaKVCond2(4, 12,\n                               static_cast&lt;uint8_t&gt;(Hz100),\n                               static_cast&lt;uint8_t&gt;(kHz1),\n                               static_cast&lt;uint8_t&gt;(kHz10),\n                               static_cast&lt;uint8_t&gt;(kHz100),\n                               static_cast&lt;uint8_t&gt;(MHz1),\n                               static_cast&lt;uint8_t&gt;(MHz10), 0);\n\n    cout &lt;&lt; bks-&gt;TrandmissionStart(\"1.1.1.1\", 10310);\n    cout &lt;&lt; \"Trandmission started.\" &lt;&lt; endl;\n    delete bks;\n    return a.exec();\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "allocation"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1552509230, "post_id": 55150695, "comment_id": 97041815, "body": "Why do you need this?  Why can&#39;t you use <code>std::string</code>? And why are you using raw arrays instead of using <code>std::vector</code>?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1552509634, "post_id": 55150695, "comment_id": 97041997, "body": "there is no magic that lets you store 500 characters in a <code>std::string</code> but it is a lot of hard-to-get-right boilerplate code around a c-style array. If you cannot use <code>std::string</code> best would be to write your own <code>my::string</code>, but really, why would you? You should rather add <code>#include &lt;vector&gt;</code> and get rid of that ugly <code>new</code> and <code>delete</code> ;)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1552510044, "post_id": 55150695, "comment_id": 97042170, "body": "<i>If so, how is the problem solved in C language where there&#39;s no string class?</i> -- I have to admit, the teachers today have really got some inventive ways of not teaching C++ in a C++ course."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1552509948, "last_edit_date": 1552509948, "creation_date": 1552509603, "answer_id": 55150853, "question_id": 55150695, "link": "https://stackoverflow.com/questions/55150695/converting-array-of-strings-to-char-multiple-char/55150853#55150853", "title": "Converting array of strings to char multiple char * []", "body": "<p>Do to what you are asking for, try something like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\nint main() {\n    char text[500];\n    char ** OldArray = nullptr;\n    char ** NewArray = nullptr;\n    unsigned int counter = 0;\n    size_t textlen;\n\n    cout &lt;&lt; \"Enter Strings: \" &lt;&lt; endl;\n    while (cin.get(text, 500, ' ')) {\n        if (strstr(text, \"End\")) break;\n\n        NewArray = new char*[counter+1];\n        for(int i = 0; i &lt; counter; ++i) {\n            NewArray[i] = OldArray[i];\n        }\n\n        textlen = strlen(text) /* or: cin.gcount() */ + 1;\n        NewArray[counter] = new char[textlen];\n        strncpy(NewArray[counter], text, textlen);\n\n        delete [] OldArray;\n        OldArray = NewArray;\n\n        ++counter;\n    }\n\n    for (int i = 0; i &lt; counter; ++i) {\n        cout &lt;&lt; OldArray[i] &lt;&lt; \" \";\n    }\n\n    for (int i = 0; i &lt; counter; ++i) {\n        delete[] OldArray[i];\n    }\n    delete[] OldArray;\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10463442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99d20fc0a7e0c0ab5bbd25bb4b338ab?s=128&d=identicon&r=PG&f=1", "display_name": "JustAnotherPerson", "link": "https://stackoverflow.com/users/10463442/justanotherperson"}, "edited": false, "score": 0, "creation_date": 1552651425, "post_id": 55151387, "comment_id": 97102247, "body": "Thanks for the explaination. If I understood correctly, string is somewhat like vector - I see it as a structure which contains - as you said - a pointer to the first element and a pointer to the last element. My question is, how does the element know if the data we&#39;re trying to store in the object exceeds the memory allocated for it? Like, some method assigned to operator &#39;&gt;&gt;&#39; in this struct?(and of course checking the number of elements in cin) I haven&#39;t really dug into ObjectOriented programming yet, but I would like to understand the general concept for now."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 23, "user_id": 10463442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99d20fc0a7e0c0ab5bbd25bb4b338ab?s=128&d=identicon&r=PG&f=1", "display_name": "JustAnotherPerson", "link": "https://stackoverflow.com/users/10463442/justanotherperson"}, "edited": false, "score": 0, "creation_date": 1552654074, "post_id": 55151387, "comment_id": 97103754, "body": "@JustAnotherPerson subtract the pointer to last element from the pointer to first element. Result is the number of elements (characters). Subtract that from the amount of memory that was allocated. Result is the memory remaining for new elements. Compare that to the number of elements being inserted."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1552512955, "last_edit_date": 1552512955, "creation_date": 1552512048, "answer_id": 55151387, "question_id": 55150695, "link": "https://stackoverflow.com/questions/55150695/converting-array-of-strings-to-char-multiple-char/55151387#55151387", "title": "Converting array of strings to char multiple char * []", "body": "<blockquote>\n  <p>I would have to use some kind of function to copy data starting from some range of addresses. Any ideas how to do it this way?</p>\n</blockquote>\n\n<p>The C++ standard library has an algorithm for copying. It is called <code>std::copy</code>. If you may not use the standard library, you can implement the same algorithm using a loop, the assignment operator and pointer arithmetic.</p>\n\n<blockquote>\n  <p>isn't creating an array of chars capable of holding 500 characters a waste of memory comparing to string?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>If so, how is the problem solved in C language where there's no string class?</p>\n</blockquote>\n\n<p>In a similar way to how <code>std::string</code> itself is implemented; After all, <code>std::string</code> cannot be used to implement <code>std::string</code>. While the underlying data structure of <code>std::string</code> can be implemented in C just as well as in C++, the way memory is acquired and released is somewhat different because C has no classes or exceptions.</p>\n\n<p>A string is just a special case of a sequence of objects - it is a sequence of characters. There are several resizable data structures that can represent a sequence. <code>std::string</code> and <code>std::vector</code> for example are implemented using a data structure called \"dynamic array\".</p>\n\n<p>Dynamic array is implemented using a pointer, which points to a dynamically allocated array, and a record of the size of that array, as well as pointer to the last inserted element (or alternatively, number of elements). If the allocated space runs out, a new, larger dynamic array is allocated, the content from the old array is copied over, and the old one is released. It is important to grow the array at a geometric rate, in order to achieve constant asymptotic complexity (amortised) for insertion operation.</p>\n"}], "owner": {"reputation": 23, "user_id": 10463442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99d20fc0a7e0c0ab5bbd25bb4b338ab?s=128&d=identicon&r=PG&f=1", "display_name": "JustAnotherPerson", "link": "https://stackoverflow.com/users/10463442/justanotherperson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 55150853, "answer_count": 2, "score": 0, "last_activity_date": 1552649570, "creation_date": 1552508948, "last_edit_date": 1552649570, "question_id": 55150695, "link": "https://stackoverflow.com/questions/55150695/converting-array-of-strings-to-char-multiple-char", "title": "Converting array of strings to char multiple char * []", "body": "<p>I have the following piece of code: </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nint main(){\n    string text;\n    string * OldArray = nullptr;\n    string * NewArray = nullptr;\n    unsigned int counter = 0;\n\n    cout &lt;&lt;\"Enter StringS\" &lt;&lt;endl;\n    while(true){\n        cin &gt;&gt; text;\n        if (text.find(\"End\") != string::npos ) break;\n        NewArray = new string[counter +1];\n        for(int i = 0; i &lt; counter; i++){\n            NewArray[i] = OldArray[i];\n        }\n        NewArray[counter] = text;\n        delete [] OldArray;\n        OldArray = NewArray;\n        counter++;\n    }\n\n    for (int i = 0; i&lt; counter; i++){\n        cout &lt;&lt; OldArray[i];\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>And I am supposed to write code that does exactly the same, but without including the <code>&lt;string&gt;</code> header.</p>\n\n<p>So, basically, I have to write a string as <code>char []</code> and make the string pointers an array of pointers to multiple <code>char[]</code>.</p>\n\n<p>The problem is, I have no idea how to do it correctly. </p>\n\n<p>I would normally try to do something like this:</p>\n\n<pre><code>int counter = 0\nchar * charptr[500]; //this is gonna store adresses to some char[] 's \nchar OurString[500]; //variable that will hold user's input\nwhile(true){\n    cin &gt;&gt; OurString;\n    charptr[counter] = new char [500];\n    charptr[counter] = OurString // mistake - charptr[counter] gets assigned physical adress of OutString while that's not exactly what we want\n}\n</code></pre>\n\n<p>I would have to use some kind of function to copy data starting from some range of addresses. Any ideas how to do it this way?</p>\n\n<p>Also, please notice that this solution forces me to create char array of fixed size, while, when using string, it is unnecessary to define size of string - isn't creating an array of chars capable of holding 500 characters a waste of memory comparing to string? If so, how is the problem solved in C language where there's no string class?</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 739, "user_id": 8808047, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RNZnhl-JxaE/AAAAAAAAAAI/AAAAAAAAAD8/STLEovcCjNE/photo.jpg?sz=128", "display_name": "Skiller Dz", "link": "https://stackoverflow.com/users/8808047/skiller-dz"}, "edited": false, "score": 0, "creation_date": 1552510636, "post_id": 55150767, "comment_id": 97042468, "body": "@Progremmer3 you need to put it when you handle the create Message of the window , the message is WM_CREATE , after handling it with switch &amp; case statements , you put that line of code , and don&#39;t forget to to replace PositionX,PositionY,SizeX,SizeY by the value of your window"}], "tags": [], "owner": {"reputation": 739, "user_id": 8808047, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RNZnhl-JxaE/AAAAAAAAAAI/AAAAAAAAAD8/STLEovcCjNE/photo.jpg?sz=128", "display_name": "Skiller Dz", "link": "https://stackoverflow.com/users/8808047/skiller-dz"}, "is_accepted": false, "score": 0, "last_activity_date": 1552510193, "last_edit_date": 1552510193, "creation_date": 1552509196, "answer_id": 55150767, "question_id": 55150622, "link": "https://stackoverflow.com/questions/55150622/how-to-change-messagebox-position-in-c/55150767#55150767", "title": "How to Change MessageBox Position in C++", "body": "<p>I don't think that we can change the position of MessageBox. There is no prototype which requests an int value for position and the return value of MessageBox is an int value, which is the ID of the button that you've pressed.</p>\n\n<p>So it's impossible.</p>\n\n<p>But I can propose something.</p>\n\n<p>Create a new window and give a Handle for it such as HWND.</p>\n\n<p>Then change the Windows Position Using SetWindowPos Function:</p>\n\n<pre><code>SetWindowPos(hwnd,NULL,PositionX,PositionY,SizeX,SizeY,SWP_SHOWWINDOW);\n</code></pre>\n\n<p>and for The Beep you can use the MessageBeep() function. It works with the ICON Themes of MessageBox :</p>\n\n<pre><code>MessageBeep(MB_OK);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>MessageBeep(MB_ICONINFORMATION);\n</code></pre>\n\n<p>or also</p>\n\n<pre><code>MessageBeep(MB_ICONERROR);\n</code></pre>\n\n<p>That's it, thank you for reading!</p>\n"}, {"comments": [{"owner": {"reputation": 739, "user_id": 8808047, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RNZnhl-JxaE/AAAAAAAAAAI/AAAAAAAAAD8/STLEovcCjNE/photo.jpg?sz=128", "display_name": "Skiller Dz", "link": "https://stackoverflow.com/users/8808047/skiller-dz"}, "edited": false, "score": 0, "creation_date": 1552510833, "post_id": 55151073, "comment_id": 97042567, "body": "owh totally forgot the Enumeration of Window Thread , anyways ."}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 1, "creation_date": 1552511112, "post_id": 55151073, "comment_id": 97042688, "body": "Ok Thenks you.. if you have a video from youtube about this please send me (:"}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552570582, "post_id": 55151073, "comment_id": 97066871, "body": "MessageBoxPos is Underfined E0020 Error ||  Severity\tCode\tDescription\tProject\tFile\tLine\tSuppression State Error (active)\tE0140\ttoo many arguments in function call\t||  Severity\tCode\tDescription\tProject\tFile\tLine\tSuppression State Error\tC2065\t&#39;hwnd&#39;: undeclared identifier"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552575149, "post_id": 55151073, "comment_id": 97070351, "body": "@Progremmer3 the inner <code>MessageBox()</code> should have been <code>MessageBoxPos()</code> instead. I fixed that. But there is no undeclared <code>hwnd</code> identifier in the code I showed."}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552585584, "post_id": 55151073, "comment_id": 97077320, "body": "@Remy Lebeau  in the first line Error MessageBoxPos is underFined"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552589316, "post_id": 55151073, "comment_id": 97079135, "body": "@Progremmer3 Obviously, you need to declare the <code>MessageBoxPos()</code> function before you can use it.  I gave you the implementation."}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552590907, "post_id": 55151073, "comment_id": 97079984, "body": "I know it a Stupid Quest But How i declare the MessageBoxPos()??"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552591201, "post_id": 55151073, "comment_id": 97080126, "body": "@Progremmer3 If you don&#39;t know how to declare and implement custom functions, you need to stop what you are doing and review C++ basics."}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552591427, "post_id": 55151073, "comment_id": 97080240, "body": "@RemyLebeau I did not understand what you meant How i can declere this? please learn me"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552591691, "post_id": 55151073, "comment_id": 97080365, "body": "@Progremmer3 seriously? Put the implementation of <code>MessageBoxPos()</code> above the implementation of <code>_MessageBox()</code>. Or, create a new translation unit with its own <code>.h</code> and <code>.c</code>/<code>.cpp</code> files to declare/implement <code>MessageBoxPos()</code>, respectively, and then add the <code>.c</code>/<code>.cpp</code> file to your project and <code>#include</code> the <code>.h</code> file in other source files as needed."}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552674362, "post_id": 55151073, "comment_id": 97115479, "body": "Only i need to do is write MessageBoxPos()?? What inside the ()?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552675151, "post_id": 55151073, "comment_id": 97115871, "body": "@Progremmer3 this goes back to my earlier comment. You clearly don&#39;t understand how to write your own functions, which is an essential skill for any C/C++ developer to have, so stop what you are doing and go refer to a decent C++ book, which covers that topic in detail. That is outside the scope of the question of manipulating a MessageBox dialog."}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552680692, "post_id": 55151073, "comment_id": 97118322, "body": "I know The basic of C++ But i dont understand.. MessageBoxPos is under found.. i need a libary?? Include what?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552683239, "post_id": 55151073, "comment_id": 97119415, "body": "@Progremmer3 No, you do not need a library, <code>MessageBoxPos()</code> is a custom function, I gave you two different implementations for it above in my answer, just copy/paste the desired one into your project code. If you are having errors with it not being found, then you are not applying it to your code correctly, or you are not declaring it before calling it. You do know what a function declaration is, don&#39;t you?"}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552739702, "post_id": 55151073, "comment_id": 97130947, "body": "@RemyLebeau how is it possible?? MessageBoxPos is not a word saved in my libraries Window.h | Iostream | String .. How can I use something that does not exist ???"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552761081, "post_id": 55151073, "comment_id": 97137577, "body": "@Progremmer3 &lt;sigh&gt; you are not listening, and I&#39;m getting tired of repeating myself. <code>MessageBoxPos()</code> IS A CUSTOM FUNCTION, YOU NEED TO DECLARE AND IMPLEMENT IT IN YOUR OWN CODE. What part of this is not clear to you? Just copy the code I gave you and paste it into your source file about your existing <code>_MessageBox()</code> function."}, {"owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1552767576, "post_id": 55151073, "comment_id": 97139375, "body": "I&#39;m Sorry.. I&#39;m So stupid .. I understand  Know and this is Work! Thanks you!!Thank you for your patience and forgiveness again if I disturbed you"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "edited": false, "score": 0, "creation_date": 1556454844, "post_id": 55151073, "comment_id": 98437466, "body": "@pro: From <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>: <i>&quot;You may accept the answer that you believe is the best solution to your problem.&quot;</i> Also: <i>&quot;Please do not add a comment on your question or on an answer to say &quot;Thank you&quot;. If you want to say &quot;thank you,&quot; vote on or accept that person&#39;s answer&quot;</i>. Probably best to take the <a href=\"https://stackoverflow.com/tour\">tour</a>, too."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1552675472, "last_edit_date": 1552675472, "creation_date": 1552510637, "answer_id": 55151073, "question_id": 55150622, "link": "https://stackoverflow.com/questions/55150622/how-to-change-messagebox-position-in-c/55151073#55151073", "title": "How to Change MessageBox Position in C++", "body": "<p><code>MessageBox()</code> does not allow you to specify a position for its dialog window.</p>\n\n<p>However, you can manipulate the dialog window manually.  First, install a thread-local hook via <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-setwindowshookexw\" rel=\"nofollow noreferrer\"><code>SetWindowsHookEx()</code></a> or <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-setwineventhook\" rel=\"nofollow noreferrer\"><code>SetWinEventHook()</code></a> before calling <code>MessageBox()</code>.  The hook will give you access to the dialog window when it is created.  You can then do whatever you want with the dialog window, such as position it where you want to it to appear.</p>\n\n<p>For example:</p>\n\n<pre><code>// Using SetWindowsHookEx() ...\n\n__thread int MsgBox_X;\n__thread int MsgBox_Y;\n\nstatic LRESULT CALLBACK CBTProc(int nCode, WPARAM wParam, LPARAM lParam)\n{\n    if (nCode == HCBT_CREATEWND)\n    {\n        CBT_CREATEWND *s = (CBT_CREATEWND*) lParam;\n        s-&gt;lpcs-&gt;x = MsgBox_X;\n        s-&gt;lpcs-&gt;y = MsgBox_Y;\n    }\n    return CallNextHookEx(NULL, nCode, wParam, lParam);\n}\n\nint MessageBoxPos(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType, int X, int Y)\n{\n    HHOOK hHook = SetWindowsHookEx(WH_CBT, &amp;CBTProc, NULL, GetCurrentThreadId());\n    MsgBox_X = X;\n    MsgBox_Y = Y;\n    int result = MessageBox(hWnd, lpText, lpCaption, uType);\n    if (hHook) UnhookWindowsHookEx(hHook);\n    return result;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>// Using SetWinEventHook() ...\n\n__thread int MsgBox_X;\n__thread int MsgBox_Y;\n\nstatic void CALLBACK WinEventProc(HWINEVENTHOOK hWinEventHook, DWORD event, HWND hwnd, LONG idObject, LONG idChild, DWORD dwEventThread, DWORD dwmsEventTime)\n{\n    SetWindowPos(hwnd, NULL, MsgBox_X, MsgBox_Y, 0, 0, SWP_NOSIZE | SWP_NOZORDER);\n}\n\nint MessageBoxPos(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType, int X, int Y)\n{\n    HWINEVENTHOOK hHook = SetWinEventHook(EVENT_OBJECT_CREATE, EVENT_OBJECT_CREATE, NULL, &amp;WinEventProc, GetCurrentProcessId(), GetCurrentThreadId(), WINEVENT_INCONTEXT);\n    MsgBox_X = X;\n    MsgBox_Y = Y;\n    int result = MessageBox(hWnd, lpText, lpCaption, uType);\n    if (hHook)  UnhookWinEvent(hHook);\n    return result;\n}\n</code></pre>\n\n<p>Either way, you can then call <code>MessageBoxPos()</code> as needed:</p>\n\n<pre><code>void _MessageBox()\n{\n    ResultMB = MessageBoxPos(NULL, TEXT(\"MB!\"), TEXT(\"Message\"), MB_OK, DesiredX, DesiredY);\n    if (ResultMB == IDOK)\n    {\n        for (int q = 1; q &lt; 5; q++)\n        {\n            ResultMB = MessageBoxPos(NULL, TEXT(\"hi\"), TEXT(\"Message\"), MB_OK, DesiredX, DesiredY);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11198690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91f49bfca3ebfc42229a445ccc40c4?s=128&d=identicon&r=PG&f=1", "display_name": "Progremmer3", "link": "https://stackoverflow.com/users/11198690/progremmer3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1552675472, "creation_date": 1552508698, "question_id": 55150622, "link": "https://stackoverflow.com/questions/55150622/how-to-change-messagebox-position-in-c", "title": "How to Change MessageBox Position in C++", "body": "<pre><code>void _MessageBox()\n{\nResultMB = MessageBox(NULL, TEXT(\"MB!\"), TEXT(\"Message\"), MB_OK);\n    if (ResultMB == IDOK)\n    {\n        for (int q = 1; q &lt; 5; q++)\n         {\n            ResultMB = MessageBox(NULL, TEXT(\"hi\"), TEXT(\"Message\"), MB_OK);\n         }\n    }\n}\n</code></pre>\n\n<p>I want to make every MessageBox be somewhere else on the screen\nBut I do not know how to change a position using C ++</p>\n"}, {"tags": ["c++", "vector", "types", "custom-data-type"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1552508862, "post_id": 55150612, "comment_id": 97041649, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Starting with line 1 we cannot possibly know what <code>vecmath::prod</code> is actually doing"}, {"owner": {"reputation": 11, "user_id": 9969625, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDuh7wlrfgw/AAAAAAAAAAI/AAAAAAAAAHA/WQnhtTgwoP0/photo.jpg?sz=128", "display_name": "GHOST", "link": "https://stackoverflow.com/users/9969625/ghost"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552508958, "post_id": 55150612, "comment_id": 97041693, "body": "vecmath::prod is calculating the Product of any given Vector b and the Vector in vecmath itself."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552509040, "post_id": 55150612, "comment_id": 97041735, "body": "apparently it does not, otherwise you would not be asking here. Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read the <a href=\"https://stackoverflow.com/help\">help center</a>. Among other things you will get informed that questions seeking debugging help are required to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, desired and expected output"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1552509237, "post_id": 55150612, "comment_id": 97041819, "body": "Among the code that is missing is the <code>vecmath</code> class definition, constructor definition, <code>operator+</code> with vecmath operators, and the <code>nfzehnhoch</code> function."}, {"owner": {"reputation": 11, "user_id": 9969625, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDuh7wlrfgw/AAAAAAAAAAI/AAAAAAAAAHA/WQnhtTgwoP0/photo.jpg?sz=128", "display_name": "GHOST", "link": "https://stackoverflow.com/users/9969625/ghost"}, "edited": false, "score": 0, "creation_date": 1552509832, "post_id": 55150612, "comment_id": 97042089, "body": "Ok, I have updated it. The nfzehnhoch function was explained."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552510018, "post_id": 55150612, "comment_id": 97042163, "body": "Please read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It is not sufficient when you tell us what <code>nfzehnhoch</code> is doing, but we need to see the code. Somewhere you have a bug, most likely in a place where you do not expect it. Dont let us play hide and seek but give us all the code that is necessary to reproduce the problem"}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552511146, "post_id": 55150992, "comment_id": 97042700, "body": "the example is calculating powers of 2, maybe it is just coincidence that it fails after 64 steps"}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1552510164, "creation_date": 1552510164, "answer_id": 55150992, "question_id": 55150612, "link": "https://stackoverflow.com/questions/55150612/c-vector-product-with-integer/55150992#55150992", "title": "C++ Vector Product with Integer", "body": "<p>The value you get stuck at is 2^64. The underlying library is probably detecting the overflow and not doing the multiplication.</p>\n"}], "owner": {"reputation": 11, "user_id": 9969625, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDuh7wlrfgw/AAAAAAAAAAI/AAAAAAAAAHA/WQnhtTgwoP0/photo.jpg?sz=128", "display_name": "GHOST", "link": "https://stackoverflow.com/users/9969625/ghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552510185, "creation_date": 1552508659, "last_edit_date": 1552510185, "question_id": 55150612, "link": "https://stackoverflow.com/questions/55150612/c-vector-product-with-integer", "title": "C++ Vector Product with Integer", "body": "<p>I have a weird Limit with my Datatype. Without explaining much, I will just show you.</p>\n\n<p>This is the Class.</p>\n\n<pre><code>class vecmath\n{\nprivate:\n    std::vector&lt;int&gt; avec;\npublic:\n    vecmath(std::string b);\n    vecmath(std::vector&lt;int&gt;);\n    ~vecmath();\n    vecmath add(vecmath b);\n    vecmath mult(vecmath b);\n    vecmath prod(vecmath b);\n    void read();\n    std::string write();\n    std::vector&lt;int&gt; getVec();\n    vecmath operator+(vecmath a);\n    vecmath operator*(vecmath a);\n};\n</code></pre>\n\n<p>This is the constructor which is being used.</p>\n\n<pre><code>vecmath::vecmath(std::string b) {\n    for (unsigned long long i = 0; i &lt; b.length(); ++i) {\n        avec.push_back((int)(b[i]) - 48);\n    }\n}\n</code></pre>\n\n<p>This is the Add Function. It is being called in the operator+ function which just returns it.</p>\n\n<pre><code>vecmath vecmath::add(vecmath b) {\n    std::vector&lt;int&gt; cbvec = b.getVec();\n    std::vector&lt;int&gt; cavec = avec;\n    if (cavec.size() &gt; cbvec.size()) {\n        std::swap(cbvec, cavec);\n    }\n\n    std::vector&lt;int&gt; ret;\n    unsigned long long asize = cavec.size();\n    unsigned long long bsize = cbvec.size();\n\n    std::reverse(cavec.begin(), cavec.end());\n    std::reverse(cbvec.begin(), cbvec.end());\n\n    int carry = 0;\n    for (unsigned long long i = 0; i &lt; asize; ++i) {\n\n        int sum = (cavec[i] + cbvec[i] + carry);\n        ret.push_back(sum % 10);\n\n        carry = sum / 10;\n    }\n\n    for (unsigned long long i = asize; i &lt; bsize; ++i) {\n        int sum = (cbvec[i] + carry);\n        ret.push_back(sum % 10);\n        carry = sum / 10;\n    }\n\n    if (carry) {\n        ret.push_back(carry);\n    }\n\n    std::reverse(ret.begin(), ret.end());\n\n    return vecmath(ret);\n}\n</code></pre>\n\n<p>This is the function which calculates a Product from 2 Vectors (1 is in the Class itself).</p>\n\n<pre><code>vecmath vecmath::prod(vecmath b) {\n    vecmath ret(\"0\");\n    std::vector&lt;int&gt; cbvec = b.getVec();\n    std::vector&lt;int&gt; cavec = avec;\n\n    if(cavec.size() &gt; cbvec.size()) {\n        std::swap(cavec, cbvec);\n    }\n\n    unsigned long long asize = cavec.size();\n    unsigned long long bsize = cbvec.size();\n\n    std::reverse(cavec.begin(), cavec.end());\n    std::reverse(cbvec.begin(), cbvec.end());\n\n    for(unsigned long long i = 0; i &lt; asize; ++i) {\n        for (unsigned long long j = 0; j &lt; bsize; ++j) {\n            ret = ret + vecmath(std::to_string(cavec[i] * cbvec[j] * nfzehnhoch(i) * nfzehnhoch(j)));\n        }\n    }\n\n    return ret;\n}\n</code></pre>\n\n<p>This is the nfzehnhoch function.</p>\n\n<pre><code>unsigned long long nfzehnhoch(unsigned int n) {\n    unsigned long long ret = 1;\n    for(unsigned int i = 0; i &lt; n; ++i) {\n        ret *= 10;\n    }\n    return ret;\n}\n</code></pre>\n\n<p>This is my main Function.</p>\n\n<pre><code>int main(void) {\n    vecmath a(\"2\");\n    vecmath c(\"2\");\n\n    for(int i = 1; i &lt;= 100; ++i) {\n        std::cout &lt;&lt; c.write() &lt;&lt; \", \" &lt;&lt; std::endl;\n        c = c * a;\n    }\n\n    std::string end;\n    std::getline(std::cin, end);\n}\n</code></pre>\n\n<p>This is what I get when I run it.</p>\n\n<p>2,\n4,\n8,\n16,\n32,\n64,\n128,\n256,\n512,\n1024,\n2048,\n4096,\n8192,\n16384,\n32768,\n65536,\n131072,\n262144,\n524288,\n1048576,\n2097152,\n4194304,\n8388608,\n16777216,\n33554432,\n67108864,\n134217728,\n268435456,\n536870912,\n1073741824,\n2147483648,\n4294967296,\n8589934592,\n17179869184,\n34359738368,\n68719476736,\n137438953472,\n274877906944,\n549755813888,\n1099511627776,\n2199023255552,\n4398046511104,\n8796093022208,\n17592186044416,\n35184372088832,\n70368744177664,\n140737488355328,\n281474976710656,\n562949953421312,\n1125899906842624,\n2251799813685248,\n4503599627370496,\n9007199254740992,\n18014398509481984,\n36028797018963968,\n72057594037927936,\n144115188075855872,\n288230376151711744,\n576460752303423488,\n1152921504606846976,\n2305843009213693952,\n4611686018427387904,\n9223372036854775808,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,\n18446744073709551616,</p>\n\n<p>As you see, it's stuck at 18446744073709551616. Maybe someone will just take a glance at it and find out.</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["c++", "performance", "sorting", "benchmarking", "branch-prediction"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1552508738, "post_id": 55150605, "comment_id": 97041605, "body": "First, Did you compile with optimizations turned on?  Second, I&#39;ve not seen a 10x difference but normally the first run is slower since the code is &quot;cold&quot;."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1552508921, "post_id": 55150605, "comment_id": 97041678, "body": "Third, a vector of size 5 really doesn&#39;t provide a meaningful benchmark.  Use at least a few thousand items.  Fourth, how is <code>getRandomIntVectorWithConstantSeed</code> implemented?"}, {"owner": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552509803, "post_id": 55150605, "comment_id": 97042071, "body": "@NathanOliver I have edited my post to include the implementation of <code>getRandomIntVectorWithConstantSeed</code>. I need to perform benchmakrs for small lists because I want to see at which point my quicksort implementation starts outperforming insertion sort."}, {"owner": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552510812, "post_id": 55150605, "comment_id": 97042553, "body": "@NathanOliver No, I did not compile with optimizations turned on. Nevertheless, compiling with optimizations on still results in the first method call taking roughly 10 times longer than the others."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1552518071, "post_id": 55150605, "comment_id": 97045245, "body": "Benchmarking with optimization disabled is generally useless.  That said, there obviously is an effect here, but there are many startup effects in microbenchmarking."}], "answers": [{"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1552518022, "post_id": 55152107, "comment_id": 97045229, "body": "The OP is writing the array right before sorting; it will already be hot in L1d cache.  (And registers like you originally said isn&#39;t plausible; they aren&#39;t a cache unless the compiler uses them that way, and that&#39;s not plausible unless the benchmark mostly optimized away.)"}], "tags": [], "owner": {"reputation": 1, "user_id": 9769625, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JAjxsyHEfxs/AAAAAAAAAAI/AAAAAAAAA9w/cg-cSUQ1dWY/photo.jpg?sz=128", "display_name": "Carlos Bernal", "link": "https://stackoverflow.com/users/9769625/carlos-bernal"}, "is_accepted": false, "score": 0, "last_activity_date": 1552517423, "last_edit_date": 1552517423, "creation_date": 1552516097, "answer_id": 55152107, "question_id": 55150605, "link": "https://stackoverflow.com/questions/55150605/first-method-call-takes-10-times-longer-than-consecutive-calls-with-the-same-dat/55152107#55152107", "title": "First method call takes 10 times longer than consecutive calls with the same data", "body": "<p>Probably is because of caching, as the memory needs to be fetched from DRAM and allocated in CPU's data cache the first time.  That takes (much) more latency more than loads that hit in the CPU's cache.</p>\n\n<p>Then as your instructions are in the pipeline they follow the same branch as it is the instructions from the same memory source as it doesn't need to be invalidated because is the same pointer.</p>\n\n<p>Would be interesting if you implement 4 methods with more or less the same functionality and then swap between them to see what happen.</p>\n"}, {"comments": [{"owner": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "edited": false, "score": 1, "creation_date": 1552556389, "post_id": 55152415, "comment_id": 97057499, "body": "I tried using different random arrays and the average time stays roughly the same (neither obviously higher nor lower)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "edited": false, "score": 1, "creation_date": 1552556623, "post_id": 55152415, "comment_id": 97057659, "body": "@K.Claesson: ok, then it is branch prediction.  Apparently even 1 iteration is enough to make a huge difference.  You can see the 2nd iteration in your plot is still slightly slower than the rest, so it&#39;s still learning the pattern.  And compiling with optimization disabled is enough of a bottleneck to hide a few mispredicts.  (BTW, &quot;core i5&quot; tells us that it&#39;s an Intel mainstream CPU of Nehalem or newer, so at least 2008 or so.  Sandybridge changed a lot of internals, so just saying &quot;i5&quot; doesn&#39;t narrow it down much.  Not that it matters in this case, TAGE since SnB with various improvements.)"}, {"owner": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "edited": false, "score": 0, "creation_date": 1552557911, "post_id": 55152415, "comment_id": 97058473, "body": "Given that it is branch prediction that causes the significant performance boost after the first run (or first couple runs), would you discard the first  measurement when calculating the average execution time of the algorithm and present the execution time of the first iteration separetely, or would you include the first measurement in the average? Which would be the best way to quantify the &quot;real-world&quot; performance of the algorithm?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "edited": false, "score": 1, "creation_date": 1552558347, "post_id": 55152415, "comment_id": 97058752, "body": "@K.Claesson: Is the real-world use-case sorting the same input repeatedly?  Or is it sorting different inputs?  For sorting, it&#39;s almost always the variable-input case that&#39;s interesting, so you should remove the <code>srand</code> from your input generator and microbenchmark with varying data.  It&#39;s also interesting to measure the already-sorted case, and maybe the warmed-up case.  (By contrast, binary searching can be different. Sometimes repeated queries for the same key are common, so warming up the branch predictors for a fixed data-set and key is a &quot;fair&quot; microbenchmark)."}, {"owner": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "edited": false, "score": 0, "creation_date": 1552558687, "post_id": 55152415, "comment_id": 97058978, "body": "The real-world use case is sorting different inputs. I have modified my tests so that I sort a set of different vectors (to minimize the &quot;bias&quot; of the vector) and sort each vector multiple times (to minimize &quot;bias&quot; from the particular run)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "edited": false, "score": 1, "creation_date": 1552559236, "post_id": 55152415, "comment_id": 97059336, "body": "@K.Claesson: Modern Intel CPUs can &quot;learn&quot; surprisingly long branch-prediction patterns.  e.g. I was playing around with a bubblesort (optimized for tiny code size), and tried benchmarking it by copying in the same data repeatedly.  I got like 0.1% branch mispredicts IIRC, even with a 16-element array or so on Skylake!  So be careful just alternating a couple different vectors.  But if you rotate through copying enough different input vectors (or better, copy slices of a big array into the same <code>std::vector</code>, to avoid any alloc/dealloc), you should get &quot;realistic&quot; times."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1552517952, "creation_date": 1552517952, "answer_id": 55152415, "question_id": 55150605, "link": "https://stackoverflow.com/questions/55150605/first-method-call-takes-10-times-longer-than-consecutive-calls-with-the-same-dat/55152415#55152415", "title": "First method call takes 10 times longer than consecutive calls with the same data", "body": "<p>Yes, it could be a page fault on the page holding the code for the sort function (and the timing code itself).  The 10x could also include ramp-up to max turbo clock speed.</p>\n\n<p>Caching is not plausible, though: you're writing the (tiny) array outside the timed region, unless the compiler somehow reordered the init with the constructor of your <code>Timer</code>.  Memory allocation being much slower the first time would easily explain it, maybe having to make a system call to get a new page the first time, but later calls to <code>new</code> (to construct std::vector) just grabbing already-hot-in-cache memory from the free list.</p>\n\n<p><strong>Training the branch predictors could also be a big factor</strong>, but you'd expect it to take more than 1 run before the TAGE branch predictors in a modern Intel CPU, or the perceptron predictors in a modern AMD, \"learned\" the full pattern of all the branching.  But maybe they get close after the first run.</p>\n\n<p><strong>Note that you produce the <em>same</em> random array every time, by using <code>srand()</code> on every call.</strong>  To test if branch prediction is the explanation, remove the <code>srand</code> so you get different arrays every time, and see if the time stays much higher.</p>\n\n<p>What CPU, compiler version / options, etc. are you using?</p>\n"}], "owner": {"reputation": 437, "user_id": 2441615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22651679ce216dc2e20778a92b68a08?s=128&d=identicon&r=PG", "display_name": "K. Claesson", "link": "https://stackoverflow.com/users/2441615/k-claesson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 55152415, "answer_count": 2, "score": 2, "last_activity_date": 1552558375, "creation_date": 1552508611, "last_edit_date": 1552558375, "question_id": 55150605, "link": "https://stackoverflow.com/questions/55150605/first-method-call-takes-10-times-longer-than-consecutive-calls-with-the-same-dat", "title": "First method call takes 10 times longer than consecutive calls with the same data", "body": "<p>I am performing some execution time benchmarks for my implementation of quicksort. Out of 100 successive measurements on exactly the same input data it seems like the first call to quicksort takes roughly 10 times longer than all consecutive calls. Is this a consequence of the operating system getting ready to execute the program, or is there some other explanation? Moreover, is it reasonable to discard the first measurement when computing an average runtime?</p>\n\n<p>The below bar chart illustrates execution time (miliseconds) versus method call number. Each time the method is called it processes the exact same data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tRAfl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tRAfl.png\" alt=\"execution time vs. method call number\"></a></p>\n\n<p>To produce this particular graph the main method makes a call to <code>quicksort_timer::time_fpi_quicksort(5, 100)</code> whose implementation can be seen below.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>static void time_fpi_quicksort(int size, int runs)\n{\n    std::vector&lt;int&gt; vector(size);\n    for (int i = 0; i &lt; runs; i++)\n    {\n        vector = utilities::getRandomIntVectorWithConstantSeed(size);\n        Timer timer;\n        quicksort(vector, ver::FixedPivotInsertion);\n    }\n}\n</code></pre>\n\n<p>The <code>getRandomIntVectorWithConstantSeed</code> is implemented as follows</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>   std::vector&lt;int&gt; getRandomIntVectorWithConstantSeed(int size)\n   {\n      std::vector&lt;int&gt; vector(size);\n      srand(6475307);\n      for (int i = 0; i &lt; size; i++)\n         vector[i] = rand();\n      return vector;\n   }\n</code></pre>\n\n<p><strong>CPU and Compilation</strong></p>\n\n<p>CPU: Broadwell 2.7 GHz Intel Core i5 (5257U)</p>\n\n<p>Compiler Version: Apple LLVM version 10.0.0 (clang-1000.11.45.5)</p>\n\n<p>Compiler Options: <code>-std=c++17 -O2 -march=native</code></p>\n"}, {"tags": ["c++", "tuples", "c++17"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1552507811, "post_id": 55150392, "comment_id": 97041155, "body": "Can you tun this into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?  The code loos like it could work but it is missing stuff."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1552508257, "post_id": 55150392, "comment_id": 97041377, "body": "Why ignore the previous versions? I mean are you going to stop using virtual functions because they were in &#39;98?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 2, "creation_date": 1552508421, "post_id": 55150392, "comment_id": 97041454, "body": "@GemTaylor A less hostile interpretation of the question might be: &quot;We have structured bindings in C++17. Does there exist a new, nicer way for me to solve this problem, or do I have to use the old way?&quot;"}, {"owner": {"reputation": 154, "user_id": 2397351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a8d26329f12de8df1cc55b9436012cb?s=128&d=identicon&r=PG", "display_name": "Mercutio Calviary", "link": "https://stackoverflow.com/users/2397351/mercutio-calviary"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1552508555, "post_id": 55150392, "comment_id": 97041524, "body": "@Barry, That is exactly what I am asking."}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 2397351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a8d26329f12de8df1cc55b9436012cb?s=128&d=identicon&r=PG", "display_name": "Mercutio Calviary", "link": "https://stackoverflow.com/users/2397351/mercutio-calviary"}, "edited": false, "score": 0, "creation_date": 1552517285, "post_id": 55150457, "comment_id": 97045024, "body": "Well that is unfortunate, there is always hope for C++2X"}, {"owner": {"reputation": 1409, "user_id": 6385640, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muwyWfIjFd8/AAAAAAAAAAI/AAAAAAAAAG0/nctjQMOQOQY/photo.jpg?sz=128", "display_name": "Red.Wave", "link": "https://stackoverflow.com/users/6385640/red-wave"}, "edited": false, "score": 0, "creation_date": 1552568054, "post_id": 55150457, "comment_id": 97064966, "body": "And probably make the tuple accepting ctor private."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 5, "last_activity_date": 1552507916, "creation_date": 1552507916, "answer_id": 55150457, "question_id": 55150392, "link": "https://stackoverflow.com/questions/55150392/c17-tuple-unpacking/55150457#55150457", "title": "C++17 Tuple Unpacking", "body": "<p>Not really. Structured bindings can only <em>declare</em> new names, it cannot <em>assign</em> to existing ones.</p>\n\n<p>Best would be to just do this:</p>\n\n<pre><code>foo() : foo(IO()) { } // delegate to a constructor, calling IO\n\nfoo(std::tuple&lt;A, vector&lt;A&gt;&gt;&amp;&amp; tup) // manually unpack within this constructor\n  : var(std::get&lt;0&gt;(std::move(tup)))\n  , vec(std::get&lt;1&gt;(std::move(tup)))\n{ }\n</code></pre>\n\n<hr />\n\n<p>If <code>A</code> happens to be default constructible and move assignable, then yeah this works too:</p>\n\n<pre><code>foo() {\n    std::tie(var, vec) = IO();\n}\n</code></pre>\n\n<p>If <code>A</code> happens to <em>not</em> be default constructible, then you could use <code>optional</code> to add that extra state:</p>\n\n<pre><code>struct foo {\n    std::optional&lt;A&gt; var;\n    std::vector&lt;A&gt; vec;\n\n    foo() {\n        std::tie(var, vec) = IO();\n    }\n};\n</code></pre>\n\n<p>None of these are particularly great.</p>\n"}], "owner": {"reputation": 154, "user_id": 2397351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a8d26329f12de8df1cc55b9436012cb?s=128&d=identicon&r=PG", "display_name": "Mercutio Calviary", "link": "https://stackoverflow.com/users/2397351/mercutio-calviary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 55150457, "answer_count": 1, "score": 2, "last_activity_date": 1552507985, "creation_date": 1552507624, "last_edit_date": 1552507985, "question_id": 55150392, "link": "https://stackoverflow.com/questions/55150392/c17-tuple-unpacking", "title": "C++17 Tuple Unpacking", "body": "<p>I am trying to unpack a tuple and use the results to assign into members. Is it possible to do that in idiomatic C++17? </p>\n\n<p>I realize that <code>std::tie</code> exists but I am trying to utilize C++17 features and not default to older features nor the old way (<code>std::get&lt;N&gt;(tuple)</code>)</p>\n\n<pre><code>tuple&lt;A, vector&lt;A&gt;&gt; IO(){\n     //IO happens here\n     return {var, vec};\n}\n\nclass foo{\npublic:\n    foo();\nprivate:\n    A var;\n    vector&lt;A&gt; vec;\n};\n\nfoo::foo(){\n    //this line here: I want to assign var and vec from IO()\n    [var, vec] = IO();\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "filereader"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1552506878, "post_id": 55150169, "comment_id": 97040746, "body": "I think you&#39;re walking on yourself. Try making <code>int count</code> and <code>std:: int count</code> different names. That will ensure the variable you actually want is used. If you still have a problem after that, feel free to ask."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1552506883, "post_id": 55150169, "comment_id": 97040749, "body": "What are &quot;some errors&quot; ? Please include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and the error message"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1552506902, "post_id": 55150169, "comment_id": 97040759, "body": "Do yourself a favour and use a <code>std::vector</code>. This code would be literally three lines and no bugs. Arrays are primitive, under-powered, verbose and above all difficult."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1552507033, "post_id": 55150169, "comment_id": 97040818, "body": "also, <code>cout&lt;&lt;count</code> probably outputs 8 since cout is actually std::cout, meaning it uses std::count, which is filled from file&gt;&gt;count because file is probably an std::ifstream. Hopefully that makes sense."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1552507923, "post_id": 55150169, "comment_id": 97041214, "body": "<code>*new ELEMENT[count]</code> discards the address of the allocated memory. It\u2019s a memory leak."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1552508040, "post_id": 55150169, "comment_id": 97041283, "body": "@PeteBecker given you can&#39;t see the scope of the variable; how can you be sure (though I&#39;m not saying it doesn&#39;t leak - or is exception safe)?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1552511404, "post_id": 55150169, "comment_id": 97042805, "body": "@UKMonkey \u2014 you\u2019re right: if the type of <code>elme</code> is <code>ELEMENT &amp;</code> the code can use <code>delete &amp;elme</code> to release the memory. Of course, that\u2019s a horrible thing to do."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1552512113, "post_id": 55150491, "comment_id": 97043111, "body": "And you can even get rid of the manual loop if you use <code>std::copy()</code> with <code>std::istream_iterator</code> and <code>std::back_inserter</code>, eg: <code>std::copy(std::istream_iterator&lt;int&gt;(file), std::istream_iterator(), std::back_inserter(v));</code>"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1552521345, "post_id": 55150491, "comment_id": 97046104, "body": "@RemyLebeau Don&#39;t need the copy. The vector can be created by passing two iterators. <code>std::vector&lt;int&gt;  v(std::istream_iterator&lt;int&gt;{file}, std::istream_iterator&lt;int&gt;{})</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1552522055, "post_id": 55150491, "comment_id": 97046286, "body": "@MartinYork sure, if you fill the <code>vector</code> during its initialization.  But, if not, then <code>std::copy()</code> comes in handy for this."}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 1, "last_activity_date": 1552508061, "creation_date": 1552508061, "answer_id": 55150491, "question_id": 55150169, "link": "https://stackoverflow.com/questions/55150169/how-to-read-from-a-text-file-and-adding-to-array-in-c/55150491#55150491", "title": "How to read from a text file and adding to array in c++", "body": "<p>To sum up what others have said, this is extremely easy with <code>std::vector</code>:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n\nint main ()\n{\n    std::ifstream file;\n    file.open (\"&lt;path of HEAPinput&gt;\");\n    if(!file)\n    {\n        std::cout &lt;&lt; \"There was a problem opening file HEAPinput2.txt for reading\";\n        exit (0);\n    }\n\n    std::vector &lt;int&gt; v;\n    int i;\n    while (file &gt;&gt; i)\n        v.push_back (i);\n    file.close ();\n}\n</code></pre>\n\n<p>More details on <code>std::vector</code> here:</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/container/vector</a></p>\n"}, {"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 0, "last_activity_date": 1552508322, "creation_date": 1552508322, "answer_id": 55150546, "question_id": 55150169, "link": "https://stackoverflow.com/questions/55150169/how-to-read-from-a-text-file-and-adding-to-array-in-c/55150546#55150546", "title": "How to read from a text file and adding to array in c++", "body": "<p>Assuming that the first integer of the text file is the number of remaining integers to be read, and that <code>elme</code> is an <code>int*</code>, and that you are not allowed for this exercise to use vectors: </p>\n\n<pre><code>else{\n    int count = 0;    // this should REALLY be declared in same block as elme\n    int i=0; \n    if(file&gt;&gt;count) {  \n        elme = new int[count];   // assuming that count is valid and not 0\n        while (i&lt;count &amp;&amp; file&gt;&gt;elme[i]) \n            i++;   \n        count = i; //  to adjust the number of items to the number really read\n    }\n    cout&lt;&lt;count; \n}\nbreak;\n</code></pre>\n\n<p>If you're allowed to use vectors,  then go to Paul Sander's answer because vector is really century XXI for C++, whereas dynamically allocated arrays are something like the medieval age.    </p>\n"}], "owner": {"reputation": 49, "user_id": 10792504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/648b3a59f7214c011cbe567a947dd60d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Young", "link": "https://stackoverflow.com/users/10792504/mark-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552508322, "creation_date": 1552506668, "question_id": 55150169, "link": "https://stackoverflow.com/questions/55150169/how-to-read-from-a-text-file-and-adding-to-array-in-c", "title": "How to read from a text file and adding to array in c++", "body": "<p>How would I go about reading numbers from a text file and adding them to an array? </p>\n\n<p><strong>textfile</strong>: HEAPinput2.txt</p>\n\n<pre><code>12\n9\n10\n11\n12\n2\n4\n6\n5\n3\n1\n7\n8\n</code></pre>\n\n<p>What I have here is a snippet of my code. If needed I will provide my whole main. But essentially I have a switch statement, when user chooses <strong>R</strong> read from a file and sort them into the array. I've been looking online and have been seeing different ways of doing it, I have done it as shown below, but have been running into some errors </p>\n\n<pre><code>case 'R':\nfile.open(\"&lt;path of HEAPinput&gt;\");\nif(!file){\n        cout&lt;&lt;\"There was a problem opening file HEAPinput2.txt for reading\";\n        exit(0);\n }\nelse{\n        int count = 0;\n        std:: int count;\n        while(file&gt;&gt;count){\n                    count++; //making sure it increments the\n        }\n        elme = *new ELEMENT[count];\n        cout&lt;&lt;count; //prints out 8 for some reason\n    }\n    break;\n</code></pre>\n"}, {"tags": ["c++", "vector", "reinterpret-cast"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1552505963, "post_id": 55150001, "comment_id": 97040314, "body": "I find it interesting that this code inserts anything into the vector at all."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1552506136, "post_id": 55150001, "comment_id": 97040410, "body": "Why are you using a <code>void*</code> for the type in the vector?"}, {"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1552506149, "post_id": 55150001, "comment_id": 97040417, "body": "int and pointers often have different sizes which will break this. Otherwise you still are looking at UB galore too."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 5, "creation_date": 1552506327, "post_id": 55150001, "comment_id": 97040493, "body": "<code>reinterpret_cast</code> is a <i>huge</i> &quot;there&#39;s probably a bug here&quot; flag. Also; <i>Why</i> <code>void*</code>?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1552506461, "post_id": 55150001, "comment_id": 97040543, "body": "<code>void *</code> should only be used in C++ when interfacing with an API that demands it and a few extremely rare edge cases.  Instead of <code>void *</code>, use templates, overloads, inheritance, and <code>std::variant</code> if it&#39;s supported."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1552506469, "post_id": 55150001, "comment_id": 97040549, "body": "And before you run into next trouble: <code>col.push_back(reinterpret_cast&lt;void*&gt;(static_cast&lt;intptr_t&gt;(&zwnj;&#8203;value)));</code> \u2013 you need the intermediate step (intptr_t) to get an integer of appropriate size to be reinterpret-casted! Still I agree with the `most likely bug&#39; fraction..."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552506580, "post_id": 55150001, "comment_id": 97040596, "body": "If you would explain why you feel you need to do this, I&#39;m confident we can point you to a better, safer and easier solution."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1552543992, "post_id": 55150001, "comment_id": 97051576, "body": "Oh my. If the source contains <i>such</i> code \u2013 and if I additionally see limiting string lengths not simply to a maximum, but only to a subset of these limited lengths (<code>RTType</code> enum!), I&#39;d immediately exclude it from use in my own projects..."}], "answers": [{"comments": [{"owner": {"reputation": 2114, "user_id": 1737747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3212488a3cf5394b93f203ab7aa9af3?s=128&d=identicon&r=PG", "display_name": "Khalefa", "link": "https://stackoverflow.com/users/1737747/khalefa"}, "edited": false, "score": 0, "creation_date": 1552508610, "post_id": 55150104, "comment_id": 97041551, "body": "Thank you for your response. It is unfortunately not my code. it is extracted from <a href=\"https://github.com/TimoKersten/db-engine-paradigms/blob/ae3286b279ad26ab294224d630d650bc2f2f3519/src/common/runtime/Import.cpp#L134\" rel=\"nofollow noreferrer\">github.com/TimoKersten/db-engine-paradigms/blob/&hellip;</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 2114, "user_id": 1737747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3212488a3cf5394b93f203ab7aa9af3?s=128&d=identicon&r=PG", "display_name": "Khalefa", "link": "https://stackoverflow.com/users/1737747/khalefa"}, "edited": false, "score": 1, "creation_date": 1552508970, "post_id": 55150104, "comment_id": 97041695, "body": "@Khalefa then you can&#39;t trust using that code. What it is doing is not safe."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 6, "last_activity_date": 1552506762, "last_edit_date": 1552506762, "creation_date": 1552506359, "answer_id": 55150104, "question_id": 55150001, "link": "https://stackoverflow.com/questions/55150001/vector-with-reinterpret-cast/55150104#55150104", "title": "vector with reinterpret_cast", "body": "<p>Your code is exhibiting <strong>undefined behavior</strong>.</p>\n\n<p><code>std::vector&lt;void*&gt;</code> and <code>std::vector&lt;int&gt;</code> are two completely separate and unrelated types, you can't safely cast between them the way you are, especially since there is no guarantee that <code>void*</code> and <code>int</code> are the same byte size.</p>\n\n<p>Cast the <em>values</em> you are pushing, don't cast the <code>vector</code> itself, eg:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cstdint&gt;\nusing namespace std;\n\nvoid add(std::vector&lt;void*&gt; &amp;col) {\n    col.push_back(reinterpret_cast&lt;void*&gt;(static_cast&lt;intptr_t&gt;(1)));\n    col.push_back(reinterpret_cast&lt;void*&gt;(static_cast&lt;intptr_t&gt;(2)));\n    col.push_back(reinterpret_cast&lt;void*&gt;(static_cast&lt;intptr_t&gt;(13)));\n}\n\nint main() {\n    std::vector&lt;void*&gt; col;\n\n    add(col);\n\n    cout &lt;&lt; col.size() &lt;&lt; endl;\n    for(int i=0;i&lt;col.size();i++)\n        cout &lt;&lt; reinterpret_cast&lt;intptr_t&gt;(col[i]) &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Of course, you really should be using the proper container type to begin with:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nvoid add(std::vector&lt;int&gt; &amp;col) {\n    col.push_back(1);\n    col.push_back(2);\n    col.push_back(13);\n}\n\nint main() {\n    std::vector&lt;int&gt; col;\n\n    add(col);\n\n    cout &lt;&lt; col.size() &lt;&lt; endl;\n    for(int i=0;i&lt;col.size();i++)\n        cout &lt;&lt; col[i] &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 2114, "user_id": 1737747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3212488a3cf5394b93f203ab7aa9af3?s=128&d=identicon&r=PG", "display_name": "Khalefa", "link": "https://stackoverflow.com/users/1737747/khalefa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1748, "favorite_count": 0, "accepted_answer_id": 55150104, "answer_count": 1, "score": -3, "last_activity_date": 1552508757, "creation_date": 1552505885, "last_edit_date": 1552508757, "question_id": 55150001, "link": "https://stackoverflow.com/questions/55150001/vector-with-reinterpret-cast", "title": "vector with reinterpret_cast", "body": "<p>The following code inserts only one value to the vector <code>col</code>.\nThe code is extracted from DBMS code base (for importing files), specifically, it is from <a href=\"https://github.com/TimoKersten/db-engine-paradigms/blob/ae3286b279ad26ab294224d630d650bc2f2f3519/src/common/runtime/Import.cpp#L134\" rel=\"nofollow noreferrer\">1</a></p>\n\n<p>The code uses void* to be able to read any field type (int, float, and so on).</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nvoid add(std::vector&lt;void*&gt; &amp;col){\n  reinterpret_cast&lt;std::vector&lt;int&gt;&amp;&gt;(col).push_back( 1);\n  reinterpret_cast&lt;std::vector&lt;int&gt;&amp;&gt;(col).push_back( 2);\n  reinterpret_cast&lt;std::vector&lt;int&gt;&amp;&gt;(col).push_back( 13);\n}\nint main() {\n std::vector&lt;void*&gt; col;\n\n add(col);\n cout &lt;&lt; col.size() &lt;&lt; endl;\n for(int i=0;i&lt;col.size();i++)\n    cout &lt;&lt;reinterpret_cast&lt;std::vector&lt;int&gt;&amp;&gt; (col)[i] &lt;&lt;endl;\n    return 0;\n}\n</code></pre>\n\n<p>I am not sure how this code work?</p>\n"}, {"tags": ["c++", "opengl", "colors", "lighting", "gouraud"], "answers": [{"tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": false, "score": 1, "last_activity_date": 1552513474, "creation_date": 1552513474, "answer_id": 55151660, "question_id": 55149946, "link": "https://stackoverflow.com/questions/55149946/opengl-how-do-i-render-individual-rgb-values-given-a-cross-product-that-contain/55151660#55151660", "title": "OpenGL: How do I render individual RGB values given a cross product that contains the total light?", "body": "<p>I recommend to write your first <a href=\"https://www.khronos.org/opengl/wiki/Shader\" rel=\"nofollow noreferrer\">Shader program</a>, which does per fragment lighting and consists of a <a href=\"https://www.khronos.org/opengl/wiki/Vertex_Shader\" rel=\"nofollow noreferrer\">Vertex Shader</a> and a <a href=\"https://www.khronos.org/opengl/wiki/Fragment_Shader\" rel=\"nofollow noreferrer\">Fragment Shader</a>.<br>\nThe program has to use GLSL version 2.00 (<a href=\"https://www.khronos.org/registry/OpenGL/index_gl.php\" rel=\"nofollow noreferrer\">OpenGL Shading Language 1.20 Specification</a>).  This program can access the Fixed function attributes by the built in variables <code>gl_Vertex</code>,  <code>gl_Normal</code> and  <code>gl_Color</code>, as the fixed function matrices <code>gl_NormalMatrix</code>, <code>gl_ModelViewMatrix</code> and <code>gl_ModelViewProjectionMatrix</code> and the function <code>ftransform()</code>.<br>\nSee als <a href=\"https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/attributes.php\" rel=\"nofollow noreferrer\">Built in Vertex Attributes</a> and <a href=\"http://www.lighthouse3d.com/tutorials/glsl-12-tutorial/hello-world-in-glsl/\" rel=\"nofollow noreferrer\">Hello World in GLSL</a>.<br>\nFurther the program has to use <a href=\"https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/uniform.php\" rel=\"nofollow noreferrer\">Uniform Variables</a> for the light colors and positions.</p>\n\n<p>The Vertex shader transforms the model space coordinates and vectors to view space and pass the to the fragment shader by <a href=\"https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/varying.php\" rel=\"nofollow noreferrer\">Varying Variables</a>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>std::string vertex_shader = R\"(\n#version 120\n\nuniform vec3 u_light_pos_1;\nuniform vec3 u_light_pos_2;\n\nvarying vec3 v_pos;\nvarying vec3 v_nv;\nvarying vec4 v_color;\nvarying vec3 v_light_pos1;\nvarying vec3 v_light_pos2;\n\nvoid main()\n{\n    v_pos        = (gl_ModelViewMatrix * gl_Vertex).xyz;\n    v_nv         = gl_NormalMatrix * gl_Normal;\n    v_color      = gl_Color;\n    v_light_pos1 = (gl_ModelViewMatrix * vec4(u_light_pos_1, 1.0)).xyz;\n    v_light_pos2 = (gl_ModelViewMatrix * vec4(u_light_pos_2, 1.0)).xyz;\n    gl_Position  = ftransform();\n}\n)\";\n</code></pre>\n\n<p>The fragment shader dose the <a href=\"https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/lighting.php\" rel=\"nofollow noreferrer\">per Fragment Light</a> calculations in view space:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>std::string fragment_shader = R\"(\n#version 120\n\nvarying vec3 v_pos;\nvarying vec3 v_nv;\nvarying vec4 v_color;\nvarying vec3 v_light_pos1;\nvarying vec3 v_light_pos2;\n\nuniform vec3 u_light_col_1;\nuniform vec3 u_light_col_2;\n\nvoid main()\n{\n    vec3 N  = normalize(v_nv); \n    vec3 L1 = normalize(v_light_pos1 - v_pos);\n    vec3 L2 = normalize(v_light_pos2 - v_pos);\n\n    float kd_1 = max(0.0, dot(L1, N));\n    float kd_2 = max(0.0, dot(L2, N));\n\n    vec3 light_sum = kd_1 * u_light_col_1 + kd_2 * u_light_col_2;\n\n    gl_FragColor = vec4(v_color.rgb * light_sum, v_color.a);\n}\n)\";\n</code></pre>\n\n<p>Compile the shader stages</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>GLuint generate_shader(GLenum stage, const std::string &amp;source)\n{\n    GLuint shader_obj = glCreateShader(stage);\n    const char *srcCodePtr = source.c_str();\n    glShaderSource(shader_obj, 1, &amp;srcCodePtr, nullptr);\n    glCompileShader(shader_obj);\n    GLint status;\n    glGetShaderiv(shader_obj, GL_COMPILE_STATUS, &amp;status);\n    if (status == GL_FALSE)\n    {\n        GLint maxLen;\n        glGetShaderiv(shader_obj, GL_INFO_LOG_LENGTH, &amp;maxLen);\n        std::vector&lt; char &gt;log( maxLen );\n        GLsizei len;\n        glGetShaderInfoLog(shader_obj, maxLen, &amp;len, log.data());\n        std::cout &lt;&lt; \"compile error:\" &lt;&lt; std::endl &lt;&lt; log.data() &lt;&lt; std::endl;\n    }\n    return shader_obj;\n}\n</code></pre>\n\n<p>and link the program.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>GLuint generate_program(const std::string &amp;vert_sh, const std::string &amp;frag_sh)\n{\n    std::cout &lt;&lt; \"compile vertex shader\" &lt;&lt; std::endl;\n    GLuint vert_obj = generate_shader(GL_VERTEX_SHADER, vert_sh);\n    std::cout &lt;&lt; \"compile fragment shader\" &lt;&lt; std::endl;\n    GLuint frag_obj = generate_shader(GL_FRAGMENT_SHADER, frag_sh);\n\n    std::cout &lt;&lt; \"link shader program\" &lt;&lt; std::endl;\n    GLuint program_obj = glCreateProgram();\n    glAttachShader(program_obj, vert_obj);\n    glAttachShader(program_obj, frag_obj);\n    glLinkProgram(program_obj);\n    GLint status;\n    glGetProgramiv(program_obj, GL_LINK_STATUS, &amp;status);\n    if (status == GL_FALSE)\n    {\n        GLint maxLen;\n        glGetProgramiv(program_obj, GL_INFO_LOG_LENGTH, &amp;maxLen);\n        std::vector&lt; char &gt;log( maxLen );\n        GLsizei len;\n        glGetProgramInfoLog(program_obj, maxLen, &amp;len, log.data());\n        std::cout  &lt;&lt; \"link error:\" &lt;&lt; std::endl &lt;&lt; log.data() &lt;&lt; std::endl;\n    }\n\n    glDeleteShader(vert_obj);\n    glDeleteShader(frag_obj);\n    return program_obj;\n}\n</code></pre>\n\n<p>Further get the uniform locations by <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetUniformLocation.xhtml\" rel=\"nofollow noreferrer\"><code>glGetUniformLocation</code></a> in the function <code>init</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>GLuint diffuse_prog_obj = 0;\nGLint loc_l_pos[] = {-1, -1};\nGLint loc_l_col[] = {-1, -1};\nvoid init()\n{\n    diffuse_prog_obj = generate_program(vertex_shader, fragment_shader);\n    loc_l_pos[0] = glGetUniformLocation(diffuse_prog_obj, \"u_light_pos_1\");\n    loc_l_pos[1] = glGetUniformLocation(diffuse_prog_obj, \"u_light_pos_2\");\n    loc_l_col[0] = glGetUniformLocation(diffuse_prog_obj, \"u_light_col_1\");\n    loc_l_col[1] = glGetUniformLocation(diffuse_prog_obj, \"u_light_col_2\");\n\n    // [...]\n}\n</code></pre>\n\n<p>The shader program can be used by <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glUseProgram.xhtml\" rel=\"nofollow noreferrer\"><code>glUseProgram</code></a>. The uniforms are set by <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glUniform.xhtml\" rel=\"nofollow noreferrer\"><code>glUniform</code>*</a>.<br>\nBeside the vertex coordinates, the normal vector attributes have to be set per vertex, to make the light calculations proper work. But it is sufficient to set a single color for the entire mesh:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void display()\n{\n    // [...]\n\n    // install program\n    glUseProgram(diffuse_prog_obj);\n\n    // set light positions and colors \n    glUniform3f(loc_l_pos[0], Light1x, Light1y, Light1z);\n    glUniform3f(loc_l_pos[1], Light2x, Light2y, Light2z);\n    glUniform3f(loc_l_col[0], Light1r, Light1g, Light1b);\n    glUniform3f(loc_l_col[1], Light2r, Light2g, Light2b);\n\n    // set object color\n    glColor3f(1, 1, 0.5);\n\n    //Draw the squares, select column  \n    for (int i = 0; i &lt;= 9; i++)\n    {\n        //Select row        \n        for (int j = 0; j &lt;= 9; j++)\n        {   \n            glBegin(GL_POLYGON); \n\n            std::cout &lt;&lt; R[i][j] &lt;&lt; \" \" &lt;&lt;  G[i][j] &lt;&lt; \" \" &lt;&lt;  B[i][j] &lt;&lt; endl;\n            glNormal3f(Nx[i][j], Ny[i][j], Nz[i][j]);\n            glVertex3f(surfaceX[i][j], surfaceY[i][j], surfaceZ[i][j]);\n\n            glNormal3f(Nx[i][j+1], Ny[i][j+1], Nz[i][j+1]);\n            glVertex3f(surfaceX[i][j+1], surfaceY[i][j+1], surfaceZ[i][j+1]);\n\n            glNormal3f(Nx[i+1][j+1], Ny[i+1][j+1], Nz[i+1][j+1]);\n            glVertex3f(surfaceX[i+1][j+1], surfaceY[i+1][j+1], surfaceZ[i+1][j+1]);\n\n            glNormal3f(Nx[i+1][j], Ny[i+1][j], Nz[i+1][j]);\n            glVertex3f(surfaceX[i+1][j], surfaceY[i+1][j], surfaceZ[i+1][j]);\n\n            glEnd();\n        }\n    }\n\n    // invalidate installed program\n    glUseProgram(0);\n\n    // [...]\n}\n</code></pre>\n\n<p>See the preview of you program, with the applied suggestions:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dgeFs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dgeFs.png\" alt=\"\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 1, "last_activity_date": 1552580305, "creation_date": 1552580305, "answer_id": 55167416, "question_id": 55149946, "link": "https://stackoverflow.com/questions/55149946/opengl-how-do-i-render-individual-rgb-values-given-a-cross-product-that-contain/55167416#55167416", "title": "OpenGL: How do I render individual RGB values given a cross product that contains the total light?", "body": "<p>A common formula to calculate a a diffuse light is to calculate the <a href=\"https://en.wikipedia.org/wiki/Dot_product\" rel=\"nofollow noreferrer\">Dot product</a> of the normal vector of the surface and the vector to from the surface to the light source. See <a href=\"https://stackoverflow.com/questions/7061745/how-does-this-faking-the-light-work-on-aerotwist/45121641#45121641\">How does this faking the light work on aerotwist?</a>.  </p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>kd = max(0, L dot N)\n</code></pre>\n\n<p>To get the color of the light, the RGB values are component wise multiplied by the diffuse coefficient:</p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>(Cr, Cg, Cb) = (LCr, LCg, LCb) * kd\n</code></pre>\n\n<p>If there are multiple light sources, then the light colors are summed:</p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>(Cr, Cg, Cb) = (LC1r, LC1g, LC1b) * max(0, L1 dot N) + (LC2r, LC2g, LC2b) * max(0, L2 dot N)\n</code></pre>\n\n<p>Note, if the surface (material) has an additional color, then ths color would have to be component wise multiplied to the final color:</p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>(Cr, Cg, Cb) = (Cr, Cg, Cb) * (CMr, CMg, CMb)\n</code></pre>\n\n<p>Write a function which calculates the light for 1 single light source and add the light to the final color:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void add_light_color(int i, int j, float lpx, float lpy, float lpz, float lcr, float lcg, float lcb)\n{\n    float Lx = lpx - surfaceX[i][j]; \n    float Ly = lpy - surfaceY[i][j];\n    float Lz = lpz - surfaceZ[i][j];\n\n    float length = sqrt(Lx * Lx + Ly * Ly + Lz * Lz);\n    if (length &lt;= 0.0)\n        return;\n\n    float kd = Lx/length * Nx[i][j] + Ly/length * Ny[i][j] + Ly/length * Ny[i][j];\n    if ( kd &lt;= 0.0 )\n    return; \n\n    R[i][j] += kd * lcr;\n    G[i][j] += kd * lcg;\n    B[i][j] += kd * lcb;\n}\n</code></pre>\n\n<p>Traverse the filed of attributes, set each color (0, 0, 0) and use the above function to add the color form each light source:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void calc_color()\n{\n    float lp1[] = {Light1x, Light1y, Light1z};\n    float lp2[] = {Light2x, Light2y, Light2z};\n    float lc1[] = {Light1r, Light1g, Light1b};\n    float lc2[] = {Light2r, Light2g, Light2b};\n\n    for (int i = 0; i &lt; 10; i++)\n    {\n        for (int j = 0; j &lt; 10; j++)\n        {\n            R[i][j] = G[i][j] = B[i][j] = 0.0;  \n\n            add_light_color(i, j, Light1x, Light1y, Light1z, Light1r, Light1g, Light1b);\n            add_light_color(i, j, Light2x, Light2y, Light2z, Light2r, Light2g, Light2b);\n        }\n    }\n}\n</code></pre>\n\n<p>The result for the following light color settings:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>float Light1r = 1;\nfloat Light1g = 0;\nfloat Light1b = 0;\n\nfloat Light2r = 0;\nfloat Light2g = 1;\nfloat Light2b = 0;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/PSV6n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PSV6n.png\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 99, "user_id": 7418868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f16fdacc8452bb21bc945f99d2eb510?s=128&d=identicon&r=PG&f=1", "display_name": "Razmode", "link": "https://stackoverflow.com/users/7418868/razmode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "accepted_answer_id": 55167416, "answer_count": 2, "score": 1, "last_activity_date": 1553463057, "creation_date": 1552505683, "last_edit_date": 1553463057, "question_id": 55149946, "link": "https://stackoverflow.com/questions/55149946/opengl-how-do-i-render-individual-rgb-values-given-a-cross-product-that-contain", "title": "OpenGL: How do I render individual RGB values given a cross product that contains the total light?", "body": "<p>I've been working on my own implementation of a Gouraud style shading model, and I've got the rest of it working pretty much how I want it, but the problem I've run into is it only shows white light. The calc_color function is where this operation is being performed. The Color variable represents the <strong><em>total</em></strong> light of the R, G and B values for that given location. I've been assigning Color to all three arrays just to get the shading implemented properly, but now that that is complete, I'd like to figure out a way to extract the R, G and B values from that total light value.</p>\n\n<p>I've tried several different things, like taking the total light, and taking a percentage of the Light1r, etc. values but it always ends up looking strange or too bright.</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;iostream&gt;\n#ifdef MAC\n#include &lt;GLUT/glut.h&gt;\n#else\n#include &lt;GL/glut.h&gt;\n#endif\n\nusing namespace std;\n\n//Camera variables\nint xangle = -270;\nint yangle = 0;\n\n//Control Modes (Rotate mode by default)\nint mode = 0;\nint lightmode = 0;\n\n//Player Position (Y offset so it would not be straddling the grid)\nfloat cubeX = 0;\nfloat cubeY = 0.5;\nfloat cubeZ = 0;\n\n//Vertex arrays for surface\nfloat surfaceX [12][12];\nfloat surfaceY [12][12];\nfloat surfaceZ [12][12];\n\n//Surface Normal arrays\nfloat Nx[11][11];\nfloat Ny[11][11];\nfloat Nz[11][11];\n\n//Color arrays\nfloat R[11][11];\nfloat G[11][11];\nfloat B[11][11];\n\n//Light position and color variables\nfloat Light1x = 0;\nfloat Light1y = 5;\nfloat Light1z = 0;\n\nfloat Light1r = 0;\nfloat Light1g = 1;\nfloat Light1b = 0;\n\nfloat Light2x = -5;\nfloat Light2y = 5;\nfloat Light2z = -5;\n\nfloat Light2r = 0;\nfloat Light2g = 1;\nfloat Light2b = 0;\n\n\n\n//Random number generator\nfloat RandomNumber(float Min, float Max)\n{\n    return ((float(rand()) / float(RAND_MAX)) * (Max - Min)) + Min;\n}\n\n//---------------------------------------\n// Initialize surface \n//---------------------------------------\nvoid init_surface()\n{\n    //Initialize X, select column  \n    for (int i = 0; i &lt; 12; i++) \n    {\n        //Select row\n        //Surface is +1 so the far right normal will be generated correctly     \n        for (int j = 0; j &lt; 12; j++)\n        {   \n            //-5 to compensate for negative coordinate values\n            surfaceX[i][j] = i-5;\n            //Generate random surface height\n            surfaceY[i][j] = RandomNumber(5, 7) - 5;\n            //surfaceY[i][j] = 0;\n            surfaceZ[i][j] = j-5;\n        }\n    }\n}\n\nvoid define_normals()\n{\n    //Define surface normals\n    for (int i = 0; i &lt; 11; i++)\n    {\n        for (int j = 0; j &lt; 11; j++)\n        {\n            //Get two tangent vectors\n            float Ix = surfaceX[i+1][j] - surfaceX[i][j];\n            float Iy = surfaceY[i+1][j] - surfaceY[i][j];\n            float Iz = surfaceZ[i+1][j] - surfaceZ[i][j];\n            float Jx = surfaceX[i][j+1] - surfaceX[i][j];\n            float Jy = surfaceY[i][j+1] - surfaceY[i][j];\n            float Jz = surfaceZ[i][j+1] - surfaceZ[i][j];\n\n            //Do cross product, inverted for upward normals\n            Nx[i][j] = - Iy * Jz + Iz * Jy;\n            Ny[i][j] = - Iz * Jx + Ix * Jz;\n            Nz[i][j] = - Ix * Jy + Iy * Jx;\n\n            //Original vectors\n            //Nx[i][j] = Iy * Jz - Iz * Jy;\n            //Ny[i][j] = Iz * Jx - Ix * Jz;\n            //Nz[i][j] = Ix * Jy - Iy * Jx;\n\n            float length = sqrt( \n                Nx[i][j] * Nx[i][j] + \n                Ny[i][j] * Ny[i][j] + \n                Nz[i][j] * Nz[i][j]);\n            if (length &gt; 0)\n            {\n                Nx[i][j] /= length;\n                Ny[j][j] /= length;\n                Nz[i][j] /= length;\n            }\n        }   \n    } \n}\n\nvoid calc_color()\n{\n    for (int i = 0; i &lt; 10; i++)\n    {           \n        for (int j = 0; j &lt; 10; j++)\n        {\n            //Calculate light vector\n            //Light position, hardcoded for now 0,1,1\n            float Lx = Light1x - surfaceX[i][j]; \n            float Ly = Light1y - surfaceY[i][j];\n            float Lz = Light1z - surfaceZ[i][j];\n\n            float length = sqrt(Lx * Lx + Ly * Ly + Lz * Lz);\n            if (length &gt; 0)\n            {\n                Lx /= length;\n                Ly /= length;\n                Lz /= length;\n                        }\n\n            //std::cout &lt;&lt; \"Lx: \" &lt;&lt; Lx &lt;&lt; std::endl;   \n            //std::cout &lt;&lt; \"Ly: \" &lt;&lt; Ly &lt;&lt; std::endl;\n            //std::cout &lt;&lt; \"Lz: \" &lt;&lt; Lz &lt;&lt; std::endl;\n\n\n\n            //Grab surface normals\n            //These are Nx,Ny,Nz due to compiler issues\n            float Na = Nx[i][j];\n            float Nb = Ny[i][j];\n            float Nc = Nz[i][j];\n\n            //std::cout &lt;&lt; \"Na: \" &lt;&lt; Na &lt;&lt; std::endl;   \n            //std::cout &lt;&lt; \"Nb: \" &lt;&lt; Nb &lt;&lt; std::endl;   \n            //std::cout &lt;&lt; \"Nc: \" &lt;&lt; Nc &lt;&lt; std::endl;\n\n            //Do cross product\n            float Color = (Na * Lx) + (Nb * Ly) + (Nc * Lz);\n            std::cout &lt;&lt; \"Color: \" &lt;&lt; Color &lt;&lt; std::endl;\n\n            //if (Color &gt; 0)\n            //{\n            //  Color = Color / 100;\n            //}\n            //Percent of light color\n            //float Ramt = (Light1r/2) / Color;\n            //float Gamt = (Light1g/2) / Color;\n            //float Bamt = (Light1b/2) / Color;\n            //R[i][j] = Ramt * Color;\n            //G[i][j] = Gamt * Color;\n            //B[i][j] = Bamt * Color;\n\n            R[i][j] = Color;\n            G[i][j] = Color;\n            B[i][j] = Color;    \n        }\n    }\n}\n\n//---------------------------------------\n// Init function for OpenGL\n//---------------------------------------\nvoid init()\n{\n    glClearColor(0.0, 0.0, 0.0, 1.0);\n    glMatrixMode(GL_PROJECTION);\n    glLoadIdentity();\n    //Viewing Window Modified\n    glOrtho(-7.0, 7.0, -7.0, 7.0, -7.0, 7.0);\n    glMatrixMode(GL_MODELVIEW);\n    glLoadIdentity();\n    //Rotates camera\n    //glRotatef(30.0, 1.0, 1.0, 1.0);\n    glEnable(GL_DEPTH_TEST);\n\n    //Project 3 code\n    init_surface();\n    define_normals();\n\n    //Shading code\n    // glShadeModel(GL_SMOOTH);\n    // glEnable(GL_NORMALIZE);\n\n    //X,Y,Z - R,G,B\n    // init_light(GL_LIGHT1, Light1x, Light1y, Light1z, Light1r, Light1g, Light1b);\n    // init_light(GL_LIGHT2, Light2x, Light2y, Light2z, Light2r, Light2g, Light2b);\n    //init_light(GL_LIGHT2, 0, 1, 0, 0.5, 0.5, 0.5);\n\n\n}\n\nvoid keyboard(unsigned char key, int x, int y)\n{\n\n///TODO: allow user to change color of light\n\n    //Controls\n    //Toggle Mode  \n    if (key == 'q')\n    {\n        if(mode == 0)\n        {       \n            mode = 1;\n            std::cout &lt;&lt; \"Switched to Light mode (\" &lt;&lt; mode &lt;&lt; \")\" &lt;&lt; std::endl;    \n        }\n        else if(mode == 1)\n        {   \n            mode = 0;\n            std::cout &lt;&lt; \"Switched to Rotate mode (\" &lt;&lt; mode &lt;&lt; \")\" &lt;&lt; std::endl;\n        }\n    }\n    //Toggle light control\n    else if (key == 'e' &amp;&amp; mode == 1)\n    {\n        if(lightmode == 0)\n        {       \n            lightmode = 1;\n            std::cout &lt;&lt; \"Switched to controlling light 2 (\" &lt;&lt; lightmode &lt;&lt; \")\" &lt;&lt; std::endl;  \n        }\n\n        else if(lightmode == 1)\n        {       \n            lightmode = 0;\n            std::cout &lt;&lt; \"Switched to controlling light 1 (\" &lt;&lt; lightmode &lt;&lt; \")\" &lt;&lt; std::endl;  \n        }\n    }\n\n    ////Rotate Camera (mode 0)\n    //Up &amp; Down\n    else if (key == 's' &amp;&amp; mode == 0)\n        xangle += 5;\n    else if (key == 'w' &amp;&amp; mode == 0)\n    xangle -= 5;\n\n    //Left &amp; Right\n    else if (key == 'a' &amp;&amp; mode == 0) \n    yangle -= 5;\n    else if (key == 'd' &amp;&amp; mode == 0) \n    yangle += 5;\n\n    ////Move Light (mode 1)\n    //Forward &amp; Back\n    else if (key == 'w' &amp;&amp; mode == 1) \n    {\n        if (lightmode == 0) \n        {       \n            Light1z = Light1z - 1;\n            //init_surface();           \n            //define_normals();         \n            //calc_color();\n            //glutPostRedisplay();\n\n        }\n        else if (lightmode == 1)\n        Light2z = Light2z - 1;\n        //init_surface();\n\n    }\n\n    else if (key == 's' &amp;&amp; mode == 1)\n    {\n        if (lightmode == 0)\n        Light1z = Light1z + 1;\n\n        else if (lightmode == 1)\n        Light2z = Light2z + 1;\n    }\n\n    //Strafe\n    else if (key == 'd' &amp;&amp; mode == 1)\n    {\n        if (lightmode == 0)\n        Light1x = Light1x + 1;\n\n        else if (lightmode == 1)\n        Light2x = Light2x + 1;  \n    }\n    else if (key == 'a' &amp;&amp; mode == 1)\n    {\n        if (lightmode == 0)     \n        Light1x = Light1x - 1;\n        else if (lightmode == 1)\n        Light2x = Light2x - 1;\n\n    }   \n\n    //Up &amp; Down (Cube offset by +0.5 in Y)\n    else if (key == 'z' &amp;&amp; mode == 1)\n    {\n        if (lightmode == 0)\n        Light1y = Light1y + 1;\n        else if (lightmode == 1)\n        Light2y = Light2y + 1;\n    }\n    else if (key == 'x' &amp;&amp; mode == 1)\n    {\n        if (lightmode == 0)\n        Light1y = Light1y - 1;\n        else if (lightmode == 1)\n        Light2y = Light2y - 1;\n    }\n\n    //Redraw objects\n    glutPostRedisplay();\n}\n\n\n//---------------------------------------\n// Display callback for OpenGL\n//---------------------------------------\nvoid display()\n{       \n        // Clear the screen\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\n    //Rotation Code\n    glMatrixMode(GL_MODELVIEW);\n    glLoadIdentity();\n    glRotatef(xangle, 1.0, 0.0, 0.0);\n    glRotatef(yangle, 0.0, 1.0, 0.0);\n\n    //Light Code\n    // init_material(Ka, Kd, Ks, 100 * Kp, 0.8, 0.6, 0.4);  \n\n    // init_light(GL_LIGHT1, Light1x, Light1y, Light1z, Light1r, Light1g, Light1b);\n        // init_light(GL_LIGHT2, Light2x, Light2y, Light2z, Light2r, Light2g, Light2b);\n\n    // glEnable(GL_LIGHTING);\n    //Color Code\n    calc_color();\n\n    //Draw the squares, select column  \n    for (int i = 0; i &lt;= 9; i++)\n    {\n        //Select row        \n        for (int j = 0; j &lt;= 9; j++)\n        {   \n            glBegin(GL_POLYGON); \n\n            //Surface starts at top left\n            //Counter clockwise\n\n            glColor3f(R[i][j], G[i][j], B[i][j]);\n            std::cout &lt;&lt; R[i][j] &lt;&lt; \" \" &lt;&lt;  G[i][j] &lt;&lt; \" \" &lt;&lt;  B[i][j] &lt;&lt; endl;\n            // glNormal3f(Nx[i][j], Ny[i][j], Nz[i][j]);\n            glVertex3f(surfaceX[i][j], surfaceY[i][j], surfaceZ[i][j]);\n\n            glColor3f(R[i][j+1], G[i][j+1], B[i][j+1]);\n            // glNormal3f(Nx[i][j+1], Ny[i][j+1], Nz[i][j+1]);\n            glVertex3f(surfaceX[i][j+1], surfaceY[i][j+1], surfaceZ[i][j+1]);\n\n            glColor3f(R[i+1][j+1], G[i+1][j+1], B[i+1][j+1]);\n            // glNormal3f(Nx[i+1][j+1], Ny[i+1][j+1], Nz[i+1][j+1]);\n            glVertex3f(surfaceX[i+1][j+1], surfaceY[i+1][j+1], surfaceZ[i+1][j+1]);\n\n            glColor3f(R[i+1][j], G[i+1][j], B[i+1][j]);\n            // glNormal3f(Nx[i+1][j], Ny[i+1][j], Nz[i+1][j]);\n            glVertex3f(surfaceX[i+1][j], surfaceY[i+1][j], surfaceZ[i+1][j]);\n\n            glEnd();\n        }\n    }\n\n    // glDisable(GL_LIGHTING);\n    //Draw the normals\n    for (int i = 0; i &lt;= 10; i++)\n    {\n        for (int j = 0; j &lt;= 10; j++)\n        {\n\n            glBegin(GL_LINES);\n            glColor3f(0.0, 1.0, 1.0);\n            float length = 1;\n            glVertex3f(surfaceX[i][j], surfaceY[i][j], surfaceZ[i][j]);\n                glVertex3f(surfaceX[i][j]+length*Nx[i][j], \n                surfaceY[i][j]+length*Ny[i][j], \n                surfaceZ[i][j]+length*Nz[i][j]);\n            glEnd();\n        }\n    }\n\n    //Marking location of lights\n    glPointSize(10);\n    glBegin(GL_POINTS);\n    glColor3f(Light1r, Light1g, Light1b);\n    glVertex3f(Light1x, Light1y, Light1z);      \n    glEnd();\n\n    glPointSize(10);\n    glBegin(GL_POINTS);\n    glColor3f(Light2r, Light2g, Light2b);\n    glVertex3f(Light2x, Light2y, Light2z);      \n    glEnd();\n\n    //+Z = Moving TOWARD camera in opengl\n    //Origin point for reference\n    glPointSize(10);\n    glColor3f(1.0, 1.0, 0.0);\n    glBegin(GL_POINTS);\n    glVertex3f(0, 0, 0);        \n    glEnd();\n\n    //Assign Color of Lines\n    float R = 1;\n    float G = 1;\n    float B = 1;\n    glBegin(GL_LINES);\n    glColor3f(R, G, B);\n\n    ////Drawing the grid\n    //Vertical lines\n    for (int i = 0; i &lt; 11; i++)\n    {\n        int b = -5 + i;\n\n        glVertex3f(b, 0, -5);\n        glVertex3f(b, 0, 5);\n    }\n\n    //Horizontal lines\n    for (int i = 0; i &lt; 11; i++)\n    {\n        int b = -5 + i;\n        glVertex3f(-5,0,b);\n        glVertex3f(5,0,b);\n\n    }\n\n    glEnd();\n    glFlush();  \n}\n\n//---------------------------------------\n// Main program\n//---------------------------------------\nint main(int argc, char *argv[])\n{\n    srand(time(NULL));\n\n    //Print Instructions\n    std::cout &lt;&lt; \"Project 3 Controls: \" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"q switches control mode\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"w,a,s,d for camera rotation\" &lt;&lt; std::endl;\n\n\n    //Required\n    glutInit(&amp;argc, argv);\n    //Window will default to a different size without\n    glutInitWindowSize(500, 500);\n    //Window will default to a different position without\n    glutInitWindowPosition(250, 250);\n    //\n    glutInitDisplayMode(GLUT_RGB | GLUT_SINGLE | GLUT_DEPTH);\n    //Required\n    glutCreateWindow(\"Project 3\");\n    //Required, calls display function\n    glutDisplayFunc(display);\n    glutKeyboardFunc(keyboard);\n\n    //Required\n    init();\n    glutMainLoop();\n\n\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "g++", "grpc", "sgx"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552504610, "post_id": 55149611, "comment_id": 97039690, "body": "If the OS only supports single threaded applications, how does the application manage to create multiple threads? That seems like <i>quite</i> a trick. One might almost think that the OS supports multiple threads, since it lets the application create them... Something in your question doesn&#39;t add up."}, {"owner": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552505290, "post_id": 55149611, "comment_id": 97039971, "body": "The executable is compiled with <code>-pie</code> flag from my host machine, and I am trying to make the executable running inside OS running in a container. My host machine is running ubuntu which the program does not cause any problem. But it will crash when running in the container."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552505406, "post_id": 55149611, "comment_id": 97040029, "body": "How is <code>-pie</code> relevant? That has <i>nothing</i> to do with the number of threads. That only affects your address space layout and whether your application is dynamically relocatable or not."}, {"owner": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552505644, "post_id": 55149611, "comment_id": 97040148, "body": "I know. My point is that the reason of why app create multi threads inside that os is because I initially compiled it in my host machine."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552505754, "post_id": 55149611, "comment_id": 97040212, "body": "how is where it is compiled relevant? It either creates multiple threads or it does not. Where/how it was compiled does not influence that."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552505906, "post_id": 55149611, "comment_id": 97040291, "body": "@JesperJuhl The test case presented above is run in one environment. OP is concerned that there will be problems when it&#39;s deployed on another target environment that doesn&#39;t allow new threads to be created."}, {"owner": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "edited": false, "score": 0, "creation_date": 1552506044, "post_id": 55149611, "comment_id": 97040351, "body": "From my understanding, creating threads makes the program out of the sgx enclave(environment from the link in question), which caused the problem. And that&#39;s why I want to prevent the executable creating threads."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552506124, "post_id": 55149611, "comment_id": 97040400, "body": "@Fran&#231;oisAndrieux then OP should make his software <i>not</i> create multiple threads. What more is there to say?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552506137, "post_id": 55149611, "comment_id": 97040411, "body": "@J.Z I&#39;m not an expert on gRPC but RPCs in general usually imply asynchronous execution which is usually implemented by starting unique threads or using a thread pool. My impression is that, unless the framework was specifically designed to work around this problem, it likely relies strongly on the availability of threads."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552506171, "post_id": 55149611, "comment_id": 97040425, "body": "@JesperJuhl OP is using a third party library and is asking how to make it do precisely what you are suggesting."}, {"owner": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552506680, "post_id": 55149611, "comment_id": 97040636, "body": "@Fran&#231;ois Andrieux Thanks for the explanation. Comparing to the rpc server, I feel the blocking due to the single thread for rpc client is acceptable in my case and seems to be the only solution for this os. But I&#39;m not sure if there is a way to do that using gPRC cpp. Anyways, thank you for the help."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552506776, "post_id": 55149611, "comment_id": 97040687, "body": "@J.Z It may be worth it to investigate whether gRPC is directly requesting threads or if some underlying platform-specific dependency is doing it. If it&#39;s the latter, it might just work out of the box for you. Try using a debugger to investigate the entry point for those threads."}], "owner": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1552589158, "creation_date": 1552504370, "last_edit_date": 1552589158, "question_id": 55149611, "link": "https://stackoverflow.com/questions/55149611/how-to-force-grpc-cpp-program-using-single-thread-only", "title": "How to force gRPC cpp program using single thread only", "body": "<p>I need to run my client application (written in c++ with gRPC) in an operating system (which only support single thread).\nHowever, I noticed that <code>grpc::InsecureChannelCredentials();</code> is trying to create multiple threads. Here is the output from debugger after calling that gRPC function in my host machine:</p>\n\n<pre><code>[New Thread 0x7ffff524a700 (LWP 3709)]\n[New Thread 0x7ffff524a700 (LWP 3710)]\n[New Thread 0x7ffff524a700 (LWP 3711)]\n</code></pre>\n\n<p>This will cause the program crash inside the single thread OS.</p>\n\n<p>My question is: is there a way to configure gPRC using only single thread, or make cpp executable run only with single thread? Thanks in advance.</p>\n\n<p>btw, here is the link to the os mentioned above and the issue explains why it only support single thread.\n<a href=\"https://github.com/lsds/sgx-lkl/issues/1\" rel=\"nofollow noreferrer\">https://github.com/lsds/sgx-lkl/issues/1</a></p>\n\n<p><strong>EDIT:</strong>\nIt's actually not allowing multi-process instead of multi-thread applicaiton. gRPC seems like doing fork inside its core lib. I'm wondering if there is a way to configure gRPC to disable process forking.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1552505649, "post_id": 55149582, "comment_id": 97040152, "body": "Side note: Should friends get implemented in the class? I thought the point of them was that they get implemented outside the class, but have access to the private members."}, {"owner": {"reputation": 51, "user_id": 8922321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e7725e5917f180321dd62fa794de14?s=128&d=identicon&r=PG&f=1", "display_name": "Jack W", "link": "https://stackoverflow.com/users/8922321/jack-w"}, "edited": false, "score": 0, "creation_date": 1552505722, "post_id": 55149582, "comment_id": 97040201, "body": "Yes, I do that in the actual program I&#39;m working on. I just thought it would be quicker and simpler to do it this way for the purpose of this question"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1552505764, "post_id": 55149582, "comment_id": 97040217, "body": "Oh Got you. Thanks for doing that, btw."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1552505813, "post_id": 55149582, "comment_id": 97040245, "body": "Your code looks okay to me. Maybe someone with more experience can find the problem."}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 2, "creation_date": 1552505814, "post_id": 55149582, "comment_id": 97040246, "body": "Have you tried, instead of just outputting a bunch of asterisks, outputting the actual values you&#39;re getting? Which I guess should be done in the operator before you try <code>stoi</code>."}, {"owner": {"reputation": 51, "user_id": 8922321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e7725e5917f180321dd62fa794de14?s=128&d=identicon&r=PG&f=1", "display_name": "Jack W", "link": "https://stackoverflow.com/users/8922321/jack-w"}, "edited": false, "score": 0, "creation_date": 1552506326, "post_id": 55149582, "comment_id": 97040492, "body": "OK, I just put <code>cout &lt;&lt; &quot;\\nstring tempID is: &quot; &lt;&lt; tempID &lt;&lt; &quot;\\nconverted to int: &quot; &lt;&lt; stoi(tempID);</code> right after <code>getline(lineIn, tempID);</code> It outputs everything correctly, for example <code>string tempID is: 43</code>. But right at the end it outputs <code>string tempID is:</code> with nothing afterwards, then the next line has the same error before it can output <code>converted to int</code>. So I know it&#39;s reading an empty value and trying to convert it. But the problem I&#39;m having  is that it doesn&#39;t stop reading before it gets there."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8922321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e7725e5917f180321dd62fa794de14?s=128&d=identicon&r=PG&f=1", "display_name": "Jack W", "link": "https://stackoverflow.com/users/8922321/jack-w"}, "edited": false, "score": 0, "creation_date": 1552507888, "post_id": 55150046, "comment_id": 97041199, "body": "I&#39;m going to implement that security check you mentioned. Can always improve my code"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 4, "last_activity_date": 1552506453, "last_edit_date": 1552506453, "creation_date": 1552506106, "answer_id": 55150046, "question_id": 55149582, "link": "https://stackoverflow.com/questions/55149582/c-creating-objects-by-reading-from-a-file-but-the-instream-isnt-stopping-a/55150046#55150046", "title": "C++ - Creating objects by reading from a file, but the instream isn&#39;t stopping at the end of the file. `std::invalid_argument what() stoi`", "body": "<p>The problem is that you aren't checking for errors in your overloaded <code>operator&gt;&gt;</code>. So the getlines are failing but you are still trying to set the values in your contact. Try this instead</p>\n\n<pre><code>  friend istream&amp; operator&gt;&gt;(istream&amp; lineIn, Contact&amp; newContact) {\n      string tempName, tempID, emptyLine;\n      if (getline(lineIn, tempID) &amp;&amp; getline(lineIn, tempName) &amp;&amp; getline(lineIn, emptyLine)) {\n          newContact.setID(stoi(tempID));\n          newContact.setName(tempName);\n      }\n      return lineIn;\n  }\n</code></pre>\n\n<p>I suppose the empty line at the end isn't vital. In which case you could move the last getline out of the if statement.</p>\n\n<p>For extra security you should check that <code>tempID</code> is in the form of an integer, and set the failbit on the stream if it is not.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 8922321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e7725e5917f180321dd62fa794de14?s=128&d=identicon&r=PG&f=1", "display_name": "Jack W", "link": "https://stackoverflow.com/users/8922321/jack-w"}, "edited": false, "score": 0, "creation_date": 1552507820, "post_id": 55150085, "comment_id": 97041159, "body": "Not sure why, but John&#39;s way didn&#39;t work for me. It kept on reading. But yours did work. I&#39;m not sure why yours did but his didn&#39;t, because comparing your two answers seems to test the same thing in the if statement. Regardless, it worked. Thank-you!"}], "tags": [], "owner": {"reputation": 3615, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": true, "score": 2, "last_activity_date": 1552506294, "creation_date": 1552506294, "answer_id": 55150085, "question_id": 55149582, "link": "https://stackoverflow.com/questions/55149582/c-creating-objects-by-reading-from-a-file-but-the-instream-isnt-stopping-a/55150085#55150085", "title": "C++ - Creating objects by reading from a file, but the instream isn&#39;t stopping at the end of the file. `std::invalid_argument what() stoi`", "body": "<p>Well your problem is in <code>operator&gt;&gt;</code> implementation. If <code>getline()</code> does not read the line, it does nothing, thus your loop will continue on with running. So what you can do is:</p>\n\n<pre><code>if(!getline(lineIn, tempID))\n    return lineIn;\n</code></pre>\n\n<p>and do it every time you call <code>getline()</code>.</p>\n\n<pre><code>friend istream&amp; operator&gt;&gt;(istream&amp; lineIn, Contact&amp; newContact) {\n    string tempName;\n    string tempID;\n    string emptyLine;\n    if(!getline(lineIn, tempID)) return lineIn;\n    newContact.setID(stoi(tempID));\n    if(getline(lineIn, tempName)) return lineIn;\n    newContact.setName(tempName);\n    if(getline(lineIn, emptyLine)) return lineIn;\n    return lineIn;\n}\n</code></pre>\n\n<p>EDIT: @Johns way of dealing with this is better, but I hope from my answer you can see clearly what you need to do with your code to make it work.</p>\n"}], "owner": {"reputation": 51, "user_id": 8922321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e7725e5917f180321dd62fa794de14?s=128&d=identicon&r=PG&f=1", "display_name": "Jack W", "link": "https://stackoverflow.com/users/8922321/jack-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55150085, "answer_count": 2, "score": -1, "last_activity_date": 1552506453, "creation_date": 1552504240, "last_edit_date": 1552505177, "question_id": 55149582, "link": "https://stackoverflow.com/questions/55149582/c-creating-objects-by-reading-from-a-file-but-the-instream-isnt-stopping-a", "title": "C++ - Creating objects by reading from a file, but the instream isn&#39;t stopping at the end of the file. `std::invalid_argument what() stoi`", "body": "<p>So, the following is just a tiny example of a problem I'm having with a much larger program.</p>\n\n<p>By making it output ****, I was able to figure out that after it reaches what should be the end of the file, the while loop keeps going on. I can't get it to stop at the end of file. </p>\n\n<p>Here is an example of what the .data file contains</p>\n\n<pre><code>/***\n56\nJohn\n\n43\nLisa\n\n91\nJim\n\n***/\n</code></pre>\n\n<p>And here is the code</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;iostream&gt;\n#include &lt;ostream&gt;\n#include &lt;fstream&gt;\nusing namespace std;\n\nclass Contact {\npublic:\n  int ID;\n  string name;\n  void setID(int newID) {\n    ID = newID;\n  }\n  void setName(string newName) {\n    name = newName;\n  }\n  friend istream&amp; operator&gt;&gt;(istream&amp; lineIn, Contact&amp; newContact) {\n    string tempName;\n    string tempID;\n    string emptyLine;\n    getline(lineIn, tempID);\n    newContact.setID(stoi(tempID));\n    getline(lineIn, tempName);\n    newContact.setName(tempName);\n    getline(lineIn, emptyLine);\n    return lineIn;\n  }\n};\n\nconst string CONTACT_FILE = \"contacts.data\";\nstd::map&lt;int,Contact&gt; ContactsMap;\n\nint main() {\n  ifstream fin( CONTACT_FILE );\n  if (fin) {\n    Contact c;\n    while ( fin &gt;&gt; c  ) {\n      std::cout &lt;&lt; \"\\n********\";\n      ContactsMap[c.ID] = c;\n    }\n    fin.close();\n  }\n  cout &lt;&lt; \"\\nContactsMap.at(56).name\";\n\n}\n</code></pre>\n"}, {"tags": ["c++", "function", "loops", "infinite-loop"], "comments": [{"owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "edited": false, "score": 0, "creation_date": 1552504254, "post_id": 55149526, "comment_id": 97039523, "body": "Aside from the questionable use of recursion instead of simple iteration, I note that the value of ModuleIndex never changes once GetMark is called. So if it&#39;s out of range, you simple recurse again and again infinitely with that same out-of-range value."}, {"owner": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "reply_to_user": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "edited": false, "score": 0, "creation_date": 1552504402, "post_id": 55149526, "comment_id": 97039601, "body": "@L.ScottJohnson it does change, if it&#39;s out of range it prompts the user for new input value everytime"}, {"owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "edited": false, "score": 0, "creation_date": 1552504436, "post_id": 55149526, "comment_id": 97039617, "body": "it prompts, yes. But it doesn&#39;t read the user&#39;s response to the prompt."}, {"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 0, "creation_date": 1552505301, "post_id": 55149526, "comment_id": 97039978, "body": "The code can be optimized through changing it radically. Why this e.g `\t\t\tcin &gt;&gt; marks[i]; \t\t\tGetMark(marks[i])`?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1552505570, "post_id": 55149526, "comment_id": 97040117, "body": "If called, <code>GetMark()</code> does not read any value, and calls itself recursively with the value passed to it.    That results in infinite recursion.   The code after the recursive call of <code>GetMark()</code> is never reached."}], "answers": [{"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1552504488, "post_id": 55149607, "comment_id": 97039635, "body": "+1. But the function <b>does</b> return the value. The problem is that the value returned by the (ghastly) recursive call isn&#39;t used, so the updated value is thrown away."}, {"owner": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552504866, "post_id": 55149607, "comment_id": 97039811, "body": "So what would you suggest? Because i can&#39;t really think of a better way to declare this function without the recursion...."}, {"owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "edited": false, "score": 0, "creation_date": 1552505679, "post_id": 55149607, "comment_id": 97040173, "body": "I&#39;d suggest Iteration. while(ModuleIndex &lt; 0 || ModuleIndex &gt; 100) { read new ModuleIndex }"}], "tags": [], "owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1552504353, "creation_date": 1552504353, "answer_id": 55149607, "question_id": 55149526, "link": "https://stackoverflow.com/questions/55149526/my-function-skips-a-loop-parameter-in-c/55149607#55149607", "title": "My function skips a loop parameter in c++", "body": "<p>You need to allow the user to specify a new value of marks[i] / ModuleIndex within GetMarks. After clearing cin, read a new value from cin. You also need to return that value so that main's marks[i] can be updated with that value instead of the original out-of-range value.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552505043, "post_id": 55149724, "comment_id": 97039865, "body": "Thank you, with the addition of cin.ignore() and cin.clear() to enhance error handling, this works perfectly :)"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552505277, "post_id": 55149724, "comment_id": 97039964, "body": "@Sami -- yes, I left out the bells and whistles to make the logic clear."}], "tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": true, "score": 3, "last_activity_date": 1552504826, "creation_date": 1552504826, "answer_id": 55149724, "question_id": 55149526, "link": "https://stackoverflow.com/questions/55149526/my-function-skips-a-loop-parameter-in-c/55149724#55149724", "title": "My function skips a loop parameter in c++", "body": "<p>That function is overly complicated for what it does. Just loop while the value is bad, and prompt for a new value:</p>\n\n<pre><code>int GetMark(int ModuleIndex) {\n    while (ModuleIndex &lt; 0 || ModuleIndex &gt; 100) {\n        std::cout &lt;&lt; \"Invalid value.\\n\"\n        std::cin &gt;&gt; ModuleIndex;\n    }\n    return ModuleIndex;\n}\n</code></pre>\n\n<p>Recursion is very handy in theoretical analysis, but in practice it's almost always a mistake.</p>\n"}, {"tags": [], "owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "is_accepted": false, "score": 1, "last_activity_date": 1552506919, "last_edit_date": 1552506919, "creation_date": 1552504986, "answer_id": 55149765, "question_id": 55149526, "link": "https://stackoverflow.com/questions/55149526/my-function-skips-a-loop-parameter-in-c/55149765#55149765", "title": "My function skips a loop parameter in c++", "body": "<p>It is apparently in you <code>getMark</code>, inside the <code>while</code> loop you are calling <code>getMark</code> recursively with the same invalid <code>ModuleIndex</code> value. So you need to get it from the standard input before recursion. e.g:</p>\n\n<pre><code>int GetMark(int ModuleIndex){\n    bool help;\n    if (ModuleIndex &lt; 0 || ModuleIndex &gt; 100){\n        help = false;\n        while (help != true){\n                cout &lt;&lt; \"enter new ModuleIndex: \\n\";\n                cin &gt;&gt; ModuleIndex;\n                GetMark(ModuleIndex);\n                // ...\n        }\n\n        return ModuleIndex;\n    }\n</code></pre>\n\n<p>Your code is unreadable, in addition you can use class <code>std::vector</code>.</p>\n\n<p>I propose to test this code:</p>\n\n<pre><code>int GetMarkIndex(const std::vector&lt;double&gt;&amp; vMarks, const double Search) {\n    auto beg{ vMarks.begin() }, end{ vMarks.end() };\n    while (beg != end &amp;&amp; *beg != Search)\n        ++beg;\n    return beg != end ? beg - vMarks.begin() : -1;\n}\n\nint main() {\n\n    std::vector&lt;double&gt; marks(5);\n    int value;\n\n    auto i{ 0U };\n    auto sz{ marks.size() };\n    while (i != sz) {\n        std::cout &lt;&lt; \"Enter marks 1--&gt;100\" &lt;&lt; std::endl;\n        if (cin &gt;&gt; value &amp;&amp; value &gt; 0 &amp;&amp; value &lt; 101) {\n            marks[i] = value;\n            ++i;\n        }\n        else\n            std::cout &lt;&lt; \"Invalid input!\" &lt;&lt; std::endl;\n    }\n\n    for (auto e : marks)\n        cout &lt;&lt; e &lt;&lt; \", \";\n    std::cout &lt;&lt; std::endl;\n\n    double Search = 15;\n    auto index{GetMarkIndex(marks, Search)};\n\n    (index != -1) ? (std::cout &lt;&lt; Search &lt;&lt; \" Found at index: \" &lt;&lt; index) : (std::cout &lt;&lt; Search &lt;&lt; \" Not found!\" &lt;&lt; std::endl);\n\n\n    std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552508451, "post_id": 55149826, "comment_id": 97041475, "body": "this still reads negative values and characters so it&#39;s not any good really"}], "tags": [], "owner": {"reputation": 62, "user_id": 4866684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6b8af3cce6f1d778cec7bed9ae3c10f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Ebert", "link": "https://stackoverflow.com/users/4866684/andrew-ebert"}, "is_accepted": false, "score": 1, "last_activity_date": 1552505200, "creation_date": 1552505200, "answer_id": 55149826, "question_id": 55149526, "link": "https://stackoverflow.com/questions/55149526/my-function-skips-a-loop-parameter-in-c/55149826#55149826", "title": "My function skips a loop parameter in c++", "body": "<p>Basically what you need to do is remove the recursion from this method and just rely on the while loop.  Instead of recalling the function you need to prompt for input again with the failed input and then test the value again to escape the loop.</p>\n\n<pre><code>int GetMark(int ModuleIndex) //user input function\n{\n    bool help;\n    if (ModuleIndex &lt; 0 || ModuleIndex &gt;100)\n    {\n        help = false;\n        while (help != true)\n        {\n            cin.clear();\n            cin.ignore(numeric_limits&lt;streamsize&gt;::max(), '\\n');\n            cout &lt;&lt; \"hey, that's a invalid value, try again!\" &lt;&lt; endl;\n            cout &lt;&lt; \"enter mark (0 - 100): \" &lt;&lt; endl;\n            cin &gt;&gt; ModuleIndex;\n            if ((ModuleIndex &gt; 0) &amp;&amp;( ModuleIndex &lt; 101))\n            {\n                help = true;\n            }\n    }\n}\n    return ModuleIndex;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552507148, "post_id": 55150144, "comment_id": 97040866, "body": "Thanks, but how should i make the function to not take strings at this point?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552507241, "post_id": 55150144, "comment_id": 97040913, "body": "@Sami, you&#39;ll have to use your strategy of <code>cin.clear()</code> and <code>cin.ignore()</code> but then you&#39;ll have to update the <code>while</code> loop a bit."}, {"owner": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552508651, "post_id": 55150144, "comment_id": 97041567, "body": "it does not work... when i implement cin.clear() and cin.ignore() strings still pass through and so do negative integers for 1 loop, only after that does the function prompt for different input, and records the nearest correct input but into the next loop"}, {"owner": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552510224, "post_id": 55150144, "comment_id": 97042245, "body": "yeah well, the problem i have is that the code takes bad input as answer, so for me, it is placed into the array instead of being deleted and replaced by a valid value, and that makes the point of my array, which is calculating a average and so on, pointless since the invalid input messes up all the calculations"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "edited": false, "score": 0, "creation_date": 1552510525, "post_id": 55150144, "comment_id": 97042414, "body": "@Sami, with the updated <code>GetMark</code> function, you should never get an invalid value in <code>marks</code>."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1552509514, "last_edit_date": 1552509514, "creation_date": 1552506546, "answer_id": 55150144, "question_id": 55149526, "link": "https://stackoverflow.com/questions/55149526/my-function-skips-a-loop-parameter-in-c/55150144#55150144", "title": "My function skips a loop parameter in c++", "body": "<p>The combination of the way you have defined <code>GetMark</code> and the way you use it is flawed.</p>\n\n<p>No matter what you do in <code>GetMark</code>, the value entered in <code>main</code> does not change.</p>\n\n<p>Change <code>GetMark</code> to:</p>\n\n<pre><code>int GetMark()\n{\n   std::cout &lt;&lt; \"enter mark (0 - 100): \" &lt;&lt; std::endl;\n   int mark;\n   while ( std::cin &gt;&gt; mark )\n   {\n      if (  mark &gt;= 0 &amp;&amp; mark &lt;= 100)\n      {\n         return mark;\n      }\n\n      std::cout &lt;&lt; \"Invalid value \" &lt;&lt; mark &lt;&lt; std::endl;\n      std::cout &lt;&lt; \"enter mark (0 - 100): \" &lt;&lt; std::endl;\n   }\n\n   // Unable to read.\n   // Throw exception, or exit with an error message.\n}\n</code></pre>\n\n<p>and change its usage. Instead of</p>\n\n<pre><code>cout &lt;&lt; \"enter mark (0 - 100): \" &lt;&lt; endl;\ncin &gt;&gt; marks[i];\nGetMark(marks[i]);\n</code></pre>\n\n<p>use </p>\n\n<pre><code>marks[i] = GetMark();\n</code></pre>\n\n<hr>\n\n<p>A working version of <code>GetMark</code>:</p>\n\n<pre><code>int GetMark()\n{\n   std::cout &lt;&lt; \"enter mark (0 - 100): \" &lt;&lt; std::endl;\n\n   std::string line;\n   while ( getline(std::cin, line) )\n   {\n      std::istringstream str(line);\n      int mark;\n      if ( str &gt;&gt; mark )\n      {\n         if (  mark &gt;= 0 &amp;&amp; mark &lt;= 100)\n         {\n            return mark;\n         }\n      }\n      std::cout &lt;&lt; \"Invalid input: \" &lt;&lt; line &lt;&lt; std::endl;\n      std::cout &lt;&lt; \"enter mark (0 - 100): \" &lt;&lt; std::endl;\n   }\n\n   // Unable to read.\n   // Throw exception, or exit with an error message.\n   return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/99Kdld\" rel=\"nofollow noreferrer\">Live Demo</a>.</p>\n"}], "owner": {"reputation": 63, "user_id": 10521064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hUw3.jpg?s=128&g=1", "display_name": "Average JS enjoyer", "link": "https://stackoverflow.com/users/10521064/average-js-enjoyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55149724, "answer_count": 5, "score": 1, "last_activity_date": 1554409519, "creation_date": 1552504029, "last_edit_date": 1554409519, "question_id": 55149526, "link": "https://stackoverflow.com/questions/55149526/my-function-skips-a-loop-parameter-in-c", "title": "My function skips a loop parameter in c++", "body": "<p>My GetMark() function, which is supposed to check for correct range and afterwards return the value, if correct to the given array gets stuck in a infinite loop when a parameter is given outside of the accepted range, before i added the SearchMark() function it worked correctly and looped only until the user finally entered a value in the given range (0 - 100) but now after the first out of range value is given it loops no matter what is entered, I will be thankful for any suggestions. full code: </p>\n\n<pre><code>int GetMark(int ModuleIndex) //user input function\n{\n    bool help;\n    if (ModuleIndex &lt; 0 || ModuleIndex &gt;100)\n    {\n        help = false;\n        while (help != true)\n        {\n            cin.clear();\n            cin.ignore(numeric_limits&lt;streamsize&gt;::max(), '\\n');\n            cout &lt;&lt; \"hey, that's a invalid value, try again!\" &lt;&lt; endl;\n            GetMark(ModuleIndex);\n            if ((ModuleIndex &gt; 0) &amp;&amp;( ModuleIndex &lt; 101))\n            {\n                help = true;\n            }\n        }\n    }\n\n    return ModuleIndex;\n}\n\nint SearchMark(int A[], int a) //search grades array for numbers of specific grades\n{\n    int i = 0;\n    int ii = 0;\n\n    while (i &lt; 12)\n    {\n        if (A[i] == a)\n            ii++;\n        i++;\n    }\n    cout &lt;&lt; \"Mark \" &lt;&lt; a &lt;&lt; \" was found: \" &lt;&lt; ii &lt;&lt; \" times\" &lt;&lt; endl;\n    return 0;\n}\n\n\n\nint main()\n{\n    int marks[12]; \n    int i = 0;\n    int sum = 0;\n    int grades[12];\n\n    while (i &lt; 12)\n    {\n        cout &lt;&lt; \"enter mark (0 - 100): \" &lt;&lt; endl;\n        cin &gt;&gt; marks[i];\n        GetMark(marks[i]);\n        sum = sum + marks[i];\n        if (marks[i] &gt; 69)\n        {\n            grades[i] = 1;\n        }\n        else if (marks[i] &gt; 59 &amp;&amp; marks[i] &lt; 70)\n        {\n            grades[i] = 2;\n        }\n        else if (marks[i] &gt; 49 &amp;&amp; marks[i] &lt; 60)\n        {\n            grades[i] = 22;\n        }\n        else if (marks[i] &gt; 39 &amp;&amp; marks[i &lt; 50])\n        {\n            grades[i] = 3;\n        }\n        else if (marks[i] &lt; 35)\n        {\n            grades[i] = 4;\n        }\n        i++;\n    }\n    sum = sum / 12;\n    cout &lt;&lt; \"your average is: \" &lt;&lt; sum  &lt;&lt; endl;\n\n\n\n\n    if (sum &gt; 69)\n    {\n        cout &lt;&lt; \"You passed with 1st!\" &lt;&lt; endl;\n    }\n    else if ((sum &gt; 59) &amp;&amp; (sum &lt; 70))\n    {\n        cout &lt;&lt; \"You passed with 2i!\" &lt;&lt; endl;\n    }\n    else if ((sum &gt; 49) &amp;&amp; (sum &lt; 60))\n    {\n        cout &lt;&lt; \"You passed with 2ii!\" &lt;&lt; endl;\n    }\n    else if ((sum &gt; 39) &amp;&amp; (sum &lt; 50))\n    {\n        cout &lt;&lt; \"You passed with 3rd!\" &lt;&lt; endl;\n    }\n    else if (sum &lt; 40)\n    {\n        cout &lt;&lt; \"Your average is too low! You failed.\" &lt;&lt; endl;\n    }\n\n\n    i = 0;\n    while (i &lt; 12)\n    {\n        if (marks[i] &lt; 35)\n        {\n            cout &lt;&lt; \"Referred in module \" &lt;&lt; i + 1 &lt;&lt; \" mark too low.\" &lt;&lt; endl;\n        }\n        i++;\n    }\n\n    SearchMark(grades, 1);\n    SearchMark(grades, 2);\n    SearchMark(grades, 22);\n    SearchMark(grades, 3);\n    SearchMark(grades, 4);\n\n    return 0;\n}`\n</code></pre>\n"}, {"tags": ["c++", "c++17", "xcode10"], "comments": [{"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1552503603, "post_id": 55149369, "comment_id": 97039206, "body": "Well, for one thing the f.open() is missing a semicolon"}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 2, "creation_date": 1552503617, "post_id": 55149369, "comment_id": 97039219, "body": "<code>open</code> takes 2 parameters, you are passing 3, I guess you wanted to pass  <code>ios::app | ios::binary</code> instead of <code>ios::app,ios::binary</code>  as second param. Read about serialization methods, you cannot store <code>string</code> object into binary file by <code>write()</code>."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552503747, "post_id": 55149369, "comment_id": 97039286, "body": "&quot;but it says this error &quot; - which has <i>what</i> to do with a <code>.dat</code> file? What <i>is</i> a <code>.dat</code> file? The file extension means <i>nothing</i>. You can store a GIF image in a file named <code>.doc</code> if you want to. What is your <i>real</i> question?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1552503856, "post_id": 55149369, "comment_id": 97039329, "body": "Also note that when you have succeeded in compiling and running this program and next try to read from the file to restore your object, nasal demons will come and bite you."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552507532, "post_id": 55149369, "comment_id": 97041027, "body": "if you are lucky you just get the <code>phonenumber</code> of a nasal demon. In that case, dont call it :P"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552507957, "post_id": 55149369, "comment_id": 97041241, "body": "@user463035818 :-)"}], "answers": [{"tags": [], "owner": {"reputation": 2939, "user_id": 2367231, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/CeSBA.png?s=128&g=1", "display_name": "Alex44", "link": "https://stackoverflow.com/users/2367231/alex44"}, "is_accepted": false, "score": 1, "last_activity_date": 1552507506, "last_edit_date": 1552507506, "creation_date": 1552503639, "answer_id": 55149435, "question_id": 55149369, "link": "https://stackoverflow.com/questions/55149369/problems-while-opening-a-dat-file-in-c/55149435#55149435", "title": "Problems while opening a .dat file in c++", "body": "<p>You miss a semicolon and you need to \"bitwise or\" your flags:</p>\n\n<pre><code>void wrt_file() //file function\n{\n    memberinformation k;\n    fstream f;\n    f.open (\"information.dat\",ios::app|ios::binary); //this is where I get the error. \n    ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 11042389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355fe2ebcba4c451b1d2d93a606aa335?s=128&d=identicon&r=PG&f=1", "display_name": "Vibhor Sagar", "link": "https://stackoverflow.com/users/11042389/vibhor-sagar"}, "edited": false, "score": 0, "creation_date": 1552505380, "post_id": 55149728, "comment_id": 97040016, "body": "I am pretty new to this. I have written a program like this before but it was a very old version of c++.  Can you suggest or teach how do i save the class in .dat file which i suppose is a data file. My main goal is create a program which can hold the information of a multiple members."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "reply_to_user": {"reputation": 51, "user_id": 11042389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355fe2ebcba4c451b1d2d93a606aa335?s=128&d=identicon&r=PG&f=1", "display_name": "Vibhor Sagar", "link": "https://stackoverflow.com/users/11042389/vibhor-sagar"}, "edited": false, "score": 0, "creation_date": 1552506538, "post_id": 55149728, "comment_id": 97040577, "body": "@VibhorSagar I would avoid using binary representation of your data. It&#39;s more compact but its more brittle (and harder to debug/understand). Most applications will serialize to a human readable format unless they have a absolute need for speed/space or both. Look into the concept of serialization and define the <code>operator&gt;&gt;</code> and <code>operator&lt;&lt;</code> for your class <code>memberinformation</code>"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 3, "last_activity_date": 1552504834, "creation_date": 1552504834, "answer_id": 55149728, "question_id": 55149369, "link": "https://stackoverflow.com/questions/55149369/problems-while-opening-a-dat-file-in-c/55149728#55149728", "title": "Problems while opening a .dat file in c++", "body": "<p>You are lucky to have been stopped by a simple error. @Alex44 has already shown how to get rid of the error:</p>\n\n<pre><code>f.open (\"information.dat\",ios::app|ios::binary); //this is where I get the error. \n</code></pre>\n\n<p>But the following line is even worse:</p>\n\n<pre><code>f.write((char*)&amp;k,sizeof(k));\n</code></pre>\n\n<p>because the compiler will not show any error, while the content of the string will not be saved in the file. <code>std::string</code> is not trivially copiable and because of that, the <code>memberinformation</code> class is not either. So you should not try to write it to a file as raw bytes.</p>\n\n<p>You should instead write a serialization function that writes to a binary stream (just a possible serialization way):</p>\n\n<ul>\n<li><code>phonenumber</code> as a long int (no problem there)</li>\n<li><code>memberid</code> as an int (no problem there)</li>\n<li><code>name.size</code> as a <code>size_t</code></li>\n<li><code>name.data</code> as <code>name.size</code> bytes</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552507665, "post_id": 55150279, "comment_id": 97041085, "body": "the default sorting criteria is votes, but depening on how I sort, &quot;answers above&quot; can be different ;)"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1552507737, "post_id": 55150279, "comment_id": 97041124, "body": "Regarding <a href=\"https://en.cppreference.com/w/cpp/io/basic_ofstream/close\" rel=\"nofollow noreferrer\">close</a>: <i>This function is called by the destructor of basic_ofstream when the stream object goes out of scope and is not usually invoked directly.</i>"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 2, "creation_date": 1552507830, "post_id": 55150279, "comment_id": 97041165, "body": "I would consider it bad practice to manually call <code>close()</code> That&#39;s the whole point of destructors."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1552508011, "post_id": 55150279, "comment_id": 97041266, "body": "Though in general I would not use JSON for simple serialization. It is definately worth the effort if you need any type of cross compatabiity with other tools. Though if you are going to serialize/deserialize via JSON I would not do this manually it is just to much boilerplate. In this case I would use a serialization library like: <a href=\"https://github.com/Loki-Astari/ThorsSerializer\" rel=\"nofollow noreferrer\">ThorsSerializer</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552508308, "post_id": 55150279, "comment_id": 97041402, "body": "&quot;..but I personally think that&#39;s ugly, and I wouldn&#39;t count on it.&quot; I dont think it is ugly at all, but your opinion, but it is definitely something you <b>should</b> count on. RAII is a powerful concept and the way to write exception safe code"}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552510107, "post_id": 55150279, "comment_id": 97042203, "body": "@user463035818 Good point about sort order of answers. I should have been more specific. Regarding close() -- part of the reason I don&#39;t like to count on destructors calling close is because it&#39;s sloppy, and there are too many environments where it doesn&#39;t work that way., or doesn&#39;t work when you think it should. I prefer calling them directly because then I <i>know</i> it&#39;s done, and when it&#39;s done. But ultimately it&#39;s a style choice."}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1552510217, "post_id": 55150279, "comment_id": 97042243, "body": "@MartinYork The whole point of destructors is to clean up after your classes. Correct. I personally don&#39;t want destruction to be the time when heavyweight things like fflush() get called, or worse, when exceptions can be thrown due to stuff like out of disk space. But hey, that&#39;s just me."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552510327, "post_id": 55150279, "comment_id": 97042309, "body": "@JosephLarson what environments do you mean? There must be some misunderstanding, not sure if me or you ;). Destructors being called deterministically is at the heart of c++, it is the essence of RAII, it is the feature of c++ i love most, you actually do know when it is done (even when there are exceptions and no matter how you leave the scope). In an environment without RAII it is not possible to write the c++ i know"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552510564, "post_id": 55150279, "comment_id": 97042434, "body": "i also disagree that it is a style choice. Consider <code>File f; f.open(); throw &quot;ups&quot;; f.close();</code>. A well behaved <code>File</code> has to <code>close()</code> in its destructor, otherwise I&#39;d consider it as broken"}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552510595, "post_id": 55150279, "comment_id": 97042449, "body": "@user463035818 In some languages, destructors are called when the garbage collector comes around, not when an object falls out of scope. If one gets used to fstream, but then uses plain old C file methods (open / fopen), there are no classes with destructors to handle this for you. If he extends the method, then the file contents are dangling during additional code. If this code gets copied to a main() method, then the object may never fall out of scope, and the file is never written. If the program aborts for some reason... It might be safe here, but it&#39;s not universally safe."}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552510696, "post_id": 55150279, "comment_id": 97042501, "body": "@user463035818 Yes, a well-designed File class cleans up itself. Sure. But open/fopen are not well designed, for instance. The call to close doesn&#39;t cost a single thing, but it&#39;s a habit I prefer. You don&#39;t like it. It&#39;s a style difference. We can agree to disagree."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552510732, "post_id": 55150279, "comment_id": 97042515, "body": "of course it is not univerally safe. Languages are different, writing language agnostic code is ... well its going offtopic, and yes we can agree to disagree :)"}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "edited": false, "score": 0, "creation_date": 1552511558, "post_id": 55150279, "comment_id": 97042866, "body": "Because I end up programming in so many different environments, using so many different libraries, I end up using various design patterns. We all do. File open, file write, explicit file close is one of those patterns. It avoids problems when switching to other environments."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1552516104, "post_id": 55150279, "comment_id": 97044656, "body": "Should read: <a href=\"https://stackoverflow.com/q/748014/14065\">stackoverflow.com/q/748014/14065</a> You bring up exceptions. Thats a good point. Because <code>close()</code> can generate exceptions. <b>BUT</b> the destructor will call close discard any exceptions generated (for std::fstream objects). So still the best way is to let RAII handle it (it does the correct thing). The only time I would argue otherwise is when you have an interactive user interface and providing that information does something useful."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 2, "creation_date": 1552516308, "post_id": 55150279, "comment_id": 97044733, "body": "Yes using the same patterns across multiple languages is a bad habiit (you should stop that). You should learn how to use each language it is supposed to be used. Applying the rules for Java or C# to C++ is going to make you use bad patterns like this. PS Garbage collection is the poor mans resource management (it is far inferior to C++ scope based management)."}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "reply_to_user": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1552581851, "post_id": 55150279, "comment_id": 97075098, "body": "@MartinYork Ooh, a new debate. If you&#39;re programming in Java, you&#39;re using the garbage collector. There&#39;s nothing wrong with file.close(). It&#39;s not ONLY about memory manage / garbage collection, but I also listed other reasons I do it. I wasn&#39;t trying to argue. I was trying to offer an alternate perspective. We can disagree. Remember: put any two programmers to solving a problem, and you&#39;ll probably get six solutions. :-)"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1552591105, "post_id": 55150279, "comment_id": 97080079, "body": "@JosephLarson: Probably. :-)"}], "tags": [], "owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "is_accepted": false, "score": -1, "last_activity_date": 1552507190, "creation_date": 1552507190, "answer_id": 55150279, "question_id": 55149369, "link": "https://stackoverflow.com/questions/55149369/problems-while-opening-a-dat-file-in-c/55150279#55150279", "title": "Problems while opening a .dat file in c++", "body": "<p>The answers above address your initial problem. I'm going to talk about two more.</p>\n\n<p>First, you probably should f.close() at the end of your method. It may be perfectly fine to let it drop out of scope and clean up from there, but I personally think that's ugly, and I wouldn't count on it.</p>\n\n<p>Second, I wouldn't store the data in binary unless there's a really good reason to do it. It won't be portable. Serge above suggests a serialization method. I'd consider an alternate approach. I'd write to the file in a human readable form such as JSON. Yes, it's a little more work, but...</p>\n\n<p>-If you change your class, your old files will still be readable\n-They are portable across environments\n-You can actually look at them and readily understand what they contain</p>\n\n<p>So Serge's suggestions above aren't horrible, but I'd pick a more modern serialization / deserialization style.</p>\n\n<p>Note that your f.write won't work because your object contains other objects, you don't know how they work under the hood. That string, for instance, almost certainly can't be dumped the way you're trying to do it. Plus you aren't only dumping your data.</p>\n\n<p>Also, you should printf the sizeof(k). You might find it interesting information. Try to account for every byte. You could printf the sizeof(k.name) to help you work some of it out.</p>\n\n<p>I'm almost positive the information doing so would surprise you, but I haven't actually done it myself, because I would never try to raw memory copy C++ objects, and that's in effect what you're trying to do.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 11042389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355fe2ebcba4c451b1d2d93a606aa335?s=128&d=identicon&r=PG&f=1", "display_name": "Vibhor Sagar", "link": "https://stackoverflow.com/users/11042389/vibhor-sagar"}, "edited": false, "score": 0, "creation_date": 1552752806, "post_id": 55150339, "comment_id": 97135051, "body": "I have other functions declared for receive the information for the class. also can you tell me if every time I call the function to input the data in the class, it&#39;ll save it and store it like multiple data for multiple members. thank you"}, {"owner": {"reputation": 51, "user_id": 11042389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355fe2ebcba4c451b1d2d93a606aa335?s=128&d=identicon&r=PG&f=1", "display_name": "Vibhor Sagar", "link": "https://stackoverflow.com/users/11042389/vibhor-sagar"}, "edited": false, "score": 0, "creation_date": 1552753053, "post_id": 55150339, "comment_id": 97135130, "body": "Also if I decide to setup a function for search up the members, how would you suggest I do?"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "reply_to_user": {"reputation": 51, "user_id": 11042389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355fe2ebcba4c451b1d2d93a606aa335?s=128&d=identicon&r=PG&f=1", "display_name": "Vibhor Sagar", "link": "https://stackoverflow.com/users/11042389/vibhor-sagar"}, "edited": false, "score": 0, "creation_date": 1552753843, "post_id": 55150339, "comment_id": 97135397, "body": "@VibhorSagar I would write a loop to load all the <code>&quot;memberinformation&quot;</code> into a <code>vector&lt; memberinformation&gt;</code> then you can simply loop over vector to search for it. If you want a more sophisticated search you can use <code>std::map&lt;&gt;</code> rather than <code>std::vector&lt;&gt;</code> but that is a cuople of steps ahead of you. You can any working code reviewed at <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a>"}], "tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 2, "last_activity_date": 1552508103, "last_edit_date": 1552508103, "creation_date": 1552507463, "answer_id": 55150339, "question_id": 55149369, "link": "https://stackoverflow.com/questions/55149369/problems-while-opening-a-dat-file-in-c/55150339#55150339", "title": "Problems while opening a .dat file in c++", "body": "<p>The other two answers have answered:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/a/55149435/14065\">Why its not compiling</a>.</li>\n<li><a href=\"https://stackoverflow.com/a/55149728/14065\">Why its a bad idea to write binary objects</a>.</li>\n</ol>\n\n<p>I would suggest that you serialize the object via the standard C++ technique of using the stream operators. This makes writting/reading the objects trivial and usually makes debugging problems easy.</p>\n\n<p>Using the format suggested by <a href=\"https://stackoverflow.com/users/3545273/serge-ballesta\">@serge-ballesta</a> in his post:</p>\n\n<pre><code>class memberinformation\n{\n    string    name; //name\n    long int  phonenumber; // phone number\n    int       memberid; // member id\n    public :\n      // OLD STUFF GOES HERE\n\n    void swap(memberinformation&amp; other) noexcept\n    {\n         using std::swap;\n         swap(name,        other.name);\n         swap(phonenumber, other.phonenumber);\n         swap(memberid,    other.memberid);\n    }\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; str, memberinformation const&amp; data)\n    {\n         return str &lt;&lt; data.phonenumber &lt;&lt; \" \"\n                    &lt;&lt; data.memberid    &lt;&lt; \" \"\n                    &lt;&lt; data.name.size() &lt;&lt; \" \"\n                    &lt;&lt; data.name        &lt;&lt; \" \";\n    }\n    friend std::istream&amp; operator&lt;&lt;(std::istream&amp; str, memberinformation&amp; data)\n    {\n         memberinformation tmp;\n         std::size_t       nameSize\n         if (str &gt;&gt; tmp.phonenumber &gt;&gt; tmp.memberid &gt;&gt; nameSize) {\n             // All sizes were read correctly.\n             tmp.name.resize(nameSize);\n             if (str.ignore(1).read(&amp;tmp.name[0], nameSize)) {\n                 // ignored the space and read the name correctly.\n                 // So now we update the \"data\" object\n                 tmp.swap(data);\n             }\n         }\n         return str;\n    }\n};\n</code></pre>\n\n<p>Now in your code:</p>\n\n<pre><code>int main()\n{\n    memberinformation   object;\n\n    std::cout &lt;&lt; object;\n    std::cin  &gt;&gt; object;\n\n    std::ofstream  file(\"Data.dat\");\n    file &lt;&lt; object;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 11042389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355fe2ebcba4c451b1d2d93a606aa335?s=128&d=identicon&r=PG&f=1", "display_name": "Vibhor Sagar", "link": "https://stackoverflow.com/users/11042389/vibhor-sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1552508103, "creation_date": 1552503315, "question_id": 55149369, "link": "https://stackoverflow.com/questions/55149369/problems-while-opening-a-dat-file-in-c", "title": "Problems while opening a .dat file in c++", "body": "<p>so basically I was trying to save a class inside a .dat file but in my code but it says this error No matching member function for call to 'open' but I put fstream header. I don't know if I'm writing something wrong. I use Xcode 10. </p>\n\n<pre><code>class memberinformation\n{\n    string name; //name\n    long int phonenumber; // phone number\n    int memberid; // member id\n    public :\n    memberinformation()\n    { name=\"not assigned\" ;\n        phonenumber=0;\n        memberid=0;\n    }\n    int option3();\n    int option2();\n    int option1();\n    int option4();\n};\n\n\n\nvoid wrt_file() //file function\n{\n    memberinformation k;\n    fstream f;\n    f.open (\"information.dat\",ios::app,ios::binary) //this is where I get the error. \n            f.write((char*)&amp;k,sizeof(k));\n\n\n\n\n}\n</code></pre>\n"}, {"tags": ["c++", "sandbox"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552502990, "post_id": 55149232, "comment_id": 97038884, "body": "Run the script in a seperate process so it runs in its own isolated address space."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1552503052, "post_id": 55149232, "comment_id": 97038918, "body": "I am not finally sure, but such question might probably better be asked at <a href=\"https://softwareengineering.stackexchange.com/\">SE Software Engineering</a>. Too broad to be answered concisely here."}, {"owner": {"reputation": 1426, "user_id": 673826, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f50a845aca7585dfa8bff6358258eabc?s=128&d=identicon&r=PG", "display_name": "mlt", "link": "https://stackoverflow.com/users/673826/mlt"}, "edited": false, "score": 0, "creation_date": 1552503089, "post_id": 55149232, "comment_id": 97038947, "body": "Use containers."}, {"owner": {"reputation": 7715, "user_id": 58099, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/58bd27591c5f64d1ce84c0a4cb82329c?s=128&d=identicon&r=PG", "display_name": "Vojislav Stojkovic", "link": "https://stackoverflow.com/users/58099/vojislav-stojkovic"}, "edited": false, "score": 0, "creation_date": 1552503239, "post_id": 55149232, "comment_id": 97039025, "body": "My apologies, I wasn&#39;t aware of SE Software Engineering. I don&#39;t user Stack Exchange or Stack Overflow too often, so I&#39;m afraid I was a bit out of the loop. Thank you for pointing me in the right direction. I&#39;ll leave this question open just in case -- the community has the power to close it if they consider it inappropriate."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1552503554, "post_id": 55149232, "comment_id": 97039171, "body": "@VojislavStojkovic THX for noticing. <i>&quot;I&#39;ll leave this question open just in case &quot;</i> Cross posting questions over SE sites isn&#39;t really well received. Better definitiely decide where to ask and delete posts from inappropriate sites."}], "owner": {"reputation": 7715, "user_id": 58099, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/58bd27591c5f64d1ce84c0a4cb82329c?s=128&d=identicon&r=PG", "display_name": "Vojislav Stojkovic", "link": "https://stackoverflow.com/users/58099/vojislav-stojkovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552502786, "creation_date": 1552502786, "question_id": 55149232, "link": "https://stackoverflow.com/questions/55149232/securely-sandboxing-user-scripts-in-a-c-program", "title": "Securely sandboxing user scripts in a C++ program", "body": "<p>I've been working on a personal project in C# that allows the user to execute scripts written by other users and restrict the permissions of that script. I can use .NET Code Access Security mechanisms to sandbox user scripts and make sure that they have only those permissions that the user wants to give them.</p>\n\n<p>Broadly speaking, my security requirements are:</p>\n\n<ul>\n<li>the user should be able to restrict the untrusted script's access to only certain parts of the filesystem, including forbidding all filesystem access</li>\n<li>the user should be able to restrict the untrusted script's network connections to only certain IP addresses or hostnames, including forbidding all network connections</li>\n<li>it is okay if the user script manages to hang or terminate the host application, but the user script must not be able to circumvent the permission restrictions (i.e. denial of service is okay, breach isn't)</li>\n</ul>\n\n<p>I'm contemplating trying to do something similar in C++, as a sort of a personal exercise. Obviously, things are more complicated when running native code directly, even if the user scripts are written in a scripting language like Lua.</p>\n\n<p>The first approach I can think of is to insert my own hooks in the scripting environments standard library functions. For example, if the scripting language is Lua, instead of exposing <code>io.open</code> normally, I would have to expose a wrapper that checked the arguments against the script's permissions before passing them to the original implementation.</p>\n\n<p>My concern with this approach is that it drastically increases the amount of my own code that is in charge of security and, therefore, a potential security vulnerability that I wrote myself. In other words, when working with .NET CAS, I can trust that Microsoft did its job well in the sandboxing code, as opposed to having to trust my own sandboxing code.</p>\n\n<p>Are there any alternatives I'm unaware of?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552502715, "post_id": 55149173, "comment_id": 97038739, "body": "These links may help you: <a href=\"https://en.cppreference.com/w/cpp/algorithm/unique\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/algorithm/unique</a> , <a href=\"https://en.cppreference.com/w/cpp/algorithm/all_any_none_of\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/algorithm/all_any_none_of</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1552502771, "post_id": 55149173, "comment_id": 97038771, "body": "Seems like you are only checking if consecutive elements are equal. This might work if the map was sorted in terms of value, but they are in fact sorted by key. So identical values are not necessarily adjacent while iterating over the map. Edit <i>&quot;I&#39;m struggling to understand why <code>bool notMatch = (pair.second[i] != pair.second[i+1])</code> does not consider them to be equal.&quot;</i> Because <code>6</code> and <code>10</code> aren&#39;t sequential. If <code>i</code> is <code>6</code> you only compare <code>pair.second[6]</code> with <code>pair.second[7]</code>. There&#39;s no possible value of <code>i</code> that would compare the element at position <code>6</code> with the one at position <code>10</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1552502814, "post_id": 55149173, "comment_id": 97038796, "body": "Note that <code>pair.second[i+1]</code> will be undefined behavior on the last iteration where <code>i == pair.second.size() - 1</code>."}, {"owner": {"reputation": 75, "user_id": 11107767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc9527cae6d2ceeaaaa5904d482be2a?s=128&d=identicon&r=PG&f=1", "display_name": "ksm", "link": "https://stackoverflow.com/users/11107767/ksm"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552502994, "post_id": 55149173, "comment_id": 97038887, "body": "@JesperJuhl Thank you! I&#39;ll take a look into those"}, {"owner": {"reputation": 75, "user_id": 11107767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc9527cae6d2ceeaaaa5904d482be2a?s=128&d=identicon&r=PG&f=1", "display_name": "ksm", "link": "https://stackoverflow.com/users/11107767/ksm"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552503091, "post_id": 55149173, "comment_id": 97038952, "body": "@Fran&#231;oisAndrieux Okay okay, that makes sense, thank you"}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 1, "creation_date": 1552507625, "post_id": 55149173, "comment_id": 97041072, "body": "Quick and dirty: dump all the values from pair.second into a std::set, and output the contents of that. something like <code>std::set&lt;std:string&gt; mySet; mySet.insert(pair.second.begin(), pair.second.end());</code>"}, {"owner": {"reputation": 75, "user_id": 11107767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc9527cae6d2ceeaaaa5904d482be2a?s=128&d=identicon&r=PG&f=1", "display_name": "ksm", "link": "https://stackoverflow.com/users/11107767/ksm"}, "reply_to_user": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1552508751, "post_id": 55149173, "comment_id": 97041609, "body": "@Tzalumen You&#39;re my hero"}, {"owner": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 1, "creation_date": 1552509352, "post_id": 55149173, "comment_id": 97041866, "body": "I&#39;d make it an answer, but it doesn&#39;t really address your question, just sidesteps around it using another stl container. One thing to keep in mind: std::set is a sorted container, so you will lose the order in which you inserted elements."}, {"owner": {"reputation": 75, "user_id": 11107767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc9527cae6d2ceeaaaa5904d482be2a?s=128&d=identicon&r=PG&f=1", "display_name": "ksm", "link": "https://stackoverflow.com/users/11107767/ksm"}, "reply_to_user": {"reputation": 564, "user_id": 7298812, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dkDJ8dvUcEI/AAAAAAAAAAI/AAAAAAAAAII/QYtIn6oS_zg/photo.jpg?sz=128", "display_name": "Tzalumen", "link": "https://stackoverflow.com/users/7298812/tzalumen"}, "edited": false, "score": 0, "creation_date": 1552518373, "post_id": 55149173, "comment_id": 97045342, "body": "@Tzalumen Still very helpful nonetheless, learning new things is always great. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 11146756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835530277a9db4ac77128d78b9377bea?s=128&d=identicon&r=PG&f=1", "display_name": "julians", "link": "https://stackoverflow.com/users/11146756/julians"}, "is_accepted": false, "score": 0, "last_activity_date": 1552560150, "creation_date": 1552560150, "answer_id": 55160461, "question_id": 55149173, "link": "https://stackoverflow.com/questions/55149173/checking-for-duplicate-values-associated-with-key-in-map/55160461#55160461", "title": "Checking for duplicate values associated with key in map?", "body": "<p>Building on @Tzalumen's comment, you could insert the values in a set or unordered set and compare the size to the original vector:</p>\n\n<pre><code>for(const auto&amp; pair : myMap){\n    unordered_set&lt;string&gt; s(pair.second.begin(), pair.second.end());\n    if (s.size() == pair.second.size()) {\n        cout &lt;&lt; \"value has unique elements\" &lt;&lt; endl;\n    } else { \n        cout &lt;&lt; \"value has duplicate elements\" &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>If the set's size is smaller than the vector's size, you know the vector has duplicates.</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 11107767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc9527cae6d2ceeaaaa5904d482be2a?s=128&d=identicon&r=PG&f=1", "display_name": "ksm", "link": "https://stackoverflow.com/users/11107767/ksm"}, "edited": false, "score": 0, "creation_date": 1552597830, "post_id": 55160702, "comment_id": 97083346, "body": "Hi, thanks for the tip, as I stated in my post, I do actually need the duplicates in the original map, otherwise <code>map&lt;string, set&lt;string&gt;&gt;</code> would be prefect"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1552560901, "creation_date": 1552560901, "answer_id": 55160702, "question_id": 55149173, "link": "https://stackoverflow.com/questions/55149173/checking-for-duplicate-values-associated-with-key-in-map/55160702#55160702", "title": "Checking for duplicate values associated with key in map?", "body": "<p>If you don't want duplicates anywhere, why not have a <code>std::map&lt;std::string, std::set&lt;std::string&gt;&gt;</code> in the first place?</p>\n"}], "owner": {"reputation": 75, "user_id": 11107767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc9527cae6d2ceeaaaa5904d482be2a?s=128&d=identicon&r=PG&f=1", "display_name": "ksm", "link": "https://stackoverflow.com/users/11107767/ksm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552560901, "creation_date": 1552502533, "question_id": 55149173, "link": "https://stackoverflow.com/questions/55149173/checking-for-duplicate-values-associated-with-key-in-map", "title": "Checking for duplicate values associated with key in map?", "body": "<p>I'm struggling with outputting unique values of a <code>map&lt;string, vector&lt;string&gt;&gt;</code> I have. Right now, I have a map, and iterate through it, with the goal of outputting only unique values associated with the specified key.</p>\n\n<p>I do need to keep the duplicate values, or else I'd just remove the dups :)</p>\n\n<p>After looking at <strong><a href=\"https://stackoverflow.com/questions/32391079/c-how-to-check-if-elements-in-an-array-are-equal/32391112\">this post</a></strong>, my set up is like the following:</p>\n\n<pre><code> for( const auto&amp; pair : myMap ){\n\n        for( std::size_t i = 0; i &lt; pair.second.size(); ++i ) {\n\n            bool notMatch = (pair.second[i] != pair.second[i+1]){\n\n            if (pair.first == key &amp;&amp; notMatch){\n                cout &lt;&lt; key &lt;&lt; \" : \";\n                cout &lt;&lt; pair.second[i] &lt;&lt; \" - at index -  \" &lt;&lt; i &lt;&lt; \"\\n\";\n            }\n       }\n    }\n</code></pre>\n\n<p>I then get an output along the lines of :</p>\n\n<p>\"key : value - at index -  6\"</p>\n\n<p>\"key : value - at index -  10\"</p>\n\n<p>My initial thought was that one of the elements might have some extra characters or something, which would make sense as to why the duplicate elements are not being seen as equal.</p>\n\n<p>But when doing a simple check of -</p>\n\n<pre><code>if (pair.second[6] == pair.second[10]){\n   cout &lt;&lt; \"They are equal\";\n} else {\n   cout &lt;&lt; \"They are NOT equal\";\n}\n</code></pre>\n\n<p>It confirms and returns that the two elements are in fact equal. Since the elements are equal, I'm struggling to understand why <code>bool notMatch = (pair.second[i] != pair.second[i+1])</code> does not consider them to be equal. </p>\n\n<p>Apologies if this was posted incorrectly, I'll edit if necessary.</p>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["c++", "qt", "qwidget"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1552502707, "post_id": 55149076, "comment_id": 97038729, "body": "You have <code>#include &quot;ui_mainwindow.h&quot;</code>, but haven&#39;t show the contents of that file.  In fact, there seems to be a lot more here than I&#39;d expect for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, even where you need two subclasses."}, {"owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1552502840, "post_id": 55149076, "comment_id": 97038814, "body": "@TobySpeight, this is correct. I can supply the ui file if needed, I just didn&#39;t want to load the question with a bunch of junk. However, in my <code>MainWindow.cpp</code> I have labeled two very obvious dock widgets and a splitter. It is probably not the best practice to assume the user will create those themselves. I will link the UI File."}], "owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552502971, "creation_date": 1552502200, "last_edit_date": 1552502971, "question_id": 55149076, "link": "https://stackoverflow.com/questions/55149076/how-do-i-re-dock-a-qdockwidget-to-its-parent-qmainwindow", "title": "How do I re-dock a QDockWidget to it&#39;s Parent QMainWindow?", "body": "<p>I have been trying to figure out if you could dock a QDockWidget in a QSplitter, <a href=\"https://stackoverflow.com/questions/55131178/how-to-dock-a-qdockwidgets-inside-a-qsplitter\">here is my original question</a>. However, after doing a lot of digging around, I found <a href=\"https://stackoverflow.com/questions/35287958/dragging-qdockwidgets-between-qmainwindows?rq=1\">this helpful post</a> which lead to another post that stated that <code>QDockWidgets</code> can only be docked on <code>QMainWindows</code>. In the helpful post I linked, there was a comment that led to <a href=\"https://www.qtcentre.org/threads/41847-Dragging-QDockWidgets-between-QMainWindows\" rel=\"nofollow noreferrer\">this solution</a> on the QtCenter. </p>\n\n<p>What I have done, is taken that code and added it to my application. However, I quickly found out that it only works one way. As in if I have a <code>QMainWindow</code> in my <code>QSplitter</code>, I can take the <code>QDockWindow</code> out of the <code>QSplitter</code> and dock it on the main application. However, I cannot re-dock my QSplitter's <code>QDockWindow</code> back into the QSplitter's <code>QMainWindow</code>. </p>\n\n<p>I then tried to create another class called, <code>MyWindow</code> as I figured that maybe I just need to be able to create a seperate <code>QMainWindow</code> class that I can then connect through the GUI and has the same functions as the <code>MainWindowClass</code>. However that too has failed. Here is my code:</p>\n\n<p><strong>MyWindow.hpp</strong></p>\n\n<pre><code>#ifndef MYWINDOW_HPP\n#define MYWINDOW_HPP\n\n#include &lt;QMainWindow&gt;\n#include &lt;QObject&gt;\n#include &lt;QWidget&gt;\n#include &lt;QDockWidget&gt;\n\n\nclass MyWindow : public QMainWindow\n{\n  Q_OBJECT\n\n  public:\n    MyWindow(QWidget *child = nullptr);\n\n    QMainWindow* createNewWindow();\n\n\n  public slots:\n    void dragStarted(bool started);\n    void enterEvent(QEvent *event);\n    void dragEnded() { dw = nullptr; }\n\n\n  private:\n    QDockWidget* dw = nullptr;\n};\n\n#endif // MYWINDOW_HPP\n</code></pre>\n\n<p><strong>MyWindow.cpp</strong></p>\n\n<pre><code>#include \"mywindow.hpp\"\n\nMyWindow::MyWindow(QWidget *child) : QMainWindow (child){}\n\nQMainWindow* MyWindow::createNewWindow()\n{\n    QMainWindow *newWindow = new QMainWindow(this);\n    newWindow-&gt;setWindowFlags(Qt::Widget);\n    return newWindow;\n}\n\nvoid MyWindow::dragStarted(bool started)\n{\n    if(started)\n    {\n        if(QDockWidget* dock = qobject_cast&lt;QDockWidget*&gt;(sender()))\n            dw = dock;\n        else\n            dw = nullptr;\n    }\n}\n\nvoid MyWindow::enterEvent(QEvent *event)\n{\n    if(dw &amp;&amp; dw-&gt;parent() != this)\n    {\n        addDockWidget(Qt::RightDockWidgetArea, dw);\n        dw = nullptr;\n    }\n}\n</code></pre>\n\n<p><strong>MainWindow.hpp</strong></p>\n\n<pre><code>#ifndef MAINWINDOW_HPP\n#define MAINWINDOW_HPP\n\n#include &lt;QMainWindow&gt;\n#include &lt;QWidget&gt;\n#include &lt;QDockWidget&gt;\n#include \"mywindow.hpp\"\n\nnamespace Ui {\nclass MainWindow;\n}\n\nclass MainWindow : public QMainWindow\n{\n    Q_OBJECT\n\npublic:\n    explicit MainWindow(QWidget *parent = nullptr);\n    ~MainWindow();\n\npublic slots:\n    void dragStarted(bool started);\n    void enterEvent(QEvent *event);\n    void dragEnded() { dw = nullptr; }\n\nprivate:\n    Ui::MainWindow *ui;\n    QDockWidget* dw = nullptr;\n};\n\n#endif // MAINWINDOW_HPP\n</code></pre>\n\n<p><strong>MainWindow.cpp</strong></p>\n\n<pre><code>#include \"mainwindow.hpp\"\n#include \"ui_mainwindow.h\"\n\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n    QWidget *child = nullptr;\n    MyWindow myWindow(child);\n\n    QMainWindow *leftWindow = myWindow.createNewWindow();\n    QMainWindow *rightWindow = myWindow.createNewWindow();\n\n    leftWindow-&gt;addDockWidget(Qt::LeftDockWidgetArea,ui-&gt;leftDock);\n    rightWindow-&gt;addDockWidget(Qt::RightDockWidgetArea,ui-&gt;rightDock);\n\n    ui-&gt;splitter-&gt;addWidget(leftWindow);\n    ui-&gt;splitter-&gt;addWidget(rightWindow);\n\n    //connect(ui-&gt;leftDock,SIGNAL(topLevelChanged(bool)),&amp;myWindow,SLOT(dragStarted(bool)));\n    //connect(ui-&gt;rightDock,SIGNAL(topLevelChanged(bool)),&amp;myWindow,SLOT(dragStarted(bool)));\n    connect(ui-&gt;leftDock,SIGNAL(topLevelChanged(bool)),this,SLOT(dragStarted(bool)));\n    connect(ui-&gt;rightDock,SIGNAL(topLevelChanged(bool)),this,SLOT(dragStarted(bool)));\n\n    //connect(ui-&gt;leftDock,SIGNAL(dockLocationChanged (Qt::DockWidgetArea)),&amp;myWindow,SLOT(dragEnded()));\n    //connect(ui-&gt;rightDock,SIGNAL(dockLocationChanged (Qt::DockWidgetArea)),&amp;myWindow,SLOT(dragEnded()));\n    connect(ui-&gt;leftDock,SIGNAL(dockLocationChanged (Qt::DockWidgetArea)),this,SLOT(dragEnded()));\n    connect(ui-&gt;rightDock,SIGNAL(dockLocationChanged (Qt::DockWidgetArea)),this,SLOT(dragEnded()));\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n\nvoid MainWindow::dragStarted(bool started)\n{\n    if(started)\n    {\n        if(QDockWidget* dock = qobject_cast&lt;QDockWidget*&gt;(sender()))\n            dw = dock;\n        else\n            dw = nullptr;\n    }\n}\n\nvoid MainWindow::enterEvent(QEvent *event)\n{\n    if(dw &amp;&amp; dw-&gt;parent() != this)\n    {\n        addDockWidget(Qt::RightDockWidgetArea, dw);\n        dw = nullptr;\n    }\n}\n</code></pre>\n\n<p>The commented out pieces of code is what I originally tried to do in order to connect them. My thought process was that <code>MyWindow</code> class should have it's own <code>QDockWidget</code>, however when thinking about it, <code>MainWindow</code> class is the one that actually owns the <code>QDockWidget</code> and I am not really sure if re-assigning the parent <code>QMainWindow</code> is the right way to go or not. </p>\n\n<p>What do I need to do in order to get them to re-dock to their original Parent's QMainWindow? </p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>Here is the ui file should anyone need it:</p>\n\n<p><strong>MainWindow.ui</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ui version=\"4.0\"&gt;\n &lt;class&gt;MainWindow&lt;/class&gt;\n &lt;widget class=\"QMainWindow\" name=\"MainWindow\"&gt;\n  &lt;property name=\"geometry\"&gt;\n   &lt;rect&gt;\n    &lt;x&gt;0&lt;/x&gt;\n    &lt;y&gt;0&lt;/y&gt;\n    &lt;width&gt;1144&lt;/width&gt;\n    &lt;height&gt;802&lt;/height&gt;\n   &lt;/rect&gt;\n  &lt;/property&gt;\n  &lt;property name=\"windowTitle\"&gt;\n   &lt;string&gt;MainWindow&lt;/string&gt;\n  &lt;/property&gt;\n  &lt;widget class=\"QWidget\" name=\"centralWidget\"&gt;\n   &lt;widget class=\"QSplitter\" name=\"splitter\"&gt;\n    &lt;property name=\"geometry\"&gt;\n     &lt;rect&gt;\n      &lt;x&gt;30&lt;/x&gt;\n      &lt;y&gt;60&lt;/y&gt;\n      &lt;width&gt;781&lt;/width&gt;\n      &lt;height&gt;591&lt;/height&gt;\n     &lt;/rect&gt;\n    &lt;/property&gt;\n    &lt;property name=\"minimumSize\"&gt;\n     &lt;size&gt;\n      &lt;width&gt;681&lt;/width&gt;\n      &lt;height&gt;551&lt;/height&gt;\n     &lt;/size&gt;\n    &lt;/property&gt;\n    &lt;property name=\"maximumSize\"&gt;\n     &lt;size&gt;\n      &lt;width&gt;16777215&lt;/width&gt;\n      &lt;height&gt;16777215&lt;/height&gt;\n     &lt;/size&gt;\n    &lt;/property&gt;\n    &lt;property name=\"frameShape\"&gt;\n     &lt;enum&gt;QFrame::Box&lt;/enum&gt;\n    &lt;/property&gt;\n    &lt;property name=\"frameShadow\"&gt;\n     &lt;enum&gt;QFrame::Raised&lt;/enum&gt;\n    &lt;/property&gt;\n    &lt;property name=\"lineWidth\"&gt;\n     &lt;number&gt;2&lt;/number&gt;\n    &lt;/property&gt;\n    &lt;property name=\"midLineWidth\"&gt;\n     &lt;number&gt;2&lt;/number&gt;\n    &lt;/property&gt;\n    &lt;property name=\"orientation\"&gt;\n     &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;\n    &lt;/property&gt;\n   &lt;/widget&gt;\n  &lt;/widget&gt;\n  &lt;widget class=\"QMenuBar\" name=\"menuBar\"&gt;\n   &lt;property name=\"geometry\"&gt;\n    &lt;rect&gt;\n     &lt;x&gt;0&lt;/x&gt;\n     &lt;y&gt;0&lt;/y&gt;\n     &lt;width&gt;1144&lt;/width&gt;\n     &lt;height&gt;21&lt;/height&gt;\n    &lt;/rect&gt;\n   &lt;/property&gt;\n  &lt;/widget&gt;\n  &lt;widget class=\"QToolBar\" name=\"mainToolBar\"&gt;\n   &lt;attribute name=\"toolBarArea\"&gt;\n    &lt;enum&gt;TopToolBarArea&lt;/enum&gt;\n   &lt;/attribute&gt;\n   &lt;attribute name=\"toolBarBreak\"&gt;\n    &lt;bool&gt;false&lt;/bool&gt;\n   &lt;/attribute&gt;\n  &lt;/widget&gt;\n  &lt;widget class=\"QStatusBar\" name=\"statusBar\"/&gt;\n  &lt;widget class=\"QDockWidget\" name=\"leftDock\"&gt;\n   &lt;property name=\"maximumSize\"&gt;\n    &lt;size&gt;\n     &lt;width&gt;524287&lt;/width&gt;\n     &lt;height&gt;300&lt;/height&gt;\n    &lt;/size&gt;\n   &lt;/property&gt;\n   &lt;property name=\"windowTitle\"&gt;\n    &lt;string&gt;Left Dock&lt;/string&gt;\n   &lt;/property&gt;\n   &lt;attribute name=\"dockWidgetArea\"&gt;\n    &lt;number&gt;1&lt;/number&gt;\n   &lt;/attribute&gt;\n   &lt;widget class=\"QWidget\" name=\"dockWidgetContents\"&gt;\n    &lt;layout class=\"QGridLayout\" name=\"gridLayout\"&gt;\n     &lt;item row=\"0\" column=\"0\"&gt;\n      &lt;widget class=\"QTabWidget\" name=\"tabWidget\"&gt;\n       &lt;widget class=\"QWidget\" name=\"tab\"&gt;\n        &lt;attribute name=\"title\"&gt;\n         &lt;string&gt;Tab 1&lt;/string&gt;\n        &lt;/attribute&gt;\n       &lt;/widget&gt;\n       &lt;widget class=\"QWidget\" name=\"tab_2\"&gt;\n        &lt;attribute name=\"title\"&gt;\n         &lt;string&gt;Tab 2&lt;/string&gt;\n        &lt;/attribute&gt;\n       &lt;/widget&gt;\n      &lt;/widget&gt;\n     &lt;/item&gt;\n    &lt;/layout&gt;\n   &lt;/widget&gt;\n  &lt;/widget&gt;\n  &lt;widget class=\"QDockWidget\" name=\"rightDock\"&gt;\n   &lt;property name=\"maximumSize\"&gt;\n    &lt;size&gt;\n     &lt;width&gt;524287&lt;/width&gt;\n     &lt;height&gt;300&lt;/height&gt;\n    &lt;/size&gt;\n   &lt;/property&gt;\n   &lt;property name=\"windowTitle\"&gt;\n    &lt;string&gt;Right Dock&lt;/string&gt;\n   &lt;/property&gt;\n   &lt;attribute name=\"dockWidgetArea\"&gt;\n    &lt;number&gt;1&lt;/number&gt;\n   &lt;/attribute&gt;\n   &lt;widget class=\"QWidget\" name=\"dockWidgetContents_2\"&gt;\n    &lt;layout class=\"QGridLayout\" name=\"gridLayout_2\"&gt;\n     &lt;item row=\"0\" column=\"0\"&gt;\n      &lt;widget class=\"QTabWidget\" name=\"tabWidget_2\"&gt;\n       &lt;property name=\"currentIndex\"&gt;\n        &lt;number&gt;0&lt;/number&gt;\n       &lt;/property&gt;\n       &lt;widget class=\"QWidget\" name=\"tab_3\"&gt;\n        &lt;attribute name=\"title\"&gt;\n         &lt;string&gt;Tab 1&lt;/string&gt;\n        &lt;/attribute&gt;\n       &lt;/widget&gt;\n       &lt;widget class=\"QWidget\" name=\"tab_4\"&gt;\n        &lt;attribute name=\"title\"&gt;\n         &lt;string&gt;Tab 2&lt;/string&gt;\n        &lt;/attribute&gt;\n       &lt;/widget&gt;\n      &lt;/widget&gt;\n     &lt;/item&gt;\n    &lt;/layout&gt;\n   &lt;/widget&gt;\n  &lt;/widget&gt;\n &lt;/widget&gt;\n &lt;layoutdefault spacing=\"6\" margin=\"11\"/&gt;\n &lt;resources/&gt;\n &lt;connections/&gt;\n&lt;/ui&gt;\n</code></pre>\n"}, {"tags": ["c++", "r", "rcpp"], "comments": [{"owner": {"reputation": 133, "user_id": 7186287, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f78fb99dc15046f60b6aa586a285706b?s=128&d=identicon&r=PG&f=1", "display_name": "gultu", "link": "https://stackoverflow.com/users/7186287/gultu"}, "reply_to_user": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1552502082, "post_id": 55148827, "comment_id": 97038396, "body": "@coatless Here, ts= sort(runif(100)); cf=1.4;  h=0.5;  g=2.3"}, {"owner": {"reputation": 133, "user_id": 7186287, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f78fb99dc15046f60b6aa586a285706b?s=128&d=identicon&r=PG&f=1", "display_name": "gultu", "link": "https://stackoverflow.com/users/7186287/gultu"}, "reply_to_user": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1552502455, "post_id": 55148827, "comment_id": 97038601, "body": "@coatless, to produce a reproducible example, I gave that example. But if I get NaN values; how can I check that without creating a vector?"}, {"owner": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1552502577, "post_id": 55148827, "comment_id": 97038668, "body": "In terms of <code>NaN</code> (not a number), this is triggered if there are missing values in the data or <code>x</code> is negative inside <code>log()</code>."}, {"owner": {"reputation": 133, "user_id": 7186287, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f78fb99dc15046f60b6aa586a285706b?s=128&d=identicon&r=PG&f=1", "display_name": "gultu", "link": "https://stackoverflow.com/users/7186287/gultu"}, "reply_to_user": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1552502768, "post_id": 55148827, "comment_id": 97038770, "body": "@coatless, are you suggesting to create a vector and filling up each entry and checking if it is giving finite values and then summing up the finite values only?"}, {"owner": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 2, "creation_date": 1552502915, "post_id": 55148827, "comment_id": 97038850, "body": "You can check the result prior to adding it to the reduction variable, e.g.   <code>result = pow(ts[i]-ts[j]+h, g); if(is_finite(result)) {     temp += result; }</code>"}, {"owner": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1552502974, "post_id": 55148827, "comment_id": 97038874, "body": "Again, we need an example of the issue you are running into with the above code related to <code>NaN</code> before we can help further. This portion is &quot;unclear&quot;"}, {"owner": {"reputation": 133, "user_id": 7186287, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f78fb99dc15046f60b6aa586a285706b?s=128&d=identicon&r=PG&f=1", "display_name": "gultu", "link": "https://stackoverflow.com/users/7186287/gultu"}, "reply_to_user": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1552503618, "post_id": 55148827, "comment_id": 97039222, "body": "@coatless Thanks, that answered my question"}], "answers": [{"tags": [], "owner": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "is_accepted": false, "score": 2, "last_activity_date": 1552515308, "last_edit_date": 1552515308, "creation_date": 1552514639, "answer_id": 55151870, "question_id": 55148827, "link": "https://stackoverflow.com/questions/55148827/checking-non-finite-values-in-rcpp-without-creating-a-vector/55151870#55151870", "title": "Checking non-finite values in Rcpp without creating a vector", "body": "<p>In short, you can check for whether a value is finite, e.g. not <code>NaN</code>,<code>Inf</code>, or <code>-Inf</code>, by using <code>arma::is_finite()</code>. <strong>Note:</strong> In cases where only <em>Rcpp</em> is used, check with <code>bool finiteness = Rcpp::is_finite(x)[0]</code> as <code>Rcpp::is_finite()</code> returns a <code>LogicalVector</code>. </p>\n\n<p>Sample implementation:</p>\n\n<pre><code>#include &lt;RcppArmadillo.h&gt;\n// [[Rcpp::depends(RcppArmadillo)]]\n\n// [[Rcpp::export]]\ndouble AmiA(arma::vec ts, int n, double cf, double h, double g) {\n\n\n    double sumA = log(cf);\n    double temp;\n\n\n    for (int i=1; i &lt; n; i++) {\n        temp = cf;\n        for (int j=0; j&lt;i; j++) {\n\n            // Compute value\n            result = pow(ts[i]-ts[j]+h, g);\n\n            // Guard against non-finite values\n            if(arma::is_finite(result)){\n                temp +=  result\n            }\n\n        }\n        sumA += log(temp);\n\n    }\n\n    return(sumA);\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 7186287, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f78fb99dc15046f60b6aa586a285706b?s=128&d=identicon&r=PG&f=1", "display_name": "gultu", "link": "https://stackoverflow.com/users/7186287/gultu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552515308, "creation_date": 1552501287, "last_edit_date": 1552502280, "question_id": 55148827, "link": "https://stackoverflow.com/questions/55148827/checking-non-finite-values-in-rcpp-without-creating-a-vector", "title": "Checking non-finite values in Rcpp without creating a vector", "body": "<p>I haven written Rcpp code to perform a calculation related to time series:</p>\n\n<pre><code>#include &lt;RcppArmadillo.h&gt;\n// [[Rcpp::depends(RcppArmadillo)]]\n\n// [[Rcpp::export]]\ndouble AmiA(arma::vec ts, int n, double cf, double h, double g) {\n\n\n  double sumA = log(cf);\n  double temp;\n\n\n  for (int i=1; i &lt; n; i++) {\n    temp = cf;\n    for (int j=0; j&lt;i; j++) {\n      temp +=  pow(ts[i]-ts[j]+h, g);\n\n    }\n    sumA += log(temp);\n\n  }\n\n  return(sumA);\n}\n\n</code></pre>\n\n<p>Here, \"ts\" is a vector and \"n\" is the length of this vector. \"cf\", \"h\" and \"g\" are the constants. </p>\n\n<p>To make the code faster, I declared the double <code>temp</code> and then for each observation, I added the portion <code>pow(ts[i]-ts[j]+h, g)</code> with it. Now for some observation; the portion <code>pow(ts[i]-ts[j]+h, g)</code> gives NaN values. This can be obtained by:</p>\n\n<pre><code>n = 100; ts = sort(runif(n)); cf=1.4; h=0.5; g=2.3\nAmiA(ts, n, cf, h, g)\n# [1] 307.0836\n</code></pre>\n\n<p>How can I check those values without creating a vector and checking the values of this vector? Any ideas will be much appreciated.</p>\n"}, {"tags": ["c++", "opengl"], "answers": [{"tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 3, "last_activity_date": 1552501420, "creation_date": 1552501420, "answer_id": 55148870, "question_id": 55148786, "link": "https://stackoverflow.com/questions/55148786/is-it-portable-using-glclearbufferdata-for-composite-data-types/55148870#55148870", "title": "Is it portable using glClearBufferData for composite data types?", "body": "<p>Buffer objects do not have an \"actual type of the data\". They contain bytes; that's it. It's the usage of a buffer that gives the bytes it stores meaning, and those bytes have the meaning that the particular usage says that they have. And even then, it only has that meaning when using the buffer's data in that particular way.</p>\n\n<p>Your clear call sets all of the buffer's bytes to 0. If you use that buffer as a source for vertex data, and the type for a particular attribute is <code>GL_FLOAT</code>, then the bytes read for that attribute will be interpreted as storing an IEEE-754 32-bit floating-point value, in the same byte ordering as the CPU provides its equivalent type. IEEE-754 defines that a sequence of 0 bytes has a well-defined value (namely, positive zero), so this will have well-defined behavior.</p>\n"}], "owner": {"reputation": 559, "user_id": 9659683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249fe606f1c24c12c7b2356ea3c52dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Tarquiscani", "link": "https://stackoverflow.com/users/9659683/tarquiscani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 55148870, "answer_count": 1, "score": 1, "last_activity_date": 1552504361, "creation_date": 1552501096, "last_edit_date": 1552504361, "question_id": 55148786, "link": "https://stackoverflow.com/questions/55148786/is-it-portable-using-glclearbufferdata-for-composite-data-types", "title": "Is it portable using glClearBufferData for composite data types?", "body": "<p>I have a buffer (used both as SSBO and VBO) that contains a composite data type interleaving floats and unsigned integers:</p>\n\n<pre><code>struct VertexData\n{\n    struct \n    {   \n        float x; \n        float y; \n        float z; \n    } position;\n\n    struct\n    {\n        float u;\n        float v;\n    } tex_coords;\n\n    GLuint entity_id;\n};\n\nglBufferData(GL_ARRAY_BUFFER, sizeof(VertexData) * buffer_maxSize, nullptr, GL_DYNAMIC_DRAW);\n</code></pre>\n\n<p>When I clear the buffer I use the following function:</p>\n\n<pre><code>glClearBufferData(GL_SHADER_STORAGE_BUFFER, GL_R32UI, GL_RED, GL_UNSIGNED_INT, nullptr);\n</code></pre>\n\n<p>It works, but since the <em>format</em> <code>GL_R32UI</code> doesn't match the actual type of the data (<code>VertexData</code>), I'm afraid that the code might not work on every machine/driver.</p>\n\n<p>In the case the code isn't portable what is the right function I should use?</p>\n\n<hr>\n\n<p>As an aside, should I use GL_FLOAT in my VertexData for better portability?</p>\n"}, {"tags": ["c++", "templates", "move-semantics"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1552501338, "post_id": 55148774, "comment_id": 97037983, "body": "Please copy-paste full error messages (from the &quot;Output&quot; tab, instead of the &quot;Error List&quot;), since ones that you show here, doesn&#39;t seem complete."}, {"owner": {"reputation": 921, "user_id": 2043980, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/17e881e92b245bcb71fe579f34acb1b0?s=128&d=identicon&r=PG", "display_name": "Demaunt", "link": "https://stackoverflow.com/users/2043980/demaunt"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1552501510, "post_id": 55148774, "comment_id": 97038068, "body": "sorry I missed  void foo() { }  in the top of code"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1552501858, "post_id": 55148774, "comment_id": 97038281, "body": "1) This is not what I was pointing out. 2) Now <code>&#47;&#47;error 1</code> <code>&#47;&#47;error 2</code> comments, doesn&#39;t make sense, due to the fact, that your question no longer contains any errors, that you get."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1552501771, "creation_date": 1552501771, "answer_id": 55148967, "question_id": 55148774, "link": "https://stackoverflow.com/questions/55148774/cannot-move-stdfunction-into-map/55148967#55148967", "title": "Cannot move std::function into map", "body": "<p><code>T&amp;&amp;</code> is not a forwarding reference if <code>T</code> is not deduced, and converse.</p>\n\n<pre><code>template&lt;class T&gt;\nauto&amp; get_collection_for_signal(T&amp;&amp; t)\n</code></pre>\n\n<p><code>T</code> is deduced as a reference to <code>Signal&lt;void()&gt;</code> in your example use:</p>\n\n<pre><code>auto&amp; t = get_collection_for_signal(sgl);\n</code></pre>\n\n<p>so it returns:</p>\n\n<pre><code>return SignalCollection&lt;T&gt;::Instance();\n</code></pre>\n\n<p>which is:</p>\n\n<pre><code>SignalCollection&lt;Signal&lt;void()&gt;&amp;&gt;::Instance()\n</code></pre>\n\n<p>which is nonsense.</p>\n\n<p>Brush up on forwarding references and l/rvalue references.  Every use of it in your code is wrong.</p>\n\n<p>Design wise, you have useless types -- <code>Signal&lt;T&gt;</code> as written is a std function with baggage that does nothing -- global singletons, and type deduction creating global state.</p>\n\n<p>I get what you are trying to do, but it is kin to wanting to make a fire engine out of straw.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 6, "last_activity_date": 1552502321, "last_edit_date": 1552502321, "creation_date": 1552501844, "answer_id": 55148990, "question_id": 55148774, "link": "https://stackoverflow.com/questions/55148774/cannot-move-stdfunction-into-map/55148990#55148990", "title": "Cannot move std::function into map", "body": "<p>The problem here is</p>\n\n<pre><code>template&lt;class T&gt;\nauto&amp; get_collection_for_signal(T&amp;&amp; t)\n{\n    return SignalCollection&lt;T&gt;::Instance();\n}\n</code></pre>\n\n<p>When you call it like</p>\n\n<pre><code>auto&amp; t = get_collection_for_signal(sgl);\n</code></pre>\n\n<p><code>T</code> is deduced as <code>Signal&lt;void()&gt;&amp;</code> and that means you return a <code>SignalCollection&lt;Signal&lt;void()&gt;&amp;&gt;</code> which is not what you want.  What you need to do is remove the reference from the type.  You can do that using</p>\n\n<pre><code>template&lt;class T&gt;\nauto&amp; get_collection_for_signal(T&amp;&amp;)\n{\n    return SignalCollection&lt;std::remove_cv_t&lt;std::remove_reference_t&lt;T&gt;&gt;&gt;::Instance();\n}\n</code></pre>\n\n<p>which removed the <em>cv</em> qualification and the reference from <code>T</code> (C++20 gives us <code>std::remove_cvref</code> so it can be done with a single helper).</p>\n\n<p>You can also get the same behavior with</p>\n\n<pre><code>template&lt;class T&gt;\nauto&amp; get_collection_for_signal(T)\n{\n    return SignalCollection&lt;T&gt;::Instance();\n}\n</code></pre>\n\n<p>This involves a lot less typing and gives you the same behavior since top level cv qualifications get striped out and it will never deduce a reference.</p>\n\n<hr>\n\n<p>You also have an issue with your <code>add</code> function.</p>\n\n<pre><code>void add(T&amp;&amp; signal)\n{\n    this-&gt;signals_map.insert(std::make_pair(\"a\", std::forward&lt;T&gt;(signal)));\n}\n</code></pre>\n\n<p>isn't using a forwarding reference since <code>T</code> is part of the class type.  You need to make it it's own template to have a forwarding reference.  You can do that by changing it to</p>\n\n<pre><code>template&lt;typename U&gt;\nvoid add(U&amp;&amp; signal)\n{\n    this-&gt;signals_map.insert(std::make_pair(\"a\", std::forward&lt;U&gt;(signal)));\n}\n</code></pre>\n\n<hr>\n\n<p>lastly</p>\n\n<pre><code>void main()\n</code></pre>\n\n<p>is <strong>always</strong> wrong.  <code>main()</code> is mandated to return an <code>int</code>.  Have a read through <a href=\"https://stackoverflow.com/questions/204476/what-should-main-return-in-c-and-c\">What should main() return in C and C++?</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 2, "last_activity_date": 1552502107, "creation_date": 1552502107, "answer_id": 55149055, "question_id": 55148774, "link": "https://stackoverflow.com/questions/55148774/cannot-move-stdfunction-into-map/55149055#55149055", "title": "Cannot move std::function into map", "body": "<p>The other answers are good at explaining the error, but I would recommend another solution to fix the problem.</p>\n\n<p>I see that in your code you don't actually need a forwarding reference. You only use it for deduction. In that case, you can take your argument by <code>T const&amp;</code>, which always will deduce a <code>T</code> without a reference.</p>\n\n<pre><code>template&lt;class T&gt;\nauto&amp; get_collection_for_signal(T const&amp; t)\n{\n    return SignalCollection&lt;T&gt;::Instance();\n}\n</code></pre>\n"}], "owner": {"reputation": 921, "user_id": 2043980, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/17e881e92b245bcb71fe579f34acb1b0?s=128&d=identicon&r=PG", "display_name": "Demaunt", "link": "https://stackoverflow.com/users/2043980/demaunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 55148990, "answer_count": 3, "score": 0, "last_activity_date": 1552502431, "creation_date": 1552501058, "last_edit_date": 1552502431, "question_id": 55148774, "link": "https://stackoverflow.com/questions/55148774/cannot-move-stdfunction-into-map", "title": "Cannot move std::function into map", "body": "<p>I have some Signal prototype class</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;string&gt;\n#include &lt;functional&gt;\n\ntemplate &lt;class T&gt;\nclass Signal\n{\npublic:\n    std::function&lt;T&gt; slot;\n};\n</code></pre>\n\n<p>Next comes template singleton <code>SignalCollection</code> class, that automatically generates appropriate type for <code>Signal</code></p>\n\n<pre><code>template &lt;class T&gt;\nclass SignalCollection\n{\nprivate:\n    SignalCollection() {}\n    SignalCollection(const SignalCollection&amp;) = delete;\n    SignalCollection&amp; operator= (const SignalCollection&amp;) = delete;\npublic:\n\n    static SignalCollection&amp; Instance()\n    {\n        static SignalCollection br{};\n        return br;\n    }\n\n    std::map&lt;std::string, T&gt; signals_map;\n\n    void add(T&amp;&amp; signal)\n    {\n        this-&gt;signals_map.insert(std::make_pair(\"a\", std::forward&lt;T&gt;(signal)));\n    }\n};\n</code></pre>\n\n<p>and last I have a function that deduces <code>SignalCollection</code> type for some <code>Signal</code></p>\n\n<pre><code>template&lt;class T&gt;\nauto&amp; get_collection_for_signal(T&amp;&amp; t)\n{\n    return SignalCollection&lt;T&gt;::Instance();\n}\n</code></pre>\n\n<p>The problem is, that I can't add values to the map of collection. Here is main:</p>\n\n<pre><code>void foo()\n{\n\n}\nvoid main()\n{\n    Signal&lt;void()&gt; sgl = Signal&lt;void()&gt;{}; //Create signal\n    sgl.slot = foo;                       //add slot\n\n    auto&amp; t = get_collection_for_signal(sgl); //Get collection for this signal which is SignalCollection&lt;Signal&lt;void()&gt;&gt;\n\n    t.add(sgl); //error 1\n    t.signals_map[\"a\"] = sgl; //error 2\n}\n</code></pre>\n"}, {"tags": ["c++", "node.js", "c++11", "v8", "node.js-addon"], "answers": [{"comments": [{"owner": {"reputation": 224, "user_id": 507662, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d4261ca820fe2cfbac8865f48b4dc6ee?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/507662/michael"}, "edited": false, "score": 0, "creation_date": 1552576981, "post_id": 55149834, "comment_id": 97071705, "body": "This is super helpful. Thank you!"}, {"owner": {"reputation": 224, "user_id": 507662, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d4261ca820fe2cfbac8865f48b4dc6ee?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/507662/michael"}, "edited": false, "score": 0, "creation_date": 1552577884, "post_id": 55149834, "comment_id": 97072388, "body": "I think the part I&#39;m fuzzy on is how to signal its result to the main thread? Do you know if there&#39;s a way to do this with V8? I&#39;m assuming I spawn an AsyncWorker at this point, but I&#39;m unsure how to do this without another entrypoint into my C++ code from js"}, {"owner": {"reputation": 18838, "user_id": 6036428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b632c15ba23e78e466c8d33d657378fe?s=128&d=identicon&r=PG&f=1", "display_name": "jmrk", "link": "https://stackoverflow.com/users/6036428/jmrk"}, "reply_to_user": {"reputation": 224, "user_id": 507662, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d4261ca820fe2cfbac8865f48b4dc6ee?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/507662/michael"}, "edited": false, "score": 0, "creation_date": 1552582489, "post_id": 55149834, "comment_id": 97075463, "body": "V8 is not involved in the cross-thread stuff at all. Store the callback on the main thread. The main thread should have some sort of main loop / &quot;event loop&quot; where it waits for requests from JavaScript, and/or from timers, and that&#39;s where it should also check whether any background thread has indicated that it has completed its task."}, {"owner": {"reputation": 224, "user_id": 507662, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d4261ca820fe2cfbac8865f48b4dc6ee?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/507662/michael"}, "edited": false, "score": 0, "creation_date": 1552674575, "post_id": 55149834, "comment_id": 97115585, "body": "Figured it out, I had to spawn an AsyncWorker in V8 (using NAN). This allowed me to use a callback I had passed into the function to execute the next steps. Thank you for your help, this got me on the right path!"}], "tags": [], "owner": {"reputation": 18838, "user_id": 6036428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b632c15ba23e78e466c8d33d657378fe?s=128&d=identicon&r=PG&f=1", "display_name": "jmrk", "link": "https://stackoverflow.com/users/6036428/jmrk"}, "is_accepted": true, "score": 1, "last_activity_date": 1552505222, "creation_date": 1552505222, "answer_id": 55149834, "question_id": 55148342, "link": "https://stackoverflow.com/questions/55148342/blocking-calls-in-a-node-js-addon/55149834#55149834", "title": "Blocking calls in a Node.js Addon", "body": "<p>I have not solved a similar problem before, but the general way I would go about it is:</p>\n\n<ul>\n<li>let the JavaScript code be oblivious of the threading</li>\n<li>expose a function <code>getMeasurements(callback)</code> to JavaScript, implemented in C++</li>\n<li>when the function is called, it gets itself a thread (either newly created, or from the pool) and instructs it to do the blocking external call; when that call is completed the thread signals its result to the main thread, which invokes the <code>callback</code> with it.</li>\n<li>that way all communication with JavaScript code (i.e. all interaction with V8) happens on the main thread, and you only use background threads for the blocking calls.</li>\n</ul>\n\n<p>I hope this helps!</p>\n"}], "owner": {"reputation": 224, "user_id": 507662, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d4261ca820fe2cfbac8865f48b4dc6ee?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/507662/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 55149834, "answer_count": 1, "score": 0, "last_activity_date": 1559936531, "creation_date": 1552499529, "last_edit_date": 1559936531, "question_id": 55148342, "link": "https://stackoverflow.com/questions/55148342/blocking-calls-in-a-node-js-addon", "title": "Blocking calls in a Node.js Addon", "body": "<p>I'm developing a Node.js application that incorporates a Windows DLL. The DLL manages scientific equipment, for context.</p>\n\n<p>My interface from Node to the DLL is going well, however the DLL has some non-deterministic calls that depend on the network topology and RF signals in the room. These calls can take anywhere from 10 seconds to 10 minutes.</p>\n\n<p>I'd like to get these calls off Node's event loop, and even avoid AsyncWorkers. I'd like to put them in their own C++ threads. I'm worried that I don't know enough Node/V8 to approach the problem correctly, though I've attempted twice now.</p>\n\n<p>Below is my attempt at spawning a thread to call a js callback, though I'm not sure if this is a good approach. I need the result of the call, and what I have so far is a 'daemon' in my node app that checks on a regular interval to retrieve results for completed tasks.</p>\n\n<p><code>mTp</code> in the snippet below is a threadpool implementation I've written. Runtask takes a C++ lambda as a parameter to be pushed onto my worker thread queue. mThreadStatus is a map from my thread 'handle', which is a string, to thread_status_t enum. mThreadResults is another map from the thread handle to a v8::Value that gets returned by the callback.</p>\n\n<pre><code>void\nMyObj::SpawnThread(functionInput info) {\n    MyObj* obj = ObjectWrap::Unwrap&lt;MyObj&gt;(info.Holder());      \n    obj-&gt;mTp.RunTask([&amp;]() {\n        v8::Isolate::CreateParams cp;\n        v8::Isolate* tpIsolate = v8::Isolate::New(cp);\n        v8::Locker locker(tpIsolate);\n        v8::Isolate::Scope isolateScope(tpIsolate);\n\n        Nan::HandleScope scope;\n\n        auto global = obj-&gt;mContext.Get(tpIsolate)-&gt;Global();\n\n        auto handle = std::string(*v8::String::Utf8Value(info[0]-&gt;ToString()));\n\n        {\n            std::unique_lock&lt;std::shared_mutex&gt; lock(obj-&gt;mThreadStatusMutex);\n            obj-&gt;mThreadStatus[handle] = thread_status_t::running;\n        }\n\n        v8::Handle&lt;v8::Function&gt; f = v8::Handle&lt;v8::Function&gt;::Cast(info[1]);\n        v8::TryCatch trycatch(tpIsolate);\n        v8::Handle&lt;v8::Value&gt; result = f-&gt;Call(global, 0, nullptr);\n        if (result.IsEmpty()) {\n            v8::Local&lt;v8::Value&gt; exception = trycatch.Exception();\n            std::unique_lock&lt;std::shared_mutex&gt; lock(obj-&gt;mThreadStatusMutex);\n            obj-&gt;mThreadStatus[handle] = thread_status_t::error;\n            return;\n        }\n\n        {\n            std::unique_lock&lt;std::shared_mutex&gt; resultLock(obj-&gt;mThreadResultsMutex);\n            obj-&gt;mThreadResults[handle] = result;\n        }\n\n        std::unique_lock&lt;std::shared_mutex&gt; lock(obj-&gt;mThreadStatusMutex);\n        obj-&gt;mThreadStatus[handle] = completed;\n\n        tpIsolate-&gt;Dispose();\n    });\n</code></pre>\n\n<p>I'm envisioning my js looking like this to spawn a thread:</p>\n\n<pre><code>var ctx = this\nthis.myObj.spawnThread('startMeasurements', () =&gt; {\n    return ctx.myObj.startMeasurements()\n})\n</code></pre>\n\n<p>And like this to get the result, in my 'daemon':</p>\n\n<pre><code>var status = this.myObj.getThreadStatus('startMeasurements')\nif ( status === 'complete') {\n    // Publish returned information to front-end\n}\nelse if (status === 'error') {\n    // Handle error\n}\n</code></pre>\n\n<p>Has anyone solved this problem before? Does this look like a decent approach? Help with v8 is greatly appreciated. Thank you!</p>\n"}, {"tags": ["c++", "unreal-engine4"], "answers": [{"tags": [], "owner": {"reputation": 9371, "user_id": 196964, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/df6zG.jpg?s=128&g=1", "display_name": "Doug Richardson", "link": "https://stackoverflow.com/users/196964/doug-richardson"}, "is_accepted": false, "score": 1, "last_activity_date": 1552514397, "creation_date": 1552514397, "answer_id": 55151826, "question_id": 55148309, "link": "https://stackoverflow.com/questions/55148309/unreal-engine-how-can-i-create-ustaticmeshcomponent-in-a-loop/55151826#55151826", "title": "Unreal Engine: How can I create UStaticMeshComponent in a loop?", "body": "<p>You used the same name for two different calls to CreateDefaultSubobject.</p>\n\n<p>I ran your code in a new UE4 C++ project and got the following error message:</p>\n\n<blockquote>\n  <p>Fatal error:\n  [File:D:\\Build++UE4\\Sync\\Engine\\Source\\Runtime\\CoreUObject\\Private\\UObject\\UObjectGlobals.cpp]\n  [Line: 3755] Default subobject StaticMeshComponent Sphere already\n  exists for FlowSphere /Script/MyProject.Default__FlowSphere.</p>\n</blockquote>\n\n<p>Also, the code you posted didn't compile.</p>\n\n<pre><code>item.AttachTo(this-&gt;RootComponent);\n</code></pre>\n\n<p>should have been:</p>\n\n<pre><code>item-&gt;AttachTo(this-&gt;RootComponent);\n</code></pre>\n\n<p>and you also needed to include \"Components/StaticMeshComponent.h\". Here is the corrected code:</p>\n\n<pre><code>#include \"FlowSphere.h\"\n#include \"Components/StaticMeshComponent.h\"\n\n// Sets default values\nAFlowSphere::AFlowSphere()\n{\n    int32 amount = 100;\n\n    RootComponent = CreateDefaultSubobject&lt;USceneComponent&gt;(\"SceneComponent\");\n\n    for (int32 i = 0; i &lt; amount; i++) {\n\n        FName name = *FString::Printf(TEXT(\"Sphere %i\"), i);\n        UStaticMeshComponent* item = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(name);\n        item-&gt;AttachTo(this-&gt;RootComponent);\n\n    }\n\n    this-&gt;test = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT(\"HELLO\"));\n    PrimaryActorTick.bCanEverTick = true;\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68, "user_id": 6207537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PMA77.jpg?s=128&g=1", "display_name": "Emi Harry", "link": "https://stackoverflow.com/users/6207537/emi-harry"}, "is_accepted": false, "score": 1, "last_activity_date": 1614213758, "creation_date": 1614213758, "answer_id": 66360899, "question_id": 55148309, "link": "https://stackoverflow.com/questions/55148309/unreal-engine-how-can-i-create-ustaticmeshcomponent-in-a-loop/66360899#66360899", "title": "Unreal Engine: How can I create UStaticMeshComponent in a loop?", "body": "<p>So I had to do the same thing recently and ran into a lot of issues but the two major things to fix are:</p>\n<ol>\n<li>use UInstancedStaticMesh instead of UStaticMesh.</li>\n<li>add a property to your static mesh.</li>\n</ol>\n<p>Below is the correct code.</p>\n<pre><code>#include &quot;FlowSphere.h&quot;\n#include &quot;Components/StaticMeshComponent.h&quot;\n#include &quot;UObject/ConstructorHelpers.h&quot;\n\n// Sets default values\nAFlowSphere::AFlowSphere()\n{\n    int32 amount = 100;\n\n    RootComponent = CreateDefaultSubobject&lt;USceneComponent&gt;(&quot;SceneComponent&quot;);\n\n    for (int32 i = 0; i &lt; amount; i++) {\n\n        FName name = *FString::Printf(TEXT(&quot;Sphere %i&quot;), i);\n        FName c_name = *FString::Printf(TEXT(&quot;ChildSceneComponent %i&quot;), i);\n\n        UPROPERTY(EditAnywhere)\n            USceneComponent* ChildSceneComponent\n            = CreateDefaultSubobject&lt;USceneComponent&gt;(c_name);\n\n        // instead of the regular static mesh, create and instance static mesh object with name assigned\n        UInstancedStaticMeshComponent* item = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(name);\n        item-&gt;RegisterComponent();\n\n        // assign property to mesh if not you'll get a static mesh null property error like i did \n        auto MeshAsset = ConstructorHelpers::FObjectFinder&lt;UStaticMesh&gt;(TEXT(&quot;StaticMesh'/Engine/BasicShapes/Sphere.Sphere'&quot;));\n\n        if (MeshAsset.Object != nullptr)\n        {\n            item-&gt;SetStaticMesh(MeshAsset.Object);\n        }\n        item-&gt;SetFlags(RF_Transactional);\n\n        // add instance to actor level\n        this-&gt;AddInstanceComponent(item);\n\n        // make the scene component for the mesh to be visible\n        RootComponent = Root;\n\n        // attach mesh to the scene component of the actor in form of a Hierarchy\n\n        item-&gt;AttachToComponent(ChildSceneComponent, FAttachmentTransformRules::KeepWorldTransform, m_name);\n        ChildSceneComponent-&gt;AttachToComponent(Root, FAttachmentTransformRules::KeepWorldTransform, c_name);\n\n        // set mesh transform based on the ith position\n        FTransform t(FVector(250 * i, i, i));\n\n        // activate the new copy of the mesh\n        Mesh-&gt;AddInstance(t);\n\n        // Offset and scale the child scene from the root scene as a precaution\n        ChildSceneComponent-&gt;SetRelativeTransform(\n            FTransform(FRotator(0, 0, 0),\n                FVector(250 * i, i, i),\n                FVector(0.1f))\n        );\n\n\n    }\n\n\n    PrimaryActorTick.bCanEverTick = true;\n\n}\n\n\n\n    \n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 7121446, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1109069192474617/picture?type=large", "display_name": "Tats", "link": "https://stackoverflow.com/users/7121446/tats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4929, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1614213758, "creation_date": 1552499400, "last_edit_date": 1552499809, "question_id": 55148309, "link": "https://stackoverflow.com/questions/55148309/unreal-engine-how-can-i-create-ustaticmeshcomponent-in-a-loop", "title": "Unreal Engine: How can I create UStaticMeshComponent in a loop?", "body": "<p>I am trying to create multiple <code>UStaticMeshComponent</code> by using for loop but Unreal Engine keeps triggering breakpoint on <code>CreateDefaultSubobject</code> in <code>Object.h</code>(Not in my code, it's from UE4 core API). When I'm creating a single component it's working fine. I am pretty new to UnrealEngine and C++ so I might be doing something dumb but please be easy on that:) </p>\n\n<p>Thank you so much for your help.</p>\n\n<p><strong>Header</strong></p>\n\n<pre><code>#pragma once\n\n#include \"CoreMinimal.h\"\n#include \"GameFramework/Actor.h\"\n#include \"FlowSphere.generated.h\"\n\nUCLASS()\nclass CPP_PRACTICE_3_API AFlowSphere : public AActor\n{\n    GENERATED_BODY()\n\npublic: \n    // Sets default values for this actor's properties\n    AFlowSphere();\n\nprotected:\n    // Called when the game starts or when spawned\n    virtual void BeginPlay() override;\n\npublic: \n    // Called every frame\n    virtual void Tick(float DeltaTime) override;\n\nprivate:\n    //UPROPERTY()\n    //TArray&lt;UStaticMeshComponent*&gt; StaticMeshComponents;\n\n    UStaticMeshComponent* test;\n\n};\n\n</code></pre>\n\n<p><strong>C++</strong></p>\n\n<pre><code>#include \"FlowSphere.h\"\n\n// Sets default values\nAFlowSphere::AFlowSphere()\n{\n    int32 amount = 100;\n\n    RootComponent = CreateDefaultSubobject&lt;USceneComponent&gt;(\"SceneComponent\");\n\n    for (int32 i = 0; i &lt; amount; i++) {\n\n        //WHEN I INCLUDE THE LINE BELOW, UE4 START MAKING BREAKPOINT\n        UStaticMeshComponent* item = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT(\"Sphere\"));\n        item.AttachTo(this-&gt;RootComponent);\n\n    }\n\n    //THIS WORKS FINE\n    this-&gt;test = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT(\"HELLO\")); \n    PrimaryActorTick.bCanEverTick = true;\n\n}\n\n// Called when the game starts or when spawned\nvoid AFlowSphere::BeginPlay()\n{\n    Super::BeginPlay();\n\n}\n\n// Called every frame\nvoid AFlowSphere::Tick(float DeltaTime)\n{\n    Super::Tick(DeltaTime);\n\n}\n</code></pre>\n\n<p><strong>Where it triggering breakpoint on the <code>Object.h</code> from UE4 API</strong></p>\n\n<pre><code>    /**\n    * Create a component or subobject\n    * @param    TReturnType                 class of return type, all overrides must be of this type\n    * @param    SubobjectName               name of the new component\n    * @param    bTransient                  true if the component is being assigned to a transient property. This does not make the component itself transient, but does stop it from inheriting parent defaults\n    */\n    template&lt;class TReturnType&gt;\n    TReturnType* CreateDefaultSubobject(FName SubobjectName, bool bTransient = false)\n    {\n        UClass* ReturnType = TReturnType::StaticClass();\n        return static_cast&lt;TReturnType*&gt;(CreateDefaultSubobject(SubobjectName, ReturnType, ReturnType, /*bIsRequired =*/ true, /*bIsAbstract =*/ false, bTransient));\n    }\n</code></pre>\n"}, {"tags": ["c++", "openmp"], "comments": [{"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 1, "creation_date": 1552647609, "post_id": 55147875, "comment_id": 97099964, "body": "Data placement is a function of the OS not compiler.  It will"}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 1, "creation_date": 1552647668, "post_id": 55147875, "comment_id": 97100000, "body": "Local to the thread which initial"}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 1, "creation_date": 1552647792, "post_id": 55147875, "comment_id": 97100084, "body": "Initializes data.  Given that you don&#39;t modify data each thread will have a cached copy which should minimize problem of remote access."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 1, "creation_date": 1552648005, "post_id": 55147875, "comment_id": 97100219, "body": "Depending somewhat on thread affinity e.g. omp_places which libgomp doesn&#39;t implement for some OS e.g. Windows"}], "answers": [{"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": true, "score": 1, "last_activity_date": 1552501782, "creation_date": 1552501782, "answer_id": 55148970, "question_id": 55147875, "link": "https://stackoverflow.com/questions/55147875/openmp-thread-affinities-with-static-variables/55148970#55148970", "title": "OpenMP thread affinities with static variables", "body": "<p>You have to assume that the thread stack, thread-bound malloc, and thread local storage will allocate to the thread's \"local\" memory - so any auto or new variables should be optimised at least on the thread they were created on, though I don't know which compilers support that kind of allocation model; but as you say, static non-const data can only exist in one location. I guess if the compiler recognises const segments or constructed const segments, then after construction they could be duplicated per zone and then mapped to the same logical address? Again don't know if compilers are doing that automagically.</p>\n\n<p>Non-const statics are going to be troublesome. Presumably these statics are helping to perform some sort of thread synchronisation. If they contain flags that are read often and written rarely then for best performance it may be better for the writer to write to a number of registered copies (one per zone) and each thread uses a thread-local pointer to the appropriate zone copy, than half (or 3/4) the readers are always slow. Of course, that ceases to be a simple atomic write, and a single mutex just puts you back where you started. I suspect this is roll-your-own code land.</p>\n\n<p>The simple case that shouldn't be forgotten: if objects are passed between threads, then potentially a thread could be accessing a non-local object.</p>\n"}], "owner": {"reputation": 461, "user_id": 10431634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4334fb41f1d618dffb8fdb68971f294e?s=128&d=identicon&r=PG&f=1", "display_name": "astrophobia", "link": "https://stackoverflow.com/users/10431634/astrophobia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55148970, "answer_count": 1, "score": 0, "last_activity_date": 1552501782, "creation_date": 1552497857, "question_id": 55147875, "link": "https://stackoverflow.com/questions/55147875/openmp-thread-affinities-with-static-variables", "title": "OpenMP thread affinities with static variables", "body": "<p>I have a C++ class C which contains some code, including a static variable  which is meant to only be read, and perhaps a constexpr static function. For example:</p>\n\n<pre><code>template&lt;std::size_t T&gt;\nclass C {\n   public:\n     //some functions\n     void func1();\n     void func2()\n     static constexpr std::size_t sfunc1(){ return T; }\n\n\n   private:\n     std::size_t var1;\n     std::array&lt;std::size_t,10000&gt; array1;\n     static int svar1;\n\n}\n</code></pre>\n\n<p>The idea is to use the thread affinity mechanisms of openMP 4.5 to control the socket (NUMA architecture) where various instances of this class are executed (and therefore also place it in a memory location close to the socket to avoid using the interconnect between the NUMA nodes). It is my understanding that since this code contains a static variable it is effectively shared between all class instances so I won't have control of the memory location where the static variable will be placed, upon thread creation. Is this correct? But I presume the other non-static variables will be located at memory locations close to the socket being used? Thanks  </p>\n"}, {"tags": ["c++", "pipe", "stdout", "googletest"], "comments": [{"owner": {"reputation": 2333, "user_id": 6783775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d399a7e1545b42ae65bca9b4568099a?s=128&d=identicon&r=PG", "display_name": "rveerd", "link": "https://stackoverflow.com/users/6783775/rveerd"}, "edited": false, "score": 0, "creation_date": 1552578296, "post_id": 55147759, "comment_id": 97072672, "body": "I assume Google Test does some operation on stdout that is allowed when stdout goes to an interactive terminal but not when stdout goes to a file or a pipe. Try running both commands under strace and compare the results. But why do you care?"}, {"owner": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "reply_to_user": {"reputation": 2333, "user_id": 6783775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d399a7e1545b42ae65bca9b4568099a?s=128&d=identicon&r=PG", "display_name": "rveerd", "link": "https://stackoverflow.com/users/6783775/rveerd"}, "edited": false, "score": 0, "creation_date": 1552605619, "post_id": 55147759, "comment_id": 97085852, "body": "@rveerd I just prefer to take the time to understand things that surprise me.  I haven&#39;t used <code>strace</code> before, so I&#39;ll try that.  Thanks!"}], "owner": {"reputation": 325, "user_id": 3023462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2b86eb349bcabd984acb538ced76724?s=128&d=identicon&r=PG&f=1", "display_name": "sasquires", "link": "https://stackoverflow.com/users/3023462/sasquires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552497515, "creation_date": 1552497419, "last_edit_date": 1552497515, "question_id": 55147759, "link": "https://stackoverflow.com/questions/55147759/redirecting-stdout-when-using-google-test-causes-errno-to-be-set", "title": "Redirecting stdout when using Google Test causes errno to be set", "body": "<p>Consider the following code using Google Test.  Note that I have not added any tests at all.</p>\n\n<pre><code>// File main.cpp\n\n#include &lt;gtest/gtest.h&gt;\n\nusing ::testing::InitGoogleTest;\n\nint main( int argc, char* argv[] )\n{\n    InitGoogleTest( &amp;argc, argv );\n    std::cerr &lt;&lt; \"INITIAL ERRNO \" &lt;&lt; errno &lt;&lt; std::endl;\n    int result = RUN_ALL_TESTS();\n    std::cerr &lt;&lt; \"FINAL ERRNO \" &lt;&lt; errno &lt;&lt; std::endl;\n    return result;\n}\n</code></pre>\n\n<p>I can compile this with:</p>\n\n<pre><code>g++ main.cpp -o test -I/path/to/googletest/1.8.0/include/ -lgtest -L/path/to/googletest/1.8.0/lib/\n</code></pre>\n\n<p>(I'm using <code>g++</code> version 6.1.0 and <code>googletest</code> version 1.8.0.)</p>\n\n<p>Executing <code>test</code> gives me</p>\n\n<pre><code>% ./test\nINITIAL ERRNO 0\n[==========] Running 0 tests from 0 test cases.\n[==========] 0 tests from 0 test cases ran. (0 ms total)\n[  PASSED  ] 0 tests.\nFINAL ERRNO 0\n</code></pre>\n\n<p>However, piping the results of this execution into <code>less</code> (or piping to <code>view -</code> or redirecting to a file) gives</p>\n\n<pre><code>% ./test |&amp; less\nINITIAL ERRNO 0\n[==========] Running 0 tests from 0 test cases.\n[==========] 0 tests from 0 test cases ran. (0 ms total)\n[  PASSED  ] 0 tests.\nFINAL ERRNO 22\n</code></pre>\n\n<p>(It appears that the critical redirect here is <code>stdout</code>.  Redirecting <code>stderr</code> alone does not cause a problem.)</p>\n\n<p>On my system, <code>22</code> corresponds to <code>EINVAL</code>.</p>\n\n<p>What is happening here?  I understand that gtest absorbs <code>stdout</code> from the main execution, but it also writes to <code>stdout</code>, so there should be an open pipe from the <code>stdout</code> of <code>test</code> to the <code>stdin</code> of <code>less</code>.  Is there something obvious I'm missing here?</p>\n\n<p>Note: I am writing in C++11, but I occasionally need to use the bare C interface for things that (in C++17 and later) would be handled by <code>std::filesystem</code>, which is how I noticed that <code>errno</code> is being set.  I have heard that setting <code>errno</code> to zero before calling functions that might set it is recommended by some people to prevent these kinds of issues, and I may adopt that practice (depending on the comments I get in response), but I'd still like to understand what's going on here.</p>\n"}, {"tags": ["c++", "callback", "branch", "cplex"], "comments": [{"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552497165, "post_id": 55147584, "comment_id": 97035749, "body": "I see a function, no macro..."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552497206, "post_id": 55147584, "comment_id": 97035777, "body": "You could make your code more self-explanatory and thereby increase your chances, by translating everything to English."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1552497282, "post_id": 55147584, "comment_id": 97035828, "body": "... and it&#39;s not even a complete function. Make it a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552497316, "post_id": 55147584, "comment_id": 97035853, "body": "... and it would benefit from some consistent indentation."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552497663, "post_id": 55147584, "comment_id": 97036071, "body": "@GorAsatryan Your edit is very small, be careful with that. However, I approve because even a small typo (or language-misselection) like that is really distracting in a title."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1552500289, "post_id": 55147584, "comment_id": 97037423, "body": "@Estef&#226;nia Moura When asking question about something as specific as CPLEX, make use of the tags. I added the <code>cplex</code> tag to the question. It will hopefully attract people who knows this framework."}, {"owner": {"reputation": 11, "user_id": 11033484, "user_type": "registered", "profile_image": "https://graph.facebook.com/2478430868853673/picture?type=large", "display_name": "Estef&#226;nia Moura", "link": "https://stackoverflow.com/users/11033484/estef%c3%a2nia-moura"}, "edited": false, "score": 0, "creation_date": 1552607584, "post_id": 55147584, "comment_id": 97086278, "body": "Thanks for the tips! I\u2019m new in here. I will try to do better next time"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11033484, "user_type": "registered", "profile_image": "https://graph.facebook.com/2478430868853673/picture?type=large", "display_name": "Estef&#226;nia Moura", "link": "https://stackoverflow.com/users/11033484/estef%c3%a2nia-moura"}, "edited": false, "score": 0, "creation_date": 1552613602, "post_id": 55152665, "comment_id": 97087532, "body": "I did that and I found out that Makebranch only acepts IloNumVarArray as argument, and my variable it&#39;s a IloNumVarMatrix."}, {"owner": {"reputation": 4187, "user_id": 1718477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iisrz.jpg?s=128&g=1", "display_name": "rkersh", "link": "https://stackoverflow.com/users/1718477/rkersh"}, "reply_to_user": {"reputation": 11, "user_id": 11033484, "user_type": "registered", "profile_image": "https://graph.facebook.com/2478430868853673/picture?type=large", "display_name": "Estef&#226;nia Moura", "link": "https://stackoverflow.com/users/11033484/estef%c3%a2nia-moura"}, "edited": false, "score": 0, "creation_date": 1552679597, "post_id": 55152665, "comment_id": 97117897, "body": "I assume you have the following in your code: <code>typedef IloArray&lt;IloNumVarArray&gt; IloNumVarMatrix</code>. So, <code>X[i]</code> should give you a <code>IloNumVarArray</code>. Is there a reason you can&#39;t work with this?"}], "tags": [], "owner": {"reputation": 4187, "user_id": 1718477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iisrz.jpg?s=128&g=1", "display_name": "rkersh", "link": "https://stackoverflow.com/users/1718477/rkersh"}, "is_accepted": false, "score": 1, "last_activity_date": 1552519654, "creation_date": 1552519654, "answer_id": 55152665, "question_id": 55147584, "link": "https://stackoverflow.com/questions/55147584/how-to-fix-bounds-change-variable-bounds-in-macro-branchcallback-c/55152665#55152665", "title": "How to fix bounds/change variable bounds in macro BranchCallback? C++", "body": "<p>You cannot modify a model while it is being solved (for example, see the <em>Note</em> in the documentation <a href=\"https://www.ibm.com/support/knowledgecenter/SSSA5P_12.9.0/ilog.odms.cplex.help/CPLEX/UsrMan/topics/progr_adv/callbacks_basic/22_cb_interface.html\" rel=\"nofollow noreferrer\">here</a>). As you have found out, this can result in a segfault. Thus, you cannot use the <code>setUB</code> method in your callback.</p>\n\n<p>As you probably know (based on the code you have commented out), you can use the <a href=\"https://www.ibm.com/support/knowledgecenter/SSSA5P_12.9.0/ilog.odms.cplex.help/refcppcplex/html/classes/IloCplex_BranchCallbackI.html#method_makeBranch\" rel=\"nofollow noreferrer\">makeBranch</a> method, which:</p>\n\n<blockquote>\n  <p>instructs the invoking IloCplex object how to create a subnode from\n  the current node by specifying new, tighter bounds for a set of\n  variables.</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 11033484, "user_type": "registered", "profile_image": "https://graph.facebook.com/2478430868853673/picture?type=large", "display_name": "Estef&#226;nia Moura", "link": "https://stackoverflow.com/users/11033484/estef%c3%a2nia-moura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552519654, "creation_date": 1552496854, "last_edit_date": 1552500138, "question_id": 55147584, "link": "https://stackoverflow.com/questions/55147584/how-to-fix-bounds-change-variable-bounds-in-macro-branchcallback-c", "title": "How to fix bounds/change variable bounds in macro BranchCallback? C++", "body": "<p>In the code below I'm trying to create a branch callback using the CPLEX macro <code>ILOBRANCHCALLBACK2</code> where I'm chosing the ways of fixing some varables bounds. But when doing the fixing I'm getting an access violation error when reading some space. Could someone tell me the right way of doing this? Do I have to do the make branch for all the variables or will the branchcallback do it itself?</p>\n\n<pre><code>ILOBRANCHCALLBACK2(simetria, const Instance&amp;, instance, const IloNumVarMatrix&amp;, X) {\n    vector&lt;coordenates&gt; F_zeros;\n    vector&lt;coordenates&gt; F_ones;\n    vector&lt;int&gt; a;\n    a.resize(instance.getNbClients());\n    a[0] = 0;\n    coordenates first;\n    first.x = 0;\n    first.y = 0;\n    F_ones.push_back(first);\n\n    // Je verifie s'il y a deja des variables fix\u00e9es\n    for(int i = 1; i &lt; instance.getNbClients() - 1; ++i) {\n        for(int j = 1; j &lt; instance.getNbVehicles() - 1; ++j) {\n            if(getUB(X[i][j]) &lt;= 0.001) {\n                coordenates obj;\n                obj.x = i;\n                obj.y = j;\n                F_zeros.push_back(obj);\n            }\n\n            if(getLB(X[i][j]) &gt;= 0.99) {\n                coordenates obj;\n                obj.x = i;\n                obj.y = j;\n                F_ones.push_back(obj);\n            }\n        }\n    }\n\n    // Je vais construir mon a.\n    for(int k = 1; k &lt; instance.getNbClients() - 1; k++) {\n        // Zero setting\n        if(a[k - 1] == instance.getNbVehicles() - 1 || findInVector(F_zeros, k, a[k - 1] + 1)) {\n            a[k] = a[k - 1];\n            coordenates obj;\n            obj.x = k;\n            obj.y = a[k - 1];\n\n        } else {\n            a[k] = a[k - 1] + 1;\n            coordenates obj;\n            obj.x = k;\n            obj.y = a[k - 1] + 1;\n        }\n    }\n\n    // Je mets a jour le F_zero a partir de a\n    for(int k = 1; k &lt; instance.getNbClients() - 1; k++) {\n        for(int p = 1; p &lt; instance.getNbVehicles() - 1; p++) {\n            if(p &gt; a[k]) {\n                coordenates obj;\n                obj.x = k;\n                obj.y = p;\n                F_zeros.push_back(obj);\n            }\n        }\n    }\n\n    // je fixe tout ce qui est en  F_zero en zero (Changer les bornnes)\n    for(int i = 0; i &lt; F_zeros.size(); i++) {\n        int a = F_zeros[i].x;\n        int b = F_zeros[i].y;\n        X[a][b].setUB(0);\n        // X[F_zeros[i].x][F_zeros[i].y].setBounds(0, 0);\n        // makeBranch(X[F_zeros[i].x][F_zeros[i].y], 0, IloCplex::BranchUp, getBestObjValue());\n        // makeBranch(X[F_zeros[i].x][F_zeros[i].y], 0, IloCplex::BranchDown, getBestObjValue());\n    }\n</code></pre>\n"}, {"tags": ["c++", "database", "sqlite", "in-memory-database"], "owner": {"reputation": 1031, "user_id": 2563449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/08823daac701d0d77d4c5f35f268fe51?s=128&d=identicon&r=PG", "display_name": "PazO", "link": "https://stackoverflow.com/users/2563449/pazo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1552554959, "creation_date": 1552495513, "last_edit_date": 1552554959, "question_id": 55147113, "link": "https://stackoverflow.com/questions/55147113/sqlite-how-can-i-perform-on-going-incremental-backup-from-an-in-memory-db-to-a", "title": "SQLite - How can I perform on-going incremental backup from an IN-MEMORY db to a file-system db?", "body": "<p>I am working with an IN-MEMORY database.<br>\nWhen my program starts I load data from file-system db into my IN-MEMORY db.<br>\nFrom that point and on I work directly with the IN-MEMORY db.<br>\nThis is in order to achieve high performance.</p>\n\n<p>In addition, I have a requirement that my original file-system db <strong>will be kept updated</strong> every few seconds.</p>\n\n<p>In order to achieve this I was trying to use <a href=\"https://www.sqlite.org/backup.html\" rel=\"nofollow noreferrer\">SQLite Online Backup API</a>. \nThe idea was to have a worker-thread that will save latest modifications every few seconds:</p>\n\n<pre><code>void WorkerThread()\n{\n    // Initialize SQLite online-backup ONCE:\n    p = sqlite3_backup_init(...);\n\n    loop{\n        Sleep(few seconds);\n\n        // Save only intermediate changes (?)\n        sqlite3_backup_step(p, -1); // Backup all modifications from last time\n\n    }  while( program is running);\n\n    // Program is exiting...\n    sqlite3_backup_finish(p);\n}\n</code></pre>\n\n<p>The problem I found was that this API <strong>cannot be used successively</strong>:<br>\nThe first call to <code>sqlite3_backup_step()</code> will save the whole db, but any successive calls after some data was modified will save nothing(!).</p>\n\n<p>My question:<br>\nIs there an <strong>efficient and incremental way</strong> to keep an external file-system db up-to-date with an IN-MEMORY db latest state? <br><br><em>Efficient and incremental</em> in the sense that I can call it every ~n seconds and it will save <strong>only the latest modifications</strong> done from last time it was saved.</p>\n"}, {"tags": ["c++", "openmp", "clion"], "answers": [{"comments": [{"owner": {"reputation": 730, "user_id": 9815708, "user_type": "registered", "profile_image": "https://graph.facebook.com/872534512905210/picture?type=large", "display_name": "Marine Galantin", "link": "https://stackoverflow.com/users/9815708/marine-galantin"}, "edited": false, "score": 0, "creation_date": 1602943710, "post_id": 55147365, "comment_id": 113882279, "body": "same answer as here : <a href=\"https://stackoverflow.com/questions/12399422/how-to-set-linker-flags-for-openmp-in-cmakes-try-compile-function/12404666#12404666\" title=\"how to set linker flags for openmp in cmakes try compile function\">stackoverflow.com/questions/12399422/&hellip;</a>"}, {"owner": {"reputation": 758, "user_id": 6203350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tHrBB.jpg?s=128&g=1", "display_name": "asendjasni", "link": "https://stackoverflow.com/users/6203350/asendjasni"}, "reply_to_user": {"reputation": 730, "user_id": 9815708, "user_type": "registered", "profile_image": "https://graph.facebook.com/872534512905210/picture?type=large", "display_name": "Marine Galantin", "link": "https://stackoverflow.com/users/9815708/marine-galantin"}, "edited": false, "score": 0, "creation_date": 1603001053, "post_id": 55147365, "comment_id": 113894147, "body": "@MarineGalantin Here, it&#39;s rather a recommendation than an answer."}], "tags": [], "owner": {"reputation": 758, "user_id": 6203350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tHrBB.jpg?s=128&g=1", "display_name": "asendjasni", "link": "https://stackoverflow.com/users/6203350/asendjasni"}, "is_accepted": false, "score": 0, "last_activity_date": 1552498356, "last_edit_date": 1552498356, "creation_date": 1552496137, "answer_id": 55147365, "question_id": 55147037, "link": "https://stackoverflow.com/questions/55147037/compiling-program-with-openmp-with-clion-on-windows/55147365#55147365", "title": "Compiling program with openMP with CLION on Windows", "body": "<p><strong>CLion</strong> uses <strong>CMake</strong> as a build system, <strong>OpenMP</strong> support was drastically improved in <strong>CMake 3.9+</strong>. Now, you need to configure your <strong>CMakeLists.txt</strong> file as follow:</p>\n\n<p>For example, consider the example code below.</p>\n\n<h2>OpenMP code</h2>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;omp.h&gt;\n\nint main()\n{\n#pragma omp parallel num_threads(3)\n    {\n        int id = omp_get_thread_num();\n        std::cout &lt;&lt; \"Greetings from process \" &lt;&lt; id &lt;&lt; std::endl;\n    }\n    std::cout &lt;&lt; \"parallel for ends \" &lt;&lt; std::endl;\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<h2>CMakeLists.txt</h2>\n\n<p>The <code>CMakeLists.txt</code> file will be like :</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.9)\nproject(openmp_test) # you can change the project name\n\nfind_package(OpenMP)\n\nadd_executable(openmp_para_test main.cpp)\n\nif(OpenMP_CXX_FOUND)\n    target_link_libraries(openmp_para_test PUBLIC OpenMP::OpenMP_CXX)\nendif()\n</code></pre>\n\n<p>If you are not familiar with CMake, <a href=\"https://www.jetbrains.com/help/clion/quick-cmake-tutorial.html\" rel=\"nofollow noreferrer\">Here a quick CMake tutorial to use with CLion</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 730, "user_id": 9815708, "user_type": "registered", "profile_image": "https://graph.facebook.com/872534512905210/picture?type=large", "display_name": "Marine Galantin", "link": "https://stackoverflow.com/users/9815708/marine-galantin"}, "edited": false, "score": 0, "creation_date": 1602943632, "post_id": 55147421, "comment_id": 113882267, "body": "indeed, the flag <code>-fopenmp</code> shouldn&#39;t be added to parameters, but inside <code>parameter</code>, in <code>build</code>."}], "tags": [], "owner": {"reputation": 1650, "user_id": 2785280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mokc5.jpg?s=128&g=1", "display_name": "Michael Klemm", "link": "https://stackoverflow.com/users/2785280/michael-klemm"}, "is_accepted": false, "score": 1, "last_activity_date": 1552496313, "creation_date": 1552496313, "answer_id": 55147421, "question_id": 55147037, "link": "https://stackoverflow.com/questions/55147037/compiling-program-with-openmp-with-clion-on-windows/55147421#55147421", "title": "Compiling program with openMP with CLION on Windows", "body": "<p>I'm not a user of CLION, but are the <em>Program arguments</em> really the arguments for the compiler for your compiled code?</p>\n\n<p>Usually, when compiling an OpenMP source file, the <code>-fopenmp</code> flag need to be added to both the compiler and linker.  So, for instance:</p>\n\n<pre><code>gcc -fopenmp -c foo.c -o foo.o\ngcc -fopenmp -c bar.c -o bar.o\ngcc -fopenmp -o app.exe foo.o bar.o\n</code></pre>\n\n<p>Or if you comoile and link using just one source file:</p>\n\n<pre><code>gcc -fopenmp -c fooc -o app.exe\n</code></pre>\n\n<p>PS: There's a typo, it should be <code>#pragma omp parallel</code> instead of <code>#pragma omp paraller</code>.</p>\n"}], "owner": {"reputation": 4112, "user_id": 4048191, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/486fef69a96590dd206cbe6e87d5cc2f?s=128&d=identicon&r=PG&f=1", "display_name": "Darlyn", "link": "https://stackoverflow.com/users/4048191/darlyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552498356, "creation_date": 1552495239, "question_id": 55147037, "link": "https://stackoverflow.com/questions/55147037/compiling-program-with-openmp-with-clion-on-windows", "title": "Compiling program with openMP with CLION on Windows", "body": "<p>I have downloaded openMP using cygwin which i use as compiler in CLION.</p>\n\n<p>I have included</p>\n\n<pre><code>#include &lt;omp.h&gt;\n</code></pre>\n\n<p>and used its schemas e.g</p>\n\n<pre><code>#pragma omp paraller\n        #pragma omp single\n</code></pre>\n\n<p>however when i use <code>omp_get_max_threads()</code>  it throws</p>\n\n<blockquote>\n  <p>undefined reference to `omp_get_max_threads'</p>\n</blockquote>\n\n<p>error, i tried to add compiler arguments:\n<a href=\"https://i.stack.imgur.com/qkbZ1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qkbZ1.png\" alt=\"enter image description here\"></a></p>\n\n<p>But the error remains the same. Is there a way how to fix this? Thanks for help.</p>\n"}, {"tags": ["c++", "types", "casting"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 11074577, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DvFnOfXA6uY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPRZzJX9V4FnvIRIPfPwR6j2Keu7Q/mo/photo.jpg?sz=128", "display_name": "GE LO", "link": "https://stackoverflow.com/users/11074577/ge-lo"}, "edited": false, "score": 0, "creation_date": 1552573198, "post_id": 55147149, "comment_id": 97068861, "body": "Thanks for your answer and  advise!! The problem is solved!"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": true, "score": 8, "last_activity_date": 1552500926, "last_edit_date": 1552500926, "creation_date": 1552495587, "answer_id": 55147149, "question_id": 55147007, "link": "https://stackoverflow.com/questions/55147007/c-type-conversion-operator/55147149#55147149", "title": "C++ type conversion operator", "body": "<p>You forgot the <code>const</code> on the <code>double</code> conversion operator:</p>\n\n<pre><code>operator double() const {  // &lt;---------------------------\n        cout &lt;&lt; \"operator double() called\" &lt;&lt; endl;\n        return this-&gt;c;\n    }\n};\n</code></pre>\n\n<p>As in your example <code>a</code> is not <code>const</code>, the double conversion is the best match. If you fix that you get the expected output. </p>\n\n<p><a href=\"https://wandbox.org/permlink/cDmdaAQZdlNqEkmh\" rel=\"nofollow noreferrer\">Live example</a></p>\n\n<p><strong>...some opinion based PS:</strong></p>\n\n<p>I didnt find what the core guidelines say about conversion operators, but if I had to make up a guideline for conversion operators it would be: Avoid them. If you use them, make them <code>explicit</code>. The surprising effects of implicit conversion outweigh the benefits by far. </p>\n\n<p>Just as an example, consider <a href=\"https://en.cppreference.com/w/cpp/utility/bitset\" rel=\"nofollow noreferrer\"><code>std::bitset</code></a>. Instead of offering conversion operators it has <code>to_string</code>, <code>to_ulong</code> and <code>to_ullong</code>. It is better to have your code explicit. <code>A a; double d = a;</code> is a little bit mysterious. I would have to look at the class definition to get an idea of what is really going on. On the other hand <code>A a; double d = a.as_double();</code> can do the exact same thing, but is way more expressive. </p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 7200139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab71a47ac7bc3fc13e3943318577e46?s=128&d=identicon&r=PG&f=1", "display_name": "Dimfred", "link": "https://stackoverflow.com/users/7200139/dimfred"}, "is_accepted": false, "score": 1, "last_activity_date": 1552496315, "creation_date": 1552496315, "answer_id": 55147422, "question_id": 55147007, "link": "https://stackoverflow.com/questions/55147007/c-type-conversion-operator/55147422#55147422", "title": "C++ type conversion operator", "body": "<p>Yea so the problem is, that you made all operators const except for the double operator. I am still a bit surprised because this const just means that the operator call does not modify the class members. Still it seems that only the double operator is called for all 3. I would all 3 op's make const and then it will work properly. </p>\n\n<p>If someone has an explanation why this happens, I would also like to know.\nCheers.</p>\n\n<pre><code>operator char() const { // here is const\n    cout &lt;&lt; \"operator char() called\" &lt;&lt; endl;\n    return this-&gt;a;\n}\n\noperator int() const { // here is const\n    cout &lt;&lt; \"operator int() called\" &lt;&lt; endl;\n    return this-&gt;b;\n}\n\noperator double() { // here is no const\n    cout &lt;&lt; \"operator double() called\" &lt;&lt; endl;\n    return this-&gt;c;\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 11074577, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DvFnOfXA6uY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPRZzJX9V4FnvIRIPfPwR6j2Keu7Q/mo/photo.jpg?sz=128", "display_name": "GE LO", "link": "https://stackoverflow.com/users/11074577/ge-lo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1227, "favorite_count": 0, "accepted_answer_id": 55147149, "answer_count": 2, "score": 7, "last_activity_date": 1552501554, "creation_date": 1552495144, "last_edit_date": 1552501554, "question_id": 55147007, "link": "https://stackoverflow.com/questions/55147007/c-type-conversion-operator", "title": "C++ type conversion operator", "body": "<p>I am studying operator overloading, there are some parts that are difficult to understand.</p>\n\n<p>See this example code.</p>\n\n<pre><code>class A {\n    private:\n    char a;\n    int b;\n    double c;\n\npublic:\nA(char _a = 'a', int _b = 99, double _c = 1.618) :a(_a), b(_b), c(_c){\n}\n\npublic:\n    operator char() const {\n        cout &lt;&lt; \"operator char() called\" &lt;&lt; endl;\n        return this-&gt;a;\n    }\n\noperator int() const {\n        cout &lt;&lt; \"operator int() called\" &lt;&lt; endl;\n        return this-&gt;b;\n    }\n\noperator double() {\n        cout &lt;&lt; \"operator double() called\" &lt;&lt; endl;\n        return this-&gt;c;\n    }\n};\nint main(void) {\n    A a;\n    char b = a;\n    int c = a;\n    double d = a;\n\n    printf(\"%c\\n\", b);\n    printf(\"%d\\n\", c);\n    printf(\"%f\\n\", d);\n\n    return 0;\n}\n</code></pre>\n\n<p>I made this code to test for type conversion operator and expected that the appropriate function would be called for each type of data.</p>\n\n<p>But the result is..</p>\n\n<pre><code>operator double() called\noperator double() called\noperator double() called\n    &lt;-- strange character is gone on board!\n1\n1.618000\n</code></pre>\n\n<p>I can not understand why the results are not as follows.</p>\n\n<pre><code>operator char() called\noperator int() called\noperator double() called\na\n99\n1.618\n</code></pre>\n\n<p>Why is double operator called when converting to char and int?</p>\n\n<p>Have a good day! :)</p>\n"}, {"tags": ["c++", "qt", "c++11", "qdatastream"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 5655424, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-sV-5bLj9Z2c/AAAAAAAAAAI/AAAAAAAAAFU/Mevqt1Jag-A/photo.jpg?sz=128", "display_name": "Lilo", "link": "https://stackoverflow.com/users/5655424/lilo"}, "edited": false, "score": 0, "creation_date": 1552556775, "post_id": 55149308, "comment_id": 97057764, "body": "Oh yes, your are right. I simply didn&#39;t stumble upon that. Thank you, for opening my eyes."}], "tags": [], "owner": {"reputation": 17562, "user_id": 568635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25f0758867b3f251cfdf101b9611b9b5?s=128&d=identicon&r=PG", "display_name": "Eelke", "link": "https://stackoverflow.com/users/568635/eelke"}, "is_accepted": true, "score": 1, "last_activity_date": 1552503084, "creation_date": 1552503084, "answer_id": 55149308, "question_id": 55146979, "link": "https://stackoverflow.com/questions/55146979/qdatastream-empty-after-call-of-qdatastreamwriterawdata/55149308#55149308", "title": "QDataStream empty after call of QDataStream::writeRawData", "body": "<p>The problem is not that there is no data but that your current position is at the end of the data. Use <code>device()</code> to retrieve the <code>QBuffer</code> which it used to wrap your <code>QByteArray</code> and reset the position of that object.</p>\n\n<pre><code>mStream.device()-&gt;reset()\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 5655424, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-sV-5bLj9Z2c/AAAAAAAAAAI/AAAAAAAAAFU/Mevqt1Jag-A/photo.jpg?sz=128", "display_name": "Lilo", "link": "https://stackoverflow.com/users/5655424/lilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 55149308, "answer_count": 1, "score": 2, "last_activity_date": 1552503084, "creation_date": 1552495060, "last_edit_date": 1552495386, "question_id": 55146979, "link": "https://stackoverflow.com/questions/55146979/qdatastream-empty-after-call-of-qdatastreamwriterawdata", "title": "QDataStream empty after call of QDataStream::writeRawData", "body": "<p>I have a rather odd problem, using <code>QDataStream</code>, or at least it is odd to me, because I don't understand the behavior at all.</p>\n\n<p>Of course my problem is from a big project, but I managed to reproduce that odd behavior with a minimal example, which I'll describe now.</p>\n\n<p>I have two classes</p>\n\n<ol>\n<li>a binary data reader <code>Reader</code> and</li>\n<li>a binary data parser <code>Parser</code>.</li>\n</ol>\n\n<p>The <code>Reader</code> reads data via a <code>QTcpSocket</code>, packs each received data chunk into a <code>QByteArray</code> and sends that array via Qt signal to <code>Parser</code>.</p>\n\n<p>The <code>Parser</code> writes all received data chunks to its own <code>QDataStream</code> and shall parse packets from that stream afterwards.</p>\n\n<p>The problem arises, when <code>Parser</code> writes the data from the received <code>QByteArray</code> to its <code>QDataStream</code>. The return value of <code>QDataStream::writeRawData</code> correctly returns the number of bytes written, but then <code>QDataStream::atEnd</code> returns <code>true</code> and <code>QDataStream::device.bytesAvailable</code> returns zero.</p>\n\n<p>Why? <strong>Where is the data <code>QDataStream::writeRawData</code> claims to have written?</strong></p>\n\n<p>You can find the code at the and of this post.</p>\n\n<p><strong>Environment:</strong> Qt 5.9.1 (MSVC 2015, 32/64 bit) on Windows 7 Enterprise SP1 64 bit</p>\n\n<hr>\n\n<p><strong>Reader.h</strong></p>\n\n<pre><code>#ifndef READER_H\n#define READER_H\n\n#include &lt;QAbstractSocket&gt;\n#include &lt;QByteArray&gt;\n#include &lt;QDataStream&gt;\n#include &lt;QHostAddress&gt;\n#include &lt;QObject&gt;\n\nclass Reader : public QObject\n{\n    Q_OBJECT\n\npublic:\n    Reader(const QHostAddress ip, quint16 port);\n    virtual ~Reader();\n\nsignals:\n    void signalNewData(const QByteArray data);\n\nprivate slots:\n    void slotOnReadyRead();\n\nprivate:\n    QAbstractSocket *mSocket;\n    QDataStream mStream;\n};\n\n#endif // READER_H\n</code></pre>\n\n<p><strong>Reader.cpp</strong></p>\n\n<pre><code>#include \"reader.h\"\n\n#include &lt;QTcpSocket&gt;\n\nReader::Reader(const QHostAddress ip, quint16 port)\n    : mSocket(new QTcpSocket(this))\n    , mStream()\n{\n    mStream.setDevice(mSocket);\n    mStream.setVersion(QDataStream::Qt_5_9);\n    mStream.setByteOrder(QDataStream::LittleEndian);\n\n    connect(mSocket, &amp;QIODevice::readyRead, this, &amp;Reader::slotOnReadyRead);\n\n    mSocket-&gt;connectToHost(ip, port, QIODevice::ReadOnly);\n}\n\nReader::~Reader()\n{\n    mSocket-&gt;disconnectFromHost();\n    delete mSocket;\n    mSocket = nullptr;\n}\n\nvoid Reader::slotOnReadyRead()\n{\n    mStream.startTransaction();\n\n    quint64 availableBytesForReading = mStream.device()-&gt;bytesAvailable();\n    QByteArray binaryDataBlock;\n    char *tmp = new char[availableBytesForReading];\n    mStream.readRawData(tmp, availableBytesForReading);\n    binaryDataBlock.append(tmp, availableBytesForReading);\n    delete[] tmp;\n    tmp = nullptr;\n\n    if (mStream.commitTransaction())\n    {\n        emit signalNewData(binaryDataBlock);\n    }\n}\n</code></pre>\n\n<p><strong>Parser.h</strong></p>\n\n<pre><code>#ifndef PARSER_H\n#define PARSER_H\n\n#include &lt;QByteArray&gt;\n#include &lt;QDataStream&gt;\n#include &lt;QObject&gt;\n\nclass Parser : public QObject\n{\n    Q_OBJECT\n\npublic:\n    Parser();\n\npublic slots:\n    void slotOnNewData(const QByteArray data);\n\nprivate:\n    QDataStream mStream;\n};\n\n#endif // PARSER_H\n</code></pre>\n\n<p><strong>Parser.cpp</strong></p>\n\n<pre><code>#include \"parser.h\"\n#include &lt;QDebug&gt;\n\nParser::Parser()\n    : mStream(new QByteArray(), QIODevice::ReadWrite)\n{\n    mStream.setVersion(QDataStream::Qt_5_9);\n    mStream.setByteOrder(QDataStream::LittleEndian);\n}\n\nvoid Parser::slotOnNewData(const QByteArray data)\n{\n    const char *tmp = data.constData();\n    int numberOfBytesWritten = mStream.writeRawData(tmp, data.length());\n\n    qDebug() &lt;&lt; \"numberOfBytesWritten:\" &lt;&lt; numberOfBytesWritten &lt;&lt; endl;\n    qDebug() &lt;&lt; \"QDataStream::status():\" &lt;&lt; mStream.status() &lt;&lt; endl;\n    qDebug() &lt;&lt; \"QDataStream::atEnd():\" &lt;&lt; mStream.atEnd() &lt;&lt; endl;\n    qDebug() &lt;&lt; \"QDataStream::device.bytesAvailable():\" &lt;&lt; mStream.device()-&gt;bytesAvailable() &lt;&lt; endl;\n}\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;QCoreApplication&gt;\n#include \"reader.h\"\n#include \"parser.h\"\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication a(argc, argv);\n\n    Reader *reader = new Reader(QHostAddress(\"&lt;insert IP&gt;\"), &lt;insertPort&gt;);\n    Parser *parser = new Parser();\n\n    QObject::connect(&amp;a, &amp;QCoreApplication::aboutToQuit, reader, &amp;QObject::deleteLater);\n    QObject::connect(&amp;a, &amp;QCoreApplication::aboutToQuit, parser, &amp;QObject::deleteLater);\n\n    QObject::connect(reader, &amp;Reader::signalNewData, parser, &amp;Parser::slotOnNewData);\n\n    return a.exec();\n}\n</code></pre>\n\n<p><strong>delete.pro</strong> <em>Yes, I called my minimal example project 'delete' :'D</em></p>\n\n<pre><code>QT += core network\nQT -= gui\n\nCONFIG += c++11\n\nTARGET = delete\nCONFIG += console\nCONFIG -= app_bundle\n\nTEMPLATE = app\n\nSOURCES += main.cpp \\\n    reader.cpp \\\n    parser.cpp\n\n# The following define makes your compiler emit warnings if you use\n# any feature of Qt which as been marked deprecated (the exact warnings\n# depend on your compiler). Please consult the documentation of the\n# deprecated API in order to know how to port your code away from it.\nDEFINES += QT_DEPRECATED_WARNINGS\n\n# You can also make your code fail to compile if you use deprecated APIs.\n# In order to do so, uncomment the following line.\n# You can also select to disable deprecated APIs only up to a certain version of Qt.\n#DEFINES += QT_DISABLE_DEPRECATED_BEFORE=0x060000    # disables all the APIs deprecated before Qt 6.0.0\n\nHEADERS += \\\n    reader.h \\\n    parser.h\n</code></pre>\n"}, {"tags": ["c++", "language-lawyer"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552495218, "post_id": 55146952, "comment_id": 97034560, "body": "That&#39;s a side effect of your own change. But <code>const</code> doesn&#39;t mean that the object <code>rhs</code> will not change over time, it just means that you (accessing <code>rhs</code>) cannot change it."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1552495327, "post_id": 55146952, "comment_id": 97034631, "body": "There\u2019s no \u201dalso\u201d \u2014 <code>*this</code> is the same object as <code>rhs</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 4, "creation_date": 1552495996, "post_id": 55146952, "comment_id": 97035036, "body": "You have a <code>const</code> reference parameter, but not a <code>const</code> object. That means that you&#39;re not allowed to use that reference to change the object. It doesn&#39;t mean that the referred-to object is immutable."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 4, "creation_date": 1552496002, "post_id": 55146952, "comment_id": 97035037, "body": "<code>this</code> is not <code>const</code> and <code>this</code> is the object being operated on. The fact that <code>rhs</code>  is the same as <code>*this</code> is not relevant.  Think of the annoyance it would be if you could not change a value because somewhere else in the program there was a <code>const</code> reference to it. How would this be tracked? The book-keeping required would be insane."}, {"owner": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1552496153, "post_id": 55146952, "comment_id": 97035126, "body": "@molbdnilo Ah, I understand now. Thank you."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 2, "creation_date": 1552496168, "post_id": 55146952, "comment_id": 97035132, "body": "OT.: deleting <code>this-&gt;p</code> and then assigning a copy of <code>*rhs.p</code> while <code>&amp;rhs == this</code> looks like a guarantee to shoot in your own foot for me. ;-) I sometimes saw a previous check for <code>this != &amp;rhs</code> and this example illustrates very nicely why this makes very sense."}, {"owner": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1552496172, "post_id": 55146952, "comment_id": 97035134, "body": "@user4581301 I think you are totally right. Thank you."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1552496314, "post_id": 55146952, "comment_id": 97035219, "body": "@Scheff, yes indeed, that&#39;s undefined behavior."}, {"owner": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1552496446, "post_id": 55146952, "comment_id": 97035303, "body": "@Scheff Yes. I know this code is not good. This is referred to as a bad code in <i>Effective C++ 3rd Edition</i>."}, {"owner": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "edited": false, "score": 0, "creation_date": 1552496482, "post_id": 55146952, "comment_id": 97035325, "body": "Wait. Changing <code>delete p;</code> to <code>delete rhs.p;</code> still works. Why?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1552496594, "post_id": 55146952, "comment_id": 97035394, "body": "You can still <code>delete</code> a const pointer. You aren&#39;t changing the value of the pointer, you are ending the life of what it points to."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1552496597, "post_id": 55146952, "comment_id": 97035398, "body": "@matn because <code>delete p</code> doesn&#39;t change the <code>p</code> - and only <code>p</code> itself is const for const reference. And even if <code>p</code> was a const pointer, you&#39;d still be able to call <code>delete</code> on it."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1552520631, "post_id": 55146952, "comment_id": 97045927, "body": "Its a bug in the Standard. The similar bug exists in the C Standard."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "edited": false, "score": 0, "creation_date": 1552497275, "post_id": 55147568, "comment_id": 97035822, "body": "Is the phrase &quot;but does not change the pointer itself&quot; guaranteed in the standard? As I cited in my question, the standard says <i>delete-expression</i> invalidates the related pointers. Why can we say &quot;To invalidate a pointer never change the value of the pointer&quot;?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "edited": false, "score": 3, "creation_date": 1552497677, "post_id": 55147568, "comment_id": 97036077, "body": "@matn I have not checked the standatd text. But I would be <i>very</i> surprised if it said anything about the pointer itself changing. A pointer is just a variable holding an address of something else, and to change it would require work to be done, and in C++ you don&#39;t pay for what you don&#39;t use/ask for. So, silently paying the cost of changing the bits of the pointer when doing a <code>delete</code> would be <i>very</i> un-C++-like. As far as invalidation goes, that does not require the pointer to change. That just means it&#39;s no longer valid for you to dereference it."}, {"owner": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "edited": false, "score": 0, "creation_date": 1552498415, "post_id": 55147568, "comment_id": 97036467, "body": "Thank you. Your explanation sounds so natural. It seems I&#39;m too paranoid."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1552550508, "post_id": 55147568, "comment_id": 97054218, "body": "<i>does not change the pointer itself</i> Are you sure? <a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.stc#4\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/n4659/basic.stc#4</a> says that the values of pointers become <i>invalid pointer values</i>. If a pointer value was <i>pointed to</i> an object and then became <i>invalid pointer value</i>, how it didn&#39;t change?"}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 3, "last_activity_date": 1552496795, "creation_date": 1552496795, "answer_id": 55147568, "question_id": 55146952, "link": "https://stackoverflow.com/questions/55146952/why-can-delete-operator-be-used-in-const-context/55147568#55147568", "title": "Why can delete operator be used in const context?", "body": "<p>Calling <code>delete</code> on a member pointer frees the memory the pointer <em>points to</em> but does <em>not</em> change the pointer itself. Thus, it does not change the bitwise contents of the object, thus it can be done in a <code>const</code> member.</p>\n\n<p>C++ only cares about bitwise const (of the object the method is invoked on). Not logical const. If no bits in <em>the object</em> change, then all is well - const wise - as far as the C++ language is concerned. It does <em>not</em> matter whether the <em>logical</em> behaviour of the object is changed (for example by changing something member pointers point to). That's not what the compiler checks for.</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "edited": false, "score": 1, "creation_date": 1552500717, "post_id": 55147740, "comment_id": 97037650, "body": "For later reader: the statement &quot;A pointer value becomes invalid when ...&quot; can be found in N4713(C++20) and N4659(C++17) but not in N3092(C++11) or N4140(C++14)."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1552519675, "post_id": 55147740, "comment_id": 97045693, "body": "<i>Note that it is the value that becomes invalid. The pointer still has the same value</i> Wait. Does it become invalid or the pointer has the same value? It can&#39;t be both."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1552522183, "post_id": 55147740, "comment_id": 97046321, "body": "@LanguageLawyer it can be both, and is. The same value that used to be valid is now invalid. It is still the same value. I find it hard to express this unambiguously in English."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1552522364, "post_id": 55147740, "comment_id": 97046368, "body": "@eerorika in a discussion under some CWG issue Mike Miller told that the value of an object could be changed only by a store. Which means that freeing memory generates a store into each pointer pointing into the freed region. Storing invalid pointer value into it."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1552522578, "post_id": 55147740, "comment_id": 97046425, "body": "@LanguageLawyer how did you come to the conclusion that stores are generated into each pointer?"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1552522672, "post_id": 55147740, "comment_id": 97046454, "body": "@eerorika if a value could be changed only by a store and pointer values become invalid when a region of memory is freed, then this invalidation is performed by a store"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1552522706, "post_id": 55147740, "comment_id": 97046464, "body": "@LanguageLawyer but why do you think that the value changed?"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1552522717, "post_id": 55147740, "comment_id": 97046468, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189985/discussion-between-language-lawyer-and-eerorika\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 6, "last_activity_date": 1552498923, "last_edit_date": 1592644375, "creation_date": 1552497324, "answer_id": 55147740, "question_id": 55146952, "link": "https://stackoverflow.com/questions/55146952/why-can-delete-operator-be-used-in-const-context/55147740#55147740", "title": "Why can delete operator be used in const context?", "body": "<blockquote>\n<p>So I think <code>delete p;</code> may change the member <code>p</code> of <code>rhs</code> though <code>rhs</code> is a const reference.</p>\n</blockquote>\n<ol>\n<li><p>No. <code>delete p;</code> doesn't change <code>p</code>. Invalidation is not modification.</p>\n</li>\n<li><p>Regardless, having a const reference to an object (<code>rhs</code>) does not by any means prevent the referred object form being modified. It merely prevents modification through the const reference. In this case we access the object through <code>this</code> which happens to be a pointer to non-const, so modification is allowed.</p>\n</li>\n</ol>\n<blockquote>\n<p>Someone may insist that &quot;to render a pointer invalid is not to change the value of a pointer&quot; but I don't find such a statement in the standard.</p>\n</blockquote>\n<p>The behaviour of delete expression is specified in [expr.delete]. Nowhere in that section does it mention that the operand is modified.</p>\n<p>Becoming invalid is specified like this:</p>\n<blockquote>\n<p>[basic.compound]</p>\n<p>... A pointer value becomes invalid when the storage it denotes reaches the end of its storage duration ...</p>\n</blockquote>\n<p>Note that it is the <strong>value</strong> that becomes invalid. The pointer still has the same value because the pointer was not modified. The value that the pointer had and still has is simply a value that no longer points to an object - it is invalid.</p>\n<hr />\n<blockquote>\n<p>Supplement: I've changed <code>delete p;</code> to <code>delete rhs.p;</code>, but it still works. Why?</p>\n</blockquote>\n<p>Answer 2. From previous question no longer applies, but answer 1. does. <code>delete rhs.p;</code> does not modify <code>rhs.p</code>.</p>\n"}], "owner": {"reputation": 117, "user_id": 10900307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcbb0be16aea1e8d1c83c6afd28325b?s=128&d=identicon&r=PG&f=1", "display_name": "matn", "link": "https://stackoverflow.com/users/10900307/matn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 55147740, "answer_count": 2, "score": 6, "last_activity_date": 1552498923, "creation_date": 1552494966, "last_edit_date": 1552498645, "question_id": 55146952, "link": "https://stackoverflow.com/questions/55146952/why-can-delete-operator-be-used-in-const-context", "title": "Why can delete operator be used in const context?", "body": "<p>This question is different from:</p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/8372456/is-a-destructor-considered-a-const-function\">Is a destructor considered a const function?</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/19327785/new-expression-and-delete-expression-on-const-reference-and-const-pointer\">new-expression and delete-expression on const reference and const pointer</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/755196/deleting-a-pointer-to-const-t-const\">Deleting a pointer to const (T const*)</a></p></li>\n</ul>\n\n<hr>\n\n<p>I wrote a class <code>Test</code> like this.</p>\n\n<pre><code>class Test {\n\n    private:\n\n        int *p;\n\n    public:\n\n        //constructor\n        Test(int i) {\n            p = new int(i);\n        }\n\n        Test &amp; operator = (const Test &amp;rhs) {\n            delete p;\n            p = new int(*(rhs.p));\n            return *this;\n        }\n\n};\n</code></pre>\n\n<p>When the parameter <code>rhs</code> of the operator function is itself (i.e. <code>Test t(3); t = t;</code>), <code>delete p;</code> also changes the pointer <code>p</code> <strong>of <code>rhs</code></strong>. Why is this allowed? </p>\n\n<p>C++ standard (N3092, \"<em>3.7.4.2 Deallocation functions</em>\") says</p>\n\n<blockquote>\n  <p>If the argument given to a deallocation function in the standard library is a pointer that is not the null pointer value (4.10), the deallocation function shall deallocate the storage referenced by the pointer, <strong>rendering invalid all pointers</strong> referring to any part of the deallocated storage. The effect of using an invalid pointer value (including passing it to a deallocation function) is undefined.</p>\n</blockquote>\n\n<p>(Note: <em>delete-expression</em> internally calls a deallocation function. So this excerpt is related with <code>delete</code> operator.)</p>\n\n<p>So I think <code>delete p;</code> may change the member <code>p</code> of <code>rhs</code> though <code>rhs</code> is a const reference. </p>\n\n<p>Someone may insist that \"to render a pointer invalid is <strong>not</strong> to change the value of a pointer\" but I don't find such a statement in the standard. I doubt there is a possibility that the address pointed by <code>rhs</code>'s <code>p</code> has been changed after <code>delete p;</code> in <code>operator =</code>(*).</p>\n\n<p>(*): Whether or not this situation can be reproduced on popular compilers doesn't matter. I want a theoretical guarantee. </p>\n\n<hr>\n\n<p>Supplement:</p>\n\n<p>I've changed <code>delete p;</code> to <code>delete rhs.p;</code>, but it still works. Why?</p>\n\n<p>Full code here:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Test {\n\n    private:\n\n        int *p;\n\n        //print the address of a pointer\n        void print_address() const {\n            std::cout &lt;&lt; \"p: \" &lt;&lt; p &lt;&lt; \"\\n\";\n        }\n\n    public:\n\n        //constructor\n        Test(int i) {\n            p = new int(i);\n        }\n\n        Test &amp; operator = (const Test &amp;rhs) {\n\n            print_address(); //=&gt; output1\n            delete rhs.p;\n            print_address(); //=&gt; output2\n\n            p = new int(*(rhs.p));\n            return *this;\n\n        }\n\n};\n\nint main() {\n\n    Test t(3);\n    t = t;\n\n}\n</code></pre>\n\n<p>In this case, it is guaranteed that <code>p</code> is invalidated. But who guarantees <code>invalidate != (change the value)</code>? i.e. Does the standard guarantee that <code>output1</code> and <code>output2</code> are the same?</p>\n"}, {"tags": ["c++", "mfc", "visual-studio-debugging"], "answers": [{"tags": [], "owner": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "is_accepted": false, "score": 1, "last_activity_date": 1552499884, "creation_date": 1552499884, "answer_id": 55148436, "question_id": 55146931, "link": "https://stackoverflow.com/questions/55146931/how-can-i-debug-mfc-container-properly-with-visual-studio-2015/55148436#55148436", "title": "How can i debug MFC container properly with visual studio 2015", "body": "<p>You must create a custom <a href=\"https://docs.microsoft.com/en-us/visualstudio/debugger/create-custom-views-of-native-objects?view=vs-2015\" rel=\"nofollow noreferrer\">natvis</a> debugger visualizer.</p>\n"}], "owner": {"reputation": 11, "user_id": 11198410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71a78b851c0138a15fed95e769d4b134?s=128&d=identicon&r=PG&f=1", "display_name": "NoTo", "link": "https://stackoverflow.com/users/11198410/noto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552499884, "creation_date": 1552494920, "question_id": 55146931, "link": "https://stackoverflow.com/questions/55146931/how-can-i-debug-mfc-container-properly-with-visual-studio-2015", "title": "How can i debug MFC container properly with visual studio 2015", "body": "<p>i am using visual studio 2015 in large legacy project,\nbut when i try to debug a MFC container like CMap, CArray\ni cannot succeed to see which elements the container has.</p>\n\n<p>the only way that i can do it is to assign it to variable and watch the variable in specific key.</p>\n\n<p>every time doing it it consume a lot of time of compiling and restart the tool.</p>\n\n<p>is there a way to overcome this?</p>\n\n<p>Many thanks\nNoto</p>\n"}, {"tags": ["c++", "opencv", "opengl", "computer-vision", "augmented-reality"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1552495227, "post_id": 55146916, "comment_id": 97034571, "body": "just check the <a href=\"https://docs.opencv.org/master/df/db4/classcv_1_1xfeatures2d_1_1FREAK.html\" rel=\"nofollow noreferrer\">doc</a>:  <code>cv::xfeatures2d::FREAK</code>"}, {"owner": {"reputation": 69, "user_id": 8461256, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203632326725304/picture?type=large", "display_name": "Mohammad Albardaweel", "link": "https://stackoverflow.com/users/8461256/mohammad-albardaweel"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1552495672, "post_id": 55146916, "comment_id": 97034845, "body": "I have tried to change it to what you have written, but again I found this error:     \u2018FREAK\u2019 is not a member of \u2018cv::xfeatures2d\u2019"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 1, "creation_date": 1552495693, "post_id": 55146916, "comment_id": 97034858, "body": "have you compiled opencv with contrib modules?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1552495733, "post_id": 55146916, "comment_id": 97034880, "body": "Also, do you have the right version of OpenCV? Did you include the appropriate header file?"}, {"owner": {"reputation": 69, "user_id": 8461256, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203632326725304/picture?type=large", "display_name": "Mohammad Albardaweel", "link": "https://stackoverflow.com/users/8461256/mohammad-albardaweel"}, "edited": false, "score": 0, "creation_date": 1552495823, "post_id": 55146916, "comment_id": 97034928, "body": "Yes, I have compiled with the following headers:     #include &lt;opencv2/opencv.hpp&gt;     #include &lt;opencv2/features2d.hpp&gt;     #include &lt;opencv2/xfeatures2d/nonfree.hpp&gt; and the OpenCV version is 3.4.0"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1552496328, "post_id": 55146916, "comment_id": 97035229, "body": "<code>#include &lt;opencv2&#47;xfeatures2d.hpp&gt;</code>"}, {"owner": {"reputation": 2756, "user_id": 2487730, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/738346725144dd27b32670cc7316ee80?s=128&d=identicon&r=PG", "display_name": "zipzit", "link": "https://stackoverflow.com/users/2487730/zipzit"}, "edited": false, "score": 0, "creation_date": 1552497864, "post_id": 55146916, "comment_id": 97036188, "body": "@MohammadAlbardaweel Possible to share the link to the tutorial?"}], "owner": {"reputation": 69, "user_id": 8461256, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203632326725304/picture?type=large", "display_name": "Mohammad Albardaweel", "link": "https://stackoverflow.com/users/8461256/mohammad-albardaweel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552498575, "creation_date": 1552494854, "last_edit_date": 1552498575, "question_id": 55146916, "link": "https://stackoverflow.com/questions/55146916/freak-is-not-a-member-of-cv", "title": "FREAK is not a member of cv?", "body": "<p>I am trying a code from tutorial to test the marker-less AR experience with OpenCV + OpenGL. But the problem is that when I compiled the code I found out that there is an error with the following segment of code:</p>\n\n<pre><code>cv::Ptr&lt;cv::DescriptorExtractor&gt; extractor = cv::FREAK(false, false), \n</code></pre>\n\n<p>and the error is:</p>\n\n<pre><code>FREAK is not a member of cv.\n</code></pre>\n\n<p>So, can someone tell me why is that happening? I have tried to search for a solution and tried to solve as much as I can but every time I got error.</p>\n"}, {"tags": ["c++", "smart-pointers", "unique-ptr"], "comments": [{"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 2, "creation_date": 1552494714, "post_id": 55146813, "comment_id": 97034288, "body": "You can only have one unique_ptr (one ownership). When you move it, you are passing this ownership forward, so the behind is assigned as nullptr"}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1552494907, "post_id": 55146813, "comment_id": 97034386, "body": "<a href=\"https://stackoverflow.com/questions/8114276/how-do-i-pass-a-unique-ptr-argument-to-a-constructor-or-a-function/8114913\" title=\"how do i pass a unique ptr argument to a constructor or a function\">stackoverflow.com/questions/8114276/&hellip;</a>"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1552494942, "post_id": 55146813, "comment_id": 97034405, "body": "Unfortunately your code has two variables called <code>ctorArg</code> so it&#39;s not completely clear which you are talking about. If you are talking about the second occurance then that is expected behaviour for <code>unique_ptr</code>."}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1552495131, "post_id": 55146813, "comment_id": 97034515, "body": "I have updated the code to use separate variable names, since @Amadeus comment indicated that the original wording of this question was unclear about the behavior it exhibited."}, {"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1552495402, "post_id": 55146813, "comment_id": 97034693, "body": "Declare SomeClass constructor as public. Else code is ok."}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1552495475, "post_id": 55146813, "comment_id": 97034728, "body": "@Mat I fail to see how that link is relevant.  Is my code in any way violating the recommendations?  It appears to me I am 100% compliant with the recommendations in that post, yet the code isn&#39;t working."}, {"owner": {"reputation": 1782, "user_id": 10548514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hky6xOH08T4/AAAAAAAAAAI/AAAAAAAABSM/Tw8IuIniovs/photo.jpg?sz=128", "display_name": "Juan Carlos Ramirez", "link": "https://stackoverflow.com/users/10548514/juan-carlos-ramirez"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1552495554, "post_id": 55146813, "comment_id": 97034777, "body": "From @Mat link, &quot;After newBase is constructed, nextBase is guaranteed to be empty. You don&#39;t own the object, and you don&#39;t even have a pointer to it anymore. It&#39;s gone.  This is ensured because we take the parameter by value. std::move doesn&#39;t actually move anything; it&#39;s just a fancy cast. std::move(nextBase) returns a Base&amp;&amp; that is an r-value reference to nextBase. That&#39;s all it does.&quot;"}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "reply_to_user": {"reputation": 1782, "user_id": 10548514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hky6xOH08T4/AAAAAAAAAAI/AAAAAAAABSM/Tw8IuIniovs/photo.jpg?sz=128", "display_name": "Juan Carlos Ramirez", "link": "https://stackoverflow.com/users/10548514/juan-carlos-ramirez"}, "edited": false, "score": 0, "creation_date": 1552495736, "post_id": 55146813, "comment_id": 97034882, "body": "@JuanCarlosRamirez Yes, I understand that.  But the problem is that the parameter is null by the time it reaches my constructor, NOT that the <code>intPtr</code> variable is null after the call to my constructor.  It appears that <code>std::make_unique</code> is eating the pointer enroute to my constructor.  Is that expected?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1552495797, "post_id": 55146813, "comment_id": 97034913, "body": "@AhmedMasud no, <code>std::unique_ptr&lt;int&gt; intPtr { new int() };</code> creates a dynamic <code>int</code>, and initialises <code>intPtr</code>. Your snippet isn&#39;t valid C++"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1552496359, "post_id": 55146813, "comment_id": 97035251, "body": "Cannot reproduce the issue. Dies the program (<i>not your debugger</i>) behave differently from what you expect? Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1552496533, "post_id": 55146813, "comment_id": 97035355, "body": "@n.m.  You are correct.  This code doesn&#39;t reproduce the issue.  I am looking into what is different in my actual use case so I can get real help.  I think it has something to do with the class I am passing not having a move constructor, but am looking into it.  Standby..."}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "edited": false, "score": 0, "creation_date": 1552500299, "post_id": 55146813, "comment_id": 97037432, "body": "I finally figured it out... it was a field order initialization issue (trying to use the passed <code>ctorArg</code> after it was moved, due to initialization being done in the order of declaration within the class).  I have updated the question to reflect the issue more accurately."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552500968, "post_id": 55146813, "comment_id": 97037789, "body": "Hopefully a lesson in pushing a MCVE up-front!!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552500990, "post_id": 55146813, "comment_id": 97037802, "body": "BTW my compiler has had warnings for this since 1066 AD! Do you have warnings turned off? Why?"}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552502254, "post_id": 55146813, "comment_id": 97038497, "body": "@LightnessRacesinOrbit I just built the above example with the &quot;Warning Level&quot; set to &quot;All&quot; in VS2017u2, and although I got 606 warnings, not one of them was for out-of-order initialization.  Still, your comment made me think of release notes in old English, and I immediately thought of the holy hand grenade user instructions.  Thou shalt not initialize the second declared member variable within a constructor, unless thou immediately preceedith such declaration by initialization of the first declared member variable.  I want a Monty Python C++ user&#39;s guide in the worst way."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552522870, "post_id": 55146813, "comment_id": 97046500, "body": "I suggest warning level 2. Warning level 4 will give you craptons of spam from their own standard library implementation, go figure."}], "answers": [{"comments": [{"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1552496770, "post_id": 55147502, "comment_id": 97035520, "body": "The order issue only applies if the globals are in different source files."}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "edited": false, "score": 0, "creation_date": 1552500387, "post_id": 55147502, "comment_id": 97037473, "body": "@rustyx I have updated the example code so it now <i>actually</i> breaks in the way I was observing."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1552500773, "last_edit_date": 1552500773, "creation_date": 1552496578, "answer_id": 55147502, "question_id": 55146813, "link": "https://stackoverflow.com/questions/55146813/c-smart-pointer-lost-in-stdmake-unique/55147502#55147502", "title": "C++ Smart Pointer Lost in std::make_unique", "body": "<p>The order of <a href=\"https://en.cppreference.com/w/cpp/language/initializer_list\" rel=\"nofollow noreferrer\">member-initializer-list</a> is irrelevant, the members will be initialized in the order of their declaration.</p>\n\n<p>So, first <code>m_Foo(std::move(ctorArg))</code> will zero out <code>ctorArg</code> <strong>then</strong> <code>m_Field(ctorArg-&gt;field)</code> will attempt to derefence an empty <code>ctorArg</code>.</p>\n\n<p>Change your code to:</p>\n\n<pre><code>class SomeClass {\nprivate:\n    std::unique_ptr&lt;foo&gt; m_Foo;\n    int m_Field;\npublic:\n    SomeClass(std::unique_ptr&lt;int&gt; ctorArg)\n        : m_Foo(std::move(ctorArg)), m_Field(m_Foo-&gt;field) {\n    }\n};\n</code></pre>\n\n<p>That is, always mention initializers in the order the fields are declared, and don't use input arguments which have been moved-out from.</p>\n"}], "owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 55147502, "answer_count": 1, "score": 2, "last_activity_date": 1552500773, "creation_date": 1552494568, "last_edit_date": 1552500131, "question_id": 55146813, "link": "https://stackoverflow.com/questions/55146813/c-smart-pointer-lost-in-stdmake-unique", "title": "C++ Smart Pointer Lost in std::make_unique", "body": "<p>I am in the process of converting some legacy code to take advantage of smart pointers in C++.  However, I ran into a runtime issue that I'm struggling to figure out.  I have code such as the following:</p>\n\n<pre><code>struct foo {\n    int field;\n};\n\nclass SomeClass {\nprivate:\n    std::unique_ptr&lt;foo&gt; m_Foo;\n    int m_Field;\npublic:\n    SomeClass(std::unique_ptr&lt;int&gt; ctorArg)\n        : m_Field(ctorArg-&gt;field), m_Foo(std::move(ctorArg)) {\n    }\n};\n\nstd::unique_ptr&lt;foo&gt; fooPtr{ new foo() };\nauto const classInstance{ std::make_unique&lt;SomeClass&gt;(std::move(fooPtr)) };\n</code></pre>\n\n<p>If I put a breakpoint prior to calling the <code>SomeClass</code> constructor, I can verify that <code>fooPtr</code> is not null.  However, once I am within the <code>SomeClass</code> constructor, the application is crashing when trying to initialize <code>m_Field</code>, since <code>ctorArg</code> is null (empty).  Is this expected?  If I change the constructor signature to take <code>std::unique_ptr&lt;int&gt; &amp;&amp;</code>, I see the same issue.  Can someone please explain what the issue is with this code, and how to go about fixing it?</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552494497, "post_id": 55146715, "comment_id": 97034153, "body": "You have missing symbols in your shared library. Check <code>ErrorClientKeeper</code> implementation, as the errors tells you to."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1552494508, "post_id": 55146715, "comment_id": 97034160, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 67, "user_id": 3739187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8695fc5fad44f5d075dea1762a1097ca?s=128&d=identicon&r=PG&f=1", "display_name": "codechao", "link": "https://stackoverflow.com/users/3739187/codechao"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552495226, "post_id": 55146715, "comment_id": 97034568, "body": "You&#39;re saying I should check the ErrorClientKeeper class file?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552495257, "post_id": 55146715, "comment_id": 97034595, "body": "That&#39;s what the error says, yes."}, {"owner": {"reputation": 67, "user_id": 3739187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8695fc5fad44f5d075dea1762a1097ca?s=128&d=identicon&r=PG&f=1", "display_name": "codechao", "link": "https://stackoverflow.com/users/3739187/codechao"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552495418, "post_id": 55146715, "comment_id": 97034698, "body": "I can&#39;t see any error with it. Would it help if I added that to my question? I should be including in the class everything the class needs"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552495567, "post_id": 55146715, "comment_id": 97034786, "body": "part.cpp:(.text+0x88f): undefined reference to `ErrorClientKeeper::addError(ForgeError::Severity, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, bool)&#39;"}, {"owner": {"reputation": 67, "user_id": 3739187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8695fc5fad44f5d075dea1762a1097ca?s=128&d=identicon&r=PG&f=1", "display_name": "codechao", "link": "https://stackoverflow.com/users/3739187/codechao"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552495747, "post_id": 55146715, "comment_id": 97034887, "body": "I saw that. I posted the class file in my question if that helps. I&#39;ve looked over part and part&#39;s use of errorclientkeeper seems to match the file."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552496516, "post_id": 55146715, "comment_id": 97035344, "body": "Are the two compiled with the same compiler? May be a gcc ABI difference if you are using a more recent compiler for your project and the library is using the system gcc."}, {"owner": {"reputation": 67, "user_id": 3739187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8695fc5fad44f5d075dea1762a1097ca?s=128&d=identicon&r=PG&f=1", "display_name": "codechao", "link": "https://stackoverflow.com/users/3739187/codechao"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1552496998, "post_id": 55146715, "comment_id": 97035646, "body": "they should be getting built with the same compiler. They&#39;re all made with one catkin_make command"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1552506896, "post_id": 55146715, "comment_id": 97040756, "body": "You <code>.cpp</code> file defines a <b>global function</b> <code>addError</code>, but the missed symbol is a <b>class method</b> <code>ErrorClientKeeper::addError</code>. They are not interchangeable."}, {"owner": {"reputation": 67, "user_id": 3739187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8695fc5fad44f5d075dea1762a1097ca?s=128&d=identicon&r=PG&f=1", "display_name": "codechao", "link": "https://stackoverflow.com/users/3739187/codechao"}, "edited": false, "score": 0, "creation_date": 1552683032, "post_id": 55146715, "comment_id": 97119347, "body": "ahhh, that must be the issue. either way, I went around the issue, but thank you."}], "owner": {"reputation": 67, "user_id": 3739187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8695fc5fad44f5d075dea1762a1097ca?s=128&d=identicon&r=PG&f=1", "display_name": "codechao", "link": "https://stackoverflow.com/users/3739187/codechao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552495660, "creation_date": 1552494230, "last_edit_date": 1552495660, "question_id": 55146715, "link": "https://stackoverflow.com/questions/55146715/cmake-linker-failing-building-executable-with-static-functions", "title": "CMake Linker failing building executable with static functions", "body": "<p>I'll try to describe this issue the best I can. I'm trying to catkin_make a multi-package c++ project, but I'm getting a couple linker issues when its trying to build executables for 2 of the packages.</p>\n\n<p>The error:</p>\n\n<pre><code>forge/devel/lib/libforge_features.so: undefined reference to `ErrorClientKeeper::addError(ForgeError::Severity, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, bool)'\ncollect2: error: ld returned 1 exit status\nforge_feature_identification/CMakeFiles/feature_identification_service_node.dir/build.make:224: recipe for target '/home/brian-pc/forge/devel/lib/forge_feature_identification/feature_identification_service_node' failed\nmake[2]: *** [/home/brian-pc/forge/devel/lib/forge_feature_identification/feature_identification_service_node] Error 1\nCMakeFiles/Makefile2:8322: recipe for target 'forge_feature_identification/CMakeFiles/feature_identification_service_node.dir/all' failed\nmake[1]: *** [forge_feature_identification/CMakeFiles/feature_identification_service_node.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\nCMakeFiles/part_manager_node.dir/src/part.cpp.o: In function `Part::read(int)':\npart.cpp:(.text+0x88f): undefined reference to `ErrorClientKeeper::addError(ForgeError::Severity, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, bool)'\npart.cpp:(.text+0x102b): undefined reference to `ErrorClientKeeper::addError(ForgeError::Severity, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, bool)'\nCMakeFiles/part_manager_node.dir/src/part.cpp.o: In function `Part::createFromTemplate(int)':\npart.cpp:(.text+0x137d): undefined reference to `ErrorClientKeeper::addError(ForgeError::Severity, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, bool)'\npart.cpp:(.text+0x1a21): undefined reference to `ErrorClientKeeper::addError(ForgeError::Severity, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, bool)'\ncollect2: error: ld returned 1 exit status\nforge_part_manager/CMakeFiles/part_manager_node.dir/build.make:172: recipe for target '/home/brian-pc/forge/devel/lib/forge_part_manager/part_manager_node' failed\nmake[2]: *** [/home/brian-pc/forge/devel/lib/forge_part_manager/part_manager_node] Error 1\nCMakeFiles/Makefile2:9105: recipe for target 'forge_part_manager/CMakeFiles/part_manager_node.dir/all' failed\nmake[1]: *** [forge_part_manager/CMakeFiles/part_manager_node.dir/all] Error 2\nMakefile:140: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>feature_identification_service_node and part_manager_node are the exes its trying to build.\nThe function its trying to reference is a static function is a package called forge_errors declared in file error_client_keeper.h. Here is the header file for that:</p>\n\n<pre><code>#ifndef __ERROR_CLIENT_KEEPER_H_INCLUDED__\n#define __ERROR_CLIENT_KEEPER_H_INCLUDED__\n\n#include &lt;ros/ros.h&gt;\n\n#include &lt;forge_errors/Error.h&gt;\n#include &lt;forge_errors/forge_error.h&gt;\n#include &lt;forge_errors/alert_service.h&gt;\n#include &lt;forge_errors/error_client.h&gt;\n\nclass ErrorClientKeeper\n{\npublic:\n\n  static bool addError(ForgeError err);\n  static bool addError(ForgeError::Severity severity, std::string msg, std::string caller = \"\", bool display = true);\n\nprivate:\n  ErrorClientKeeper();\n  ~ErrorClientKeeper(){};\n\n};\n\n#endif\n</code></pre>\n\n<p>The .cpp file:</p>\n\n<pre><code>#include &lt;forge_errors/error_client_keeper.h&gt;\n\nbool addError(ForgeError err)\n{\n  ros::NodeHandle nh;\n\n  ErrorClient client(nh);\n\n  bool success = client.addError(err);\n\n  ros::spinOnce();\n\n  return success;\n}\nbool addError(ForgeError::Severity severity, std::string msg, std::string caller = \"\", bool display = true)\n{\n  ros::NodeHandle nh;\n\n  ErrorClient client(nh);\n\n  bool success = client.addError(severity, msg, caller, display);\n\n  ros::spinOnce();\n\n  return success;\n}\n</code></pre>\n\n<p>forge error is a class also in the forge_errors package, in forge_error.h</p>\n\n<p>Here's the feature_identification package's cmakelists.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8.3)\nproject(forge_feature_identification)\n\nfind_package(catkin REQUIRED COMPONENTS\n  forge_msgs\n  forge_features\n  roscpp\n  rospy\n  actionlib\n  actionlib_msgs\n)\n\n###################################\n## catkin specific configuration ##\n###################################\n\ncatkin_package(\n CATKIN_DEPENDS\n  forge_msgs\n  forge_features\n  roscpp\n  rospy\n  actionlib\n  actionlib_msgs\n)\n\n###########\n## Build ##\n###########\n\ninclude_directories(\n  include\n  ${catkin_INCLUDE_DIRS}\n)\n\nadd_executable(\n  feature_identification_service_node\n  src/feature_identification_service_node.cpp\n  src/feature_identification_service.cpp\n  src/feature_identifier.cpp\n  src/seam_identifier.cpp\n  src/part_model_identifier.cpp\n)\ntarget_link_libraries(\n  feature_identification_service_node\n  ${catkin_LIBRARIES}\n)\n add_dependencies(\n  feature_identification_service_node\n  ${catkin_EXPORTED_TARGETS}\n)\n\n#############\n## Install ##\n#############\n\n# Mark cpp header files for installation\ninstall(DIRECTORY include/${PROJECT_NAME}/\n  DESTINATION ${CATKIN_PACKAGE_INCLUDE_DESTINATION}\n  FILES_MATCHING PATTERN \"*.h\"\n  PATTERN \".svn\" EXCLUDE\n)\n</code></pre>\n\n<p>Here's part_manager_node's cmakelist.txt</p>\n\n<pre><code>project(forge_part_manager)\n\n## Find catkin macros and libraries\nfind_package(catkin REQUIRED COMPONENTS\n  forge_db_manager\n  forge_utils\n  forge_msgs\n  forge_features\n  forge_feature_identification\n  actionlib\n  roscpp\n  forge_errors\n  rospy\n  std_msgs\n)\n\n###################################\n## catkin specific configuration ##\n###################################\ncatkin_package(\n # INCLUDE_DIRS include\n # LIBRARIES forge_part_manager\n CATKIN_DEPENDS\n  forge_db_manager\n  forge_utils\n  forge_features\n  forge_feature_identification\n  roscpp\n  rospy\n  std_msgs\n  forge_errors\n  actionlib\n#  DEPENDS system_lib\n)\n\n###########\n## Build ##\n###########\ninclude_directories(\n  include\n  ${catkin_INCLUDE_DIRS}\n)\n\nadd_executable(\n  part_manager_node\n  src/part_manager_node.cpp\n  src/part_manager.cpp\n  src/part.cpp\n)\ntarget_link_libraries(\n  part_manager_node\n  ${catkin_LIBRARIES}\n)\n\n#############\n## Install ##\n#############\n</code></pre>\n\n<p>There's more relevant files I can show, but this is already getting pretty long. The forge_features package depends on forge_errors, and the files in it all </p>\n\n<pre><code>#include &lt;forge_errors/error_client_keeper.h&gt;\n#include &lt;forge_errors/forge_error.h&gt;\n</code></pre>\n\n<p>in the header files. And in the cmakelists for forge_features they're listed under find_package and catkin_package( CATKIN_DEPENDS, as well as in the package.xml for build and exec dependencies</p>\n\n<p>part.h also includes those two files.</p>\n\n<p>here's the relevant section of the errors package cmakelists:</p>\n\n<pre><code>catkin_package(\n INCLUDE_DIRS\n  include\n LIBRARIES\n  forge_errors\n CATKIN_DEPENDS\n  forge_msgs\n  forge_db_manager\n  forge_utils\n  roscpp\n)\n\n###########\n## Build ##\n###########\n\ninclude_directories(\n  include\n  ${catkin_INCLUDE_DIRS}\n)\n\nadd_library(\n  forge_errors\n  src/forge_error.cpp\n  src/error_service.cpp\n  src/error_service_node.cpp\n  src/error_client.cpp\n  src/alert_service.cpp\n  src/error_client_keeper.cpp\n)\ntarget_link_libraries(\n  forge_errors\n  ${catkin_LIBRARIES}\n)\nadd_dependencies(\n  forge_errors\n  ${PROJECT_NAME}_generate_messages_cpp\n  ${catkin_EXPORTED_TARGETS}\n)\n\nadd_executable(\n  error_service_node\n  src/error_service_node.cpp\n  src/error_service.cpp\n  src/forge_error.cpp\n  src/alert_service.cpp\n)\ntarget_link_libraries(\n  error_service_node\n  ${catkin_LIBRARIES}\n)\nadd_dependencies(\n  error_service_node\n  ${PROJECT_NAME}_generate_messages_cpp\n  ${catkin_EXPORTED_TARGETS}\n) \n\n#############\n## Install ##\n#############\n\n# Mark cpp header files for installation\ninstall(DIRECTORY include/${PROJECT_NAME}/\n  DESTINATION ${CATKIN_PACKAGE_INCLUDE_DESTINATION}\n  FILES_MATCHING PATTERN \"*.h\"\n  PATTERN \".svn\" EXCLUDE\n)\n</code></pre>\n\n<p>I can provide any other files it would help to see, but this post is too long already, so hopefully someone is able to wade through it and knows what the issue is, because I don't. forge_errors should be a complete and correctly building library, and I don't know why it can't link it to these executables.</p>\n"}, {"tags": ["c++", "polymorphism", "abstract-class", "virtual-functions"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1552493355, "post_id": 55146342, "comment_id": 97033438, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/3804079/how-does-virtual-method-invocation-work-in-c\" title=\"how does virtual method invocation work in c\">stackoverflow.com/questions/3804079/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/1306778/c-virtual-pure-virtual-explained\" title=\"c virtual pure virtual explained\">stackoverflow.com/questions/1306778/&hellip;</a>"}, {"owner": {"reputation": 1943, "user_id": 1840804, "user_type": "registered", "accept_rate": 2, "profile_image": "https://www.gravatar.com/avatar/43f319966c701ecead79a450137a128c?s=128&d=identicon&r=PG", "display_name": "Skorpius", "link": "https://stackoverflow.com/users/1840804/skorpius"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552499153, "post_id": 55146342, "comment_id": 97036839, "body": "I don&#39;t see these explain casting though?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1552499416, "post_id": 55146342, "comment_id": 97036991, "body": "No casting happens in the function call.  Since all derived objects are also a base object they populate the vtable in the base part with the function address to the derived object function."}, {"owner": {"reputation": 1943, "user_id": 1840804, "user_type": "registered", "accept_rate": 2, "profile_image": "https://www.gravatar.com/avatar/43f319966c701ecead79a450137a128c?s=128&d=identicon&r=PG", "display_name": "Skorpius", "link": "https://stackoverflow.com/users/1840804/skorpius"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552503605, "post_id": 55146342, "comment_id": 97039209, "body": "And this happens implicitly at every pointer reassign?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1552503873, "post_id": 55146342, "comment_id": 97039341, "body": "Yes-ish.  When you have <code>class B: public A</code> you basically get a blob of memory that represents <code>B</code>,but the very first part of that blob is the <code>A</code> part of <code>B</code>.  So when you do <code>A* foo = new B;</code> foo will point to the <code>A</code> part of <code>B</code>, but all of the <code>B</code> part is still there.  It is the <code>A</code> part that, when <code>B</code> is created, has it&#39;s vtable populated to point to <code>B</code>&#39;s functions, instead of <code>A</code>&#39;s."}, {"owner": {"reputation": 1943, "user_id": 1840804, "user_type": "registered", "accept_rate": 2, "profile_image": "https://www.gravatar.com/avatar/43f319966c701ecead79a450137a128c?s=128&d=identicon&r=PG", "display_name": "Skorpius", "link": "https://stackoverflow.com/users/1840804/skorpius"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552504085, "post_id": 55146342, "comment_id": 97039441, "body": "I see. One last thing. if class B has function that it has on its own, would we have to downcast the pointer to B to call those functions?   For example, if class B implements baz() but its not virtual in A, can spa call baz()?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1552504204, "post_id": 55146342, "comment_id": 97039500, "body": "Yes, you would hve to cast to <code>B</code> since <code>A</code> has no idea that function exists.  In those cases you would need to use a <code>dynamic_cast</code> to make sure you are casting it correctly.  Normally though having to call dynamic_cast is considered a design flaw as it should be avoid for the most part."}], "owner": {"reputation": 1943, "user_id": 1840804, "user_type": "registered", "accept_rate": 2, "profile_image": "https://www.gravatar.com/avatar/43f319966c701ecead79a450137a128c?s=128&d=identicon&r=PG", "display_name": "Skorpius", "link": "https://stackoverflow.com/users/1840804/skorpius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1552496223, "answer_count": 0, "score": 0, "last_activity_date": 1552493664, "creation_date": 1552493119, "last_edit_date": 1552493664, "question_id": 55146342, "link": "https://stackoverflow.com/questions/55146342/what-is-going-on-behind-the-scenes-with-polymorphism-in-c", "closed_reason": "Duplicate", "title": "What is going on behind the scenes with polymorphism in C++?", "body": "<p>Let's say we have these classes:</p>\n\n<pre><code>class A {\n virtual void foo() {} //implemented\n virtual void bar() = 0;\n};\nclass B: public A {\n virtual void foo() override {} //implemented\n virtual void bar() override {} //implemented\n};\nclass C: public A {\n virtual void foo() override {} //implemented\n virtual void bar() override {} //implemented\n};\n</code></pre>\n\n<p>Then let's say we do this:</p>\n\n<pre><code>shared_ptr&lt;A&gt; spa;\n\nif (someCondition) {\n spa = make_shared&lt;B&gt;();\n} else {\n spa = make_shared&lt;C&gt;();\n}\n\nspa-&gt;foo();\nspa-&gt;bar();\n</code></pre>\n\n<p>What happens in the background? Obviously, pure virtual function bar() MUST be implemented in the derived classes - so is there an implicit cast that happens for the shared ptr to use the derived class implementation? In the case of bar, we are still overriding despite implementation in the base class, so will it also do a an implicit cast of some sort to use the derived class implementation?</p>\n\n<p>Essentially, it's not a question of what will happen, but moreso a question of how what is happening is happening.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1552493372, "post_id": 55146279, "comment_id": 97033454, "body": "Aside: return type of main is int"}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1552493484, "post_id": 55146279, "comment_id": 97033529, "body": "Foo is a templated class. as you need to call <code>auto&amp; foo1 = Foo&lt;int&gt;::Instance();</code>, you sould call <code>auto&amp; foo4 = Foo&lt;int&gt;::DeductInstance(123);</code> too, or <code>auto&amp; foo4 = Foo&lt;decltype(123)&gt;::DeductInstance(123);</code>"}, {"owner": {"reputation": 921, "user_id": 2043980, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/17e881e92b245bcb71fe579f34acb1b0?s=128&d=identicon&r=PG", "display_name": "Demaunt", "link": "https://stackoverflow.com/users/2043980/demaunt"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1552493560, "post_id": 55146279, "comment_id": 97033575, "body": "I know, but I want Instance to automaticaly deduct types from argument"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552494417, "post_id": 55146279, "comment_id": 97034099, "body": "what do you really want to achieve? To &quot;deduce&quot; the type of <code>123</code> you could simply write <code>decltype(123)</code>"}, {"owner": {"reputation": 921, "user_id": 2043980, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/17e881e92b245bcb71fe579f34acb1b0?s=128&d=identicon&r=PG", "display_name": "Demaunt", "link": "https://stackoverflow.com/users/2043980/demaunt"}, "edited": false, "score": 0, "creation_date": 1552495123, "post_id": 55146279, "comment_id": 97034507, "body": "I want to deduce type of Foo&lt;int&gt; from Foo::Instance(123)"}], "answers": [{"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 0, "last_activity_date": 1552494256, "creation_date": 1552494256, "answer_id": 55146728, "question_id": 55146279, "link": "https://stackoverflow.com/questions/55146279/template-static-function-template-class-type-deduction/55146728#55146728", "title": "template static function template class type deduction", "body": "<p>I have to admit that I dont understand completely what you are trying to do. However, you can do either of the following two:</p>\n\n<pre><code>struct foo {\n    template &lt;typename T&gt; \n    static T deduce(const T&amp; t) { \n        return {};\n    }\n};\n\ntemplate &lt;typename T&gt; \nT deduce_free(const T&amp; t) {\n    return {};\n}\n\nint main() {\n    auto x = foo::deduce(1);\n    auto y = deduce_free(1);\n}\n</code></pre>\n\n<p>But you cannot call a method (whehter static or not) on some instance of <code>bar&lt;T&gt;</code> before you know what <code>T</code> is. </p>\n\n<p>Things have changed a bit with C++17 which has <a href=\"https://en.cppreference.com/w/cpp/language/class_template_argument_deduction\" rel=\"nofollow noreferrer\">class template argument deduction</a>, though <strike>as far as I know this works for constructors, so you would still need a <code>foo&lt;int&gt;</code> first before you could call a <code>foo&lt;int&gt;::deduce()</code></strike> I am too unexperienced with that to say something not wrong ;).</p>\n"}, {"tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 1, "last_activity_date": 1552495176, "creation_date": 1552495176, "answer_id": 55147020, "question_id": 55146279, "link": "https://stackoverflow.com/questions/55146279/template-static-function-template-class-type-deduction/55147020#55147020", "title": "template static function template class type deduction", "body": "<p>The syntax you're asking for is theorically possible using injected class names. That would make <code>Foo::</code> resolve to a particular, unrelated <code>Foo&lt;x&gt;::</code>. Here's an example:</p>\n\n<pre><code>struct BaseFoo {\n    template&lt;class K&gt; static\n    auto&amp; DeductInstance(const K&amp;);\n};\n\ntemplate &lt;class T&gt;\nstruct Foo  {\n    static auto&amp; Instance() {\n        static Foo foo{};\n        return foo;\n    }\n};\n\ntemplate&lt;&gt;\nstruct Foo&lt;void&gt; : private BaseFoo {\n    using BaseFoo::DeductInstance;\n};\n\ntemplate&lt;typename K&gt;\nauto&amp; BaseFoo::DeductInstance(const K&amp;)\n{\n    return Foo&lt;K&gt;::Instance();\n}\n\nusing MakeFooAvailable = Foo&lt;void&gt;;\n\nstruct Dummy : MakeFooAvailable {\n    auto&amp; bar() {\n        // Syntax working\n        return Foo::DeductInstance(234);\n    }\n};\n</code></pre>\n\n<p>In the class <code>Dummy</code>, there's a injected class name for the base class <code>Foo</code>, resolving it to <code>Foo&lt;void&gt;</code>. Then, <code>Foo&lt;void&gt;</code> is making <code>BaseFoo::DeductInstance</code> available for name resolution in its scope.</p>\n\n<hr>\n\n<p>I would advise not using this solution because it's a clever one. Clever generally mean surprising. Programmers don't expect seeing <code>Foo</code> as a non template when it is. The best solution I think would be:</p>\n\n<pre><code>auto&amp; foo1 = Foo&lt;int&gt;::Instance(); //OK\n</code></pre>\n\n<p>The simpler, the better.</p>\n"}], "owner": {"reputation": 921, "user_id": 2043980, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/17e881e92b245bcb71fe579f34acb1b0?s=128&d=identicon&r=PG", "display_name": "Demaunt", "link": "https://stackoverflow.com/users/2043980/demaunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 55147020, "answer_count": 2, "score": 0, "last_activity_date": 1552495176, "creation_date": 1552492942, "question_id": 55146279, "link": "https://stackoverflow.com/questions/55146279/template-static-function-template-class-type-deduction", "title": "template static function template class type deduction", "body": "<p>I want to make static function in singletone template class, that would be able to deduct types of template class.\nThe problem is, that calling static function from template class requires explicit type.\nThe only workaround that I've came up with was template function instead if template member function.</p>\n\n<p>Here is an example. The problem is that foo4 part is not working</p>\n\n<pre><code>template &lt;class T&gt;\nclass Foo\n{\nprivate:\n    Foo() {}\n    Foo(const Foo&amp;) = delete;\n    Foo&amp; operator= (const Foo&amp;) = delete;\n\npublic:\n    static auto&amp; Instance()\n    {\n        static Foo foo{};\n        return foo;\n    }\n\n    template&lt;class K&gt; static\n    auto&amp; DeductInstance(const K&amp;)\n    {\n        static Foo&lt;K&gt; foo{};\n        return foo;\n    }\n\n};\n\ntemplate&lt;class K&gt;\nauto&amp; DeductInstance(const K&amp;)\n{\n    return Foo&lt;K&gt;::Instance();\n}\n\nvoid main()\n{\n    auto&amp; foo1 = Foo&lt;int&gt;::Instance(); //OK\n    auto&amp; foo2 = Foo&lt;int&gt;::Instance(); //OK (return same example as foo1)\n    auto&amp; foo3 = DeductInstance(123); //OK\n    auto&amp; foo4 = Foo::DeductInstance(123); //NOT WORKING\n}\n</code></pre>\n"}, {"tags": ["c++", "boost", "boost-xpressive"], "answers": [{"tags": [], "owner": {"reputation": 1878, "user_id": 717406, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a4a30e64bea9d876a1a6f19940a9df20?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/717406/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1552557112, "creation_date": 1552557112, "answer_id": 55159418, "question_id": 55146150, "link": "https://stackoverflow.com/questions/55146150/boost-xpressive-cannot-use-afterstuff/55159418#55159418", "title": "Boost Xpressive - cannot use after(stuff)", "body": "<p>The, rather ugly, solution involves multiple <code>before</code>and <code>after</code> elements.</p>\n\n<p>Here is the solution, which has been tested and works :</p>\n\n<pre><code>(~after(range('A', 'Z') &gt;&gt; as_xpr(\". \")  &gt;&gt; as_xpr(\". \"))  &gt;&gt;\n        ~after(as_xpr(\"\u00c0\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00c1\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00c2\")  &gt;&gt; as_xpr(\". \")) &gt;&gt;\n        ~after(as_xpr(\"\u00c3\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00c4\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00c5\")  &gt;&gt; as_xpr(\". \")) &gt;&gt;\n        ~after(as_xpr(\"\u00c7\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00c8\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00c9\")  &gt;&gt; as_xpr(\". \")) &gt;&gt;\n        ~after(as_xpr(\"\u00ca\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00cb\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00cc\")  &gt;&gt; as_xpr(\". \")) &gt;&gt;\n        ~after(as_xpr(\"\u00cd\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00ce\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00cf\")  &gt;&gt; as_xpr(\". \")) &gt;&gt;\n        ~after(as_xpr(\"\u00d1\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00d2\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00d3\")  &gt;&gt; as_xpr(\". \")) &gt;&gt;\n        ~after(as_xpr(\"\u00d4\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00d5\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00d6\")  &gt;&gt; as_xpr(\". \")) &gt;&gt;\n        ~after(as_xpr(\"\u00d8\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00d9\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00da\")  &gt;&gt; as_xpr(\". \")) &gt;&gt;\n        ~after(as_xpr(\"\u00db\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00dc\")  &gt;&gt; as_xpr(\". \")) &gt;&gt; ~after(as_xpr(\"\u00dd\")  &gt;&gt; as_xpr(\". \")) )  &gt;&gt;\n        (boost::xpressive::set= 'm', 'M') &gt;&gt; '.' &gt;&gt;\n        (~before(as_xpr(\" \") &gt;&gt; range('A', 'Z') &gt;&gt; as_xpr(\". \"))  &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c0\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c1\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c2\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c3\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c4\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c5\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c7\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c8\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00c9\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00ca\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00cb\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00cc\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00cd\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00ce\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00cf\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00d1\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00d2\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00d3\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00d4\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00d5\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00d6\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00d8\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00d9\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00da\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00db\") &gt;&gt; as_xpr(\". \")) &gt;&gt; ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00dc\") &gt;&gt; as_xpr(\". \")) &gt;&gt;\n                ~before(as_xpr(\" \") &gt;&gt; as_xpr(\"\u00dd\") &gt;&gt; as_xpr(\". \")) )\n</code></pre>\n\n<p>As said before, it is ugly, but this overcomes the limitations of <code>xpressive</code> not working with UTF8 characters natively.</p>\n"}], "owner": {"reputation": 1878, "user_id": 717406, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a4a30e64bea9d876a1a6f19940a9df20?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/717406/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552557112, "creation_date": 1552492529, "question_id": 55146150, "link": "https://stackoverflow.com/questions/55146150/boost-xpressive-cannot-use-afterstuff", "title": "Boost Xpressive - cannot use after(stuff)", "body": "<p>I am in the process of converting a regex library (thousands of perl regex's) and have come across a major problem.</p>\n\n<p>This is the expression that I have to translate into <strong>static xpressive</strong> :</p>\n\n<pre><code>(?&lt;![A-Z\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c7\u00c8\u00c9\u00ca\u00cb\u00cc\u00cd\u00ce\u00cf\u00d1\u00d2\u00d3\u00d4\u00d5\u00d6\u00d8\u00d9\u00da\u00db\u00dc\u00dd]\\. )[mM]\\.(?! [A-Z\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c7\u00c8\u00c9\u00ca\u00cb\u00cc\u00cd\u00ce\u00cf\u00d1\u00d2\u00d3\u00d4\u00d5\u00d6\u00d8\u00d9\u00da\u00db\u00dc\u00dd]\\. )\n</code></pre>\n\n<p>This expression has <code>before</code> and <code>after</code> negating validation conditions.</p>\n\n<p>Which means that normally I should use <code>~after</code> and <code>~before</code>.</p>\n\n<p>However, as there are multibyte characters, I have to put them in as string literals.</p>\n\n<p>My initial attempt was therefore like this :</p>\n\n<pre><code>~after(range('A', 'Z')| as_xpr(\"\u00c0\")| as_xpr(\"\u00c1\")| as_xpr(\"\u00c2\")| as_xpr(\"\u00c3\")| as_xpr(\"\u00c4\")|\n       as_xpr(\"\u00c5\")| as_xpr(\"\u00c7\")| as_xpr(\"\u00c8\")| as_xpr(\"\u00c9\")| as_xpr(\"\u00ca\")| as_xpr(\"\u00cb\")| \n       as_xpr(\"\u00cc\")| as_xpr(\"\u00cd\")| as_xpr(\"\u00ce\")| as_xpr(\"\u00cf\")| as_xpr(\"\u00d1\")| as_xpr(\"\u00d2\")| \n       as_xpr(\"\u00d3\")| as_xpr(\"\u00d4\")| as_xpr(\"\u00d5\")| as_xpr(\"\u00d6\")| as_xpr(\"\u00d8\")| as_xpr(\"\u00d9\")| \n       as_xpr(\"\u00da\")| as_xpr(\"\u00db\")| as_xpr(\"\u00dc\")| as_xpr(\"\u00dd\") | as_xpr(\". \") ) &gt;&gt;\n(set= 'm', 'M') &gt;&gt; '.' &gt;&gt;\n~before(range('A', 'Z')| as_xpr(\"\u00c0\")| as_xpr(\"\u00c1\")| as_xpr(\"\u00c2\")| as_xpr(\"\u00c3\")| as_xpr(\"\u00c4\")|\n       as_xpr(\"\u00c5\")| as_xpr(\"\u00c7\")| as_xpr(\"\u00c8\")| as_xpr(\"\u00c9\")| as_xpr(\"\u00ca\")| as_xpr(\"\u00cb\")| \n       as_xpr(\"\u00cc\")| as_xpr(\"\u00cd\")| as_xpr(\"\u00ce\")| as_xpr(\"\u00cf\")| as_xpr(\"\u00d1\")| as_xpr(\"\u00d2\")| \n       as_xpr(\"\u00d3\")| as_xpr(\"\u00d4\")| as_xpr(\"\u00d5\")| as_xpr(\"\u00d6\")| as_xpr(\"\u00d8\")| as_xpr(\"\u00d9\")| \n       as_xpr(\"\u00da\")| as_xpr(\"\u00db\")| as_xpr(\"\u00dc\")| as_xpr(\"\u00dd\") | as_xpr(\". \") )\n</code></pre>\n\n<p>However, as this gives a variable number of characters, it will not compile.</p>\n\n<p>Is there anyway that I can implement this regex correctly in <strong>static xpressive</strong> ?</p>\n"}, {"tags": ["c++", "delete-operator", "rule-of-three"], "comments": [{"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 3, "creation_date": 1552492593, "post_id": 55146122, "comment_id": 97032886, "body": "From C++11 and onward, it is the <a href=\"https://cpppatterns.com/patterns/rule-of-five.html\" rel=\"nofollow noreferrer\">Rule of five</a> though."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552492649, "post_id": 55146122, "comment_id": 97032927, "body": "From C++98 and onward, the rule of zero is your friend ;)"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1552492787, "post_id": 55146122, "comment_id": 97033031, "body": "Does your copy-constructor, actually do any copying?"}, {"owner": {"reputation": 2853, "user_id": 626796, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4b13deba744c5599a43e06f52af13366?s=128&d=identicon&r=PG", "display_name": "Tharwen", "link": "https://stackoverflow.com/users/626796/tharwen"}, "edited": false, "score": 0, "creation_date": 1552493647, "post_id": 55146122, "comment_id": 97033634, "body": "You also need to pass the Vector2 into your copy assignment operator by reference. Ideally as a const reference but I&#39;m not sure if that&#39;s absolutely necessary"}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "reply_to_user": {"reputation": 2853, "user_id": 626796, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4b13deba744c5599a43e06f52af13366?s=128&d=identicon&r=PG", "display_name": "Tharwen", "link": "https://stackoverflow.com/users/626796/tharwen"}, "edited": false, "score": 0, "creation_date": 1552493774, "post_id": 55146122, "comment_id": 97033725, "body": "@Tharwen that&#39;s the very point of the rule of three/five: you do <b>not</b> need to do that :)"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1552494296, "post_id": 55146122, "comment_id": 97034031, "body": "I would highlight that debugging programs is a skill that must be learnt - and using a debugger is an essential skill if you plan to do any programming (except for arduino work - where I don&#39;t think one exists).  Learning how to do this is should be moved up your priority list rather than learning about the rule of 3/5"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1552494945, "post_id": 55146122, "comment_id": 97034408, "body": "You must have a <i>working</i>, non-buggy copy constructor, and a <i>working</i>, non-buggy destructor for the rule of 3 to work.  Your copy constructor doesn&#39;t copy anything -- bug.  Bottom line is that the copy constructor cannot be a &quot;stub&quot; function that is basically empty -- either you implement it fully, or declare it as <code>delete</code>-ed.  You cannot run the program reliably with a stub copy constructor or actually any of the 3 functions as stubs to be filled in later."}], "answers": [{"comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 4, "creation_date": 1552492941, "post_id": 55146173, "comment_id": 97033148, "body": "It is not destroyed twice.  Newly constructed object does not initialize <code>k</code>, resulting in the crash when the destructor tries to delete this uninitialized value."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1552493036, "post_id": 55146173, "comment_id": 97033214, "body": "@1201ProgramAlarm Did you try it because I got a copy. OR the same pointer somehow. But you&#39;re technically right and I updated my answer."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1552493078, "post_id": 55146173, "comment_id": 97033244, "body": "@1201ProgramAlarm, I think so too - as written - k does not point to a valid memory address. At which step though does it become invalid?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1552493122, "post_id": 55146173, "comment_id": 97033284, "body": "@Imago It never <i>becomes</i> invalid. It was never valid to start with because it is never set explicitly by the copy constructor."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1552493284, "post_id": 55146173, "comment_id": 97033395, "body": "Why not? It had called the constructor for <code>v1</code>, so not using the copy assignment constructor makes above&#39;s code completely valid."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 2, "creation_date": 1552493361, "post_id": 55146173, "comment_id": 97033444, "body": "It isn&#39;t overwriting <code>v1</code> in <code>operator=</code>. It creates an entirely new copy because the function parameter is not a reference."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 2, "creation_date": 1552493444, "post_id": 55146173, "comment_id": 97033506, "body": "Or, OK. <code>v1</code> becomes invalid when <code>swap</code> overwrites its <code>k</code> with the <code>other.k</code>"}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 0, "last_activity_date": 1552492992, "last_edit_date": 1552492992, "creation_date": 1552492598, "answer_id": 55146173, "question_id": 55146122, "link": "https://stackoverflow.com/questions/55146122/implementation-of-rule-of-three-gone-wrong/55146173#55146173", "title": "Implementation of &quot;Rule of Three&quot; gone wrong", "body": "<p>Constructing <code>other</code> in <code>operator=</code> uses the copy constructor, which does not create a new copy of the pointed to value. Your copy constructor may not even copy <code>k</code> since it is a POD type and therefore not necessarily default constructed or default copied.</p>\n\n<p>Then when it is destructed it tries to destroy it twice. Or depending on random factors like stack layout, it may not copy <code>k</code> at all and then it tries to <code>delete</code> an invalid pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1552494155, "creation_date": 1552494155, "answer_id": 55146692, "question_id": 55146122, "link": "https://stackoverflow.com/questions/55146122/implementation-of-rule-of-three-gone-wrong/55146692#55146692", "title": "Implementation of &quot;Rule of Three&quot; gone wrong", "body": "<p>Your issue is in <code>Vector2(const Vector2 &amp;other)</code></p>\n\n<p>You use this constructor in your <code>operator =</code> implicitly by passing by value; but you fail to assign k to any value in that constructor.</p>\n\n<p>This results in swap replacing a valid k with an invalid k, and then deleting the invalid k; resulting in your crash.</p>\n"}, {"tags": [], "owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "is_accepted": false, "score": 3, "last_activity_date": 1552561365, "last_edit_date": 1552561365, "creation_date": 1552494294, "answer_id": 55146739, "question_id": 55146122, "link": "https://stackoverflow.com/questions/55146122/implementation-of-rule-of-three-gone-wrong/55146739#55146739", "title": "Implementation of &quot;Rule of Three&quot; gone wrong", "body": "<p>It's actually very simple: Your copy constructor does not make a copy. In fact, it does not initialize any member, so any instance created by this constructor is filled with crap.</p>\n\n<p>For the call of <code>operator=(Vector2 other)</code> the copy constructor is called to create <code>other</code> (this is the point of the rule of three), so <code>other</code> is filled with crap.\nThen you swap the valid <code>k</code> of <code>this</code> (aka <code>v1</code>) with the crappy <code>k</code> of <code>other</code>.</p>\n\n<p>Then, when the destructor of <code>v1</code> is called, it calls <code>delete[] k</code> on a crappy <code>k</code> --> access violation.</p>\n\n<h2>Solution</h2>\n\n<p>Make your copy constructor make a copy. Or at least, make it properly initialize <code>k</code> (e.g. to <code>nullptr</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "is_accepted": true, "score": 0, "last_activity_date": 1578676016, "last_edit_date": 1578676016, "creation_date": 1552497624, "answer_id": 55147812, "question_id": 55146122, "link": "https://stackoverflow.com/questions/55146122/implementation-of-rule-of-three-gone-wrong/55147812#55147812", "title": "Implementation of &quot;Rule of Three&quot; gone wrong", "body": "<p>The solution can be derived by laying out the exact sequence of events, e.g.: More print outs and testing, what parameters are called when:</p>\n\n<p>Starting in: <code>v1 = v2;</code> </p>\n\n<ol>\n<li><code>v2</code> calls <strong>copy constructor</strong> with the argument other (whatever other is), in particular: its <code>int* k</code> does not point to valid memory. For simplicity let's call this new Vector2 v3. </li>\n<li>The <strong>copy assignment constructor</strong> is called now with v3. </li>\n<li>Then we begin swap. </li>\n</ol>\n\n<p>The error actually arises within the <strong>copy constructor</strong>, as <code>v3</code> is not initialised properly in step 1 .</p>\n\n<p>Step 2 and step 3 are basically \"hiding\", transferring the error from <code>v3</code> onto <code>v1</code>. </p>\n\n<p>The interesting question now is, how is <code>v3</code> actually generated? Not by the default constructor!</p>\n"}], "owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 55147812, "answer_count": 4, "score": 2, "last_activity_date": 1578676016, "creation_date": 1552492443, "question_id": 55146122, "link": "https://stackoverflow.com/questions/55146122/implementation-of-rule-of-three-gone-wrong", "title": "Implementation of &quot;Rule of Three&quot; gone wrong", "body": "<p>Below is an erroneous implementation of \"The rule of three\", which I try to understand.</p>\n\n<p>Debugging the program, I found that the debugger has a problem cleaning up  <code>int *k</code>, which could be resolved either by defining <code>int *k = nullptr</code> or simply setting it to something reasonable in the copy constructor. </p>\n\n<p>However, I do not understand how the resulting error of the program, an access violation, comes into existence. </p>\n\n<p>I do know, after the copy assignment constructor <code>v1</code>'s <code>int *k</code>no longer points to a valid memory address.</p>\n\n<pre><code>class Vector2 {\npublic:\n    std::string name = \"default\";\n    int* k;\n\n    Vector2(int s, std::string n) : k(new int[s]), name(n) {\n    }\n\n    Vector2(const Vector2 &amp;other)  {\n        std::cout&lt;&lt; \"Copy constructor: \" &lt;&lt; name &lt;&lt; std::endl;\n    }\n\n    ~Vector2() {\n        std::cout &lt;&lt; \"Deleting: \" &lt;&lt; name &lt;&lt; std::endl;\n        delete[] k;\n    }\n\n    void swap(Vector2&amp; other) {\n        using std::swap;\n        swap(k, other.k);\n    }\n\n    Vector2&amp; operator=(Vector2 other) {\n        std::cout &lt;&lt; \"Copy assignment constructor: \" &lt;&lt; name &lt;&lt; std::endl;\n        swap(other);\n        return *this;\n    }\n};\n\n\nint main() {\n        Vector2 v1 = Vector2(2, \"v1\");\n        Vector2 v2 = Vector2(4, \"v2\");\n        v1 = v2;\n        std::cout &lt;&lt; &amp;v1 &lt;&lt; \" \" &lt;&lt; &amp;v2 &lt;&lt; std::endl;\n        std::cout &lt;&lt; &amp;v1.k &lt;&lt; \" \" &lt;&lt; &amp;v2.k &lt;&lt; std::endl;\n        return 0;\n    }\n</code></pre>\n\n<p>Below is the console output of above's program:</p>\n\n<pre><code>Copy constructor: default\nCopy assignment constructor: v1\nDeleting: default\n0000001B5611FA28 0000001B5611FA78\n0000001B5611FA50 0000001B5611FAA0\nDeleting: v2\nDeleting: v1\n16:18:42: The program has unexpectedly finished.\n</code></pre>\n"}, {"tags": ["python", "c++", "arrays", "ctypes"], "comments": [{"owner": {"reputation": 36561, "user_id": 36330, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/087bc3a6b2fe0dbbf39ca49f40e2bac1?s=128&d=identicon&r=PG", "display_name": "joeforker", "link": "https://stackoverflow.com/users/36330/joeforker"}, "edited": false, "score": 1, "creation_date": 1552492862, "post_id": 55146025, "comment_id": 97033091, "body": "Cffi is a newer library that can do the same job"}], "answers": [{"tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": false, "score": 1, "last_activity_date": 1552501035, "last_edit_date": 1552501035, "creation_date": 1552499971, "answer_id": 55148470, "question_id": 55146025, "link": "https://stackoverflow.com/questions/55146025/pass-integer-array-by-reference-using-ctypes/55148470#55148470", "title": "Pass integer array by reference using ctypes", "body": "<p><code>ctypes</code> accesses C interfaces.  C doesn't have pointer references, but when treated as <code>extern \"C\"</code> a pointer reference is marshaled the same as a pointer pointer. Just don't pass <code>None</code> from Python since C++ will see that as a null reference.  You'd be better off actually declaring the function to take <code>int**</code> so you can deal with the possibility that <code>None</code> could be passed from Python.</p>\n\n<p>Use:</p>\n\n<pre><code>func.argtypes = [POINTER(POINTER(c_int))]\n</code></pre>\n\n<p>Call it with:</p>\n\n<pre><code>p = POINTER(c_int)()\nfunc(byref(p))\nprint(p[:3])\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4005067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12581489bf17427f6492e2df4aa0513c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Kraft", "link": "https://stackoverflow.com/users/4005067/kevin-kraft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552555742, "creation_date": 1552492198, "last_edit_date": 1552492720, "question_id": 55146025, "link": "https://stackoverflow.com/questions/55146025/pass-integer-array-by-reference-using-ctypes", "title": "Pass integer array by reference using ctypes", "body": "<p>I want to run a C++ function from python that returns an <code>int*</code> array by reference and converts it into a python list.</p>\n\n<p>Here is the example C++ code:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n\n#define DLLEXPORT extern \"C\" __declspec(dllexport)\n\nDLLEXPORT int getResponse(int*&amp; hash_list)\n{\n\n    std::cout &lt;&lt; hash_list &lt;&lt; std::endl;\n\n    int* hashes = new int[3];\n    hashes[0] = 8;\n    hashes[1] = 9;\n    hashes[2] = 10;\n    hash_list = hashes;\n\n    std::cout &lt;&lt; hash_list &lt;&lt; std::endl;\n    std::cout &lt;&lt; *hash_list &lt;&lt; std::endl;\n    std::cout &lt;&lt; *(hash_list + 1) &lt;&lt; std::endl;\n    std::cout &lt;&lt; *(hash_list + 2) &lt;&lt; std::endl;\n\n    return 0;\n}\n\nDLLEXPORT void testDLL()\n{\n    std::cout &lt;&lt; \"DLL can be read\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Here is my best attempt in python:</p>\n\n<pre><code>from ctypes import cdll, c_int, POINTER, ARRAY, byref\n\nLIB = cdll.LoadLibrary(\"&lt;path to DLL&gt;\")\n\nLIB.testDLL()\n\nfunc = LIB.getResponse\nitype = c_int\nfunc.argtypes = [POINTER(ARRAY(itype,3))]\nfunc.restype = c_int\n\nchashes = (itype * 3)(*[0,1,2])\nprint(chashes)\n\nfunc(byref(chashes))\n\nprint(chashes)\nprint(list(chashes))\n</code></pre>\n\n<p>This is the output:</p>\n\n<pre><code>DLL can be read\n&lt;ctypes.c_long_Array_3 object at 0x000001B00FB7FEC8&gt;\n0000000100000000\n000001B00DB0AC70\n8\n9\n10\n&lt;ctypes.c_long_Array_3 object at 0x000001B00FB7FEC8&gt;\n[229682288, 432, 2]\n</code></pre>\n\n<p>This approach seems to have some success, however I think the initial array passed to the C++ function has invalid entries. And then the returned values are mangled anyway.</p>\n\n<p>Is this possible with ctypes? Any suggestions would be appreciated.</p>\n\n<p>I also tried using a <code>c_void_p</code> instead of the <code>ARRAY</code>. In that case it also seems to work, but I don't know how to turn the resulting pointer into a python list.</p>\n"}, {"tags": ["c++", "string", "pointers", "char"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1552491301, "post_id": 55145646, "comment_id": 97031977, "body": "&quot;C++: A Beginnners Guide, Second Edition, Herbert Schildt&quot; - a great way NOT to learn C++ properly."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1552491352, "post_id": 55145646, "comment_id": 97032022, "body": "Oh yes, good old Schildt, teaches you language that is almost but not quite C++."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552491871, "post_id": 55145646, "comment_id": 97032341, "body": "quoting <a href=\"https://en.wikipedia.org/wiki/Herbert_Schildt\" rel=\"nofollow noreferrer\">wikipedia</a> &quot;Schildt&#39;s books have a reputation for being riddled with errors&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9149922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AaYSRkAWH28/AAAAAAAAAAI/AAAAAAAAAO4/PFABBot4RNA/photo.jpg?sz=128", "display_name": "William Slater", "link": "https://stackoverflow.com/users/9149922/william-slater"}, "edited": false, "score": 2, "creation_date": 1552492048, "post_id": 55145703, "comment_id": 97032459, "body": "Thank you for your quick reply, I will make sure to review my learning materials more thoroughly."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": true, "score": 6, "last_activity_date": 1552492670, "last_edit_date": 1552492670, "creation_date": 1552491270, "answer_id": 55145703, "question_id": 55145646, "link": "https://stackoverflow.com/questions/55145646/error-passing-strings-as-pointers-cannot-assign-const-char-to-char/55145703#55145703", "title": "Error passing strings as pointers, cannot assign const char* to char*", "body": "<p>Your book is old and doesn't conform to the standard anymore, as <code>char*</code> litterals must be <code>const</code> since C++11:</p>\n\n<pre><code>const char *get_substr(const char *sub, const char *str);\n</code></pre>\n\n<p>Have a look at the <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">curated C++ book list</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1552491664, "post_id": 55145814, "comment_id": 97032201, "body": "<i>&quot;String literals ... are of <code>const char</code> data-type&quot;</i> More like <code>const char [N]</code>."}, {"owner": {"reputation": 123, "user_id": 11003129, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0Oi72szkaGo/AAAAAAAAAAI/AAAAAAAABLo/qUUw6k-Ze_0/photo.jpg?sz=128", "display_name": "Bhargav Kinnal", "link": "https://stackoverflow.com/users/11003129/bhargav-kinnal"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1552556341, "post_id": 55145814, "comment_id": 97057464, "body": "@HolyBlackCat My bad. Thanks for the comment. I have edited the answer."}], "tags": [], "owner": {"reputation": 123, "user_id": 11003129, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0Oi72szkaGo/AAAAAAAAAAI/AAAAAAAABLo/qUUw6k-Ze_0/photo.jpg?sz=128", "display_name": "Bhargav Kinnal", "link": "https://stackoverflow.com/users/11003129/bhargav-kinnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1552556368, "last_edit_date": 1552556368, "creation_date": 1552491578, "answer_id": 55145814, "question_id": 55145646, "link": "https://stackoverflow.com/questions/55145646/error-passing-strings-as-pointers-cannot-assign-const-char-to-char/55145814#55145814", "title": "Error passing strings as pointers, cannot assign const char* to char*", "body": "<p>String literals like \"three\" are of <code>const char [N]</code> data-type. \nThe arguments passed are not compliant with C++11 standards.\nThe following usage should fix your issue</p>\n\n<pre><code>const char *get_substr(const char *sub, const char *str);\n</code></pre>\n\n<p>Here is a quick guide for you\n<a href=\"https://www.geeksforgeeks.org/difference-const-char-p-char-const-p-const-char-const-p/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/difference-const-char-p-char-const-p-const-char-const-p/</a></p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 10792368, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lUyhIe-tBiU/AAAAAAAAAAI/AAAAAAAAAA4/TJs3p-ZxEKA/photo.jpg?sz=128", "display_name": "Jan Reme\u0161", "link": "https://stackoverflow.com/users/10792368/jan-reme%c5%a1"}, "is_accepted": false, "score": 0, "last_activity_date": 1552491696, "creation_date": 1552491696, "answer_id": 55145859, "question_id": 55145646, "link": "https://stackoverflow.com/questions/55145646/error-passing-strings-as-pointers-cannot-assign-const-char-to-char/55145859#55145859", "title": "Error passing strings as pointers, cannot assign const char* to char*", "body": "<p>Your compiler complains because you are feeding a string literal to a function that may want to modify it.</p>\n\n<p>Presumably, your <code>get_substr()</code> function does not modify the input string, nor the string you are looking for (either of the parameters).</p>\n\n<p>If you know this about your function, you can change its prototype to</p>\n\n<pre><code>const char *get_substr(const char *sub, const char *str);\n</code></pre>\n\n<p>This has following effects:</p>\n\n<ul>\n<li>the compiler will complain if you try to modify either of the strings in the body of the function</li>\n<li>the compiler will be free to assume that your function <strong>does not</strong> change the data and will not complain when you use <code>const</code> data (such as literals) as parameters for the function</li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 9149922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AaYSRkAWH28/AAAAAAAAAAI/AAAAAAAAAO4/PFABBot4RNA/photo.jpg?sz=128", "display_name": "William Slater", "link": "https://stackoverflow.com/users/9149922/william-slater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "closed_date": 1552491815, "accepted_answer_id": 55145703, "answer_count": 3, "score": 0, "last_activity_date": 1552556368, "creation_date": 1552491097, "last_edit_date": 1552491148, "question_id": 55145646, "link": "https://stackoverflow.com/questions/55145646/error-passing-strings-as-pointers-cannot-assign-const-char-to-char", "closed_reason": "Duplicate", "title": "Error passing strings as pointers, cannot assign const char* to char*", "body": "<p>I am learning C++ from a textbook (C++: A Beginnners Guide, Second Edition, Herbert Schildt).  The following program code is from the book, but results in error, can someone please explain to me why this is not allowed?</p>\n\n<p>The aim is to demonstrate a pointer as a parameter: </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nchar *get_substr(char *sub, char *str); //function prototype\n\nint main()\n{\n    char *substr;\n    substr = get_substr(\"three\", \"one two three four\");\n\n    cout &lt;&lt; \"substring found: \" &lt;&lt; substr;\n\n    return 0;\n}\n</code></pre>\n\n<p>I'll not list the function body because it goes as you would expect, but even if it just returns zero, this results in the following error: \nE0167   argument of type \"const char *\" is incompatible with parameter of type \"char *\", referencing the function call. My understanding is a string is basically an array of char in C anyway, why is this not allowed, and what is  a suitable alternative?  Thank you in advance.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "edited": false, "score": 2, "creation_date": 1552491054, "post_id": 55145584, "comment_id": 97031825, "body": "you have to rename your enum because this prefedined IN will be overwriten over the <code>Countrycode</code> enum definition"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552491060, "post_id": 55145584, "comment_id": 97031827, "body": "Please upgrade to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The solution is however usually to exert tight control of what you include where."}, {"owner": {"reputation": 2120, "user_id": 5420570, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4ea437b24f9ddf2bcf52604ceae28e4?s=128&d=identicon&r=PG", "display_name": "BladeMight", "link": "https://stackoverflow.com/users/5420570/blademight"}, "edited": false, "score": 0, "creation_date": 1552491089, "post_id": 55145584, "comment_id": 97031847, "body": "I don&#39;t think you could override something that is already defined."}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2120, "user_id": 5420570, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4ea437b24f9ddf2bcf52604ceae28e4?s=128&d=identicon&r=PG", "display_name": "BladeMight", "link": "https://stackoverflow.com/users/5420570/blademight"}, "edited": false, "score": 2, "creation_date": 1552491128, "post_id": 55145584, "comment_id": 97031869, "body": "@BladeMight Could - but shouldn&#39;t, for their own sanity and hapiness... I am trying for decades to keep my colleagues from doing <code>#ifdef IN #undef IN #endif #define IN</code>."}, {"owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "edited": false, "score": 0, "creation_date": 1552491179, "post_id": 55145584, "comment_id": 97031900, "body": "but then the country code enum cannot be &#39;ISO_3166-1_alpha-2&#39;, huh!"}, {"owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "reply_to_user": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552491330, "post_id": 55145584, "comment_id": 97032004, "body": "@Yunnosch that was my first thought! Wondering any other way out!"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552491414, "post_id": 55145584, "comment_id": 97032062, "body": "Use <code>#ifndef MYHEADERCALLED_IN_H #define MYHEADERCALLED_IN_H</code>. Short &quot;good&quot; names are always a trap."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552491417, "post_id": 55145584, "comment_id": 97032063, "body": "Do you need these to be compile time value?  If not you can use a <code>std::map&lt;std::string, int&gt;</code>"}, {"owner": {"reputation": 1350, "user_id": 4413370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWSa5.jpg?s=128&g=1", "display_name": "Jorge Torres", "link": "https://stackoverflow.com/users/4413370/jorge-torres"}, "edited": false, "score": 0, "creation_date": 1552491832, "post_id": 55145584, "comment_id": 97032318, "body": "If you can use c++11 or later, what about using an <code>enum class</code> instead of a plain <code>enum</code>?"}, {"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552491839, "post_id": 55145584, "comment_id": 97032322, "body": "Or is your side the enum? Then <code>#define MYENUMVALUECALLED_IN</code>. Yes I am exaggerating. The point is, in C you need to use names nobody else uses in the same include-visibility context and that is easier with longer identifiers. By the way, the person to blame is the one which defines the extremely short <code>IN</code> and then devilishly distributes that to other hitherto clean poor souls."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1552491908, "post_id": 55145584, "comment_id": 97032366, "body": "The real solution is to get whoever wrote <code>#define IN</code> to go back and change it. It&#39;s not reasonable to reserve such a short and potentially common identifier across all namespaces. Alternatively you can change your <code>enum</code> to not collide with the naming conventions of <code>#define</code>s (if your organisation has such naming conventions)."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 2, "creation_date": 1552491961, "post_id": 55145584, "comment_id": 97032406, "body": "The <code>IN</code> (and <code>OUT</code>) macros are used for readability of parameters in function declarations.  The simple fix is to just <code>#undef IN</code> after including all the system headers.  The (probably better) fix is to prefix all you country codes, something like <code>CC_IN</code>."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1552491966, "post_id": 55145584, "comment_id": 97032410, "body": "@JimsonKannantharaJames Why do you even want this? Are you sure you don&#39;t need something like <code>#define Country_Code_IN &quot;IN&quot;</code>?"}, {"owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "reply_to_user": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1552492406, "post_id": 55145584, "comment_id": 97032731, "body": "@Dominique nope, the enum is a list of all country codes which is in &#39;ISO_3166-1_alpha-2&#39; format."}, {"owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552492907, "post_id": 55145584, "comment_id": 97033128, "body": "@Fran&#231;oisAndrieux Silly Microsoft guys wrote it and burnt it into Windows SDK, no way out! Changed my enum to <code>IN_</code>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1552497731, "post_id": 55145584, "comment_id": 97036109, "body": "@JimsonKannantharaJames Well, that&#39;s a shame. The standard explicitly reserves identifiers for those guys but they don&#39;t use them. For example, <code>_IN</code> would have been fine, nobody else is allowed to use that for any purpose. But maybe the WINAPI predates those identifier reservations. Edit : One thing I like to do with <code>&lt;windows.h&gt;</code> is to only include it once in a dedicated wrapper header where I can fix stuff like that (such as <code>#undef IN</code>, excluding <code>min</code> and <code>max</code>, etc.) and then only include <i>that</i> header when I need OS stuff."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1552769596, "post_id": 55145584, "comment_id": 97139926, "body": "Simply <code>#undef</code> it."}], "owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552769245, "creation_date": 1552490948, "last_edit_date": 1552769245, "question_id": 55145584, "link": "https://stackoverflow.com/questions/55145584/using-enum-value-which-is-already-defined", "title": "Using Enum value which is already #define&#39;d", "body": "<p>I have an enum, which defines <code>Countrycode</code> which is in ISO_3166-1_alpha-2 format. \nBut somewhere in the third party includes, there is a #define, which defines IN. \n(For example, C:\\Program Files (x86)\\Windows Kits\\10\\Include\\10.0.16299.0\\shared\\minwindef.h).</p>\n\n<pre><code>#ifndef IN\n#define IN\n#endif\n</code></pre>\n\n<p>Now my country code Enum says I cannot define country code <code>IN</code> . </p>\n\n<p>Any idea?</p>\n"}, {"tags": ["c++", "protocol-buffers"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1552490050, "post_id": 55145216, "comment_id": 97031088, "body": "The reference you&#39;ve quoted doesn&#39;t say that <code>ParseFromString</code> is a global function but your code seems to think it is."}, {"owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "edited": false, "score": 1, "creation_date": 1552490263, "post_id": 55145216, "comment_id": 97031232, "body": "<code>MyProtoMsgType proto; bool success = proto.ParseFromString(dataString);</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1552490299, "post_id": 55145216, "comment_id": 97031260, "body": "Look at the example in <a href=\"https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.message\" rel=\"nofollow noreferrer\">the <code>Message</code> documentation</a>. Does it look like your code?"}], "answers": [{"tags": [], "owner": {"reputation": 793, "user_id": 381201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7240779deb1e3d81c49472fe45697f59?s=128&d=identicon&r=PG", "display_name": "mannysz", "link": "https://stackoverflow.com/users/381201/mannysz"}, "is_accepted": true, "score": 2, "last_activity_date": 1584030534, "last_edit_date": 1584030534, "creation_date": 1552490499, "answer_id": 55145432, "question_id": 55145216, "link": "https://stackoverflow.com/questions/55145216/c-protobuf-where-are-all-the-methods-in-my-generated-classes/55145432#55145432", "title": "c++ protobuf -- where are all the methods in my generated classes?", "body": "<p>I think your problem is you're using <code>ParseFromString</code> as an unbound method. It is actually a method from <code>Message</code> or <code>MessageLite</code> classes.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Message* msg = new Message();\nbool success = msg-&gt;ParseFromString(dataString);\n...\n</code></pre>\n\n<p>If this is not your issue, I am missing something here in your code.</p>\n"}], "owner": {"reputation": 43, "user_id": 1320548, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/075e38728e526786c7b30a312b951175?s=128&d=identicon&r=PG", "display_name": "loamobn", "link": "https://stackoverflow.com/users/1320548/loamobn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 55145432, "answer_count": 1, "score": 1, "last_activity_date": 1584030534, "creation_date": 1552489840, "question_id": 55145216, "link": "https://stackoverflow.com/questions/55145216/c-protobuf-where-are-all-the-methods-in-my-generated-classes", "title": "c++ protobuf -- where are all the methods in my generated classes?", "body": "<p>I am attempting to parse a protobuf message (in c++) that I receive as a character array.  However, all <a href=\"https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.message_lite?csw=1#MessageLite.ParseFromString.details\" rel=\"nofollow noreferrer\">the references</a> I've read on how to parse a byte array or string into a protobuf type (e.x. \"ParseFromString\") use methods that the compiler says aren't defined.</p>\n\n<p>For example,</p>\n\n<pre><code>Message* msg;\nbool success = ParseFromString(dataString, msg); //error: \"ParseFromString\" not defined in this scope\nMyProtoMsgType* proto = new MyProtoMsgType();\nproto-&gt;CopyFrom(*msg);\n</code></pre>\n\n<p>The only methods of my message class that are available are the field setters and getters and a couple others (CopyFrom and MergeFrom).  So I have no way of reading the contents of a protobuf message received as a char array!</p>\n\n<p>I would so appreciate help, I've been searching for answers for hours upon hours.</p>\n"}, {"tags": ["c++", "templates", "gcc", "sfinae", "enable-if"], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 3, "last_activity_date": 1552489814, "creation_date": 1552489814, "answer_id": 55145205, "question_id": 55144761, "link": "https://stackoverflow.com/questions/55144761/infinite-template-recursion-because-no-bool-expression-optimisation-only-with-gc/55145205#55145205", "title": "Infinite template recursion because no bool expression optimisation only with gcc", "body": "<blockquote>\n  <p>how can I solve this problem to be able to compile this code with GCC</p>\n</blockquote>\n\n<p>You might use <code>std::conjunction</code> (C++17) which guaranty short-circuit</p>\n\n<pre><code>template &lt;typename To, typename From&gt;\ntypename std::enable_if&lt;\n    std::conjunction&lt;\n           std::negation&lt;std::is_same&lt;std::string, To&gt;&gt;,\n           std::negation&lt;std::is_same&lt;std::string, From&gt;&gt;,\n           LexicalCastable&lt;From, std::string&gt;\n           LexicalCastable&lt;std::string, To&gt;&gt;::value,\n    To&gt;::type\nlexicalCast(const From &amp;from)\n{\n    return lexicalCast&lt;To&gt;(lexicalCast&lt;std::string&gt;(from));\n}\n</code></pre>\n"}], "owner": {"reputation": 1031, "user_id": 535473, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/1Bkf9.jpg?s=128&g=1", "display_name": "simon", "link": "https://stackoverflow.com/users/535473/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55145205, "answer_count": 1, "score": 1, "last_activity_date": 1552489814, "creation_date": 1552488557, "last_edit_date": 1552489570, "question_id": 55144761, "link": "https://stackoverflow.com/questions/55144761/infinite-template-recursion-because-no-bool-expression-optimisation-only-with-gc", "title": "Infinite template recursion because no bool expression optimisation only with gcc", "body": "<p>I'm working on a lexical caster. See below the simplified, problematic part of the code below. The code compiles with clang and msvc, but fails to compile with gcc. It seems, that in the first argument of lexicalCast's <code>std::enable_if</code> gcc tries to evaluate all operand of the bool expression before evaluating it, while clang and msvc makes optimization and ignores the evaluation of <code>LexicalCastable&lt;&gt;:: value</code> if the <code>std::is_same</code> expressions failed.\nMy questions would be:</p>\n\n<ul>\n<li>do the standard specifies, which behaviour is correct?</li>\n<li>how can I solve this problem to be able to compile this code with GCC?</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;string&gt;\n\ntemplate&lt;typename From, typename To&gt;\nclass LexicalCastable;\n\ntemplate&lt;typename To, typename From&gt; typename\n    std::enable_if&lt;\n           !std::is_same&lt;std::string, To&gt;::value\n        &amp;&amp; !std::is_same&lt;std::string, From&gt;::value\n        &amp;&amp; LexicalCastable&lt;From, std::string&gt;::value\n        &amp;&amp; LexicalCastable&lt;std::string, To&gt;::value,\nTo&gt;::type lexicalCast(const From &amp;from) {\n    return lexicalCast&lt;To&gt;(lexicalCast&lt;std::string&gt;(from));\n}\n\ntemplate&lt;typename From, typename To&gt;\nclass LexicalCastable\n{\n    template&lt;typename TT&gt;\n    static auto test(int)\n        -&gt; decltype(lexicalCast&lt;TT&gt;(std::declval&lt;From&gt;()), std::true_type{});\n\n    template&lt;typename&gt;\n    static auto test(...)-&gt;std::false_type;\n\npublic:\n    static const bool value = decltype(test&lt;To&gt;(0))::value;\n};\n\nstatic_assert(!LexicalCastable&lt;std::string, std::string&gt;::value, \"\");\n</code></pre>\n\n<p>Errors with gcc:</p>\n\n<pre><code>prog.cpp: In substitution of \u2018template&lt;class TT&gt; static decltype ((lexicalCast&lt;TT&gt;(declval&lt;From&gt;()), std::true_type{})) LexicalCastable&lt;From, To&gt;::test(int) [with TT = std::__cxx11::basic_string&lt;char&gt;]\u2019:\nprog.cpp:35:45:   required from \u2018const bool LexicalCastable&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt;::value\u2019\nprog.cpp:19:3:   required by substitution of \u2018template&lt;class To, class From&gt; typename std::enable_if&lt;(((((! std::is_constructible&lt;To, From&gt;::value) &amp;&amp; (! std::is_same&lt;std::__cxx11::basic_string&lt;char&gt;, To&gt;::value)) &amp;&amp; (! std::is_same&lt;std::__cxx11::basic_string&lt;char&gt;, From&gt;::value)) &amp;&amp; LexicalCastable&lt;From, std::__cxx11::basic_string&lt;char&gt; &gt;::value) &amp;&amp; LexicalCastable&lt;std::__cxx11::basic_string&lt;char&gt;, To&gt;::value), To&gt;::type lexicalCast(const From&amp;) [with To = std::__cxx11::basic_string&lt;char&gt;; From = &lt;missing&gt;]\u2019\nprog.cpp:29:30:   required by substitution of \u2018template&lt;class TT&gt; static decltype ((lexicalCast&lt;TT&gt;(declval&lt;From&gt;()), std::true_type{})) LexicalCastable&lt;From, To&gt;::test(int) [with TT = std::__cxx11::basic_string&lt;char&gt;]\u2019\nprog.cpp:35:45:   required from \u2018const bool LexicalCastable&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt;::value\u2019\nprog.cpp:19:3:   required by substitution of \u2018template&lt;class To, class From&gt; typename std::enable_if&lt;(((((! std::is_constructible&lt;To, From&gt;::value) &amp;&amp; (! std::is_same&lt;std::__cxx11::basic_string&lt;char&gt;, To&gt;::value)) &amp;&amp; (! std::is_same&lt;std::__cxx11::basic_string&lt;char&gt;, From&gt;::value)) &amp;&amp; LexicalCastable&lt;From, std::__cxx11::basic_string&lt;char&gt; &gt;::value) &amp;&amp; LexicalCastable&lt;std::__cxx11::basic_string&lt;char&gt;, To&gt;::value), To&gt;::type lexicalCast(const From&amp;) [with To = std::__cxx11::basic_string&lt;char&gt;; From = &lt;missing&gt;]\u2019\nprog.cpp:29:30:   [ skipping 889 instantiation contexts, use -ftemplate-backtrace-limit=0 to disable ]\nprog.cpp:35:45:   required from \u2018const bool LexicalCastable&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt;::value\u2019\nprog.cpp:19:3:   required by substitution of \u2018template&lt;class To, class From&gt; typename std::enable_if&lt;(((((! std::is_constructible&lt;To, From&gt;::value) &amp;&amp; (! std::is_same&lt;std::__cxx11::basic_string&lt;char&gt;, To&gt;::value)) &amp;&amp; (! std::is_same&lt;std::__cxx11::basic_string&lt;char&gt;, From&gt;::value)) &amp;&amp; LexicalCastable&lt;From, std::__cxx11::basic_string&lt;char&gt; &gt;::value) &amp;&amp; LexicalCastable&lt;std::__cxx11::basic_string&lt;char&gt;, To&gt;::value), To&gt;::type lexicalCast(const From&amp;) [with To = std::__cxx11::basic_string&lt;char&gt;; From = &lt;missing&gt;]\u2019\nprog.cpp:29:30:   required by substitution of \u2018template&lt;class TT&gt; static decltype ((lexicalCast&lt;TT&gt;(declval&lt;From&gt;()), std::true_type{})) LexicalCastable&lt;From, To&gt;::test(int) [with TT = std::__cxx11::basic_string&lt;char&gt;]\u2019\nprog.cpp:35:45:   required from \u2018const bool LexicalCastable&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt;::value\u2019\nprog.cpp:19:3:   required by substitution of \u2018template&lt;class To, class From&gt; typename std::enable_if&lt;(((((! std::is_constructible&lt;To, From&gt;::value) &amp;&amp; (! std::is_same&lt;std::__cxx11::basic_string&lt;char&gt;, To&gt;::value)) &amp;&amp; (! std::is_same&lt;std::__cxx11::basic_string&lt;char&gt;, From&gt;::value)) &amp;&amp; LexicalCastable&lt;From, std::__cxx11::basic_string&lt;char&gt; &gt;::value) &amp;&amp; LexicalCastable&lt;std::__cxx11::basic_string&lt;char&gt;, To&gt;::value), To&gt;::type lexicalCast(const From&amp;) [with To = std::__cxx11::basic_string&lt;char&gt;; From = &lt;missing&gt;]\u2019\nprog.cpp:40:43:   required from here\nprog.cpp:29:49: fatal error: template instantiation depth exceeds maximum of 900 (use -ftemplate-depth= to increase the maximum)\n   -&gt; decltype(lexicalCast&lt;TT&gt;(std::declval&lt;From&gt;()), std::true_type{});\n                               ~~~~~~~~~~~~~~~~~~^~\n</code></pre>\n"}, {"tags": ["c++", "qt", "model-view-controller"], "comments": [{"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 1, "creation_date": 1552492059, "post_id": 55144462, "comment_id": 97032469, "body": "From a code review perspective, I think it would be better to make     <code>QList&lt;Doc*&gt; *docs</code> into a value list <code>QList&lt;Doc&gt; docs</code> (or a list of pointers <code>QList&lt;Doc*&gt;</code> if you need polymorphic behavior from the <code>Doc</code> objects). This would also remove the need for the <code>delete</code> and the <code>~Model()</code> destructor entirely. Likewise with <code>QList&lt;Stage *&gt; *stages</code>."}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 0, "creation_date": 1552492261, "post_id": 55144462, "comment_id": 97032621, "body": "As a general point, I would advise against using Qt&#39;s model-view stuff to implement the MVC pattern in C++ -- UNLESS you are specifically wanting to use their model-view widgets, in which case you have no choice, as you, alas, indicate is the case here. It is a confusing and over-engineered implementation, IMHO."}, {"owner": {"reputation": 23, "user_id": 9946214, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NgYw1-GzJOo/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq03VxnTHMaOxUp55r3jZZag-qK-dA/mo/photo.jpg?sz=128", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u0421\u0443\u0432\u043e\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/9946214/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%a1%d1%83%d0%b2%d0%be%d1%80%d0%be%d0%b2"}, "reply_to_user": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 0, "creation_date": 1552493229, "post_id": 55144462, "comment_id": 97033354, "body": "Thanks for comment, but the main quastion still without answer."}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 0, "creation_date": 1552496962, "post_id": 55144462, "comment_id": 97035625, "body": "The reason I have not answered your question is because Qt&#39;s model-view classes are an overly complicated tool. I have used them but not in a while. I suggest you work through a tutorial for Qt&#39;s model-view widgets, which you can find online or in a book like <a href=\"https://rads.stackoverflow.com/amzn/click/com/B004W2G5C4\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\"><i>C++ GUI Programming with Qt4</i></a> by Blanchette and Summerfield (this part hasn&#39;t changed from Qt 4 to 5). I&#39;d have to go re-read something like that myself in order to answer your question. Sorry."}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 0, "creation_date": 1552497074, "post_id": 55144462, "comment_id": 97035698, "body": "PS, in followup to my first comment, you are currently leaking the individual <code>Doc</code> objects. You delete the list, but not the items in the list."}, {"owner": {"reputation": 23, "user_id": 9946214, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NgYw1-GzJOo/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq03VxnTHMaOxUp55r3jZZag-qK-dA/mo/photo.jpg?sz=128", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u0421\u0443\u0432\u043e\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/9946214/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%a1%d1%83%d0%b2%d0%be%d1%80%d0%be%d0%b2"}, "reply_to_user": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "edited": false, "score": 0, "creation_date": 1552498909, "post_id": 55144462, "comment_id": 97036719, "body": "Yes you are right. thanks for the comments."}], "owner": {"reputation": 23, "user_id": 9946214, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NgYw1-GzJOo/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq03VxnTHMaOxUp55r3jZZag-qK-dA/mo/photo.jpg?sz=128", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u0421\u0443\u0432\u043e\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/9946214/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%a1%d1%83%d0%b2%d0%be%d1%80%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552487798, "creation_date": 1552487798, "question_id": 55144462, "link": "https://stackoverflow.com/questions/55144462/how-to-map-a-multi-level-object-model-with-a-qabstractitemmodel", "title": "How to map a multi-level object model with a QAbstractItemModel", "body": "<p>I start to lern MVC pattern in Qt.</p>\n\n<p>I have the simple data structure, like this:</p>\n\n<pre><code>class Stage\n{\npublic:\n    QString name;\n    int number;\n};\n\nclass Doc\n{\npublic:\n    Doc();\n    ~Doc();\n    QString name;\n    int number;\n    QList&lt;Stage *&gt; *stages;\n};\n</code></pre>\n\n<p>I want to view this structure in TreeView. For this i create model class:</p>\n\n<pre><code>class Model: public QAbstractItemModel\n{\n    Q_OBJECT\n\npublic:\n    Model(QObject *parent);\n    ~Model();\n\n    QVariant data(const QModelIndex &amp;index, int role = Qt::DisplayRole) const;\n    QModelIndex index(int row, int column, const QModelIndex &amp;parent) const;\n    QModelIndex parent(const QModelIndex &amp;index) const;\n    int rowCount(const QModelIndex &amp;parent = QModelIndex()) const;\n    int columnCount(const QModelIndex &amp;parent = QModelIndex()) const;\n    Qt::ItemFlags flags(const QModelIndex &amp;index) const;\n    QVariant headerData(int section, Qt::Orientation orientation,\n                        int role = Qt::DisplayRole) const;\nprivate:\n    QList&lt;Doc*&gt; *docs;\n</code></pre>\n\n<p>If I have only one level of data (doc without stage), everything works fine, but I can't understand how to add second tree level to the model(stage)? </p>\n\n<p>Code example (one level)</p>\n\n<pre><code>Model::Model(QObject *parent) : QAbstractItemModel(parent)\n{\n    docs = new QList&lt;Doc*&gt;();\n    for (int i = 0; i &lt; 3; ++i) {\n        Doc *d = new Doc();\n        d-&gt;name = \"name_\" + QString::number(i);\n        d-&gt;number = i;\n        docs-&gt;append(d);\n    }\n}\n\nModel::~Model()\n{\n    delete docs;\n}\n\nQModelIndex Model::index(int row, int column, const QModelIndex &amp;parent) const\n{\n    if (!parent.isValid()) {\n        Doc *d = docs-&gt;at(row);\n        return createIndex(row, column, d);\n    } \n    return QModelIndex();\n}\n\nQModelIndex Model::parent(const QModelIndex &amp;index) const\n{\n    return QModelIndex();\n}\n\nint Model::rowCount(const QModelIndex &amp;parent) const\n{\n    int cnt = 0;\n    if (!parent.isValid()) {\n        cnt = docs-&gt;size();\n    } \n    return cnt;\n}\n\nint Model::columnCount(const QModelIndex &amp;parent) const\n{\n    Q_UNUSED(parent);\n    return 3;\n}\n\nQt::ItemFlags Model::flags(const QModelIndex &amp;index) const\n{\n    if (!index.isValid())\n        return nullptr;\n    return Qt::ItemIsEnabled | Qt::ItemIsSelectable;\n}\n\nQVariant Model::headerData(int section, Qt::Orientation orientation, int role) const\n{\n    if (role != Qt::DisplayRole)\n        return QVariant();\n\n    if (orientation == Qt::Horizontal) {\n        switch (section) {\n        case 0:\n            return tr(\"Number\");\n        case 1:\n            return tr(\"Code\");\n        case 2:\n            return tr(\"Stages count\");\n        default:\n            return QVariant();\n        }\n    }\n    return QVariant();\n}\n\nQVariant Model::data(const QModelIndex &amp;index, int role) const\n{\n    if (!index.isValid())\n        return QVariant();\n\n    if (role != Qt::DisplayRole)\n        return QVariant();\n    {\n        Doc *d = static_cast&lt;Doc*&gt;(index.internalPointer());\n\n        switch (index.column()) {\n        case 0:\n            return d-&gt;name;\n        case 1:\n            return d-&gt;number;\n        case 2:\n            return d-&gt;stages-&gt;size();\n        default:\n            break;\n        }\n    }\n    return QVariant();\n}\n</code></pre>\n\n<p>i think its will look like this:</p>\n\n<pre><code>Model::Model(QObject *parent) : QAbstractItemModel(parent)\n{\n    docs = new QList&lt;Doc*&gt;();\n    for (int i = 0; i &lt; 3; ++i) {\n        Doc *d = new Doc();\n        d-&gt;name = \"name_\" + QString::number(i);\n        d-&gt;number = i;\n        for (int j = 5; j &lt; 9; ++j) {\n            Stage *s = new Stage();\n            s-&gt;name = \"name_\" + QString::number(j);\n            s-&gt;number = j;\n            d-&gt;stages-&gt;append(s);\n        }\n        docs-&gt;append(d);\n    }\n}\n\n\nQModelIndex Model::index(int row, int column, const QModelIndex &amp;parent) const\n{\n    if (!parent.isValid()) {\n        Doc *d = docs-&gt;at(row);\n        return createIndex(row, column, d);\n    } else {\n        Stage *s = static_cast&lt;Doc*&gt;(parent.internalPointer())-&gt;stages-&gt;at(row);\n        return createIndex(row, column, s);\n    }\n    return QModelIndex();\n}\n\nQModelIndex Model::parent(const QModelIndex &amp;index) const\n{\n    if (!index.isValid())\n        return QModelIndex();\n    else if (index.parent().isValid())\n        return createIndex(index.parent().row(), 0, index.internalPointer());\n    return QModelIndex();\n}\n\nint Model::rowCount(const QModelIndex &amp;parent) const\n{\n    int cnt = 0;\n    if (!parent.isValid()) {\n        cnt = docs-&gt;size();\n    } else {\n        cnt = static_cast&lt;Doc*&gt;(parent.parent().internalPointer())-&gt;stages-&gt;size();\n    }\n    return cnt;\n}\n</code></pre>\n\n<p>but its wrong code...</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 3, "creation_date": 1552487699, "post_id": 55144408, "comment_id": 97029345, "body": "Step through the code in a debugger and examine how the variables change in each step."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1552487720, "post_id": 55144408, "comment_id": 97029361, "body": "It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> and <a href=\"http://idownvotedbecau.se/nodebugging/\" rel=\"nofollow noreferrer\">Debugging Guide</a>"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 5, "creation_date": 1552487772, "post_id": 55144408, "comment_id": 97029404, "body": "Where is <code>temp</code> assigned (or, even, initialized)?"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 2, "creation_date": 1552487995, "post_id": 55144408, "comment_id": 97029574, "body": "Think about your algorithm. Why do you have two loops, one inside the other? What does that achieve? You only need one loop to reverse a sequence."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1552488161, "post_id": 55144408, "comment_id": 97029688, "body": "You need to find some better collaborators if no-one you&#39;ve shown this to can find a problem."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1552488273, "post_id": 55144408, "comment_id": 97029778, "body": "Here&#39;s the algorithm you need. Loop through the array but only go half way. Swap each element with the corresponding element at the other end of the array, so first array element is swapped with last array element, second array element is swapped with second last array element etc. It&#39;s common sense really. You&#39;re probably thinking to much about C++, first you need to think in <i>general terms</i> how to do something, then you need to think how to translate that into C++."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1552492515, "post_id": 55144408, "comment_id": 97032818, "body": "<a href=\"https://en.cppreference.com/w/cpp/algorithm/reverse\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/algorithm/reverse</a>"}], "answers": [{"tags": [], "owner": {"reputation": 157, "user_id": 7200139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab71a47ac7bc3fc13e3943318577e46?s=128&d=identicon&r=PG&f=1", "display_name": "Dimfred", "link": "https://stackoverflow.com/users/7200139/dimfred"}, "is_accepted": false, "score": 1, "last_activity_date": 1552495382, "last_edit_date": 1552495382, "creation_date": 1552488316, "answer_id": 55144666, "question_id": 55144408, "link": "https://stackoverflow.com/questions/55144408/reversing-array-but-only-one-element-is-returning/55144666#55144666", "title": "Reversing array but only one element is returning", "body": "<p>This would be faster. You just traverse half of the array and switch the elements don't do n\u00b2 traversion, this is definitely not needed here. </p>\n\n<pre><code>void reverse() {\n  const int size = 9;\n  int arr[size] = {1, 4, 10, 16, 34, 7, 8, 9, 11};\n\n  int back = size - 1;\n  int temp;\n  for( int i = 0; i &lt; size / 2; ++i)\n  {\n     temp = arr[i];\n     arr[i] = arr[back];\n     arr[back--] = temp;\n  }\n  for( auto n : arr )\n    std::cout &lt;&lt; n &lt;&lt; \" \";\n  std::cout &lt;&lt; std::endl;\n</code></pre>\n\n<p>}</p>\n\n<p>to your code:</p>\n\n<pre><code>void reverse() {\n  int temp;\n  const int size = 9;\n  int arr[size] = {1, 4, 10, 16, 34, 7, 8, 9, 11};\n  for (int i=0; i &lt;size-1; i++){\n    for (int j=size-1; j&gt;=0; j--){ // here every element is set to \n    // temp, but temp isn initialized so they are set to a random value. \n    // Try setting temp to 0 and look what happens your whole array should \n    // become 0.\n      arr[j]= temp; \n      arr[i] = temp;\n    }\n  }\n  for(int x= 0; x&lt;size; x++){\n    std::cout&lt;&lt;arr[x]&lt;&lt; \" \";\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 704, "user_id": 8801881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1053cd1123d3bf1c159b18b97cf9c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Hemil", "link": "https://stackoverflow.com/users/8801881/hemil"}, "edited": false, "score": 0, "creation_date": 1552493893, "post_id": 55145475, "comment_id": 97033799, "body": "Thank you for mentioning std::reverse"}], "tags": [], "owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "is_accepted": false, "score": 2, "last_activity_date": 1552490623, "creation_date": 1552490623, "answer_id": 55145475, "question_id": 55144408, "link": "https://stackoverflow.com/questions/55144408/reversing-array-but-only-one-element-is-returning/55145475#55145475", "title": "Reversing array but only one element is returning", "body": "<p>I suggest you use an algorithm of the std, namely <code>std::reverse</code>. You don't have to invent an algorithm, that reverts an array.</p>\n\n<p>Thus your code is reduced to </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;array&gt;\n#include &lt;algorithm&gt;\n\nvoid reverse() {\n    std::array&lt;int, 9&gt; arr{1, 4, 10, 16, 34, 7, 8, 9, 11};\n    std::reverse(arr.begin(), arr.end());\n    for (const auto&amp; item : arr) {\n        std::cout &lt;&lt; item &lt;&lt; \" \";\n    }\n}\n\nint main() {\n    reverse();\n    return 0;\n}\n</code></pre>\n\n<p>Choosing proper container and algorithm form the standard library will significantly enhance the quality (in terms of bugs, readability, ...) and speed up you development. Furthermore, in most cases the runtime of your program will be shorter as well. </p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 1574173, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d03fdacaefda3557461da7efd6ba4d78?s=128&d=identicon&r=PG", "display_name": "poojakz", "link": "https://stackoverflow.com/users/1574173/poojakz"}, "is_accepted": false, "score": 1, "last_activity_date": 1552491167, "creation_date": 1552491167, "answer_id": 55145667, "question_id": 55144408, "link": "https://stackoverflow.com/questions/55144408/reversing-array-but-only-one-element-is-returning/55145667#55145667", "title": "Reversing array but only one element is returning", "body": "<pre><code>    #include&lt;iostream&gt; \n    using namespace std;\n    void reverse() {\n      int temp;\n      const int size = 9;\n      int arr[size] = {1, 4, 10, 16, 34, 7, 8, 9, 11};\n      for (int i=0, j =size-1; i &lt;j ; i++, j--)\n      {\n        temp = arr[i];\n        arr[i] =  arr[j];\n        arr[j] = temp;\n      }\n      for(int x= 0; x&lt;size; x++){\n        std::cout&lt;&lt;arr[x]&lt;&lt; \" \";\n      }\n    }\n\n    int main () {\n\n      reverse();\n      return 0;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 5792895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f309bcd896210616042e00264a44af7?s=128&d=identicon&r=PG&f=1", "display_name": "helloworld134", "link": "https://stackoverflow.com/users/5792895/helloworld134"}, "is_accepted": false, "score": 1, "last_activity_date": 1552491444, "creation_date": 1552491444, "answer_id": 55145772, "question_id": 55144408, "link": "https://stackoverflow.com/questions/55144408/reversing-array-but-only-one-element-is-returning/55145772#55145772", "title": "Reversing array but only one element is returning", "body": "<p>The variable 'temp' in your code is not initialised. </p>\n\n<p>// I think this is what you are trying to do.</p>\n\n<pre><code>temp = arr[i];\narr[i] = arr[j];\narr[j] = temp;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 529, "user_id": 9599861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sabeen kanwal", "link": "https://stackoverflow.com/users/9599861/sabeen-kanwal"}, "is_accepted": false, "score": 1, "last_activity_date": 1552501064, "creation_date": 1552501064, "answer_id": 55148777, "question_id": 55144408, "link": "https://stackoverflow.com/questions/55144408/reversing-array-but-only-one-element-is-returning/55148777#55148777", "title": "Reversing array but only one element is returning", "body": "<p>check this one to reverse ur array..</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nvoid reverse() {\n  int temp;\n  const int size = 9;\n  int arr[size] = {1, 4, 10, 16, 34, 7, 8, 9, 11};\n  for (int i=8; i&gt;=0; i--){\n\n\n//   cout&lt;&lt;arr[i]&lt;&lt; \" \";\n   std::cout&lt;&lt;arr[i]&lt;&lt; \" \";\n  }\n\n}\n\nint main () {\n\n  reverse();\n  return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pEPm9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pEPm9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10873020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-M1lXO5DX4xg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcahqOpE1rG1Q1cXLlzmaI9JjrTTCQ/mo/photo.jpg?sz=128", "display_name": "Elle", "link": "https://stackoverflow.com/users/10873020/elle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1552501064, "creation_date": 1552487637, "question_id": 55144408, "link": "https://stackoverflow.com/questions/55144408/reversing-array-but-only-one-element-is-returning", "title": "Reversing array but only one element is returning", "body": "<p>I'm trying to reverse an array and I think the for loop is wrong but everyone I've shown it to doesn't see a problem. </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid reverse() {\n  int temp;\n  const int size = 9;\n  int arr[size] = {1, 4, 10, 16, 34, 7, 8, 9, 11};\n  for (int i=0; i &lt;size-1; i++){\n    for (int j=size-1; j&gt;=0; j--){\n      arr[j]= temp;\n      arr[i] = temp;\n    }\n  }\n  for(int x= 0; x&lt;size; x++){\n    std::cout&lt;&lt;arr[x]&lt;&lt; \" \";\n  }\n}\n\nint main () {\n\n  reverse();\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "class", "object"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552487527, "post_id": 55144231, "comment_id": 97029216, "body": "C++ arrays don&#39;t let you copy them very easily. You need to do a per-element copy. You can just use <a href=\"https://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a> instead which acts like any other value type."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552487568, "post_id": 55144231, "comment_id": 97029242, "body": "If you can I would suggest getting a matrix library or writing your own matrix class.  Then you have a &quot;first class&quot; object that is easy to pass around, instead of raw arrays which have a lot of complications."}], "owner": {"reputation": 481, "user_id": 4921101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de2f06ac49c178875eadca53415555b?s=128&d=identicon&r=PG&f=1", "display_name": "varlotbarnacle", "link": "https://stackoverflow.com/users/4921101/varlotbarnacle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1552487584, "answer_count": 0, "score": 0, "last_activity_date": 1552489003, "creation_date": 1552487149, "last_edit_date": 1552489003, "question_id": 55144231, "link": "https://stackoverflow.com/questions/55144231/how-to-pass-a-3-d-array-into-an-class-constructor", "closed_reason": "Duplicate", "title": "How to pass a 3-D array into an class constructor", "body": "<p>I am trying to define a 3-D array in my main-loop, then pass it to my class constructor so that it can be assigned to a new variable when my class constructor is called. I'm having trouble with how to do this, the error I'm receiving: </p>\n\n<p><code>error: incompatible types in assignment of \u2018float (*)[1][3]\u2019 to \u2018float [1][1][3]\u2019 uav_wpts = waypoints;</code></p>\n\n<p>And my code (I just tried to isolate the problem here):</p>\n\n<p>\"uav_gnc.cpp\"</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    ros::init(argc, argv, \"uav_gnc\");\n    std::vector&lt;std::thread&gt; uav_thread_vec; \n\n    // define 3-D array: rows are UAVs, columns are waypoints (each dimension 3)\n    float waypoints[num_quads][wpt_num][3] = {\n        {{-3.0, -2.0, 2.5}}\n    }; \n\n    // Spawn quacopter objects in own threads, put threads in a vector\n    for(int i=1; i&lt;=(num_quads); i++){\n        std::thread tn(test_call, i, waypoints);\n        uav_thread_vec.push_back(std::move(tn));\n    }\n\n    // Cleanup\n    for (std::thread &amp; th : uav_thread_vec)\n    {\n        if(th.joinable()){\n            th.join();\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>\"My thread function\"</p>\n\n<pre><code>void test_call(int id, float waypoints[][wpt_num][3]){\n    // float uav_specific_waypoints = waypoints[(id-1)];\n    std::string quad_id = std::to_string(id);\n    std::string node_name = \"uav\"+quad_id;\n\n    ROS_INFO_STREAM(\"Spawn thread: \"+node_name);\n    ros::NodeHandle nh(node_name);\n    GNC uav(&amp;nh, id, waypoints, wpt_num);\n\n    run_quad_ops(&amp;uav);\n}\n</code></pre>\n\n<p>\"My class: uav_gnc.h\"</p>\n\n<pre><code>class GNC\n{\nprivate:\n    int uav_num;\n    int total_wpts;\n    int curr_wpt = 0;\n    float uav_wpts[num_quads][wpt_num][3];\n\npublic:\n    quad_lab::cc_state cc_cmd;\n    GNC(ros::NodeHandle *node_handle, int id, float waypoints[num_quads][wpt_num][3], int wpts);\n\n//\n// Member Functions\n//\n\nGNC::GNC(ros::NodeHandle *node_handle, int id, float waypoints[][wpt_num][3], int wpts):nh_(*node_handle)\n{\n    uav_wpts = waypoints;\n    total_wpts = wpts;\n    uav_num = id;\n}\n</code></pre>\n\n<p>It would be fantastic if I knew how to take a specific row of my 3-D array and pass that by reference into my thread call and then into my class constructor and finally assign it to <code>uav_wpts</code>. Maybe I'm naive, or maybe I've spent too much time with Python. Can this be done?</p>\n\n<p>Thanks for the help!</p>\n\n<p>@Fran\u00e7ois Andrieux, I also need to know how to pass this array by reference into my class constructor.</p>\n"}, {"tags": ["c++", "file-handling"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1552487139, "post_id": 55144181, "comment_id": 97028902, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/12929378/difference-between-iosapp-and-iosate\" title=\"difference between iosapp and iosate\">stackoverflow.com/questions/12929378/&hellip;</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1552487695, "post_id": 55144181, "comment_id": 97029336, "body": "Try <code>ofstream</code> instead of <code>fstream</code>. Also check whether your operations are successful."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552487838, "post_id": 55144181, "comment_id": 97029450, "body": "@NathanOliver it&#39;s a different issue <a href=\"http://coliru.stacked-crooked.com/a/256cacac707b9397\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/256cacac707b9397</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1552487954, "post_id": 55144181, "comment_id": 97029546, "body": "Also please make sure you do not post sreenshots of text files, much less acreenshot of <i>empty</i> text files."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8785293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368fe080bfc5d2bcbce26056554a3f83?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Rai", "link": "https://stackoverflow.com/users/8785293/pranjal-rai"}, "edited": false, "score": 0, "creation_date": 1552492069, "post_id": 55144517, "comment_id": 97032475, "body": "I tried this, (even copied and pasted the exact code) and my file is truncated after each execution. All that is written is the most recent entry."}, {"owner": {"reputation": 3522, "user_id": 4964791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVT1l.jpg?s=128&g=1", "display_name": "RamblinRose", "link": "https://stackoverflow.com/users/4964791/ramblinrose"}, "reply_to_user": {"reputation": 11, "user_id": 8785293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368fe080bfc5d2bcbce26056554a3f83?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Rai", "link": "https://stackoverflow.com/users/8785293/pranjal-rai"}, "edited": false, "score": 0, "creation_date": 1552492744, "post_id": 55144517, "comment_id": 97033004, "body": "Use fstream::app to append, as noted in the first comment by NathanOliver.  I&#39;ve amended the code accordingly."}], "tags": [], "owner": {"reputation": 3522, "user_id": 4964791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVT1l.jpg?s=128&g=1", "display_name": "RamblinRose", "link": "https://stackoverflow.com/users/4964791/ramblinrose"}, "is_accepted": false, "score": 1, "last_activity_date": 1586719291, "last_edit_date": 1586719291, "creation_date": 1552487931, "answer_id": 55144517, "question_id": 55144181, "link": "https://stackoverflow.com/questions/55144181/unable-to-write-into-text-file-using-iosate-in-c/55144517#55144517", "title": "Unable to write into text file using ios:ate in c++", "body": "<p>You code assumes the file exists. you're not specifying an i/o direction, and you should <em>always</em> check whether an operation, e.g. <code>file.open</code>, succeeds.</p>\n\n<pre><code>int main()\n{\n    fstream file;\n\n// open or create file if it doesn't exist, append.\n    file.open(\"text.txt\", fstream::out | fstream::app);\n\n// did the file open?\n    if (file.is_open()) {\n        char a;\n\n        while (1) {\n            cin.get(a);\n            if (a != '0')\n                file &lt;&lt; a;\n            else break;\n        }\n\n        file.close();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8785293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368fe080bfc5d2bcbce26056554a3f83?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Rai", "link": "https://stackoverflow.com/users/8785293/pranjal-rai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1586719291, "creation_date": 1552487017, "last_edit_date": 1552945787, "question_id": 55144181, "link": "https://stackoverflow.com/questions/55144181/unable-to-write-into-text-file-using-iosate-in-c", "title": "Unable to write into text file using ios:ate in c++", "body": "<p>I am using Visual Studio 2017 to practice C++, I have had some experience of C++ on TurboC++.\nTrying to create a program that reads and writes from file, I am having trouble when I use the \"ios::Ate\" while opening the file.</p>\n\n<blockquote>\n  <p>file.open(\"text.txt\", ios::ate);</p>\n</blockquote>\n\n<p>My code is as follows.</p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\nusing namespace std;\n\nint main()\n{\n    fstream file;\n    file.open(\"text.txt\", ios::ate);\n\n    char a;\n\n    while(1){\n        cin.get(a);\n        if (a != '0')\n            file &lt;&lt; a;\n        else break;\n    }\n\n    file.close();\n}\n</code></pre>\n\n<p>When I run this program, is runs without errors but when I open the file it is empty.</p>\n\n<p>I have tried using ios::out and it works fine but I do not want to truncate the file every time I want to write into it.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552485712, "post_id": 55143704, "comment_id": 97027780, "body": "I don&#39;t know of any compile-time system for this. I assume some static analyzers do it. In my experience a runtime <code>assert</code> is enough for most cases. Edit : Note that different types have different guaranties regarding their post-move state. Many standard types are perfectly fine to use, but have had their values set to some known &quot;empty&quot; state. So it might be harder than you think to implement such a check."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1552485912, "post_id": 55143704, "comment_id": 97027935, "body": "Easy rule: Don&#39;t let them use <code>std::move</code>, and if absolutely they have to, put that variable in a scope so it will not be available outside of the scope it was needed and can&#39;t be used."}, {"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 4, "creation_date": 1552485940, "post_id": 55143704, "comment_id": 97027958, "body": "Using a static analyzer like  clang-tidy can help you in finding problematic parts of the code. (<a href=\"https://clang.llvm.org/extra/clang-tidy/checks/bugprone-use-after-move.html\" rel=\"nofollow noreferrer\">clang-tidy: bugprone-use-after-move</a>)."}, {"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1552486062, "post_id": 55143704, "comment_id": 97028055, "body": "The tool does not need to be cross platform, but you should make it available/enforced in your code reviewing process, as part of e.g. your CI or pull request."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 4, "creation_date": 1552486160, "post_id": 55143704, "comment_id": 97028120, "body": "Exactly what do you mean by &quot;use after move&quot; mistake? Reading from a moved-from object? Do you have problems with own types, or <code>std</code>? If own types, you can put the object into a state, which can be asserted on afterwards."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1552486497, "post_id": 55143704, "comment_id": 97028387, "body": "Another option is to not allow <code>std::move</code> at all outside of member initialization lists or lambda captures.  If you have a case where you need to create an object, do some stuff to it, and then move it off somewhere, you can easily encapsulate that into a function or lambda and have the value returned to the thing it needs to move to and since it will be an rvalue the move will happen automatically.  Not sure if this is actually good advice, but it might be worth looking into."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 2, "creation_date": 1552486912, "post_id": 55143704, "comment_id": 97028699, "body": "Generally, I don&#39;t think there&#39;s anything wrong with <i>use-after-move</i>. Consider common generic swap, such as: <code>template &lt;typename T&gt; void swap(T&amp; a, T&amp; b) { T c(std::move(a)); a = std::move(b); b = std::move(c); }</code> (<a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/move.h#L193\" rel=\"nofollow noreferrer\">e.g., libstdc++ impl</a>). First, <code>a</code> is moved-from and then its move/copy assignment operator is invoked (i.e. <code>a</code> is used after move). Do you want the tool you are looking for to warn you about every swap?"}, {"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 3, "creation_date": 1552487379, "post_id": 55143704, "comment_id": 97029098, "body": "@DanielLangr That&#39;s not really a use after move, at least not what is normaly referre to if you talk about user after move, you re assign <code>a</code> after you moved from it, but you do not use it after move. A <code>a.foo()</code> would be a user after move."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1552487415, "post_id": 55143704, "comment_id": 97029126, "body": "Are you asking about <code>std::</code> types which only promise &quot;valid but unspecified state&quot; after being moved-from? Or other libraries&#39; types where moved-from objects may be in invalid states? Or your own types?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1552487444, "post_id": 55143704, "comment_id": 97029145, "body": "@t.niese what&#39;s the <code>=</code>, if not a use? remember it is also expressible as <code>a.operator=(std::move(b));</code>"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "reply_to_user": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1552487634, "post_id": 55143704, "comment_id": 97029294, "body": "@t.niese IIRC, you are also allowed to call some member functions for <code>std::</code> objects in unspecified state. Such as <code>std::vector::capacity</code> or <code>::size</code>. See, e.g., this answer: <a href=\"https://stackoverflow.com/a/9168917/580083\">stackoverflow.com/a/9168917/580083</a>."}, {"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1552488042, "post_id": 55143704, "comment_id": 97029607, "body": "@DanielLangr That&#39;s true. But if a class is move assignable and it compiles, then it should be valid to be used (or the class design is broken). But for a <code>a.foo()</code> the user needs to look at the documentation, if it is valid to call the function (if it does not have any preconditions). So for a correctly implemented class the compiler should be able to tell you if <code>a = std::move(b);</code> is valid."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1552488360, "post_id": 55143704, "comment_id": 97029824, "body": "&quot;find these mistake to be all-too-easy for developers to make&quot;. I personally don&#39;t think so. It&#39;s way much more easy to get a dangling reference or work with an expired temporary. Personal opinion. And that doesn&#39;t mean it&#39;s not interesting to find a solution."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1552488405, "post_id": 55143704, "comment_id": 97029848, "body": "@t.niese The same could be said of default constructors. <code>std::vector&lt;int&gt; ints; ints[0];</code>  is undefined behaviour. Should we ban default constructors? or <code>[]</code>? The thing about &quot;valid but unspecified state&quot; is that you can call <i>exactly only</i> the members with no preconditions safely."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1552493458, "post_id": 55143704, "comment_id": 97033516, "body": "what is &quot;use after move&quot;?  how can it be a mistake? Where is your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> ?"}], "answers": [{"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 2, "last_activity_date": 1552491252, "creation_date": 1552491252, "answer_id": 55145700, "question_id": 55143704, "link": "https://stackoverflow.com/questions/55143704/is-there-an-authoritative-way-to-guard-against-use-after-move-mistakes-in-c/55145700#55145700", "title": "Is there an authoritative way to guard against &quot;use after move&quot; mistakes in c++?", "body": "<p>So the issue really is \"read\" after move. I think I agree that any use of std::move should be code reviewed as a potential risk. If the std::move is at the end of a function with a local value or value parameter, all good.</p>\n\n<p>Anything else needs scrutiny, and any use of the variable after the move should be given attention. I guess giving the variable an \"_movable\" suffix will also help with the code review. </p>\n\n<p>The few cases of write after move, such as swap will just have to be defended during the review.</p>\n\n<p>Personally, I still treat std::move as a smell in the code, much like casts.</p>\n\n<p>I'm not sure of any lint rules that would enforce this pattern, but I'm sure they are easy to write :-)</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1552494650, "last_edit_date": 1552494650, "creation_date": 1552493543, "answer_id": 55146488, "question_id": 55143704, "link": "https://stackoverflow.com/questions/55143704/is-there-an-authoritative-way-to-guard-against-use-after-move-mistakes-in-c/55146488#55146488", "title": "Is there an authoritative way to guard against &quot;use after move&quot; mistakes in c++?", "body": "<p>An effective rule of thumb: Never use <code>std::move</code> nor <code>std::forward</code> and never type cast to an rvalue (or universal) reference. If you never move from a variable or a reference, then you can't make the mistake of using it after. This approach obviously has a drawback, since those utilities are useful in some cases for turning a copy into a move when the move is sufficient; not to mention the cases where it is necessary.</p>\n\n<p>Approach for your own types: Add assertions into member functions that verify whether the instance has been moved from, and rely on them to trigger during testing. The \"moved\" state will need to be stored as a member. Assertions and the member can be removed in release build. A drawback is that this adds otherwise unnecessary boilerplate to every member function.</p>\n\n<p>An extra approach: Use a static analysis tool that attempts to detect the potential mistake.</p>\n\n<p>A reasonable rule of thumb: Keep your functions short. When the function is short, a use will be close to the move, and thus the potential mistake is easier to spot.</p>\n"}, {"comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1552501866, "post_id": 55148541, "comment_id": 97038287, "body": "Agreed, but should really be a comment!"}], "tags": [], "owner": {"reputation": 4403, "user_id": 6868543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ced262f63c87506f6e61ef2d1e692d4?s=128&d=identicon&r=PG&f=1", "display_name": "j6t", "link": "https://stackoverflow.com/users/6868543/j6t"}, "is_accepted": false, "score": 1, "last_activity_date": 1552500230, "creation_date": 1552500230, "answer_id": 55148541, "question_id": 55143704, "link": "https://stackoverflow.com/questions/55143704/is-there-an-authoritative-way-to-guard-against-use-after-move-mistakes-in-c/55148541#55148541", "title": "Is there an authoritative way to guard against &quot;use after move&quot; mistakes in c++?", "body": "<p>To ban <code>std::move</code> is short-sighted. The best way to avoid read-after-move is to <code>std::move</code> at the end of the scope that introduced the moved-from variables.</p>\n"}], "owner": {"reputation": 4089, "user_id": 625359, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6e1b6d314418caa2db1aad5f8e225037?s=128&d=identicon&r=PG", "display_name": "Darkenor", "link": "https://stackoverflow.com/users/625359/darkenor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 1, "accepted_answer_id": 55146488, "answer_count": 3, "score": 9, "last_activity_date": 1552500230, "creation_date": 1552485577, "question_id": 55143704, "link": "https://stackoverflow.com/questions/55143704/is-there-an-authoritative-way-to-guard-against-use-after-move-mistakes-in-c", "title": "Is there an authoritative way to guard against &quot;use after move&quot; mistakes in c++?", "body": "<p>I find these mistake to be all-too-easy for developers to make. Is there a best practice or authoritative way to avoid this? Is there a compiler flag or hint that works across multiple platforms?  </p>\n"}, {"tags": ["c++", "boost", "codeblocks", "wxwidgets", "ptree"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1552488888, "post_id": 55143615, "comment_id": 97030213, "body": "What version of boost are you using ?"}, {"owner": {"reputation": 111, "user_id": 3007875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/af52a582b6393ce96da386be9df53e57?s=128&d=identicon&r=PG&f=1", "display_name": "user3007875", "link": "https://stackoverflow.com/users/3007875/user3007875"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1552489504, "post_id": 55143615, "comment_id": 97030696, "body": "@rafix07  boost_1_67_0"}, {"owner": {"reputation": 111, "user_id": 3007875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/af52a582b6393ce96da386be9df53e57?s=128&d=identicon&r=PG&f=1", "display_name": "user3007875", "link": "https://stackoverflow.com/users/3007875/user3007875"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1552490011, "post_id": 55143615, "comment_id": 97031056, "body": "@rafix07 I changed, but still same crash, it doesnt catch it. &#39;catch (...)             {                 wxMessageBox(_(&quot;asdf error&quot;));                 return;             }&#39;"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1552490258, "post_id": 55143615, "comment_id": 97031223, "body": "@user3007875, as I wrote on the wx forum, try to create debug build of the library and your application. This will give you an idea of what went wrong."}, {"owner": {"reputation": 111, "user_id": 3007875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/af52a582b6393ce96da386be9df53e57?s=128&d=identicon&r=PG&f=1", "display_name": "user3007875", "link": "https://stackoverflow.com/users/3007875/user3007875"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1552490966, "post_id": 55143615, "comment_id": 97031764, "body": "@Igor Yes, I am doing that now. :)"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1552494759, "post_id": 55143615, "comment_id": 97034316, "body": "What is the reason of crash? Uncaught exception? Segmentation fault?"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1552495328, "post_id": 55143615, "comment_id": 97034632, "body": "From what I&#39;m seeing <code>mb_str()</code> returns <code>wxCharBuffer</code> now you convert this to <code>std::string</code> (please do not use <code>using namesapce std</code>). Is this <code>wxCharBuffer</code> contains buffer which is properly <code>null</code> terminated?"}, {"owner": {"reputation": 111, "user_id": 3007875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/af52a582b6393ce96da386be9df53e57?s=128&d=identicon&r=PG&f=1", "display_name": "user3007875", "link": "https://stackoverflow.com/users/3007875/user3007875"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1552552612, "post_id": 55143615, "comment_id": 97055274, "body": "@MarekR Uncaught exception. I dont know how to check if it is null terminated but it works if I run it through IDE, so I don&#39;t know why it shouldn&#39;t work when run as a standalone application..."}], "owner": {"reputation": 111, "user_id": 3007875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/af52a582b6393ce96da386be9df53e57?s=128&d=identicon&r=PG&f=1", "display_name": "user3007875", "link": "https://stackoverflow.com/users/3007875/user3007875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552489575, "creation_date": 1552485327, "last_edit_date": 1552489575, "question_id": 55143615, "link": "https://stackoverflow.com/questions/55143615/boost-ptree-read-ini-crashes-standalone-application", "title": "boost ptree read_ini crashes standalone application", "body": "<p>I am using CodeBlocks and wxWidgets with minGW compiler on Windows. Under project's build options->search directories->compiler I have boost root folder, and under resource compiler wxWidgets-3.1.2/include folder.</p>\n\n<p>When running application through CodeBlocks, the program runs fine with no error. But when I run .exe file of the application (from project_dir/bin), the application crashes at line read_ini (inbetween message boxes).</p>\n\n<p>This is part of the code which I think is relevant:</p>\n\n<pre><code>#include &lt;boost/property_tree/ini_parser.hpp&gt;\nboost::property_tree::ptree tree;\nint result = FileDialog1-&gt;ShowModal();\nif (result == wxID_OK)\n{\n    string f;\n    try\n    {\n        f = string((FileDialog1-&gt;GetPath()).mb_str());\n        try\n        {\n            wxMessageBox(_(\"asdf0 \"));\n            read_ini(f, tree);\n            wxMessageBox(_(\"asdf1\"));\n        }\n        catch (exception e)\n        {\n            wxMessageBox(_(\"Can't read file.\"));\n            return;\n        }\n</code></pre>\n\n<p>I have no idea how to fix this or where to start. I tried googling a bit, but no luck so far.</p>\n\n<p>I will hugely appreciate any help. Let me know if you need more info.</p>\n"}, {"tags": ["c++", "g++", "std"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 5, "creation_date": 1552484542, "post_id": 55143269, "comment_id": 97026959, "body": "<code>x</code> is uninitialized. You shouldn&#39;t have any expectations to its value. (This is <a href=\"https://stackoverflow.com/a/4105123/1505939\">U.B.</a>, strictly speaking.) So, the answer could be &quot;Why not.&quot; ;-)"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552484815, "post_id": 55143269, "comment_id": 97027151, "body": "<i>&quot;Now, the x printed is always equal to zero.&quot;</i> Only as far as you&#39;ve tested it. It&#39;s undefined behavior, so it could act differently on other platforms, with other compilers or for no apparent reason."}, {"owner": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1552485029, "post_id": 55143269, "comment_id": 97027311, "body": "Try initializing<code>x</code> with a value.  e.g.  <code>int x = 1</code>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1552485234, "post_id": 55143269, "comment_id": 97027472, "body": "Interesting (insofar that looking at undefined behaviour is interesting). What does the generated assembly tell you about it <i>always</i> being zero in the second case?"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1552486148, "post_id": 55143269, "comment_id": 97028105, "body": "Is there a general-purpose duplicate for &quot;why is my undefined behaviour behaving undefinedly&quot; questions?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1552486372, "post_id": 55143269, "comment_id": 97028294, "body": "@Useless duplicate? <a href=\"https://stackoverflow.com/q/54120862/5470596\">stackoverflow.com/q/54120862/5470596</a>"}, {"owner": {"reputation": 119, "user_id": 3732445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c5ff682e41dcfa713d38d79e3ac2a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3732445", "link": "https://stackoverflow.com/users/3732445/user3732445"}, "edited": false, "score": 0, "creation_date": 1552489611, "post_id": 55143269, "comment_id": 97030774, "body": "it is a compiler dependent thing as far as I see"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 3732445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c5ff682e41dcfa713d38d79e3ac2a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3732445", "link": "https://stackoverflow.com/users/3732445/user3732445"}, "edited": false, "score": 0, "creation_date": 1552489574, "post_id": 55143459, "comment_id": 97030744, "body": "Yes, it might be the compiler issue. Because on my Mac with g++ (Apple LLVM version 10.0.0 (clang-1000.10.44.4)) the behavior is different."}], "tags": [], "owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "is_accepted": false, "score": 2, "last_activity_date": 1552485704, "last_edit_date": 1552485704, "creation_date": 1552484892, "answer_id": 55143459, "question_id": 55143269, "link": "https://stackoverflow.com/questions/55143269/why-does-stdendl-assign-zero-to-an-unitialized-variable/55143459#55143459", "title": "Why does std:endl assign zero to an unitialized variable?", "body": "<p>With gcc 5.4.0 on Ubuntu 16.04 I'm getting <code>0</code> in both versions of your code. But that doesn't matter since <code>x</code> is uninitialized and trying to read it is undefined behavior. Anything may happen depending on the particular compiler and system being used with no guarantee for any particular behavior. </p>\n\n<p>Now consider the following:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid foo() {\n    int x;\n    std::cout &lt;&lt; x &lt;&lt; std::endl;\n}\n\nvoid bar() {\n    int y = 123;\n    std::cout &lt;&lt; y &lt;&lt; std::endl;\n}\n\nint main() {\n    foo();\n    bar();\n    foo();\n\n    return 0;\n}\n</code></pre>\n\n<p>On my machine it prints:</p>\n\n<pre><code>0\n123\n123\n</code></pre>\n\n<p>So my guess is that my compiler does zero initialization of stack area before program starts but doesn't bother to do so later to avoid unnecessary works.</p>\n\n<p>But as I pointed out before, these behaviors are undefined. There is no requirement from standard regarding this and as a result we must not assume anything specific to happen always.</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 3732445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c5ff682e41dcfa713d38d79e3ac2a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3732445", "link": "https://stackoverflow.com/users/3732445/user3732445"}, "edited": false, "score": 0, "creation_date": 1552489507, "post_id": 55143515, "comment_id": 97030700, "body": "Thanks you! The intention behind my question was to find the mechanism that led to x being 0. I am trying to learn and write fast programs so I need to know about all the details how it got set up."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 119, "user_id": 3732445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c5ff682e41dcfa713d38d79e3ac2a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3732445", "link": "https://stackoverflow.com/users/3732445/user3732445"}, "edited": false, "score": 1, "creation_date": 1552510005, "post_id": 55143515, "comment_id": 97042161, "body": "@user3732445 I doubt there&#39;s anything about writing fast programs to be learned about this."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1552485918, "last_edit_date": 1592644375, "creation_date": 1552485053, "answer_id": 55143515, "question_id": 55143269, "link": "https://stackoverflow.com/questions/55143269/why-does-stdendl-assign-zero-to-an-unitialized-variable/55143515#55143515", "title": "Why does std:endl assign zero to an unitialized variable?", "body": "<blockquote>\n<p>as expected the result printed will be unpredictable ...</p>\n<p>Now, the x printed is always equal to zero. Why is that?</p>\n</blockquote>\n<p>It is so because the behaviour is undefined.</p>\n<p>You expected the number to be &quot;unpredictable&quot;. It seems that you didn't predict the number to be zero. This should be according to your expectations.</p>\n<p>You did nothing to make the number non-zero, so why would you expect the number to be non-zero?</p>\n<p>On the other hand, you may have been expecting that the behaviour doesn't change because the change to the program seems to be unrelated. That expectation is ill-advised. Undefined behaviour is not guaranteed to be the same undefined behaviour if you change any part of the program. In fact, the behaviour is not guaranteed to be the same even if you don't change anything. On the other hand, the behaviour is also not guaranteed to be different. Nothing about the behaviour of the program is guaranteed. That is what undefined behaviour means.</p>\n"}, {"tags": [], "owner": {"reputation": 1069, "user_id": 6002613, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zXlVLOKMF2E/AAAAAAAAAAI/AAAAAAAAAAA/IsGXYuxy-VE/photo.jpg?sz=128", "display_name": "Soulimane Mammar", "link": "https://stackoverflow.com/users/6002613/soulimane-mammar"}, "is_accepted": false, "score": -1, "last_activity_date": 1552486124, "creation_date": 1552486124, "answer_id": 55143870, "question_id": 55143269, "link": "https://stackoverflow.com/questions/55143269/why-does-stdendl-assign-zero-to-an-unitialized-variable/55143870#55143870", "title": "Why does std:endl assign zero to an unitialized variable?", "body": "<p>It's undefined behavior what you get is compiler call\nWith Microsfot Visual C++ it doesn't even compile (error C4700: uninitialized local variable 'x' used)</p>\n"}], "owner": {"reputation": 119, "user_id": 3732445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c5ff682e41dcfa713d38d79e3ac2a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3732445", "link": "https://stackoverflow.com/users/3732445/user3732445"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "closed_date": 1552489638, "answer_count": 3, "score": -1, "last_activity_date": 1552486801, "creation_date": 1552484389, "question_id": 55143269, "link": "https://stackoverflow.com/questions/55143269/why-does-stdendl-assign-zero-to-an-unitialized-variable", "closed_reason": "Duplicate", "title": "Why does std:endl assign zero to an unitialized variable?", "body": "<p>Please, consider the following C++ snippet:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main() {\n    int x;\n    std::cout &lt;&lt; x &lt;&lt; '\\n';\n    return 0;\n}\n</code></pre>\n\n<p>as expected the result printed will be unpredictable since the variable <code>x</code> has not been initialized. If you run it may get 458785234 and 348934610 the second time. However, if you change the code the following way:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main() {\n    int x;\n    std::cout &lt;&lt; x &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>Now, the x printed is always equal to zero. Why is that? Note the only change introduced is the <code>std::endl</code>. Can anybody explain why this assigns 0 to <code>x</code> variable?</p>\n"}, {"tags": ["c++", "boost", "caffe", "ubuntu-18.04"], "comments": [{"owner": {"reputation": 9718, "user_id": 8186898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0cEU.jpg?s=128&g=1", "display_name": "Nino Filiu", "link": "https://stackoverflow.com/users/8186898/nino-filiu"}, "edited": false, "score": 0, "creation_date": 1552510804, "post_id": 55143135, "comment_id": 97042546, "body": "Please include a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete and verifiable example</a>"}, {"owner": {"reputation": 161, "user_id": 11396171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138a79f369dc8cd43a82a03589aed7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Bauriegel", "link": "https://stackoverflow.com/users/11396171/paul-bauriegel"}, "edited": false, "score": 0, "creation_date": 1556096640, "post_id": 55143135, "comment_id": 98321309, "body": "I had the same issue recently on Ubuntu 18.10 with boost 1.67 an CUDA 10.1. I fixed the error by switching to CUDA 9.2. and gcc-7. Hope that helps."}], "answers": [{"comments": [{"owner": {"reputation": 1431, "user_id": 3468778, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/662609375/picture?type=large", "display_name": "Amin Merati", "link": "https://stackoverflow.com/users/3468778/amin-merati"}, "edited": false, "score": 0, "creation_date": 1555183234, "post_id": 55657954, "comment_id": 98024393, "body": "Thanks Museus. But I would like to use GPU to have maximum speed on Caffe"}], "tags": [], "owner": {"reputation": 13, "user_id": 8385288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eac080c01c10c14b05e6decc5c339f5?s=128&d=identicon&r=PG&f=1", "display_name": "Museus", "link": "https://stackoverflow.com/users/8385288/museus"}, "is_accepted": false, "score": 1, "last_activity_date": 1555095422, "creation_date": 1555095422, "answer_id": 55657954, "question_id": 55143135, "link": "https://stackoverflow.com/questions/55143135/error-cannot-call-member-function-impl-of-impl-pointer-in-boost/55657954#55657954", "title": "error: cannot call member function impl() of impl_pointer in boost", "body": "<p>Obviously not the best solution, but I solved this problem by enabling CPU_ONLY mode in the Makefile.config</p>\n"}], "owner": {"reputation": 1431, "user_id": 3468778, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/662609375/picture?type=large", "display_name": "Amin Merati", "link": "https://stackoverflow.com/users/3468778/amin-merati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556104177, "creation_date": 1552483996, "last_edit_date": 1552510774, "question_id": 55143135, "link": "https://stackoverflow.com/questions/55143135/error-cannot-call-member-function-impl-of-impl-pointer-in-boost", "title": "error: cannot call member function impl() of impl_pointer in boost", "body": "<p>I am trying to build a version of Caffe for object detection called <a href=\"https://github.com/weiliu89/caffe/tree/ssd\" rel=\"nofollow noreferrer\">SSD</a></p>\n\n<p>I checked out the code and I am getting the error <code>cannot call member function \u2018boost::multi_index::detail::sequenced_index_node&lt;Super&gt;::impl_pointer boost::multi_index::detail::sequenced_index_node&lt;Super&gt;::impl()</code> which seems to be related to boost library and I have installed boost as a dependency:</p>\n\n<pre><code>NVCC src/caffe/layers/cudnn_conv_layer.cu\n/usr/include/boost/multi_index/detail/seq_index_node.hpp: In instantiation of \u2018static void boost::multi_index::detail::sequenced_index_node&lt;Super&gt;::increment(boost::multi_index::detail::sequenced_index_node&lt;Super&gt;*&amp;) [with Super = boost::multi_index::detail::ordered_index_node&lt;boost::multi_index::detail::null_augment_policy, boost::multi_index::detail::index_node_base&lt;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt;, std::allocator&lt;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt; &gt; &gt; &gt;]\u2019:\n/usr/include/boost/multi_index/detail/bidir_node_iterator.hpp:55:16:   required from \u2018boost::multi_index::detail::bidir_node_iterator&lt;Node&gt;&amp; boost::multi_index::detail::bidir_node_iterator&lt;Node&gt;::operator++() [with Node = boost::multi_index::detail::sequenced_index_node&lt;boost::multi_index::detail::ordered_index_node&lt;boost::multi_index::detail::null_augment_policy, boost::multi_index::detail::index_node_base&lt;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt;, std::allocator&lt;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt; &gt; &gt; &gt; &gt;]\u2019\n/usr/include/boost/multi_index_container.hpp:269:73:   required from \u2018boost::multi_index::multi_index_container&lt;Value, IndexSpecifierList, Allocator&gt;::multi_index_container(const boost::multi_index::multi_index_container&lt;Value, IndexSpecifierList, Allocator&gt;&amp;) [with Value = std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt;; IndexSpecifierList = boost::multi_index::indexed_by&lt;boost::multi_index::sequenced&lt;boost::multi_index::tag&lt;&gt; &gt;, boost::multi_index::ordered_non_unique&lt;boost::multi_index::tag&lt;boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt;::subs::by_name, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na&gt;, boost::multi_index::member&lt;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt;, const std::__cxx11::basic_string&lt;char&gt;, &amp;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt;::first&gt;, std::less&lt;std::__cxx11::basic_string&lt;char&gt; &gt; &gt;, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na&gt;; Allocator = std::allocator&lt;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt; &gt;]\u2019\n/usr/include/boost/property_tree/detail/ptree_implementation.hpp:191:94:   required from \u2018boost::property_tree::basic_ptree&lt;Key, Data, KeyCompare&gt;::basic_ptree(const boost::property_tree::basic_ptree&lt;Key, Data, KeyCompare&gt;&amp;) [with Key = std::__cxx11::basic_string&lt;char&gt;; Data = std::__cxx11::basic_string&lt;char&gt;; KeyCompare = std::less&lt;std::__cxx11::basic_string&lt;char&gt; &gt;]\u2019\nsrc/caffe/layers/detection_output_layer.cu:220:29:   required from \u2018void caffe::DetectionOutputLayer&lt;Dtype&gt;::Forward_gpu(const std::vector&lt;caffe::Blob&lt;Dtype&gt;*&gt;&amp;, const std::vector&lt;caffe::Blob&lt;Dtype&gt;*&gt;&amp;) [with Dtype = float]\u2019\nsrc/caffe/layers/detection_output_layer.cu:302:147:   required from here\n/usr/include/boost/multi_index/detail/seq_index_node.hpp:198:23: error: cannot call member function \u2018boost::multi_index::detail::sequenced_index_node&lt;Super&gt;::impl_pointer boost::multi_index::detail::sequenced_index_node&lt;Super&gt;::impl() [with Super = boost::multi_index::detail::ordered_index_node&lt;boost::multi_index::detail::null_augment_policy, boost::multi_index::detail::index_node_base&lt;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt;, std::allocator&lt;std::pair&lt;const std::__cxx11::basic_string&lt;char&gt;, boost::property_tree::basic_ptree&lt;std::__cxx11::basic_string&lt;char&gt;, std::__cxx11::basic_string&lt;char&gt; &gt; &gt; &gt; &gt; &gt;; boost::multi_index::detail::sequenced_index_node&lt;Super&gt;::impl_pointer = boost::multi_index::detail::sequenced_index_node_impl&lt;std::allocator&lt;char&gt; &gt;*]\u2019 without object\n     impl_pointer xi=x-&gt;impl();\n                   ~~~~^~\n</code></pre>\n\n<p>Any thoughts how to rectify that?</p>\n"}, {"tags": ["python", "c++", "class", "this"], "comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1552483522, "post_id": 55142958, "comment_id": 97026217, "body": "Sadly, no. Are you trying to make a macro or something?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1552483545, "post_id": 55142958, "comment_id": 97026236, "body": "In C++ classes doesn&#39;t exist in that way. A class or structure is really nothing more than a way to group functions and variables."}, {"owner": {"reputation": 567, "user_id": 2039503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0c7f37315f74cd12254b9404c442ae8b?s=128&d=identicon&r=PG", "display_name": "NoSplitSherlock", "link": "https://stackoverflow.com/users/2039503/nosplitsherlock"}, "edited": false, "score": 3, "creation_date": 1552483576, "post_id": 55142958, "comment_id": 97026261, "body": "What are you trying to achieve?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1552483630, "post_id": 55142958, "comment_id": 97026302, "body": "C++ is not (yet) a reflective language. Aside from <code>decltype(*this)</code> which yields a reference to the static type, there&#39;s not much you can really do."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 4, "creation_date": 1552483753, "post_id": 55142958, "comment_id": 97026384, "body": "In Python, classes are values. It&#39;s not so in C++; a class doesn&#39;t exist at runtime."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1552483954, "post_id": 55142958, "comment_id": 97026504, "body": "Features usually make their way into C++ by being useful in a variety of situations and mixing well with a variety of existing features. How does this idea fare in this test? I&#39;d say it gets a pretty weak score. Not that many situations, and virtually no interaction with existing features."}, {"owner": {"reputation": 59, "user_id": 2219379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fCnnA.jpg?s=128&g=1", "display_name": "isados", "link": "https://stackoverflow.com/users/2219379/isados"}, "reply_to_user": {"reputation": 567, "user_id": 2039503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0c7f37315f74cd12254b9404c442ae8b?s=128&d=identicon&r=PG", "display_name": "NoSplitSherlock", "link": "https://stackoverflow.com/users/2039503/nosplitsherlock"}, "edited": false, "score": 0, "creation_date": 1552485954, "post_id": 55142958, "comment_id": 97027972, "body": "@NoSplitSherlock I was trying to call a thread on a member function <code>threaded_func</code> from within another member function, and I just didn&#39;t want to mention the class&#39;s name  <code>thread(&amp;Mandelbrot::threaded_func, this, x_range, y_range)</code>"}, {"owner": {"reputation": 59, "user_id": 2219379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fCnnA.jpg?s=128&g=1", "display_name": "isados", "link": "https://stackoverflow.com/users/2219379/isados"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1552486451, "post_id": 55142958, "comment_id": 97028348, "body": "@StoryTeller Noted, thanks."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1552489222, "post_id": 55142958, "comment_id": 97030466, "body": "@isados: We tend to use lambda&#39;s for that: <code>[=]{threaded_func(x_range, y_range);}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1552488979, "post_id": 55143125, "comment_id": 97030281, "body": "Why a macro? <code>using Self = C;</code> obeys the language rules, and sidesteps some of the problems you show below. <code>Self::Self</code> of course can never work."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1552489336, "post_id": 55143125, "comment_id": 97030563, "body": "@MSalters: <code>struct C {using Self = C;     Self(const Self&amp;) = default;};</code> is still wrong :-/ <code>C(const Self&amp;) = default;</code> is, but mixing too. <code>using</code> might be enough for user case though."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1552489175, "last_edit_date": 1552489175, "creation_date": 1552483963, "answer_id": 55143125, "question_id": 55142958, "link": "https://stackoverflow.com/questions/55142958/shouldnt-there-be-a-name-agnostic-class-pointer-similar-to-this-pointer-for-m/55143125#55143125", "title": "Shouldn&#39;t there be a name-agnostic class pointer similar to &#39;this&#39; pointer for member functions to refer to in C++?", "body": "<p>C++ doesn't have this kind of keyword allowing something like:</p>\n\n<pre><code>class C\n{\n    Self(const Self&amp;) = default;  // Not valid\n    ~Self() = default; // Not valid\n};\n</code></pre>\n\n<p>You could simulate it with MACRO:</p>\n\n<pre><code>class C\n{\n#define Self C\n    Self(const Self&amp;) = default;\n    ~Self() = default;\n#undef Self\n};\n</code></pre>\n\n<blockquote>\n  <p>but why not make it a feature in C++?</p>\n</blockquote>\n\n<p>You can still try to create a proposal for that.</p>\n\n<p>Whereas using it in class definition seems fine,\nusing it outside seems problematic:</p>\n\n<pre><code>C::C(const C&amp;) {} // Regular way\n\nSelf::Self(const Self&amp;) {} // Which class ?\nC::Self(const Self&amp;) {}    // Mix C and Self\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 2219379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fCnnA.jpg?s=128&g=1", "display_name": "isados", "link": "https://stackoverflow.com/users/2219379/isados"}, "edited": false, "score": 0, "creation_date": 1552486817, "post_id": 55143150, "comment_id": 97028625, "body": "Yeah pointer was the wrong word.. I meant a way to resolve the type of the enclosing class that @Yakk - Adam Nevraumont mentioned."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1552484031, "creation_date": 1552484031, "answer_id": 55143150, "question_id": 55142958, "link": "https://stackoverflow.com/questions/55142958/shouldnt-there-be-a-name-agnostic-class-pointer-similar-to-this-pointer-for-m/55143150#55143150", "title": "Shouldn&#39;t there be a name-agnostic class pointer similar to &#39;this&#39; pointer for member functions to refer to in C++?", "body": "<blockquote>\n  <p>but I'm not aware of any pointer to the class itself</p>\n</blockquote>\n\n<p>A class is not an object, so there can not be a pointer to a class.</p>\n\n<p>Within other member functions (i.e. the only places you may have access to <code>this</code> in the first place), you can refer to static member functions simply by their name:</p>\n\n<pre><code>struct S {\n    static void foo(){}\n    void bar() {\n        foo();\n    }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1552484541, "creation_date": 1552484541, "answer_id": 55143335, "question_id": 55142958, "link": "https://stackoverflow.com/questions/55142958/shouldnt-there-be-a-name-agnostic-class-pointer-similar-to-this-pointer-for-m/55143335#55143335", "title": "Shouldn&#39;t there be a name-agnostic class pointer similar to &#39;this&#39; pointer for member functions to refer to in C++?", "body": "<p>Inside a method of the class, the tokens</p>\n\n<pre><code>std::decay_t&lt;decltype(*this)&gt;\n</code></pre>\n\n<p>will evaluate to the type name of <code>this</code>.</p>\n\n<p>Outside of a method there is no similar technique.</p>\n\n<p>It isn't in the language, because nobody has gotten such a feature through the committee.  It would take work.</p>\n\n<p>A number of compilers have extensions that resolve to the \"parent class\".  I'm unaware of a compiler that has the extension for \"type of enclosing class\".</p>\n"}], "owner": {"reputation": 59, "user_id": 2219379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fCnnA.jpg?s=128&g=1", "display_name": "isados", "link": "https://stackoverflow.com/users/2219379/isados"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1552489175, "creation_date": 1552483424, "last_edit_date": 1552483533, "question_id": 55142958, "link": "https://stackoverflow.com/questions/55142958/shouldnt-there-be-a-name-agnostic-class-pointer-similar-to-this-pointer-for-m", "title": "Shouldn&#39;t there be a name-agnostic class pointer similar to &#39;this&#39; pointer for member functions to refer to in C++?", "body": "<p>In Python, there's a <code>self</code> variable that refers to the instance itself, and a <code>cls</code> object (for class methods) that refer to the class. In the same manner, there's a 'this' pointer pointing to the calling object; but I'm not aware of any pointer to the class itself, I'm familiar with using something like this...</p>\n\n<p><code>ClassName::memberFunction(this)</code> </p>\n\n<p>But it's not what I want.</p>\n\n<p>I guess it's pretty obvious that there's no such thing, given how constructors still make use of their class's name, but why not make it a feature in C++?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1552482874, "post_id": 55142738, "comment_id": 97025783, "body": "Did you actually add a function definition for <code>Test2</code>?  A link error suggest you did not."}, {"owner": {"reputation": 1134, "user_id": 2683574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e65517e8eab731bde8dac73ed7960ee?s=128&d=identicon&r=PG&f=1", "display_name": "tnt", "link": "https://stackoverflow.com/users/2683574/tnt"}, "edited": false, "score": 0, "creation_date": 1552482902, "post_id": 55142738, "comment_id": 97025801, "body": "Because if it can it will be a non-static member function?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 1134, "user_id": 2683574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e65517e8eab731bde8dac73ed7960ee?s=128&d=identicon&r=PG&f=1", "display_name": "tnt", "link": "https://stackoverflow.com/users/2683574/tnt"}, "edited": false, "score": 0, "creation_date": 1552482928, "post_id": 55142738, "comment_id": 97025823, "body": "@tntxtnt OP is using <code>pUser-&gt;Test2();</code> not <code>this-&gt;Test2();</code>. It should be fine."}, {"owner": {"reputation": 47, "user_id": 8891573, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5uh9QY4F3yA/AAAAAAAAAAI/AAAAAAAAAA8/DSqAN1tIrWQ/photo.jpg?sz=128", "display_name": "Sungsu Kim", "link": "https://stackoverflow.com/users/8891573/sungsu-kim"}, "edited": false, "score": 0, "creation_date": 1552483047, "post_id": 55142738, "comment_id": 97025892, "body": "Oh, my mistake..thank you for your advice."}, {"owner": {"reputation": 1134, "user_id": 2683574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e65517e8eab731bde8dac73ed7960ee?s=128&d=identicon&r=PG&f=1", "display_name": "tnt", "link": "https://stackoverflow.com/users/2683574/tnt"}, "edited": false, "score": 0, "creation_date": 1552483068, "post_id": 55142738, "comment_id": 97025905, "body": "<a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/tool-errors/linker-tools-error-lnk2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/error-messages/tool-errors/&hellip;</a> Maybe OP haven&#39;t defined <code>Test2()</code> yet."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1134, "user_id": 2683574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e65517e8eab731bde8dac73ed7960ee?s=128&d=identicon&r=PG&f=1", "display_name": "tnt", "link": "https://stackoverflow.com/users/2683574/tnt"}, "edited": false, "score": 2, "creation_date": 1552483122, "post_id": 55142738, "comment_id": 97025946, "body": "@tntxtnt - Clearly they haven&#39;t defined <code>Test2</code>. But what do static data members have to do with it?"}, {"owner": {"reputation": 1134, "user_id": 2683574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e65517e8eab731bde8dac73ed7960ee?s=128&d=identicon&r=PG&f=1", "display_name": "tnt", "link": "https://stackoverflow.com/users/2683574/tnt"}, "edited": false, "score": 0, "creation_date": 1552483284, "post_id": 55142738, "comment_id": 97026062, "body": "Sorry it&#39;s just something I copied from google should have posted the link. Update it now"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 1134, "user_id": 2683574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e65517e8eab731bde8dac73ed7960ee?s=128&d=identicon&r=PG&f=1", "display_name": "tnt", "link": "https://stackoverflow.com/users/2683574/tnt"}, "edited": false, "score": 1, "creation_date": 1552483574, "post_id": 55142738, "comment_id": 97026258, "body": "@tntxtnt Whenever you copy somebody else&#39;s words/work, you should use &quot;quotation formatting&quot; to indicate that it is not your words/work. Or when the words don&#39;t apply to the topic at all, maybe just don&#39;t copy them at all ;)"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8891573, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5uh9QY4F3yA/AAAAAAAAAAI/AAAAAAAAAA8/DSqAN1tIrWQ/photo.jpg?sz=128", "display_name": "Sungsu Kim", "link": "https://stackoverflow.com/users/8891573/sungsu-kim"}, "edited": false, "score": 0, "creation_date": 1552483052, "post_id": 55142784, "comment_id": 97025897, "body": "Oh, my mistake..thank you for your advice."}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 1, "last_activity_date": 1552482927, "creation_date": 1552482927, "answer_id": 55142784, "question_id": 55142738, "link": "https://stackoverflow.com/questions/55142738/why-cant-static-member-methods-access-its-non-static-method-in-c/55142784#55142784", "title": "Why can&#39;t static member methods access its non-static method in C++?", "body": "<p>LNK2019 is unresolved symbol, probably you simply forgot to implement <code>Test2()</code>. </p>\n"}], "owner": {"reputation": 47, "user_id": 8891573, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5uh9QY4F3yA/AAAAAAAAAAI/AAAAAAAAAA8/DSqAN1tIrWQ/photo.jpg?sz=128", "display_name": "Sungsu Kim", "link": "https://stackoverflow.com/users/8891573/sungsu-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "closed_date": 1552482967, "answer_count": 1, "score": -1, "last_activity_date": 1552482927, "creation_date": 1552482784, "question_id": 55142738, "link": "https://stackoverflow.com/questions/55142738/why-cant-static-member-methods-access-its-non-static-method-in-c", "closed_reason": "Duplicate", "title": "Why can&#39;t static member methods access its non-static method in C++?", "body": "<p>I had to make a callback interface for a new module while I work, so I made a static method in a class.</p>\n\n<p>One thing I still don't understand is why I can't call a non-static member method in a static member like this :</p>\n\n<pre><code>class CAdapterUser\n{\npublic:\n    CAdapterUser()          {}\n    virtual ~CAdapterUser() {}\n\n    void        Test();\n    void        Test2();\n\nprotected:\n    CAdapter    m_Adapter;\n\n    unsigned char buffer[16];\n\n    static void TestFunc(void* apContext);\n};\n\nvoid \nCAdapterUser::TestFunc( void* apContext )\n{\n//  CAdapterUser* pUser = (CAdapterUser*)apContext;\n    CAdapterUser* pUser = reinterpret_cast&lt;CAdapterUser*&gt;(apContext);\n\n    pUser-&gt;Test2();         // Compile error : LNK2019\n    pUser-&gt;buffer[0] = 1;   // Even though I can access protected member variable?\n}\n</code></pre>\n\n<p>Could someone answer my question?</p>\n"}, {"tags": ["c++", "arrays", "string", "char", "word"], "comments": [{"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 1, "creation_date": 1552482331, "post_id": 55142496, "comment_id": 97025366, "body": "I don&#39;t see any question but it looks like a job for the debugger."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1552482404, "post_id": 55142496, "comment_id": 97025419, "body": "Research <code>std::adjacent_find</code>"}, {"owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1552482404, "post_id": 55142496, "comment_id": 97025420, "body": "Can you share problem link in comment box?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552482563, "post_id": 55142496, "comment_id": 97025535, "body": "It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> and <a href=\"http://idownvotedbecau.se/nodebugging/\" rel=\"nofollow noreferrer\">Debugging Guide</a>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1552482769, "post_id": 55142496, "comment_id": 97025693, "body": "you increment <code>non_vowels</code> each time you reach a non vowel, to check the parity doesn&#39;t allow to check the if non vowels are consecutive or not. Your algorithm is wrong"}, {"owner": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1552482905, "post_id": 55142496, "comment_id": 97025803, "body": "@bruno Could you help me a bit on how I can fix it?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1552483025, "post_id": 55142496, "comment_id": 97025879, "body": "@N.T. when you reach the first non vowel after vowels (or at the beginning of the <i>zbor</i>) start a new loop to count the consecutive non vowel after it and stop at end of <i>zbor</i> or reaching a vowel. of course that second loop modify the index of the first."}, {"owner": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1552484300, "post_id": 55142496, "comment_id": 97026790, "body": "@bruno I tried simplifying it, I edited my comment, it&#39;s not working though because if I type &#39;jas&#39; it outputs 1 instead of 0 so it&#39;s still a wrong algorhithm."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1552484453, "post_id": 55142496, "comment_id": 97026900, "body": "@N.T.  Honestly, you&#39;re overcomplicating the program.  All you need to do is go through each adjacent pair of characters and if the pair matches the criteria, then add 1 to the count.  All of this division by 2 is totally unnecessary.  For example: <code>if (is_consanant(str[i]) &amp;&amp; is_consanant(str[i+1])) ++numpairs;</code>.  You just have to write the <code>is_consanant</code> function."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1552485014, "post_id": 55142496, "comment_id": 97027299, "body": "@N.T. I edited my answer, counts as you wanted now"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1552485204, "post_id": 55143286, "comment_id": 97027446, "body": "What does the &#39;size_t&#39; part mean?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1552485302, "post_id": 55143286, "comment_id": 97027524, "body": "@N.T. <code>size_t</code>is the right type rather than <i>int</i> or <i>unsigned int</i> in a lot of cases, for instance <code>string::length()</code> returns <code>a size_t</code>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1552486360, "post_id": 55143286, "comment_id": 97028291, "body": "@N.T. Here, <code>size_t</code> is the same as <code>std::size_t</code> - note the nasty <code>using namespace std;</code> near the top (and read <i><a href=\"/q/1452721/\">Why is \u201cusing namespace std\u201d considered bad practice?</a></i>)."}, {"owner": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1552487309, "post_id": 55143286, "comment_id": 97029047, "body": "We&#39;re taught in school to use &#39;using namespace std;&#39; so I am used to it, I&#39;ll change that habit though."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1552487498, "post_id": 55143286, "comment_id": 97029196, "body": "@N.T. in 15 years of C++ I <i>never</i> had a problem because of <code>using  namespace std;</code> ;-)"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1552487806, "post_id": 55143286, "comment_id": 97029431, "body": "@N.T. you have 6 answers, now you have to decide the one you accept, and may be up vote some of the others you also like ? ^^"}, {"owner": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1552488024, "post_id": 55143286, "comment_id": 97029591, "body": "@bruno Yeah... The only problem is that I&#39;m still in my 1st year of high school, and many of these codes are still a bit confusing to me. I will try to understand at least one of them and try them. Thanks everyone for the help!"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1552488374, "post_id": 55143286, "comment_id": 97029836, "body": "I recommend placing the vowels into a string, then searching the string.  If the letter is in the vowel string, it is a vowel.  Possibly more efficient than the <code>switch&#47;case</code> statement (at least less statements to type)."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1552488506, "post_id": 55143286, "comment_id": 97029922, "body": "@ThomasMatthews I was first thinking to use a string but for me the switch case is more efficient"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1552488240, "last_edit_date": 1552488240, "creation_date": 1552484434, "answer_id": 55143286, "question_id": 55142496, "link": "https://stackoverflow.com/questions/55142496/finding-pairs-of-non-vowels-in-c/55143286#55143286", "title": "Finding pairs of non_vowels in C++", "body": "<p>A proposal :</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nbool vowel(char c)\n{\n    switch (c) {\n    case 'a':\n    case 'e':\n    case 'i':\n    case 'o':\n    case 'u':\n    case 'y':\n        return true;\n    default:\n        return false;\n    }\n}\n\nint main()\n{\n    string zbor;\n\n    if (! (cin &gt;&gt; zbor))\n        return -1;\n\n    int pairs = 0;\n\n    for (size_t i = 0; i &lt; zbor.length(); ++i) {\n        if (!vowel(zbor[i])) {\n          int n = 0;\n\n          do\n            n += 1;\n          while ((++i != zbor.length()) &amp;&amp; !vowel(zbor[i]));\n\n          pairs += n - 1;\n        }\n    }\n\n    cout &lt;&lt; pairs &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Compilation and execution:</p>\n\n<pre><code>/tmp % g++ -pedantic -Wextra p.cc\n/tmp % ./a.out\njas\n0\n/tmp % ./a.out\nolovo\n0\n/tmp % ./a.out\nskok\n1\n/tmp % ./a.out\nstvarnost\n4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1552486523, "post_id": 55143448, "comment_id": 97028417, "body": "No need for the stateful <code>checker()</code> (how do you reset it for the next use?) if you simply use <code>std::adjacent_find()</code> instead."}], "tags": [], "owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "is_accepted": false, "score": 2, "last_activity_date": 1552484867, "creation_date": 1552484867, "answer_id": 55143448, "question_id": 55142496, "link": "https://stackoverflow.com/questions/55142496/finding-pairs-of-non-vowels-in-c/55143448#55143448", "title": "Finding pairs of non_vowels in C++", "body": "<p>You could easily simplify your code by using C++ features, a proposal:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;array&gt;\n#include &lt;vector&gt;\n\nconst std::array&lt;char, 5&gt; vowels = {'a', 'e', 'i', 'o', 'u'};\n\nbool isVowel(char c)\n{\n    return std::find(vowels.begin(), vowels.end(), c) != vowels.end();\n}\n\nbool checker(char c)\n{\n    static bool lastFound = false;\n\n    if (lastFound &amp;&amp; !isVowel(c))\n        return true;\n    else\n        lastFound = !isVowel(c);\n\n    return false;   \n}\n\nint main()\n{\n    std::vector&lt;char&gt; v{'s', 'k', 'o', 'k', 'a', 'k'};\n\n    int num_items = std::count_if(v.begin(), v.end(), &amp;checker);\n\n    std::cout &lt;&lt; num_items &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1552556471, "post_id": 55143682, "comment_id": 97057550, "body": "Why do we check whether the same <code>zbor [i]</code> is a vowel twice after <code>non_vowels++</code>."}, {"owner": {"reputation": 64, "user_id": 9994791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b9c36613e950f3e1f1283108a873d?s=128&d=identicon&r=PG&f=1", "display_name": "Ozzy", "link": "https://stackoverflow.com/users/9994791/ozzy"}, "reply_to_user": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "edited": false, "score": 0, "creation_date": 1554193434, "post_id": 55143682, "comment_id": 97651029, "body": "Whups, good point. Edited the code, since non-vowels are never vowels :S"}], "tags": [], "owner": {"reputation": 64, "user_id": 9994791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b9c36613e950f3e1f1283108a873d?s=128&d=identicon&r=PG&f=1", "display_name": "Ozzy", "link": "https://stackoverflow.com/users/9994791/ozzy"}, "is_accepted": true, "score": 1, "last_activity_date": 1554193296, "last_edit_date": 1554193296, "creation_date": 1552485508, "answer_id": 55143682, "question_id": 55142496, "link": "https://stackoverflow.com/questions/55142496/finding-pairs-of-non-vowels-in-c/55143682#55143682", "title": "Finding pairs of non_vowels in C++", "body": "<p>Indeed, there are several things..  </p>\n\n<ol>\n<li><p>accessing zbor[i] could be very time consuming, because it always looks up the position i again for every comparison (unless the compiler optimizes some things)</p></li>\n<li><p>the second for-loop is not needed, you can just count if the last entry was a vowel and that is all the info you need when going further through the string.</p></li>\n<li>make use of c++ features like lambdas to make your code easier readable</li>\n</ol>\n\n<p>.</p>\n\n<pre><code>auto isVowel = [](char&amp; c) {return c == 'a' || c == 'e' || c == 'i' || c == 'o' || c == 'u';};\n\nfor (int i = 0; i &lt; length; i++)\n{\n  if (isVowel(zbor[i]))\n  {\n    non_vowels = 0;\n  }\n  else\n  {\n    non_vowels++;\n\n    if (non_vowels &gt; 1)\n      pairs++;\n  }\n}\n\ncout &lt;&lt; pairs;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1552485595, "creation_date": 1552485595, "answer_id": 55143709, "question_id": 55142496, "link": "https://stackoverflow.com/questions/55142496/finding-pairs-of-non-vowels-in-c/55143709#55143709", "title": "Finding pairs of non_vowels in C++", "body": "<p>Here is a solution using <a href=\"https://en.cppreference.com/w/cpp/algorithm/adjacent_find\" rel=\"nofollow noreferrer\">std::adjacent_find</a>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;cstring&gt;\n#include &lt;string&gt;\n\nbool isConsonant(char c)\n{\n    static const char *vowels = \"aeiou\";\n    return strchr(vowels, c)?false:true;\n}\n\nint main()\n{\n    std::string s = \"stvarnost\";\n    auto it = s.begin();\n    int count = 0;\n    while (true)\n    {\n        // find the adjacent consonants\n        auto it2 = std::adjacent_find(it, s.end(), \n                                     [&amp;](char a, char b) \n                                     { return isConsonant(a) &amp;&amp; isConsonant(b); });\n        if ( it2 != s.end())\n        {\n            // found adjacent consonents, so increment count and restart at the next character.\n            ++count;\n            it = std::next(it2);\n        }\n        else\n            break;\n    }\n    std::cout &lt;&lt; count &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>4\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/1a6602c910d20b90\" rel=\"nofollow noreferrer\">Live Example</a></p>\n"}, {"comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1552488575, "post_id": 55143789, "comment_id": 97029984, "body": "Macros are evil.  For example, what is the result of <code>IS_VOWEL(3.14159264)</code>?  A function has better type checking."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1552488681, "post_id": 55143789, "comment_id": 97030069, "body": "You should prefer <code>std::string</code> as it is safer than character arrays.  You can use <code>operator[]</code> to access characters in the string."}, {"owner": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1552494211, "post_id": 55143789, "comment_id": 97033979, "body": "@ThomasMatthews I knwo macros aren&#39;t good, but it is just an example that has to be enhanced. For the string vs char arrays, if you check correctly the input you can work with it, also the whole logic behind the algorithm is pointer manipulations."}], "tags": [], "owner": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "is_accepted": false, "score": 1, "last_activity_date": 1552485822, "last_edit_date": 1592644375, "creation_date": 1552485822, "answer_id": 55143789, "question_id": 55142496, "link": "https://stackoverflow.com/questions/55142496/finding-pairs-of-non-vowels-in-c/55143789#55143789", "title": "Finding pairs of non_vowels in C++", "body": "<ol>\n<li>Optimize time: When parsing strings (char *), pass through using &quot;while&quot; instead of getting the length and using &quot;for&quot;. You get only 1 pass insteads of 2 (1 pass is already taken by strlen).</li>\n<li>Optimize code: If you have code that repeats itself, either put it in a function or a macro.</li>\n<li>Using the two points before, here is a sample code (you can handle the input management):</li>\n</ol>\n<h1>Sample</h1>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstddef&gt;\n\nusing namespace std;\n\n#define IS_VOWEL(a) ((a == 'a') || (a == 'i') || (a == 'u') || (a == 'e') || (a == 'o') || (a == 'y'))\n\nint find_pairs(char * input, char ** stop_pos)\n{\n    char * input_cursor = input;\n\n    while ((*input_cursor != 0) &amp;&amp; IS_VOWEL(*input_cursor))\n    {\n        input_cursor++;\n    }\n    size_t used_count = 0;\n    while ((*input_cursor != 0) &amp;&amp; !IS_VOWEL(*input_cursor))\n    {\n        used_count++;\n        input_cursor++;\n    }\n    *stop_pos = input_cursor;\n    if (used_count &lt; 2)\n    {\n        return 0;\n    }\n    else\n    {\n        return used_count - 1;\n    }\n}\n\nint main()\n{\n    char input[] = &quot;stvarnost&quot;;\n    char * input_cursor = input;\n    int found = 0;\n    while (*input_cursor != 0)\n    {\n        found += find_pairs(input_cursor, &amp;input_cursor);\n    }\n    cout &lt;&lt; found &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n<p>Have fun :)</p>\n"}, {"comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1552488495, "post_id": 55143831, "comment_id": 97029909, "body": "You can reduce the size of the <code>switch&#47;case</code> statement by using <code>std::toupper</code> or <code>std::tolower</code>.  Also, consider using <code>std::string</code> rather than character arrays, as arrays can overflow (or worse, they may not have a terminating nul character)."}], "tags": [], "owner": {"reputation": 11, "user_id": 6155099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16dc05cd80e58f864ae8d40635bbb07?s=128&d=identicon&r=PG&f=1", "display_name": "sabapathy", "link": "https://stackoverflow.com/users/6155099/sabapathy"}, "is_accepted": false, "score": 1, "last_activity_date": 1552485965, "creation_date": 1552485965, "answer_id": 55143831, "question_id": 55142496, "link": "https://stackoverflow.com/questions/55142496/finding-pairs-of-non-vowels-in-c/55143831#55143831", "title": "Finding pairs of non_vowels in C++", "body": "<p>I think, for the requirement, you can make the program look more simpler like below, which I tested and working for the samples you've given. Instead of getting input, I tested by hardcoding input, which you can change:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n\nusing namespace std;\n\nbool IsVowel(char ch)\n{\n    switch (ch)\n    {\n    case 'a':\n    case 'e':\n    case 'i':\n    case 'o':\n    case 'u':\n    case 'A':\n    case 'E':\n    case 'I':\n    case 'O':\n    case 'U':\n        return true;\n        //break;\n    default:\n        return false;\n    }\n\n    return false;\n}\n\nint CountNonVowelPair(char* chIn)\n{\n        char zbor[200];\n        //cin.get(zbor, 200);\n        strcpy(zbor, chIn);\n        int length = strlen(zbor);\n        int j_value = 0;\n        int check_pairs = 0;\n        int pairs = 0;\n        int non_vowels = 0;\n\n        if (length &lt;= 1)\n            return 0;\n\n        for (int i = 1; i &lt; length; i++)\n        {\n            if (IsVowel(zbor[i - 1]) || IsVowel(zbor[i]))\n                continue;\n            else\n                pairs++;\n        }\n\n        return pairs;\n}\n\nint main() \n{\n    int nRet;\n    nRet = CountNonVowelPair(\"jas\");\n    cout &lt;&lt; nRet &lt;&lt;endl;\n    nRet = CountNonVowelPair(\"olovo\");\n    cout &lt;&lt; nRet &lt;&lt;endl;\n    nRet = CountNonVowelPair(\"skok\");\n    cout &lt;&lt; nRet &lt;&lt;endl;\n    nRet = CountNonVowelPair(\"stvarnost\");\n    cout &lt;&lt; nRet &lt;&lt;endl;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 703, "user_id": 9753452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Michael Surette", "link": "https://stackoverflow.com/users/9753452/michael-surette"}, "is_accepted": false, "score": 2, "last_activity_date": 1552489920, "creation_date": 1552489920, "answer_id": 55145238, "question_id": 55142496, "link": "https://stackoverflow.com/questions/55142496/finding-pairs-of-non-vowels-in-c/55145238#55145238", "title": "Finding pairs of non_vowels in C++", "body": "<p>Here's a C++17 solution that uses string_view and adjacent_find. It's idiomatic C++, making it quite short and easy to understand.</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;string_view&gt;\nusing namespace std;\n\nbool checkPair(char a, char b)\n{\n    string_view vowels { \"aeiou\" };\n    bool aNotVowel = vowels.find(a) == string_view::npos;\n    bool bNotVowel = vowels.find(b) == string_view::npos;\n    return aNotVowel &amp;&amp; bNotVowel;\n}\n\nint main(int argc, char **argv)\n{\n    int pairs { 0 };\n    string_view input(argv[1]);\n\n    for(auto next = input.begin(); next != input.end();)\n    {\n        next = adjacent_find(next, input.end(), checkPair);\n        if(next != input.end())\n        {\n            ++pairs;\n            ++next;\n        }\n    }\n    cout &lt;&lt; pairs &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 11107763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d05aed8edca90f1656212dbc2ed926?s=128&d=identicon&r=PG&f=1", "display_name": "N.T.", "link": "https://stackoverflow.com/users/11107763/n-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 55143682, "answer_count": 7, "score": 0, "last_activity_date": 1554193296, "creation_date": 1552482001, "last_edit_date": 1552494707, "question_id": 55142496, "link": "https://stackoverflow.com/questions/55142496/finding-pairs-of-non-vowels-in-c", "title": "Finding pairs of non_vowels in C++", "body": "<p>I have a programming problem where I should make a program which will calculate the amount of pairs of letters (letters next to each other) which aren't 'a', 'e', 'i', 'o', 'u' (vowels).</p>\n\n<p>Examples:</p>\n\n<ul>\n<li><strong>jas</strong> 0</li>\n<li><strong>olovo</strong> 0</li>\n<li><strong>skok</strong> 1 (sk)</li>\n<li><strong>stvarnost</strong> 4 (st, tv, rn, st)</li>\n</ul>\n\n<p>Input consists of small letters which make a word not bigger than 200 characters, and the output should output the number of pairs of letters that aren't vowels (a, e, i, o, u).</p>\n\n<p><strong>Time limit</strong>: </p>\n\n<ul>\n<li>1 sec</li>\n</ul>\n\n<p><strong>Memory limit</strong>: </p>\n\n<ul>\n<li>64 MB</li>\n</ul>\n\n<p>Examples provided in the problem I have been given:</p>\n\n<ul>\n<li><strong>Input</strong> skok</li>\n<li><strong>Output</strong> 1</li>\n</ul>\n\n<p>However, when I enter the words 'skok' the program doesn't work (it seems to keep working in the background yet not displaying anything on screen). The word 'stvarnost' (reality) works however, displaying '4' - as given in the problem. </p>\n\n<p>Out of 10 test-cases, two test-cases give me the right output, one gives me a wrong output, and seven other test-cases tell me I have exceeded my time-limit.</p>\n\n<p>Now, I'd also like an advice on how I can avoid exceeding my given time-limit, and how to fix it in the program below.</p>\n\n<p>Here's the code I've started:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n\nusing namespace std;\n\nint main() {\n\n    char zbor[200];\n    cin.get(zbor, 200);\n    int length = strlen(zbor);\n    int j_value = 0;\n    int check_pairs = 0;\n    int pairs = 0;\n    int non_vowels = 0;\n\n    for (int i = 0; i &lt; length; i++) {\n        if (zbor[i] == 'a' || zbor[i] == 'e' || zbor[i] == 'i' || zbor[i] == 'o' || zbor[i] == 'u') {\n            continue;\n        } else {\n            non_vowels++;\n            for (int j = i + 1; j &lt; length; j++) {\n                if (zbor[j] == 'a' || zbor[j] == 'e' || zbor[j] == 'i' || zbor[j] == 'o' || zbor[j] == 'u') {\n                    break;\n                } else {\n                    non_vowels++;\n                    if (non_vowels % 2 != 0) {\n                        check_pairs = non_vowels / 2 + 1;\n                    } else {\n                        check_pairs = non_vowels / 2;\n                    }\n                    if (pairs &lt; check_pairs) {\n                        pairs++;\n                    }\n                    j_value = j;\n                }\n            }\n            i = j_value +  1;\n        }\n    }\n\n    cout &lt;&lt; pairs;\n\n    return 0;\n}\n</code></pre>\n\n<p>Edit:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n\nusing namespace std;\n\nint main() {\n\n    char zbor[200];\n    cin.get(zbor, 200);\n    int length = strlen(zbor);\n    int pairs = 0;\n    int non_vowels = 0;\n\n    for (int i = 0; i &lt; length; i++) {\n        if (zbor[i] == 'a' || zbor[i] == 'e' || zbor[i] == 'i' || zbor[i] == 'o' || zbor[i] == 'u') {\n            non_vowels = 0;\n            continue;\n        } else {\n            non_vowels++;\n            if (non_vowels &gt;= 2) {\n                if (non_vowels % 2 != 0) {\n                    pairs = non_vowels / 2 + 1;\n                } else if (non_vowels % 2 == 0) {\n                    pairs = non_vowels / 2;\n                }\n            }\n        }\n    }\n\n    cout &lt;&lt; pairs;\n\n    return 0;\n}\n</code></pre>\n\n<p>Edited the code, using pieces of code of the answers below, (<strong>bruno</strong>'s and <strong>Ozzy</strong>'s) here's the final version which works:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n\nusing namespace std;\n\nbool vowel(char c) {\n    switch(c) {\n    case 'a':\n    case 'e':\n    case 'i':\n    case 'o':\n    case 'u':\n        return true;\n    default:\n        return false;\n    }\n}\n\nint main()\n{\n\n    char zbor[200];\n    cin.get(zbor, 200);\n    int N = strlen(zbor);\n    int non_vowels = 0;\n    int pairs = 0;\n\n    for (int i = 0; i &lt; N; i++) {\n        if (!vowel(zbor[i])) {\n            non_vowels = 0;\n        } else {\n            non_vowels++;\n            if (!vowel(zbor[i])) {\n                non_vowels = 0;\n            } else {\n                non_vowels++;\n                if (non_vowels &gt; 1) {\n                    pairs++;\n                }\n            }\n        }\n    }\n\n    cout &lt;&lt; pairs;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1552481946, "post_id": 55142361, "comment_id": 97025146, "body": "Are you sure your second example works?  I don&#39;t see a declaration for <code>x</code>."}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 1, "creation_date": 1552482023, "post_id": 55142361, "comment_id": 97025194, "body": "Also, note that members will be initialized in the order that they are declared in the class; you should keep your member initializer lists in the same order to avoid accidentally invoking UB."}, {"owner": {"reputation": 43, "user_id": 10823533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa2qyVXhbgo/AAAAAAAAAAI/AAAAAAAAAFw/2B1SIXqAL5U/photo.jpg?sz=128", "display_name": "sarthak bansal", "link": "https://stackoverflow.com/users/10823533/sarthak-bansal"}, "reply_to_user": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1552548024, "post_id": 55142361, "comment_id": 97053029, "body": "@0x5453 yes it should have been declared .just edited that."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10823533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa2qyVXhbgo/AAAAAAAAAAI/AAAAAAAAAFw/2B1SIXqAL5U/photo.jpg?sz=128", "display_name": "sarthak bansal", "link": "https://stackoverflow.com/users/10823533/sarthak-bansal"}, "edited": false, "score": 0, "creation_date": 1552548221, "post_id": 55142465, "comment_id": 97053115, "body": "I get that. You said that we haven&#39;t constructed <code>this</code> yet (before the scope of constructor in initialization list) But it shouldn&#39;t work for reference variable &amp;x too. I think we can just say its how the syntax was decided ! Thankyou"}, {"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "reply_to_user": {"reputation": 43, "user_id": 10823533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa2qyVXhbgo/AAAAAAAAAAI/AAAAAAAAAFw/2B1SIXqAL5U/photo.jpg?sz=128", "display_name": "sarthak bansal", "link": "https://stackoverflow.com/users/10823533/sarthak-bansal"}, "edited": false, "score": 0, "creation_date": 1552549302, "post_id": 55142465, "comment_id": 97053655, "body": "@sarthakbansal I agree there is some inconsistency there, but it can be philosophied-away too (as most things :) ) - From context, <code>age</code> in the parenthesis should be the argument <code>age</code>, so if we did not allow <b>only</b> in the references to explicitly reference <code>this-&gt;member</code>, we could not initialize the reference (well we could, to the temporary argument, which makes no sense)! Of course it would make no sense for anything but a reference or a pointer. It does cause some confusion though."}], "tags": [], "owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "is_accepted": true, "score": 5, "last_activity_date": 1552481877, "creation_date": 1552481877, "answer_id": 55142465, "question_id": 55142361, "link": "https://stackoverflow.com/questions/55142361/this-keyword-for-const-variable-in-initialising-list/55142465#55142465", "title": "&quot;this&quot; keyword for const variable in initialising list", "body": "<p>The short answer is \"this is how it was decided the syntax would be\", but from a philosophical standpoint, you might say that <code>this-&gt;age</code> does not exist in the initializer list (since you did not construct <code>this</code> yet...). Just:</p>\n\n<pre><code>age(age)\n</code></pre>\n\n<p>is the correct syntax, and it is clear from the context which <code>age</code> is which here.</p>\n"}], "owner": {"reputation": 43, "user_id": 10823533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa2qyVXhbgo/AAAAAAAAAAI/AAAAAAAAAFw/2B1SIXqAL5U/photo.jpg?sz=128", "display_name": "sarthak bansal", "link": "https://stackoverflow.com/users/10823533/sarthak-bansal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55142465, "answer_count": 1, "score": 0, "last_activity_date": 1552547829, "creation_date": 1552481488, "last_edit_date": 1552547829, "question_id": 55142361, "link": "https://stackoverflow.com/questions/55142361/this-keyword-for-const-variable-in-initialising-list", "title": "&quot;this&quot; keyword for const variable in initialising list", "body": "<p>Why cant we use <code>this</code> in initialization list like this?\nIt threw an error cant find <code>{</code> before <code>this</code>..\nBut scope is not the problem because the second code works</p>\n\n<pre><code>class Student {\npublic :\n    int age;\n    const int rollNumber;\n    int &amp;x;     // age reference variable\n\n    Student(int r, int age) : rollNumber(r), this-&gt;age(age), x(this -&gt; age) {\n        //rollNumber = r;\n    }\n</code></pre>\n\n<p>\"This\" one works:</p>\n\n<pre><code>class Student {\npublic :\n    int age;\n    const int rollNumber;int &amp;x;\n\n\n    Student(int r, int age) : rollNumber(r), x(this -&gt; age) {\n        //rollNumber = r;\n    }\n</code></pre>\n\n<p>I know we have to declare and initialize <code>const</code> and reference variables at same time but I want to initialize them after taking an input and passing to my objects</p>\n"}, {"tags": ["c++", "sorting", "stdvector"], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1552481963, "post_id": 55142421, "comment_id": 97025153, "body": "I was too late :("}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1552481989, "post_id": 55142421, "comment_id": 97025169, "body": "@Slava only by a few seconds :)"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 6, "last_activity_date": 1552482243, "last_edit_date": 1592644375, "creation_date": 1552481716, "answer_id": 55142421, "question_id": 55142345, "link": "https://stackoverflow.com/questions/55142345/cstdsort-how-does-it-work-on-2d-containers/55142421#55142421", "title": "[C++][std::sort] How does it work on 2D containers?", "body": "<p>Sorting vector elements works the same way as sorting any other type. <code>std::sort</code> uses the comparison object given as an argument. If none was passed explicitly, <code>std::less</code> is the default.</p>\n<p><code>std::less</code> uses <code>operator&lt;</code>. As per vector documentation, it:</p>\n<blockquote>\n<p>Compares the contents of lhs and rhs lexicographically. The comparison is performed by a function equivalent to <code>std::lexicographical_compare</code>.</p>\n<hr />\n<p>Lexicographical comparison is a operation with the following properties:</p>\n<ul>\n<li>Two ranges are compared element by element.</li>\n<li>The first mismatching element defines which range is lexicographically less or greater than the other.</li>\n<li>If one range is a prefix of another, the shorter range is lexicographically less than the other.</li>\n<li>If two ranges have equivalent elements and are of the same length, then the ranges are lexicographically equal.</li>\n<li>An empty range is lexicographically less than any non-empty range.</li>\n<li>Two empty ranges are lexicographically equal.</li>\n</ul>\n</blockquote>\n<p>In short, lexicographical sorting is the same as sorting used for dictionaries (ignoring oddities of some languages).</p>\n<hr />\n<blockquote>\n<p>2D vectors are sorted by size.</p>\n</blockquote>\n<p>Not quite. <code>{1}, {3, 4}, {1, 2, 5}</code>  would be sorted as <code>{1}, {1, 2, 5}, {3, 4}</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 4, "last_activity_date": 1552482231, "last_edit_date": 1552482231, "creation_date": 1552481723, "answer_id": 55142424, "question_id": 55142345, "link": "https://stackoverflow.com/questions/55142345/cstdsort-how-does-it-work-on-2d-containers/55142424#55142424", "title": "[C++][std::sort] How does it work on 2D containers?", "body": "<p><code>std::sort</code> uses <code>operator &lt;</code> by default to sort.  Since <code>std::vector</code> has an overloaded <code>operator &lt;</code> it uses that.  <a href=\"https://en.cppreference.com/w/cpp/container/vector/operator_cmp\" rel=\"nofollow noreferrer\"><code>std::vector::operator &lt;</code></a> does a lexicographical compare meaning it returns the vector that has the first smaller element.  That means <code>{1, 1, 2}</code> is less than <code>{1, 1, 3}</code> since the <code>2</code> is less than <code>3</code>.  If the vectors are of different length but the smaller one has the same elements that the larger one has then the smaller one is returned.  That means that</p>\n\n<pre><code>int main()\n{\n    std::vector a{5, 1}, b{10};\n    std::cout &lt;&lt; (a &lt; b);\n}\n</code></pre>\n\n<p>Prints <code>1</code> since <code>5</code> is less than <code>10</code>.</p>\n\n<pre><code>int main()\n{\n    std::vector a{5, 10}, b{5};\n    std::cout &lt;&lt; (a &lt; b);\n}\n</code></pre>\n\n<p>Prints <code>0</code> since <code>a</code> is larger than <code>b</code> but they have the same common element.</p>\n"}], "owner": {"reputation": 3, "user_id": 11197147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gUGcY3U4bdo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcznhd48Y9Kc3aH1i5-gXWeq9fTcg/mo/photo.jpg?sz=128", "display_name": "BlueAxis", "link": "https://stackoverflow.com/users/11197147/blueaxis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 55142421, "answer_count": 2, "score": 0, "last_activity_date": 1552482243, "creation_date": 1552481428, "last_edit_date": 1552481915, "question_id": 55142345, "link": "https://stackoverflow.com/questions/55142345/cstdsort-how-does-it-work-on-2d-containers", "title": "[C++][std::sort] How does it work on 2D containers?", "body": "<p>I have this vector object that contains vector of <code>int</code>s</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; vec;\n</code></pre>\n\n<p>I have been trying to figure out how <code>std::sort(vec.begin(), vec.end())</code> works on it. Here are my observations:</p>\n\n<ol>\n<li>2D vectors are sorted by size.</li>\n<li>If some of inner vectors has the same size, the vector with lesser value of first element will have lesser index value.</li>\n</ol>\n\n<p>I have been generating a few 2D vectors now, and it seems that these two are always true. However, I am doubting about my second assumption. Does <code>std::sort</code> really work this way, or it was just some luck that made my assumptions correct?</p>\n"}, {"tags": ["c++", "arrays", "binary-search"], "comments": [{"owner": {"reputation": 18353, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "edited": false, "score": 0, "creation_date": 1552481148, "post_id": 55142220, "comment_id": 97024637, "body": "Can you provide the input values and also show the results and desired results?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1552481153, "post_id": 55142220, "comment_id": 97024641, "body": "Is the array sorted?  I&#39;m not sure how you could find all duplicates in less then O(N)"}, {"owner": {"reputation": 134, "user_id": 4057776, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Avishek Saha", "link": "https://stackoverflow.com/users/4057776/avishek-saha"}, "edited": false, "score": 0, "creation_date": 1552481258, "post_id": 55142220, "comment_id": 97024706, "body": "are you sure about the time complexity ?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1552481446, "post_id": 55142220, "comment_id": 97024829, "body": "to find duplicates you need to touch every element at least once, O(logn) is not possible"}, {"owner": {"reputation": 21, "user_id": 11136696, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIWdQDsKJ1o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reL6KdABq2_0xBXn3WVMqeLQZqmTg/mo/photo.jpg?sz=128", "display_name": "Mateusz M\u0142odochowski", "link": "https://stackoverflow.com/users/11136696/mateusz-m%c5%82odochowski"}, "edited": false, "score": 0, "creation_date": 1552481456, "post_id": 55142220, "comment_id": 97024833, "body": "Yes the array is sorted as I wrote"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552481517, "post_id": 55142220, "comment_id": 97024872, "body": "sorted does not really help that much, eg when you know that <code>arr[3] == 3</code> and <code>arr[5] == 5</code> you still have to inspect <code>arr[4]</code> to know what value it has"}, {"owner": {"reputation": 21, "user_id": 11136696, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIWdQDsKJ1o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reL6KdABq2_0xBXn3WVMqeLQZqmTg/mo/photo.jpg?sz=128", "display_name": "Mateusz M\u0142odochowski", "link": "https://stackoverflow.com/users/11136696/mateusz-m%c5%82odochowski"}, "edited": false, "score": 0, "creation_date": 1552481717, "post_id": 55142220, "comment_id": 97025000, "body": "You just need to count how many 2&#39;s or 3&#39;s are there when you know that the 1st 2 is on index X and the last 2 is on index Y you know that there are Y-X 2&#39;s"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1552481833, "post_id": 55142220, "comment_id": 97025066, "body": "<a href=\"https://en.cppreference.com/w/cpp/algorithm/equal_range\" rel=\"nofollow noreferrer\">std::equal_range</a> might help."}, {"owner": {"reputation": 2055, "user_id": 10733631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z9f47Aj3ez4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j0jfocyr5e1Wd0v4q8aluK_b7B5Q/mo/photo.jpg?sz=128", "display_name": "Dmytro Dadyka", "link": "https://stackoverflow.com/users/10733631/dmytro-dadyka"}, "edited": false, "score": 1, "creation_date": 1552481864, "post_id": 55142220, "comment_id": 97025083, "body": "You need to determine the upper and lower boundaries of <code>num</code> subsequence using the dichotomy method. The difference of this values is subsequence length. Your implementation of the dichotomy method is incorrect."}, {"owner": {"reputation": 5818, "user_id": 978558, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d023acf70b927cb813b48631195e346e?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/978558/fredrik"}, "edited": false, "score": 0, "creation_date": 1552481879, "post_id": 55142220, "comment_id": 97025094, "body": "Worst case will still be O(n) as you are potentially counting the largest number in the list."}, {"owner": {"reputation": 21, "user_id": 11136696, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIWdQDsKJ1o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reL6KdABq2_0xBXn3WVMqeLQZqmTg/mo/photo.jpg?sz=128", "display_name": "Mateusz M\u0142odochowski", "link": "https://stackoverflow.com/users/11136696/mateusz-m%c5%82odochowski"}, "edited": false, "score": 0, "creation_date": 1552481903, "post_id": 55142220, "comment_id": 97025112, "body": "Could you show me an example?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1552483839, "post_id": 55142220, "comment_id": 97026435, "body": "@user463035818 Yeah but you don&#39;t have to look at arr[0] or arr[1] or arr[2] or arr[6] or arr[7] or arr[8] or arr[9] or arr[10] or arr[11] or arr[12] or arr[13] or arr[14] so yes it helps a lot"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1552483659, "post_id": 55142484, "comment_id": 97026317, "body": "standard with algorithm comes with <code>std::lower_bound</code>/<code>std::upper_bound</code> for that.and <code>std::equal_range</code> when both are required."}], "tags": [], "owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "is_accepted": false, "score": 0, "last_activity_date": 1552482695, "last_edit_date": 1552482695, "creation_date": 1552481955, "answer_id": 55142484, "question_id": 55142220, "link": "https://stackoverflow.com/questions/55142220/function-to-count-same-numbers-in-array-c/55142484#55142484", "title": "Function to count same numbers in array C++", "body": "<p>From the function signature you gave, I am guessing you were given a number N and a sorted array of numbers and need to count how many times N appears in the array.</p>\n\n<p>Since the array is sorted, you need to find the index (using binary search) of the first number that is smaller than N (this is <code>O(log n)</code>), the index of the first number larger than N (this is also <code>O(log n)</code>), and simply substract one index from the other.\nOf course you need to take into account edge cases where there are no numbers smaller than N <em>or</em> larger than N, but that is for you to figure out.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1552483900, "post_id": 55142513, "comment_id": 97026470, "body": "While true and a good solution for the real world, it seems clear that the OP is supposed to design the <i>algorithm</i> not just use an existing implementation."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1552482068, "creation_date": 1552482068, "answer_id": 55142513, "question_id": 55142220, "link": "https://stackoverflow.com/questions/55142220/function-to-count-same-numbers-in-array-c/55142513#55142513", "title": "Function to count same numbers in array C++", "body": "<p>With std, you might do:</p>\n\n<pre><code>int CountElementsinFile(const int *a, int size, int value)\n{\n    const auto range = std::equal_range(a, a + size, value);\n    return range.second - range.first;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1552560746, "post_id": 55144240, "comment_id": 97060290, "body": "split the method makes sense, and would make code clearer."}], "tags": [], "owner": {"reputation": 2055, "user_id": 10733631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z9f47Aj3ez4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j0jfocyr5e1Wd0v4q8aluK_b7B5Q/mo/photo.jpg?sz=128", "display_name": "Dmytro Dadyka", "link": "https://stackoverflow.com/users/10733631/dmytro-dadyka"}, "is_accepted": false, "score": 2, "last_activity_date": 1552490699, "last_edit_date": 1552490699, "creation_date": 1552487166, "answer_id": 55144240, "question_id": 55142220, "link": "https://stackoverflow.com/questions/55142220/function-to-count-same-numbers-in-array-c/55144240#55144240", "title": "Function to count same numbers in array C++", "body": "<p>You need to determine the upper and lower boundaries of <code>num</code> subsequence using the <a href=\"https://en.wikipedia.org/wiki/Bisection_method\" rel=\"nofollow noreferrer\">Bisection method</a>. You need to rearrange the lower or upper (depending on the comparison) search region boundary in the while loop until <code>inB &lt; inE</code> reducing the region in half. The complexity will be <code>O(ln(n))</code>. You were close, but you will not be able to find both boundaries in one <code>while</code> loop. I just corrected your code.</p>\n\n<pre><code>int CountElementsinFile(int *Arr, int num, int numOfD)\n{\n   // There is no num in the array\n   if (Arr[0] &gt; num || Arr[numOfD - 1] &lt; num)\n      return 0;\n\n   int avg{};\n   int lb, ub;\n\n   // Find lower boundary\n   int inB = 0;\n   int inE = numOfD - 1;\n   while (inB &lt; inE)\n   {\n      // divide search region\n      avg = (inB + inE) / 2;\n      if (Arr[avg] &gt;= num)\n         inE = avg;\n      else\n         inB = avg+1;\n   }\n\n   lb = inE;\n\n   // Find upper boundary   \n   // inB already found\n   inE = numOfD - 1;\n   while (inB &lt; inE)\n   {\n      avg = (inB + inE + 1) / 2;\n      if (Arr[avg] &gt; num)\n         inE = avg-1;\n      else\n         inB = avg;\n   }\n\n   ub = inB;\n\n   return ub - lb + 1;\n}\n\nint main()\n{\n   int arr[] = { 5, 7, 8, 9, 9, 9, 9, 9, 11 };\n   std::cout &lt;&lt; CountElementsinFile(arr, 9, sizeof(arr) / sizeof(int)) &lt;&lt; std::endl;\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1552560647, "post_id": 55145132, "comment_id": 97060232, "body": "You are in linear complexity. whereas <code>arr</code> is sorted, we might have better complexity."}], "tags": [], "owner": {"reputation": 47, "user_id": 1574173, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d03fdacaefda3557461da7efd6ba4d78?s=128&d=identicon&r=PG", "display_name": "poojakz", "link": "https://stackoverflow.com/users/1574173/poojakz"}, "is_accepted": false, "score": 0, "last_activity_date": 1552489605, "creation_date": 1552489605, "answer_id": 55145132, "question_id": 55142220, "link": "https://stackoverflow.com/questions/55142220/function-to-count-same-numbers-in-array-c/55145132#55145132", "title": "Function to count same numbers in array C++", "body": "<pre><code>#include&lt;algorithm&gt;\nusing namespace std;\n\nint CountElementsinFile(int arr[], int size, int numToSearch)\n{\n    return count(arr, arr + size, numToSearch); \n}   \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11136696, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HIWdQDsKJ1o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reL6KdABq2_0xBXn3WVMqeLQZqmTg/mo/photo.jpg?sz=128", "display_name": "Mateusz M\u0142odochowski", "link": "https://stackoverflow.com/users/11136696/mateusz-m%c5%82odochowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1552505321, "creation_date": 1552481026, "last_edit_date": 1552505321, "question_id": 55142220, "link": "https://stackoverflow.com/questions/55142220/function-to-count-same-numbers-in-array-c", "title": "Function to count same numbers in array C++", "body": "<p>I have this function that is supposed to count how many duplicates of same number occur in certain array. Important this must be of complexity O(logn).\nI wrote this one below, but it doesn't count the duplicates properly.\nAlso one more thing, the numbers are sorted from lowest to highest.</p>\n\n<pre><code>int CountElementsinFile(int *Arr, int num, int numOfD)\n{\n    int avg{}; \n    int inB = 0; \n    int inE = numOfD - 1; \n    int el{};\n    while (inB &lt;= inE)\n    {\n        avg = (inB + inE) / 2;\n\n        if (Arr[avg] == num)\n            el++;\n            if (Arr[avg] &gt; num)\n                inE = avg - 1;\n            else\n                inB = avg + 1;\n    }\n\n    return el;\n}\n</code></pre>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 3, "creation_date": 1552481267, "post_id": 55142131, "comment_id": 97024711, "body": "so why do you call <code>drawMatches</code> if you don&#39;t want to <i>draw matches</i>?"}, {"owner": {"reputation": 65, "user_id": 10512554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5736718f9054e092c01ba1b90aea6f?s=128&d=identicon&r=PG&f=1", "display_name": "MJ Kwon", "link": "https://stackoverflow.com/users/10512554/mj-kwon"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1552481560, "post_id": 55142131, "comment_id": 97024895, "body": "@Miki For img_matches. I draw green lines using line function.            line( img_matches, scene_corners[0] + Point2f( img_object.cols, 0), scene_corners[1] + Point2f( img_object.cols, 0), Scalar(0, 255, 0), 4 );"}], "answers": [{"tags": [], "owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "is_accepted": true, "score": 3, "last_activity_date": 1552482079, "creation_date": 1552482079, "answer_id": 55142516, "question_id": 55142131, "link": "https://stackoverflow.com/questions/55142131/how-to-remove-keypoint-matches-lines-in-opencv/55142516#55142516", "title": "How to remove keypoint-matches lines in OpenCV", "body": "<p>You can mask out all matches with the <code>matchesMask</code> parameter:</p>\n\n<pre><code>Mat img_matches;\nstd::vector&lt;char&gt; mask_matches(good_matches.size(), 0);\ndrawMatches( \n    img_object, \n    keypoints_object, \n    img_scene, \n    keypoints_scene,\n    good_matches, \n    img_matches, \n    Scalar::all(-1), \n    Scalar::all(-1),\n    mask_matches, // &lt;----\n    DrawMatchesFlags::NOT_DRAW_SINGLE_POINTS \n);\n</code></pre>\n\n<hr>\n\n<p>Since you basically just need the two images side-by-side, you can just create the image by yourself. You can find an example <a href=\"https://stackoverflow.com/a/33262398/5008845\">here</a>.</p>\n"}], "owner": {"reputation": 65, "user_id": 10512554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5736718f9054e092c01ba1b90aea6f?s=128&d=identicon&r=PG&f=1", "display_name": "MJ Kwon", "link": "https://stackoverflow.com/users/10512554/mj-kwon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 55142516, "answer_count": 1, "score": -2, "last_activity_date": 1552483109, "creation_date": 1552480698, "last_edit_date": 1552483109, "question_id": 55142131, "link": "https://stackoverflow.com/questions/55142131/how-to-remove-keypoint-matches-lines-in-opencv", "title": "How to remove keypoint-matches lines in OpenCV", "body": "<p>I want to remove lines and keypoints. \nIs there a function other than <code>drawMatches</code> or can I make lines and keypoints invisible in <code>drawMatches</code>?</p>\n\n<pre><code>Mat img_matches;\ndrawMatches( img_object, keypoints_object, img_scene, keypoints_scene,\n           good_matches, img_matches, Scalar::all(-1), Scalar::all(-1),\n           std::vector&lt;char&gt;(), DrawMatchesFlags::NOT_DRAW_SINGLE_POINTS );\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/srZni.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/srZni.jpg\" alt=\"A picture\"></a></p>\n"}, {"tags": ["c++", "g++", "sfinae"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1552481132, "post_id": 55142122, "comment_id": 97024625, "body": "You might use: <code>std::void_t&lt;decltype(T::x)&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 4792865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bada01b5d11bcdaa68b42d55945ab273?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/4792865/andre"}, "edited": false, "score": 0, "creation_date": 1552551527, "post_id": 55142785, "comment_id": 97054730, "body": "That suggestion works, thanks. So which compiler is wrong, g++ or clang/msvc?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1552560557, "post_id": 55142785, "comment_id": 97060170, "body": "Issue is not in <code>FooTraits</code>, as using <code>void_t</code> for <code>HasX</code> fix in both compiler  <a href=\"http://coliru.stacked-crooked.com/a/93be7563a671a0fc\" rel=\"nofollow noreferrer\">Demo</a>."}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 3, "last_activity_date": 1552482927, "creation_date": 1552482927, "answer_id": 55142785, "question_id": 55142122, "link": "https://stackoverflow.com/questions/55142122/sfinae-detecting-existence-of-member-variable-does-not-work-on-g/55142785#55142785", "title": "SFINAE: Detecting existence of member variable does not work on g++", "body": "<p>SFINAE only work in immediate context. In other words, if the compiler can see in advance that a declaration has a problem, then it must be an error.</p>\n\n<p>When instantiating a class, the compiler will try to resolve everything it can. So is this:</p>\n\n<pre><code>template&lt;bool enable = HasX&lt;T&gt;::value&gt;\n....\n</code></pre>\n\n<p>This is not dependent of the context of the function. This can be instantiated right when <code>FooTraits</code> is instantiated.</p>\n\n<p>In other words, this assignation can be calculated in advance, as if you'd move it to the class scope.</p>\n\n<p>In your case, the compiler has nothing to do at subtitution.</p>\n\n<p>The fix is simply that:</p>\n\n<pre><code>template &lt;typename U = T, bool enable = HasX&lt;U&gt;::value&gt;\nstatic constexpr std::enable_if_t&lt; enable, size_t&gt; x() { return T::x; }\ntemplate &lt;typename U = T, bool enable = HasX&lt;U&gt;::value&gt;\nstatic constexpr std::enable_if_t&lt;!enable, size_t&gt; x() { return 1; }\n</code></pre>\n\n<p>In theory, <code>U</code> could be a completely different type. <code>U</code> is immediate to the function instantiation, while <code>T</code> is not.</p>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 4792865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bada01b5d11bcdaa68b42d55945ab273?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/4792865/andre"}, "edited": false, "score": 0, "creation_date": 1552576939, "post_id": 55160871, "comment_id": 97071684, "body": "Interesting. This variant works with gcc 5+, but fails (with and without the commented line) for 4.9.4, which compiled depending on the comment line."}, {"owner": {"reputation": 476, "user_id": 4792865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bada01b5d11bcdaa68b42d55945ab273?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/4792865/andre"}, "edited": false, "score": 0, "creation_date": 1552577441, "post_id": 55160871, "comment_id": 97072072, "body": "That problem seems to be related to CWG1558. With the more complex definition of <code>void_t</code> as explained here <a href=\"https://en.cppreference.com/w/cpp/types/void_t\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/types/void_t</a> it also works on that gcc."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1552561472, "creation_date": 1552561472, "answer_id": 55160871, "question_id": 55142122, "link": "https://stackoverflow.com/questions/55142122/sfinae-detecting-existence-of-member-variable-does-not-work-on-g/55160871#55160871", "title": "SFINAE: Detecting existence of member variable does not work on g++", "body": "<p>Fact that switching comment of:</p>\n\n<pre><code>//std::cout &lt;&lt; HasX&lt;WithoutX&gt;::value &lt;&lt; std::endl;\n</code></pre>\n\n<p>is indeed a good sign of gcc bug.</p>\n\n<p>Seems gcc has issue with your form:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct HasX &lt;T, decltype((void) T::x)&gt; : std::true_type {};\n</code></pre>\n\n<p>A more typical way is to use <code>std::void_t</code>:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct HasX &lt;T, std::void_t&lt;decltype(T::x)&gt;&gt; : std::true_type {};\n</code></pre>\n\n<p>which indeed solves the issue <a href=\"http://coliru.stacked-crooked.com/a/93be7563a671a0fc\" rel=\"nofollow noreferrer\">Demo</a>.</p>\n"}], "owner": {"reputation": 476, "user_id": 4792865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bada01b5d11bcdaa68b42d55945ab273?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/4792865/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 55160871, "answer_count": 2, "score": 5, "last_activity_date": 1552561472, "creation_date": 1552480672, "question_id": 55142122, "link": "https://stackoverflow.com/questions/55142122/sfinae-detecting-existence-of-member-variable-does-not-work-on-g", "title": "SFINAE: Detecting existence of member variable does not work on g++", "body": "<p>I'm trying to combine the approaches used in <a href=\"https://stackoverflow.com/a/16000226/4792865\">this answer</a> for detecting whether a class has a member variable <code>x</code> with <a href=\"https://stackoverflow.com/a/47935516/4792865\">this answer</a> to select different implementations depending on that using <code>enable_if</code>.</p>\n\n<p>Basically, I want to write a trait class that, given a type <code>T</code>, provides access to the member <code>T::x</code> if it exists, and provides a default value otherwise.</p>\n\n<p>The following code does not compile on g++: (<a href=\"https://godbolt.org/z/K24_r5\" rel=\"noreferrer\">Compiler Explorer</a>)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\n// classes with / without x member\nstruct WithX { static constexpr int x = 42; };\nstruct WithoutX {};\n\n// trait to detect x\ntemplate &lt;typename T, typename = void&gt;\nstruct HasX : std::false_type { };\n\ntemplate &lt;typename T&gt;\nstruct HasX &lt;T, decltype((void) T::x)&gt; : std::true_type { };\n\n// trait to provide default for x\ntemplate &lt;typename T&gt;\nstruct FooTraits\n{\n    template &lt;bool enable = HasX&lt;T&gt;::value&gt;\n    static constexpr std::enable_if_t&lt; enable, size_t&gt; x() { return T::x; }\n    template &lt;bool enable = HasX&lt;T&gt;::value&gt;\n    static constexpr std::enable_if_t&lt;!enable, size_t&gt; x() { return 1; }\n\n};\n\n\nint main() {\n    std::cout &lt;&lt; HasX&lt;WithX&gt;::value &lt;&lt; std::endl;\n    // Uncomment the following line to make this compile with g++\n    //std::cout &lt;&lt; HasX&lt;WithoutX&gt;::value &lt;&lt; std::endl;\n    std::cout &lt;&lt; FooTraits&lt;WithoutX&gt;::x() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>g++ gives error messages that</p>\n\n<pre><code>error: 'x' is not a member of 'WithoutX'\n  struct HasX &lt;T, decltype((void) T::x)&gt; : std::true_type { };\n</code></pre>\n\n<p>in the part which should detect whether <code>x</code> is a member in the first place. Curiously though, if I uncomment the second to last line which instantiates <code>HasX&lt;WithoutX&gt;::value</code> by itself, g++ compiles without errors (<a href=\"https://godbolt.org/z/r0zD5u\" rel=\"noreferrer\">Compiler Explorer</a>).</p>\n\n<p>Both clang and msvc compile without a problem on Compiler Explorer.</p>\n\n<p>What's wrong here?</p>\n"}, {"tags": ["c++", "valgrind"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1552480829, "post_id": 55142121, "comment_id": 97024443, "body": "C-style strings have a terminating zero."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1552481803, "post_id": 55142121, "comment_id": 97025044, "body": "Did you intend to write <code>n</code> different strings? Or to concatenate the <code>n</code> sprinted strings into a single string?"}], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 9293350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604d58d3a967df5019b3b2d79b5941a2?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Mancha", "link": "https://stackoverflow.com/users/9293350/alex-mancha"}, "edited": false, "score": 0, "creation_date": 1552484985, "post_id": 55142234, "comment_id": 97027271, "body": "Thanks for the reply. When I run valgrind with the change, the problem disappears."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 28, "user_id": 9293350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604d58d3a967df5019b3b2d79b5941a2?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Mancha", "link": "https://stackoverflow.com/users/9293350/alex-mancha"}, "edited": false, "score": 0, "creation_date": 1552485069, "post_id": 55142234, "comment_id": 97027346, "body": "You welcome, you are right to use <i>valgrind</i> this is a very great tool"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 3, "last_activity_date": 1552481535, "last_edit_date": 1552481535, "creation_date": 1552481054, "answer_id": 55142234, "question_id": 55142121, "link": "https://stackoverflow.com/questions/55142121/why-sprintf-crash-in-this-case/55142234#55142234", "title": "Why sprintf crash in this case?", "body": "<p><em>buffer</em> is sized 20, but when <em>i</em> values 9 you do <code>sprintf(buffer + 18, \"%.2X\",i);</code> writting 3 characters because of the ending null character, and that null character is written at <em>buffer + 20</em> which is out of <em>buffer</em></p>\n\n<p>you need <code>char *buffer = new char[n*2 + 1];</code></p>\n"}], "owner": {"reputation": 28, "user_id": 9293350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604d58d3a967df5019b3b2d79b5941a2?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Mancha", "link": "https://stackoverflow.com/users/9293350/alex-mancha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55142234, "answer_count": 1, "score": 0, "last_activity_date": 1552481535, "creation_date": 1552480669, "question_id": 55142121, "link": "https://stackoverflow.com/questions/55142121/why-sprintf-crash-in-this-case", "title": "Why sprintf crash in this case?", "body": "<p>I'm running the following function:</p>\n\n<pre><code>void f () {\n    int n = 10;\n    char *buffer = new char[n*2];\n\n    for(int i = 0; i &lt; n; i++) {\n\n        sprintf(buffer + (i*2), \"%.2X\",i);\n    }\n\n    delete[] buffer;\n}\n</code></pre>\n\n<p>and in some cases this function crash.\nRunning valgrind, I can see the following problem:</p>\n\n<pre><code>==26747== Invalid write of size 1\n==26747==    at 0x56CC2C9: vsprintf (in /usr/lib64/libc-2.17.so)\n==26747==    by 0x56AE456: sprintf (in /usr/lib64/libc-2.17.so)\n</code></pre>\n\n<p>Can anyone explain what's happening?</p>\n"}, {"tags": ["c++", "sockets", "networking", "ace"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552479750, "post_id": 55141759, "comment_id": 97023732, "body": "ACE is not a header-only library, there an actual &quot;library&quot; file you need to link with (using the <code>-l</code> (lower case L) option when building)."}, {"owner": {"reputation": 331, "user_id": 8349044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16f2d5ee00d6d61d6087d33c6ee2e25?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/8349044/ricky"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552482775, "post_id": 55141759, "comment_id": 97025699, "body": "@Someprogrammerdude can you tell me the name of the library and how to install it?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1552483977, "post_id": 55141759, "comment_id": 97026528, "body": "Did you install the files from <code>$ACE_ROOT&#47;lib</code>? Otherwise Use e.g. <code>-L$ACE_ROOT&#47;lib -lACE</code> when building."}, {"owner": {"reputation": 331, "user_id": 8349044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16f2d5ee00d6d61d6087d33c6ee2e25?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/8349044/ricky"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552484354, "post_id": 55141759, "comment_id": 97026825, "body": "@Someprogrammerdude I don&#39;t know how to thank you!!!! It worked!!!! Thank you very much :)"}], "owner": {"reputation": 331, "user_id": 8349044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16f2d5ee00d6d61d6087d33c6ee2e25?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/8349044/ricky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1552479723, "answer_count": 0, "score": 0, "last_activity_date": 1578984802, "creation_date": 1552479573, "last_edit_date": 1592644375, "question_id": 55141759, "link": "https://stackoverflow.com/questions/55141759/how-to-compile-an-ace-program", "closed_reason": "Duplicate", "title": "How to compile an ACE program", "body": "<p>I am using ACE (adaptive communication environment) framework for the first time and am struggling a lot in installation process. I downloaded the project folder from <a href=\"http://download.dre.vanderbilt.edu/\" rel=\"nofollow noreferrer\">here</a> and then used the instructions written <a href=\"http://wiki.icub.org/wiki/Compiling_ACE\" rel=\"nofollow noreferrer\">here</a>. I included the 'ace' folder in /usr/include/ folder. Then I tried to compile this program:</p>\n<pre><code>//client.cpp\n#include &lt;ace/Log_Msg.h&gt;\n#include &lt;ace/SOCK_Connector.h&gt;\nstatic u_short SERVER_PORT = ACE_DEFAULT_SERVER_PORT;\nstatic const char *const SERVER_HOST = ACE_DEFAULT_SERVER_HOST;\nstatic const int MAX_ITERATIONS = 4;\n\nint\nmain (int argc, char *argv[])\n{\n  const char *server_host = argc &gt; 1 ? argv[1] : SERVER_HOST;\n  u_short server_port = argc &gt; 2 ? ACE_OS::atoi (argv[2]) : SERVER_PORT;\n  int max_iterations = argc &gt; 3 ? ACE_OS::atoi (argv[3]) : MAX_ITERATIONS;\n  ACE_SOCK_Stream server;\n  ACE_SOCK_Connector connector;\n  ACE_INET_Addr addr (server_port,\n                      server_host);\n  if (connector.connect (server, addr) == -1)\n    ACE_ERROR_RETURN ((LM_ERROR,\n                       &quot;%p\\n&quot;,\n                       &quot;open&quot;),\n                      -1);\n  for (int i = 0; i &lt; max_iterations; i++)\n    {\n      char buf[BUFSIZ];\n\n      /* Create our message with the message number */\n      ACE_OS::sprintf (buf,\n                       &quot;message = %d\\n&quot;,\n                       i + 1);\n    \n      if (server.send_n (buf,\n                         ACE_OS::strlen (buf)) == -1)\n        ACE_ERROR_RETURN ((LM_ERROR,\n                           &quot;%p\\n&quot;,\n                           &quot;send&quot;),\n                          -1);\n      else\n        /* Pause for a second.  */\n        ACE_OS::sleep (1);\n    }\n\n  if (server.close () == -1)\n    ACE_ERROR_RETURN ((LM_ERROR,\n                       &quot;%p\\n&quot;,\n                       &quot;close&quot;),\n                      -1);\n  return 0;\n}\n</code></pre>\n<p>After compiling with the command <code>g++ client.cpp</code>, I got the following errors:</p>\n<pre><code>/tmp/ccsSpahN.o: In function `main':\nclient.cpp:(.text+0xe3): undefined reference to `ACE_INET_Addr::ACE_INET_Addr(unsigned short, char const*, int)'\nclient.cpp:(.text+0x10f): undefined reference to `ACE_Addr::sap_any'\nclient.cpp:(.text+0x11c): undefined reference to `ACE_SOCK_Connector::connect(ACE_SOCK_Stream&amp;, ACE_Addr const&amp;, ACE_Time_Value const*, ACE_Addr const&amp;, int, int, int, int)'\nclient.cpp:(.text+0x12f): undefined reference to `ACE_Log_Msg::last_error_adapter()'\nclient.cpp:(.text+0x13a): undefined reference to `ACE_Log_Msg::instance()'\nclient.cpp:(.text+0x16a): undefined reference to `ACE_Log_Msg::conditional_set(char const*, int, int, int)'\nclient.cpp:(.text+0x191): undefined reference to `ACE_Log_Msg::log(ACE_Log_Priority, char const*, ...)'\nclient.cpp:(.text+0x1db): undefined reference to `ACE_OS::sprintf(char*, char const*, ...)'\nclient.cpp:(.text+0x21e): undefined reference to `ACE_Log_Msg::last_error_adapter()'\nclient.cpp:(.text+0x229): undefined reference to `ACE_Log_Msg::instance()'\nclient.cpp:(.text+0x259): undefined reference to `ACE_Log_Msg::conditional_set(char const*, int, int, int)'\nclient.cpp:(.text+0x280): undefined reference to `ACE_Log_Msg::log(ACE_Log_Priority, char const*, ...)'\nclient.cpp:(.text+0x2af): undefined reference to `ACE_SOCK_Stream::close()'\nclient.cpp:(.text+0x2be): undefined reference to `ACE_Log_Msg::last_error_adapter()'\nclient.cpp:(.text+0x2c9): undefined reference to `ACE_Log_Msg::instance()'\nclient.cpp:(.text+0x2f9): undefined reference to `ACE_Log_Msg::conditional_set(char const*, int, int, int)'\nclient.cpp:(.text+0x320): undefined reference to `ACE_Log_Msg::log(ACE_Log_Priority, char const*, ...)'\nclient.cpp:(.text+0x33b): undefined reference to `ACE_INET_Addr::~ACE_INET_Addr()'\nclient.cpp:(.text+0x37e): undefined reference to `ACE_INET_Addr::~ACE_INET_Addr()'\n/tmp/ccsSpahN.o: In function `ACE::send_n(int, void const*, unsigned long, ACE_Time_Value const*, unsigned long*)':\nclient.cpp:(.text._ZN3ACE6send_nEiPKvmPK14ACE_Time_ValuePm[_ZN3ACE6send_nEiPKvmPK14ACE_Time_ValuePm]+0x34): undefined reference to `ACE::send_n_i(int, void const*, unsigned long, unsigned long*)'\nclient.cpp:(.text._ZN3ACE6send_nEiPKvmPK14ACE_Time_ValuePm[_ZN3ACE6send_nEiPKvmPK14ACE_Time_ValuePm]+0x53): undefined reference to `ACE::send_n_i(int, void const*, unsigned long, ACE_Time_Value const*, unsigned long*)'\n/tmp/ccsSpahN.o: In function `ACE_SOCK_IO::ACE_SOCK_IO()':\nclient.cpp:(.text._ZN11ACE_SOCK_IOC2Ev[_ZN11ACE_SOCK_IOC5Ev]+0x14): undefined reference to `ACE_SOCK::ACE_SOCK()'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n<p>So my question is:</p>\n<ol>\n<li>Why is this error coming.Which step am I missing?</li>\n<li>What library do I need to link while compilation? Please provide syntax.</li>\n</ol>\n<p><strong>EDIT:</strong> In reference to the comment section I am editing this question. Seeing the errors, it is clear that the error is because of a library which has not been linked during compilation with g++. I clearly specified that in my second question. I want to know what will be that -l(some library) option that needs to be added during compilation.</p>\n"}, {"tags": ["c++", "initialization", "c++14", "unique-ptr", "c++-standard-library"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 7, "creation_date": 1552479425, "post_id": 55141594, "comment_id": 97023497, "body": "Consider situation when you call <code>make_unique&lt;vector&lt;int&gt;&gt;(10,20)</code> what do you want to get ? vector with 10 items, all 20 value (when () is used in make_unique), or vector with 2 items 10,20 (when {} is used, vector has constructor which takes initializer_list)."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1552479563, "post_id": 55141594, "comment_id": 97023590, "body": "If it&#39;s any consolation, there&#39;s <a href=\"https://wg21.link/p0960\" rel=\"nofollow noreferrer\">p0960</a> in the pipeline. Future versions of C++ may support aggregates without needing to change the implementation of how factory library functions work."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1552479708, "post_id": 55141594, "comment_id": 97023697, "body": "Although conceivably, it&#39;s possible to support stuff like that today with the help of the <code>std::is_aggregate</code> trait. I guess people felt it&#39;s better to have a language solution to that, rather than a library one."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1552479868, "post_id": 55141594, "comment_id": 97023810, "body": "&quot;Seeing how the general trend appears to prefer braces for initialization&quot; I am afraid due to problem with vector etc there is no such trend anymore."}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 2, "creation_date": 1552485787, "post_id": 55141594, "comment_id": 97027838, "body": "From <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3588.txt\" rel=\"nofollow noreferrer\">this proposal</a>, it was done to match <code>make_shared</code>. I have yet to find why <code>make_shared</code> chose one way over the other. <code>shared_ptr</code> was in TR1 though, long before unified initialisation syntax existed - not certain if <code>make_shared</code> existed back then."}], "answers": [{"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1552482158, "post_id": 55141731, "comment_id": 97025268, "body": "C++20 changes this answer I believe."}, {"owner": {"reputation": 766, "user_id": 10532253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7970ca81beac26fc5094dbbcd1d618b?s=128&d=identicon&r=PG&f=1", "display_name": "Handy999", "link": "https://stackoverflow.com/users/10532253/handy999"}, "edited": false, "score": 3, "creation_date": 1552552741, "post_id": 55141731, "comment_id": 97055330, "body": "No, C++20 will not break anything from the answer. The 2 versions of std::vector constructors will still be different and make_shared will still call the round brace constructor (the committee will never support changes that break tons of code). However, C++20 will allow aggregate initialization with standard braces."}], "tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": true, "score": 17, "last_activity_date": 1552479694, "last_edit_date": 1552479694, "creation_date": 1552479470, "answer_id": 55141731, "question_id": 55141594, "link": "https://stackoverflow.com/questions/55141594/make-unique-with-brace-initialization/55141731#55141731", "title": "make_unique with brace initialization", "body": "<p>Some classes have different behavior with the 2 initialization styles. e.g.</p>\n\n<pre><code>std::vector&lt;int&gt; v1(1, 2); // 1 element with value 2\nstd::vector&lt;int&gt; v2{1, 2}; // 2 elements with value 1 &amp; 2\n</code></pre>\n\n<p>There might not be enough reason to choose one prefer to another; I think the standard just choose one and state the decision explicitly.</p>\n\n<p>As the workaround, you might want to implement your own <code>make_unique</code> version. As you have showed, it's not a hard work.</p>\n"}, {"comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1590532196, "post_id": 55144743, "comment_id": 109714306, "body": "Parenthesized initialization has its own daemon too. This initializer class would be more complex if it were doing non braced direct initialization."}, {"owner": {"reputation": 7698, "user_id": 2085626, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yP5Oy.jpg?s=128&g=1", "display_name": "Amir Kirsh", "link": "https://stackoverflow.com/users/2085626/amir-kirsh"}, "edited": false, "score": 0, "creation_date": 1590578802, "post_id": 55144743, "comment_id": 109730841, "body": "With C++20 this still won&#39;t compile: <code>auto p = std::make_unique&lt;std::array&lt;int, 2&gt;&gt;(1, 2);</code> C++ initialization is a riddle wrapped in a mystery inside an enigma."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 19, "last_activity_date": 1552488504, "creation_date": 1552488504, "answer_id": 55144743, "question_id": 55141594, "link": "https://stackoverflow.com/questions/55141594/make-unique-with-brace-initialization/55144743#55144743", "title": "make_unique with brace initialization", "body": "<p>In C++20, this will compile:</p>\n\n<pre><code>std::make_unique&lt;point&gt;(1, 2);\n</code></pre>\n\n<p>due to the new rule <a href=\"https://wg21.link/p0960\" rel=\"noreferrer\">allowing initializing aggregates from a parenthesized list of values</a>.</p>\n\n<hr />\n\n<p>In C++17, you can just do:</p>\n\n<pre><code>std::unique_ptr&lt;point&gt;(new point{1, 2});\n</code></pre>\n\n<p>That won't work with <code>make_shared</code> though. So you can also just create a factory (forwarding left as an exercise):</p>\n\n<pre><code>template &lt;typename... Args&gt;\nstruct braced_init {\n    braced_init(Args... args) : args(args...) { }\n    std::tuple&lt;Args...&gt; args;\n\n    template &lt;typename T&gt;\n    operator T() const {\n        return std::apply([](Args... args){\n            return T{args...};\n        }, args);\n    }\n};\n\nstd::make_unique&lt;point&gt;(braced_init(1, 2));\n</code></pre>\n\n<p>In C++14, you'll have to implement <code>apply</code> and write a factory function for <code>braced_init</code> because there's no CTAD yet - but these are doable. </p>\n\n<hr />\n\n<blockquote>\n  <p>Seeing how the general trend appears to prefer braces for initialization</p>\n</blockquote>\n\n<p>Citation needed. It's a charged topic - but I definitely disagree with the claim. </p>\n"}, {"tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 7, "last_activity_date": 1569404377, "creation_date": 1569404377, "answer_id": 58095494, "question_id": 55141594, "link": "https://stackoverflow.com/questions/55141594/make-unique-with-brace-initialization/58095494#58095494", "title": "make_unique with brace initialization", "body": "<p>In addition to other answers, in his <a href=\"https://youtu.be/22jIHfvelZk?t=3281\" rel=\"noreferrer\">presentation</a> on C++17, <strong>Alisdair Meredith</strong> gives the following implementation of <code>make_unique</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T, typename... Args&gt;\nauto make_unique(Args&amp;&amp;... args) -&gt; std::unique_ptr&lt;T&gt; {\n    if constexpr (std::is_constructible&lt;T, Args...&gt;::value)\n        return std::unique_ptr&lt;T&gt;(new T(std::forward&lt;Args&gt;(args)...));\n    else\n        return std::unique_ptr&lt;T&gt;(new T{std::forward&lt;Args&gt;(args)...});\n}\n</code></pre>\n\n<p>It uses C+17 <code>if constexpr</code>, but can easily be rewritten without it.</p>\n\n<p>With this version you can do both</p>\n\n<pre><code>auto v = make_unique&lt;std::vector&lt;int&gt;&gt;(10, 20); // *v is a vector of 10 elements\n</code></pre>\n\n<p>and </p>\n\n<pre><code>auto p = make_unique&lt;point&gt;(10, 20); // *p is a point (10, 20)\n</code></pre>\n"}], "owner": {"reputation": 51182, "user_id": 1468366, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2e313135581cf6ceaad355580af931f8?s=128&d=identicon&r=PG", "display_name": "MvG", "link": "https://stackoverflow.com/users/1468366/mvg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3441, "favorite_count": 1, "accepted_answer_id": 55141731, "answer_count": 3, "score": 24, "last_activity_date": 1569404377, "creation_date": 1552479027, "last_edit_date": 1552480168, "question_id": 55141594, "link": "https://stackoverflow.com/questions/55141594/make-unique-with-brace-initialization", "title": "make_unique with brace initialization", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr/make_unique\" rel=\"noreferrer\">https://en.cppreference.com/w/cpp/memory/unique_ptr/make_unique</a> writes that <code>std::make_unique</code> can be implemented as</p>\n\n<pre><code>template&lt;typename T, typename... Args&gt;\nstd::unique_ptr&lt;T&gt; make_unique(Args&amp;&amp;... args)\n{\n    return std::unique_ptr&lt;T&gt;(new T(std::forward&lt;Args&gt;(args)...));\n}\n</code></pre>\n\n<p>This does not work for plain structs with no constructors. Those can be brace-initialized but don't have a non-default constructor. Example:</p>\n\n<pre><code>#include &lt;memory&gt;\nstruct point { int x, z; };\nint main() { std::make_unique&lt;point&gt;(1, 2); }\n</code></pre>\n\n<p><a href=\"https://ideone.com/FB3fQ7\" rel=\"noreferrer\">Compiling this</a> will have the compiler complain about lack of a 2-argument constructor, and rightly so.</p>\n\n<p>I wonder, is there any technical reason not to define the function in terms of brace initialization instead? As in</p>\n\n<pre><code>template&lt;typename T, typename... Args&gt;\nstd::unique_ptr&lt;T&gt; make_unique(Args&amp;&amp;... args)\n{\n    return std::unique_ptr&lt;T&gt;(new T{std::forward&lt;Args&gt;(args)...});\n}\n</code></pre>\n\n<p>That <a href=\"https://ideone.com/BDsq1S\" rel=\"noreferrer\">works well enough</a> for the scenario above. Are there any other legitimate use cases this would break?</p>\n\n<p>Seeing how the general trend appears to prefer braces for initialization, I would assume making braces in that template would be the canonical choice, but the fact that the standard doesn't do it might be an indication of me missing something.</p>\n"}, {"tags": ["c++", "dependencies", "forward-declaration"], "comments": [{"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 1, "creation_date": 1552479725, "post_id": 55141592, "comment_id": 97023712, "body": "What you say about CMake and circular dependencies makes little sense. You can\u2019t include the error header in the db_manager header, obviously, but including it <code>db_manager.cpp</code> should be perfectly fine."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1552480194, "post_id": 55141592, "comment_id": 97024027, "body": "Create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1552480335, "post_id": 55141592, "comment_id": 97024117, "body": "Circular header dependency is only a problem for headers. Since source files should generally never be included, they can&#39;t be part of a circular dependency problem. Though for reference, <a href=\"https://stackoverflow.com/questions/4816698/avoiding-circular-dependencies-of-header-files\">here</a> is a question about resolving them."}, {"owner": {"reputation": 67, "user_id": 3739187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8695fc5fad44f5d075dea1762a1097ca?s=128&d=identicon&r=PG&f=1", "display_name": "codechao", "link": "https://stackoverflow.com/users/3739187/codechao"}, "edited": false, "score": 0, "creation_date": 1552480758, "post_id": 55141592, "comment_id": 97024391, "body": "db_manager and error are in 2 different packages. If I try to include the error header in db_manager.cpp, the compiler says it can&#39;t find it, and that is usually because the cmakelist and/or package.xml doesn&#39;t have the package that includes error in it as a dependency. And of course, if I add that, then we have a circular dependency."}], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 9634289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb71dbce9a93ed492fa47cbc9e4afea2?s=128&d=identicon&r=PG&f=1", "display_name": "A.K.", "link": "https://stackoverflow.com/users/9634289/a-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1552485433, "creation_date": 1552485433, "answer_id": 55143650, "question_id": 55141592, "link": "https://stackoverflow.com/questions/55141592/c-using-member-functions-with-forward-declaration/55143650#55143650", "title": "C++ using member functions with forward declaration", "body": "<p><strong>First: Your example is very bad.</strong> Please provide a minimum working example. I understand what your problem is (circular dependency), but your example is not showing this Problem. This is something you have to solve on an architectural level. You can't solve this inside CMake.</p>\n\n<p>Depending on the Code you have shown you don't need to include db_manager.h in error.h, since you are not using anything from db_manager during the declaration of class Error. You only need to include it inside error.cpp, since there you are using one static method from db_manager. That way you don't have any circular dependency.</p>\n\n<p>I have added a minimum working example below which compiles without any errors.</p>\n\n<p>error.h</p>\n\n<pre><code>#ifndef _ERROR_H_\n#define _ERROR_H_\n\n#include &lt;string&gt;\n\nclass Error\n{\npublic:\n  enum def_enum{ Val1, Val2};\n\n  bool read(int id);\n  static bool logError(def_enum v, std::string msg);\n};\n\n#endif /* _ERROR_H_ */\n</code></pre>\n\n<p>error.cpp</p>\n\n<pre><code>#include \"error.h\"\n#include \"db_manager.h\"\n\nbool Error::read(int id)\n{\n    return db_manager::read(id);\n}\n\nbool Error::logError(Error::def_enum v, std::string msg)\n{\n    //do error service stuff\n    return true;\n}\n</code></pre>\n\n<p>db_manager.h</p>\n\n<pre><code>#ifndef _DB_MANAGER_H_\n#define _DB_MANAGER_H_\n\n#include &lt;string&gt;\n#include \"error.h\"\n\nclass db_manager\n{\npublic:\n  static bool logError(Error::def_enum v, std::string msg);\n  static bool read(int id);\n};\n\n#endif /* _DB_MANAGER_H_ */\n</code></pre>\n\n<p>db_manager.cpp</p>\n\n<pre><code>#include \"db_manager.h\"\n\nbool db_manager::logError(Error::def_enum v, std::string msg)\n{\n    return Error::logError(v, msg);\n}\n\nbool db_manager::read(int id)\n{\n    //do db access stuff\n    return true;\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include \"db_manager.h\"\n#include \"error.h\"\n\nint main(){\n\n\n  db_manager::read(1);\n  db_manager::logError(Error::Val1, \"Test\");\n\n  Error e;\n  e.read(2);\n\n  return 0;\n}\n</code></pre>\n\n<p>CMakeLists.txt</p>\n\n<pre><code>project(db_manager)\n\nadd_executable(executable main.cpp db_manager.cpp error.cpp)\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 3739187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8695fc5fad44f5d075dea1762a1097ca?s=128&d=identicon&r=PG&f=1", "display_name": "codechao", "link": "https://stackoverflow.com/users/3739187/codechao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55143650, "answer_count": 1, "score": -1, "last_activity_date": 1552485433, "creation_date": 1552479024, "last_edit_date": 1552481501, "question_id": 55141592, "link": "https://stackoverflow.com/questions/55141592/c-using-member-functions-with-forward-declaration", "title": "C++ using member functions with forward declaration", "body": "<p>I've seen similar questions, but not quite like the predicament I find myself in. I'm working with someone else's code, and their structure is like this.</p>\n\n<pre><code>//db_manager.h\nclass db_manager\n{\n  class error;\n  bool logError(error::def_enum::Value v, string msg);\n\n  bool read(int id);\n}\n\n//db_manager.cpp\n#include db_manager.h\nbool logError(error::def_enum::Value v, string msg)\n{\n    return error::logError(v, msg);\n}\n\nbool read(int id)\n{\n    //do db access stuff\n    return true;\n}\n\n//error.h\n#include db_manager\nclass error\n{\n  bool read(int id);\n}\n\n//error.cpp\n#include error.h\nbool read(int id)\n{\n    return db_manager::read(id);\n}\n\nbool logError(error::def_enum::Value v, string msg)\n{\n    //do error service stuff\n}\n</code></pre>\n\n<p>This is a pretty obvious simplification, but hopefully it demonstrates the issue.</p>\n\n<p>When I compile, I get a lot of incomplete type errors whenever error is used in db_manager.cpp, and I can't include the relevant header files from error into db_manager.cpp, because then I have to add it to db_managers cmake dependencies, which means I have to list it in package.xml, and then it gets upset from the circular dependency. How can I get around this? If I could use error's members in db_manager without making error a dependency, I'd be good, I think, but I just can't figure out how to do that. I've seen many other forward-declaration questions on here, but for all of them, the declared class usage isn't very deep. Here I'm using class members, not just declaring a class pointer like other questions.</p>\n\n<p>I definitely could use help, I just don't see any logical way to do this without completely scrapping the error package and writing a new one.</p>\n\n<p>Edit: also, I simplified this out, but maybe I shouldn't have. error and db_manager are in two separate packages.</p>\n"}, {"tags": ["c++", "regex", "qt", "qt5", "qregexp"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1552478027, "post_id": 55141207, "comment_id": 97022580, "body": "What chars does <code>name</code> contains? If there are any special chars, like <code>(</code> or <code>[</code>, the regex may not work as expected."}, {"owner": {"reputation": 97, "user_id": 9994816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8213bd57ef3c330df0884b0638e7ac?s=128&d=identicon&r=PG&f=1", "display_name": "DevelopmentPeasant", "link": "https://stackoverflow.com/users/9994816/developmentpeasant"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1552478524, "post_id": 55141207, "comment_id": 97022892, "body": "Its a normal string typed into textbox. Like entering country names to filter chart. So in that way <code>name</code> would be &quot;Brazil&quot; for example"}], "answers": [{"tags": [], "owner": {"reputation": 528, "user_id": 8568673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4GHk.jpg?s=128&g=1", "display_name": "Jeredriq Demas", "link": "https://stackoverflow.com/users/8568673/jeredriq-demas"}, "is_accepted": true, "score": 1, "last_activity_date": 1552547463, "creation_date": 1552547463, "answer_id": 55156793, "question_id": 55141207, "link": "https://stackoverflow.com/questions/55141207/qregexp-not-matching-anything/55156793#55156793", "title": "QRegExp not matching anything", "body": "<p>I had somewhat similar thingy and it worked when I've added a regex to parameter QString. Try this:</p>\n\n<pre><code>....\nQString filterStr = \"^.*\"+name+\".*$\";\nQRegExp regExp(filterStr);\n....\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 9994816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8213bd57ef3c330df0884b0638e7ac?s=128&d=identicon&r=PG&f=1", "display_name": "DevelopmentPeasant", "link": "https://stackoverflow.com/users/9994816/developmentpeasant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 55156793, "answer_count": 1, "score": 0, "last_activity_date": 1552547463, "creation_date": 1552477783, "question_id": 55141207, "link": "https://stackoverflow.com/questions/55141207/qregexp-not-matching-anything", "title": "QRegExp not matching anything", "body": "<p>I've an application made by another person and I need to fix it. There's a chart on the view and a textbox for filtering the chart but filter doesnt work. For some reason QRegExp cant find anything.</p>\n\n<p>I am using QT5.12.1 and VS2015. </p>\n\n<pre><code>void ChartWidget::filterSeriesByName(QString name) {\n//  QString text=ui.lineEditFilterByName-&gt;text();\n    QRegExp regExp(name, Qt::CaseSensitive);\n    proxyModel-&gt;setFilterRegExp(regExp);\n    setFilterLabel();\n\n    foreach (QLegendMarker* marker, chart-&gt;legend()-&gt;markers())\n    {\n        if(regExp.isEmpty() || regExp.exactMatch(marker-&gt;series()-&gt;name())) {\n            setMarkerVisible(marker,true,true);\n        }\n        else {\n            setMarkerVisible(marker,true,false);\n        }\n    }\n}\n\nvoid ChartWidget::setFilterLabel() {\n    //resetVerticalHeader();\n    QString filteredCount = QString::number(proxyModel-&gt;rowCount()).append(\" / \");\n    filteredCount.append(QString::number(model-&gt;rowCount()));\n    filteredCount.append(\" kay\u0131t g\u00f6steriliyor\");\n\n    ui.labelFilter-&gt;setText(filteredCount);\n\n    QFont font = ui.labelFilter-&gt;font();\n    if (proxyModel-&gt;rowCount() != model-&gt;rowCount()) {\n        ui.labelFilter-&gt;setForegroundRole(QPalette::Link);\n        font.setStyle(QFont::StyleItalic);\n        ui.labelFilter-&gt;setFont(font);\n    } else {\n        ui.labelFilter-&gt;setForegroundRole(QPalette::WindowText);\n        font.setStyle(QFont::StyleNormal);\n        ui.labelFilter-&gt;setFont(font);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "proxy", "model", "qt4.8"], "comments": [{"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1552478122, "post_id": 55141141, "comment_id": 97022634, "body": "No. <code>QSortFilterProxyModel</code> already overrides them. The only functions you need to override (it&#39;s even not required) are protected virtual ones, such as ` QSortFilterProxyModel::lessThan()` etc."}, {"owner": {"reputation": 56, "user_id": 9630308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b740783d6db19cece7ce4aa3fe5e83f?s=128&d=identicon&r=PG&f=1", "display_name": "twohobos", "link": "https://stackoverflow.com/users/9630308/twohobos"}, "reply_to_user": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 0, "creation_date": 1552478608, "post_id": 55141141, "comment_id": 97022962, "body": "That seems to go against what the qt manual says, hasChildren() isn&#39;t protected virtual?"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1552479083, "post_id": 55141141, "comment_id": 97023281, "body": "Can you provide a reference for the manual excerpt?  Also note that it&#39;s referring to <code>QAbstractProxyModel</code> and not <code>QSortFilterProxyModel</code>."}, {"owner": {"reputation": 56, "user_id": 9630308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b740783d6db19cece7ce4aa3fe5e83f?s=128&d=identicon&r=PG&f=1", "display_name": "twohobos", "link": "https://stackoverflow.com/users/9630308/twohobos"}, "edited": false, "score": 0, "creation_date": 1552479246, "post_id": 55141141, "comment_id": 97023386, "body": "I&#39;ve updated the question with the link to the excerpt. It&#39;s on the page for the <code>QSortFilterProxyModel</code> as it&#39;s a subclass of <code>QAbstractProxyModel</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9290113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVa3k.jpg?s=128&g=1", "display_name": "freakMeduza", "link": "https://stackoverflow.com/users/9290113/freakmeduza"}, "is_accepted": false, "score": 1, "last_activity_date": 1552487365, "creation_date": 1552487365, "answer_id": 55144315, "question_id": 55141141, "link": "https://stackoverflow.com/questions/55141141/which-functions-to-override-with-a-custom-qsortfilterproxymodel/55144315#55144315", "title": "Which functions to override with a custom QSortFilterProxyModel", "body": "<p>No, you don't need to override these functions.</p>\n\n<p>Simple example QSortFilterProxyModel usage below:</p>\n\n<p>Model.hpp</p>\n\n<pre><code>#pragma once\n\n#include &lt;QAbstractListModel&gt;\n\nclass Model : public QAbstractListModel {\n    Q_OBJECT\npublic:\n    enum Roles {\n        Name = Qt::UserRole + 1\n    };\n\n    Model(QObject* parent = nullptr);\n    virtual ~Model();\n\n    // QAbstractItemModel interface\n    int rowCount(const QModelIndex &amp;parent) const noexcept override;\n    QVariant data(const QModelIndex &amp;index, int role) const noexcept override;\n    QHash&lt;int, QByteArray&gt; roleNames() const noexcept override;\n\nprivate:\n    QStringList list_;\n\n};\n</code></pre>\n\n<p>Model.cpp</p>\n\n<pre><code>#include \"Model.hpp\"\n\nModel::Model(QObject *parent) : QAbstractListModel{parent}\n{\n    list_ &lt;&lt; \"Adam\" &lt;&lt; \"John\" &lt;&lt; \"Alice\" &lt;&lt; \"Kate\";\n}\n\nModel::~Model()\n{\n\n}\n\nint Model::rowCount(const QModelIndex &amp;parent) const noexcept\n{\n    return list_.size();\n}\n\nQVariant Model::data(const QModelIndex &amp;index, int role) const noexcept\n{\n    if(!index.isValid() || role &lt; Name)\n        return QVariant{};\n\n    auto name = list_[index.row()];\n\n    if(role == Name)\n        return name;\n\n    return QVariant{};\n}\n\nQHash&lt;int, QByteArray&gt; Model::roleNames() const noexcept\n{\n    return QHash&lt;int, QByteArray&gt;{{Name, \"name\"}};\n}\n</code></pre>\n\n<p>FilterModel.hpp</p>\n\n<pre><code>#pragma once\n\n#include &lt;QSortFilterProxyModel&gt;\n\nclass FilterModel : public QSortFilterProxyModel {\n    Q_OBJECT\npublic:\n    FilterModel(QObject* parent = nullptr);\n    virtual ~FilterModel();\n\n    Q_INVOKABLE void setFilterString(const QString&amp; filter) noexcept;\n\n};\n</code></pre>\n\n<p>FilterModel.cpp</p>\n\n<pre><code>#include \"FilterModel.hpp\"\n#include \"Model.hpp\"\n\nFilterModel::FilterModel(QObject *parent) : QSortFilterProxyModel{parent}\n{\n\n}\n\nFilterModel::~FilterModel()\n{\n\n}\n\nvoid FilterModel::setFilterString(const QString &amp;filter) noexcept\n{\n    setFilterCaseSensitivity(Qt::CaseInsensitive);\n    setFilterFixedString(filter);\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;QGuiApplication&gt;\n#include &lt;QQmlApplicationEngine&gt;\n#include &lt;QQmlContext&gt;\n\n#include \"Model.hpp\"\n#include \"FilterModel.hpp\"\n\nint main(int argc, char *argv[])\n{\n    QGuiApplication app(argc, argv);\n\n    Model model;\n    FilterModel filterModel;\n\n    filterModel.setSourceModel(&amp;model);\n    filterModel.setFilterRole(Model::Name);\n\n    QQmlApplicationEngine engine;\n\n    QQmlContext* ctx = engine.rootContext();\n    ctx-&gt;setContextProperty(\"filterModel\", &amp;filterModel);\n\n    engine.load(QUrl(QStringLiteral(\"qrc:/main.qml\")));\n    if (engine.rootObjects().isEmpty())\n        return -1;\n\n    return app.exec();\n}\n</code></pre>\n\n<p>main.qml</p>\n\n<pre><code>import QtQuick 2.11\nimport QtQuick.Controls 2.2\nimport QtQuick.Layouts 1.3\n\nApplicationWindow {\n    visible: true\n\n    width: 200\n    height: 300\n\n    ColumnLayout {\n        anchors.fill: parent\n\n        TextField {\n            id: textField\n\n            Layout.fillWidth: true\n\n            placeholderText: \"Search...\"\n\n            onTextChanged: { filterModel.setFilterString(textField.text) }\n        }\n\n        ListView {\n            id: view\n\n            Layout.fillHeight: true\n            Layout.fillWidth: true\n\n            clip: true\n\n            model: filterModel\n\n            delegate: Text {\n                width: parent.width\n\n                text: name\n\n                font.pointSize: 14\n                font.bold: true\n\n                verticalAlignment: Text.AlignVCenter\n                horizontalAlignment: Text.AlignHCenter\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Notice if you have a custom class as an item of model, you have to override</p>\n\n<pre><code> bool QSortFilterProxyModel::filterAcceptsRow(int source_row, const QModelIndex &amp;source_parent) const\n</code></pre>\n\n<p>for your filter.</p>\n"}], "owner": {"reputation": 56, "user_id": 9630308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b740783d6db19cece7ce4aa3fe5e83f?s=128&d=identicon&r=PG&f=1", "display_name": "twohobos", "link": "https://stackoverflow.com/users/9630308/twohobos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552487365, "creation_date": 1552477523, "last_edit_date": 1552485051, "question_id": 55141141, "link": "https://stackoverflow.com/questions/55141141/which-functions-to-override-with-a-custom-qsortfilterproxymodel", "title": "Which functions to override with a custom QSortFilterProxyModel", "body": "<p>So I have a custom QAbstractItemModel that overrides the following functions:</p>\n\n<pre><code>QVariant data(..) const;\nQVariant headerData(..) const;\nQModelIndex index(..) const;\nQModelIndex parent(..) const;\nint rowCount(..) const;\nint columnCount(..) const;\nvirtual bool removeRows(..);\n</code></pre>\n\n<p>Is it necessary to override all of these in a custom QSortFilterProxyModel that uses my model as a source? </p>\n\n<p>The source of my confusion is this excerpt from the manual:</p>\n\n<blockquote>\n  <p>Since QAbstractProxyModel and its subclasses are derived from\n  QAbstractItemModel, much of the same advice about subclassing normal\n  models also applies to proxy models. In addition, it is worth noting\n  that many of the default implementations of functions in this class\n  are written so that they call the equivalent functions in the relevant\n  source model. This simple proxying mechanism may need to be overridden\n  for source models with more complex behavior; for example, if the\n  source model provides a custom hasChildren() implementation, you\n  should also provide one in the proxy model.<br/>\n  <a href=\"https://doc.qt.io/archives/qt-4.8/qsortfilterproxymodel.html#subclassing\" rel=\"nofollow noreferrer\">https://doc.qt.io/archives/qt-4.8/qsortfilterproxymodel.html#subclassing</a></p>\n</blockquote>\n"}, {"tags": ["c++", "input", "output"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1552477544, "post_id": 55141063, "comment_id": 97022276, "body": "Someone will surely confirm or dispute soon, but I seem to remember that reading from cin was changed so, that on parse errors the value is still set, to 0 in case of integer. This prevents undefined behaviour caused by uninitialised variables. Proper way to test if reading failed is to test stream status with the status methods of the class."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1552477645, "post_id": 55141063, "comment_id": 97022350, "body": "Note that if you leave local variable uninitialised it will be <i>default initialised</i>, which for int means uninitialised, so you wouldn&#39;t necessarily get 0, you could get anything when using the value (technically it is undefined behaviour, so theoretically the program could do <i>anything</i>)."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 2, "creation_date": 1552477750, "post_id": 55141063, "comment_id": 97022412, "body": "@hyde You mean: <a href=\"https://stackoverflow.com/q/19522504/583833\">istream behavior change in C++ upon failure</a> ?"}, {"owner": {"reputation": 145, "user_id": 4462694, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-RvI4fIPaRhw/AAAAAAAAAAI/AAAAAAAAABw/zohstFvLYr8/photo.jpg?sz=128", "display_name": "Vynylyn", "link": "https://stackoverflow.com/users/4462694/vynylyn"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1552477795, "post_id": 55141063, "comment_id": 97022434, "body": "@hyde I have initialised it."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1552477941, "post_id": 55141063, "comment_id": 97022525, "body": "@Vynylyn I was referring to &quot;just like the time I have not given an intial value&quot; text in your question."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1552478324, "post_id": 55141063, "comment_id": 97022774, "body": "@Borgleader Yep. Thanks for digging that out, put the link to the answer I just wrote."}], "answers": [{"tags": [], "owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "is_accepted": false, "score": 2, "last_activity_date": 1552478215, "creation_date": 1552478215, "answer_id": 55141351, "question_id": 55141063, "link": "https://stackoverflow.com/questions/55141063/c-not-receiving-expected-output/55141351#55141351", "title": "C++: Not receiving expected output", "body": "<p>Since C++11, when reading integer or floating point number from istream fails, the target variable is set to 0. See <a href=\"https://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt\" rel=\"nofollow noreferrer\">this (cppreference.com)</a> or <a href=\"https://stackoverflow.com/q/19522504/583833\">this (stack overflow.com)</a> for more on that.</p>\n\n<p>This means, you can't use a sentinel value to detect parse error, you have to use for example <a href=\"https://en.cppreference.com/w/cpp/io/basic_ios/fail\" rel=\"nofollow noreferrer\"><code>fail()</code> method</a> to check if there was some error.</p>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 4100453, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vAyr8.jpg?s=128&g=1", "display_name": "Alexander Falk", "link": "https://stackoverflow.com/users/4100453/alexander-falk"}, "is_accepted": false, "score": 2, "last_activity_date": 1552479071, "creation_date": 1552479071, "answer_id": 55141615, "question_id": 55141063, "link": "https://stackoverflow.com/questions/55141063/c-not-receiving-expected-output/55141615#55141615", "title": "C++: Not receiving expected output", "body": "<p>As per C++11, the value is set to zero, when an error occurs. See <a href=\"https://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt\" rel=\"nofollow noreferrer\">\"<em>If extraction fails, zero is written to value and failbit is set. If extraction results in the value too large or too small to fit in value...</em>\"</a> for more info.</p>\n"}], "owner": {"reputation": 145, "user_id": 4462694, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-RvI4fIPaRhw/AAAAAAAAAAI/AAAAAAAAABw/zohstFvLYr8/photo.jpg?sz=128", "display_name": "Vynylyn", "link": "https://stackoverflow.com/users/4462694/vynylyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1552479071, "creation_date": 1552477253, "last_edit_date": 1552477583, "question_id": 55141063, "link": "https://stackoverflow.com/questions/55141063/c-not-receiving-expected-output", "title": "C++: Not receiving expected output", "body": "<p>I'm trying to examine a C++ code from my tutorial book. I've written this using CodeBlocks IDE:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;cmath&gt;\n/*...*/\nusing namespace std;\n/*...*/\nint main (void){\n\n    cout &lt;&lt; \"Please enter name and age: \\n\\n:&gt;\";\n    string _sInput = \"\";\n    int _intInput = -1;\n    cin &gt;&gt; _sInput &gt;&gt; _intInput;\n    cout &lt;&lt; \"Hello \" &lt;&lt; _sInput &lt;&lt; \"!\\n\";\n    cout &lt;&lt; \"You have aged \" &lt;&lt; _intInput &lt;&lt; \" years.\";\n}\n</code></pre>\n\n<p>Based on what was discussed in the book by Mr. Stroustrup, now that I have given the variable <code>_intInput</code>an intial value, if I input wrong data like <code>James Boy</code> I am supposed to receive an output like this:</p>\n\n<pre><code>Hello James!\n\nYou have aged -1 years.\n</code></pre>\n\n<p>But what I get is <code>You have aged 0 years.</code> just like the time I have not given an intial value.<br>\nIs there anything wrong with my code or what?!</p>\n"}, {"tags": ["c++", "inheritance"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552476731, "post_id": 55140861, "comment_id": 97021767, "body": "To make polymorphism work in C++, you first of all need to make the polymorphic functions <code>virtual</code>. Then you need to use pointers or references to the <i>base</i> class, as in <code>A* b = new B;</code> If you want compile-time polymorphism there are ways around that, but it&#39;s a lot more work and makes your code much more complicated (and therefore harder to read, understand and maintain)."}, {"owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "edited": false, "score": 0, "creation_date": 1552476808, "post_id": 55140861, "comment_id": 97021823, "body": "It would be pretty confusing if A would be a large class, sort of hidden (e.g. from a library) and someone that extends it implements some random function that because of luck or coding standards matches something from A. The whole behavior of A might suddenly change."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "edited": false, "score": 0, "creation_date": 1552477023, "post_id": 55140861, "comment_id": 97021926, "body": "@Paul92: if A is in a library, and I extend B in my library with a member function that shadows a function from A, and the call resolves to this new function in B, that is exactly what I would expect to happen. :)"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552477024, "post_id": 55140861, "comment_id": 97021928, "body": "Also remember that inheritance is a <i>one way</i> relationship. If you call a member function in <code>A</code>, then it doesn&#39;t really know anything about possible child-classes. Virtual dispatch is a workaround for that problem, which solves it at run-time."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552477076, "post_id": 55140861, "comment_id": 97021962, "body": "@Someprogrammerdude: at the call site, I am calling member functions from <code>B</code> and <code>C</code>, so there would be no problem for the name resolution to just remember where <code>g()</code> was called from, resolve it in the parent, and switch back. It enters <code>B</code> and <code>C</code> first, then finds <code>using::</code>, jumps to <code>A</code> and sits there."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552477322, "post_id": 55140861, "comment_id": 97022133, "body": "If you use virtual, and you have small functions, everything should be inlined, so there would be no virtual dispatch at all for your example. If you have bigger functions, then I doubt that it matters whether the function is virtual or not. Calling virtual functions is fast, it doesn&#39;t work like &quot;resolve the function names at runtime&quot;. There is no naming resolve at runtime at all."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552477524, "post_id": 55140861, "comment_id": 97022257, "body": "By the way, I&#39;m very curious as to <i>why</i> you don&#39;t want to use standard polymorphism with <code>virtual</code> functions? Is it just plain curiosity, or is there a <i>real</i> problem in the background that you want to solve? If it&#39;s curiosity, then please state so in your question. If there&#39;s a real problem lurking behind, then please ask directly about that problem instead."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552477537, "post_id": 55140861, "comment_id": 97022267, "body": "@geza: <a href=\"https://stackoverflow.com/q/48906338/704028\">stackoverflow.com/q/48906338/704028</a> : devirtualization doesn&#39;t always work."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552477706, "post_id": 55140861, "comment_id": 97022385, "body": "@Someprogrammerdude: the struct member functions are radial-basis-function kernels, that are called 1e06 x 15 x 1e05 times in a numerical simulation. Counting on devirtualization to inline virtual functions is not something I want to do for that many function calls. Also, the structs (RBF kernels) are already used as template parameters of a larger interpolation class. All of this does not help the question at all - my motive for the question does not impact its solution."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552477770, "post_id": 55140861, "comment_id": 97022423, "body": "And note that doing <code>using A::g;</code> doesn&#39;t make the function a member of the class you do it in, it just adds the symbol so it can be found (and overrides the <code>private</code> inheritance). Talking about private inheritance, why do you use it? It&#39;s usually a form of composition, which often can be solved in other ways."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552477854, "post_id": 55140861, "comment_id": 97022475, "body": "@Someprogrammerdude: exactly my point as well. So the name lookup mechanism <i>knows</i> it is fetching <code>g()</code> <i>from a parent</i>, <i>in a derived class</i>. Why then not just fetch it and stay in the derived, <i>before</i> trying to look up <code>f()</code>?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1552477867, "post_id": 55140861, "comment_id": 97022481, "body": "That is very crucial information that should have been in the question itself from the very beginning. We really shouldn&#39;t have to drag information from you like this in comments. Knowing <i>why</i> you want to do something is really crucial for out understanding, and how we will and can help you. Just asking about a solution, without mentioning the problem it&#39;s supposed to solve, makes a question an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552478114, "post_id": 55140861, "comment_id": 97022627, "body": "@tmaric: evaluating RBF functions likely takes much more time than the time difference between virtual and non-virtual function calls. Put your whole problem here please, because it is not OK to say &quot;devirtualization doesn&#39;t always work&quot;. Put your exact case here, so we can check whether devirtualization works or not."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552478239, "post_id": 55140861, "comment_id": 97022708, "body": "@geza: I can&#39;t upload my not yet open source library. The model describes exactly what I want, and there is already an answer based on templates, doing the work at compile time."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552478447, "post_id": 55140861, "comment_id": 97022845, "body": "@tmaric: your question is very vague at some points. The current answer modifies your model, as it doesn&#39;t have a simple base class <code>A</code>, but a bunch of them. You may think that your question is super clear, but believe me, it is not. Anyways, it is up to you. If you don&#39;t give enough information, it is likely that you won&#39;t get good answers."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552478582, "post_id": 55140861, "comment_id": 97022935, "body": "@geza: Assuming the model is the only thing I can show, can you tell me what is the reasoning for the name lookup to stick to the base class, instead of returning to the derived class once it looked up <code>g()</code>?"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552478683, "post_id": 55140861, "comment_id": 97023020, "body": "@tmaric: this is how C++ works. If you want the &quot;lookup&quot; (note, your terminology is wrong, lookup is a different thing in C++, it is a compile-time thing) done differently, put <code>virtual</code> there. In common implementations, in current CPUs, the difference between virtual and non-virtual calls is very small (it is just a function call from a table, indexed by a constant integer. No string operations are done, which you may seem to think)."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552481180, "post_id": 55140861, "comment_id": 97024659, "body": "@geza: &quot;this is how C++ works&quot; doesn&#39;t answer my question. Nowhere did I imply that string operations are done. Yes, it&#39;s called member name lookup: The C++ standard, Section 13.2 &quot;Member name <i>lookup</i>&quot;."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552482768, "post_id": 55140861, "comment_id": 97025692, "body": "@tmaric: &quot;resolve the function names at runtime&quot;. One can easily think that this some string related thing. Like calling a function from .so/.dll. And about lookup, you&#39;re still wrong. When you are in <code>A::g()</code>, the call <code>f()</code> will find <code>A::f()</code>. That&#39;s name lookup. No matter whether <code>f</code> is virtual or not. If <code>f</code> is virtual, then <code>B::f</code> will override it, and at run-time, <code>B::f</code> will be called (If <code>this</code> points to <code>B</code>) instead of <code>A::f</code>. This mechanism is not lookup. Btw., if C++ worked the way you say, what would be the difference between virtual and non-virtual functions?"}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "edited": false, "score": 0, "creation_date": 1552483111, "post_id": 55140861, "comment_id": 97025941, "body": "How does calling <code>B b; b.g()</code> not involve name lookup? <code>g()</code> is inherited from <code>A</code> and needs to be found. Regarding virtual functions: the difference would be the same as it is now - access of a derived type via a pointer to the base. It is quite clear when this happens and when the types are known at compile time. I&#39;m just simply asking: why isn&#39;t <code>B::f()</code> used for this specific example, I still don&#39;t see a reason to force <code>A::f()</code> just because <code>using A::g()</code> is in <code>B</code>. The base is overriding a derived function in this case, that is visible and more specialized in the object hierarchy."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552483497, "post_id": 55140861, "comment_id": 97026204, "body": "Of course it involves a lookup. But the mechanism you want from C++ is not called lookup. Anyways, let&#39;s drop this subject. :) You seem to misunderstand something. The behavior you see has nothing to do with <code>using A::g</code>. When you call <code>b.g()</code>, <code>A::g()</code> will be called (even if you use <code>using A::g</code> in <code>B</code>). At that point in <code>A::g()</code>, the name <code>f</code> will find <code>A::f</code>. And as <code>A::f</code> is not virtual, <code>A::f</code> will be called."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1552483681, "post_id": 55140861, "comment_id": 97026331, "body": "@geza: OK, thanks a lot for the help! :) I will dig around, maybe I find an example where doing: &quot;find g() in A, go back to B, find f() in B, use it&quot; would break something else somewhere."}], "answers": [{"comments": [{"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "edited": false, "score": 0, "creation_date": 1552481725, "post_id": 55140954, "comment_id": 97025004, "body": "Thank you for answering the other part as well! I can turn your question around, maybe it helps to show my perspective. By implementing B, I am specializing A in a hierarchy (that is also the case when <code>virtual</code> is used). I am then surprised, that when I use <code>B b; b.g();</code>, the class <code>A</code> <i>arbitrarily</i> overrides <code>f()</code> ,simply because it shares <code>g()</code> with its derived classes. :) Why is this direction OK in the language, and the other one isn&#39;t? I would expect that the <i>most specialized</i> (down in the hierarchy) object is used."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "edited": false, "score": 0, "creation_date": 1552481790, "post_id": 55140954, "comment_id": 97025032, "body": "Also, if <code>endl</code> is added to <code>B</code>, how can it break <code>A</code> under these rules, when <code>A a; A.g();</code> is called? Under these rules, everything is first found in <code>A</code>. For <code>A</code>, there is no base, so there is a compile error because the name lookup didn&#39;t find something in this case. Otherwise, its base is searched for <code>endl</code>, <code>endl</code> is found and resolved in <code>A</code> and not the base."}, {"owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "edited": false, "score": 0, "creation_date": 1552482010, "post_id": 55140954, "comment_id": 97025186, "body": "&quot;Should B have to care about all the private member names of A?&quot;: It can&#39;t and doesn&#39;t if they are private."}], "tags": [], "owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "is_accepted": true, "score": 5, "last_activity_date": 1552479604, "last_edit_date": 1552479604, "creation_date": 1552476913, "answer_id": 55140954, "question_id": 55140861, "link": "https://stackoverflow.com/questions/55140861/why-does-the-member-function-name-lookup-stay-in-the-parent-class/55140954#55140954", "title": "Why does the member function name lookup stay in the parent class?", "body": "<p>This is a standard task for the <a href=\"https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern\" rel=\"nofollow noreferrer\">CRTP</a>. The base class needs to know what the static type of the object is, and then it just casts itself to that.</p>\n\n<pre><code>template&lt;typename Derived&gt;\nstruct A\n{\n    void g() const\n    {\n        cout &lt;&lt; static_cast&lt;Derived const*&gt;(this)-&gt;f() &lt;&lt; endl;\n    }\n};\n\nstruct B : A&lt;B&gt;\n{\n    using A::g; \n    double f() const { return 1; };\n};\n</code></pre>\n\n<p>Also, responding to a comment you wrote, (which is maybe your real question?),</p>\n\n<blockquote>\n  <p>can you tell me what is the reasoning for the name lookup to stick to the base class, instead of returning to the derived class once it looked up g()? </p>\n</blockquote>\n\n<p>Because classes are intended to be used for object-oriented programming, not for code reuse. The programmer of <code>A</code> needs to be able to understand what their code is doing, which means subclasses shouldn't be able to <em>arbitrarily</em> override functionality from the base class. That's what <code>virtual</code> is, really: <code>A</code> giving its subclasses permission to override <em>that specific member</em>. Anything that <code>A</code> hasn't opted-in to that for, they should be able to rely on.</p>\n\n<p>Consider in your example: What if the author of <code>B</code> later added an integer member which happened to be called <code>endl</code>? Should that break <code>A</code>? Should <code>B</code> have to care about all the private member names of <code>A</code>? And if the author of <code>A</code> wants to add a member variable, should they be able to do so in a way that doesn't potentially break some subclass? (The answers are \"no\", \"no\", and \"yes\".)</p>\n"}], "owner": {"reputation": 4815, "user_id": 704028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/64accf9ad1449326ae9f62e0f9e387c5?s=128&d=identicon&r=PG&f=1", "display_name": "tmaric", "link": "https://stackoverflow.com/users/704028/tmaric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 55140954, "answer_count": 1, "score": 2, "last_activity_date": 1552479604, "creation_date": 1552476581, "last_edit_date": 1552477958, "question_id": 55140861, "link": "https://stackoverflow.com/questions/55140861/why-does-the-member-function-name-lookup-stay-in-the-parent-class", "title": "Why does the member function name lookup stay in the parent class?", "body": "<p>Motivation, if it helps: : I have struct member functions that are radial-basis-function kernels. They are called 1e06 x 15 x 1e05 times in a numerical simulation. Counting on devirtualization to inline virtual functions is not something I want to do for that many function calls. Also, the structs (RBF kernels) are already used as template parameters of a larger interpolation class.</p>\n\n<p><strong>Minimal working example</strong></p>\n\n<p>I have a function <code>g()</code> that is always the same, and I want to reuse it, so I pack it in the base class. </p>\n\n<p>The function <code>g()</code> calls a function <code>f()</code> that is different in derived classes. </p>\n\n<p><strong>I don't want to use <code>virtual</code> functions to resolve the function names at runtime, because this incurs additional costs (I measured it in my code, it has an effect).</strong> </p>\n\n<p>Here is the example: </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct A \n{\n    double f() const { return 0; };\n\n    void g() const\n    {\n        std::cout &lt;&lt; f() &lt;&lt; std::endl; \n    }\n};\n\nstruct B : private A\n{\n    using A::g; \n    double f() const { return 1; };\n};\n\nstruct C : private A\n{\n    using A::g;\n    double f() const { return 2; };\n};\n\nint main()\n{\n    B b; \n    C c; \n\n    b.g(); // Outputs 0 instead of 1 \n    c.g(); // Outputs 0 instead of 2\n}\n</code></pre>\n\n<p>I expected the name resolution mechanism to figure out I want to use \"A::g()\", but then to return to \"B\" or \"C\" to resolve the \"f()\" function. Something along the lines: \"when I know a type at compile time, I will try to resolve all names in this type first, and do a name lookup from objects/parents something is missing, then go back to the type I was called from\". However, it seems to figure out \"A::g()\" is used, then it sits in \"A\" and just picks \"A::f()\", even though the actual call to \"g()\" came from \"B\" and \"C\". </p>\n\n<p>This can be solved using virtual functions, <strong>but I don't understand and would like to know the reasoning behind the name lookup sticking to the parent class when types are known at compile time</strong>. </p>\n\n<p><strong>How can I get this to work without virtual functions?</strong></p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 1, "creation_date": 1552476370, "post_id": 55140723, "comment_id": 97021561, "body": "I&#39;m not sure what your desired class structure is. Are <code>A</code>, <code>B</code>, and <code>C</code> really not subclasses of <code>BASE</code>? What <i>precisely</i> do you want to clone, an object or a class.... and what do you want the <i>precise</i> effect of that cloning to be?"}, {"owner": {"reputation": 956, "user_id": 6449949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a920ba06a595d7137a076ab1de7425?s=128&d=identicon&r=PG&f=1", "display_name": "paler123", "link": "https://stackoverflow.com/users/6449949/paler123"}, "edited": false, "score": 0, "creation_date": 1552476397, "post_id": 55140723, "comment_id": 97021574, "body": "You might be interested in <a href=\"https://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Virtual_Constructor\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1552477092, "post_id": 55140723, "comment_id": 97021974, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You have, among other errors, mismatched braces all over the place."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1552477330, "post_id": 55140723, "comment_id": 97022141, "body": "What are you allowed to change to achieve &quot;Running the program should produce the output: ...&quot;? The simplest thing would to just <code>std::cout</code> each of those lines in turn"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1552477420, "post_id": 55140723, "comment_id": 97022191, "body": "Your <code>main</code> is also illegal. You can&#39;t re-use the name <code>ptr</code> with multiple declarations"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1552478630, "post_id": 55140723, "comment_id": 97022978, "body": "Firstly, your code will not compile (even allowing for the incomplete <code>clone()</code> function).    Second, cloning has a specific meaning - producing an object of the same type and value as the original.    You&#39;re using cloning to describe cloning an object of type <code>A</code> as somehow producing an object (or a pointer to an object) of unrelated type <code>B</code>.   That doesn&#39;t make sense."}, {"owner": {"reputation": 757, "user_id": 683387, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40a933b7a2d658f881ded16bbdc50df6?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/683387/jeffr"}, "edited": false, "score": 0, "creation_date": 1552507712, "post_id": 55140723, "comment_id": 97041114, "body": "The code wasn&#39;t meant to compile - I typed it off the top of my head just to give an idea of what I wanted to do.  Caleth&#39;s answer below is almost exactly what I want.  I can use what he has, and create a pointer that points to first base, then to a, then to b etc. to achieve what I want.  Thanks Caleth."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1552509088, "post_id": 55140723, "comment_id": 97041755, "body": "You don&#39;t need pointers to anything here. The <code>main</code> in my answer gives the desired output. C++ has value copying <i>by default</i>"}, {"owner": {"reputation": 757, "user_id": 683387, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40a933b7a2d658f881ded16bbdc50df6?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/683387/jeffr"}, "edited": false, "score": 0, "creation_date": 1552536005, "post_id": 55140723, "comment_id": 97049486, "body": "That&#39;s true, but I don&#39;t want the variable name to change.  I just want to refer to the same variable throughout its evolution - so a pointer that starts out pointing at &quot;base&quot;, then points at &quot;a&quot;, then &quot;b&quot; etc. as the object changes.  I don&#39;t need to, but it makes more sense in the code if I do.  It&#39;s a little like the base class being &quot;person&quot;, and having a pointer to that person but having the type of person change from &quot;baby&quot;, to&quot;child&quot;, &quot;adolescent&quot;, &quot;adult&quot; etc as the person ages.  The pointer doesn&#39;t change name, but the underlying class changes."}], "answers": [{"comments": [{"owner": {"reputation": 757, "user_id": 683387, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40a933b7a2d658f881ded16bbdc50df6?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/683387/jeffr"}, "edited": false, "score": 0, "creation_date": 1552507774, "post_id": 55141485, "comment_id": 97041141, "body": "Thanks Caleth - this is almost exactly what I need."}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": true, "score": 0, "last_activity_date": 1552478646, "creation_date": 1552478646, "answer_id": 55141485, "question_id": 55140723, "link": "https://stackoverflow.com/questions/55140723/clone-an-instance-of-a-class-then-clone-the-clone-then-clone-the-clone/55141485#55141485", "title": "Clone an instance of a class, then clone the clone, then clone the clone...?", "body": "<p>It sounds like you want <code>A</code>, <code>B</code> and <code>C</code> to inherit from <code>BASE</code>, and be constructable from one. </p>\n\n<pre><code>#include &lt;cstdio&gt;\n\nclass BASE {\nprivate:\n\n    int m_x = 1;\n    int m_y = 2;\n    int m_z = 3;\n\npublic:\n\n    virtual void id() { printf(\"BASE\\n\"); }\n\n    virtual void f1() { printf(\"BASE f1\\n\"); }\n    void f2() { printf(\"BASE f2\\n\"); } /* virtual ? */ \n    void f3() { printf(\"BASE f3\\n\"); } /* virtual ? */ \n\n    void x() { printf(\"x = %d\\n\", m_x); }\n    void y() { printf(\"y = %d\\n\", m_y); }\n    void z() { printf(\"z = %d\\n\", m_z); }\n\n    void x(int v) { m_x = v; }\n    void y(int v) { m_y = v; }\n    void z(int v) { m_z = v; }\n};\n\nclass A : public BASE {\npublic:\n    A(const BASE &amp; base) : BASE(base) {}\n    A&amp; operator = (const BASE &amp; base) { static_cast&lt;BASE&amp;&gt;(*this) = base; return *this; }\n\n    void id() override { printf(\"A\\n\"); };\n    void f1() override { printf(\"A f1\\n\"); };\n};\n\nclass B : public BASE {\npublic:\n    B(const BASE &amp; base) : BASE(base) {}\n    B&amp; operator = (const BASE &amp; base) { static_cast&lt;BASE&amp;&gt;(*this) = base; return *this; }\n\n    void id() override { printf(\"B\\n\"); };\n    void f1() override { printf(\"B f1\\n\"); };\n};\n\nclass C : public BASE {\npublic:\n    C(const BASE &amp; base) : BASE(base) {}\n    C&amp; operator = (const BASE &amp; base) { static_cast&lt;BASE&amp;&gt;(*this) = base; return *this; }\n    void id() override { printf(\"C\\n\"); };\n    void f1() override { printf(\"C f1\\n\"); };\n};\n\nint main() {\n\n    BASE base;\n\n    base.id();\n    base.f1();\n    base.f2();\n    base.f3();\n    base.x();\n    base.y();\n    base.z();\n\n    printf(\"\\n\\n\");\n\n    A a = base;\n\n    a.id();\n    a.f1();\n    a.f2();\n    a.f3();\n    a.x(7);  // change member x to 7\n    a.x();\n    a.y();\n    a.z();\n\n    printf(\"\\n\\n\");\n\n    B b = a;\n\n    b.id();\n    b.f1();\n    b.f2();\n    b.f3();\n    b.x();\n    b.y(9);  // change member y to 9\n    b.y();\n    b.z();\n\n    printf(\"\\n\\n\");\n\n    C c = b;\n\n    c.id();\n    c.f1();\n    c.f2();\n    c.f3();\n    c.x();\n    c.y();\n    c.z(5);  // change member z to 5\n    c.z();\n\n}\n</code></pre>\n\n<p>You really don't need inheritance here, as there is just a data difference between <code>BASE</code>, <code>A</code>, <code>B</code> and <code>C</code>.</p>\n"}], "owner": {"reputation": 757, "user_id": 683387, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40a933b7a2d658f881ded16bbdc50df6?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/683387/jeffr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 55141485, "answer_count": 1, "score": -3, "last_activity_date": 1552478646, "creation_date": 1552476157, "question_id": 55140723, "link": "https://stackoverflow.com/questions/55140723/clone-an-instance-of-a-class-then-clone-the-clone-then-clone-the-clone", "title": "Clone an instance of a class, then clone the clone, then clone the clone...?", "body": "<p>I have a need to clone a class from an instance of another class, having the clone inherit the characteristics of the original class with some new/changed attributes defined, then clone the clone, clone the clone etc.  The code below hopefully shows want I want to achieve.  I've tried variations of several stackoverflow answers regarding cloning classes, but I'm not able to get it to work.  Can anyone help?</p>\n\n<p>This is the (incomplete) code:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n\nclass BASE {\n\n    private:\n\n        int x = 1;\n        int y = 2;\n        int z = 3;\n\n    public:\n\n        void id() { printf(\"BASE\\n\"); }\n\n        void f1() { printf(\"BASE f1\\n\" }\n        void f2() { printf(\"BASE f2\\n\" }\n        void f3() { printf(\"BASE f3\\n\" }\n\n        void x() { printf(\"x = %d\\n\", x);\n        void y() { printf(\"y = %d\\n\", y);\n        void z() { printf(\"z = %d\\n\", z);\n\n        void x(int v) { x = v);\n        void y(int v) { y = v);\n        void z(int v) { z = v);\n}\n\nclass A {\n\n    public:\n\n        void id() { printf(\"A\\n\"); }\n\n        void f1() { printf(\"A f1\\n\" }\n\n        void x() { printf(\"x = %d\\n\", x);\n        void y() { printf(\"y = %d\\n\", y);\n        void z() { printf(\"z = %d\\n\", z);\n\n        void x(int v) { x = v);\n        void y(int v) { y = v);\n        void z(int v) { z = v);\n}\n\nclass B {\n\n    public:\n\n        void id() { printf(\"B\\n\"); }\n\n        void f1() { printf(\"B f1\\n\" }\n\n        void x() { printf(\"x = %d\\n\", x);\n        void y() { printf(\"y = %d\\n\", y);\n        void z() { printf(\"z = %d\\n\", z);\n\n        void x(int v) { x = v);\n        void y(int v) { y = v);\n        void z(int v) { z = v);\n}\n\nclass C {\n\n    public:\n\n        void id() { printf(\"C\\n\"); }\n\n        void f1() { printf(\"C f1\\n\" }\n\n        void x() { printf(\"x = %d\\n\", x);\n        void y() { printf(\"y = %d\\n\", y);\n        void z() { printf(\"z = %d\\n\", z);\n\n        void x(int v) { x = v);\n        void y(int v) { y = v);\n        void z(int v) { z = v);\n}\n\nint main() {\n\n    BASE *ptr = new BASE();\n\n    ptr-&gt;id();\n    ptr-&gt;f1();\n    ptr-&gt;f2();\n    ptr-&gt;f3();\n    ptr-&gt;x();\n    ptr-&gt;y();\n    ptr-&gt;z();\n\n    printf(\"\\n\\n\");\n\n    A *a = base-&gt;clone();\n\n    delete ptr;\n    A *ptr = a;\n\n    ptr-&gt;id();\n    ptr-&gt;f1();\n    ptr-&gt;f2();\n    ptr-&gt;f3();\n    ptr-&gt;x(7);  // change member x to 7\n    ptr-&gt;x();\n    ptr-&gt;y();\n    ptr-&gt;z();\n\n    printf(\"\\n\\n\");\n\n    B *b = a-&gt;clone();\n\n    delete ptr;\n    B *ptr = b;\n\n    ptr-&gt;id();\n    ptr-&gt;f1();\n    ptr-&gt;f2();\n    ptr-&gt;f3();\n    ptr-&gt;x();\n    ptr-&gt;y(9);  // change member y to 9\n    ptr-&gt;y();\n    ptr-&gt;z();\n\n    printf(\"\\n\\n\");\n\n    C *c = b-&gt;clone();\n\n    delete ptr;\n    C *ptr = c;\n\n    ptr-&gt;id();\n    ptr-&gt;f1();\n    ptr-&gt;f2();\n    ptr-&gt;f3();\n    ptr-&gt;x();\n    ptr-&gt;y();\n    ptr-&gt;z(5);  // change member z to 5\n    ptr-&gt;z();\n\n}\n</code></pre>\n\n<p>The code is not complete - most notably the \"clone()\" function is not written.  That's the bit I don't know how to do.</p>\n\n<p>Running the program should produce the output:</p>\n\n<pre><code>BASE\nBASE f1\nBASE f2\nBASE f3\nx = 1\ny = 2\nz = 3\n\n\nA\nA f1\nBASE f2\nBASE f3\nx = 7\ny = 2\nz = 3\n\n\nB\nB f1\nBASE f2\nBASE f3\nx = 7\ny = 9\nz = 3\n\n\nC\nC f1\nBASE f2\nBASE f3\nx = 7\ny = 9\nz = 5\n</code></pre>\n\n<p>Can this be achieved?  If so, how?</p>\n"}, {"tags": ["c++", "templates", "function-pointers"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1552476352, "post_id": 55140578, "comment_id": 97021548, "body": "<code>template&lt;template &lt;typename&gt; typename T&gt;</code> means <code>T</code> is a <i>template</i>, not a type. If you have trouble passing template functions, use functors instead."}, {"owner": {"reputation": 548, "user_id": 5583878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-YuHSssE2c98/AAAAAAAAAAI/AAAAAAAAACc/VvjqlMwl3wA/photo.jpg?sz=128", "display_name": "Aryan", "link": "https://stackoverflow.com/users/5583878/aryan"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1552477223, "post_id": 55140578, "comment_id": 97022070, "body": "@PasserBy I added my reasoning to my code. I don&#39;t know the syntax of how I would go about doing this but I wanted to make an attempt at solving the issue."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1552477331, "post_id": 55140578, "comment_id": 97022143, "body": "Why not <code>measure_func([&amp;]{ serial::merge_sort(data.begin(), data.end(), std::less&lt;&gt;{}); });</code>?"}, {"owner": {"reputation": 548, "user_id": 5583878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-YuHSssE2c98/AAAAAAAAAAI/AAAAAAAAACc/VvjqlMwl3wA/photo.jpg?sz=128", "display_name": "Aryan", "link": "https://stackoverflow.com/users/5583878/aryan"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1552477520, "post_id": 55140578, "comment_id": 97022250, "body": "@PasserBy That is a good idea. I don&#39;t know why I didn&#39;t think of that. I would still like to figure out if what I&#39;m trying to do is possible or not. For curiosity reasons. Thank you"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1552478742, "post_id": 55140578, "comment_id": 97023059, "body": "You can&#39;t pass a function template as a template parameter. You would need to make <code>sub</code> and <code>add</code> template classes for this to work. It seems like the wrong approach, where Passer&#39;s suggestion in on point."}], "owner": {"reputation": 548, "user_id": 5583878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-YuHSssE2c98/AAAAAAAAAAI/AAAAAAAAACc/VvjqlMwl3wA/photo.jpg?sz=128", "display_name": "Aryan", "link": "https://stackoverflow.com/users/5583878/aryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 1, "closed_date": 1552482901, "answer_count": 0, "score": 4, "last_activity_date": 1552477332, "creation_date": 1552475653, "last_edit_date": 1552477332, "question_id": 55140578, "link": "https://stackoverflow.com/questions/55140578/return-function-pointer-by-auto-filling-template-parameters", "closed_reason": "Duplicate", "title": "Return function pointer by auto filling template parameters", "body": "<p>I am trying to create a simple way to return a pointer to a template function with a special initialization. The best way I can describe this is with actual code.</p>\n\n<p>The reason I am using something like this is because in my actual production code, I have a <code>measure_func</code> function that calls a function and measures the time it takes to execute that function. The function I am tryng to measure has very long template parameters and trying to get this might make getting the function pointer easier.</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;cassert&gt;\n\ntemplate &lt;typename T&gt;\nT add (T a, T b) {\n    return a + b;\n}\n\ntemplate &lt;typename T&gt;\nT sub (T a, T b) {\n    return a - b;\n}\n\n\ntemplate &lt;typename F, typename ...A&gt;\nstd::invoke_result_t&lt;F&gt; do_operation(F func, A &amp;&amp;...args) {\n    return func( std::forward&lt;A&gt;(args)... );\n}\n\n/// Attempt? Doesn't work though\ntemplate&lt;template &lt;typename&gt; typename T&gt;\nauto get_float_func(T t) {\n    return &amp;t&lt;float&gt;;\n}\n\n\nint main() {\n    // here I can create a function or a templated struct that returns the address of add&lt;float&gt;\n    auto float_add = get_float_func(add);\n\n    // here get_float_func returns the address of sub&lt;float&gt;\n    auto float_sub = get_float_func(sub);\n\n    // that way I can more easily call do_operation like this\n    float ans1 = do_operation(float_add, 1.5, 1.0);\n    assert(ans1 == 2.5);\n    float ans2 = do_operation(float_sub, 1.5, 1.0);\n    assert(ans2 == 0.5);\n}\n</code></pre>\n\n<p>So in the code, <code>get_float_func</code> returns the address of <code>t&lt;float&gt;</code>. In the first case <code>t</code> is the <code>add</code> template function. Once we have the pointer, we can invoke the result using <code>do_operation</code></p>\n\n<p>EDIT1:</p>\n\n<p>The reason behind this is because for our class assignment we have to write a parallel merge sort code in 3 different ways. A serial way that uses one thread, a parallel way that splits the work statically, and a threadpool merge sort that dynamically splits the work and assigns it to different threads. Each of these merge sorts are in 3 different namespaces but share the same function declaration. I have a function that you can pass in a function pointer and it will measure the time that function takes and returns it. I want to be able to write something like this:</p>\n\n<pre><code>namespace serial {\n    template &lt;typename I, typename O = std::less&lt;typename I::value_type&gt;&gt;\n    void merge_sort(I begin, I end, O op = {  })\n    { /* code */ }\n}\n\nnamespace parallel {\n    template &lt;typename I, typename O = std::less&lt;typename I::value_type&gt;&gt;\n    void merge_sort(I begin, I end, O op = {  })\n    { /* code */ }\n}\n\nnamespace threadpool {\n    template &lt;typename I, typename O = std::less&lt;typename I::value_type&gt;&gt;\n    void merge_sort(I begin, I end, O op = {  })\n    { /* code */ }\n}\n\nint main() {\n    std::vector&lt;int&gt; data = create_random_array();\n    /// I want to create something that will always return the instantiation of merge_sort&lt;std::vector&lt;int&gt;::iterator, std::less&lt;int&gt;&gt;\n    /// function pointer\n    float elapse1 = measure_func(serial::merge_sort,     data.begin(), data.end(), std::less&lt;int&gt;{  });\n    float elapse2 = measure_func(parallel::merge_sort,   data.begin(), data.end(), std::less&lt;int&gt;{  });\n    float elapse3 = measure_func(threadpool::merge_sort, data.begin(), data.end(), std::less&lt;int&gt;{  });\n}\n</code></pre>\n\n<p>The above code does not work because serial::merge_sort and the like are not function pointers, but need template initialization. </p>\n"}, {"tags": ["c++", "c++11", "templates", "variadic"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1552475393, "post_id": 55140284, "comment_id": 97020967, "body": "Unfortunately, braced initialization lists cannot be bound to non-typed template parameters, which is the fundamental problem here."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1552475538, "post_id": 55140284, "comment_id": 97021060, "body": "How about <code>append (   std::make_pair(&quot;first&quot;, 3),   std::make_pair(&quot;second&quot;, 2.),   std::make_pair(&quot;third&quot;, std::string { &quot;test&quot; }) );</code> ?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1552476069, "post_id": 55140284, "comment_id": 97021375, "body": "You can probably use boost::assign or something similar <code>append(std::cout)(&quot;first&quot;, int{3})(&quot;second&quot;, double{ 2.0})(&quot;third&quot;, std::string{&quot;test&quot;})</code>"}], "answers": [{"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1552478961, "post_id": 55140903, "comment_id": 97023204, "body": "Why are you moving <code>*this</code> into a fresh <code>t_Append</code> to return? And I don&#39;t think you need to declare a move constructor"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1552509963, "post_id": 55140903, "comment_id": 97042142, "body": "@Caleth The idea was to suppress <code>t_Append</code> class from being used as a functor and passed around. In original code it had <code>Append</code> as a friend and all the constructors were private so presence of user-defined move constructor prevents public copy / move constructors from being generated. Also note rvalue reference qualifier on <code>operator ()</code>."}], "tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": true, "score": 2, "last_activity_date": 1552476703, "creation_date": 1552476703, "answer_id": 55140903, "question_id": 55140284, "link": "https://stackoverflow.com/questions/55140284/structured-arguments-as-variadic-template/55140903#55140903", "title": "structured arguments as variadic template", "body": "<p>You can probably use boost::assign or something similar:</p>\n\n<pre><code> class t_Append final\n {\n     private: ::std::ostream &amp; m_where;\n\n     public: explicit\n     t_Append\n     (\n         ::std::ostream &amp; where\n     ) noexcept\n     :   m_where{where}\n     {\n         return;\n     }\n\n     public: explicit\n     t_Append\n     (\n          t_Append &amp;&amp; other\n     ) noexcept\n     :    m_where{other.m_where}\n     {\n          return;\n     }\n\n     public: template\n     &lt;\n         typename x_Object\n     &gt; auto\n     operator ()\n     (\n          char const * const psz_str\n     ,    x_Object const &amp; object\n     ) &amp;&amp;\n     {\n          m_where &lt;&lt; \"str: \" &lt;&lt; psz_str &lt;&lt; \" type: \" &lt;&lt; object &lt;&lt; \"\\n\";\n          return t_Append{::std::move(*this)};\n     }\n };\n\n inline auto\n Append(::std::ostream &amp; where)\n {\n     return t_Append{where};\n }\n</code></pre>\n\n<p>usage:</p>\n\n<pre><code> Append(::std::cout)\n     (\"first\", int{3})\n     (\"second\", double{2.0})\n     (\"third\", ::std::string{\"test\"});\n</code></pre>\n"}], "owner": {"reputation": 425, "user_id": 10911886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51aa344456eed18b5a1f88711d7ce76?s=128&d=identicon&r=PG&f=1", "display_name": "user3520616", "link": "https://stackoverflow.com/users/10911886/user3520616"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 55140903, "answer_count": 1, "score": 2, "last_activity_date": 1552476703, "creation_date": 1552474794, "question_id": 55140284, "link": "https://stackoverflow.com/questions/55140284/structured-arguments-as-variadic-template", "title": "structured arguments as variadic template", "body": "<p>I've a method needing two parameters: An alias (string) and an object (of any type).</p>\n\n<p>Now I would like to have a (template) method taking n of those pairs; The syntax should look like this:</p>\n\n<pre><code>append (\n  { \"first\", int { 3 } },\n  { \"second\", double { 2. } },\n  { \"third\", std::string { \"test\" } }\n);\n</code></pre>\n\n<p>What I currently do is following:</p>\n\n<pre><code>void append() {}\n\ntemplate&lt;typename Type&gt;\nvoid append(std::string str, Type obj)\n{\n  std::cout &lt;&lt; \"str: \" &lt;&lt; str &lt;&lt; \" type: \" &lt;&lt; obj &lt;&lt; \"\\n\";\n}\n\ntemplate&lt;typename Type, typename... Args&gt;\nvoid append(std::string str, Type t, Args... args)\n{\n  append(str, t);\n  append(args...);\n}\n\nint main()\n{\n append(\"first\", 1, \"second\", 2., \"third, \"test\");\n}\n</code></pre>\n\n<p>Which makes it possible to write something like this</p>\n\n<pre><code>append (\n  \"first\", int { 3 },\n  \"second\", double { 2. },\n  \"third\", std::string { \"test\" }\n);\n</code></pre>\n\n<p>But in my opinion it would make the code more readable, if I could use the curly Braces like in my example above.</p>\n\n<p>What I've tried to do is use a templated std::pair but all I get are compiler errors:</p>\n\n<pre><code>main.cpp:9:6: note: template&lt;class Type&gt; void \n\nappend(std::initializer_list&lt;std::pair&lt;std::basic_string&lt;char&gt;, Type&gt; &gt;)\n void append(std::initializer_list&lt;std::pair&lt;std::string, Type&gt;&gt; pair)\n      ^\nmain.cpp:9:6: note:   template argument deduction/substitution failed:\nmain.cpp:23:22: note:   couldn't deduce template parameter \u2018Type\u2019\n  append({\"first\", 1});\n</code></pre>\n\n<p>Does someone have an idea? </p>\n"}, {"tags": ["c++", "matrix-multiplication"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1552474577, "post_id": 55140147, "comment_id": 97020523, "body": "Even if it&#39;s &quot;called [a] great number of times&quot;, have you measured and profiled that this really is a bottleneck in your program? Always measure before manual optimization. And always build with optimizations enabled before measuring. And remember that &quot;good enough&quot; often <i>is</i> good enough. And when you do manual optimization, remember that it often makes the code quite obfuscated, so good documentation (comments) is a must. Lastly, modern compilers are very good at optimizations, including loop unrolling."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1552474766, "post_id": 55140147, "comment_id": 97020628, "body": "code appears to be bugged in that <code>result</code> is not guaranteed to be set to zero at function start."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 2, "creation_date": 1552474780, "post_id": 55140147, "comment_id": 97020637, "body": "You could use <a href=\"http://eigen.tuxfamily.org/index.php?title=Main_Page\" rel=\"nofollow noreferrer\"><code>Eigen</code></a>."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 4, "creation_date": 1552474838, "post_id": 55140147, "comment_id": 97020676, "body": "<code>std::vector&lt; std::vector&lt;double&gt; &gt;</code> is not (I&#39;m told) particularly efficient. It&#39;s better to have a a 1d vector and manipulate the indexes to it."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 1, "creation_date": 1552475479, "post_id": 55140147, "comment_id": 97021024, "body": "You&#39;d better use a ready-made BLAS Level 2 implementation."}, {"owner": {"reputation": 53, "user_id": 8953100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1630203880376872/picture?type=large", "display_name": "Pavel Kikin", "link": "https://stackoverflow.com/users/8953100/pavel-kikin"}, "edited": false, "score": 1, "creation_date": 1552475876, "post_id": 55140147, "comment_id": 97021262, "body": "Yes, I&#39;ve profiled the program and this function makes the biggest time contribution. Depending on initial data, the total execution time may last up to 30 min, but the desired time is 10 min maximum. So, in my case &quot;good enough&quot; is not enough :) btw: I use speed priority in optimization preferences."}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 2, "creation_date": 1552476966, "post_id": 55140147, "comment_id": 97021897, "body": "Just curious: did your manual chunking into blocks of size 16 turn out to be faster than a simple <code>for (j=0; j &lt; size; ++j)</code>? I would expect a modern compiler to optimize that itself."}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1552477198, "post_id": 55140147, "comment_id": 97022052, "body": "Also another hint: don&#39;t use <code>result[i]</code> directly to accumulate the sum. Each access to it is a potential cache miss. Instead, use a local variable and at the end of the loop do a single assignment to <code>result[i] = sum</code>."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "edited": false, "score": 0, "creation_date": 1552477376, "post_id": 55140147, "comment_id": 97022165, "body": "@sebrockm Making a new result involves memory allocation and could slow this down more depending on the size of result. Morale of the story is, profile."}, {"owner": {"reputation": 4966, "user_id": 9883438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9176c9238126b88b11234a86f45cbe?s=128&d=identicon&r=PG&f=1", "display_name": "sebrockm", "link": "https://stackoverflow.com/users/9883438/sebrockm"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1552477633, "post_id": 55140147, "comment_id": 97022337, "body": "@FantasticMrFox of course that needs to be profiled, that&#39;s why I declared it a hint and not a fact :) But I&#39;m talking about one single local int. No (heap) allocation will happen. Local variables are usually for free and give much more opportunity for the compiler to apply different optimization techniques. It&#39;s definitely worth a try."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 1578529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68e3655962c3cc6d4aec5f84b2adaf4?s=128&d=identicon&r=PG", "display_name": "Azad", "link": "https://stackoverflow.com/users/1578529/azad"}, "is_accepted": false, "score": 0, "last_activity_date": 1552490724, "creation_date": 1552490724, "answer_id": 55145505, "question_id": 55140147, "link": "https://stackoverflow.com/questions/55140147/the-fastest-way-to-multiply-a-matrix-with-a-vector/55145505#55145505", "title": "The fastest way to multiply a matrix with a vector?", "body": "<p>Depending on you hardware, using GPU parallelization (ex: CUDA) might help substantially.</p>\n"}], "owner": {"reputation": 53, "user_id": 8953100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1630203880376872/picture?type=large", "display_name": "Pavel Kikin", "link": "https://stackoverflow.com/users/8953100/pavel-kikin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552490724, "creation_date": 1552474400, "last_edit_date": 1552474628, "question_id": 55140147, "link": "https://stackoverflow.com/questions/55140147/the-fastest-way-to-multiply-a-matrix-with-a-vector", "title": "The fastest way to multiply a matrix with a vector?", "body": "<p>Could anyone please suggest any faster way to multiply matrix to vector inside this function?</p>\n\n<pre><code>  inline void multiply(\n        std::vector&lt; std::vector&lt;double&gt; &gt; &amp;matrix,\n        std::vector&lt;double&gt; &amp;vector,\n        std::vector&lt;double&gt; &amp;result\n    ){\n        int size = (int) vector.size();\n\n        result.resize(size);\n\n        #pragma omp parallel for\n        for(int i = 0; i &lt; size; ++i){\n              int j = 0;\n\n            for(; j &lt;= size - 16; j += 16){\n                result[i] += matrix[i][j] * vector[j]\n                    + matrix[i][j + 1] * vector[j + 1]\n                    + matrix[i][j + 2] * vector[j + 2]\n                    + matrix[i][j + 3] * vector[j + 3]\n                    + matrix[i][j + 4] * vector[j + 4]\n                    + matrix[i][j + 5] * vector[j + 5]\n                    + matrix[i][j + 6] * vector[j + 6]\n                    + matrix[i][j + 7] * vector[j + 7]\n                    + matrix[i][j + 8] * vector[j + 8]\n                    + matrix[i][j + 9] * vector[j + 9]\n                    + matrix[i][j + 10] * vector[j + 10]\n                    + matrix[i][j + 11] * vector[j + 11]\n                    + matrix[i][j + 12] * vector[j + 12]\n                    + matrix[i][j + 13] * vector[j + 13]\n                    + matrix[i][j + 14] * vector[j + 14]\n                    + matrix[i][j + 15] * vector[j + 15];\n            }\n\n            for(; j &lt; size; ++j){\n                result[i] += matrix[i][j] * vector[j];\n            }\n        }\n    }\n</code></pre>\n\n<p>This function is called a great number of times during the runtime, so it has a very critical influence for total computation time.</p>\n"}, {"tags": ["c++", "lua", "bytecode", "luac"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1552474391, "post_id": 55140109, "comment_id": 97020400, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4158900/embedding-resources-in-executable-using-gcc\">Embedding resources in executable using GCC</a>"}, {"owner": {"reputation": 199, "user_id": 8572843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jf3W8.png?s=128&g=1", "display_name": "gotocoffee", "link": "https://stackoverflow.com/users/8572843/gotocoffee"}, "edited": false, "score": 1, "creation_date": 1552474710, "post_id": 55140109, "comment_id": 97020608, "body": "lua does not need to convert the code to byte code but the bytecode still needs to be interpreted"}, {"owner": {"reputation": 199, "user_id": 8572843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jf3W8.png?s=128&g=1", "display_name": "gotocoffee", "link": "https://stackoverflow.com/users/8572843/gotocoffee"}, "edited": false, "score": 1, "creation_date": 1552482153, "post_id": 55140109, "comment_id": 97025266, "body": "<code>(luaL_loadbuffer(L, s, length_of_s, s) || lua_pcall(L, 0, LUA_MULTRET, 0))</code> should do the job"}], "answers": [{"comments": [{"owner": {"reputation": 1576, "user_id": 1511417, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uYOCF.jpg?s=128&g=1", "display_name": "user1511417", "link": "https://stackoverflow.com/users/1511417/user1511417"}, "edited": false, "score": 0, "creation_date": 1552484270, "post_id": 55142530, "comment_id": 97026768, "body": "Thanks, but this will not work either, since <code>test</code> contains dec.-values which are greater than <code>125</code> . See question: <code>unsigned char[]</code>. This is why it&#39;s an array of unsigned chars. The problem here is, that <code>luaL_loadbuffer</code> expects an <code>const signed char-Pointer</code>, which is interesting."}, {"owner": {"reputation": 199, "user_id": 8572843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jf3W8.png?s=128&g=1", "display_name": "gotocoffee", "link": "https://stackoverflow.com/users/8572843/gotocoffee"}, "reply_to_user": {"reputation": 1576, "user_id": 1511417, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uYOCF.jpg?s=128&g=1", "display_name": "user1511417", "link": "https://stackoverflow.com/users/1511417/user1511417"}, "edited": false, "score": 1, "creation_date": 1552484738, "post_id": 55142530, "comment_id": 97027098, "body": "@user1511417 <code>luaL_loadbuffer(L,(const char*)test,test_len,&quot;&quot;);</code>"}, {"owner": {"reputation": 1576, "user_id": 1511417, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uYOCF.jpg?s=128&g=1", "display_name": "user1511417", "link": "https://stackoverflow.com/users/1511417/user1511417"}, "edited": false, "score": 0, "creation_date": 1552485272, "post_id": 55142530, "comment_id": 97027500, "body": "This should generate a warning, which should be taken seriously."}, {"owner": {"reputation": 1576, "user_id": 1511417, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uYOCF.jpg?s=128&g=1", "display_name": "user1511417", "link": "https://stackoverflow.com/users/1511417/user1511417"}, "edited": false, "score": 0, "creation_date": 1553176317, "post_id": 55142530, "comment_id": 97293743, "body": "I&#39;ve just tested gotocoffee&#39;s suggestion. It works, but why? :D"}], "tags": [], "owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "is_accepted": true, "score": 4, "last_activity_date": 1552482110, "creation_date": 1552482110, "answer_id": 55142530, "question_id": 55140109, "link": "https://stackoverflow.com/questions/55140109/embed-luac-bytecode-into-c-c-source-file/55142530#55142530", "title": "Embed luac-bytecode into C/C++ source-file", "body": "<p>Use <a href=\"https://www.lua.org/manual/5.1/manual.html#luaL_loadbuffer\" rel=\"nofollow noreferrer\">luaL_loadbuffer</a> instead of <a href=\"https://www.lua.org/manual/5.1/manual.html#luaL_loadstring\" rel=\"nofollow noreferrer\">luaL_loadstring</a>:</p>\n\n<pre><code>luaL_loadbuffer(L,test,test_len,\"\");\n</code></pre>\n"}], "owner": {"reputation": 1576, "user_id": 1511417, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uYOCF.jpg?s=128&g=1", "display_name": "user1511417", "link": "https://stackoverflow.com/users/1511417/user1511417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 55142530, "answer_count": 1, "score": 1, "last_activity_date": 1552482110, "creation_date": 1552474264, "last_edit_date": 1552478942, "question_id": 55140109, "link": "https://stackoverflow.com/questions/55140109/embed-luac-bytecode-into-c-c-source-file", "title": "Embed luac-bytecode into C/C++ source-file", "body": "<p>How do you include a lua-bytecode-string into a C/C++ file ?</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ luac -o test -s test.lua\n$ cat test\nLuaS\ufffd\n\nxV(w@@A@$@&amp;\ufffdprintTestj\n</code></pre>\n\n<p>Now if you could insert this byte-string into a C/C++-file, you could actually</p>\n\n<pre><code>luaL_loadfile(lua, bytestring.c_str());\n</code></pre>\n\n<p>which makes it unnecessary to load <code>test.lua</code> at run-time. You would not even have to interpret <code>test.lua</code> at run-time, right?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>The first two comments to this question were helpful for generating a bytestring so that you can include it in your C/C++ code.\n<a href=\"https://stackoverflow.com/a/21605198/1511417\">From this answer</a> I got this idea:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>xxd -i test &gt; test.h\n</code></pre>\n\n<p>which creates this:</p>\n\n<pre><code>unsigned char test[] = {\n  0x1b, 0x4c, 0x75, 0x61, 0x53, 0x00, 0x19, 0x93, 0x0d, 0x0a, 0x1a, 0x0a,\n  0x04, 0x08, 0x04, 0x08, 0x08, 0x78, 0x56, 0x00, /* ... */, 0x00};\nunsigned int test_len = 105;\n</code></pre>\n\n<p>This is great, but this will <em>not</em> work with <a href=\"https://www.lua.org/manual/5.1/manual.html#luaL_loadstring\" rel=\"nofollow noreferrer\">luaL_loadstring</a>, since</p>\n\n<blockquote>\n  <p>This function uses lua_load to load the chunk in the zero-terminated string s. </p>\n</blockquote>\n\n<p>Note: there are <em>zeros</em> as data in <code>test</code>.</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1552474081, "post_id": 55140017, "comment_id": 97020234, "body": "<code>iString.push_back(iString);</code>? You mean  <code>strArray.push_back(iString);</code>?"}, {"owner": {"reputation": 737, "user_id": 7240180, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/dX8NQ.jpg?s=128&g=1", "display_name": "kiltannen", "link": "https://stackoverflow.com/users/7240180/kiltannen"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1552474258, "post_id": 55140017, "comment_id": 97020336, "body": "And here I thought I didn&#39;t understand something - and it was just a simple case of coding too late at night and not seeing what was in front of my eyes!  THANK YOU HEAPS for taking the time to comment!"}], "answers": [{"comments": [{"owner": {"reputation": 737, "user_id": 7240180, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/dX8NQ.jpg?s=128&g=1", "display_name": "kiltannen", "link": "https://stackoverflow.com/users/7240180/kiltannen"}, "edited": false, "score": 1, "creation_date": 1552559437, "post_id": 55140049, "comment_id": 97059462, "body": "Hi Maxim - FYI I SO appreciate your patience with answering such a simple mistake. I was definitely stuck, and not seeing what was right in front of my nose!  ANd this was enough of a kick that I wa able to also find my other error - fix them both and submit my homework.  Thank You!"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 737, "user_id": 7240180, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/dX8NQ.jpg?s=128&g=1", "display_name": "kiltannen", "link": "https://stackoverflow.com/users/7240180/kiltannen"}, "edited": false, "score": 0, "creation_date": 1552560308, "post_id": 55140049, "comment_id": 97060017, "body": "@kiltannen Aww, that happens to me as well all the time!"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1552474066, "creation_date": 1552474066, "answer_id": 55140049, "question_id": 55140017, "link": "https://stackoverflow.com/questions/55140017/getting-error-using-vector-push-back-with-string-in-c/55140049#55140049", "title": "Getting error using vector push_back with &lt;string&gt; in c++", "body": "<p>The compiler tells you that <code>std::basic_string&lt;char&gt;::push_back</code> with <code>std::string</code> argument doesn't exist.</p>\n\n<p>Use <code>operator+=</code>: <code>iString += iString</code>.</p>\n\n<hr>\n\n<p>You probably want <code>strArray.push_back(iString)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4620, "user_id": 5260982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ww1JG.png?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5260982/dave"}, "edited": false, "score": 0, "creation_date": 1552478584, "post_id": 55140324, "comment_id": 97022939, "body": "Please use the edit link on your question to add additional information. The Post Answer button should be used only for complete answers to the question. - <a href=\"/review/low-quality-posts/22452140\">From Review</a>"}, {"owner": {"reputation": 737, "user_id": 7240180, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/dX8NQ.jpg?s=128&g=1", "display_name": "kiltannen", "link": "https://stackoverflow.com/users/7240180/kiltannen"}, "reply_to_user": {"reputation": 4620, "user_id": 5260982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ww1JG.png?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5260982/dave"}, "edited": false, "score": 1, "creation_date": 1552481074, "post_id": 55140324, "comment_id": 97024588, "body": "@Dave Hi Dave, THX for the feedback, A couple of times I have been encouraged to provide answers as standalone rather than as edit&#39;s in the question. And while this is not a complete answer - I suspect it might actually be more confusing for someone if I embedded it into the question. I suppose I could completely replace the bad code - and just have this question focus on the piece that someone else provided the answer for - But when I figured out I had this problem I thought it might actually help someone else almost as much as my original question. So I chose to specifically call it out..."}, {"owner": {"reputation": 19032, "user_id": 257090, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/KnHGI.jpg?s=128&g=1", "display_name": "codenheim", "link": "https://stackoverflow.com/users/257090/codenheim"}, "edited": false, "score": 0, "creation_date": 1552489214, "post_id": 55140324, "comment_id": 97030458, "body": "My 2 cents - reword &quot;needs to understand what form of class it is iterating over&quot; to &quot;needs to be type compatible with the collection it is iterating over&quot; - if you make that change I&#39;ll upvote it."}, {"owner": {"reputation": 737, "user_id": 7240180, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/dX8NQ.jpg?s=128&g=1", "display_name": "kiltannen", "link": "https://stackoverflow.com/users/7240180/kiltannen"}, "reply_to_user": {"reputation": 19032, "user_id": 257090, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/KnHGI.jpg?s=128&g=1", "display_name": "codenheim", "link": "https://stackoverflow.com/users/257090/codenheim"}, "edited": false, "score": 0, "creation_date": 1552559134, "post_id": 55140324, "comment_id": 97059266, "body": "@codenheim  Thank you for the suggestion - it says it much better than I tried to.  And I even understand it better myself this way!"}], "tags": [], "owner": {"reputation": 737, "user_id": 7240180, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/dX8NQ.jpg?s=128&g=1", "display_name": "kiltannen", "link": "https://stackoverflow.com/users/7240180/kiltannen"}, "is_accepted": false, "score": 1, "last_activity_date": 1552559085, "last_edit_date": 1552559085, "creation_date": 1552474920, "answer_id": 55140324, "question_id": 55140017, "link": "https://stackoverflow.com/questions/55140017/getting-error-using-vector-push-back-with-string-in-c/55140324#55140324", "title": "Getting error using vector push_back with &lt;string&gt; in c++", "body": "<p>Just for the benefit of anyone else who might find this - therre was another error in my code, where in fact I had not understood a piece of the required concept around iterators:</p>\n\n<p>this line here:</p>\n\n<pre><code>std::vector&lt;int&gt;::const_iterator y;\n</code></pre>\n\n<p>in fact needed to be:</p>\n\n<pre><code>std::vector&lt;std::string&gt;::const_iterator y;\n</code></pre>\n\n<p>If I understand this right - it is because the iterator being declared needs to be type compatible with the collection it is iterating over...</p>\n"}], "owner": {"reputation": 737, "user_id": 7240180, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/dX8NQ.jpg?s=128&g=1", "display_name": "kiltannen", "link": "https://stackoverflow.com/users/7240180/kiltannen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 55140049, "answer_count": 2, "score": 2, "last_activity_date": 1552559085, "creation_date": 1552473964, "question_id": 55140017, "link": "https://stackoverflow.com/questions/55140017/getting-error-using-vector-push-back-with-string-in-c", "title": "Getting error using vector push_back with &lt;string&gt; in c++", "body": "<p>I am trying to write a &lt; string > into a vector - I did this exact thing with a vector of int and it worked OK - so I suspect I need to do this differently when using a string - but  While I understand my compile error is telling me that I am trying to use incompatible types &lt; char > - I don't know why because I THOUGHT I had declared everything and used it correctly - can someone please tell me how I got this wrong?</p>\n\n<p>Here is the code I am trying to use:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n   std::vector&lt;std::string&gt; strArray;\n   std::vector&lt;int&gt;::const_iterator y;\n\n   std::string iString = \"\";\n\n   while (iString != \"quit\")\n   {\n      std::cout &lt;&lt; \"Enter string: \";\n      std::cin &gt;&gt; iString;\n      iString.push_back(iString);\n   }\n\n   std::cout &lt;&lt; \"Your list is:\\n\";\n   for (y= iString.begin(); y &lt;= iString.end(); y++)\n   {\n      std::cout &lt;&lt; (*y)\n                &lt;&lt; std::endl;\n   }\n   std::cout &lt;&lt;  std::endl;\n\n   return 0;\n}\n</code></pre>\n\n<p>And here is the error message:</p>\n\n<pre><code>check10a.cpp: In function \u2018int main()\u2019:\ncheck10a.cpp:57:32: error: no matching function for call to \u2018std::basic_string&lt;char&gt;::push_back(std::string&amp;)\u2019\n       iString.push_back(iString);\n</code></pre>\n\n<p>I would really appreciate a bit of a pointer here...</p>\n"}, {"tags": ["c++", "c++11", "std"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 2, "creation_date": 1552473876, "post_id": 55139926, "comment_id": 97020087, "body": "Why are you passing pointers by reference in operator(). Remove references and the code compiles <a href=\"https://godbolt.org/z/SMOsVn\" rel=\"nofollow noreferrer\">DEMO</a>."}, {"owner": {"reputation": 1805, "user_id": 437948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CJVaw.png?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/437948/mark"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1552474056, "post_id": 55139926, "comment_id": 97020214, "body": "quite right, thanks, must have added the <code>&amp;</code> before adding the <code>const</code> to try to match the error message"}], "answers": [{"tags": [], "owner": {"reputation": 1805, "user_id": 437948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CJVaw.png?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/437948/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1552474510, "creation_date": 1552474510, "answer_id": 55140184, "question_id": 55139926, "link": "https://stackoverflow.com/questions/55139926/c11-polymorphic-map-keys-static-assertion-failed-hash-function-must-be-invoca/55140184#55140184", "title": "c++11 polymorphic map keys static assertion failed: hash function must be invocable with an argument of key type", "body": "<p>In view of the fact that it looked as though there were limited specifically helpful results for the general design pattern of using polymorphic pointers as map keys, I'll just post the modified code as <a href=\"https://stackoverflow.com/users/8950365/rafix07\">rafix07</a> rightly and very quickly suggested</p>\n\n<pre><code>struct MyClassHash {\npublic:\n    size_t operator() (const MyClass * c) const {\n        return c-&gt;id();\n    }\n};\n\nstruct MyClassEquality {\npublic:\n    bool operator() (const MyClass * a, const MyClass * b) const {\n        return a-&gt;id() == b-&gt;id();\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 1805, "user_id": 437948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CJVaw.png?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/437948/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552474593, "creation_date": 1552473702, "last_edit_date": 1552474593, "question_id": 55139926, "link": "https://stackoverflow.com/questions/55139926/c11-polymorphic-map-keys-static-assertion-failed-hash-function-must-be-invoca", "title": "c++11 polymorphic map keys static assertion failed: hash function must be invocable with an argument of key type", "body": "<p>The error is</p>\n\n<pre><code>in file included from /usr/include/c++/8/unordered_map:46,\n                from main.cpp:3:\n/usr/include/c++/8/bits/hashtable.h: In instantiation of \u2018class std::_Hashtable&lt;MyClass*, std::pair&lt;MyClass* const, double&gt;, std::allocator&lt;std::pair&lt;MyClass* const, double&gt; &gt;, std::__detail::_Select1st, MyClassEquality, MyClassHash, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, std::__detail::_Hashtable_traits&lt;true, false, true&gt; &gt;\u2019:\n/usr/include/c++/8/bits/unordered_map.h:105:18:   required from \u2018class std::unordered_map&lt;MyClass*, double, MyClassHash, MyClassEquality&gt;\u2019\nmain.cpp:35:68:   required from here\n/usr/include/c++/8/bits/hashtable.h:195:21: error: static assertion failed: hash function must be invocable with an argument of key type\n    static_assert(__is_invocable&lt;const _H1&amp;, const _Key&amp;&gt;{},\n                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/usr/include/c++/8/bits/hashtable.h:197:21: error: static assertion failed: key equality predicate must be invocable with two arguments of key type\n    static_assert(__is_invocable&lt;const _Equal&amp;, const _Key&amp;, const _Key&amp;&gt;{},\n                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>the code is</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include &lt;unordered_map&gt;\n\nusing namespace std;\n\nclass MyClass {\npublic:\n    long my_id;\n\n    MyClass() {\n        my_id = lrand48();\n    }\n\n    size_t id() const {\n        hash&lt;long&gt; long_hash;\n        return long_hash(my_id);\n    }\n};\n\nstruct MyClassHash {\npublic:\n    size_t operator() (const MyClass * &amp;c) const {\n        return c-&gt;id();\n    }\n};\n\nstruct MyClassEquality {\npublic:\n    bool operator() (const MyClass * &amp;a, const MyClass * &amp;b) const {\n        return a-&gt;id() == b-&gt;id();\n    }\n};\n\nclass TestClass {\npublic:\n    unordered_map&lt;MyClass *, double, MyClassHash, MyClassEquality&gt; my_map;;\n\n/* makes no difference\n * TestClass() {\n *        my_map = unordered_map&lt;MyClass *, double, MyClassHash, MyClassEquality&gt;(42, MyClassHash(), MyClassEquality());\n *    }\n */\n\n    void test() {\n        for (auto p : my_map) {\n            cout &lt;&lt; p.first &lt;&lt; \",\" &lt;&lt; p.second &lt;&lt; endl;\n        }\n    }\n};\n\nint main(int argc, char * argv[]) {\n    auto * a = new TestClass();\n    a-&gt;test();\n    return 0;\n}\n</code></pre>\n\n<p>The reason the map has pointers as keys is that the program needs to leverage polymorphism when it interacts with the contents of the map; is there a relatively simple oversight in the code or is there a more appropriate design pattern?</p>\n\n<p>I've tried variations such as changing the <code>struct</code>s to <code>class</code>es, not declaring the hash / equality operators <code>public</code>, etcetera; similarly the commented constructor.</p>\n"}, {"tags": ["c++", "class", "object", "int", "operator-overloading"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1552474087, "post_id": 55139892, "comment_id": 97020237, "body": "You&#39;re calling <code>fun(t)</code> where <code>t</code> is of type <code>Test</code>.  The only overloads of <code>fun()</code> accept an <code>int</code> or a <code>Test2</code>.   The compiler therefore looks for conversions of <code>Test</code> to other types that an overload of <code>fun()</code> will accept, and finds the <code>operator Test2()</code> and <code>operator int()</code>.    Hence both the sequences &quot;convert <code>t</code> to <code>Test2</code> and pass that to the <code>fun()</code> that accepts a <code>Test2</code>&quot; and &quot;convert <code>t</code> to <code>int</code> and pass that to the <code>fun()</code> that accepts an <code>int</code>&quot; are equally valid, and the compiler has no reason to prefer one over the other.   Hence the call <code>fun(t)</code> is diagnosed as ambiguous."}], "answers": [{"tags": [], "owner": {"reputation": 33577, "user_id": 9593596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JdCIQ.jpg?s=128&g=1", "display_name": "lubgr", "link": "https://stackoverflow.com/users/9593596/lubgr"}, "is_accepted": true, "score": 1, "last_activity_date": 1552474231, "creation_date": 1552474231, "answer_id": 55140100, "question_id": 55139892, "link": "https://stackoverflow.com/questions/55139892/operator-overloading-and-function-overloading-producing-ambiguous-compiler-error/55140100#55140100", "title": "operator overloading and function overloading producing ambiguous compiler error", "body": "<blockquote>\n  <p>I am not able to understand why the compiler is producing errors when the function is called</p>\n</blockquote>\n\n<p>How is the compiler supposed to figure out which function to call? You have two function in the overload set associated with the name <code>func</code>, and two operators that allow for implicit conversions to types that equally well match both function parameters of this overload set.</p>\n\n<p>The situation is identical to</p>\n\n<pre><code>void f(long);\nvoid f(short);\n\nf(42); // Error: both conversions int -&gt; log and int -&gt; short possible\n</code></pre>\n\n<p>You can fix it by e.g.</p>\n\n<pre><code>fun(static_cast&lt;Test2&gt;(t)); // be explicit on the calling side\n</code></pre>\n\n<p>or by marking one (or both) of the conversion operators as <code>explicit</code></p>\n\n<pre><code>explicit operator Test2 () {return t2;}\n</code></pre>\n\n<p>which disables implicit conversions to <code>Test2</code> and requires an explicit cast as shown before.</p>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1552474420, "creation_date": 1552474420, "answer_id": 55140154, "question_id": 55139892, "link": "https://stackoverflow.com/questions/55139892/operator-overloading-and-function-overloading-producing-ambiguous-compiler-error/55140154#55140154", "title": "operator overloading and function overloading producing ambiguous compiler error", "body": "<p>The call <code>fun(t);</code> is ambiguous because both overloads of <code>fun</code> are eligible for it.</p>\n\n<p>This is again because <code>t</code> is a <code>Test</code> object which can be converted to both <code>Test2</code> and <code>int</code>. </p>\n\n<p>Marking either one of the conversion operators as <code>explicit</code> will resolve this issue.</p>\n\n<p>See <a href=\"https://wandbox.org/permlink/PncoGjzlEIBf7C2g\" rel=\"nofollow noreferrer\"><strong>Demo</strong></a> here.</p>\n"}], "owner": {"reputation": 43, "user_id": 10570524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1d925f0ebd29fff25eb622fae16d4?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Noman", "link": "https://stackoverflow.com/users/10570524/mohammad-noman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 55140100, "answer_count": 2, "score": 0, "last_activity_date": 1552474420, "creation_date": 1552473580, "last_edit_date": 1552473889, "question_id": 55139892, "link": "https://stackoverflow.com/questions/55139892/operator-overloading-and-function-overloading-producing-ambiguous-compiler-error", "title": "operator overloading and function overloading producing ambiguous compiler error", "body": "<p>In the given code, I am not able to understand why the compiler is producing errors when the function is called. It is passing object of <code>test</code> class which has its data member of a <code>test2</code> class</p>\n\n<pre><code>class Test2 {\n    int y;\n};\n\nclass Test {\n    int x;\n    Test2 t2;\npublic:\n    operator Test2 () {return t2;}\n    operator int () {return x;}\n};\n\nvoid fun (int x) { \n    cout &lt;&lt; \"fun(int) called\";\n}\n\nvoid fun (Test2 t) {\n    cout &lt;&lt; \"fun(Test 2) called\";\n}\n\nint main() {\n    Test t;\n    fun(t);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "swig"], "comments": [{"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1552484914, "post_id": 55139832, "comment_id": 97027223, "body": "I have encountered some similar situations, where I have <code>#ifndef SWIG_VERSION</code> to skip certain function. Have you tried just wrapping <code>Vector</code> of say <code>int</code> to see whether it is related to <code>directors</code> or a general cast issue. Another thing - why are you using directors, I see no Python class implementing <code>Foo</code>."}, {"owner": {"reputation": 990, "user_id": 913135, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f3331e4ca287df745723b9eb00a64ce?s=128&d=identicon&r=PG", "display_name": "Citron", "link": "https://stackoverflow.com/users/913135/citron"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1552486766, "post_id": 55139832, "comment_id": 97028588, "body": "Wrapping <code>Vector</code> of types which are not using the <code>director</code> feature works fine (the invalid <code>dynamic_cast</code> is in the generated part related to this feature only) So specializing <code>Vector</code> for <code>int</code> works fine. And you see no Python class implementing <code>Foo</code> because <code>%feature(director)</code> is meant to be used when the class implementing <code>Foo</code> is defined in Python (well, in my case at least, that&#39;s what I need) And I didn&#39;t provide an example Python script which uses the example module, because the module doesn&#39;t even compile so it&#39;s not really relevant."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1552952595, "post_id": 55139832, "comment_id": 97197531, "body": "If you skip the use of native RTTI by adding the compile option <code>-DSWIG_DIRECTOR_NORTTI</code> your example compiles.."}, {"owner": {"reputation": 990, "user_id": 913135, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f3331e4ca287df745723b9eb00a64ce?s=128&d=identicon&r=PG", "display_name": "Citron", "link": "https://stackoverflow.com/users/913135/citron"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1552990994, "post_id": 55139832, "comment_id": 97210186, "body": "You&#39;re a life saver ! It compiles, and my example use-case works as intended ! I feel a bit dumb for not having thought of trying to define this macro (I remember seeing it in the generated wrapper code and wondering what its use was) If you want to add this as a proper answer, I can then accept it (maybe it will help other people in the future :)"}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1553029552, "post_id": 55139832, "comment_id": 97232600, "body": "I will do that..."}], "answers": [{"tags": [], "owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "is_accepted": true, "score": 1, "last_activity_date": 1553030159, "creation_date": 1553030159, "answer_id": 55250104, "question_id": 55139832, "link": "https://stackoverflow.com/questions/55139832/swig-binding-a-method-returning-a-reference-to-a-pointer-of-a-director-class/55250104#55250104", "title": "Swig - binding a method returning a reference to a pointer of a director class", "body": "<p>I found a solution to your problem.</p>\n\n<p>In some situations, using the director feature and native RTTI leads to code, which does not compile out of the box, e.g. when using <code>distutils</code> from Python.</p>\n\n<p>A solution, which works for your example is to define <code>SWIG_DIRECTOR_NORTTI</code> when compiling the code, e.g. for the GNU compiler add <code>-DSWIG_DIRECTOR_NORTTI</code> to the <code>CXXFLAGS</code></p>\n"}], "owner": {"reputation": 990, "user_id": 913135, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f3331e4ca287df745723b9eb00a64ce?s=128&d=identicon&r=PG", "display_name": "Citron", "link": "https://stackoverflow.com/users/913135/citron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 55250104, "answer_count": 1, "score": 2, "last_activity_date": 1553030159, "creation_date": 1552473400, "last_edit_date": 1552480934, "question_id": 55139832, "link": "https://stackoverflow.com/questions/55139832/swig-binding-a-method-returning-a-reference-to-a-pointer-of-a-director-class", "title": "Swig - binding a method returning a reference to a pointer of a director class", "body": "<p>Ok, the title is a bit long, but I couldn't figure out a shorter one :) So let me explain.</p>\n\n<p>I have a C++ codebase where we have some container classes. Those classes have access methods returning items by reference or const reference. Then in another part of the codebase, I have containers of heap allocated <code>object</code>'s, which are using the director feature.</p>\n\n<p>And I can't figure out how to specialize our container classes for <code>object</code>: For all the container methods returning references to items (in this case a reference to an <code>object</code>'s pointer), Swig generates a wrapper code which fails to compile due to an invalid dynamic_cast (basically it tries to cast <code>object **</code> into <code>Swig::Director *</code>)</p>\n\n<p>I managed to reproduce the issue with the following code.</p>\n\n<p>Test.h</p>\n\n<pre><code>#ifndef TEST_H\n#define TEST_H\n\ntemplate&lt; typename T &gt;\nclass Vector\n{\n\npublic:\n\n    inline Vector(void)\n        : m_Data(nullptr)\n        , m_Size(0)\n    {\n    }\n\n    inline ~Vector(void)\n    {\n        delete [] m_Data;\n    }\n\n    inline void add(const T &amp; item)\n    {\n        T * data = new T [m_Size + 1];\n        for (int i = 0; i &lt; m_Size; ++i)\n        {\n            data[i] = std::move(m_Data[i]);\n        }\n        delete [] m_Data;\n        m_Data = data;\n        m_Data[m_Size++] = item;\n    }\n\n    inline const T&amp; item(int index) const\n    {\n        return m_Data[index];\n    }\n\n    inline int count(void) const\n    {\n        return m_Size;\n    }\n\nprivate:\n\n    T * m_Data;\n    int m_Size;\n\n};\n\nclass Foo\n{\n\npublic:\n\n    Foo(void) = default;\n    virtual ~Foo(void) = default;\n\n    virtual const char * method(void) const\n    {\n        return \"Foo::method\";\n    }\n\n};\n\nclass Cache\n{\n\npublic:\n\n    static void add(Foo * item = nullptr)\n    {\n        m_Cache.add(item == nullptr ? new Foo() : item);\n    }\n\n    static const Vector&lt; Foo * &gt; &amp; get(void)\n    {\n        return m_Cache;\n    }\n\n    static Foo * get(int index)\n    {\n        return m_Cache.item(index);\n    }\n\nprivate:\n\n    static Vector&lt; Foo * &gt; m_Cache;\n\n};\n\nVector&lt; Foo * &gt; Cache::m_Cache;\n\n#endif // TEST_H\n</code></pre>\n\n<p>core.i</p>\n\n<pre><code>%module(directors=\"1\") core\n\n// we want to be able to inherit Foo in Python\n%feature(\"director\") Foo;\n\n// generate wrappers\n%include \"Test.h\"\n\n// specialize Vector for Foo\n%template(FooVector) Vector&lt;Foo*&gt;;\n\n// when compiling the wrapper code, include those\n%{\n#include \"Test.h\"\n%}\n</code></pre>\n\n<p>If you generate the Python module (<code>swig.exe -python -c++ core.i</code>) it works fine, but the generated <code>core_wrap.cxx</code> file fails to build because the generated wrapper code for <code>Vector::item</code> contains an invalid dynamic_cast from <code>Foo **</code> to <code>Swig::Director *</code></p>\n\n<p>The offending line is (where result is of type <code>Foo **</code>)</p>\n\n<pre><code>  director = SWIG_DIRECTOR_CAST(result);\n</code></pre>\n\n<p>And if I manually fix it like this:</p>\n\n<pre><code>  director = SWIG_DIRECTOR_CAST(*result);\n</code></pre>\n\n<p>Then the module compiles correctly, and everything works fine.</p>\n\n<p>So basically my question is: is this a bug in Swig ? Am I doing things wrong ? Is there a workaround to tell Swig to correctly dereference my <code>Foo **</code> result before casting to <code>Swig::Director *</code> ?</p>\n\n<p>Any help appreciated :)</p>\n"}, {"tags": ["c++", "caffe", "ubuntu-18.04"], "comments": [{"owner": {"reputation": 1431, "user_id": 3468778, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/662609375/picture?type=large", "display_name": "Amin Merati", "link": "https://stackoverflow.com/users/3468778/amin-merati"}, "edited": false, "score": 0, "creation_date": 1552474700, "post_id": 55139410, "comment_id": 97020600, "body": "I tried the solution by installing and adding the CPATH but it did not work and still complaining about hdf5.h not found"}], "owner": {"reputation": 1431, "user_id": 3468778, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/662609375/picture?type=large", "display_name": "Amin Merati", "link": "https://stackoverflow.com/users/3468778/amin-merati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 0, "closed_date": 1552474535, "answer_count": 0, "score": 1, "last_activity_date": 1560283286, "creation_date": 1552472288, "last_edit_date": 1560283286, "question_id": 55139410, "link": "https://stackoverflow.com/questions/55139410/fatal-error-hdf5-h-no-such-file-or-directory", "closed_reason": "Duplicate", "title": "fatal error: hdf5.h: No such file or directory", "body": "<p>I have been trying to build the code for single shot object detector SSD <a href=\"https://github.com/weiliu89/caffe/tree/ssd\" rel=\"nofollow noreferrer\">SSD ob github</a> on Ubuntu 18.04\nI checked out the code and tried to installed the dependencies based on what is suggested in the link (<a href=\"http://caffe.berkeleyvision.org/install_apt.html\" rel=\"nofollow noreferrer\">Ubuntu installation</a>)</p>\n\n<p>which included these:</p>\n\n<pre><code>sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler\n\nsudo apt-get install --no-install-recommends libboost-all-dev\n</code></pre>\n\n<p>When I am trying to follow the instructions to build the code I am getting this error:</p>\n\n<pre><code>user:~/project/SSD/caffe$ make -j8\nCXX src/caffe/layer_factory.cpp\nCXX src/caffe/syncedmem.cpp\nCXX src/caffe/parallel.cpp\nCXX src/caffe/internal_thread.cpp\nCXX src/caffe/data_transformer.cpp\nCXX src/caffe/layer.cpp\nCXX src/caffe/net.cpp\nCXX src/caffe/data_reader.cpp\nsrc/caffe/net.cpp:8:10: fatal error: hdf5.h: No such file or directory\n #include \"hdf5.h\"\n          ^~~~~~~~\ncompilation terminated.\nMakefile:575: recipe for target '.build_release/src/caffe/net.o' failed\nmake: *** [.build_release/src/caffe/net.o] Error 1\nmake: *** Waiting for unfinished jobs....\n</code></pre>\n\n<p>I thought by installing libhdf5-serial-dev hdf5 dependency is done but it seems that for some reason it is not enough?</p>\n\n<p>Any help would be appreciated? </p>\n"}, {"tags": ["c++", "python-3.x", "tensorflow"], "owner": {"reputation": 372, "user_id": 2866102, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4b978d0429b3d1112abd623744b88d1b?s=128&d=identicon&r=PG&f=1", "display_name": "isra60", "link": "https://stackoverflow.com/users/2866102/isra60"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554355045, "creation_date": 1552472150, "last_edit_date": 1554355045, "question_id": 55139349, "link": "https://stackoverflow.com/questions/55139349/linking-error-when-use-python-embedding-code-on-c-code-tensorflow-with-cuda", "title": "Linking error when use Python embedding code on C++ code (Tensorflow with CUDA)", "body": "<p>I have installed a tensorflow wheel with GPU support on jetson TX2 (recommended by NVIDIA . So tensorflow is installed in </p>\n\n<blockquote>\n  <p>/.local/lib/python3.5/site-packages/tensorflow</p>\n</blockquote>\n\n<p>Also the ldd of the tensorflow libs seems to be perfect.</p>\n\n<blockquote>\n  <p>ldd libtensorflow_framework.so\n          linux-vdso.so.1 =>  (0x0000007f89736000)\n          libcublas.so.9.0 => /usr/local/cuda-9.0/lib64/libcublas.so.9.0 (0x0000007f86c56000)\n          libcuda.so.1 => /usr/lib/aarch64-linux-gnu/tegra/libcuda.so.1 (0x0000007f86275000)\n          libcudnn.so.7 => /usr/lib/aarch64-linux-gnu/libcudnn.so.7 (0x0000007f77bcb000)\n          libcufft.so.9.0 => /usr/local/cuda-9.0/lib64/libcufft.so.9.0 (0x0000007f70af0000)\n          libcurand.so.9.0 => /usr/local/cuda-9.0/lib64/libcurand.so.9.0 (0x0000007f6cab3000)\n          libcudart.so.9.0 => /usr/local/cuda-9.0/lib64/libcudart.so.9.0 (0x0000007f6ca4e000)\n          libdl.so.2 => /lib/aarch64-linux-gnu/libdl.so.2 (0x0000007f6ca3a000)\n          libm.so.6 => /lib/aarch64-linux-gnu/libm.so.6 (0x0000007f6c98d000)\n          libpthread.so.0 => /lib/aarch64-linux-gnu/libpthread.so.0 (0x0000007f6c961000)\n          libstdc++.so.6 => /usr/lib/aarch64-linux-gnu/libstdc++.so.6 (0x0000007f6c7d1000)\n          libgcc_s.so.1 => /lib/aarch64-linux-gnu/libgcc_s.so.1 (0x0000007f6c7b0000)\n          libc.so.6 => /lib/aarch64-linux-gnu/libc.so.6 (0x0000007f6c669000)\n          /lib/ld-linux-aarch64.so.1 (0x0000005562b57000)\n          librt.so.1 => /lib/aarch64-linux-gnu/librt.so.1 (0x0000007f6c651000)\n          libnvrm_gpu.so => /usr/lib/aarch64-linux-gnu/tegra/libnvrm_gpu.so (0x0000007f6c61c000)\n          libnvrm.so => /usr/lib/aarch64-linux-gnu/tegra/libnvrm.so (0x0000007f6c5e4000)\n          libnvidia-fatbinaryloader.so.28.2.1 => /usr/lib/aarch64-linux-gnu/tegra/libnvidia-fatbinaryloader.so.28.2.1 (0x0000007f6c57e000)\n          libnvos.so => /usr/lib/aarch64-linux-gnu/tegra/libnvos.so (0x0000007f6c561000)</p>\n</blockquote>\n\n<p>Then I have Jupyter notebooks working and also I can import tensorflow from a python3 console, but I want to embed the tensorflow code inside a C++ project.</p>\n\n<p>I'm using the python embedding code like this.</p>\n\n<pre><code>Py_Initialize();\n\n//Import\nPyRun_SimpleString(\"import sys\");\nPyRun_SimpleString(\"import tensorflow as tf\");\n</code></pre>\n\n<p>This throws this error:</p>\n\n<pre><code>    Traceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\n  File \"/home/ubuntu/.local/lib/python3.5/site-packages/tensorflow/__init__.py\", line 22, in &lt;module&gt;\n    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import\n  File \"/home/ubuntu/.local/lib/python3.5/site-packages/tensorflow/python/__init__.py\", line 49, in &lt;module&gt;\n    from tensorflow.python import pywrap_tensorflow\n  File \"/home/ubuntu/.local/lib/python3.5/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 74, in &lt;module&gt;\n    raise ImportError(msg)\nImportError: Traceback (most recent call last):\n  File \"/home/ubuntu/.local/lib/python3.5/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 58, in &lt;module&gt;\n    from tensorflow.python.pywrap_tensorflow_internal import *\n  File \"/home/ubuntu/.local/lib/python3.5/site-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 28, in &lt;module&gt;\n    _pywrap_tensorflow_internal = swig_import_helper()\n  File \"/home/ubuntu/.local/lib/python3.5/site-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\n  File \"/usr/lib/python3.5/imp.py\", line 242, in load_module\n    return load_dynamic(name, filename, file)\n  File \"/usr/lib/python3.5/imp.py\", line 342, in load_dynamic\n    return _load(spec)\nImportError: libcusolver.so.9.0: cannot open shared object file: No such file or directory\n\n\nFailed to load the native TensorFlow runtime.\n\nSee https://www.tensorflow.org/install/install_sources#common_installation_problems\n\nfor some common reasons and solutions.  Include the entire stack trace\nabove this error message when asking for help.\nTraceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\nNameError: name 'tf' is not defined\nTraceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\nNameError: name 'tf_config' is not defined\nTraceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\nNameError: name 'tf' is not defined\n</code></pre>\n\n<p>The tensorflow version is 11 so is compatible with cuda 9.0. but I don't know why embeded code can not find the cuda libraries.</p>\n"}, {"tags": ["c++", "code-coverage", "lcov"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552471992, "post_id": 55139113, "comment_id": 97018892, "body": "On an unrelated note, default-constructors don&#39;t need to be marked as <code>explicit</code>."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1552472532, "post_id": 55139113, "comment_id": 97019231, "body": "In both the code you have shown and in the linked image representing the lcov report,  lines 11 and 12 are comments.    It is a bit of a philosophical question whether a coverage report should count comments in called functions as covered or not."}, {"owner": {"reputation": 621, "user_id": 11196108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1ec3c09309cb74231ec021f99047b?s=128&d=identicon&r=PG&f=1", "display_name": "ymochurad", "link": "https://stackoverflow.com/users/11196108/ymochurad"}, "edited": false, "score": 0, "creation_date": 1552478120, "post_id": 55139113, "comment_id": 97022631, "body": "I added it as comments just to clarify the issue. If you have a look at the screenshot - part of the comment is displayed as covered and part is not. And I also had same problem when part of the function was displayed as covered and part is not while the whole function should have been displayed as not covered"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1552484721, "post_id": 55139113, "comment_id": 97027084, "body": "Can you post another picture demonstrating the &quot;<i>move initialization across the header file - the covered lines in the cpp file also move</i>&quot;"}, {"owner": {"reputation": 621, "user_id": 11196108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1ec3c09309cb74231ec021f99047b?s=128&d=identicon&r=PG&f=1", "display_name": "ymochurad", "link": "https://stackoverflow.com/users/11196108/ymochurad"}, "edited": false, "score": 0, "creation_date": 1552485317, "post_id": 55139113, "comment_id": 97027533, "body": "Sure, I just updated the original post with new screenshot"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1552485532, "post_id": 55139113, "comment_id": 97027685, "body": "How did you compile?  It&#39;s likely that those redundant assignments are optimised out."}, {"owner": {"reputation": 621, "user_id": 11196108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1ec3c09309cb74231ec021f99047b?s=128&d=identicon&r=PG&f=1", "display_name": "ymochurad", "link": "https://stackoverflow.com/users/11196108/ymochurad"}, "edited": false, "score": 0, "creation_date": 1552486423, "post_id": 55139113, "comment_id": 97028328, "body": "I am compiling with <code>-O0</code> which should disable optimisations, isn&#39;t it?"}], "owner": {"reputation": 621, "user_id": 11196108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1ec3c09309cb74231ec021f99047b?s=128&d=identicon&r=PG&f=1", "display_name": "ymochurad", "link": "https://stackoverflow.com/users/11196108/ymochurad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552485534, "creation_date": 1552471450, "last_edit_date": 1552485534, "question_id": 55139113, "link": "https://stackoverflow.com/questions/55139113/class-member-initialization-in-header-files-generated-wrong-lcov-coverage-report", "title": "Class member initialization in header files generated wrong lcov coverage report", "body": "<p>I have created a simple example to illustrate the issue:</p>\n\n<p>test.h</p>\n\n<pre><code>#ifndef TEST_H\n#define TEST_H\n\nclass TestCoverage{\npublic:\n/*\n *\n *\n *\n */\n    int a = 5;\n    int b = 10;\n    void testfunc();\n    explicit TestCoverage();\n};\n\n#endif // TEST_H\n</code></pre>\n\n<p>test.cpp</p>\n\n<pre><code>#include \"test.h\"\n#include &lt;iostream&gt;\n\nTestCoverage::TestCoverage()\n{\n    a=15;\n    b=20;\n}\n\nvoid TestCoverage::testfunc(){\n/*\n *\n * */\n    std::cout&lt;&lt;\"hey\";\n}\n</code></pre>\n\n<p>And added a simple test case (which checks nothing) using catch2:</p>\n\n<p>test_test.cpp</p>\n\n<pre><code>#include \"test.h\"\n#include &lt;catch2/catch.hpp&gt;\n\nTEST_CASE(\"test\", \"[whatever]\")\n{\n    auto testCoverage = new TestCoverage();\n    testCoverage-&gt;testfunc();\n}\n</code></pre>\n\n<p>Afterwards I generated a code coverage report using lcov and generated html file. Html file shows some strange results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WxSxe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WxSxe.png\" alt=\"lcov report\"></a></p>\n\n<p>The question is: why lines 11 and 12 are displayed as covered? It looks like they are completely mirroring the class member initialization in the header file (a and b initialization). If I move initialization across the header file - the covered lines in the cpp file also move.\nIs this a bug in lcov or am I missing something?</p>\n\n<p><strong><em>UPD:</em></strong>\nIf I build coverage with slightly updated header file, e.g.:</p>\n\n<pre><code>#ifndef TEST_H\n#define TEST_H\n\nclass TestCoverage{\npublic:\n/*\n *\n *\n *\n */\n    int a = 5;\n    void testfunc();\n    int b = 10;\n    explicit TestCoverage();\n};\n\n#endif // TEST_H\n</code></pre>\n\n<p>I get report like this: <a href=\"https://i.stack.imgur.com/ZW3UJ.png\" rel=\"nofollow noreferrer\">lcov report upd</a></p>\n\n<p>Note that I swapped lines 12 and 13 in the header file and it is reflected in the report file. In the report file line 12 appears as not covered and line 13 as covered</p>\n"}, {"tags": ["c++", "rcpp", "r-package"], "comments": [{"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1552472131, "post_id": 55139102, "comment_id": 97018977, "body": "Does <code>PKG_LIBS = -L..&#47;bin -l:levmar</code> or <code>PKG_LIBS = ..&#47;bin&#47;levmar.lib</code> work?"}, {"owner": {"reputation": 13, "user_id": 8377043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040e640159e618cc88b5fc4790dc92ed?s=128&d=identicon&r=PG&f=1", "display_name": "Herrvey", "link": "https://stackoverflow.com/users/8377043/herrvey"}, "reply_to_user": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1552473221, "post_id": 55139102, "comment_id": 97019667, "body": "Thank you for your input. The first one gives me an other bug :  <code>C:&#47;RBuildTools&#47;3.4&#47;mingw_32&#47;bin&#47;..&#47;lib&#47;gcc&#47;i686-w64-mingw32&#47;&zwnj;&#8203;4.9.3&#47;..&#47;..&#47;..&#47;..&#47;i6&zwnj;&#8203;86-w64-mingw32&#47;bin&#47;l&zwnj;&#8203;d.exe: cannot find -l:levmar</code> and with the second one I get the same bug as before. In my opinion, the levmar.lib is actually found by the linker as far as I got a incompatibility bug message when I first compiled the Levmar library for a 32-bit target, which doesn&#39;t appear now that I compiled it for a 64-bit target."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1552473319, "post_id": 55139102, "comment_id": 97019735, "body": "Ok. How did you compile <code>levmar.lib</code>?"}, {"owner": {"reputation": 13, "user_id": 8377043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040e640159e618cc88b5fc4790dc92ed?s=128&d=identicon&r=PG&f=1", "display_name": "Herrvey", "link": "https://stackoverflow.com/users/8377043/herrvey"}, "reply_to_user": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1552474053, "post_id": 55139102, "comment_id": 97020212, "body": "I used CMake with the library-provided CMakeLists.txt to generate the files for Visual Studio and then I compiled with Visual Studio, which created the levmar.lib file"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 1, "creation_date": 1552474212, "post_id": 55139102, "comment_id": 97020322, "body": "VC and gcc have incompatible C++ ABIs. You have to compile the library with gcc, preferably the one from Rtools. It might be easiest to just add the sources for the library to the package and compile them during package build, c.f. <a href=\"https://stackoverflow.com/a/53638867/8416610\">stackoverflow.com/a/53638867/8416610</a>."}, {"owner": {"reputation": 13, "user_id": 8377043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040e640159e618cc88b5fc4790dc92ed?s=128&d=identicon&r=PG&f=1", "display_name": "Herrvey", "link": "https://stackoverflow.com/users/8377043/herrvey"}, "reply_to_user": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1552475131, "post_id": 55139102, "comment_id": 97020806, "body": "That may be indeed be the cause of my bug. I already tried to add the sources for the library to the package and compile them during package build (cf end of my post) but it didn&#39;t change anything. I&#39;ll try to compile with gcc using Rtools"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8377043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040e640159e618cc88b5fc4790dc92ed?s=128&d=identicon&r=PG&f=1", "display_name": "Herrvey", "link": "https://stackoverflow.com/users/8377043/herrvey"}, "edited": false, "score": 0, "creation_date": 1552556263, "post_id": 55151272, "comment_id": 97057413, "body": "Thanks a lot for this tailored answer. As it stands, it works exactly like I want to. I really do appreciate you took the time to post a working code on Github."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 13, "user_id": 8377043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040e640159e618cc88b5fc4790dc92ed?s=128&d=identicon&r=PG&f=1", "display_name": "Herrvey", "link": "https://stackoverflow.com/users/8377043/herrvey"}, "edited": false, "score": 0, "creation_date": 1552556853, "post_id": 55151272, "comment_id": 97057805, "body": "@Herrvey You are welcome. Feel free to ping me on GH if you are interested in developing this for more than &quot;my own use&quot;."}], "tags": [], "owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "is_accepted": true, "score": 2, "last_activity_date": 1552550033, "last_edit_date": 1592644375, "creation_date": 1552511457, "answer_id": 55151272, "question_id": 55139102, "link": "https://stackoverflow.com/questions/55139102/undefined-reference-when-building-r-package-using-rcpp-with-an-external-c-libr/55151272#55151272", "title": "Undefined reference when building R package using Rcpp with an external C++ library", "body": "<p><a href=\"https://www.r-bloggers.com/sodd-stackoverflow-driven-development/\" rel=\"nofollow noreferrer\">SODD</a> got the better of me. I have build a <strong>very</strong> rough package that compiles the levmar code and creates an initial R package from it: <a href=\"https://github.com/rstub/levmaR\" rel=\"nofollow noreferrer\">https://github.com/rstub/levmaR</a>.  Important points:</p>\n<ul>\n<li><p>Source files in sub-directories of <code>src</code> are <strong>not</strong> automatically compiled. One has to add them somehow, e.g.</p>\n<pre><code>CXX_STD = CXX11\nPKG_LIBS=-L. -llevmar  $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)\nPKG_CPPFLAGS=-I./levmar/ -DSTRICT_R_HEADERS \n\nall: $(SHLIB)\n$(SHLIB): liblevmar.a\n\nLIBOBJS = levmar/lm.o levmar/Axb.o levmar/misc.o levmar/lmlec.o levmar/lmbc.o \\\n          levmar/lmblec.o levmar/lmbleic.o\n\nliblevmar.a: $(LIBOBJS)\n    $(AR) rcs liblevmar.a $(LIBOBJS)\n</code></pre>\n</li>\n<li><p>By default levmar tries to build single- and double-precision functions and tries to use LAPACK. Default builds of R only include double-precision LAPACK and BLAS. I disabled the single precision build.</p>\n</li>\n<li><p>The levmar library is actually pure C. So my suspicion that your problems where caused by the different C++ ABIs between VC and gcc is probably not correct. Most likely there is some other incompatibility between VC and gcc concerning the layout of static libraries.</p>\n</li>\n</ul>\n<p>Right now the only available function is your <code>test_levmar()</code>. Tested on Linux and Windows (via Appveyor and rhub).</p>\n"}], "owner": {"reputation": 13, "user_id": 8377043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040e640159e618cc88b5fc4790dc92ed?s=128&d=identicon&r=PG&f=1", "display_name": "Herrvey", "link": "https://stackoverflow.com/users/8377043/herrvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "accepted_answer_id": 55151272, "answer_count": 1, "score": 0, "last_activity_date": 1552550033, "creation_date": 1552471430, "question_id": 55139102, "link": "https://stackoverflow.com/questions/55139102/undefined-reference-when-building-r-package-using-rcpp-with-an-external-c-libr", "title": "Undefined reference when building R package using Rcpp with an external C++ library", "body": "<p>I'm trying to create a R package for my own use, that is using Rcpp and whose C++ code include the <a href=\"http://users.ics.forth.gr/~lourakis/levmar/\" rel=\"nofollow noreferrer\">Levmar</a> library. I'm working on Windows.</p>\n\n<p>The C++ code works fine when I build it using CMake for example and run it with Visual Studio. But when I put this code in my R package and try to build it, I get the following error :</p>\n\n<blockquote>\n  <p>levmar_example_r.o:levmar_example_r.cpp:(.text+0x281): undefined reference to `dlevmar_der'</p>\n</blockquote>\n\n<p>(dlevmar_der is declared in levmar.h which is included in my R package, see below)</p>\n\n<p>I have already read quite a lot of SO posts on how to build a R package with external libraries like <a href=\"https://stackoverflow.com/questions/37753149/adding-an-external-library-in-r-package-using-rcpp\">this</a> or <a href=\"https://stackoverflow.com/questions/36927141/syncing-rcpp-with-external-headers-and-libraries-to-build-a-batch-geocoding-pack\">this</a> but it didn't help me to solve my problem. </p>\n\n<p>The structure of my package :</p>\n\n<pre><code>bin/\n  |- levmar.lib\ninst/\n  |- include/\n      |- levmar.h\nman/\nR/\nsrc/\n  |- Makevars\n  |- Makevars.win\n  |- levmar_example_r.cpp\n  |- RcppExports.cpp\nsrc-i386/\nDESCRIPTION\nNAMESPACE\n</code></pre>\n\n<p>Content of Makevars/Makevars.win</p>\n\n<pre><code>PKG_LIBS = -L../bin -llevmar\nPKG_CPPFLAGS = -I../inst/include \n</code></pre>\n\n<p>The C++ code (levmar_example_r.cpp)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;levmar.h&gt;\n#include &lt;math.h&gt;\n#include &lt;Rcpp.h&gt;\n\nvoid fun(double *p, double *x, int m, int n, void *data_){\n  double a = p[0];\n  double b = p[1];\n\n  double *data = (double *) data_;\n\n  for(int i = 0; i &lt; n; i++){\n      x[i] = log(a*data[i]+b);\n  }\n}\n\nvoid jacFun(double *p, double *jac, int m, int n, void *data_){\n  double a = p[0]; \n  double b = p[1];\n\n  double *data = (double *) data_;\n\n  int k, l;\n  for(l=k=0; l &lt; n; l++){\n    jac[k++] = data[l]/(a*data[l]+b);\n    jac[k++] = 1/(a*data[l]+b);\n  }\n\n}\n\n// [[Rcpp::export]]\nvoid test_levmar(){\n  int m = 2; // # of parameters\n  int n = 40; // # of observations\n\n  double a = 1.0;\n  double b = 2.0;\n\n  double data[] = {0.119047619047619, 0.238095238095238,    0.357142857142857, 0.476190476190476,   0.595238095238095, 0.714285714285714, 1.07142857142857, 1.42857142857143,\n    0.119047619047619   ,0.238095238095238, 0.357142857142857, 0.476190476190476, 0.595238095238095, 0.714285714285714  ,1.07142857142857, 1.42857142857143 ,\n    0.119047619047619,  0.238095238095238,  0.357142857142857,  0.476190476190476,  0.595238095238095,  0.714285714285714,  1.07142857142857,   1.42857142857143,\n    0.119047619047619,  0.238095238095238,  0.357142857142857,  0.476190476190476   ,0.595238095238095, 0.714285714285714,  1.07142857142857,   1.42857142857143,\n    0.119047619047619,  0.238095238095238   ,0.357142857142857, 0.476190476190476,  0.595238095238095,  0.714285714285714,  1.07142857142857,   1.42857142857143};\n\n  double popti[2];\n  popti[0] = a; popti[1] = b;\n\n  double x[40];\n  fun(popti, x, m, n, (void *) data);\n\n  // algorithm parameters\n  double opts[LM_OPTS_SZ], info[LM_INFO_SZ];\n  opts[0]=LM_INIT_MU;\n  // stopping thresholds for\n  opts[1]=1E-10;       // ||J^T e||_inf\n  opts[2]=1E-10;       // ||Dp||_2\n  opts[3]=1E-10;       // ||e||_2\n  opts[4]= LM_DIFF_DELTA; // finite difference if used\n\n  double p[2];\n  p[0] = 3.0; p[1] = 1.0;\n\n  dlevmar_der(fun,jacFun,p,x,m,n,100,opts,info,NULL,NULL,(void *) data);\n\n  std::cout &lt;&lt; \"Optimum found:\" &lt;&lt; std::scientific &lt;&lt; std::setprecision(8)&lt;&lt; \"\\t\"&lt;&lt; p[0]&lt;&lt; \"\\t\" &lt;&lt; p[1]&lt;&lt; std::endl;\n }\n</code></pre>\n\n<p>I have also tried to put all headers of the levmar library in the inst/include folder and all the .c files in a src/levmar folder and consequently remove </p>\n\n<pre><code>PKG_LIBS = -L../bin -llevmar\n</code></pre>\n\n<p>in Makevars/Makevars.win and add </p>\n\n<pre><code>-I src/levmar\n</code></pre>\n\n<p>to the PKG_CPPFLAGS but it didn't work out either. </p>\n\n<p>Do you have any idea on what I should do ? </p>\n\n<p>Don't hesitate to ask for precisions if I wasn't clear enough</p>\n"}, {"tags": ["c++", "utf-8", "mbcs"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1552471622, "post_id": 55138971, "comment_id": 97018651, "body": "CW2T will lose any Unicode characters that can&#39;t be represented with your code page."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1552473912, "post_id": 55138971, "comment_id": 97020117, "body": "Why are your project settings still on MBCS?  Do you still have customers on Windows 98?"}, {"owner": {"reputation": 97, "user_id": 9590864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14311ba6c6a8db8bed97681419b10bfb?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Lopes Martins", "link": "https://stackoverflow.com/users/9590864/miguel-lopes-martins"}, "reply_to_user": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1552476043, "post_id": 55138971, "comment_id": 97021360, "body": "@selbie Um... Honestly, I don&#39;t know. All of our customers use Windows 8, but I believe this is a legacy application. From what I understand, changing the setting to Unicode might break existing code..."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1552476134, "post_id": 55138971, "comment_id": 97021420, "body": "@MiguelLopesMartins - I figured as much.  It&#39;s easy to work around though.  See my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": false, "score": 1, "last_activity_date": 1552474406, "creation_date": 1552474406, "answer_id": 55140148, "question_id": 55138971, "link": "https://stackoverflow.com/questions/55138971/visual-c-utf-8-ca2w-followed-by-cw2t-with-mbcs-possibly-a-bad-idea/55140148#55140148", "title": "Visual C++ - UTF-8 - CA2W followed by CW2T with MBCS - Possibly a bad idea?", "body": "<p>Even if your application is compiled as MBCS, you can still use Unicode strings, buffers, and Windows Unicode APIs without any issue.</p>\n\n<p>Pass your strings around as UTF-8 either with a raw pointer (<code>const char*</code>) or in a string class such as <code>CString</code> or <code>std::string</code>.  When you actually need to <strong>render</strong> the string for display, convert to Unicode and use the <code>W</code> API explicitly.</p>\n\n<p>For example:</p>\n\n<pre><code>void UpdateDisplayText(const char* s)\n{\n    CStringW ws = CA2W(s, CP_UTF8);\n    SetDlgItemTextW(m_hWnd, IDC_LABEL1, ws);\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 9590864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14311ba6c6a8db8bed97681419b10bfb?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Lopes Martins", "link": "https://stackoverflow.com/users/9590864/miguel-lopes-martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552474406, "creation_date": 1552471050, "question_id": 55138971, "link": "https://stackoverflow.com/questions/55138971/visual-c-utf-8-ca2w-followed-by-cw2t-with-mbcs-possibly-a-bad-idea", "title": "Visual C++ - UTF-8 - CA2W followed by CW2T with MBCS - Possibly a bad idea?", "body": "<p>I'm using a library that produces UTF-8 null-terminated strings in the <code>const char*</code> type. Examples include:</p>\n\n<pre><code>MIGUEL ANT\u00c3\u201cNIO\nDONA ESTEF\u00c3\u201aNIA\n</code></pre>\n\n<p>I'd like to convert those two <code>const char*</code> types to <code>CString</code> so that they read:</p>\n\n<pre><code>MIGUEL ANT\u00d3NIO\nDONA ESTEF\u00c2NIA\n</code></pre>\n\n<p>To that effect, I'm using the following function I made:</p>\n\n<pre><code>CString Utf8StringToCString(const char * s)\n{\n    CStringW ws = CA2W(s, CP_UTF8);\n    return CW2T(ws);\n}\n</code></pre>\n\n<p>The function seems to do what I want (at least for those 2 cases). However, I'm wondering: is it a good idea at all to use the CA2W macro, followed by CW2T? Am I doing some sort of lossy conversion by doing this? Are there any side-effects I should worry about?</p>\n\n<p>Some other details:</p>\n\n<ol>\n<li>I'm using Visual Studio 2015</li>\n<li>My application is compiled using <strong>Use Multi-Byte Character Set</strong></li>\n</ol>\n"}]