[{"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1503532196, "last_edit_date": 1503532196, "creation_date": 1503532005, "answer_id": 45850857, "question_id": 45850806, "link": "https://stackoverflow.com/questions/45850806/checking-if-a-string-is-a-number-then-converting-that-number-to-an-int/45850857#45850857", "title": "Checking if a string is a number, then converting that number to an int?", "body": "<p>Use <code>stoi</code> to parse the input like this:</p>\n\n<pre><code>int num = std::stoi(input);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "is_accepted": true, "score": 6, "last_activity_date": 1503566085, "last_edit_date": 1503566085, "creation_date": 1503532131, "answer_id": 45850868, "question_id": 45850806, "link": "https://stackoverflow.com/questions/45850806/checking-if-a-string-is-a-number-then-converting-that-number-to-an-int/45850868#45850868", "title": "Checking if a string is a number, then converting that number to an int?", "body": "<p>The problem is that </p>\n\n<pre><code>stringstream(str) &gt;&gt; number;\n</code></pre>\n\n<p>creates a fresh string stream from the initial sentence, then tries to extract from it into <code>number</code>. Of course that will fail (as the first word in the sentence is not a number). If you wonder why <code>number</code> was set to 0, that's because on failure, the <code>stringstream::operator&gt;&gt;</code> zeros the argument (since C++11).</p>\n\n<blockquote>\n  <p>\"<em>If extraction fails, zero is written to value and failbit is set.</em>\" ...</p>\n</blockquote>\n\n<p>Before C++11, it left the argument unchanged. See the <a href=\"http://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt\" rel=\"nofollow noreferrer\">documentation</a> for more details.</p>\n\n<p>The correct way is to use a conversion from string to <code>int</code> (or <code>long</code>), namely <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/stol\" rel=\"nofollow noreferrer\"><code>std::stoi</code></a>, and replace that line by</p>\n\n<pre><code>try{\n    number = std::stoi(word); \n}\ncatch(std::exception&amp; e){\n    std::cout &lt;&lt; \"error converting\" &lt;&lt; '\\n';\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1503533003, "post_id": 45850947, "comment_id": 78660129, "body": "No, you need to <code>catch</code> the exception that&#39;s thrown by <code>std::stoi</code>. Otherwise what happens with <code>std::stoi(&quot;0&quot;)</code>?"}, {"owner": {"reputation": 729, "user_id": 6078157, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/42d3b295d499636cc926cbaad18227d4?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyCantEven", "link": "https://stackoverflow.com/users/6078157/thisguycanteven"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1503533207, "post_id": 45850947, "comment_id": 78660174, "body": "I suppose I had not considered that, is there some case where this would also fail when used to catch file IO exceptions?"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1503533324, "post_id": 45850947, "comment_id": 78660203, "body": "The problem I see is that your test will never catch the error, as <code>stoi(string)</code> will just throw an exception so the inside of the <code>if</code> won&#39;t be executed. Not sure what you mean by file IO exceptions? <code>stoi</code> will just throw if it cannot convert."}, {"owner": {"reputation": 729, "user_id": 6078157, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/42d3b295d499636cc926cbaad18227d4?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyCantEven", "link": "https://stackoverflow.com/users/6078157/thisguycanteven"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1503587595, "post_id": 45850947, "comment_id": 78688905, "body": "Well what I mean by IO is that I often use this convention to check for a file in a directory. Like this <code>if(!ifstream(&#39;file&#39;)){no file}</code>. I have also done this with <code>stod()</code>."}], "tags": [], "owner": {"reputation": 729, "user_id": 6078157, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/42d3b295d499636cc926cbaad18227d4?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyCantEven", "link": "https://stackoverflow.com/users/6078157/thisguycanteven"}, "is_accepted": false, "score": 0, "last_activity_date": 1503532804, "creation_date": 1503532804, "answer_id": 45850947, "question_id": 45850806, "link": "https://stackoverflow.com/questions/45850806/checking-if-a-string-is-a-number-then-converting-that-number-to-an-int/45850947#45850947", "title": "Checking if a string is a number, then converting that number to an int?", "body": "<p>using <code>stoi</code> is easy, and you can lazily catch the exception by the following:</p>\n\n<pre><code>if(!stoi(string)){\n    std::cout &lt;&lt; \"caught a non integer string\" &lt;&lt; endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6789042, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-V5uCMq7Qrgw/AAAAAAAAAAI/AAAAAAAACBg/m_f8Gsmj6Bc/photo.jpg?sz=128", "display_name": "Stubbsy", "link": "https://stackoverflow.com/users/6789042/stubbsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 45850868, "answer_count": 3, "score": 1, "last_activity_date": 1503566085, "creation_date": 1503531570, "question_id": 45850806, "link": "https://stackoverflow.com/questions/45850806/checking-if-a-string-is-a-number-then-converting-that-number-to-an-int", "title": "Checking if a string is a number, then converting that number to an int?", "body": "<p>The 'program' is to take input in then spit the string back out on seperate lines and all numbers are to be multiplied by two in this case. </p>\n\n<p>My issue occurs when a number is input after a white space.\nExample</p>\n\n<pre><code>Sentence: 12 fish\n</code></pre>\n\n<p>Outputs:  </p>\n\n<pre><code>24     \nfish\n</code></pre>\n\n<p>But...</p>\n\n<pre><code>Sentence: there are 12\n</code></pre>\n\n<p>Outputs:     </p>\n\n<pre><code>there\nare\n0\n</code></pre>\n\n<p>The program I have written:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\nusing namespace std;\n\nint main()\n{\n    string str;\n    int number = 811;\n    cout &lt;&lt; \"Sentence: \";\n    getline(cin,str);\n\n    istringstream iss(str);\n\n     while(iss)\n     {\n            bool ree = 0;\n            string word;\n            iss &gt;&gt; word;\n\n            if(isdigit(word[0]))\n            {\n                stringstream(str) &gt;&gt; number;\n                number = (number * 2);\n                cout &lt;&lt; number &lt;&lt; endl;\n                ree = 1;\n                number = 911;\n            }\n\n           if(!ree)\n           {\n            cout &lt;&lt; word &lt;&lt; endl;\n           }\n\n           ree = 0;\n\n      }\n}\n</code></pre>\n\n<p>Hopefully it's something small I am not seeing! \nThanks for the help in advanced.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 4, "creation_date": 1503531669, "post_id": 45850753, "comment_id": 78659828, "body": "Downvote for stupid title. You won&#39;t get any interest that way. Be specific, attract someone who&#39;s interested in the specific problem. This title would apply to 99% of questions on this site."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 3, "creation_date": 1503532263, "post_id": 45850753, "comment_id": 78659958, "body": "<code>biggest = smallest = num;</code> Okay, but don&#39;t you also need <code>biggestUnit = smallestUnit = unit;</code> here? Otherwise, how will your comparisons work? Also, why put <code>total = adder(unit, total, num);</code> in all three code paths? Why not just put it once somewhere outside of the <code>if</code>s?"}, {"owner": {"reputation": 63, "user_id": 7937457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f251c734100b1c32188cc41550ef0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus ", "link": "https://stackoverflow.com/users/7937457/jesus"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1503532592, "post_id": 45850753, "comment_id": 78660036, "body": "@DavidSchwartz thanks for catching that, I guess I missed that when I was adding biggest and smallest units to the code . Doesn&#39;t seem to fix the problem though :/ EDIT: Never mind it fixed the issue with my comparisons thanks!!! Just having issues with the vector now."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7937457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f251c734100b1c32188cc41550ef0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus ", "link": "https://stackoverflow.com/users/7937457/jesus"}, "edited": false, "score": 0, "creation_date": 1503533155, "post_id": 45850941, "comment_id": 78660161, "body": "Thanks! Another user already pointed it out and it fixed the comparisons issue. However, my vector is still doing weird things"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 63, "user_id": 7937457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f251c734100b1c32188cc41550ef0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus ", "link": "https://stackoverflow.com/users/7937457/jesus"}, "edited": false, "score": 0, "creation_date": 1503535348, "post_id": 45850941, "comment_id": 78660668, "body": "Probably because <code>for(int i : meters)</code> doesn&#39;t make sense. Are you trying to iterate over the integers or over the values in the vector?"}, {"owner": {"reputation": 63, "user_id": 7937457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f251c734100b1c32188cc41550ef0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus ", "link": "https://stackoverflow.com/users/7937457/jesus"}, "edited": false, "score": 0, "creation_date": 1503536648, "post_id": 45850941, "comment_id": 78660971, "body": "oh that seemed to fix it. The book talked about that type of notation for doing a simple iteration over a vector. I thought it would be appropriate to use it. Would you mind explaining why the long version of the for loop works and this one didn&#39;t?"}, {"owner": {"reputation": 834, "user_id": 744300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27f5a1a7ecdd65cda7916ebed1bed543?s=128&d=identicon&r=PG", "display_name": "Conrad Parker", "link": "https://stackoverflow.com/users/744300/conrad-parker"}, "edited": false, "score": 0, "creation_date": 1503536938, "post_id": 45850941, "comment_id": 78661035, "body": "You can just do <code>for (auto x : meters) { cout &lt;&lt; x &lt;&lt; &quot;m &quot;; }</code>"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 63, "user_id": 7937457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f251c734100b1c32188cc41550ef0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus ", "link": "https://stackoverflow.com/users/7937457/jesus"}, "edited": false, "score": 0, "creation_date": 1503537069, "post_id": 45850941, "comment_id": 78661073, "body": "@Jesus Because the part before the <code>:</code> says you&#39;re iterating over the integers and the part after the <code>:</code> says you&#39;re iterating over the values in <code>meters</code>. You can do it either way, but you have to pick one and stick to it. To iterate over the integers, you&#39;d need a collection with as many integers as the vector has members, which you don&#39;t have."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1503532756, "creation_date": 1503532756, "answer_id": 45850941, "question_id": 45850753, "link": "https://stackoverflow.com/questions/45850753/need-some-help-finding-a-logic-error-in-my-program/45850941#45850941", "title": "Need some help finding a logic error in my program", "body": "<p>You don't set <code>biggestUnit</code> or <code>smallestUnit</code> when you set <code>biggest</code> and <code>smallest</code> on the first input. So the comparisons don't work correctly.</p>\n\n<p>Try:</p>\n\n<pre><code>    //if the count is 0, i.e. very first run of the program, biggest and \n    //smallest is equal to original and call adder() to increment the total\n    if(count == 0)\n    {\n        biggest = smallest = num;\n        biggestUnit = smallestUnit = unit;\n\n        total = adder(unit, total, num);\n    }\n</code></pre>\n\n<p>Also, it's not a good idea to put <code>total = adder(unit, total, num);</code> in every code path. Just place it once outside the <code>if</code>s. Otherwise, it's harder to see that it is always executed precisely once for each input.</p>\n"}], "owner": {"reputation": 63, "user_id": 7937457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f251c734100b1c32188cc41550ef0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus ", "link": "https://stackoverflow.com/users/7937457/jesus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503532797, "creation_date": 1503531219, "last_edit_date": 1503532797, "question_id": 45850753, "link": "https://stackoverflow.com/questions/45850753/need-some-help-finding-a-logic-error-in-my-program", "title": "Need some help finding a logic error in my program", "body": "<p>I am learning C++ through Bjarne Stroustrup's \"Programming Principles and Practices Using C++\"  second edition. I am committed to doing all the drills and exercises because I am taking a game AI class in a month at school and I need to know C++ and I want to know as much as possible. </p>\n\n<p>Anyways, if anyone has ever done the drill in the book, I am on Chapter 4's drill. I am at the very end. The final product is supposed to be a program that takes a number followed by a unit of measurement (cm, in, ft, or m) in a while loop while keeping track of the biggest value as well as the smallest value and total sum of units entered in meters. I am working entirely in meters except for the biggest and smallest values which are converted to meters to check which one is bigger but stored as they were originally entered by the user. The numbers are also inserted into a vector which isn't used until the very end to sort the values and print them in order.</p>\n\n<p>Anyways, I seem to have no issue keeping track of total meters because it prints out correctly at the end but when it comes to smallest value something seems to go wrong as well as occasionally on the biggest value. Plus, some values are completely off in the vector of values. I will but the code bellow. I think the error is somewhere in my toMeters() but I have stared at it for so long that I feel like a fresh set of eyes might be helpful. Thanks!</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;cmath&gt;\n\nusing namespace std;\n\nconstexpr double mToCm = 100.00; //1m == 100cm\nconstexpr double inToCm = 2.54; //1in == 2.54cm\nconstexpr double ftToIn = 12.00; //1ft == 12in\n\n//this function just increases total ammount of units in meters\ndouble adder(string unit, double total, double num)\n{\n    if(unit == \"cm\")\n    {\n        total += (num / mToCm);\n    }\n    else if(unit == \"in\")\n    {\n        double temp;\n        temp = num * inToCm;\n        total += (temp / mToCm);\n    }\n    else if(unit == \"ft\")\n    {\n        double temp;\n        temp = num * ftToIn;\n        temp *= inToCm;\n        total += (temp / mToCm);\n    }\n    else\n    {\n        total += num;\n    }\n    return total;\n}\n\ndouble toMeters(string unit, double num)\n{\n    double value = num;\n\n    if(unit == \"cm\")\n    {\n        value /= mToCm;\n    }\n    else if(unit == \"in\")\n    {\n        value *= inToCm;\n        value /= mToCm;\n    }\n    else if(unit == \"ft\")\n    {\n        value *= ftToIn;\n        value *= inToCm;\n        value /= mToCm;\n    }\n    return value;\n}\n\nint main()\n{\n\n    double num, biggest, smallest; //current number, biggest and smallest value\n    double total = 0; //total number in meters\n    string unit, biggestUnit, smallestUnit; //current unit, unit for biggest and smallest value\n    int count = 0; //count for the loop it's only real purpose is on the first and second loop runs\n    vector&lt;double&gt;meters; //a vector of doubles called meters\n\n\n    cout &lt;&lt; \"Total ammount of units will be converted to meters, largest and biggest values will be kept in original units\\n\";\n    cout &lt;&lt; \"Start of by entering a number followed by cm, m, in, ft and continue until you want to stop; to stop, press |\\n\";\n\n    while(cin &gt;&gt; num &gt;&gt; unit)\n    {\n        //check if user want to stop\n        if(num == '|')\n        {\n            break;\n        }\n\n        //check for correct units, if not then break out\n        if(unit != \"cm\" &amp;&amp; unit != \"m\" &amp;&amp; unit != \"in\" &amp;&amp; unit != \"ft\")\n        {\n            cout &lt;&lt; \"Unit not recognized; only cm, m, in, ft are valid\\n\";\n            return 1;\n        }\n        //this checks if there is no second unit but since cin reads no \n        //whitespace it doesn't work. I just haven't gotten around to removing it\n        else if(unit == \" \")\n        {\n            cout &lt;&lt; \"Please input a unit\\n\";\n            return 1;\n        }\n\n        //all values in vectors are supposed to be in meters. If the unit is not \n        //in meters, we will call a push back on the value returned by converting \n        //the orignal number to meters\n        if(unit != \"m\")\n        {\n            meters.push_back(toMeters(unit, num));\n        }\n        //else, just call a push_back\n        else\n        {\n            meters.push_back(num);\n        }\n\n        //if the count is 0, i.e. very first run of the program, biggest and \n        //smallest is equal to original and call adder() to increment the total\n        if(count == 0)\n        {\n            biggest = smallest = num;\n            biggestUnit = smallestUnit = unit;\n\n            total = adder(unit, total, num);\n        }\n        //else, if count is &gt; 0, i.e. this is not the first run, do this part\n        else\n        {   \n            //if the value returned after running toMeters on the current value\n            //is greater than the biggest, biggest now equals current num and \n            //biggest unit is equal to current unit. Then call adder to inceare total\n            if(toMeters(unit, num) &gt; toMeters(biggestUnit, biggest))\n            {\n                biggest = num;\n                biggestUnit = unit;\n\n                total = adder(unit, total, num);\n            }\n            //same as top function but for smallers value\n            else if(toMeters(unit, num) &lt; toMeters(smallestUnit, smallest))\n            {\n                smallest = num;\n                smallestUnit = unit;\n\n                total = adder(unit, total, num);\n            }\n            //else both numbers are equal so just make a call to adder()\n            else\n            {\n                total = adder(unit, total, num);\n            }\n        }\n        //increase count just because. It was really only needed to be incremented once \n        ++count;\n    }\n\n    //call sort on the vector then print out the total units followed by bigges the smallest values\n    //then the values in meters, is ascending sorted order.\n    sort(meters.begin(), meters.end());\n    cout &lt;&lt; \"Total units in meters is \" &lt;&lt; total &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"Largest unit is \" &lt;&lt; biggest &lt;&lt; biggestUnit &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"Smallest unit is \" &lt;&lt; smallest &lt;&lt; smallestUnit &lt;&lt; \"\\n\";\n    cout&lt;&lt; \"Here are all values you entered, in meters, in ascending order: \\n\";\n\n    for(int i : meters)\n    {\n        cout &lt;&lt; meters[i] &lt;&lt; \"m\" &lt;&lt; \" \";\n    }\n    cout &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>My latest inputs were 1 cm 2 in 3 m 4 ft and the output was \n     Total units in meters is 4.28\n     Largest unit is 3m (correct)\n     Smallest unit is 2in (should be 1cm)\n     Here are all values you entered, in meters, in ascending order:\n     0.01m 0.01m 0.0508m 3m</p>\n"}, {"tags": ["c++", "loops"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1503530651, "post_id": 45850670, "comment_id": 78659587, "body": "A) Reduce the code sample B) Specify on <i>which line</i> the breakpoint occured."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1503530663, "post_id": 45850670, "comment_id": 78659591, "body": "You&#39;re calling <code>strcpy_s()</code> with the wrong number of arguments, how did this compile?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1503530712, "post_id": 45850670, "comment_id": 78659601, "body": "Why are you using C strings at all, just use <code>std::string</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503530906, "post_id": 45850670, "comment_id": 78659638, "body": "Use <code>std::getline(std::cin, my_word_string);</code> and you should have no problems with the line endings.  The variable should be <code>std::string my_word_string;</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1503531000, "post_id": 45850670, "comment_id": 78659655, "body": "Does it really work to mix stdio function <code>getcar()</code> with C++ stream <code>cin.ignore()</code>?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503531009, "post_id": 45850670, "comment_id": 78659657, "body": "<i>Don&#39;t cross the streams</i>.  The C language I/O may not use the same streams as C++ I/O (<code>cin</code>).  Prefer to use C++ I/O only."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1503532425, "post_id": 45850670, "comment_id": 78660000, "body": "@Barmar There&#39;s a template version of <code>strcpy_s</code> for arrays that is used here."}], "answers": [{"tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 0, "last_activity_date": 1503536699, "creation_date": 1503536699, "answer_id": 45851411, "question_id": 45850670, "link": "https://stackoverflow.com/questions/45850670/visual-triggered-a-breakpoint-c/45851411#45851411", "title": "Visual triggered a breakpoint c++", "body": "<p><code>ignore()</code> will set the eof bit of cin, and leave the stream in an error state. You should always clear the stream error bits after calling <code>ignore()</code>.</p>\n\n<pre><code>cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\ncin.clear();\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7786450, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MCBND0_RrcU/AAAAAAAAAAI/AAAAAAAAAkg/D7eizS0G_co/photo.jpg?sz=128", "display_name": "NGC 6543", "link": "https://stackoverflow.com/users/7786450/ngc-6543"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1503536699, "creation_date": 1503530477, "last_edit_date": 1503533208, "question_id": 45850670, "link": "https://stackoverflow.com/questions/45850670/visual-triggered-a-breakpoint-c", "title": "Visual triggered a breakpoint c++", "body": "<p>I'm new at coding and I tried to write a hangman game. The program chooses randomly one of 10 words, displays only '_' and after every guess the screen refreshes.</p>\n\n<p>The problem is that sometimes the loop is displayed 2X the whole screen.So, I tried using -</p>\n\n<pre><code>cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n</code></pre>\n\n<p>but then Visual says to me that program triggered a breakpoint. What is wrong?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n\nusing namespace std;\n\nvoid showLogo();\nint main()\n{\n    int number, amount;\n    int mistake = 5;\n    int wrongLetter = 0;\n    char letter;\n    char tab[13];\n    char unknown[13];\n    char usedLetters[5];\n    char *wsk;\n\n    srand(time(NULL));\n    number = rand() % 10;  //choose one of 10 words\n\n    string words[10] ={\"LONGITUDINAL\",\"UNFORTUNATELY\",\"EXPLANATORY\",\n                       \"PERENNIAL\",\"UNPUTDOWNABLE\",\"REMORSELESS\",\n                       \"INTERMITTENT\",\"ADJUDICATE\",\"INERSTITIAL\",\n                       \"MALPOSED\" };\n\n    amount = size(words[number]);  \n    strcpy_s(tab, words[number].c_str()); //string to char\n\n    for (int i = 0; i &lt; amount; i++)\n    {\n        unknown[i] = '_';\n    }\n\n    while (mistake)\n    {\n        int noOfGuessed = 0;\n        showLogo();\n\n        cout &lt;&lt; \"You have: \" &lt;&lt; mistake &lt;&lt; \" chances.\" &lt;&lt; endl &lt;&lt; endl;\n        cout &lt;&lt; \"Used words: \";\n        for (int i = 0; i &lt; wrongLetter; i++)\n        {\n            cout &lt;&lt; usedLetters[i] &lt;&lt; \" \";\n        }\n        cout &lt;&lt; endl &lt;&lt; endl;\n\n        for (int i = 0; i &lt; amount; i++)\n        {   \n            cout &lt;&lt; unknown[i] &lt;&lt; \"  \";\n        }\n        cout &lt;&lt; \"\\t Enter a letter: \";\n\n        letter = getchar();\n        letter = toupper(letter);\n\n        for (int i = 0; i &lt; amount; i++)\n        {\n            if (letter == tab[i] &amp;&amp; unknown[i] == '_')\n            {\n                wsk = &amp;unknown[i];\n                *wsk = letter;\n                noOfGuessed++;\n            }\n        }\n\n        if (noOfGuessed == 0)\n        {\n            mistake--;\n            usedLetters[wrongLetter] = letter;\n            wrongLetter++;\n        }\n\n        cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n        system(\"cls\");\n    }\n\n    system(\"pause\");    \n    return 0;\n}\n\nvoid showLogo()\n{\n    cout &lt;&lt; \"\\t\\t\\t\\t\\t\\t\\t HANGMAN\" &lt;&lt; endl;\n    cout &lt;&lt; endl;\n    cout &lt;&lt; endl;\n    cout &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c#", "c++", ".net", "multithreading", "disposable"], "comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 3, "creation_date": 1503529376, "post_id": 45850376, "comment_id": 78659309, "body": "C++ standard is oblivious of C#. Can you please clarify what you mean by: &quot;<i>C++ class that is associated to this C# class, and I want to delete C++ object on disposing C# class...</i>&quot;?"}, {"owner": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "edited": false, "score": 0, "creation_date": 1503529767, "post_id": 45850376, "comment_id": 78659407, "body": "This is positively not a c++ question."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "edited": false, "score": 0, "creation_date": 1503530525, "post_id": 45850376, "comment_id": 78659562, "body": "@captain probably both threading models and how they interact (probably inderspecified) are required to answer this question.  What kind of C# operations correspond to C++ sequencimg?  What do C# threads act like with regards to C++ memory model?  I suspect nobody specified it, and instead we have &quot;whatever the various compilers that mix managed and unmananged code do&quot;, but I could be wrong."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1503530703, "post_id": 45850376, "comment_id": 78659600, "body": "The disposable pattern is certainly a C++ induced disease.  Egged-on by the common &quot;I have to do something <i>important</i> in the destructor&quot; feeling that C++ is saddled with.  The pattern itself dates from .NET version 1, made pointless in version 2 by the SafeHandle wrapper classes.  You can always tell that it is pointless when you can see that the Disposing(bool) overload never does anything useful with <i>disposing</i> is false.  And thread-safety is never, never a concern, Dispose() can only be called when nobody uses the object anymore.  So it is inevitably thread-safe."}, {"owner": {"reputation": 9448, "user_id": 491907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/eAa3p.png?s=128&g=1", "display_name": "pinkfloydx33", "link": "https://stackoverflow.com/users/491907/pinkfloydx33"}, "edited": false, "score": 0, "creation_date": 1503533769, "post_id": 45850376, "comment_id": 78660297, "body": "Dispose can be called whenever, by whatever. Two threads could have a reference to the same disposable. One may call Dispose but that doesn&#39;t set the references to null; successive calls can be made (by either thread). In practice (and with at least somewhat decent code) probably not going to happen that way, but to say that &#39;Dispose can only be called when nobody uses it anymore&#39;... That sounds more like the finalizer"}, {"owner": {"reputation": 71, "user_id": 2443626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447873d91e8eafeedd9544bddefcf779?s=128&d=identicon&r=PG", "display_name": "user2443626", "link": "https://stackoverflow.com/users/2443626/user2443626"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1503579688, "post_id": 45850376, "comment_id": 78682842, "body": "@Ron Let&#39;s say I&#39;m working on game engine, and I have a Component class which I want to use in C++ and in C#, so I have this native C++ pointer <code>self</code>, which points to C++ object in memory, and I can call C++ member functions on using this <code>self</code> pointer. For instance, I make a native call to C++ function <code>Init(self)</code> in C#, which basically calls <code>((Component*)self)-&gt;Init()</code>"}, {"owner": {"reputation": 71, "user_id": 2443626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447873d91e8eafeedd9544bddefcf779?s=128&d=identicon&r=PG", "display_name": "user2443626", "link": "https://stackoverflow.com/users/2443626/user2443626"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1503580450, "post_id": 45850376, "comment_id": 78683370, "body": "@HansPassant But how can I be sure that my class variables are ok? Let&#39;s say I acquired resource in C++, and I no longer use the object, so GC decides to recycle C# object and hence call C++ destructor on cleaning unmanaged resources. So if C++ member variables were not synchronized, there&#39;s no guarantee that pointer that points to native resource was updated and actually contains the resource acquired in a different thread (I know that it&#39;s almost impossible to get this behaviour, but I want to be 100% sure of a proper resource destruction, and not just rely on implementation)"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1503593263, "post_id": 45850376, "comment_id": 78692607, "body": "That just nonsensical, the GC never calls a C++ destructor.  Only a C++ compiler knows how to do that.  The GC calls a <i>finalizer</i>.  With a very nice rock-hard guarantee, it only ever does that when an object is not referenced anywhere anymore.  None of this has anything to do with IDisposable, calling Dispose() or using the <i>using</i> statement is up to the programmer, not automatic and optional.  There are not many good scenarios were it is safe to use Dispose() when a variable is accessed by multiple threads, you have to know when they are all done."}, {"owner": {"reputation": 71, "user_id": 2443626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447873d91e8eafeedd9544bddefcf779?s=128&d=identicon&r=PG", "display_name": "user2443626", "link": "https://stackoverflow.com/users/2443626/user2443626"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1503597376, "post_id": 45850376, "comment_id": 78694962, "body": "@HansPassant you got me wrong! Of course GC never calls C++ destructor, that&#39;s obvious, I was referring to my specific example where C++ destructor is called via finalizer. My concern is not that variable is accessed on different threads at the same time, but rather that one thread has updated a variable but never let other threads know, and if it still in the L2 cache in finalizer thread, than you end up with the wrong behaviour. Correct me if I&#39;m wrong!"}, {"owner": {"reputation": 71, "user_id": 2443626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447873d91e8eafeedd9544bddefcf779?s=128&d=identicon&r=PG", "display_name": "user2443626", "link": "https://stackoverflow.com/users/2443626/user2443626"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1503597682, "post_id": 45850376, "comment_id": 78695109, "body": "@HansPassant It seems to me that our assumptions that this code will work properly are only based on the fact that by that time finalizer will acquire an unsynchronized variable from the memory or L3 cache, instead of fetching it from potentially not updated L2/L1 cache with the old value."}], "answers": [{"tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": true, "score": 2, "last_activity_date": 1503733375, "creation_date": 1503733375, "answer_id": 45893140, "question_id": 45850376, "link": "https://stackoverflow.com/questions/45850376/c-disposable-pattern-for-c-object-destruction/45893140#45893140", "title": "C# disposable pattern for C++ object destruction", "body": "<blockquote>\n  <p>Is microsoft disposable pattern broken? Seems like disposed flag is a simple variable which is not synchronized if finalizer is called from a different thread.</p>\n</blockquote>\n\n<p>No it is not broken.</p>\n\n<p>This question poses 2 interesting problems.  For a class which pre-dates <code>C++11</code> thinking and is thread unaware, what is the impact of the following.</p>\n\n<pre><code> class PreCpp11 {\n   public:\n     int ** ptr;\n     bool   mInitDone;\n     PreCpp11() : mInitDone(false) {\n         ptr = new int*[100];\n     }\n     init() {\n         for( size_t i = 0; i &lt; 100; i++ ){\n             ptr[i] = new int[100];\n         }\n         mInitDone = true;\n     }\n     ~PreCpp11() {\n        if( mInitDone ){\n            for( size_t i =0; i &lt;100; i++ ){\n                delete ptr[i];\n            }\n        }\n        delete []ptr;\n     }\n }\n</code></pre>\n\n<p>After the code</p>\n\n<pre><code>PreCpp11 * myObj = new PreCpp11();\nmyObj-&gt;init();\nsend_object_to_thread2( myObj );\n</code></pre>\n\n<p>Where thread 2 performs</p>\n\n<pre><code> PreCpp11 obj = get_obj_from_sync();\n delete obj;\n</code></pre>\n\n<p>If the destructor is called on a different thread, how have we avoided a data race.</p>\n\n<p>Given that for a disposable implementation, will that cause a data race as above.</p>\n\n<p>In both cases I believe the answer to be this code is acceptable and compliant.  However, it relies on the inter-thread communication of the PreCpp11 object to itself be compliant.</p>\n\n<p>My thinking....</p>\n\n<p>I have a whole bunch of data race opportunities, this thread is guaranteed to see the values I have written into the ptr array, but other threads have no guarantee that a <code>inter-thread happens-before</code> relationship have occurred.</p>\n\n<p>However, when I inter-thread communicate my class with the second thread, then the synchronization which occurs to ensure my pointer is synchronized correctly between the initiating thread and the \"disposing\" thread, create an <code>inter-thread happens-before</code> relationship, which given this occurs after I have called <code>init</code>, that the values seen in thread 2 are the values thread 1 saw, when it started to communicate with the second thread.</p>\n\n<p>So if thread 1 continues to modify the object after it has been given to thread 2, then data races can occur, but assuming the communication between threads is compliant, then the second thread sees the first behavior.</p>\n\n<p>From <a href=\"http://en.cppreference.com/w/cpp/atomic/memory_order\" rel=\"nofollow noreferrer\">cppreference memory_order</a></p>\n\n<p><strong>Sequenced-before</strong></p>\n\n<pre><code> -&gt;init() is sequenced before \n send_object_to_thread2( myObj );\n</code></pre>\n\n<p><strong>Happens before</strong></p>\n\n<pre><code>-&gt;init() happens before the synchronized communication with thread2.\n</code></pre>\n\n<p><strong>Inter-thread happens-before</strong></p>\n\n<pre><code>-&gt;init() happens before thread 2 gets the data and calls the destructor\n -&gt;init() is sequenced-before the synchronized write to the inter-thread communication, and the write occurs before the synchronized read.\n The actual write-read is ordered, as they are synchronized.\n</code></pre>\n\n<p>So as long as inter-thread communication of the object is synchronized, and no further modification of the object occurs post- hand-off to the new thread, there is no data race.</p>\n"}], "owner": {"reputation": 71, "user_id": 2443626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447873d91e8eafeedd9544bddefcf779?s=128&d=identicon&r=PG", "display_name": "user2443626", "link": "https://stackoverflow.com/users/2443626/user2443626"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1600, "favorite_count": 0, "accepted_answer_id": 45893140, "answer_count": 1, "score": 2, "last_activity_date": 1503733375, "creation_date": 1503528225, "question_id": 45850376, "link": "https://stackoverflow.com/questions/45850376/c-disposable-pattern-for-c-object-destruction", "title": "C# disposable pattern for C++ object destruction", "body": "<p>I came across this implementation of disposable pattern provided by microsoft: <a href=\"https://msdn.microsoft.com/en-us/library/system.idisposable(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.idisposable(v=vs.110).aspx</a></p>\n\n<pre><code>using System;\n\nclass BaseClass : IDisposable\n{\n   // Flag: Has Dispose already been called?\n   bool disposed = false;\n\n   // Public implementation of Dispose pattern callable by consumers.\n   public void Dispose()\n   { \n      Dispose(true);\n      GC.SuppressFinalize(this);           \n   }\n\n   // Protected implementation of Dispose pattern.\n   protected virtual void Dispose(bool disposing)\n   {\n      if (disposed)\n         return; \n\n      if (disposing) {\n         // Free any other managed objects here.\n         //\n      }\n\n      // Free any unmanaged objects here.\n      //\n      disposed = true;\n   }\n\n   ~BaseClass()\n   {\n      Dispose(false);\n   }\n}\n</code></pre>\n\n<p>Let's say I have a C++ class that is associated to this C# class, and I want to <code>delete</code> C++ object on disposing C# class to make sure that my unmanaged resources are released properly. I add a function <code>DestructNative(self)</code> which basically makes a native C++ call <code>delete (CppObject*)self</code> on associated C++ object. So my code looks like this:</p>\n\n<pre><code>   // Protected implementation of Dispose pattern.\n   protected virtual void Dispose(bool disposing)\n   {\n      if (disposed)\n         return; \n\n\n      if (disposing) {\n         // Free any other managed objects here.\n         //\n      }\n\n      DestructNative(self);\n      disposed = true;\n   }\n</code></pre>\n\n<p>So my question is, knowing that C# finalizers can be called from a different thread, do I need to provide synchronization inside C++ object's destructor to make sure I don't have any race conditions when <code>Dispose(false)</code> called from C# finalizer?</p>\n\n<h2>Additional question</h2>\n\n<p>Is microsoft disposable pattern broken? Seems like <code>disposed</code> flag is a simple variable which is not synchronized if finalizer is called from a different thread.</p>\n"}, {"tags": ["c++", "algorithm"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503527975, "post_id": 45850316, "comment_id": 78658850, "body": "Can a ever be 0? Looks like if it is 0 your code loops forever."}, {"owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "edited": false, "score": 0, "creation_date": 1503527985, "post_id": 45850316, "comment_id": 78658854, "body": "Try to use a debugger and step through the code..."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 3, "creation_date": 1503528007, "post_id": 45850316, "comment_id": 78658865, "body": "If you are to pursue a career that of a software developer then you are well advised to stay away from those bogus <i>competitive programming</i> sites. They spread toxic knowledge and contribute nothing."}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "edited": false, "score": 0, "creation_date": 1503528152, "post_id": 45850316, "comment_id": 78658918, "body": "@mame98, I did that, I find no problem when running a single input, nor locally nor in the web interface."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1503528170, "post_id": 45850316, "comment_id": 78658924, "body": "@ron Some stupid recruiters seem to judge similar ways nowadays? &quot;O tempora o mores&quot;"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1503528179, "post_id": 45850316, "comment_id": 78658927, "body": "Those competitive programming sites accept any crap program that happens to pass the test.  They don&#39;t really teach how to properly write a program."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503528181, "post_id": 45850316, "comment_id": 78658928, "body": "You probably did not try the same test case."}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1503528189, "post_id": 45850316, "comment_id": 78658931, "body": "@Ron, leetcode was working pretty well until now :( At least they are useful in preparing for interviews since many companies ask these kind of questions..."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1503528248, "post_id": 45850316, "comment_id": 78658955, "body": "@gg.kaspersky In that case - walk away from those interviews."}, {"owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "edited": false, "score": 0, "creation_date": 1503528252, "post_id": 45850316, "comment_id": 78658958, "body": "@gg.kaspersky oh ok, then ignore my comment ;)"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503528262, "post_id": 45850316, "comment_id": 78658961, "body": "Seems like you are missing several <code>break;</code>"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503528292, "post_id": 45850316, "comment_id": 78658973, "body": "@gg.kaspersky No problemz found? You&#39;re using the debugger wrong most probably, or you don&#39;t apply the relevant test cases to your code."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503528366, "post_id": 45850316, "comment_id": 78658991, "body": "@gg.kaspersky <i>As far as I can tell, it is very similar to the most upvoted solution</i> -- So was the most upvoted solution written in C++?  If not, then this is a case where learning C++ properly supersedes writing anything that looks like some other language."}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503528625, "post_id": 45850316, "comment_id": 78659082, "body": "@PaulMcKenzie, the similarity is in the algorithmic idea. The most upvoted was a Java program, which I ported to C++ and submitted and it got accepted, however my C++ solution does not work, making me believe I have a bug, but I can not find it."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503529124, "post_id": 45850316, "comment_id": 78659231, "body": "I mentioned 2 possible bugs. My advice to you is go back and use a debugger and try more test cases. Single step through the test cases and make sure the algorithm is doing what you expect."}, {"owner": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 0, "creation_date": 1503529233, "post_id": 45850316, "comment_id": 78659256, "body": "If you don&#39;t mind can you please explain the problem and the approach you adopted ..Apart from SO I am not regular to any other . online site"}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 0, "creation_date": 1503530059, "post_id": 45850316, "comment_id": 78659461, "body": "@HariomSingh, I made an edit, thank you."}], "answers": [{"comments": [{"owner": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 0, "creation_date": 1503533428, "post_id": 45850892, "comment_id": 78660235, "body": "Its good that you found out the solution.but in c++ version you have used unordered_map and finding element adds to time complexity"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503544731, "post_id": 45850892, "comment_id": 78662816, "body": "If you would have incrementally ported the code to C++ instead of jumping straight into trying to get <code>unordered_map</code> to work, you would have seen that your <code>coinChange</code> function would probably run faster if <code>um</code> was a non-local <code>std::vector</code> and just called <code>resize()</code> to resize the vector.  Right now, you&#39;re calling <code>calloc</code> and <code>free</code>, which adds to the time taken if <code>coinChange</code> is called multiple times."}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503552019, "post_id": 45850892, "comment_id": 78664776, "body": "@PaulMcKenzie, I am aware of that. I discovered the real issue and updated the answer. It was a subtle flaw in the algorithm."}], "tags": [], "owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "is_accepted": false, "score": 0, "last_activity_date": 1503551914, "last_edit_date": 1503551914, "creation_date": 1503532365, "answer_id": 45850892, "question_id": 45850316, "link": "https://stackoverflow.com/questions/45850316/why-does-my-solution-to-leetcode-322-coin-change-timeout/45850892#45850892", "title": "Why does my solution to leetcode 322 Coin Change timeout", "body": "<p><strong>Later edit: I was wrong</strong></p>\n\n<p>I noticed that the running times were still too high for the C version, so that was not the issue. I managed to get all the tests from Leetcode and found the problem.</p>\n\n<p>For the test case coins: {3, 7, 405, 436} and amount: 8839 my implementation would make 18744855 calls while the most popular only 34486.</p>\n\n<p>This is because, for each coin, I try to put it into amount as many times as it is possible (the <code>while (true)</code> loop), and after each try I make a recursive call. It goes like this (for coins = {1} and amount = 3):</p>\n\n<pre><code>S(3) = min{1 + S(2), 2 + S(1), 3 + S(0)}\n\nS(2) = min{1 + S(1), 2 + S(0)}\n\nS(1) = min{1 + S(0)}\n\nS(0) = 0\n</code></pre>\n\n<p>However it is sufficient to try the coin only once and let the recursive call handle the rest, like the popular solution does:</p>\n\n<pre><code>S(3) = min{1 + S(2)}\n\nS(2) = min{1 + S(1)}\n\nS(1) = min{1 + S(0)}\n\nS(0) = 0\n</code></pre>\n\n<p><strong>Previous answer:</strong></p>\n\n<p>I have ported the same exact solution to C, and that got accepted, so I assume it is some problem in the Leetcode infrastructure.</p>\n\n<pre><code>int coinChange_(int* coins, int coinsSize, int *um, int amount) {\n    if (amount == 0)\n        return 0;\n\n    if (um[amount] != 0)\n        return um[amount];\n\n    int ret = -1;\n\n    for (int i = 0; i &lt; coinsSize; i++)\n    {\n        int c = coins[i];\n        int n = 1;\n        while (true)\n        {\n            int a = amount - n * c, m = 0;\n            if (a &lt; 0)\n                break;\n            if (a &gt; 0)\n                m = coinChange_(coins, coinsSize, um, a);\n            if (m != -1)\n            {\n                if (ret == -1)\n                    ret = m + n;\n                else\n                    ret = m + n &lt; ret ? m + n : ret;\n            }\n            n++;\n        }\n    }\n\n    um[amount] = ret;\n    return ret;\n}\n\nint coinChange(int* coins, int coinsSize, int amount) {\n    int *um = calloc(amount + 1, sizeof *um);\n    int ret = coinChange_(coins, coinsSize, um, amount);\n    free(um);\n    return ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1503551914, "creation_date": 1503527885, "last_edit_date": 1503530042, "question_id": 45850316, "link": "https://stackoverflow.com/questions/45850316/why-does-my-solution-to-leetcode-322-coin-change-timeout", "title": "Why does my solution to leetcode 322 Coin Change timeout", "body": "<p>Here is my code:</p>\n\n<pre><code>class Solution {\n    std::unordered_map&lt;int, int&gt; um;\npublic:\n    int coinChange(vector&lt;int&gt;&amp; coins, int amount) {\n        if (amount == 0)\n            return 0;\n\n        auto it = um.find(amount);\n        if (it != um.end())\n            return it-&gt;second;\n\n        int ret = -1;\n\n        for (int c : coins)\n        {\n            int n = 1;\n            while (true)\n            {\n                int a = amount - n * c, m = 0;\n                if (a &lt; 0)\n                    break;\n                if (a &gt; 0)\n                    m = coinChange(coins, a);\n                if (m != -1)\n                {\n                    if (ret == -1)\n                        ret = m + n;\n                    else\n                        ret = std::min(ret, m + n);\n                }\n                n++;\n            }\n        }\n\n        um[amount] = ret;\n        return ret;\n    }\n};\n</code></pre>\n\n<p>As far as I can tell, it is very similar to the most upvoted solution, it even constructs the same hashtable. However I get timeout at arbitrary inputs.\nI am not able to find any errors locally.</p>\n\n<p>Any ideas what could be wrong?</p>\n\n<p>Edit:</p>\n\n<p>I include the problem statement:</p>\n\n<p>You are given coins of different denominations and a total amount of money amount. Write a function to compute the fewest number of coins that you need to make up that amount. If that amount of money cannot be made up by any combination of the coins, return -1. </p>\n\n<p>Example:\ncoins = [1, 2, 5], amount = 11\nreturn 3 (11 = 5 + 5 + 1)</p>\n\n<p>The approach:</p>\n\n<p>Use dynamic programming (recursion + memoization). For an amount, try every coin as long as the amount is positive. For the above example:</p>\n\n<pre><code>S(11) = 1 + S(10) | 2 + S(9) | 3 + S(8) | ... | 11 + S(0) | //try coin 1\n\n        1 + S(9) | 2 + S(7) | 3 + S(5) | ... | 5 + S(1) | //try coin 2\n\n        1 + S(6) | 2 + S(1) //try coin 5\n</code></pre>\n\n<p>Pardon the confusion around this question, I believe my implementation of the above idea has some bug but I have a difficult time finding it.</p>\n"}, {"tags": ["c++", "char", "delimiter"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1503527548, "post_id": 45850201, "comment_id": 78658727, "body": "How do you know it doesn&#39;t work? You aren&#39;t doing anything with the value of <code>sub</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1503527579, "post_id": 45850201, "comment_id": 78658737, "body": "You immediately overwrite <code>sub</code> anyway , with <code>sub = strtok(NULL, inputDelim);</code> so it is not clear to me what you are trying to accomplish"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503527644, "post_id": 45850201, "comment_id": 78658760, "body": "Your question title makes absolutely no sense! There&#39;s nothing like an <i>end of char</i>. <code>char</code> values are indivisable entities. (stay away from <code>strtok()</code> BTW)."}, {"owner": {"reputation": 39, "user_id": 5196288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ffa763b3397060b9f3c9713f200537e1?s=128&d=identicon&r=PG&f=1", "display_name": "Hennry", "link": "https://stackoverflow.com/users/5196288/hennry"}, "edited": false, "score": 0, "creation_date": 1503528023, "post_id": 45850201, "comment_id": 78658867, "body": "Thats why I&#39;m asking for a way to do it. I gave my current method that doesn&#39;t work while asking for any other possible ways to go about it. And I made some changes to the explanation. There are a couple hundred more lines of code after this block. This is just new material I&#39;m adding."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1503528059, "post_id": 45850201, "comment_id": 78658883, "body": "Change that block to <code>if(vw[v] == &#39;s&#39;) vw[v] = 0;</code>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1503528143, "post_id": 45850201, "comment_id": 78658917, "body": "This will be much simpler if you use (GASP!) C++. Create a <code>std::istringstream</code>, initializing it with the contents of <code>InputArray</code>. Write a loop that extracts words from that stream (<code>std::string word; str &gt;&gt; word;</code>). If the word ends with <code>s</code>, remove the <code>s</code>. Done."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1503528986, "post_id": 45850201, "comment_id": 78659190, "body": "Use <code>std::string</code>, <code>std::string.length() - 1</code>.  Don&#39;t use character arrays."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1503529689, "post_id": 45850201, "comment_id": 78659382, "body": "@Hennry <i>OR show me another another way</i> -- <a href=\"https://ideone.com/smDoZw\" rel=\"nofollow noreferrer\">Another way</a>.  I didn&#39;t post this as an answer, since I&#39;m tired of being burned by &quot;I can&#39;t use that because my book/teacher/whatever has not explained it&quot;."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503529757, "post_id": 45850201, "comment_id": 78659405, "body": "@user0042 I think he meant &quot;Remove char from end of string&quot; and he&#39;s a non-English speaker."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1503535626, "post_id": 45850201, "comment_id": 78660730, "body": "You have a perfectly good string to work with in <code>stringTemp</code>, why not work with that?"}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1503536523, "post_id": 45851129, "comment_id": 78660943, "body": "<code>vw[v]</code> is the last character of the string, <code>vw[v+1]</code> (i.e. <code>vw[strlen(vw)]</code>) is the null terminator"}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1503537001, "post_id": 45851129, "comment_id": 78661056, "body": "Oh..I&#39;ve missed the v--.  Too many variables meaning the same thing in that code..."}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 0, "last_activity_date": 1503534562, "last_edit_date": 1503534562, "creation_date": 1503534257, "answer_id": 45851129, "question_id": 45850201, "link": "https://stackoverflow.com/questions/45850201/c-remove-value-from-end-of-char/45851129#45851129", "title": "C++ remove value from end of char", "body": "<p>There is another problem exactly where you pointed out:</p>\n\n<pre><code>//...\nint v = n;\nchar *vw = &amp;sub[0u];\nv--;\n\n/////////////////////\n//The problem is here\n/////////////////////\nif(vw[v] == 's') // v points the the NULL char at the end of vw.\n\n// should read:\nif(vw[v - 1] == 's') // v points the the last char of string vw\n</code></pre>\n\n<p>The main issue is that once you've started using strtok on your InputArray, you should not mess with it. strtok pretty much owns your string's contents, and even modifies it.  Your trying to write into <code>sub</code> (which points inside <code>InputArray</code>) effectively breaks <code>strtok</code>'s internal logic.</p>\n\n<p>You could have saved yourself the irritant bug by working with std::string from the get to. strtok() is far from being perfect...</p>\n\n<p>This code is for C++03. C++11 introduced std::find_if_not, and deprecated std::not1.</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;cctype&gt;\n\nusing namespace std;\n\nbool is_space(char c)\n{\n    return isspace(static_cast&lt;unsigned char&gt;(c)) != 0;\n}\n\nint main()\n{\n    string no_s;\n    //...\n    string phrase = \"hello world and its riches\";\n    string::iterator p1;\n    string::iterator p2 = phrase.begin();\n    while ((p1 = find_if(p2, phrase.end(), not1(ptr_fun(is_space)))) != phrase.end())\n    {\n        p2 = find_if(p1 + 1, phrase.end(), is_space);\n\n        string sub(p1, p2);\n        if (*sub.rbegin() == 's')\n            sub.resize(sub.length() - 1);\n\n        no_s += sub + \" \";\n    }\n\n    if (no_s.length())\n        no_s.resize(no_s.length() - 1);\n\n    cout &lt;&lt; no_s;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5196288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ffa763b3397060b9f3c9713f200537e1?s=128&d=identicon&r=PG&f=1", "display_name": "Hennry", "link": "https://stackoverflow.com/users/5196288/hennry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1503534562, "creation_date": 1503527220, "last_edit_date": 1503527867, "question_id": 45850201, "link": "https://stackoverflow.com/questions/45850201/c-remove-value-from-end-of-char", "title": "C++ remove value from end of char", "body": "<p>This simply gets each delims values from an array of words called <code>inputArray</code> and goes to the next word after every loop of the while.</p>\n\n<p>each word is called <code>sub</code>. </p>\n\n<p>The problem is once a word with an 's' is found at the end, I want to remove the 's' and make <code>sub</code> = the new word. </p>\n\n<p>My current method turns sub back into a string called <code>stringTemp</code> and then removes the 's' and turns it back into a the char <code>sub</code>.  </p>\n\n<pre><code>char inputDelim[] = \" \";\nchar* sub = strtok(InputArray, inputDelim);\nwhile(sub) \n{\n    //This sets up the ability to find if 's' is at the end of the word \n    int n = strlen(sub);\n    int v = n;\n    char *vw = &amp;sub[0u];\n    v--;\n\n    /////////////////////\n    //The problem is here\n    /////////////////////\n    if(vw[v] == 's')\n    {\n        string stringTemp = string(sub);\n        stringTemp.erase(stringTemp.end() - 1);\n        sub = str.c_str();//This does not work. Can not convert const char* into char*\n        s = 1;\n        r = 1;\n    }\n    ...lots more code...\n    sub = strtok(NULL, inputDelim);\n}\n</code></pre>\n\n<p>sub is used further in the code for different means.</p>\n\n<p>Can anyone assist with making this method work, OR show me another another way I could remove the 's' at the end of the <code>sub</code> char?</p>\n\n<p>I shouldn't be struggling with this, but sadly I am.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "box2d"], "comments": [{"owner": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "edited": false, "score": 0, "creation_date": 1503527485, "post_id": 45850143, "comment_id": 78658704, "body": "Looks like you missed some code in the examples snippets you&#39;ve given. What&#39;s the definition of m_particleInteractTab for instance? You also start a line of code right after saying &quot;I create two std::pair&quot; that looks incomplete or superfluous . I&#39;d like to help but I&#39;d need to see more complete code or better formatted code or something like verifiable code."}, {"owner": {"reputation": 41, "user_id": 8485087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70b1029479aea33c789155dac59e688?s=128&d=identicon&r=PG&f=1", "display_name": "Frozen", "link": "https://stackoverflow.com/users/8485087/frozen"}, "reply_to_user": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "edited": false, "score": 0, "creation_date": 1503527776, "post_id": 45850143, "comment_id": 78658788, "body": "Sorry my mistake, I edited the code."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 2, "creation_date": 1503527955, "post_id": 45850143, "comment_id": 78658842, "body": "What is the <code>b2Vec2</code> type?  You&#39;re getting the error because there is no less than comparison operator for it (<code>operator&lt;</code>)."}, {"owner": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "edited": false, "score": 0, "creation_date": 1503528078, "post_id": 45850143, "comment_id": 78658888, "body": "Maybe a typedef or a using alias would help clarify the code. Like using intvec = std::pair&lt;int, b2Vec2&gt;; then replace those uses with this alias."}, {"owner": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "edited": false, "score": 1, "creation_date": 1503528492, "post_id": 45850143, "comment_id": 78659034, "body": "1201 has it I believe. std::map does the less than comparison of the pair which I bet gets passed into its members leaving the b2Vec2 unsortable since there&#39;s no supported less than operator for it."}, {"owner": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1504276756, "post_id": 45850143, "comment_id": 78966010, "body": "@1201ProgramAlarm If you enter your explanation as the answer then this question won&#39;t show up as unanswered anymore. Any reason not to do so?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 2361, "user_id": 7410358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b241c8238988d25da76f83adf9071201?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Langholtz", "link": "https://stackoverflow.com/users/7410358/louis-langholtz"}, "edited": false, "score": 0, "creation_date": 1504281647, "post_id": 45850143, "comment_id": 78969014, "body": "@LouisLangholtz I&#39;ve added an answer, but the question will still show up as unanswered unless it has an <i>accepted</i> answer."}], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 2, "last_activity_date": 1504281568, "creation_date": 1504281568, "answer_id": 46004047, "question_id": 45850143, "link": "https://stackoverflow.com/questions/45850143/adding-a-b2vec2-in-a-map-with-stdpair-key-and-value/46004047#46004047", "title": "Adding a b2vec2 in a map with std::pair key and value", "body": "<p>The type used as a key in a <code>std::map</code> needs to have a less than comparison operator defined for it (<code>operator&lt;</code>).  <code>std::pair</code> defines one of these, which requires that <code>operator&lt;</code> be defined for the types in the pair.</p>\n\n<p>In your case, you're getting the compile error because the <code>b2Vec2</code> type does not define <code>operator&lt;</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 8485087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70b1029479aea33c789155dac59e688?s=128&d=identicon&r=PG&f=1", "display_name": "Frozen", "link": "https://stackoverflow.com/users/8485087/frozen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504281568, "creation_date": 1503526845, "last_edit_date": 1503527920, "question_id": 45850143, "link": "https://stackoverflow.com/questions/45850143/adding-a-b2vec2-in-a-map-with-stdpair-key-and-value", "title": "Adding a b2vec2 in a map with std::pair key and value", "body": "<p>I have a error when I'm trying to add element to my map, here is my simplified code :  </p>\n\n<p>I have a map :  </p>\n\n<pre><code>std::map&lt;std::pair&lt;std::string, std::pair&lt;int, b2Vec2&gt; &gt;, std::pair&lt;std::string, std::pair&lt;int, b2Vec2&gt; &gt; &gt; myMap; `  \n\nb2Vec2 rVec (1, 1)  \nstd::pair&lt;std::string, std::pair&lt;int, b2Vec2&gt; &gt; partA (std::make_pair (\"test\", std::make_pair(1, rVec ) ) );  \nstd::pair&lt;std::string, std::pair&lt;int, b2Vec2&gt; &gt; partB (std::make_pair (\"testb\", std::make_pair(1, rVec ) ) );` \n\nmyMap[partA] = partB; //When I add this line i get an error when compiling.`\n</code></pre>\n\n<p>I get the error : \"Invalid operands to binary expression ('const b2Vec2' and 'const b2Vec2').\"\nIf I replace every b2Vec2 type by a  int type in <code>myMap</code> definition and initialization, it works. So I think there is just an issue with b2Vec2 but I don't get it.</p>\n"}, {"tags": ["c++", "arrays", "struct", "sdl"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1503527235, "post_id": 45850142, "comment_id": 78658626, "body": "It probably <i>is overflowing</i> because you lied to the compiler that the variables are const."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1503527322, "post_id": 45850142, "comment_id": 78658653, "body": "Edit in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 21, "user_id": 8508577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b50492fe341cf2c6ece76ce539fe285?s=128&d=identicon&r=PG&f=1", "display_name": "Reece Ward", "link": "https://stackoverflow.com/users/8508577/reece-ward"}, "edited": false, "score": 0, "creation_date": 1503527427, "post_id": 45850142, "comment_id": 78658689, "body": "This is minimal, and it&#39;s complete for the problem...."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503527560, "post_id": 45850142, "comment_id": 78658732, "body": "Hard for us to compile and test.."}, {"owner": {"reputation": 21, "user_id": 8508577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b50492fe341cf2c6ece76ce539fe285?s=128&d=identicon&r=PG&f=1", "display_name": "Reece Ward", "link": "https://stackoverflow.com/users/8508577/reece-ward"}, "edited": false, "score": 0, "creation_date": 1503527711, "post_id": 45850142, "comment_id": 78658780, "body": "Literally nothing really more I can give you other than function names..."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8508577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b50492fe341cf2c6ece76ce539fe285?s=128&d=identicon&r=PG&f=1", "display_name": "Reece Ward", "link": "https://stackoverflow.com/users/8508577/reece-ward"}, "edited": false, "score": 0, "creation_date": 1503528207, "post_id": 45850331, "comment_id": 78658940, "body": "I have now removed the const, and am still getting the issue. Updated post"}, {"owner": {"reputation": 21, "user_id": 8508577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b50492fe341cf2c6ece76ce539fe285?s=128&d=identicon&r=PG&f=1", "display_name": "Reece Ward", "link": "https://stackoverflow.com/users/8508577/reece-ward"}, "edited": false, "score": 0, "creation_date": 1503528664, "post_id": 45850331, "comment_id": 78659094, "body": "The enum starts at 1, so there is no 0 with the mouse button"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "reply_to_user": {"reputation": 21, "user_id": 8508577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b50492fe341cf2c6ece76ce539fe285?s=128&d=identicon&r=PG&f=1", "display_name": "Reece Ward", "link": "https://stackoverflow.com/users/8508577/reece-ward"}, "edited": false, "score": 0, "creation_date": 1503560563, "post_id": 45850331, "comment_id": 78669330, "body": "@ReeceWard &quot;there is no 0 with the mouse button&quot; yet in question you said that you do use 0 as test case. One of these is wrong. If you do use value within [1;5] range then the problem isn&#39;t in presented code."}], "tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": false, "score": 0, "last_activity_date": 1503528530, "last_edit_date": 1503528530, "creation_date": 1503527962, "answer_id": 45850331, "question_id": 45850142, "link": "https://stackoverflow.com/questions/45850142/c-sdl-overwriting-an-array-some-how/45850331#45850331", "title": "C++/SDL Overwriting an array some how?", "body": "<pre><code>const Rect MousePosition      = Rect(0, 0);\n// ...\n*(Rect*)(&amp;MousePosition)      = Rect(event.motion.x, event.motion.y);\n</code></pre>\n\n<p>You told the compiler that MousePosition was const. Its not a reference and not a pointer, so the compiler <strong>knows for sure</strong>, that <code>MousePosition.x</code> and <code>MousePosition.y</code> can never change, which means, they are <code>0</code>. From now till eternity, they will be <code>0</code>.</p>\n\n<p>If the compiler optimizes your code the way I expect it to, it will just remove <code>MousePosition</code> and <code>MouseDeltaPosition</code> completely and replace all reads from <code>MousePosition.x</code>, <code>MousePosition.y</code>, <code>MouseDeltaPosition.x</code> and <code>MouseDeltaPosition.y</code> with a literal <code>0</code>, this is why you're writing in your array instead.</p>\n\n<p>TLDR: Don't lie to the compiler. If you are writing to a variable, don't make it const and cast away constness.</p>\n\n<p>Edit:</p>\n\n<blockquote>\n  <p>This is from simply doing: Input.GetMouseButton(0) that returns 255 when the mouse is in a certain position</p>\n</blockquote>\n\n<p>Well, take a look at that function:</p>\n\n<pre><code>bool CInput::GetMouseButton(int button)\n{\n    return _mouseButtons[button - 1];\n}\n</code></pre>\n\n<p><code>0 - 1</code> is <code>-1</code> so reading from <code>_mouseButtons[-1]</code> reads the data <em>from somewhere else</em>. Undefined Behavior.</p>\n"}], "owner": {"reputation": 21, "user_id": 8508577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b50492fe341cf2c6ece76ce539fe285?s=128&d=identicon&r=PG&f=1", "display_name": "Reece Ward", "link": "https://stackoverflow.com/users/8508577/reece-ward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1503528530, "creation_date": 1503526843, "last_edit_date": 1503528426, "question_id": 45850142, "link": "https://stackoverflow.com/questions/45850142/c-sdl-overwriting-an-array-some-how", "title": "C++/SDL Overwriting an array some how?", "body": "<p>I am creating a game engine for a project and am using SDL for input and stuff. </p>\n\n<p>I have something like this:</p>\n\n<pre><code>class CInput\n{\npublic:\n    CInput();\n\n    Rect MousePosition      = Rect(0, 0);\n    Rect MouseDeltaPosition = Rect(0, 0);\n\n    bool GetMouseButton(int button);\n\n    bool Process();\n\nprivate:\n    bool _mouseButtons[5];\n};\n\nbool CInput::GetMouseButton(int button)\n{\n    return _mouseButtons[button - 1];\n}\n</code></pre>\n\n<p>The rect structure is like this:</p>\n\n<pre><code>struct Rect\n{\n    int x, y;\n\n    Rect(int x, int y) : x(x), y(y) {};\n};\n</code></pre>\n\n<p>I am logging the mouse buttons and movements to be used for well whatever really, but it seems that when I set the mouseposition/mousedeltaposition it is \"overflowing\" onto the _mouseButtons array?</p>\n\n<p>Here is my input capture:</p>\n\n<pre><code>while (SDL_PollEvent(&amp;event))\n{\n    switch (event.type)\n    {\n    case SDL_MOUSEMOTION:\n        MousePosition      = Rect(event.motion.x, event.motion.y);\n        MouseDeltaPosition = Rect(event.motion.xrel, event.motion.yrel);\n\n        break;\n\n    case SDL_MOUSEBUTTONDOWN:\n        _mouseButtons[event.button.button - 1] = true;\n        break;\n    case SDL_MOUSEBUTTONUP:\n        _mouseButtons[event.button.button - 1] = false;\n        break;\n\n    case SDL_QUIT:\n        return 0;\n    }\n}\n</code></pre>\n\n<p>During testing, the _mouseButton arrays can get filled with 255 even though nobody is pressing a button. </p>\n\n<p>EDIT---</p>\n\n<p><a href=\"https://i.stack.imgur.com/xoADc.png\" rel=\"nofollow noreferrer\">imgur</a></p>\n\n<p>This is from simply doing: Input.GetMouseButton(0)\nthat returns 255 when the mouse is in a certain position</p>\n\n<p>!!! I have narrowed down the issue, it appears to occur when DeltaMousePosition.y is negative, as in the mouse is moving upwards in relation to the window! Could be the problem</p>\n"}, {"tags": ["c++", "visual-studio", "macros", "stringstream"], "comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1503526666, "post_id": 45850109, "comment_id": 78658427, "body": "Avoid macros (that look like functions). Prefer <code>const</code> or <code>constexpr</code> to <code>#define</code>."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 3, "creation_date": 1503527664, "post_id": 45850109, "comment_id": 78658765, "body": "<code>std::stringstream temp; temp &lt;&lt; msg;</code> should do the trick."}, {"owner": {"reputation": 41, "user_id": 8473659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0173c6cbc5ca34785e1ae1df95541be6?s=128&d=identicon&r=PG&f=1", "display_name": "Doug ", "link": "https://stackoverflow.com/users/8473659/doug"}, "edited": false, "score": 0, "creation_date": 1503528138, "post_id": 45850109, "comment_id": 78658916, "body": "Put your comment as an answer and I will mark it."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1503528288, "post_id": 45850109, "comment_id": 78658972, "body": "you have to make sure that &#39;msg&#39; is quoted, otherwise it will become <code>#msg</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1503530666, "post_id": 45850109, "comment_id": 78659593, "body": "This is the kind of situation you really shouldn&#39;t be using a macro for. I would suggest creating a <code>Logger</code> class that supports <code>operator&lt;&lt;</code>, then you can do things like this: <code>Logger(WARN, &quot;Logger1&quot;, __FILE__, __func__, __LINE__) &lt;&lt; &quot;Hello World! A: &quot; &lt;&lt; a &lt;&lt; b;</code> Easily implemented using a <code>std::ostringstream</code> associated with a custom <code>std::basic_stringbuf</code> that writes to your log when flushed."}], "owner": {"reputation": 41, "user_id": 8473659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0173c6cbc5ca34785e1ae1df95541be6?s=128&d=identicon&r=PG&f=1", "display_name": "Doug ", "link": "https://stackoverflow.com/users/8473659/doug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1503606208, "answer_count": 0, "score": 0, "last_activity_date": 1503530197, "creation_date": 1503526561, "last_edit_date": 1503530197, "question_id": 45850109, "link": "https://stackoverflow.com/questions/45850109/converting-a-macro-parameter-and-turning-it-into-a-stringstream", "closed_reason": "Duplicate", "title": "Converting a macro parameter and turning it into a stringstream", "body": "<p>I have a parameter in my <code>LOG()</code> macro called <code>msg</code>.  I am using this macro to perform logging.</p>\n\n<p>Currently this is what <code>LOG()</code> looks like: </p>\n\n<pre><code>#define LOG(level, msg, logger, ...) { \\\n    Log(level, msg, logger, __VA_ARGS__) \\\n}\n</code></pre>\n\n<p>What I would like to do is accept the <code>&lt;&lt;</code> operator to append additional information to the <code>msg</code>, something like this: </p>\n\n<pre><code>int b = 1000;\nstd::string a = \"I love coding\";\nLOG(WARN, \"Hello World! A: \" &lt;&lt; a &lt;&lt; b, \"Logger1\", __FILE__, __func__, __LINE__);\n</code></pre>\n\n<p>My <code>Log()</code> function (not the macro) is overloaded:</p>\n\n<pre><code>Log(Level level, const std::string&amp; msg, const std::string&amp; logger)\n\nLog(Level level, const std::string&amp; msg, const std::string&amp; logger, char* fileName, const char* functionName, int lineNumber)\n</code></pre>\n\n<p>I have tried:</p>\n\n<pre><code>#define LOG(level, msg, logger, ...) { \\\n    std::stringstream temp(msg);  \\\n    std::string message = temp.str(); \\\n    atk::core::Logger::Log(level, message, logger, __VA_ARGS__) \\\n}\n</code></pre>\n\n<p>But I receive many errors in my test application.</p>\n\n<p>Can someone point me in the right direction?</p>\n\n<p>I'd like to be able to do this inside of the macro, and not have to do something like this instead:</p>\n\n<pre><code>std::stringstream buffer;\nbuffer &lt;&lt; \"Text\" &lt;&lt; std::endl;\nstd::string s = buffer.str();\nLOG(WARN, s, \"Logger1\", __FILE__, __func__, __LINE__);\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1503526952, "post_id": 45850082, "comment_id": 78658517, "body": "Why iterate over pages, calculating <code>Begin</code> and <code>End</code>? Why not iterate over strings, calculating <code>Page</code>?"}, {"owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1503527135, "post_id": 45850082, "comment_id": 78658592, "body": "Well, you would have the same problem, wouldn&#39;t you?"}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1503528868, "post_id": 45850082, "comment_id": 78659150, "body": "No, because you can add pages to the map without danger."}, {"owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1503529031, "post_id": 45850082, "comment_id": 78659202, "body": "Then I&#39;m not sure what you mean..."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1503529258, "post_id": 45850082, "comment_id": 78659264, "body": "If you iterate over pages and calculate <code>Begin</code> and <code>End</code>, you might dereference a pointer past the end of the vector, which is UB. If you iterate over strings and calculate pages, there is no way to run past the end of the vector, and you can add pages to the map without danger of running past the end of the map."}, {"owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1503529443, "post_id": 45850082, "comment_id": 78659321, "body": "But that would involve an if condition to check if i need a new page right?"}], "answers": [{"comments": [{"owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "edited": false, "score": 0, "creation_date": 1503528718, "post_id": 45850407, "comment_id": 78659108, "body": "ad 1: Thats the problem I&#39;m aware of ad 2: Thanks for pointing that out, corrected the misstake. Thanks for the additional remarks, you are right. But is i guaranteed to work with  std::min?"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "edited": false, "score": 0, "creation_date": 1503529123, "post_id": 45850407, "comment_id": 78659230, "body": "Yes, that should do it."}, {"owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "edited": false, "score": 0, "creation_date": 1503529592, "post_id": 45850407, "comment_id": 78659356, "body": "Thanks for the quick help and for implicitly pointing me to cbegin(). I didnt know that existed."}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": true, "score": 2, "last_activity_date": 1503528407, "creation_date": 1503528407, "answer_id": 45850407, "question_id": 45850082, "link": "https://stackoverflow.com/questions/45850082/clamp-iterator-value-to-end-with-stdmin/45850407#45850407", "title": "Clamp iterator value to end() with std::min", "body": "<p>There are two things wrong with your proposed replacement:</p>\n\n<ol>\n<li>You are potentially creating an iterator past the end-iterator, which is UB.</li>\n<li>For some unfathomable reason, you want to stop at <code>end() - 1</code>?? Everywhere else, you properly use half-open ranges.</li>\n</ol>\n\n<p>What you want is more like</p>\n\n<pre><code>auto End = myVec.cbegin() + std::min(ItemsPerPage * (Page + 1), myVec.size());\n</code></pre>\n\n<p>Also take note that I used <code>auto</code> to avoid needlessly specifying complicated type-names.</p>\n\n<p>As an aside, using <code>std::ceil</code> on an integer is not very useful conceptually, at least the compiler will likely optimize out the round-trip through <code>double</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "edited": false, "score": 0, "creation_date": 1503564519, "post_id": 45851237, "comment_id": 78671800, "body": "Thanks! I&#39;ve never seen this syntax before with the | though"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "edited": false, "score": 1, "creation_date": 1503565030, "post_id": 45851237, "comment_id": 78672132, "body": "You can overload most operator including <code>operator |</code>. It has been done to allow intuitive chaining (instead of <code>f(g(a, h(x)))</code> we have <code>x | h | g(a) | f</code>)."}, {"owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "edited": false, "score": 0, "creation_date": 1503565687, "post_id": 45851237, "comment_id": 78672597, "body": "Makes sense. Thanks!"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1503535586, "last_edit_date": 1503535586, "creation_date": 1503535199, "answer_id": 45851237, "question_id": 45850082, "link": "https://stackoverflow.com/questions/45850082/clamp-iterator-value-to-end-with-stdmin/45851237#45851237", "title": "Clamp iterator value to end() with std::min", "body": "<p>With <a href=\"https://github.com/ericniebler/range-v3\" rel=\"nofollow noreferrer\">range-v3</a>, you may use <code>chunk</code> view:</p>\n\n<pre><code>std::vector&lt;std::string&gt; myVec = /*...*/;\n\nconst int ItemsPerPage = 3 // or whatever\n\nstd::map&lt;int, std::vector&lt;std::string&gt;&gt;&gt; myMap;\nint counter = 0;\nfor (const auto&amp; page : myVec | ranges::view::chunk(ItemsPerPage)) {\n    myMap[counter++] = page;\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/f904a316dd753ed3\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 1, "accepted_answer_id": 45850407, "answer_count": 2, "score": 1, "last_activity_date": 1503535586, "creation_date": 1503526442, "last_edit_date": 1503528645, "question_id": 45850082, "link": "https://stackoverflow.com/questions/45850082/clamp-iterator-value-to-end-with-stdmin", "title": "Clamp iterator value to end() with std::min", "body": "<p>I have a vector with n Strings in it. Now lets say I want to \"page\" or \"group\" those strings in a map.</p>\n\n<pre><code>typedef std::vector&lt;std::string&gt; TStringVec;\nTStringVec myVec;\n\n//.. fill myVecwith n elements\n\ntypedef std::map&lt;int, TStringVec&gt;&gt; TPagedMap;\nTPagedMap myMap;\n\nint ItemsPerPage = 3 // or whatever\nint PagesRequired = std::ceil(myVec.size() / nItemsPerPage);\nfor (int Page = 0; Page &lt; NumPagesMax; ++Page)\n{\n    TStringVec::const_iterator Begin = myVec.begin() + (ItemsPerPage * Page);\n    TStringVec::const_iterator End = myVec.begin() + ItemsPerPage * (Page+1);\n    myMap[Page] = TStringVec(Begin, End);\n}\n</code></pre>\n\n<p>One can easily spot the problem here. When determining the end iterator, I risk leaving the allocated space by the vector.</p>\n\n<p>Quick example: 5 elements in the vector, ItemsPerPage is 3. That means we need a total of 2 pages in the map to group all elements.</p>\n\n<p>Now when hitting the last iteration, begin is pointing at myVec[3] but end is \"pointing\" to myVec[6]. Remember, myVec only has 5 elements.</p>\n\n<p>Could this case be safely handled by swapping</p>\n\n<pre><code>TStringVec::const_iterator End = myVec.begin() + ItemsPerPage * (Page+1);\n</code></pre>\n\n<p>with </p>\n\n<pre><code>TStringVec::const_iterator End = std::min(myVec.begin() + ItemsPerPage * (Page+1), myVec.end()); \n</code></pre>\n\n<p>It compiles of course, and it <em>seems</em> to work. But I'm not sure if this can be considered a <strong>safe</strong> thing to do. Any advice or a definitive answer?</p>\n\n<p>I think the question is... Is a value \"past\" .end() guaranteed to be larger than the adress returned by .end()?</p>\n\n<p>Thanks in advance.</p>\n\n<p>EDIT: of course, a <code>if</code> check beforehand could solve the problem, but I'm looking for a more <em>elegant</em> solution.</p>\n"}, {"tags": ["c++", "gcc", "ld"], "comments": [{"owner": {"reputation": 4815, "user_id": 3087601, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ad2f9879fa1dea6fd47a45052ad02a09?s=128&d=identicon&r=PG&f=1", "display_name": "Zereges", "link": "https://stackoverflow.com/users/3087601/zereges"}, "edited": false, "score": 0, "creation_date": 1503526798, "post_id": 45850063, "comment_id": 78658479, "body": "virtual destructor?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 11, "creation_date": 1503527849, "post_id": 45850063, "comment_id": 78658811, "body": "Why no <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?  I get you don&#39;t want a problem solved, but helping others get the same error message (starting point) seems polite."}, {"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 6, "creation_date": 1503547837, "post_id": 45850063, "comment_id": 78663545, "body": "@Yakk How does asking what something <i>is</i> require an MCVE?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 5, "creation_date": 1503553843, "post_id": 45850063, "comment_id": 78665530, "body": "@rob &quot;I got this error doing something&quot; is <i>improved</i> by including how to get the error, because people helpimg can get to your starting poimt (getting the error) faster.  Getting the error then gets you the context in which the error happens, instead of the OP&#39;s interpretation of the context, which could lead the answerer to a better spot to seach for a definition.  I said nothing about &quot;requires&quot;.  And the mcce would have revealed it was an undefined <i>virtual</i> destructor, which the OP failed to mention."}, {"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 4, "creation_date": 1503557879, "post_id": 45850063, "comment_id": 78667479, "body": "@Yakk The question is not about the error at all. It&#39;s asking &#39;what is a key function?&#39; The error provoked the question, but it&#39;s completely unrelated to the question and answer."}, {"owner": {"reputation": 5555, "user_id": 2927205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luWrX.jpg?s=128&g=1", "display_name": "Mailerdaimon", "link": "https://stackoverflow.com/users/2927205/mailerdaimon"}, "edited": false, "score": 2, "creation_date": 1503559041, "post_id": 45850063, "comment_id": 78668254, "body": "Then why not delete this part of the questions as the &quot;why I ask&quot; is not really relevant on this site and only causes confusion to others (see the this comment section as example)?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 2, "creation_date": 1503561405, "post_id": 45850063, "comment_id": 78669880, "body": "@rob becauae context matters.  &quot;Key function&quot; without context is meaningless; the more context, the more the meaning is clear, <i>and</i> the easier investigation can be.  It is asking &quot;when I get this error, it talks about &#39;key function&#39;.  What does that mean <b>in that error</b>&quot;.  If you answer what a key function is in a crypto algorithm that is obviously wrong.  The fact the error involved vtables, and an undefined virtual method, would siggest google search terms that could lead to an answer."}], "answers": [{"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1503527664, "post_id": 45850190, "comment_id": 78658764, "body": "IOW, OP probably forgot to define the first non-inline virtual function, or to link the relevant object file. So, instead of an &quot;undefined reference&quot; error to it, you get this bizarre message - not defining the key function causes the vtable not to be emitted, which is probably spotted earlier than missing references to the key function itself."}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 2, "creation_date": 1503554376, "post_id": 45850190, "comment_id": 78665759, "body": "What happens if all virtual functions are defined inline?"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 3, "creation_date": 1503561888, "post_id": 45850190, "comment_id": 78670208, "body": "@MikeMB: from the link above: &quot;Whenever possible the vtable will only be generated and output in a single object file rather than generating the vtable in every object file which refers to the class (which might be hundreds of objects that include a header but don&#39;t actually use the class.)&quot;. I suspect that your case is one that falls out of the &quot;whenever possible&quot; above, so a vtable will be generated in every TU with the same attributes as <code>inline</code> function, and the linker will know it can pick one at random. I&#39;ll do some tests to see if this is the case."}, {"owner": {"reputation": 3301, "user_id": 2067419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/OAlqY.jpg?s=128&g=1", "display_name": "Bhupesh Pant", "link": "https://stackoverflow.com/users/2067419/bhupesh-pant"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1537724252, "post_id": 45850190, "comment_id": 91879108, "body": "@MatteoItalia, Did you find some time to do some tests around this scenario? I got stuck to this problem recently and investigating for RCA."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1537748549, "post_id": 45850190, "comment_id": 91884694, "body": "Uh sorry, unfortunately that was a good deed that I forgot. \ud83d\ude22"}], "tags": [], "owner": {"reputation": 7532, "user_id": 1753073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84fc25306e27dd3393559721ba869cd?s=128&d=identicon&r=PG", "display_name": "navylover", "link": "https://stackoverflow.com/users/1753073/navylover"}, "is_accepted": true, "score": 31, "last_activity_date": 1503527127, "creation_date": 1503527127, "answer_id": 45850190, "question_id": 45850063, "link": "https://stackoverflow.com/questions/45850063/what-is-a-c-key-function-as-described-by-gold/45850190#45850190", "title": "What is a C++ &quot;Key Function&quot; as described by gold?", "body": "<p>key function is defined as the first non-inline, virtual function declared in the class.\nThe official gcc wiki about it is <a href=\"https://gcc.gnu.org/wiki/VerboseDiagnostics#missing_vtable\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 17, "last_activity_date": 1503534644, "last_edit_date": 1503534644, "creation_date": 1503528285, "answer_id": 45850386, "question_id": 45850063, "link": "https://stackoverflow.com/questions/45850063/what-is-a-c-key-function-as-described-by-gold/45850386#45850386", "title": "What is a C++ &quot;Key Function&quot; as described by gold?", "body": "<p>(moving/expanding from the comment)</p>\n\n<p>As @navylover explained, the key function is the first non-inline, virtual function defined in the class; it's important because it is used by the compiler as a conventional marker to decide in what TU the vtable must be emitted (as it must be emitted just once) - whichever TU contains the definition of the key function, the corresponding object module will contain the vtable as well.</p>\n\n<p>It follows that, if no TU defines the key function (e.g. because you forgot to define it), the vtable will never get emitted, hence the error.</p>\n\n<p>gold there is trying to hint you in the right direction: if the vtable is missing, probably is because the key function is missing as well (again, either because you didn't define or forgot to link its module), although it may not be listed explicitly as an undefined reference (which could put you on the right track) because in the rest of the code nobody invokes it directly<sup>1</sup>, as in this example:</p>\n\n<pre><code>struct Test {\n    virtual void foo();\n    virtual int bar() {\n        return 0;\n    }\n};\n\nint main() {\n    Test t;\n    t.bar();\n    return 0;\n}\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code>[matteo@teolapkubuntu /tmp]$ g++ -fuse-ld=gold keyf.cpp \n/tmp/ccduMsT3.o:keyf.cpp:function main: error: undefined reference to 'vtable for Test'\n/usr/bin/ld.gold: the vtable symbol may be undefined because the class is missing its key function\n</code></pre>\n\n<p>Compare this with regular GNU ld, which just says</p>\n\n<pre><code>[matteo@teolapkubuntu /tmp]$ g++ keyf.cpp \n/tmp/ccUr3Xyi.o: In function `main':\nkeyf.cpp:(.text+0x1a): undefined reference to `vtable for Test'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Ok, so what? It's not like I have to explicitly define vtables, so it's definitely not obvious where should I start to look to go fixing this kind of error.</p>\n\n<hr>\n\n<ol>\n<li>Such a function may however be invoked <em>indirectly</em> through a pointer to base class, and the linker would still show only the undefined reference to the vtable and not to the function, as the only reference to the function in this case would be in the vtable, which is missing. </li>\n</ol>\n"}], "owner": {"reputation": 3189, "user_id": 633310, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8583c083d6d1fc36b494effea416b114?s=128&d=identicon&r=PG", "display_name": "Cuadue", "link": "https://stackoverflow.com/users/633310/cuadue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10635, "favorite_count": 4, "accepted_answer_id": 45850190, "answer_count": 2, "score": 34, "last_activity_date": 1503534644, "creation_date": 1503526320, "last_edit_date": 1503527430, "question_id": 45850063, "link": "https://stackoverflow.com/questions/45850063/what-is-a-c-key-function-as-described-by-gold", "title": "What is a C++ &quot;Key Function&quot; as described by gold?", "body": "<p>Please do not answer the question \"how do I solve this error message?\"</p>\n\n<p>In the error message provided by gold:</p>\n\n<pre><code>/usr/bin/ld.gold: the vtable symbol may be undefined\nbecause the class is missing its key function\n</code></pre>\n\n<p>What is a <code>key function</code>? I find reference to it in the <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/Function-Attributes.html\" rel=\"noreferrer\">GCC manual page for Function Attributes</a> under the section <code>dllimport</code>. The relevant text reads:</p>\n\n<blockquote>\n  <p>On the SH Symbian OS target the dllimport attribute also has another affect (sic)\u2014it can cause the vtable and run-time type information for a class to be exported. This happens when the class has a dllimport'ed constructor or a non-inline, non-pure virtual function and, for either of those two conditions, the class also has an inline constructor or destructor and has a key function that is defined in the current translation unit. </p>\n</blockquote>\n\n<p>From this I take away that there is some function distinct from constructors or destructors, required under some conditions, when using the <code>dllimport</code> attribute, on Symbian OS. Interesting, but I'm compiling for Linux on Linux, and <code>grep -r dllimport</code> reveals nothing. So this paragraph does not apply.</p>\n\n<p>(FWIW the problem derives (in this instance) from an undefined <em>destructor</em> but both the documentation and the output of the linker go to great pains to distinguish a \"key function\" from a destructor. For other kinds of missing symbols, the linker spells the name of the missing symbol.)</p>\n\n<p>So, what is a <code>key function</code> <em>really</em>?</p>\n"}, {"tags": ["c++", "cmath"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1503526404, "post_id": 45850061, "comment_id": 78658336, "body": "Advice -- there is no need to post an entire program showing <code>while</code> loops, I/O,  and <code>system</code> calls to show us you&#39;re having problems calling the <code>sqrt</code> function.  A two or 3 line <code>main()</code> program would have shown the issue."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1503526751, "post_id": 45850061, "comment_id": 78658463, "body": "Also, <i>&quot;call of overloaded&quot;</i> is not a proper error message. Please post an MCVE and the actual error you get."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503526809, "post_id": 45850061, "comment_id": 78658486, "body": "Does <a href=\"https://ideone.com/meKcnY\" rel=\"nofollow noreferrer\">this program compile successfully</a>?  If not, then you need to tell us what compiler you&#39;re using."}, {"owner": {"reputation": 464, "user_id": 1699328, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9225b78aebcfa548c9e133dcae2c4dc7?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/1699328/dom"}, "edited": false, "score": 0, "creation_date": 1503526972, "post_id": 45850061, "comment_id": 78658531, "body": "Duplicate question, see this answer: <a href=\"https://stackoverflow.com/a/4217970/1699328\">stackoverflow.com/a/4217970/1699328</a>"}, {"owner": {"reputation": 11, "user_id": 8508562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ca59ab3efb8d652bd7150da31aedf26?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Babecki", "link": "https://stackoverflow.com/users/8508562/ryan-babecki"}, "edited": false, "score": 0, "creation_date": 1503527259, "post_id": 45850061, "comment_id": 78658638, "body": "I&#39;m using the Dev-C++ compiler (or whatever compiler comes installed with that IDE.)"}, {"owner": {"reputation": 11, "user_id": 8508562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ca59ab3efb8d652bd7150da31aedf26?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Babecki", "link": "https://stackoverflow.com/users/8508562/ryan-babecki"}, "edited": false, "score": 0, "creation_date": 1503527583, "post_id": 45850061, "comment_id": 78658739, "body": "Edited with an image of the error."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 464, "user_id": 1699328, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9225b78aebcfa548c9e133dcae2c4dc7?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/1699328/dom"}, "edited": false, "score": 0, "creation_date": 1503527718, "post_id": 45850061, "comment_id": 78658782, "body": "@Dom If it&#39;s a duplicate, use &quot;flag&quot; to mark it as a duplicate."}], "owner": {"reputation": 11, "user_id": 8508562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ca59ab3efb8d652bd7150da31aedf26?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Babecki", "link": "https://stackoverflow.com/users/8508562/ryan-babecki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1503527799, "answer_count": 0, "score": 0, "last_activity_date": 1503527615, "creation_date": 1503526308, "last_edit_date": 1503527615, "question_id": 45850061, "link": "https://stackoverflow.com/questions/45850061/error-call-of-overloaded-sqrtint", "closed_reason": "Duplicate", "title": "Error &quot;call of overloaded &#39;sqrt(int&amp;)&#39;", "body": "<p><a href=\"https://i.stack.imgur.com/L8KWM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L8KWM.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I'm just starting off in C++ reading the book \"C++ without fear second edition\" and I'm doing one of the examples which has me write this code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n  using namespace std;\n\nint main() {\n  int n;\n  int i;\n  int is_prime = true;\n\n  cout &lt;&lt; \"Enter a number and press enter: \";\n  cin &gt;&gt; n;\n\n  i = 2;\n  while (i &lt;= sqrt(n)) {\n    if (n % i == 0) {\n      is_prime = false;\n    }\n    i++;\n    if (is_prime) {\n      cout &lt;&lt; \"Number is prime\" &lt;&lt; endl;\n    } else {\n      cout &lt;&lt; \"Number is not prime\" &lt;&lt; endl;\n    }\n  }\n  system(\"PAUSE\");\n  return 0;\n\n}\n</code></pre>\n\n<p>However when I attempt to compile I get the error</p>\n\n<blockquote>\n  <p>14 C:\\Users\\Owner\\Desktop\\C++\\PrimeCheck.cpp\n  call of overloaded `sqrt(int&amp;)'</p>\n</blockquote>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1503525212, "post_id": 45849832, "comment_id": 78657913, "body": "By stride, do you mean the number of bytes between the start of two rows? (presumably caused by row padding)"}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1503525252, "post_id": 45849832, "comment_id": 78657936, "body": "@Frank yes I would like to calculate image stride, the number of bytes"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503525985, "post_id": 45849960, "comment_id": 78658188, "body": "Please take a look at the modified question"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "reply_to_user": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503526187, "post_id": 45849960, "comment_id": 78658248, "body": "@andre and what <code>dst_image</code> and <code>src_image</code> are supposed to be? The edited question is completely different from the original"}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503526264, "post_id": 45849960, "comment_id": 78658279, "body": "dst_image is unsigned int [dst_image-&gt;width*dst_image-&gt;height] and src_image is a modified cvMat that is copied into unsigned int"}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503526459, "post_id": 45849960, "comment_id": 78658369, "body": "Miki, I&#39;m trying to do perspective transformation <a href=\"https://github.com/marcantonio/imagekiln/blob/master/perspective.c\" rel=\"nofollow noreferrer\">github.com/marcantonio/imagekiln/blob/master/perspective.c</a>"}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503526618, "post_id": 45849960, "comment_id": 78658416, "body": "Mike, please take a look at the original question"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "reply_to_user": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 1, "creation_date": 1503527028, "post_id": 45849960, "comment_id": 78658555, "body": "I&#39;m sorry but this has nothing to do with the original question, which is the one I answered to. Good luck"}], "tags": [], "owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "is_accepted": true, "score": 9, "last_activity_date": 1503525797, "creation_date": 1503525797, "answer_id": 45849960, "question_id": 45849832, "link": "https://stackoverflow.com/questions/45849832/how-do-i-calculate-the-stride-for-a-cvmat/45849960#45849960", "title": "how do I calculate the stride for a cv::Mat", "body": "<p>You can use <a href=\"http://docs.opencv.org/2.4/modules/core/doc/basic_structures.html#mat\" rel=\"noreferrer\">step</a>:</p>\n\n<blockquote>\n  <p><strong>step</strong> \u2013 Number of bytes each matrix row occupies</p>\n</blockquote>\n\n<pre><code>int n_bytes_for_each_row = mat.step;\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7542, "favorite_count": 1, "accepted_answer_id": 45849960, "answer_count": 1, "score": 5, "last_activity_date": 1602725811, "creation_date": 1503525072, "last_edit_date": 1602725811, "question_id": 45849832, "link": "https://stackoverflow.com/questions/45849832/how-do-i-calculate-the-stride-for-a-cvmat", "title": "how do I calculate the stride for a cv::Mat", "body": "<p>I would like to know how would I calculate the stride of a <code>cv:Mat</code>.</p>\n<p>I have updated the code, where I need to calculate the stride, I don't know what's wrong to calculate the projective transformation.\nI get a <code>cv::Mat</code> then copy it to <code>unsigned int</code> array, then do the transformation on it, then get back a <code>cv::Mat</code> to be shown.</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>cv::Mat3b  srcIm;\nsrcIm = imread(&quot;15016889798859437.jpg&quot;);\ncv::Mat3b  srcIm, edges;\nsrcIm = imread(&quot;Lenna.png&quot;);\n   \nimage_t src, dst;\nint n_bytes_for_each_row = srcIm.step;\n\nsrc.width = srcIm.rows;\nsrc.height = srcIm.cols;\n \nsrc.stride = n_bytes_for_each_row;\n \ndst.width = 350;\ndst.height = 350;\ndst.stride = n_bytes_for_each_row;\ndst.pixels = new unsigned int[350*350];\n   \nstd::unique_ptr&lt;unsigned int[]&gt; videoFrame(new unsigned int[srcIm.rows * srcIm.cols]);\n\nstd::transform(srcIm.begin(), srcIm.end(), videoFrame.get()\n    , [](cv::Vec3b const&amp; v) {\n    return v[0] | (v[1] &lt;&lt; 8) | (v[2] &lt;&lt; 16);\n});\n\nvertex_t vert[4];\nvert[0].u = 0;\nvert[0].v = 0;\nvert[0].x = 0;\nvert[0].y = 0;\n\nvert[1].u = 50;\nvert[1].v = 0;\nvert[1].x = 350;\nvert[1].y = 0;\n//\nvert[2].u = 150;\nvert[2].v = 350;\nvert[2].x = 350;\nvert[2].y = 350;\n//\nvert[3].u = 0;\nvert[3].v = 50;\nvert[3].x = 0;\nvert[3].y = 350;\n\nsrc.pixels = videoFrame.get();\nperspective_transform(&amp;src, &amp;dst, vert);\n\ncv::Mat videoFrameMat(350, 350, CV_32S, dst.pixels);\n\ndouble min;\ndouble max;\ncv::minMaxIdx(videoFrameMat, &amp;min, &amp;max);\ncv::Mat adjMap;\ncv::convertScaleAbs(videoFrameMat, adjMap, 255 / max);\ncv::imshow(&quot;Out&quot;, adjMap);\n\ncv::waitKey();\n</code></pre>\n"}, {"tags": ["c++", "dictionary"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1503524596, "post_id": 45849740, "comment_id": 78657629, "body": "Docs: <a href=\"http://en.cppreference.com/w/cpp/container/map/end\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/map/end</a>"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1503524621, "post_id": 45849740, "comment_id": 78657644, "body": "Iterators form a half-open range... Please read the documentation on iterators again."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1503524647, "post_id": 45849740, "comment_id": 78657668, "body": "You&#39;re thinking of <code>back()</code>, which returns a reference to the last element."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 3, "creation_date": 1503524715, "post_id": 45849740, "comment_id": 78657701, "body": "<i>&quot;Everything I&#39;ve read says this should work.&quot;</i> You should either get better reading material or read the material more carefully."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1503524742, "post_id": 45849740, "comment_id": 78657712, "body": "<code>end()</code> is an iterator to <i>beyond last element</i> - you cannot dereference it; it does not point to a valid element."}], "answers": [{"comments": [{"owner": {"reputation": 1136, "user_id": 6238063, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5ace5a4184dddfab5d73fea23d722e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/6238063/mason"}, "edited": false, "score": 0, "creation_date": 1503524856, "post_id": 45849771, "comment_id": 78657756, "body": "THANK YOU. I don&#39;t care if I get downvoted for asking this. I saw examples of end and its been driving me crazy."}, {"owner": {"reputation": 1136, "user_id": 6238063, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5ace5a4184dddfab5d73fea23d722e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/6238063/mason"}, "edited": false, "score": 0, "creation_date": 1503525259, "post_id": 45849771, "comment_id": 78657940, "body": "so what is the point of having a &quot;first&quot; and &quot;second&quot; function attached to end(). further, what is the point of even having a [poorly named] end function anyway as maps cannot be referenced like arrays by index anyway?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 1136, "user_id": 6238063, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5ace5a4184dddfab5d73fea23d722e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/6238063/mason"}, "edited": false, "score": 0, "creation_date": 1503525448, "post_id": 45849771, "comment_id": 78658003, "body": "@Mason, good questions. The answers to them are long and not appropriate in a SO comment."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 1136, "user_id": 6238063, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5ace5a4184dddfab5d73fea23d722e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/6238063/mason"}, "edited": false, "score": 0, "creation_date": 1503525491, "post_id": 45849771, "comment_id": 78658017, "body": "@Mason <code>end</code> is not &quot;poorly named&quot; - read up on half-open ranges. Also, read this: <a href=\"https://stackoverflow.com/questions/13066884/what-is-half-open-range-and-off-the-end-value\" title=\"what is half open range and off the end value\">stackoverflow.com/questions/13066884/&hellip;</a> (especially the accepted answer)."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1503524707, "creation_date": 1503524707, "answer_id": 45849771, "question_id": 45849740, "link": "https://stackoverflow.com/questions/45849740/map-end-error-iterator-not-dereferenceable-c/45849771#45849771", "title": "map.end() error &quot;iterator not dereferenceable&quot; c++", "body": "<p>Trying to get anything from the <em>end</em> iterator causes undefined behavior.</p>\n\n<p>To get the last item, you can use <code>std::map::rbegin()</code>.</p>\n\n<pre><code>// cout &lt;&lt; \"map[last value is \" &lt;&lt; doubleStatsMap.end()-&gt;first &lt;&lt; endl;\ncout &lt;&lt; \"map[last value is \" &lt;&lt; doubleStatsMap.rbegin()-&gt;first &lt;&lt; endl;\n</code></pre>\n"}], "owner": {"reputation": 1136, "user_id": 6238063, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5ace5a4184dddfab5d73fea23d722e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/6238063/mason"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "closed_date": 1503524804, "answer_count": 1, "score": -5, "last_activity_date": 1503524707, "creation_date": 1503524542, "question_id": 45849740, "link": "https://stackoverflow.com/questions/45849740/map-end-error-iterator-not-dereferenceable-c", "closed_reason": "Duplicate", "title": "map.end() error &quot;iterator not dereferenceable&quot; c++", "body": "<pre><code>//Works    \ncout &lt;&lt; \"map[0] value is \" &lt;&lt; doubleStatsMap.begin()-&gt;first&lt;&lt; endl;\n//gives error\ncout &lt;&lt; \"map[last value is \" &lt;&lt; doubleStatsMap.end()-&gt;first &lt;&lt; endl;\n</code></pre>\n\n<p>Im simply trying to get the value of the last element of my map. It works correctly with\n \"map.begin->first\" \nbut is giving \"map/set iterator not dereferencable\" for the\n \"map.end()->first\".\n It cant be empty as the map has a beginning thus it has an end. Everything I've read says this should work. Any suggestions greatly appreciated!</p>\n"}, {"tags": ["c++", "sfml"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503524945, "post_id": 45849513, "comment_id": 78657798, "body": "Use a profile to find out where most of your execution time is spent."}, {"owner": {"reputation": 1, "user_id": 5425479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rmTsDTEpgIo/AAAAAAAAAAI/AAAAAAAAA2Y/WXhgq9R3QxE/photo.jpg?sz=128", "display_name": "Fyuchanick", "link": "https://stackoverflow.com/users/5425479/fyuchanick"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503534250, "post_id": 45849513, "comment_id": 78660416, "body": "This is the part where most of my execution time is spent."}, {"owner": {"reputation": 3357, "user_id": 1325084, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/861cba4c57f76eb68d3249b60c72c809?s=128&d=identicon&r=PG", "display_name": "cppguy", "link": "https://stackoverflow.com/users/1325084/cppguy"}, "edited": false, "score": 0, "creation_date": 1503535642, "post_id": 45849513, "comment_id": 78660732, "body": "Is <code>doesBlockExist</code> expensive? It&#39;s called a lot."}, {"owner": {"reputation": 1, "user_id": 5425479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rmTsDTEpgIo/AAAAAAAAAAI/AAAAAAAAA2Y/WXhgq9R3QxE/photo.jpg?sz=128", "display_name": "Fyuchanick", "link": "https://stackoverflow.com/users/5425479/fyuchanick"}, "reply_to_user": {"reputation": 3357, "user_id": 1325084, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/861cba4c57f76eb68d3249b60c72c809?s=128&d=identicon&r=PG", "display_name": "cppguy", "link": "https://stackoverflow.com/users/1325084/cppguy"}, "edited": false, "score": 0, "creation_date": 1503585812, "post_id": 45849513, "comment_id": 78687508, "body": "@cppguy I edited it to include the function."}, {"owner": {"reputation": 3357, "user_id": 1325084, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/861cba4c57f76eb68d3249b60c72c809?s=128&d=identicon&r=PG", "display_name": "cppguy", "link": "https://stackoverflow.com/users/1325084/cppguy"}, "edited": false, "score": 0, "creation_date": 1503592975, "post_id": 45849513, "comment_id": 78692451, "body": "It looks like you need to redesign this logic. It looks incredibly expensive for what you&#39;re trying to do. You&#39;re nesting looping over blockX.size(). There&#39;s almost certainly a way to just check the surrounding 8 tiles to determine your texture."}], "answers": [{"tags": [], "owner": {"reputation": 2213, "user_id": 1034248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/be63e5221accb92b50f75ad083fe3e65?s=128&d=identicon&r=PG", "display_name": "Lukas", "link": "https://stackoverflow.com/users/1034248/lukas"}, "is_accepted": false, "score": 0, "last_activity_date": 1503669317, "creation_date": 1503669317, "answer_id": 45883005, "question_id": 45849513, "link": "https://stackoverflow.com/questions/45849513/best-way-to-make-tiles-not-have-borders-in-between-them/45883005#45883005", "title": "Best way to make tiles not have borders in between them?", "body": "<p>Whenever you have nested if-statements (high <a href=\"https://en.wikipedia.org/wiki/Cyclomatic_complexity\" rel=\"nofollow noreferrer\">cyclomatic complexity</a>) like this, you should immediately stop and think about other designs. Large nested if-statements are not only prone to contain mistakes, but are impossible to really understand at a glance.</p>\n\n<p>A better design can start with splitting things into multiple function, each with their own <a href=\"https://en.wikipedia.org/wiki/Single_responsibility_principle\" rel=\"nofollow noreferrer\">single responsibility</a>. Other steps involve thinking about the logic hard enough to find ways that eliminate conditions, i.e. when situation X holds up, Y follows and there's no need for further checking. And then there are also situations where instead of using if-statements you can construct an object that will have the right settings after construction.</p>\n\n<p>As for optimizations on your code:</p>\n\n<ul>\n<li>Use a sprite sheet and don't use x amount of textures. <code>setTextureRect</code> is basically a free function, while switching textures all the time, can lead to performance issues.</li>\n<li>If you keep the implementation of <code>doesBlockExist</code>, at least make sure to return right when you find the block and don't keep iterating. This means, inside the if-body just write <code>return true</code> and after the loop write <code>return false</code> and delete the variable returnVal.</li>\n<li>However the <code>doesBlockExist</code> function seems badly implemented. What exactly does it check for? Do you just check the surrounding tiles? If so, then you can easily just check the 8 surrounding tiles and don't need to iterate over all the tiles.</li>\n<li>Since you call <code>doesBlockExist</code> quite often, you'll have to think about, whether it wouldn't be possible to just call it once and report on all the surrounding tiles at once.</li>\n<li><code>int(round(x / 20) * 20);</code> since x is already <code>int</code> <code>x / 20</code> will be an integer division anyways, so there's no reason to round.</li>\n</ul>\n\n<p>Alternatively you could just use a tile editor like Tiled and place the tiles accordingly when designing the level and then just load the tile map.</p>\n\n<p>As for the question in the title, I have no idea what you mean with borders.</p>\n"}], "owner": {"reputation": 1, "user_id": 5425479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rmTsDTEpgIo/AAAAAAAAAAI/AAAAAAAAA2Y/WXhgq9R3QxE/photo.jpg?sz=128", "display_name": "Fyuchanick", "link": "https://stackoverflow.com/users/5425479/fyuchanick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1503669317, "creation_date": 1503523511, "last_edit_date": 1503585713, "question_id": 45849513, "link": "https://stackoverflow.com/questions/45849513/best-way-to-make-tiles-not-have-borders-in-between-them", "title": "Best way to make tiles not have borders in between them?", "body": "<p>So I am trying to make a game using SFML and visual c++. Currently I have different sprites without borders on certain sides for every combination of tiles that could be bordering each other, then used nested if statements to check which sprite to use. However, this slows down my game to the point where I can't even play it. Is there a better way to do this?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>//Render tiles\n            for (int i = 0; i &lt; blockX.size(); i++) {\n                    block.setPosition(float(blockX[i]), float(blockY[i]));\n                    if (blockType[i] == \"metal\") {\n                            //if block is metal tile\n                            block.setTexture(metalBlockSingle);\n                            if (doesBlockExist(blockX[i] + 20, blockY[i])) {\n                                    //if block is to right\n                                    if (doesBlockExist(blockX[i], blockY[i] + 20)) {\n                                            //if block is below\n                                            if (doesBlockExist(blockX[i] - 20, blockY[i])) {\n                                                    //if block is to left\n                                                    if (doesBlockExist(blockX[i], blockY[i] - 20)) {\n                                                            //if block is above\n                                                            block.setTexture(metalBlockCenter);\n                                                    }\n                                                    else {\n                                                            block.setTexture(metalBlockBottomRightLeft);\n                                                    }\n                                            }\n                                            else if (doesBlockExist(blockX[i], blockY[i] - 20)) {\n                                                    //if block is above\n                                                    block.setTexture(metalBlockTopBottomRight);\n                                            }\n                                            else {\n                                                    //if block is neither above nor to left\n                                                    block.setTexture(metalBlockBottomRight);\n                                            }\n                                    }\n                                    else if (doesBlockExist(blockX[i] - 20, blockY[i])) {\n                                            //if block is to left\n                                            if (doesBlockExist(blockX[i], blockY[i] - 20)) {\n                                                    //if block is above\n                                                    block.setTexture(metalBlockTopRightLeft);\n                                            }\n                                            else {\n                                                    block.setTexture(metalBlockRightLeft);\n                                            }\n                                    }\n                                    else if (doesBlockExist(blockX[i], blockY[i] - 20)) {\n                                            //if block is above\n                                            block.setTexture(metalBlockTopRight);\n                                    }\n                                    else {\n                                            //if block is only right\n                                            block.setTexture(metalBlockRight);\n                                    }\n                            }\n                            else if (doesBlockExist(blockX[i], blockY[i] + 20)) {\n                                    //if block is below\n                                    if (doesBlockExist(blockX[i] - 20, blockY[i])) {\n                                            //if block is to left\n                                            if (doesBlockExist(blockX[i], blockY[i] - 20)) {\n                                                    //if block is above\n                                                    block.setTexture(metalBlockTopBottomLeft);\n                                            }\n                                            else {\n                                                    //if block is not above\n                                                    block.setTexture(metalBlockBottomLeft);\n                                            }\n                                    }\n                                    else {\n                                            //if block is not to left\n                                            if (doesBlockExist(blockX[i], blockY[i] - 20)) {\n                                                    //if block is above\n                                                    block.setTexture(metalBlockTopBottom);\n                                            }\n                                            else {\n                                                    //if metal block is not above\n                                                    block.setTexture(metalBlockBottom);\n                                            }\n                                    }\n                            }\n                            else if (doesBlockExist(blockX[i] - 20, blockY[i])) {\n                                    //if block is to left\n                                    if (doesBlockExist(blockX[i], blockY[i] - 20)) {\n                                            //if block is above\n                                            block.setTexture(metalBlockTopLeft);\n                                    }\n                                    else {\n                                            block.setTexture(metalBlockLeft);\n                                    }\n                            }\n                            else if (doesBlockExist(blockX[i], blockY[i] - 20)) {\n                                    //if block is above\n                                    block.setTexture(metalBlockTop);\n                            }\n                    }\n                    window.draw(block);\n            }\n</code></pre>\n\n<p>EDIT: Here is the code for the \"doesBlockExist\" function:</p>\n\n<pre><code>bool doesBlockExist(int x, int y) {\n    bool returnVal =  false;\n    int findX = int(round(x / 20) * 20);\n    int findY = int(round(y / 20) * 20);\n    for (int i = 0; i &lt; blockX.size(); i++) {\n        if (blockX[i] == findX &amp;&amp; blockY[i] == findY) {\n            returnVal = true;\n        }\n    }\n    return(returnVal);\n\n    return(true);\n}\n</code></pre>\n"}, {"tags": ["c++", "function", "templates", "polymorphism", "virtual"], "comments": [{"owner": {"reputation": 982, "user_id": 5314692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772574311ed4da5b181c0134a99dda29?s=128&d=identicon&r=PG&f=1", "display_name": "Semyon Burov", "link": "https://stackoverflow.com/users/5314692/semyon-burov"}, "edited": false, "score": 0, "creation_date": 1503523153, "post_id": 45849394, "comment_id": 78657050, "body": "you can make class template and use virtual functions inside"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 982, "user_id": 5314692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772574311ed4da5b181c0134a99dda29?s=128&d=identicon&r=PG&f=1", "display_name": "Semyon Burov", "link": "https://stackoverflow.com/users/5314692/semyon-burov"}, "edited": false, "score": 0, "creation_date": 1503523290, "post_id": 45849394, "comment_id": 78657097, "body": "@SemyonBurov - but the template is specific of the method; how can you solve the problem making the class template?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1503523406, "post_id": 45849394, "comment_id": 78657148, "body": "Why do you need <code>eval()</code> virtual?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1503523418, "post_id": 45849394, "comment_id": 78657154, "body": "You might be able to pull something off by manually creating a vtable (using a <code>map&lt;string, function_ptr&gt;</code>) and use <code>typeid(T).name()</code> to key off the proper method. This is however going to be slooooow."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1503523666, "post_id": 45849394, "comment_id": 78657254, "body": "The template types for <code>eval()</code> are related in some way? There is a common base (virtual?) class for <code>DerivedStuff1</code>, <code>DerivedStuff2</code>, etc.?"}, {"owner": {"reputation": 982, "user_id": 5314692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772574311ed4da5b181c0134a99dda29?s=128&d=identicon&r=PG&f=1", "display_name": "Semyon Burov", "link": "https://stackoverflow.com/users/5314692/semyon-burov"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1503524087, "post_id": 45849394, "comment_id": 78657411, "body": "@max66 I dont see any specific reason here why not to use class template. May be in context of a problem this is a bad approach, but context isn&#39;t included here, so I suggest class templates... In example they look like functors."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 982, "user_id": 5314692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772574311ed4da5b181c0134a99dda29?s=128&d=identicon&r=PG&f=1", "display_name": "Semyon Burov", "link": "https://stackoverflow.com/users/5314692/semyon-burov"}, "edited": false, "score": 0, "creation_date": 1503524302, "post_id": 45849394, "comment_id": 78657515, "body": "@SemyonBurov - not sure to understand; do you mean a solution like the Filip Ko\u010dica&#39;s one? Anyway, why don&#39;t you propose an example of your idea as solution?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1503525251, "post_id": 45849394, "comment_id": 78657935, "body": "There is a thing called an X/Y problem.  You have problem Y.  You imagine a solution to it, called X.  You discover a problem with X, and ask how to fix it.  But your real problem is Y.  You don&#39;t tell people what Y is, because if only you could solve X you&#39;d have no problem.  But when the solution to X is impractical, this leads to people either describing insane solutions or saying &quot;no&quot;.  Your question is about X.  What is Y?"}, {"owner": {"reputation": 982, "user_id": 5314692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772574311ed4da5b181c0134a99dda29?s=128&d=identicon&r=PG&f=1", "display_name": "Semyon Burov", "link": "https://stackoverflow.com/users/5314692/semyon-burov"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1503531550, "post_id": 45849394, "comment_id": 78659800, "body": "@max66 Yes, something like that. Why not post as an answer? Because it looks too easy to be a solution :)"}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 1, "last_activity_date": 1503524113, "creation_date": 1503524113, "answer_id": 45849643, "question_id": 45849394, "link": "https://stackoverflow.com/questions/45849394/virtual-template-function-in-c/45849643#45849643", "title": "Virtual template function in c++", "body": "<p>Since virtual template methods in C++ arent allowed, you can make a class template and call static function of class template param.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing std::cout;\nusing std::endl;\n\n//*******************************************************************\n//*******************************************************************\n\nstruct DerivedStuff1\n{\n    static void eval() { cout &lt;&lt; \"evaluating DerivedStuff1\" &lt;&lt; endl; }\n};\n\nstruct DerivedStuff2\n{\n    static void eval() { cout &lt;&lt; \"evaluating DerivedStuff2\" &lt;&lt; endl; }\n};\n\n//*******************************************************************\n//*******************************************************************\nclass BaseClass\n{\npublic:\n    virtual void eval() const = 0;\n};\n\ntemplate&lt;typename StuffType&gt;\nclass DerivedClass1 : public BaseClass\n{\npublic:\n    virtual void eval() const\n    {\n        std::cout &lt;&lt; \"We are in DerivedClass1: \";\n        StuffType::eval();\n    }\n};\n\ntemplate&lt;typename StuffType&gt;\nclass DerivedClass2 : public BaseClass\n{\npublic:\n    virtual void eval() const\n    {\n        std::cout &lt;&lt; \"We are in DerivedClass2: \";\n        StuffType::eval();\n    }\n};\n\nint main()\n{\n    BaseClass* c1 = new DerivedClass1&lt;DerivedStuff1&gt;;\n    c1-&gt;eval();\n    c1 = new DerivedClass1&lt;DerivedStuff2&gt;;\n    c1-&gt;eval();\n\n    BaseClass* c2 = new DerivedClass2&lt;DerivedStuff1&gt;;\n    c2-&gt;eval();\n    c2 = new DerivedClass2&lt;DerivedStuff2&gt;;\n    c2-&gt;eval();\n\n    // deletes\n\n    return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>We are in DerivedClass1: evaluating DerivedStuff1\nWe are in DerivedClass1: evaluating DerivedStuff2\nWe are in DerivedClass2: evaluating DerivedStuff1\nWe are in DerivedClass2: evaluating DerivedStuff2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 4, "creation_date": 1503528025, "post_id": 45849725, "comment_id": 78658868, "body": "I can write runtime polymorphic template code through a number of means; tyoe erasure, various double-dispatch (or poly-dispatch) strategies, fast casts via CRTP, etc.  Please be more specific when you say something cannot be done; the OP&#39;s way of doing it doesn&#39;t work, and generally some additional restriction is required if your goal is to avoid reimplementing a c++ compiler in your executable, but &quot;cannot&quot; is a bit strong.  &quot;Should not&quot; usually."}], "tags": [], "owner": {"reputation": 1736, "user_id": 2489715, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JlL22.png?s=128&g=1", "display_name": "amchacon", "link": "https://stackoverflow.com/users/2489715/amchacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1503524464, "creation_date": 1503524464, "answer_id": 45849725, "question_id": 45849394, "link": "https://stackoverflow.com/questions/45849394/virtual-template-function-in-c/45849725#45849725", "title": "Virtual template function in c++", "body": "<p>You cannot mix templates (compile time) and polymorphic (runtime). That's it.</p>\n\n<p>So, a posible workaround is remove templates. For example, it could take a function pointer or just more polymorphism:</p>\n\n<pre><code>//*******************************************************************\n//*******************************************************************\n\nstruct InterfaceStuff{\n  virtual void eval() = 0;\n}\n\nstruct DerivedStuff1 : public InterfaceStuff\n{\n    void eval() { cout &lt;&lt; \"evaluating DerivedStuff1\" &lt;&lt; endl; }\n};\n\nstruct DerivedStuff2 : public InterfaceStuff\n{\n    void eval() { cout &lt;&lt; \"evaluating DerivedStuff2\" &lt;&lt; endl; }\n};\n\n//*******************************************************************\n//*******************************************************************\nclass BaseClass\n{\npublic:\n    virtual void eval(InterfaceStuff* interface) const = 0;\n};\n\nclass DerivedClass1 : public BaseClass\n{\npublic:\n    virtual void eval(InterfaceStuff* interface) const\n    {\n        std::cout &lt;&lt; \"We are in DerivedClass1: \";\n        interface-&gt;eval();\n    }\n};\n\nclass DerivedClass2 : public BaseClass\n{\npublic:\n    virtual void eval(InterfaceStuff* interface) const\n    {\n        std::cout &lt;&lt; \"We are in DerivedClass2: \";\n        interface-&gt;eval();\n    }\n};\n</code></pre>\n\n<p>Another posible workaround is remove polymorphism, just use more templates:</p>\n\n<pre><code>struct DerivedStuff1\n{\n    static void eval() { cout &lt;&lt; \"evaluating DerivedStuff1\" &lt;&lt; endl; }\n};\n\nstruct DerivedStuff2\n{\n    static void eval() { cout &lt;&lt; \"evaluating DerivedStuff2\" &lt;&lt; endl; }\n};\n\n//*******************************************************************\n//*******************************************************************\nclass BaseClass\n{\npublic:\n    template&lt;typename Eval,typename StuffType&gt; void eval() const\n    {\n        Eval::eval();\n        StuffType::eval();\n    }\n};\n\nclass DerivedClass1 : public BaseClass\n{\n};\n\nclass DerivedClass2 : public BaseClass\n{\n};\n</code></pre>\n\n<p>One way of another, you have to choose one.</p>\n"}, {"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1503528378, "post_id": 45849724, "comment_id": 78658997, "body": "You should use typeindex instead of typeid pointers; typeid pointers are not guaranteed to map 1-1 and onto types."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1503555762, "post_id": 45849724, "comment_id": 78666387, "body": "I have had fun reading your answer this is so academic as you say!! Actualy working and flexible but so inefficient LOL, I got nostalgia of when I was a PhD student surrounded by professors wasting state money on work that had the merit to make them write papers soon forgotten!!"}, {"owner": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "edited": false, "score": 0, "creation_date": 1503582238, "post_id": 45849724, "comment_id": 78684864, "body": "Note that in my specific case, speed is not really an issue as this function will only be called a few times here and there. I am much more worried about the developer interface. Regardless of the hidden complexity, I want anyone to be able to use my code without requiring detailed knowledge of its inner working. In light of this, would you still not recommend your approach?"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "reply_to_user": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "edited": false, "score": 0, "creation_date": 1503583583, "post_id": 45849724, "comment_id": 78685864, "body": "@Touloudou Sure I guess, if it fits your needs. A few macros could even make this look decent. But since you have to explicitely list all the supported types, you might as well just use a separate virtual function for each type."}], "tags": [], "owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "is_accepted": false, "score": 1, "last_activity_date": 1503549230, "last_edit_date": 1503549230, "creation_date": 1503524464, "answer_id": 45849724, "question_id": 45849394, "link": "https://stackoverflow.com/questions/45849394/virtual-template-function-in-c/45849724#45849724", "title": "Virtual template function in c++", "body": "<p>You could reinvent the vtable and resolve the function pointer at run time. You will, however, have to explicitely instantiate the template on the derived class, but I don't see any approach to this that won't require that.</p>\n\n<p>Quick and dirty example:</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;iostream&gt;\n\nclass Base {\npublic:\n  typedef void (Base::*eval_ptr)();\n  using eval_vtable = std::map&lt;std::type_index, eval_ptr&gt;;\n\n  Base(eval_vtable const&amp; eval_p) : eval_ptrs(eval_p) {}\n\n  template&lt;typename T&gt;\n  void eval() {\n    auto handler = eval_ptrs.find(type_index(typeid(T)));\n    if(handler != eval_ptrs.end()) {\n      auto handler_ptr = handler-&gt;second;\n      (this-&gt;*handler_ptr)();\n    }\n  }\n\n  eval_vtable const&amp; eval_ptrs;\n};\n\nclass Derived : public Base {\npublic:\n    Derived()\n     : Base(eval_functions) {}\n\n  template&lt;typename T&gt;\n  void eval_impl() {\n    std::cout &lt;&lt; typeid(T).name() &lt;&lt; \"\\n\";\n  }\n\n  static eval_vtable eval_functions;\n};\n\nBase::eval_vtable Derived::eval_functions = {\n  { type_index(typeid(int)), eval_ptr(&amp;Derived::eval_impl&lt;int&gt;) },\n  { type_index(typeid(float)), eval_ptr(&amp;Derived::eval_impl&lt;float&gt;) },\n  { type_index(typeid(short)), eval_ptr(&amp;Derived::eval_impl&lt;short&gt;) },\n};\n\nint main(int argc, const char* argv[]) {\n  Derived x;\n  Base * x_as_base = &amp;x;\n\n  x_as_base-&gt;eval&lt;int&gt;(); // calls Derived::eval_impl&lt;int&gt;()\n  return 0;\n}\n</code></pre>\n\n<p>This won't be exactly <strong>fast</strong>, but it will give you the closest thing to templated virtual functions that I can think of.</p>\n\n<p><strong>Edit:</strong> For the record I don't advocate anyone use this. I would much rather revisit the design to avoid being painted in this particular corner in the first place. Please consider my answer as an academic solution to a theoretical problem, not an actual engineering recommendation.</p>\n"}, {"comments": [{"owner": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "edited": false, "score": 0, "creation_date": 1503580952, "post_id": 45850104, "comment_id": 78683770, "body": "I like this approach, but I am just a bit worried about the developer interface. As is, if someone wants to use my code, he needs to create a visitor and pass it to the accept function. Is there no way to encapsulate this a bit further, so that the visitor is not even apparent to the user? Basically, add a template function eval&lt;Stuff&gt;() that would just be there to create the visitor and pass it to the accept function?"}, {"owner": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "edited": false, "score": 0, "creation_date": 1503581942, "post_id": 45850104, "comment_id": 78684616, "body": "Also, the implementation has been moved from the DerivedClasses to the EvalVisitor now. This will be a problem for me, since these derived classes contain lots of data that they use in the eval functions."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "edited": false, "score": 0, "creation_date": 1503582303, "post_id": 45850104, "comment_id": 78684916, "body": "If you create the EvalVisitor class, you can certainly hide it from the user inside some user-friendly function template. If you want the users to add new functions, they need to be aware of the visitor infrastructure."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "edited": false, "score": 0, "creation_date": 1503582539, "post_id": 45850104, "comment_id": 78685116, "body": "You can also have the actual implementations in (non virtual) member function trmplates of DerivedClassN, and the visitor would just call them. It knows both the specific derived class and specific template arguments to pass so it&#39;s not a problem. E.g. <code>virtual void visit(DerivedClass1&amp; d) { d.eval&lt;StuffYype&gt;(); }</code>"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1503526551, "creation_date": 1503526551, "answer_id": 45850104, "question_id": 45849394, "link": "https://stackoverflow.com/questions/45849394/virtual-template-function-in-c/45850104#45850104", "title": "Virtual template function in c++", "body": "<p>The <a href=\"https://en.wikipedia.org/wiki/Visitor_pattern\" rel=\"nofollow noreferrer\">visitor pattern</a> turns run-time polymorphism on its side and makes runtime-polymorphic function templates possible. It has other legitimate uses apart from templatisation, so I guess you can call it somewhat elegant.</p>\n\n<p>Your example can look as follows:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass DerivedStuff1 {\n  public:\n   static void eval() { std::cout &lt;&lt; \"Evaluating DerivedStuff1\\n\"; }\n};\n\nclass DerivedStuff2 {\n  public:\n   static void eval() { std::cout &lt;&lt; \"Evaluating DerivedStuff2\\n\"; }\n};\n\nclass DerivedClass1; class DerivedClass2;\nclass BaseClassVisitor {\n  public:\n    virtual void visit(DerivedClass1&amp;) = 0;\n    virtual void visit(DerivedClass2&amp;) = 0;\n};\n\nclass BaseClass {\n  public:\n    virtual void accept(BaseClassVisitor&amp; v) = 0;\n};\n\nclass DerivedClass1 : public BaseClass\n{\n  public:\n    virtual void accept(BaseClassVisitor&amp; v) { v.visit(*this); }\n};\n\nclass DerivedClass2 : public BaseClass\n{\n  public:\n    virtual void accept(BaseClassVisitor&amp; v) { v.visit(*this); }\n};\n\n\ntemplate &lt;typename StuffType&gt;\nclass EvalVisitor : public BaseClassVisitor\n{\n    virtual void visit(DerivedClass1&amp;) {\n        std::cout &lt;&lt; \"We are in DerivedClass1: \";\n        StuffType::eval();\n    }\n    virtual void visit(DerivedClass2&amp;) {\n        std::cout &lt;&lt; \"We are in DerivedClass2: \";\n        StuffType::eval();\n    }\n\n};\n\nint main()\n{\n    EvalVisitor&lt;DerivedStuff1&gt; e1;\n    EvalVisitor&lt;DerivedStuff2&gt; e2;\n\n    BaseClass* c1 = new DerivedClass1;\n\n    c1-&gt;accept(e1);\n    c1-&gt;accept(e2);\n\n    BaseClass* c2 = new DerivedClass2;\n\n    c2-&gt;accept(e1);\n    c2-&gt;accept(e2);\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/x6LlLw\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>Of course all shortcomings of Visitor apply here.</p>\n"}], "owner": {"reputation": 1481, "user_id": 4438463, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a0f16ea396090bd329422805329b1ba?s=128&d=identicon&r=PG&f=1", "display_name": "Touloudou", "link": "https://stackoverflow.com/users/4438463/touloudou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3703, "favorite_count": 1, "answer_count": 4, "score": 5, "last_activity_date": 1503549230, "creation_date": 1503522918, "question_id": 45849394, "link": "https://stackoverflow.com/questions/45849394/virtual-template-function-in-c", "title": "Virtual template function in c++", "body": "<p>I have been looking for a way to use both templating and polymorphism at the same time. Here's a simplified version of my problem:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing std::cout;\nusing std::endl;\n\n//*******************************************************************\n//*******************************************************************\n\nstruct DerivedStuff1\n{\n    static void eval() { cout &lt;&lt; \"evaluating DerivedStuff1\" &lt;&lt; endl; }\n};\n\nstruct DerivedStuff2\n{\n    static void eval() { cout &lt;&lt; \"evaluating DerivedStuff2\" &lt;&lt; endl; }\n};\n\n//*******************************************************************\n//*******************************************************************\nclass BaseClass\n{\npublic:\n    template&lt;typename StuffType&gt; virtual void eval() const = 0;\n};\n\nclass DerivedClass1 : public BaseClass\n{\npublic:\n    template&lt;typename StuffType&gt; virtual void eval() const\n    {\n        std::cout &lt;&lt; \"We are in DerivedClass1: \";\n        StuffType::eval();\n    }\n};\n\nclass DerivedClass2 : public BaseClass\n{\npublic:\n    template&lt;typename StuffType&gt; virtual void eval() const\n    {\n        std::cout &lt;&lt; \"We are in DerivedClass2: \";\n        StuffType::eval();\n    }\n};\n\nint main()\n{\n    BaseClass* c1 = new DerivedClass1;\n    c1-&gt;eval&lt;DerivedStuff1&gt;();\n    c1-&gt;eval&lt;DerivedStuff2&gt;();\n\n    BaseClass* c2 = new DerivedClass2;\n    c2-&gt;eval&lt;DerivedStuff1&gt;();\n    c2-&gt;eval&lt;DerivedStuff2&gt;();\n\n    return 0;\n}\n</code></pre>\n\n<p>This code does not compile because virtual template functions are not allowed in C++. I found a few approaches to tackle this problem (CRTP, etc.) but none of them were really satisfying. Is there no elegant way to get around that issue?</p>\n"}, {"tags": ["c++", "qt", "tile"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503523236, "post_id": 45849392, "comment_id": 78657079, "body": "QObject is not copyable. The Qt4 way was to use pointers instead of objects."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503523409, "post_id": 45849392, "comment_id": 78657151, "body": "<a href=\"https://stackoverflow.com/questions/19854371/repeating-q-disable-copy-in-qobject-derived-classes\" title=\"repeating q disable copy in qobject derived classes\">stackoverflow.com/questions/19854371/&hellip;</a>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503523416, "post_id": 45849392, "comment_id": 78657153, "body": "<a href=\"https://stackoverflow.com/questions/2652504/how-do-i-copy-object-in-qt\" title=\"how do i copy object in qt\">stackoverflow.com/questions/2652504/how-do-i-copy-object-in-&zwnj;&#8203;qt</a>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503523470, "post_id": 45849392, "comment_id": 78657186, "body": "<a href=\"https://stackoverflow.com/questions/19092513/copy-constructor-of-derived-qt-class\" title=\"copy constructor of derived qt class\">stackoverflow.com/questions/19092513/&hellip;</a>"}, {"owner": {"reputation": 522, "user_id": 8304478, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6ed0a9fc607629b57235f0556f000fe7?s=128&d=identicon&r=PG&f=1", "display_name": "CrippledTable", "link": "https://stackoverflow.com/users/8304478/crippledtable"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503524553, "post_id": 45849392, "comment_id": 78657607, "body": "Do you mean pointers to the objects, that&#39;s what it says in the second link, just checking if that would be a viable option for what I am trying to do here"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503524636, "post_id": 45849392, "comment_id": 78657654, "body": "I use pointers to Qt objects. Make sure you set the parent so that it get freed when the parent goes out of scope."}, {"owner": {"reputation": 522, "user_id": 8304478, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6ed0a9fc607629b57235f0556f000fe7?s=128&d=identicon&r=PG&f=1", "display_name": "CrippledTable", "link": "https://stackoverflow.com/users/8304478/crippledtable"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503525863, "post_id": 45849392, "comment_id": 78658151, "body": "I&#39;ve never used parents before, and I&#39;m trying to read up on them right now. A little bit confused as to their implementation though. Is the parent the pointer I will be working with instead of copying, or is it just a pointer that is there to be deleted when I want all of it&#39;s children to be deleted as well. In which case I would need a different pointer to do the copying work around?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503526495, "post_id": 45849392, "comment_id": 78658381, "body": "This is a fundamental feature of Qt. When a parent QObject goes out of scope it frees all of its children. That is why all QObject constructors have a parent parameter. <a href=\"http://doc.qt.io/qt-5/qobject.html#QObject\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qobject.html#QObject</a>"}, {"owner": {"reputation": 522, "user_id": 8304478, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6ed0a9fc607629b57235f0556f000fe7?s=128&d=identicon&r=PG&f=1", "display_name": "CrippledTable", "link": "https://stackoverflow.com/users/8304478/crippledtable"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503526693, "post_id": 45849392, "comment_id": 78658439, "body": "Ya I read that as well, I&#39;m just curious if there&#39;s anything else you do with the parent. edit nvm it makes sense now"}, {"owner": {"reputation": 11885, "user_id": 2257050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VknAq.png?s=128&g=1", "display_name": "thuga", "link": "https://stackoverflow.com/users/2257050/thuga"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1503566761, "post_id": 45849392, "comment_id": 78673410, "body": "@drescherjm You are right that copying is disabled, but <code>QGraphicsItem</code> is not derived from <code>QObject</code>. However it has the same disable copy macros in the class definition."}, {"owner": {"reputation": 522, "user_id": 8304478, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6ed0a9fc607629b57235f0556f000fe7?s=128&d=identicon&r=PG&f=1", "display_name": "CrippledTable", "link": "https://stackoverflow.com/users/8304478/crippledtable"}, "edited": false, "score": 0, "creation_date": 1503596455, "post_id": 45849392, "comment_id": 78694462, "body": "I&#39;m trying to implement pointers with the Qvectors now, but the image does not come out as intended."}], "answers": [{"comments": [{"owner": {"reputation": 11885, "user_id": 2257050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VknAq.png?s=128&g=1", "display_name": "thuga", "link": "https://stackoverflow.com/users/2257050/thuga"}, "edited": false, "score": 0, "creation_date": 1503903966, "post_id": 45867998, "comment_id": 78785370, "body": "You don&#39;t have to store <code>QBitmap</code>s as pointers in your vector. Those can be automatic variables."}], "tags": [], "owner": {"reputation": 522, "user_id": 8304478, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6ed0a9fc607629b57235f0556f000fe7?s=128&d=identicon&r=PG&f=1", "display_name": "CrippledTable", "link": "https://stackoverflow.com/users/8304478/crippledtable"}, "is_accepted": false, "score": 0, "last_activity_date": 1503602600, "last_edit_date": 1503602600, "creation_date": 1503596917, "answer_id": 45867998, "question_id": 45849392, "link": "https://stackoverflow.com/questions/45849392/creating-graphics-tiles-using-qvectorbasics-before-qcache/45867998#45867998", "title": "Creating Graphics Tiles Using QVector(Basics Before QCache)", "body": "<p>Using pointers and tears    </p>\n\n<pre><code>int count;\nQGraphicsScene *scene = new QGraphicsScene(0, 0, 150*4, 150*4);\nQVector&lt;QBitmap*&gt; BitmapArrayTiles;\nQVector&lt;QGraphicsPixmapItem*&gt; BitmapItemsArray;\nQGraphicsPixmapItem* CurrentItem;\nQBitmap *CurrentBitmap;\nconst QBitmap* CurrentBitmapConstPointer = CurrentBitmap;\n\nfor(count = 0; count &lt; 4; count++)\n{\n    CurrentBitmap = new QBitmap(150,150);\n    QPainter Painter(CurrentBitmap);\n    QPen Pen(Qt::black); // just to be explicit\n    Painter.setPen(Pen);\n    drawStuff(Painter);\n    BitmapArrayTiles.insert(count, CurrentBitmap);\n    CurrentItem = new QGraphicsPixmapItem(*BitmapArrayTiles[count]);\n    BitmapItemsArray.insert(count, CurrentItem);\n    //PixmapItemsArray.insert(count, currentItem);\n    scene-&gt;addItem(BitmapItemsArray[count]);\n    BitmapItemsArray[count]-&gt;setPos((count*150)+150, (count*150)+150);\n}\n\nui-&gt;TileView-&gt;setScene(scene);\n</code></pre>\n"}], "owner": {"reputation": 522, "user_id": 8304478, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6ed0a9fc607629b57235f0556f000fe7?s=128&d=identicon&r=PG&f=1", "display_name": "CrippledTable", "link": "https://stackoverflow.com/users/8304478/crippledtable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503602600, "creation_date": 1503522910, "last_edit_date": 1503596982, "question_id": 45849392, "link": "https://stackoverflow.com/questions/45849392/creating-graphics-tiles-using-qvectorbasics-before-qcache", "title": "Creating Graphics Tiles Using QVector(Basics Before QCache)", "body": "<p>I am trying to upgrade my Seismic Graph Viewer to use tile graphics rendering. I am very unfamiliar with the process but my attempt to create a simple example is below. The reason why I need to use either QVector or QCache(I'm using QVector right now for simplicity) is to save ram and the tiles needed to be created on the fly. I'm not entirely sure if you're able to do what I'm trying to do below, but essentially it creates an array of bitmaps, makes them items, and then tries to add them to the scene. There are twelve errors when this program compiles, none of which directly refer the code that I made in the mainWindow.cpp.</p>\n\n<p>the errors are either this</p>\n\n<blockquote>\n  <p>C:\\Qt\\Qt5.9.1\\5.9.1\\mingw53_32\\include\\QtCore\\qvector.h:713: error:\n  use of deleted function 'QGraphicsPixmapItem&amp;\n  QGraphicsPixmapItem::operator=(const QGraphicsPixmapItem&amp;)' with the\n  only thing changing being the location of the error (different header\n  files)</p>\n</blockquote>\n\n<p>or this</p>\n\n<blockquote>\n  <p>C:\\Qt\\Qt5.9.1\\5.9.1\\mingw53_32\\include\\QtWidgets\\qgraphicsitem.h:861:\n  error: 'QGraphicsPixmapItem::QGraphicsPixmapItem(const\n  QGraphicsPixmapItem&amp;)' is private Q_DISABLE_COPY(QGraphicsPixmapItem)\n  which is in the qgraphicsitem.h header file</p>\n</blockquote>\n\n<p>The code that produces doesn't compile due to these errors popping up in the header files</p>\n\n<pre><code>int count;\nQVector&lt;QBitmap&gt; BitmapArrayTiles;\nQVector&lt;QGraphicsPixmapItem&gt; PixmapItemsArray;\nQGraphicsPixmapItem currentItem;\nQBitmap currentBitmap;\nQGraphicsScene *scene = new QGraphicsScene();\n\nfor(count = 0; count &lt; 4; count++)\n{\ncurrentBitmap = QBitmap(150,150);\nQPainter Painter(&amp;currentBitmap);\nQPen Pen(Qt::black); // just to be explicit\nPainter.setPen(Pen);\ndrawStuff(Painter);\nBitmapArrayTiles.insert(0, currentBitmap);\ncurrentItem.setPixmap(BitmapArrayTiles[count]);\nPixmapItemsArray.insert(count, currentItem);\nscene-&gt;addItem(&amp;currentItem);\ncurrentItem.mapToScene((count*150)+150, (count*150)+150);\n}\nui-&gt;TileView-&gt;setScene(scene);\n            ^\n</code></pre>\n\n<p>I have not changed the header files manually so I'm not entirely sure why I would be getting these errors.</p>\n"}, {"tags": ["c++", "boost-spirit"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 1, "creation_date": 1503522786, "post_id": 45849276, "comment_id": 78656894, "body": "The <code>%</code> parser is defined as: &quot;List. Parse a delimited b one or more times&quot;. IIRC, you can simply mark the list as optional, and it&#39;ll do what you want : <code>&quot;[&quot; &gt;&gt; -(listRule % &quot;,&quot;) &gt;&gt; &quot;]&quot;;</code>"}, {"owner": {"reputation": 230, "user_id": 1229582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d33f03ad5a363de9f0b955c74bbcface?s=128&d=identicon&r=PG", "display_name": "matpen", "link": "https://stackoverflow.com/users/1229582/matpen"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1503523787, "post_id": 45849276, "comment_id": 78657305, "body": "Uhmm.. nope, does not seem to work. In that case (and with all combinations in both <code>listRule</code> and <code>list2Rule</code> I get a list of vectors, each with only one value..."}], "answers": [{"comments": [{"owner": {"reputation": 230, "user_id": 1229582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d33f03ad5a363de9f0b955c74bbcface?s=128&d=identicon&r=PG", "display_name": "matpen", "link": "https://stackoverflow.com/users/1229582/matpen"}, "edited": false, "score": 0, "creation_date": 1503561151, "post_id": 45850176, "comment_id": 78669693, "body": "Thank you for your answer. However, this is not the output that I was expecting... see my modified question."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 230, "user_id": 1229582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d33f03ad5a363de9f0b955c74bbcface?s=128&d=identicon&r=PG", "display_name": "matpen", "link": "https://stackoverflow.com/users/1229582/matpen"}, "edited": false, "score": 0, "creation_date": 1503561818, "post_id": 45850176, "comment_id": 78670159, "body": "Damn. I should pay more attention to the output next time. Obviously, that&#39;s not right :)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 230, "user_id": 1229582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d33f03ad5a363de9f0b955c74bbcface?s=128&d=identicon&r=PG", "display_name": "matpen", "link": "https://stackoverflow.com/users/1229582/matpen"}, "edited": false, "score": 0, "creation_date": 1503561896, "post_id": 45850176, "comment_id": 78670213, "body": "Fixed. The problem is too much attribute compatibility magic for this case :)"}, {"owner": {"reputation": 230, "user_id": 1229582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d33f03ad5a363de9f0b955c74bbcface?s=128&d=identicon&r=PG", "display_name": "matpen", "link": "https://stackoverflow.com/users/1229582/matpen"}, "edited": false, "score": 1, "creation_date": 1503562511, "post_id": 45850176, "comment_id": 78670596, "body": "Yes, that works perfectly! So there where three points missing: (a) using <code>auto</code> with rules is undefined behavior, (b) a parser can be made optional with <code>-</code> and (c) each rule can have its own attribute type based on how its parser actually works. Thanks a lot!"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1503561869, "last_edit_date": 1503561869, "creation_date": 1503527045, "answer_id": 45850176, "question_id": 45849276, "link": "https://stackoverflow.com/questions/45849276/parsing-nested-lists-with-boost-spirit/45850176#45850176", "title": "Parsing nested lists with Boost.Spirit", "body": "<p>You're using <code>auto</code> for proto expression templates in the Qi domain - that's undefined behaviour 99.9% of the time:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/26410498/undefined-behaviour-somewhere-in-boostspiritqiphrase-parse\">undefined behaviour somewhere in boost::spirit::qi::phrase_parse</a></li>\n</ul>\n\n<p>Now, while you fix that, also make the list body optional:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/ba55dc7a046ee14d\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/spirit/include/qi.hpp&gt;\nnamespace qi = boost::spirit::qi;\n\nint main() {\n    using It      = std::string::const_iterator;\n    using Skipper = qi::space_type;\n\n    for(std::string const input : { \"[[\\t1 , 2 ], [3, 4, 65.4]]\", \"[[\\t1 , 2 ], [3, 4, 65.4], []]\", \"[]\" })\n    {\n        std::cout &lt;&lt; \" ---- '\" &lt;&lt; input &lt;&lt; \"' ----\\n\";\n        auto it = input.begin();\n\n        //parse the string\n        using doubles = std::vector&lt;double&gt;;\n        using vectors = std::vector&lt;doubles&gt;;\n\n        qi::rule&lt;It, doubles(), Skipper&gt; doubles_ = \"[\" &gt;&gt; -(qi::double_ % \",\") &gt;&gt; \"]\";\n        qi::rule&lt;It, vectors(), Skipper&gt; vectors_ = \"[\" &gt;&gt; -(doubles_    % \",\") &gt;&gt; \"]\";\n\n        vectors data;\n        bool match = qi::phrase_parse(it, input.end(), vectors_, qi::space, data);\n\n        //check if we have a match\n        std::cout &lt;&lt; \"matched: \" &lt;&lt; std::boolalpha &lt;&lt; match &lt;&lt; '\\n';\n        if (it != input.end())\n            std::cout &lt;&lt; \"unmatched part: \" &lt;&lt; std::string{it, input.end()} &lt;&lt; '\\n';\n\n        //print the result\n        std::cout &lt;&lt; \"result\\n\";\n        for (const auto&amp; v : data) {\n            std::cout &lt;&lt; \"[\";\n            for (double i : v)\n                std::cout &lt;&lt; i &lt;&lt; \",\";\n            std::cout &lt;&lt; \"]\\n\";\n        }\n    }\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code> ---- '[[   1 , 2 ], [3, 4, 65.4]]' ----\nmatched: true\nresult\n[1,2,]\n[3,4,65.4,]\n ---- '[[   1 , 2 ], [3, 4, 65.4], []]' ----\nmatched: true\nresult\n[1,2,]\n[3,4,65.4,]\n[]\n ---- '[]' ----\nmatched: true\nresult\n</code></pre>\n"}], "owner": {"reputation": 230, "user_id": 1229582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d33f03ad5a363de9f0b955c74bbcface?s=128&d=identicon&r=PG", "display_name": "matpen", "link": "https://stackoverflow.com/users/1229582/matpen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 45850176, "answer_count": 1, "score": 1, "last_activity_date": 1503561869, "creation_date": 1503522411, "last_edit_date": 1503561063, "question_id": 45849276, "link": "https://stackoverflow.com/questions/45849276/parsing-nested-lists-with-boost-spirit", "title": "Parsing nested lists with Boost.Spirit", "body": "<p>I am trying to parse nested lists of numbers with Boost.Spirit. This is what I have so far:</p>\n\n<pre><code>//define a test string\nstd::string string = \"[[\\t1 , 2 ], [3, 4, 65.4]]\";\nauto it = string.begin();\n\n//parse the string\nstd::vector&lt;std::vector&lt;double&gt;&gt; vector;\nauto listRule = \"[\" &gt;&gt; (qi::double_ % \",\") &gt;&gt; \"]\";\nauto list2Rule = \"[\" &gt;&gt; (listRule % \",\") &gt;&gt; \"]\";\nbool match = qi::phrase_parse(it, string.end(), list2Rule, ascii::space, vector);\n\n//check if we have a match\nstd::cout &lt;&lt; \"matched: \" &lt;&lt; std::boolalpha &lt;&lt; match &lt;&lt; '\\n';\nif (it != string.end())\n    std::cout &lt;&lt; \"unmatched part: \" &lt;&lt; std::string{it, string.end()} &lt;&lt; '\\n';\n\n//print the result\nstd::cout &lt;&lt; \"result\\n\";\nfor (const auto&amp; v : vector) {\n    std::cout &lt;&lt; \"[\";\n    for (double i : v)\n        std::cout &lt;&lt; i &lt;&lt; \",\";\n    std::cout &lt;&lt; \"]\\n\";\n}\n</code></pre>\n\n<p>The above works wonderfully and prints: </p>\n\n<pre><code>matched: true\nresult\n[1,2,]\n[3,4,65.4,]\n</code></pre>\n\n<p>The problem I am facing is that it does not accept <em>empty</em> lists. For example, by changing the string like so:</p>\n\n<pre><code>std::string string = \"[[\\t1 , 2 ], [3, 4, 65.4], []]\";\n</code></pre>\n\n<p>Then I have no match (that is <code>match == false</code> and <code>it == string.begin()</code>). The vector still gets populated, apparently, but the last empty list is missing. Can anyone provide an explanation on why this is the case, and how to fix it?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 1, "creation_date": 1503521946, "post_id": 45849146, "comment_id": 78656527, "body": "Please before posting a question check whether it already exists or not otherwise by time you&#39;ll get blocked from posting."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1503522036, "post_id": 45849146, "comment_id": 78656563, "body": "<i>&quot;... and I believe, I have to be strong with pointers to code in c++ and make efficient programs.&quot;</i> No that&#39;s the completely wrong attitude to approach c++. You shouldn&#39;t deal with raw pointers or raw arrays in 1st place. There&#39;s c++ standard library support with <code>std::array</code> and <code>std::vector</code>."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1503522053, "post_id": 45849146, "comment_id": 78656569, "body": "Being &quot;strong with pointers&quot; is <b>a lot</b> less important than beginners seem to think, at least in this millennium."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1503522154, "post_id": 45849146, "comment_id": 78656617, "body": "@Baum It&#39;s what their stupid teachers/professors want to see. I&#39;m really pissed off to finance these people with my taxes paid."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503522358, "post_id": 45849146, "comment_id": 78656703, "body": "Went with Unclear already, but <a href=\"https://stackoverflow.com/q/4810664/3002139\">this</a> may be a good dupe target."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503524583, "post_id": 45849146, "comment_id": 78657624, "body": "<i>I have to be strong with pointers to code in c++ and make efficient programs.</i> -- In a lot of situations, using pointers too much causes the compiler&#39;s optimizer to skip your code.  Thus the result is slower programs by overusing pointers, not more efficient ones."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 2641850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed65133dd53cd345c0d33c6e3608d49e?s=128&d=identicon&r=PG", "display_name": "AmithRc", "link": "https://stackoverflow.com/users/2641850/amithrc"}, "edited": false, "score": 0, "creation_date": 1503591293, "post_id": 45849344, "comment_id": 78691423, "body": "Thank you, this is clear now. I have another question for you"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 59, "user_id": 2641850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed65133dd53cd345c0d33c6e3608d49e?s=128&d=identicon&r=PG", "display_name": "AmithRc", "link": "https://stackoverflow.com/users/2641850/amithrc"}, "edited": false, "score": 0, "creation_date": 1503592906, "post_id": 45849344, "comment_id": 78692410, "body": "@AmithRc If you have another question ask another question."}], "tags": [], "owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "is_accepted": true, "score": 1, "last_activity_date": 1503522685, "creation_date": 1503522685, "answer_id": 45849344, "question_id": 45849146, "link": "https://stackoverflow.com/questions/45849146/pointers-with-c/45849344#45849344", "title": "Pointers with c++", "body": "<blockquote>\n  <p>Literally i can use <code>a[i]</code> or <code>p1[i]</code>?</p>\n</blockquote>\n\n<p>Yes, dereferencing works the same way for a raw array symbol or a pointer.</p>\n\n<p>The <code>a</code> symbol  in your example will decay to a <code>int*</code> pointer whenever used as such (<code>p1=a;</code>).</p>\n\n<p>Using code like <code>p1[i]</code> is just syntactic sugar for <code>*(p1 +i)</code>.</p>\n"}], "owner": {"reputation": 59, "user_id": 2641850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed65133dd53cd345c0d33c6e3608d49e?s=128&d=identicon&r=PG", "display_name": "AmithRc", "link": "https://stackoverflow.com/users/2641850/amithrc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1503529222, "accepted_answer_id": 45849344, "answer_count": 1, "score": -7, "last_activity_date": 1503522685, "creation_date": 1503521820, "last_edit_date": 1503521891, "question_id": 45849146, "link": "https://stackoverflow.com/questions/45849146/pointers-with-c", "closed_reason": "Duplicate", "title": "Pointers with c++", "body": "<pre><code>int main()\n{\n\n    int x=5,y=5;\n    int sum = add(&amp;x,&amp;y);\n\n    cout&lt;&lt;\"Address of x is\"&lt;&lt;&amp;x&lt;&lt;endl;\n    cout&lt;&lt;\"Address of y is\"&lt;&lt;&amp;y&lt;&lt;endl;\n    cout&lt;&lt;\"The addition of a and b is\"&lt;&lt;sum&lt;&lt;endl;\n\n    int a[5]={1,2,3,4,5};\n    int *p1;\n    p1=a;\n\n    for(int i=0;i&lt;5;i++)\n    {\n        cout&lt;&lt;\"The Address of the Array elements is\"&lt;&lt;p1+i&lt;&lt;endl;\n        cout&lt;&lt;\"The value of the array element is\"&lt;&lt;*(p1+i)&lt;&lt;endl;\n    }\n    cout&lt;&lt;endl;\n    cout&lt;&lt;endl;\n    for(int i=0;i&lt;5;i++)\n        {\n            cout&lt;&lt;\"The Address of the Array elements is\"&lt;&lt;&amp;p1[i]&lt;&lt;endl;\n            cout&lt;&lt;\"The value of the array element is\"&lt;&lt;p1[i]&lt;&lt;endl;\n        }\n\n    cout&lt;&lt;\"address of a is \"&lt;&lt;p1&lt;&lt;endl;\n    int arrayTotal= SumofArray(a,5);\n    cout&lt;&lt;\"The sum of array is\"&lt;&lt;arrayTotal &lt;&lt;endl;\n}\n</code></pre>\n\n<p>I started to learn to code and I believe, I have to be strong with pointers to code in c++ and make efficient programs.</p>\n\n<p>when we assign p1=a;</p>\n\n<p>Literally i can use a[i] or p[i]? I am confused between this difference. The above snippet works tho I am curious if some one can explain in detail.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "node.js", "binary", "node-gyp"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503521613, "post_id": 45849078, "comment_id": 78656391, "body": "Is your binary data printable?  A lot of <i>binary</i> data values are not printable."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503521749, "post_id": 45849078, "comment_id": 78656453, "body": "Like @Thomas said, how does your <i>binary data</i> look like? Do you use some encoding?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1503521779, "post_id": 45849078, "comment_id": 78656460, "body": "You should <i>write</i> content of this buffer to the file instead of <i>printing</i> it."}, {"owner": {"reputation": 11, "user_id": 8508367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdaf2ef0932d0b81bf4ec69481c83621?s=128&d=identicon&r=PG&f=1", "display_name": "jmahecha", "link": "https://stackoverflow.com/users/8508367/jmahecha"}, "edited": false, "score": 0, "creation_date": 1503522341, "post_id": 45849078, "comment_id": 78656693, "body": "I read the binary data from a binary file  with this code: <code>char c;    std::string content=&quot;&quot;;    while (file.get(c)){     content+=c;    }</code>  I need to pass the content of the file to node, is there any other way to do that?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1503522693, "post_id": 45849078, "comment_id": 78656852, "body": "You should open file in binary mode and read entire file content using <a href=\"http://en.cppreference.com/w/cpp/io/basic_istream/read\" rel=\"nofollow noreferrer\"><code>read</code></a> method. Though you can do this in node itself."}, {"owner": {"reputation": 11, "user_id": 8508367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdaf2ef0932d0b81bf4ec69481c83621?s=128&d=identicon&r=PG&f=1", "display_name": "jmahecha", "link": "https://stackoverflow.com/users/8508367/jmahecha"}, "edited": false, "score": 0, "creation_date": 1503523058, "post_id": 45849078, "comment_id": 78657002, "body": "The library I&#39;m using creates the binary file from a json file with some specifications, but I need to pass the content of the file to node instead of saving it from c++. The idea is to use the content of the file later in a larger aplication."}, {"owner": {"reputation": 5242, "user_id": 2976093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jJoEz.png?s=128&g=1", "display_name": "EMX", "link": "https://stackoverflow.com/users/2976093/emx"}, "edited": false, "score": 0, "creation_date": 1503700121, "post_id": 45849078, "comment_id": 78739875, "body": "@jmahecha have you looked into redis?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8508367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdaf2ef0932d0b81bf4ec69481c83621?s=128&d=identicon&r=PG&f=1", "display_name": "jmahecha", "link": "https://stackoverflow.com/users/8508367/jmahecha"}, "edited": false, "score": 0, "creation_date": 1503524027, "post_id": 45849554, "comment_id": 78657389, "body": "Do you think that passing the buffer from the binary file is a bad idea? Do you think is better to save the file to disk in c++ and read it from node that try to pass the content?"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 11, "user_id": 8508367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdaf2ef0932d0b81bf4ec69481c83621?s=128&d=identicon&r=PG&f=1", "display_name": "jmahecha", "link": "https://stackoverflow.com/users/8508367/jmahecha"}, "edited": false, "score": 0, "creation_date": 1503524165, "post_id": 45849554, "comment_id": 78657444, "body": "Your Node program and your C++ programs are two different processes, running in two different address spaces, aren&#39;t they?  If so, then &quot;yes&quot;, a disk file is a good choice.  Other <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">IPC</a> choices besides &quot;files&quot; might include &quot;sockets&quot; and/or &quot;pipes&quot;."}, {"owner": {"reputation": 11, "user_id": 8508367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdaf2ef0932d0b81bf4ec69481c83621?s=128&d=identicon&r=PG&f=1", "display_name": "jmahecha", "link": "https://stackoverflow.com/users/8508367/jmahecha"}, "edited": false, "score": 0, "creation_date": 1503524422, "post_id": 45849554, "comment_id": 78657556, "body": "The node-gyp library <a href=\"https://github.com/nodejs/node-gyp\" rel=\"nofollow noreferrer\">github.com/nodejs/node-gyp</a> that build bundles for node js with othe code for example c++"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 11, "user_id": 8508367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdaf2ef0932d0b81bf4ec69481c83621?s=128&d=identicon&r=PG&f=1", "display_name": "jmahecha", "link": "https://stackoverflow.com/users/8508367/jmahecha"}, "edited": false, "score": 0, "creation_date": 1503525015, "post_id": 45849554, "comment_id": 78657819, "body": "Fair enough: Writing a Node Add-on in C++ is also a viable alternative.  Please read my post above, and read (and try the sample code) at this link: <a href=\"https://community.risingstack.com/using-buffers-node-js-c-plus-plus/\" rel=\"nofollow noreferrer\">Scott Frees: Using Buffers to share data between Node.js and C++</a>"}, {"owner": {"reputation": 11, "user_id": 8508367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdaf2ef0932d0b81bf4ec69481c83621?s=128&d=identicon&r=PG&f=1", "display_name": "jmahecha", "link": "https://stackoverflow.com/users/8508367/jmahecha"}, "edited": false, "score": 0, "creation_date": 1504207790, "post_id": 45849554, "comment_id": 78937800, "body": "I check out you post and base on that I&#39;m working on a example to pass a buffer using this code: <code>info.GetReturnValue().Set(Nan::NewBuffer(&amp;buffer[0], size).ToLocalChecked());</code> I get data from node, but is not the same that in c++, maybe is because is binary data, I don&#39;t know is using this the data is transform o alter in some way. have you try ti use buffer with binary data?"}], "tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": false, "score": 1, "last_activity_date": 1503524927, "last_edit_date": 1503524927, "creation_date": 1503523710, "answer_id": 45849554, "question_id": 45849078, "link": "https://stackoverflow.com/questions/45849078/pass-binary-string-file-content-from-c-to-node-js/45849554#45849554", "title": "Pass Binary string/file content from c++ to node js", "body": "<ol>\n<li><p>Probably the best approach is to write your data to a binary disk file.  Write to disk in C++; read from disk in NodeJS.</p></li>\n<li><p>Very importantly, make sure you specify <em>BINARY MODE</em>.</p>\n\n<p>For example:</p>\n\n<p><code>myFile.open (\"data2.bin\", ios::out | ios::binary);</code></p></li>\n<li><p>Do not use \"strings\" (at least not unless you want to uuencode).  Use buffers.  Here is a good example:</p></li>\n</ol>\n\n<p><a href=\"https://stackoverflow.com/questions/5784621/how-to-read-binary-files-byte-by-byte-in-node-js\">How to read binary files byte by byte in Node.js</a></p>\n\n<pre><code>var fs = require('fs');\n\nfs.open('file.txt', 'r', function(status, fd) {\n    if (status) {\n        console.log(status.message);\n        return;\n    }\n    var buffer = new Buffer(100);\n    fs.read(fd, buffer, 0, 100, 0, function(err, num) {\n        ...\n    });\n});\n</code></pre>\n\n<ol start=\"4\">\n<li><p>You might also find these links helpful:</p>\n\n<ul>\n<li><p><a href=\"https://nodejs.org/api/buffer.html\" rel=\"nofollow noreferrer\">https://nodejs.org/api/buffer.html</a>\n&lt;= Has good examples for specific Node APIs</p></li>\n<li><p><a href=\"http://blog.paracode.com/2013/04/24/parsing-binary-data-with-node-dot-js/\" rel=\"nofollow noreferrer\">http://blog.paracode.com/2013/04/24/parsing-binary-data-with-node-dot-js/</a>\n&lt;= Good discussion of some of the issues you might face, including \"endianness\" and \"interpreting numbers\"</p></li>\n</ul></li>\n</ol>\n\n<p>ADDENDUM:</p>\n\n<ul>\n<li><p>The OP clarified that he's considering using C++ as a <em>NodeJS Add-On</em> (not a standalone C++ program.</p></li>\n<li><p>Consequently, using buffers is definitely an option.  Here is a good tutorial:</p></li>\n</ul>\n\n<p><a href=\"https://community.risingstack.com/using-buffers-node-js-c-plus-plus/\" rel=\"nofollow noreferrer\">https://community.risingstack.com/using-buffers-node-js-c-plus-plus/</a></p>\n\n<p>If you choose to go this route, I would DEFINITELY download the example code and play with it first, before implementing buffers in your own application.</p>\n"}, {"tags": [], "owner": {"reputation": 5242, "user_id": 2976093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jJoEz.png?s=128&g=1", "display_name": "EMX", "link": "https://stackoverflow.com/users/2976093/emx"}, "is_accepted": false, "score": 0, "last_activity_date": 1503525050, "creation_date": 1503525050, "answer_id": 45849827, "question_id": 45849078, "link": "https://stackoverflow.com/questions/45849078/pass-binary-string-file-content-from-c-to-node-js/45849827#45849827", "title": "Pass Binary string/file content from c++ to node js", "body": "<p>It depends but for example using redis</p>\n\n<blockquote>\n  <p>Values can be strings (including binary data) of every kind, for\n  instance you can store a jpeg image inside a value. A value can't be\n  bigger than 512 MB.</p>\n</blockquote>\n\n<p>If the file is bigger than 512MB, then you can store it in chunks.\nBut I wouldnt suggest since this is an <strong>in-memory data store</strong></p>\n\n<p>Its easy to implement in both c++ and node.js</p>\n"}], "owner": {"reputation": 11, "user_id": 8508367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdaf2ef0932d0b81bf4ec69481c83621?s=128&d=identicon&r=PG&f=1", "display_name": "jmahecha", "link": "https://stackoverflow.com/users/8508367/jmahecha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1503525050, "creation_date": 1503521519, "last_edit_date": 1503523304, "question_id": 45849078, "link": "https://stackoverflow.com/questions/45849078/pass-binary-string-file-content-from-c-to-node-js", "title": "Pass Binary string/file content from c++ to node js", "body": "<p>I'm trying to pass the content of a binary file from c++ to node using the node-gyp library. I have a process that creates a binary file using the .fit format and I need to pass the content of the file to js to process it. So, my first aproach was to extract the content of the file in a string and try to pass it to node like this.</p>\n\n<pre><code>   char c;\n   std::string content=\"\";\n   while (file.get(c)){\n    content+=c;\n   }\n</code></pre>\n\n<p>I'm using the following code to pass it to Node</p>\n\n<pre><code>v8::Local&lt;v8::ArrayBuffer&gt; ab = v8::ArrayBuffer::New(args.GetIsolate(), (void*)content.data(), content.size());\nargs.GetReturnValue().Set(ab);\n</code></pre>\n\n<p>In node a get an arrayBuffer but when I print the content to a file it is different to the one that show a c++ cout.</p>\n\n<p>How can I pass the binary data succesfully?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "opengl", "matrix", "glm-math", "coordinate-transformation"], "comments": [{"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 2, "creation_date": 1503521731, "post_id": 45848967, "comment_id": 78656438, "body": "Most comprehensible would be: <code>glm::mat4 m4;</code> <code>glm::mat3 m3( m4[0][0], m4[0][1], 0.0f, m4[1][0], m4[1][1], 0.0f, m4[3][0], m4[3][1], 1.0f );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2481, "user_id": 3606192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5f2597f776eb2f658ef6f63dac2259ec?s=128&d=identicon&r=PG&f=1", "display_name": "RafazZ", "link": "https://stackoverflow.com/users/3606192/rafazz"}, "edited": false, "score": 0, "creation_date": 1503620417, "post_id": 45854314, "comment_id": 78704210, "body": "That&#39;s pretty much what I am doing right now -- is there a way of constructing a matrix using submatrices/rows/columns combination. Generally I am looking for a readable one-liner :)"}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "reply_to_user": {"reputation": 2481, "user_id": 3606192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5f2597f776eb2f658ef6f63dac2259ec?s=128&d=identicon&r=PG&f=1", "display_name": "RafazZ", "link": "https://stackoverflow.com/users/3606192/rafazz"}, "edited": false, "score": 1, "creation_date": 1503642031, "post_id": 45854314, "comment_id": 78709197, "body": "@RafazZ Commonly a readable one liner is a well named function"}], "tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 3, "last_activity_date": 1503664520, "last_edit_date": 1503664520, "creation_date": 1503555688, "answer_id": 45854314, "question_id": 45848967, "link": "https://stackoverflow.com/questions/45848967/converting-3d-transformation-to-2d/45854314#45854314", "title": "Converting 3D transformation to 2D", "body": "<p>The most comprehensible and probably the best performing way is to write a inline method or function and to use directly the constructor of <code>glm::mat3</code>:</p>\n\n<pre><code>glm::mat3 Mat3Dto2D( const glm::mat4 &amp; m )\n{\n    return glm::mat3(\n        m[0][0], m[0][1], 0.0f,\n        m[1][0], m[1][1], 0.0f,\n        m[3][0], m[3][1], 1.0f\n    );\n}\n</code></pre>\n"}], "owner": {"reputation": 2481, "user_id": 3606192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5f2597f776eb2f658ef6f63dac2259ec?s=128&d=identicon&r=PG&f=1", "display_name": "RafazZ", "link": "https://stackoverflow.com/users/3606192/rafazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 45854314, "answer_count": 1, "score": 1, "last_activity_date": 1570892966, "creation_date": 1503521017, "last_edit_date": 1570892966, "question_id": 45848967, "link": "https://stackoverflow.com/questions/45848967/converting-3d-transformation-to-2d", "title": "Converting 3D transformation to 2D", "body": "<p>I am trying to figure out a way of converting a 3D transformation matrix to 2D in OpenGL. My z-coordinates are ignored (I am working with ground projections). </p>\n\n<p>Here is an example of what I am trying to achieve:</p>\n\n<pre><code>// Given a transformation matrix\n// | r00 r01 r01 t0 |\n// | r10 r11 r11 t1 |\n// | r20 r21 r21 t2 |\n// | 0.  0.  0.  1. |\n//\n// Ignore the z-coordinate, and convert it to\n// | r00 r01 t0 |\n// | r10 r11 t1 |\n// | 0.  0.  1. |\nglm::dmat4 t_matrix_3D = GetTransformation();\nglm::dmat3 t_matrix_2D = glm::dmat3(t_matrix_3D);\nt_matrix_2D[2] = dvec3(dvec2(t_matrix_3D[3]), 1.);\nt_matrix_2D[0][2] = 0.;\nt_matrix_2D[1][2] = 0.;\n</code></pre>\n\n<p>The question is if there is a prettier way of doing it? Maybe using matrix slicing, or sub matrix extraction?</p>\n"}, {"tags": ["c++", "algorithm", "c++11", "d"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1503520969, "post_id": 45848930, "comment_id": 78656072, "body": "Did you compile with optimizations on?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1503521126, "post_id": 45848930, "comment_id": 78656149, "body": "It&#39;s possible that the site has different time limits for C++ and D."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1503521220, "post_id": 45848930, "comment_id": 78656195, "body": "Looks like you&#39;ll need to perform some profiling to see where the bottlenecks are in the C++ code."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 1, "creation_date": 1503521428, "post_id": 45848930, "comment_id": 78656301, "body": "@Mandy - for c++: <code>edges.reserve(M)</code> before <code>for(...</code>? And <code>edges.emplace_back()</code> instead of <code>edges.push_back()</code>?"}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 1, "creation_date": 1503521509, "post_id": 45848930, "comment_id": 78656340, "body": "why are your snippets so different? different flow of logic? different names? makes it hard to compare why one would be faster than the other..."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503521592, "post_id": 45848930, "comment_id": 78656383, "body": "I would downvote just on that we have no idea which compiler was used, what optimaztions were used, etc (all requirements if we&#39;re going to compare speed of a program)."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 1, "creation_date": 1503521614, "post_id": 45848930, "comment_id": 78656392, "body": "@Mandy - important for c++: the signature for <code>inc()</code> should be <code>bool inc(Edge const &amp; a, Edge const &amp; b)</code>; this can avoid a lot of unuseful copies."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1503521968, "post_id": 45848930, "comment_id": 78656536, "body": "<code>for(auto edge : edges){</code> also creates copies."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1503522149, "post_id": 45848930, "comment_id": 78656616, "body": "Instead of taking solutions written for one language, you should carefully inspect what you&#39;re doing.  For example, your <code>find</code> function is recursive, and with all of that data, potentially blowing out the call stack.  You should rewrite this to be iterative -- not only will you save on stack space, the unwinding of the stack also won&#39;t be done."}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1503522133, "post_id": 45849105, "comment_id": 78656607, "body": "I doubt this would make so big difference"}], "tags": [], "owner": {"reputation": 236, "user_id": 422345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7611d8abfb432aa4e1092ecfd93e3466?s=128&d=identicon&r=PG", "display_name": "Phil Dennis", "link": "https://stackoverflow.com/users/422345/phil-dennis"}, "is_accepted": false, "score": 1, "last_activity_date": 1503521620, "creation_date": 1503521620, "answer_id": 45849105, "question_id": 45848930, "link": "https://stackoverflow.com/questions/45848930/d-lang-being-faster-than-c/45849105#45849105", "title": "D-lang being faster than C++?", "body": "<p>One possible contributor to the slow performance of the C++ version is the 'inc' function. It receives 2 'Edge' structs by value, which in C++ will mean copying of the structs for every comparison during the sort call towards the end of main().</p>\n\n<p>Try changing the signature of 'inc' to accept 'const Edge&amp;' instead of 'Edge'. This will cause the struct values to be passed by reference and so avoid the extra copying.</p>\n\n<p>Also, if you run a profiler you should be able to find where the majority of the time is being spent. This is the 'right' way to approach optimization: measure to find where you have a performance bottleneck, address the bottleneck and measure again to confirm you have indeed improved the performance.</p>\n"}, {"comments": [{"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1503635606, "post_id": 45849278, "comment_id": 78707403, "body": "(Making previous results available for reuse should most probably read <i>cache</i>.)"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": 7, "last_activity_date": 1503522422, "creation_date": 1503522422, "answer_id": 45849278, "question_id": 45848930, "link": "https://stackoverflow.com/questions/45848930/d-lang-being-faster-than-c/45849278#45849278", "title": "D-lang being faster than C++?", "body": "<p><code>find()</code> seems to be heavily used and they are very different in D and C++ implementations:</p>\n\n<pre><code>int find(int x) {\n    return ds[x] = (x == ds[x] ? x: find(ds[x]));\n}\n</code></pre>\n\n<p>vs:</p>\n\n<pre><code>long long find(long long node)\n{\n    if(parents[node] == node)return node;\n    else return find(parents[node]);\n}\n</code></pre>\n\n<p><code>find()</code> in D modifies array (looks like some kind of dynamic programming, were you cash previous result) while in C++ you always do full lookup. You should compare apples to apples, especially this code could be written exactly the same way in C++.</p>\n"}, {"tags": [], "owner": {"reputation": 236, "user_id": 422345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7611d8abfb432aa4e1092ecfd93e3466?s=128&d=identicon&r=PG", "display_name": "Phil Dennis", "link": "https://stackoverflow.com/users/422345/phil-dennis"}, "is_accepted": false, "score": 2, "last_activity_date": 1503524973, "creation_date": 1503524973, "answer_id": 45849817, "question_id": 45848930, "link": "https://stackoverflow.com/questions/45848930/d-lang-being-faster-than-c/45849817#45849817", "title": "D-lang being faster than C++?", "body": "<p>Out of curiosity, I tried running OPs code, and also the version below, which I created by minimally tweaking the 'D' code so that it would compile under C++. OPs C++ version took around 12 seconds to run. The version below took around 0.25 seconds to run.</p>\n\n<p>My conclusion, in answer to the question is that the difference in run time seen by the OP is likely due to differences in implementation as described in some of the other answers, as opposed to poor performance of C++.</p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\nstruct edge {\n    edge(int src, int des, int w, int o) : src(src), des(des), w(w), o(o) {}\n\n    int src, des, w, o;\n\n    int opCmp(const edge&amp; e) const {\n        if (w != e.w) return w - e.w;\n        else return o - e.o;\n    }\n};\n\nconst int MAXN = 100004, MAXM = 200004;\nint N, M, D, ee, weight, days;\nint ds[MAXN];\nstd::vector&lt;edge&gt; edges;\n\nvoid init() {\n    for (int i = 1; i &lt;= N; i++) ds[i] = i;\n}\n\nint find(int x) {\n    return ds[x] = (x == ds[x] ? x : find(ds[x]));\n}\n\nbool connected(int x, int y) {\n    return find(x) == find(y);\n}\n\nbool merge(int x, int y) {\n    int xr = find(x), yr = find(y);\n    if (xr ^ yr) {\n        ds[xr] = yr;\n        return 1;\n    }\n    return 0;\n}\n\nvoid main() {\n    std::scanf(\"%d%d%d\", &amp;N, &amp;M, &amp;D);\n    for (int i = 1, a, b, c; i &lt;= M; i++) {\n        scanf(\"%d%d%d\", &amp;a, &amp;b, &amp;c);\n        if (i &lt; N)\n            edges.push_back(edge(a, b, c, 0));\n        else\n            edges.push_back(edge(a, b, c, 1));\n    }\n    std::sort(edges.begin(), edges.end(), [](const edge&amp; lhs, const edge&amp; rhs) { return lhs.opCmp(rhs) &lt; 0; });\n    init();\n    int i, maxe = 0;\n    for (i = 0; i&lt;edges.size(); i++) {\n        auto e = edges[i];\n        if (merge(e.src, e.des)) {\n            if (e.o)\n                days++;\n        }\n    }\n    printf(\"%d\", days);\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8508252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/536bec8640495aa4f6d61857aafc52be?s=128&d=identicon&r=PG&f=1", "display_name": "Mandy", "link": "https://stackoverflow.com/users/8508252/mandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "closed_date": 1503549216, "accepted_answer_id": 45849278, "answer_count": 3, "score": -7, "last_activity_date": 1503610932, "creation_date": 1503520848, "last_edit_date": 1503610932, "question_id": 45848930, "link": "https://stackoverflow.com/questions/45848930/d-lang-being-faster-than-c", "closed_reason": "Needs details or clarity", "title": "D-lang being faster than C++?", "body": "<p>So I was practising for an upcoming programming contest on algorithms, and I stumbled upon a problem from the previous year.</p>\n\n<p>I pretty much solved it(in C++), but i was getting some timeouts, so i took a look at the official solution and it was written in Dlang.</p>\n\n<p>I then tried to imitate what the official answer did in D, but I was still getting timeouts( > 4 seconds on a single input). Afaik, C++ is supposed to be faster than D, but D solves the same input in a split second and C++ takes more than 5 seconds for it</p>\n\n<p>Here is the D answer code</p>\n\n<pre><code>import std.stdio;\nimport std.algorithm;\n\nstruct edge {\n    int src, des, w, o;\n\n    int opCmp (ref const edge e) const {\n        if(w != e.w) return w - e.w;\n        else return o - e.o;\n    }\n};\n\nconst int MAXN = 100004, MAXM = 200004;\nint N, M, D, ee, weight, days;\nint[MAXN] ds;\nedge[] edges;\n\nvoid init() {\n    for(int i=1;i&lt;=N;i++) ds[i] = i;\n}\n\nint find(int x) {\n    return ds[x] = (x == ds[x] ? x: find(ds[x]));\n}\n\nbool connected(int x, int y) {\n    return find(x) == find(y);\n}\n\nbool merge(int x, int y) {\n    int xr = find(x), yr = find(y);\n    if(xr ^ yr) {\n        ds[xr] = yr;\n        return 1;\n    }\n    return 0;\n}\n\nvoid main() {\n    scanf(\"%d%d%d\", &amp;N, &amp;M, &amp;D);\n    for(int i=1, a, b, c;i&lt;=M;i++) {\n        scanf(\"%d%d%d\", &amp;a, &amp;b, &amp;c);\n        if(i &lt; N)\n            edges ~= edge(a, b, c, 0);\n        else\n            edges ~= edge(a, b, c, 1);\n    }\n    edges.sort();\n    init();\n    int i, maxe=0;\n    for(i=0;i&lt;edges.length;i++) {\n        auto e = edges[i];\n        if(merge(e.src, e.des)) {\n            if(e.o)\n                days ++;\n        }\n    }\n    printf(\"%d\", days);\n}\n</code></pre>\n\n<p>And then here is what I wrote in C++ as the answer code</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;map&gt;\n#include &lt;algorithm&gt;\n\nusing namespace std;\n\nstruct Edge{\n    long long source, end, weight, old;\n    Edge(long long _s, long long _e, long long _w, long long _o):source(_s), end(_e), weight(_w), old(_o){}\n};\n\nint parents[100004];\nvector&lt;Edge&gt;edges;\n\nbool inc(Edge a, Edge b)\n{\n    if(a.weight == b.weight)return a.old &gt; b.old;\n    return a.weight &lt; b.weight;\n}\n\nlong long find(long long node)\n{\n    if(parents[node] == node)return node;\n    else return find(parents[node]);\n}\n\nvoid init(long long M)\n{\n    for(long long i = 0; i &lt; M; ++i)parents[i] = i;\n}\n\nbool connect(long long x, long long y)\n{\n    long long fx = find(x);\n    long long fy = find(y);\n    if(fx == fy)return false;\n    parents[fx] = fy;\n    return true;\n}\n\nlong long noOfDays()\n{\n    long long days = 0;\n    for(auto edge : edges){\n        if(connect(edge.source, edge.end)){\n            if(!edge.old)++days;\n        }\n    }\n    return days;\n}\n\nint main()\n{\n    ios::sync_with_stdio(false); \n    long long N, M , D;\n    cin &gt;&gt; N &gt;&gt; M &gt;&gt; D;\n    N--;\n    for(long long i = 0; i &lt; M; ++i){\n        long long a,b,c;\n        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n        if(i &lt; N){\n            edges.push_back(Edge(a,b,c,1));\n        }else{\n            edges.push_back(Edge(a,b,c,0));         \n        }\n    }\n    sort(edges.begin(), edges.end(), inc);\n    init(N+2);\n    cout &lt;&lt; noOfDays() &lt;&lt; endl;\n}\n</code></pre>\n\n<p>The input which takes more than 5 seconds on C++, and a split second on D can be found here \"<a href=\"http://ddl3.data.hu/get/356808/10699419/s4.24.in\" rel=\"nofollow noreferrer\">http://ddl3.data.hu/get/356808/10699419/s4.24.in</a>\"</p>\n\n<p>Here is the question I was actually trying to solve \"<a href=\"https://dmoj.ca/problem/ccc17s4\" rel=\"nofollow noreferrer\">https://dmoj.ca/problem/ccc17s4</a>\"(I am only doing the 11 point part).</p>\n\n<p>Is there any way I can make my C++ code as fast as the D code? and why exactly isn't my C++ code running as fast as the D code?</p>\n\n<hr>\n\n<p>EDIT: For all clarifications, g++ was used for the C++ without any optimizations, and 'dmd' for the Dlang, without any optimizations either</p>\n"}, {"tags": ["c++", "function-pointers", "reinterpret-cast"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1503520859, "post_id": 45848823, "comment_id": 78656018, "body": "You can definitely make it shorter by writing a proper extraction method doing most of the job, however completely getting rid of fancy casts probably is not possible."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1503520875, "post_id": 45848823, "comment_id": 78656025, "body": "Imagine there is a solution. How would the compiler know the return type of <code>function_map[key]()</code> without specifying it yourself? The return type of any function call must be known at compile time, but in that case, it would depend on the value of <code>key</code> and the state of <code>function_map</code> which are runtime informations. In this case, the key happens to be derived from a type name. It may be cleared if you change your example, for example by using an <code>enum</code> as the key instead."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1503520975, "post_id": 45848823, "comment_id": 78656078, "body": "Can you change function declarations or those are fixed? Otherwise you can reverse the approach and use always the same declaration. Casts are no longer required in this case."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1503521060, "post_id": 45848823, "comment_id": 78656111, "body": "@VTT I would be happy by just using <code>static_cast</code>. The thing is, <code>reinterpret_cast</code> are harder to maintain and catch errors. @Fran&#231;oisAndrieux unfortunatly, I cannot use an enum, I have an undefinite amount of user defined type."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1503521096, "post_id": 45848823, "comment_id": 78656127, "body": "I mean you can write a getter doing all the casts."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1503521196, "post_id": 45848823, "comment_id": 78656186, "body": "@skypjack I have full control over the declaration of the lambdas. However, I add the lambda in the list from a function template, where the type is defined by the user of this code."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1503521874, "post_id": 45848823, "comment_id": 78656499, "body": "@GuillaumeRacicot I mean, can&#39;t you do something along <a href=\"https://wandbox.org/permlink/E0dwP4GKD6yXaBbt\" rel=\"nofollow noreferrer\">this</a> line and then dispatch to the right function from within <code>S</code>?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1503522127, "post_id": 45848823, "comment_id": 78656604, "body": "@skypjack this is an interesting solution. It would work for any situation that only needs to do a particular action for the type used in the function, much like a visitor. In my case however I need to return the type to the user of my code. If there&#39;s no easy way to do this without reinterpret cast it&#39;s okay too. I will need to document the usage and the reason why."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1503522448, "post_id": 45848823, "comment_id": 78656745, "body": "@GuillaumeRacicot So, something like <a href=\"https://wandbox.org/permlink/Xyx4okTfbAMxAjh6\" rel=\"nofollow noreferrer\">this</a> would work? No <code>reinterpret_cast</code>, only <code>static_cast</code> as requested."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1503522788, "post_id": 45848823, "comment_id": 78656895, "body": "@skypjack that&#39;s interesting. I can already imagine many other similar solution."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 1, "creation_date": 1503522833, "post_id": 45848823, "comment_id": 78656910, "body": "@GuillaumeRacicot Yeah, probably <a href=\"https://wandbox.org/permlink/X4B6c3tXyoQrELtC\" rel=\"nofollow noreferrer\">this</a>. :-) ... Ok, I&#39;m putting it in an answer. Hope it can help you."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1503527178, "post_id": 45848823, "comment_id": 78658614, "body": "You can use Boost.Any (to be incorporated into C++17 as <code>std::any</code>) which uses type erasure and hides all the nasty low-level casting from you. It&#39;s also not that hard to write it yourself if you can&#39;t use Boost."}], "answers": [{"tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": true, "score": 1, "last_activity_date": 1503523017, "creation_date": 1503523017, "answer_id": 45849410, "question_id": 45848823, "link": "https://stackoverflow.com/questions/45848823/is-there-a-way-to-hold-many-type-of-pointer-to-function-without-reinterpret-cast/45849410#45849410", "title": "Is there a way to hold many type of pointer to function without reinterpret_cast?", "body": "<p>If you can rework a bit your functions, you could approach it by reversing the flow and removing the return type.<br>\nHere is an example of what I mean:</p>\n\n<pre><code>#include &lt;unordered_map&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename T&gt;\nvoid call(T t, void *ptr) {\n    *static_cast&lt;T *&gt;(ptr) = t;\n}\n\n// Simple type id system\ntemplate&lt;typename&gt; void type_id() {}\nusing type_id_t = void(*)();\n\n// value type of our map. We reinterpret functions pointer to this type\nusing held_type = void(*)(void *);\n\n// actual function type.\ntemplate&lt;typename T&gt;\nusing funct_type = T(*)();\n\nint main() {\n    std::unordered_map&lt;type_id_t, held_type&gt; function_map;\n\n    function_map.emplace(type_id&lt;int&gt;, +[](void *ptr){ return call(42, ptr); });\n    function_map.emplace(type_id&lt;double&gt;, +[](void *ptr) { call(9.4, ptr); });\n\n    // prints 42\n    int i;\n    function_map[type_id&lt;int&gt;](&amp;i);\n    std::cout &lt;&lt; i &lt;&lt; std::endl;\n\n    // prints 9.4\n    double d;\n    function_map[type_id&lt;double&gt;](&amp;d);\n    std::cout &lt;&lt; d &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>See it up and running on <a href=\"https://wandbox.org/permlink/X4B6c3tXyoQrELtC\" rel=\"nofollow noreferrer\">wandbox</a>.</p>\n\n<p>Probably you can use the type of the variable to pick the right specialization of <code>type_id</code> up when you query <code>function_map</code>. Just hide everything behind a function template.</p>\n"}], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 45849410, "answer_count": 1, "score": 1, "last_activity_date": 1503523017, "creation_date": 1503520414, "question_id": 45848823, "link": "https://stackoverflow.com/questions/45848823/is-there-a-way-to-hold-many-type-of-pointer-to-function-without-reinterpret-cast", "title": "Is there a way to hold many type of pointer to function without reinterpret_cast?", "body": "<p>I have some code that deal with many pointer to function of different signature. Here's a snippet:</p>\n\n<pre><code>#include &lt;unordered_map&gt;\n\n// Simple type id system\ntemplate&lt;typename&gt; void type_id(){}\nusing type_id_t = void(*)();\n\n// value type of our map. We reinterpret functions pointer to this type\nusing held_type = void(*)();\n\n// actual function type.\ntemplate&lt;typename T&gt;\nusing funct_type = T(*)();\n\nint main() {\n    std::unordered_map&lt;type_id_t, held_type&gt; function_map;\n\n    function_map.emplace(type_id&lt;int&gt;, reinterpret_cast&lt;held_type&gt;(\n        static_cast&lt;func_type&lt;int&gt;&gt;([]() -&gt; int { return 42; });\n    ));\n\n    function_map.emplace(type_id&lt;double&gt;, reinterpret_cast&lt;held_type&gt;(\n        static_cast&lt;func_type&lt;double&gt;&gt;([]() -&gt; double { return 9.4; });\n    ));\n\n    // later on\n\n    // prints 42\n    std::cout &lt;&lt; reinterpret_cast&lt;func_type&lt;int&gt;&gt;(function_map[type_id&lt;int&gt;])();\n\n    // prints 9.4\n    std::cout &lt;&lt; reinterpret_cast&lt;func_type&lt;double&gt;&gt;(function_map[type_id&lt;double&gt;])();\n}        \n</code></pre>\n\n<p>Is there a way to achieve similar result without significant overhead and without reinterpret casts?</p>\n"}, {"tags": ["c++", "multithreading", "parallel-processing"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 2, "creation_date": 1503519600, "post_id": 45848608, "comment_id": 78655432, "body": "How many cores do you have available at your target environment? Throwing stuff at threads, doesn&#39;t make them magically faster unless you have distinct CPU cores available to handle them."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1503519695, "post_id": 45848608, "comment_id": 78655477, "body": "Spinning up threads has a cost. What you are seeing is that cost.  Try adding loops to add many items into the vectors and see how that performs instead of adding a single item (which is a waste of a thread)"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503519765, "post_id": 45848608, "comment_id": 78655512, "body": "@Nathan That should be probably an answer. Let&#39;s wait a bit if the OP clarifies more about their target."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1503520803, "post_id": 45848608, "comment_id": 78655993, "body": "Make your calculation do much more than just a single addition that is likely optimized out anyways. The cost of creating threads is way more than the operation you are doing in the threads."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4081625"}, "edited": false, "score": 0, "creation_date": 1503520488, "post_id": 45848740, "comment_id": 78655859, "body": "You could add some Parallel Efficiency graphs to demonstrate."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503520657, "post_id": 45848740, "comment_id": 78655948, "body": "@Mel Well, no :-D. Feel free to do so yourself (edit my answer or post your own)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4081625"}, "edited": false, "score": 0, "creation_date": 1503520810, "post_id": 45848740, "comment_id": 78655997, "body": "Haha maybe tomorrow! :)"}], "tags": [], "owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "is_accepted": false, "score": 0, "last_activity_date": 1503520995, "last_edit_date": 1503520995, "creation_date": 1503520029, "answer_id": 45848740, "question_id": 45848608, "link": "https://stackoverflow.com/questions/45848608/can-someone-explain-why-using-openmp-sections-run-slower-than-a-single-thread/45848740#45848740", "title": "Can someone explain why using OpenMP sections run slower than a single thread?", "body": "<p>To <em>really</em> compute things in parallel (running threads independent of each other), you need to have dedicated CPU cores associated with your threads.</p>\n\n<p>If you have more threads than CPU cores available, you'll just introduce overhead regarding thread creation and scheduling. That's most probably why your code slows down.</p>\n"}, {"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 1, "last_activity_date": 1503520478, "creation_date": 1503520478, "answer_id": 45848843, "question_id": 45848608, "link": "https://stackoverflow.com/questions/45848608/can-someone-explain-why-using-openmp-sections-run-slower-than-a-single-thread/45848843#45848843", "title": "Can someone explain why using OpenMP sections run slower than a single thread?", "body": "<p>Also notice that for such simple computations, the time <strong><em>cost of spamming the threads</em></strong> could be even greater that just compute them in a single thread.\nAlso as user0042 said, if you <strong><em>spam more threads than cores</em></strong> has your computer they will start scheduling the resources (cores) and sharing them, entering and exiting wich also slows down the computation.</p>\n"}], "owner": {"reputation": 15, "user_id": 6564953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3fe70747e3994e5838cfb5b478deb61?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/6564953/rocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1503523622, "creation_date": 1503519511, "last_edit_date": 1503523622, "question_id": 45848608, "link": "https://stackoverflow.com/questions/45848608/can-someone-explain-why-using-openmp-sections-run-slower-than-a-single-thread", "title": "Can someone explain why using OpenMP sections run slower than a single thread?", "body": "<p>I am new for the parallel programming.\nAccording to the example code, Can someone explain why using OpenMP sections run slower than a single thread? and Is there any suggestion to improve it?</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;chrono&gt;\n#include &lt;numeric&gt;\n#include&lt;omp.h&gt;\n\nusing namespace std;\n\nint Calculation_1(int A, int B);\nint Calculation_2(int A, int B);\nint Calculation_3(int A, int B);\nint Calculation_4(int A, int B);\n\nint main() {\n\nvector&lt;int&gt;W;\nvector&lt;int&gt;X;\nvector&lt;int&gt;Y;\nvector&lt;int&gt;Z;\n\nchrono::steady_clock::time_point begin1 = std::chrono::steady_clock::now();\n    omp_set_num_threads(4);\n\n    #pragma omp parallel\n    {\n    #pragma omp sections nowait\n        {\n        #pragma omp section\n            {\n                W.push_back(Calculation_1(5, 5));\n            }\n        #pragma omp section\n            {\n                X.push_back(Calculation_2(5, 5));\n            }\n        #pragma omp section\n            {\n                Y.push_back(Calculation_3(5, 5));\n            }\n        #pragma omp section\n            {\n                Z.push_back(Calculation_4(5, 5));\n            }\n        }\n    }\n\ncout &lt;&lt; \"Parallel = \" &lt;&lt; accumulate(W.begin(), W.end(), 0) + accumulate(X.begin(), X.end(), 0) + accumulate(Y.begin(), Y.end(), 0) + accumulate(Z.begin(), Z.end(), 0) &lt;&lt; endl;;\nchrono::steady_clock::time_point end1 = std::chrono::steady_clock::now();\ncout &lt;&lt; \"Time difference = \" &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(end1 - begin1).count() &lt;&lt; std::endl;\n//Clear vector\nW.clear();\nX.clear();\nY.clear();\nZ.clear();\n\n////Sigle\nchrono::steady_clock::time_point begin2 = std::chrono::steady_clock::now();\n\n    W.push_back(Calculation_1(5, 5));\n    X.push_back(Calculation_2(5, 5));\n    Y.push_back(Calculation_3(5, 5));\n    Z.push_back(Calculation_4(5, 5));\n\ncout &lt;&lt; \"single = \" &lt;&lt; accumulate(W.begin(), W.end(), 0) + accumulate(X.begin(), X.end(), 0) + accumulate(Y.begin(), Y.end(), 0) + accumulate(Z.begin(), Z.end(), 0) &lt;&lt; endl;\nchrono::steady_clock::time_point end2 = std::chrono::steady_clock::now();\ncout &lt;&lt; \"Time difference = \" &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(end2 - begin2).count() &lt;&lt; std::endl;\n\ncin.get();\n\nreturn 0;\n\n}\n\nint Calculation_1(int A, int B) {\n    return A + B;\n}\nint Calculation_2(int A, int B) {\n    return A + B;\n}\nint Calculation_3(int A, int B) {\n    return A + B;\n}\nint Calculation_4(int A, int B) {\n    return A + B;\n}\n</code></pre>\n\n<p>The results are:\nParallel = 40\nTime = 9168172</p>\n\n<p>Single = 40\nTime 225580</p>\n\n<p>The parallel one is 40 times slower than single one.</p>\n\n<p>//I also have tried to push many numbers into the vector based on the suggestion (code below). The results are: (The parallel one is 9 times slower than single one.).</p>\n\n<p>Parallel\nTime = 12907862</p>\n\n<p>Single\nTime = 1334519</p>\n\n<pre><code>chrono::steady_clock::time_point begin1 = std::chrono::steady_clock::now();\n    omp_set_num_threads(2);\n\n    #pragma omp parallel\n    {\n    #pragma omp sections nowait\n        {\n        #pragma omp section\n            {\n                for (int i = 0; i &lt; 100000; i++) {\n                    X.push_back(i);\n                }\n            }\n        #pragma omp section\n            {\n                for (int j = 0; j &lt; 100000; j++) {\n                    Y.push_back(j);\n                }\n            }\n        }\n    }\n\ncout &lt;&lt; \"Parallel = \" &lt;&lt; accumulate(X.begin(), X.end(), 0) + accumulate(Y.begin(), Y.end(), 0) &lt;&lt; endl;;\nchrono::steady_clock::time_point end1 = std::chrono::steady_clock::now();\ncout &lt;&lt; \"Time difference = \" &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(end1 - begin1).count() &lt;&lt; std::endl;\n//Clear vector\nX.clear();\nY.clear();\n\n////Sigle\nchrono::steady_clock::time_point begin2 = std::chrono::steady_clock::now();\n\nfor (int i = 0; i &lt; 100000; i++) {\n    X.push_back(i);\n}\nfor (int j = 0; j &lt; 100000; j++) {\n    Y.push_back(j);\n}\n\n\ncout &lt;&lt; \"single = \" &lt;&lt; accumulate(X.begin(), X.end(), 0) + accumulate(Y.begin(), Y.end(), 0) &lt;&lt; endl;\nchrono::steady_clock::time_point end2 = std::chrono::steady_clock::now();\ncout &lt;&lt; \"Time difference = \" &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(end2 - begin2).count() &lt;&lt; std::endl;\n</code></pre>\n\n<p>Thank You very much,</p>\n"}, {"tags": ["c++", "hex"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1503519544, "post_id": 45848597, "comment_id": 78655409, "body": "Do note that accessing the non active member of a union is undefined behavior."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1503519734, "post_id": 45848597, "comment_id": 78655499, "body": "Can you provide a <a href=\"https://stackoverflow.com/help/mcve\">minimal test case</a>?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1503520090, "post_id": 45848597, "comment_id": 78655663, "body": "What is the string you are attempting to convert? Does it fit in a <code>long long</code>?  <code>std::stoll</code> throws <code>std::out_of_range</code> if the converted value would fall out of the range of the result type."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1503520313, "post_id": 45848597, "comment_id": 78655779, "body": "I mean a test case that causes the error."}, {"owner": {"reputation": 3, "user_id": 8508181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40a0e6186d16b764af6f3f9517365c55?s=128&d=identicon&r=PG&f=1", "display_name": "Rami", "link": "https://stackoverflow.com/users/8508181/rami"}, "edited": false, "score": 0, "creation_date": 1503520770, "post_id": 45848597, "comment_id": 78655979, "body": "Sure, for example  &quot;3fc87916804e22df&quot; gives &quot;0.19119530930426884&quot; But  &quot;bf9f9dca2676f181&quot;\tgives &quot;-9.2559631349317831e+61&quot; which is a wrong result and leads to that error"}], "answers": [{"tags": [], "owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "is_accepted": true, "score": 0, "last_activity_date": 1503520578, "creation_date": 1503520578, "answer_id": 45848868, "question_id": 45848597, "link": "https://stackoverflow.com/questions/45848597/convertion-from-hex-to-dual-leads-always-to-stdout-of-range-at-memory-location/45848868#45848868", "title": "Convertion from Hex to Dual leads always to std::out_of_range at memory location", "body": "<p>From the <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/stol\" rel=\"nofollow noreferrer\">documentation</a> it says:</p>\n\n<blockquote>\n  <h1>Exceptions</h1>\n  \n  <p>...<br>\n   - <code>std::out_of_range</code> if the converted value would fall out of the range of the result type or if the underlying function (<code>std::strtol</code> or <code>std::strtoll</code>) sets <code>errno</code> to <code>ERANGE</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 3, "user_id": 8508181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40a0e6186d16b764af6f3f9517365c55?s=128&d=identicon&r=PG&f=1", "display_name": "Rami", "link": "https://stackoverflow.com/users/8508181/rami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 45848868, "answer_count": 1, "score": -2, "last_activity_date": 1503520899, "creation_date": 1503519454, "last_edit_date": 1503520899, "question_id": 45848597, "link": "https://stackoverflow.com/questions/45848597/convertion-from-hex-to-dual-leads-always-to-stdout-of-range-at-memory-location", "title": "Convertion from Hex to Dual leads always to std::out_of_range at memory location", "body": "<p>I'm writing a c++ program that converts a list of characters to a double number. So basically i convert the characters to a hex number and then convert the hex to double using this method</p>\n\n<pre><code>#include &lt;cstdio&gt;\n\ndouble hexstr2double(const std::string&amp; hexstr)\n{\n     union\n     {\n         long long  i;\n         double    d;\n     } value;\n\n     value.i = std::stoll(hexstr, nullptr, 16);\n\n     return value.d;\n}\n</code></pre>\n\n<p>hexstr is the hex number that i want to convert to double. I'm able to have good  conversion results but only if the double number is positive if it's negative I always have this error \" Microsoft C++ exception: std::out_of_range at memory location \" </p>\n\n<p>For example \"3fc87916804e22df\" gives \"0.19119530930426884\" But \"bf9f9dca2676f181\" gives \"-9.2559631349317831e+61\" which is a wrong result and leads to the error</p>\n"}, {"tags": ["c++", "qt"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8366181, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/907955cedff212784eb43ea1577b4236?s=128&d=identicon&r=PG&f=1", "display_name": "Dan3460", "link": "https://stackoverflow.com/users/8366181/dan3460"}, "edited": false, "score": 0, "creation_date": 1503520430, "post_id": 45848669, "comment_id": 78655829, "body": "Thanks very much, i could not initialize on the header of the function, complaint of an unexpected &quot;(&quot;. But adding including QDate i was able to compile. I have the initialization of the variable in the body of the fiunction."}, {"owner": {"reputation": 157, "user_id": 5703879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57f355841498713a9571be1586dce86?s=128&d=identicon&r=PG&f=1", "display_name": "Taha Tekdo\u011fan", "link": "https://stackoverflow.com/users/5703879/taha-tekdo%c4%9fan"}, "reply_to_user": {"reputation": 67, "user_id": 8366181, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/907955cedff212784eb43ea1577b4236?s=128&d=identicon&r=PG&f=1", "display_name": "Dan3460", "link": "https://stackoverflow.com/users/8366181/dan3460"}, "edited": false, "score": 0, "creation_date": 1503520588, "post_id": 45848669, "comment_id": 78655909, "body": "You&#39;re welcome and glad you handled it! Please accept it as an answer if you are done with your problem after this post."}, {"owner": {"reputation": 2748, "user_id": 6165833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1b6bbdd7a7472d52c14da82af5eb6d20?s=128&d=identicon&r=PG&f=1", "display_name": "ymoreau", "link": "https://stackoverflow.com/users/6165833/ymoreau"}, "edited": false, "score": 0, "creation_date": 1503561571, "post_id": 45848669, "comment_id": 78669994, "body": "If you initialize your data-member in the cpp file, you can use forward-declaration in your header instead of including QDate."}], "tags": [], "owner": {"reputation": 157, "user_id": 5703879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57f355841498713a9571be1586dce86?s=128&d=identicon&r=PG&f=1", "display_name": "Taha Tekdo\u011fan", "link": "https://stackoverflow.com/users/5703879/taha-tekdo%c4%9fan"}, "is_accepted": true, "score": 0, "last_activity_date": 1503519708, "creation_date": 1503519708, "answer_id": 45848669, "question_id": 45848488, "link": "https://stackoverflow.com/questions/45848488/qdate-has-incomplete-type-declaring-as-private-member/45848669#45848669", "title": "QDate has incomplete type, declaring as private member", "body": "<p>After adding the header</p>\n\n<pre><code>#include &lt;QDate&gt;\n</code></pre>\n\n<p>you can initialize them like this:</p>\n\n<pre><code>QDate date1(1995,2,2);\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8366181, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/907955cedff212784eb43ea1577b4236?s=128&d=identicon&r=PG&f=1", "display_name": "Dan3460", "link": "https://stackoverflow.com/users/8366181/dan3460"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 45848669, "answer_count": 1, "score": 0, "last_activity_date": 1503576901, "creation_date": 1503518984, "last_edit_date": 1503576901, "question_id": 45848488, "link": "https://stackoverflow.com/questions/45848488/qdate-has-incomplete-type-declaring-as-private-member", "title": "QDate has incomplete type, declaring as private member", "body": "<p>I'm trying to create two private variables type date on a class but i'm getting the error \"field 'date1' has incomplete type 'QDate'\". I made an empty test application to show the problem. </p>\n\n<pre><code>#ifndef MAINWINDOW_H\n#define MAINWINDOW_H\n\n#include &lt;QMainWindow&gt;\n\nnamespace Ui {\n  class MainWindow;\n}\n\nclass MainWindow : public QMainWindow\n{\n  Q_OBJECT\n\npublic:\n  explicit MainWindow(QWidget *parent = 0);\n  ~MainWindow();\n\nprivate:\n  Ui::MainWindow *ui;\n\n  QDate date1;  &lt;&lt;---- Problem here\n  QDate date2;\n};\n\n#endif // MAINWINDOW_H\n</code></pre>\n\n<p>Is there a special way to declare date variables?</p>\n"}, {"tags": ["c++", "opencv", "computer-vision", "cascade"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8412178, "user_type": "registered", "profile_image": "https://graph.facebook.com/1265082786954483/picture?type=large", "display_name": "Santiago Restrepo Serna", "link": "https://stackoverflow.com/users/8412178/santiago-restrepo-serna"}, "edited": false, "score": 0, "creation_date": 1503534506, "post_id": 45848440, "comment_id": 78660486, "body": "Thank you very much, can not believe it was that simple. Now I am able to run this code and others I was trying to run. I have one more question. How do I prevent the code to stop immediately? I was using waitKey(0); but it does not stop it. Also tried if(waitKey(33)&gt;=0) break; but it keeps going and closes as well."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 39, "user_id": 8412178, "user_type": "registered", "profile_image": "https://graph.facebook.com/1265082786954483/picture?type=large", "display_name": "Santiago Restrepo Serna", "link": "https://stackoverflow.com/users/8412178/santiago-restrepo-serna"}, "edited": false, "score": 0, "creation_date": 1503585192, "post_id": 45848440, "comment_id": 78687057, "body": "@SantiagoRestrepoSerna Either run your code from a separate command window, or use something like <code>std::getline()</code> that will wait for input (ENTER)."}], "tags": [], "owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "is_accepted": false, "score": 2, "last_activity_date": 1503519206, "last_edit_date": 1503519206, "creation_date": 1503518741, "answer_id": 45848440, "question_id": 45848362, "link": "https://stackoverflow.com/questions/45848362/face-recognition-using-harr-cascades-fails-every-time-b-c-the-program-can-not-lo/45848440#45848440", "title": "Face recognition using harr cascades fails every time b/c the program can not load cascades", "body": "<blockquote>\n  <p>Please help me find what I am doing wrong ...</p>\n</blockquote>\n\n<p>Escape <code>\\</code> appearing in string literals: <code>\\\\</code>!</p>\n\n<p>This </p>\n\n<pre><code> string face_cascade_name = \n \"C:\\opencv\\sources\\data\\haarcascades\\haarcascade_frontalface_alt2.xml\";\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>string face_cascade_name = \n\"C:\\\\opencv\\\\sources\\\\data\\\\haarcascades\\\\haarcascade_frontalface_alt2.xml\";\n // ^       ^        ^     ^             ^\n</code></pre>\n\n<p>or<sup>1</sup></p>\n\n<pre><code> string face_cascade_name = \n    R\"x(C:\\opencv\\sources\\data\\haarcascades\\haarcascade_frontalface_alt2.xml)x\";\n // ^^^^                                                                    ^^\n</code></pre>\n\n<hr>\n\n<p>BTW: The compiler should have spit out warnings about unknown character escape sequences like <code>'\\o'</code>, <code>'\\s'</code>, <code>'\\d'</code> and\n <code>'\\h'</code>.</p>\n\n<hr>\n\n<p><sup>1)</sup><sub>See <a href=\"http://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow noreferrer\">raw string literals</a></sub></p>\n"}], "owner": {"reputation": 39, "user_id": 8412178, "user_type": "registered", "profile_image": "https://graph.facebook.com/1265082786954483/picture?type=large", "display_name": "Santiago Restrepo Serna", "link": "https://stackoverflow.com/users/8412178/santiago-restrepo-serna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503519206, "creation_date": 1503518411, "question_id": 45848362, "link": "https://stackoverflow.com/questions/45848362/face-recognition-using-harr-cascades-fails-every-time-b-c-the-program-can-not-lo", "title": "Face recognition using harr cascades fails every time b/c the program can not load cascades", "body": "<p>I have tried everything I found on the web but nothing makes this or similar programs run in my computer. I have tried absolute path (C:\\opencv\\sources\\data\\haarcascades\\haarcascade_frontalface_alt2.xml) directly into the code. Also, I tried copying the xml files into the folder where my program is, I also tried running the code in different platforms and configuration(Off course matching the version), but still nothing works for me. I have also tried visual studio 2015,2017, open CV 3.2 and 3.3 but again, no success Please help me find what I am doing wrong and thanks. Here is on of the codes I have tried.`The program crashes in the if statement but i have no idea why.</p>\n\n<p>enter code here`</p>\n\n<pre><code>#include \"opencv2/objdetect/objdetect.hpp\" \n#include \"opencv2/highgui/highgui.hpp\"\n#include \"opencv2/imgproc/imgproc.hpp\"\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n\nusing namespace std;\nusing namespace cv;\n\n// Function Headers\nvoid detectAndDisplay(Mat frame);\n\n// Global variables\nstring face_cascade_name = \n\"C:\\opencv\\sources\\data\\haarcascades\\haarcascade_frontalface_alt2.xml\";\nCascadeClassifier face_cascade;\n\n// Function main\nint main(void)\n{\n    // Load the cascade\n\n    if (!face_cascade.load(face_cascade_name)) {\n        printf(\"--(!)Error on cascade loading\\n\");\n        return (-1);\n     }\n\n     // Read the image file\n    Mat frame = imread(\"preview-obama-10.jpg\");\n\n    // Apply the classifier to the frame\n    if (!frame.empty())\n        detectAndDisplay(frame);\n    waitKey(0);\n    return 0;\n }\n\n// Function detectAndDisplay\nvoid detectAndDisplay(Mat frame)\n{\n    std::vector&lt;Rect&gt; faces;\n    Mat frame_gray;\n\n     cvtColor(frame, frame_gray, COLOR_BGR2GRAY);\n    equalizeHist(frame_gray, frame_gray);\n\n    // Detect faces\n     face_cascade.detectMultiScale(frame_gray, faces, 1.1, 2, 0 | \nCASCADE_SCALE_IMAGE, Size(30, 30));\n\n    for (int ic = 0; ic &lt; faces.size(); ic++) // Iterate through all current \nelements (detected faces)\n    {\n        Point pt1(faces[ic].x, faces[ic].y); // Display detected faces on \nmain window - live stream from camera\n        Point pt2((faces[ic].x + faces[ic].height), (faces[ic].y + \nfaces[ic].width));\n        rectangle(frame, pt1, pt2, Scalar(0, 255, 0), 2, 8, 0);\n    }\n\n    imshow(\"original\", frame);\n}\n</code></pre>\n"}, {"tags": ["c++", "c++builder"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1503517745, "post_id": 45848139, "comment_id": 78654528, "body": "Please <a href=\"https://stackoverflow.com/posts/45848139/edit\">edit</a> your question to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 619, "user_id": 6794745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1JnxH.jpg?s=128&g=1", "display_name": "relayman357", "link": "https://stackoverflow.com/users/6794745/relayman357"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503519118, "post_id": 45848139, "comment_id": 78655190, "body": "OK, done.  I hope it is repeatable."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503519175, "post_id": 45848139, "comment_id": 78655216, "body": "I&#39;m afraid it isn&#39;t. <a href=\"https://wandbox.org/permlink/9RUlGfEd1Ldfu1uF\" rel=\"nofollow noreferrer\">wandbox.org/permlink/9RUlGfEd1Ldfu1uF</a> Works even with values that don&#39;t fit into <code>int</code>, as it should. <a href=\"https://wandbox.org/permlink/CQqKfSant3dDcEv1\" rel=\"nofollow noreferrer\">wandbox.org/permlink/CQqKfSant3dDcEv1</a>"}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1503519200, "post_id": 45848139, "comment_id": 78655231, "body": "You can verify here: <a href=\"http://coliru.stacked-crooked.com/a/d7aa94d3ff41d9c1\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/d7aa94d3ff41d9c1</a> not repeatable"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1503519210, "post_id": 45848139, "comment_id": 78655232, "body": "@relayman357 No, that is not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It is not complete, I can&#39;t put this in a source file and compile it. If I modify it to make it compilable, it doesn&#39;t produce the behavior you describe."}, {"owner": {"reputation": 619, "user_id": 6794745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1JnxH.jpg?s=128&g=1", "display_name": "relayman357", "link": "https://stackoverflow.com/users/6794745/relayman357"}, "edited": false, "score": 0, "creation_date": 1503519278, "post_id": 45848139, "comment_id": 78655278, "body": "Did you try to repeat it in Rad Studio 10.2?"}, {"owner": {"reputation": 619, "user_id": 6794745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1JnxH.jpg?s=128&g=1", "display_name": "relayman357", "link": "https://stackoverflow.com/users/6794745/relayman357"}, "edited": false, "score": 0, "creation_date": 1503519351, "post_id": 45848139, "comment_id": 78655320, "body": "Sorry guys, other than giving you the code (I&#39;d be happy to via a link but i don&#39;t think that is allowed here?) i don&#39;t know that else to do."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1503519460, "post_id": 45848139, "comment_id": 78655372, "body": "@relayman357 <i>&quot;Did you try to repeat it in Rad Studio 10.2?&quot;</i> Unless this compiler implements some dialect of C++ (in that case, please retag accordingly) or is <i>terribly</i> broken (in that case, don&#39;t use it), choice of compiler is irrelevant. C++ is standardized to guarantee portability across compilers."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503519507, "post_id": 45848139, "comment_id": 78655392, "body": "@relayman357 <i>&quot;i don&#39;t know that else to do.&quot;</i> Read the links we gave you, narrow down the problem and then present that MCVE."}, {"owner": {"reputation": 619, "user_id": 6794745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1JnxH.jpg?s=128&g=1", "display_name": "relayman357", "link": "https://stackoverflow.com/users/6794745/relayman357"}, "edited": false, "score": 0, "creation_date": 1503519682, "post_id": 45848139, "comment_id": 78655470, "body": "I&#39;m following you - and I agree with what your saying - but i&#39;m not making it up.  This is happening exactly as i describe.  The Rad Studio 10.2 help says that the compiler is a Clang-enhanced C++ Compiler BCC64, clang version 3.3 and LLVM version 3.3.   I guess it is just not promoting the literal to unsigned long on its own."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503519929, "post_id": 45848139, "comment_id": 78655583, "body": "Something like this is certainly not broken in clang3.3. If that &quot;Clang-enhanced C++ Compiler BCC64&quot; is supposed to implement C++ and those examples from my wandbox links actually break, you should file a bugreport there I suppose. That would be a <i>serious</i> blunder on their part though."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1503521328, "post_id": 45848139, "comment_id": 78656248, "body": "<code>myGlobalInt</code> being global or extern makes no significant difference, the same promotion rules apply. You&#39;ll have to keep digging I&#39;m afraid."}], "answers": [{"comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503517740, "post_id": 45848140, "comment_id": 78654526, "body": "If <code>myGlobalInt</code> is <code>unsigned long</code> , then <code>86399</code> would be promoted to <code>unsigned long</code> anyways due to the usual arithmetic conversions, so this cannot be the solution to the actual problem."}, {"owner": {"reputation": 619, "user_id": 6794745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1JnxH.jpg?s=128&g=1", "display_name": "relayman357", "link": "https://stackoverflow.com/users/6794745/relayman357"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503518051, "post_id": 45848140, "comment_id": 78654678, "body": "Adding the UL was the only thing i changed in my code.  I can make a video showing it but i&#39;m not sure how i can prove it otherwise.  Suggestions?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1503518190, "post_id": 45848140, "comment_id": 78654749, "body": "I&#39;d suggest you actually present that MCVE. Your &quot;fix&quot; probably worked by chance, there is most certainly some UB like array-out-of-bounds-access, use-after-free or a race in the picture."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1503518588, "post_id": 45848140, "comment_id": 78654959, "body": "@relayman357 -- the way to show it is to chop out code. You don&#39;t need that Windows stuff; just write the values to <code>std::cout</code> in a console application. If you&#39;re right about what the problem is, that will show it."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1503518639, "post_id": 45848140, "comment_id": 78654982, "body": "I&#39;ve never heard of Embarcadero c++ builder. Perhaps this is a standard compliance issue unique to that particular implementation? It may use a 2 byte <code>int</code> and incorrectly implement arithmetic conversions."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1503519019, "post_id": 45848140, "comment_id": 78655152, "body": "@Fran&#231;oisAndrieux The former would not matter, and if the latter is the case, that would be quite a big screw up. I hope no such compiler would be used for anything production related."}], "tags": [], "owner": {"reputation": 619, "user_id": 6794745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1JnxH.jpg?s=128&g=1", "display_name": "relayman357", "link": "https://stackoverflow.com/users/6794745/relayman357"}, "is_accepted": false, "score": -2, "last_activity_date": 1503517462, "creation_date": 1503517462, "answer_id": 45848140, "question_id": 45848139, "link": "https://stackoverflow.com/questions/45848139/if-statement-with-unsigned-long-integer-c-builder/45848140#45848140", "title": "if statement with unsigned long Integer - c++ builder", "body": "<p>Ok, i think the issue is that the compiler cannot tell from the context that the 86399 literal should be considered an unsigned long integer.  After reading the section on \"integer\" on page 8 of the following i decided to try adding \"UL\" to the end of 86399: <a href=\"http://helpcentreonline.com/article/primitiv_console_bcc.pdf\" rel=\"nofollow noreferrer\">http://helpcentreonline.com/article/primitiv_console_bcc.pdf</a></p>\n\n<p>This worked and the code runs properly now.  Here is the final version:</p>\n\n<pre><code>ShowMessage(myGlobalInt);\nif (myGlobalInt &gt; 86399UL) {\n   ShowMessage(\"Job timer stops at 24 hours.\");\n}\n</code></pre>\n\n<p>Hope this helps the next newbie.  ;-)</p>\n"}], "owner": {"reputation": 619, "user_id": 6794745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1JnxH.jpg?s=128&g=1", "display_name": "relayman357", "link": "https://stackoverflow.com/users/6794745/relayman357"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 704, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1503523252, "creation_date": 1503517462, "last_edit_date": 1503523252, "question_id": 45848139, "link": "https://stackoverflow.com/questions/45848139/if-statement-with-unsigned-long-integer-c-builder", "title": "if statement with unsigned long Integer - c++ builder", "body": "<p>In the following snip of code, the <code>myGlobalInt</code> variable is an <code>unsigned long int</code>.  I'm running this code in Embarcadero C++Builder.</p>\n\n<p>The first <code>ShowMessage()</code> popup correctly shows the value for <code>myGlobalInt</code> and it is larger than <code>86399</code>.  But, the <code>ShowMessage()</code> inside the <code>if</code> statement never fires.</p>\n\n<pre><code>ShowMessage(myGlobalInt);\nif (myGlobalInt &gt; 86399) {\n    ShowMessage(\"Job timer stops at 24 hours.\");\n}\n</code></pre>\n\n<p><strong>Edit</strong>: Below shows all of the relevant code so you can repeat and hopefully verify my results.  This is built in Embarcadero RAD Studio 10.2 Tokyo in a simple Multi-Device C++ Application.</p>\n\n<p>In the <code>Project.cpp</code> file, I have the following relavent code, just after the includes:</p>\n\n<pre><code>//---- Global variables ---\nunsigned long int myGlobalInt;       // used to track seconds\nint jobInt;            // used to track which job is accruing time\n</code></pre>\n\n<p>In the <code>Unit.cpp</code> file for my one Form, I have the following code just after the includes:</p>\n\n<pre><code>extern unsigned long int  myGlobalInt;  // seconds counter\nextern int jobInt;  // which job is accruing time\n</code></pre>\n\n<p>When enabled, the Timer I'm using on the Form fires every 1 second.  It has the following relavent code:</p>\n\n<pre><code>myGlobalInt++;   // eventually this exceeds 86,399.\n\nShowMessage(myGlobalInt);\nif (myGlobalInt &gt; 86399UL) {\n    ShowMessage(\"Job timer stops at 24 hours.\");\n}\n</code></pre>\n\n<p>Without the <code>UL</code> suffix on the <code>86399</code> literal, the <code>\"Job timer stops at 24 hours.\"</code> message never happens.</p>\n\n<p><strong>Edit</strong>:  Following advice, I've created a simple console code as below.  But, this code works fine - and without the <code>UL</code> suffix!  </p>\n\n<pre><code>#include &lt;tchar.h&gt;\n#include &lt;iostream.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, _TCHAR* argv[])\n{\n    int goofy;\n    unsigned long int myGlobalInt = 90000;\n    if (myGlobalInt &gt; 86399) {\n        std::cout &lt;&lt; \"Big number\";\n    }\n    std::cin &gt;&gt; goofy;     //this is just to hold the console open\n    return 0;\n}\n</code></pre>\n\n<p>My original problem (that was fixed by putting <code>UL</code> on end of the <code>86399</code> literal) must have something to do with the fact that I declared the <code>unsigned long int</code> as a global variable (in the <code>Project.cpp</code> file) and then brought it into my <code>Unit.cpp</code> for use with the <code>extern</code> code.</p>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1503517627, "post_id": 45848113, "comment_id": 78654471, "body": "If you are going to use the C++ in a C++ manner then consider abandoning that C <code>typedef</code> construct. Prefer alias declarations to typedefs. Structs are classes in C++."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1503517664, "post_id": 45848113, "comment_id": 78654490, "body": "and structs are types anyway in c++"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1503517719, "post_id": 45848113, "comment_id": 78654517, "body": "It is not &quot;a struct with no type&quot;, it is anonymous struct type. But it is unclear what is your problem exactly. Just write normal definitions with proper names separated from variable declarations."}], "answers": [{"tags": [], "owner": {"reputation": 5052, "user_id": 479574, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/11f025f0f74ee6557e479a0ba2215223?s=128&d=identicon&r=PG", "display_name": "mark", "link": "https://stackoverflow.com/users/479574/mark"}, "is_accepted": true, "score": 3, "last_activity_date": 1503519717, "creation_date": 1503519717, "answer_id": 45848671, "question_id": 45848113, "link": "https://stackoverflow.com/questions/45848113/nested-structure-with-anonymous-type-in-c/45848671#45848671", "title": "Nested Structure with anonymous type in C++", "body": "<p>This works for me in C++11:</p>\n\n<pre><code>st-&gt;list.array = new decltype( struct1_t::list )::struct2;\n</code></pre>\n"}], "owner": {"reputation": 1597, "user_id": 1131067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5zIZe.png?s=128&g=1", "display_name": "ManiAm", "link": "https://stackoverflow.com/users/1131067/maniam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 45848671, "answer_count": 1, "score": 2, "last_activity_date": 1503519717, "creation_date": 1503517329, "last_edit_date": 1503517736, "question_id": 45848113, "link": "https://stackoverflow.com/questions/45848113/nested-structure-with-anonymous-type-in-c", "title": "Nested Structure with anonymous type in C++", "body": "<p>I am trying to port a nested struct code in C into C++. I know that in C++ the inner structure type will be a member of outer struct type. In my case, I have an inner struct that has no type (marked with <code>*</code>), and I do not know how to fully specify struct2 to the compiler.</p>\n\n<pre><code>typedef struct struct1\n{\n    struct // *\n    {\n        struct struct2\n        {\n            int bla;\n            int bla2;\n        } *array;\n\n        int bla3;\n\n    } list;\n\n    int bla4;\n\n} struct1_t;\n\n\nint main()\n{\n    struct1_t *st = new struct1_t();\n\n    st-&gt;bla4 = 10;\n    st-&gt;list.bla3 = 45;\n\n    // ?\n    st-&gt;list.array = new struct1_t::struct2();\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Edit: the structure code above is generated automatically by the ASN1 compiler and I can not make any changes to it.</p>\n"}, {"tags": ["c++", "debugging", "eclipse-cdt", "cstdio"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503520624, "post_id": 45848065, "comment_id": 78655932, "body": "Required reading: <a href=\"http://c-faq.com/stdio/scanfprobs.html\" rel=\"nofollow noreferrer\">C FAQ - <code>scanf</code></a>"}, {"owner": {"reputation": 44207, "user_id": 141719, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5026f7977fda423dc990cc74b2ad4c9d?s=128&d=identicon&r=PG&f=1", "display_name": "HighCommander4", "link": "https://stackoverflow.com/users/141719/highcommander4"}, "edited": false, "score": 0, "creation_date": 1503547329, "post_id": 45848065, "comment_id": 78663411, "body": "Does this happen when you run or debug your code outside of Eclipse CDT? Do you know where that output is coming from?"}, {"owner": {"reputation": 360, "user_id": 3268405, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1608dd4a2c2706bc5f5227dc61ae6d8d?s=128&d=identicon&r=PG&f=1", "display_name": "ModDL", "link": "https://stackoverflow.com/users/3268405/moddl"}, "edited": false, "score": 0, "creation_date": 1503547981, "post_id": 45848065, "comment_id": 78663581, "body": "This problem does not occur in Visual Studio for Run or Debug. This only occurs when launching the program using the &quot;Debug &lt;Project Name&gt;&quot; option in Eclipse CDT and does not occur using the &quot;Run &lt;Project Name&gt;&quot; option."}, {"owner": {"reputation": 360, "user_id": 3268405, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1608dd4a2c2706bc5f5227dc61ae6d8d?s=128&d=identicon&r=PG&f=1", "display_name": "ModDL", "link": "https://stackoverflow.com/users/3268405/moddl"}, "edited": false, "score": 0, "creation_date": 1503548716, "post_id": 45848065, "comment_id": 78663768, "body": "Under further examination I found that the standard input stream was fighting with the GDB console. The inputs given via a file was causing errors in the GDB console whilst commands in the GDB console is being picked up by scanf."}, {"owner": {"reputation": 480, "user_id": 172916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8bc59c1e3b0fa2587738e2c9a6418d?s=128&d=identicon&r=PG", "display_name": "simark", "link": "https://stackoverflow.com/users/172916/simark"}, "edited": false, "score": 0, "creation_date": 1504206246, "post_id": 45848065, "comment_id": 78936997, "body": "What method do you use to get the program to read from a file while debugging in CDT?  Also, which versions of both GDB and CDT are you using?"}], "owner": {"reputation": 360, "user_id": 3268405, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1608dd4a2c2706bc5f5227dc61ae6d8d?s=128&d=identicon&r=PG&f=1", "display_name": "ModDL", "link": "https://stackoverflow.com/users/3268405/moddl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1503517249, "creation_date": 1503517129, "last_edit_date": 1503517249, "question_id": 45848065, "link": "https://stackoverflow.com/questions/45848065/eclipse-cdt-debug-has-extra-lines-in-scanf", "title": "Eclipse CDT Debug Has Extra Lines In Scanf", "body": "<p>I have a simple piece of code that will echo whatever you type into the console:</p>\n\n<pre><code>int main(){\n    setvbuf(stdout, NULL, _IONBF, 0);\n    char c = -1;\n    while(scanf(\"%c\", &amp;c) == 1){\n        printf(\"%c\", c);\n    }\n}\n</code></pre>\n\n<p>But when I Debug this code in Eclipse CDT it outputs the following without me typing anything into the console.</p>\n\n<pre><code>47-thread-select 1\n</code></pre>\n\n<p>How can I disable this from being fed into the input stream? Also sometimes if I run this there are multiple lines being outputted so I cannot simply discard 1 line.</p>\n"}, {"tags": ["c++", "image", "qt", "user-interface"], "comments": [{"owner": {"reputation": 33, "user_id": 8480690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c936cba51e6e1005c2f9b9ceae0e18c7?s=128&d=identicon&r=PG&f=1", "display_name": "pythonner", "link": "https://stackoverflow.com/users/8480690/pythonner"}, "edited": false, "score": 0, "creation_date": 1503518674, "post_id": 45848063, "comment_id": 78654999, "body": "Solved by using qrc resource editor and added the image :)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8480690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c936cba51e6e1005c2f9b9ceae0e18c7?s=128&d=identicon&r=PG&f=1", "display_name": "pythonner", "link": "https://stackoverflow.com/users/8480690/pythonner"}, "edited": false, "score": 0, "creation_date": 1503597235, "post_id": 45851315, "comment_id": 78694869, "body": "Thanks, this could be a second option. But it is solved using the resource editor."}], "tags": [], "owner": {"reputation": 467, "user_id": 8106002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e477ad83a0db8ad842418b2a4ee15fa?s=128&d=identicon&r=PG&f=1", "display_name": "pat", "link": "https://stackoverflow.com/users/8106002/pat"}, "is_accepted": true, "score": 1, "last_activity_date": 1503535983, "creation_date": 1503535983, "answer_id": 45851315, "question_id": 45848063, "link": "https://stackoverflow.com/questions/45848063/qt-quick-image-not-showing/45851315#45851315", "title": "Qt Quick image not showing", "body": "<p>You can use image in file system by adding file:// infront.\nExample: source: \"file://C:/test.png\"</p>\n"}], "owner": {"reputation": 33, "user_id": 8480690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c936cba51e6e1005c2f9b9ceae0e18c7?s=128&d=identicon&r=PG&f=1", "display_name": "pythonner", "link": "https://stackoverflow.com/users/8480690/pythonner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 45851315, "answer_count": 1, "score": 1, "last_activity_date": 1503535983, "creation_date": 1503517104, "question_id": 45848063, "link": "https://stackoverflow.com/questions/45848063/qt-quick-image-not-showing", "title": "Qt Quick image not showing", "body": "<p>When I try to add an image to the template of new qt quick project, it compiles and shows the window, but only the edit text and the rectangle only shows.</p>\n\n<pre><code>import QtQuick 2.6\n\nRectangle {\n   property alias mouseArea: mouseArea\n   property alias textEdit: textEdit\n\n   width: 360\n   height: 360\n\n   MouseArea {\n    id: mouseArea\n    anchors.fill: parent\n   }\n\n   TextEdit {\n    id: textEdit\n    text: qsTr(\"Enter some text...\")\n    verticalAlignment: Text.AlignVCenter\n    anchors.top: parent.top\n    anchors.horizontalCenter: parent.horizontalCenter\n    anchors.topMargin: 20\n    Rectangle {\n        anchors.fill: parent\n        anchors.margins: -10\n        color: \"transparent\"\n        border.width: 1\n    }\n   }\n   Image {\n    id: image\n    x: 207\n    y: 235\n    width: 100\n    height: 100\n    source: \"../../QtIcon.png\"\n   }\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "c++11", "constructor", "overloading"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1503516155, "post_id": 45847787, "comment_id": 78653801, "body": "&quot;I suspect the prototypes of fill constructor and range constructor of std::vector (and many other STL types) given in this webpage are not right, &quot; - well, it wouldn&#39;t surprise me, but why not simply use the correct prototypes from the Standard Library?"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503516458, "post_id": 45847787, "comment_id": 78653957, "body": "<code>InputIterator</code> just means a template parameter name. Nothing to do with <code>std::vector&lt;T&gt;::iterator</code>."}, {"owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503516596, "post_id": 45847787, "comment_id": 78654022, "body": "@user0042 you are right, but I am not implying <code>InputIterator</code> should be <code>std::vector&lt;T&gt;::iterator</code>. It can indeed be any class that satisfies the requirements of an <a href=\"http://www.cplusplus.com/reference/iterator/InputIterator/\" rel=\"nofollow noreferrer\">input iterator</a>."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1503516621, "post_id": 45847787, "comment_id": 78654033, "body": "cplusplus.com is garbage. Much better reference at <a href=\"http://en.cppreference.com/w/cpp/container/vector/vector\" rel=\"nofollow noreferrer\">cppreference.com</a>. Note in particular: &quot;This overload only participates in overload resolution if <code>InputIt</code> satisfies <code>InputIterator</code>, to avoid ambiguity with the overload (2).&quot; This is usually achieved via <a href=\"http://en.cppreference.com/w/cpp/language/sfinae\" rel=\"nofollow noreferrer\">SFINAE</a>"}, {"owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1503516733, "post_id": 45847787, "comment_id": 78654071, "body": "@IgorTandetnik I know the concept of SFINAE but don&#39;t know how it is used here.. so here comes the million-dollar question: how to implement it?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1503516824, "post_id": 45847787, "comment_id": 78654109, "body": "You have on your machine the source code of at least one standard library implementation. You could do worse than study how the experts did it."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503516929, "post_id": 45847787, "comment_id": 78654151, "body": "@user8385554 But <code>std::vector</code> doesn&#39;t imply that. So what you wrote doesn&#39;t have to do anything with how <code>std::vector</code> distinguishes these constructor signatures."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1503517024, "post_id": 45847787, "comment_id": 78654197, "body": "This is a dupe, I answered teh same question about insert last week. Finding it."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 1, "creation_date": 1503517052, "post_id": 45847787, "comment_id": 78654207, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45581142/how-does-a-compiler-distinguish-between-two-variations-of-vectorinsert\">How does a compiler distinguish between two variations of &quot;vector::insert&quot;?</a>"}, {"owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1503518458, "post_id": 45847787, "comment_id": 78654898, "body": "@IgorTandetnik um.. I just checked.. experts expertly entangles the checking mechanism with other things (GCC 4.4.7 bits/stl_vector.h uses std::__is_integer&lt;&gt;, which is not directly given in C++11), so not straightforward enough."}, {"owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503518780, "post_id": 45847787, "comment_id": 78655037, "body": "@user0042 yes, my code is an <b>intentional</b> example to demonstrate the fallacy of the prototypes given in that webpage. At least those prototypes are only intended for reference, not for real implementation."}], "answers": [{"comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1503516751, "post_id": 45847950, "comment_id": 78654078, "body": "<code>std::vector&lt;T&gt;</code>&#39;s constructor accepts iterators whose <code>value_type</code> is different from, but convertible to, <code>T</code>."}, {"owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1503518932, "post_id": 45847950, "comment_id": 78655114, "body": "@IgorTandetnik so you mean the code given in this answer should be further generalized?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "edited": false, "score": 1, "creation_date": 1503519046, "post_id": 45847950, "comment_id": 78655165, "body": "@user8385554 Yes, it is possible to adjust this code to achieve that behavior using <code>::std::is_convertible</code>."}, {"owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "edited": false, "score": 0, "creation_date": 1503649790, "post_id": 45847950, "comment_id": 78713016, "body": "In your solution there is a bug: if <code>InputIt</code> is a const_iterator, then dereferencing it with <code>*</code> will yield a <code>const T &amp;</code>, whose <code>const</code> cannot be cast away by <code>std::remove_const</code>. So comparing it with <code>T &amp;</code> would return <code>false</code>, causing the compiler to select the fill constructor. There seems to be no nicer workaround other than combining two <code>is_same</code> conditions with OR operator, one comparing with <code>T &amp;</code>, the other with <code>const T &amp;</code>."}], "tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 1, "last_activity_date": 1503516766, "last_edit_date": 1503516766, "creation_date": 1503516640, "answer_id": 45847950, "question_id": 45847787, "link": "https://stackoverflow.com/questions/45847787/how-to-differentiate-fill-constructor-and-range-constructor-in-c11/45847950#45847950", "title": "How to differentiate fill constructor and range constructor in C++11?", "body": "<p>You can try adding some type trait check to verify that arguments of second constructor are iterators over T elements:</p>\n\n<pre><code>template\n&lt;\n    typename InputIterator\n,   typename = typename ::std::enable_if\n    &lt;\n        ::std::is_same\n        &lt;\n            T &amp;\n        ,   typename ::std::remove_const\n            &lt;\n                decltype(*(::std::declval&lt; InputIterator &gt;()))\n            &gt;::type\n        &gt;::value\n    ,  void\n    &gt;::type\n&gt;\nNaiveVector(InputIterator first, InputIterator last) : v(first, last)\n{\n    cout &lt;&lt; \"(InputIterator first, InputIterator last)\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/rf9qXv\" rel=\"nofollow noreferrer\">Run this code online</a></p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1503517176, "last_edit_date": 1503517176, "creation_date": 1503516800, "answer_id": 45847989, "question_id": 45847787, "link": "https://stackoverflow.com/questions/45847787/how-to-differentiate-fill-constructor-and-range-constructor-in-c11/45847989#45847989", "title": "How to differentiate fill constructor and range constructor in C++11?", "body": "<p>If you read the documentation at <a href=\"http://en.cppreference.com/w/cpp/container/vector/vector\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/container/vector/vector</a> carefully, you will notice the following (emphasis mine):</p>\n\n<blockquote>\n  <p>4) Constructs the container with the contents of the range <code>[first, last)</code>.</p>\n  \n  <p>This constructor has the same effect as <code>vector(static_cast&lt;size_type&gt;(first), static_cast&lt;value_type&gt;(last), a)</code> if <code>InputIt</code> is an integral type.    (until C++11)</p>\n  \n  <p><strong>This overload only participates in overload resolution if <code>InputIt</code> satisfies <code>InputIterator</code>, to avoid ambiguity with the overload (2)</strong>.</p>\n</blockquote>\n\n<p>The confusion is not with the <code>std::vector</code> but your expectation of which of your constructors gets called. Your code doesn't have the checks to make sure that the second constructor gets called only if the above condition of <code>std::vector</code> is met.</p>\n\n<p>In your case, when you use</p>\n\n<pre><code>NaiveVector&lt;int&gt; myVec1(5,1);\n</code></pre>\n\n<p>the second constructor can be called by using <code>int</code> as the template parameter without requiring any conversion. The compiler needs to convert an <code>int</code> to a <code>size_t</code> in order to be able to call the first constructor. Hence, the second constructor is a better fit.</p>\n"}, {"comments": [{"owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "edited": false, "score": 0, "creation_date": 1503519422, "post_id": 45848470, "comment_id": 78655347, "body": "For comprehensiveness, the answer <a href=\"https://stackoverflow.com/a/45847950/8385554\">here</a> gives a straightforward code and runnable online implementation."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 5, "last_activity_date": 1503518911, "creation_date": 1503518911, "answer_id": 45848470, "question_id": 45847787, "link": "https://stackoverflow.com/questions/45847787/how-to-differentiate-fill-constructor-and-range-constructor-in-c11/45848470#45848470", "title": "How to differentiate fill constructor and range constructor in C++11?", "body": "<p><strong>C++03</strong></p>\n\n<p>[lib.sequence.reqmts]/9</p>\n\n<blockquote>\n  <p>For every sequence defined in this clause and in clause 21:</p>\n  \n  <ul>\n  <li><p>the constructor</p>\n\n<pre><code>template &lt;class InputIterator&gt;\nX(InputIterator f, InputIterator l, const Allocator&amp; a = Allocator())\n</code></pre>\n  \n  <p>shall have the same effect as:</p>\n\n<pre><code>X(static_cast&lt;typename X::size_type&gt;(f),\n  static_cast&lt;typename X::value_type&gt;(l),\n  a)\n</code></pre>\n  \n  <p>if <code>InputIterator</code> is an integral type.</p></li>\n  </ul>\n  \n  <p>...</p>\n</blockquote>\n\n<p>[lib.sequence.reqmts]/11</p>\n\n<blockquote>\n  <p>One way that sequence implementors can satisfy this requirement is to specialize the member template for\n  every integral type. Less cumbersome implementation techniques also exist.</p>\n</blockquote>\n\n<p>In other words, the standard says that if the range constructor gets selected by overload resolution but the \"iterator\" type is actually an integral type, it has to delegate to the fill constructor by casting its argument types to force the latter to be an exact match.</p>\n\n<p><strong>C++11/C++14</strong></p>\n\n<p>[sequence.reqmts]/14</p>\n\n<blockquote>\n  <p>For every sequence container defined in this clause and in clause 21:</p>\n  \n  <ul>\n  <li><p>If the constructor</p>\n\n<pre><code>template &lt;class InputIterator&gt;\nX(InputIterator first, InputIterator last,\n  const allocator_type&amp; alloc = allocator_type())\n</code></pre>\n  \n  <p>is called with a type <code>InputIterator</code> that does not qualify as an input iterator, then the constructor shall not participate in overload resolution.\n  ...</p></li>\n  </ul>\n</blockquote>\n\n<p>[sequence.reqmts]/15</p>\n\n<blockquote>\n  <p>The extent to which an implementation determines that a type cannot be an input iterator is unspecified,\n  except that as a minimum integral types shall not qualify as input iterators.</p>\n</blockquote>\n\n<p>This is more or less the way the standard hints to you to use SFINAE (which works reliably in C++11 as opposed to C++03).</p>\n\n<p><strong>C++17</strong></p>\n\n<p>The wording is similar, except that the paragraph about integral types not being iterators has been moved to <a href=\"http://eel.is/c++draft/container.requirements.general#17\" rel=\"noreferrer\">[container.requirements.general]/17</a>.</p>\n\n<p><strong>Conclusion</strong></p>\n\n<p>You can write your range constructor to look something like this:</p>\n\n<pre><code>template &lt;typename InputIterator,\n          typename = std::enable_if&lt;is_likely_iterator&lt;InputIterator&gt;&gt;::type&gt;\nNaiveVector(InputIterator first, InputIterator last)\n</code></pre>\n\n<p>The <code>is_iterator</code> helper template might simply disqualify integral types and accept all other types, or it might do something more sophisticated such as checking whether there is an <code>std::iterator_traits</code> specialization that indicates that the type is an input iterator (or stricter). See <a href=\"https://github.com/gcc-mirror/gcc/blob/7b35a939b8cb869efb830701cef4fa1dc5ff4020/libstdc%2B%2B-v3/include/bits/stl_iterator_base_types.h#L230\" rel=\"noreferrer\">libstdc++ source</a>, <a href=\"https://github.com/llvm-mirror/libcxx/blob/24047fd4a7e8231b2220abc1d20b16bc5de3ee87/include/iterator#L512\" rel=\"noreferrer\">libc++ source</a></p>\n\n<p>Both approaches are consistent with the standard's mandated behaviour of <code>std::vector</code> in C++11 and later. The latter approach is recommended (and will be consistent with what the real <code>std::vector</code> is likely to do on typical implementations), because if you pass arguments that are implicitly convertible to the types expected by the fill constructor, you would hope that the class would \"do the right thing\" and not select the range constructor only to have it fail to compile. (Although I suspect this is fairly uncommon.) Relative to the C++03 <code>std::vector</code>, it is a \"conforming extension\" since in that case the constructor call would not compile.</p>\n"}], "owner": {"reputation": 3048, "user_id": 8385554, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/16ab4fec9e219838c24af269960afac8?s=128&d=identicon&r=PG", "display_name": "Leedehai", "link": "https://stackoverflow.com/users/8385554/leedehai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 45848470, "answer_count": 3, "score": 1, "last_activity_date": 1503518948, "creation_date": 1503515949, "last_edit_date": 1503518948, "question_id": 45847787, "link": "https://stackoverflow.com/questions/45847787/how-to-differentiate-fill-constructor-and-range-constructor-in-c11", "title": "How to differentiate fill constructor and range constructor in C++11?", "body": "<p>I suspect the prototypes of fill constructor and range constructor of <code>std::vector</code> (and many other STL types) given in this <a href=\"http://www.cplusplus.com/reference/vector/vector/vector/\" rel=\"nofollow noreferrer\">webpage</a> are not right, so I implement a <code>NaiveVector</code> to mimic these two prototypes.</p>\n\n<p>My code is:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\ntemplate &lt;typename T&gt;\nstruct NaiveVector {\n  vector&lt;T&gt; v;\n  NaiveVector(size_t num, const T &amp;val) : v(num, val) { // fill\n    cout &lt;&lt; \"(int num, const T &amp;val)\" &lt;&lt; endl;\n  }\n\n  template &lt;typename InputIterator&gt;\n  NaiveVector(InputIterator first, InputIterator last) : v(first, last) { // range\n    cout &lt;&lt; \"(InputIterator first, InputIterator last)\" &lt;&lt; endl;\n  }\n\n  size_t size() const { return v.size(); }\n};\n\nint main() {\n  NaiveVector&lt;int&gt; myVec1(5,1);                   // A\n  cout &lt;&lt; \"size = \" &lt;&lt; myVec1.size() &lt;&lt; endl;\n  for (auto n : myVec1.v) { cout &lt;&lt; n &lt;&lt; \" \"; }\n  cout &lt;&lt; endl;\n\n  cout &lt;&lt; \"-----\" &lt;&lt; endl;\n\n  vector&lt;int&gt; vec({1,2,3,4,5});               \n  NaiveVector&lt;int&gt; myVec2(vec.begin(), vec.end());// B\n  cout &lt;&lt; \"size = \" &lt;&lt; myVec2.size() &lt;&lt; endl;\n  for (auto n : myVec2.v) { cout &lt;&lt; n &lt;&lt; \" \"; }\n  cout &lt;&lt; endl;\n}\n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code>$ g++ overload.cc -o overload -std=c++11\n$ ./overload\n(InputIterator first, InputIterator last) // should be: (int num, const T &amp;val)\nsize = 5\n1 1 1 1 1\n-----\n(InputIterator first, InputIterator last)\nsize = 5\n1 2 3 4 5\n</code></pre>\n\n<p>As I suspected from the beginning, the compiler cannot differentiate the two constructors properly. Then <strong>my question</strong> is: how does <code>std::vector</code>'s fill constructor and range constructor differentiate from each other?</p>\n\n<p><strong>Rephrase</strong>: how to implement the two constructors of this <code>NaiveVector</code>?</p>\n\n<blockquote>\n  <p>This question seems to be a duplicate of <a href=\"https://stackoverflow.com/q/21042872/8385554\">this</a> question but the answer is not satisfying. Additionally, C++11 itself doesn't provide a <code>is_iterator&lt;&gt;</code>.. (MSVC has lots of hacks).</p>\n</blockquote>\n\n<p>Edit: it is allowed to bind an rvalue to a constant lvalue reference, so the first constructor of <code>NaiveVector</code> is valid for <code>A</code>.</p>\n"}, {"tags": ["c++", "circular-dependency", "incomplete-type"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503515870, "post_id": 45847732, "comment_id": 78653620, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/625799/resolve-header-include-circular-dependencies\">Resolve header include circular dependencies</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1503515898, "post_id": 45847732, "comment_id": 78653637, "body": "When you forward declare a class, you still need to include the header which provides it&#39;s definition before you use it. For example, you need to include &quot;character.h&quot; in &quot;action.cpp&quot;."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1503516030, "post_id": 45847732, "comment_id": 78653723, "body": "There are serious errors in this example. <code>*subject=p1;</code> will not do what you want. <code>subject</code> is an uninitialized pointer. Dereferencing is undefined behavior. At the very least, you will need to allocate a new <code>PChar</code> as a copy of your argument."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 8507897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908eba90e847c1a9f7d7d2f807ed784c?s=128&d=identicon&r=PG&f=1", "display_name": "Julian L", "link": "https://stackoverflow.com/users/8507897/julian-l"}, "edited": false, "score": 0, "creation_date": 1503516918, "post_id": 45847856, "comment_id": 78654149, "body": "Thank you! Just including as you said works, I don&#39;t know why I didn&#39;t think of that. I will have to read a bit more about pointers to understand what is the problem there though."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": 0, "last_activity_date": 1503516571, "last_edit_date": 1503516571, "creation_date": 1503516227, "answer_id": 45847856, "question_id": 45847732, "link": "https://stackoverflow.com/questions/45847732/invalid-use-of-incomplete-type-solving-circular-dependencies/45847856#45847856", "title": "&quot;invalid use of incomplete type&quot;. Solving circular dependencies", "body": "<p>You can forward declare type to declare pointer or reference to it. But when you start to use that type (declare it as a value or assign to it or call a method) it must be defined. Including <code>character.h</code> in <code>action.cpp</code> would solve compilation error. Note you have UB in your ctor:</p>\n\n<pre><code>Action::Action(PChar&amp; p1,PChar&amp; p2)\n{\n    *subject=p1;\n    *object=p2;\n}\n</code></pre>\n\n<p>as you dereference uninitialized pointers. You need to make them point somewhere, probably you meant to allocate dynamic memory. In that case <code>std::unique_ptr</code> would be preferrable as would solve issues with <a href=\"http://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">Rule of 3/5/0</a>:</p>\n\n<pre><code>class Action\n{\n    std::unique_ptr&lt;PChar&gt; subject, object;\npublic:\n    ...\n};\n\nAction::Action(const PChar&amp; p1, const PChar&amp; p2) :\n    subject( new PChar(p1) ), object( new PChar(p2) )\n{\n}\n</code></pre>\n\n<p>and when you do not have intention to modify object you better pass it as const reference.</p>\n"}, {"tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": false, "score": 1, "last_activity_date": 1503516451, "creation_date": 1503516451, "answer_id": 45847905, "question_id": 45847732, "link": "https://stackoverflow.com/questions/45847732/invalid-use-of-incomplete-type-solving-circular-dependencies/45847905#45847905", "title": "&quot;invalid use of incomplete type&quot;. Solving circular dependencies", "body": "<p>C++ needs to know the details of a type to be able to compile and assignment operation.</p>\n\n<p>A solution is to include <code>\"Character.h\"</code> also in <code>\"Action.cpp\"</code>.</p>\n"}], "owner": {"reputation": 123, "user_id": 8507897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908eba90e847c1a9f7d7d2f807ed784c?s=128&d=identicon&r=PG&f=1", "display_name": "Julian L", "link": "https://stackoverflow.com/users/8507897/julian-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3695, "favorite_count": 0, "accepted_answer_id": 45847856, "answer_count": 2, "score": 2, "last_activity_date": 1503516571, "creation_date": 1503515686, "question_id": 45847732, "link": "https://stackoverflow.com/questions/45847732/invalid-use-of-incomplete-type-solving-circular-dependencies", "title": "&quot;invalid use of incomplete type&quot;. Solving circular dependencies", "body": "<p>I'm a newbie in C++ and I have been trying different suggestions from other questions but I can't make my code work.</p>\n\n<p>I have a class \"PChar\" and another class \"Action\". An Action has two PChar members and a method of PChar (\"act()\") has to be able to create an Action object. So after trying different things I got this code:</p>\n\n<p>\"action.h\":</p>\n\n<pre><code>#ifndef ACTION_H\n#define ACTION_H\n\nclass PChar;\n\nclass Action\n{\n    PChar *subject, *object;\npublic:\n    Action();\n    Action(PChar&amp; p1, PChar&amp; p2);\n};\n\n\n#endif\n</code></pre>\n\n<p>\"action.cpp\":</p>\n\n<pre><code>#include \"action.h\"\n\nAction::Action(){};\n\nAction::Action(PChar&amp; p1,PChar&amp; p2)\n{\n    *subject=p1;\n    *object=p2;\n};\n</code></pre>\n\n<p>\"character.h\"</p>\n\n<pre><code>#ifndef CHARACTER_H\n#define CHARACTER_H\n\n#include &lt;string&gt;\n\n#include \"action.h\"\n\nclass PChar\n{\npublic:\n    std::string name;\n\n    PChar();\n\n    PChar(std::string input_name);\n\n    void act(PChar&amp; target, Action &amp;action);\n};\n#endif    \n</code></pre>\n\n<p>\"character.cpp\"</p>\n\n<pre><code>#include \"character.h\"\n\nPChar::PChar(){}\n\nPChar::PChar(std::string input_name)\n{\n    name=input_name;\n}\n\nvoid PChar::act(PChar&amp; target, Action&amp; action)\n{\n    action=Action(*this, target);\n}\n</code></pre>\n\n<p>\"main.cpp\"</p>\n\n<pre><code>#include \"action.h\"\n#include \"character.h\"\n\nint main()\n{\n    PChar char1(\"Joe\");\n    PChar char2(\"Matt\");\n    Action handshake;\n    char1.act(char2, handshake);\n}\n</code></pre>\n\n<p>The goal is to create an object \"handshake\" which has both characters as members. When compiling I get the error:</p>\n\n<pre><code>action.cpp:7:10: error: invalid use of incomplete type \u2018class PChar\u2019\n  *subject=p1;\n          ^\nIn file included from action.cpp:1:0:\naction.h:4:7: note: forward declaration of \u2018class PChar\u2019\n class PChar;\n       ^\naction.cpp:8:9: error: invalid use of incomplete type \u2018class PChar\u2019\n  *object=p2;\n         ^\nIn file included from action.cpp:1:0:\naction.h:4:7: note: forward declaration of \u2018class PChar\u2019\n class PChar;\n       ^\n</code></pre>\n\n<p>This is part of a larger project, that's why the files are structured like that, I just simplified the code to reproduce the error. I have tried solutions from other similar questions but they don't seem to work. Any help or tip is welcome. Thank you!</p>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "edited": false, "score": 2, "creation_date": 1503515825, "post_id": 45847702, "comment_id": 78653596, "body": "replace <code>if(dummys.mark == 5)</code> with <code>if(dummys.mark == &#39;5&#39;)</code> and try again"}, {"owner": {"reputation": 1724, "user_id": 5269178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddb19370af3c88392ce8d470f0864da?s=128&d=identicon&r=PG&f=1", "display_name": "Ampati Hareesh", "link": "https://stackoverflow.com/users/5269178/ampati-hareesh"}, "edited": false, "score": 1, "creation_date": 1503516252, "post_id": 45847702, "comment_id": 78653858, "body": "or replace char with int in declaration of Student struct[for the variable mark !!]"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503519296, "post_id": 45847702, "comment_id": 78655287, "body": "Off-topic:  Use <code>std::string</code> for text, not character arrays.  The <code>std::string</code> type can grow dynamically, whereas character arrays have a fixed capacity and can overflow easily."}], "answers": [{"tags": [], "owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "is_accepted": false, "score": 2, "last_activity_date": 1503516053, "creation_date": 1503516053, "answer_id": 45847815, "question_id": 45847702, "link": "https://stackoverflow.com/questions/45847702/c-using-if-else-to-return-values-in-struct/45847815#45847815", "title": "C++, using if/else to return values in struct", "body": "<p>You store the mark in <code>unsigned char</code>, so when you use \n        <code>std::cin &gt;&gt; input.mark;</code> and type '5' the value typed is not parsed into integer type and is saved as indeed '5' - character with integer value 53 (from ASCII table). \nYou can use <code>dummys.mark == '5'</code> comparision and get your code working.</p>\n"}], "owner": {"reputation": 11, "user_id": 7415601, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rC1rBBrIFHo/AAAAAAAAAAI/AAAAAAAAACc/ZrAKhCsc1hc/photo.jpg?sz=128", "display_name": "Jasmont", "link": "https://stackoverflow.com/users/7415601/jasmont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1503597151, "answer_count": 1, "score": -1, "last_activity_date": 1503516053, "creation_date": 1503515558, "question_id": 45847702, "link": "https://stackoverflow.com/questions/45847702/c-using-if-else-to-return-values-in-struct", "closed_reason": "Not suitable for this site", "title": "C++, using if/else to return values in struct", "body": "<p>I'm learning \"struct\" and I don't understand why it is not returning values from struct based on conditions. Here's my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n\nstruct Student{\n    char name[15];\n    unsigned char mark;\n};\n\nstruct Group{\n    Student *students;\n    size_t size;\n};\n\nint main()\n{\n    const size_t N = 2;\n\n    std::cout &lt;&lt; \"Student(s) we have: \" &lt;&lt; std::endl;\n\n    Group group;\n    group.size = N;\n    group.students = new Student[N];\n\n    for(size_t i = 0; i &lt; N; ++i)\n    {\n        Student &amp;input = group.students[i];\n        std::cout &lt;&lt; \"Student #\" &lt;&lt; i + 1 &lt;&lt; \": \";\n        std::cin &gt;&gt; input.name;\n        std::cout &lt;&lt; \"Score: \";\n        std::cin &gt;&gt; input.mark;\n    }\n\n    for(int i = 0; i &lt; N; ++i)\n    {\n        const Student &amp;dummys = group.students[i];\n        if(dummys.mark == 5) std::cout &lt;&lt; dummys.name &lt;&lt; std::endl;\n    }\n\n    delete[] group.students;\n\n    return 0;\n}\n</code></pre>\n\n<p>I want to return a student who's score is '5' (I should enter student's name and mark). When I do - my code returns nothing...</p>\n"}, {"tags": ["c++", "qt", "cmake", "linker"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1503518497, "post_id": 45847696, "comment_id": 78654919, "body": "You need Qt binaries built with mingw instead of Visual Studio."}, {"owner": {"reputation": 77, "user_id": 5040788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1347dd2b69c1b42ebfc5c9abe738b47d?s=128&d=identicon&r=PG&f=1", "display_name": "aquaatic", "link": "https://stackoverflow.com/users/5040788/aquaatic"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503518844, "post_id": 45847696, "comment_id": 78655066, "body": "That makes sense - I&#39;ll give it a try. So do I just need to install the precompiled binaries or is the toolchain needed aswell?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1503519307, "post_id": 45847696, "comment_id": 78655294, "body": "Binaries should be fine. I assume your  mingw toolchain works."}], "owner": {"reputation": 77, "user_id": 5040788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1347dd2b69c1b42ebfc5c9abe738b47d?s=128&d=identicon&r=PG&f=1", "display_name": "aquaatic", "link": "https://stackoverflow.com/users/5040788/aquaatic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503515537, "creation_date": 1503515537, "question_id": 45847696, "link": "https://stackoverflow.com/questions/45847696/qt5-cmake-windows-linker-error", "title": "Qt5 cmake Windows Linker Error", "body": "<p>I just wanted to start a new project which uses Qt in combination with CMake. I (hope I) followed the docs, but it seems as if the linker is not doing its work correctly:</p>\n\n<pre><code>CMakeFiles\\QtTest.dir/objects.a(main.cpp.obj): In function `QString::QString(char const*)':\nP:/Qt/5.9.1/msvc2015_64/include/QtCore/qstring.h:659: undefined reference to `__imp__ZN7QString16fromAscii_helperEPKci'\nCMakeFiles\\QtTest.dir/objects.a(main.cpp.obj): In function `QTypedArrayData&lt;unsigned short&gt;::deallocate(QArrayData*)':\nP:/Qt/5.9.1/msvc2015_64/include/QtCore/qarraydata.h:237: undefined reference to `__imp__ZN10QArrayData10deallocateEPS_yy'\n</code></pre>\n\n<p>I'm using mingw-w64 (the x86_64 installation) with CLion and its bundled CMake and Qt 5.9.1. My CMakeLists.txt looks like this:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(QtTest)\n\nset(CMAKE_CXX_STANDARD 14)\nset(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR})\n\nset(CMAKE_VERBOSE_MAKEFILE ON)\n\n\n# Qt\nset(CMAKE_INCLUDE_CURRENT_DIR ON)\nset(CMAKE_AUTOMOC ON)\nset(Qt5_NO_LINK_QTMAIN ON)\n\nset(CMAKE_PREFIX_PATH P:/Qt/5.9.1/msvc2015_64/lib/cmake)\nfind_package(Qt5Core REQUIRED)\n\nget_target_property(QtCore_location Qt5::Core LOCATION)\nmessage(\"QtCore version ${Qt5Core_VERSION} is at ${QtCore_location}\")\n\n# QtTest executable\nset(SOURCE_FILES main.cpp)\nadd_executable(QtTest ${SOURCE_FILES})\ntarget_link_libraries(QtTest Qt5::Core)\n</code></pre>\n\n<p>When creating the build files it outputs (correctly) <code>QtCore version 5.9.1 is at P:/Qt/5.9.1/msvc2015_64/bin/Qt5Core.dll</code>\nThe main.cpp contains just a call to QString for testing purposes:</p>\n\n<pre><code>#include &lt;QtCore/QString&gt;\n\nint main() {\n    QString string = QString(\"test\");\n}\n</code></pre>\n\n<p>Why does this happen?</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1503515520, "post_id": 45847666, "comment_id": 78653451, "body": "Err, this answer is a bit vague (yes, what Nicol said)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1503515677, "post_id": 45847666, "comment_id": 78653532, "body": "@Nicol  Right - fixed it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": false, "score": 3, "last_activity_date": 1503515523, "last_edit_date": 1503515523, "creation_date": 1503515424, "answer_id": 45847666, "question_id": 45847612, "link": "https://stackoverflow.com/questions/45847612/assignment-operators-return-value-can-be-a-reference/45847666#45847666", "title": "Assignment operator&#39;s return value can be a reference?", "body": "<p>Assignment returns a reference to the object being assigned to (not the object being assigned from), which in this case is the lvalue <code>ok</code>, so the code is also ok, though perhaps not great.</p>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1503515741, "post_id": 45847721, "comment_id": 78653556, "body": "I think you can remove &quot;probably&quot;. Canonical assignment should be written the same way they work for embedded types."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1503515790, "post_id": 45847721, "comment_id": 78653576, "body": "@Slava I wrote probably only because strictly speaking I&#39;m speculating as to what was on the mind of whoever decided that this would be the canonical form, but I see your point, I&#39;ll remove it."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1503515978, "post_id": 45847721, "comment_id": 78653678, "body": "I&#39;d say as of C++11 this is not canonical anymore. Sometimes the pass-by-value version is better."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1503516581, "post_id": 45847721, "comment_id": 78654013, "body": "@Brian Not really. Pass-by-value usually means writing swap by hand. There are multiple performance issues with this: implementing move assignment in terms of swap is inefficient, copy construction is often inefficient compared to assignment, etc. The core guidelines specifically suggest passing by <code>const&amp;</code>. It can save a very small amount of code duplication, in very specific circumstances; usually code duplication is better avoided with the rule of zero. Hinnant and Meyers have both recommended against it. Etc. If you have a good source arguing its merits I&#39;d be curious to see it."}], "tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": false, "score": 6, "last_activity_date": 1503515801, "last_edit_date": 1503515801, "creation_date": 1503515624, "answer_id": 45847721, "question_id": 45847612, "link": "https://stackoverflow.com/questions/45847612/assignment-operators-return-value-can-be-a-reference/45847721#45847721", "title": "Assignment operator&#39;s return value can be a reference?", "body": "<p>The canonical assignment operator for a class <code>Foo</code> looks like this:</p>\n\n<pre><code>class Foo {\n  ...\n\n  Foo&amp; operator=(const Foo&amp; other) {\n    // make this the same as other\n    return *this;\n  }\n};\n</code></pre>\n\n<p>As you can see, it does return a reference. In this case the object is <code>ok</code>, and so it returns a reference to <code>ok</code>, which is an lvalue, which is why the call works.</p>\n\n<p>Bool of course is not a class but nonetheless it works the same way, this is <em>why</em> the canonical assignment operator is written just like this.</p>\n\n<p>As an aside, I personally don't really care for exploiting this very much and I would probably have written the <code>doSomething(ok=false)</code> as two lines, and I suspect many other people would too.</p>\n"}], "owner": {"reputation": 2167, "user_id": 552613, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/W4tCs.gif?s=128&g=1", "display_name": "Addy", "link": "https://stackoverflow.com/users/552613/addy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "closed_date": 1503515783, "answer_count": 2, "score": 1, "last_activity_date": 1503515801, "creation_date": 1503515210, "last_edit_date": 1503515435, "question_id": 45847612, "link": "https://stackoverflow.com/questions/45847612/assignment-operators-return-value-can-be-a-reference", "closed_reason": "Duplicate", "title": "Assignment operator&#39;s return value can be a reference?", "body": "<p>I was surprised to see a bit of syntax in a co-worker's code today. </p>\n\n<pre><code>void doSomething(bool&amp; boolRef);\n\nbool ok = true;\ndoSomething(ok = false);\n</code></pre>\n\n<p>I would think this is an error since the assignment operator in the param, <code>ok = false</code>, returns the value of the assigned value, which in this case is false. And since <code>doSomething</code> is expecting a reference, my first reaction was \"that shouldn't work\" since it would seem almost identical to doing <code>doSomething(false);</code></p>\n\n<p>But alas it does work. And reassigning the value of reference inside of <code>doSomething</code> works just like you'd expect.</p>\n\n<p>Can someone please explain why this works?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "windows", "winapi", "bitmap", "gdi+"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1503516537, "post_id": 45847610, "comment_id": 78653990, "body": "if you want idea - call <code>Image::GetLastStatus </code> - may be this give you hint"}], "answers": [{"comments": [{"owner": {"reputation": 6658, "user_id": 3697757, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0aQ16.jpg?s=128&g=1", "display_name": "hackjutsu", "link": "https://stackoverflow.com/users/3697757/hackjutsu"}, "edited": false, "score": 0, "creation_date": 1503523963, "post_id": 45847904, "comment_id": 78657367, "body": "Awesome, I didn&#39;t realize there are startup &amp; shutdown methods."}, {"owner": {"reputation": 6658, "user_id": 3697757, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0aQ16.jpg?s=128&g=1", "display_name": "hackjutsu", "link": "https://stackoverflow.com/users/3697757/hackjutsu"}, "edited": false, "score": 0, "creation_date": 1503529416, "post_id": 45847904, "comment_id": 78659317, "body": "Just curious, <code>HICON</code>&#39;s height would behave differently depending on if  <code>hbmColor</code> is present or not (colorful or monochrome). Does the <code>Gdiplus::Bitmap::FromHICON</code> handle this properly?"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "reply_to_user": {"reputation": 6658, "user_id": 3697757, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0aQ16.jpg?s=128&g=1", "display_name": "hackjutsu", "link": "https://stackoverflow.com/users/3697757/hackjutsu"}, "edited": false, "score": 0, "creation_date": 1503533792, "post_id": 45847904, "comment_id": 78660305, "body": "@hackjutsu You should probably post that as a separate question."}], "tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": true, "score": 2, "last_activity_date": 1503521074, "last_edit_date": 1503521074, "creation_date": 1503516448, "answer_id": 45847904, "question_id": 45847610, "link": "https://stackoverflow.com/questions/45847610/failure-for-gdiplusbitmapfromhicon/45847904#45847904", "title": "Failure for Gdiplus::Bitmap::FromHICON", "body": "<p>You need to initialize the GDI+ engine using the <a href=\"https://msdn.microsoft.com/en-us/library/ms534077(VS.85).aspx\" rel=\"nofollow noreferrer\">GdiplusStartup</a> function first:</p>\n\n<pre><code>HICON hIcon = LoadIcon(NULL, IDI_WINLOGO);\nassert(hIcon != nullptr); // passed\nGdiplusStartupInput gdiplusStartupInput;\nULONG_PTR gdiplusToken;\nGdiplusStartup(&amp;gdiplusToken, &amp;gdiplusStartupInput, NULL);\nGdiplus::Bitmap *pIcon = Gdiplus::Bitmap::FromHICON(hIcon);\nassert(pIcon != nullptr); // now OK\nGdiplusShutdown(gdiplusToken);\n</code></pre>\n"}], "owner": {"reputation": 6658, "user_id": 3697757, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0aQ16.jpg?s=128&g=1", "display_name": "hackjutsu", "link": "https://stackoverflow.com/users/3697757/hackjutsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 45847904, "answer_count": 1, "score": 0, "last_activity_date": 1503522318, "creation_date": 1503515200, "last_edit_date": 1503522318, "question_id": 45847610, "link": "https://stackoverflow.com/questions/45847610/failure-for-gdiplusbitmapfromhicon", "title": "Failure for Gdiplus::Bitmap::FromHICON", "body": "<p>I'm trying to convert a <code>HICON</code> to <code>Gdiplus::Bitmap</code> by calling <code>Gdiplus::Bitmap::FromHICON</code> as shown below. </p>\n\n<p>I created a windows icon by calling <code>LoadIcon</code>, and verified the icon is valid by drawing on screen. </p>\n\n<p>Surprisingly, I still got a <code>NULL</code> pointer. I revisited the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms536292(v=vs.85).aspx\" rel=\"nofollow noreferrer\">win32 documents</a> but cannot find what I'm missing.</p>\n\n<pre><code>HICON hIcon = LoadIcon(NULL, IDI_WINLOGO);\nassert( hIcon != nullptr ); // passed\n\nGdiplus::Bitmap *pIcon = Gdiplus::Bitmap::FromHICON(hIcon);\n\nassert( pIcon != nullptr ); // failed\n</code></pre>\n\n<p>Does anyone have some idea? Thanks:)</p>\n"}, {"tags": ["c++", "object"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 5, "creation_date": 1503515180, "post_id": 45847571, "comment_id": 78653278, "body": "Objects are effectively variables, variables are objects. In neither case do you normally want them to be global."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1503515354, "post_id": 45847571, "comment_id": 78653363, "body": "How are you going to get a global object without storing it in a variable?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1503528126, "post_id": 45847571, "comment_id": 78658909, "body": "All variables are objects"}, {"owner": {"reputation": 3, "user_id": 5073076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c4758e3da6bc9d45b81a808ca766e5?s=128&d=identicon&r=PG&f=1", "display_name": "Brooce", "link": "https://stackoverflow.com/users/5073076/brooce"}, "edited": false, "score": 0, "creation_date": 1503927881, "post_id": 45847571, "comment_id": 78799554, "body": "True - the difference is that objects are generally more organised then &quot;loose&quot; variables (i.e. one object contains many attributes) and that&#39;s why I set them apart, but now I know it doesn&#39;t do much difference either way."}, {"owner": {"reputation": 3, "user_id": 5073076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c4758e3da6bc9d45b81a808ca766e5?s=128&d=identicon&r=PG&f=1", "display_name": "Brooce", "link": "https://stackoverflow.com/users/5073076/brooce"}, "edited": false, "score": 0, "creation_date": 1503927922, "post_id": 45847571, "comment_id": 78799578, "body": "My question stems from another dilemma. I am dealing with embedded systems and it&#39;s quite popular to have plenty of functions in a main file that share file-scoped-variables (what is OK I guess). What I wanted to do was to put all those functions in separate files for clarity - but then those variables will become truly global..."}], "answers": [{"comments": [{"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1503526481, "post_id": 45849666, "comment_id": 78658376, "body": "What are <i>&quot;pod&quot;</i> variables please?"}, {"owner": {"reputation": 1160, "user_id": 8490870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c084fe165955c1d26cbc964c9291f566?s=128&d=identicon&r=PG", "display_name": "DrSvanHay", "link": "https://stackoverflow.com/users/8490870/drsvanhay"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1503527423, "post_id": 45849666, "comment_id": 78658685, "body": "Hey Mark POD stands for Plain Old Data: a class without constructors, destructors and virtual members functions, int, char, wchar_t, bool, float, double are PODs as well as class, struct or union of PODs, provided that all non-static data members are public, and it has no base class and no constructors, destructors, or virtual methods."}, {"owner": {"reputation": 1160, "user_id": 8490870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c084fe165955c1d26cbc964c9291f566?s=128&d=identicon&r=PG", "display_name": "DrSvanHay", "link": "https://stackoverflow.com/users/8490870/drsvanhay"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1503527981, "post_id": 45849666, "comment_id": 78658852, "body": "I replace POD with scalar types, POD was not precise enough and scalar types is much easier to understand"}, {"owner": {"reputation": 3, "user_id": 5073076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c4758e3da6bc9d45b81a808ca766e5?s=128&d=identicon&r=PG&f=1", "display_name": "Brooce", "link": "https://stackoverflow.com/users/5073076/brooce"}, "edited": false, "score": 0, "creation_date": 1503927687, "post_id": 45849666, "comment_id": 78799405, "body": "Thank you for a detailed explanation. Thinking about the threats posed by globals, I was mainly focused on making a mess in the code - that&#39;s why I differentiated objects, which keep the variables together. But it doesn&#39;t make any difference in other aspects indeed."}, {"owner": {"reputation": 3, "user_id": 5073076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c4758e3da6bc9d45b81a808ca766e5?s=128&d=identicon&r=PG&f=1", "display_name": "Brooce", "link": "https://stackoverflow.com/users/5073076/brooce"}, "edited": false, "score": 0, "creation_date": 1503927897, "post_id": 45849666, "comment_id": 78799563, "body": "My question stems from another dilemma. I am dealing with embedded systems and it&#39;s quite popular to have plenty of functions in a main file that share file-scoped-variables (what is OK I guess). What I wanted to do was to put all those functions in separate files for clarity - but then those variables will become truly global..."}, {"owner": {"reputation": 1160, "user_id": 8490870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c084fe165955c1d26cbc964c9291f566?s=128&d=identicon&r=PG", "display_name": "DrSvanHay", "link": "https://stackoverflow.com/users/8490870/drsvanhay"}, "reply_to_user": {"reputation": 3, "user_id": 5073076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c4758e3da6bc9d45b81a808ca766e5?s=128&d=identicon&r=PG&f=1", "display_name": "Brooce", "link": "https://stackoverflow.com/users/5073076/brooce"}, "edited": false, "score": 0, "creation_date": 1503941784, "post_id": 45849666, "comment_id": 78807528, "body": "@Brooce I&#180;m not so much into the embedded stuff, only some atmel things. But ... C++ is really written with performance in mind, static members come at no cost. Given what you say, I would check out whether a class with only static members might be a solution. You can hide or expose the functions, you can hide and expose your globals aka static members. And the definition can be split over several files. Thorough planning is needed to avoid putting chaos to a new level, especially with the static member variables, but if well done that might be what you&#180;re looking for."}], "tags": [], "owner": {"reputation": 1160, "user_id": 8490870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c084fe165955c1d26cbc964c9291f566?s=128&d=identicon&r=PG", "display_name": "DrSvanHay", "link": "https://stackoverflow.com/users/8490870/drsvanhay"}, "is_accepted": true, "score": 1, "last_activity_date": 1503528526, "last_edit_date": 1503528526, "creation_date": 1503524261, "answer_id": 45849666, "question_id": 45847571, "link": "https://stackoverflow.com/questions/45847571/is-it-ok-to-use-global-scope-objects-structs-in-c-c/45849666#45849666", "title": "Is it OK to use global-scope objects (structs) in C++ (C)?", "body": "<h3>summary</h3>\n\n<p>Global scalar type variables are a tool and tools are not good or bad, their use is appropriate or inappropriate. Adding the power of classes to that tool is not good or bad, it has the potential to improve the appropriateness or deteriorate the appropriateness.</p>\n\n<h3>Objects</h3>\n\n<p>An answer requires a definition of object. Object is not the complement of variable. The complement of variable is constant. I will use \"scalar types\" as the complement of object.</p>\n\n<h3>The problems of using global scalar type variables</h3>\n\n<p>It seems that the problems of global variables are in general something along</p>\n\n<ul>\n<li>non-locality </li>\n<li>no constraint checking</li>\n<li>coupling</li>\n<li>concurrency problems</li>\n<li>namespace pollution</li>\n<li>testing and debugging</li>\n</ul>\n\n<p>I think as long as we talk about scalar types memory footprint is an argument to be considered obsolete at least for PCs, embedded might be a different thing.</p>\n\n<p>On remark: constants do not have all of this problems, thats why global constants are far more common than global variables.</p>\n\n<h3>The problems of using global objects</h3>\n\n<p>You have to ask yourself whether any of this problems is eliminated by using objects instead of scalar type variables</p>\n\n<p>All of those problems apply to objects as well.</p>\n\n<p>Plus they add all the complexities of classes on top and make every single of those objections worse, at least in general.</p>\n\n<p>With objects you just have more locations to break everything, just some locations more that hinder debugging by side effects. Objects have the tendency to become a little bit more complex, adding to potential consistent initialization problems.</p>\n\n<p>With objects you suddenly not only have to manage access or not, but you have to make sure that every single point of access is compatible to the current interface of your object and the constraints of the underlying data type. Make sure that parts of the program manage ownership correctly.</p>\n\n<p>I think it is not a matter of opinion: If you consider global scalar type variables to be bad you will have to consider global objects to be bad a fortiori.</p>\n\n<h3>cum grano salis</h3>\n\n<p>Of course there are rightful and perfectly justified applications of global scalar type variables as well as of global objects.</p>\n\n<p>And if several global variables are logically connected I think bundling those connections in a global object might tackle some of the objections. E.g. namespace pollution is of course reduced when you move some global scalar type variables in an object. And if there is a invariant in these variables of course the class of a global object is the first place you would be looking for that and a class would definitely the best place to code that invariant. Setters might be a tool to soothe the problem of missing constraints.</p>\n"}], "owner": {"reputation": 3, "user_id": 5073076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c4758e3da6bc9d45b81a808ca766e5?s=128&d=identicon&r=PG&f=1", "display_name": "Brooce", "link": "https://stackoverflow.com/users/5073076/brooce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 45849666, "answer_count": 1, "score": 0, "last_activity_date": 1503528526, "creation_date": 1503515053, "question_id": 45847571, "link": "https://stackoverflow.com/questions/45847571/is-it-ok-to-use-global-scope-objects-structs-in-c-c", "title": "Is it OK to use global-scope objects (structs) in C++ (C)?", "body": "<p>As we all know, it is a bad habit to use global variables unnecessarily and there is a tendency to keep the scope as small as possible.</p>\n\n<p>But what about objects? Or structure instantiations of a similar function in C. Is there anything wrong with using global objects across multiple source files?</p>\n\n<p>Thanks for sheding some light to this issue as I just got a bit... mangled.</p>\n"}, {"tags": ["c++", "c++11", "thread-local"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 4, "creation_date": 1503515046, "post_id": 45847552, "comment_id": 78653209, "body": "I think this is implementation defined."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1503515068, "post_id": 45847552, "comment_id": 78653222, "body": "As with where <i>any</i> variables are stored, it&#39;s implementation specific."}, {"owner": {"reputation": 63, "user_id": 2832978, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000543055238/picture?type=large", "display_name": "Ben Connor", "link": "https://stackoverflow.com/users/2832978/ben-connor"}, "edited": false, "score": 3, "creation_date": 1503515427, "post_id": 45847552, "comment_id": 78653407, "body": "What do common implementations do? Say gcc. In general, we can consider dynamic allocations using malloc/new to be on heap, local variables and function arguments to be on stack. Most implementations stick to this. Given this context, where do thread_local variables go?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1503516052, "post_id": 45847552, "comment_id": 78653739, "body": "@Ben Thread local variables are very implementation specific because the underlying OS thread facilities are different (cf Windows, POSIX)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503524732, "post_id": 45847552, "comment_id": 78657705, "body": "It works by magic. Imagine there&#39;s a plain global (mutexed-off or otherwise protected from races) <code>std::map&lt;std::thread::id,void*&gt; TLS</code> somewhere. You can retrieve your TLS with <code>TLS[std::this_thread::get_id()]</code>. Actually implementations on x86 use <code>%fs</code> (or <code>%gs</code> on 32 bits) as the base for the TLS segment. Is that really important?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2832978, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000543055238/picture?type=large", "display_name": "Ben Connor", "link": "https://stackoverflow.com/users/2832978/ben-connor"}, "edited": false, "score": 1, "creation_date": 1503517071, "post_id": 45847832, "comment_id": 78654214, "body": "Sorry, if not clear. I want to make a global variable (just declared in same header as of Class declaration) as thread_lcoal.  Also, its the same object instance being used by both threads. So member variables are anyway same, hence guarded using locks."}, {"owner": {"reputation": 8593, "user_id": 732454, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ddb83f70a52b1a6689a7a44b270908e5?s=128&d=identicon&r=PG", "display_name": "stefan bachert", "link": "https://stackoverflow.com/users/732454/stefan-bachert"}, "reply_to_user": {"reputation": 63, "user_id": 2832978, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000543055238/picture?type=large", "display_name": "Ben Connor", "link": "https://stackoverflow.com/users/2832978/ben-connor"}, "edited": false, "score": 2, "creation_date": 1503518972, "post_id": 45847832, "comment_id": 78655127, "body": "When all threads share the same object, you don&#39;t need thread_local. If some threads share an object, you have to pass that information, at thread creation time for example, and you need a thread_local pointer to that object."}, {"owner": {"reputation": 63, "user_id": 2832978, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000543055238/picture?type=large", "display_name": "Ben Connor", "link": "https://stackoverflow.com/users/2832978/ben-connor"}, "edited": false, "score": 0, "creation_date": 1503519330, "post_id": 45847832, "comment_id": 78655308, "body": "The object pointer is being passed as you said. No thread_lcoal declaration on that pointer. Few member functions need to know which thread they are being called from. Hence thinking of a thread_local global variable in the header file."}], "tags": [], "owner": {"reputation": 8593, "user_id": 732454, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ddb83f70a52b1a6689a7a44b270908e5?s=128&d=identicon&r=PG", "display_name": "stefan bachert", "link": "https://stackoverflow.com/users/732454/stefan-bachert"}, "is_accepted": false, "score": -1, "last_activity_date": 1503516135, "creation_date": 1503516135, "answer_id": 45847832, "question_id": 45847552, "link": "https://stackoverflow.com/questions/45847552/c-where-are-thread-local-variables-stored/45847832#45847832", "title": "C++ - Where are thread_local variables stored?", "body": "<p>Your descriptions sounds that you want to mark some non-static member var as thread_local. This is not allowed.</p>\n\n<p><code>thread_local</code> is somewhat like <code>static</code> (global), but specific for each thread while <code>static</code> is shared across all threads</p>\n\n<p>Each thread holds own memory ranges. for example an own stack. </p>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/language/storage_duration\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/storage_duration</a><a href=\"http://en.cppreference.com/w/cpp/language/storage_duration\" rel=\"nofollow noreferrer\">Referen</a></p>\n"}, {"comments": [{"owner": {"reputation": 2920, "user_id": 3022952, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b62f68f2f334d828423b8706fc88c56e?s=128&d=identicon&r=PG&f=1", "display_name": "R.M.", "link": "https://stackoverflow.com/users/3022952/r-m"}, "edited": false, "score": 2, "creation_date": 1507172949, "post_id": 45849265, "comment_id": 80107566, "body": "Is the data stored in the actual table itself? That seems odd, as if you have different sized thread_local objects, there&#39;s not a consistent &quot;slot&quot; size. If the table doesn&#39;t store the objects themselves, but instead just pointers to the objects, where are the objects themselves being allocated? In either case, where/how is the table itself being allocated in memory, such that it can handle the widely varying number (and size?) of potential thread_local objects?"}], "tags": [], "owner": {"reputation": 694, "user_id": 2160290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da403b7839453e0dd04600de49d5ca11?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Rastogi", "link": "https://stackoverflow.com/users/2160290/amit-rastogi"}, "is_accepted": true, "score": 4, "last_activity_date": 1503523111, "last_edit_date": 1503523111, "creation_date": 1503522370, "answer_id": 45849265, "question_id": 45847552, "link": "https://stackoverflow.com/questions/45847552/c-where-are-thread-local-variables-stored/45849265#45849265", "title": "C++ - Where are thread_local variables stored?", "body": "<p><strong>1. As I understand, both threads will get their own copy of this variable, correct?</strong><br>\n Yes. Each thread gets its own copy of the thread_local variable.<br>\n<strong>2. Where exactly is the thread local variable stored in memory? If data segment, how exactly does the right variable gets picked up during execution?</strong><br>\n thread_local is the implementation of the Thread Local Storage concept. TLS is  implemented as a table of slots withing each thread object. Each thread having its own copy of the table. For e.g in Windows implementation of TLS this table is within the Thread Information Block of a thread. When a global/static variable is declared as thread_local, it would get associated with a table slot of each thread at the same offset. When the thread_local variable is accessed by a thread then using the current thread context, the thread's own copy of the variable associated with the table slot within this thread object is accessed. Please check this link for more detail on TLS implementation. <a href=\"https://en.wikipedia.org/wiki/Thread-local_storage\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Thread-local_storage</a></p>\n"}, {"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 5, "last_activity_date": 1503585382, "last_edit_date": 1503585382, "creation_date": 1503523356, "answer_id": 45849474, "question_id": 45847552, "link": "https://stackoverflow.com/questions/45847552/c-where-are-thread-local-variables-stored/45849474#45849474", "title": "C++ - Where are thread_local variables stored?", "body": "<p>In the case of 64 bit Windows, the TLS can be accessed via the GS selector register, using a separate physical address space per thread (allocated during CreateThread()), although Visual Studio may map the TLS into a process / thread virtual address space, with each thread getting a different virtual address, since it's a different physical address for each thread. You can look at the disassembled code by stepping into rand() with a debugger to see how it accesses the seed, which is a TLS variable.</p>\n"}], "owner": {"reputation": 63, "user_id": 2832978, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000543055238/picture?type=large", "display_name": "Ben Connor", "link": "https://stackoverflow.com/users/2832978/ben-connor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4633, "favorite_count": 2, "accepted_answer_id": 45849265, "answer_count": 3, "score": 6, "last_activity_date": 1503585382, "creation_date": 1503514953, "last_edit_date": 1503515043, "question_id": 45847552, "link": "https://stackoverflow.com/questions/45847552/c-where-are-thread-local-variables-stored", "title": "C++ - Where are thread_local variables stored?", "body": "<p>I am trying to understand how exactly thread_local qualifier works and where the actual variable gets stored? This is on C++.</p>\n\n<p>Say I have a class with multiple member variables. An objet of the class is instantiated on heap and the object is shared between 2 threads. Appropriate locking mechanism is used to ensure two threads are not stomping on a member variable at same time.</p>\n\n<p>There is a need for threads to keep track of few thread specific items. So I am thinking to create a thread_local variable in same header file as the Class declaration. As I understand, both threads will get their own copy of this variable, correct? Where exactly is the thread local variable stored in memory? If data segment, how exactly does the  right variable gets picked up during execution?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23, "user_id": 8039903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde703fc36448a40438018117e0e65?s=128&d=identicon&r=PG&f=1", "display_name": "moon", "link": "https://stackoverflow.com/users/8039903/moon"}, "reply_to_user": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503515454, "post_id": 45847535, "comment_id": 78653418, "body": "is there any other way except for std::map?"}], "answers": [{"comments": [{"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503516436, "post_id": 45847863, "comment_id": 78653943, "body": "OP says: <i>&quot;Below is my code. I understand that I did a for loop. But I&#39;m not too sure how I can display a single result, without looping it.&quot;</i> So problem isnt in that it prints all seminars (there is an condition so it prints just one), as you think, but in using loop."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503516541, "post_id": 45847863, "comment_id": 78653992, "body": "@FilipKo\u010dica Also OP: &quot;<i>The code that I have is able to print out the result, however it display all the result that it loop through. Is there a way for me to print the result just for that particular seminar that the user had input?</i>&quot; Your quote says that the problem is that the output is &quot;looped&quot; and not just a single result."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503516590, "post_id": 45847863, "comment_id": 78654018, "body": "You still dont get it. OP dont want to use loop to search for seminar, but your code <i>has</i> loop."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503516814, "post_id": 45847863, "comment_id": 78654106, "body": "@FilipKo\u010dica No, you don&#39;t get it. OP wants to use a loop to search for the seminar, but they don&#39;t want the output to &quot;loop&quot;; i.e. they only want to display a single result."}, {"owner": {"reputation": 23, "user_id": 8039903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde703fc36448a40438018117e0e65?s=128&d=identicon&r=PG&f=1", "display_name": "moon", "link": "https://stackoverflow.com/users/8039903/moon"}, "edited": false, "score": 1, "creation_date": 1503516981, "post_id": 45847863, "comment_id": 78654176, "body": "@melpomene Thanks for the help. That is what I needed."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503517016, "post_id": 45847863, "comment_id": 78654193, "body": "But here is an condition <code>if( theSeminar[i].Title == sem)</code> which will print only seminar which OP asks for. Also this <i>&quot;But I&#39;m not too sure how I can display a single result, without looping it.&quot;</i> is extremely misleading."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 0, "last_activity_date": 1503516260, "creation_date": 1503516260, "answer_id": 45847863, "question_id": 45847535, "link": "https://stackoverflow.com/questions/45847535/how-to-display-one-result-in-for-loop/45847863#45847863", "title": "How to display one result in for loop", "body": "<p>You need to move the printing out of the loop. You can do that by adding a <code>found</code> variable that you can check afterwards:</p>\n\n<pre><code>void registerSem(string sem){\n    bool found = false;\n    for (int i = 0; i &lt; 4; i++)\n    {\n       if( theSeminar[i].Title == sem){\n            found = true;\n            if (theSeminar[i].Capacity &gt; 0)\n            {\n                theSeminar[i].Capacity = theSeminar[i].Capacity - 1;\n                cout &lt;&lt; \"Successful registered!\" &lt;&lt; endl;    \n            }\n            else{\n                cout &lt;&lt; \"Unsuccessful registration\" &lt;&lt; endl;\n            }\n            break;\n       }\n    }\n    if (!found)\n    {\n        cout &lt;&lt; \"Not Found\" &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>You could also streamline the code by returning from the whole function once a seminar is found:</p>\n\n<pre><code>void registerSem(string sem) {\n    for (int i = 0; i &lt; 4; i++) {\n        if (theSeminar[i].Title == sem) {\n            if (theSeminar[i].Capacity &gt; 0) {\n                theSeminar[i].Capacity -= 1;\n                cout &lt;&lt; \"Successfully registered!\\n\";\n            }\n            else {\n                cout &lt;&lt; \"Unsuccessful registration\\n\";\n            }\n            return;\n        }\n    }\n    cout &lt;&lt; \"Not found\\n\";\n}\n</code></pre>\n\n<hr>\n\n<p>Alternatively, you could separate the concerns of finding the right seminar and doing something with it:</p>\n\n<pre><code>void registerSem(string sem) {\n    int found_at = -1;\n    for (int i = 0; i &lt; 4; i++) {\n        if (theSeminar[i].Title == sem) {\n            found_at = i;\n            break;\n        }\n    }\n\n    if (found_at == -1) {\n        cout &lt;&lt; \"Not found\\n\";\n        return;\n    }\n\n    if (theSeminar[found_at].Capacity &lt;= 0) {\n        cout &lt;&lt; \"Unsuccessful registration\\n\";\n        return;\n    }\n\n    theSeminar[found_at].Capacity -= 1;\n    cout &lt;&lt; \"Successfully registered!\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8039903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde703fc36448a40438018117e0e65?s=128&d=identicon&r=PG&f=1", "display_name": "moon", "link": "https://stackoverflow.com/users/8039903/moon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 45847863, "answer_count": 1, "score": 0, "last_activity_date": 1503516260, "creation_date": 1503514887, "last_edit_date": 1503515567, "question_id": 45847535, "link": "https://stackoverflow.com/questions/45847535/how-to-display-one-result-in-for-loop", "title": "How to display one result in for loop", "body": "<p>I've this program that is dealing with registration on seminar.</p>\n\n<p>I'v managed to do up the struct class, and also able to list out the seminar.\nCurrently, I have an issue with the registration.\nThe problem goes like this:\nThe user would input the seminar that he would like to register for.\nOnce the user registered the seminar, it will result that the seminar is either registered successfully (if there's slot), or unsuccessfully (if all slot are taken).</p>\n\n<p>The code that I have is able to print out the result, however it display all the result that it loop through. Is there a way for me to print the result just for that particular seminar that the user had input?</p>\n\n<p>Below is my code.\nI understand that I did a for loop.\nBut I'm not too sure how I can display a single result, without looping it.</p>\n\n<p>Struct:</p>\n\n<pre><code>     struct Seminar\n        {\n            string Title;\n            int Capacity;\n        };\nSeminar theSeminar[4];\n</code></pre>\n\n<p>function:</p>\n\n<pre><code>void registerSem(string sem){\n\n    for (int i = 0; i &lt; 4; i++)\n    {\n       if( theSeminar[i].Title == sem){\n            if (theSeminar[i].Capacity &gt; 0)\n            {\n                theSeminar[i].Capacity = theSeminar[i].Capacity - 1;\n                cout &lt;&lt; \"Successful registered!\" &lt;&lt; endl;\n\n            }\n            else{\n                cout &lt;&lt; \"Unsuccessful registration\" &lt;&lt; endl;\n            }\n       }\n       else{\n           cout &lt;&lt; \"Not Found\" &lt;&lt; endl;\n       }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1503514812, "post_id": 45847394, "comment_id": 78653091, "body": "To access an specific pixel in an array, inside too loops whose variables are <code>i</code> and <code>j</code>, you should <code>image[(i * image.cols * image.channels)+(j*image.channels)+desiredChannel]</code>"}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "reply_to_user": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1503514942, "post_id": 45847394, "comment_id": 78653156, "body": "You mean in finalSrc assignment ?"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1503514960, "post_id": 45847394, "comment_id": 78653168, "body": "The <code>cvtColor</code> is rather useless -- you could just swap <code>r</code> with <code>b</code> in the loop. <code>finalSrc</code> seems to be 3x the necessary size. The input indexing is also quite unnecessary, you could just iterate over the elements."}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1503515085, "post_id": 45847394, "comment_id": 78653230, "body": "@DanMa\u0161ek Can you post an answer please with these adjustments ?"}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1503515093, "post_id": 45847394, "comment_id": 78653234, "body": "No, <code>r</code>, <code>g</code>, <code>b</code> assignment"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 1, "creation_date": 1503517077, "post_id": 45847394, "comment_id": 78654216, "body": "opencv doesn&#39;t support unsigned int type, only signed int (.convertTo(CV_32S))"}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "reply_to_user": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1503517171, "post_id": 45847394, "comment_id": 78654254, "body": "@Micka I converted cv::Mat videoFrame(srcIm.rows, srcIm.cols, CV_32S, finalSrc); but still I get white image"}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503517337, "post_id": 45847394, "comment_id": 78654322, "body": "I have updated the code regarding the comments, but I still get white image"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1503518051, "post_id": 45847394, "comment_id": 78654677, "body": "as I said, openCV doesn&#39;t allow UNSIGNED int, only signed int. In your question it is completelty unclear what you want to achieve, if you want a single int to represent RGB values, use CV_8UC4 instead, encoding 1 int to be BGRA values. Currently you are creating a single channel Mat which uses uninitialized memory values."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503519177, "post_id": 45848480, "comment_id": 78655220, "body": "The thing is I want to store the cv::Mat into unsigned int []"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "reply_to_user": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503520044, "post_id": 45848480, "comment_id": 78655647, "body": "@andre Same principle will apply, just replace <code>videoFrame</code>."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "reply_to_user": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503521010, "post_id": 45848480, "comment_id": 78656090, "body": "@andre In what sense does it not work? Can you elaborate, please? Unfortunately I don&#39;t have a copy of VS2017 to test it with, but it definitely seems a bit odd, it&#39;s been part of the c++ for ages now. Perhaps I missed an include, it should be in <code>&lt;algorithm&gt;</code>."}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503521218, "post_id": 45848480, "comment_id": 78656192, "body": "It&#39;s a security issue, so I disabled the warning. But thanks for the answer. Is it possible to see the result in a cv::Mat, I know its not possible, but I converted the videoFrame to CV_32S"}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503522430, "post_id": 45848480, "comment_id": 78656737, "body": "an off question, how do I calculate the stride for a cv::Mat"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "reply_to_user": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503522972, "post_id": 45848480, "comment_id": 78656964, "body": "@andre Please, post that as a new question."}, {"owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "edited": false, "score": 0, "creation_date": 1503525084, "post_id": 45848480, "comment_id": 78657854, "body": "<a href=\"https://stackoverflow.com/questions/45849832/how-do-i-calculate-the-stride-for-a-cvmat\" title=\"how do i calculate the stride for a cvmat\">stackoverflow.com/questions/45849832/&hellip;</a>"}], "tags": [], "owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "is_accepted": true, "score": 2, "last_activity_date": 1503520123, "last_edit_date": 1503520123, "creation_date": 1503518948, "answer_id": 45848480, "question_id": 45847394, "link": "https://stackoverflow.com/questions/45847394/converting-cvmat-to-unsigned-int-pixels/45848480#45848480", "title": "Converting cv::Mat to unsigned int pixels", "body": "<p>IMHO there are multiple opportunities to simplify the code.</p>\n\n<ol>\n<li><p>Drop the <code>cvtColor</code>. You're iterating over the elements anyway, so just swap <code>r</code> and <code>b</code> in your loop body and you can avoid the conversion.</p></li>\n<li><p><code>finalSrc</code> array is 3x the needed size. It's a single channel <code>Mat</code>, so you just need <code>srcIm.rows * srcIm.cols</code> elements.</p></li>\n<li><p>No need for such complex indexing. The <code>Mat</code>s are the same shape, so you can just iterate over the elements.</p></li>\n<li><p>Don't even iterate, use an algorithm instead -- <code>std::transform</code> is a good fit for this.</p></li>\n<li><p>Don't expect to be able to visualize the result using <code>cv::imshow</code>. From the docs: </p>\n\n<blockquote>\n  <p>If the image is 16-bit unsigned or 32-bit integer, the pixels are divided by 256. That is, the value range [0,255*256] is mapped to [0,255].</p>\n</blockquote>\n\n<p>Your values use 24 bits, so vast majority of them will exceed <code>255*256</code>, and will saturate to white.</p></li>\n</ol>\n\n<p>Note: I'm using \"typed\" <code>Mat</code>s (e.g. <code>cv::Mat3b</code>, <code>cv::Mat1i</code>). Those \"know\" the contained data type, which makes using them somewhat simpler.</p>\n\n<p>Note: I'm filling the input image with a sequence of values. The first pixel will have <code>(B=0, G=1, R=2)</code>, second <code>(B=3, G=4, R=5)</code>, and so on. This makes it simple to verify the results.</p>\n\n<hr>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;opencv2/opencv.hpp&gt;\n#include &lt;numeric&gt;\n\nint main()\n{\n    // Generate a sample image.\n    cv::Mat3b srcIm(4, 4);\n    std::iota(srcIm.data, srcIm.data + srcIm.rows * srcIm.cols * 3, 0);\n\n    cv::Mat1i videoFrame(srcIm.rows, srcIm.cols);\n\n    // Perform the conversion\n    std::transform(srcIm.begin(), srcIm.end(), videoFrame.begin()\n        , [](cv::Vec3b const&amp; v) {\n            return v[0] | (v[1] &lt;&lt; 8) | (v[2] &lt;&lt; 16);\n        });\n\n    // Display results\n    for (auto const&amp; v : videoFrame) {\n        std::cout &lt;&lt; std::setw(6) &lt;&lt; std::setfill('0') &lt;&lt; std::hex &lt;&lt; v &lt;&lt; \"\\n\";\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>020100\n050403\n080706\n0b0a09\n0e0d0c\n11100f\n141312\n171615\n1a1918\n1d1c1b\n201f1e\n232221\n262524\n292827\n2c2b2a\n2f2e2d\n</code></pre>\n\n<hr>\n\n<p>You mention you want the result as an array. Same principle will apply.</p>\n\n<pre><code>std::unique_ptr&lt;unsigned int[]&gt; result(new unsigned int[srcIm.rows * srcIm.cols]);\n\nstd::transform(srcIm.begin(), srcIm.end(), result.get()\n    , [](cv::Vec3b const&amp; v) {\n        return v[0] | (v[1] &lt;&lt; 8) | (v[2] &lt;&lt; 16);\n    });\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7640416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3ef7ab5ac25746be022c1487eb57d0c?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/7640416/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1168, "favorite_count": 0, "accepted_answer_id": 45848480, "answer_count": 1, "score": 0, "last_activity_date": 1503520123, "creation_date": 1503514402, "last_edit_date": 1503517318, "question_id": 45847394, "link": "https://stackoverflow.com/questions/45847394/converting-cvmat-to-unsigned-int-pixels", "title": "Converting cv::Mat to unsigned int pixels", "body": "<p>I'm trying to convert cv::Mat to unsigned int buffer image, The conversion is not working, I get a black image</p>\n\n<pre><code>    Mat srcIm, edges;\n    srcIm = imread(\"15016889798859437.jpg\");\n    cv::cvtColor(srcIm, srcIm, cv::COLOR_BGR2RGB);\n    unsigned int *finalSrc = new unsigned int[srcIm.rows*srcIm.cols*3];\n\n    unsigned char *input = (unsigned char*)(srcIm.data);\n\n        for (int i = 0; i &lt; srcIm.rows; i++) {\n            for (int j = 0; j &lt; srcIm.cols; j++) {\n                 int r, g, b;\n                r = input[srcIm.step * j + i];\n                g = input[srcIm.step * j + i + 1];\n                b = input[srcIm.step * j + i + 2];\n\n                int rgb = ((r &amp; 0x0ff) &lt;&lt; 16) | ((g &amp; 0x0ff) &lt;&lt; 8) | (b &amp; 0x0ff);\n\n                finalSrc[i+ j*srcIm.rows] = rgb;\n            }\n        }\n\n        cv::Mat videoFrame(srcIm.rows, srcIm.cols, CV_32SC1, finalSrc);\n</code></pre>\n\n<p>UPDATED CODE:</p>\n\n<p>Following the comments, I have solved the mistakes, but still I get white image. </p>\n\n<pre><code>unsigned int *finalSrc = new unsigned int[srcIm.rows*srcIm.cols];\n\n    unsigned char *input = (unsigned char*)(srcIm.data);\n\n    int cn = srcIm.channels();\n\n    for (int i = 0; i &lt; srcIm.rows; i++)\n    {\n        for (int j = 0; j &lt; srcIm.cols; j++)\n        {\n            int r, g, b;\n\n            r = input[(i * srcIm.cols * srcIm.channels()) + (j*srcIm.channels()) + 0];\n            g = input[(i * srcIm.cols * srcIm.channels()) + (j*srcIm.channels()) + 1];\n            b = input[(i * srcIm.cols * srcIm.channels()) + (j*srcIm.channels()) + 2];\n\n            int rgb = ((r &amp; 0x0ff) &lt;&lt; 16) | ((g &amp; 0x0ff) &lt;&lt; 8) | (b &amp; 0x0ff);\n\n        }\n    }\n\n    cv::Mat videoFrame(srcIm.rows, srcIm.cols, CV_32S, finalSrc);\n\n\n    imshow(\"v\", videoFrame);\n</code></pre>\n"}, {"tags": ["c++", "amazon-web-services", "amazon"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503514191, "post_id": 45847326, "comment_id": 78652772, "body": "What&#39;s actually unclear about that error message?"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503514238, "post_id": 45847326, "comment_id": 78652798, "body": "Just implement error reporting function."}], "owner": {"reputation": 1, "user_id": 8507909, "user_type": "registered", "profile_image": "https://graph.facebook.com/1650262118317678/picture?type=large", "display_name": "Naveed Anjum", "link": "https://stackoverflow.com/users/8507909/naveed-anjum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503577915, "creation_date": 1503514154, "last_edit_date": 1503577915, "question_id": 45847326, "link": "https://stackoverflow.com/questions/45847326/sqsclient-compilation-error", "title": "SQSClient compilation error", "body": "<p>i am getting this error \"The type <code>Aws::SQS::SQSClient</code> must implement the inherited pure virtual method <code>Aws::Client::AWSClient::BuildAWSError</code>  \" while compiling the following code in eclipse for c++ on ubuntu.</p>\n\n<pre><code>   using namespace std;\n   using namespace Aws;\n   using namespace Aws::SQS::Model;\n   using namespace Aws::SQS;\n\n int main() {\n\n Aws::String queue_url = \"  https://sqs.us-west-2.amazonaws.com ,,,,,,,\";\n    Aws::String msg_body =\"testing\";\n    Aws::SDKOptions options;\n    Aws::InitAPI(options);\n    {\n        Aws::Client::ClientConfiguration config;\n            config.scheme = Aws::Http::Scheme::HTTPS;\n            config.region = Aws::Region::US_EAST_1;\n            Aws::SQS::SQSClient sqs{config};\n\n            Aws::SQS::Model::SendMessageRequest sm_req;\n            sm_req.SetQueueUrl(queue_url);\n            sm_req.SetMessageBody(msg_body);\n\n            auto sm_out = sqs.SendMessage(sm_req);\n            if (sm_out.IsSuccess()) {\n                std::cout &lt;&lt; \"Successfully sent message to \" &lt;&lt; queue_url &lt;&lt;\n                    std::endl;\n            } else {\n      `   std::cout &lt;&lt; \"Error sending message to \" &lt;&lt; queue_url &lt;&lt; \": \" &lt;&lt;\n                    sm_out.GetError().GetMessage() &lt;&lt; std::endl;\n            }\n        }\n        Aws::ShutdownAPI(options);\n        return 0;\n</code></pre>\n\n<p>}</p>\n\n<p>can any one help?</p>\n"}, {"tags": ["c++", "qt", "qt5", "qtstylesheets"], "answers": [{"tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 4, "last_activity_date": 1503514591, "creation_date": 1503514591, "answer_id": 45847451, "question_id": 45847234, "link": "https://stackoverflow.com/questions/45847234/qt-apply-style-from-external-stylesheet-to-a-programmatically-added-widget/45847451#45847451", "title": "Qt apply style from external stylesheet to a programmatically added widget", "body": "<p>When you use the <strong>SomeWidget#SomeName</strong> command, qt uses the <code>objectName</code> to apply the style. If you use Qt Designer, set this property to the name of the attribute. But if we create the widget, we must establish that property, in your case the solution is:</p>\n\n<pre><code>QListWidget *songList = new QListWidget;\nsongList-&gt;setObjectName(\"songList\");\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 3266626, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mR6Fs.jpg?s=128&g=1", "display_name": "fbg13", "link": "https://stackoverflow.com/users/3266626/fbg13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 45847451, "answer_count": 1, "score": 2, "last_activity_date": 1503514966, "creation_date": 1503513827, "last_edit_date": 1503514966, "question_id": 45847234, "link": "https://stackoverflow.com/questions/45847234/qt-apply-style-from-external-stylesheet-to-a-programmatically-added-widget", "title": "Qt apply style from external stylesheet to a programmatically added widget", "body": "<p>I'm loading an external stylesheet to my application (in main.cpp) like this:</p>\n\n<pre><code>QApplication a(argc, argv);\nQFile File(\":/resources/stylesheet.qss\");\nFile.open(QIODevice::ReadOnly);\nQString style( File.readAll() );\na.setStyleSheet(style);\n</code></pre>\n\n<p>In that style sheet I tried targeting a widget that I create in mainwindow.cpp, the widget is added to a layout created in the same file and the layout is set to a widget created with the designer.</p>\n\n<pre><code>QListWidget *songList = new QListWidget;\nQVBoxLayout *vBoxLayout = new QVBoxLayout;\n\nvBoxLayout-&gt;addWidget(songList);\nui-&gt;midWidgetCenter-&gt;setLayout(vBoxLayout);\n</code></pre>\n\n<p>stylesheet.qss</p>\n\n<pre><code>QListWidget#songList {\n    background: red;\n}\n</code></pre>\n\n<p>Omitting the widget name applies the style.</p>\n\n<p>Is it possible to apply the style from an external style sheet to elements created programmatically?</p>\n"}, {"tags": ["c++", "string", "std", "stm32"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503513687, "post_id": 45847168, "comment_id": 78652483, "body": "The problem obviously is that your MC&#39;s ROM is to small for a program linking with the <code>libstd-c++</code>."}, {"owner": {"reputation": 11, "user_id": 8212920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1485ed46d8ce41b7774c87cb101bdd64?s=128&d=identicon&r=PG&f=1", "display_name": "mict", "link": "https://stackoverflow.com/users/8212920/mict"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503513981, "post_id": 45847168, "comment_id": 78652644, "body": "I&#39;m to suprise cause arduino is it almost whole on c++, but isnt working on much bigger microcontroller.."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1503514102, "post_id": 45847168, "comment_id": 78652716, "body": "I didn&#39;t really investigate about that, but doesn&#39;t arduino come with a specialized C++ library?"}, {"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 0, "creation_date": 1503514391, "post_id": 45847168, "comment_id": 78652877, "body": "how much flash do you got?"}, {"owner": {"reputation": 11, "user_id": 8212920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1485ed46d8ce41b7774c87cb101bdd64?s=128&d=identicon&r=PG&f=1", "display_name": "mict", "link": "https://stackoverflow.com/users/8212920/mict"}, "edited": false, "score": 0, "creation_date": 1503514451, "post_id": 45847168, "comment_id": 78652906, "body": "Ok, i do not have using strictly this library. Did you know any method to comfortable and light work with strings? I depend use strings like string.lenght() and other...  STM32F103C8T6 have 64kb flash."}, {"owner": {"reputation": 6270, "user_id": 3820025, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zXOn4.png?s=128&g=1", "display_name": "Bence Kaulics", "link": "https://stackoverflow.com/users/3820025/bence-kaulics"}, "edited": false, "score": 0, "creation_date": 1503518353, "post_id": 45847168, "comment_id": 78654847, "body": "Well, maybe you could get the one that Arduino uses."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503519698, "post_id": 45847168, "comment_id": 78655478, "body": "Dynamic memory structures like <code>std::string</code> and <code>std::vector</code> are frowned upon in embedded system that have constrained memory limits.  Search the internet for &quot;c++ memory fragmentation&quot;.  There is no garbage collection in C++."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503519802, "post_id": 45847168, "comment_id": 78655525, "body": "At my shop, we use an array of fixed capacity for the text.  The input functions (USB and RS232) are designed to limit and not overflow the text array."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1503596980, "post_id": 45847168, "comment_id": 78694739, "body": "@mict, the c library string functions are quite good enough to do light work on strings.  The c library provided by ST even has a malloc() and free(), but I do not recommend using them."}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 1850429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aeac2c1534ffc9cd94072b3196838b9?s=128&d=identicon&r=PG", "display_name": "Jeroen3", "link": "https://stackoverflow.com/users/1850429/jeroen3"}, "is_accepted": false, "score": 1, "last_activity_date": 1504074525, "creation_date": 1504074525, "answer_id": 45953408, "question_id": 45847168, "link": "https://stackoverflow.com/questions/45847168/stm32f103c8t6-using-c-string-std/45953408#45953408", "title": "STM32F103C8T6 using C++ string std", "body": "<p>The STM32F103C<strong>8</strong>T6 only has 64 Kbytes of flash. Your program does not fit.</p>\n\n<p>Look at the <a href=\"https://stackoverflow.com/questions/22199844/what-are-gcc-linker-map-files-used-for\">linker output</a>, see how much you need. If possible, you can get the <em>B</em> version.<br>\nYou could also see if you can enable the <a href=\"https://stackoverflow.com/a/6770305/1850429\">removal of unused objects</a>. Since there might be functions of the string library that you don't even need.</p>\n\n<p><a href=\"https://i.stack.imgur.com/w2O7P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w2O7P.png\" alt=\"stm32f103c8t6\"></a></p>\n\n<p><em>*I'm taking a wild guess you're using GNU-ARM.</em></p>\n"}, {"tags": [], "owner": {"reputation": 448, "user_id": 1128881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212bf05ba88cb5705ff5bb32e9c69e1f?s=128&d=identicon&r=PG", "display_name": "Sirmabus", "link": "https://stackoverflow.com/users/1128881/sirmabus"}, "is_accepted": false, "score": 1, "last_activity_date": 1513545738, "last_edit_date": 1513545738, "creation_date": 1513545358, "answer_id": 47859522, "question_id": 45847168, "link": "https://stackoverflow.com/questions/45847168/stm32f103c8t6-using-c-string-std/47859522#47859522", "title": "STM32F103C8T6 using C++ string std", "body": "<p>I think this question has been mostly answered here already but would like to throw in a couple words at a higher level perspective that might help some others going down this same path.</p>\n\n<p>You can of course use C++ for microcontroller projects, but you'll want to avoid the majority of C++ paradigms.\nWant to be \"C+\"; closer to C than the Object Oriented Programming (OOP) side.\nIn particular avoid most instanced things like in general C++ objects. And avoid code memory hogging paradigms like templates, etc.</p>\n\n<p>You can setup a malloc(), so there is a C++ new/delete but most of the time you'll want to structure your code so there is next to no dynamic allocations.\nNot only because these add more code space bulk but you'll end up just using more of the limited 20kb RAM. Just to have a dynamic allocate you have to have some minimal linked list or similar to maintain the blocks of RAM et al.</p>\n\n<p>Really, probably, you want to just use parts of the convince features of C++ like the loosening of variable scope restrictions, etc.</p>\n\n<p>You'll probably want to just use the minimal C libraries that you can get on the ST website and/or other places.</p>\n\n<p>For cheap low cost microcontroller projects, one of the arts of it is minification. Depending on the scope of you project of course. For something complex, with a lot of features, you might be hard pressed fitting everything in just the 64kb flash ROM space.</p>\n\n<p>Some other options are getting a beefer microcontroller and/or adding an I2C EEPROM for more code space (that you'ed probably have to page in and out of RAM for running code use).</p>\n\n<p>As a strategy, you'll probably just want to utilize the stack (local static sized character arrays) to use and manipulate dynamic strings and use good old C library types like strcpy(), sprintf(), etc.   </p>\n"}], "owner": {"reputation": 11, "user_id": 8212920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1485ed46d8ce41b7774c87cb101bdd64?s=128&d=identicon&r=PG&f=1", "display_name": "mict", "link": "https://stackoverflow.com/users/8212920/mict"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1705, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513545738, "creation_date": 1503513595, "last_edit_date": 1503518140, "question_id": 45847168, "link": "https://stackoverflow.com/questions/45847168/stm32f103c8t6-using-c-string-std", "title": "STM32F103C8T6 using C++ string std", "body": "<p>I have using C++ Eclipse in my STM32F103C8T6 with string type from std. I get error like: \"region rom overflowed by 5980bytes\". </p>\n\n<pre><code>#include \"stm32f1xx.h\"\n#include &lt;string&gt;\n\n\nstd::string a;\n\nint main(void)\n{\n\n\n    for(;;);\n}\n</code></pre>\n\n<p>Is there any way to fix it on this microcontroler?</p>\n"}, {"tags": ["c++", "c", "redhat", "strace", "brk"], "comments": [{"owner": {"reputation": 45, "user_id": 3027028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2771e6ef9ecc4eb00edfa947477355?s=128&d=identicon&r=PG", "display_name": "Umesh C G", "link": "https://stackoverflow.com/users/3027028/umesh-c-g"}, "edited": false, "score": 0, "creation_date": 1503513140, "post_id": 45846961, "comment_id": 78652152, "body": "why &lt;b&gt; html tag is not coming?"}, {"owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 0, "creation_date": 1503513178, "post_id": 45846961, "comment_id": 78652167, "body": "Last time I checked, <a href=\"https://linux.die.net/man/1/strace\" rel=\"nofollow noreferrer\"><code>strace</code></a> still reported in \u03bcs, not seconds, so that&#39;s more like 17.8 \u03bcs."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1503513197, "post_id": 45846961, "comment_id": 78652178, "body": "Because it was part of an (indented) code block. Those get rendered verbatim."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1503513277, "post_id": 45846961, "comment_id": 78652224, "body": "Nice fix to the markup, @melpomene.  I trust you had a program do the grunt work for you."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1503513304, "post_id": 45846961, "comment_id": 78652248, "body": "@JonathanLeffler vim and a few regex substitutions. :-)"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 2, "creation_date": 1503513378, "post_id": 45846961, "comment_id": 78652295, "body": "@dhke <code>man strace</code>: &quot;<i><code>-ttt</code> ... the time printed will include the microseconds and the leading portion will be printed as the number of seconds since the epoch.</i>&quot; So the number before the <code>.</code> is still in seconds."}, {"owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1503513414, "post_id": 45846961, "comment_id": 78652315, "body": "@melpomene ah, thanks. I stand corrected."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1503513530, "post_id": 45846961, "comment_id": 78652392, "body": "One possibility is that the system was rather busy with other processes while your program was hung up in the <code>brk()</code> system call.  The problem may be nothing to do with <code>brk()</code> except that it happened to be the system call that allowed the O/S to take control again and run other processes instead of yours."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3027028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2771e6ef9ecc4eb00edfa947477355?s=128&d=identicon&r=PG", "display_name": "Umesh C G", "link": "https://stackoverflow.com/users/3027028/umesh-c-g"}, "edited": false, "score": 0, "creation_date": 1503518794, "post_id": 45847222, "comment_id": 78655041, "body": "Thanks for reply. I too think about this, but got confused when saw this question and answer.    <a href=\"https://stackoverflow.com/q/42535397/3027028\">stackoverflow.com/q/42535397/3027028</a>"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 3, "last_activity_date": 1503513795, "creation_date": 1503513795, "answer_id": 45847222, "question_id": 45846961, "link": "https://stackoverflow.com/questions/45846961/is-brk0-taking-taking-too-much-time/45847222#45847222", "title": "is brk(0) taking taking too much time?", "body": "<p>To answer the question in the title: No, <code>brk(0)</code> is not taking too much time.</p>\n\n<p>You can see this by looking at the time reported for the syscall itself (<code>&lt;0.000003&gt;</code>, added by the <code>-T</code> option). That's only 3 microseconds.</p>\n\n<p>The values on the left are (absolute) timestamps. But that just means the process performed a <code>brk</code> syscall at 1503431273.935080 and another syscall at 1503431291.010338. That doesn't mean any single syscall took 17 seconds; it just means it took 17 seconds for the process to reach the next syscall.</p>\n\n<p>The process could have been doing many other things, such as doing raw computation (burning CPU), or not being scheduled (because the system was busy with other programs). The latter option is admittedly unlikely because you said this happened in multiple runs of the program. Therefore I think the most likely explanation is that the code just spends a lot of time computing things without needing to call the kernel (e.g. tight numeric code in a loop, with no memory allocation).</p>\n"}], "owner": {"reputation": 45, "user_id": 3027028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2771e6ef9ecc4eb00edfa947477355?s=128&d=identicon&r=PG", "display_name": "Umesh C G", "link": "https://stackoverflow.com/users/3027028/umesh-c-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503513795, "creation_date": 1503512750, "last_edit_date": 1503513157, "question_id": 45846961, "link": "https://stackoverflow.com/questions/45846961/is-brk0-taking-taking-too-much-time", "title": "is brk(0) taking taking too much time?", "body": "<p>This is an output of <code>strace -T -ttt -ff -x -y -o pid.trace -p 2145</code> . Trace given below.</p>\n\n<pre>1503431273.934716 semop(1204093022, {{0, 1, SEM_UNDO}}, 1) = 0 &lt;0.000004&gt;\n1503431273.934737 clock_gettime(CLOCK_REALTIME, {1503431273, 934741536}) = 0 &lt;0.000004&gt;\n1503431273.934763 write(6&lt;/home/red/samples/debug/hexa.debug&gt;, \"17.08.23 01:17:53 [     hexa:2145\"..., 79) = 79 &lt;0.000016&gt;\n1503431273.934960 brk(0)                = 0x1adc000 &lt;0.000004&gt;\n1503431273.934974 brk(0x1afd000)        = 0x1afd000 &lt;0.000006&gt;\n1503431273.934994 brk(0)                = 0x1afd000 &lt;0.000003&gt;\n1503431273.935006 brk(0)                = 0x1afd000 &lt;0.000004&gt;\n1503431273.935017 brk(0x1afc000)        = 0x1afc000 &lt;0.000008&gt;\n1503431273.935033 brk(0)                = 0x1afc000 &lt;0.000003&gt;\n1503431273.935045 brk(0)                = 0x1afc000 &lt;0.000004&gt;\n1503431273.935057 brk(0)                = 0x1afc000 &lt;0.000004&gt;\n1503431273.935068 brk(0x1afb000)        = 0x1afb000 &lt;0.000005&gt;\n<b>1503431273.935080 brk(0)                = 0x1afb000 &lt;0.000003&gt;\n1503431291.010338 brk(0)                = 0x1afb000 &lt;0.000006&gt;</b>\n1503431291.010366 brk(0x1b1c000)        = 0x1b1c000 &lt;0.000006&gt;\n1503431291.010391 brk(0)                = 0x1b1c000 &lt;0.000003&gt;\n1503431291.010403 brk(0)                = 0x1b1c000 &lt;0.000004&gt;\n1503431291.010414 brk(0x1b12000)        = 0x1b12000 &lt;0.000008&gt;\n1503431291.010430 brk(0)                = 0x1b12000 &lt;0.000004&gt;\n1503431291.010443 brk(0)                = 0x1b12000 &lt;0.000004&gt;\n1503431291.010455 brk(0)                = 0x1b12000 &lt;0.000003&gt;\n1503431291.010466 brk(0x1b11000)        = 0x1b11000 &lt;0.000004&gt;\n<b>1503431291.010478 brk(0)                = 0x1b11000 &lt;0.000004&gt;\n1503431301.277050 clock_gettime(CLOCK_REALTIME, {1503431301, 277067441}) = 0 &lt;0.000005&gt;</b>\n1503431301.277094 write(6&lt;/home/red/samples/debug/hexa.debug&gt;, \"17.08.23 01:18:21 [     hexa:2145\"..., 91) = 91 &lt;0.000019&gt;\n1503431301.277201 clock_gettime(CLOCK_REALTIME, {1503431301, 277216542}) = 0 &lt;0.000005&gt;\n1503431301.277234 write(6&lt;/home/red/samples/debug/hexa.debug&gt;, \"17.08.23 01:18:21 [     hexa:2145\"..., 126) = 126 &lt;0.000018&gt;\n1503431301.277296 clock_gettime(CLOCK_REALTIME, {1503431301, 277301142}) = 0 &lt;0.000004&gt;\n1503431301.277317 write(6&lt;/home/red/samples/debug/hexa.debug&gt;, \"17.08.23 01:18:21 [     hexa:2145\"..., 126) = 126 &lt;0.000012&gt;\n1503431301.288030 clock_gettime(CLOCK_REALTIME, {1503431301, 288037704}) = 0 &lt;0.000004&gt;</pre>\n\n<p>if you look at the above trace at two <strong>brk(0)s</strong> (please see 1503431273.935080 and 1503431291.010478) taking too much time, around <strong>17 seconds and 10 seconds</strong> respectively (comparing left side time). But execution time in the right side is just minimal. I have done multiple runs of this program, in the same <strong>Redhat Linux box (7.2)</strong>, all runs were giving same timings (with microseconds difference) at same place of system call (brk(0)).</p>\n\n<p>What could be the issue? is it at Programming Level or OS level? I am not having source code for this, but I know it is a c/c++ program.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503512103, "post_id": 45846729, "comment_id": 78651594, "body": "You cant declare non-const reference to const. It would break <code>const</code> rules because you would be able to change value of that constant"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1503512175, "post_id": 45846729, "comment_id": 78651646, "body": "&quot;The reference r to array of int but it&#39;s a const reference.&quot; All references cannot be rebound, thus all references &quot;are const&quot;, so you don&#39;t actually write <code>const</code> for them. If you add <code>const</code>, that means something else entirely."}, {"owner": {"reputation": 2833, "user_id": 303250, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/363f15e560fb17bbfb5fe228a7b2dde2?s=128&d=identicon&r=PG", "display_name": "yapkm01", "link": "https://stackoverflow.com/users/303250/yapkm01"}, "edited": false, "score": 0, "creation_date": 1503512286, "post_id": 45846729, "comment_id": 78651716, "body": "why having an int x:r works and int &amp;x:r doesn&#39;t?"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503512326, "post_id": 45846729, "comment_id": 78651734, "body": "We have already written it 3 times, read answers please"}], "answers": [{"comments": [{"owner": {"reputation": 2833, "user_id": 303250, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/363f15e560fb17bbfb5fe228a7b2dde2?s=128&d=identicon&r=PG", "display_name": "yapkm01", "link": "https://stackoverflow.com/users/303250/yapkm01"}, "edited": false, "score": 0, "creation_date": 1503512223, "post_id": 45846787, "comment_id": 78651681, "body": "The const reference is what r can do. The array ia is not const. So the iteration of each item is not what const reference can do. Then why having an int works?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 2833, "user_id": 303250, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/363f15e560fb17bbfb5fe228a7b2dde2?s=128&d=identicon&r=PG", "display_name": "yapkm01", "link": "https://stackoverflow.com/users/303250/yapkm01"}, "edited": false, "score": 0, "creation_date": 1503512332, "post_id": 45846787, "comment_id": 78651740, "body": "@yapkm01 Even if the referred object is not const, you cannot use a <code>const</code> reference to modify it. <code>const</code> pointers and references cannot be used to modify the referred object, regardless of rather or not that object is <code>const</code> or not. That is what makes them <code>const</code>. Having <code>int x</code> works because you are no longer taking a reference. It&#39;s a copy and you can modify that copy all you want."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 3, "last_activity_date": 1503512108, "creation_date": 1503512108, "answer_id": 45846787, "question_id": 45846729, "link": "https://stackoverflow.com/questions/45846729/c-confusion-on-const-reference-used-in-a-nested-for-range-usage/45846787#45846787", "title": "c++: confusion on const reference used in a nested FOR range usage", "body": "<p>You can't take a non-<code>const</code> reference to an element of a <code>const</code> array. <code>r</code> is a reference to a <code>const</code> array so you cannot take a non-<code>const</code> reference to it's elements. </p>\n\n<p>Try <code>for(int (&amp;r)[4]: ia)</code></p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1503512795, "last_edit_date": 1503512795, "creation_date": 1503512283, "answer_id": 45846832, "question_id": 45846729, "link": "https://stackoverflow.com/questions/45846729/c-confusion-on-const-reference-used-in-a-nested-for-range-usage/45846832#45846832", "title": "c++: confusion on const reference used in a nested FOR range usage", "body": "<p>When you use</p>\n\n<pre><code>for (const int (&amp;r)[4] : ia)\n</code></pre>\n\n<p>you have now have an array to <code>const</code> <code>int</code>'s.  You can't bind a non <code>const</code> reference to one of those elements as that violates cont-correctness.</p>\n\n<p>On the other hand when you use</p>\n\n<pre><code>for (int x : r)\n</code></pre>\n\n<p>You no longer are taking a reference and instead making a copy.  You can always copy a <code>const</code> element into a non <code>const</code> element as you can't modify the <code>const</code> element from the copy.</p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1503513121, "creation_date": 1503513121, "answer_id": 45847044, "question_id": 45846729, "link": "https://stackoverflow.com/questions/45846729/c-confusion-on-const-reference-used-in-a-nested-for-range-usage/45847044#45847044", "title": "c++: confusion on const reference used in a nested FOR range usage", "body": "<p>It is unclear where you are confused; here is a set of possible points of confusion.</p>\n\n<ul>\n<li><p>A reference to a const array is the same as a reference to an array over const elements.</p></li>\n<li><p>When a C++ programmer says const reference, they mean a reference to const; there is no such thing as a const reference other than a reference to const.</p></li>\n<li><p>You cannot get a non-const element reference from a const reference to an array.</p></li>\n<li><p>Your code tries to do that.  The compiler says \"no\".</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 0, "last_activity_date": 1503513747, "creation_date": 1503513747, "answer_id": 45847208, "question_id": 45846729, "link": "https://stackoverflow.com/questions/45846729/c-confusion-on-const-reference-used-in-a-nested-for-range-usage/45847208#45847208", "title": "c++: confusion on const reference used in a nested FOR range usage", "body": "<p>The array and the ranged based loop just obfuscates the problem. A much simpler code that exhibits the same error is this:</p>\n\n<pre><code>int main() {\n    int x = 0;\n    const int&amp; y = x;\n    int&amp; z = y;\n\n}\n</code></pre>\n\n<p>leads to:</p>\n\n<pre><code>error: binding value of type 'const int' to reference to type 'int' drops 'const' qualifier\n    int&amp; z = y;\n         ^   ~\n</code></pre>\n\n<p>Even though <code>x</code> is not <code>const</code> and using a reference is like using the original variable (most of the time) you cannot obtain a non-const reference from a const reference. </p>\n\n<p>It is also rather easy to understand why this cannot be allowed. Consider </p>\n\n<pre><code>void foo(const int&amp; x);\n</code></pre>\n\n<p><code>foo</code> cannot change the value of the parameter passed, but if the above would be allowed, <code>foo</code> could be implemented as this:</p>\n\n<pre><code>void foo(const int&amp; x) {\n    int&amp; y = x;        // now I am allowed to change it\n    y++;\n}\n</code></pre>\n\n<p>This would obvioulsy break constness, hence it cannot be allowed.</p>\n"}], "owner": {"reputation": 2833, "user_id": 303250, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/363f15e560fb17bbfb5fe228a7b2dde2?s=128&d=identicon&r=PG", "display_name": "yapkm01", "link": "https://stackoverflow.com/users/303250/yapkm01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1503513747, "creation_date": 1503511900, "question_id": 45846729, "link": "https://stackoverflow.com/questions/45846729/c-confusion-on-const-reference-used-in-a-nested-for-range-usage", "title": "c++: confusion on const reference used in a nested FOR range usage", "body": "<p>I am having confusion on the below. So let me explain simply.</p>\n\n<pre><code>int ia [3][4] =  {\n                     {0, 1, 2, 3},\n                     {4, 5, 6, 7},  \n                     {8, 9, 10, 11}  \n                 };\n\nfor (const int (&amp;r)[4] : ia)\n      for (int &amp;x : r) --&gt; this has error\n             x = 1;\n</code></pre>\n\n<p>The error is \"binding value of type 'const int' to reference to type 'int' drops 'const' qualifier\".</p>\n\n<p>The reference r to array of int but it's a const reference. That is understandable. The inner for loop using r, it will iterates over the inner array. The r is a const reference to the array but not each item. So why is there error?</p>\n\n<p>I can replace with the below code and it works ..</p>\n\n<pre><code> for (const int (&amp;r)[4] : ia)\n            for (int x : r) --&gt; this has error\n                      x = 1;\n</code></pre>\n\n<p>This i understand.\nAny help is appreciated.</p>\n"}, {"tags": ["c++", "visual-studio-2017", "sdl-2"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 2, "creation_date": 1503511593, "post_id": 45846591, "comment_id": 78651288, "body": "<i>&quot;Failure after failure&quot;</i> I you want to get helped, explicitly state what specific <i>failures</i> you&#39;re stuck with."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1503511697, "post_id": 45846591, "comment_id": 78651359, "body": "You didn&#39;t link <code>SDLmain.lib</code>"}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503511757, "post_id": 45846591, "comment_id": 78651393, "body": "I did link SDL2main.lib"}, {"owner": {"reputation": 115119, "user_id": 1053, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3f38c0e0cc4a1ca4656bfd8c78a581f2?s=128&d=identicon&r=PG", "display_name": "Ed S.", "link": "https://stackoverflow.com/users/1053/ed-s"}, "edited": false, "score": 1, "creation_date": 1503511765, "post_id": 45846591, "comment_id": 78651399, "body": "&quot;something like this nonsense...&quot; It&#39;s not nonsense, it&#39;s an error message that makes perfect sense to anyone who understands the basic of how a C++ program is put together. Of course we need to know what the actual error is, yeesh"}, {"owner": {"reputation": 115119, "user_id": 1053, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3f38c0e0cc4a1ca4656bfd8c78a581f2?s=128&d=identicon&r=PG", "display_name": "Ed S.", "link": "https://stackoverflow.com/users/1053/ed-s"}, "edited": false, "score": 1, "creation_date": 1503511804, "post_id": 45846591, "comment_id": 78651423, "body": "@JohnSilver: The linker cannot find the definition of main (_main)"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1503512222, "post_id": 45846591, "comment_id": 78651679, "body": "Please edit it into your question, no one will scroll through the comments to see it. The code itself looks ok to me. Probably you&#39;re linking your libs incorrectly or using wrong ones."}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503512503, "post_id": 45846591, "comment_id": 78651836, "body": "I editted it into my question. Linking everything seems very simple and very correct on my end. 3 things to link, library folder to additional libraries, include folder to additional include, and link each file name from lib to Additional Dependencies"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503512678, "post_id": 45846591, "comment_id": 78651917, "body": "@JohnSilver I&#39;m no SDL expert, but from the linker error it looks like the implementation of <code>_main()</code> (note the leading underscore) is missing. You&#39;re probably required to provide a definition for that."}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503512808, "post_id": 45846591, "comment_id": 78651980, "body": "Sorry for sounding dumb about this, but what do I do @user0042, what do you mean by provide a definition for that? how would I do so?"}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503512937, "post_id": 45846591, "comment_id": 78652051, "body": "I&#39;m pretty sure the compile error is just some nonsense stuff from the SDL download. Can anybody here try to successfully use SDL2 in visual studio 2017? It&#39;s supposed to be popular, how do they set it up? I&#39;m pretty sure I&#39;m doing stuff right. like the guy in the video, same stuff, only me with error: <a href=\"https://www.youtube.com/watch?v=Sfn7yOiwJLw\" rel=\"nofollow noreferrer\">youtube.com/watch?v=Sfn7yOiwJLw</a>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503513135, "post_id": 45846591, "comment_id": 78652149, "body": "@user0042 That shouldn&#39;t be neccessay. SDL is supposed to work with a normal <code>main()</code>."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1503513264, "post_id": 45846591, "comment_id": 78652220, "body": "@HolyBlackCat Yes, I saw that in some github gist while investigating. Maybe the source shown by the OP isn&#39;t a compiled part of the VS2017 project."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1503513293, "post_id": 45846591, "comment_id": 78652237, "body": "Make sure you set your <code>SUBSYSTEM</code> (Configuration Properties -&gt; Linker -&gt; System -&gt; SubSystem) to <code>CONSOLE</code> or <code>WINDOWS</code>."}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503513325, "post_id": 45846591, "comment_id": 78652267, "body": "the file from which the error comes from is &quot;MSVCRTD.lib(exe_main.obj)&quot; first line. and then of course there is a second error because of an unresolved external aka the first error, also yeah subsystem has always been console. i even created a new one just now, console-&gt;empty project (an empty project with console as subsystem), pasted code and followed the settings instructions, still doesent work."}, {"owner": {"reputation": 354, "user_id": 5199222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c741bc7e8714b4eed8d8d616da278ed?s=128&d=identicon&r=PG", "display_name": "Paul H.", "link": "https://stackoverflow.com/users/5199222/paul-h"}, "edited": false, "score": 0, "creation_date": 1503514127, "post_id": 45846591, "comment_id": 78652732, "body": "What version of VC is the SDL library compiled with?"}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503514304, "post_id": 45846591, "comment_id": 78652833, "body": "see the link I posted, I took the VC.zip one under windows, under development libraries"}, {"owner": {"reputation": 354, "user_id": 5199222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c741bc7e8714b4eed8d8d616da278ed?s=128&d=identicon&r=PG", "display_name": "Paul H.", "link": "https://stackoverflow.com/users/5199222/paul-h"}, "edited": false, "score": 0, "creation_date": 1503517086, "post_id": 45846591, "comment_id": 78654220, "body": "I looked at the link and couldn&#39;t tell what version they used. You must use libraries compiled with the same version with Visual Studio."}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503589331, "post_id": 45846591, "comment_id": 78690151, "body": "They use 2.0.5, don&#39;t know how old that is"}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503589503, "post_id": 45846591, "comment_id": 78690260, "body": "how do I get visual studio 2015? couldn&#39;t find an official download of it"}, {"owner": {"reputation": 175, "user_id": 3431608, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b4f00eb3e819e9136c4b3d8e71ed3973?s=128&d=identicon&r=PG&f=1", "display_name": "KFkf", "link": "https://stackoverflow.com/users/3431608/kfkf"}, "edited": false, "score": 0, "creation_date": 1503602321, "post_id": 45846591, "comment_id": 78697577, "body": "I have experienced the same problem using visual studio 2012. I went through the tutorial provided via the official site for SDL 3 times ! and I still get the compile time error : &quot;Error\t4\terror LNK2019: unresolved external symbol _main referenced in function ___tmainCRTStartup\tC:\\Users\\kiyarash\\Desktop\\visual studio\\SDL_header\\SDL_header\\MSVCRTD.lib(crtexe.obj)\tSDL_hea&zwnj;&#8203;der &quot;  and here is the link to the tutorial :<a href=\"http://www.willusher.io/sdl2%20tutorials/2013/08/15/lesson-0-visual-studio\" rel=\"nofollow noreferrer\">willusher.io/sdl2%20tutorials/2013/08/15/lesson-0-visual-st&zwnj;&#8203;udio</a>"}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503669682, "post_id": 45846591, "comment_id": 78724828, "body": "I tried in visual studio 2015, still same error, my computer is by the way 64 bit which means I select the x64 folder instead of the x86. Situation unchanged, still can&#39;t do anything with SDL."}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 0, "creation_date": 1503692468, "post_id": 45846591, "comment_id": 78737215, "body": "I got it to work, after hours. Literally over five hours, at the very least. I got tired of getting SDL to work, so I  tried out SFML instead. That also failed, so I went to the SFML website and checked the versions, and it stated under the version links that I should only take 64-bit version downloads if I HAVE to, and don&#39;t take 64 bit just because my PC is 64 bits. So I downloaded SFML 32 bit, it worked. Then I thought it might be the same with SDL.. and it was, just that they were pretty bad at informing me of that. Also, I also had to say main(int argc, char** argv) instead of main()"}, {"owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "edited": false, "score": 1, "creation_date": 1503692556, "post_id": 45846591, "comment_id": 78737257, "body": "To summarize, the main problem was that I needed to take the 32 bit version, and not the 64 bit one, even though my PC is 64 bit. SDL is pretty bad at documenting/stating that, but thank god I tried out SFML so they could make it clear. By the way, why do I have to say int main(int argc, char** argv) instead of int main() ? Never got that."}, {"owner": {"reputation": 175, "user_id": 3431608, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b4f00eb3e819e9136c4b3d8e71ed3973?s=128&d=identicon&r=PG&f=1", "display_name": "KFkf", "link": "https://stackoverflow.com/users/3431608/kfkf"}, "edited": false, "score": 0, "creation_date": 1503762784, "post_id": 45846591, "comment_id": 78753166, "body": "thanks for your endeavour and discovery! it worked for me too!  it is strange that we must use the x86 library version. I have no answer for the main() question either . :("}, {"owner": {"reputation": 317, "user_id": 5690027, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RJPwTsRi1l4/AAAAAAAAAAI/AAAAAAAAAGI/HUtUfIROzfI/photo.jpg?sz=128", "display_name": "George Theodosiou", "link": "https://stackoverflow.com/users/5690027/george-theodosiou"}, "edited": false, "score": 0, "creation_date": 1524067707, "post_id": 45846591, "comment_id": 86824407, "body": "<a href=\"https://stackoverflow.com/questions/42680820/is-it-possible-to-put-the-sdl-lib-dll-and-header-files-somewhere-so-i-can-ju\">Here</a> you can get the answer. Regards."}], "answers": [{"comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1503525994, "post_id": 45849875, "comment_id": 78658190, "body": "OP said they&#39;re already linking to <code>SDL2main.lib</code> in the comments."}], "tags": [], "owner": {"reputation": 84, "user_id": 5257359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/130db2c9d80582c5cf019e6e3286de96?s=128&d=identicon&r=PG&f=1", "display_name": "Leon2806", "link": "https://stackoverflow.com/users/5257359/leon2806"}, "is_accepted": false, "score": -1, "last_activity_date": 1503525301, "creation_date": 1503525301, "answer_id": 45849875, "question_id": 45846591, "link": "https://stackoverflow.com/questions/45846591/how-do-i-sucessfully-include-sdl2-in-visual-studio-2017/45849875#45849875", "title": "How do I sucessfully include SDL2 in Visual Studio 2017?", "body": "<p>That happens because SDL uses <code>#define main SDL_main</code> and replaces the main function with it's own version. Linking with SDL2main.lib, which contains the implementation should get rid of the error. Alternatively you can add <code>#undef main</code> right before your main function.</p>\n"}], "owner": {"reputation": 83, "user_id": 6706700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1T3cr.jpg?s=128&g=1", "display_name": "JohnSilver", "link": "https://stackoverflow.com/users/6706700/johnsilver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1630, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1503525301, "creation_date": 1503511443, "last_edit_date": 1503513440, "question_id": 45846591, "link": "https://stackoverflow.com/questions/45846591/how-do-i-sucessfully-include-sdl2-in-visual-studio-2017", "title": "How do I sucessfully include SDL2 in Visual Studio 2017?", "body": "<p>Please, if you think this can be done by yourself (and having tested it), please share steps instead of linking other guides. I have tried the following things in different ways:</p>\n\n<p>Downloaded the SDL2 folder, it contains a lib and include folder.</p>\n\n<ul>\n<li><p>Open my empty project containing the simple main function and all that (basic template)</p></li>\n<li><p>Open Visual Studio's project properties</p></li>\n<li><p>Add the include folder in \"Additional Include Directories\"</p></li>\n<li><p>Add the lib folder in \"Additional Library Directories\"</p></li>\n<li><p>Add the individual library files in \"Additional Dependencies\"</p></li>\n<li><p>Include it</p></li>\n</ul>\n\n<p>The download I have is from this page: <a href=\"https://www.libsdl.org/download-2.0.php\" rel=\"nofollow noreferrer\">https://www.libsdl.org/download-2.0.php</a></p>\n\n<p>Under \"Development Libraries\" and under \"Windows\" I downloaded the VC.zip one.</p>\n\n<p>Help? Please don't lock the thread, yes I have seen thousands of guides on how to do this. Why you think I ask here? Failure after failure, I'm getting nowhere.</p>\n\n<p>I get a compile error which is something like this nonsense: </p>\n\n<blockquote>\n<pre><code>Error LNK2019 unresolved external symbol _main referenced in function \"int __cdecl invoke_main(void)\" (?invoke_main@@YAHXZ) \n</code></pre>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\n#include &lt;SDL.h&gt;\n\nusing namespace std;\n\nint main(int argc, char *argv[]) {\n\n    cout &lt;&lt; \"Hello world!\" &lt;&lt; endl;\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c#", "c++", "winforms", "opencv", "picturebox"], "answers": [{"comments": [{"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1503517194, "post_id": 45848007, "comment_id": 78654269, "body": "Thank you! I have been tearing my hair out over this for days. VERY much appreciate your help."}], "tags": [], "owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "is_accepted": true, "score": 2, "last_activity_date": 1503516863, "creation_date": 1503516863, "answer_id": 45848007, "question_id": 45846469, "link": "https://stackoverflow.com/questions/45846469/calling-an-opencv-mat-from-a-dll-to-windows-forms-image-is-glitchy/45848007#45848007", "title": "Calling an opencv Mat from a dll to windows forms, image is glitchy", "body": "<p>The problem you have here is that you pass pointer to data of temporary image <code>cv::Mat tmp;</code> into C#, but it gets freed on exit of <code>getArucoFrame(void)</code>, thus it is dangling pointer. It may work, but seems it sometimes gets overwritten by new data. An easiest, but not the most optimal fix would be declaring it static <code>static cv::Mat tmp;</code> so it gets freed on DLL unload.</p>\n"}], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "accepted_answer_id": 45848007, "answer_count": 1, "score": 0, "last_activity_date": 1503516863, "creation_date": 1503511003, "question_id": 45846469, "link": "https://stackoverflow.com/questions/45846469/calling-an-opencv-mat-from-a-dll-to-windows-forms-image-is-glitchy", "title": "Calling an opencv Mat from a dll to windows forms, image is glitchy", "body": "<p>I have an openCv based dll, that connects to a camera. I then call a <code>cv::mat</code> object into a C# application, and display the image as a Bitmap in a picturebox object.\nThis works, but the image occasionally 'glitches', showing flashes of lines, static and pops, every few seconds.</p>\n\n<p>Is there a way I can check if the bitmap is valid before displaying it?\nWhen i show the image in the dll, using <code>cv::imshow</code>, it looks fine. </p>\n\n<p>The code I have is:</p>\n\n<p>in the c++ dll:</p>\n\n<pre><code>__declspec(dllexport) uchar*  getArucoFrame(void)\n{   \n\n        cv::Mat OriginalImg = returnLeftFrame(); // calls the frame from where the camera thread stores it.\n        cv::Mat tmp;\n        cv::cvtColor(OriginalImg, tmp, CV_BGRA2BGR);\n        //if I cv::imshow the Mat here, it looks good.\n        return tmp.data;\n}\n</code></pre>\n\n<p>in the C# side:</p>\n\n<pre><code>//on a button\n threadImageShow = new Thread(imageShow);\n threadImageShow.Start();\n\n//show image frame in box\nprivate void imageShow()\n{\n    while(true)\n    {\n        IntPtr ptr = getArucoFrame();\n        if (pictureBoxFrame.Image != null)\n        {\n            pictureBoxFrame.Image.Dispose();\n\n        }\n        Bitmap a = new Bitmap(640, 360, 3 * 640, PixelFormat.Format24bppRgb, ptr);\n        pictureBoxFrame.Image = a;\n        Thread.Sleep(20);\n\n\n    }\n\n\n}\n</code></pre>\n\n<p>//the dll call</p>\n\n<pre><code> [DllImport(\"Vector.dll\", CallingConvention = CallingConvention.Cdecl)]\n        public static extern IntPtr getArucoFrame();\n</code></pre>\n\n<p>As the image looks good in the dll, and glitchy in the picturebox, i am having trouble debugging this. Any help much appreciated. thank you.</p>\n"}, {"tags": ["c++", "visual-studio", "file", "integer", "fstream"], "comments": [{"owner": {"reputation": 2672, "user_id": 481422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/007ff0b62f46456d8ff2edc9c35f0153?s=128&d=identicon&r=PG", "display_name": "Zlatin Zlatev", "link": "https://stackoverflow.com/users/481422/zlatin-zlatev"}, "edited": false, "score": 1, "creation_date": 1503511144, "post_id": 45846435, "comment_id": 78651030, "body": "Why do you try to write and read at the same time? The way you are doing read and write is sequential, so your guess is correct - it is related to file pointer. You need to do some &quot;random access&quot; to the file, in order to read what you have just written to the file.  Check <a href=\"https://stackoverflow.com/questions/14393774/reading-random-access-files\" title=\"reading random access files\">stackoverflow.com/questions/14393774/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 8463405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ecd249fe86a4e561e19a7bbee0a6b0?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/8463405/jorge"}, "reply_to_user": {"reputation": 2672, "user_id": 481422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/007ff0b62f46456d8ff2edc9c35f0153?s=128&d=identicon&r=PG", "display_name": "Zlatin Zlatev", "link": "https://stackoverflow.com/users/481422/zlatin-zlatev"}, "edited": false, "score": 0, "creation_date": 1503577367, "post_id": 45846435, "comment_id": 78681035, "body": "So could I also write first ofstream and ask for the number, then close the file, and open it again with ifstream in order to display the integers? Thanks for answering."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8463405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ecd249fe86a4e561e19a7bbee0a6b0?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/8463405/jorge"}, "edited": false, "score": 0, "creation_date": 1503577316, "post_id": 45847317, "comment_id": 78680992, "body": "Okay, it finally works, thank you VERY much. I thought that std::ios::in and ::out were already into &quot;fstream&quot;, now it works. Thanks."}], "tags": [], "owner": {"reputation": 672, "user_id": 7868736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba3186dc762c3fc009d2d025a1d1643?s=128&d=identicon&r=PG&f=1", "display_name": "Tyger", "link": "https://stackoverflow.com/users/7868736/tyger"}, "is_accepted": true, "score": 1, "last_activity_date": 1503514122, "creation_date": 1503514122, "answer_id": 45847317, "question_id": 45846435, "link": "https://stackoverflow.com/questions/45846435/program-that-reads-and-writes-integers-to-a-file/45847317#45847317", "title": "Program that reads and writes integers to a file", "body": "<p>There are a few things that are need to be fixed:</p>\n\n<pre><code>in.open(\"op.txt\",std::ios::in | std::ios::out | std::ios::app);\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/28338775/what-is-iosiniosout\">here</a> is why you need to do <code>std::ios::in and out</code> </p>\n\n<p>the second problem is when you are switching between writing and reading from the file like you stated the problem is with the position of the read pointer</p>\n\n<pre><code>in.seekg(0, std::ios::beg);//before the while loop;\n</code></pre>\n\n<p>this sets the read position to 0 so the program can read from the file from the beginning.<a href=\"https://stackoverflow.com/questions/2305480/why-cant-i-read-and-append-with-stdfstream-on-mac-os-x\">here</a></p>\n"}], "owner": {"reputation": 27, "user_id": 8463405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ecd249fe86a4e561e19a7bbee0a6b0?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/8463405/jorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 45847317, "answer_count": 1, "score": 1, "last_activity_date": 1503514122, "creation_date": 1503510870, "last_edit_date": 1503511144, "question_id": 45846435, "link": "https://stackoverflow.com/questions/45846435/program-that-reads-and-writes-integers-to-a-file", "title": "Program that reads and writes integers to a file", "body": "<p>Hello and thank you in advance. This is a very simple question but one that is getting on my nerves. What I want is just to ask for an integer to write to a file and then display every integer. I've learned how to either write to or display from a file and I've been successful at it but when I try to do both at a time it just asks me for the integer and don't display the numbers.\nI think it may be a problem related to fstream or to the position of the pointer.</p>\n\n<p>Here is the program:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;fstream&gt;\n\nusing std::cout;\nusing std::cin;\nusing std::fstream;\nusing std::endl;\n\nint a;\nint x;\n\nint main() {\n    fstream in;\n\n    in.open(\"op.txt\", std::ios::app);\n\n    cout &lt;&lt; \"Write an integer\" &lt;&lt; endl;\n    cin &gt;&gt; x;\n    in &lt;&lt; \" \" &lt;&lt; x;\n\n    while (in &gt;&gt; a) {\n        cout &lt;&lt; a &lt;&lt; endl;\n        cout &lt;&lt; in.tellg();\n    }\n\n    in.close();\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "serialization", "msgpack"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1503511126, "post_id": 45846203, "comment_id": 78651012, "body": "Maybe this answers your question: <a href=\"https://stackoverflow.com/questions/15579730/android-c-data-serialization\" title=\"android c data serialization\">stackoverflow.com/questions/15579730/&hellip;</a> You could think of other alternatives like google protocol buffers."}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 3353830, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0984c049ad7f7132fcde4dd3de2bce47?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/3353830/pranav"}, "edited": false, "score": 0, "creation_date": 1503607914, "post_id": 45861568, "comment_id": 78700354, "body": "Thank you so much for the example! This answers my question."}], "tags": [], "owner": {"reputation": 2569, "user_id": 1922763, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75228956a9f2a90a98b473672b91d807?s=128&d=identicon&r=PG", "display_name": "Takatoshi Kondo", "link": "https://stackoverflow.com/users/1922763/takatoshi-kondo"}, "is_accepted": true, "score": 4, "last_activity_date": 1503579181, "last_edit_date": 1503579181, "creation_date": 1503577395, "answer_id": 45861568, "question_id": 45846203, "link": "https://stackoverflow.com/questions/45846203/is-there-versioning-capability-in-msgpack/45861568#45861568", "title": "Is there versioning capability in Msgpack", "body": "<p>Yes you can do that. If you pack <code>foo_v1</code> and then unpack it, then convert it as <code>foo_v2</code>, <code>a</code> and <code>b</code> are filled with packed values.</p>\n\n<pre><code>#include &lt;msgpack.hpp&gt;\n#include &lt;cassert&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n\nstruct foo_v1 {\n    int a;\n    float b;\n    MSGPACK_DEFINE(a, b); // pack as ARRAY, order is important\n};\n\nstruct foo_v2 {\n    int a;\n    float b;\n    std::string c;\n    MSGPACK_DEFINE(a, b, c); // pack as ARRAY, order is important\n};\n\nint main() {\n    foo_v1 v1 { 123, 45.67 };\n    std::stringstream ss;\n    msgpack::pack(ss, v1);\n\n    auto oh = msgpack::unpack(ss.str().data(), ss.str().size());\n    auto v2 = oh.get().as&lt;foo_v2&gt;();\n    std::cout &lt;&lt; \"a: \" &lt;&lt; v2.a &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"b: \" &lt;&lt; v2.b &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"c: \" &lt;&lt; v2.c &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Running demo: <a href=\"https://wandbox.org/permlink/91wRtVdJJCC5IEDx\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/91wRtVdJJCC5IEDx</a></p>\n\n<p>Similarly, if you pack <code>foo_v2</code> and then unpack it, then convert it as <code>foo_v1</code>, <code>a</code> and <code>b</code> are filled with packed values, <code>c</code> is sliced (ignored).</p>\n\n<pre><code>#include &lt;msgpack.hpp&gt;\n#include &lt;cassert&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n\nstruct foo_v1 {\n    int a;\n    float b;\n    MSGPACK_DEFINE(a, b); // pack as ARRAY, order is important\n};\n\nstruct foo_v2 {\n    int a;\n    float b;\n    std::string c;\n    MSGPACK_DEFINE(a, b, c); // pack as ARRAY, order is important\n};\n\nint main() {\n    foo_v2 v2 { 123, 45.67, \"hello\" };\n    std::stringstream ss;\n    msgpack::pack(ss, v2);\n\n    auto oh = msgpack::unpack(ss.str().data(), ss.str().size());\n    auto v1 = oh.get().as&lt;foo_v1&gt;();\n    std::cout &lt;&lt; \"a: \" &lt;&lt; v1.a &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"b: \" &lt;&lt; v1.b &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Running demo: <a href=\"https://wandbox.org/permlink/mxmSkVHebZFiOM1q\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/mxmSkVHebZFiOM1q</a></p>\n\n<p>These examples are using <code>MSGPACK_DEFINE</code> macro. See <a href=\"https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_adaptor#defining-custom-adaptors\" rel=\"nofollow noreferrer\">https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_adaptor#defining-custom-adaptors</a>.\nIt is for packing/converting as ARRAY by default. So the order is important. \nIf you use <code>MSGPACK_DEFINE_MAP</code>, the user classes are packing/converting as MAP. The key of <code>MAP</code> is the variable name by default. You can change it using <code>MSGPACK_NVP</code> see <a href=\"https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_adaptor#since-210\" rel=\"nofollow noreferrer\">https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_adaptor#since-210</a>. The value of <code>MAP</code> is the value of the member variable.\n<code>MAP</code> is more flexible than <code>ARRAY</code> but inefficient. </p>\n\n<p>If you use <code>MSGPACK_DEFINE_MAP</code>, you don't need to care about order.</p>\n\n<pre><code>#include &lt;msgpack.hpp&gt;\n#include &lt;cassert&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n\nstruct foo_v1 {\n    int a;\n    float b;\n    MSGPACK_DEFINE_MAP(a, b); // pack as MAP\n};\n\nstruct foo_v2 {\n    int a;\n    std::string c;\n    float b;\n    MSGPACK_DEFINE_MAP(a, c, b); // pack as MAP, c is at the middle position\n};\n\nint main() {\n    foo_v2 v2 { 123, \"hello\", 45.67,  };\n    std::stringstream ss;\n    msgpack::pack(ss, v2);\n\n    auto oh = msgpack::unpack(ss.str().data(), ss.str().size());\n    auto v1 = oh.get().as&lt;foo_v1&gt;();\n    std::cout &lt;&lt; \"a: \" &lt;&lt; v1.a &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"b: \" &lt;&lt; v1.b &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Running demo: <a href=\"https://wandbox.org/permlink/ozihpwXMJRpOhzT4\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/ozihpwXMJRpOhzT4</a></p>\n\n<p>Here is more complecated example:\n<a href=\"https://github.com/msgpack/msgpack-c/blob/master/example/cpp03/map_based_versionup.cpp\" rel=\"nofollow noreferrer\">https://github.com/msgpack/msgpack-c/blob/master/example/cpp03/map_based_versionup.cpp</a></p>\n\n<p>Running demo: <a href=\"https://wandbox.org/permlink/IUp94Tc4MiT4kU07\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/IUp94Tc4MiT4kU07</a></p>\n"}], "owner": {"reputation": 541, "user_id": 3353830, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0984c049ad7f7132fcde4dd3de2bce47?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/3353830/pranav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 1, "accepted_answer_id": 45861568, "answer_count": 1, "score": 1, "last_activity_date": 1503579181, "creation_date": 1503510087, "question_id": 45846203, "link": "https://stackoverflow.com/questions/45846203/is-there-versioning-capability-in-msgpack", "title": "Is there versioning capability in Msgpack", "body": "<p>I'm evaluating Msgpack(C++) as a serialization library in my current project. It seems to satisfy most of my needs except one and I didn't find much information online about it. Does Msgpack support reading different versions of data structures which I will be serializing?</p>\n\n<p>for example, I serialize following structure:</p>\n\n<pre><code>struct foo {\n  int a;\n  float b;\n};\n</code></pre>\n\n<p>And later above structure evolved into:</p>\n\n<pre><code>struct foo {\n  int a;\n  float b;\n  std::string c;\n};\n</code></pre>\n\n<p>Is it possible to read previously serialized structure into newer one using Msgpack? Boost library handles it by adding <code>VERSION</code> metadata along with the structure.</p>\n"}, {"tags": ["c++", "c", "types"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1503509933, "post_id": 45846121, "comment_id": 78650271, "body": "What do you mean by &quot;how does it work&quot;, specifically?"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1503510005, "post_id": 45846121, "comment_id": 78650323, "body": "<code>void *</code> is always a pointer type, while a universal reference type contains all values, both pointers and nonpointers"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 4, "creation_date": 1503510020, "post_id": 45846121, "comment_id": 78650333, "body": "It can point to anything.  But, you have to tell the compiler what it is before you can actually get to what it points to."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1503510177, "post_id": 45846121, "comment_id": 78650428, "body": "Pointers are the closest you can get to a reference-like concept in C."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503510205, "post_id": 45846121, "comment_id": 78650442, "body": "<b><i>In C and C++, how does void * work as a universal reference type?</i></b> I say it does not. It works as a universal pointer. However to dereference you need to cast."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1503510219, "post_id": 45846121, "comment_id": 78650447, "body": "I wouldn&#39;t use the words &quot;universal reference&quot;, these belong to Scott Myers  now and have a different meaning. I would use &quot;opaque references&quot; instead, because the meaning of the value is known to the class that &quot;owns&quot; the data."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1503510253, "post_id": 45846121, "comment_id": 78650468, "body": "@RustyX: &quot;<i>I wouldn&#39;t use the words &quot;universal reference&quot;, these belong to Scott Myers now and have a different meaning.</i>&quot; No, they don&#39;t. Those are called &quot;forwarding references&quot;."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1503510412, "post_id": 45846121, "comment_id": 78650572, "body": "C <b>or</b> C++, pick one. You can&#39;t meaningfully talk about &quot;references&quot; in a way that makes sense for both languages (unless you simply say C doesn&#39;t have them at all)."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 2, "creation_date": 1503510495, "post_id": 45846121, "comment_id": 78650621, "body": "@Leushenko The quote from the book makes it clear that &quot;reference&quot; here is the general computer science term, and not C++ references specifically."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1503510732, "post_id": 45846121, "comment_id": 78650779, "body": "A pointer to a function may not fit in a <code>void*</code>.  <code>void*</code>, in C is <b>not</b> a universal reference type nor universal pointer type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1503510773, "post_id": 45846121, "comment_id": 78650803, "body": "In C++, you use templates, not containers of void pointers. Tagging this as C++ and C makes the question meaningless. I have removed the C++ tag."}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1503510802, "post_id": 45846121, "comment_id": 78650826, "body": "Note that the excerpt states that a universal reference type can <i>reference</i> any object, not that it can <i>contain</i> any object. So while a <code>void *</code> might not be able to <i>contain</i> a <code>uint128_t</code>, it can still <i>reference</i> (or point to) it."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1503510937, "post_id": 45846121, "comment_id": 78650905, "body": "@NeilButterworth Since the text quoted in the question specifically refers to both C and C++ in the same breath, I think this is one of the rare cases where it <i>is</i> appropriate to tag with both, but answerers should be careful to address both languages."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1503515576, "post_id": 45846121, "comment_id": 78653480, "body": "@zwol Anyone is at liberty to retag it."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1503511010, "post_id": 45846249, "comment_id": 78650954, "body": "&quot;A <code>void*</code> pointer will generally hold any pointer ...&quot;  --&gt; A <code>void*</code> may be insufficient to &quot;hold&quot; a function pointer.  I agree with <a href=\"https://stackoverflow.com/questions/45846121/how-does-void-work-as-a-universal-reference-type#comment78650980_45846249\">Oliver Charlesworth</a> that an attempt to save a function pointer in a <code>void*</code> is UB."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1503511059, "post_id": 45846249, "comment_id": 78650980, "body": "@chux - It&#39;s UB I believe."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1503511228, "post_id": 45846249, "comment_id": 78651088, "body": "Very, very slight nitpick (if I&#39;m right) on &quot;<i>You also need to convert it to the same pointer type that it was converted from</i>&quot;, <b>before you use it</b>. I think you can covert to any pointer type you like in the mean time. Though, I think that&#39;s more language-layer level than anything practical."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1503511231, "post_id": 45846249, "comment_id": 78651092, "body": "@chux UB per the letter of the standard, but required to &quot;work as expected&quot; by both POSIX and the de-facto Windows ABI."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1503511276, "post_id": 45846249, "comment_id": 78651120, "body": "@luk32 If you don&#39;t convert it to either a type compatible with the one you started with, or a character type, before dereferencing, you have UB because of the pointer-aliasing rules."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1503511340, "post_id": 45846249, "comment_id": 78651156, "body": "@zwol Aren&#39;t the conversions allowed, but using the result is an UB? My bad then."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1503511363, "post_id": 45846249, "comment_id": 78651168, "body": "@luk32 Er, yes, that&#39;s what I meant."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1503511618, "post_id": 45846249, "comment_id": 78651305, "body": "@zwol I think not only deference might be illegal, but using result as a parameter also, for e.g. <code>memcpy</code> I am not sure though. I was thinking about aliasing too. We obviously agree on dereferencing. That&#39;s what I meant by language-lawyer level thing. Cheers."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1503512170, "post_id": 45846249, "comment_id": 78651638, "body": "@chux can you expand on the restriction for function pointers? The only oddity I remember is long pointers on the segmented x86 architecture."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1503512352, "post_id": 45846249, "comment_id": 78651749, "body": "@zwol a compatible type might not be good enough. You&#39;ll get in trouble with multiply derived classes, since pointers to the base classes won&#39;t all have the same address. The compiler needs type information to properly adjust the pointer."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1503512646, "post_id": 45846249, "comment_id": 78651903, "body": "@MarkRansom I only know the rules for this in C, which doesn&#39;t have multiply derived anything.  C++ will be <i>similar</i>, but undoubtedly not the same. (Also, I mean &quot;compatible&quot; in the sense precisely defined by the C standard, which is a lot closer to &quot;exactly the same&quot; than most people realize.)"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1503513560, "post_id": 45846249, "comment_id": 78652411, "body": "@zwol originally the question was tagged with both C and C++. It looks like C++ was removed, so some of my answer and comments won&#39;t make sense. I can see that C might not have the same problem with compatible types."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1503513869, "post_id": 45846249, "comment_id": 78652580, "body": "@MarkRansom Your memory of segmented x86 architecture is an example of a possible wide function pointer (e.g. 32-bit) and a narrow <code>void*</code> (e.g. 16-bit) .  IAC, C (&#167;6.3 ...) specifies conversion to/from <i>object</i> pointers with <code>void*</code> and by omission, conversion to/from function pointers is UB.  A function pointer of one type converts to/from a function pointer of another type.  So <code>union { void *v; int (*f)(); }</code> is close to a universal &quot;ref&quot; type."}], "tags": [], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": false, "score": 8, "last_activity_date": 1503510255, "creation_date": 1503510255, "answer_id": 45846249, "question_id": 45846121, "link": "https://stackoverflow.com/questions/45846121/how-does-void-work-as-a-universal-reference-type/45846249#45846249", "title": "How does void* work as a universal reference type?", "body": "<p>A <code>void*</code> pointer will generally hold any pointer that is not a C++ pointer-to-member. It's rather inconvenient in practice, since you need to cast it to another pointer type before you can use it. You also need to convert it to the same pointer type that it was converted <em>from</em> to make the <code>void*</code>, otherwise you risk undefined behavior.</p>\n\n<p>A good example would be the <a href=\"http://en.cppreference.com/w/c/algorithm/qsort\" rel=\"noreferrer\"><code>qsort</code> function</a>. It takes a <code>void*</code> pointer as a parameter, meaning it can point to an array of anything. The comparison function you pass to <code>qsort</code> must know how to cast two <code>void*</code> pointers back to the types of the array elements in order to compare them.</p>\n"}, {"tags": [], "owner": {"reputation": 1063, "user_id": 6273701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a276eef0a6e4fe33b94244a14824992f?s=128&d=identicon&r=PG&f=1", "display_name": "P. Dmitry", "link": "https://stackoverflow.com/users/6273701/p-dmitry"}, "is_accepted": false, "score": 1, "last_activity_date": 1503510393, "creation_date": 1503510393, "answer_id": 45846295, "question_id": 45846121, "link": "https://stackoverflow.com/questions/45846121/how-does-void-work-as-a-universal-reference-type/45846295#45846295", "title": "How does void* work as a universal reference type?", "body": "<p>Probably the reason is that you can take address of any variable of any type and cast it to <code>void*</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1503510673, "post_id": 45846324, "comment_id": 78650739, "body": "Not in C++. This question makes no sense if it is tagged as both C and C++."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1503510809, "post_id": 45846324, "comment_id": 78650831, "body": "@NeilButterworth I&#39;ve edited in a supplement/clarification."}], "tags": [], "owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "is_accepted": false, "score": 1, "last_activity_date": 1503510772, "last_edit_date": 1503510772, "creation_date": 1503510507, "answer_id": 45846324, "question_id": 45846121, "link": "https://stackoverflow.com/questions/45846121/how-does-void-work-as-a-universal-reference-type/45846324#45846324", "title": "How does void* work as a universal reference type?", "body": "<p>It does by a silent contract that you know the actual type of object.</p>\n\n<p>So you can store different kinds of elements in a container, but you need to somehow know what is what when taking elements back, to interpret them correctly.</p>\n\n<p>The only convenience <code>void*</code> offers is that it's idiomatic for this, i.e. it's clear that dereferencing the pointer makes no sense, and <code>void*</code> is implicitly convertible to any pointer type. That is for c/</p>\n\n<p>In c++ this is called type erasure techniques preferred. Or special types, like <a href=\"http://en.cppreference.com/w/cpp/experimental/any\" rel=\"nofollow noreferrer\"><code>any</code></a> (there is a boost version of this too.)</p>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 6521348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c09392e2895896614088b2af7d293df?s=128&d=identicon&r=PG&f=1", "display_name": "Loi Ly", "link": "https://stackoverflow.com/users/6521348/loi-ly"}, "is_accepted": false, "score": 1, "last_activity_date": 1503510826, "creation_date": 1503510826, "answer_id": 45846423, "question_id": 45846121, "link": "https://stackoverflow.com/questions/45846121/how-does-void-work-as-a-universal-reference-type/45846423#45846423", "title": "How does void* work as a universal reference type?", "body": "<p><code>void*</code> is no more <b>just a pointer</b>. Thus, it <b>holds</b> an address of an object (or an array and stuffs like that)</p>\n\n<p>When your program is running, every variable should have it owns address in memory, right? And pointer is somethings point to that address.</p>\n\n<p>In normal, each type of pointer should be the same type of object <code>int b = 5; int* p = &amp;b;</code> for example. But that is the case you know what the type is, it means the <code>specific type</code>.</p>\n\n<p>But sometimes, you just want to know that it stores somethings somewhere in memory and you know what \"type\" of that address, you can cast easily. For example, in OpenCV library which I am learning, there are a lot of functions where user can pass the arguments to instead of declaring global variables and most use in <code>callback</code> functions, like this:\n<code>void onChange(int v, void *ptr)</code>\nHere, the library does not care about what <code>ptr</code> point to, it just know that when you call the function, if you pass an address to like this <code>onChange(5,&amp;b)</code> then you must cast <code>ptr</code> to the same type before dealing with it <code>int b = static_cast&lt;int*&gt;(ptr);</code></p>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 4, "last_activity_date": 1503510876, "creation_date": 1503510876, "answer_id": 45846438, "question_id": 45846121, "link": "https://stackoverflow.com/questions/45846121/how-does-void-work-as-a-universal-reference-type/45846438#45846438", "title": "How does void* work as a universal reference type?", "body": "<p>The crux of your confusion is that neither an instance of <code>void *</code> nor an instance of Modula-3's <code>refany</code>, nor an instance of any other language's \"can refer to anything\" type, <em>contains</em> the object that it refers to.  A variable of type <code>void *</code> is always a pointer and a variable of type <code>refany</code> is always a reference.  But the <em>object that they refer to</em> can be of any type.</p>\n\n<p>A purist of programming-language theory would tell you that C does not have references at all, because pointers are not references.  It has a nearly-universal <em>pointer</em> type, <code>void *</code>, which can point to an <em>object</em> of any type (including integers, aggregates, and other pointers).  As a common but not ubiquitous extension, it can also point to any function (functions are not objects).</p>\n\n<p>The purist would also tell you that C++ does <em>not</em> have a (nearly-)universal pointer type, because of its stricter type system, and doesn't have a universal reference type either.</p>\n\n<p>They would also say that the book you are reading is being sloppy with its terminology, and they would caution you to not take any one such book for the gospel truth on terminological matters, or any other matters.  You should instead read widely in both books and CS journals and conference proceedings (collectively known as \"the literature\") until you gain an \"ear\" for what is generally-agreed-on terminology, what is specific to a subdiscipline or a community of practice, and so on.</p>\n\n<p>And finally they would remind you that C and C++ are two different languages, and anyone who speaks of them in the same breath is either glossing over the distinctions (which may or may not be relevant in context), decades out of date, or both.</p>\n"}, {"comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 2, "creation_date": 1503511717, "post_id": 45846572, "comment_id": 78651366, "body": "&quot;A pointer to void will never be equal to another pointer&quot; - is that true?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1503514186, "post_id": 45846572, "comment_id": 78652770, "body": "<code>&quot;%p&quot;</code> matches a <code>void *</code>, not an <code>int *</code> as in this example code.  <code>printf(&quot;value of pi is %p\\n&quot;, pi);</code> is UB, even though it commonly &quot;works&quot;."}], "tags": [], "owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "is_accepted": false, "score": 0, "last_activity_date": 1503511346, "creation_date": 1503511346, "answer_id": 45846572, "question_id": 45846121, "link": "https://stackoverflow.com/questions/45846121/how-does-void-work-as-a-universal-reference-type/45846572#45846572", "title": "How does void* work as a universal reference type?", "body": "<p>Probably this explanation from  <a href=\"http://shop.oreilly.com/product/0636920028000.do\" rel=\"nofollow noreferrer\">Understanding pointers from Richard Reese</a>  will help</p>\n\n<blockquote>\n  <p>A pointer to void is a general-purpose pointer used to hold references to any data type.</p>\n</blockquote>\n\n<p>It has two interesting properties:   </p>\n\n<ul>\n<li><p>A pointer to void will have the same representation and memory alignment as a pointer to char  </p></li>\n<li><p>A pointer to void will never be equal to another pointer. However, two void pointers assigned a NULL  value will be equal.</p></li>\n</ul>\n\n<p>Any pointer can be assigned to a pointer to void. It can then be cast back to its original pointer type. When this happens the value will be equal to the original pointer value.</p>\n\n<p>This  is  illustrated  in  the  following  sequence,  where  a  pointer  to \nint   is  assigned  to  a pointer to void and then back to a pointer to int</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid main()\n{\n    int num = 100;\n    int *pi = &amp;num;\n\n    printf(\"value of pi is %p\\n\", pi);\n\n    void* pv = pi;\n    pi = (int*)pv;\n\n    printf(\"value of pi is %p\\n\", pi);\n}\n</code></pre>\n\n<p>Pointers to void are used for data pointers, not function pointers</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "answer_count": 6, "score": -3, "last_activity_date": 1503515661, "creation_date": 1503509821, "last_edit_date": 1503515661, "question_id": 45846121, "link": "https://stackoverflow.com/questions/45846121/how-does-void-work-as-a-universal-reference-type", "title": "How does void* work as a universal reference type?", "body": "<p>From Programming Language Pragmatics, by Scott</p>\n\n<blockquote>\n  <p>For systems programming, or to facilitate the writing of\n  general-purpose con- tainer (collection) objects (lists, stacks,\n  queues, sets, etc.) that hold references to other objects, several\n  languages provide a universal reference type. <strong>In C and C++, this\n  type is called void *</strong>. In Clu it is called any; in Modula-2,\n  address; in Modula-3, refany; in Java, Object; in C#, object.</p>\n</blockquote>\n\n<p>In C and C++, how does <code>void *</code> work as a universal reference type?</p>\n\n<p><code>void *</code> is always only a pointer type, while a universal reference type contains all values, both pointers and nonpointers. So I can't see how <code>void *</code> is a universal reference type.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "qt", "qlist"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503508358, "post_id": 45845648, "comment_id": 78649476, "body": "Look at <a href=\"https://en.wikipedia.org/wiki/Topological_sorting\" rel=\"nofollow noreferrer\">Topological_sorting</a>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1503508492, "post_id": 45845648, "comment_id": 78649561, "body": "Your comparator is broken for <code>std::sort</code> as <code>D</code> doesn&#39;t depend of <code>A</code> (through <code>B</code>)."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1503508701, "post_id": 45845648, "comment_id": 78649677, "body": "BTW, you reverse the logic, if dependencies were complete, it would be <code>return !a.dependencies.contains(b.NAME);</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503508893, "post_id": 45845648, "comment_id": 78649783, "body": "[OT]: passing directly <code>QStringList</code> instead of 3 <code>QString</code> seems more logical (even if call sites become <code>ImportWithDependency(&quot;B&quot;, {&quot;A&quot;})</code>)."}], "owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503508105, "creation_date": 1503508105, "question_id": 45845648, "link": "https://stackoverflow.com/questions/45845648/sort-qlist-items-based-on-dependencies-using-stdsort", "title": "Sort QList items based on dependencies using std::sort", "body": "<p>I have <code>QString</code>s of item names such as \"Put coffee\", \"Start coffee machine\" or \"Pour milk into coffee\". I have such class to describe dependency (stripped of irrelevant stuff):</p>\n\n<pre><code>class ImportWithDependency {\npublic:\n    // varargs je pro lenochy\n    ImportWithDependency(const QString&amp; itemName, const QString&amp; dependsOn = \"\", const QString&amp; dependsOn2=\"\", const QString&amp; dependsOn3 = \"\")\n        : NAME(itemName)\n        , LOCALISED_NAME(getViewLocalisedName(viewName))\n    {\n        if (!dependsOn.isEmpty())\n            dependencies &lt;&lt; dependsOn;\n        if (!dependsOn2.isEmpty())\n            dependencies &lt;&lt; dependsOn2;\n        if (!dependsOn3.isEmpty())\n            dependencies &lt;&lt; dependsOn3;\n    }\n    // cannot be const for sorting\n    QString NAME;\n    QStringList dependencies;\n};\n</code></pre>\n\n<p>I want to sort items of <code>QList&lt;MyDependencyInfo&gt;</code> so that no item is preceded by item which depends on it.</p>\n\n<p>I created the following comparator:</p>\n\n<pre><code>class ImportDependencyComparator\n{\npublic:\n    bool operator()(const ImportWithDependency&amp; a, const ImportWithDependency&amp; b) const\n    {\n        // check if a depends on b\n        if (a.dependencies.contains(b.NAME))\n            return true;\n        else\n            return false;\n    }\n};\n</code></pre>\n\n<p>I init the list like this:</p>\n\n<pre><code>    QList&lt;ImportWithDependency&gt; views;\n    views &lt;&lt; ImportWithDependency(\"A\");\n    // B depends on A\n    views &lt;&lt; ImportWithDependency(\"B\", \"A\");\n    // C depends on A\n    views &lt;&lt; ImportWithDependency(\"C\", \"A\");\n    // D depends on B\n    views &lt;&lt; ImportWithDependency(\"D\", \"B\");\n</code></pre>\n\n<p>And I sort like this:</p>\n\n<pre><code>std::sort(views.begin(), views.end(), ImportDependencyComparator());\n</code></pre>\n\n<p>And the result is:</p>\n\n<p>D B C A</p>\n\n<p>Instead of:</p>\n\n<p>A B C D</p>\n\n<p>The order I'm getting seems to be random, though same every time. What's wrong? Can this even be used for sorting?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 5, "creation_date": 1503507854, "post_id": 45845546, "comment_id": 78649198, "body": "You don&#39;t <i>override</i> but <i>hide</i> method. Do you want to use virtual methods ?"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 3, "creation_date": 1503507862, "post_id": 45845546, "comment_id": 78649205, "body": "This is not how inheritance works. Learn about <code>virtual</code>, <code>override</code>, overloading and hiding of members."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1503507875, "post_id": 45845546, "comment_id": 78649213, "body": "There are no overridden functions in this snippet. You should reread the relevant section in your book."}, {"owner": {"reputation": 89, "user_id": 6000675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2b3e672b629bfbf9f9a3ba1a8bc85f?s=128&d=identicon&r=PG&f=1", "display_name": "rudky", "link": "https://stackoverflow.com/users/6000675/rudky"}, "edited": false, "score": 0, "creation_date": 1503507900, "post_id": 45845546, "comment_id": 78649226, "body": "I understand the concept of virtual but like I said I cannot change code of class A"}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 0, "creation_date": 1503508008, "post_id": 45845546, "comment_id": 78649279, "body": "The <b>override</b> is not essential, but is advisable. However, what is required is that the base class method must be declared as <b>virtual</b>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503508019, "post_id": 45845546, "comment_id": 78649284, "body": "If you do understand that stuff, it should be clear that virtual function calls cannot happen in a non-virtual context."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1503508044, "post_id": 45845546, "comment_id": 78649297, "body": "If you want <code>B::function_1()</code> to behave differently from <code>A::function_1()</code> then you just have to implement <code>B::function_1()</code> to do what you want. However, since you can&#39;t change <code>A</code>, you will not be able to achieve polymorphic behavior this way, if that&#39;s desirable for your situation."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1503508219, "post_id": 45845546, "comment_id": 78649390, "body": "You should consider rather or not inheritance is the right tool for this job. The uses for public inheritance without polymorphism in a data class is limited and very misleading for the user. You probably don&#39;t want to pass <code>B</code> where an <code>A</code> is expected. Have you thought of simply giving <code>B</code> a <code>A</code> member?"}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 0, "creation_date": 1503508388, "post_id": 45845546, "comment_id": 78649498, "body": "<code>B::function_2()</code> <b><i>cannot</i></b> <i>override</i> <code>A::function_2()</code> unless <code>A::function_2()</code> is virtual. Commenting as such doesn&#39;t change anything. You can get <code>objB.function_1();</code> to call <code>B::function_2()</code> by <i>also hiding</i> <code>A::function_1()</code> .... but that stil is <b><i>NOT</i></b> overriding!"}, {"owner": {"reputation": 89, "user_id": 6000675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2b3e672b629bfbf9f9a3ba1a8bc85f?s=128&d=identicon&r=PG&f=1", "display_name": "rudky", "link": "https://stackoverflow.com/users/6000675/rudky"}, "edited": false, "score": 0, "creation_date": 1503508428, "post_id": 45845546, "comment_id": 78649525, "body": "Oh OK so I used the wrong term it is not overridden function but hided function"}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 1, "creation_date": 1503508832, "post_id": 45845546, "comment_id": 78649747, "body": "@rudky It&#39;s not just a wrong term - the semantic difference is <b><i>very</i></b> important. It&#39;s the difference between doing what you want to do and <b><i>not being able to</i></b> do what you want."}], "answers": [{"tags": [], "owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "is_accepted": false, "score": 0, "last_activity_date": 1503511462, "last_edit_date": 1503511462, "creation_date": 1503509578, "answer_id": 45846047, "question_id": 45845546, "link": "https://stackoverflow.com/questions/45845546/how-to-make-the-inherited-function-to-call-the-derived-class-function-without-vi/45846047#45846047", "title": "How to make the inherited function to call the derived class function without virtual functions", "body": "<blockquote>\n  <p>Is it possible to do it provided that I cannot change the code of <code>A</code> class?</p>\n</blockquote>\n\n<p>As others already pointed out in comments, that's not possible without making function <code>A::function_2()</code> a <code>virtual</code> function.</p>\n\n<p>So if you can't change <code>class A</code> that's not possible.</p>\n\n<hr>\n\n<p>One option is to reimplement <code>A::function_1()</code> in your derived <code>class B</code>.</p>\n\n<p>Though you could provide a wrapper class for <code>A</code> that provides virtual functions which can be overridden in derived classes and makes that easier for future inheritors:</p>\n\n<pre><code>class AWrap {\nprotected:\n    A wrappedA;\npublic:\n    virtual void function_1() {\n        // Reimplement A::function_1() \"other codes\"\n        function_2();\n    }\n    virtual void function_2() {\n        wrappedA.function_2();\n    }\n};\n\nclass B : public AWrap {\npublic:\n    void function_2() override {\n         // Implement the B specific stuff\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6000675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2b3e672b629bfbf9f9a3ba1a8bc85f?s=128&d=identicon&r=PG&f=1", "display_name": "rudky", "link": "https://stackoverflow.com/users/6000675/rudky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1503511462, "creation_date": 1503507783, "last_edit_date": 1503509663, "question_id": 45845546, "link": "https://stackoverflow.com/questions/45845546/how-to-make-the-inherited-function-to-call-the-derived-class-function-without-vi", "title": "How to make the inherited function to call the derived class function without virtual functions", "body": "<p>Let's assume I have class <code>A</code> and <code>B</code> as follows:</p>\n\n<pre><code>class A\n{\n    public:\n        void function_1(){ /*other codes*/; function_2();};\n        void function_2();\n };\n\nclass B:public A\n{\n   public:\n   void function_2(); // this function is reimplementation of A::function_2()\n};\n</code></pre>\n\n<p>Now assume in the main code I have</p>\n\n<pre><code>B objB;\nobjB.function_1();\n</code></pre>\n\n<p>From my test if I leave the code as above, it will still call <code>A::function_2()</code> internally when <code>objB.function_1()</code> is called.</p>\n\n<p>I want <code>objB.function_1()</code> will internally call the <code>B::function_2()</code>, not <code>A::function_2()</code>. Is it possible to do it provided that I cannot change the code of <code>A</code> class?</p>\n"}, {"tags": ["c++", "c++builder", "vcl"], "answers": [{"comments": [{"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1503698041, "post_id": 45849517, "comment_id": 78739255, "body": "I&#39;m trying your suggestion of overriding WndProc().   I have in my Main Forms WndProc the following:      void __fastcall TMain::WndProc(TMessage&amp; Message)    {      if(Message.Msg == WM_GETDLGCODE)      {     \tLog(lInfo) &lt;&lt; &quot;Got WM_GETDLGCODE&quot;;         //Message.Result = DLGC_WANTARROWS;     ..... But even though I&#39;m clicking on an arrow key, I never trap the message. Also, where, how  does one &#39;switch&#39; to wanting arrows? Sorry for the confusion and not sure how to add formatted code to a comment.."}, {"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1503942041, "post_id": 45849517, "comment_id": 78807665, "body": "This approach seem not to work properly, see my update above. As soon a TButton is put on the main form, and thereby unfocusing it, no special keys comes through to the Main form. Or I might be missing something.."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1503962913, "post_id": 45849517, "comment_id": 78815928, "body": "@TotteKarlsson: Yes, because you are trying to catch the keys in the Form window, but the button window has the input focus, so the key messages go to the button instead. I updated my answer with more details."}, {"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1504042068, "post_id": 45849517, "comment_id": 78855835, "body": "I got the code working with your suggestions above. Great, and great story about the Key in suggested link."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1503963414, "last_edit_date": 1503963414, "creation_date": 1503523522, "answer_id": 45849517, "question_id": 45845465, "link": "https://stackoverflow.com/questions/45845465/how-to-use-keyboard-arrows-for-input-in-a-vcl-forms-application-with-tbuttons/45849517#45849517", "title": "How to use keyboard arrows for input in a VCL forms application with TButtons", "body": "<p>Arrow keys are reserved by Windows for navigation purposes.  If a window wants to handle arrow key messages, it must respond to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms645425.aspx\" rel=\"nofollow noreferrer\"><code>WM_GETDLGCODE</code></a> message and include the <code>DLGC_WANTARROWS</code> (or <code>DLGC_WANTALLKEYS</code>) flag in its return value.</p>\n\n<p>Most VCL UI components (including <code>TForm</code>) return 0 for <code>WM_GETDLGCODE</code>.  Only a handful of standard VCL components respond with <code>DLGC_WANTARROWS</code> (or <code>DLGC_WANTALLKEYS</code>):</p>\n\n<p><code>TColorGrid</code>, <code>TToolBar</code>, <code>TCustomGrid</code>, <code>TMediaPlayer</code>, <code>TCustomRibbon</code>, <code>TRibbonSpinButton</code>, <code>TSpinButton</code>, <code>TTabbedNotebook</code>, <code>TCustomCombo</code>, and <code>TTabSet</code></p>\n\n<p>In your <code>TForm</code> class, override its virtual <code>WndProc()</code> method, or declare a <code>message</code> handler, to handle <code>WM_GETDLGCODE</code>, then you can return whatever flag(s) you need.</p>\n\n<pre><code>void __fastcall TMyForm::WndProc(TMessage &amp;Message)\n{\n    TForm::WndProc(Message);\n    if (Message.Msg == WM_GETDLGCODE)\n        Message.Result |= DLGC_WANTARROWS;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Update</strong>: If <code>WM_GETDLGCODE</code> doesn't work, try responding to the <code>CM_WANTSPECIALKEY</code> message instead:</p>\n\n<pre><code>void __fastcall TMyForm::WndProc(TMessage &amp;Message)\n{\n    TForm::WndProc(Message);\n    if (Message.Msg == CM_WANTSPECIALKEY)\n    {\n        switch (reinterpret_cast&lt;TCMWantSpecialKey&amp;&gt;(Message).CharCode)\n        {\n            case VK_LEFT:\n            case VK_RIGHT:\n            case VK_UP:\n            case VK_DOWN:\n                Message.Result = 1;\n                break;\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Update</strong>: you are trying to process key events in the Form itself, which will only work when:</p>\n\n<ul>\n<li><p>the Form window itself has input focus.</p></li>\n<li><p>a child VCL window receives key messages, and the Form's <code>KeyPreview</code> property is true.</p></li>\n</ul>\n\n<p>When a windowed child control, like a button, has the input focus, key messages go to that window, not to the Form window.  In order for the <code>KeyPreview</code> property to work for arrow keys, the focused child must respond to the <code>WM_GETDLGCODE</code> message asking the OS to send arrow key messages.  Only then can the child forward the messages to the Form for processing.</p>\n\n<p>A button doesn't ask for arrow key messages by default, so you would have to subclass the button to handle the <code>WM_GETDLGCODE</code> message manually, eg:</p>\n\n<pre><code>class TMain : public TForm\n{\n__published:\n    TButton *Button1;\n    void __fastcall FormKeyDown(TObject *Sender, Word &amp;Key, TShiftState Shift);\n    void __fastcall FormKeyPress(TObject *Sender, Char &amp;Key);\nprivate:\n    TWndMethod PrevBtnWndProc;\n    void __fastcall BtnWndProc(TMessage &amp;Message);\npublic:\n    __fastcall TMain(TComponent *Owner);\n};\n\n__fastcall TMain::TMain(TComponent *Owner)\n    : TForm(Owner)\n{\n    PrevBtnWndProc = Button1-&gt;WindowProc;\n    Button1-&gt;WindowProc = &amp;BtnWndProc;\n}\n\nvoid __fastcall TMain::BtnWndProc(TMessage &amp;Message\n{\n    PrevBtnWndProc(Message);\n    if (Message.Msg == WM_GETDLGCODE)\n        Message.Result |= DLGC_WANTARROWS;\n}\n\nvoid __fastcall TMain::FormKeyDown(TObject *Sender, Word &amp;Key, TShiftState Shift)\n{\n    // works now!\n}\n\nvoid __fastcall TForm7::FormKeyPress(TObject *Sender, Char &amp;Key)\n{\n    // works now!\n}\n</code></pre>\n\n<p>That is fine if you have only a few controls to subclass, but if you have a lot of controls, an alternative solution would be to have your Form class handle the <code>CM_DIALOGKEY</code> message instead:</p>\n\n<pre><code>void __fastcall TMyForm::WndProc(TMessage &amp;Message)\n{\n    TForm::WndProc(Message);\n    if (Message.Msg == CM_DIALOGKEY)\n    {\n        switch (reinterpret_cast&lt;TCMDialogKey&amp;&gt;(Message).CharCode)\n        {\n            case VK_LEFT:\n            case VK_RIGHT:\n            case VK_UP:\n            case VK_DOWN:\n                // process key as needed...\n                // set Message.Result to suppress the message further...\n                Message.Result = 1;\n                break;\n        }\n    }\n}\n</code></pre>\n\n<p>You should read the following article on EDN, it has a good explanation of how the VCL processes key messages, and how the VCL implements various hooks you can use to intercept key messages:</p>\n\n<p><a href=\"http://edn.embarcadero.com/article/38447\" rel=\"nofollow noreferrer\">A Key\u2019s Odyssey</a></p>\n"}, {"comments": [{"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1503698373, "post_id": 45854430, "comment_id": 78739361, "body": "I guess I could take your 1st approach, as I only have 4 buttons on a form. However, in case thats not possible, then the WndProc approach may be the way??"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "reply_to_user": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1503732099, "post_id": 45854430, "comment_id": 78744980, "body": "@TotteKarlsson I am not that familiar with <b>WinAPI</b> as I do not use it too often but I guess it is a way. The second approach works without <b>WinAP</b>I too you do not need to override any <code>WndProc</code> you just add the 3 line function and single button to your project + call it time to time (when needed) that is it ....  I use it all the time for huge projects like <b>CAD/CAM</b> with a lot of components and subwindows without any problems ...."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "reply_to_user": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1503732489, "post_id": 45854430, "comment_id": 78745085, "body": "@TotteKarlsson Also hope you&#39;re using <code>OnKeyDown&#47;Up</code> instead of <code>OnKeyPress</code> as that does not return extended key codes only <b>ASCII</b>...."}, {"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1503940085, "post_id": 45854430, "comment_id": 78806719, "body": "I tried your approach #2, and indeed, it works fine.  Curious, I assume the function is giving focus to the main form, and therefore trapping the arrow keys works, but you call the function main_unfocus. What&#39;s the rationale for &#39;unfocus&#39;?"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "reply_to_user": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1503942924, "post_id": 45854430, "comment_id": 78808118, "body": "@TotteKarlsson it unfocus any sub component ... leaving focus to parent window of <code>bt_unfocus</code> which is Main form in my case"}], "tags": [], "owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "is_accepted": false, "score": 1, "last_activity_date": 1503556579, "last_edit_date": 1503556579, "creation_date": 1503556171, "answer_id": 45854430, "question_id": 45845465, "link": "https://stackoverflow.com/questions/45845465/how-to-use-keyboard-arrows-for-input-in-a-vcl-forms-application-with-tbuttons/45854430#45854430", "title": "How to use keyboard arrows for input in a VCL forms application with TButtons", "body": "<p>I am doing this a bit differently (no <strong>WinAPI</strong> needed). If your <strong>VCL</strong> app has no focus on any sub component (like <code>TButton,TEdit,TMemo</code>...) then Main form keyboard events (<code>OnKeyDown</code> and <code>OnKeyUp</code>) will fire on arrow keys use. There are 2 approaches for this I know of:</p>\n\n<ol>\n<li><p><strong>do not use components with focus</strong></p>\n\n<p>it may sound silly but you can have <code>TSpeedButton</code> instead of <code>TButton</code>. but essentially you can place all focusable components in some sub-window or page and make it invisible if not needed (like setup window).</p></li>\n<li><p><strong>disable focus when arrows are needed</strong></p>\n\n<p>Simply I make an <code>unfocus</code> function like this:</p>\n\n<pre><code>void main_unfocus()\n    {\n    Main-&gt;bt_unfocus-&gt;Visible=true;\n    Main-&gt;bt_unfocus-&gt;SetFocus();\n    Main-&gt;bt_unfocus-&gt;Visible=false;\n    }\n</code></pre>\n\n<p>where <code>bt_unfocus</code> is invisible 2x2 <code>TButton</code> placed in top left corner of main window <code>Main</code>. Now whenever I need to capture events like mouse wheel, arrow keys etc in the main form events then I just call the <code>main_unfocus();</code> </p>\n\n<p>I usually call it on mouse click on some viewing area or mouse move over it etc and Also I call this on hitting escape on any such component like <code>TButton,TMemo,TEdit</code> as they usually share the same event handlers in my Apps. All depends on what functionality you need/want.</p></li>\n</ol>\n\n<p><strong>PS</strong> hope you set the <code>KeyPreview</code> property to <code>true</code>.</p>\n"}], "owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "accepted_answer_id": 45849517, "answer_count": 2, "score": 3, "last_activity_date": 1503963414, "creation_date": 1503507459, "last_edit_date": 1503939471, "question_id": 45845465, "link": "https://stackoverflow.com/questions/45845465/how-to-use-keyboard-arrows-for-input-in-a-vcl-forms-application-with-tbuttons", "title": "How to use keyboard arrows for input in a VCL forms application with TButtons", "body": "<p>I have a VCL forms application where I'm intercepting keys pressed in the OnKeyPress and OnKeyDown handlers. This works fine for regular characters and keys like VK_ESC for example.</p>\n\n<p>However, when trying to catch the arrow keys (VK_UP and VK_DOWN), it does not work as they seem only to be changing the focus of the controls on the main form, and are not triggering the main forms OnKeyDown handler.</p>\n\n<p>How does one catch/process those key presses?</p>\n\n<p>Update:\nTrying the following, based on answer below, but still no success.</p>\n\n<pre><code>void __fastcall TMain::WndProc(TMessage&amp; Message)\n{\n  switch (Message.Msg)\n  {\n    case WM_GETDLGCODE:\n        Log(lInfo) &lt;&lt; \"Got WM_GETDLGCODE\";\n    break;\n    case CM_WANTSPECIALKEY:\n        Log(lInfo) &lt;&lt; \"Got WM_WANTSPECIALKEY\";\n    break;\n</code></pre>\n\n<p>None of the above cases are triggered by using the up/down arrows in my application. </p>\n\n<p>I have made the following observation. If creating an empty vcl form, the above cases <strong>are</strong> triggered, CM_WANSPECIALKEY is triggered first, followed by WM_GETDLGCODE. </p>\n\n<p>However, as soon as a TButton is placed on the form, the cases are not triggered anymore. </p>\n\n<p>I'm using C++ Builder XE3. </p>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1503507156, "post_id": 45845350, "comment_id": 78648829, "body": "Why are you defining your own oddball template container class instead of just using <code>std::vector</code>?"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1503507980, "post_id": 45845350, "comment_id": 78649265, "body": "In short templates work at compile time and <code>function_count</code> runs at runtime. You can either try to make <code>function_count</code> <code>constexpr</code> or just make <code>int T</code> a runtime variable like <code>std::vector</code> does."}], "answers": [{"comments": [{"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 0, "creation_date": 1503518920, "post_id": 45845615, "comment_id": 78655104, "body": "Are you sure that <code>vec.size() == 5</code> when you do <code>std::vector&lt;float&gt; vec(4)</code>?!"}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 1, "creation_date": 1503540501, "post_id": 45845615, "comment_id": 78661815, "body": "@AlexisWilke It was typo error. Corrected now. Thanks for your attention:)"}, {"owner": {"reputation": 11, "user_id": 8484572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f235ee1cf7e16bd5d2b47b7c1dc140e7?s=128&d=identicon&r=PG&f=1", "display_name": "Cataboum", "link": "https://stackoverflow.com/users/8484572/cataboum"}, "edited": false, "score": 0, "creation_date": 1503561057, "post_id": 45845615, "comment_id": 78669624, "body": "If I want to use <code>std::vector</code>, I have to declare <i>result</i> as <code>vector&lt;vector&lt;float&gt; &gt; result</code> ? And so, how can I say that the &quot;second&quot; vector has a len of 5?"}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 11, "user_id": 8484572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f235ee1cf7e16bd5d2b47b7c1dc140e7?s=128&d=identicon&r=PG&f=1", "display_name": "Cataboum", "link": "https://stackoverflow.com/users/8484572/cataboum"}, "edited": false, "score": 0, "creation_date": 1504016915, "post_id": 45845615, "comment_id": 78841663, "body": "@Cataboum You can&#39;t be sure from line <code>vector&lt;vector&lt;float&gt; &gt; result</code>; but you can set size of <code>vector&lt;float&gt;</code> to 5 when creating it."}], "tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": false, "score": 3, "last_activity_date": 1503540432, "last_edit_date": 1503540432, "creation_date": 1503508008, "answer_id": 45845615, "question_id": 45845350, "link": "https://stackoverflow.com/questions/45845350/c-struct-with-length-of-list-as-parameter/45845615#45845615", "title": "C++ struct with length of list as parameter", "body": "<p>Size of <code>std::vector</code> is auto adjustable i.e. its size can increase or decrease as need. So just create the vector of an appropriate type.</p>\n\n<ul>\n<li>to add element use function <code>void push_back (const value_type&amp; val);</code> of <code>std::vector</code></li>\n<li>to delete element use function <code>void pop_back();</code> of <code>std::vector</code></li>\n</ul>\n\n<p>You can also create a vector with initial size set. For example, the following sets the size of vector <code>vec</code> to 5:</p>\n\n<pre><code>std::vector&lt;float&gt; vec(5);\n</code></pre>\n\n<p>You can <a href=\"http://www.cplusplus.com/reference/vector/vector/\" rel=\"nofollow noreferrer\">get more information about vector here</a></p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1503509596, "creation_date": 1503509596, "answer_id": 45846056, "question_id": 45845350, "link": "https://stackoverflow.com/questions/45845350/c-struct-with-length-of-list-as-parameter/45846056#45846056", "title": "C++ struct with length of list as parameter", "body": "<p><code>const</code> and <code>constexpr</code> are different.</p>\n\n<p>template argument requires constant expression, so you should modify your code to something like:</p>\n\n<pre><code>constexpr int function_count() { return 64; }\n\nvoid foo()\n{\n    // ...\n    constexpr int n = function_count(); \n    std::vector&lt;channels&lt;n&gt; &gt; result;\n    // ...\n }\n</code></pre>\n\n<p>If <code>function_count</code> cannot be <code>constexpr</code>, you have to change <code>struct channels</code> to also be dynamic as for example:</p>\n\n<pre><code>struct channels {\n    std::vector&lt;float&gt; d;\n};\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8484572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f235ee1cf7e16bd5d2b47b7c1dc140e7?s=128&d=identicon&r=PG&f=1", "display_name": "Cataboum", "link": "https://stackoverflow.com/users/8484572/cataboum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1503563863, "creation_date": 1503507044, "last_edit_date": 1503563863, "question_id": 45845350, "link": "https://stackoverflow.com/questions/45845350/c-struct-with-length-of-list-as-parameter", "title": "C++ struct with length of list as parameter", "body": "<p>I'm trying to use a function that take a struct as parameter.</p>\n\n<pre><code>/**\n* @param chunk A vector of C-style structs to hold the samples.\n* @param timestamps A vector to hold the time stamps.\n* @return True if some data was obtained.\n*/\ntemplate&lt;class T&gt; bool the_function(std::vector&lt;T&gt; &amp;C, std::vector&lt;double&gt; &amp;timest){\n    T sample;\n    C.clear();\n    timest.clear();\n    while (double ts=other_function(sample,0.0)) {\n        C.push_back(sample);\n        timest.push_back(ts);\n    }\n    return !chunk.empty();\n}\n</code></pre>\n\n<p>In an example (which works fine), the struct defines a list/vector (I don't know which one is correct) of a fixed size.</p>\n\n<pre><code>using namespace std\n\nstruct sample {\n    float d[64];\n};\n\nint main(int argc, char* argv[]) {\n\n    // Some stuff is made\n\n    vector&lt;sample&gt; result;\n    vector&lt;double&gt; ts;\n    if (double timest = the_function(result, ts)){\n        cout &lt;&lt; timest &lt;&lt; endl;\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>But I want to use the same function with a list size <em>n</em> that I can choose.</p>\n\n<p>I tried to add a parameter to the struct to allow me to choose the size :</p>\n\n<pre><code>template &lt;int T&gt;\nstruct channels {\n    float d[T];\n};\n</code></pre>\n\n<p>And to use it, I used it like in the example :</p>\n\n<pre><code>const int n = function_count(); \n// function_count is a function from a class that return an int\nvector&lt;channels&lt;n&gt; &gt; result;\nvector&lt;double&gt; ts;\n</code></pre>\n\n<p>But I've got the error at the line where I declare result :<br>\n<em>error: the value of 'n' is not usable in a constant expression</em></p>\n\n<p>I tried to use</p>\n\n<pre><code>const int n = 64;\n</code></pre>\n\n<p>and it worked, so I think that the function_count makes the difference, but the function_count just return an int.</p>\n\n<p>So do I have to use another kind of <em>struct</em>? How can I create a struct that can be used with parameters defined by a function?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I want to find a solution without modifying the <code>function_count</code> and <code>the_function</code>, because I didn't made those two functions.</p>\n\n<p>I tried to use only vector to declare <code>result</code>, the compilation works, but when it try to use it, I've got the error : <code>Got an exception: An argument was incorrectly specified.</code></p>\n"}, {"tags": ["c++", "namespaces"], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 3441514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXQwu.jpg?s=128&g=1", "display_name": "Massinissa", "link": "https://stackoverflow.com/users/3441514/massinissa"}, "is_accepted": true, "score": 0, "last_activity_date": 1503528440, "creation_date": 1503528440, "answer_id": 45850416, "question_id": 45845260, "link": "https://stackoverflow.com/questions/45845260/building-audio-analysis-library-essentia-failed-with-gaia-support/45850416#45850416", "title": "Building audio analysis library Essentia failed with Gaia support", "body": "<p>It is finally an error that occurred while configuring <code>Gaia</code> that caused the problem. Actually, rather than using merely the following options for configuration:</p>\n\n<pre><code>./waf configure --with-python-bindings --with-asserts --with-cyclops\n</code></pre>\n\n<p>the option <code>--with-stlfacade</code> was added by inadvertence. This option  is not compatible when using <code>Gaia</code> in conjunction with <code>Essentia</code>.</p>\n"}], "owner": {"reputation": 85, "user_id": 3441514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXQwu.jpg?s=128&g=1", "display_name": "Massinissa", "link": "https://stackoverflow.com/users/3441514/massinissa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 45850416, "answer_count": 1, "score": 0, "last_activity_date": 1503528440, "creation_date": 1503506747, "question_id": 45845260, "link": "https://stackoverflow.com/questions/45845260/building-audio-analysis-library-essentia-failed-with-gaia-support", "title": "Building audio analysis library Essentia failed with Gaia support", "body": "<p>I am trying to build <code>Essentia</code> (<a href=\"https://github.com/MTG/essentia\" rel=\"nofollow noreferrer\">https://github.com/MTG/essentia</a>), an audio analysis library, with <code>Gaia</code> (<a href=\"https://github.com/MTG/gaia\" rel=\"nofollow noreferrer\">https://github.com/MTG/gaia</a>) support in <code>Debian 9.0</code> from source. Before that, one of its dependencies, namely <code>Gaia</code>, was successfully  built, also, from source. It was installed in <code>/usr/local/</code>.</p>\n\n<p>When it comes to <code>Essentia</code>, compilation of sources fails with the following errors:</p>\n\n<pre><code>[...]\n        In file included from ../src/algorithms/essentia_algorithms_reg.cpp:21:0:\n    ../src/algorithms/highlevel/gaiatransform.h: At global scope:\n    ../src/algorithms/highlevel/gaiatransform.h:37:10: error: \u2018TransfoChain\u2019 in namespace \u2018gaia2\u2019 does not name a type\n       gaia2::TransfoChain _history;\n              ^~~~~~~~~~~~\n    ../src/algorithms/highlevel/gaiatransform.h: In constructor \u2018essentia::standard::GaiaTransform::GaiaTransform()\u2019:\n    ../src/algorithms/highlevel/gaiatransform.h:47:5: error: \u2018init\u2019 is not a member of \u2018gaia2\u2019\n         gaia2::init();\n         ^~~~~\n    ../src/algorithms/highlevel/gaiatransform.h:47:5: note: suggested alternative:\n    In file included from ../src/essentia/algorithmfactory.h:27:0,\n                     from ../src/algorithms/essentia_algorithms_reg.cpp:1:\n    ../src/essentia/essentia.h:46:6: note:   \u2018essentia::init\u2019\n     void init();\n          ^~~~\n</code></pre>\n\n<p>The file where the error lies is <code>/src/algorithms/essentia_algorithms_reg.cpp</code> and here is the command which the file is compiled with:</p>\n\n<pre><code>/usr/bin/g++ -pipe -Wall -std=c++03 -msse -msse2 -mfpmath=sse -O2 -fPIC -pthread -Isrc -I../src -Isrc/essentia -I../src/essentia -Isrc/essentia/scheduler -I../src/essentia/scheduler -Isrc/essentia/streaming -I../src/essentia/streaming -Isrc/essentia/streaming/algorithms -I../src/essentia/streaming/algorithms -Isrc/essentia/utils -I../src/essentia/utils -Isrc/3rdparty -I../src/3rdparty -Isrc/3rdparty/spline -I../src/3rdparty/spline -Isrc/3rdparty/vamp-plugin-sdk-2.4 -I../src/3rdparty/vamp-plugin-sdk-2.4 -I/usr/include/x86_64-linux-gnu -I/usr/include/taglib -I/usr/local/include -I/usr/include/qt4 -I/usr/include/qt4/QtCore -I/usr/local/include/gaia2/ -DHAVE_AVCODEC=1 -DHAVE_AVFORMAT=1 -DHAVE_AVUTIL=1 -DHAVE_AVRESAMPLE=1 -DHAVE_SAMPLERATE=1 -DHAVE_TAGLIB=1 -DHAVE_YAML=1 -DHAVE_FFTW=1 -DHAVE_GAIA2=1 -D__STDC_CONSTANT_MACROS -DPYTHONDIR=\"/usr/local/lib/python2.7/dist-packages\" -DPYTHONARCHDIR=\"/usr/local/lib/python2.7/dist-packages\" -DHAVE_PYEMBED=1 -DHAVE_PYEXT=1 -DHAVE_PYTHON_H=1 ../src/algorithms/essentia_algorithms_reg.cpp -c -o/home/hamidi/essentia/build/src/algorithms/essentia_algorithms_reg.cpp.1.o -fPIC -v\n</code></pre>\n\n<p><code>g++</code>'s <code>-v</code> option gave me the actual paths visited by the linker (nothing bad in there, I think, but for the sake of completeness):</p>\n\n<pre><code>#include \"...\" search starts here:\n#include &lt;...&gt; search starts here:\n src\n ../src\n src/essentia\n ../src/essentia\n src/essentia/scheduler\n ../src/essentia/scheduler\n src/essentia/streaming\n ../src/essentia/streaming\n src/essentia/streaming/algorithms\n ../src/essentia/streaming/algorithms\n src/essentia/utils\n ../src/essentia/utils\n src/3rdparty\n ../src/3rdparty\n src/3rdparty/spline\n ../src/3rdparty/spline\n src/3rdparty/vamp-plugin-sdk-2.4\n ../src/3rdparty/vamp-plugin-sdk-2.4\n /usr/include/taglib\n /usr/include/qt4\n /usr/include/qt4/QtCore\n /usr/local/include/gaia2/\n /usr/include/c++/6\n /usr/include/x86_64-linux-gnu/c++/6\n /usr/include/c++/6/backward\n /usr/lib/gcc/x86_64-linux-gnu/6/include\n /usr/local/include\n /usr/lib/gcc/x86_64-linux-gnu/6/include-fixed\n /usr/include/x86_64-linux-gnu\n /usr/include\nEnd of search list.\n</code></pre>\n\n<p>Here are the files (github repo) involved in the error:</p>\n\n<ul>\n<li><p>MTG/gaia/blob/master/src/gaia.h</p></li>\n<li><p>MTG/gaia/blob/master/src/transformation.h#L106</p></li>\n<li><p>/MTG/essentia/blob/master/src/algorithms/highlevel/gaiatransform.h</p></li>\n</ul>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1503505125, "post_id": 45844804, "comment_id": 78647625, "body": "<b><i>Is there a shortage of memory on my Mac?</i></b> Unlikely."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 6, "creation_date": 1503505166, "post_id": 45844804, "comment_id": 78647649, "body": "Use a debugger to check with line the segmentation fault happens."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 1, "creation_date": 1503505172, "post_id": 45844804, "comment_id": 78647655, "body": "You should look at using a debugger, it will show you the line of code that triggered it and let you inspect your programs state (e.g. see if a pointer or index has an unexpected value)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503505215, "post_id": 45844804, "comment_id": 78647683, "body": "In <code>vecto(T *a)</code> how many elements does <code>v</code> point to?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1503505451, "post_id": 45844804, "comment_id": 78647827, "body": "You also will need to look at the rule of 3/5/0. You are not freeing your dynamically allocated memory but when you do you will run into trouble if you fail to implement the other required functions."}, {"owner": {"reputation": 454, "user_id": 682537, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0d9841d5c680d13c0dcd8d90098f2e63?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/682537/jonathan"}, "edited": false, "score": 1, "creation_date": 1503505465, "post_id": 45844804, "comment_id": 78647839, "body": "The second ctor does not initialize v before assigning values to it. you basically are accessing an uninitialized pointer. Note that where you commented ctor 2 is called there are 2 actions being made, a temporary vector will be built using a1 and then the copy ctor will be called to copy the temporary vector into v1."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503514029, "post_id": 45844804, "comment_id": 78652672, "body": "Yes, there&#39;s another reason. <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">Go here to fix the problem</a>."}], "answers": [{"tags": [], "owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "is_accepted": true, "score": 1, "last_activity_date": 1503516665, "creation_date": 1503516665, "answer_id": 45847956, "question_id": 45844804, "link": "https://stackoverflow.com/questions/45844804/segmentation-fault11-in-c/45847956#45847956", "title": "Segmentation Fault:11 in c++", "body": "<p>The call </p>\n\n<pre><code>v1=a1;  //constructor 2 called\n</code></pre>\n\n<p>Tries to make a copy, but you haven't initialized the vecto yet and you can't as constructor 2 doesn't know the size of 'T *a', anyway when it has finished it would try to call the copy constructor which would also fail.</p>\n\n<p>Instead use an assignment operator.</p>\n\n<pre><code>vecto &amp; operator= ( const T * a ) {\n    for(int i=0; i&lt;size; i++)\n        v[i]=a[i];\n    std::cout&lt;&lt;\"inside copy assign\"&lt;&lt;std::endl;\n    return *this;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7328409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0963ee476e88354ab6f6c4401d49a4?s=128&d=identicon&r=PG&f=1", "display_name": "MAVERICK", "link": "https://stackoverflow.com/users/7328409/maverick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 45847956, "answer_count": 1, "score": -2, "last_activity_date": 1503516665, "creation_date": 1503505067, "last_edit_date": 1503512174, "question_id": 45844804, "link": "https://stackoverflow.com/questions/45844804/segmentation-fault11-in-c", "title": "Segmentation Fault:11 in c++", "body": "<p>Why am I getting segmentation fault:11 in this piece of code? Is there a shortage of memory on my Mac? Or is there some other reason? I have MacBook Air RAM 8GB.</p>\n\n<pre><code>template&lt;class T&gt;\nclass vecto\n{\n     T *v;\n     int size;\npublic:\n     vecto(int m)\n     {\n          size=m;\n          v=new T[m];\n          for(int i=0; i&lt;size; i++)\n               v[i]=0;\n          cout&lt;&lt;\"inside constructor 1.\"&lt;&lt;endl;\n     }\n     vecto(T *a)\n     {\n          for(int i=0; i&lt;size; i++)\n               v[i]=a[i];\n          cout&lt;&lt;\"inside constructor 2.\"&lt;&lt;endl;\n     }\n};\n\nint main()\n{\n     int a1[3] = {1,2,3};\n     float a2[3] = {4,5,6};\n     vecto&lt;int&gt; v1(3);  //constructor 1 called\n     vecto&lt;float&gt; v2(3); //constructor 1 called\n     v1=a1;  //constructor 2 called\n     v2=a2; //constructor 2 called\n     return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "stringstream"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1503504951, "post_id": 45844760, "comment_id": 78647512, "body": "search the string for a <code>.</code>, if there is none, append it to the end"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8507274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RbsCjgEhA70/AAAAAAAAAAI/AAAAAAAAACY/BYUHPYQa7ng/photo.jpg?sz=128", "display_name": "cschaller", "link": "https://stackoverflow.com/users/8507274/cschaller"}, "edited": false, "score": 0, "creation_date": 1503563676, "post_id": 45844907, "comment_id": 78671295, "body": "Ok I see, thank you for your reply. Finally I came up with something like that, and used <a href=\"http://www.cplusplus.com/reference/cmath/modf/\" rel=\"nofollow noreferrer\">modf</a> hoping it&#39;s time effective"}], "tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": true, "score": 1, "last_activity_date": 1503505422, "creation_date": 1503505422, "answer_id": 45844907, "question_id": 45844760, "link": "https://stackoverflow.com/questions/45844760/writing-a-floating-value-in-a-stringstream-and-keep-even-if-there-is-no-deci/45844907#45844907", "title": "Writing a floating value in a stringstream and keep &quot;.&quot; even if there is no decimal", "body": "<p>To get a trailing '.' in all cases, without also getting a trailing zero, you will need to do it yourself. However appending a '.' to a <code>std::string</code> since you have one anyway is fairly simple (its harder if you want to just work with streams only).</p>\n\n<p>Also be aware of any locale specific issues (e.g. with the different uses of '.' and ',') if you ever need to support those.</p>\n\n<pre><code>std::stringstream ss;\nss &lt;&lt; std::setprecision(precision) &lt;&lt; element;\nstd::string str = stream.str();\nif (str.find('.') == std::string::npos)\n    str.push_back('.');\nreturn str;\n</code></pre>\n\n<p>Alternatively, you could strip trailing zeros.</p>\n"}], "owner": {"reputation": 3, "user_id": 8507274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RbsCjgEhA70/AAAAAAAAAAI/AAAAAAAAACY/BYUHPYQa7ng/photo.jpg?sz=128", "display_name": "cschaller", "link": "https://stackoverflow.com/users/8507274/cschaller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 45844907, "answer_count": 1, "score": 0, "last_activity_date": 1503505422, "creation_date": 1503504880, "last_edit_date": 1503505401, "question_id": 45844760, "link": "https://stackoverflow.com/questions/45844760/writing-a-floating-value-in-a-stringstream-and-keep-even-if-there-is-no-deci", "title": "Writing a floating value in a stringstream and keep &quot;.&quot; even if there is no decimal", "body": "<p>I want to convert a <code>double element</code> in a string at a given <code>precision</code>. I want to avoid getting unnecessary <code>0</code> in my string (so I can't use <a href=\"http://www.cplusplus.com/reference/ios/fixed/\" rel=\"nofollow noreferrer\">std::fixed</a>). Also, I want to always keep the \".\" in my string.</p>\n\n<p>So I wrote the following function:</p>\n\n<pre><code>std::string toString(double element, int precision)\n{\n   std::stringstream stream;\n\n   stream &lt;&lt; std::setprecision(precision) &lt;&lt; element;\n   return stream.str();\n}\n\ntoString(1.25, 2)  --&gt; \"1.25\" OK\ntoString(1.25, 17) --&gt; \"1.25\" OK\n</code></pre>\n\n<p>But now, imagine I do <code>toString(1., 2)</code>, then it returns to me <code>\"1\"</code>, but I want to keep the \"<code>.</code>\", so I want <code>\"1.\"</code></p>\n\n<p>Do you have an effective way to do this?</p>\n\n<p>PS: I'm not in C++11.</p>\n\n<p>Thank you for reading my question.</p>\n"}, {"tags": ["c++", "c++11", "boost"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1503504390, "post_id": 45844516, "comment_id": 78647165, "body": "Easy solution: after you parse run through the vector and remove the empty elements.  <code>v.erase(std::remove(v.begin(), v.end(), &quot;&quot;), v.end());</code>.  This even lets you handle <code>1&#47;2&#47;3&#47;&#47;&#47;&#47;4</code>"}, {"owner": {"reputation": 6080, "user_id": 270661, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1f113fa4c0a2e259f6f65accd611e3f6?s=128&d=identicon&r=PG", "display_name": "cateof", "link": "https://stackoverflow.com/users/270661/cateof"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503504820, "post_id": 45844516, "comment_id": 78647416, "body": "@NathanOliver I see your point but I may need the empty intervals in some cases. Only the first causes problems to me. Can I use a &quot;character set&quot; with boost::is_any_of?"}, {"owner": {"reputation": 6080, "user_id": 270661, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1f113fa4c0a2e259f6f65accd611e3f6?s=128&d=identicon&r=PG", "display_name": "cateof", "link": "https://stackoverflow.com/users/270661/cateof"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503504880, "post_id": 45844516, "comment_id": 78647460, "body": "Seriously, I don&#39;t understand the downvotes. I want to split a string that starts with the delimiter character."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503504926, "post_id": 45844516, "comment_id": 78647496, "body": "Not sure.  I guess because the simple thing to do would be to start after the first character."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 3, "creation_date": 1503504938, "post_id": 45844516, "comment_id": 78647504, "body": "Not a downvoter but it doesn&#39;t seem like you put much thought into solving the problem yourself."}, {"owner": {"reputation": 6080, "user_id": 270661, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1f113fa4c0a2e259f6f65accd611e3f6?s=128&d=identicon&r=PG", "display_name": "cateof", "link": "https://stackoverflow.com/users/270661/cateof"}, "edited": false, "score": 0, "creation_date": 1503505183, "post_id": 45844516, "comment_id": 78647662, "body": "My code is a small snippet. In real cases, I don&#39;t have argv[1] but an std::string. I don&#39;t want to use substr() since it creates a new string. I could start with the index=1 for the string, but how can I do this without creating an new std::string?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503505463, "post_id": 45844516, "comment_id": 78647838, "body": "@cateof In that case I think you would be much better off writing your own function and discard the first element if it is blank.  You can see how to write your own here: <a href=\"https://stackoverflow.com/questions/236129/most-elegant-way-to-split-a-string\" title=\"most elegant way to split a string\">stackoverflow.com/questions/236129/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1006, "user_id": 2946671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e7c2518ce2cf7ed64ce3e73464b728b?s=128&d=identicon&r=PG&f=1", "display_name": "N00byEdge", "link": "https://stackoverflow.com/users/2946671/n00byedge"}, "is_accepted": true, "score": 3, "last_activity_date": 1503504380, "creation_date": 1503504380, "answer_id": 45844617, "question_id": 45844516, "link": "https://stackoverflow.com/questions/45844516/c-text-to-stdvector-with-a-delimeter-when-text-begins-with-delimeter/45844617#45844617", "title": "C++ text to std::vector with a delimeter, when text begins with delimeter", "body": "<p>To just throw away the first character:</p>\n\n<pre><code>boost::split(v, argv[1] + 1, [](char c){return c == '/';});\n</code></pre>\n\n<p>But remember to make sure that the <code>strlen</code> of <code>argv[1]</code> is <code>&gt;0</code> at this point</p>\n"}], "owner": {"reputation": 6080, "user_id": 270661, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1f113fa4c0a2e259f6f65accd611e3f6?s=128&d=identicon&r=PG", "display_name": "cateof", "link": "https://stackoverflow.com/users/270661/cateof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 45844617, "answer_count": 1, "score": -3, "last_activity_date": 1503504380, "creation_date": 1503504043, "question_id": 45844516, "link": "https://stackoverflow.com/questions/45844516/c-text-to-stdvector-with-a-delimeter-when-text-begins-with-delimeter", "title": "C++ text to std::vector with a delimeter, when text begins with delimeter", "body": "<p>I want to split the string \"/1/2/3/4\" to four parts, ie 1,2,3,4. I am using boost to split the string</p>\n\n<pre><code>#include &lt;boost/algorithm/string.hpp&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nint main(int argc, char** argv) {\n\n        std::vector&lt;std::string&gt; v;\n        //boost::split(v, argv[1], boost::is_any_of(\"/\"));\n        boost::split(v, argv[1], [](char c){return c == '/';});\n        for( auto i : v )\n                std::cout &lt;&lt; i &lt;&lt; ' ';\n        std::cout &lt;&lt; std::endl;\n\n        std::cout &lt;&lt; v.size() &lt;&lt; std::endl;\n\n        return 0;\n\n}\n</code></pre>\n\n<p>when I run I am taking an extra empty word in my vector</p>\n\n<pre><code>[oracle@localhost split]$ ./a.out /1/2/3/4\n 1 2 3 4 \n5\n</code></pre>\n\n<p>due to the fact that my word (/1/2/3/4) starts with the delimiter. How do I resolve this issue? I want the vector to hold 1,2,3,4 only.</p>\n"}, {"tags": ["c++", "mergesort"], "comments": [{"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1503506039, "post_id": 45844408, "comment_id": 78648185, "body": "The help vector needs to be (v.size+1)/2 (round up if an odd number of elements). The two halves of the original vector are sorted, next the first half is moved to the help vector, then the help vector and second half of the original vector are merged back into the original vector starting at the beginning of the original vector."}], "answers": [{"tags": [], "owner": {"reputation": 7381, "user_id": 4095830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLf56.png?s=128&g=1", "display_name": "whoan", "link": "https://stackoverflow.com/users/4095830/whoan"}, "is_accepted": true, "score": 0, "last_activity_date": 1558726903, "last_edit_date": 1558726903, "creation_date": 1503506029, "answer_id": 45845084, "question_id": 45844408, "link": "https://stackoverflow.com/questions/45844408/mergesort-with-a-half-sized-help-vector/45845084#45845084", "title": "Mergesort with a half-sized help vector", "body": "<p>Once I used a similar approach to solve a HackerRank problem (see below for the adaptation to your approach):</p>\n\n<pre><code>void merge(std::vector&lt;int&gt;&amp; original, long long left, long long middle, const long long end) {\n    const std::vector&lt;int&gt; leftSide({original.begin()+left, original.begin()+middle});\n    const std::vector&lt;int&gt;&amp; rightSide=original; // just to make the code clearer\n    auto posForward=left;\n    auto right=middle;\n    // reset left offsets because we are using a new collection\n    middle -= left, left = 0;\n    for ( ; left &lt; middle &amp;&amp; right &lt; end; ++posForward) {\n        if (leftSide[left] &lt;= rightSide[right]) {\n            original[posForward] = leftSide[left++];\n        } else {\n            original[posForward] = rightSide[right++];\n            // inversions += (middle-left); // info: removed for this SO answer\n        }\n    }\n    while (left &lt; middle) {\n        original[posForward++] = leftSide[left++];\n    }\n    while (right &lt; end) {\n        original[posForward++] = rightSide[right++];\n    }\n}\n</code></pre>\n\n<p>You can see a full program <a href=\"https://github.com/whoan/challenges/blob/master/hacker-rank/cracking-the-code-interview/counting-inversions.cpp\" rel=\"nofollow noreferrer\">here</a></p>\n\n<hr>\n\n<h3>Code adapted to your needs:</h3>\n\n<pre><code>void TDMergeSort&lt;T&gt;::merge(vector&lt;T&gt;&amp; v, int links, int midden, int rechts, vector&lt;T&gt;&amp; hulp) const {\n    hulp = {v.begin()+links, v.begin()+midden};\n    int j = links;\n    int ri = midden;\n    midden -= links;\n    int li = 0;\n\n    while (li &lt; midden &amp;&amp; ri &lt; rechts) {        \n        if (hulp[li] &lt;= v[ri]) {\n            v[j++] = hulp[li++];\n        } else {\n            v[j++] = v[ri++];\n        }\n    }\n\n    while (li &lt; midden) {\n        v[j++]=hulp[li++];\n    }\n    while (ri &lt; rechts) {\n        v[j++]=v[ri++];\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7671281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d935f1734c8450c5d472ba181f4014?s=128&d=identicon&r=PG&f=1", "display_name": "Str-Gen", "link": "https://stackoverflow.com/users/7671281/str-gen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 45845084, "answer_count": 1, "score": 1, "last_activity_date": 1558726903, "creation_date": 1503503751, "question_id": 45844408, "link": "https://stackoverflow.com/questions/45844408/mergesort-with-a-half-sized-help-vector", "title": "Mergesort with a half-sized help vector", "body": "<p>I've been trying to optimize a mergesort implementation by using a help vector that is only half the size of the vector that needs to be sorted. It should be possible, but I don't see it.\nThe normal merge uses a full sized help vector, has 2 iterators on the original vector, one starting at the left site and one just at (or past if the vector has an even size) the middle. </p>\n\n<p>Full sized help vector merge  </p>\n\n<pre><code>void TDMergeSort&lt;T&gt;::merge(vector&lt;T&gt;&amp; v, int links, int midden, int rechts, vector&lt;T&gt;&amp; hulp) const{\n        int j = links;\n        int li = links;\n        int ri = midden;\n        while (li &lt; midden &amp;&amp; ri &lt; rechts) {\n            if (v[li] &lt; v[ri]) {\n                hulp[j++] = v[li++];\n            } else {\n                hulp[j++] = v[ri++];\n            }\n        }\n\n        while (li &lt; midden) {\n            hulp[j++]=v[li++];\n        }\n        while (ri &lt; rechts) {\n            hulp[j++]=v[ri++];\n        }\n    for(int i=links;i&lt;rechts;i++){\n        v[i]=move(hulp[i]);\n    }\n}\n</code></pre>\n\n<p>How can you convert this to a version where hulp is not v.size(), but v.size()/2?</p>\n"}, {"tags": ["c++", "visual-studio"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1503503729, "post_id": 45844375, "comment_id": 78646684, "body": "what is <code>tb3-&gt;Text</code> ? Please read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1503503731, "post_id": 45844375, "comment_id": 78646686, "body": "Convert <code>tb3-&gt;Text</code> to a number before comparing."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1503503745, "post_id": 45844375, "comment_id": 78646697, "body": "...and please include the exact error message in the question"}, {"owner": {"reputation": 1, "user_id": 11654222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Siqm-EL9P00/AAAAAAAAAAI/AAAAAAAAAPc/Z9TbvGiCsXs/photo.jpg?sz=128", "display_name": "kumail Haider", "link": "https://stackoverflow.com/users/11654222/kumail-haider"}, "edited": false, "score": 0, "creation_date": 1503503869, "post_id": 45844375, "comment_id": 78646804, "body": "tb3 is name of textbox in which i will store price of mobile"}, {"owner": {"reputation": 1, "user_id": 11654222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Siqm-EL9P00/AAAAAAAAAAI/AAAAAAAAAPc/Z9TbvGiCsXs/photo.jpg?sz=128", "display_name": "kumail Haider", "link": "https://stackoverflow.com/users/11654222/kumail-haider"}, "edited": false, "score": 0, "creation_date": 1503504325, "post_id": 45844375, "comment_id": 78647115, "body": "And Error Message Says : error C2676 : Binary &#39;&gt;=&#39; : System ::String Does not define this operator"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1503504439, "post_id": 45844375, "comment_id": 78647201, "body": "isnt the error quite clear? You cannot compare a string to an int, well... unless you define what that is supposed to mean, or more easily convert the string to an int"}], "answers": [{"tags": [], "owner": {"reputation": 1006, "user_id": 2946671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e7c2518ce2cf7ed64ce3e73464b728b?s=128&d=identicon&r=PG&f=1", "display_name": "N00byEdge", "link": "https://stackoverflow.com/users/2946671/n00byedge"}, "is_accepted": false, "score": 1, "last_activity_date": 1503504621, "creation_date": 1503504621, "answer_id": 45844691, "question_id": 45844375, "link": "https://stackoverflow.com/questions/45844375/how-to-use-relational-operators-in-visual-c/45844691#45844691", "title": "How To Use Relational Operators In Visual C++", "body": "<p>The following code will get the c string pointer and parse it to an int:</p>\n\n<pre><code>if(atoi(tb3-&gt;Text.c_str()) &gt;=1000)\n    MessageBox::Show(\"Sorry We Dont Buy It\");\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11654222, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Siqm-EL9P00/AAAAAAAAAAI/AAAAAAAAAPc/Z9TbvGiCsXs/photo.jpg?sz=128", "display_name": "kumail Haider", "link": "https://stackoverflow.com/users/11654222/kumail-haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1503505560, "creation_date": 1503503643, "last_edit_date": 1503505560, "question_id": 45844375, "link": "https://stackoverflow.com/questions/45844375/how-to-use-relational-operators-in-visual-c", "title": "How To Use Relational Operators In Visual C++", "body": "<p>I am using visual Studio 2012 and I am making a sample of a mobile shop. I have a feature of Buying a Mobile from my customer. What I want to do is if the user is selling a mobile above $1000 then I will display a message that we don't want it.</p>\n\n<pre><code>    if(tb3-&gt;Text &gt;=1000)\n    MessageBox::Show(\"Sorry We Dont Buy It\");\n</code></pre>\n\n<p><code>tb3</code> is the name of the text box I will store the price of mobile.</p>\n\n<p>Now compiler shows an error:</p>\n\n<blockquote>\n  <p>error C2676 : Binary '>=' : System ::String Does not define this operator</p>\n</blockquote>\n\n<p>Can any one tell me the correct syntax?</p>\n"}, {"tags": ["c++", "class", "private"], "comments": [{"owner": {"reputation": 1065, "user_id": 1458237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83a2bbacabb878f413699313f48a0e3?s=128&d=identicon&r=PG", "display_name": "djgandy", "link": "https://stackoverflow.com/users/1458237/djgandy"}, "edited": false, "score": 0, "creation_date": 1503503772, "post_id": 45844372, "comment_id": 78646726, "body": "You need to allocate (and free) the memory dynamically. See keyword new, then once you understand use a unique_ptr so you don&#39;t forget to free it."}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 2, "creation_date": 1503503966, "post_id": 45844372, "comment_id": 78646863, "body": "Use a <code>std::vector</code>?"}, {"owner": {"reputation": 1065, "user_id": 1458237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83a2bbacabb878f413699313f48a0e3?s=128&d=identicon&r=PG", "display_name": "djgandy", "link": "https://stackoverflow.com/users/1458237/djgandy"}, "edited": false, "score": 0, "creation_date": 1503505247, "post_id": 45844372, "comment_id": 78647707, "body": "Best SO post I found - <a href=\"https://stackoverflow.com/questions/936687/how-do-i-declare-a-2d-array-in-c-using-new\" title=\"how do i declare a 2d array in c using new\">stackoverflow.com/questions/936687/&hellip;</a> . Grid solution is perfect for preserving C-like behaviour and preserving linear memory space."}], "answers": [{"comments": [{"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1503506109, "post_id": 45844668, "comment_id": 78648221, "body": "Why not add <code>s</code> and <code>Cluster</code> to your init list? <code>... , NMmuestras(nsamples), s(L*L), Cluster(L*L*2) {}</code>"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1503510981, "post_id": 45844668, "comment_id": 78650939, "body": "@Rob I suppose you could, I&#39;m just in the habit because calling <code>reserve</code> or other things that can&#39;t be done in the constructor is so common."}], "tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": true, "score": 2, "last_activity_date": 1503504547, "creation_date": 1503504547, "answer_id": 45844668, "question_id": 45844372, "link": "https://stackoverflow.com/questions/45844372/private-variable-depending-on-unspecified-private-variable-c/45844668#45844668", "title": "Private variable depending on unspecified private variable (C++)", "body": "<p>You should handle all this in a constructor; init functions have all kinds of associated problems. And you should ensure that variables are listed in dependency order (i.e. if one variable depends on another, the latter must be declared first). Also, fixed constants can simply be made static as they are always the same. You don't need to keep variables that are trivially derived from others like L2. Initialize things inline when you can.</p>\n\n<pre><code>class SpinSystem{\nprivate:\n  static constexpr int k=1;\n  static constexpr int J=1;\n  static constexpr double TC=2/log(1+sqrt(2.0));//TC=2.269;\n\n  int teq = (int)(10*pow(length/8.0,0.58));\n  int tcorr = (int)(1*pow(length/8.0,0.58));\n\n  int L;\n  double Temp;\n  int Nmuestras;\n\n  std::vector&lt;int&gt; s;\n  int E;\n  int M;\n  std::vector&lt;int&gt; Cluster;\n  int write;\npublic:\n  void SpinSystem(int length, double temp, int nsamples)\n    : L(length)\n    , Temp(temp)\n    , NMmuestras(nsamples)\n  {\n    s.resize(L*L);\n    Cluster.resize(L*L*2);\n  }\n};\n</code></pre>\n\n<p>Here I create one dimensional arrays of the same total size. I strongly recommend you just do that and use a simple function to convert the index as you need to. But if you don't like that you can always have nested vectors.</p>\n\n<p>Make sure in your real code to initialize E, M, and Write... preferably inline or in the initializer list.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503505189, "post_id": 45844756, "comment_id": 78647668, "body": "You break rule of 0/3/5."}, {"owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503505316, "post_id": 45844756, "comment_id": 78647755, "body": "You are correct - I was providing a partial code only for allocating 2D array. Updated to a non class version."}], "tags": [], "owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "is_accepted": false, "score": -1, "last_activity_date": 1503505524, "last_edit_date": 1503505524, "creation_date": 1503504866, "answer_id": 45844756, "question_id": 45844372, "link": "https://stackoverflow.com/questions/45844372/private-variable-depending-on-unspecified-private-variable-c/45844756#45844756", "title": "Private variable depending on unspecified private variable (C++)", "body": "<p>From your code, you need to allocate a dynamic 2D array.\nThis is actually an array of pointers to arrays.</p>\n\n<pre><code>int _tmain(int argc, _TCHAR* argv[])\n{\n    int L = 10; // get from command line\n\n    int ** s = new int*[L];\n    for (int i = 0; i &lt; L; i++)\n        s[i] = new int[L];\n\n    // DO SOMETHING\n\n    // free memory\n    for (int i = 0; i &lt; L; i++)\n        delete[] s[i];\n\n    delete[] s;\n\n    return 0;\n};\n</code></pre>\n"}], "owner": {"reputation": 1383, "user_id": 4107770, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84cd102ae268671aa55a8869094210fd?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Vargas", "link": "https://stackoverflow.com/users/4107770/vladimir-vargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 45844668, "answer_count": 2, "score": 0, "last_activity_date": 1503505524, "creation_date": 1503503637, "question_id": 45844372, "link": "https://stackoverflow.com/questions/45844372/private-variable-depending-on-unspecified-private-variable-c", "title": "Private variable depending on unspecified private variable (C++)", "body": "<p>Suppose that I have a class like this one:</p>\n\n<pre><code>class SpinSystem{\nprivate:\n  int L;\n  int L2;\n  const int k=1, J=1;\n  const int teq, tcorr;\n  const double TC=2/log(1+sqrt(2.0));//TC=2.269;\n  double Temp;\n  int Nmuestras;\n  int s[L][L]; int E,M; \n  int Cluster[L2][2]; int write;\npublic:\n  void set_values(int, double, int);\n};\n\nvoid SpinSystem::set_values(int length, double temperature, int nsamples){\n  L = length;\n  Temp = temperature;\n  Nmuestras = nsamples;\n  L2 = length*length;\n  teq = (int)(10*pow(length/8.0,0.58));\n  tcorr = (int)(1*pow(length/8.0,0.58));\n}\n</code></pre>\n\n<p>The private variables L2, teq, tcorr depend on the value of L. This is why I set their values with the method set_values. However, I have to define some arrays, such as s[L][L] and Cluster[L2][2], whose sizes clearly depend on L. How can I achieve this? Thanks in advance.</p>\n"}, {"tags": ["c++", "dll", "openal", "lib"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1503503495, "post_id": 45844171, "comment_id": 78646526, "body": "Look like you need one of these: <a href=\"https://openal.org/downloads/\" rel=\"nofollow noreferrer\">openal.org/downloads</a>"}, {"owner": {"reputation": 29, "user_id": 8221034, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-l5sTx4pueZQ/AAAAAAAAAAI/AAAAAAAAIwE/-vnS9P-k_6M/photo.jpg?sz=128", "display_name": "ConanCoder", "link": "https://stackoverflow.com/users/8221034/conancoder"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1503514800, "post_id": 45844171, "comment_id": 78653082, "body": "@RichardCritten it worked, thank you so much &lt;3"}], "owner": {"reputation": 29, "user_id": 8221034, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-l5sTx4pueZQ/AAAAAAAAAAI/AAAAAAAAIwE/-vnS9P-k_6M/photo.jpg?sz=128", "display_name": "ConanCoder", "link": "https://stackoverflow.com/users/8221034/conancoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 808, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503503051, "creation_date": 1503503051, "question_id": 45844171, "link": "https://stackoverflow.com/questions/45844171/openal32-dll-missing-error", "title": "OpenAL32.dll missing error", "body": "<p>I have downloaded gorilla-audio source code to use it in my software, but when I use the external library from OpenAL (in gorilla-audio, the OpenAL32.lib) the project compiles with no errors or anything, but it doesn't run normally, I still haven't implemented anything from gorilla sound, just wanted to check that after adding the library it would still work the same before editing anything, but it just doesn't, I have linked everything and used the correct version of <code>.lib</code> but when I run the project it says:</p>\n\n<blockquote>\n  <p>The program can't start because OpenAL32.dll is missing from your\n  computer. Try reinstalling the program to fix this problem.</p>\n</blockquote>\n\n<p>What should I do, I've googled that but I'm just scared to download random things, plus I don't even know where should I put it.</p>\n\n<p>Any help guys,\nThanks ^_^</p>\n"}, {"tags": ["android", "c++"], "comments": [{"owner": {"reputation": 905471, "user_id": 115145, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/wDnd8.png?s=128&g=1", "display_name": "CommonsWare", "link": "https://stackoverflow.com/users/115145/commonsware"}, "edited": false, "score": 0, "creation_date": 1503502757, "post_id": 45844012, "comment_id": 78645998, "body": "How much experience do you have with computer vision and related technologies?"}, {"owner": {"reputation": 1652, "user_id": 1437043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kFlcw.jpg?s=128&g=1", "display_name": "Hafnernuss", "link": "https://stackoverflow.com/users/1437043/hafnernuss"}, "edited": false, "score": 0, "creation_date": 1503503007, "post_id": 45844012, "comment_id": 78646176, "body": "Maybe it would be easier to encode encrypted data in a QR code. But keep in mind that a QR code can only hold a limited amount of information."}], "answers": [{"tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": false, "score": 1, "last_activity_date": 1503503638, "creation_date": 1503503638, "answer_id": 45844373, "question_id": 45844012, "link": "https://stackoverflow.com/questions/45844012/develop-qr-scanner-to-scan-only-the-qr-codes-i-generate/45844373#45844373", "title": "Develop QR Scanner to scan &quot;only&quot; the QR codes i Generate?", "body": "<p>If you want to make your own scanner and \"QR\" codes then you are looking at image anayalis technologies and a lot of work. Making somthing that can not then be simply forged is even harder. e.g. normal QR codes are just black to make them easy to print and analyze. If you just change how the data is represented, it is easy for people to figure out how to clone or modify them.</p>\n\n<p>If your just interested in making your application verify the payload Id just see about digitally signing (with a keypair) or otherwise validating the data referenced by the QR code in some way. e.g. if they are URL's I might say they must be URLs to <a href=\"https://example.com/qr-codes/foo\" rel=\"nofollow noreferrer\">https://example.com/qr-codes/foo</a>. This would prevent other people creating their own QR codes with modified data, but it would still be fairly easy for people to copy your authentic QR codes exactly.</p>\n"}, {"tags": [], "owner": {"reputation": 416, "user_id": 7834533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bacded90185e4fc3fe9d6e458125be4?s=128&d=identicon&r=PG&f=1", "display_name": "A Hettinger", "link": "https://stackoverflow.com/users/7834533/a-hettinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1503503655, "creation_date": 1503503655, "answer_id": 45844379, "question_id": 45844012, "link": "https://stackoverflow.com/questions/45844012/develop-qr-scanner-to-scan-only-the-qr-codes-i-generate/45844379#45844379", "title": "Develop QR Scanner to scan &quot;only&quot; the QR codes i Generate?", "body": "<p>A QR-Code and store up to 2,953 bytes. All you need to do is store your data, followed by a <a href=\"https://en.wikipedia.org/wiki/Digital_signature\" rel=\"nofollow noreferrer\">signature</a>. Once you have that, all you have to do is have your reader include your public key and use that to verify the signature.</p>\n\n<p>The only problem here is the limited amount of space: every bit the signature uses, is a bit less you can have for your data.</p>\n"}], "owner": {"reputation": 9, "user_id": 8507127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155051479099576/picture?type=large", "display_name": "Neftalem Fikre Hailemeskel", "link": "https://stackoverflow.com/users/8507127/neftalem-fikre-hailemeskel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1503503655, "creation_date": 1503502561, "question_id": 45844012, "link": "https://stackoverflow.com/questions/45844012/develop-qr-scanner-to-scan-only-the-qr-codes-i-generate", "title": "Develop QR Scanner to scan &quot;only&quot; the QR codes i Generate?", "body": "<p>I need help! i am a digital marketer and obsessed with QR codes. I want to create my own \" QR Scanner\" that can only scan \" QR codes i have Generated\". I know an Israeli company did the same thing for Alibaba to fight counterfeit products..Yet i can figure out how they did it? help??? Link: <a href=\"https://www.wired.com/2015/05/alibaba-reveals-retro-way-fight-counterfeits-qr-codes/\" rel=\"nofollow noreferrer\">https://www.wired.com/2015/05/alibaba-reveals-retro-way-fight-counterfeits-qr-codes/</a>   </p>\n"}, {"tags": ["c++", "rvalue-reference", "move-constructor", "lvalue-to-rvalue", "stdmove"], "answers": [{"comments": [{"owner": {"reputation": 1706, "user_id": 5302690, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/58f104c7eddb6acb9e94430e931ea36f?s=128&d=identicon&r=PG&f=1", "display_name": "barney", "link": "https://stackoverflow.com/users/5302690/barney"}, "edited": false, "score": 0, "creation_date": 1503502907, "post_id": 45844034, "comment_id": 78646112, "body": "Oh, I see. It does make sense! I agree, the copy design is always safer than implicit move!"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 1706, "user_id": 5302690, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/58f104c7eddb6acb9e94430e931ea36f?s=128&d=identicon&r=PG&f=1", "display_name": "barney", "link": "https://stackoverflow.com/users/5302690/barney"}, "edited": false, "score": 0, "creation_date": 1503503024, "post_id": 45844034, "comment_id": 78646191, "body": "@barney that moment when a simple example makes you go &quot;Oh, I see. It does make sense!&quot; Glad I could provide one."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1503503119, "post_id": 45844034, "comment_id": 78646261, "body": "Id really struggle to find some actual code that does this however, and even more so one a compiler couldnt detect and treat as an error. Was there any discussion for the proposal about the relative trade offs, or is there a situation that is far more likely to occur?"}, {"owner": {"reputation": 1706, "user_id": 5302690, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/58f104c7eddb6acb9e94430e931ea36f?s=128&d=identicon&r=PG&f=1", "display_name": "barney", "link": "https://stackoverflow.com/users/5302690/barney"}, "edited": false, "score": 0, "creation_date": 1503503355, "post_id": 45844034, "comment_id": 78646423, "body": "yeah, thanks ) I thought: its so stupid because people often forget to cast the lvalue Rref back to rvalue with std::move and if its a special rvalue-reference type, isn&#39;t it just enough by itself to be move-constructible from it?(regardless of its l-valueness). But its obvious now that this reversed design is awkward)"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1503503387, "post_id": 45844034, "comment_id": 78646442, "body": "@FireLancer I don&#39;t know about any discussion. I think the compiler should be able to detect a last use without a problem. However I see a problem with this: scenario: use5 in your function is the last, so the compiler safely issues a move instead of a copy. You then at a later time add another use of it, use6 which it&#39;s now the last use. The compiler will silently modify use5 to be a copy, without you even remotely touching anything on that part of code."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 3, "creation_date": 1503503828, "post_id": 45844034, "comment_id": 78646773, "body": "@bolov, I was thinking more make the compiler just throw an error on any potential &quot;use after move&quot; operations. And then instead have like a <code>std::explicit_copy</code> as like the opposite of <code>std::move</code> for the 0.1% of cases you &quot;didnt want to move it just yet&quot;."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 2, "creation_date": 1503503857, "post_id": 45844034, "comment_id": 78646796, "body": "Since basically, I see in actual code people forget to put the <code>std::move</code> and get a copy they didnt want far more often, than multiple uses."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1503504241, "post_id": 45844034, "comment_id": 78647058, "body": "@FireLancer I see now. Make most used scenario easier. Yeah, I think that could have worked."}, {"owner": {"reputation": 2241, "user_id": 404734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4c30170453a44d900f8e03dd40461059?s=128&d=identicon&r=PG", "display_name": "Kaiserludi", "link": "https://stackoverflow.com/users/404734/kaiserludi"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 2, "creation_date": 1503506242, "post_id": 45844034, "comment_id": 78648289, "body": "@Fire: &quot;And then instead have like a std::explicit_copy as like the opposite of std::move for the 0.1% of cases you &quot;didnt want to move it just yet&quot;.&quot;  That would break backwards compatibility to C++03."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 2241, "user_id": 404734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4c30170453a44d900f8e03dd40461059?s=128&d=identicon&r=PG", "display_name": "Kaiserludi", "link": "https://stackoverflow.com/users/404734/kaiserludi"}, "edited": false, "score": 0, "creation_date": 1503525691, "post_id": 45844034, "comment_id": 78658086, "body": "@Kaiserludi Except C++ had no <code>&amp;&amp;</code> <b>at all</b>. Or is that the &quot;better example&quot; case using say a <code>template&lt;class T&gt; void foo(T arg)</code> or such that C++03 did have?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1503525815, "post_id": 45844034, "comment_id": 78658128, "body": "@FireLancer <code>Widget&amp;&amp; arg</code> means that <code>arg</code> binds to rvalues, not that it is an rvalue"}], "tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": true, "score": 24, "last_activity_date": 1596877719, "last_edit_date": 1596877719, "creation_date": 1503502606, "answer_id": 45844034, "question_id": 45843974, "link": "https://stackoverflow.com/questions/45843974/why-doesnt-c-move-construct-rvalue-references-by-default/45844034#45844034", "title": "Why doesn&#39;t C++ move construct rvalue references by default?", "body": "<p>with your design:</p>\n<pre><code>void doWork(Widget &amp;&amp; param)\n{\n    Widget store1 = param;     // automatically move param\n    Widget store2 = param;     // boom\n\n    Widget store_last = param; // boom    \n}\n</code></pre>\n<p>with current design:</p>\n<pre><code>void doWork(Widget &amp;&amp; param)\n{\n    Widget store1 = param;                // ok, copy\n    Widget store2 = param;                // ok, copy\n\n    Widget store_last = std::move(param); // ok, param is moved at its last use\n}\n</code></pre>\n<p>So the moral here is that even if you have an rvalue reference you have a name for it which means you can use it multiple times. As such you can't automatically move it because you could need it for a later use.</p>\n<hr />\n<p>Now let's say you want to re-design the language so that the last use is automatically treated as an rvalue.</p>\n<p>This can be easily done in the above example:</p>\n<pre><code>void doWork(Widget &amp;&amp; param)\n{\n    Widget store1 = param;     // `param` treated as lvalue here, copy\n    Widget store2 = param;     // `param` treated as lvalue here, copy\n\n    Widget store_last = param; // `param` treated as rvalue here, move    \n}\n</code></pre>\n<p>Let's ignore the inconsistency of how <code>param</code> is treated (which in itself is a problem).</p>\n<p>Now think what use of <code>param</code> is the last use:</p>\n<pre><code>void doWork(Widget &amp;&amp; param)\n{  \n    Widget store2 = param;        // this can be last use or not\n\n    while (some_condition())\n    {\n         Widget store1 = param;   // this can be both last use and not\n    }\n}\n</code></pre>\n<p>The language simply cannot be designed this way.</p>\n"}], "owner": {"reputation": 1706, "user_id": 5302690, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/58f104c7eddb6acb9e94430e931ea36f?s=128&d=identicon&r=PG&f=1", "display_name": "barney", "link": "https://stackoverflow.com/users/5302690/barney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1120, "favorite_count": 1, "closed_date": 1503525636, "accepted_answer_id": 45844034, "answer_count": 1, "score": 12, "last_activity_date": 1596877719, "creation_date": 1503502424, "last_edit_date": 1503525321, "question_id": 45843974, "link": "https://stackoverflow.com/questions/45843974/why-doesnt-c-move-construct-rvalue-references-by-default", "closed_reason": "Duplicate", "title": "Why doesn&#39;t C++ move construct rvalue references by default?", "body": "<p>Say I have the following function</p>\n\n<pre><code>void doWork(Widget &amp;&amp; param)  // param is an LVALUE of RRef type\n{\n    Widget store = std::move(param); \n}\n</code></pre>\n\n<p>Why do I need to cast <code>param</code> back to an rvalue with <code>std::move()</code>?  Shouldn't it be obvious that the type of <code>param</code> is rvalue since it was declared in the function signature as an rvalue reference? Shouldn't the move constructor be automatically invoked here on this principle alone? </p>\n\n<p>Why doesn't this happen by default? </p>\n"}, {"tags": ["c++", "c++11", "exception", "android-ndk", "dynamic-cast"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1503502551, "post_id": 45843937, "comment_id": 78645863, "body": "This cannot happen in standard C++. Either your implementation has a bug (not terrible likely, but can happen), or your tests are broken in some way."}, {"owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "edited": false, "score": 0, "creation_date": 1503502608, "post_id": 45843937, "comment_id": 78645897, "body": "Since you are targeting Android, have you tried switching to <a href=\"https://developer.android.com/ndk/guides/cpp-support.html\" rel=\"nofollow noreferrer\">other runtimes</a> and see if that&#39;s the problem?"}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503505291, "post_id": 45843937, "comment_id": 78647736, "body": "@BaummitAugen: Hopefully I&#39;ll find out what&#39;s wrong and will be able to answer my own question. Possibly a third party library does a dynamic_cast on a reference and does not catch the exception...."}, {"owner": {"reputation": 1121, "user_id": 4988044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176bea70fb8474bc1a454ffeefd59702?s=128&d=identicon&r=PG&f=1", "display_name": "TheCppZoo", "link": "https://stackoverflow.com/users/4988044/thecppzoo"}, "edited": false, "score": 0, "creation_date": 1503505301, "post_id": 45843937, "comment_id": 78647739, "body": "With regards to your question, <code>dynamic_cast</code> won&#39;t throw casting to a pointer. But to help you more, you have to provide relevant details, such as how do you know the <code>std::bad_cast</code> was thrown from the lines you say, the ones with <code>dynamic_cast</code> to pointers? because I have trouble believing there is an implementation so bad it would do that"}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "reply_to_user": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "edited": false, "score": 0, "creation_date": 1503505322, "post_id": 45843937, "comment_id": 78647760, "body": "@kennytm: Not sure this would be doable from QtCreator. I let him compile and deploy, I don&#39;t use ndk build system directly"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503505360, "post_id": 45843937, "comment_id": 78647783, "body": "@jpo38 Now that should be easy to find out by just looking at the backtrace."}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "reply_to_user": {"reputation": 1121, "user_id": 4988044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176bea70fb8474bc1a454ffeefd59702?s=128&d=identicon&r=PG&f=1", "display_name": "TheCppZoo", "link": "https://stackoverflow.com/users/4988044/thecppzoo"}, "edited": false, "score": 0, "creation_date": 1503505419, "post_id": 45843937, "comment_id": 78647814, "body": "@EdMaster: Undefined behaviour is a nice idea....hopefully I will be able to isolate  the problem and find out what&#39;s wrong..."}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1503505691, "post_id": 45843937, "comment_id": 78647967, "body": "@BaummitAugen: Unfortunately, I can only run those tests in Release (they take hours to run), so I only have very limited debugging information available."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1503506266, "post_id": 45843937, "comment_id": 78648305, "body": "Possibly it is low on some resource it needs for the dynamic cast, or some of the internal data is corrupted.  What happens if you only run some of the tests (say, half of 3/4) before the one that fails?"}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1503506463, "post_id": 45843937, "comment_id": 78648435, "body": "@1201ProgramAlarm: I&#39;ll try to disable tests one by one untill it starts working and see. But it takes our as the test suite takes more than 3 hours to run..."}, {"owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "edited": false, "score": 2, "creation_date": 1503507031, "post_id": 45843937, "comment_id": 78648757, "body": "According to <a href=\"https://developer.android.com/ndk/downloads/revision_history.html\" rel=\"nofollow noreferrer\">developer.android.com/ndk/downloads/revision_history.html</a>, there is a known issue with NDK r11 that &quot;<i>The combination of Clang, x86, stlport_static, and optimization levels higher than <code>-O0</code> causes test failures with dynamic_cast.</i>&quot; Does your testing environment match the condition? This has been fixed in r12, and the latest version r15c BTW."}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "reply_to_user": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "edited": false, "score": 0, "creation_date": 1503555871, "post_id": 45843937, "comment_id": 78666449, "body": "@kennytm: I&#39;m running on armv7. But as I&#39;m using r11b, that&#39;s definitely suspicious...."}], "answers": [{"tags": [], "owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "is_accepted": false, "score": 0, "last_activity_date": 1504792329, "creation_date": 1504792329, "answer_id": 46098190, "question_id": 45843937, "link": "https://stackoverflow.com/questions/45843937/what-could-make-dynamic-cast-start-throwing-stdbad-cast-even-if-invoked-on-poin/46098190#46098190", "title": "What could make dynamic_cast start throwing std:bad_cast even if invoked on pointers?", "body": "<p>After a lot of investigations, I found out that the root cause of the problem was the fact that I applied a custom facet to <code>std::cout</code>. At some point, it makes boost code throw <code>std::bad_cast</code> while doing a <code>use_facet</code> in it's <code>boost::posix_time::ptime</code>'s <code>operator&lt;&lt;</code>.</p>\n\n<p>See this other topic where hopefully someone will explain why: <a href=\"https://stackoverflow.com/questions/46098160/why-imbue-with-boostposix-timetime-facet-on-stdcout-crashs-my-app\">Why imbue with boost::posix_time::time_facet on std::cout crashs my app?</a></p>\n"}], "owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504792329, "creation_date": 1503502324, "last_edit_date": 1503502543, "question_id": 45843937, "link": "https://stackoverflow.com/questions/45843937/what-could-make-dynamic-cast-start-throwing-stdbad-cast-even-if-invoked-on-poin", "title": "What could make dynamic_cast start throwing std:bad_cast even if invoked on pointers?", "body": "<p>I'm experiencing a very weird behaviour. Was unable to isolate the problem in a MCVE, but will when I'll progress on my investigation.</p>\n\n<p>I have a program, based on CPPUNIT library and Qt that runs ~900 unit tests. This program is deployed on Android using QtCreator. It links with ~80 libraries, each one defining some tests.</p>\n\n<p>On PC, the programs runs perfectly. When deployed on Android, when I run it, after some tests were ran (~100), I start getting <code>std::bad_cast</code> exceptions for every <code>dynamic_cast</code>done within my tests. I see it comes from places where I call <code>dynamic_cast</code> on a pointer, not on a reference. According to the <a href=\"http://en.cppreference.com/w/cpp/types/bad_cast\" rel=\"nofollow noreferrer\">doc</a>, <code>std::bad_cast</code> is only thrown when <code>dynamic_cast</code> is called on a reference...</p>\n\n<pre><code>void validate( ParentTestHelper&amp; testHelper )\n{\n    const ChildTestHelper* child = dynamic_cast&lt;const ChildTestHelper*&gt;( &amp;testHelper );\n    ...\n}\n</code></pre>\n\n<p>However, my code throws <code>std::bad_cast</code>.</p>\n\n<p>If I run only the test doing the <code>dynamic_cast</code>, it works. It will only fail if it is run after other ones...and running them manually one by one does not let me reproduce the problem. There must be something weird somewhere leading to this issue and I'm still investigating.</p>\n\n<p>If anyone has an idea why <code>dynamic_cast</code> called on a pointer could throw <code>std::bad_cast</code>, this may help...</p>\n"}, {"tags": ["c++", "windows", "visual-studio", "windows-xp"], "comments": [{"owner": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1503502305, "post_id": 45843804, "comment_id": 78645681, "body": "My advice:  Run away from Windows XP as fast as you can."}, {"owner": {"reputation": 516, "user_id": 2118290, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/bFB3H.gif?s=128&g=1", "display_name": "Steven Venham", "link": "https://stackoverflow.com/users/2118290/steven-venham"}, "reply_to_user": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1503502415, "post_id": 45843804, "comment_id": 78645763, "body": "@edtheprogrammerguy Would love too. But the device I&#39;m writing this program for ONLY works on embedded standard. Period."}, {"owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "edited": false, "score": 0, "creation_date": 1503502614, "post_id": 45843804, "comment_id": 78645904, "body": "this is windows embeded, not desktop XP- I am not sure but you need to use some earlier Visual Studio versions (or earlier toolchains), for example for Windows CE i&#39;am able to use only Visual Studio 2005 (maybe 2008 would work too). See here for more details: <a href=\"https://msdn.microsoft.com/en-US/library/ms950428.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-US/library/ms950428.aspx</a>"}, {"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1503502765, "post_id": 45843804, "comment_id": 78646005, "body": "are you targetting x64 or x86?"}], "answers": [{"comments": [{"owner": {"reputation": 516, "user_id": 2118290, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/bFB3H.gif?s=128&g=1", "display_name": "Steven Venham", "link": "https://stackoverflow.com/users/2118290/steven-venham"}, "edited": false, "score": 0, "creation_date": 1503503127, "post_id": 45844162, "comment_id": 78646266, "body": "As a note: vs2015 had this set to: SUBSYSTEM:NATIVE"}], "tags": [], "owner": {"reputation": 516, "user_id": 2118290, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/bFB3H.gif?s=128&g=1", "display_name": "Steven Venham", "link": "https://stackoverflow.com/users/2118290/steven-venham"}, "is_accepted": true, "score": 1, "last_activity_date": 1503503024, "creation_date": 1503503024, "answer_id": 45844162, "question_id": 45843804, "link": "https://stackoverflow.com/questions/45843804/windows-embedded-standard-not-a-valid-win32-c/45844162#45844162", "title": "Windows embedded standard not a valid win32 c++", "body": "<p>After installing visual studios 2012 creating a new project and copying my code, I compared the properties between the two versions. They were nearly the same except for a few properties, one property being;</p>\n\n<p>Linker->System->Subsystem Was set to: \"Console (/SUBSYSTEM:CONSOLE)\" In VS2012</p>\n\n<p>After making the change in vs2015, the application began working.</p>\n"}], "owner": {"reputation": 516, "user_id": 2118290, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/bFB3H.gif?s=128&g=1", "display_name": "Steven Venham", "link": "https://stackoverflow.com/users/2118290/steven-venham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 45844162, "answer_count": 1, "score": 2, "last_activity_date": 1503503024, "creation_date": 1503502000, "last_edit_date": 1503502456, "question_id": 45843804, "link": "https://stackoverflow.com/questions/45843804/windows-embedded-standard-not-a-valid-win32-c", "title": "Windows embedded standard not a valid win32 c++", "body": "<p>I'm trying to compile an exe for my old windows machine, but i'm having a problem with the latest version of Visual studios.</p>\n\n<p>Iv set it to win32 application.</p>\n\n<p>Iv set the platform toolset to: Visual Studio 2015 - Windows XP (v140_xp)</p>\n\n<p>I have the windows XP support for c++ installed.</p>\n\n<p>My runtime library is: Multi-threaded Debug (/MTd)</p>\n\n<p>My additional library directory is set to: \"C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\lib;\"</p>\n\n<p>Installed the MSVC 2015 C++ redis. on target machine.</p>\n\n<p>Still says its an invalid win32 application.</p>\n\n<p>Target platform: \"Window embedded standard, Service pack 3\"</p>\n\n<p>After seeing: <a href=\"https://stackoverflow.com/questions/36314217/is-not-a-valid-win32-application-on-windows-xp\">This post</a> I'm going to try and custom install visual studios 2012 for just its c++ for XP so I can tell it to build with that compiler.</p>\n\n<p>Is this just because of the new changes to the Windows SDK being difficult with windows xp, or is this something to do with it being embedded standard?</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6714278, "user_type": "registered", "profile_image": "https://graph.facebook.com/950310495079625/picture?type=large", "display_name": "Abhi", "link": "https://stackoverflow.com/users/6714278/abhi"}, "edited": false, "score": 0, "creation_date": 1503508369, "post_id": 45843862, "comment_id": 78649480, "body": "I have to find it without using any functions.Its for my theory exam."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": false, "score": 1, "last_activity_date": 1503502432, "last_edit_date": 1503502432, "creation_date": 1503502143, "answer_id": 45843862, "question_id": 45843802, "link": "https://stackoverflow.com/questions/45843802/inheritance-finding-size-of-an-object-of-a-class/45843862#45843862", "title": "Inheritance-Finding size of an object of a class", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/language/sizeof\" rel=\"nofollow noreferrer\"><code>sizeof</code></a> tells you the size of an object, regardless of inheritance. Summing the size of members will not give you a reliable size for your object, it doesn't account for padding between those members or other size overhead. Private members, even inherited ones, contribute to the size of the object in the same way public members do.</p>\n\n<p>The usage is <code>sizeof(obj)</code> or <code>sizeof(type)</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6714278, "user_type": "registered", "profile_image": "https://graph.facebook.com/950310495079625/picture?type=large", "display_name": "Abhi", "link": "https://stackoverflow.com/users/6714278/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503502432, "creation_date": 1503501996, "question_id": 45843802, "link": "https://stackoverflow.com/questions/45843802/inheritance-finding-size-of-an-object-of-a-class", "title": "Inheritance-Finding size of an object of a class", "body": "<p>I have to find the size of an object of a derived class.But the thing is do I have to count the size of private members since object has only access to public members?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "environment-variables"], "comments": [{"owner": {"reputation": 8374, "user_id": 3691891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dcCUM.jpg?s=128&g=1", "display_name": "Arkadiusz Drabczyk", "link": "https://stackoverflow.com/users/3691891/arkadiusz-drabczyk"}, "edited": false, "score": 0, "creation_date": 1503502049, "post_id": 45843769, "comment_id": 78645488, "body": "Maybe play around with <code>LD_PRELOAD</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1503502082, "post_id": 45843769, "comment_id": 78645514, "body": "None, short of recompiling it or very dirty and platform-specific linker tricks..."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 3, "creation_date": 1503502133, "post_id": 45843769, "comment_id": 78645559, "body": "As your program will run in a subshell anyway, there is no &quot;polluting the environment&quot; -- no-one else will see what you <code>setenv()</code>. And if the underlying library is not prepared to reconnect to a different URL, no changing of the environment or other tricks (short of modifying the lib itself) will make it do so..."}, {"owner": {"reputation": 1618, "user_id": 593177, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EAUeh.jpg?s=128&g=1", "display_name": "Fausto Carvalho Marques Silva", "link": "https://stackoverflow.com/users/593177/fausto-carvalho-marques-silva"}, "edited": false, "score": 1, "creation_date": 1503502339, "post_id": 45843769, "comment_id": 78645706, "body": "Maybe you could do a wrap for getenv. Look here for some help: <a href=\"https://stackoverflow.com/questions/13961774/gnu-gcc-ld-wrapping-a-call-to-symbol-with-caller-and-callee-defined-in-the-sam\" title=\"gnu gcc ld wrapping a call to symbol with caller and callee defined in the sam\">stackoverflow.com/questions/13961774/&hellip;</a>"}, {"owner": {"reputation": 1618, "user_id": 593177, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EAUeh.jpg?s=128&g=1", "display_name": "Fausto Carvalho Marques Silva", "link": "https://stackoverflow.com/users/593177/fausto-carvalho-marques-silva"}, "edited": false, "score": 0, "creation_date": 1503502422, "post_id": 45843769, "comment_id": 78645771, "body": "And here <a href=\"https://stackoverflow.com/questions/2924440/advice-on-mocking-system-calls/2925879#2925879\" title=\"advice on mocking system calls\">stackoverflow.com/questions/2924440/&hellip;</a>"}, {"owner": {"reputation": 2458, "user_id": 6445069, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tmqHA.jpg?s=128&g=1", "display_name": "Phydeaux", "link": "https://stackoverflow.com/users/6445069/phydeaux"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1503502989, "post_id": 45843769, "comment_id": 78646161, "body": "@DevSolar good point about the subshell. But as I understand it, the library will reconnect, since it calls <code>getenv</code> each time <code>Node::init</code> is called."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1503503067, "post_id": 45843769, "comment_id": 78646222, "body": "Then <code>setenv</code> seems to be the cleanest sollution all-around. Do not fix what isn&#39;t broken."}, {"owner": {"reputation": 2458, "user_id": 6445069, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tmqHA.jpg?s=128&g=1", "display_name": "Phydeaux", "link": "https://stackoverflow.com/users/6445069/phydeaux"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1503503266, "post_id": 45843769, "comment_id": 78646356, "body": "@DevSolar yes, I agree, thank you. It seems messy, but that is a natural consequence of the dependency on this library I suppose."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1503503422, "post_id": 45843769, "comment_id": 78646471, "body": "Added the comment as an answer as it does seem to solve your problem."}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 2, "creation_date": 1503504405, "post_id": 45843769, "comment_id": 78647173, "body": "Note that <a href=\"https://rachelbythebay.com/w/2017/01/30/env/\" rel=\"nofollow noreferrer\">getenv and setenv are unsafe in a threaded program</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 1, "creation_date": 1503560626, "post_id": 45844288, "comment_id": 78669368, "body": "It&#39;s not really <i>subshell</i>, rather <i>process.</i> Every process has it own set of environment variables."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": true, "score": 4, "last_activity_date": 1503503385, "creation_date": 1503503385, "answer_id": 45844288, "question_id": 45843769, "link": "https://stackoverflow.com/questions/45843769/stop-library-from-calling-getenv/45844288#45844288", "title": "Stop library from calling getenv?", "body": "<p>Your program will run in a subshell, so there is no \"polluting the environment\" -- no other process will see what you <code>setenv()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": false, "score": 1, "last_activity_date": 1503505243, "creation_date": 1503505243, "answer_id": 45844857, "question_id": 45843769, "link": "https://stackoverflow.com/questions/45843769/stop-library-from-calling-getenv/45844857#45844857", "title": "Stop library from calling getenv?", "body": "<p>Dirty trick, but it's possible to interpose your own implementation of <code>getenv</code>.</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;dlfcn.h&gt;\n#include &lt;string.h&gt;\nstatic char *theirlib_master_uri;\nstatic char *(*real_getenv)(const char *);\nchar *getenv(const char *name) {\n    if (!strcmp(name, \"THEIRLIB_MASTER_URI\"))\n        return theirlib_master_uri;\n    if (!real_getenv)\n        *((void **)&amp;real_getenv) = dlsym(RTLD_NEXT, \"getenv\");\n    return real_getenv(name);\n}\n</code></pre>\n\n<p>This can be done either in a <code>LD_PRELOAD</code> shared object or in your own program.</p>\n"}], "owner": {"reputation": 2458, "user_id": 6445069, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tmqHA.jpg?s=128&g=1", "display_name": "Phydeaux", "link": "https://stackoverflow.com/users/6445069/phydeaux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 45844288, "answer_count": 2, "score": 2, "last_activity_date": 1503505243, "creation_date": 1503501889, "last_edit_date": 1503502022, "question_id": 45843769, "link": "https://stackoverflow.com/questions/45843769/stop-library-from-calling-getenv", "title": "Stop library from calling getenv?", "body": "<p>My program uses an existing library with limited documentation, over which I have no control. For the purposes of this question it is used as follows:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;theirlib.hpp&gt;\n\nusing their_lib::Node;\n\nint main ( int argc, char** argv )\n{\n    Node my_node;\n\n    // connect to the master communication server\n    my_node.init();\n\n    // ...\n}\n</code></pre>\n\n<p>For reasons best known to itself, <code>init()</code> takes no parameters, instead trying to find the URI of the communication server (as well as other parameters) from an environment variable. I can see this with <code>ltrace</code>:</p>\n\n<pre><code>...\n15:43:24 libtheirlib.so-&gt;getenv(\"THEIRLIB_MASTER_URI\") = nil &lt;0.000173&gt;\n...\n</code></pre>\n\n<p>Now, I can wrap my program with a script and set the environment variables beforehand, but what if I want to be able to change them at runtime? I can use <code>setenv()</code> but this still strikes me as polluting the environment, and what if I want to connect to multiple master servers at once?</p>\n\n<p>What are my options (if any) to prevent <code>theirlib</code> from using environment variables to change its behaviour and force it to use a value I can supply in code?</p>\n"}, {"tags": ["c++", "visual-studio", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1503504373, "post_id": 45843738, "comment_id": 78647151, "body": "<b><i>it give me error C2027</i></b> Always include the exact text of the error message. Most users will have to use google to figure out what C2027 is. Is best to copy error messages from the Output Tab of Visual Studio."}], "answers": [{"tags": [], "owner": {"reputation": 4467, "user_id": 3867787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gBELu.png?s=128&g=1", "display_name": "Beginner", "link": "https://stackoverflow.com/users/3867787/beginner"}, "is_accepted": false, "score": 0, "last_activity_date": 1503558574, "last_edit_date": 1503558574, "creation_date": 1503502122, "answer_id": 45843853, "question_id": 45843738, "link": "https://stackoverflow.com/questions/45843738/visual-studio-error-c2027/45843853#45843853", "title": "Visual studio error C2027", "body": "<p>You cannot use <code>_ownerObject</code> inside the header file. </p>\n\n<p>The reason is that you only <strong>forward declare</strong> its type using <code>class GameObject;</code>. The forward declaration only tells the compiler about the class existing, not how it looks like (that would be done by include \"GameObject.h\"). Therefore the compiler cannot know if <code>_ownerObject-&gt;getWorldLocation()</code> in your header line</p>\n\n<pre><code>return _relativeLocation + _ownerObject-&gt;getWorldLocation();\n</code></pre>\n\n<p>is a valid function call.</p>\n\n<p>To solve this move all functions using <code>_ownerObject</code> to the cpp file.</p>\n"}, {"tags": [], "owner": {"reputation": 6371, "user_id": 1266688, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1KqkE.jpg?s=128&g=1", "display_name": "Elvis Dukaj", "link": "https://stackoverflow.com/users/1266688/elvis-dukaj"}, "is_accepted": true, "score": 2, "last_activity_date": 1503502222, "creation_date": 1503502222, "answer_id": 45843895, "question_id": 45843738, "link": "https://stackoverflow.com/questions/45843738/visual-studio-error-c2027/45843895#45843895", "title": "Visual studio error C2027", "body": "<p>The compiler obviously has right :D.</p>\n\n<p>You had a forwar declaration of <code>GameObject</code> that is fine. What is not fine is here:</p>\n\n<pre><code>inline Vector2f getWorldPos() { return _relativeLocation + _ownerObject-&gt;getWorldLocation(); }\n</code></pre>\n\n<p>How can know the compiler that <code>_ownerObject</code> has a method <code>getWorldLocation</code>?</p>\n\n<p>You need or to include <code>GameObject</code> definitions or delcare that function inside cpp file and include the right headers.</p>\n"}], "owner": {"reputation": 37, "user_id": 8425604, "user_type": "registered", "profile_image": "https://graph.facebook.com/1938169556437356/picture?type=large", "display_name": "V&#237;t Gardo\u0148", "link": "https://stackoverflow.com/users/8425604/v%c3%adt-gardo%c5%88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1677, "favorite_count": 0, "accepted_answer_id": 45843895, "answer_count": 2, "score": 1, "last_activity_date": 1503558574, "creation_date": 1503501806, "last_edit_date": 1503502013, "question_id": 45843738, "link": "https://stackoverflow.com/questions/45843738/visual-studio-error-c2027", "title": "Visual studio error C2027", "body": "<p>I am working on my game engine and i get some error which i dont know how to fix. \nI have Camera which have pointer to GameObject but whenever i use him it said that it is undefined type GameObject. I work at Visual studio 2017 and it give me error C2027.</p>\n\n<p>I already have forward declarating and pointer is assigned to object right in constructor. I look on this page but \nThx for any help.</p>\n\n<p>here is camera.h</p>\n\n<pre><code>#pragma once\n\n#include &lt;SDL.h&gt;\n\n#include &lt;SDL_image.h&gt;\n#include &lt;map&gt;\n#include &lt;algorithm&gt;\n\nclass GameObject;\n\n#include \"Camera_manager.h\"\n#include \"gameObject.h\"\n#include \"Interface_SDL.h\"\n#include \"Layer_manager.h\"\n\n#include \"Vector2f.h\"\n#include \"Typedef.h\"\n\n\n\nclass Camera : public Interface_SDL\n{\npublic:\n    Camera(float relativeX, float relativeY, GameObject* ownerObject, ScreenDestination screenDestination, float cameraResolutionWidth, float cameraResolutionHeight, Layer_manager* layerManager);\n    ~Camera();\n\n    //Pozice kamery\n    Vector2f _relativeLocation;\n    //Object kde je um\u00edst\u011bna    \n    GameObject* _ownerObject;\n\n    bool active;\n\n\n    float _cameraResolutionWidth;\n    float _cameraResolutionHeight;\n\n    inline float getCameraResolutionWidth() { return _cameraResolutionWidth; }\n    inline float getCameraResolutionHeight() { return _cameraResolutionHeight; }\n\n\n\n    //Getter pro rozm\u011bry kamery v rozmez\u00ed 0 - 1\n    float getCameraWidthInPercent() { return _screenDestination.XEnd - _screenDestination.XStart; }\n    float getCameraHeightInPercent() { return _screenDestination.YEnd - _screenDestination.YStart; }\n    //Vrac\u00ed pozici na obrazovce\n    inline float getScreenXstart() {return _screenDestination.XStart * Interface_SDL::_windowWidth; }\n    inline float getScreenYstart() { return _screenDestination.YStart * Interface_SDL::_windowHeight; }\n\n    ScreenDestination _screenDestination;\n    Layer_manager* _layerManager;\n    //getter of LayerManager\n    Layer_manager* getLayerManger() { return _layerManager;}\n\n    inline Vector2f getWorldPos() { return _relativeLocation + _ownerObject-&gt;getWorldLocation(); }\n    inline float getWorldPosX() { return _relativeLocation.GetX() + _ownerObject-&gt;getWorldLocation().GetX(); }\n    inline float getWorldPosY() { return _relativeLocation.GetY() + _ownerObject-&gt;getWorldLocation().GetY(); }\n\n\n\n    SDL_Texture* getTexture(int layerNumber);\n\n    //V\u011bco pro maz\u00e1n\u00ed textur\n    SDL_Texture* cleaningTexture;\n    SDL_Rect* cleaningRect;\n\n\n    //LAYERY\n    SDL_Texture* textureLayer0;\n    SDL_Texture* textureLayer1;\n    SDL_Texture* textureLayer2;\n    SDL_Texture* textureLayer3;\n    SDL_Texture* textureLayer4;\n    SDL_Texture* textureLayer5;\n    SDL_Texture* textureLayer6;\n    SDL_Texture* textureLayer7;\n    SDL_Texture* textureLayer8;\n    SDL_Texture* textureLayer9;\n\n\n    //Funkce pro spr\u00e1vu textur\n\n    //Vy\u010dist\u00ed v\u0161echny Layery a nastav\u00ed je na NO USED\n    void clearAllLayers();\n\n    //Vy\u010dist\u00ed texturu kter\u00e1 se vlo\u017e\u00ed\n    void clearTexture(SDL_Texture* texture);\n\n    //resize layers\n    void resizeLayers(int width, int height);\n\n\n\n\n\n    void handleEvents();\n    void update();\n\n};\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1503501603, "post_id": 45843619, "comment_id": 78645196, "body": "string _20 = myfile[myfile.size()-3] + myfile[myfile.size()-2];"}, {"owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1503501683, "post_id": 45843619, "comment_id": 78645244, "body": "Note that is only if you know exactly where the value is, but it seems like you are looking more towards a search functionality. Look into string functions. Look at: <a href=\"http://www.cplusplus.com/reference/string/string/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/string/string</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503504082, "post_id": 45843619, "comment_id": 78646944, "body": "Why do you use a <code>for</code> loop for only 1 iteration?  Seems like a waste; get rid of the loop or correct it."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503504162, "post_id": 45843619, "comment_id": 78647001, "body": "In many programs, the entire record is read from the file into memory, then the record is examined.  If the record does not match the search criteria, another record is read.  A more efficient method is to read many records into memory since searching memory is faster than reading from the file."}, {"owner": {"reputation": 11, "user_id": 8499568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45f964599a44661e0e5bcf8964374c8?s=128&d=identicon&r=PG&f=1", "display_name": "aatanka", "link": "https://stackoverflow.com/users/8499568/aatanka"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503577600, "post_id": 45843619, "comment_id": 78681259, "body": "Actually i have multiple lines of same kind @ThomasMatthews"}], "owner": {"reputation": 11, "user_id": 8499568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45f964599a44661e0e5bcf8964374c8?s=128&d=identicon&r=PG&f=1", "display_name": "aatanka", "link": "https://stackoverflow.com/users/8499568/aatanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1503501504, "answer_count": 0, "score": 0, "last_activity_date": 1503633947, "creation_date": 1503501449, "last_edit_date": 1503633947, "question_id": 45843619, "link": "https://stackoverflow.com/questions/45843619/read-an-integer-between-two-delimiter", "closed_reason": "Duplicate", "title": "read an integer between two delimiter", "body": "<p><strong>my .txt file contains information like</strong></p>\n\n<pre><code>abc,bcd,10,20.  \ncde,efg,30.  \nhello,there,40\n</code></pre>\n\n<p>how can i read the last value, in this case 20,30 and 40 and it is between , and .</p>\n\n<pre><code>ifstream myfile;\n    myfile.open(\"myfile.txt\");\n    string doctor;\n    for(int j=1;j&lt;=5;j++)\n    {\n\n        for (int i = 1; i&lt;=1; i++)\n        { \n            getline(myfile,doctor,'.');\n\n        }\n\n        cout&lt;&lt;doctor&lt;&lt;endl;\n\n        getline(myfile,doctor);\n    }\n    myfile.close();\n</code></pre>\n\n<p><em>here, i am getting the whole line</em></p>\n"}, {"tags": ["c++", "g++", "optional", "c++17", "clang++"], "answers": [{"comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1503503069, "post_id": 45843921, "comment_id": 78646225, "body": "I always thought that overload resolution preferred non-templates. Why is it different here?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 6, "creation_date": 1503503145, "post_id": 45843921, "comment_id": 78646280, "body": "@Rakete1111 It&#39;s not different here. Overload resolution does not &quot;always&quot; prefer non-templates. Given two candidates that have equivalent conversion sequence rankings, one of the tiebreakers is then to prefer the non-template. But we don&#39;t have equivalent conversion sequence rankings here."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1503503498, "post_id": 45843921, "comment_id": 78646529, "body": "@Barry Don&#39;t we have two conversions with the same ranking? One to <code>int</code>, which would take (8) and one for <code>optional&lt;int&gt;</code>, which would take (2)?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1503503551, "post_id": 45843921, "comment_id": 78646571, "body": "@Rakete1111 No, there&#39;s no conversion for <code>(8)</code>. The conversion to <code>int</code> happens inside the constructor itself."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1503504384, "post_id": 45843921, "comment_id": 78647161, "body": "This is very likely to be another bug with GCC&#39;s P0135 implementation."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1503505066, "post_id": 45843921, "comment_id": 78647592, "body": "@T.C. Filed a bug. It&#39;s odd, since I think that&#39;s probably what we want to happen - even if it&#39;s not allowed to happen."}, {"owner": {"reputation": 1121, "user_id": 4988044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176bea70fb8474bc1a454ffeefd59702?s=128&d=identicon&r=PG&f=1", "display_name": "TheCppZoo", "link": "https://stackoverflow.com/users/4988044/thecppzoo"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1503506037, "post_id": 45843921, "comment_id": 78648182, "body": "@T.C. what is the GCC P0135 implementation?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1503575136, "post_id": 45843921, "comment_id": 78679371, "body": "@Downvoter Reasoning? I&#39;m fairly sure this is correct, and the gcc bug just got moved to NEW status."}, {"owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "edited": false, "score": 0, "creation_date": 1503577313, "post_id": 45843921, "comment_id": 78680990, "body": "@Barry Sorry, I guess I do not understand your answer fully yet. Is clang correct with its output (<code>0</code>) according to the standard? I would expect something different. But I guess it would not really fit into this thread, so I just opened <a href=\"https://stackoverflow.com/questions/45861479/why-is-a-cast-operator-to-stdoptional-ignored\">a new question</a>."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 18, "last_activity_date": 1503524806, "last_edit_date": 1503524806, "creation_date": 1503502275, "answer_id": 45843921, "question_id": 45843428, "link": "https://stackoverflow.com/questions/45843428/different-results-in-clang-and-gcc-when-casting-to-stdoptionalt/45843921#45843921", "title": "Different results in Clang and GCC when casting to std::optional&lt;T&gt;", "body": "<p>Since this is direct-initialization, we <a href=\"http://eel.is/c++draft/dcl.init#17.6.2\" rel=\"noreferrer\">enumerate the constructors</a> and just pick the best one. The relevant constructors for <a href=\"http://en.cppreference.com/w/cpp/utility/optional/optional\" rel=\"noreferrer\"><code>std::optional</code></a> are :</p>\n\n<pre><code>constexpr optional( const optional&amp; other ); // (2)\nconstexpr optional( optional&amp;&amp; other ) noexcept(/* see below */); // (3)\n\ntemplate &lt; class U = value_type &gt;\n/* EXPLICIT */ constexpr optional( U&amp;&amp; value ); // (8), with U = foo&amp;\n</code></pre>\n\n<p>Both are viable (<code>(8)</code> only participates in overload resolution if <code>int</code> is constructible from <code>foo&amp;</code> and <code>foo</code> is neither <code>std::in_place_t</code> nor <code>std::optional&lt;int&gt;</code>, all of which hold), but <code>(8)</code> is an exact match whereas <code>(2)</code> and <code>(3)</code> require a user-defined conversion, so it should be preferred. gcc is wrong here. </p>\n\n<p>However, gcc doesn't actually invoke <code>(3)</code> either. It just directly initializes <code>my_opt</code> from the result of converting <code>my_foo</code> to an <code>optional&lt;int&gt;</code>. This program with gcc 7.2 prints <code>3</code> but none of  <code>1a</code>, <code>1b</code>, or <code>2</code>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate &lt;class T&gt;\nstruct opt {\n    opt() { }\n    opt(opt const&amp; ) { std::cout &lt;&lt; \"1a\\n\"; }\n    opt(opt&amp;&amp; ) { std::cout &lt;&lt; \"1b\\n\"; }\n\n    template &lt;class U&gt;\n    opt(U&amp;&amp; ) { std::cout &lt;&lt; \"2\\n\"; }\n};\n\nstruct foo \n{\n    explicit operator opt&lt;int&gt;() { std::cout &lt;&lt; \"3\\n\"; return {}; }\n};\n\nint main()\n{\n    opt&lt;int&gt; o(foo{});\n}\n</code></pre>\n\n<p>I don't think that's an allowable route. I filed <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81952\" rel=\"noreferrer\">81952</a>.</p>\n"}], "owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 3, "accepted_answer_id": 45843921, "answer_count": 1, "score": 20, "last_activity_date": 1503524806, "creation_date": 1503500956, "question_id": 45843428, "link": "https://stackoverflow.com/questions/45843428/different-results-in-clang-and-gcc-when-casting-to-stdoptionalt", "title": "Different results in Clang and GCC when casting to std::optional&lt;T&gt;", "body": "<p>Given the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;optional&gt;\n\nstruct foo\n{\n    explicit operator std::optional&lt;int&gt;() {\n        return std::optional&lt;int&gt;( 1 );\n    }\n    explicit operator int() {\n        return 0;\n    }\n};\n\nint main()\n{\n    foo my_foo;\n    std::optional&lt;int&gt; my_opt( my_foo );\n    std::cout &lt;&lt; \"value: \" &lt;&lt; my_opt.value() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/yXd0odQ6W2oUrpUj\" rel=\"noreferrer\">gcc 7.2.0 writes</a> <code>value: 1</code>.</p>\n\n<p>MSVC 2017 (15.3) and <a href=\"https://wandbox.org/permlink/StVsiuAJky5OLZML\" rel=\"noreferrer\">clang 4.0.0 however write</a> <code>value: 0</code>.</p>\n\n<p>Which one is correct according to the C++ standard?</p>\n"}, {"tags": ["c++", "c-preprocessor"], "comments": [{"owner": {"reputation": 3978, "user_id": 3162383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b8754ab5c9bf4ed7cffed8a1d94f4c?s=128&d=identicon&r=PG", "display_name": "onqtam", "link": "https://stackoverflow.com/users/3162383/onqtam"}, "edited": false, "score": 0, "creation_date": 1503501150, "post_id": 45843417, "comment_id": 78644869, "body": "downvoters - please explain..."}], "answers": [{"comments": [{"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1503501811, "post_id": 45843638, "comment_id": 78645317, "body": "That question isn&#39;t relevant because you can&#39;t unstringify <code>__FILE__</code>."}], "tags": [], "owner": {"reputation": 403, "user_id": 8127650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae26ccc457eaa888985c1849092dced4?s=128&d=identicon&r=PG&f=1", "display_name": "drone6502", "link": "https://stackoverflow.com/users/8127650/drone6502"}, "is_accepted": false, "score": 1, "last_activity_date": 1503501533, "creation_date": 1503501533, "answer_id": 45843638, "question_id": 45843417, "link": "https://stackoverflow.com/questions/45843417/how-to-append-to-file-at-preprocessor-time-and-include-the-result/45843638#45843638", "title": "how to append to __FILE__ at preprocessor time and include the result", "body": "<p>Kind of obscure, but seems to be possible with gcc.</p>\n\n<p>Look at the second answer of this question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5873722/c-macro-dynamic-include\">C Macro - Dynamic #include</a></p>\n"}, {"comments": [{"owner": {"reputation": 3978, "user_id": 3162383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b8754ab5c9bf4ed7cffed8a1d94f4c?s=128&d=identicon&r=PG", "display_name": "onqtam", "link": "https://stackoverflow.com/users/3162383/onqtam"}, "edited": false, "score": 0, "creation_date": 1503503549, "post_id": 45843724, "comment_id": 78646565, "body": "such a shame that I can&#39;t attach defines on header files and only on source files (but it makes sense though...) - otherwise I could simulate this with my build system..."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "reply_to_user": {"reputation": 3978, "user_id": 3162383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b8754ab5c9bf4ed7cffed8a1d94f4c?s=128&d=identicon&r=PG", "display_name": "onqtam", "link": "https://stackoverflow.com/users/3162383/onqtam"}, "edited": false, "score": 0, "creation_date": 1503505165, "post_id": 45843724, "comment_id": 78647648, "body": "Your build system is open ended... you could simply use another tool to generate the include files."}], "tags": [], "owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "is_accepted": true, "score": 3, "last_activity_date": 1503501777, "creation_date": 1503501777, "answer_id": 45843724, "question_id": 45843417, "link": "https://stackoverflow.com/questions/45843417/how-to-append-to-file-at-preprocessor-time-and-include-the-result/45843724#45843724", "title": "how to append to __FILE__ at preprocessor time and include the result", "body": "<p>Unfortunately, this is not possible:</p>\n\n<ul>\n<li><code>__FILE__</code> expands to a string; you cannot unstringify a string.  So the technique of just adding the \"rest\" of the string, then stringifying the result, isn't available.</li>\n<li>Pasting two string tokens does not create a valid token.  So pasting isn't available.</li>\n<li>String literal concatenation doesn't exist for the preprocessor (preprocessor is translation phase 4; string literal concatenation is phase 6).</li>\n</ul>\n"}], "owner": {"reputation": 3978, "user_id": 3162383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b8754ab5c9bf4ed7cffed8a1d94f4c?s=128&d=identicon&r=PG", "display_name": "onqtam", "link": "https://stackoverflow.com/users/3162383/onqtam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 45843724, "answer_count": 2, "score": 1, "last_activity_date": 1503501777, "creation_date": 1503500934, "question_id": 45843417, "link": "https://stackoverflow.com/questions/45843417/how-to-append-to-file-at-preprocessor-time-and-include-the-result", "title": "how to append to __FILE__ at preprocessor time and include the result", "body": "<p>I want to include <code>component.h.gen</code> from <code>component.h</code>.</p>\n\n<p>I've already seen that I can use <code>__FILE__</code> with <code>#include</code> and that results in recursive inclusion if there is no header guard.</p>\n\n<p>Is there a way to append a C string literal and include the result? This is what I've tried so far:</p>\n\n<pre><code>#define CAT_IMPL(s1, s2) s1##s2\n#define CAT(s1, s2) CAT_IMPL(s1, s2)\n#define DO_IT CAT(__FILE__, \".gen\")\n\n#include DO_IT\n</code></pre>\n\n<p>But this results in the same recursion with the file including itself - the <code>\".gen\"</code> part is not used - and I get this warning with MSVC:</p>\n\n<blockquote>\n  <p>warning C4067: unexpected tokens following preprocessor directive - expected a newline</p>\n</blockquote>\n\n<p>Is there a solution that would work with gcc/clang/msvc?</p>\n\n<p>Note that I'm planning on using this in hundreds if not thousands of files and I would like to simplify my life by just copy-pasting the same code - that's why I'm trying to get this to work.</p>\n"}, {"tags": ["c++", "c++11", "directx", "directx-11", "tga"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1503500816, "post_id": 45843210, "comment_id": 78644632, "body": "It&#39;s probably a padding issue. Depending on your compiler you can use a specific #pragma that disables padding of structures, but this may be a problem on certain achitectures as unaligned memory access of data that is larger than 1 byte may not work. Tell us which platform you&#39;re targeting and which compiler you use. And please read <a href=\"https://stackoverflow.com/questions/5397447/struct-padding-in-c\">this</a> and <a href=\"https://stackoverflow.com/questions/4306186/structure-padding-and-packing\">this</a>."}, {"owner": {"reputation": 179, "user_id": 5888436, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/818427391612398/picture?type=large", "display_name": "Bartosz Boczula", "link": "https://stackoverflow.com/users/5888436/bartosz-boczula"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1503500998, "post_id": 45843210, "comment_id": 78644762, "body": "I&#39;m using VS2015, targeting x86 platforms. I was thinking of padding, but if you think about that, padding could only make the data end up further, but in this case they end up &quot;earlier&quot;, right? In other words, if this was padding issue, the fix would be to ADD some field in the structure, but here i have to REMOVE a field"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1503501109, "post_id": 45843210, "comment_id": 78644836, "body": "Please put complementary information into your question by <a href=\"https://stackoverflow.com/posts/45843210/edit\">edit</a>ing it. Try <code>#pragma pack(1)</code> and read <a href=\"https://stackoverflow.com/questions/3318410/pragma-pack-effect\">this</a>"}, {"owner": {"reputation": 179, "user_id": 5888436, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/818427391612398/picture?type=large", "display_name": "Bartosz Boczula", "link": "https://stackoverflow.com/users/5888436/bartosz-boczula"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1503501536, "post_id": 45843210, "comment_id": 78645158, "body": "This totally worked... Thx! In genera, I understand padding, but i don&#39;t understand this particular case, padding usually adds &quot;empty&quot; bytes, so the quick solution is to add mockup fields to the structure, but here i had to remove one... Anyway, thx again for help!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1503501754, "post_id": 45843210, "comment_id": 78645278, "body": "Look at my answer below. With all that information you should be able to figure out what exactly is going on."}, {"owner": {"reputation": 21298, "user_id": 309425, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75a67cd9a3d7367a6e594fcbe5e41400?s=128&d=identicon&r=PG", "display_name": "JWWalker", "link": "https://stackoverflow.com/users/309425/jwwalker"}, "edited": false, "score": 2, "creation_date": 1503501828, "post_id": 45843210, "comment_id": 78645327, "body": "If you have  a structure with padding, and read data into it in a way that does not take padding into account, then data will move earlier.  For example, suppose you have a struct containing a char, a short and a char.  You think that&#39;s 4 bytes, and you read 4 bytes a,b,c,d into it.  You expect that d will be in the final char, but since b goes into a padding byte, c and d go into the short."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 5888436, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/818427391612398/picture?type=large", "display_name": "Bartosz Boczula", "link": "https://stackoverflow.com/users/5888436/bartosz-boczula"}, "edited": false, "score": 0, "creation_date": 1503587551, "post_id": 45843695, "comment_id": 78688869, "body": "Just a commen, using #pragma pack(1) can be risky, in my project it caused some crashes in wierd places. The better solution would be to surrond the structure you don&#39;t want to be padded with #pragma pack(push,1) and #pragma pack(pop)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 179, "user_id": 5888436, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/818427391612398/picture?type=large", "display_name": "Bartosz Boczula", "link": "https://stackoverflow.com/users/5888436/bartosz-boczula"}, "edited": false, "score": 0, "creation_date": 1503587654, "post_id": 45843695, "comment_id": 78688969, "body": "@BartoszBoczula good point, please feel free to improve my answer."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1503502026, "last_edit_date": 1503502026, "creation_date": 1503501678, "answer_id": 45843695, "question_id": 45843210, "link": "https://stackoverflow.com/questions/45843210/tga-file-header-is-not-correct-on-windows/45843695#45843695", "title": "TGA File Header is not correct on Windows", "body": "<p>It's a padding issue. With Visual Studio you can use the <code>#pragma pack(1)</code> compiler directive disable any padding of structures.</p>\n\n<p><strong>Demonstration</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;windows.h&gt;\n\n// Default packing of structure with padding\n\ntypedef struct {\n  CHAR  idlength;\n  CHAR  colourmaptype;\n  CHAR  datatypecode;\n  WORD colourmaporigin;\n  WORD colourmaplength;\n  CHAR  colourmapdepth;\n  WORD x_origin;\n  WORD y_origin;\n  WORD width;\n  WORD height;\n  CHAR  bitsperpixel;\n  CHAR  imagedescriptor;\n} TGAHEADER;\n\n\n#pragma pack(1) // structure fields are aligned to byte boundary (no padding)\n\ntypedef struct {\n  CHAR  idlength;\n  CHAR  colourmaptype;\n  CHAR  datatypecode;\n  WORD colourmaporigin;\n  WORD colourmaplength;\n  CHAR  colourmapdepth;\n  WORD x_origin;\n  WORD y_origin;\n  WORD width;\n  WORD height;\n  CHAR  bitsperpixel;\n  CHAR  imagedescriptor;\n} TGAHEADER_PACKED;\n\nint main()\n{\n  printf(\"Offset of field bitsperpixel in TGAHEADER structure %d\\n\", offsetof(TGAHEADER, bitsperpixel));\n  printf(\"Offset of field bitsperpixel in packed TGAHEADER structure %d\\n\", offsetof(TGAHEADER_PACKED, bitsperpixel));\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Offset of field bitsperpixel in TGAHEADER structure 18\nOffset of field bitsperpixel in packed TGAHEADER structure 16\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 5888436, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/818427391612398/picture?type=large", "display_name": "Bartosz Boczula", "link": "https://stackoverflow.com/users/5888436/bartosz-boczula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 45843695, "answer_count": 1, "score": 1, "last_activity_date": 1503640159, "creation_date": 1503500302, "last_edit_date": 1503640159, "question_id": 45843210, "link": "https://stackoverflow.com/questions/45843210/tga-file-header-is-not-correct-on-windows", "title": "TGA File Header is not correct on Windows", "body": "<p>I'm trying to read a TGA header of the file I created in Paint.net. It seems that there is something wrong with it. If I use the header structure from the specification, like this one:</p>\n\n<pre><code>typedef struct {\n    CHAR  idlength;\n    CHAR  colourmaptype;\n    CHAR  datatypecode;\n    WORD colourmaporigin;\n    WORD colourmaplength;\n    CHAR  colourmapdepth;\n    WORD x_origin;\n    WORD y_origin;\n    WORD width;\n    WORD height;\n    CHAR  bitsperpixel;\n    CHAR  imagedescriptor;\n} TGAHEADER;\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>Data size: 0\nColor Map type: 0\nData Type code: 2\nBits per-pixel: 0\nSize: 501 x 2080\n</code></pre>\n\n<p>Which is wrong, since my image is 501x501, 32-bits per pixel. However, if I comment out two bytes from the structure, f.e. this one <code>colourmaporigin</code>, I get this:</p>\n\n<pre><code>Data size: 0\nColor Map type: 0\nData Type code: 2\nBits per-pixel: 32\nSize: 501 x 501\n</code></pre>\n\n<p>Which is correct. I was reading everything I found on this file format. It never says that any of those fields are optional or something.</p>\n\n<p>How come I get results like this?</p>\n\n<p>Here's the code for reading the data:</p>\n\n<pre><code>void Image::readTGA()\n{\n    TGAHEADER fileHeader;\n\n    std::ifstream fileHandle(fileName, std::ios::binary);\n    if (fileHandle.is_open())\n    {\n        fileHandle.read((char*)(&amp;fileHeader), sizeof(TGAHEADER));\n        fileHandle.close();\n    }\n    else\n    {\n        std::cout &lt;&lt; \"An error occured when opening a file.\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>I'm using VS2015, targeting x86 platform.</p>\n"}, {"tags": ["c++", "arrays", "multidimensional-array", "dynamic-arrays"], "comments": [{"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503500337, "post_id": 45843204, "comment_id": 78644291, "body": "Why wont you use something more &#39;C++&#39; ? <code>std::array</code>, <code>std::vector</code>,..."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1503500356, "post_id": 45843204, "comment_id": 78644299, "body": "Whenever you think &quot;dynamic array&quot;, your next thought should be <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><i><code>std::vector</code></i></a>."}, {"owner": {"reputation": 3, "user_id": 8235842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5dbe7d54cc501d24ffab8c46025a58a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael abdo", "link": "https://stackoverflow.com/users/8235842/michael-abdo"}, "reply_to_user": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503503267, "post_id": 45843204, "comment_id": 78646357, "body": "@FilipKo\u010dica I&#39;m quite new to C++, first time trying to make an array like this!"}, {"owner": {"reputation": 3, "user_id": 8235842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5dbe7d54cc501d24ffab8c46025a58a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael abdo", "link": "https://stackoverflow.com/users/8235842/michael-abdo"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1503503304, "post_id": 45843204, "comment_id": 78646386, "body": "@Someprogrammerdude okay no worries thanks alot :)"}], "answers": [{"tags": [], "owner": {"reputation": 3046, "user_id": 3013887, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1396249d91442e1dde6e93197c0b94a?s=128&d=identicon&r=PG&f=1", "display_name": "pingul", "link": "https://stackoverflow.com/users/3013887/pingul"}, "is_accepted": true, "score": 0, "last_activity_date": 1503578561, "creation_date": 1503578561, "answer_id": 45861967, "question_id": 45843204, "link": "https://stackoverflow.com/questions/45843204/changing-a-static-2d-array-into-a-dynamic-array-in-a-class-c/45861967#45861967", "title": "Changing a static 2D array into a Dynamic array in a class C++", "body": "<p>As suggested, <code>std::vector</code> is probably the way to go. Here is a small example that might help you:</p>\n\n<pre><code>#include &lt;vector&gt;\n\nclass board\n{\n\npublic:\n    board(int x, int y)\n    {\n        resize(x, y);\n    }\n\n    void resize(int x, int y) \n    {\n        // make sure input is OK\n        mBoard.clear();\n        for (int i = 0; i &lt; x; ++i) \n            mBoard.emplace_back(std::vector&lt;char&gt;(y, '_'));\n    }\nprivate:\n    std::vector&lt;std::vector&lt;char&gt;&gt; mBoard; // 2 dimensional std::vector\n};\n</code></pre>\n\n<p>And create by</p>\n\n<pre><code>board my_board(11, 11);\nmy_board.resize(2, 10); // Resize afterwards\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8235842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5dbe7d54cc501d24ffab8c46025a58a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael abdo", "link": "https://stackoverflow.com/users/8235842/michael-abdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 45861967, "answer_count": 1, "score": 0, "last_activity_date": 1503578561, "creation_date": 1503500280, "question_id": 45843204, "link": "https://stackoverflow.com/questions/45843204/changing-a-static-2d-array-into-a-dynamic-array-in-a-class-c", "title": "Changing a static 2D array into a Dynamic array in a class C++", "body": "<p>I have a 2D char array filled with '_' 's, I have made a static array and I wanted to change it to dynamic so you can change the size of the board, do I need to assign a pointer in public and int's in private? Or will I have to make a new array completely? Thanks :) </p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n\n\nusing namespace std;\n\nclass board\n{\n\npublic:\n    void makeBoard()\n    {\n        for (int i = 0; i &lt; 11; yaxis++)\n        {\n            for (int j = 0; j &lt; 11; xaxis++)\n            {\n                opening[i][j] = '_';\n            }\n        }\n    }\n\nprivate:\n    char placement[11][11];\n};\n</code></pre>\n"}, {"tags": ["c++", "unit-testing"], "comments": [{"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 0, "creation_date": 1503500750, "post_id": 45843137, "comment_id": 78644579, "body": "Can you mock the complete header and definition file of those classes? Why exactly do you need to mock those classes in the first place?"}, {"owner": {"reputation": 11, "user_id": 4124782, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b1cfiVmiBFw/AAAAAAAAAAI/AAAAAAAACP8/30heyKlaQ80/photo.jpg?sz=128", "display_name": "Salmony", "link": "https://stackoverflow.com/users/4124782/salmony"}, "reply_to_user": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 0, "creation_date": 1503507534, "post_id": 45843137, "comment_id": 78649048, "body": "@MikeMB It&#39;s an option, yes, but I&#39;m using Google Test/Mock and those guys are advising differently. I want to mock them because I&#39;m unit testing the class under test. It makes no sense for the design to test those classes as a part of this particular unit test."}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 0, "creation_date": 1503509515, "post_id": 45843137, "comment_id": 78650081, "body": "I&#39;m asking because I usually only mock objects that make testing the unit under test significantly more difficult (e.g. because they need a network connection) and in those cases l try to use dependency injection anyway. Otherwise I don&#39;t bother with mocking and just make sure that those classes are properly tested before."}, {"owner": {"reputation": 11, "user_id": 4124782, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b1cfiVmiBFw/AAAAAAAAAAI/AAAAAAAACP8/30heyKlaQ80/photo.jpg?sz=128", "display_name": "Salmony", "link": "https://stackoverflow.com/users/4124782/salmony"}, "reply_to_user": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 0, "creation_date": 1503514147, "post_id": 45843137, "comment_id": 78652743, "body": "@MikeMB I see your point, but in my case one of the classes is a serial port and another involves some multithreading stuff which I would very much like not to include in my unit test. But you do make another good point making sure that those classes are properly tested - which they are not (yet)."}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 0, "creation_date": 1503576644, "post_id": 45843137, "comment_id": 78680467, "body": "Well, the serial I/Of is defibrillator a candidate for DI. And if multi-threaded is part of your class, you probably also want to test it with it. But of course I don&#39;t know your code, so this is largely guesswork. Sorry that I don&#39;t have an answer to your actual question. I hope the answer isn&#39;t just &quot;you can&#39;t&quot;."}], "owner": {"reputation": 11, "user_id": 4124782, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b1cfiVmiBFw/AAAAAAAAAAI/AAAAAAAACP8/30heyKlaQ80/photo.jpg?sz=128", "display_name": "Salmony", "link": "https://stackoverflow.com/users/4124782/salmony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1503500086, "creation_date": 1503500086, "question_id": 45843137, "link": "https://stackoverflow.com/questions/45843137/how-can-i-mock-multiple-independent-classes-inside-class-under-test", "title": "How can I mock multiple independent classes inside class under test", "body": "<p>The following post partly answers my question except from the fact that my class under test is using several other independent classes and I would like to mock all of them.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/17743141/junit-mockito-mock-class-in-class-under-test\">JUnit. Mockito. Mock class in class under test</a></p>\n\n<p>I could inject each of the classes, but I think it's ugly. I could make a generic factory that can instantiate classes of any kind, but I don't want this factory to depend on several different classes because it seems ugly too.</p>\n\n<p>Some input would be very much appreciated. Thanks.</p>\n\n<p>Btw. the project is written in C++.</p>\n"}, {"tags": ["c++", "namespaces"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 3, "creation_date": 1503500116, "post_id": 45843068, "comment_id": 78644110, "body": "However high your pace gets, that extra half-second spent typing <code>std::</code> cannot possibly be significant. You usually spend considerably more time thinking than typing anyway, at least I hope so ;)"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1503500130, "post_id": 45843068, "comment_id": 78644120, "body": "It doesn&#39;t belong here as it is primarily opinion based and not a technical question. But you may want to read <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">this</a> for some mediocre opinions."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1503500151, "post_id": 45843068, "comment_id": 78644140, "body": "<code>using std::cout;</code> has the same issues as <code>using std;</code>"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 2, "creation_date": 1503501562, "post_id": 45843068, "comment_id": 78645170, "body": "You <i>could</i> add a <code>using std::cout</code> inside the 1 or 2 functions that use <code>cout</code> heavily. Most functions probably won&#39;t display anything anyway."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1503501602, "post_id": 45843068, "comment_id": 78645195, "body": "I feel better for each <code>std::</code> that I type and see in my code, because it is one more thing where I can be certain that it does what it is supposed to do, that it has documentation in case I need it, etc... of course <code>cout</code> could be the same as <code>std::cout</code> but to realize that requires me to use my brain for something when I could have avoided it"}], "answers": [{"tags": [], "owner": {"reputation": 433, "user_id": 7313789, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a4a8392e031b7a7a12a70e0efc42c9df?s=128&d=identicon&r=PG&f=1", "display_name": "Luple", "link": "https://stackoverflow.com/users/7313789/luple"}, "is_accepted": true, "score": 2, "last_activity_date": 1503500112, "creation_date": 1503500112, "answer_id": 45843143, "question_id": 45843068, "link": "https://stackoverflow.com/questions/45843068/c-best-practice-using-stdcout-vs-stdcout/45843143#45843143", "title": "C++ - Best Practice: `using std::cout` vs `std::cout`", "body": "<p>So I have done a little bit with C++, but I would say the problem falls under the problem of namespaces in all languages. The real problem is that if you have multiple namespaces with the same function, it makes it much more difficult to read whats going on and can cause undesired results. </p>\n\n<p>For example if you have two functions with the same name in two name spaces, how will the code know which one to use? Also another problem comes when you have multiple namespaces added and call a function. How does someone reading the code know which namespace the code is coming from? Having the namespace in front of the function helps make your code more readable. </p>\n"}], "owner": {"reputation": 770, "user_id": 4834108, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9ff8c9a23c77cf9ed7aeeb0709f54985?s=128&d=identicon&r=PG&f=1", "display_name": "skr_robo", "link": "https://stackoverflow.com/users/4834108/skr-robo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1767, "favorite_count": 2, "closed_date": 1503500107, "accepted_answer_id": 45843143, "answer_count": 1, "score": 2, "last_activity_date": 1503501429, "creation_date": 1503499894, "last_edit_date": 1503501429, "question_id": 45843068, "link": "https://stackoverflow.com/questions/45843068/c-best-practice-using-stdcout-vs-stdcout", "closed_reason": "Opinion-based", "title": "C++ - Best Practice: `using std::cout` vs `std::cout`", "body": "<p>I understand that, in C++, we should never use:</p>\n\n<p><code>using namespace std;</code></p>\n\n<p>The two possible alternatives are:</p>\n\n<p>1) adding <code>using std::cout;</code> at the beginning of the file and just type <code>cout</code> whenever required</p>\n\n<p>2) type <code>std::cout</code> every time we need to use <code>cout</code></p>\n\n<p>My understanding is that the second method is the best. However, is this always followed in professional environments? Is it practical to follow in highly fast paced environments? I am used to the first alternative. Is it an advantage to switch?</p>\n\n<p>Note: I originally posted this in Code Review and I was told that this topic belonged here. Kindly let me know if not.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1503499166, "post_id": 45842762, "comment_id": 78643303, "body": "Don&#39;t recurse, use a loop. Recursing doesn&#39;t &quot;restart&quot; - it suspends, calls the function, and then continues after the call returns, like every function call does."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1503499218, "post_id": 45842762, "comment_id": 78643354, "body": "What are you trying to do? And what&#39;s stumping you? Be specific."}, {"owner": {"reputation": 231, "user_id": 7404875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80971b1d5ed24a338b33e8761cf394e?s=128&d=identicon&r=PG&f=1", "display_name": "pmaxim98", "link": "https://stackoverflow.com/users/7404875/pmaxim98"}, "edited": false, "score": 0, "creation_date": 1503499237, "post_id": 45842762, "comment_id": 78643371, "body": "Isn&#39;t an <code>invalid_argument</code> exception thrown when it doesn&#39;t succeed?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1503499266, "post_id": 45842762, "comment_id": 78643402, "body": "Use <code>strtol</code> which cleanly reports non-numeric inputs via an output parameter."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503505745, "post_id": 45842762, "comment_id": 78648003, "body": "See also <a href=\"http://en.cppreference.com/w/cpp/string/byte/isdigit\" rel=\"nofollow noreferrer\"><code>std::isdigit</code></a>, which tests a character if it is a numeric digit."}, {"owner": {"reputation": 23, "user_id": 7179156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fe8a8e60f1768cfd2421ed4c6f00?s=128&d=identicon&r=PG&f=1", "display_name": "Q.Reilly", "link": "https://stackoverflow.com/users/7179156/q-reilly"}, "edited": false, "score": 0, "creation_date": 1503515637, "post_id": 45842762, "comment_id": 78653511, "body": "Thanks to moldbnilo. I will fix that."}], "answers": [{"tags": [], "owner": {"reputation": 1006, "user_id": 2946671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e7c2518ce2cf7ed64ce3e73464b728b?s=128&d=identicon&r=PG&f=1", "display_name": "N00byEdge", "link": "https://stackoverflow.com/users/2946671/n00byedge"}, "is_accepted": true, "score": 0, "last_activity_date": 1503499790, "last_edit_date": 1503499790, "creation_date": 1503499269, "answer_id": 45842844, "question_id": 45842762, "link": "https://stackoverflow.com/questions/45842762/this-snippet-of-code-does-not-stop-stoi-from-running-when-it-gets-bad-input/45842844#45842844", "title": "This snippet of code does not stop stoi from running when it gets bad input", "body": "<p>The mistake seems to be right here: <code>if (x[i] &gt;= '0' || x[i] &lt;= '9')</code>\nThis should probably be <code>if (x[i] &gt;= '0' &amp;&amp; x[i] &lt;= '9')</code> if I understand your code correctly, even though I am having some difficulty parsing it. Either way, the code you have there before will return true for all characters. This checks that it is within the number range of ascii characters.</p>\n\n<p>Also, seems like your second loop is checking <code>x.size()</code> instead of <code>y.size()</code> when working on <code>y</code>. This should matter if <code>x</code> doesn't have the same size as <code>y</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7179156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fe8a8e60f1768cfd2421ed4c6f00?s=128&d=identicon&r=PG&f=1", "display_name": "Q.Reilly", "link": "https://stackoverflow.com/users/7179156/q-reilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 45842844, "answer_count": 1, "score": -4, "last_activity_date": 1503499790, "creation_date": 1503499040, "last_edit_date": 1503499304, "question_id": 45842762, "link": "https://stackoverflow.com/questions/45842762/this-snippet-of-code-does-not-stop-stoi-from-running-when-it-gets-bad-input", "title": "This snippet of code does not stop stoi from running when it gets bad input", "body": "<p>I am stuck with this bit of code. I am trying to get this code snippet to restart if the user input isn't numeric. It doesn't seem to do this and I don't know why. I would appreciate it if someone could give me a hand. Sorry about the start and end line indents, it's driving me mad.</p>\n\n<pre><code>void write() {\n  string x, y;    \n  int x1 = 0, y1 = 0, no = 0;\n\n  /*highNumber (x1, y1);*/\n\n  cout &lt;&lt; endl &lt;&lt; \" x to display: \";\n  cin &gt;&gt; x;\n  cout &lt;&lt; endl &lt;&lt; \" y to display: \";\n  cin &gt;&gt; y;\n\n  for (int i = 0; i &lt; x.length(); i++) {\n    if (x[i] &gt;= '0' || x[i] &lt;= '9') {\n      no++;\n    }\n  }\n\n  if (no == x.length()) {\n    no = 0;\n  }\n  else {\n    write();\n  }\n\n  for (int i = 0; i &lt; x.length(); i++) {\n    if (y[i] &gt;= '0' || y[i] &lt;= '9') {\n      no++;\n    }\n  }\n\n  if (no == x.length()) {\n    no = 0;\n  }\n  else {\n    write();\n  }\n\n  x1 = stoi(x);\n  y1 = stoi(y);\n\n  highNumber (x1, y1);\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "templates", "code-duplication"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1503499555, "post_id": 45842717, "comment_id": 78643651, "body": "Contrary to <code>noexcept</code>, there are no <code>const(condition)</code> qualifier."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503499648, "post_id": 45842717, "comment_id": 78643717, "body": "@NathanOliver: OP would like to have <code>INIFile&lt;MyProcessor&gt;::process()</code> and <code>INIFile&lt;MyConstProcessor&gt;::process() const</code> without to have to duplicate code."}, {"owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503499667, "post_id": 45842717, "comment_id": 78643731, "body": "@Jarod42 exactly my point. but is there any tricks? I have some ideas, like extracting &quot;lots of code here&quot; into const function, but it have several branches and result non duplicated code is way too complicated"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503499746, "post_id": 45842717, "comment_id": 78643797, "body": "Ah.  Okay.  So you want <code>process()</code> to be <code>const</code> if <code>CALLBACK::operator()</code> is <code>const</code>."}, {"owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503499883, "post_id": 45842717, "comment_id": 78643930, "body": "@NathanOliver exactly. please feel free to edit the question"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1503500306, "post_id": 45842717, "comment_id": 78644267, "body": "@Nick Edited.  Fell free to roll back if you think that changes it."}], "answers": [{"comments": [{"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1503526525, "post_id": 45849758, "comment_id": 78658386, "body": "In this solution though, <code>process</code> is always const regardless of whether <code>CALLBACK::operator()</code> is. There is a real solution, it&#39;s pretty straightforward, I&#39;ll post it shortly."}], "tags": [], "owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1503524652, "creation_date": 1503524652, "answer_id": 45849758, "question_id": 45842717, "link": "https://stackoverflow.com/questions/45842717/template-const-non-const-method/45849758#45849758", "title": "template const / non const method", "body": "<p>Another way I found, but I do not like it very much is to use pointer instead of reference.</p>\n\n<p>Here is the code.</p>\n\n<p>Note in this particular case we do not need to check for <code>nullptr</code> at all.</p>\n\n<pre><code>template&lt;class CALLBACK&gt;\nstruct INIFile{\n    INIFile(CALLBACK &amp;processor) :\n                    processor(&amp; processor ){}\n\n    bool process() const{\n        // lots of code here,\n        // call processor\n        processor-&gt;operator()(123);\n\n        return true;\n    }\n\n    CALLBACK    *processor;\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2251, "user_id": 6639082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44da46c9168a90de2479557760523d3d?s=128&d=identicon&r=PG&f=1", "display_name": "WindyFields", "link": "https://stackoverflow.com/users/6639082/windyfields"}, "edited": false, "score": 1, "creation_date": 1503528179, "post_id": 45850241, "comment_id": 78658926, "body": "Nice solution, but is there any reason to use <code>const_cast</code> instead of <code>static_cast</code>?? Isn&#39;t it just <code>CALLBACK&amp;</code> -&gt; <code>const CALLBACK&amp;</code>. Or is it just one letter less to type :)"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 2251, "user_id": 6639082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44da46c9168a90de2479557760523d3d?s=128&d=identicon&r=PG&f=1", "display_name": "WindyFields", "link": "https://stackoverflow.com/users/6639082/windyfields"}, "edited": false, "score": 0, "creation_date": 1503529030, "post_id": 45850241, "comment_id": 78659200, "body": "I guess in this situation there is no real reason because it would be hard to imagine how you could make a mistake either way; you are clearly adding const-ness and you clearly would have to work hard to get the wrong type."}, {"owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "edited": false, "score": 0, "creation_date": 1503557276, "post_id": 45850241, "comment_id": 78667144, "body": "amazing usage of sfinae"}], "tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": true, "score": 3, "last_activity_date": 1503527410, "creation_date": 1503527410, "answer_id": 45850241, "question_id": 45842717, "link": "https://stackoverflow.com/questions/45842717/template-const-non-const-method/45850241#45850241", "title": "template const / non const method", "body": "<p>Your problem is solved by doing the following:</p>\n\n<pre><code>template&lt;class CALLBACK&gt;\nstruct INIFile{\n    INIFile(CALLBACK &amp;processor) :\n                    processor(processor){}\n\n    template &lt;class T&gt;\n    bool process_impl(T&amp; processor) const {\n        // deliberately shadow processor\n        // reduce likelihood of using member processor, but can use other member variables\n\n        // lots of code\n        processor(123);\n        return true;\n    }\n\n    bool process() const {\n        return process_impl(const_cast&lt;const CALLBACK&amp;&gt;(processor));\n    }\n    bool process() {\n        return process_impl(processor);\n    }\n\n    CALLBACK&amp;    processor;\n};\n</code></pre>\n\n<p>This of course technically overloads <code>process</code>, but it has the exact same effect that you want. If the <code>processor</code>'s call operator is <em>not</em> marked const, and you try to call <code>process</code> via a const reference or const copy of the object, you get a compilation error (unlike with your solution). That's because the <code>const</code> overload of <code>process</code> gets called, it adds the <code>const</code> to the processor which gets passed along, and then of course the call operator on the processor fails.</p>\n\n<p>However, if the callback does provide a <code>const</code> call operator, then either process call will do exactly the same thing. This effectively means that you can call <code>process</code> on a const copy of <code>INIFile</code>, which is equivalent to <code>process</code> being <code>const</code>.</p>\n\n<p>If the callback also overloads the call operator, then this implementation will forward along to whichever is correct, but you didn't specify that as a condition. The only thing to watch out for, is that <code>process_impl</code> should never access the member variable <code>processor</code>, because that member variable will always be mutable, i.e. the call will work even when it shouldn't (like in your solution). I shadow intentionally to try to prevent this. This isn't that beautiful but as an implementation detail it's not so bad, and it does remove the duplication.</p>\n"}], "owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 45850241, "answer_count": 2, "score": 4, "last_activity_date": 1503527410, "creation_date": 1503498947, "last_edit_date": 1503500236, "question_id": 45842717, "link": "https://stackoverflow.com/questions/45842717/template-const-non-const-method", "title": "template const / non const method", "body": "<p>Suppose we have code like this:</p>\n\n<pre><code>template&lt;class CALLBACK&gt;\nstruct INIFile{\n    INIFile(CALLBACK &amp;processor) :\n                    processor(processor     ){}\n\n    bool process(){\n        // lots of code here,\n        // call processor\n        processor(123);\n\n        return true;\n    }\n\n    CALLBACK    &amp;processor;\n};\n\n\nstruct MyProcessor{\n    void operator()(int val){\n        // do something\n    }\n};\n\nstruct MyConstProcessor{\n    void operator()(int val) const{ // !!!!!\n        // do something\n    }\n};\n\nint main(){\n    MyProcessor p;\n    INIFile&lt;MyProcessor&gt; ini(p);\n    ini.process();\n\n    // const case:\n    MyConstProcessor cp;\n    INIFile&lt;MyConstProcessor&gt; cini(cp);\n    cini.process();\n}\n</code></pre>\n\n<p>In both cases <code>INIFile&lt;&gt;::process()</code> will be a non <code>const</code> member function.</p>\n\n<p>Is there an easy way to make <code>process()</code> a <code>const</code> member function if <code>CALLBACK::operator()</code> is <code>const</code>, without duplicate all logic in <code>INIFile&lt;&gt;::process()</code>?</p>\n"}, {"tags": ["c++", "multithreading", "hash", "md5"], "comments": [{"owner": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 0, "creation_date": 1503498970, "post_id": 45842660, "comment_id": 78643121, "body": "How many cpu cores do you have to run it on?..."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1503498973, "post_id": 45842660, "comment_id": 78643127, "body": "You have ten thread all reading and seeking from the same file. If you&#39;re not using an SSD then the physical disk-heads have to move back and forth with each thread context switch. Try to read the full file into memory first, and then use the threads to do what they need from the in-memory buffer."}, {"owner": {"reputation": 15, "user_id": 3972677, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad02341e08c09d7a701993d34ed75619?s=128&d=identicon&r=PG&f=1", "display_name": "Sem William Cersosimo", "link": "https://stackoverflow.com/users/3972677/sem-william-cersosimo"}, "reply_to_user": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 0, "creation_date": 1503498999, "post_id": 45842660, "comment_id": 78643154, "body": "@Joe i run it on 48 Cores server"}, {"owner": {"reputation": 15, "user_id": 3972677, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad02341e08c09d7a701993d34ed75619?s=128&d=identicon&r=PG&f=1", "display_name": "Sem William Cersosimo", "link": "https://stackoverflow.com/users/3972677/sem-william-cersosimo"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1503499029, "post_id": 45842660, "comment_id": 78643186, "body": "@Someprogrammerdude i&#39;m using SSDs"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1503499170, "post_id": 45842660, "comment_id": 78643305, "body": "Also, why is each thread reading the processing the <i>whole</i> file? What is then the purpose of the threads if they all do the same work on the same data? Furthermore, each thread also write to the same output file, overwriting each others data."}, {"owner": {"reputation": 15, "user_id": 3972677, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad02341e08c09d7a701993d34ed75619?s=128&d=identicon&r=PG&f=1", "display_name": "Sem William Cersosimo", "link": "https://stackoverflow.com/users/3972677/sem-william-cersosimo"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1503499249, "post_id": 45842660, "comment_id": 78643386, "body": "@Someprogrammerdude exactly the thing i want to avoid but i m not good with multithreading"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1503499504, "post_id": 45842660, "comment_id": 78643606, "body": "For a possible solution to my latest comment, again you should probably read the whole file into memory (like you do now) but only <i>once</i>, before you start the threads. Then you divide the data into <code>num_threads</code> chunks, and have each thread only calculate the checksum of that chunk only. Save the output to memory and collate it later and write the result. <b><i>However</i></b> this only works if the lines are all the same length so the data could be split evenly. If each lines length varies you have to use some other algorithm to split the data into chunks."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1503506003, "post_id": 45842660, "comment_id": 78648165, "body": "Remember that there is execution overhead of creating and scheduling threads.  You may not see significant performance improvement using threads here because the OS needs to schedule execution of the threads on one or more cores (along with all the other tasks running).  The multi-thread solution is to have one thread reading the data, while another thread performs the calculations on the data.  You may want give the reader thread a head start since reading a file is slower than calculating from memory."}], "answers": [{"tags": [], "owner": {"reputation": 1006, "user_id": 2946671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e7c2518ce2cf7ed64ce3e73464b728b?s=128&d=identicon&r=PG&f=1", "display_name": "N00byEdge", "link": "https://stackoverflow.com/users/2946671/n00byedge"}, "is_accepted": false, "score": 0, "last_activity_date": 1503499635, "creation_date": 1503499635, "answer_id": 45842976, "question_id": 45842660, "link": "https://stackoverflow.com/questions/45842660/multithreaded-md5-hashing/45842976#45842976", "title": "Multithreaded MD5 Hashing", "body": "<p>What you see here is that all the threads are reading the same file and doing the same work. This results in that the file has to be read <code>num_threads</code> times, probably causing a slowdown of about <code>num_threads</code> (since file I/O probably is on the critical path) or maybe even more because of more cache misses.</p>\n\n<p>You could try reading the entire file into memory, splitting it up between your threads and then having each thread process a subset of that files content.</p>\n"}], "owner": {"reputation": 15, "user_id": 3972677, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad02341e08c09d7a701993d34ed75619?s=128&d=identicon&r=PG&f=1", "display_name": "Sem William Cersosimo", "link": "https://stackoverflow.com/users/3972677/sem-william-cersosimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 892, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503499635, "creation_date": 1503498808, "question_id": 45842660, "link": "https://stackoverflow.com/questions/45842660/multithreaded-md5-hashing", "title": "Multithreaded MD5 Hashing", "body": "<p>i'm trying to multithread a program wich take word from file then hash these and write to another.</p>\n\n<p>If i make it without multithreading it's really fast, it's able to use only 15-20% of the CPU and has out like 300.000line/s</p>\n\n<p>But when i tryied with multithreading it only slow down and start to hash only at 17000lines/s, can you please help me?</p>\n\n<p>Thanks</p>\n\n<pre><code>#include &lt;iostream&gt;     // std::cout, std::streambuf, std::streamsize\n#include &lt;fstream&gt;      // std::ifstream\n#include &lt;string&gt;\n#include &lt;thread&gt;\n#include \"md5.h\"\n\nusing namespace std;\n\nstatic const int num_threads = 10;\n\nvoid call_from_thread(int tid) {\n    cout &lt;&lt; \"Launched by thread \" &lt;&lt; tid &lt;&lt; std::endl;\n    int cl = 0;\n    int uscita = 0;\n    int parole = 0;\n    char* contents;\n    ifstream istr(\"test.txt\");\n\n    if (istr) {\n        streambuf * pbuf = istr.rdbuf();\n        streamsize size = pbuf-&gt;pubseekoff(0, istr.end);\n        pbuf-&gt;pubseekoff(0, istr.beg);       // rewind\n        contents = new char[size];\n        pbuf-&gt;sgetn(contents, size);\n        istr.close();\n\n        ofstream myfile;\n        myfile.open(\"out.txt\");\n\n        do {\n            string prova(\"\");\n            uscita = 0;\n            do {\n                if (contents[cl] == '\\n') {\n                    uscita = 1;\n                }\n                prova += contents[cl];\n                cl += 1;\n            } while (uscita != 1);\n            parole += 1;\n            //cout &lt;&lt; prova &lt;&lt; \":\" &lt;&lt; md5(prova) &lt;&lt; endl;\n            myfile &lt;&lt; prova &lt;&lt; \":\" &lt;&lt; md5(prova) &lt;&lt; endl;\n        } while (parole != 9586054);\n\n        myfile.close();\n    }\n}\n\nint main()\n{\n\n    thread t[num_threads];\n\n    //Launch a group of threads\n    for (int i = 0; i &lt; num_threads; ++i) {\n        t[i] = thread(call_from_thread, i);\n    }\n\n    cout &lt;&lt; \"Launched from the main\\n\";\n\n    //Join the threads with the main thread\n    for (int i = 0; i &lt; num_threads; ++i) {\n        t[i].join();\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "zeromq"], "comments": [{"owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 2, "creation_date": 1503499223, "post_id": 45842514, "comment_id": 78643364, "body": "The subscriber must run first as part of the documentation/example and then the publisher. Add a delay between the start of the subscriber thread and the start of the publisher thread see if that makes a difference. You can add some proper synchronisation after. Set your bind like this as well please: &quot;tcp://*:58951&quot;"}, {"owner": {"reputation": 913, "user_id": 1849975, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5a2ae9703546a8bfed6b4d464b056481?s=128&d=identicon&r=PG", "display_name": "carobnodrvo", "link": "https://stackoverflow.com/users/1849975/carobnodrvo"}, "reply_to_user": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 0, "creation_date": 1503499559, "post_id": 45842514, "comment_id": 78643653, "body": "Hi, I just managed to solve this problem... This is called &quot;slow joiner&quot; and is described <a href=\"http://zguide.zeromq.org/page:all\" rel=\"nofollow noreferrer\">here</a> in detail. In short: it takes some time for the TCP handshake to finish, thus establishing the connection. But you were absolutly right."}, {"owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 1, "creation_date": 1503499633, "post_id": 45842514, "comment_id": 78643701, "body": "This could be solved by providing a suitable sync mechansicm between the start of the sub and pub."}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 1, "creation_date": 1503523803, "post_id": 45842514, "comment_id": 78657311, "body": "There are more tasks under the hood of the <code>.context( nIoThreads )</code> instance, than just the noted TCP-related ones. One ought read the API, and about proper releasing of resources ( termination of sockets and context instance ), why one ought always setup a preventive value of a <code>.setsockopt( zmq.LINGER, 0 )</code> for each socket instances. Worth reading, if one is serious into going distributed. +Not all ZeroMQ versions operate the same way the topic-filtering, so if one sides subscribes to something, the filtering may take place on the PUB-side, for which even more <b><i>&quot;temportisation</i></b>&quot; needed.."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 3, "creation_date": 1503524287, "post_id": 45843826, "comment_id": 78657505, "body": "Starting with tweaking <code>ZMQ_RCVTIMEO</code> is an escape from proper designer&#39;s work. There is both an explicitly non-blocking <code>.recv()</code>-call syntax and also a <code>.poll()</code>-instrumentation, for not having a need to use ( principally bad ) practice of blocking. Professional-grade distributed-computing systems ought never block ( due to many obvious reasons - the code being totally out-of-control during the whole duration, potentially infinite, of the blocking-state etc ), so rather do not replicate any schoolbook examples, where the code-designer was easy and withing some space-limits for a few SLOCs."}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 0, "creation_date": 1503524641, "post_id": 45843826, "comment_id": 78657658, "body": "Having been an RTOS-expert, this ought sound clear and sound to your ears :o)"}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "reply_to_user": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 0, "creation_date": 1503525107, "post_id": 45843826, "comment_id": 78657862, "body": "Yes, there are way better pattern for a distributed PUB / SUB system. I just tried to emphasize the slow joiner property while staying as close as OP&#39;s example. You are absolutly right :). But for a trivial example of a threaded PUB / SUB, it seems good enough."}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 0, "creation_date": 1503525273, "post_id": 45843826, "comment_id": 78657946, "body": "Might be also interested, that not only the slow-join is the problem, also the uncertainty about the topic-filter processing ( one could hardly tell in newer versions, which side is going to handle the topic-filter processing ... )"}], "tags": [], "owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "is_accepted": true, "score": 3, "last_activity_date": 1503502049, "creation_date": 1503502049, "answer_id": 45843826, "question_id": 45842514, "link": "https://stackoverflow.com/questions/45842514/zeromq-sub-never-receives-messages/45843826#45843826", "title": "ZeroMQ SUB never receives messages", "body": "<p>Based on your example, the following code works for me.\nThe problem is that the PUB / SUB pattern is a slow joiner, meaning you need to wait a while after binding the PUB socket and before sending any message.</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;zmq.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\nvoid startPublisher()\n{\n    zmq::context_t zmq_context(1);\n    zmq::socket_t zmq_socket(zmq_context, ZMQ_PUB);\n    zmq_socket.bind(\"tcp://127.0.0.1:58951\");\n    usleep(100000); // Sending message too fast after connexion will result in dropped message\n    zmq::message_t msg(3);\n    for(int i = 0; i &lt; 10; i++) {\n        memcpy(msg.data(), \"abc\", 3);\n        zmq_socket.send(msg); // &lt;-- always true\n        msg.rebuild(3);\n        usleep(1); // Temporisation between message; not necessary\n    }\n}\nvolatile bool run = false;\nvoid startSubscriber()\n{\n    zmq::context_t zmq_context(1);\n    zmq::socket_t zmq_socket(zmq_context, ZMQ_SUB);\n    zmq_socket.connect(\"tcp://127.0.0.1:58951\");\n    std::string TOPIC = \"\";\n    zmq_socket.setsockopt(ZMQ_SUBSCRIBE, TOPIC.c_str(), TOPIC.length()); // allow all messages\n    zmq_socket.setsockopt(ZMQ_RCVTIMEO, 1000); // Timeout to get out of the while loop\n    while(run) {\n        zmq::message_t msg;\n        int rc = zmq_socket.recv(&amp;msg);  // Works fine\n        if(rc) // Do no print trace when recv return from timeout\n            std::cout &lt;&lt; std::string(static_cast&lt;char*&gt;(msg.data()), msg.size()) &lt;&lt; std::endl;\n    }\n}\nint main() {\n    run = true;\n    std::thread t_sub(startSubscriber);\n    sleep(1); // Slow joiner in ZMQ PUB/SUB pattern\n    std::thread t_pub(startPublisher);\n    t_pub.join();\n    sleep(1);\n    run = false;\n    t_sub.join();\n}\n</code></pre>\n"}], "owner": {"reputation": 913, "user_id": 1849975, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5a2ae9703546a8bfed6b4d464b056481?s=128&d=identicon&r=PG", "display_name": "carobnodrvo", "link": "https://stackoverflow.com/users/1849975/carobnodrvo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 1, "accepted_answer_id": 45843826, "answer_count": 1, "score": 3, "last_activity_date": 1503524486, "creation_date": 1503498426, "last_edit_date": 1503524486, "question_id": 45842514, "link": "https://stackoverflow.com/questions/45842514/zeromq-sub-never-receives-messages", "title": "ZeroMQ SUB never receives messages", "body": "<p>I am having trouble with a <strong><code>PUB/SUB</code></strong> in ZeroMQ.</p>\n\n<p>After connecting everything, publisher publishes all messages ( socket's send message returns <code>true</code> ) but the <code>SUB</code> never receives them and blocks forever on <code>.recv()</code> function.</p>\n\n<p>Here is the code I am using:</p>\n\n<pre><code>void startPublisher()\n{\n    zmq::context_t zmq_context(1);\n    zmq::socket_t zmq_socket(zmq_context, ZMQ_PUB);\n    zmq_socket.bind(\"tcp://127.0.0.1:58951\");\n\n    zmq::message_t msg(3);\n    memcpy(msg.data(), \"abc\", 3);\n\n    for(int i = 0; i &lt; 10; i++)\n        zmq_socket.send(msg); // &lt;-- always true\n}\n\nvoid startSubscriber()\n{\n    zmq::context_t zmq_context(1);\n    zmq::socket_t zmq_socket(zmq_context, ZMQ_SUB);\n\n    zmq_socket.connect(\"tcp://127.0.0.1:58951\");\n    zmq_socket.setsockopt(ZMQ_SUBSCRIBE, \"\", 0); // allow all messages\n\n    zmq::message_t msg(3);\n    zmq_socket.recv(&amp;msg); // &lt;-- blocks forever (message never received?)\n}\n</code></pre>\n\n<p>Please note that I am runing these 2 functions in two different threads, starting <code>SUB</code> thread first, waiting for some time and then starting publisher thread ( also tried other way around with publisher sending messages in an endless-loop, but didn't work ).</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1503498333, "post_id": 45842422, "comment_id": 78642534, "body": "Why not construct the vector from the iterators and then <code>resize</code> the vector to the final size you want?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503498525, "post_id": 45842422, "comment_id": 78642712, "body": "What happens if the total length of <code>a1</code> and <code>a2</code> exceeds 20?  What do you do with the excess elements?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1503498701, "post_id": 45842422, "comment_id": 78642879, "body": "Note: if all want to do is concatenate two vectors, then see <a href=\"https://stackoverflow.com/questions/3177241/what-is-the-best-way-to-concatenate-two-vectors\" title=\"what is the best way to concatenate two vectors\">stackoverflow.com/questions/3177241/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7697850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6925ad3d7c28d729ddb6d297292cd0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Susanth", "link": "https://stackoverflow.com/users/7697850/susanth"}, "edited": false, "score": 0, "creation_date": 1503685304, "post_id": 45842464, "comment_id": 78734095, "body": "I hope the second argument is a1.end(). And we need to repeat the same for copying a2."}], "tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": false, "score": 3, "last_activity_date": 1503692893, "last_edit_date": 1503692893, "creation_date": 1503498332, "answer_id": 45842464, "question_id": 45842422, "link": "https://stackoverflow.com/questions/45842422/keeping-the-same-vector-throughout-the-function-for-additions-and-deletions/45842464#45842464", "title": "keeping the same vector throughout the function for additions and deletions", "body": "<p>If you want to copy things, you can use <a href=\"http://en.cppreference.com/w/cpp/algorithm/copy\" rel=\"nofollow noreferrer\"><code>std:copy</code></a>:</p>\n\n<pre><code>std::copy(a1.begin(), a1.end(), b1.begin());\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7697850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6925ad3d7c28d729ddb6d297292cd0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Susanth", "link": "https://stackoverflow.com/users/7697850/susanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503692893, "creation_date": 1503498205, "question_id": 45842422, "link": "https://stackoverflow.com/questions/45842422/keeping-the-same-vector-throughout-the-function-for-additions-and-deletions", "title": "keeping the same vector throughout the function for additions and deletions", "body": "<p>I am creating a vector b1 with fixed size (like c-style array), for copying a1 followed a2.\nI thought of using assign as below, But size of b1 is reduced to 7(to size of a1) after b1.assign(). How can I keep the b1 size 20 (fixed size) even after assign().\nAny suggestions, I am using memcpy() now. </p>\n\n<pre><code>std::vector&lt;int&gt; a1{1,2,3,4,5,6,7};\nstd::vector&lt;int&gt; a2{ 10,11,12,13,14,15,16,17 };\nstd::vector&lt;int&gt; b1(20);\nb1.assign(a1.begin(),a1.end());\n</code></pre>\n"}, {"tags": ["c++", "filter", "pcap"], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 6770249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451c0eb5e676ea8dc2c5dd297db8d136?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Toffolo", "link": "https://stackoverflow.com/users/6770249/lee-toffolo"}, "is_accepted": true, "score": 0, "last_activity_date": 1503592305, "last_edit_date": 1503592305, "creation_date": 1503503046, "answer_id": 45844170, "question_id": 45842275, "link": "https://stackoverflow.com/questions/45842275/how-to-filter-by-ip-with-pcap-h-c/45844170#45844170", "title": "How to filter by ip with pcap.h c++", "body": "<p>The Data array from the pcap_next_ex() call will contain the raw packet bytes (<a href=\"http://www.tcpdump.org/manpages/pcap_next_ex.3pcap.html\" rel=\"nofollow noreferrer\">pcap_next_ex man</a>). You need to find the index of the field that contains the IPAddress you are trying to filter out (most likely the IPv4 source or destination address field.)</p>\n\n<p>Unless you are dealing with a non-ipv4 case you should have packets where the layers are (generalized): MAC, IPv4, protocol, payload. The MAC layer will consist of 14-bytes, this will be added to any index. And the IPv4 layer should look like <a href=\"https://www.google.com/imgres?imgurl=http://mars.netanya.ac.il/~unesco/cdrom/booklet/HTML/NETWORKING/IMAGES/ipheader.gif&amp;imgrefurl=http://mars.netanya.ac.il/~unesco/cdrom/booklet/HTML/NETWORKING/node020.html&amp;h=448&amp;w=762&amp;tbnid=sskkJZUATtVMOM:&amp;tbnh=123&amp;tbnw=211&amp;usg=__Tfoan3Bqub2BlsD0gN2BJCP_QM4=&amp;vet=10ahUKEwjph5Sr1u3VAhWix4MKHVY1BrQQ9QEILDAA..i&amp;docid=WO5-O7QwvkAtpM&amp;sa=X&amp;ved=0ahUKEwjph5Sr1u3VAhWix4MKHVY1BrQQ9QEILDAA\" rel=\"nofollow noreferrer\">this</a>. The last two fields you see are the src and dst IPAddresses. Thus take whichever index value you need, account for the 14-bytes in the MAC, and then extract the necessary bytes (4 for an IP) from this index. Use any Network-to-Host conversions, and now you got yourself an IP that can be compared to your filter value.</p>\n\n<p>Note: This is a generalized way to filter ipv4 packets. If you want an \"all traffic via an ip\",  including such protocols as ARP or ICMP you will need to take a look at those protocol structures and find the appropriate byte index of the defined  IP. It will be similar to the above in concept.</p>\n"}], "owner": {"reputation": 27, "user_id": 8433957, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5245f28831d017e91eec8f4dc575f820?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Trigo Ros&#243;n", "link": "https://stackoverflow.com/users/8433957/alejandro-trigo-ros%c3%b3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 45844170, "answer_count": 1, "score": 0, "last_activity_date": 1503592305, "creation_date": 1503497745, "question_id": 45842275, "link": "https://stackoverflow.com/questions/45842275/how-to-filter-by-ip-with-pcap-h-c", "title": "How to filter by ip with pcap.h c++", "body": "<p>I'm trying to select a group of packages of a pcap file with c++. The criteria is the IP. \nThe code of the pcap reader:</p>\n\n<pre><code>readPcap()\n{\n\n  //Filter packages with ip = 192.168.15.40\n  std::vector&lt;std::string&gt; rmc;\n  std::string path = \"../../imu10000.pcap\";\n  char errbuff[PCAP_ERRBUF_SIZE];\n  pcap_t *pcap = pcap_open_offline(path.c_str(), errbuff);\n  struct pcap_pkthdr *header;\n  const unsigned char *data;\n\n  while (int returnValue = pcap_next_ex(pcap, &amp;header, &amp;data) &gt;= 0)\n  {\n    if (header-&gt;len != header-&gt;caplen)\n        printf(\"Warning! Capture size different than packet size: %d bytes\\n\", header-&gt;len);\n\n    // We also have a function that does this similarly below: PrintData()\n    for (u_int i=0; (i &lt; header-&gt;caplen ) ; i++)\n    {\n        // Start printing on the next after every 16 octets\n        if ( (i % 16) == 0) printf(\"\\n\");\n\n        // Print each octet as hex (x), make sure there is always two characters (.2).\n        printf(\"%.2x \", data[i]);\n    }\n  }\n}\n</code></pre>\n\n<p>By the moment, the code is printing all the body of all the packages in hex, but i have 10,000 packages in the file and half of them are from other IP.</p>\n\n<p>Do you know how to filter by IP so I can read only the packages I need?</p>\n\n<p>If you know another way for reading pcap files and filtering them, it will also be welcome.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "vector", "parent", "hierarchy"], "comments": [{"owner": {"reputation": 14960, "user_id": 135862, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a5a2dd5f01a60b5953b09002ae6a344b?s=128&d=identicon&r=PG", "display_name": "Adi Shavit", "link": "https://stackoverflow.com/users/135862/adi-shavit"}, "edited": false, "score": 0, "creation_date": 1503497805, "post_id": 45842208, "comment_id": 78642097, "body": "Smart pointer would probably be best so it is all cleaned up automatically. However, if your hierarchy is <i>VERY</i> deep you might get a stack-overflow in the destructors. In that case you will need to release everything &quot;manually&quot; like you showed."}, {"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "reply_to_user": {"reputation": 14960, "user_id": 135862, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a5a2dd5f01a60b5953b09002ae6a344b?s=128&d=identicon&r=PG", "display_name": "Adi Shavit", "link": "https://stackoverflow.com/users/135862/adi-shavit"}, "edited": false, "score": 0, "creation_date": 1503498083, "post_id": 45842208, "comment_id": 78642313, "body": "Also, because the destroy function is recursive, and I only need to remove the parent&#39;s reference once at the very highest level, that means that I need to make one function to remove the reference, and another to do the recursive deletes, right? That would probably be three functions, one removeReferenceAndDestroy, and in that one removeReference, and then do the recursive destroy(). There&#39;s no more elegant way?"}, {"owner": {"reputation": 14960, "user_id": 135862, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a5a2dd5f01a60b5953b09002ae6a344b?s=128&d=identicon&r=PG", "display_name": "Adi Shavit", "link": "https://stackoverflow.com/users/135862/adi-shavit"}, "edited": false, "score": 0, "creation_date": 1503498283, "post_id": 45842208, "comment_id": 78642493, "body": "If stack overflow <i>is</i> a realistic problem (it will also happen for regular hierarchy recursive traversal) then its actually <i>not</i> like you showed, you need to do it without recursion but with loops."}, {"owner": {"reputation": 14960, "user_id": 135862, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a5a2dd5f01a60b5953b09002ae6a344b?s=128&d=identicon&r=PG", "display_name": "Adi Shavit", "link": "https://stackoverflow.com/users/135862/adi-shavit"}, "edited": false, "score": 0, "creation_date": 1503498315, "post_id": 45842208, "comment_id": 78642520, "body": "Basically the smart pointer dtor will do what you did automatically."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1503498329, "post_id": 45842208, "comment_id": 78642530, "body": "If you have an <code>addChild</code> shouldn&#39;t you have a corresponding <code>removeChild</code> to have the parent do the cleanup? And to me <code>child-&gt;destroy()</code> seems to be what the destructor should do when invoked from <code>delete child</code> (but without the <code>delete this</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1503499099, "post_id": 45842575, "comment_id": 78643245, "body": "Thanks. It&#39;s interesting how most people tend to stay away from raw pointers, and how the trend of C++ is going. I guess it&#39;s a good thing for automatic cleanup, definitely much easier.  A vector of smart pointers is always an extra call, right? Upon destroying the vector each unique_pointer&#39;s destructor is called, which then calls delete on the object pointed to."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1503499309, "post_id": 45842575, "comment_id": 78643435, "body": "@Zebrafish You have to be careful. People stay away from <i>owning</i> raw pointers. My code contains both raw pointer member variables (generally a bad thing, but sometimes you need it), and a pointer being returned from a member variable. However, in both cases its a non-owning relationship. Note that in <code>addChild</code>, it would be better to check that <code>c</code> actually owns a <code>Window</code>, and throw if it doesn&#39;t. Then you can return a <code>Window&amp;</code> which is better as it can&#39;t be null (I can change the code if you&#39;re curious)."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1503499335, "post_id": 45842575, "comment_id": 78643458, "body": "@Zebrafish An extra call, relative to what? Your description is correct but I don&#39;t see how it could be faster if coded with manual rather than automatic cleanup."}, {"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1503501572, "post_id": 45842575, "comment_id": 78645179, "body": "When you std::make_unique&lt;Window&gt; it news a new window, how can it not contain a Window? Do you mean if the allocation failed? Also I&#39;m not understanding why returning a reference to a Window instead of a pointer makes a difference."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1503502130, "post_id": 45842575, "comment_id": 78645554, "body": "@Zebrafish I&#39;m not sure about your first comment. I said &quot;a class cannot contain itself&quot;. A Window does not have a Window member, but it can have a unique_ptr&lt;Window&gt; member. The unique_ptr has an indirection which makes this work. A reference is better because it can&#39;t be null, and it doesn&#39;t really make any sense to have null windows. Like if someone calls <code>root-&gt;addChild(std::unique_ptr&lt;Window&gt;{});</code>, you probably want that to throw an exception."}], "tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": false, "score": 1, "last_activity_date": 1503498891, "last_edit_date": 1503498891, "creation_date": 1503498562, "answer_id": 45842575, "question_id": 45842208, "link": "https://stackoverflow.com/questions/45842208/best-way-to-delete-parent-child-window-hierarchy/45842575#45842575", "title": "Best way to delete parent/child window hierarchy", "body": "<p>I think you are confusing yourself a bit. The following self contained example has no memory leaks:</p>\n\n<pre><code>#include &lt;utility&gt;\n#include &lt;vector&gt;\n#include &lt;memory&gt;\n\nusing std::vector;\nusing std::unique_ptr;\n\nstruct Window {\n    Window() = default;\n    vector&lt;unique_ptr&lt;Window&gt;&gt; children;\n    Window* parent = nullptr;\n    ~Window();\n\n    Window* addChild(std::unique_ptr&lt;Window&gt; c) {\n        c-&gt;parent = this;\n        children.push_back(std::move(c));\n        return children.back().get();\n    }\n};\n\nWindow::~Window() = default;\n\nint main() {\n    auto root = std::make_unique&lt;Window&gt;();\n    root-&gt;addChild(std::make_unique&lt;Window&gt;());\n    auto child = root-&gt;addChild(std::make_unique&lt;Window&gt;());\n    child-&gt;addChild(std::make_unique&lt;Window&gt;());\n};\n</code></pre>\n\n<p>A class cannot contain itself, but it can contain a <code>unique_ptr</code> to itself (or containers thereof). In this scheme, all of the recursive destruction happens correctly and automatically. You can dress this up in various ways of course but this is the basic idea.</p>\n\n<p>There are some other questions here of good object and class design and encapsulation, but that's another issue. Note: you should not have a method called <code>destroy</code> in the vast majority of cases, but that should instead happen in the destructor.</p>\n\n<p>It should basically never be necessary to write either new or delete in C++11 or greater, unless you are writing relatively low level code (like your own memory allocator).</p>\n\n<p>Live example: <a href=\"http://coliru.stacked-crooked.com/a/adef8cc40de4916a\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/adef8cc40de4916a</a></p>\n"}], "owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1503498891, "creation_date": 1503497585, "question_id": 45842208, "link": "https://stackoverflow.com/questions/45842208/best-way-to-delete-parent-child-window-hierarchy", "title": "Best way to delete parent/child window hierarchy", "body": "<p>I have a window system in a GUI, and I'm not sure about the destruction sequence. Each Window has a vector holding its children, and each also has a pointer to its parent:</p>\n\n<pre><code>auto root = new Window;\nroot-&gt;addChild(new Window);\nroot-&gt;addChild(new Window);\nauto child = root-&gt;addChild(new Window);  // Return value is the newly created Window\nchild-&gt;addChild(new Window);\nchild-&gt;addChild(new Window);\nauto grandchild = child-&gt;addChild(new Window);\ngrandchild-&gt;addChild(new Window);\ngrandchild-&gt;addChild(new Window);\ngrandchild-&gt;addChild(new Window);\n</code></pre>\n\n<p>// I want to delete the child pointer, first I need to erase the pointer of it from its parent's children vector.</p>\n\n<pre><code>child-&gt;parent-&gt;children.erase(child-&gt;parent-&gt;children.begin() + child-&gt;positionInParentsVector - 1);\n\nchild-&gt;destroy();\n\nvoid Window::destroy()\n{\n    if (children.size() == 0) delete this;\n    else for (auto i : children) i-&gt;destroy();\n}\n</code></pre>\n\n<p>OR with vectors of smart pointers, would it be sufficient to do:</p>\n\n<pre><code>// Remove reference of child from parent's children vector, then\n\ndelete child;\n</code></pre>\n\n<p>I have read that it is OK to do delete this. It's hard to get my head around this.</p>\n"}, {"tags": ["c++", "linux", "multithreading", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 5, "creation_date": 1503497307, "post_id": 45842038, "comment_id": 78641667, "body": "The question of whether a mutex is currently locked is pretty much meaningless, because it basically gives you no information about anything."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1503497469, "post_id": 45842038, "comment_id": 78641808, "body": "<a href=\"https://stackoverflow.com/q/21892934/841108\">stackoverflow.com/q/21892934/841108</a> is a very similar question."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1503498891, "post_id": 45842038, "comment_id": 78643060, "body": "What architecture are you running this on - x86? And how many sockets, and how many cores?"}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1503499397, "post_id": 45842038, "comment_id": 78643507, "body": "@Useless Thanks, I am running on x64 with an Intel Celeron with 1 socket with 4 cores."}, {"owner": {"reputation": 1241, "user_id": 8424429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9002f7998cce992a047bee84a5129c37?s=128&d=identicon&r=PG&f=1", "display_name": "curiousguy12", "link": "https://stackoverflow.com/users/8424429/curiousguy12"}, "edited": false, "score": 0, "creation_date": 1503518206, "post_id": 45842038, "comment_id": 78654759, "body": "@user2062604 Did you compile the code for those test runs with full optimization enabled ? - If not, you may want to try again"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1503726393, "post_id": 45842038, "comment_id": 78743788, "body": "Doing as you do is highly incompatible. <code>pthread_t</code> not required to be a pointer, as it is on the implementation you use. <code>pthread_t</code> is to be taken as an <a href=\"https://en.wikipedia.org/wiki/Opaque_data_type\" rel=\"nofollow noreferrer\">opaque data type</a>."}], "answers": [{"comments": [{"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "edited": false, "score": 0, "creation_date": 1503501767, "post_id": 45843238, "comment_id": 78645284, "body": "Thanks for the answer. I did not know that reads/writes up to 8 bytes properly aligned would always happen atomically - this answers my question."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "reply_to_user": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "edited": false, "score": 0, "creation_date": 1503502047, "post_id": 45843238, "comment_id": 78645486, "body": "@user2062604 Unfortunately it is incorrect. Compilers optimize assuming such a race condition can never happen and break your code. It is safe in x86-assembly, but not in C++. That C++ is converted to x86-assembly doesn&#39;t save you, compilers will produce incorrect x86-code."}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "edited": false, "score": 0, "creation_date": 1503502125, "post_id": 45843238, "comment_id": 78645548, "body": "@employee of the month I would like to separately note, however, that beyond answering my question, your three points about why the macros look &quot;bad&quot; are both irrelevant and misguided. If you use the macros I provided as checks to ensure that all multithreaded code is written correctly, then they are extremely useful. Either way, the additional points do not answer my question."}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1503502274, "post_id": 45843238, "comment_id": 78645658, "body": "@nwp If employee of the month&#39;s answer is incorrect, then what is the answer? Why is it apparently safe to do what I&#39;m doing?"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "reply_to_user": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "edited": false, "score": 1, "creation_date": 1503502367, "post_id": 45843238, "comment_id": 78645729, "body": "@user2062604 Because it is undefined behavior. Doing exactly what you want is allowed behavior for undefined behavior. It might just not do that all the time, depending on timing, architecture, compiler flags and position of the moon."}, {"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "edited": false, "score": 0, "creation_date": 1503502434, "post_id": 45843238, "comment_id": 78645778, "body": "perhaps his point is that in principle the compiler can generate any reads it wants, e.g. byte by byte which in turn loses the &#39;atomicity&#39; bit. this is part of why i said it is &#39;safe&#39; in quotes. there is probably a dedicated way in c++ to safely provide an atomic read."}, {"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "edited": false, "score": 0, "creation_date": 1503502779, "post_id": 45843238, "comment_id": 78646017, "body": "regarding 3 points, i strongly stand by them. for starters i mentioned that <i>typically</i> checking this stuff to decide the logic is wrong. i even gave an example. assertions are an excellent example of correct use of course, but you never said what you need these macros for"}], "tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": true, "score": 0, "last_activity_date": 1503500380, "creation_date": 1503500380, "answer_id": 45843238, "question_id": 45842038, "link": "https://stackoverflow.com/questions/45842038/is-it-safe-to-directly-read-owner-field-of-a-pthread-mutex/45843238#45843238", "title": "Is it safe to directly read owner field of a pthread mutex?", "body": "<p>it is 'safe' because reads and writes up to 8 bytes, aligned to the respective number of bytes, are atomic. assuming x86_64</p>\n\n<p>i don't know boost, but your macros look bad in 3 ways:</p>\n\n<ul>\n<li>you go for internal data layout which makes the thingy prone to api and abi breakage</li>\n<li>checks \"do i have the lock\" are almost always a design error (program logic should dictate whether you do, hence no need to check). besides accesses of the sort slow down the code under contention - another cpu could have dirtied the cacheline with the lock word, which you are now fetching for no good reason</li>\n<li>checks \"does someone have a lock\" are inhererently racy and typically wrong. if you want to grab the lock if it is available but fail otherwise, you can trylock</li>\n</ul>\n"}], "owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 45843238, "answer_count": 1, "score": 0, "last_activity_date": 1503500380, "creation_date": 1503497193, "question_id": 45842038, "link": "https://stackoverflow.com/questions/45842038/is-it-safe-to-directly-read-owner-field-of-a-pthread-mutex", "title": "Is it safe to directly read owner field of a pthread mutex?", "body": "<p>I have a question about the way in which I am using boost::mutex objects in my Linux C++ application. I have a collection of convenience macros for performing various mutex operations, for example I have macros that return whether or not a mutex is locked by any thread, whether or not one is already locked specifically by the calling thread, and several others. The macros that need to know what thread (if any) currently has the mutex locked are the following:</p>\n\n<pre><code>// Determine whether or not a boost mutex is already locked\n#define IsBoostMutexLocked(m) ((m.native_handle()-&gt;__data.__owner) != 0)\n\n// Determine whether or not a boost mutex is already locked by the calling thread\n#define IsBoostMutexLockedByCallingThread(m) ((m.native_handle()-&gt;__data.__owner) == (syscall(SYS_gettid)))\n</code></pre>\n\n<p>But I began to wonder whether or not it is safe to directly read the __owner int field. Could one thread not attempt to read the __owner field while another thread is busy locking or unlocking the mutex, thereby writing to the __owner field?</p>\n\n<p>So, I devised a test that would attempt to expose any data race vulnerabilities and abort if such a situation was detected. So far, I have had 100 threads all concurrently locking, unlocking, and reading the __owner of one global mutex for tens of millions of loop iterations per thread and not once have I ever read an invalid __owner value. Below I've included the entirety of the test code. Frankly I am surprised that I've never read a bad __owner value.</p>\n\n<p>Can anyone explain to me why it is (apparently) safe to directly read the __owner of a mutex even when other threads are trying to lock/unlock? Thanks in advance!</p>\n\n<pre><code>// The test mutex\nboost::mutex g_TestMutex;\n\n// The number of threads to launch for the test\n#define NUM_THREADS_TO_LAUNCH 100\n\n// The thread IDs of all test threads\nlong int g_AllSpecialThreadsTIDs[NUM_THREADS_TO_LAUNCH];\n\n// Whether or not each test thread is ready to begin the test\nstd::atomic&lt;bool&gt; g_bEachTestThreadIsReadyToBegin[NUM_THREADS_TO_LAUNCH];\n\n// Whether or not the test is ready to begin\nstd::atomic&lt;bool&gt; g_bTestReadyToBegin(false);\n\n// A structure that encapsulates data to be passed to each test thread\ntypedef struct {\n    long *pStoreTIDLoc; // A pointer to the variable at which to store the thread ID\n    std::atomic&lt;bool&gt; *pTIDStoredLoc; // A pointer to the variable at which to store the status of whether or not the thread ID has been set\n} TestThreadDataStructure;\n\n// Ensure that a test thread ID is valid\nvoid AssertIsValidTID(int iTID)\n{\n    // Whether or not this thread ID is valid\n    bool bValid = false;\n\n    // If the thread ID indicates that no-one has locked the mutex\n    if (iTID == 0)\n    {\n        // A thread ID indicating that no-one has locked the mutex is always valid\n        bValid = true;\n    }\n\n    // Or, if this is a non-zero thread ID\n    else\n    {\n        // For each test thread\n        for (int i = 0; i &lt; NUM_THREADS_TO_LAUNCH; i++)\n        {\n            // If this is a thread ID match\n            if (iTID == static_cast&lt;int&gt;(g_AllSpecialThreadsTIDs[i]))\n            {\n                // Set that the incoming thread ID is valid\n                bValid = true;\n\n                // Stop looking\n                break;\n            }\n        }\n    }\n\n    // If the incoming thread ID is invalid\n    if (!bValid)\n    {\n        // The test has failed\n        abort();\n    }\n}\n\n// Each test thread\nvoid TestMutexTesterThread(void *pArg)\n{\n    // Each mutex owner thread ID\n    int iOwner = 0;\n\n    // Unpack the incoming data structure\n    TestThreadDataStructure *pStruct = ((TestThreadDataStructure *)pArg);\n    long int *pStoreHere = pStruct-&gt;pStoreTIDLoc;\n    std::atomic&lt;bool&gt; *pTIDStoredLoc = pStruct-&gt;pTIDStoredLoc;\n\n    // Clean up\n    delete pStruct;\n    pStruct = NULL;\n    pArg = NULL;\n\n    // Get this thread ID\n    const long int lThisTID = syscall(SYS_gettid);\n\n    // Store this thread ID\n    (*pStoreHere) = lThisTID;\n\n    // Set that we have finished storing the thread ID\n    pTIDStoredLoc-&gt;store(true);\n\n    // While we are waiting for everything to be ready so that we can begin the test\n    while (true)\n    {\n        // If we are now ready to begin the test\n        if (g_bTestReadyToBegin.load())\n        {\n            // Stop waiting\n            break;\n        }\n    }\n\n    // The loop iteration count\n    uint64_t uCount = 0;\n\n    // For the life of the test, i.e. forever\n    while (true)\n    {\n        // Increment the count\n        uCount++;\n\n        // If we are about to go over the edge\n        if (uCount &gt;= (UINT64_MAX - 1))\n        {\n            // Reset the count\n            uCount = 0;\n        }\n\n        // Every so often\n        if ((uCount % 500000) == 0)\n        {\n            // Print our progress\n            printf(\"Thread %05ld: uCount = %lu\\n\", lThisTID, uCount);\n        }\n\n        // Get the mutex owner's thread ID\n        iOwner = g_TestMutex.native_handle()-&gt;__data.__owner;\n\n        // Ensure that this is a valid thread ID\n        AssertIsValidTID(iOwner);\n\n        // Lock the mutex as part of the test\n        g_TestMutex.lock();\n\n        // Get the mutex owner's thread ID\n        iOwner = g_TestMutex.native_handle()-&gt;__data.__owner;\n\n        // Ensure that this is a valid thread ID\n        AssertIsValidTID(iOwner);\n\n        // Unlock the mutex as part of the test\n        g_TestMutex.unlock();\n\n        // Get the mutex owner's thread ID\n        iOwner = g_TestMutex.native_handle()-&gt;__data.__owner;\n\n        // Ensure that this is a valid thread ID\n        AssertIsValidTID(iOwner);\n    }\n}\n\n// Start the test\nvoid StartTest()\n{\n    // For each thread to launch\n    for (int i = 0; i &lt; NUM_THREADS_TO_LAUNCH; i++)\n    {\n        // Initialize that we do not have a thread ID yet\n        g_AllSpecialThreadsTIDs[i] = 0;\n        g_bEachTestThreadIsReadyToBegin[i].store(false);\n    }\n\n    // For each thread to launch\n    for (int i = 0; i &lt; NUM_THREADS_TO_LAUNCH; i++)\n    {\n        // Allocate a data structure with which to pass data to each thread\n        TestThreadDataStructure *pDataStruct = new TestThreadDataStructure;\n\n        // Store the location at which the thread should place its thread ID\n        pDataStruct-&gt;pStoreTIDLoc = ((long int *)((&amp;(g_AllSpecialThreadsTIDs[i]))));\n\n        // Store the location of the atomic variable that each thread should set to true when it has finished storing its thread ID\n        pDataStruct-&gt;pTIDStoredLoc = ((std::atomic&lt;bool&gt; *)((&amp;(g_bEachTestThreadIsReadyToBegin[i]))));\n\n        // The thread to return\n        boost::thread *pNewThread = NULL;\n\n        // Launch the new thread\n        try { pNewThread = new boost::thread(TestMutexTesterThread, pDataStruct); }\n\n        // Catch errors\n        catch (boost::thread_resource_error &amp;ResourceError)\n        {\n            // Print this error\n            printf(\"boost::thread construction error: '%s'\", ResourceError.what());\n\n            // This is a fatal error\n            abort();\n        }\n\n        // Clean up\n        delete pNewThread;\n        pNewThread = NULL;\n    }\n\n    // Whether or not all threads are ready to begin\n    bool bAllThreadsReadyToBegin = false;\n\n    // While we are waiting for all threads to be ready to begin\n    while (true)\n    {\n        // Reset to assuming all threads are ready to begin\n        bAllThreadsReadyToBegin = true;\n\n        // For each thread we launched\n        for (int i = 0; i &lt; NUM_THREADS_TO_LAUNCH; i++)\n        {\n            // If this thread has not yet stored its thread ID\n            if (g_bEachTestThreadIsReadyToBegin[i].load() == false)\n            {\n                // We are not yet ready to begin\n                bAllThreadsReadyToBegin = false;\n\n                // Start over\n                break;\n            }\n        }\n\n        // If all threads are ready to begin\n        if (bAllThreadsReadyToBegin)\n        {\n            // We are done waiting\n            break;\n        }\n    }\n\n    // Atomically store that all threads are ready to begin and that the test should proceed\n    g_bTestReadyToBegin.store(true);\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "constexpr"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1503497787, "post_id": 45841822, "comment_id": 78642086, "body": "The question may not be an exact match of the dup I linked, but the answer is the same regardless. The class is incomplete."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1503498069, "post_id": 45841822, "comment_id": 78642301, "body": "@AndyG, It&#39;s understandable that <code>Bar</code> is not complete at that line but why is the nested class not considered complete?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1503498516, "post_id": 45841822, "comment_id": 78642704, "body": "@RSahu: I believe it has more to do with the fact that a nested class has access to the containing class. As such, it cannot be used in a static constexpr context from within the enclosing class. The C++17 standard is a bit more clear about it than C++11 IMO."}, {"owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "edited": false, "score": 0, "creation_date": 1503499004, "post_id": 45841822, "comment_id": 78643158, "body": "So the problem is not actually InnerFoo being incomplete? InnerFoo&#39;s closing &quot;}&quot; has passed at that point, thus by the excerpt from the standard that you give in the post you linked it should be considered complete at the point where inner_f should be initialized, right? I agree that there is a class that InnerFoo has access to which is not complete (namely Bar), but the standard does not say that this makes InnerFoo incomplete?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1503499326, "post_id": 45841822, "comment_id": 78643449, "body": "@LukasBarth: The problem is that <code>Bar</code> is not considered complete until the closing brace. Therefore any types that you define within it cannot be used in a <code>static constexpr</code> context inside."}], "owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "closed_date": 1503498391, "answer_count": 0, "score": 3, "last_activity_date": 1503496644, "creation_date": 1503496644, "question_id": 45841822, "link": "https://stackoverflow.com/questions/45841822/static-constexpr-member-of-an-inner-class", "closed_reason": "Duplicate", "title": "Static constexpr member of an inner class", "body": "<p>I'm trying to declare a static constexpr member, the type of which is an inner class. This inner class as a constexpr constructor so in my opinion, everything should be fine. But it isn't. In fact, when I move the inner class out of the containing class, everything works fine.</p>\n\n<p>This is a minimal example:</p>\n\n<pre><code>class Foo {\npublic:\n    constexpr Foo(int param) : i(param) {};\n    int i;\n};\n\nclass Bar {\npublic:\n    class InnerFoo {\n    public:\n        constexpr InnerFoo(int param) : i(param) {};\n        int i;\n    };\n\n    static constexpr Foo f { 1 };\n    static constexpr InnerFoo inner_f { 2 };\n}; \n\nint main() {\n    Bar b;\n}\n</code></pre>\n\n<p>The error messages of clang / gcc are not very helpful. Clang tells me: </p>\n\n<pre><code>16 : &lt;source&gt;:16:31: error: constexpr variable 'inner_f' must be initialized by a constant expression\n    static constexpr InnerFoo inner_f { 2 };\n                              ^~~~~~~~~~~~~\n16 : &lt;source&gt;:16:31: note: undefined constructor 'InnerFoo' cannot be used in a constant expression\n11 : &lt;source&gt;:11:19: note: declared here\n        constexpr InnerFoo(int param) : i(param) {};\n</code></pre>\n\n<p>I fail to see how the constructor is undefined? It's literally the same thing as for Foo(), and for Foo() it seems to be defined? The error message by gcc is slightly more helpful: </p>\n\n<pre><code>16 : &lt;source&gt;:16:43: error: 'constexpr Bar::InnerFoo::InnerFoo(int)' called in a constant expression before its definition is complete\n     static constexpr InnerFoo inner_f { 2 };\n</code></pre>\n\n<p>But how is the definition not yet 'complete'? Is the definition of a inner class's methods only 'complete' after the containing class has been completely declared? If so, is there any way of re-shuffeling the code so that I can have a static constexpr member of an inner class?</p>\n\n<p>Thanks,</p>\n\n<p>Lukas</p>\n"}, {"tags": ["c++", "java-native-interface", "variadic-functions", "jniwrapper"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503498132, "post_id": 45841763, "comment_id": 78642351, "body": "<code>va_list</code> and <code>va_start</code> are purely C++ inventions.  Not only that, different compilers implement each differently.  So your attempt would never work."}, {"owner": {"reputation": 2798, "user_id": 4478544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uPFEK.png?s=128&g=1", "display_name": "Zaboj Campula", "link": "https://stackoverflow.com/users/4478544/zaboj-campula"}, "edited": false, "score": 0, "creation_date": 1503503506, "post_id": 45841763, "comment_id": 78646538, "body": "see <a href=\"https://stackoverflow.com/questions/8880404/how-call-java-vararg-method-from-c-with-valist\" title=\"how call java vararg method from c with valist\">stackoverflow.com/questions/8880404/&hellip;</a>"}], "owner": {"reputation": 21, "user_id": 2915365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807ddb36764b3ed3d5131b4a1125143b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2915365/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1503496522, "creation_date": 1503496522, "question_id": 45841763, "link": "https://stackoverflow.com/questions/45841763/wrapper-function-for-jni-methodcall-in-c", "title": "Wrapper Function for JNI MethodCall in C++", "body": "<p>my question is: is there any good solution to write a wrapper function that recieves variable arguments, can use those arguments but can also pass them to any jni callmethod-function? I have already tried out stuff like variadic functions. I have managed to recieve variable arguments from functions but i have not managed to pass those variable arguments to any further jni method function. I realy can't find help on the Internet on this Topic. Hope you could help me.</p>\n\n<pre><code>void convertParameterString(JNIEnv *env,... ){\n  using namespace std;\n  va_list args;\n  va_start(args,env);\n\n  jclass cls2 = env-&gt;FindClass(\"CPPJava\");//de/xcc/jnitest/JNITest\");  // try to find the class \n   if(cls2 == nullptr) {\n       cerr &lt;&lt; \"ERROR: class not found !\";\n   }\n   else {                                  // if class found, continue\n\n\n       // rerun object construction and method call\n       jmethodID ctor = env-&gt;GetMethodID(cls2, \"&lt;init&gt;\", \"()V\");  // FIND AN OBJECT CONSTRUCTOR \n       if(ctor == nullptr) {\n           cerr &lt;&lt; \"ERROR: constructor not found !\" &lt;&lt; endl;\n       }\n       else {\n           cout &lt;&lt; \"Object succesfully constructed !\" &lt;&lt; endl;\n           jobject myo = env-&gt;NewObject(cls2, ctor);              // CREEATE OBJECT\n           if(myo) {                                     // IF OBJECT CREATED EXECUTE METHOD\n               jmethodID show = env-&gt;GetMethodID(cls2, \"getString\", \"(I)V\");\n\n               if(show == nullptr)\n                   cerr &lt;&lt; \"No showId method !!\" &lt;&lt; endl;\n               else env-&gt;CallVoidMethod(myo,show,args);\n               cout &lt;&lt; \"===End of call to java===========\" &lt;&lt; endl;\n           }\n       }\n   }                   \n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "c++11", "templates", "c++14", "variadic-templates"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1503496192, "post_id": 45841555, "comment_id": 78640741, "body": "Have a look at <code>std::index_sequence</code>."}], "answers": [{"tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": false, "score": 2, "last_activity_date": 1503497367, "creation_date": 1503497367, "answer_id": 45842124, "question_id": 45841555, "link": "https://stackoverflow.com/questions/45841555/map-variadic-template-arguments/45842124#45842124", "title": "Map Variadic Template Arguments", "body": "<pre><code>template &lt;class ... TSends, std::size_t ... Is&gt;\nGenericPublish__Advertise_impl(Node &amp;node, std::vector&lt;Publisher&gt; &amp;publishers,\n                               const std::vector&lt;std::string&gt;&amp; topics, std::index_sequence&lt;Is...&gt;)\n{\n    (void)int x[] = {(publishers.push_back(node.advertise&lt;TSends&gt;(topics.at(Is))), 0)...};\n} \n\n\ntemplate &lt;class ... TSends&gt;\nGenericPublish__Advertise((Node &amp;node, std::vector&lt;Publisher&gt; &amp;publishers,\n                               const std::vector&lt;std::string&gt;&amp; topics)\n{\n    GenericPublish__Advertise_impl(node, publishers, topics, std::index_sequence_for&lt;TSends...&gt;{});\n}\n</code></pre>\n\n<p>There's two tricks here which are pretty standard when you want to do some kind of indexing over a variadic pack. The first thing is that you delegate to an implementation function, passing it all the arguments, plus this <code>std::index_sequence</code> type. This lets the implementation function deduce a pack of integers which will be numbered 0 to N-1 a pack of size N. Second, you initialize an unused dummy array, and use the comma operator to discard the return (or lack thereof) of whatever you are doing, and simply return 0.</p>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 3, "last_activity_date": 1503497517, "creation_date": 1503497517, "answer_id": 45842178, "question_id": 45841555, "link": "https://stackoverflow.com/questions/45841555/map-variadic-template-arguments/45842178#45842178", "title": "Map Variadic Template Arguments", "body": "<p>The typical approach here is to use the <a href=\"http://en.cppreference.com/w/cpp/utility/integer_sequence\" rel=\"nofollow noreferrer\">index sequence</a> trick. You take a parameter pack of types, construct an index sequence of the same size, and then iterate over both:</p>\n\n<pre><code>template &lt;typename... TSends&gt; // &lt;== pack of types\nvoid GenericPublishAdvertise(Node &amp;node, std::vector&lt;Publisher&gt; &amp;publishers,\n                             const std::vector&lt;std::string&gt; &amp;topics)\n{\n  GenericPublishAdvertiseImpl&lt;TSends...&gt;(node, publishers, topics,\n      std::index_sequence_for&lt;TSends...&gt;()); // &lt;== index sequence creation\n}\n</code></pre>\n\n<p>with the separate implementation doing:</p>\n\n<pre><code>template &lt;typename... TSends, size_t... Is&gt;\nvoid GenericPublishAdvertiseImpl(Node &amp;node, std::vector&lt;Publisher&gt; &amp;publishers,\n    const std::vector&lt;std::string&gt; &amp;topics, std::index_sequence&lt;Is...&gt; )\n{\n    // since this is C++14\n    using swallow = int[];\n    (void)swallow{0,\n        (void(publishers.push_back(node.advertise&lt;TSends&gt;(topics.at(Is)))), 0)...\n        };\n\n    // in C++17, that's just\n    (publishers.push_back(node.advertise&lt;TSends&gt;(topics.at(Is))), ...);\n}\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/a/25683817/2069064\">this answer</a> for explanation of that pattern.</p>\n\n<hr />\n\n<p>Note that using <code>GenericPublish__Advertise</code> is UB: names with double underscores are reserved. </p>\n"}], "owner": {"reputation": 1080, "user_id": 2394327, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/6Va97.jpg?s=128&g=1", "display_name": "Mihai Galos", "link": "https://stackoverflow.com/users/2394327/mihai-galos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1132, "favorite_count": 0, "accepted_answer_id": 45842178, "answer_count": 2, "score": 0, "last_activity_date": 1503497517, "creation_date": 1503496029, "last_edit_date": 1503496957, "question_id": 45841555, "link": "https://stackoverflow.com/questions/45841555/map-variadic-template-arguments", "title": "Map Variadic Template Arguments", "body": "<p>In the following code, I would like to find a more generic way of calling GenericPublish__Advertise(), which takes a variadic template list. What could I do to improve it?</p>\n\n<p>I would like to map topics to a publisher of a specific type:</p>\n\n<ul>\n<li>topic[0] -> publisher[0]</li>\n<li>topic[1] -> publisher[1] </li>\n<li>so forth</li>\n</ul>\n\n<p>While the code works ok, I need to manually write the templated versions of GenericPublish__Advertise() and manually map topics[i] to publishers. I would like to somehow generalize the implementation of GenericPublish__Advertise().</p>\n\n<p>Many thanks in advance.</p>\n\n<p>Code:</p>\n\n<pre><code>    #include &lt;iostream&gt;\n    #include &lt;memory&gt;\n    #include &lt;typeinfo&gt;\n    #include &lt;vector&gt;\n\n    class AdvertiseOptionsBase {\n    public:\n      virtual const std::type_info &amp;GetType() = 0;\n    };\n\n    template &lt;typename TSend&gt; \n    class AdvertiseOptions : public AdvertiseOptionsBase {\n    public:\n      AdvertiseOptions(TSend opt) : opt_(opt) {}\n      const std::type_info &amp;GetType() { return typeid(opt_); }\n\n    private:\n      TSend opt_;\n    };\n\n    class Publisher {\n    public:\n      Publisher(const std::string &amp;topic) : topic_(topic) {}\n      const std::string &amp;GetTopic() const { return topic_; }\n      template &lt;typename TSend&gt;\n      void SetOptions(const AdvertiseOptions&lt;TSend&gt; &amp;opt) {\n        options_ = std::make_unique&lt;AdvertiseOptions&lt;TSend&gt;&gt;(opt);\n      }\n      const std::unique_ptr&lt;AdvertiseOptionsBase&gt; &amp;GetOptions() const {\n        return options_;\n      }\n\n    private:\n      std::string topic_;\n      std::unique_ptr&lt;AdvertiseOptionsBase&gt; options_;\n    };\n\n    class Node {\n    public:\n      template &lt;typename TSend&gt;\n      Publisher advertise(std::string topic) {\n        Publisher publisher(topic);\n        TSend option;\n        AdvertiseOptions&lt;TSend&gt; options(option);\n        publisher.SetOptions&lt;TSend&gt;(options);\n        return publisher;\n      }\n    };\n\n    template &lt;typename TSend1, typename TSend2&gt;\n    void GenericPublish__Advertise(Node &amp;node, std::vector&lt;Publisher&gt; &amp;publishers,\n                                   const std::vector&lt;std::string&gt; &amp;topics) {\n      publishers.push_back(node.advertise&lt;TSend1&gt;(topics.at(0)));\n      publishers.push_back(node.advertise&lt;TSend2&gt;(topics.at(1)));\n    }\n    template &lt;typename TSend1, typename TSend2, typename TSend3&gt;\n    void GenericPublish__Advertise(Node &amp;node, std::vector&lt;Publisher&gt; &amp;publishers,\n                                   const std::vector&lt;std::string&gt; &amp;topics) {\n      publishers.push_back(node.advertise&lt;TSend1&gt;(topics.at(0)));\n      publishers.push_back(node.advertise&lt;TSend2&gt;(topics.at(1)));\n      publishers.push_back(node.advertise&lt;TSend3&gt;(topics.at(2)));\n    }\n\n    template &lt;typename... TSend&gt;\n    class GenericPublish {\n    public:\n      GenericPublish(const std::vector&lt;std::string&gt; &amp;topics) {\n        GenericPublish__Advertise&lt;TSend...&gt;(node_, publishers_, topics);\n      }\n      void PrintInfo() {\n        for (const auto &amp;publisher : publishers_) {\n          std::cout &lt;&lt; publisher.GetTopic() &lt;&lt; \" -----&gt; \"\n                         &lt;&lt; (publisher.GetOptions()-&gt;GetType()).name() &lt;&lt; std::endl;\n        }\n      }\n\n    protected:\n      Node node_;\n      std::vector&lt;Publisher&gt; publishers_;\n\n    private:\n    };\n\n    int main() {\n      std::vector&lt;std::string&gt; topics({\"topic_int\", \"topic_double\"});\n      GenericPublish&lt;int, double&gt; o(topics);\n      o.PrintInfo();\n      return 0;\n    }\n</code></pre>\n"}, {"tags": ["c++", "makefile"], "comments": [{"owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "edited": false, "score": 0, "creation_date": 1503498953, "post_id": 45841544, "comment_id": 78643101, "body": "Typically <code>make</code> is used to <i>make</i> things, not run things (I&#39;m not a fan of side effects of make).   That being said, you want to be able to make your test or your regular build.    One note: you&#39;re always rebuilding your <code>.depend</code> file no matter what.  If this was a large project this would kill your build time.   A better practice is to have a target-specific objects directory, and then generate .d files in there for each source as you&#39;re compiling them.   This link: <a href=\"http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/]\" rel=\"nofollow noreferrer\">make.mad-scientist.net/papers/&hellip;</a> has a good description."}], "answers": [{"comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1503700757, "post_id": 45843225, "comment_id": 78740034, "body": "Just to clarify, this solution requires that <code>OBJECT_FILES</code> still be modified as a target-specific variable. (And I&#39;d be in favor of changing that, for the sake of clarity.)"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1503750022, "post_id": 45843225, "comment_id": 78749411, "body": "You&#39;re right, that was my bad.  Fixed to use automatic variables which is more correct anyway: with this you can avoid making OBJECT_FILES a target-specific variable."}], "tags": [], "owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "is_accepted": false, "score": 2, "last_activity_date": 1503749969, "last_edit_date": 1503749969, "creation_date": 1503500345, "answer_id": 45843225, "question_id": 45841544, "link": "https://stackoverflow.com/questions/45841544/adding-source-files-and-updating-dependencies-in-makefiles/45843225#45843225", "title": "Adding source files and updating dependencies in makefiles", "body": "<p>You cannot use target-specific variable values in prerequisite lists.  The GNU make manual is <a href=\"https://www.gnu.org/software/make/manual/html_node/Target_002dspecific.html\" rel=\"nofollow noreferrer\">very clear</a> about this:</p>\n\n<blockquote>\n  <p>The other exception is target-specific variable values. This feature allows you to define different values for the same variable, based on the target that make is currently building. <strong>As with automatic variables, these values are only available within the context of a target\u2019s recipe (and in other target-specific assignments).</strong></p>\n</blockquote>\n\n<p>(emphasis added).  You can add the test target specifically:</p>\n\n<pre><code>$(TESTTARGET): $(OBJECT_FILES) tests/tests.o\n        $(CXX) $(CXXFLAGS) -o $@ $^ $(LDLIBS)\n        ./dsptest\n</code></pre>\n\n<p>PS. I don't recommend using <code>$(subst ...)</code> to replace extensions; use <code>$(patsubst ...)</code> instead.</p>\n"}], "owner": {"reputation": 23, "user_id": 7533341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e10bd3c430c53f68283e104d573719?s=128&d=identicon&r=PG&f=1", "display_name": "Kunstmord", "link": "https://stackoverflow.com/users/7533341/kunstmord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1503749969, "creation_date": 1503495998, "question_id": 45841544, "link": "https://stackoverflow.com/questions/45841544/adding-source-files-and-updating-dependencies-in-makefiles", "title": "Adding source files and updating dependencies in makefiles", "body": "<p>I'm writing a (dynamic) library in C++, and have a set of tests for it. Currently, I'm working a makefile (default target) that can either build the library or build and run the tests (<code>test</code> target). The whole difference is in a couple of linker flags and whether or not a single <code>.cpp</code> file (containing <code>main</code>) is included, but I can't get the <code>test</code> target to build properly, since the dependency list does not get updated for some reason.\nHere's the whole makefile:</p>\n\n<pre><code>CXX = g++\nRM=rm -f\n\nEXTRA_CCFLAGS   = -Wall -Wextra -Wcast-qual -Wfloat-equal -Wpedantic -Wpointer-arith -Wshadow\nCXXOPTFLAGS     = -O2\nCXXFLAGS        = -std=c++11 $(EXTRA_CCFLAGS) $(CXXOPTFLAGS)\n\nLDLIBS=-larmadillo\nMAKELIBFLAGS=-current_version 0.1 -compatibility_version 0.1 -dynamiclib\n\nTARGET = libadsp.dylib\nTESTTARGET = dsptest\nSOURCE_FILES=src/stft.cpp src/filters.cpp src/windows.cpp src/helpers.cpp\nOBJECT_FILES=$(subst .cpp,.o,$(SOURCE_FILES))\n\nall: $(TARGET)\n\ntest: SOURCE_FILES += tests/tests.cpp\ntest: OBJECT_FILES = $(subst .cpp,.o,$(SOURCE_FILES))\ntest: $(TESTTARGET)\n\n$(TARGET): $(OBJECT_FILES)\n    $(CXX) $(CXXFLAGS) $(MAKELIBFLAGS) -o $(TARGET) $(OBJECT_FILES) $(LDLIBS)\n\n$(TESTTARGET): $(OBJECT_FILES)\n    $(CXX) $(CXXFLAGS) -o $(TESTTARGET) $(OBJECT_FILES) $(LDLIBS)\n    ./dsptest\n\ndepend: .depend\n\n.depend: $(SOURCE_FILES)\n    $(RM) ./.depend\n    $(CXX) $(CXXFLAGS) -MM $^&gt;&gt;./.depend;\n\n.PHONY: clean\n\nclean:\n    $(RM) $(OBJECT_FILES)\n    $(RM) ./.depend\n\ninclude .depend\n</code></pre>\n"}, {"tags": ["c++", "class", "pointers", "for-loop", "memory-management"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 5, "creation_date": 1503496162, "post_id": 45841543, "comment_id": 78640714, "body": "Check your boundaries. If you&#39;d started with a more moderate amount than 26 (like one or two) you would probably have noticed more animal chatter than expected."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1503496954, "post_id": 45841543, "comment_id": 78641372, "body": "And feel free to write <code>&#39;a&#39;</code> instead of <code>97</code>. There&#39;s no point in memorising unportable character encodings."}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 2, "last_activity_date": 1503496496, "last_edit_date": 1503496496, "creation_date": 1503496190, "answer_id": 45841628, "question_id": 45841543, "link": "https://stackoverflow.com/questions/45841543/c-problems-with-destructing-objects-after-iteration/45841628#45841628", "title": "c++ Problems with destructing objects after iteration", "body": "<p>Change</p>\n\n<pre><code>for (int i = 0; i &lt;= numberAnimals; i++, test++)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>for (int i = 0; i &lt; numberAnimals; i++, test++)\n</code></pre>\n\n<p>You are accessing outside of bounds which leads to undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 273, "user_id": 2480884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba68307bc6b4c769fc2d67ce24493f49?s=128&d=identicon&r=PG", "display_name": "Geek", "link": "https://stackoverflow.com/users/2480884/geek"}, "is_accepted": false, "score": 1, "last_activity_date": 1503496238, "creation_date": 1503496238, "answer_id": 45841648, "question_id": 45841543, "link": "https://stackoverflow.com/questions/45841543/c-problems-with-destructing-objects-after-iteration/45841648#45841648", "title": "c++ Problems with destructing objects after iteration", "body": "<p>Array elements are numbered from 0 to length-1, being 0 the first and length -1 the last; In C++, the first element in an array is always numbered with a zero (not a one) and the last element is length-1 (not length)</p>\n\n<p>modify your below code  </p>\n\n<pre><code>for (int i = 0; i &lt;= numberAnimals; i++, test++) {\n\n        string name(1, test);\n\n        pAnimal[i].setName(name);\n        pAnimal[i].speak();\n\n    }\n</code></pre>\n\n<p>to  </p>\n\n<pre><code>for (int i = 0; i &lt; numberAnimals; i++, test++) {\n\n        string name(1, test);\n\n        pAnimal[i].setName(name);\n        pAnimal[i].speak();\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8506402, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213835366466414/picture?type=large", "display_name": "Jim", "link": "https://stackoverflow.com/users/8506402/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 45841628, "answer_count": 2, "score": 1, "last_activity_date": 1503496704, "creation_date": 1503495996, "last_edit_date": 1503496704, "question_id": 45841543, "link": "https://stackoverflow.com/questions/45841543/c-problems-with-destructing-objects-after-iteration", "title": "c++ Problems with destructing objects after iteration", "body": "<p>I wrote this little test program, the problem is that the program terminates and crashes after the for loop. Can someone explain whats the cause?</p>\n\n<p><strong>What I want to accomplish</strong></p>\n\n<ol>\n<li>create pointer for Animal objects</li>\n<li>Allocate memory for 26 Animal objects</li>\n<li>Set the name for each Animal object to alphabet order a-z</li>\n<li>Display the name for each Animal object</li>\n<li>delete all the Allocated memory by calling the destructor</li>\n<li>exit main</li>\n</ol>\n\n<p><strong>Source</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Animal {\nprivate:\n    string name;\npublic:\n    Animal() {\n        cout &lt;&lt; \"Animal created.\" &lt;&lt; endl;\n    }\n    ~Animal() {\n        cout &lt;&lt; \"Animal destructor\" &lt;&lt; endl;\n    }\n\n    void setName(string name) {\n        this-&gt;name = name;\n    }\n    void speak() {\n        cout &lt;&lt; \"My name is: \" &lt;&lt; name &lt;&lt; endl;\n    }\n};\n\nint main() {\n\n    int numberAnimals = 26;\n\n    Animal *pAnimal = new Animal[numberAnimals];\n\n    char test = 97; // a\n\n\n    cout &lt;&lt; \"========================================================\" &lt;&lt; endl;\n\n    for (int i = 0; i &lt;= numberAnimals; i++, test++) {\n\n        string name(1, test);\n\n        pAnimal[i].setName(name);\n        pAnimal[i].speak();\n\n    }\n\n    cout &lt;&lt; \"========================================================\" &lt;&lt; endl;\n\n    delete[] pAnimal;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "allocator"], "answers": [{"tags": [], "owner": {"reputation": 14960, "user_id": 135862, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a5a2dd5f01a60b5953b09002ae6a344b?s=128&d=identicon&r=PG", "display_name": "Adi Shavit", "link": "https://stackoverflow.com/users/135862/adi-shavit"}, "is_accepted": false, "score": 1, "last_activity_date": 1503497505, "last_edit_date": 1503497505, "creation_date": 1503496153, "answer_id": 45841617, "question_id": 45841511, "link": "https://stackoverflow.com/questions/45841511/why-there-is-no-stduses-allocatorstdoptional/45841617#45841617", "title": "Why there is no std::uses_allocator&lt;std::optional&gt;?", "body": "<p>From the <a href=\"http://eel.is/c++draft/optional.optional#1\" rel=\"nofollow noreferrer\">Standard 23.6.3.1</a>:  </p>\n\n<blockquote>\n  <p><em>Implementations are not permitted to use additional storage, such as dynamic memory, to allocate its contained value.</em></p>\n</blockquote>\n\n<p>So there is no need for an allocator.</p>\n\n<p>Though the same is true for variant <a href=\"http://eel.is/c++draft/variant#variant-1\" rel=\"nofollow noreferrer\">23.7.3.1</a>:  </p>\n\n<blockquote>\n  <p><em>Implementations are not permitted to use additional storage, such as dynamic memory, to allocate the contained value.</em></p>\n</blockquote>\n\n<p>Apparently, the <code>uses_allocator</code> specialization for <code>std::variant</code> <a href=\"http://cplusplus.github.io/LWG/lwg-defects.html#2901\" rel=\"nofollow noreferrer\">was removed for C++17</a> (HT: @K-ballo!). </p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 5329481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebe6629b709854d5afc9ad8951e1766d?s=128&d=identicon&r=PG&f=1", "display_name": "draganm17", "link": "https://stackoverflow.com/users/5329481/draganm17"}, "edited": false, "score": 0, "creation_date": 1503496334, "post_id": 45841638, "comment_id": 78640860, "body": "a variant does not allocate memory as well."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 79, "user_id": 5329481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebe6629b709854d5afc9ad8951e1766d?s=128&d=identicon&r=PG&f=1", "display_name": "draganm17", "link": "https://stackoverflow.com/users/5329481/draganm17"}, "edited": false, "score": 0, "creation_date": 1503496580, "post_id": 45841638, "comment_id": 78641078, "body": "@draganm17 I have an unsupported feeling that this is due to the original implementation of variants, which did."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1503496626, "last_edit_date": 1503496626, "creation_date": 1503496214, "answer_id": 45841638, "question_id": 45841511, "link": "https://stackoverflow.com/questions/45841511/why-there-is-no-stduses-allocatorstdoptional/45841638#45841638", "title": "Why there is no std::uses_allocator&lt;std::optional&gt;?", "body": "<p>Because </p>\n\n<blockquote>\n  <p>If an optional contains a value, the value is guaranteed to be\n  allocated as part of the optional object footprint, i.e. no dynamic\n  memory allocation ever takes place. Thus, an optional object models an\n  object, not a pointer, even though the operator*() and operator->()\n  are defined.</p>\n</blockquote>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/utility/optional\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/utility/optional</a></p>\n\n<p>On the other hand, <code>std::variant</code> used to support allocators in earlier edition of the Standard, so I have the feeling this specialization is a remnant of those days.</p>\n"}], "owner": {"reputation": 79, "user_id": 5329481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebe6629b709854d5afc9ad8951e1766d?s=128&d=identicon&r=PG&f=1", "display_name": "draganm17", "link": "https://stackoverflow.com/users/5329481/draganm17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1503497505, "creation_date": 1503495894, "question_id": 45841511, "link": "https://stackoverflow.com/questions/45841511/why-there-is-no-stduses-allocatorstdoptional", "title": "Why there is no std::uses_allocator&lt;std::optional&gt;?", "body": "<p>There is an specialization of uses_allocator for std::variant, but not for std::optional. Why?</p>\n"}, {"tags": ["c++", "c++11", "overloading", "wrapper"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1503495773, "post_id": 45841427, "comment_id": 78640382, "body": "<code>auto greet = std::mem_fn(static_cast&lt;void (Foo::*)(int)&gt;(&amp;Foo::display_greeting));</code> Basically, you have to manually pick the correct overload."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1503495881, "post_id": 45841427, "comment_id": 78640464, "body": "<code>std::mem_fn&lt;void(int)&gt;(&amp;Foo::display_greeting);</code> to be a bit less verbose than a cast."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503495999, "post_id": 45841427, "comment_id": 78640568, "body": "I cant figure out how to call overload without arguments, it keep giving me errors."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503496236, "post_id": 45841427, "comment_id": 78640776, "body": "@FilipKo\u010dica - Like this <a href=\"https://ideone.com/igujxt\" rel=\"nofollow noreferrer\">ideone.com/igujxt</a>"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1503496461, "post_id": 45841427, "comment_id": 78640968, "body": "@FairyTailTeller thank you, it was in the calling <code>greet(f, 1);</code> sorry"}], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "closed_date": 1503495740, "answer_count": 0, "score": 1, "last_activity_date": 1503496023, "creation_date": 1503495679, "last_edit_date": 1503496023, "question_id": 45841427, "link": "https://stackoverflow.com/questions/45841427/using-stdmem-fn-generate-wrapper-object-for-overloaded-functions", "closed_reason": "Duplicate", "title": "Using std::mem_fn, generate wrapper object for Overloaded functions", "body": "<p>In this code:</p>\n\n<pre><code>struct Foo {\n    /*void display_greeting() {\n        std::cout &lt;&lt; \"Hello, world.\\n\";\n    }*/\n    void display_greeting(int i) {\n        std::cout &lt;&lt; \"Hello, world.Greeting #\" &lt;&lt; i &lt;&lt;std::endl;\n    }\n};\n\nint main() {\n    Foo f;\n\n    auto greet = std::mem_fn(&amp;Foo::display_greeting);\n    greet(f, 1);\n}\n</code></pre>\n\n<p>If I uncomment code for <code>display_greeting()</code>, the overload resolution fails at compile time giving error </p>\n\n<pre><code>no matching function for call to 'mem_fn(&lt;unresolved overloaded function type&gt;)'\nauto greet = std::mem_fn(&amp;Foo::display_greeting);\"\n                                   ^\n</code></pre>\n\n<p>How do I fix this issue, so that I can have both flavors of <code>display_greeting</code> func?</p>\n"}, {"tags": ["c++", "class", "constructor"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 4, "creation_date": 1503495541, "post_id": 45841330, "comment_id": 78640178, "body": "The error doesn&#39;t complain about the constructor, but about the assignment operator. Apparently, <code>detect::Wrapper</code> is not copy-assignable. That&#39;s why <code>detector = whatever;</code> doesn&#39;t work, regardless of what <code>whatever</code> is."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1503495602, "post_id": 45841330, "comment_id": 78640230, "body": "You could use <code>?:</code> instead of <code>if</code>/<code>else</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503495729, "post_id": 45841330, "comment_id": 78640341, "body": "Is your class move-constructible ? (it is already not move assignable)."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1503495755, "post_id": 45841330, "comment_id": 78640366, "body": "The error message is complaining about line 126 in your source code. The code you posted does not have 126 lines. Post the smallest example you can come up with that <b>reproduces the problem</b>. Don&#39;t leave it to readers to try to figure out what&#39;s missing and cobble toghether something that might or might not be the same as what you&#39;re looking at."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1503496046, "post_id": 45841330, "comment_id": 78640613, "body": "You could have simply declared a <code>detect::Wrapper*</code> and point to the <code>detect::Wrapper</code> that you&#39;ve created, then use the pointer from there on."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1503502606, "post_id": 45841330, "comment_id": 78645894, "body": "You could of course factor the common three calls out to a separate function and then only call <code>FindLoadAndRun(detector);</code> for each alternative. Cuts redundancy by 2/3."}], "answers": [{"comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1503496321, "post_id": 45841604, "comment_id": 78640842, "body": "Maybe worth mentioning that this comes with a runtime cost."}], "tags": [], "owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "is_accepted": false, "score": 1, "last_activity_date": 1503496138, "creation_date": 1503496138, "answer_id": 45841604, "question_id": 45841330, "link": "https://stackoverflow.com/questions/45841330/calling-overloaded-constructors-fails-in-if-statement/45841604#45841604", "title": "Calling overloaded constructors fails in if statement", "body": "<p>What you can do to avoid code duplication is using a pointer and circumvent the deleted assignment operator:</p>\n\n<pre><code>std::unique_ptr&lt;detect::Wrapper&gt; detector; // &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\nif (detectorFileNameSpecified){\n  detector = std::make_unique&lt;detect::Wrapper&gt;(detectorFileName,\n                                               saveImages,\n                                               learnOrDetect,\n                                               verbosity);\n}\nelse {\n  detector = std::make_unique&lt;detect::Wrapper&gt;(saveImages,\n                                               learnOrDetect,\n                                               verbosity);\n}\n\n// Note the -&gt; to dereference    \ndetector-&gt;setFind(findAlgNo);\ndetector-&gt;setLD(LDAlgNo);\n\ndetector-&gt;run();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1503503565, "creation_date": 1503503565, "answer_id": 45844350, "question_id": 45841330, "link": "https://stackoverflow.com/questions/45841330/calling-overloaded-constructors-fails-in-if-statement/45844350#45844350", "title": "Calling overloaded constructors fails in if statement", "body": "<p>By creating function:</p>\n\n<pre><code>void doJob(detect::Wrapper&amp;&amp; detector)\n{\n    detector.setFind(findAlgNo);\n    detector.setLD(LDAlgNo);\n\n    detector.run();\n}\n</code></pre>\n\n<p>You may then factorize your code to:</p>\n\n<pre><code>if (detectorFileNameSpecified){\n    doJob(detect::Wrapper(detectorFileName, saveImages, learnOrDetect, verbosity));\n} else {\n    doJob(detect::Wrapper(saveImages, learnOrDetect, verbosity));\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8220747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcefc6022ed25b7604874143f855a2ec?s=128&d=identicon&r=PG&f=1", "display_name": "Skyline_V", "link": "https://stackoverflow.com/users/8220747/skyline-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 45844350, "answer_count": 2, "score": 0, "last_activity_date": 1503503565, "creation_date": 1503495394, "question_id": 45841330, "link": "https://stackoverflow.com/questions/45841330/calling-overloaded-constructors-fails-in-if-statement", "title": "Calling overloaded constructors fails in if statement", "body": "<p>So I have an if statement that decides whether one or another constructor is called. This is the code that gives me the error:</p>\n\n<pre><code>detect::Wrapper detector;\n\nif (detectorFileNameSpecified){\n  detector = detect::Wrapper(detectorFileName,\n             saveImages,\n             learnOrDetect,\n             verbosity);\n}\nelse {\n  detector = detect::Wrapper(saveImages,\n             learnOrDetect,\n             verbosity);\n}\n\ndetector.setFind(findAlgNo);\ndetector.setLD(LDAlgNo);\n\ndetector.run();\n</code></pre>\n\n<p>g++ gives me these kinds of errors:</p>\n\n<pre><code>main.cpp:126:15: error: use of deleted function \u2018detect::Wrapper&amp; detect::Wrapper::operator=(detect::Wrapper&amp;&amp;)\u2019\n      verbosity);\n               ^\nIn file included from main.cpp:1:0:\nwrapper.hpp:14:9: note: \u2018detect::Wrapper&amp; detect::Wrapper::operator=(detect::Wrapper&amp;&amp;)\u2019 is implicitly deleted because the default definition would be ill-formed:\n   class Wrapper{\n         ^~~~~~~\n</code></pre>\n\n<p>However if I do it the naive way of creating redundant code it works perfectly.</p>\n\n<pre><code>if (detectorFileNameSpecified){\n      detect::Wrapper detector(detectorFileName,\n                   saveImages,\n                   learnOrDetect,\n                   verbosity);\n\n      detector.setFind(findAlgNo);\n      detector.setLD(LDAlgNo);\n\n      detector.run();\n    }\n    else {\n      detect::Wrapper detector(saveImages,\n                   learnOrDetect,\n                   verbosity);\n\n      detector.setFind(findAlgNo);\n      detector.setLD(LDAlgNo);\n\n      detector.run();\n    }\n</code></pre>\n\n<p>All I want to do is reduce the redundancy in my code and not have to write the .setFind() etc. part every time I need a different constructor. I'm not sure how to solve this.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 379, "user_id": 1011320, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e11690da53b1fa123830ea70f96f4f64?s=128&d=identicon&r=PG", "display_name": "ToniAz", "link": "https://stackoverflow.com/users/1011320/toniaz"}, "edited": false, "score": 0, "creation_date": 1503495170, "post_id": 45841178, "comment_id": 78639859, "body": "Thanks for the reply. I clearly said  &quot;of course, in this case the plus operator already accomplishes what the following code does.&quot;"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1503495231, "post_id": 45841178, "comment_id": 78639920, "body": "Well, if you could do this then option 2 is not an option as it would be a infinite recursive call."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1503495313, "post_id": 45841178, "comment_id": 78639986, "body": "<i>the plus operator already accomplishes</i> is something different to <i>you can&#39;t overload operators for built in types</i>, isnt it?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1503495371, "post_id": 45841178, "comment_id": 78640029, "body": "Don&#39;t use built-in types for illustrative purposes. That&#39;s just confusing. Use an enumeration instead. Then the code will make sense when coupled with the question."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1503495533, "post_id": 45841178, "comment_id": 78640167, "body": "Chance are the 2 will be compiled in same code after sufficient optimization flag."}, {"owner": {"reputation": 22622, "user_id": 148897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7u1oT.jpg?s=128&g=1", "display_name": "Henrik", "link": "https://stackoverflow.com/users/148897/henrik"}, "edited": false, "score": 2, "creation_date": 1503495680, "post_id": 45841178, "comment_id": 78640301, "body": "DRY and use Option 1, especially if it&#39;s a more complicated operation. If you&#39;re concerned about performance and the objects might be big, consider passing them as <code>const T&amp;</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1503496029, "post_id": 45841178, "comment_id": 78640600, "body": "Some advice: Don&#39;t worry about optimizing every line of code.  Write the code the is natural and easy to understand.  The compile with optimizations on and profile.  If the performance is acceptable then your done.  You&#39;d be surprised how much the compiler can optimize these days, especially if the code is not obscure."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1503503412, "post_id": 45841178, "comment_id": 78646460, "body": "What about Option 3: rename <code>int add(T a, T b)</code> to <code>int operator+(T lhs, T rhs)</code>?"}, {"owner": {"reputation": 379, "user_id": 1011320, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e11690da53b1fa123830ea70f96f4f64?s=128&d=identicon&r=PG", "display_name": "ToniAz", "link": "https://stackoverflow.com/users/1011320/toniaz"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1503590242, "post_id": 45841178, "comment_id": 78690780, "body": "@Caleth Backward compatibility. That would&#39;ve been the solution that made sense."}], "answers": [{"tags": [], "owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "is_accepted": true, "score": 1, "last_activity_date": 1503506671, "last_edit_date": 1503506671, "creation_date": 1503506321, "answer_id": 45845159, "question_id": 45841178, "link": "https://stackoverflow.com/questions/45841178/overloading-operator-body-contains-only-one-function-call/45845159#45845159", "title": "Overloading operator body contains only one function call", "body": "<p>Use option 1, do not repeat yourself. Make sure the compiler sees the definition of add when you define operator+ so it can inline the code. There will be absolutely no difference in the generated code when optimizations are turned on.</p>\n\n<pre><code>struct T\n{\n    int blah;\n};\n\nint add(T a, T b)\n{\n  return a.blah +b.blah;\n}\n\nint operator+(T lhs, T rhs)\n{\n  return add(lhs, rhs);\n}\n</code></pre>\n\n<p>GCC generates:</p>\n\n<pre><code>add(T, T):\n  lea eax, [rdi+rsi]\n  ret\noperator+(T, T):\n  lea eax, [rsi+rdi]\n  ret\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/g1ypni\" rel=\"nofollow noreferrer\">https://godbolt.org/g/g1ypni</a></p>\n\n<p>Clang and the Microsoft compiler generate the same code.</p>\n\n<p>If the code is more complex and the compiler refuses to inline <code>add</code> into <code>operator+</code>, consider making operator+ an inline function. Then it will get inlined since it does just one call and the caller will directly call <code>add</code> without additional overhead.</p>\n\n<p>The usual admonition: You should of course as always benchmark to see if there is any real difference and profile to see what is causing the difference, also look at the generated code to check whether optimizations are performed as you expect :-)</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1503506850, "creation_date": 1503506850, "answer_id": 45845292, "question_id": 45841178, "link": "https://stackoverflow.com/questions/45841178/overloading-operator-body-contains-only-one-function-call/45845292#45845292", "title": "Overloading operator body contains only one function call", "body": "<p>Option 1 is better as you are not duplicating code.</p>\n\n<p>Might be better still to pass T by constant reference to obviate a value copy.</p>\n"}], "owner": {"reputation": 379, "user_id": 1011320, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e11690da53b1fa123830ea70f96f4f64?s=128&d=identicon&r=PG", "display_name": "ToniAz", "link": "https://stackoverflow.com/users/1011320/toniaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 45845159, "answer_count": 2, "score": 0, "last_activity_date": 1503506850, "creation_date": 1503495012, "last_edit_date": 1503495421, "question_id": 45841178, "link": "https://stackoverflow.com/questions/45841178/overloading-operator-body-contains-only-one-function-call", "title": "Overloading operator body contains only one function call", "body": "<p>I have this function</p>\n\n<pre><code>int add(T a, T b)\n{\n  return a.blah +b.blah;\n}\n</code></pre>\n\n<p>And I want to overload the plus operator and I have to options (<em>of course, in this case the plus operator already accomplishes what the following code does</em>)</p>\n\n<p><strong>Option 1:</strong></p>\n\n<pre><code>int operator+(T lhs, T rhs)\n{\n  return add(a,b);\n}\n</code></pre>\n\n<p><strong>Option 2:</strong></p>\n\n<pre><code>int operator+(T lhs, T rhs)\n{\n  return a.blah+b.blah;\n}\n</code></pre>\n\n<p>Does any of those definitions have a performance edge over the other? Something to not is that the function I am trying to implement performs a more complicated operation on the elements of an STL container.</p>\n"}, {"tags": ["c++", "fstream"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1503495045, "post_id": 45841143, "comment_id": 78639744, "body": "Time to learn <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">how to debug small programs</a>."}, {"owner": {"reputation": 3963, "user_id": 1189656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf01748088cd4ae4c46fc0ce6bffcee?s=128&d=identicon&r=PG", "display_name": "ikkuh", "link": "https://stackoverflow.com/users/1189656/ikkuh"}, "edited": false, "score": 1, "creation_date": 1503495071, "post_id": 45841143, "comment_id": 78639771, "body": "The order of <code>while</code> and <code>for</code> seems wrong. You are reading 1 number and using that 10 times in the for loop."}, {"owner": {"reputation": 35, "user_id": 8288151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00b4e230fa801d89e262d2ed3d4c8c3?s=128&d=identicon&r=PG&f=1", "display_name": "introvertbustardxd", "link": "https://stackoverflow.com/users/8288151/introvertbustardxd"}, "edited": false, "score": 0, "creation_date": 1503495438, "post_id": 45841143, "comment_id": 78640087, "body": "As I know the <code>while (average  &gt;&gt; number)</code> is the same as <code>while (!average.eof())</code>...<code>getline</code>"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1503495523, "post_id": 45841143, "comment_id": 78640156, "body": "<code>if (i = 9)</code> is assignment, not comparison. It&#39;s also always true. ` i++;` inside the loop and inside the <code>for</code> means you increment it twice per iteration."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503496265, "post_id": 45841143, "comment_id": 78640804, "body": "<code>double sum;</code> is used before being initialized -&gt; UB."}, {"owner": {"reputation": 35, "user_id": 8288151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00b4e230fa801d89e262d2ed3d4c8c3?s=128&d=identicon&r=PG&f=1", "display_name": "introvertbustardxd", "link": "https://stackoverflow.com/users/8288151/introvertbustardxd"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503496401, "post_id": 45841143, "comment_id": 78640921, "body": "edited it @Jarod42"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1503496471, "post_id": 45841143, "comment_id": 78640977, "body": "<a href=\"https://ideone.com/JFSLq1\" rel=\"nofollow noreferrer\">ideone.com/JFSLq1</a>"}, {"owner": {"reputation": 849, "user_id": 1885002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0db5b35211eb1c3987d9299ca4cbc5c?s=128&d=identicon&r=PG", "display_name": "King Thrushbeard", "link": "https://stackoverflow.com/users/1885002/king-thrushbeard"}, "edited": false, "score": 0, "creation_date": 1503496512, "post_id": 45841143, "comment_id": 78641016, "body": "You are incrementing <code>i</code> twice in the <code>for</code>-loop?"}], "answers": [{"comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1503495899, "post_id": 45841481, "comment_id": 78640476, "body": "<a href=\"https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong\" title=\"why is iostreameof inside a loop condition considered wrong\">stackoverflow.com/questions/5605125/&hellip;</a>"}, {"owner": {"reputation": 890, "user_id": 2710291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2137ebc802947205000ce484c02cb18e?s=128&d=identicon&r=PG", "display_name": "petrpulc", "link": "https://stackoverflow.com/users/2710291/petrpulc"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1503496024, "post_id": 45841481, "comment_id": 78640594, "body": "@RetiredNinja typing faster than thinking, of course"}], "tags": [], "owner": {"reputation": 890, "user_id": 2710291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2137ebc802947205000ce484c02cb18e?s=128&d=identicon&r=PG", "display_name": "petrpulc", "link": "https://stackoverflow.com/users/2710291/petrpulc"}, "is_accepted": true, "score": 1, "last_activity_date": 1503499752, "last_edit_date": 1503499752, "creation_date": 1503495832, "answer_id": 45841481, "question_id": 45841143, "link": "https://stackoverflow.com/questions/45841143/summarize-then-average-every-10-lines-from-a-txt-file/45841481#45841481", "title": "Summarize then average every 10 lines from a txt file", "body": "<p>A possible solution:</p>\n\n<pre><code>int i;\nwhile (average.good()) // only while we are good\n{\n  sum = 0; // you need to clean it\n  for(i = 0; i &lt; 10; i++)\n  {   \n    average &gt;&gt; number;\n\n    if (!average.good()) break; // if number of lines is not mod10\n\n    sum = sum + number;\n    // i++; you already do that in for loop\n  }\n  if (i)\n  {\n    cout &lt;&lt; sum / i &lt;&lt; endl; // only print after each 10 or less\n  }\n}\n</code></pre>\n\n<p>Or with the single loop:</p>\n\n<pre><code>sum = 0;\nint i = 0;\n\nwhile (average &gt;&gt; number) {\n  sum = sum + number;\n  ++i;\n\n  if (i == 10) {\n    cout &lt;&lt; sum / i &lt;&lt; endl;\n    sum = i = 0;\n  }\n}\nif (i) {\n  cout &lt;&lt; sum / i &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 231, "user_id": 7404875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80971b1d5ed24a338b33e8761cf394e?s=128&d=identicon&r=PG&f=1", "display_name": "pmaxim98", "link": "https://stackoverflow.com/users/7404875/pmaxim98"}, "is_accepted": false, "score": 0, "last_activity_date": 1503498784, "creation_date": 1503498784, "answer_id": 45842653, "question_id": 45841143, "link": "https://stackoverflow.com/questions/45841143/summarize-then-average-every-10-lines-from-a-txt-file/45842653#45842653", "title": "Summarize then average every 10 lines from a txt file", "body": "<p>You could achieve this easily with a <code>std::deque</code> since you can easily add and remove numbers when you reach the tenth quota every line.</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;deque&gt;\n#include &lt;numeric&gt;\n\nint main()\n{\n    std::ifstream read(\"average.txt\");\n\n    constexpr unsigned linesToAverage = 10;\n    std::deque&lt;double&gt; numbers;\n    double currentNumber = 0.0;\n\n    while (read &gt;&gt; currentNumber) {\n        if (numbers.size() == linesToAverage) {\n            std::cout &lt;&lt; std::accumulate(std::begin(numbers), std::end(numbers), 0.0) / linesToAverage &lt;&lt; std::endl;\n            numbers.pop_back();\n        }\n\n        numbers.push_front(currentNumber);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This code shows the averages starting from the first ten numbers.</p>\n"}], "owner": {"reputation": 35, "user_id": 8288151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00b4e230fa801d89e262d2ed3d4c8c3?s=128&d=identicon&r=PG&f=1", "display_name": "introvertbustardxd", "link": "https://stackoverflow.com/users/8288151/introvertbustardxd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 45841481, "answer_count": 2, "score": 1, "last_activity_date": 1503499752, "creation_date": 1503494946, "last_edit_date": 1503496344, "question_id": 45841143, "link": "https://stackoverflow.com/questions/45841143/summarize-then-average-every-10-lines-from-a-txt-file", "title": "Summarize then average every 10 lines from a txt file", "body": "<p>I have this code for the task mentioned in the title:</p>\n\n<p>The program reads from a 1 columned text file in which the numbers are below each other.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\nusing namespace std;\n\nint main()\n{\n\n    double number;\n    double sum = 0;\n\n    ifstream average;\n    average.open(\"average.txt\");\n\n    while (average &gt;&gt; number)\n    {\n        for(int i = 0; i &lt; 10; i++)\n        {\n            sum = sum + number;\n\n            i++;\n\n            if (i = 9)\n            {\n                cout &lt;&lt; sum / 10 &lt;&lt; endl;\n            }\n         }\n    {\n\n    average.close();\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>But somehow it doesn't average the numbers just divide all of them by 10.</p>\n\n<p>What might be the problem?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "multithreading", "file-io", "client-server", "qt4"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1503494482, "post_id": 45840687, "comment_id": 78639256, "body": "You appear to be moving the socket descriptor to the new <code>MyThread</code> but not the associated <code>QTcpSocket</code>.  Have a look at the <a href=\"http://doc.qt.io/qt-5/qtcpserver.html#incomingConnection\" rel=\"nofollow noreferrer\">docs</a>."}, {"owner": {"reputation": 15, "user_id": 8421922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J05ilvdPDz4/AAAAAAAAAAI/AAAAAAAAFVk/8z8Em9OyLHs/photo.jpg?sz=128", "display_name": "Shahwani", "link": "https://stackoverflow.com/users/8421922/shahwani"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1503495115, "post_id": 45840687, "comment_id": 78639814, "body": "@G.M. I didn&#39;t get your point properly. You mean I have to change <i>socketDescriptor</i> here: <code>MyThread *thread = new MyThread(socketDescriptor, this);</code>"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1503495415, "post_id": 45840687, "comment_id": 78640069, "body": "The second <b>Note</b> in the link I gave states &quot;Note: If you want to handle an incoming connection as a new QTcpSocket object in another thread you have to pass the socketDescriptor to the other thread and create the QTcpSocket object there and use its setSocketDescriptor() method&quot;.  You don&#39;t appear to be doing that."}, {"owner": {"reputation": 15, "user_id": 8421922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J05ilvdPDz4/AAAAAAAAAAI/AAAAAAAAFVk/8z8Em9OyLHs/photo.jpg?sz=128", "display_name": "Shahwani", "link": "https://stackoverflow.com/users/8421922/shahwani"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1503495614, "post_id": 45840687, "comment_id": 78640241, "body": "I&#39;m actually doing that in the <code>run()</code> function of <b>myThread.cpp</b> kindly see the edited question above!"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1503496157, "post_id": 45840687, "comment_id": 78640712, "body": "But you&#39;ve already created a <code>QTcpSocket</code> wrapper for the descriptor at the top of <code>MyServer::incomingConnection</code>.  So you appear to have two <code>QTcpSocket</code> objects on different threads managing the same descriptor."}, {"owner": {"reputation": 15, "user_id": 8421922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J05ilvdPDz4/AAAAAAAAAAI/AAAAAAAAFVk/8z8Em9OyLHs/photo.jpg?sz=128", "display_name": "Shahwani", "link": "https://stackoverflow.com/users/8421922/shahwani"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1503497579, "post_id": 45840687, "comment_id": 78641908, "body": "@G.M. yeah! now I&#39;m getting your point. Should I comment out the one in <code>MyServer::incomingConnection</code> ?"}], "owner": {"reputation": 15, "user_id": 8421922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J05ilvdPDz4/AAAAAAAAAAI/AAAAAAAAFVk/8z8Em9OyLHs/photo.jpg?sz=128", "display_name": "Shahwani", "link": "https://stackoverflow.com/users/8421922/shahwani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503495678, "creation_date": 1503493779, "last_edit_date": 1503495678, "question_id": 45840687, "link": "https://stackoverflow.com/questions/45840687/multi-clients-not-working-properly-on-qt4-multi-thread-server", "title": "Multi clients not working properly on Qt4 Multi thread server?", "body": "<p>Friends! I have written a code for a <em>multi threaded TCP server</em> in Qt4. The server is constantly listening for remote client connection requests. Whenever the client connects to the server, it takes its IP, Name and Port number and verifies if it is a recognized (authorized) client (that can be checked through a <em>pre-stored text file</em> having names, IPs and port numbers of all registered clients). If it is, the communication will proceed. Otherwise, the server terminates the connection.</p>\n\n<p><strong>EDIT1:</strong> here is the excerpt from <strong>myThread.cpp</strong></p>\n\n<pre><code>void MyThread::run()\n{\n    // Thread starts here\n    qDebug() &lt;&lt; socketDescriptor &lt;&lt; (\"Starting thread...\");\n    socket = new QTcpSocket();\n\n    if(!socket-&gt;setSocketDescriptor(this-&gt;socketDescriptor))\n    {\n        emit error(socket-&gt;error());\n        return;\n    }\n\n    connect(socket, SIGNAL(readyRead()), this, SLOT(readyRead()), Qt::DirectConnection);\n    connect(socket, SIGNAL(disconnected()), this, SLOT(disconnected()), Qt::DirectConnection);\n\n    qDebug() &lt;&lt; socketDescriptor &lt;&lt; (\"Client connected!\");\n\n    exec();\n}\n</code></pre>\n\n<p><strong>ISSUE</strong>: Now the problem is when I run the program and connects the first client it works fine. But as soon as the 2nd client is connected (testing through telnet, for now) it starts behaving strange (no messages receiving from client 2 or client 2 completely freezing etc). Can someone test the code in their machine?</p>\n\n<p><strong>myserver.cpp</strong></p>\n\n<pre><code>#include \"myserver.h\"\n#include \"ioprogram.h\"\n#include &lt;QTcpSocket&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nMyServer::MyServer(QObject *parent): QTcpServer(parent)\n{\n    QStringList accepted_ip_list;   //List of remote IPs that can be accepted in QString list format\n    accepted_ip_list.append(\"127.0.0.1\");   // IPv4 local address\n    accepted_ip_list.append(\"::1\");         // IPv6 local address\n\n    accepted_ip_list.append(\"172.18.48.139\");\n\n    // Convert from QString to integer format, generating new list\n    foreach (const QString &amp;ip, accepted_ip_list)\n    {\n        QHostAddress host_address(ip);\n        my_accepted_ip_list.append(host_address);\n    }\n/*\n    myserver = new QTcpServer(this);\n\n    connect(myserver, &amp;QTcpServer::incomingConnection, this, &amp;MyServer::incomingConnection);\n\n    myserver-&gt;listen(QHostAddress::Any, 1234);\n*/\n}\n\nvoid MyServer::startServer()\n{\n    if(!this-&gt;listen(QHostAddress::Any,1234))\n    {\n        qDebug() &lt;&lt; \"Could not start server.\";\n    }\n    else\n    {\n        qDebug() &lt;&lt; \"Listening...\";\n    }\n}\n\nvoid MyServer::incomingConnection(qintptr socketDescriptor)\n{\n    QTcpSocket *socket = new QTcpSocket(this);\n    socket-&gt;setSocketDescriptor(socketDescriptor);\n\n    qDebug() &lt;&lt; socketDescriptor &lt;&lt; \"Connecting...\";\n\n    QHostAddress host_address = socket-&gt;peerAddress();\n\n    //quint32 ipv4 = host_address.toIPv4Address();\n    std::string ipv4 = host_address.toString().toStdString();\n\n    QByteArray ipv6 = QByteArray((char*)host_address.toIPv6Address().c, 16);\n\n    IOProgram test;\n\n    bool status= test.checkAuthenticity(ipv4);\n\n    if(status == false){\n        /*\n    while (myserver-&gt;hasPendingConnections())\n    {\n        QTcpSocket *socket = myserver-&gt;nextPendingConnection();\n        QHostAddress host_address = socket-&gt;peerAddress();\n\n        bool contains = false;\n*/\n        for(int i=0; i &lt; my_accepted_ip_list.size(); i++)\n        {\n            //quint32 accepted_ipv4 = my_accepted_ip_list[i].toIPv4Address();\n            std::string accepted_ipv4 = my_accepted_ip_list[i].toString().toStdString();\n\n            if(accepted_ipv4 == ipv4)\n            {\n                status = true;\n                qDebug() &lt;&lt; \"testing...\";\n                break;\n            }\n       /*     else\n            {\n                qDebug() &lt;&lt; \"Rejected!\";\n                socket-&gt;abort();        // Reject peer by disconnecting it\n                socket-&gt;deleteLater();  // Schedule the socket removal from memory\n            }\n        */\n            /*if(my_accepted_ip_list[i].isEqual(host_address,QHostAddress::ConvertV4MappedToIPv4))\n            {\n                contains = true;\n                break;\n            }*/\n        }\n\n        if(!socket-&gt;QTcpSocket::ConnectedState){\n            socket-&gt;abort();        // Reject peer by disconnecting it\n            socket-&gt;deleteLater();  // Schedule the socket removal from memory\n        }\n\n        if(status)\n        {\n            qDebug() &lt;&lt; \"Accepted!\";\n            MyThread *thread = new MyThread(socketDescriptor, this);\n\n            connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));\n            thread-&gt;start();\n        }\n    }\n}\n</code></pre>\n\n<p><strong>ioprogram.cpp</strong></p>\n\n<pre><code>#include \"ioprogram.h\"\n#include &lt;QFile&gt;\n#include &lt;QDebug&gt;\n#include &lt;QTextStream&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;sstream&gt;\n\nusing namespace std;\n\n    struct Data {\n        string Name;\n        string IP;\n        string Port;\n    };\n\n    vector&lt;Data&gt; AllData;\n\nIOProgram::IOProgram()\n{\n\n}\n\nvoid Read()\n{\n    QFile file(\"C:/Users/Shahwani/Documents/Bremen/Sem3/Qt/MultiServerAugust/NodesList.txt\");\n\n    if(file.open(QIODevice::ReadWrite | QIODevice::Text))\n    {\n        QTextStream stream(&amp;file);\n\n        QString line;\n        do\n        {\n            line = stream.readLine();\n            qDebug() &lt;&lt; line;\n        }while(!line.isNull());\n\n        file.close();\n    }\n}\n\nstring IOProgram::inpop()\n{\n    ifstream inFile;\n    inFile.open(\"NodesList.txt\");\n//    inFile.clear();\n\n    // Check for error\n    if(inFile.fail()){\n        cerr &lt;&lt; \"Error opening file\" &lt;&lt; endl;\n        exit(1);\n    }\n\n    int count = 0;\n    string line;\n    char delim = '\\t';\n    getline (inFile,line);\n\n    // Read the file until the end\n    while(!inFile.eof())\n    {\n        getline (inFile,line);\n\n        string token;\n        stringstream stream(line);          // Splitting a string using a delimiter\n        vector&lt;string&gt; vect;\n        while(getline(stream, token, delim) )\n        {\n            vect.push_back(token);\n        }\n        Data d;\n        d.Name = vect[0];\n        d.IP = vect[1];\n        d.Port = vect[2];\n        vect.clear();\n        AllData.push_back(d);\n        count++;\n    }\n\n    cout &lt;&lt; count &lt;&lt; \" nodes found!\" &lt;&lt; endl;\n    inFile.close();\n\n    // Check for authenticity and only allow the recognised IPs\n\n\n    // Write the active nodes in a separate file on the disk\n\n    ofstream outFile;\n    outFile.open(\"sample.txt\");\n    Data activeList;\n    for(int i = 0; i &lt; AllData.size(); i++)\n    {\n        activeList = AllData[i];\n        outFile &lt;&lt; \"Name: \" &lt;&lt; activeList.Name &lt;&lt; \"\\tIP: \" &lt;&lt; activeList.IP &lt;&lt; \"\\tPort: \" &lt;&lt; activeList.Port &lt;&lt;endl;\n    }\n\n    outFile.close();\n\n    return activeList.IP;\n}\n\nbool IOProgram::checkAuthenticity(string ip)\n{\n    for(int i=0;i&lt;AllData.size();i++)\n    {\n        Data check;\n        check = AllData[i];\n        if(ip == check.IP)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n}\n</code></pre>\n\n<p>I guess I cannot put a lot of code in one question. Let me know in case someone needs rest of the files like <strong>mythread.cpp</strong> or <strong>header files</strong> to understand the issue and how I can share them.</p>\n"}, {"tags": ["c++", "boost", "file-io"], "comments": [{"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1503493959, "post_id": 45840686, "comment_id": 78638828, "body": "Is it an option to implement a stream or stream-like class using the C functions? Allthough yes id agree, io streams for files, sockets, etc. is not great."}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1503494045, "post_id": 45840686, "comment_id": 78638902, "body": "Of course it is possible to implement it, but I hope that in modern C++ there is out out-of-the-box solution for such a simple and common task."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1503494125, "post_id": 45840686, "comment_id": 78638959, "body": "Boost has stuff to make custom streams easier, but I dont recall one out of the box. Many larger frameworks have file etc. classes, and there are many libraries. But nothing much in the standard library."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 4, "creation_date": 1503494233, "post_id": 45840686, "comment_id": 78639062, "body": "Yes, there&#39;s a way to &quot;accomplish this using C++14&quot;. Implement your own subclass of <code>std::streambuf</code>, then use it to construct a <code>std::istream</code>. You get an ordinary stream, and your implementation can use OS calls to open/read the file, and report the actual OS errors."}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1503494470, "post_id": 45840686, "comment_id": 78639244, "body": "@SamVarshavchik This sounds horrible."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1503494657, "post_id": 45840686, "comment_id": 78639415, "body": "Well, if one&#39;s goal is to capture the underlying OS errors, and still have an ordinary <code>std::istream</code>, this is the only way to do it. Unfortunately, C++ does not have a reputation for having a lot of magic buttons that one only needs to push in order to get the results they&#39;re looking for. Many things require a lot of work to implement correctly, and properly."}, {"owner": {"reputation": 2374, "user_id": 8491726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550562035006492/picture?type=large", "display_name": "Artemy Vysotsky", "link": "https://stackoverflow.com/users/8491726/artemy-vysotsky"}, "edited": false, "score": 0, "creation_date": 1503497555, "post_id": 45840686, "comment_id": 78641880, "body": "Have you tried to check filesystem::exists and filesystem::file_status::permissions before opening the file?"}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "reply_to_user": {"reputation": 2374, "user_id": 8491726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550562035006492/picture?type=large", "display_name": "Artemy Vysotsky", "link": "https://stackoverflow.com/users/8491726/artemy-vysotsky"}, "edited": false, "score": 3, "creation_date": 1503498643, "post_id": 45840686, "comment_id": 78642821, "body": "@ArtemyVysotsky This is totally inappropriate because it introduces the TOCTTOU problem."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1503499883, "post_id": 45840686, "comment_id": 78643929, "body": "@OlegAndriyanov I believe the more widely used jargon is &quot;race condition&quot; (I had to google TOCTTOU to get it)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503512357, "post_id": 45840686, "comment_id": 78651755, "body": "&quot;the standard does not guarantee that errno is set by any functions in iostreams library&quot;. The standard says just about nothing about errno. When ENOENT is set? The standard is silent. EACCESS? Nothing. EAGAIN? Nada. Will <code>perror</code> print a user-friendly error message or something alongthe lines of &quot;an error occurred, reboot now&quot;? Who knows? If you want any guarantees, you need a guarantee provider other than the C++ standard."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1503513628, "post_id": 45840686, "comment_id": 78652460, "body": "About &quot;C does it better&quot;. The C standard mandates exactly three errno-related macros: EDOM, EILSEQ and ERANGE, and no guarantees about any I/O functions setting errno to anything in particular."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503517162, "post_id": 45840686, "comment_id": 78654252, "body": "@n.m. you could say &quot;C does it better&quot; because it abstract 0% over POSIX. This <i>also</i> means, no loss of fidelity (like the C++ libs), aside from the minor quip that there&#39;s no abstraction - at all. So it&#39;s easier to do the wrong thing in C, but it&#39;s more possible to do the right thing well. Plot twist: C++ afords 100% the same. <b>TL;DR</b> It&#39;s just an expectation mismatch."}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503517460, "post_id": 45840686, "comment_id": 78654380, "body": "@n.m. Yes it does better. At least C functions do set <code>errno</code>, and <code>perror</code> documentation in C11 standard says that it &quot;maps the <b>error number</b> in the integer expression errno to an <b>error message</b>&quot;. See, at least it has error numbers. Of course they are implementation defined, but in fact we get &quot;No such file or directory&quot; with <code>perror</code> while libstdc++ leaves us with with something like &quot;basic_ios::clear: iostream error&quot; in exception object."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503521430, "post_id": 45840686, "comment_id": 78656303, "body": "<code>perror</code> prints &quot;No such file or directory&quot; in <b>your</b> implementation of C. The C standard doesn&#39;t guarantee you that. <code>perror</code> prints exactly the same &quot;No such file or directory&quot; in my implementation of C++ when using iostreams. Tell me again why exactly C is better?"}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1503525131, "post_id": 45840686, "comment_id": 78657874, "body": "Because C library functions are guaranteed to set <code>errno</code> to the (implementation defined) value. C++ iostreams are not required to set <code>errno</code>. You get the same output just because your iostreams backend is implemented using system calls from libc, but it is surely not required to be implemented that way. So checking <code>errno</code> with <code>stdio</code> functions in C is portable, but it is not portable in C++ with <code>fstream</code>. That&#39;s why I think error handling is better in C."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503527674, "post_id": 45840686, "comment_id": 78658768, "body": "C library functions are not guaranteed to set <code>errno</code> to values you will like or find useful. An implementation-defined value is all that is guaranteed in most cases. For example they all may set errno to EUNKNOWNERROR. If you happen to be on a POSIX system yoiu get more guarantees. They are of course non-portable to non-POSIX systems but this isn&#39;t even important. (to be continued)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503527854, "post_id": 45840686, "comment_id": 78658814, "body": "Restricting our attention to POSIX systems, what do you prefer: spend your time implementing a custom IO system with guaranteed error reporting, or producing useful, working, <b>portable in practice</b> software that relies on non-standards-guaranteed errno being set by implementation the right way? I personally trust implementations to be non-evil and do the right thing, in this and other cases, but YMMV."}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1503528270, "post_id": 45840686, "comment_id": 78658965, "body": "I also trust implementations to be non-evil, and in that sense C standard (even without POSIX) is enough to do a portable (in practice <b>and theory</b>) error reporting, while C++ is not."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503529346, "post_id": 45840686, "comment_id": 78659300, "body": "I have actually read the C standard and I don&#39;t find it supporting anything remotely like portable reporting of I/O errors. The standard specifies exactly three I/O functions that are guaranteed to set errno (to an implementation-defined value): fgetpos, fsetpos and ftell. I don&#39;t see how this can possibly be taken as a basis for portable error reporting. If you find something else in your copy of the standard, please share."}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1503529446, "post_id": 45840686, "comment_id": 78659323, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/152683/discussion-between-oleg-andriyanov-and-n-m\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 1, "creation_date": 1503502023, "post_id": 45843625, "comment_id": 78645464, "body": "What are these examples for? To demonstrate that they don&#39;t do what I want to do? I don&#39;t think manual API wrapping is a good idea since this task is easily solved in any modern language in a few lines. Even C does it better than C++."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 3, "creation_date": 1503502253, "post_id": 45843625, "comment_id": 78645642, "body": "Information is everything. If you knew, you could have shown it in your question. Also, <a href=\"https://chat.stackoverflow.com/transcript/message/38808019#38808019\">I share the rant</a>, but that&#39;s not a useful answer. (It&#39;s even a questionable attitude)."}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1503502915, "post_id": 45843625, "comment_id": 78646121, "body": "Thanks for sharing this."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1503505874, "post_id": 45843625, "comment_id": 78648092, "body": "boost wraps <code>ifstream</code> and <code>ofstream</code> and handles correct pathing so you have unicode on both platforms"}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1503506427, "post_id": 45843625, "comment_id": 78648407, "body": "@Mgetz That&#39;s cool, but unicode paths have nothing to do with system errors like no such file, etc."}, {"owner": {"reputation": 10759, "user_id": 343443, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2dcf7b64ff07a02fbd78c27f50ce9631?s=128&d=identicon&r=PG", "display_name": "Abyx", "link": "https://stackoverflow.com/users/343443/abyx"}, "edited": false, "score": 0, "creation_date": 1504392466, "post_id": 45843625, "comment_id": 78997510, "body": "Doesn&#39;t answer the question, should be a comment."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1504394005, "post_id": 45843625, "comment_id": 78997810, "body": "Honestly, I think this answer presents research that could have been part of the question. Because it was not, I present it here as a body of work to avoid others having to try the same things. It&#39;s not like these parts are well documented (which is why the question is so relevant)."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1503501474, "creation_date": 1503501474, "answer_id": 45843625, "question_id": 45840686, "link": "https://stackoverflow.com/questions/45840686/portable-way-to-read-a-file-in-c-and-handle-possible-errors/45843625#45843625", "title": "Portable way to read a file in C++ and handle possible errors", "body": "<p>The best thing to do could be to wrap <a href=\"http://www.boost.org/doc/libs/1_65_0/libs/winapi/doc/html/index.html\" rel=\"nofollow noreferrer\">Boost WinAPI</a> and or POSIX APIs.</p>\n\n<p>The \"naive\" C++ standard library thing (with bells and wistles) doesn't get you too far:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/b49c986f3aa57a29\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;vector&gt;\n\ntemplate &lt;typename Out&gt;\nOut read_file(std::string const&amp; path, Out out) {\n    std::ifstream s;\n    s.exceptions(std::ios::badbit | std::ios::eofbit | std::ios::failbit);\n    s.open(path, std::ios::binary);\n\n    return out = std::copy(std::istreambuf_iterator&lt;char&gt;{s}, {}, out);\n}\n\nvoid test(std::string const&amp; spec) try {\n    std::vector&lt;char&gt; data;\n    read_file(spec, back_inserter(data));\n\n    std::cout &lt;&lt; spec &lt;&lt; \": \" &lt;&lt; data.size() &lt;&lt; \" bytes read\\n\";\n} catch(std::ios_base::failure const&amp; f) {\n    std::cout &lt;&lt; spec &lt;&lt; \": \" &lt;&lt; f.what() &lt;&lt; \" code \" &lt;&lt; f.code() &lt;&lt; \" (\" &lt;&lt; f.code().message() &lt;&lt; \")\\n\";\n} catch(std::exception const&amp; e) {\n    std::cout &lt;&lt; spec &lt;&lt; \": \" &lt;&lt; e.what() &lt;&lt; \"\\n\";\n};\n\nint main() {\n\n    test(\"main.cpp\");\n    test(\"nonexistent.cpp\");\n\n}\n</code></pre>\n\n<p>Prints...:</p>\n\n<pre><code>main.cpp: 823 bytes read\nnonexistent.cpp: basic_ios::clear: iostream error code iostream:1 (iostream error)\n</code></pre>\n\n<blockquote>\n  <ol>\n  <li><p><em>Of course you can add more diagnostics perusing <code>&lt;filesystem&gt;</code> but \n  that's susceptible to races, as mentioned (depending on your application, these can even open up security vulnerabilities, so just say \"No\").</em></p></li>\n  <li><p>Using <code>boost::filesystem::ifstream</code> doesn't change the exceptions raised</p></li>\n  <li><p>Worse still, using Boost IOstream fails to raise any errors:</p>\n\n<pre><code>template &lt;typename Out&gt;\nOut read_file(std::string const&amp; path, Out out) {\n    namespace io = boost::iostreams;\n    io::stream&lt;io::file_source&gt; s;\n    s.exceptions(std::ios::badbit | std::ios::eofbit | std::ios::failbit);\n    s.open(path, std::ios::binary);\n\n    return out = std::copy(std::istreambuf_iterator&lt;char&gt;{s}, {}, out);\n}\n</code></pre>\n  \n  <p>Happily prints:</p>\n\n<pre><code>main.cpp: 956 bytes read\nnonexistent.cpp: 0 bytes read\n</code></pre>\n  \n  <p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/11840739d5d5c176\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p></li>\n  </ol>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1504611099, "post_id": 45846195, "comment_id": 79067084, "body": "Could you please provide an example of code which reads a line from a file using AFIO? This looks like what I need but I haven&#39;t found any code examples."}, {"owner": {"reputation": 8223, "user_id": 805579, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0d2eb3294e0905aa3c750998db351ddc?s=128&d=identicon&r=PG", "display_name": "Niall Douglas", "link": "https://stackoverflow.com/users/805579/niall-douglas"}, "reply_to_user": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1504613309, "post_id": 45846195, "comment_id": 79068554, "body": "@OlegAndriyanov That&#39;s a good idea. Back in a few mins with something."}, {"owner": {"reputation": 8223, "user_id": 805579, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0d2eb3294e0905aa3c750998db351ddc?s=128&d=identicon&r=PG", "display_name": "Niall Douglas", "link": "https://stackoverflow.com/users/805579/niall-douglas"}, "reply_to_user": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1504615903, "post_id": 45846195, "comment_id": 79070340, "body": "@OlegAndriyanov Example of use code added. Let me know if you have any questions."}, {"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1504650978, "post_id": 45846195, "comment_id": 79089354, "body": "That looks like pretty nice wrapper around OS calls. Are there any plans for inclusion of AFIO in boost? Also IMO it would be nice to have an implementation of <code>std::streambuf</code> in AFIO (as @SamVarshavchik suggested) to reuse all the power of formatting IO operations of iostreams but with portable error handling. Or is it beyond the scope of the library?"}, {"owner": {"reputation": 8223, "user_id": 805579, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0d2eb3294e0905aa3c750998db351ddc?s=128&d=identicon&r=PG", "display_name": "Niall Douglas", "link": "https://stackoverflow.com/users/805579/niall-douglas"}, "reply_to_user": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 3, "creation_date": 1504652233, "post_id": 45846195, "comment_id": 79089679, "body": "@OlegAndriyanov I hope to return AFIO for its second Boost peer review in 2019. I&#39;m blocked on the Coroutines TS, Ranges TS, Expected and Span proposals and a few other bits coming in C++ 20. No need to add streambuf support, AFIO uses the Ranges TS already. So speak i/o with Ranges, all works very nicely. Eric did a blog post on this at <a href=\"http://ericniebler.com/2017/08/17/ranges-coroutines-and-react-early-musings-on-the-future-of-async-in-c/\" rel=\"nofollow noreferrer\">ericniebler.com/2017/08/17/&hellip;</a>, he used libuv instead of AFIO as it&#39;s wider known. But AFIO is <i>far</i> more efficient than libuv, and WG21 is currently smiling on AFIO for iostreams v2"}, {"owner": {"reputation": 8223, "user_id": 805579, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0d2eb3294e0905aa3c750998db351ddc?s=128&d=identicon&r=PG", "display_name": "Niall Douglas", "link": "https://stackoverflow.com/users/805579/niall-douglas"}, "reply_to_user": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1504652719, "post_id": 45846195, "comment_id": 79089812, "body": "I would also add that it&#39;s straightforward to implement <code>streambuf</code> with AFIO, donations of a high quality implementation with comprehensive test suite are welcome. My main reason for not doing so myself is &quot;other fish to fry first&quot;, and as I mentioned, AFIO was designed for the Ranges TS which is the beginnings of the future iostreams reboot."}], "tags": [], "owner": {"reputation": 8223, "user_id": 805579, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0d2eb3294e0905aa3c750998db351ddc?s=128&d=identicon&r=PG", "display_name": "Niall Douglas", "link": "https://stackoverflow.com/users/805579/niall-douglas"}, "is_accepted": false, "score": 18, "last_activity_date": 1505443356, "last_edit_date": 1505443356, "creation_date": 1503510040, "answer_id": 45846195, "question_id": 45840686, "link": "https://stackoverflow.com/questions/45840686/portable-way-to-read-a-file-in-c-and-handle-possible-errors/45846195#45846195", "title": "Portable way to read a file in C++ and handle possible errors", "body": "<p>Disclaimer: I am the author of AFIO. But exactly what you are looking for is <a href=\"https://ned14.github.io/afio/\" rel=\"nofollow noreferrer\">https://ned14.github.io/afio/</a> which is the v2 library incorporating the feedback from its Boost peer review in August 2015. <a href=\"https://ned14.github.io/afio/\" rel=\"nofollow noreferrer\">See the list of features here</a>.</p>\n\n<p>I will of course caveat that this is an alpha quality library, and you should not use it in production code. However, quite a few people already are doing so.</p>\n\n<p>How to use AFIO to solve the OP's problem:</p>\n\n<p>Note that AFIO is a very low level library, hence you have to type a lot more code to achieve the same as iostreams, on the other hand you get no memory allocation, no exception throwing, no unpredictable latency spikes:</p>\n\n<pre><code>  // Try to read first line from file at path, returning no string if file does not exist,\n  // throwing exception for any other error\n  optional&lt;std::string&gt; read_first_line(filesystem::path path)\n  {\n    using namespace AFIO_V2_NAMESPACE;\n    // The result&lt;T&gt; is from WG21 P0762, it looks quite like an `expected&lt;T, std::error_code&gt;` object\n    // See Outcome v2 at https://ned14.github.io/outcome/ and https://lists.boost.org/boost-announce/2017/06/0510.php\n\n    // Open for reading the file at path using a null handle as the base\n    result&lt;file_handle&gt; _fh = file({}, path);\n    // If fh represents failure ...\n    if(!_fh)\n    {\n      // Fetch the error code\n      std::error_code ec = _fh.error();\n      // Did we fail due to file not found?\n      // It is *very* important to note that ec contains the *original* error code which could\n      // be POSIX, or Win32 or NT kernel error code domains. However we can always compare,\n      // via 100% C++ 11 STL, any error code to a generic error *condition* for equivalence\n      // So this comparison will work as expected irrespective of original error code.\n      if(ec == std::errc::no_such_file_or_directory)\n      {\n        // Return empty optional\n        return {};\n      }\n      std::cerr &lt;&lt; \"Opening file \" &lt;&lt; path &lt;&lt; \" failed with \" &lt;&lt; ec.message() &lt;&lt; std::endl;\n    }\n    // If errored, result&lt;T&gt;.value() throws an error code failure as if `throw std::system_error(fh.error());`\n    // Otherwise unpack the value containing the valid file_handle\n    file_handle fh(std::move(_fh.value()));\n    // Configure the scatter buffers for the read, ideally aligned to a page boundary for DMA\n    alignas(4096) char buffer[4096];\n    // There is actually a faster to type shortcut for this, but I thought best to spell it out\n    file_handle::buffer_type reqs[] = {{buffer, sizeof(buffer)}};\n    // Do a blocking read from offset 0 possibly filling the scatter buffers passed in\n    file_handle::io_result&lt;file_handle::buffers_type&gt; _buffers_read = read(fh, {reqs, 0});\n    if(!_buffers_read)\n    {\n      std::error_code ec = _fh.error();\n      std::cerr &lt;&lt; \"Reading the file \" &lt;&lt; path &lt;&lt; \" failed with \" &lt;&lt; ec.message() &lt;&lt; std::endl;\n    }\n    // Same as before, either throw any error or unpack the value returned\n    file_handle::buffers_type buffers_read(_buffers_read.value());\n    // Note that buffers returned by AFIO read() may be completely different to buffers submitted\n    // This lets us skip unnecessary memory copying\n\n    // Make a string view of the first buffer returned\n    string_view v(buffers_read[0].data, buffers_read[0].len);\n    // Sub view that view with the first line\n    string_view line(v.substr(0, v.find_first_of('\\n')));\n    // Return a string copying the first line from the file, or all 4096 bytes read if no newline found.\n    return std::string(line);\n  }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 4, "creation_date": 1503525794, "post_id": 45849914, "comment_id": 78658122, "body": "Checking <code>errno</code> is not portable as I&#39;ve said."}, {"owner": {"reputation": 1, "user_id": 8508543, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b1e17e5ce1d966c0d92834ff4ce5ac7d?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/8508543/hans"}, "reply_to_user": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "edited": false, "score": 0, "creation_date": 1503529610, "post_id": 45849914, "comment_id": 78659360, "body": "If you believe <code>fopen</code> sets <code>errno</code> but <code>ifstream::open</code> does not, use <code>fopen</code>. But note that ISO C doesn&#39;t say anything about <code>errno</code> in the <code>fopen</code> section (compare this against <code>fgetpos</code>, <code>fsetpos</code>, <code>ftell</code>,...). Note also that ISO C knows exactly 3 error codes for <code>errno</code> while ISO C++ mentions all POSIX error codes and maps those to <code>errc</code>."}, {"owner": {"reputation": 8223, "user_id": 805579, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0d2eb3294e0905aa3c750998db351ddc?s=128&d=identicon&r=PG", "display_name": "Niall Douglas", "link": "https://stackoverflow.com/users/805579/niall-douglas"}, "edited": false, "score": 2, "creation_date": 1503547184, "post_id": 45849914, "comment_id": 78663368, "body": "I&#39;m fairly sure that iostreams makes no guarantees that errno will be preserved on failure. Indeed, one can see it would be highly likely to get overwritten."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1504546611, "post_id": 45849914, "comment_id": 79043977, "body": "This code also uses system_category instead of generic_category which is wrong."}], "tags": [], "owner": {"reputation": 1, "user_id": 8508543, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b1e17e5ce1d966c0d92834ff4ce5ac7d?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/8508543/hans"}, "is_accepted": false, "score": 0, "last_activity_date": 1503527030, "last_edit_date": 1503527030, "creation_date": 1503525524, "answer_id": 45849914, "question_id": 45840686, "link": "https://stackoverflow.com/questions/45840686/portable-way-to-read-a-file-in-c-and-handle-possible-errors/45849914#45849914", "title": "Portable way to read a file in C++ and handle possible errors", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;system_error&gt;\n\nusing namespace std;\n\nint\nmain()\n{\n    ifstream f(\"testfile.txt\");\n    if (!f.good()) {\n        error_code e(errno, system_category());\n        cerr &lt;&lt; e.message();\n        //...\n    }\n    // ...\n}\n</code></pre>\n\n<p>ISO C++ Standard:</p>\n\n<blockquote>\n  <p>The contents of the header\n  \"cerrno\"\n  are the same as the POSIX header\n  \"errno.h\"\n  , except that\n  errno\n  shall\n  be defined as a macro. [\n  Note:\n  The intent is to remain in close alignment with the POSIX standard.\n  \u2014 end\n  note\n  ] A separate\n  errno\n  value shall be provided for each thread.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1504593900, "post_id": 46048344, "comment_id": 79056400, "body": "And why should we check that code in the context of this question?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1504594514, "post_id": 46048344, "comment_id": 79056729, "body": "Then you should show why/how in the argument. This is a link only answer that shows little or no effort at all. (I&#39;ve looked at the code and it certainly doesn&#39;t help handle error conditions correctly and or portably). <a href=\"https://github.com/msharov/ustl/issues/25\" rel=\"nofollow noreferrer\">A word</a> from its project leader: <b><i>&quot;Windows is not and will not be supported. We should all do our part to discourage the existence of Windows.&quot;</i></b>"}, {"owner": {"reputation": 1714, "user_id": 7404323, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jYEFn.png?s=128&g=1", "display_name": "sailfish009", "link": "https://stackoverflow.com/users/7404323/sailfish009"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1504595284, "post_id": 46048344, "comment_id": 79057171, "body": "windows support problem is irrelevant, i only point fstream implementation."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 5, "creation_date": 1504595309, "post_id": 46048344, "comment_id": 79057188, "body": "Wow. So, you didn&#39;t read the question. In fact, not even the very first word. Of the title."}], "tags": [], "owner": {"reputation": 1714, "user_id": 7404323, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jYEFn.png?s=128&g=1", "display_name": "sailfish009", "link": "https://stackoverflow.com/users/7404323/sailfish009"}, "is_accepted": false, "score": -2, "last_activity_date": 1504593092, "creation_date": 1504593092, "answer_id": 46048344, "question_id": 45840686, "link": "https://stackoverflow.com/questions/45840686/portable-way-to-read-a-file-in-c-and-handle-possible-errors/46048344#46048344", "title": "Portable way to read a file in C++ and handle possible errors", "body": "<p>check this code:</p>\n\n<p>uSTL is a partial implementation of the C++ standard library that focuses on\ndecreasing the memory footprint of user executables.</p>\n\n<p><a href=\"https://github.com/msharov/ustl/blob/master/fstream.cc\" rel=\"nofollow noreferrer\">https://github.com/msharov/ustl/blob/master/fstream.cc</a></p>\n"}, {"tags": [], "owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1548018702, "creation_date": 1548018702, "answer_id": 54281022, "question_id": 45840686, "link": "https://stackoverflow.com/questions/45840686/portable-way-to-read-a-file-in-c-and-handle-possible-errors/54281022#54281022", "title": "Portable way to read a file in C++ and handle possible errors", "body": "<p>People on boost-users mailing list pointed out that the <a href=\"https://www.boost.org/doc/libs/1_69_0/libs/beast/doc/html/index.html\" rel=\"nofollow noreferrer\">boost.beast</a> library has OS-independent API for basic file IO <strong>including proper error handling</strong>. There are three implementations of the <a href=\"https://www.boost.org/doc/libs/1_69_0/libs/beast/doc/html/beast/concepts/File.html\" rel=\"nofollow noreferrer\">file concept</a> out-of-the-box: POSIX, stdio and win32. The implementations support RAII (automatic closing on destruction) and move semantics. The POSIX file model automatically handles <code>EINTR</code> error. Basically this is sufficient and convenient to portably read a file chunk by chunk and, for example, explicitly handle the situation of absence of a file:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>using namespace boost::beast;\nusing namespace boost::system;\n\nfile f;\nerror_code ec;\nf.open(\"/path/to/file\", file_mode::read, ec);\nif(ec == errc::no_such_file_or_directory) {\n    // ...\n} else {\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 4287, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3901, "favorite_count": 2, "answer_count": 5, "score": 16, "last_activity_date": 1568145156, "creation_date": 1503493779, "last_edit_date": 1568145156, "question_id": 45840686, "link": "https://stackoverflow.com/questions/45840686/portable-way-to-read-a-file-in-c-and-handle-possible-errors", "title": "Portable way to read a file in C++ and handle possible errors", "body": "<p>I want to do a simple thing: read the first line from a file, and do a proper error reporting in case there is no such file, no permission to read the file and so on.</p>\n\n<p>I considered the following options:</p>\n\n<ul>\n<li><code>std::ifstream</code>. Unfortunately, there is no portable way to report system errors. Some other answers suggest checking <code>errno</code> after reading failed, but the standard does not guarantee that <code>errno</code> is set by any functions in iostreams library.</li>\n<li>C style <code>fopen</code>/<code>fread</code>/<code>fclose</code>. This works, but is not as convenient as iostreams with <code>std::getline</code>. I'm looking for C++ solution.</li>\n</ul>\n\n<p>Is there any way to accomplish this using C++14 and boost?</p>\n"}, {"tags": ["c++", "regex", "lambda"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1503493915, "post_id": 45840508, "comment_id": 78638781, "body": "<i>&quot;I&#39;m suspecting the link_match object is not being initialized properly...&quot;</i> can you put a breakpoint in and check?"}, {"owner": {"reputation": 601, "user_id": 1353535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91bbd6bf603aa89fb88f7005fac64d58?s=128&d=identicon&r=PG", "display_name": "user1353535", "link": "https://stackoverflow.com/users/1353535/user1353535"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1503494573, "post_id": 45840508, "comment_id": 78639337, "body": "It seems to be initialized properly when im debugging, but the regex search still fails."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1503494628, "post_id": 45840508, "comment_id": 78639383, "body": "Does it fail with flag <code>-O3</code> and without <code>std::optimize</code>?"}, {"owner": {"reputation": 601, "user_id": 1353535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91bbd6bf603aa89fb88f7005fac64d58?s=128&d=identicon&r=PG", "display_name": "user1353535", "link": "https://stackoverflow.com/users/1353535/user1353535"}, "edited": false, "score": 0, "creation_date": 1503494729, "post_id": 45840508, "comment_id": 78639478, "body": "yes, even without the std::optimize flag it fails."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1503495103, "post_id": 45840508, "comment_id": 78639806, "body": "Try it with <code>-O2</code> so we can narrow it down to the <code>GCC</code> flags, what would be the result?"}, {"owner": {"reputation": 601, "user_id": 1353535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91bbd6bf603aa89fb88f7005fac64d58?s=128&d=identicon&r=PG", "display_name": "user1353535", "link": "https://stackoverflow.com/users/1353535/user1353535"}, "edited": false, "score": 0, "creation_date": 1503495338, "post_id": 45840508, "comment_id": 78640000, "body": "-O2 seems to work fine. I think its probably a bug with my compiler gcc 6.2."}, {"owner": {"reputation": 2374, "user_id": 8491726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550562035006492/picture?type=large", "display_name": "Artemy Vysotsky", "link": "https://stackoverflow.com/users/8491726/artemy-vysotsky"}, "edited": false, "score": 0, "creation_date": 1503497735, "post_id": 45840508, "comment_id": 78642053, "body": "Could you move the link_match definition into the lambda body?"}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1503498605, "post_id": 45840508, "comment_id": 78642785, "body": "To get to the bottom of it you can try <code>-O2</code> and then add <code>-O3</code> flags manually one by one from <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html\" rel=\"nofollow noreferrer\">here</a> and then see which is causing the failure. I would be interested to know."}, {"owner": {"reputation": 601, "user_id": 1353535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91bbd6bf603aa89fb88f7005fac64d58?s=128&d=identicon&r=PG", "display_name": "user1353535", "link": "https://stackoverflow.com/users/1353535/user1353535"}, "edited": false, "score": 0, "creation_date": 1503499394, "post_id": 45840508, "comment_id": 78643501, "body": "This is definitely a compiler issue. I just upgraded to gcc 7.2 and the issue is gone completely."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1503499872, "post_id": 45840508, "comment_id": 78643918, "body": "Please mention the <code>GCC</code> version that the issue was reproduced in your question for later reference."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1503500831, "post_id": 45840508, "comment_id": 78644641, "body": "You are not explicitly capturing link_match, which could be an issue.  I suspect the optimizer skips the initialization of link_match, since it it not used within the function. You should try that.  It could still be a compiler bug, though."}], "answers": [{"comments": [{"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1503502315, "post_id": 45843546, "comment_id": 78645689, "body": "This is a good point and I guess will solve the problem on <code>GCC v6.2</code> (@user1353535 can confirm). However, it is still a compiler bug since it is a valid code to not pass the static object as part of the capture of lambda."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1503502438, "post_id": 45843546, "comment_id": 78645783, "body": "Yes.  The good news is that OP reported that gcc 7.2 doesn&#39;t exhibit the same behaviour."}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": true, "score": 0, "last_activity_date": 1503502391, "last_edit_date": 1503502391, "creation_date": 1503501267, "answer_id": 45843546, "question_id": 45840508, "link": "https://stackoverflow.com/questions/45840508/static-variables-used-from-lambdas-are-not-initialized/45843546#45843546", "title": "Static variables used from lambdas are not initialized", "body": "<p>At first glance, this seems like a compiler bug.  <code>link_match</code> is not used within its immediate scope, which may confuse the optimizer. Here's a workaround:</p>\n\n<pre><code>void scrape_link(const std::string&amp; url, std:function&lt;void()&gt; callback)\n{\n    static const std::regex link_match { \n        R\"re(href=\"([^\"]+)\")re\",\n        std::regex_constants::optimize\n    };\n\n    // force the creation of link_match by using it in the capture clause.\n\n    async_download(url,[&amp;link_match, callback=std::move(callback)] (std::vector&lt;char&gt;&amp; data)\n    {\n        std::smatch matches;\n        if(std::regex_search(data.begin(), data.end(), matches, link_match))\n            std::cout &lt;&lt; matches[1] &lt;&lt; std::endl;\n        callback();\n    });\n}\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 1353535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91bbd6bf603aa89fb88f7005fac64d58?s=128&d=identicon&r=PG", "display_name": "user1353535", "link": "https://stackoverflow.com/users/1353535/user1353535"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 45843546, "answer_count": 1, "score": 3, "last_activity_date": 1503509211, "creation_date": 1503493271, "last_edit_date": 1503509211, "question_id": 45840508, "link": "https://stackoverflow.com/questions/45840508/static-variables-used-from-lambdas-are-not-initialized", "title": "Static variables used from lambdas are not initialized", "body": "<p>I am trying to use a static variable in a lambda like this</p>\n\n<pre><code>void scrape_link(const std::string&amp; url, std:function&lt;void()&gt; callback)\n{\n    static const std::regex link_match { \n        R\"re(href=\"([^\"]+)\")re\",\n        std::regex_constants::optimize\n    };\n\n    async_download(url,[callback=std::move(callback)] (std::vector&lt;char&gt;&amp; data)\n    {\n        std::smatch matches;\n        if(std::regex_search(data.begin(), data.end(), matches, link_match))\n            std::cout &lt;&lt; matches[1] &lt;&lt; std::endl;\n        callback();\n    });\n}\n</code></pre>\n\n<p>When i compile this code without <code>-O3</code> flag I don't seem to face any issues. It works as expected. But with the flag turned on, the regex search fails everytime. I'm suspecting the <code>link_match</code> object is not being initialized properly. Any idea how to fix this?</p>\n\n<p>Note that the lambda is called asyncronously from a different thread.</p>\n\n<p>Update: It seems like it was a compiler issue. I was compiling this on gcc 6.2. I am not observing this issue in gcc 7.2.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1503493227, "post_id": 45840448, "comment_id": 78638245, "body": "Is <code>cMain</code> supposed to be a pointer?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1503493247, "post_id": 45840448, "comment_id": 78638266, "body": "What you probably meant to say was <code>(*cMain)-&gt;f()</code>, but that&#39;s still UB because <code>cMain</code> is uninitialized."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1503493580, "post_id": 45840448, "comment_id": 78638521, "body": "Shouldn&#39;t the template do <code>T* operator-&gt;() { return static_cast&lt;T*&gt;(this); } </code>?"}], "answers": [{"comments": [{"owner": {"reputation": 238, "user_id": 8181043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-amX-LhiYcBk/AAAAAAAAAAI/AAAAAAAAA1c/ShKMTBF5zWo/photo.jpg?sz=128", "display_name": "Raghu DV", "link": "https://stackoverflow.com/users/8181043/raghu-dv"}, "edited": false, "score": 0, "creation_date": 1503550229, "post_id": 45840594, "comment_id": 78664166, "body": "Lets say c1 has function f1 and c2 has function f2 how can i map a function in c &#39;f&#39; to both f1 and f2."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "reply_to_user": {"reputation": 238, "user_id": 8181043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-amX-LhiYcBk/AAAAAAAAAAI/AAAAAAAAA1c/ShKMTBF5zWo/photo.jpg?sz=128", "display_name": "Raghu DV", "link": "https://stackoverflow.com/users/8181043/raghu-dv"}, "edited": false, "score": 0, "creation_date": 1503576592, "post_id": 45840594, "comment_id": 78680428, "body": "What do you mean by both? Do you want <code>c.f()</code> to call both functions? You can do something like in Bo Persson&#39;s answer."}, {"owner": {"reputation": 238, "user_id": 8181043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-amX-LhiYcBk/AAAAAAAAAAI/AAAAAAAAA1c/ShKMTBF5zWo/photo.jpg?sz=128", "display_name": "Raghu DV", "link": "https://stackoverflow.com/users/8181043/raghu-dv"}, "edited": false, "score": 0, "creation_date": 1503577309, "post_id": 45840594, "comment_id": 78680987, "body": "the above i asked as a separate question here is the link: <a href=\"https://stackoverflow.com/questions/45854027/refer-to-function-of-different-base-class-according-to-template-parameter\" title=\"refer to function of different base class according to template parameter\">stackoverflow.com/questions/45854027/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "is_accepted": true, "score": 3, "last_activity_date": 1503493988, "last_edit_date": 1503493988, "creation_date": 1503493495, "answer_id": 45840594, "question_id": 45840448, "link": "https://stackoverflow.com/questions/45840448/c-request-for-member-is-ambiguous/45840594#45840594", "title": "C++: request for member is ambiguous", "body": "<p>The problem is that you're using pointers. You aren't calling <code>c::operator-&gt;</code> but just dereferencing <code>cMain</code> which is uninitialized and leads to UB. Removing the pointers (for the most part) fixes the problem:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass c1{\npublic:\n    void f(){std::cout&lt;&lt;\"In f1\\n\";}\n};\nclass c2{\npublic:\n    void f(){std::cout&lt;&lt;\"In f2\\n\";}\n};\n\ntemplate &lt;typename T&gt;\nclass c { // No longer derives from c1 and c2\n    T t; // No longer a pointer\npublic:\n    T* operator-&gt;() { return &amp;t; }\n};\n\nint main()\n{\n    c&lt;c1&gt; cMain; // No longer a pointer\n    cMain-&gt;f(); // Calls c::operator-&gt;() now\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/mnN5De\" rel=\"nofollow noreferrer\">see it work</a></p>\n\n<p>Of course you don't need <code>c</code> to derive from <code>c1</code> and <code>c2</code> (or anything) for this to work.</p>\n"}, {"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1503495061, "post_id": 45840804, "comment_id": 78639764, "body": "Or even <code>using T::f;</code>"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1503495409, "post_id": 45840804, "comment_id": 78640060, "body": "@Jarod42 - Right, I learned the redirection trick before there was a <code>using</code>. Hard to relearn the new language.  :-)"}], "tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 2, "last_activity_date": 1503494070, "creation_date": 1503494070, "answer_id": 45840804, "question_id": 45840448, "link": "https://stackoverflow.com/questions/45840448/c-request-for-member-is-ambiguous/45840804#45840804", "title": "C++: request for member is ambiguous", "body": "<p>If you don't particularly need the pointer semantics for something else, you can add a function to <code>c</code> that redirects to the proper base class function:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass c:public c1, c2 {\npublic:\n   void f() { T::f(); }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2251, "user_id": 6639082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44da46c9168a90de2479557760523d3d?s=128&d=identicon&r=PG&f=1", "display_name": "WindyFields", "link": "https://stackoverflow.com/users/6639082/windyfields"}, "is_accepted": false, "score": 0, "last_activity_date": 1503494104, "creation_date": 1503494104, "answer_id": 45840811, "question_id": 45840448, "link": "https://stackoverflow.com/questions/45840448/c-request-for-member-is-ambiguous/45840811#45840811", "title": "C++: request for member is ambiguous", "body": "<p>Your calling code is equivalent to </p>\n\n<pre><code>c&lt;c1&gt;* cMain;\n(*cMain).f(); // equivalent to: c&lt;c1&gt; cMain; cMain.f();\n</code></pre>\n\n<p>Value <code>*cMain</code> has type of <code>c&lt;c1&gt;</code>. Obviously, now a call to <code>f()</code> is ambiguous, because both <code>c1</code> and <code>c2</code> has <code>f()</code> function and <code>c&lt;c1&gt;</code> inherits them both. Templates are not to blame (you can make <code>class c</code> non-template and get the same result).</p>\n\n<p>If you want to call <code>-&gt;</code> operator you should say <code>(*cMain)-&gt;f();</code> but don't forget to initialize the pointer before.</p>\n"}], "owner": {"reputation": 238, "user_id": 8181043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-amX-LhiYcBk/AAAAAAAAAAI/AAAAAAAAA1c/ShKMTBF5zWo/photo.jpg?sz=128", "display_name": "Raghu DV", "link": "https://stackoverflow.com/users/8181043/raghu-dv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 1, "accepted_answer_id": 45840594, "answer_count": 3, "score": 2, "last_activity_date": 1503494104, "creation_date": 1503493126, "question_id": 45840448, "link": "https://stackoverflow.com/questions/45840448/c-request-for-member-is-ambiguous", "title": "C++: request for member is ambiguous", "body": "<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nclass c1{\n        public:\n                void f(){std::cout&lt;&lt;\"In f1\\n\";}\n};\nclass c2{\n        public:\n                void f(){std::cout&lt;&lt;\"In f2\\n\";}\n};\n\ntemplate &lt;typename T&gt;\nclass c:public c1, c2 {\n    T* pT;\npublic:\n    T* operator-&gt;() { return pT; }\n};\n\nint main()\n{\nc&lt;c1&gt;* cMain;\ncMain-&gt;f();\nreturn 0;\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>g++ cache.cc\ncache.cc: In function \u2018int main()\u2019:\ncache.cc:22:8: error: request for member \u2018f\u2019 is ambiguous\n cMain-&gt;f();\n        ^\ncache.cc:9:8: note: candidates are: void c2::f()\n   void f(){std::cout&lt;&lt;\"In f2\\n\";}\n        ^\ncache.cc:5:8: note:                 void c1::f()\n   void f(){std::cout&lt;&lt;\"In f1\\n\";}\n</code></pre>\n\n<p>why is it not accessing the function f of c1 as specified in the template? is my template usage wrong? How can i make it point to the required class using template.?</p>\n"}, {"tags": ["c++", "qt", "enums", "qml", "qtquick2"], "answers": [{"tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1503496771, "creation_date": 1503496771, "answer_id": 45841868, "question_id": 45840228, "link": "https://stackoverflow.com/questions/45840228/printing-a-qt-property-enum-value-as-a-key-string/45841868#45841868", "title": "Printing a Qt property enum value as a key string", "body": "<p>The only other way would be to access that property from a C++ helper that looks up the enum's name using the metadata generated by moc. See also <a href=\"https://stackoverflow.com/a/32661752/1329652\">this answer</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 11264, "user_id": 2056452, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/51f9d3e603983dd1aee8aadd80f17e2f?s=128&d=identicon&r=PG", "display_name": "derM", "link": "https://stackoverflow.com/users/2056452/derm"}, "edited": false, "score": 0, "creation_date": 1503499271, "post_id": 45842007, "comment_id": 78643405, "body": "If you don&#39;t know the name of the <code>ENUM</code> maybe you can return a list of all tuples <code>(ENUM, key)</code>."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1503513354, "post_id": 45842007, "comment_id": 78652280, "body": "I&#39;d suggest to not be an exemplary boy scout and split code into h and cpp for such short answers. Code is more illustrative when it is more concise and compact."}, {"owner": {"reputation": 11264, "user_id": 2056452, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/51f9d3e603983dd1aee8aadd80f17e2f?s=128&d=identicon&r=PG", "display_name": "derM", "link": "https://stackoverflow.com/users/2056452/derm"}, "reply_to_user": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1503526721, "post_id": 45842007, "comment_id": 78658453, "body": "@dtech, if I&#39;d knew how to do that, I would save me that work. However I started really learning C++ just 3 weeks ago, so forgive me my lack of knowledge. I once was googleing, how to have it in one file, and the answer I found was: &quot;Don&#39;t do it!&quot;. So I figured, it won&#39;t have priority to learn that ;-)"}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1503531606, "post_id": 45842007, "comment_id": 78659818, "body": "That&#39;s definitely recommended practice in production, but brevity and clarity outta take precedence in a QA scenario. I mean the important stuff is like 4 lines of code, no need to spread that to an entire page :)"}], "tags": [], "owner": {"reputation": 11264, "user_id": 2056452, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/51f9d3e603983dd1aee8aadd80f17e2f?s=128&d=identicon&r=PG", "display_name": "derM", "link": "https://stackoverflow.com/users/2056452/derm"}, "is_accepted": false, "score": 0, "last_activity_date": 1503499360, "last_edit_date": 1503499360, "creation_date": 1503497114, "answer_id": 45842007, "question_id": 45840228, "link": "https://stackoverflow.com/questions/45840228/printing-a-qt-property-enum-value-as-a-key-string/45842007#45842007", "title": "Printing a Qt property enum value as a key string", "body": "<p>ENUMs are used to make code more readable compared to the use of integers but faster than using strings for that purpose.<br>\nTheir intent is mainly comparison.</p>\n\n<p>If you want to have the names to it, you need to create additional structures (e.g. arrays) to look them up. Usually this is not necessary, so it is more efficient, not to do it.</p>\n\n<p>If you look at <code>console.log(typeof(Loader.Ready))</code> you will find, that the <code>ENUM</code> is indeed nothing more than a <code>number</code> - and maybe some meta object information.</p>\n\n<p>Due to the MetaObject, there is a way, even though uncomfortable... The thing is, you need to know the name of the <code>ENUM</code></p>\n\n<p><strong>enumspy.h</strong></p>\n\n<pre><code>#ifndef ENUMSPY_H\n#define ENUMSPY_H\n\n#include &lt;QObject&gt;\n\nclass EnumSpy: public QObject\n{\n    Q_OBJECT\npublic:\n    EnumSpy(QObject* parent = nullptr);\n\npublic slots:\n    QString getEnumName(QObject* object, QString name, int index) const;\n};\n\n#endif // ENUMSPY_H\n</code></pre>\n\n<p><strong>enumspy.cpp</strong></p>\n\n<pre><code>#include &lt;QMetaObject&gt;\n#include &lt;QMetaEnum&gt;\n#include &lt;QDebug&gt;\n#include \"enumspy.h\"\n\nEnumSpy::EnumSpy(QObject* parent)\n    : QObject(parent)\n{\n\n}\n\nQString EnumSpy::getEnumName(QObject *object, QString name, int index) const\n{\n    const QMetaObject* meta = object-&gt;metaObject();\n    QMetaEnum enm = meta-&gt;enumerator(meta-&gt;indexOfEnumerator(&amp;name.toStdString()[0]));\n    qDebug() &lt;&lt; meta;\n    return QString(enm.key(index));\n}\n</code></pre>\n\n<p>Register it, create an object, and call the method.</p>\n\n<blockquote>\n  <p><strong>Note:</strong> The name for the ENUMs of the Loader is <code>Status</code>\n  <code>myEnumSpy.getEnumName(myLoaderInstance, 'Status', 1) =&gt; \"Ready\"</code></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 1, "creation_date": 1503681243, "post_id": 45847459, "comment_id": 78731934, "body": "It is more generic to make it <code>Q_INVOKABLE</code> simple member function and return <code>QString</code>."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 13492, "user_id": 1430927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ruRvK.png?s=128&g=1", "display_name": "Tomilov Anatoliy", "link": "https://stackoverflow.com/users/1430927/tomilov-anatoliy"}, "edited": false, "score": 0, "creation_date": 1503681824, "post_id": 45847459, "comment_id": 78732236, "body": "@Orient I don&#39;t think there is much of a difference. Both cause the function to get moc treatment. I prefer <code>public slots</code> because I can put a bunch of function afterwards, instead of having to keep typing <code>Q_INVOKABLE</code>. The question was about printing, so its printing, which is optimal in the context of the OP, <code>Info.print(loader, &quot;status&quot;)</code> is much better than <code>console.log(Info.print(loader, &quot;status&quot;))</code>. If a string needs to be returned, the modification is trivial."}], "tags": [], "owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "is_accepted": true, "score": 3, "last_activity_date": 1503680997, "last_edit_date": 1503680997, "creation_date": 1503514613, "answer_id": 45847459, "question_id": 45840228, "link": "https://stackoverflow.com/questions/45840228/printing-a-qt-property-enum-value-as-a-key-string/45847459#45847459", "title": "Printing a Qt property enum value as a key string", "body": "<p>There is actually a way to get the enum key without knowing or even passing the enum name, if the following syntax suits your needs:</p>\n\n<pre><code>Info.print(loader, \"status\")\n</code></pre>\n\n<p>You can get it via this:</p>\n\n<pre><code>#include &lt;QMetaType&gt;\n#include &lt;QMetaProperty&gt;\n#include &lt;QMetaEnum&gt;\n#include &lt;QObject&gt;\n#include &lt;QDebug&gt;\n\nclass EnumInfo : public QObject {\n    Q_OBJECT\n  public slots:\n    void print(QObject * obj, QString prop) {\n      const QMetaObject * meta = obj-&gt;metaObject();\n      int i = meta-&gt;indexOfProperty(qUtf8Printable(prop));\n      if (i &gt; -1) {\n        QMetaProperty p = meta-&gt;property(i);\n        if (p.isEnumType()) {\n          QMetaEnum en = p.enumerator();\n          qDebug() &lt;&lt; en.name() &lt;&lt; \":\" &lt;&lt; en.key(obj-&gt;property(p.name()).toInt());\n        }\n      }\n    }\n};\n</code></pre>\n\n<p>That object is best exposed to QML as a singleton, although for more casual use a context property won't be too much overhead.</p>\n"}], "owner": {"reputation": 10571, "user_id": 122687, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9b4e0447e8d049ba853fe368765f6f76?s=128&d=identicon&r=PG", "display_name": "Stefan Monov", "link": "https://stackoverflow.com/users/122687/stefan-monov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 1, "accepted_answer_id": 45847459, "answer_count": 3, "score": 2, "last_activity_date": 1503680997, "creation_date": 1503492562, "last_edit_date": 1503515561, "question_id": 45840228, "link": "https://stackoverflow.com/questions/45840228/printing-a-qt-property-enum-value-as-a-key-string", "title": "Printing a Qt property enum value as a key string", "body": "<p>I have a QML <code>Loader</code> and on some event I want to print its <code>status</code> property, but I'm getting <code>0</code> on the console, even if I use <code>toString()</code>. So I need to always refer to the order of the enum values in qquickloader_p.h to know what's going on.</p>\n\n<p>Any other way?</p>\n"}]