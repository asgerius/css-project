[{"tags": ["c++", "hashtable"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1533168613, "post_id": 51643789, "comment_id": 90251907, "body": "1) &quot;<i>I created it with const static. I had to because it wouldn&#39;t let me otherwise</i>&quot; Sure it didn&#39;t let you otherwise - arrays must have their size known at compile time. That should have been explained to you, before giving an assignment about arrays. 2) To avoid such restriction consider using <code>std::vector</code>. Or, alternatively, if you, for some reason, can&#39;t use it - dynamic arrays. 3) If you made your array size fixed, I see no reason, for the dynamic creation of <code>item</code>s inside said array. Especially, since your <code>hash_table</code> doesn&#39;t deallocate the memory, which causes memory leaks."}], "answers": [{"tags": [], "owner": {"reputation": 2107, "user_id": 7451787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lNcOE.jpg?s=128&g=1", "display_name": "bcperth", "link": "https://stackoverflow.com/users/7451787/bcperth"}, "is_accepted": false, "score": 1, "last_activity_date": 1533169049, "creation_date": 1533169049, "answer_id": 51643910, "question_id": 51643789, "link": "https://stackoverflow.com/questions/51643789/c-hashtable-issues-with-rehash/51643910#51643910", "title": "C++ Hashtable issues with rehash", "body": "<p>Generally, to make an array bigger, you need to make a bigger array and copy the contents of the old array to the new. You figured this out!</p>\n\n<p>You are locked in to fixed array size by making table_size a constant and then declaring a fixed sized array here.</p>\n\n<pre><code>const static int tableSize = 26;\nitem* HashTable[tableSize];\n</code></pre>\n\n<p>If you make tableSize a variable above, and make the initial array more like this</p>\n\n<pre><code>item** newHashTable = new item*[tableSize];\n</code></pre>\n\n<p>then you have a better chance of succeeding! Since this is a school exercise, its not right to do the code for you...</p>\n\n<p>Generally though, in the situation where you need to change the array size during program execution, its much better to use vectors. These can be extended at will during execution, and well worth reading up and doing some examples.</p>\n"}], "owner": {"reputation": 11, "user_id": 10168322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fdde4984b6df0ac66a8109d7b8a373?s=128&d=identicon&r=PG&f=1", "display_name": "bozzard", "link": "https://stackoverflow.com/users/10168322/bozzard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533169049, "creation_date": 1533167978, "question_id": 51643789, "link": "https://stackoverflow.com/questions/51643789/c-hashtable-issues-with-rehash", "title": "C++ Hashtable issues with rehash", "body": "<p>As for my school assigment I have to update my hashtable size when it hits %70-90 load. I am having issues with rehashing the hash table. I cannot modify tableSize (because I created it with const static. I had to because it wouldn't let me otherwise). Also I cant modify HashTable as it's not modifiable value. I think my constructor is wrong but i can't figure out by my self. </p>\n\n<p>Any help is appreciated.</p>\n\n<p>hash_table.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;string&gt;\n\n#include \"hash_table.h\"\n\nusing namespace std;\n\n\nhash_table::hash_table()\n{\n    for (int i = 0; i &lt; tableSize; i++) {\n        HashTable[i] = new item;\n        HashTable[i]-&gt;name = \"\";\n        HashTable[i]-&gt;info.documentName = \"\";\n        HashTable[i]-&gt;info.count = 1;\n        HashTable[i]-&gt;info.next = NULL;\n        HashTable[i]-&gt;next = NULL;\n    }\n}\n\nint hash_table::Hash(string key)\n{\n    int hash = 0;\n    int index;\n\n    for (int i = 0; i &lt; key.length(); i++) {\n        hash = (hash + (int)key[i]) * 17;\n    }\n\n    index = hash % tableSize;\n\n    return index;\n}\n\nvoid hash_table::AddItem(string name,string document)\n{\n    int index = Hash(name);\n    int check = size / tableSize;\n\n    if(check &gt; 0.78){\n        reHash();\n    }\n\n    if (HashTable[index]-&gt;name == \"\") {\n        HashTable[index]-&gt;name = name;\n        HashTable[index]-&gt;info.documentName = document;\n        HashTable[index]-&gt;info.count = 1;\n        size++;\n    }\n    else if (HashTable[index]-&gt;name == name) {\n        if (HashTable[index]-&gt;info.documentName == document) {\n            HashTable[index]-&gt;info.count++;\n        }\n        else if (HashTable[index]-&gt;info.next != NULL) {\n            Document* checkPtr = &amp;HashTable[index]-&gt;info;\n            while (HashTable[index]-&gt;info.next != NULL) {\n                checkPtr = checkPtr-&gt;next;\n                if (checkPtr != NULL) {\n                    if (checkPtr-&gt;documentName == document) {\n                        checkPtr-&gt;count++;\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            Document* tempPtr = &amp;HashTable[index]-&gt;info;\n            Document* t = new Document;\n            t-&gt;documentName = document;\n            t-&gt;count = 1;\n            t-&gt;next = NULL;\n            while (tempPtr-&gt;next != NULL) {\n                tempPtr = tempPtr-&gt;next;\n            }\n            tempPtr-&gt;next = t;\n        }\n    }\n    else {\n        item* Ptr = HashTable[index];\n        item* n = new item;\n        n-&gt;name = name;\n        n-&gt;next = NULL;\n        while (Ptr-&gt;next != NULL) {\n            Ptr = Ptr-&gt;next;\n        }\n        Ptr-&gt;next = n;\n    }\n}\n\nint hash_table::NumberOfItemsInIndex(int index)\n{\n    int count = 0;\n\n    if (HashTable[index]-&gt;name == \"\") {\n        return count;\n    }\n    else {\n        count++;\n        item* Ptr = HashTable[index];\n        while (Ptr-&gt;next != NULL) {\n            count++;\n            Ptr = Ptr-&gt;next;\n        }\n    }\n    return count;\n}\n\nvoid hash_table::PrintTable() // CAN USE AS CALCULATING TOTAL NUMBER\n{\n    int number;\n    for (int i = 0; i &lt; tableSize; i++) {\n        number = NumberOfItemsInIndex(i);\n        cout &lt;&lt; \"----------------\" &lt;&lt; endl;\n        cout &lt;&lt; \"index = \" &lt;&lt; i &lt;&lt; endl;\n        cout &lt;&lt; HashTable[i]-&gt;name &lt;&lt; endl;\n        cout &lt;&lt; HashTable[i]-&gt;info.count &lt;&lt; endl;\n        cout &lt;&lt; \"# of items = \" &lt;&lt; number &lt;&lt; endl;\n        cout &lt;&lt; \"----------------\" &lt;&lt; endl;\n    }\n}\n\nvoid hash_table::PrintItemsInIndex(int index)\n{\n    item* Ptr = HashTable[index];\n\n    if (Ptr-&gt;name == \"empty\") {\n        cout &lt;&lt; \"index = \" &lt;&lt; index &lt;&lt; \" is empty\" &lt;&lt; endl;\n    }\n    else {\n        cout &lt;&lt; \"index \" &lt;&lt; index &lt;&lt; \"countains the following item\" &lt;&lt; endl;\n\n        while (Ptr != NULL) {\n            cout &lt;&lt; \"--------------\" &lt;&lt; endl;\n            cout &lt;&lt; Ptr-&gt;name &lt;&lt; endl;\n            cout &lt;&lt; Ptr-&gt;info.count &lt;&lt; endl;\n            cout &lt;&lt; \"--------------\" &lt;&lt; endl;\n            Ptr = Ptr-&gt;next;\n        }\n    }\n}\n\nvoid hash_table::FindString(string name)\n{\n    int index = Hash(name);\n    bool foundQuery = false;\n    item *Ptr = HashTable[index];\n    Document* checkPtr = NULL;\n\n    while (Ptr != NULL) {\n        if (Ptr-&gt;name == name) {\n            foundQuery = true;\n            checkPtr = &amp;Ptr-&gt;info;\n        }\n        Ptr = Ptr-&gt;next;\n    }\n    if (foundQuery == true) {\n        while (checkPtr != NULL) {\n            cout &lt;&lt; \"in document \" &lt;&lt; checkPtr-&gt;documentName &lt;&lt; \", \" &lt;&lt; name &lt;&lt; \" found \" &lt;&lt; checkPtr-&gt;count &lt;&lt; \" times.\" &lt;&lt; endl;\n            checkPtr = checkPtr-&gt;next;\n        }\n    }\n    else {\n        cout &lt;&lt; \"No document contains the given query\" &lt;&lt; endl;\n    }\n}\n\nvoid hash_table::reHash()\n{\n    int oldCapacity = tableSize;\n    tableSize = tableSize * 2 + 1;\n\n    item** newHashTable = new item*[tableSize];\n\n    for (int i = 0; i &lt; oldCapacity; i++) {\n        item *n = HashTable[i];\n        while (n != NULL) {\n            item *tmp = n;\n            n = n-&gt;next;\n\n            item*&amp; bucket = newHashTable[hash_table::Hash(tmp-&gt;name) % tableSize];\n            tmp-&gt;next = bucket;\n            bucket = tmp;\n        }\n    }\n\n    delete[] HashTable;\n    HashTable = newHashTable;\n}\n</code></pre>\n\n<p>hash_table.h</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;cstdlib&gt;\n\nusing namespace std;\n\n#ifndef HASH_H\n#define HASH_H\n\nstruct Document {\n    string documentName;\n    int count;\n    Document* next;\n};\n\nstruct item {\n    string name;\n    item* next;\n    struct Document info;\n};\n\n\n\n\nclass hash_table{\nprivate:\n    const static int tableSize = 26;\n    item* HashTable[tableSize];\n\npublic:\n    hash_table();\n    int Hash(string key);\n    void AddItem(string name, string document);\n    int NumberOfItemsInIndex(int index);\n    void PrintTable();\n    void PrintItemsInIndex(int index);\n    void FindString(string name);\n    void reHash();\n    int size = 0;\n\n};\n\n#endif  // !HASH_H\n</code></pre>\n"}, {"tags": ["c++", "graph", "shortest-path", "directed-graph", "weighted-graph"], "answers": [{"tags": [], "owner": {"reputation": 2077, "user_id": 4694124, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4e2b18d7cefdae9b599a884d2ae4e4c?s=128&d=identicon&r=PG", "display_name": "Lukas Barth", "link": "https://stackoverflow.com/users/4694124/lukas-barth"}, "is_accepted": false, "score": 0, "last_activity_date": 1533217231, "last_edit_date": 1533217231, "creation_date": 1533211934, "answer_id": 51653342, "question_id": 51643781, "link": "https://stackoverflow.com/questions/51643781/finding-shortest-cycle-which-includes-a-specific-edge/51653342#51653342", "title": "finding shortest cycle which includes a specific edge", "body": "<p>First, you should be using BFS, not DFS, to compute shortest paths in unweighted graphs.</p>\n\n<p>Second, it's almost impossible to figure out exactly how your code works. If you want to get meaningful answers, I'd recommend cleaning up your code. Here are some pointers:</p>\n\n<ul>\n<li>Please use variable names that describe what the variable does / means. Variable names like <code>std::vector&lt;\u2026&gt; vec</code> make your code very hard to comprehend.</li>\n<li>Add a few comments to tell us what your code does where.</li>\n<li>Please don't use thinks like <code>#define pb push_back</code>. This makes it almost impossible for everyone who is not you to read your code.</li>\n<li>You use a lot of unnecessary pointers / heap allocations (and you don't <code>delete</code> them.) Examples are <code>vec</code> or <code>recstack</code> (make that a <code>std::vector&lt;bool&gt;</code>\u2026)</li>\n<li>Use <code>std::numeric_limits</code> instead of defining your own <code>maxn</code> etc.</li>\n<li>Instead of <code>.push_back(std::make_pair(a,b))</code>, use <code>.emplace_back(a,b)</code></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 7724121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c219d8911936688c186425f110fb70dd?s=128&d=identicon&r=PG&f=1", "display_name": "Sia", "link": "https://stackoverflow.com/users/7724121/sia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1533217231, "creation_date": 1533167913, "last_edit_date": 1533216727, "question_id": 51643781, "link": "https://stackoverflow.com/questions/51643781/finding-shortest-cycle-which-includes-a-specific-edge", "title": "finding shortest cycle which includes a specific edge", "body": "<p>Hi i wanted to solve \"shortest cycle through  a given edge \" problem that is on this website <a href=\"http://rosalind.info/problems/cte/\" rel=\"nofollow noreferrer\">http://rosalind.info/problems/cte/</a> .\nsuppose our specific edge (that is our first edge in this problem) be 'E'.\ni wrote a  program to solve this problem and my algorithm is to use DFS on end_node of 'E' and it goes till encounter start_node of 'E'. it works fine for sample given on that website but when i used a large data it goes to a loop.\ni tried many examples of simple directed graphs and i didn't find why it goes to a loop.\ncan anyone show me if there is anyway that it goes to loop?</p>\n\n<p>here is my program :</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cmath&gt;\n#include &lt;algorithm&gt;\n#include &lt;map&gt;\n#include &lt;set&gt;\n#include &lt;string&gt;\n#include &lt;queue&gt;\n#include &lt;list&gt;\n#include &lt;sstream&gt;\n#include &lt;iomanip&gt;\n#include &lt;fstream&gt;\n#include &lt;stack&gt;\n\n\nusing namespace std;\n\n#define ll long long int\n#define pb push_back\n#define mk make_pair\n\nconst ll maxn = 1e5 + 3;\nconst ll inf = 1e12 + 10;\n\nvector &lt;ll&gt; cost;\n\nvoid is_cyclic(int i, bool * recstack,ll cnt,vector &lt;pair&lt;ll,ll&gt;&gt; * vec,ll ind) {\n    recstack[i] = true;\n    vector &lt;pair&lt;ll, ll&gt;&gt;::iterator it = vec[i].begin();\n    for (; it != vec[i].end(); it++) {\n        if (it-&gt;first == ind) {\n            cnt += it-&gt;second;\n            cost.pb(cnt);\n        }\n        else {\n            if (recstack[it-&gt;first] == false) {\n                is_cyclic(it-&gt;first, recstack, cnt + it-&gt;second, vec, ind);\n            }\n        }\n    }\n    recstack[i] = false;\n}\n\nint main() {\n    ll k;\n    //file &gt;&gt; k;\n    //while (k--) {\n        ll n, m;\n        cin &gt;&gt; n &gt;&gt; m;\n        ll s;\n        vector &lt;pair&lt;ll, ll&gt;&gt; * vec;\n        vec = new vector&lt;pair&lt;ll, ll&gt;&gt;[n];\n        for (int j = 0; j &lt; m; j++) {\n            ll a, b, c;\n            cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n            if (j == 0) {\n                s = a - 1;\n            }\n            vec[a - 1].pb(mk(b - 1, c));\n        }\n        bool * recstack = new bool[n];\n        for (int j = 0; j &lt; n; j++) {\n            recstack[j] = false;\n        }\n        ll cnt = 0;\n        pair &lt;ll, ll&gt; p;\n        p = vec[s][0];\n        cnt += p.second;\n        recstack[s] = true;\n        is_cyclic(p.first, recstack, cnt, vec,s);\n        if (cost.size() == 0) {\n            cout &lt;&lt; -1 &lt;&lt; \" \";\n        }\n        else {\n            sort(cost.begin(), cost.end());\n            cout  &lt;&lt; cost[0] &lt;&lt; \" \";\n        }\n        cost.clear();\n    //}\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "chrono"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1533168240, "post_id": 51643772, "comment_id": 90251828, "body": "According to <a href=\"https://en.cppreference.com/w/cpp/chrono/duration\" rel=\"nofollow noreferrer\">this</a> it would seem to be a <code>signed integer type of at least 45 bits</code>."}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 1, "creation_date": 1533168299, "post_id": 51643772, "comment_id": 90251844, "body": "It says you are casting to &quot;std::chrono::milliseconds&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1533169876, "post_id": 51643838, "comment_id": 90252118, "body": "This is why <code>auto</code> is such a good idea, sometimes you just shouldn&#39;t have to care :-)"}, {"owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "edited": false, "score": 0, "creation_date": 1533170944, "post_id": 51643838, "comment_id": 90252309, "body": "Ok, what should I do then? I need to pass this result type to another language so I need to know at least how large it is."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1533171332, "post_id": 51643838, "comment_id": 90252376, "body": "It depends. You might have code dependent of rep <code>type</code> to give appropriate type, or use your type and &quot;convert&quot; result to your type (as <code>std::int64_t</code>) (care with signed overflow :/)."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1533168414, "creation_date": 1533168414, "answer_id": 51643838, "question_id": 51643772, "link": "https://stackoverflow.com/questions/51643772/what-is-the-actual-result-type-of-stdchronodurationcount-function/51643838#51643838", "title": "What is the actual result type of std::chrono::duration::count function", "body": "<p>From doc, <code>count</code> returns <code>rep</code> type which comes from <code>template&lt;class Rep, class Period = std::ratio&lt;1&gt;&gt; class duration;</code></p>\n\n<p>Moreover,</p>\n\n<pre><code>std::chrono::milliseconds   duration&lt;/*signed integer type of at least 45 bits*/, std::milli&gt;\n</code></pre>\n\n<p>So it is implementation specific.</p>\n"}, {"comments": [{"owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "edited": false, "score": 0, "creation_date": 1533170954, "post_id": 51643942, "comment_id": 90252312, "body": "Ok, what should I do then? I need to pass this result type to another language so I need to know at least how large it is."}, {"owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1533170972, "post_id": 51643942, "comment_id": 90252316, "body": "Just be careful of this, the <i>proper</i> type is the first one given, <code>std:chrono:milliseconds:rep</code>. Using <code>long long</code> may well be unportable if, for example, an implementation wants to provide enough bits to measure milliseconds from the big bang to the heat death :-) As to passing it to another language, if only there were some common representation. I think, if I were to invent this, I&#39;d call it, I don&#39;t know, something like &quot;text&quot; :-) Note the smileys, I&#39;m not intending to offend."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 0, "creation_date": 1533171360, "post_id": 51643942, "comment_id": 90252382, "body": "<code>sizeof</code> is the C++ way to get the number of bytes a type or variable takes.  And text is a good idea for passing among languages unless it is known a-priori that the two languages share the same binary representation for the type."}], "tags": [], "owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "is_accepted": false, "score": 1, "last_activity_date": 1533169297, "creation_date": 1533169297, "answer_id": 51643942, "question_id": 51643772, "link": "https://stackoverflow.com/questions/51643772/what-is-the-actual-result-type-of-stdchronodurationcount-function/51643942#51643942", "title": "What is the actual result type of std::chrono::duration::count function", "body": "<p>The type is <code>std::chrono::milliseconds::rep</code>.  You can inspect this type with <a href=\"https://stackoverflow.com/a/20170989/576911\">a function that prints out types</a>.  For example:</p>\n\n<pre><code>#include \"type_name.h\"\n#include &lt;chrono&gt;\n#include &lt;iostream&gt;\n\nint\nmain()\n{\n    std::cout &lt;&lt; type_name&lt;std::chrono::milliseconds::rep&gt;() &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>For me (and probably for you too), this outputs:</p>\n\n<pre><code>long long\n</code></pre>\n"}], "owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1533169297, "creation_date": 1533167827, "question_id": 51643772, "link": "https://stackoverflow.com/questions/51643772/what-is-the-actual-result-type-of-stdchronodurationcount-function", "title": "What is the actual result type of std::chrono::duration::count function", "body": "<p>What is the actual result type of <code>std::chrono::duration::count</code> function like in the following case:</p>\n\n<pre><code>std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end - begin).count();\n</code></pre>\n\n<p>It <a href=\"https://en.cppreference.com/w/cpp/chrono/duration/count\" rel=\"nofollow noreferrer\">seems</a> like it is some <code>rep</code> type but what is it actually? I need to know the exact type to pass it to some other languages. Can I just cast it to <code>long long</code>, for example?</p>\n"}, {"tags": ["c++", "factorial"], "comments": [{"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1533167400, "post_id": 51643698, "comment_id": 90251648, "body": "Why do you need a special condition for <code>num &gt; 20</code>? Does the math of how we calculate factorial change?"}, {"owner": {"reputation": 1, "user_id": 10002479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe7943699225f79d1be8fc44884eabe?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedEz", "link": "https://stackoverflow.com/users/10002479/confusedez"}, "reply_to_user": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1533167519, "post_id": 51643698, "comment_id": 90251668, "body": "@scohe001 It&#39;s simple to find the factorial of 20! or below, but c++ can&#39;t store any number&#39;s factorial past that, so I would have to use a different method. I could use the same method for all numbers, but I don&#39;t think it would matter."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 1, "creation_date": 1533167635, "post_id": 51643698, "comment_id": 90251692, "body": "Ahh I see. If you use your &quot;more complex&quot; method for <i>all</i> numbers it&#39;ll make it easier to debug since you&#39;ll be able to follow the math on say 6! as opposed to 21! ;)"}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 2, "creation_date": 1533167857, "post_id": 51643698, "comment_id": 90251742, "body": "Stack Overflow isn&#39;t a free debugging service, and you should show your attempts at debugging the code with a debugger or other simpler methods such as debug print statements. You can also test each part of the code separately to figure out exactly which part of the code is causing the problem, and make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. This won&#39;t be the only time you end up with a bug in your code, and learning to debug your programs will help you much more than having someone find the bug for you. Debugging your own code is an important skill in programming. See <a href=\"http://idownvotedbecau.se/nodebugging/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/nodebugging</a>."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 2, "creation_date": 1533167904, "post_id": 51643698, "comment_id": 90251752, "body": "Also, quick tip....after your loop to populate <code>multFactorial</code>, <code>num</code> will always be <code>0</code>. The next thing you do is enter a loop whose condition is <code>while (num &gt; 1)</code>..."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533167916, "post_id": 51643698, "comment_id": 90251755, "body": "Debugger.  Use a debugger.  A debugger will help you step through your code, watching values in variables.  Often, using a debugger is faster than correctly posting to StackOverflow and <i>waiting</i> for somebody else to inspect or debug your program for you.  Please edit your post with the text results of your debugging session."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1533169903, "post_id": 51643698, "comment_id": 90252124, "body": "<code>if (num &gt; 20)</code> in <code>else if (num &gt; 20)</code> is unnecessary since the other condition is <code>if (num &lt;= 20)</code>."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1533182567, "post_id": 51643698, "comment_id": 90254541, "body": "&quot;is there a better way to solve this?&quot;  in what way better?  For &quot;ease of use&quot; I choose Gnu MP&#39;s  mpz_class, a multi-precision  integer, and the obvious for loop.  20 Factorial takes 2 us and generates 19 digit value.  100,000 factorial takes 1.7 seconds, and generates 456,574 digit (unreadable) value."}], "answers": [{"tags": [], "owner": {"reputation": 2107, "user_id": 7451787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lNcOE.jpg?s=128&g=1", "display_name": "bcperth", "link": "https://stackoverflow.com/users/7451787/bcperth"}, "is_accepted": false, "score": 1, "last_activity_date": 1533173761, "last_edit_date": 1533173761, "creation_date": 1533168053, "answer_id": 51643797, "question_id": 51643698, "link": "https://stackoverflow.com/questions/51643698/factorial-function-only-returning-inputted-answer-in-c/51643797#51643797", "title": "Factorial function only returning inputted answer in C++?", "body": "<p>Factorials of large numbers results in huge numbers. This can be accommodated in languages like C, C++ etc by putting the results into arbitrary length strings.</p>\n\n<p>Here is an algorithm for that - similar to yours.</p>\n\n<p><a href=\"https://www.geeksforgeeks.org/factorial-large-number/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/factorial-large-number/</a></p>\n\n<p>Best advice is to check your code against this.\nUse a debugger if you have one and step through the code line by line.\nIf not print out intermediate results and compare with expected.</p>\n\n<p><strong>EDIT:</strong> As per review comment, the code at above ref is similar to below- just in case link is broken in future.</p>\n\n<pre><code>// C++ program to compute factorial of big numbers\n#include&lt;iostream&gt;\nusing namespace std;\n\n// Maximum number of digits in output\n#define MAX 100   // change to whatever value you need\n\nint multiply(int x, int res[], int res_size);\n\n// Calculate factorial of large number\nvoid factorial(int n)\n{\n    int res[MAX];\n\n    // Initialize result\n    res[0] = 1;\n    int res_size = 1;\n\n    // Apply factorial formula\n    for (int x=2; x&lt;=n; x++)\n        res_size = multiply(x, res, res_size);\n\n    // print out the result \n    cout &lt;&lt; \"Factorial is \\n\";\n    for (int i=res_size-1; i&gt;=0; i--)\n        cout &lt;&lt; res[i];\n}\n\n// Multiplies x with the number represented by res[].\n// res_size is size of res[] or number of digits in the \n// number represented by res[]. \n\nint multiply(int x, int res[], int res_size)\n{\n    int carry = 0;  // Initialize carry\n\n    // One by one multiply n with individual digits of res[]\n    for (int i=0; i&lt;res_size; i++)\n    {\n        int prod = res[i] * x + carry;\n\n        // Store last digit of 'prod' in res[]  \n        res[i] = prod % 10;  \n\n        // Put rest in carry\n        carry  = prod/10;    \n    }\n\n    // Put carry in res and increase result size\n    while (carry)\n    {\n        res[res_size] = carry%10;\n        carry = carry/10;\n        res_size++;\n    }\n    return res_size;\n}\n\n// Main program\nint main()\n{\n    //put code here to read a number\n\n    factorial(50); // take 50 for example\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10002479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe7943699225f79d1be8fc44884eabe?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedEz", "link": "https://stackoverflow.com/users/10002479/confusedez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533173761, "creation_date": 1533167159, "question_id": 51643698, "link": "https://stackoverflow.com/questions/51643698/factorial-function-only-returning-inputted-answer-in-c", "title": "Factorial function only returning inputted answer in C++?", "body": "<p>I have to create a program which calculates the factorial of any number, the problem is if I input any number above 20 it just returns that number. What in my else if statement could be causing this and is there a better way to solve this? ( this function is called in main and works if num &lt;= 20)</p>\n\n<pre><code>void factorial() {\n\n//User input for number\nlong long num;\nstd::cout &lt;&lt; \"Input any positive integer to find its factorial: \";\nstd::cin &gt;&gt; num;\n\nunsigned long long numFact = 1;\nif (num &lt;= 20) {\n\n    while (num &gt; 0) {\n        numFact = numFact * num;\n        num = num - 1;\n    }\n    std::cout &lt;&lt; numFact;\n}\n\nelse if (num &gt; 20) {\n\n    std::vector&lt;int&gt; multFactorial;\n\n    //stores num as seperate elements in vector multFactorial\n    while (num &gt; 0) {\n        int remain = num % 10;\n        num = num / 10;\n        multFactorial.insert(multFactorial.begin(), remain);\n    }\n    std::vector&lt;int&gt; answer;\n    std::vector&lt;int&gt; answerFinal;\n\n    //Manually multiplies elements in multFactorial\n    //Then adds new vectors created by multiplying to get final answer\n    //Repeats until factorial is solved\n    //Ex: 21 * 20; 0 * 1 and 0 * 2 stored as {0 , 0}\n    //2*1 and 2*2 stored as {4, 2, 0}\n    //Vectors will be addes to get {4, 2, 0} and then that will be multiplied \nby 19 until num = 1\n    while (num &gt; 1) {\n\n        for (int i = multFactorial.size() - 1; i &gt;= 0; i--) {\n            int remain1 = ((num - 1) % 10) * multFactorial[i];\n            answer.insert(answer.begin(), remain1);\n            int remain2 = (((num - 1) / 10) * multFactorial[i]);\n            answerFinal.insert(answerFinal.begin(), remain2);\n        }\n\n        answerFinal.insert(answerFinal.begin(), 0);\n\n        //Adds vectors to get final value seperate as digits\n        for (int i = multFactorial.size() - 1; i &gt;= 0; i--) {\n            multFactorial[i] = answer[i] + answerFinal[i];\n        }\n        num = num - 1;\n\n    }\n    //Prints what should be the factorial of the number input\n    for (size_t i = 0; i &lt; multFactorial.size(); i++) {\n        std::cout &lt;&lt; multFactorial[i];\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c++", "shared-ptr", "c++17", "smart-pointers"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1533166378, "post_id": 51643548, "comment_id": 90251447, "body": "Since you&#39;re not directly allocating the <code>Node_ptr&lt;T&gt; *</code> what you&#39;re doing may seem &quot;pretty bad&quot;, but it also <i>works</i>, I see no reason to wrap shared pointers around shared pointers in this case. Had you  been allocating and storing pointers to shared pointers, that would change things. All of that said, any reason you&#39;re not using a <i>reference</i> return type? I see no means in which <code>node</code> would ever be NULL in the case you&#39;re presenting. In fact, the passed <code>node</code> would also be a reference candidate."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1533167917, "post_id": 51643548, "comment_id": 90251756, "body": "Do you really need <code>shared_ptr</code> here? Do you share <i>nodes</i> between different trees or something?"}, {"owner": {"reputation": 55, "user_id": 6340589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ec0f3d7019af05a7fa7ac7957734cd?s=128&d=identicon&r=PG&f=1", "display_name": "Tinnuir", "link": "https://stackoverflow.com/users/6340589/tinnuir"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533168163, "post_id": 51643548, "comment_id": 90251814, "body": "@WhozCraig Thanks! Indeed, both starting node and the returned one can by passed by reference. I&#39;ve completely overlooked this fact, being more focused on function&#39;s body. But as you have pointed out, in the way raw pointers are used there, they pose no risks usually associated with them. Maybe I&#39;m just digging too deep :)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533193946, "post_id": 51643548, "comment_id": 90258707, "body": "If you don&#39;t share notes between trees or allow to insert one and the same node multiple times into a single tree, you&#39;d profit from smart pointers only in one single situation (node deletion), whereas you have quite some overhead for nothing in all other situations (insertion, moving nodes e. g. for tree balancing, ...) as you wouldn&#39;t actually share pointers apart from modifying the tree (where all involved nodes are known anyway...). So maybe <code>std::unique_ptr</code> is a better choice?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5920427"}, "is_accepted": true, "score": 1, "last_activity_date": 1533180742, "last_edit_date": 1533180742, "creation_date": 1533173544, "answer_id": 51644324, "question_id": 51643548, "link": "https://stackoverflow.com/questions/51643548/using-stdshared-ptr-in-pointer-to-pointer-scenario/51644324#51644324", "title": "Using std::shared_ptr in pointer to pointer scenario", "body": "<ol>\n<li><p>Use of a raw pointer is suggested when you have to allow for passing a null pointer - not true in your example; or when you have to pass a non-integral value (true in your case).  In the latter case one should still consider passing a reference rather than a raw pointer.  This is a generic suggestion - so exceptions may exist.</p></li>\n<li><p>Having noted that, you could still use a raw pointer in your function here rather safely by making find_node(...) a private function while keeping the insert(...) public. That is safe, since there is no chance of leaving the pointer dangling from inside insert(...).</p></li>\n</ol>\n\n<p>Essentially we need to guard against two possibilities with raw pointers: #1. prematurely deleting the memory the pointer points to, #2. never deleting the memory that the pointer points to.  Neither of this is possible inside your insert(...) function.  So you're safe.</p>\n\n<p>On a related note, you might consider having unique_pointer for your nodes when they are created and then converting them into shared pointers if they are to be shared by more child than one: std::move(...).</p>\n"}], "owner": {"reputation": 55, "user_id": 6340589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ec0f3d7019af05a7fa7ac7957734cd?s=128&d=identicon&r=PG&f=1", "display_name": "Tinnuir", "link": "https://stackoverflow.com/users/6340589/tinnuir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 51644324, "answer_count": 1, "score": 2, "last_activity_date": 1533180742, "creation_date": 1533165914, "last_edit_date": 1533168486, "question_id": 51643548, "link": "https://stackoverflow.com/questions/51643548/using-stdshared-ptr-in-pointer-to-pointer-scenario", "title": "Using std::shared_ptr in pointer to pointer scenario", "body": "<p>I've created a <code>Node</code> struct to be used in an implementation of binary search tree. It uses shared pointers to keep track of its children:</p>\n\n<pre><code>template &lt;class T&gt; struct Node;\n\ntemplate &lt;class T&gt;\nusing Node_ptr = std::shared_ptr&lt;Node&lt;T&gt;&gt;;\n\ntemplate &lt;class T&gt;\nstruct Node {\n  Node_ptr&lt;T&gt; left;\n  Node_ptr&lt;T&gt; right;\n  const T label;\n  ...\n};\n</code></pre>\n\n<p>Now, I'd like to have a function which given some subtree and a value will return either the node of that specific value or the place where such node should be located in future - <code>find_node</code>.</p>\n\n<p>This is how it looks at the moment:</p>\n\n<pre><code>template &lt;class T&gt;\nauto* find_node(Node_ptr&lt;T&gt;* node, const T&amp; value) {\n  for (; *node &amp;&amp; (*node)-&gt;label != value\n       ; node = value &lt; (*node)-&gt;label ? &amp;(*node)-&gt;left : &amp;(*node)-&gt;right);\n\n  return node;\n}\n</code></pre>\n\n<p>Pretty bad. But it works:</p>\n\n<pre><code>template &lt;class T&gt;\nclass Binary_search_tree {\npublic:\n  // correctly inserts consecutive values\n  void insert(const T&amp; value) {\n    if (auto* node = find_node(&amp;root, value); !*node)\n      *node = std::make_shared&lt;Node&lt;T&gt;&gt;(value);\n  }\n  ...\nprivate:\n  Node_ptr&lt;T&gt; root;\n  ...\n};\n</code></pre>\n\n<p>I could rewrite <code>find_node</code> to use <code>std::shared_ptr&lt;Node_ptr&lt;T&gt;&gt;</code> instead of <code>Node_ptr&lt;T&gt;*</code> but it would look even worse. Or would it?</p>\n\n<p>How should I handle such situations?</p>\n\n<p>edit: As it's been pointed out, the function can be simplified a bit by taking a reference to starting node, and returning a reference to a node:</p>\n\n<pre><code>template &lt;class T&gt;\nNode_ptr&lt;T&gt;&amp; find_node(Node_ptr&lt;T&gt;&amp; node_ref, const T&amp; value) {\n  auto* node = &amp;node_ref;\n  ...\n  return *node;\n}\n</code></pre>\n"}, {"tags": ["c++", "linux"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1533165956, "post_id": 51643541, "comment_id": 90251346, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/18458064/608639\">How to refresh the screen continuously and update it in real time</a>, <a href=\"https://stackoverflow.com/q/6958972/608639\">Modifying text in the terminal</a>, <a href=\"https://stackoverflow.com/q/23205280/608639\">Updating/Refreshing text displayed on the terminal</a>, etc."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1533165995, "post_id": 51643541, "comment_id": 90251358, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4388628/c-change-output-from-cout\">C++ Change Output From &quot;cout&quot;</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1533166175, "post_id": 51643541, "comment_id": 90251402, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6958972/modifying-text-in-the-terminal\">Modifying text in the terminal</a>"}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 1, "creation_date": 1533171091, "post_id": 51643541, "comment_id": 90252340, "body": "When looking at the answers in the commented duplicates, I&#39;d prefer the ones discussing the <code>ncurses</code> library.  Disregard the answers suggesting to hard-code escape codes into your program - or even worse, suggesting <code>system(&quot;clear&quot;);</code> or <code>system(&quot;cls&quot;);</code> (seriously?!) ."}, {"owner": {"reputation": 66, "user_id": 5777915, "user_type": "registered", "profile_image": "https://graph.facebook.com/881761275227009/picture?type=large", "display_name": "Cirrus", "link": "https://stackoverflow.com/users/5777915/cirrus"}, "edited": false, "score": 0, "creation_date": 1533214955, "post_id": 51643541, "comment_id": 90271992, "body": "You should try using ncurses library. It&#39;s capable of continuous refresh without blinking and other cool options."}], "owner": {"reputation": 1, "user_id": 7355388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5faa33da967b952ccd12f74ae4e8f7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Undertow", "link": "https://stackoverflow.com/users/7355388/undertow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533166086, "creation_date": 1533165854, "last_edit_date": 1533166086, "question_id": 51643541, "link": "https://stackoverflow.com/questions/51643541/clear-or-replace-console-output", "title": "Clear or replace console output", "body": "<p>I'm doing an alarm clock in C++ and am currently working on the program's output. The program will output the alarm time and current time on separate lines, as such:</p>\n\n<p>Your alarm is set for: 12:12 AM</p>\n\n<p>It is currently: 7:08:32 PM</p>\n\n<p>I have the program output once per second to keep track of the current time accurately, however rather than having new lines appear once per second, I was wondering if there would be a way to keep the current time on a single line, and have that line change accordingly to make the program more readable. I'm using cout for this program. Any help would be much appreciated.</p>\n"}, {"tags": ["c++", "arrays", "object", "multidimensional-array", "constructor"], "comments": [{"owner": {"reputation": 664, "user_id": 8166144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZEFuA.png?s=128&g=1", "display_name": "Azhy", "link": "https://stackoverflow.com/users/8166144/azhy"}, "edited": false, "score": 0, "creation_date": 1533165709, "post_id": 51643443, "comment_id": 90251288, "body": "Try to initiallize using float lists <code>Matrix matrix(new float[4][4]{{...},{...},{...},{...}});</code>."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 1, "creation_date": 1533165730, "post_id": 51643443, "comment_id": 90251295, "body": "Related: <a href=\"https://stackoverflow.com/q/16455029/2602718\">stackoverflow.com/q/16455029/2602718</a>"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1533165951, "post_id": 51643443, "comment_id": 90251344, "body": "<a href=\"https://stackoverflow.com/questions/7657910/arrays-initialization-body-as-function-parameter-c-array-is-it-possible\" title=\"arrays initialization body as function parameter c array is it possible\">stackoverflow.com/questions/7657910/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/31537349/initialiser-list-passed-as-function-parameter-for-array\" title=\"initialiser list passed as function parameter for array\">stackoverflow.com/questions/31537349/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/8767166/passing-a-2d-array-to-a-c-function\" title=\"passing a 2d array to a c function\">stackoverflow.com/questions/8767166/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1533167501, "post_id": 51643600, "comment_id": 90251663, "body": "Isn&#39;t that bug long fixed by now?"}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1533167565, "post_id": 51643600, "comment_id": 90251677, "body": "@o11c <a href=\"https://ideone.com/DmR8PD\" rel=\"nofollow noreferrer\">ideone</a> still yells at me if I don&#39;t have the extra set of braces, so I figured I&#39;d throw them in."}, {"owner": {"reputation": 117, "user_id": 7501404, "user_type": "registered", "profile_image": "https://graph.facebook.com/1382057821835787/picture?type=large", "display_name": "Khalid Akash", "link": "https://stackoverflow.com/users/7501404/khalid-akash"}, "edited": false, "score": 0, "creation_date": 1533167817, "post_id": 51643600, "comment_id": 90251734, "body": "@scohe001 Thank you. I&#39;ll keep your answer in mind, for this particular project, I decided to go a bit bare-bones."}], "tags": [], "owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "is_accepted": false, "score": 2, "last_activity_date": 1533166996, "last_edit_date": 1533166996, "creation_date": 1533166300, "answer_id": 51643600, "question_id": 51643443, "link": "https://stackoverflow.com/questions/51643443/how-to-create-a-constructor-that-accepts-2d-array/51643600#51643600", "title": "How to create a constructor that accepts 2D array", "body": "<p>You're using C++, so you can use <a href=\"https://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a>!</p>\n\n<p><code>std::array</code> is <a href=\"https://stackoverflow.com/a/8192275/2602718\">a little wonky</a> with initialization, so you'll need an extra set of curly braces. Here's a working example:</p>\n\n<pre><code>#include &lt;array&gt;\n\nclass foo\n{\npublic:\n    foo(std::array&lt;std::array&lt;int, 2&gt;, 3&gt; arr) { }\n};\n\nint main()\n{\n    foo f({{{1, 2}, {3, 4}, {5, 6}}});\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 423, "user_id": 9746273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c9hgs.png?s=128&g=1", "display_name": "L. Kue", "link": "https://stackoverflow.com/users/9746273/l-kue"}, "edited": false, "score": 0, "creation_date": 1533166610, "post_id": 51643604, "comment_id": 90251494, "body": "This should really be a comment, not an answer."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 423, "user_id": 9746273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c9hgs.png?s=128&g=1", "display_name": "L. Kue", "link": "https://stackoverflow.com/users/9746273/l-kue"}, "edited": false, "score": 2, "creation_date": 1533166974, "post_id": 51643604, "comment_id": 90251565, "body": "@L.Kue: That would solve OP&#39;s issue, so it is an answer. You might consider it as too short answer. Comments are mostly to ask &quot;clarification&quot;s."}, {"owner": {"reputation": 117, "user_id": 7501404, "user_type": "registered", "profile_image": "https://graph.facebook.com/1382057821835787/picture?type=large", "display_name": "Khalid Akash", "link": "https://stackoverflow.com/users/7501404/khalid-akash"}, "edited": false, "score": 0, "creation_date": 1533167179, "post_id": 51643604, "comment_id": 90251603, "body": "@Jarod42 Thank you for your response, it works well!  Does this work because I am essentially passing a pointer by declaring it like this: Matrix matrix({{......}})?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 117, "user_id": 7501404, "user_type": "registered", "profile_image": "https://graph.facebook.com/1382057821835787/picture?type=large", "display_name": "Khalid Akash", "link": "https://stackoverflow.com/users/7501404/khalid-akash"}, "edited": false, "score": 0, "creation_date": 1533167456, "post_id": 51643604, "comment_id": 90251655, "body": "@KhalidAkash: C-Arrays cannot be passed by value, so you have to pass them by pointer/reference. <code>Matrix(float initMatrix[4][4])</code> is in fact <code>Matrix(float (*initMatrix)[4])</code>."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1533166341, "creation_date": 1533166341, "answer_id": 51643604, "question_id": 51643443, "link": "https://stackoverflow.com/questions/51643443/how-to-create-a-constructor-that-accepts-2d-array/51643604#51643604", "title": "How to create a constructor that accepts 2D array", "body": "<p>The syntax would be:</p>\n\n<pre><code>Matrix(const float (&amp;m)[4][4]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "is_accepted": true, "score": 1, "last_activity_date": 1533166363, "creation_date": 1533166363, "answer_id": 51643606, "question_id": 51643443, "link": "https://stackoverflow.com/questions/51643443/how-to-create-a-constructor-that-accepts-2d-array/51643606#51643606", "title": "How to create a constructor that accepts 2D array", "body": "<p>If you want to force the dimensions you can accept a const reference to an array instead of passing the array directly:</p>\n\n<pre><code>struct Matrix {\n    Matrix(const float (&amp;initMatrix) [4][4]) {}\n};\n\nint main()\n{\n    Matrix m({{1,2,3,4},{5,6,7,8},{9,10,11,12},{13,14,15,16}});\n    return 0;\n}\n</code></pre>\n\n<p>Try it here: <a href=\"https://onlinegdb.com/ByzOQTkrQ\" rel=\"nofollow noreferrer\">https://onlinegdb.com/ByzOQTkrQ</a></p>\n\n<p>This is a good answer: <a href=\"https://stackoverflow.com/a/17569578/2193968\">https://stackoverflow.com/a/17569578/2193968</a></p>\n"}, {"tags": [], "owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "is_accepted": false, "score": 1, "last_activity_date": 1533167336, "creation_date": 1533167336, "answer_id": 51643720, "question_id": 51643443, "link": "https://stackoverflow.com/questions/51643443/how-to-create-a-constructor-that-accepts-2d-array/51643720#51643720", "title": "How to create a constructor that accepts 2D array", "body": "<p>You could just do:</p>\n\n<pre><code>struct Matrix\n{\n    float initMatrix[4][4];\n};\n\nint main()\n{\n    Matrix m{ { { 1,2,3,4 },{ 5,6,7,8 },{ 9,10,11,12 },{ 13,14,15,16 } } };\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/WeZjbY\" rel=\"nofollow noreferrer\">https://ideone.com/WeZjbY</a></p>\n"}], "owner": {"reputation": 117, "user_id": 7501404, "user_type": "registered", "profile_image": "https://graph.facebook.com/1382057821835787/picture?type=large", "display_name": "Khalid Akash", "link": "https://stackoverflow.com/users/7501404/khalid-akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 2, "accepted_answer_id": 51643606, "answer_count": 4, "score": 2, "last_activity_date": 1533167336, "creation_date": 1533165095, "question_id": 51643443, "link": "https://stackoverflow.com/questions/51643443/how-to-create-a-constructor-that-accepts-2d-array", "title": "How to create a constructor that accepts 2D array", "body": "<p>Im creating my own matrix library for education purposes.\nI created a constructor that accepts a 4x4 matrix in the form of </p>\n\n<pre><code>Matrix(float initMatrix[4][4]){\n //init operation here\n}\n</code></pre>\n\n<p>The above constructor works fine when creating the object by creating a 2D array and then using that variable to initialize this object, for example:</p>\n\n<pre><code>float my_matrix[4][4] = {{...},{...},{...},{...}}; //shortened for brevity\nMatrix matrix(my_matrix);\n</code></pre>\n\n<p>However, it fails to build when doing the following:</p>\n\n<pre><code>Matrix matrix({{...},{...},{...},{...}});\n</code></pre>\n\n<p>The compiler tells me </p>\n\n<pre><code>&gt; cannot convert initializer list argument to 'float (*)[4]'\n</code></pre>\n\n<p>So I added another constructor that looks like this:</p>\n\n<pre><code>Matrix matrix(float matrix(*)[4]){}\n</code></pre>\n\n<p>I end up getting the following compiler error.</p>\n\n<pre><code>error: C++ requires a type specifier for all declarations\n    Vytrix(float input(*)[4]){\n</code></pre>\n\n<p>Can someone show me a good flexible way of designing the constructors so that I can initialize the class in a clean way?</p>\n"}, {"tags": ["c++", "sdl-2", "sdl-image"], "comments": [{"owner": {"reputation": 1222, "user_id": 1576803, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/5fPDS.gif?s=128&g=1", "display_name": "aram", "link": "https://stackoverflow.com/users/1576803/aram"}, "edited": false, "score": 0, "creation_date": 1533173347, "post_id": 51643442, "comment_id": 90252706, "body": "Does IMG_LoadTexture works with a MVCE?"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1533183245, "post_id": 51643442, "comment_id": 90254683, "body": "I find it to be much more likely that problem is in your output code, e.g. not putting <code>\\n</code> into stdout. Or if you&#39;re on windows, you might not see anything you put into stdout at all (without special handling)."}, {"owner": {"reputation": 423, "user_id": 9746273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c9hgs.png?s=128&g=1", "display_name": "L. Kue", "link": "https://stackoverflow.com/users/9746273/l-kue"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1533206153, "post_id": 51643442, "comment_id": 90266096, "body": "I thought this was a pretty solid MVCE, but no, reducing the code has not helped me get this to work. @keltar I&#39;ve tried a number of different print commands, none of them have yielded any result (including adding \\n or std::endl, as well as string concatenation or using std::cerr instead)"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1533206577, "post_id": 51643442, "comment_id": 90266392, "body": "@L.Kue my statement was more about can you get anything printed at all, not related to <code>SDL_image</code>. As for the MCVE part - it is neither compilable nor verifyable (which would require OS, toolchain, library versions, and your image file). Have you initialised SDL_image with PNG flag set? What return value <code>IMG_Init</code> gave you?"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 2, "creation_date": 1533225556, "post_id": 51643442, "comment_id": 90279390, "body": "Well it clearly failed to initialise, and exited before even trying to load your PNG, but I can&#39;t imagine situation when it doesn&#39;t set error message (not that it required to - but the code of SDL_image is not that big). I recommend stepping through IMG_Init (probably even building debug libraries), but it is up to you; actual problem is most likely it being unable to load <code>libpng*.dll</code> becuause it isn&#39;t in system32 or executable&#39;s directory, or have wrong architecture (like 32bit dll but 64bit executable)."}], "owner": {"reputation": 423, "user_id": 9746273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c9hgs.png?s=128&g=1", "display_name": "L. Kue", "link": "https://stackoverflow.com/users/9746273/l-kue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1225, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533219265, "creation_date": 1533165089, "last_edit_date": 1533219265, "question_id": 51643442, "link": "https://stackoverflow.com/questions/51643442/sdl2-image-img-init-returns-0-with-img-geterror-being-empty", "title": "SDL2 image - IMG_Init() returns 0, with IMG_GetError() being empty", "body": "<p>I'm trying to load a <code>png</code> image with SDL2. However, even though the file exists and the renderer is created correctly, <code>IMG_LoadTexture</code> will only return a nullptr, for no apparent reason.</p>\n\n<p>The function I'm using <code>IMG_LoadTexture</code> in looks like this, where <code>texture</code> is a <code>SDL_Texture*</code>:</p>\n\n<pre><code>void setTexture(const char* filePath) {\n    // check if the specified file exists\n    assert(utils::fileExists(filePath) &amp;&amp; \"Texture file does not exist!\");\n\n    // this should set the texture, but never succeeds\n    texture = IMG_LoadTexture(Game::renderer, filePath);\n    if (!texture) {\n        // error handling, this is always true\n    }\n}\n</code></pre>\n\n<p>The assert passes, so the file was found. <code>filePath</code> looks something like <code>\"assets/texture.png\"</code>. The <code>Game::renderer</code> is set beforehand and looks like this:</p>\n\n<pre><code>static SDL_Renderer* renderer; // in header\n\nrenderer = SDL_CreateRenderer(window, -1, 0); // in implementation\nif(renderer) {\n    SDL_SetRenderDrawColor(renderer, 100, 200, 255, 255);\n} else {\n// error handling and quit\n}\n</code></pre>\n\n<p>However, despite <code>IMG_LoadTexture</code> not returning a proper <code>SDL_Texture*</code>, <code>IMG_GetError()</code> is simply empty, meaning</p>\n\n<pre><code>std::cout &lt;&lt; IMG_GetError();\n</code></pre>\n\n<p>after calling <code>IMG_LoadTexture</code> does not output anything.</p>\n\n<p>Seeing as I'm at a complete loss as to why this happens, I hope someone can help me here.</p>\n\n<p>EDIT: As requested, here is a more complete, compilable version of the program that produces the same error.</p>\n\n<p>I'm on Windows 10 Home 64-bit, using the 32-bit version of MingW-w64 to compile on C++17. My SDL2 version is 2.0.8, and my SDL2_image version is 2.0.3.</p>\n\n<p>Here is the image I would like to load:\n<a href=\"https://i.stack.imgur.com/irJIO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/irJIO.png\" alt=\"player\"></a></p>\n\n<p>The image is contained inside a folder called <code>assets</code> in the original directory and the build directory. (I use CMake to remove the folder in the build directory pre-build and copy paste it post-build).</p>\n\n<p>And here is the code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;SDL2/SDL.h&gt;\n#include &lt;SDL2/SDL_image.h&gt;\n\nvoid quit(SDL_Window* window, SDL_Renderer* renderer) {\n    SDL_DestroyWindow(window);\n    SDL_DestroyRenderer(renderer);\n    IMG_Quit();\n    SDL_Quit();\n    std::cout &lt;&lt; \"Quit Test.\" &lt;&lt; std::endl;\n}\n\nint main(int argv, char** argc) {\n\n    if (SDL_Init(SDL_INIT_EVERYTHING) == 0) {\n        std::cout &lt;&lt; \"SDL initialized\" &lt;&lt; std::endl;\n    } else {\n        std::cerr &lt;&lt; \"Failed to initialize SDL\" &lt;&lt; std::endl;\n        std::cerr &lt;&lt; SDL_GetError() &lt;&lt; std::endl;\n        return 1;\n    }\n    auto window = SDL_CreateWindow(\"Test\", SDL_WINDOWPOS_CENTERED, SDL_WINDOWPOS_CENTERED, 1280, 720, 0);\n    if (window) {\n        std::cout &lt;&lt; \"Window created.\" &lt;&lt; std::endl;\n    } else {\n        std::cerr &lt;&lt; \"Failed to create window.\" &lt;&lt; std::endl;\n        return 2;\n    }\n\n    auto initError = IMG_Init(IMG_INIT_PNG);\n    if (initError == IMG_INIT_PNG) {\n        std::cout &lt;&lt; \"SDL_image initialized\" &lt;&lt; std::endl;\n    } else {\n        std::cerr &lt;&lt; \"Failed to initialize SDL_image\" &lt;&lt; std::endl;\n        std::cerr &lt;&lt; \"Return value: \" &lt;&lt; initError &lt;&lt; std::endl;\n        std::cerr &lt;&lt; \"Error flags: \" &lt;&lt; IMG_GetError() &lt;&lt; std::endl;\n        return 3;\n    }\n\n    auto renderer = SDL_CreateRenderer(window, -1, 0);\n    if (renderer) {\n        SDL_SetRenderDrawColor(renderer, 100, 200, 255, 255);\n        std::cout &lt;&lt; \"Renderer created.\" &lt;&lt; std::endl;\n    } else {\n        std::cerr &lt;&lt; \"Failed to create renderer.\" &lt;&lt; std::endl;\n        std::cerr &lt;&lt; SDL_GetError() &lt;&lt; std::endl;\n        return 4;\n    }\n\n    auto texture = IMG_LoadTexture(renderer, \"assets/player.png\");\n    if (!texture) {\n        std::cerr &lt;&lt; \"Failed to load texture!\" &lt;&lt; std::endl;\n        std::cerr &lt;&lt; IMG_GetError() &lt;&lt; std::endl;\n        return 5;\n    }\n\n    quit(window, renderer);\n\n    return 0;\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>SDL initialized\nWindow created.\nFailed to initialize SDL_image\nReturn value: 0\nError flags:\n\nProcess finished with exit code 3\n</code></pre>\n"}, {"tags": ["c++", "compiler-errors", "pass-by-reference", "lvalue"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1533164991, "post_id": 51643409, "comment_id": 90251149, "body": "Just use <code>var += 1;</code> I am wondering whether I should vote to close for typo."}, {"owner": {"reputation": 1, "user_id": 10168231, "user_type": "registered", "profile_image": "https://graph.facebook.com/682660115410704/picture?type=large", "display_name": "Hannah Louise", "link": "https://stackoverflow.com/users/10168231/hannah-louise"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533165899, "post_id": 51643409, "comment_id": 90251329, "body": "When I remove the &amp;, it tells me undefined reference to function(var)"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533165957, "post_id": 51643409, "comment_id": 90251348, "body": "It&#39;s hard to suggest what to do without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 0, "creation_date": 1533166854, "post_id": 51643409, "comment_id": 90251540, "body": "It looks like the function definition for <code>addActivities()</code> takes three arguments: an array of structs, a pointer to int, and then an int (as a reference). You appear to be passing it an array of structs, an int, and another int. That&#39;s assuming that the error arises from your call directly underneath <code>&#47;&#47;unrelated code...</code>."}, {"owner": {"reputation": 1, "user_id": 10168231, "user_type": "registered", "profile_image": "https://graph.facebook.com/682660115410704/picture?type=large", "display_name": "Hannah Louise", "link": "https://stackoverflow.com/users/10168231/hannah-louise"}, "edited": false, "score": 0, "creation_date": 1533167105, "post_id": 51643409, "comment_id": 90251588, "body": "When I change the referenced int to int&amp; in the argument, it tells me: invalid conversion from int* to int. Which part of it should be changed to make it match? (For the referenced int?)"}, {"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 0, "creation_date": 1533167375, "post_id": 51643409, "comment_id": 90251643, "body": "I&#39;m not sure what the point of the rest of the code is, but if the function expects an int, give it an int. When you call the function and pass in &amp;var, you&#39;re actually passing the <i>address</i> of <code>var</code>, hence the error about trying to convert an <code>int*</code> (which is the <i>address</i> of an <code>int</code>) to an <code>int</code>."}, {"owner": {"reputation": 1, "user_id": 10168231, "user_type": "registered", "profile_image": "https://graph.facebook.com/682660115410704/picture?type=large", "display_name": "Hannah Louise", "link": "https://stackoverflow.com/users/10168231/hannah-louise"}, "edited": false, "score": 0, "creation_date": 1533167824, "post_id": 51643409, "comment_id": 90251736, "body": "Thanks for your help. I appreciate it. I haven&#39;t solved my issue, but I feel like I&#39;m going to need someone to look in depth into the whole thing to figure this out, so I&#39;ll ask a friend to look at it in person."}, {"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "edited": false, "score": 0, "creation_date": 1533167912, "post_id": 51643409, "comment_id": 90251754, "body": "@HannahLouise Good luck."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10168231, "user_type": "registered", "profile_image": "https://graph.facebook.com/682660115410704/picture?type=large", "display_name": "Hannah Louise", "link": "https://stackoverflow.com/users/10168231/hannah-louise"}, "edited": false, "score": 1, "creation_date": 1533165781, "post_id": 51643431, "comment_id": 90251307, "body": "There wasn&#39;t a return type because it&#39;s not a real function, I just made it like this for simplicity&#39;s sake. When I take away the &amp;, it tells me undefined reference to this variable..."}, {"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "reply_to_user": {"reputation": 1, "user_id": 10168231, "user_type": "registered", "profile_image": "https://graph.facebook.com/682660115410704/picture?type=large", "display_name": "Hannah Louise", "link": "https://stackoverflow.com/users/10168231/hannah-louise"}, "edited": false, "score": 0, "creation_date": 1533165840, "post_id": 51643431, "comment_id": 90251316, "body": "@HannahLouise I figured. Just making sure."}, {"owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "reply_to_user": {"reputation": 1, "user_id": 10168231, "user_type": "registered", "profile_image": "https://graph.facebook.com/682660115410704/picture?type=large", "display_name": "Hannah Louise", "link": "https://stackoverflow.com/users/10168231/hannah-louise"}, "edited": false, "score": 0, "creation_date": 1533166277, "post_id": 51643431, "comment_id": 90251430, "body": "@HannahLouise Can you post the full example that gives you that error?"}, {"owner": {"reputation": 1, "user_id": 10168231, "user_type": "registered", "profile_image": "https://graph.facebook.com/682660115410704/picture?type=large", "display_name": "Hannah Louise", "link": "https://stackoverflow.com/users/10168231/hannah-louise"}, "edited": false, "score": 0, "creation_date": 1533166626, "post_id": 51643431, "comment_id": 90251496, "body": "The whole thing is monstrous, but I tried to post the related bits"}], "tags": [], "owner": {"reputation": 908, "user_id": 3292279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VX393.jpg?s=128&g=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/3292279/alex-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1533165810, "last_edit_date": 1533165810, "creation_date": 1533164994, "answer_id": 51643431, "question_id": 51643409, "link": "https://stackoverflow.com/questions/51643409/lvalue-required-as-left-operand-of-assignment-incrementing-a-referenced-variabl/51643431#51643431", "title": "lvalue required as left operand of assignment (incrementing a referenced variable) C++", "body": "<p>Remove the <code>&amp;</code> from in front of <code>var</code> inside your function:</p>\n\n<pre><code>function (int &amp;var)\n{\n    //Body\n    var += 1;\n}\n</code></pre>\n\n<p>The <code>&amp;</code> inside the function acts as an address operator, which means that you're actually incrementing the <em>address</em> of <code>var</code> and not the value it points to. </p>\n\n<p>Another way of phrasing: using <code>&amp;</code> as a parameter (as you did with <code>function(int &amp;var)</code>) means that you're actually passing in <code>var</code> itself, rather than it's value. So when you increment <code>var</code> inside the function, you no longer need a reference to it, because the <code>var</code> inside function is the same <code>var</code> that was passed into <code>function()</code> (from within <code>main()</code>, for example).</p>\n\n<p>And don't forget a return type for your function. You can also increment <code>var</code> using the increment operator, like so:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nvoid increment(int &amp;var)\n{\n    var++;\n}\n\nint main() {\n  int num = 0;\n  increment(num);\n  increment(num);\n  std::cout &lt;&lt; num &lt;&lt; std::endl; // prints 2\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10168231, "user_type": "registered", "profile_image": "https://graph.facebook.com/682660115410704/picture?type=large", "display_name": "Hannah Louise", "link": "https://stackoverflow.com/users/10168231/hannah-louise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533166542, "creation_date": 1533164875, "last_edit_date": 1533166542, "question_id": 51643409, "link": "https://stackoverflow.com/questions/51643409/lvalue-required-as-left-operand-of-assignment-incrementing-a-referenced-variabl", "title": "lvalue required as left operand of assignment (incrementing a referenced variable) C++", "body": "<p>Say I have a variable in main, we'll call it var.\nI have a function that I want to be able to increment var within it.</p>\n\n<pre><code>function (int &amp;var)\n{\n    //Body\n    &amp;var += 1;\n}\n</code></pre>\n\n<p>I get the error:</p>\n\n<p>lvalue required as left operand of assignment. \nHow can I fix this?</p>\n\n<p>EDIT:</p>\n\n<pre><code>//In header file:\nvoid addActivities(struct activity activityEntry[], int &amp;activityIndex, int \n&amp;activityList);\n\n//In Main:\nstruct activity activityEntry[LIST_SIZE];\nint activityIndex = 0;\nint activityList = 0;\n//unrelated code...\ncase 1: addActivities(&amp;activityEntry[activityIndex], activityIndex, \nactivityList);\n\n//In actual function:\nvoid addActivities(struct activity activityEntry[], int *activityIndex, int \n&amp;activityList)\n{\n    //unrelated code...\n    activityList += 1;\n}\n</code></pre>\n\n<p>Then the error:</p>\n\n<p>Program3Main.cpp:(.text+0x12b): undefined reference to `addActivities(activity*, int&amp;, int&amp;)'\ncollect2: error: ld returned 1 exit status</p>\n"}, {"tags": ["c++", "variadic-templates", "c++17"], "comments": [{"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1533169176, "post_id": 51643222, "comment_id": 90252002, "body": "Interesting. It seems to me that your example is overcomplicated: you can obtain the same error (from g++; no error from clang++) with <code>#include &lt;functional&gt;  template &lt;typename T&gt; auto foo (T) { return 1;}  int main () {      auto bound = std::bind(&amp;foo&lt;int&gt;, 1); }</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1533170975, "post_id": 51643222, "comment_id": 90252317, "body": "It seems to be a gcc bug, compile as expected with clang <a href=\"http://coliru.stacked-crooked.com/a/2f54400d74897012\" rel=\"nofollow noreferrer\">Demo</a>. As workaround, you may use: <code>template &lt;typename... Args&gt; auto invoke_impl(Args... a) -&gt; decltype((a + ...)) { return ( a + ...); }</code>."}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1533198051, "post_id": 51644693, "comment_id": 90261113, "body": "Btw, it is not <code>std::bind</code> which is &quot;problematic&quot; (for the bug), but taking reference of the function."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 4, "last_activity_date": 1533177175, "creation_date": 1533177175, "answer_id": 51644693, "question_id": 51643222, "link": "https://stackoverflow.com/questions/51643222/stdbind-with-variadic-template-and-auto-return-type/51644693#51644693", "title": "std::bind with variadic template and auto return type", "body": "<p>This is definitely a gcc bug (filed <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=86826\" rel=\"nofollow noreferrer\">86826</a>).</p>\n\n<p>The solution is to just... not use <code>std::bind()</code>. There's hardly ever a reason to anyway. Lambdas are strictly superior:</p>\n\n<pre><code>template &lt;typename... Args&gt;\nauto inv(Args... args) {\n  return [=]{ return inv_impl(args...); };\n}\n</code></pre>\n"}], "owner": {"reputation": 2363, "user_id": 4588453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/51da95e02741a304f3620d3b9697eda9?s=128&d=identicon&r=PG&f=1", "display_name": "pseyfert", "link": "https://stackoverflow.com/users/4588453/pseyfert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 51644693, "answer_count": 1, "score": 4, "last_activity_date": 1533177175, "creation_date": 1533163488, "last_edit_date": 1533177107, "question_id": 51643222, "link": "https://stackoverflow.com/questions/51643222/stdbind-with-variadic-template-and-auto-return-type", "title": "std::bind with variadic template and auto return type", "body": "<p>Following the code in <a href=\"https://stackoverflow.com/q/18380820\">this question</a>, I have a <code>std::bind</code> with a variadic template function. If I try to provide a function template with <code>auto</code> return, gcc rejects the program:</p>\n\n<pre><code>#include &lt;functional&gt;\n\ntemplate &lt;typename... Args\nauto inv_impl(Args... a) { return (a + ...); }\n\ntemplate &lt;typename... Args&gt;\nauto inv(Args... args) {\n  auto bound = std::bind(&amp;inv_impl&lt;Args...&gt;, args...);\n  return bound;\n}\n\nint main() {\n  auto b = inv(1, 2);\n}\n</code></pre>\n\n<p>The compile error is:</p>\n\n<pre><code>foo.cc: In instantiation of \u2018auto inv(Args ...) [with Args = {int, int}]\u2019:\nfoo.cc:41:30:   required from here\nfoo.cc:36:25: error: no matching function for call to \u2018bind(&lt;unresolved overloaded function type&gt;, int&amp;, int&amp; \u2019\n   auto bound = std::bind(&amp;inv_impl&lt;Args...&gt;, args...);\n                ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn file included from foo.cc:2:\n/usr/include/c++/8.1.1/functional:808:5: note: candidate: \u2018template&lt;class _Func, class ... _BoundArgs&gt; typename std::_Bind_helper&lt;std::__is_socketlike&lt;_Func&gt;::value, _Func, _BoundArgs ...&gt;::type std::bind(_Func&amp;&amp;, _BoundArgs&amp;&amp; ...)\u2019\n     bind(_Func&amp;&amp; __f, _BoundArgs&amp;&amp;... __args)\n     ^~~~\n/usr/include/c++/8.1.1/functional:808:5: note:   template argument deduction/substitution failed:\nfoo.cc:36:25: note:   couldn't deduce template parameter \u2018_Func\u2019\n   auto bound = std::bind(&amp;inv_impl&lt;Args...&gt;, args...);\n                ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nIn file included from foo.cc:2:\n/usr/include/c++/8.1.1/functional:832:5: note: candidate: \u2018template&lt;class _Result, class _Func, class ... _BoundArgs&gt; typename std::_Bindres_helper&lt;_Result, _Func, _BoundArgs&gt;::type std::bind(_Func&amp;&amp;, _BoundArgs&amp;&amp; ...)\u2019  \n     bind(_Func&amp;&amp; __f, _BoundArgs&amp;&amp;... __args)\n     ^~~~\n/usr/include/c++/8.1.1/functional:832:5: note:   template argument deduction/substitution failed:\nfoo.cc:36:25: note:   couldn't deduce template parameter \u2018_Result\u2019\n   auto bound = std::bind(&amp;inv_impl&lt;Args...&gt;, args...);\n                ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nfoo.cc:37:10: error: unable to deduce \u2018auto\u2019 from \u2018bound\u2019\n   return bound;\n          ^~~~~ \nfoo.cc: In function \u2018int main()\u2019:\nfoo.cc:41:8: error: \u2018void b\u2019 has incomplete type\n   auto b = inv&lt;int, int&gt;(1, 2);\n        ^\n</code></pre>\n\n<p>As far as I see, return types spelled out by me work, and it's only <code>auto</code> return types that the compiler can't handle.</p>\n\n<p>Is there a way I can return from inv_impl without knowing the return type at code-write time?\n(I'm playing with <code>declval</code>/<code>decltype</code> constructs but I'm wondering if there's something better)</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 242, "user_id": 4978849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf0788f7c6cce9ff33488ae5a495b48?s=128&d=identicon&r=PG&f=1", "display_name": "George Arokiam", "link": "https://stackoverflow.com/users/4978849/george-arokiam"}, "edited": false, "score": 0, "creation_date": 1533163054, "post_id": 51643099, "comment_id": 90250668, "body": "What kind of code is this?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1533163099, "post_id": 51643099, "comment_id": 90250684, "body": "@HenriMenke You still need to set <code>bshowLoadingIcon</code> to <code>TRUE</code> if <code>sCurrentLevelId_5C3030</code> is neither 16, 0, nor -1."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1533163582, "post_id": 51643099, "comment_id": 90250839, "body": "What are <code>BOOL</code>, <code>TRUE</code> and <code>FALSE</code>?"}, {"owner": {"reputation": 5071, "user_id": 1124744, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2f7980bcb4c6b1c604cd0f3424f06f84?s=128&d=identicon&r=PG", "display_name": "paulm", "link": "https://stackoverflow.com/users/1124744/paulm"}, "edited": false, "score": 0, "creation_date": 1533163600, "post_id": 51643099, "comment_id": 90250842, "body": "BOOL is a nasty win32 type :)"}], "answers": [{"tags": [], "owner": {"reputation": 522, "user_id": 10008121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y2nGqLlveJ4/AAAAAAAAAAI/AAAAAAAABAY/yU19oXpYf0w/photo.jpg?sz=128", "display_name": "Soham", "link": "https://stackoverflow.com/users/10008121/soham"}, "is_accepted": false, "score": 4, "last_activity_date": 1533166053, "last_edit_date": 1533166053, "creation_date": 1533163092, "answer_id": 51643157, "question_id": 51643099, "link": "https://stackoverflow.com/questions/51643099/c-comma-operator-confusion/51643157#51643157", "title": "C++ comma operator confusion", "body": "<p>In C++, the comma operator (<code>statementX, statementY</code>) first executes <code>statementX</code>, and then <code>statementY</code>. The expression holds the value of the second statement.</p>\n\n<p>In your code, <code>bShowLoadingIcon</code> is assigned the value <code>TRUE</code>, and then the value that C++ checks for in the if statement is whether <code>sCurrentLevelId_5C3030 == -1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 4, "last_activity_date": 1533163492, "creation_date": 1533163492, "answer_id": 51643223, "question_id": 51643099, "link": "https://stackoverflow.com/questions/51643099/c-comma-operator-confusion/51643223#51643223", "title": "C++ comma operator confusion", "body": "<p>C++ only evaluates a boolean OR if it needs to. So if <code>sCurrentLevelId_5C30303</code> is <code>0</code> or <code>16</code>, the last statement never gets evaluated.</p>\n\n<p>If <code>(bShowLoadingIcon = TRUE, sCurrentLevelId_5C3030 == -1)</code> does get evaluated, it first sets <code>bShowLoadingIcon</code> to <code>TRUE</code> and then evaluates to the result of <code>sCurrentLevelId_5C3030 == -1</code>. If that's true, then <code>bShowLoadingIcon</code> will just get set back to <code>FALSE</code>.</p>\n\n<p>So in summary, <code>bShowLoadingIcon</code> is set to <code>FALSE</code>. Then if <code>sCurrentLevelId_5C3030</code> is neither <code>0</code> nor <code>16</code>, then <code>bShowLoadingIcon</code> is set to <code>TRUE</code>, only to be set back to false if <code>sCurrentLevelId_5C3030</code> is <code>-1</code>.</p>\n\n<p>So, in even more summary, <code>bShowLoadingIcon</code> is set to <code>TRUE</code> if <code>sCurrentLevelId_5C3030</code> is neither <code>0</code> nor <code>16</code> and stays that way so long as <code>sCurrentLevelId_5C303030</code> is not <code>-1</code>.</p>\n\n<p>It's equivalent to:</p>\n\n<pre><code>BOOL bShowLoadingIcon = (\n    (sCurrentLevelId_5C3030 != 0) &amp;&amp;\n    (sCurrentLevelId_5C3030 != 16) &amp;&amp;\n    (sCurrentLevelId_5C3030 != -1)) ? TRUE : FALSE:\n</code></pre>\n\n<p>Or, if you prefer:</p>\n\n<pre><code>BOOL bShowLoadingIcon = (\n    (sCurrentLevelId_5C3030 == 0) ||\n    (sCurrentLevelId_5C3030 == 16) ||\n    (sCurrentLevelId_5C3030 == -1)) ? FALSE : TRUE;\n</code></pre>\n"}], "owner": {"reputation": 5071, "user_id": 1124744, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2f7980bcb4c6b1c604cd0f3424f06f84?s=128&d=identicon&r=PG", "display_name": "paulm", "link": "https://stackoverflow.com/users/1124744/paulm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 51643223, "answer_count": 2, "score": 0, "last_activity_date": 1533166053, "creation_date": 1533162657, "question_id": 51643099, "link": "https://stackoverflow.com/questions/51643099/c-comma-operator-confusion", "title": "C++ comma operator confusion", "body": "<p>Similar question to:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12824378/how-is-the-comma-operator-being-used-here\">How is the comma operator being used here?</a></p>\n\n<pre><code>BOOL bShowLoadingIcon = FALSE;\nif (sCurrentLevelId_5C3030 == 0 || sCurrentLevelId_5C3030 == 16 || (bShowLoadingIcon = TRUE, sCurrentLevelId_5C3030 == -1))\n{\n    bShowLoadingIcon = FALSE;\n}\n</code></pre>\n\n<p>In the above code sample what values/range of sCurrentLevelId_5C3030 would cause bShowLoadingIcon to be set to TRUE. Is it possible it would be set to TRUE and also become true (overall if expression) thus also then being set back to FALSE?</p>\n\n<p>I have no idea what <code>(bShowLoadingIcon = TRUE, sCurrentLevelId_5C3030 == -1)</code> is actually doing.</p>\n"}, {"tags": ["c++", "swift", "boolean", "bluetooth-lowenergy"], "comments": [{"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1533162857, "post_id": 51643094, "comment_id": 90250615, "body": "How do you know the incoming message is received incorrectly?  Is there an error message you can show us?"}, {"owner": {"reputation": 43976, "user_id": 6541007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2xMee.jpg?s=128&g=1", "display_name": "OOPer", "link": "https://stackoverflow.com/users/6541007/ooper"}, "edited": false, "score": 0, "creation_date": 1533163265, "post_id": 51643094, "comment_id": 90250732, "body": "What do you get with <code>print(characteristic.value! as NSData)</code> ?"}, {"owner": {"reputation": 21, "user_id": 5998232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480b43a495f1682f0f77ef1b8d671fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Dario Concilio", "link": "https://stackoverflow.com/users/5998232/dario-concilio"}, "edited": false, "score": 0, "creation_date": 1533239513, "post_id": 51643094, "comment_id": 90285783, "body": "I received [STX]A\\0[ETX], then 4 character, but \\0 it should be 1 or 0 (respectively true and false). I don&#39;t know how can I format this message... Could I format in byte array? How? I would like to avoid converting the message to a string...."}, {"owner": {"reputation": 21, "user_id": 5998232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480b43a495f1682f0f77ef1b8d671fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Dario Concilio", "link": "https://stackoverflow.com/users/5998232/dario-concilio"}, "edited": false, "score": 0, "creation_date": 1533244732, "post_id": 51643094, "comment_id": 90288019, "body": "I found an approach to decode received message"}], "owner": {"reputation": 21, "user_id": 5998232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480b43a495f1682f0f77ef1b8d671fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Dario Concilio", "link": "https://stackoverflow.com/users/5998232/dario-concilio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533245716, "creation_date": 1533162583, "last_edit_date": 1533245716, "question_id": 51643094, "link": "https://stackoverflow.com/questions/51643094/swift-receives-data-from-device-by-ble", "title": "Swift receives data from device by BLE", "body": "<p>I have a device that transmits by BLE a message composed in this way: [STX]A1[ETX]</p>\n\n<p>This device use a software written in C++ and 3rd character is a boolean!</p>\n\n<p>Now, I would receive this message by iOS using swift. Other incoming message  it received correctly, but this one not.</p>\n\n<p>This is a method in C++ that trasmits:</p>\n\n<pre><code>isModeOn = (byte)data[1] == 1 ? true : false;\n\n//Send message by BLE (by Serial)\nSerial3.write(STX);\nSerial3.write(GF);\nSerial3.write(isModeOn);\nSerial3.write(ETX);\n</code></pre>\n\n<p>This is my method in swift that receives:</p>\n\n<pre><code>func peripheral(_ peripheral: CBPeripheral, didUpdateValueFor characteristic: CBCharacteristic, error: Error?) {\n    print(#function)\n    var receivedMessage: String\n\n    if characteristic.uuid == BLE_RX_UUID {\n\n        receivedMessage = NSString(data: characteristic.value!, encoding: String.Encoding.utf8.rawValue)! as String\n        processMessage(receivedMessage: \"\\(receivedMessage as String)\")\n    }\n}\n</code></pre>\n\n<p>Can anyone help me?</p>\n\n<p>UPDATE!\nI found this approach:</p>\n\n<pre><code>//Lettura fecilitata dei NSData\nstruct DataReader {\n    var data: Data\n    var offset: Int = 0\n\n    mutating func read() -&gt; UInt8 {\n        let result = data[offset]\n        offset += MemoryLayout&lt;UInt8&gt;.size\n        return result\n    }\n    mutating func read2() -&gt; UInt16 {\n        let subdata = data.subdata(in: offset..&lt;offset+MemoryLayout&lt;UInt16&gt;.size)\n        let result: UInt16 = subdata.withUnsafeBytes {(bytes: UnsafePointer&lt;UInt16&gt;) in\n            bytes.pointee.littleEndian\n        }\n        offset += MemoryLayout&lt;UInt16&gt;.size\n        return result\n    }\n}\n</code></pre>\n\n<p>with this I can received easely my data</p>\n\n<pre><code>var reader = MessageHelper.DataReader.init(data: receivedMessage, offset: 0)\n\n    for _ in 1...reader.data.count {\n        let value = reader.read()\n\n        if value == STX {\n            incomingMessage = \"\"\n        } else if value == ETX {\n            print(#function, incomingMessage)\n            commandSelector(message: incomingMessage)\n        } else {\n            if value == 0x01 {\n                incomingMessage += \"1\"\n            } else if value == 0x00 {\n                incomingMessage += \"0\"\n            } else {\n                incomingMessage += \"\\(Character(UnicodeScalar(value)))\"\n            }\n        }\n    }\n</code></pre>\n\n<p>OK! And If I need to send same message</p>\n\n<pre><code>sendMessage(message: String(\"\\(COMMAND)\\(Character(UnicodeScalar(UInt8(1))))\"), withResponde: true)\n</code></pre>\n\n<p>I have to convert UInt8(1) in UnicodeScalar and then Character, and that's it!</p>\n"}, {"tags": ["c++", "com", "atl", "throw", "idispatch"], "comments": [{"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1533161565, "post_id": 51642910, "comment_id": 90250262, "body": "@NeilButterworth, according to the links that I posted, it&#39;s part of ATL."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533161961, "post_id": 51642910, "comment_id": 90250382, "body": "<code>IDispatch::Invoke()</code> cannot throw either.  If it invokes a function of some object and that function tries to throw across a COM boundary it&#39;s undefined behaviour  (COM functions should not leak exceptions)"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1533162016, "post_id": 51642910, "comment_id": 90250396, "body": "Easy answer, COM interfaces are never allowed to throw.  Exception handling is impossible to do correctly across language runtime boundaries.  One basic reason that every IDispatch interface method <b>must</b> return an HRESULT, &quot;it didn&#39;t work&quot; is the most important detail.  Language bindings are free to turn the HRESULT into an exception, they routinely do so.  Even in C++ when you use the #import directive.  Fwiw, having to squeeze the failure of a complicated library function into a single error code is the primary reason why COM+ lost the middleware war to Java and why UWP is having trouble."}], "answers": [{"comments": [{"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1533161701, "post_id": 51642954, "comment_id": 90250309, "body": "<code>IDispatch</code> is a C++ wrapper for the COM interface, so I figured that it would implement a throwing mechanism."}, {"owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "edited": false, "score": 0, "creation_date": 1533162115, "post_id": 51642954, "comment_id": 90250416, "body": "@RemyLebeau, ah, I thought that was weird.  Yes, I&#39;m looking at <code>OAld.h</code> which is part of <code>Windows Kits</code> (<code>c:\\Program Files (x86)\\Windows Kits\\8.1\\Include\\um\\OAIdl.h</code>), which I&#39;m assuming is part of the VS install.  I&#39;m guessing that MS didn&#39;t do anything wild and make it throw as that would prolly be confusing to C/C++ devs."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1533162117, "post_id": 51642954, "comment_id": 90250418, "body": "<code>IDispatch</code> itself is NOT a C++ wrapper, it is just another COM interface like any other.  You are likely using a C++ wrapper that <b>implements</b> <code>IDispatch</code>, but that is a separate issue.  COM implementations are not allowed to throw.  But wrappers that <i>consume</i> COM interfaces MAY throw when they detect COM errors being reported (see the <a href=\"https://msdn.microsoft.com/en-us/library/0ye3k36s.aspx\" rel=\"nofollow noreferrer\"><code>_com_error</code></a> class in ATL, the <a href=\"https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comexception(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>COMException</code></a> class in .NET, etc)"}], "tags": [], "owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": true, "score": 3, "last_activity_date": 1533161650, "creation_date": 1533161650, "answer_id": 51642954, "question_id": 51642910, "link": "https://stackoverflow.com/questions/51642910/does-the-idispatchgettypeinfo-interface-thow/51642954#51642954", "title": "Does the `IDispatch::GetTypeInfo()` interface thow?", "body": "<p><em>None</em> of the standard COM interfaces will throw. COM was designed to be language agnostic, including languages that don't have exceptions.</p>\n\n<p>It's entirely possible that the implementation of a COM object might throw, but that's up to the implementation of the object itself. Normally a COM object will indicate an error by returning an error code for its HRESULT.</p>\n"}], "owner": {"reputation": 8353, "user_id": 1366368, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9CxXt.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1366368/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 51642954, "answer_count": 1, "score": 0, "last_activity_date": 1533161650, "creation_date": 1533161333, "last_edit_date": 1533161573, "question_id": 51642910, "link": "https://stackoverflow.com/questions/51642910/does-the-idispatchgettypeinfo-interface-thow", "title": "Does the `IDispatch::GetTypeInfo()` interface thow?", "body": "<p>I'm trying to find information on if the <code>IDispatch</code> interface throws, specifically if <code>IDispatch::GetTypeInfo()</code> does.  IIRC, <code>IDispatch::Invoke()</code> can, but I can't seem to find anything on the subject and the documentation <a href=\"https://docs.microsoft.com/en-us/cpp/atl/supporting-idispatch-and-ierrorinfo?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev15.query%3FappId%3DDev15IDEF1%26l%3DEN-US%26k%3Dk(OAIDL%2FIDispatch)%3Bk(IDispatch)%3Bk(DevLang-C%2B%2B)%3Bk(TargetOS-Windows)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">here</a> or <a href=\"https://docs.microsoft.com/en-us/cpp/atl/reference/idispatchimpl-class\" rel=\"nofollow noreferrer\">here</a> doesn't mention anything about this.</p>\n"}, {"tags": ["c++", "gcc", "g++", "atomic"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1533163207, "post_id": 51642780, "comment_id": 90250716, "body": "What do you see?  How does it fail?"}, {"owner": {"reputation": 1, "user_id": 5372416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54aec420112c2aa2c1792b25bcc4fadf?s=128&d=identicon&r=PG&f=1", "display_name": "S.Gupta", "link": "https://stackoverflow.com/users/5372416/s-gupta"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1533163480, "post_id": 51642780, "comment_id": 90250806, "body": "I hit that printf where it says &quot;found inconsistency&quot; i.e. the upper 64 bits are not the same as lower 64 bits. Which indicates that the 128 bits were not updated atomically."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1533165849, "post_id": 51642780, "comment_id": 90251319, "body": "<code>on different intel CPUs </code> Which CPUs?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1533166140, "post_id": 51642780, "comment_id": 90251392, "body": "duplicate of <a href=\"https://stackoverflow.com/questions/18177622/how-to-atomically-add-and-fetch-a-128-bit-number-in-c\" title=\"how to atomically add and fetch a 128 bit number in c\">stackoverflow.com/questions/18177622/&hellip;</a> ?"}, {"owner": {"reputation": 1, "user_id": 5372416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54aec420112c2aa2c1792b25bcc4fadf?s=128&d=identicon&r=PG&f=1", "display_name": "S.Gupta", "link": "https://stackoverflow.com/users/5372416/s-gupta"}, "edited": false, "score": 0, "creation_date": 1533166463, "post_id": 51642780, "comment_id": 90251460, "body": "Kamil, I did mention Ivy bridge and Broadwell. Also, I do not think it is a duplicate of the other post."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1533202675, "post_id": 51642780, "comment_id": 90263943, "body": "I would avoid mixing __sync and __atomic builtins."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5372416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54aec420112c2aa2c1792b25bcc4fadf?s=128&d=identicon&r=PG&f=1", "display_name": "S.Gupta", "link": "https://stackoverflow.com/users/5372416/s-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1533324241, "creation_date": 1533324241, "answer_id": 51678935, "question_id": 51642780, "link": "https://stackoverflow.com/questions/51642780/c-atomicity-test-for-128-bit-compare-and-swap/51678935#51678935", "title": "c++: Atomicity test for 128 bit compare and swap", "body": "<p>So What I found is that gcc does not implement 16Byte atomics in a lock free manner. After some debugging with gdb, I found that the __atomic*_16() functions in gcc, use a lock. On the other hand __sync*_16() functions use <code>lock cmpxchg16</code> instruction. So Marc's suggestion is right. You cannot mix __sync with __atomic and in general __atomic (specially for 16 byte ops) are not lock free (yet ?).</p>\n\n<p>So I ended up implementing my own primitives for 16 byte atomic load and CAS. I am pasting that code below. Using those primitives, the above code just works.</p>\n\n<pre><code>union alignas(16) atomic_u128 {\n  unsigned __int128 val;\n  struct {\n    volatile uint64_t lo, hi;\n  };\n};\n\n// Atomically read a 128 bit unsigned.\n__attribute__((always_inline)) inline unsigned __int128 AtomicLoad128(\n    register atomic_u128 *src) {\n  atomic_u128 ret;\n  __asm__ __volatile__ (\n      \"xor %%ecx, %%ecx\\n\"\n      \"xor %%eax, %%eax\\n\"\n      \"xor %%edx, %%edx\\n\"\n      \"xor %%ebx, %%ebx\\n\"\n      \"lock cmpxchg16b %2\"\n      : \"=&amp;a\"(ret.lo), \"=d\"(ret.hi)\n      : \"m\"(*src)\n      : \"cc\", \"rbx\", \"rcx\" );\n  return ret.val;\n}\n\n__attribute__((always_inline)) inline bool AtomicCAS128(\n    volatile atomic_u128 *src, atomic_u128 *expected,\n    atomic_u128 desired) {\n  bool result;\n  atomic_u128 e;\n  e.val = expected-&gt;val;\n  __asm__ __volatile__ (\n    \"lock cmpxchg16b %1\"\n    : \"=@ccz\" ( result ), \"+m\" ( *src ), \"+a\"(e.lo), \"+d\"(e.hi)\n    : \"c\" ( desired.hi ), \"b\" ( desired.lo )\n    : \"cc\");\n  if (!result)\n    expected-&gt;val = e.val;\n\n  return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5372416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54aec420112c2aa2c1792b25bcc4fadf?s=128&d=identicon&r=PG&f=1", "display_name": "S.Gupta", "link": "https://stackoverflow.com/users/5372416/s-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533324241, "creation_date": 1533160434, "last_edit_date": 1533163638, "question_id": 51642780, "link": "https://stackoverflow.com/questions/51642780/c-atomicity-test-for-128-bit-compare-and-swap", "title": "c++: Atomicity test for 128 bit compare and swap", "body": "<p>I am trying to verify the atomicity of 128 bit operations on different intel CPUs but for some reason my program is failing atomicity test on every machine I test. I have tested on ivy bridge, and broadwell CPUs. I have included the source code below. Basically it is incrementing two 64 bit counters simultaneously which are combined together to form the 128 bit integer. If atomicity is working on the CPU then the lower 64 bits must be equal to the upper 64 bits, always. And thats what this program is testing. But the test is failing all the time with the output:</p>\n\n<blockquote>\n  <p>Found inconsistency 18550, 18551</p>\n</blockquote>\n\n<p>I am running ubuntu 4.15, gcc I am compiling this code as:</p>\n\n<p><code>g++ -pthread -march=native test.cc -latomic</code></p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;thread&gt;\n\n__int128 __attribute__((__aligned__(16))) count;\n\nvoid task() {\n while(1) {\n  __int128 old_count, swapped_count;\n  do {\n    __atomic_load(&amp;count, &amp;old_count, __ATOMIC_SEQ_CST);\n    uint64_t old_lo = (uint64_t)old_count;\n    uint64_t old_hi = ((uint64_t)(old_count &gt;&gt; 64));\n    if (old_lo != old_hi) {\n      printf(\"Found inconsistency %lu, %lu\\n\", old_lo, old_hi);\n      exit(1);\n    }\n    __int128 __attribute__((__aligned__(16))) new_count;\n    new_count = old_hi + 1;\n    new_count &lt;&lt;= 64;\n    new_count |= (old_lo + 1);\n    swapped_count = __sync_val_compare_and_swap(&amp;count, old_count, new_count);\n    uint64_t new_lo = (uint64_t)swapped_count;\n    uint64_t new_hi = (uint64_t)(swapped_count &gt;&gt; 64);\n    if (new_lo != new_hi) {\n      printf(\"Found inconsistency post swap %lu, %lu\\n\", new_lo, new_hi);\n      exit(1);\n    }\n    // At this point count must have changed one way or the other\n    if (count == old_count) {\n      printf(\"Count is still the same ????\\n\");\n      exit(1);\n    }\n  }  while (old_count != swapped_count);\n }  // while (1)\n}\n\nint main() {\n  count = 0;\n  for (int i = 0; i &lt; 2; i++)\n    new std::thread(task);\n\n  while(1)\n    sleep(1);\n}\n</code></pre>\n"}, {"tags": ["c++", "oop", "vector", "istream", "istringstream"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1533158508, "post_id": 51642314, "comment_id": 90249319, "body": "Did you write person.txt yourself, or generate it using your <code>operator&lt;&lt;</code>? They look slightly mismatched."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1533158609, "post_id": 51642314, "comment_id": 90249359, "body": "Option 2 of Answer 1 in <a href=\"https://stackoverflow.com/questions/7868936/read-file-line-by-line\">Read file line by line</a> should get you going. Read in the line, pop the line in a stringstream, parse the stringstream until you run out of tokens."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1533158850, "post_id": 51642314, "comment_id": 90249436, "body": "Unrelated: <code>random_generator</code>&#39;s constructor should be  private to prevent silly buggers and the copy and move constructors and assignment operators deleted.id you want it to be a proper singleton."}, {"owner": {"reputation": 259, "user_id": 2898736, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/pmVNS.jpg?s=128&g=1", "display_name": "andres", "link": "https://stackoverflow.com/users/2898736/andres"}, "edited": false, "score": 0, "creation_date": 1533159915, "post_id": 51642314, "comment_id": 90249778, "body": "My favorite thing about this &#39;community&#39; is seeing down-votes with no justification"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533161604, "post_id": 51642314, "comment_id": 90250276, "body": "I&#39;m afraid the bad behaviour goes both ways. As often than not when I justify my downvoting, or try to justify someone else&#39;s, I get nonsense that makes it not worth the time I spent explaining. As a result, I only drop comments where I think the recipient will take the comment as intended, improve the post, and give me some chance at getting the reputation I invested in the downvote back."}], "answers": [{"tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": true, "score": 1, "last_activity_date": 1533161619, "creation_date": 1533161619, "answer_id": 51642950, "question_id": 51642314, "link": "https://stackoverflow.com/questions/51642314/in-terms-of-design-overloading-the-insertion-operator-for-a-class-member-of-typ/51642950#51642950", "title": "in terms of design: overloading the insertion operator for a class member of type vector", "body": "<p>I guess I don't see where the difficulty would be. Reading them in will be a mirror image of writing them out. If you can count on there always being five of them, then you'd basically just do something like this:</p>\n\n<pre><code>std::istream&amp; operator&gt;&gt;(std::istream&amp; input, person&amp; p)\n{\n  input &gt;&gt; p.id &gt;&gt; p.age;\n\n  p.categories.clear();\n  for (int i=0; i&lt;5; i++) {\n     char ch;\n     input &gt;&gt; ch;\n     p.categories.push_back(ch);\n  }\n\n  return input;\n}\n</code></pre>\n\n<p>If it's basically a matter of reading categories until you reach the end of the line, then it'll probably be easiest to read the line into a string, shove the string into a stringstream, then read characters until you reach the end of the stringstream:</p>\n\n<pre><code>while (input &gt;&gt; ch)\n    p.categories.push_back(ch);\n</code></pre>\n\n<p>That's not generally the fastest way to do things (creating a stringstream is somewhat slow), but given that you're dealing with I/O, parsing speed is only rarely much of a consideration.</p>\n"}], "owner": {"reputation": 259, "user_id": 2898736, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/pmVNS.jpg?s=128&g=1", "display_name": "andres", "link": "https://stackoverflow.com/users/2898736/andres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 51642950, "answer_count": 1, "score": -2, "last_activity_date": 1533161619, "creation_date": 1533157862, "last_edit_date": 1533159777, "question_id": 51642314, "link": "https://stackoverflow.com/questions/51642314/in-terms-of-design-overloading-the-insertion-operator-for-a-class-member-of-typ", "title": "in terms of design: overloading the insertion operator for a class member of type vector", "body": "<p>Attempting to read from a source file to store person objects into a container.</p>\n\n<p>A person object is initialized with a random age, id and a categories vector of five assorted chars. </p>\n\n<h2>person.hpp</h2>\n\n<pre><code>class person \n{\n    protected :\n    int age; // 0 - 99\n    int id;  // 20181104 eight numeric characters \n    std::vector&lt;char&gt; categories = {'A', 'B', 'C', 'D', 'E'}\n\n    person()\n    {\n    ...\n    std::shuffle(categories.begin(), categories.end(), \n      random_generator::instance().gen);\n    }\n}; \n</code></pre>\n\n<h2>random_generator.hpp</h2>\n\n<p>Used to shuffle the person class member categories with std::shuffle</p>\n\n<pre><code>class random_generator\n{\n    public :\n        static random_generator&amp; instance()\n        {\n            static random_generator instance;\n            return instance;\n        }\n        random_generator(random_generator const&amp;)            = delete;\n        random_generator&amp; operator=(random_generator const&amp;) = delete;\n    private :\n        random_generator(){}\n        std::random_device rd;\n        std::mt19937 gen{rd()};\n\n    ...\n    friend class person;\n};\n</code></pre>\n\n<h2>person.cpp</h2>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; output, const person&amp; p)\n{\n  output &lt;&lt; p.id &lt;&lt;  ' ' &lt;&lt; p.age; \n\n  for(char c : p.categories)\n    output &lt;&lt; c &lt;&lt; ' ';\n\n  return output;\n}\nstd::istream&amp; operator&gt;&gt;(std::istream&amp; input, person&amp; p)\n{\n  input &gt;&gt; p.id &gt;&gt; p.age;\n\n  // how can I implement this; suggested alternatives are most welcome\n\n  return input;\n}\n</code></pre>\n\n<h2>person.txt source file</h2>\n\n<p>19850319 33 A C E B D<br>\n06111990 28 B E C A D</p>\n"}, {"tags": ["c++", "boost", "boost-spirit", "boost-spirit-x3"], "answers": [{"comments": [{"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "edited": false, "score": 0, "creation_date": 1533174241, "post_id": 51643231, "comment_id": 90252861, "body": "Thank you for the insight. I was getting errors when building a more complex and complete parser and was trying to isolate the construct that was generating the compiler issue."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1533164056, "last_edit_date": 1533164056, "creation_date": 1533163539, "answer_id": 51643231, "question_id": 51642145, "link": "https://stackoverflow.com/questions/51642145/automatic-attribute-propagation-sometimes-doesnt-work-when-combining-and-op/51643231#51643231", "title": "Automatic attribute propagation sometimes doesn&#39;t work when combining `%` and optional suffixes", "body": "<p>The short answer is: magic.</p>\n\n<p>The slightly longer answer is: single-element sequence attributes are sometimes considered as their single element instead.</p>\n\n<p>You are beating out the fine edge between those cases and finding that the \"heuristic\" choices made at various implementation points leak the \"magic\".</p>\n\n<h2>Fixing Things</h2>\n\n<p>I'm not sure what version you are on, and what inputs you are testing with. Actually, the source code suggests some problems:</p>\n\n<ul>\n<li><code>alpha - ' '</code> is a pleonasm for <code>alpha</code> (' ' is not alpha)</li>\n<li>this means you might have expected words to be separated by whitespace, which they're not unless you also have a skipper <strong>and</strong> put <code>word</code> under <code>lexeme[]</code> (see <a href=\"https://stackoverflow.com/questions/17072987/boost-spirit-skipper-issues/17073965#17073965\">Boost spirit skipper issues</a>)</li>\n<li>You didn't check the results at all. Which means that the thing could possibly not parse anything, or partial input only. \"Compiling\" is not as interesting was \"working\"</li>\n</ul>\n\n<p>With that out of the way, here's my best guess at what you were trying to get at, with all examples working, so I hope that gives you some ideas:</p>\n\n<h2>Demo</h2>\n\n<ul>\n<li>Working <strong><kbd><a href=\"https://wandbox.org/permlink/HGGVTjnXFOlaPZc1\" rel=\"nofollow noreferrer\">Live On Wandbox w/boost 1.67</a></kbd></strong></li>\n<li>Broken <strong><kbd><a href=\"https://wandbox.org/permlink/5IxuIvG5dMCG1RWZ\" rel=\"nofollow noreferrer\">Live On Wandbox w/boost 1.66</a></kbd></strong> (but <a href=\"https://wandbox.org/permlink/vzXK3x8bt5SVUxL4\" rel=\"nofollow noreferrer\">commenting out those two cases works</a>)</li>\n</ul>\n\n\n\n<pre><code>#include &lt;boost/fusion/adapted.hpp&gt;\n#include &lt;boost/spirit/home/x3.hpp&gt;\n#include &lt;tuple&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\nnamespace x3 = boost::spirit::x3;\n\nnamespace {\n    std::ostream&amp; dump(std::ostream&amp; os, std::string const&amp; s) {\n        return os &lt;&lt; std::quoted(s);\n    }\n\n    template &lt;typename T&gt;\n    std::ostream&amp; dump(std::ostream&amp; os, std::vector&lt;T&gt; const&amp; v) {\n        os &lt;&lt; \"vector{ \";\n        for (auto&amp; el : v)\n            dump(os, el) &lt;&lt; \", \";\n        return os &lt;&lt; \"}\";\n    }\n\n    template &lt;typename A, typename B&gt;\n    std::ostream&amp; dump(std::ostream&amp; os, std::tuple&lt;A, B&gt; const&amp; tuple) {\n        dump(os &lt;&lt; \"\\n  * tuple[0]: \", std::get&lt;0&gt;(tuple));\n        dump(os &lt;&lt; \"\\n  * tuple[1]: \", std::get&lt;1&gt;(tuple));\n        return os;\n    }\n}\n\ntemplate &lt;typename Out, typename It, typename Grammar&gt;\nvoid do_test(It f, It l, Grammar const&amp; g) {\n    std::cout &lt;&lt; \" == input = \" &lt;&lt; std::quoted(std::string(f,l)) &lt;&lt; \"\\n\";\n    Out out{};\n    bool ok = x3::parse(f, l, g, out);\n\n    std::cout &lt;&lt; \" -- ok = \" &lt;&lt; std::boolalpha &lt;&lt; ok &lt;&lt; \"\\n\";\n    dump(std::cout &lt;&lt; \" -- out = \", out) &lt;&lt; \"\\n\";\n    if (f!=l)\n        std::cout &lt;&lt; \" -- remaining unparsed: \" &lt;&lt; std::quoted(std::string(f,l)) &lt;&lt; \"\\n\";\n}\n\nnamespace testing {\n    #define TESTCASE(T, P)                                                                                  \\\n        do {                                                                                                \\\n            std::cout &lt;&lt; \"\\n## \" &lt;&lt; __FUNCTION__ &lt;&lt; \" line: \" &lt;&lt; __LINE__ &lt;&lt; \" parser: \" &lt;&lt; std::quoted(std::string(#P)) &lt;&lt; \"\\n\";  \\\n            auto f = begin(input), l = end(input);                                                          \\\n            do_test&lt;T&gt;(f, l, P);                                                                            \\\n        } while (0)\n\n    using std::string;\n    using string_vec       = std::vector&lt;string&gt;;\n    using string_string    = std::tuple&lt;string, string&gt;;\n    using string_stringvec = std::tuple&lt;string, string_vec&gt;;\n\n    static auto const word\n        = x3::rule&lt;struct word_, std::string&gt; {\"word\"}\n        = x3::graph &gt;&gt; *(x3::graph - ':' - ',' - '/')\n        ;\n\n    void value_only(std::string const&amp; input) {\n        TESTCASE(string, word);\n        TESTCASE(string_vec, (word % ','));\n        TESTCASE(string_vec, '/' &gt;&gt; (word % ','));\n        TESTCASE(string_vec, -(word % ','));\n        TESTCASE(string_vec, -('/' &gt;&gt; (word % ',')));\n        TESTCASE(string_vec, -('/' &gt;&gt; (word % ',') &gt;&gt; -x3::lit('/')));\n    }\n\n    void key_value(std::string const&amp; input) {\n        TESTCASE(string_string,    word &gt;&gt; ':' &gt;&gt; word);\n        TESTCASE(string_stringvec, word &gt;&gt; ':' &gt;&gt; -(word % ','));\n        TESTCASE(string_stringvec, word &gt;&gt; ':' &gt;&gt; -('/' &gt;&gt; (word % ',') &gt;&gt; -x3::lit('/')));\n        TESTCASE(string_stringvec, word &gt;&gt; ':' &gt;&gt; -((word % ',') &gt;&gt; -x3::lit('/')));\n    }\n\n    #undef TESTCASE\n}\n\nint main() {\n    testing::value_only(\"/other,words/\");\n    testing::key_value(\"hello:/other,words/\");\n}\n</code></pre>\n\n<h2>Boost 1.66 workaround?</h2>\n\n<p>You can <strong>coerce</strong> the \"value\" part to be <code>vector&lt;string&gt;</code> using an additional rule. The simplest way to do this:</p>\n\n<p><strong><kbd><a href=\"https://wandbox.org/permlink/5IxuIvG5dMCG1RWZ\" rel=\"nofollow noreferrer\">Live On Wandbox w/boost 1.66</a></kbd></strong></p>\n\n<pre><code>void key_value(std::string const&amp; input) {\n    TESTCASE(string_string,    word &gt;&gt; ':' &gt;&gt; word);\n    TESTCASE(string_stringvec, word &gt;&gt; ':' &gt;&gt; -(word % ','));\n    auto asvec = [](auto p) {\n        return x3::rule&lt;struct asvec_, string_vec&gt; {\"asvec\"} = p;\n    };\n    TESTCASE(string_stringvec, word &gt;&gt; ':' &gt;&gt; asvec(-('/' &gt;&gt; (word % ',') &gt;&gt; -x3::lit('/'))));\n    TESTCASE(string_stringvec, word &gt;&gt; ':' &gt;&gt; asvec(-((word % ',') &gt;&gt; -x3::lit('/'))));\n}\n</code></pre>\n\n<h2>Output</h2>\n\n<p>For completeness the programs print:</p>\n\n<pre><code>## value_only line: 64 parser: \"word\"\n == input = \"/other,words/\"\n -- ok = true\n -- out = \"/other\"\n -- remaining unparsed: \",words/\"\n\n## value_only line: 65 parser: \"(word % ',')\"\n == input = \"/other,words/\"\n -- ok = true\n -- out = vector{ \"/other\", \"words\", }\n -- remaining unparsed: \"/\"\n\n## value_only line: 66 parser: \"'/' &gt;&gt; (word % ',')\"\n == input = \"/other,words/\"\n -- ok = true\n -- out = vector{ \"other\", \"words\", }\n -- remaining unparsed: \"/\"\n\n## value_only line: 67 parser: \"-(word % ',')\"\n == input = \"/other,words/\"\n -- ok = true\n -- out = vector{ \"/other\", \"words\", }\n -- remaining unparsed: \"/\"\n\n## value_only line: 68 parser: \"-('/' &gt;&gt; (word % ','))\"\n == input = \"/other,words/\"\n -- ok = true\n -- out = vector{ \"other\", \"words\", }\n -- remaining unparsed: \"/\"\n\n## value_only line: 69 parser: \"-('/' &gt;&gt; (word % ',') &gt;&gt; -x3::lit('/'))\"\n == input = \"/other,words/\"\n -- ok = true\n -- out = vector{ \"other\", \"words\", }\n\n## key_value line: 73 parser: \"word &gt;&gt; ':' &gt;&gt; word\"\n == input = \"hello:/other,words/\"\n -- ok = true\n -- out = \n  * tuple[0]: \"hello\"\n  * tuple[1]: \"/other\"\n -- remaining unparsed: \",words/\"\n\n## key_value line: 74 parser: \"word &gt;&gt; ':' &gt;&gt; -(word % ',')\"\n == input = \"hello:/other,words/\"\n -- ok = true\n -- out = \n  * tuple[0]: \"hello\"\n  * tuple[1]: vector{ \"/other\", \"words\", }\n -- remaining unparsed: \"/\"\n\n## key_value line: 78 parser: \"word &gt;&gt; ':' &gt;&gt; asvec(-('/' &gt;&gt; (word % ',') &gt;&gt; -x3::lit('/')))\"\n == input = \"hello:/other,words/\"\n -- ok = true\n -- out = \n  * tuple[0]: \"hello\"\n  * tuple[1]: vector{ \"other\", \"words\", }\n\n## key_value line: 79 parser: \"word &gt;&gt; ':' &gt;&gt; asvec(-((word % ',') &gt;&gt; -x3::lit('/')))\"\n == input = \"hello:/other,words/\"\n -- ok = true\n -- out = \n  * tuple[0]: \"hello\"\n  * tuple[1]: vector{ \"/other\", \"words\", }\n</code></pre>\n"}], "owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 51643231, "answer_count": 1, "score": 0, "last_activity_date": 1533164056, "creation_date": 1533157036, "last_edit_date": 1533163675, "question_id": 51642145, "link": "https://stackoverflow.com/questions/51642145/automatic-attribute-propagation-sometimes-doesnt-work-when-combining-and-op", "title": "Automatic attribute propagation sometimes doesn&#39;t work when combining `%` and optional suffixes", "body": "<p>Using boost 1.61, on both clang 3.8.0, and GCC 5.4, I get  errors when compiling the following code: </p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;boost/spirit/home/x3.hpp&gt;\n#include &lt;boost/fusion/adapted.hpp&gt;\n#include &lt;tuple&gt;\n#include &lt;vector&gt;\n#include &lt;cassert&gt;\n\nvoid do_test(std::string input)\n{\n    namespace x3 = boost::spirit::x3;\n\n    using x3::char_;\n    using x3::lit;\n    using x3::alpha;\n\n    auto const word = +(alpha - ' ');\n\n\n    auto first = begin(input);\n    auto last = end(input);\n\n    //this works\n    {\n        auto const&amp; g = word;\n        std::string out;\n        x3::parse(first, last, g, out);\n    }\n    {\n        auto const&amp; g = (word % ',');\n        std::vector&lt;std::string&gt; out;\n        x3::parse(first, last, g, out);\n    }\n    {\n        auto const&amp; g = lit('/') &gt;&gt; (word % ',');\n        std::vector&lt;std::string&gt; out;\n        x3::parse(first, last, g, out);\n    }\n    {\n        auto const&amp; g = -(word % ',');\n        std::vector&lt;std::string&gt; out;\n        x3::parse(first, last, g, out);\n    }\n    {\n        auto const&amp; g = -(lit('/') &gt;&gt; (word % ','));\n        std::vector&lt;std::string&gt; out;\n        x3::parse(first, last, g, out);\n    }\n    {\n        auto const&amp; g = -(lit('/') &gt;&gt; (word % ',') &gt;&gt; -lit('/'));\n        std::vector&lt;std::string&gt; out;\n        x3::parse(first, last, g, out);\n    }\n    {\n        auto const&amp; g = word &gt;&gt; lit(':') &gt;&gt; word;\n        std::tuple&lt;std::string, std::string&gt; out;\n        x3::parse(first, last, g, out);\n    }\n    {\n        auto const&amp; g = word &gt;&gt; lit(':') &gt;&gt; -(word % ',');\n        std::tuple&lt;std::string, std::vector&lt;std::string&gt;&gt; out;\n        x3::parse(first, last, g, out);\n    }\n    //but this fails.\n    {\n        auto const&amp; g = word &gt;&gt; lit(':') &gt;&gt; -(lit('/') &gt;&gt; (word % ',') &gt;&gt; -lit('/'));\n        std::tuple&lt;std::string, std::vector&lt;std::string&gt;&gt; out;\n        x3::parse(first, last, g, out);\n    }\n    {\n        auto const&amp; g = word &gt;&gt; lit(':') &gt;&gt; -((word % ',') &gt;&gt; -lit('/'));\n        std::tuple&lt;std::string, std::vector&lt;std::string&gt;&gt; out;\n        x3::parse(first, last, g, out);\n    }\n\n}\n</code></pre>\n\n<p>with the following error message: </p>\n\n<pre><code>FAILED: /usr/bin/x86_64-linux-gnu-g++   -I../ext/boost-spirit/include -g -ggdb3   -fPIC -std=gnu++14 -MD -MT src/rtsp-header-parse/CMakeFiles/rtsp-header-parse.dir/rtsp-header-parse/test.cpp.o -MF src/rtsp-header-parse/CMakeFiles/rtsp-header-parse.dir/rtsp-header-parse/test.cpp.o.d -o src/rtsp-header-parse/CMakeFiles/rtsp-header-parse.dir/rtsp-header-parse/test.cpp.o -c ../src/rtsp-header-parse/rtsp-header-parse/test.cpp\nIn file included from ../ext/boost-spirit/include/boost/spirit/home/x3/auxiliary/any_parser.hpp:15:0,\n                 from ../ext/boost-spirit/include/boost/spirit/home/x3/auxiliary.hpp:11,\n                 from ../ext/boost-spirit/include/boost/spirit/home/x3.hpp:14,\n                 from ../src/rtsp-header-parse/rtsp-header-parse/test.cpp:2:\n../ext/boost-spirit/include/boost/spirit/home/x3/support/traits/container_traits.hpp: In instantiation of \u2018struct boost::spirit::x3::traits::container_value&lt;boost::fusion::iterator_range&lt;boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 1&gt;, boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 2&gt; &gt;, void&gt;\u2019:\n../ext/boost-spirit/include/boost/spirit/home/x3/core/detail/parse_into_container.hpp:227:12:   required from \u2018struct boost::spirit::x3::detail::parser_attr_is_substitute_for_container_value&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::fusion::iterator_range&lt;boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 1&gt;, boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 2&gt; &gt;, boost::spirit::x3::unused_type&gt;\u2019\n../ext/boost-spirit/include/boost/mpl/aux_/nested_type_wknd.hpp:26:31:   required from \u2018struct boost::mpl::aux::nested_type_wknd&lt;boost::spirit::x3::detail::parser_attr_is_substitute_for_container_value&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::fusion::iterator_range&lt;boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 1&gt;, boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 2&gt; &gt;, boost::spirit::x3::unused_type&gt; &gt;\u2019\n../ext/boost-spirit/include/boost/mpl/not.hpp:39:8:   required from \u2018struct boost::mpl::not_&lt;boost::spirit::x3::detail::parser_attr_is_substitute_for_container_value&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::fusion::iterator_range&lt;boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 1&gt;, boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 2&gt; &gt;, boost::spirit::x3::unused_type&gt; &gt;\u2019\n../ext/boost-spirit/include/boost/mpl/aux_/nested_type_wknd.hpp:26:31:   required from \u2018struct boost::mpl::aux::nested_type_wknd&lt;boost::mpl::not_&lt;boost::spirit::x3::detail::parser_attr_is_substitute_for_container_value&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::fusion::iterator_range&lt;boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 1&gt;, boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 2&gt; &gt;, boost::spirit::x3::unused_type&gt; &gt; &gt;\u2019\n../ext/boost-spirit/include/boost/mpl/aux_/preprocessed/gcc/or.hpp:23:8:   required from \u2018struct boost::mpl::aux::or_impl&lt;false, boost::mpl::not_&lt;boost::spirit::x3::detail::parser_attr_is_substitute_for_container_value&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::fusion::iterator_range&lt;boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 1&gt;, boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 2&gt; &gt;, boost::spirit::x3::unused_type&gt; &gt;, mpl_::bool_&lt;false&gt;, mpl_::bool_&lt;false&gt;, mpl_::bool_&lt;false&gt; &gt;\u2019\n../ext/boost-spirit/include/boost/mpl/aux_/preprocessed/gcc/or.hpp:48:8:   [ skipping 7 instantiation contexts, use -ftemplate-backtrace-limit=0 to disable ]\n../ext/boost-spirit/include/boost/spirit/home/x3/core/proxy.hpp:42:73:   required from \u2018bool boost::spirit::x3::proxy&lt;Subject, Derived&gt;::parse(Iterator&amp;, const Iterator&amp;, const Context&amp;, RuleContext&amp;, Attribute&amp;) const [with Iterator = __gnu_cxx::__normal_iterator&lt;char*, std::__cxx11::basic_string&lt;char&gt; &gt;; Context = boost::spirit::x3::unused_type; RuleContext = const boost::spirit::x3::unused_type; Attribute = boost::fusion::iterator_range&lt;boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 1&gt;, boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 2&gt; &gt;; Subject = boost::spirit::x3::sequence&lt;boost::spirit::x3::list&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;; Derived = boost::spirit::x3::optional&lt;boost::spirit::x3::sequence&lt;boost::spirit::x3::list&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt; &gt;]\u2019\n../ext/boost-spirit/include/boost/spirit/home/x3/operator/detail/sequence.hpp:312:13:   required from \u2018bool boost::spirit::x3::detail::parse_sequence(const Parser&amp;, Iterator&amp;, const Iterator&amp;, const Context&amp;, RContext&amp;, Attribute&amp;, boost::spirit::x3::traits::tuple_attribute) [with Parser = boost::spirit::x3::sequence&lt;boost::spirit::x3::sequence&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::sequence&lt;boost::spirit::x3::list&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt; &gt; &gt;; Iterator = __gnu_cxx::__normal_iterator&lt;char*, std::__cxx11::basic_string&lt;char&gt; &gt;; Context = boost::spirit::x3::unused_type; RContext = const boost::spirit::x3::unused_type; Attribute = std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;]\u2019\n../ext/boost-spirit/include/boost/spirit/home/x3/operator/sequence.hpp:44:42:   required from \u2018bool boost::spirit::x3::sequence&lt;Left, Right&gt;::parse(Iterator&amp;, const Iterator&amp;, const Context&amp;, RContext&amp;, Attribute&amp;) const [with Iterator = __gnu_cxx::__normal_iterator&lt;char*, std::__cxx11::basic_string&lt;char&gt; &gt;; Context = boost::spirit::x3::unused_type; RContext = const boost::spirit::x3::unused_type; Attribute = std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;; Left = boost::spirit::x3::sequence&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;; Right = boost::spirit::x3::optional&lt;boost::spirit::x3::sequence&lt;boost::spirit::x3::list&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt; &gt;]\u2019\n../ext/boost-spirit/include/boost/spirit/home/x3/core/parse.hpp:35:68:   required from \u2018bool boost::spirit::x3::parse_main(Iterator&amp;, Iterator, const Parser&amp;, Attribute&amp;) [with Iterator = __gnu_cxx::__normal_iterator&lt;char*, std::__cxx11::basic_string&lt;char&gt; &gt;; Parser = boost::spirit::x3::sequence&lt;boost::spirit::x3::sequence&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::sequence&lt;boost::spirit::x3::list&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt; &gt; &gt;; Attribute = std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;]\u2019\n../ext/boost-spirit/include/boost/spirit/home/x3/core/parse.hpp:47:26:   required from \u2018bool boost::spirit::x3::parse(Iterator&amp;, Iterator, const Parser&amp;, Attribute&amp;) [with Iterator = __gnu_cxx::__normal_iterator&lt;char*, std::__cxx11::basic_string&lt;char&gt; &gt;; Parser = boost::spirit::x3::sequence&lt;boost::spirit::x3::sequence&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::sequence&lt;boost::spirit::x3::list&lt;boost::spirit::x3::plus&lt;boost::spirit::x3::difference&lt;boost::spirit::x3::char_class&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::alpha_tag&gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt;, boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt;, boost::spirit::x3::optional&lt;boost::spirit::x3::literal_char&lt;boost::spirit::char_encoding::standard, boost::spirit::x3::unused_type&gt; &gt; &gt; &gt; &gt;; Attribute = std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;]\u2019\n../src/rtsp-header-parse/rtsp-header-parse/test.cpp:72:38:   required from here\n../ext/boost-spirit/include/boost/spirit/home/x3/support/traits/container_traits.hpp:76:12: error: no type named \u2018value_type\u2019 in \u2018struct boost::fusion::iterator_range&lt;boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 1&gt;, boost::fusion::std_tuple_iterator&lt;std::tuple&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::vector&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt; &gt; &gt;, 2&gt; &gt;\u2019\n     struct container_value\n            ^\nIn file included from ../ext/boost-spirit/include/boost/spirit/home/x3/directive/expect.hpp:12:0,\n                 from ../ext/boost-spirit/include/boost/spirit/home/x3/auxiliary/guard.hpp:11,\n                 from ../ext/boost-spirit/include/boost/spirit/home/x3/auxiliary.hpp:13,\n                 from ../ext/boost-spirit/include/boost/spirit/home/x3.hpp:14,\n                 from ../src/rtsp-header-parse/rtsp-header-parse/test.cpp:2:\n...\n</code></pre>\n\n<p>I'm curious as to why the combination of the <code>%</code> operator with the inclusion of optional with an internal sequenced section causes a compilation to fail. ie: why does <code>-(word % ',')</code>work without issue, but <code>-((word % ',') &gt;&gt; lit('/'))</code> fail to parse into a subexpression? At the same time, why does it work when removing the prefix word and parsing directly into a <code>std::vector&lt;std::string&gt;</code>?</p>\n\n<p>I've also tried to parse into a <code>boost::mpl::vector&lt;std::string, std::vector&lt;std::string&gt;&gt;</code> and get the same errors.</p>\n"}, {"tags": ["c++", "opengl", "glsl", "shader"], "answers": [{"tags": [], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "is_accepted": true, "score": 3, "last_activity_date": 1533157302, "creation_date": 1533157302, "answer_id": 51642211, "question_id": 51642141, "link": "https://stackoverflow.com/questions/51642141/rendering-transparent-blocks-in-opengl/51642211#51642211", "title": "Rendering Transparent Blocks in OpenGL", "body": "<p>You need to set blending mode for the transparent shape as well:</p>\n\n<pre><code>glEnable(GL_BLEND);\nglBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 7043401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a69ceceae43c69068f9a38c636c85419?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/7043401/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 51642211, "answer_count": 1, "score": 1, "last_activity_date": 1533157302, "creation_date": 1533157022, "question_id": 51642141, "link": "https://stackoverflow.com/questions/51642141/rendering-transparent-blocks-in-opengl", "title": "Rendering Transparent Blocks in OpenGL", "body": "<p>I'm rendering 3D terrain with cubes and I need to render water transparently.</p>\n\n<p>My solution for this, after some research, was to separate the water cubes into one buffer and the solid blocks into the other buffer, then in my fragment shader, I'm using:</p>\n\n<pre><code>uniform float transparency;\n</code></pre>\n\n<p>in my rendering code:</p>\n\n<pre><code>shader.setFloat(\"transparency\", 1.0f);\nglBindVertexArray(solidVAO);\nglDrawArrays(GL_TRIANGLES, 0, solidPoints.size());\n\nshader.setFloat(\"transparency\", 0.3f);\nglBindVertexArray(transparentVAO);\nglDrawArrays(GL_TRIANGLES, 0, transparentPoints.size());\n</code></pre>\n\n<p>and then in my Fragment Shader</p>\n\n<pre><code>out vec4 FragColor;\n\nin vec2 TexCoord;\n\n// texture sampler\nuniform sampler2D atlas;\nuniform float transparency;\n\nvoid main()\n{\n    FragColor = texture(atlas, TexCoord);\n    FragColor.w = transparency;\n}\n</code></pre>\n\n<p>However, the water is still solid, is there a better approach to drawing transparent shapes in front of solids? Or, what is going wrong here?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1533156432, "post_id": 51641998, "comment_id": 90248457, "body": "You could make <code>get_doors()</code> a pure virtual function in <code>Car</code> and override it in <code>Ford</code>. It can&#39;t return <code>void</code>, though."}, {"owner": {"reputation": 3012, "user_id": 6741482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e2d07264d5857c8851212ac5c882039a?s=128&d=identicon&r=PG&f=1", "display_name": "pstatix", "link": "https://stackoverflow.com/users/6741482/pstatix"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1533156458, "post_id": 51641998, "comment_id": 90248471, "body": "@alterigel I thought I could use a <code>Car*</code> to point to any instance of a derived class from <code>Car</code>? That leaves no room for abstract class instantiation because there needs to be a single <code>Car</code> instance."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1533156587, "post_id": 51641998, "comment_id": 90248530, "body": "What do you mean by &quot;abstract class instantiation&quot;? You can&#39;t instantiate an abstract class."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 3, "creation_date": 1533156612, "post_id": 51641998, "comment_id": 90248542, "body": "Yes, you can use a <code>Car*</code> to point to any instance of a derived class from <code>Car</code>. But you are also limited to operations available to <code>Car</code>. (Because there is no guarantee that the thing your <code>Car*</code> points to supports <code>get_doors</code>. Imagine if the second line were <code>c = new Car();</code>.)"}, {"owner": {"reputation": 3012, "user_id": 6741482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e2d07264d5857c8851212ac5c882039a?s=128&d=identicon&r=PG&f=1", "display_name": "pstatix", "link": "https://stackoverflow.com/users/6741482/pstatix"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1533156651, "post_id": 51641998, "comment_id": 90248568, "body": "@FredLarson At runtime it will be unknown what type of <code>Car</code> subclass the user will create. So I would&#39;ve thought that a <code>Car*</code> could point to any of the subclasses and allow access to not only <code>Car</code> members but that of the subclass as well?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1533156675, "post_id": 51641998, "comment_id": 90248580, "body": "That&#39;s what virtual functions are for, as I mentioned in my first comment. C++ is statically typed and does not have &quot;duck typing&quot; as Python does."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 1, "creation_date": 1533157376, "post_id": 51641998, "comment_id": 90248885, "body": "Try <code>static_cast&lt;Ford *&gt;(c)-&gt;get_doors();</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3012, "user_id": 6741482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e2d07264d5857c8851212ac5c882039a?s=128&d=identicon&r=PG&f=1", "display_name": "pstatix", "link": "https://stackoverflow.com/users/6741482/pstatix"}, "edited": false, "score": 0, "creation_date": 1533156862, "post_id": 51642066, "comment_id": 90248665, "body": "I ended up using the <code>virutal</code> keyword and read the docs, makes sense. Thanks!"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533156986, "post_id": 51642066, "comment_id": 90248715, "body": "Addendum: This is done because C++ strives to make the program pay only for what the programmer asked for. Dynamic dispatch has a price, so in C++ you only pay that price if you ask for it."}], "tags": [], "owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "is_accepted": true, "score": 4, "last_activity_date": 1533156668, "creation_date": 1533156668, "answer_id": 51642066, "question_id": 51641998, "link": "https://stackoverflow.com/questions/51641998/unable-to-access-subclass-methods-from-baseclass-pointer/51642066#51642066", "title": "Unable to access subclass methods from baseclass pointer", "body": "<p>Python methods are <em>dynamic</em> - pure object-oriented in the nature of smalltalk.  You send an instance a message and if it can answer it, it does.</p>\n\n<p>C++ is not like that.  It uses <em>static</em> types.  You have <em>declared</em> an object of type <code>Car*</code> so a) it can hold a pointer to any <code>Car</code> instance or instance of a subtype of <code>Car</code> and b) it can only be told to do what <code>Car</code>s can be told to do.</p>\n\n<p>C++ also has <em>virtual</em> methods.  If a method, declared in <code>Car</code>, is virtual, then it can be <em>implemented</em> in a subclass of <code>Car</code> (e.g., in <code>Ford</code>).  Then that subclasses' implementation will be called when calling through a <code>Car</code> pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 3012, "user_id": 6741482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e2d07264d5857c8851212ac5c882039a?s=128&d=identicon&r=PG&f=1", "display_name": "pstatix", "link": "https://stackoverflow.com/users/6741482/pstatix"}, "edited": false, "score": 0, "creation_date": 1533156959, "post_id": 51642107, "comment_id": 90248701, "body": "I ended up using the <code>virtual</code> keyword, but not <code>override</code>. Instead, in <code>Car</code> I declared <code>virtual get_doors() const {};</code> and then in <code>Ford</code> I declared <code>virtual get_doors() const {return this-&gt;doors;};</code>. Do I need to use <code>override</code>?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 3012, "user_id": 6741482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e2d07264d5857c8851212ac5c882039a?s=128&d=identicon&r=PG&f=1", "display_name": "pstatix", "link": "https://stackoverflow.com/users/6741482/pstatix"}, "edited": false, "score": 1, "creation_date": 1533157057, "post_id": 51642107, "comment_id": 90248745, "body": "@pstatix: I recommend it. With <code>override</code>, if you make a mistake, you get a compile error. Without it, you get weird runtime behavior."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1533157224, "post_id": 51642107, "comment_id": 90248825, "body": "Indeed, while <code>override</code> is optional, it can only do good. See <a href=\"https://stackoverflow.com/questions/18198314/what-is-the-override-keyword-in-c-used-for\" title=\"what is the override keyword in c used for\">stackoverflow.com/questions/18198314/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": false, "score": 1, "last_activity_date": 1533156837, "creation_date": 1533156837, "answer_id": 51642107, "question_id": 51641998, "link": "https://stackoverflow.com/questions/51641998/unable-to-access-subclass-methods-from-baseclass-pointer/51642107#51642107", "title": "Unable to access subclass methods from baseclass pointer", "body": "<p>This is exactly what should happen. A <code>Car*</code> pointer only lets you see <code>Car</code> members. Try using a <code>Ford*</code> pointer instead to see Ford methods. To see why, consider you had another class deriving from <code>Car</code>:</p>\n\n<pre><code>class Honda : public Car {\n    // no get_doors() here\n    void honk();\n};\n\n... \n\nCar* c = new Honda();\nc-&gt;get_doors(); // What should happen here???\n</code></pre>\n\n<p>On the other hand, if you want <em>every</em> <code>Car</code> to have its own number of doors, you could do a couple things:</p>\n\n<p>You can declare a constant member in the base class:</p>\n\n<pre><code>class Car {\npublic:\n    Car(int num_doors) : m_doors(num_doors) {}\n\n    int get_doors() const { return m_doors; }\nprivate:\n    const int m_doors;\n}\n\nclass Ford : public Car {\n    Ford() : Car(4) {} // Now every ford has 4 doors\n}\n\nclass Honda : public Car {\n    Honda() : Car(5) {} // and every honda has 5\n}\n</code></pre>\n\n<p>Another thing you can do is declare a virtual function in your base class, and override that in every subclass:</p>\n\n<pre><code>class Car {\npublic:\n    virtual int num_doors() const = 0;\n}\n\nclass Ford : public Car {\n    int num_doors() const override { return 4; } // Now every ford has 4 doors\n}\n\nclass Honda : public Car {\n    int num_doors() const override { return 5; } // and every honda has 5\n}\n</code></pre>\n"}], "owner": {"reputation": 3012, "user_id": 6741482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e2d07264d5857c8851212ac5c882039a?s=128&d=identicon&r=PG&f=1", "display_name": "pstatix", "link": "https://stackoverflow.com/users/6741482/pstatix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 51642066, "answer_count": 2, "score": 0, "last_activity_date": 1533156837, "creation_date": 1533156330, "question_id": 51641998, "link": "https://stackoverflow.com/questions/51641998/unable-to-access-subclass-methods-from-baseclass-pointer", "title": "Unable to access subclass methods from baseclass pointer", "body": "<p>Not sure where my inheritance went wrong here, but I seem to be only able to access the methods of the baseclass when storing a subclass instance in a baseclass pointer:</p>\n\n<pre><code>class Car\n{\n    public:\n        Car():type(\"Car\") {};\n        Car(const char* t):type(t) {};\n        void get_type() const { return this-&gt;type; };\n    private:\n        std::string type;\n};\n\nclass Ford : public Car\n{\n    public:\n        Ford():Car(\"Ford\"), doors(4) {};\n        Ford(int x):Car(\"Ford\"), doors(x) {};\n        void get_doors() const { return this-&gt;doors; };\n    private:\n        int doors;\n};\n\nint main()\n{\n    Car* c = nullptr;\n    c = new Ford();\n    c-&gt;get_doors(); // doesn't exist, only allows for get_type()\n}\n</code></pre>\n\n<p>It's very likely it could be a misuse of the pointer. I'll admit that C++ is not my strong suit so I am trying to replicate a program written in Python that heavily uses inheritance but it's much less complicated than writing it in C++ since you don't have explicit use of Pointers and References (at the abstract level that is).</p>\n"}, {"tags": ["c++", "linux", "macros", "g++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1533156424, "post_id": 51641994, "comment_id": 90248455, "body": "Remove <code>using namespace std;</code> wherever you applied it with your code."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533156490, "post_id": 51641994, "comment_id": 90248487, "body": "Also make sure <code>#include &quot;f2c.h&quot;</code> is done after all of the standard headers."}, {"owner": {"reputation": 981, "user_id": 9058993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqtfC.jpg?s=128&g=1", "display_name": "Jeremy S.", "link": "https://stackoverflow.com/users/9058993/jeremy-s"}, "edited": false, "score": 0, "creation_date": 1533156613, "post_id": 51641994, "comment_id": 90248545, "body": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6, are you referring to removing namespace std from the f2c.h header file?"}, {"owner": {"reputation": 981, "user_id": 9058993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqtfC.jpg?s=128&g=1", "display_name": "Jeremy S.", "link": "https://stackoverflow.com/users/9058993/jeremy-s"}, "edited": false, "score": 0, "creation_date": 1533157062, "post_id": 51641994, "comment_id": 90248749, "body": "NathanOliver that was it, interesting that this isn&#39;t an issue with VS."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533158614, "post_id": 51641994, "comment_id": 90249361, "body": "@JeremyStalmer Others alluded to it, but there is already a <a href=\"https://en.cppreference.com/w/cpp/algorithm/min\" rel=\"nofollow noreferrer\">std::min</a> and <code>std::max</code> function in C++ in the <code>&lt;algorithm&gt;</code> header.  Your macro versions are interfering with those declarations.  Best bet is to remove the C-macros and just use <code>std::min</code> and <code>std::max</code>.  Also, this is the case for why <code>using namespace std;</code> is dangerous -- usage of the ubiquitous C-macros <code>min</code> and <code>max</code>, and the <code>std::min</code> and <code>std::max</code> functions."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1533158684, "post_id": 51641994, "comment_id": 90249380, "body": "See also <a href=\"https://stackoverflow.com/a/51165683/2785528\">stackoverflow.com/a/51165683/2785528</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": false, "score": 2, "last_activity_date": 1533165837, "last_edit_date": 1533165837, "creation_date": 1533159073, "answer_id": 51642531, "question_id": 51641994, "link": "https://stackoverflow.com/questions/51641994/error-defining-min-max-macro-in-f2c-h-file/51642531#51642531", "title": "Error defining min() max() macro in f2c.h file", "body": "<p>Congratulations, you just learned the hard way why <a href=\"https://www.google.at/search?q=macros+are+evil\" rel=\"nofollow noreferrer\">macros are evil</a> ;) The problem with macros is that they are really not much more than an automated text replacement mechanism that alters the source code before the \"actual\" compiler gets to see it. They do <em>not</em> respect things like namespaces or scope in general, because they operate at a level where these concepts don't even exist yet. C++ inherited macros from C. However, with <code>constexpr</code>, <code>inline</code>, and templates, C++ has much better ways of solving most problems for which you would typically use macros in C. While there may arguably be a few legitimate use cases for macros in C++, macros are generally best avoided if at all possible.</p>\n\n<p>So what happened up there when you compiled your code with g++? Well, line 396 of fstream.tcc, which is part of the standard library implementation you're using, looks like this:</p>\n\n<pre><code>__ilen = std::min(__avail, __buflen);\n</code></pre>\n\n<p>Most likely, you included some part of the standard library that indirectly includes fstream.tcc. Most likely, you included your header with the macro definition</p>\n\n<pre><code>#define max(a,b) ((a) &gt;= (b) ? (a) : (b))\n</code></pre>\n\n<p>before including that standard header. That means by the time the compiler makes its way through fstream.tcc, you have <code>max</code> defined as a function-like macro. The compiler will, thus, replace all occurrences of a token sequence that matches <code>max</code> <code>(</code> &hellip; <code>,</code> &hellip; <code>)</code> accordingly. That means instead of</p>\n\n<pre><code>__ilen = std::min(__avail, __buflen);\n</code></pre>\n\n<p>your standard header suddenly reads:</p>\n\n<pre><code>__ilen = std::((__avail) &gt;= (__buflen) ? (__avail) : (__buflen))(__avail, __buflen);\n//            ^--- note this part\n</code></pre>\n\n<p>This also explains the weird error message:</p>\n\n<blockquote>\n  <p>expected unqualified-id before \u2018(\u2019 token</p>\n</blockquote>\n\n<p><code>std::(</code> is a syntax error. The compiler expected another identifier following the <code>::</code>. And there originally was one. But the macro replaced that identifier with garbage. Because all macros do is replace tokens with no regard to syntactical context. And since macros just silently rewrite your code for you, you never get to see the code that the \"actual\" compiler sees. When something goes wrong, all you get to see is the error messages the rewritten code produced. (Unless you tell your compiler to please dump out the result of preprocessing and sift through the ocean of text you get as a result.)</p>\n\n<p>The best way to resolve the issue: get rid of your macros and just use <code>std::min()</code> and <code>std::max</code>. If that is not so easily done, it should at least be possible to turn these macros into inline functions instead.</p>\n"}], "owner": {"reputation": 981, "user_id": 9058993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqtfC.jpg?s=128&g=1", "display_name": "Jeremy S.", "link": "https://stackoverflow.com/users/9058993/jeremy-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533165837, "creation_date": 1533156313, "question_id": 51641994, "link": "https://stackoverflow.com/questions/51641994/error-defining-min-max-macro-in-f2c-h-file", "title": "Error defining min() max() macro in f2c.h file", "body": "<p>Compiling a C++ based project that is utilizing an f2c.h header file, within the header file is a macro definition for min and max as follows...</p>\n\n<pre><code>#ifndef min\n#define min(a,b) ((a) &lt;= (b) ? (a) : (b))\n#endif\n#ifndef max\n#define max(a,b) ((a) &gt;= (b) ? (a) : (b))\n#endif\n</code></pre>\n\n<p>This code had no issues when I was compiling and running on windows with Microsoft visual studios. Now I am trying to compile and run on LINUX with the g++ compiler, and I am getting the following error messages... </p>\n\n<pre><code>In file included from tsdriver.cpp:68:0:\n/usr/include/c++/6/bits/fstream.tcc: In member function \u2018virtual \nstd::basic_filebuf&lt;_CharT, _Traits&gt;::int_type std::basic_filebuf&lt;_CharT, \n_Traits&gt;::underflow()\u2019:\nf2c.h:155:18: error: expected unqualified-id before \u2018(\u2019 token\n#define min(a,b) ((a) &lt;= (b) ? (a) : (b))\n</code></pre>\n\n<p>Now, it's only giving me the error messages for the min macro, but I believe that this is due to the compiler error being such that compilation must then be terminated. </p>\n\n<p>I have done some testing and found that min/max can be called from a small test.cpp program without any extra includes, so initially thinking the error was coming from a redefinition, but that shouldn't matter since #ifndef would prevent this?</p>\n\n<p>I'm not sure how to remedy this, and I'm still adjusting to a LINUX development environment. Any help is appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["python", "c++", "swig"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1533155789, "post_id": 51641780, "comment_id": 90248168, "body": "What error you do get when you try to run the code?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533155814, "post_id": 51641780, "comment_id": 90248181, "body": "I don&#39;t think you can do what you are trying to do because the C++ class is an abstract base class. I will wait for somebody more knowledgeable than I to prove me wrong."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1533155959, "post_id": 51641780, "comment_id": 90248249, "body": "Right but my class fulfills the interface"}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1533156087, "post_id": 51641780, "comment_id": 90248318, "body": "You get <code>AttributeError: No constructor defined - class is abstract</code> if you include <code>(example.iCat)</code>, if you drop it, you get <code>TypeError: in method &#39;pawGiver&#39;, argument 1 of type &#39;iCat const &amp;&#39;</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1533156180, "post_id": 51641780, "comment_id": 90248348, "body": "@Carbon, I understand the motivation and the expectation. I don&#39;t think SWIG can generate all the intermediate code to make sure that <code>pyCat</code> is instantiable. But then, I am speculating a bit here."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1533156985, "post_id": 51641780, "comment_id": 90248714, "body": "GOT IT! Modify to <code>%module(directors=&quot;1&quot;) example</code> and add <code>%feature(&quot;director&quot;);</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533157161, "post_id": 51641780, "comment_id": 90248794, "body": "@Carbon, add the solution as an answer."}, {"owner": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "edited": false, "score": 0, "creation_date": 1533157190, "post_id": 51641780, "comment_id": 90248804, "body": "@Carbon Did you try <code>%feature(&quot;notabstract&quot;)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 9987, "user_id": 3809375, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/EA10l.png?s=128&g=1", "display_name": "BPL", "link": "https://stackoverflow.com/users/3809375/bpl"}, "edited": false, "score": 2, "creation_date": 1533157461, "post_id": 51642228, "comment_id": 90248935, "body": "Nice catch! here&#39;s the link to the official <a href=\"http://www.swig.org/Doc3.0/SWIGDocumentation.html#Go_director_enable\" rel=\"nofollow noreferrer\">http://www.swig.org/Doc3.0/SWIGDocumentation.html#Go_directo&zwnj;&#8203;r_enable</a>. Both question and answer really interesting ones, so, there we go, +2 ;)"}], "tags": [], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "is_accepted": true, "score": 3, "last_activity_date": 1533157384, "creation_date": 1533157384, "answer_id": 51642228, "question_id": 51641780, "link": "https://stackoverflow.com/questions/51641780/how-do-i-make-a-python-class-satisfying-an-interface-in-swig/51642228#51642228", "title": "How do I make a python class satisfying an interface in SWIG?", "body": "<p>Is easy. Modify the interface to:</p>\n\n<pre><code>/* File : example.i */\n%module(directors=\"1\") example\n%{\n#include \"Example.h\"\n%}\n%feature(\"director\");\n%include \"Example.h\"\n</code></pre>\n\n<p>Runs fine.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 51642228, "answer_count": 1, "score": 2, "last_activity_date": 1533157384, "creation_date": 1533155270, "question_id": 51641780, "link": "https://stackoverflow.com/questions/51641780/how-do-i-make-a-python-class-satisfying-an-interface-in-swig", "title": "How do I make a python class satisfying an interface in SWIG?", "body": "<p>I'd like to make an object in Python that sastifies a C++ instance using SWIG.</p>\n\n<p>Given I have an example like <code>Example.h</code>:</p>\n\n<pre><code>struct iCat\n{\n    virtual int paws() const = 0;\n};\n\nint pawGiver(const iCat&amp; cat);\n\nstruct cat : public iCat\n{\n    int paws() const\n    {\n        return 4;\n    }\n};\n</code></pre>\n\n<p>And <code>Example.cpp</code>:</p>\n\n<pre><code>#include \"Example.h\"\nint pawGiver(const iCat&amp; cat)\n{\n    return cat.paws();\n}\n</code></pre>\n\n<p>And <code>example.i</code>:</p>\n\n<pre><code>/* File : example.i */\n%module example\n%{\n#include \"Example.h\"\n%}\n%include \"Example.h\"\n</code></pre>\n\n<p>The above, of course, compile fine. I wrote the below to try to make an <code>iCat</code> in Python, i.e.:</p>\n\n<pre><code>import example;\nclass pyCat(example.iCat):\n     def __init__(self):\n             super().__init__()\n     def paws(self):\n             return 3;\n\nz = pyCat()\nexample.pawGiver(z)\n</code></pre>\n\n<p>Is what I'm trying to do even possible? Can a Python class fulfill a C++ instance? What am I doing wrong?</p>\n"}, {"tags": ["c++", "optimization", "move-semantics", "copy-elision"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1533155623, "post_id": 51641769, "comment_id": 90248102, "body": "If returned by value, you don&#39;t need an extra <code>std::move</code> it even hurts performance"}, {"owner": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "edited": false, "score": 0, "creation_date": 1533157411, "post_id": 51641769, "comment_id": 90248904, "body": "<a href=\"https://stackoverflow.com/a/9595610/3783662\">stackoverflow.com/a/9595610/3783662</a> this answer explains it pretty well. for your example, the best you can do is in the function, move the input argument into your new local object. thats one move. the rest will be nrvo and copy elision"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533158927, "post_id": 51641769, "comment_id": 90249474, "body": "<code>Type complex_type = param_type;</code> is not a copy elision context,  and <code>std::move(MakeType())</code> is a pessimization since <code>MakeType()</code> is a prvalue"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533159069, "post_id": 51641769, "comment_id": 90249518, "body": "There&#39;s no way to have <code>MakeType()</code> be constructed in <code>t</code> for the syntax in your last call"}], "answers": [{"comments": [{"owner": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "edited": false, "score": 0, "creation_date": 1533187658, "post_id": 51642286, "comment_id": 90255935, "body": "&quot;In short: your original code is the best version to use&quot;. I think this is not true. As mentioned in the comments, moving inside the function will replace one copy with a move. Example: <a href=\"http://coliru.stacked-crooked.com/a/a2937e370af4da86\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/a2937e370af4da86</a>"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "edited": false, "score": 0, "creation_date": 1533187896, "post_id": 51642286, "comment_id": 90256008, "body": "The question is how to call the function, not about the function impl."}, {"owner": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "edited": false, "score": 0, "creation_date": 1533188378, "post_id": 51642286, "comment_id": 90256172, "body": "Oh. Hm. The call side is okay. OP&#39;s question 2: &quot;If not, can we use std::move strategically, <b>perhaps</b> on a function call itself like std::move(MakeType()), to avoid unnecessary copying?&quot; So i just looked at everything."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 1101, "user_id": 3783662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5409812f5cca63c1deb974fe00f65644?s=128&d=identicon&r=PG&f=1", "display_name": "ph&#246;n", "link": "https://stackoverflow.com/users/3783662/ph%c3%b6n"}, "edited": false, "score": 0, "creation_date": 1533189047, "post_id": 51642286, "comment_id": 90256422, "body": "The short answer: doesn&#39;t have any effect. Let me update my post"}], "tags": [], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "is_accepted": true, "score": 2, "last_activity_date": 1533189996, "last_edit_date": 1533189996, "creation_date": 1533157698, "answer_id": 51642286, "question_id": 51641769, "link": "https://stackoverflow.com/questions/51641769/copy-elision-stdmove-and-chained-function-calls/51642286#51642286", "title": "Copy elision, std::move, and chained function calls", "body": "<p>Copy elision is the technique the compiler uses to prevent unneeded copies. Basically, it preallocates memory outside of the function and passes it in to be used. In case of your temporary, it will be on the stack.</p>\n\n<p>Adding std::move to the return type doesn't help. You are already returning by value, so you have already an rvalue. Casting it no an rvalue with std::move should me a no-op. \nI'm not aware of the details, however, for some cases adding it can hurt performance.</p>\n\n<p>Focusing on 2:\nAdding std::move to the function call only has a side effect when returned by non-const reference. In those cases, you most likely wrote a bug as the original will be  moved away.</p>\n\n<p>For number 3:\nMy favorite is using <code>f(Arg &amp;&amp;a)</code>, as this requires all callers to pass rvalue. If performance is less important, for  example: you did not find it in profiling. A value argument (some callers can copy) or even const-reference might do (function can't touch argument, so should copy).</p>\n\n<p>As indicated by the comments, the implementation of the function should also write <code>auto  result =  std::move(a)</code> as your parameter doesn't benefits from NRVO. </p>\n\n<p>Recent versions of Clang have very good warnings about when std::move should be used and when to remove it. I suggest enabling them. GCC might have some similar warnings, however I'm not up to date with it.</p>\n\n<p>In short: your original code is the best version to use and trust your compiler if it has warnings about this.</p>\n"}], "owner": {"reputation": 1419, "user_id": 3788493, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/eLdB2.jpg?s=128&g=1", "display_name": "jeanluc", "link": "https://stackoverflow.com/users/3788493/jeanluc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 51642286, "answer_count": 1, "score": 0, "last_activity_date": 1533189996, "creation_date": 1533155219, "last_edit_date": 1533156392, "question_id": 51641769, "link": "https://stackoverflow.com/questions/51641769/copy-elision-stdmove-and-chained-function-calls", "title": "Copy elision, std::move, and chained function calls", "body": "<p>I've been investigating how copy elision behaves when it is not directly assigned to an lvalue and perhaps chained or used down the road, but haven't found any concrete answers. </p>\n\n<p>For starters, I understand that NRVO occurs in the following example, and the return value is directly constructed in the destination variable:</p>\n\n<pre><code>Type MakeType() {\n  Type type;\n  // ...\n  return type;\n}\n\nType a = MakeType();\n</code></pre>\n\n<p>However, let's say we have another function which takes in a Type as a parameter:</p>\n\n<pre><code>Type MakeComplexType(/*some signature*/ param_type) {\n  Type complex_type = param_type\n  // ...\n  return complex_type;\n}\n</code></pre>\n\n<p>And we call this as follows:</p>\n\n<pre><code>Type t = MakeComplexType(MakeType());\n</code></pre>\n\n<ol>\n<li>Is it possible to chain copy elision all the way to <code>t</code>? </li>\n<li>If not, can we use <code>std::move</code> strategically, perhaps on a function call itself like <code>std::move(MakeType())</code>, to avoid unnecessary copying?</li>\n<li>What should the signature of <code>param_type</code> be such that the above assignment to <code>t</code> is the most efficient?</li>\n</ol>\n"}, {"tags": ["c++", "regex", "string", "stl", "substring"], "comments": [{"owner": {"reputation": 1522, "user_id": 8792891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a662505d48981335d92196c59d90758?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8792891/sam"}, "edited": false, "score": 2, "creation_date": 1533154952, "post_id": 51641674, "comment_id": 90247798, "body": "try a <a href=\"https://en.wikipedia.org/wiki/Trie\" rel=\"nofollow noreferrer\">trie</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 2874071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hnfvv.jpg?s=128&g=1", "display_name": "Jakub Mat\u011bna", "link": "https://stackoverflow.com/users/2874071/jakub-mat%c4%9bna"}, "is_accepted": false, "score": 1, "last_activity_date": 1533155403, "creation_date": 1533155403, "answer_id": 51641809, "question_id": 51641674, "link": "https://stackoverflow.com/questions/51641674/prefix-matching-in-c/51641809#51641809", "title": "Prefix Matching in C++", "body": "<p>It depends on, what is your goal.</p>\n\n<p>If you have a lot of prefixes and just one 'target', than your code is optimal.</p>\n\n<p>But if you have a lot of 'targets', than you might want to consider creating a smarter structure than just a list of prefixes. I would recommend using prefix tree. <a href=\"https://en.wikipedia.org/wiki/Trie\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Trie</a></p>\n\n<p>Building the structure might take some time, but if use have a lot of 'targets', it will pay off.</p>\n"}, {"tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": true, "score": 0, "last_activity_date": 1533367969, "last_edit_date": 1533367969, "creation_date": 1533159622, "answer_id": 51642631, "question_id": 51641674, "link": "https://stackoverflow.com/questions/51641674/prefix-matching-in-c/51642631#51642631", "title": "Prefix Matching in C++", "body": "<p>How many possible prefixes do you plan to have? If it is less than 50 then I don't think there is anything to optimize. </p>\n\n<p>If you use any optimization do a performance measurements to make sure that you are gaining anything. More complex solution will be slower for small number of prefixes.</p>\n\n<p>The easiest solution is use of tree and this is implemented in <code>set</code>, so this should do the trick (it has <code>o(log n)</code> complexity):</p>\n\n<pre><code>// needed since we want longer prefixes before \n// the shorter one with same begging\nclass StrCmpRevAlphaLongerFirst {\npublic:\n    bool operator()(const std::string &amp;a, const std::string &amp;b) const {\n        return !std::lexicographical_compare(a.begin(), a.end(),\n                                             b.begin(), b.end(),\n                                             std::greater_equal&lt;char&gt;()\n                                            );\n    }\n};\n\nusing PrefixSet = std::set&lt;std::string, StrCmpRevAlphaLongerFirst&gt;;\n\nbool contains_prefix(const std::string&amp; target, const PrefixSet &amp;prefixes)\n{\n    auto it = prefixes.lower_bound(target);\n    return it-&gt;length() &lt;= target.length() \n        &amp;&amp; std::equal(it-&gt;begin(), it-&gt;end(), target.begin());\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/hoskfQxh6nr2BLq7\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/hoskfQxh6nr2BLq7</a></p>\n\n<p>In special cases I think it is possible to achieve constant time (by using hash functions). For example if you have lots of prefixes which length are limited you can use <code>std::unordered_set</code>.</p>\n\n<pre><code>class PrefixMatcher {\npublic:\n    PrefixMatcher(const std::unordered_set&lt;std::string&gt; &amp;prefixes)\n        : m_prefixes(prefixes)\n    {\n         for (const auto &amp;s : m_prefixes) {\n              m_lengths.insert(s.length());\n         }\n    }\n\n    bool machesPrefix(const std::string&amp; target) const {\n         for (auto length : m_lengths) {\n             if (target.length() &lt; length) {\n                 continue;\n             }\n             std::string prefix{ target.begin(), target.begin() + length };\n             if (m_prefixes.count(prefix) == 1) {\n                 return true;\n             }\n         }\n         return false;\n    }\n\nprivate:\n    std::unordered_set&lt;std::string&gt; m_prefixes;\n    std::set&lt;size_t&gt; m_lengths;    \n};\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/fXnO3GHimtram6Lo\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/fXnO3GHimtram6Lo</a></p>\n\n<p>Above solution has constant time complexity if prefixes have limited number of possible lengths.</p>\n"}, {"tags": [], "owner": {"reputation": 4912, "user_id": 1953533, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Vs4v8.jpg?s=128&g=1", "display_name": "CroCo", "link": "https://stackoverflow.com/users/1953533/croco"}, "is_accepted": false, "score": 0, "last_activity_date": 1533275451, "last_edit_date": 1533275451, "creation_date": 1533274673, "answer_id": 51665912, "question_id": 51641674, "link": "https://stackoverflow.com/questions/51641674/prefix-matching-in-c/51665912#51665912", "title": "Prefix Matching in C++", "body": "<p>Is this what you are looking for? </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;regex&gt;\nusing std::string;\nusing std::regex;\nusing std::cout;\n\nbool contains_prefix(const string&amp; target, const string&amp; prefixes)\n{\n    return std::regex_match(target, regex(prefixes));\n}\n\nint main()\n{\n    string target = \"automobile\";\n    if (contains_prefix(target, \"(car)(.*)|(auto)(.*)|(biscuits)(.*)\"))\n        std::cout &lt;&lt; \"The target has prefix.\\n\";\n    else\n        std::cout &lt;&lt; \"The target has no prefix.\\n\";\n\n    return 0;\n}\n</code></pre>\n\n<p>If you have many prefixes, you may consider converting them in a single regular expression string. </p>\n"}], "owner": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 0, "accepted_answer_id": 51642631, "answer_count": 3, "score": 1, "last_activity_date": 1591045323, "creation_date": 1533154779, "last_edit_date": 1591045323, "question_id": 51641674, "link": "https://stackoverflow.com/questions/51641674/prefix-matching-in-c", "title": "Prefix Matching in C++", "body": "<p><strong>Problem:</strong></p>\n\n<p>Let's say I have a list of prefixes:</p>\n\n<pre><code>[p1, p2, p3, ... pn] //Prefix List (strings)\n</code></pre>\n\n<p>I want to know if a string 'target' has any of the aforementioned prefixes. </p>\n\n<p>Naive solution example:</p>\n\n<pre><code>bool contains_prefix(std::string target, vector&lt;std::string&gt; &amp;prefixes)\n{\n    for (const auto&amp; prefix : prefixes)\n    {\n       if (target.compare(0, prefix.length(), prefix)\n           return true;\n    }\n    return false;\n}\n\nstd::vector&lt;std::string&gt; prefixes{\"car\" , \"auto\" , \"biscuits\"};\n\nbool test = contains_prefix(\"automobile\", prefixes); //returns true\ntest = contains_prefix(\"biscu\", prefixes); //returns false\ntest = contains_prefix(\"v\", prefixes); //returns false (obviously)\n</code></pre>\n\n<p>So, this naive solution has the obvious shortfall that it must iterate through every item in the list.</p>\n\n<p><strong>Is there a faster way to implement prefix matching of this type?</strong> </p>\n\n<p><strong>Thing's Ive tried:</strong></p>\n\n<p><strong>1.</strong> I tried creating a compare object to be used with an std::set, but sets require strict weak ordering (equality is tested via a>b and a'&lt;'b , both must be false). So the std::compare() function does not work in this case since checking if one string is a prefix of another is an asymmetric relationship.</p>\n\n<p><strong>2.</strong> I can implement using Regexes, but this doesn't solve the problem of having to iterate through every element.</p>\n\n<p><strong>3.</strong> Any data structure that hashes doesn't work for pattern based matching.</p>\n"}, {"tags": ["c++", "opengl", "graphics"], "comments": [{"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1533155327, "post_id": 51641647, "comment_id": 90247970, "body": "Why do you set the <code>model_matrix</code> after drawing the text in <code>Text::draw()</code>? The matrix should be set to the current program object before drawing the text, shouldn&#39;t it?"}, {"owner": {"reputation": 516, "user_id": 2290639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dUoG4.jpg?s=128&g=1", "display_name": "Reza Hajianpour", "link": "https://stackoverflow.com/users/2290639/reza-hajianpour"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1533155598, "post_id": 51641647, "comment_id": 90248091, "body": "@Rabbid76 It doesn&#39;t really matter. Shaders can be updated at runtime anytime I guess. I set the program for the current object, then update the values. <code>Text::draw()</code> gets called in my main loop to update the context on each frame."}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 1, "creation_date": 1533155695, "post_id": 51641647, "comment_id": 90248132, "body": "No, the program uses the values of the uniform variables as stated at the point of the draw call (<code>glDrawArrays</code>)"}, {"owner": {"reputation": 516, "user_id": 2290639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dUoG4.jpg?s=128&g=1", "display_name": "Reza Hajianpour", "link": "https://stackoverflow.com/users/2290639/reza-hajianpour"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1533155980, "post_id": 51641647, "comment_id": 90248258, "body": "@Rabbid76 Thank you so much! That actually fixed the issue. How dumb of me."}], "answers": [{"tags": [], "owner": {"reputation": 516, "user_id": 2290639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dUoG4.jpg?s=128&g=1", "display_name": "Reza Hajianpour", "link": "https://stackoverflow.com/users/2290639/reza-hajianpour"}, "is_accepted": true, "score": 1, "last_activity_date": 1533156038, "creation_date": 1533156038, "answer_id": 51641942, "question_id": 51641647, "link": "https://stackoverflow.com/questions/51641647/pen-like-behaviour-when-setting-model-matrix-for-freetype-in-opengl/51641942#51641942", "title": "Pen-like behaviour when setting model matrix for freetype in OpenGL", "body": "<p>As mentioned in comments by @Rabbid76, moving the below line to the beginning of <code>Text::draw()</code> fixed the problem:</p>\n\n<pre><code>glUniformMatrix4fv(glGetUniformLocation(this-&gt;program, \"model_matrix\"), 1,\n                   false, &amp;model_matrix[0][0]);\n</code></pre>\n"}], "owner": {"reputation": 516, "user_id": 2290639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dUoG4.jpg?s=128&g=1", "display_name": "Reza Hajianpour", "link": "https://stackoverflow.com/users/2290639/reza-hajianpour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 51641942, "answer_count": 1, "score": 0, "last_activity_date": 1533240034, "creation_date": 1533154654, "question_id": 51641647, "link": "https://stackoverflow.com/questions/51641647/pen-like-behaviour-when-setting-model-matrix-for-freetype-in-opengl", "title": "Pen-like behaviour when setting model matrix for freetype in OpenGL", "body": "<p>So here's the thing. I'm trying to create a Text class using Freetype, which inherits from a Model class, which in turn contains stuff like setting VAO, VBOs, programs, textures, position, rotation and scaling. Here's the code for Model.cpp:</p>\n\n<pre><code>// Model.cpp\n#include \"Model.h\"\n\nusing namespace OpenGL::Rendering;\n\nModel::Model() {\n    model_matrix = glm::mat4(1.0f);\n    position = glm::vec3(0.0, 0.0, 0.0);\n    scale = glm::vec3(1.0, 1.0, 1.0);\n    rotation = glm::vec3(1.0, 0.0, 0.0);\n    rotation_angle = 0.0;\n}\n\nModel::~Model() { destroy(); }\n\nvoid Model::draw() {}\n\nvoid Model::set_program(GLuint program) { this-&gt;program = program; }\n\nGLuint Model::get_vao() const { return vao; }\n\nconst std::vector&lt;GLuint&gt;&amp; Model::get_vbos() const { return vbos; }\n\nGLuint Model::get_texture(std::string texture_name) const {\n    if (textures.size() &gt; 0) {\n        return textures.at(texture_name);\n    } else {\n        Log()-&gt;critical(\"No textures to get. Requested {}\", texture_name);\n        return 0;\n    }\n}\n\nGLuint Model::get_texture() const {\n    if (textures.size() &gt; 0) {\n        return textures.begin()-&gt;second;\n    } else {\n        Log()-&gt;critical(\"No textures to get.\");\n        return 0;\n    }\n}\n\nvoid Model::set_texture(std::string texture_name, GLuint texture) {\n    if (texture == 0) {\n        Log()-&gt;critical(\"Texture {} is empty.\", texture_name);\n        return;\n    } else {\n        textures[texture_name] = texture;\n    }\n}\n\nvoid Model::destroy() {\n    glDeleteVertexArrays(1, &amp;vao);\n    glDeleteBuffers(vbos.size(), &amp;vbos[0]);\n    vbos.clear();\n\n    if (textures.size() &gt; 0) {\n        for (auto&amp; t : textures) {\n            glDeleteTextures(1, &amp;t.second);\n        }\n\n        textures.clear();\n    }\n}\n\nconst glm::vec3&amp; Model::get_position() const { return position; }\n\nvoid Model::set_position(float pos_x, float pos_y, float pos_z) {\n    position = glm::vec3(pos_x, pos_y, pos_z);\n    update_model_matrix();\n}\n\nvoid Model::set_rotation(float angle_deg, float x, float y, float z) {\n    rotation_angle = angle_deg * M_PI / 180.0;\n    rotation = glm::vec3(x, y, z);\n    update_model_matrix();\n}\n\nvoid Model::set_scale(float sca_x, float sca_y, float sca_z) {\n    scale = glm::vec3(sca_x, sca_y, sca_z);\n    update_model_matrix();\n}\n\nvoid Model::update_model_matrix() {\n    model_matrix = glm::mat4(1.0f);\n    auto pos = glm::vec3(this-&gt;position.x, -this-&gt;position.y, this-&gt;position.z);\n    glm::mat4 translate_mat = glm::translate(glm::mat4(1.0f), pos);\n    glm::mat4 rotate_mat = glm::mat4(1.0f);\n    if (this-&gt;rotation.x != 0.0 || this-&gt;rotation.y != 0.0 || this-&gt;rotation.z != 0.0) {\n        rotate_mat = glm::rotate(glm::mat4(1.0f), this-&gt;rotation_angle, this-&gt;rotation);\n    } else {\n        rotate_mat =\n            glm::rotate(glm::mat4(1.0f), 0.0f, glm::vec3(1.0, 0.0, 0.0));\n    }\n\n    glm::mat4 scale_mat = glm::scale(glm::mat4(1.0f), this-&gt;scale);\n\n    this-&gt;model_matrix = translate_mat * rotate_mat * scale_mat;\n    glUniformMatrix4fv(glGetUniformLocation(this-&gt;program, \"model_matrix\"), 1,\n                       false, &amp;this-&gt;model_matrix[0][0]);\n}\n</code></pre>\n\n<p>Then I have my Text class, which uses Freetype to load fonts and stuff. I know it's not optimised really, so look past that. Note that for Freetype, I'm using GL_DYNAMIC_DRAW, instead of GL_STATIC_DRAW</p>\n\n<pre><code>// Text.cpp\n#include \"Text.h\"\n\nusing namespace OpenGL::Rendering::Models;\n\nText::Text(const std::string&amp; text, OpenGL::Container::Position position,\n           int font_size, OpenGL::Container::Color color) {\n    m_font_size = font_size;\n    m_scale = 1.0;\n    m_text = text;\n    float angle = 0;\n    this-&gt;color.r = color.r;\n    this-&gt;color.g = color.g;\n    this-&gt;color.b = color.b;\n    this-&gt;color.a = color.a;\n\n    matrix.xx = (FT_Fixed)(cos(angle) * 0x10000L);\n    matrix.xy = (FT_Fixed)(-sin(angle) * 0x10000L);\n    matrix.yx = (FT_Fixed)(sin(angle) * 0x10000L);\n    matrix.yy = (FT_Fixed)(cos(angle) * 0x10000L);\n\n    this-&gt;position.x = position.x;\n    this-&gt;position.y = position.y;\n    this-&gt;position.z = position.z;\n\n    if (FT_Init_FreeType(&amp;font)) {\n        Log()-&gt;critical(\"Could not initalize Freetype library for fonts.\");\n    }\n\n    if (FT_New_Face(font, \"/usr/share/fonts/truetype/ubuntu/Ubuntu-R.ttf\", 0,\n                    &amp;face)) {\n        Log()-&gt;critical(\"Could not load font. File is missing maybe?\");\n    }\n\n    FT_Set_Char_Size(face, 0, m_font_size * 64, 300, 300);\n    FT_Set_Pixel_Sizes(face, 0, m_font_size);\n    if (FT_Load_Char(face, 'X', FT_LOAD_RENDER)) {\n        Log()-&gt;critical(\n            \"Could not load a test glyph. The font is corrupted maybe?\");\n    }\n\n    for (GLubyte c = 0; c &lt; 128; ++c) {\n        FT_Set_Transform(face, &amp;matrix, 0);\n        if (FT_Load_Char(face, c, FT_LOAD_RENDER)) {\n            Log()-&gt;critical(\"Could not load glyph \\\"{}\\\"\", c);\n            continue;\n        }\n\n        GLuint texture;\n        glGenTextures(1, &amp;texture);\n        glBindTexture(GL_TEXTURE_2D, texture);\n        glTexImage2D(GL_TEXTURE_2D, 0, GL_RED, face-&gt;glyph-&gt;bitmap.width,\n                     face-&gt;glyph-&gt;bitmap.rows, 0, GL_RED, GL_UNSIGNED_BYTE,\n                     face-&gt;glyph-&gt;bitmap.buffer);\n\n        glPixelStorei(GL_UNPACK_ALIGNMENT, 1);\n\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n\n        Character character = {\n            texture,\n            glm::ivec2(face-&gt;glyph-&gt;bitmap.width, face-&gt;glyph-&gt;bitmap.rows),\n            glm::ivec2(face-&gt;glyph-&gt;bitmap_left, face-&gt;glyph-&gt;bitmap_top),\n            face-&gt;glyph-&gt;advance.x};\n\n        characters.insert(std::pair&lt;GLchar, Character&gt;(c, character));\n    }\n\n    FT_Done_Face(face);\n    FT_Done_FreeType(font);\n}\n\nvoid Text::create() {\n    GLuint vao;\n    GLuint vbo;\n\n    glGenVertexArrays(1, &amp;vao);\n    glGenBuffers(1, &amp;vbo);\n\n    glBindVertexArray(vao);\n    glBindBuffer(GL_ARRAY_BUFFER, vbo);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(GLfloat) * 6 * 4, NULL,\n                 GL_DYNAMIC_DRAW);\n\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 4, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat),\n                          (void*)0);\n\n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n    glBindVertexArray(0);\n\n    this-&gt;vao = vao;\n    this-&gt;vbos.push_back(vbo);\n    this-&gt;set_program(OpenGL::Managers::ShaderManager::get_program(\"text\"));\n    // this-&gt;set_position(position.x, position.y, position.z);\n    Log()-&gt;warn(\"Pos {0}, {1}, {2}\", position.x, position.y, position.z);\n}\n\nvoid Text::draw() {\n    GLfloat temp_x = 0;\n    GLfloat temp_y = 0;\n    glUseProgram(this-&gt;program);\n    glUniform4f(glGetUniformLocation(this-&gt;program, \"text_color\"), color.r,\n                color.g, color.b, color.a);\n    glActiveTexture(GL_TEXTURE0);\n    glBindVertexArray(this-&gt;vao);\n\n    std::string::const_iterator c;\n    for (c = m_text.begin(); c != m_text.end(); c++) {\n        Character ch = characters[*c];\n\n        GLfloat xpos = temp_x + ch.bearing.x * m_scale;\n        GLfloat ypos = temp_y - (ch.size.y - ch.bearing.y) * m_scale;\n\n        GLfloat w = ch.size.x * m_scale;\n        GLfloat h = ch.size.y * m_scale;\n\n        GLfloat vertices[6][4] = {\n            {xpos, ypos + h, 0.0, 0.0}, /**/\n            {xpos, ypos, 0.0, 1.0},     /**/\n            {xpos + w, ypos, 1.0, 1.0}, /**/\n\n            {xpos, ypos + h, 0.0, 0.0},    /**/\n            {xpos + w, ypos, 1.0, 1.0},    /**/\n            {xpos + w, ypos + h, 1.0, 0.0} /**/\n        };\n\n        glBindTexture(GL_TEXTURE_2D, ch.texture_id);\n        glBindBuffer(GL_ARRAY_BUFFER, this-&gt;vbos[0]);\n        glBufferSubData(GL_ARRAY_BUFFER, 0, sizeof(vertices), vertices);\n        glBindBuffer(GL_ARRAY_BUFFER, 0);\n        glDrawArrays(GL_TRIANGLES, 0, 6);\n        temp_x += (ch.advance &gt;&gt; 6) * m_scale;\n    }\n    glUniformMatrix4fv(glGetUniformLocation(this-&gt;program, \"model_matrix\"), 1,\n                       false, &amp;model_matrix[0][0]);\n    glBindVertexArray(0);\n    glBindTexture(GL_TEXTURE_2D, 0);\n}\n\nvoid Text::set_text(const std::string&amp; a_text) {\n    if (!a_text.empty()) {\n        m_text = a_text;\n    } else {\n        Log()-&gt;info(\"Cannot set the text. Input seems to be empty.\");\n    }\n}\n\nstd::string Text::get_text() { return m_text; }\n\nvoid Text::set_color(const Container::Color a_color) {\n    color.r = a_color.r;\n    color.g = a_color.g;\n    color.b = a_color.b;\n    color.a = a_color.a;\n}\n</code></pre>\n\n<p>So the problem is, drawing a text behaves like a pen. So when I try to set the position of text1 object, text2 object moves. text2 affects text3 and so on.</p>\n\n<pre><code>// main.cpp\n// This one moves to 200, 100 as defined in text3\nauto text1 = new OpenGL::Rendering::Models::Text(\n    \"Text1\", Container::Position(pos_x - 5, pos_y - radius, 0), 18,\n    Container::Color::YELLOW);\ntext1-&gt;create();\ntext1-&gt;set_scale(3, 3, 3);\ntext1-&gt;set_position(500, 500, 0);\n// This line actually affects text1, as expected\ntext1-&gt;set_text(\"Blah\");\n\n// This one scales to 3 times bigger, as stated in the previous object\nauto text2 = new OpenGL::Rendering::Models::Text(\n    \"Text2\", Container::Position(pos_x - radius - 10, pos_y + radius/1.5, 0), 18,\n    Container::Color::YELLOW);\ntext2-&gt;create();\ntext2-&gt;set_rotation(25, 0, 0, 1);\n\n// And this one gets rotated \nauto text3 = new OpenGL::Rendering::Models::Text(\n    \"Text3\", Container::Position(0, 0, 0), 125,\n    Container::Color::YELLOW);\ntext3-&gt;create();\ntext3-&gt;set_position(200, 100, 0);\n</code></pre>\n\n<p>Here's how it looks like:\n<a href=\"https://i.stack.imgur.com/25xIg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/25xIg.png\" alt=\"Screenshot of the issue\"></a></p>\n\n<p>Can somebody please explain this weird behaviour? The problem is, all other 2D shapes work just fine with my functions, except this Text class, which kinda affects the next object. Thank you very much in advance. If you need more information to diagnose the problem, I'll add it right away.</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1533153644, "post_id": 51641392, "comment_id": 90247252, "body": "C++ containers are not thread-safe for concurrent reads and writes."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1533153650, "post_id": 51641392, "comment_id": 90247256, "body": "If the container is from the standard library, it is not thread safe.  If any thread is modifying it, no other thread may safely access it."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1533153662, "post_id": 51641392, "comment_id": 90247264, "body": "invalidating iterators and having thread-safe state aren&#39;t related.   The answer is that it is by no means guaranteed to be legal."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533154080, "post_id": 51641392, "comment_id": 90247434, "body": "@NeilButterworth Why are you answering in the comments section?"}], "answers": [{"comments": [{"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 1, "creation_date": 1533154235, "post_id": 51641527, "comment_id": 90247487, "body": "Exactly.  All that&#39;s guaranteed by an insert that doesn&#39;t invalidate iterators is that by the END of the insert call it&#39;s valid to continue iterating on it."}, {"owner": {"reputation": 1769, "user_id": 974040, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/483eaae1aa0c673b91e343ac04f7b1ac?s=128&d=identicon&r=PG", "display_name": "Michael Conlen", "link": "https://stackoverflow.com/users/974040/michael-conlen"}, "edited": false, "score": 0, "creation_date": 1533214966, "post_id": 51641527, "comment_id": 90272000, "body": "Thanks. This was my prior but I couldn&#39;t find the wording in the standard that defined what &quot;not invalidating an iterator&quot; really means."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 1769, "user_id": 974040, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/483eaae1aa0c673b91e343ac04f7b1ac?s=128&d=identicon&r=PG", "display_name": "Michael Conlen", "link": "https://stackoverflow.com/users/974040/michael-conlen"}, "edited": false, "score": 0, "creation_date": 1533222562, "post_id": 51641527, "comment_id": 90277457, "body": "@MichaelConlen It means exactly what it says, and nothing else"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1533154187, "last_edit_date": 1533154187, "creation_date": 1533154070, "answer_id": 51641527, "question_id": 51641392, "link": "https://stackoverflow.com/questions/51641392/is-using-stdfind-and-cinsert-thread-safe-if-iterators-are-not-invalidated/51641527#51641527", "title": "Is using std::find and C::insert() thread safe if iterators are not invalidated by insert", "body": "<p>No. Although iterators are not invalidated by your mutating operation, it is still a mutating operation, and none of the standard containers are defined to be safe to read in one thread while a mutating operation is taking place in another. Remember that there are still \"innards\" to your container, all manner of internal state, which may be involved in both operations.</p>\n"}], "owner": {"reputation": 1769, "user_id": 974040, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/483eaae1aa0c673b91e343ac04f7b1ac?s=128&d=identicon&r=PG", "display_name": "Michael Conlen", "link": "https://stackoverflow.com/users/974040/michael-conlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533154187, "creation_date": 1533153521, "question_id": 51641392, "link": "https://stackoverflow.com/questions/51641392/is-using-stdfind-and-cinsert-thread-safe-if-iterators-are-not-invalidated", "title": "Is using std::find and C::insert() thread safe if iterators are not invalidated by insert", "body": "<p>Suppose I have a container C whose iterators are not invalidated upon C.insert(), can I safely perform a std::find() on the container while a concurrent insert() is being performed? That is, am I guaranteed to find a matching element or C::end(), ignoring the fact that the inserted element may match but std::find() gives me C::end()? </p>\n"}, {"tags": ["c++", "pthreads"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1533153622, "post_id": 51641374, "comment_id": 90247242, "body": "<code>extern &quot;C&quot; int main</code> is not a valid C++, as well as <code>pthread_t myPThreads[pThreadCount];</code>"}, {"owner": {"reputation": 1, "user_id": 10167563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19d68709362833f44484fc80ed2cbb4?s=128&d=identicon&r=PG&f=1", "display_name": "plshelp", "link": "https://stackoverflow.com/users/10167563/plshelp"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533153963, "post_id": 51641374, "comment_id": 90247382, "body": "@VTT Thanks for the fast reply, I removed the <code>extern &quot;C&quot;</code> part, but I see <code>pthread_t someName[numberOfThreads]</code> in a bunch of examples, am I missing something?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533154023, "post_id": 51641374, "comment_id": 90247404, "body": "Variable length array exist as (optional and uncommon) feature in recent C variants, but not in C++. If your compiler compiles this code then it is most likely a gnu extension."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1533154448, "post_id": 51641374, "comment_id": 90247577, "body": "@plshelp please update your code to reflect the current state of the things you have tried (removing extern &quot;C&quot; and anything else)"}, {"owner": {"reputation": 1, "user_id": 10167563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19d68709362833f44484fc80ed2cbb4?s=128&d=identicon&r=PG&f=1", "display_name": "plshelp", "link": "https://stackoverflow.com/users/10167563/plshelp"}, "reply_to_user": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533154728, "post_id": 51641374, "comment_id": 90247697, "body": "@VTT Is there a better way to implement the ability to input buffer size, number of producers, number of consumers, and total item count? When I remove the lines that try to reference myStack and just add print statements the threads seem to work ok."}, {"owner": {"reputation": 1, "user_id": 10167563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19d68709362833f44484fc80ed2cbb4?s=128&d=identicon&r=PG&f=1", "display_name": "plshelp", "link": "https://stackoverflow.com/users/10167563/plshelp"}, "reply_to_user": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1533155243, "post_id": 51641374, "comment_id": 90247940, "body": "@xaxxon Done, for just testing the ability to make threads I commented out the lines in producer and consumer that try to access myStack with the pointer and added the (now commented out) cout lines."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10167563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19d68709362833f44484fc80ed2cbb4?s=128&d=identicon&r=PG&f=1", "display_name": "plshelp", "link": "https://stackoverflow.com/users/10167563/plshelp"}, "edited": false, "score": 0, "creation_date": 1533156095, "post_id": 51641818, "comment_id": 90248319, "body": "Thanks for catching that with the loop, unfortunately the problem still persists. When stepping though to debug, the first producer goes through its code, then the first consumer seg faults at top() still."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 1, "user_id": 10167563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19d68709362833f44484fc80ed2cbb4?s=128&d=identicon&r=PG&f=1", "display_name": "plshelp", "link": "https://stackoverflow.com/users/10167563/plshelp"}, "edited": false, "score": 0, "creation_date": 1533173713, "post_id": 51641818, "comment_id": 90252769, "body": "<code>iCount == data-&gt;itemcount</code> clause may be entered multiple times (once by each consumer thread), which again may lead to calling <code>top</code> on empty stack."}], "tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": false, "score": 1, "last_activity_date": 1533155443, "creation_date": 1533155443, "answer_id": 51641818, "question_id": 51641374, "link": "https://stackoverflow.com/questions/51641374/pthread-segment-fault-using-pointer-to-variable-in-main/51641818#51641818", "title": "Pthread segment fault using pointer to variable in main", "body": "<p><code>iCount &lt;= data-&gt;itemcount</code> is always true. <code>consumer</code> never exits the loop. At some point, it exhausts the stack, and the subsequent <code>top()</code> call exhibits undefined behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 3692, "user_id": 3284149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZLfgb.jpg?s=128&g=1", "display_name": "Saveen", "link": "https://stackoverflow.com/users/3284149/saveen"}, "edited": false, "score": 0, "creation_date": 1533175891, "post_id": 51644323, "comment_id": 90253198, "body": "This does not provide an answer to the question. To critique or request clarification from an author, leave a comment below their post. - <a href=\"/review/low-quality-posts/20473048\">From Review</a>"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 3692, "user_id": 3284149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZLfgb.jpg?s=128&g=1", "display_name": "Saveen", "link": "https://stackoverflow.com/users/3284149/saveen"}, "edited": false, "score": 1, "creation_date": 1533184387, "post_id": 51644323, "comment_id": 90255008, "body": "@Saveen Does too. <code>consumer</code> calls <code>top()</code> on an uninitialized pointer, hence the crash."}], "tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": false, "score": 0, "last_activity_date": 1533184460, "last_edit_date": 1533184460, "creation_date": 1533173509, "answer_id": 51644323, "question_id": 51641374, "link": "https://stackoverflow.com/questions/51641374/pthread-segment-fault-using-pointer-to-variable-in-main/51644323#51644323", "title": "Pthread segment fault using pointer to variable in main", "body": "<p><code>cThrData[i].ptr</code> is never initialized, for any <code>i</code>. <code>consumer</code> calls <code>top()</code> through an uninitialized pointer, whereupon the program exhibits undefined behavior.</p>\n"}], "owner": {"reputation": 1, "user_id": 10167563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19d68709362833f44484fc80ed2cbb4?s=128&d=identicon&r=PG&f=1", "display_name": "plshelp", "link": "https://stackoverflow.com/users/10167563/plshelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533184460, "creation_date": 1533153422, "last_edit_date": 1533157590, "question_id": 51641374, "link": "https://stackoverflow.com/questions/51641374/pthread-segment-fault-using-pointer-to-variable-in-main", "title": "Pthread segment fault using pointer to variable in main", "body": "<p>I'm new to pthread and attempting to implement a producer/consumer problem that will let the user pick buffer size, # of producers, # of consumers, and total # of items. I've been looking through what I thought were similar things on stack overflow, but can't seem to get it right.</p>\n\n<p>My code has a main class and it spawns producers and consumers. It hands the producers and consumers a pointer to a stack initialized in main (or at least I'm trying to). I thought that what I was doing was legal and in CLion I get the predictive text options I want so I thought I linked it properly but I'm segfaulting when I try to read the top element.</p>\n\n<p>I used GDB to make sure I knew what line I was crashing on, but don't understand what's wrong with my setup. While debugging I confirmed that a producer goes through its push() command first, but the consumer fails when attempting top() or pop(). I'd seen some threads here where the OP had problems because they didn't join their threads, but I am so I'm a little lost.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stack&gt;\n#include &lt;cstring&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;pthread.h&gt;\n#define N 10000\n\nsem_t mutex;\nsem_t fullCount;\nsem_t emptyCount;\nint iCount = 0;\n\ntypedef struct _thread_data{\n    int id;\n    int itemcount;\n    std::stack&lt;char&gt;* ptr;\n}thread_data;\n\nvoid *producer(void *arg){\n    std::cout &lt;&lt; \"spawned producer\\n\";\n    thread_data *data = (thread_data *)arg;\n    while(true){\n        char message = 'X';\n        sem_wait(&amp;emptyCount);\n        sem_wait(&amp;mutex);\n        if(iCount &lt; data-&gt;itemcount){\n            data-&gt;ptr-&gt;push(message);\n            iCount++;\n            char temp [25];\n            sprintf(temp, \"p:&lt;%u&gt;, item: %c, at %d\\n\", data-&gt;id, message, data-&gt;ptr-&gt;size());\n            std::cout &lt;&lt; temp;\n            //std::cout &lt;&lt; \"hi I'm a producer\\n\";\n            sem_post(&amp;mutex);\n            sem_post(&amp;fullCount);\n        }\n        else{\n            sem_post(&amp;fullCount);\n            sem_post(&amp;mutex);\n            pthread_exit(nullptr);\n        }\n    }\n}\n\nvoid *consumer(void *arg){\n    std::cout &lt;&lt; (\"spawned consumer\\n\");\n    thread_data *data = (thread_data *)arg;\n    while(true){\n        char message;\n        sem_wait(&amp;fullCount);\n        sem_wait(&amp;mutex);\n        if(iCount &lt; data-&gt;itemcount) {\n            message = data-&gt;ptr-&gt;top(); //SEGFAULT\n            char temp[25];\n            printf(temp, \"c:&lt;%u&gt;, item: %c, at %d\\n\", data-&gt;id, message, data-&gt;ptr-&gt;size());\n            data-&gt;ptr-&gt;pop();\n            std::cout &lt;&lt; temp;\n            //std::cout &lt;&lt; \"Hi I'm a consumer\\n\";\n            sem_post(&amp;mutex);\n            sem_post(&amp;emptyCount);\n        }\n        else if (iCount == data-&gt;itemcount){\n            message = data-&gt;ptr-&gt;top(); //SEGFAULT\n            char temp[25];\n            printf(temp, \"c:&lt;%u&gt;, item: %c, at %d\\n\", data-&gt;id, message, data-&gt;ptr-&gt;size());\n            data-&gt;ptr-&gt;pop();\n            std::cout &lt;&lt; temp;\n            sem_post(&amp;emptyCount);\n            sem_post(&amp;mutex);\n            pthread_exit(nullptr);\n        }\n        else{\n            sem_post(&amp;mutex);\n            pthread_exit(nullptr);\n        }\n\n    }\n}\n\nint main(int argc, char *argv[]){\n    int bufferSize = N;\n    int pThreadCount,cThreadCount,itemCount;\n    for (int x = 0; x &lt; argc; ++x) {\n        if(strcmp(argv[x],\"-b\") == 0){\n            bufferSize = atoi(argv[x+1]);\n        }\n        if(strcmp(argv[x],\"-p\") == 0){\n            pThreadCount = atoi(argv[x+1]);\n        }\n        if(strcmp(argv[x],\"-c\") == 0){\n            cThreadCount = atoi(argv[x+1]);\n        }\n        if(strcmp(argv[x],\"-i\") == 0){\n            itemCount = atoi(argv[x+1]);\n        }\n    }\n    sem_init(&amp;mutex,1,1);\n    sem_init(&amp;fullCount,1,0);\n    sem_init(&amp;emptyCount,1,bufferSize);\n\n    std::stack&lt;char&gt; myStack;\n    pthread_t myPThreads[pThreadCount];\n    thread_data thrData[pThreadCount];\n    pthread_t myCThreads[cThreadCount];\n    thread_data cThrData[cThreadCount];\n\n    for (int i = 0; i &lt; pThreadCount; ++i) {\n        thrData[i].id = i;\n        thrData[i].itemcount = itemCount;\n        thrData[i].ptr = &amp;myStack;\n        pthread_create(&amp;myPThreads[i], NULL, producer, &amp;thrData[i]);\n    }\n    for (int i = 0; i &lt; cThreadCount; ++i) {\n        cThrData[i].id = i;\n        cThrData[i].itemcount = itemCount;\n        thrData[i].ptr = &amp;myStack;\n        pthread_create(&amp;myCThreads[i], NULL, consumer, &amp;cThrData[i]);\n    }\n\n    for (int k = 0; k &lt; pThreadCount; ++k) {\n        pthread_join(myPThreads[k], NULL);\n    }\n    for (int j = 0; j &lt; cThreadCount; ++j) {\n        pthread_join(myCThreads[j], NULL);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "g++", "glsl", "mingw"], "answers": [{"comments": [{"owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "edited": false, "score": 0, "creation_date": 1533822807, "post_id": 51759423, "comment_id": 90496400, "body": "I already have my complete GLSL math library and it&#39;s faster, way better than GLM with <i>extras</i> and more GLSL-like, I was switching between struct and class definitions to debug the problem so I don&#39;t need to type <code>public:</code> every time, <i>forgot to remove it</i>. By the way, none of these command-lines worked. GLM itself doesn&#39;t support that feature. What makes my library more GLSL-like is that it has this feature so I&#39;ve to fix it for all compilers or just let go it exactly as GLM did for the sake of the cross-platform compatibility... any other solution?"}, {"owner": {"reputation": 104, "user_id": 9200997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e117a1b9cb142b704e910040c186c047?s=128&d=identicon&r=PG&f=1", "display_name": "Shorrer", "link": "https://stackoverflow.com/users/9200997/shorrer"}, "reply_to_user": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "edited": false, "score": 1, "creation_date": 1533825039, "post_id": 51759423, "comment_id": 90497911, "body": "Here (<a href=\"https://github.com/g-truc/glm/blob/master/manual.md#section2\" rel=\"nofollow noreferrer\">github.com/g-truc/glm/blob/master/manual.md#section2</a>) they say that for GLM will support swizzling if GLM_FORCE_SWIZZLE is defined before any other GLM file, and I really remember it working for me, but I used it on MSVC only. It has some quirks, which all detailed in the link I provided. About question, I sorry, I can&#39;t really help now if those flags didn&#39;t helped."}, {"owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "edited": false, "score": 0, "creation_date": 1533908950, "post_id": 51759423, "comment_id": 90533200, "body": "Woow! I didn&#39;t know that it can do it. Also, it compiles fine in any compiler without any flags... I&#39;ll try to look into the source code and understand how it works. Thanks a lot!"}], "tags": [], "owner": {"reputation": 104, "user_id": 9200997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e117a1b9cb142b704e910040c186c047?s=128&d=identicon&r=PG&f=1", "display_name": "Shorrer", "link": "https://stackoverflow.com/users/9200997/shorrer"}, "is_accepted": false, "score": 2, "last_activity_date": 1533792556, "creation_date": 1533792556, "answer_id": 51759423, "question_id": 51641131, "link": "https://stackoverflow.com/questions/51641131/how-to-achieve-vector-swizzling-in-c/51759423#51759423", "title": "How to achieve vector swizzling in C++?", "body": "<p>As for <em>\"member with constructor not allowed in anonymous aggregate\"</em>, , is due to compiler running in compliance with older standard, because <a href=\"https://en.wikipedia.org/wiki/C%2B%2B11#Unrestricted_unions\" rel=\"nofollow noreferrer\">as of C++11, unions can have members with non-trivial constructors</a> (you defined your own constructor, so it's non-trivial, details about this can be found <a href=\"https://stackoverflow.com/questions/3899223/what-is-a-non-trivial-constructor-in-c\">here</a>). Add -std=c++11 in your g++ compiler's arguments and this error will likely be gone.</p>\n\n<p>Next. The only flags for g++ that could <strong>maybe</strong> make it compile your code are <em>-fms-extensions</em> and <em>-fvisibility-ms-compat</em>. Anonymous structs are a <em>non-standard</em> extension that Microsoft added to their compiler. Sorry, right now I can't test it, but I think that would do the trick.</p>\n\n<p>And now some extras.</p>\n\n<ol>\n<li>Unlike in C, you shouldn't <code>typedef</code> structs in C++ \u2014 if you named your structs, you can refer to them using that name as type.</li>\n<li>Structs are public by default, no need in <code>public</code> here. Classes, however, are private by default.</li>\n<li>If your intent is to just be able to use GLSL math in C++, <a href=\"https://glm.g-truc.net/0.9.9/index.html\" rel=\"nofollow noreferrer\">GLM</a> is the way to do it. If you want to learn how to do it yourself you can refer to their source code (it is quite heavy with templates, though).</li>\n<li>Other g++ options can be found <a href=\"https://linux.die.net/man/1/g++\" rel=\"nofollow noreferrer\">here</a>.</li>\n</ol>\n\n<p>Hope that this will help you at least somehow.</p>\n"}, {"comments": [{"owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "edited": false, "score": 0, "creation_date": 1533822713, "post_id": 51760124, "comment_id": 90496344, "body": "I should make them anonymous to work as expected. It didn&#39;t work with the example provided in this post. The problem is with only constructors, not the whole variables. Actually, I don&#39;t know much about C++17, How can <code>std::variant</code> achieve this?."}], "tags": [], "owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "is_accepted": false, "score": 5, "last_activity_date": 1546772788, "last_edit_date": 1546772788, "creation_date": 1533795846, "answer_id": 51760124, "question_id": 51641131, "link": "https://stackoverflow.com/questions/51641131/how-to-achieve-vector-swizzling-in-c/51760124#51760124", "title": "How to achieve vector swizzling in C++?", "body": "<p>First, anonymous struct is <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Unnamed-Fields.html\" rel=\"nofollow noreferrer\">a feature from C11</a>, and is <a href=\"https://stackoverflow.com/questions/2253878/why-does-c-disallow-anonymous-structs\">not allowed by C++</a>, so it does not support class members with constructors (not a C struct). To write portable C++ code, you should avoid anonymous struct:</p>\n\n<pre><code>struct vec2 // use C++ style struct declaration\n{\n// struct is public by default\n    union\n    {\n        struct { float x, y; } xy; // add member name, \n        struct { float r, g; } rg; // now the declaration declares a member \n        struct { float s, t; } st; // instead of an anonymous struct\n    };\n    vec2() {}\n    vec2(float a, float b) : xy{a, b} {}\n                          // ^^^^^^^^ also change the initialization\n};\n\nstruct vec3\n{\npublic:\n    union\n    {\n        struct { float x, y, z; } xyz;     //\n        struct { float r, g, b; } rgb;     //\n        struct { float s, t, p; } stp;     // add member name\n        struct { vec2 xy; float z; } vecz; //\n        struct { float x; vec2 yz; } xvec; //\n    };\n    vec3() {}\n    vec3(float a, float b, float c) : xyz{a, b, c} {}\n                                   // ^^^^^^^^ also change the initialization\n};\n</code></pre>\n\n<p>Now the code compiles under GCC, but that's not enough. Under Clang with <code>-pedantic-errors</code>, you'll get <a href=\"https://godbolt.org/g/L5nU4L\" rel=\"nofollow noreferrer\">several errors</a>:</p>\n\n<pre><code>error: anonymous types declared in an anonymous union are an extension [-Werror,-Wnested-anon-types]\n</code></pre>\n\n<p>This is because you cannot declare a nested type in an anonymous union, so you should also move these struct definitions outside the union:</p>\n\n<pre><code>struct vec2\n{\n    struct XY { float x, y; };\n    struct RG { float r, g; };\n    struct ST { float s, t; };\n    union\n    {\n        XY xy; \n        RG rg; \n        ST st; \n    };\n    vec2() {}\n    vec2(float a, float b) : xy{a, b} {}\n};\n\nstruct vec3\n{\n    struct XYZ { float x, y, z; };     \n    struct RGB { float r, g, b; };     \n    struct STP { float s, t, p; };     \n    struct VECZ { vec2 xy; float z; }; \n    struct XVEC { float x; vec2 yz; }; \n    union\n    {\n        XYZ xyz;     \n        RGB rgb;     \n        STP stp;     \n        VECZ vecz; \n        XVEC xvec; \n    };\n    vec3() {}\n    vec3(float a, float b, float c) : xyz{a, b, c} {}\n};\n</code></pre>\n\n<p>Although this solution works, you can only access the members via, for example, <code>v.xy.x</code>, instead of simple <code>v.x</code>. In addition, aliasing <code>vec2</code> with two <code>float</code>s would result in undefined behavior. I think there is no standard solution to achieve vector swizzling perfectly. </p>\n\n<p>For non-standard solution, one can use a proxy class without constructors instead of <code>vec2</code> to make the compiler work. The <a href=\"https://github.com/g-truc/glm\" rel=\"nofollow noreferrer\">GLM library</a> also uses this idea. OP has already posted an <a href=\"https://stackoverflow.com/a/51822107/5376789\">answer</a> as a complete implementation of this idea.    </p>\n"}, {"comments": [{"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 1, "creation_date": 1534163812, "post_id": 51822107, "comment_id": 90598947, "body": "Unfortunately, this answer still uses the anonymous struct extension. It <a href=\"https://godbolt.org/g/N4RFLp\" rel=\"nofollow noreferrer\">does not compile</a> with <a href=\"https://gcc.gnu.org/onlinedocs/gcc-8.2.0/gcc/Warning-Options.html#Warning-Options\" rel=\"nofollow noreferrer\"><code>-pedantic-errors</code></a>."}, {"owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "reply_to_user": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1534164251, "post_id": 51822107, "comment_id": 90599260, "body": "That&#39;s actually easy to fix by creating a <code>vec1_swizzle</code>."}, {"owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "reply_to_user": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1534172839, "post_id": 51822107, "comment_id": 90604984, "body": "By the way, for sure <b><i>it won&#39;t compile</i></b> because <code>-pedantic-errors</code> flag is used to convert <code>-pedantic</code> warnings to errors."}, {"owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "reply_to_user": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1534248950, "post_id": 51822107, "comment_id": 90635408, "body": "@xskxzr forgot to edit my answer sooner... Now it works with <code>-pedantic-errors</code>. :D"}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 3, "creation_date": 1534250152, "post_id": 51822107, "comment_id": 90636115, "body": "You violate the <a href=\"https://stackoverflow.com/q/98650/5376789\">strict aliasing rule</a>."}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 2, "creation_date": 1534251556, "post_id": 51822107, "comment_id": 90637068, "body": "I mean this expression: <code>*(vec_type*)this</code>. In fact, unions <a href=\"https://stackoverflow.com/q/11373203/5376789\">are also dangerous in C++</a>, which is different from that in C."}, {"owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "reply_to_user": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1534351428, "post_id": 51822107, "comment_id": 90678059, "body": "In networking, we <b>always</b> cast <code>sockaddr_in*</code> to <code>sockaddr*</code> and vice versa. Won&#39;t that break it too? updated answer by the way."}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 1, "creation_date": 1534354422, "post_id": 51822107, "comment_id": 90679383, "body": "&quot;In networking, we always cast sockaddr_in* to sockaddr* and vice versa.&quot; <a href=\"https://stackoverflow.com/a/42190913/5376789\">That&#39;s due to historical reasons and is a bad habit nowadays</a>."}], "tags": [], "owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "is_accepted": true, "score": 2, "last_activity_date": 1534351422, "last_edit_date": 1534351422, "creation_date": 1534162357, "answer_id": 51822107, "question_id": 51641131, "link": "https://stackoverflow.com/questions/51641131/how-to-achieve-vector-swizzling-in-c/51822107#51822107", "title": "How to achieve vector swizzling in C++?", "body": "<p>Well, I've found the solution myself using only the C++ Standards.<br>\nNo <em>command-lines</em> neither using <em>compiler-specific</em> code.</p>\n\n<p>So this is my new and simple implementation</p>\n\n<pre><code>template&lt;unsigned int I&gt;\nstruct scalar_swizzle\n{\n    float v[1];\n    float &amp;operator=(const float x)\n    {\n        v[I] = x;\n        return v[I];\n    }\n    operator float() const\n    {\n        return v[I];\n    }\n    float operator++(int)\n    {\n        return v[I]++;\n    }\n    float operator++()\n    {\n        return ++v[I];\n    }\n    float operator--(int)\n    {\n        return v[I]--;\n    }\n    float operator--()\n    {\n        return --v[I];\n    }\n};\n// We use a vec_type in a template instead of forward declartions to prevent erros in some compilers.\ntemplate&lt;typename vec_type, unsigned int A, unsigned int B&gt;\nstruct vec2_swizzle\n{\n    float d[2];\n    vec_type operator=(const vec_type&amp; vec)\n    {\n        return vec_type(d[A] = vec.x, d[B] = vec.y);\n    }\n    operator vec_type()\n    {\n        return vec_type(d[A], d[B]);\n    }\n};\nstruct vec2\n{\n    union\n    {\n        float d[2];\n        scalar_swizzle&lt;0&gt; x, r, s;\n        scalar_swizzle&lt;1&gt; y, g, t;\n        vec2_swizzle&lt;vec2, 0, 0&gt; xx;\n        vec2_swizzle&lt;vec2, 1, 1&gt; yy;\n    };\n    vec2() {}\n    vec2(float all)\n    {\n        x = y = all;\n    }\n    vec2(float a, float b)\n    {\n        x = a;\n        y = b;\n    }\n};\n/* Debugging */\ninline std::ostream&amp; operator&lt;&lt;(std::ostream &amp;os, vec2 vec)\n{\n    os &lt;&lt; \"(\" &lt;&lt; vec.x &lt;&lt; \", \" &lt;&lt; vec.y &lt;&lt; \")\";\n    return os;\n}\ntemplate&lt;typename vec_type, unsigned int A, unsigned int B, unsigned int C&gt;\nstruct vec3_swizzle\n{\n    float d[3];\n    vec_type operator=(const vec_type&amp; vec)\n    {\n        return vec_type(d[A] = vec.x, d[B] = vec.y, d[C] = vec.z);\n    }\n    operator vec_type()\n    {\n        return vec_type(d[A], d[B], d[C]);\n    }\n};\nstruct vec3\n{\n    union\n    {\n        float d[3];\n        scalar_swizzle&lt;0&gt; x, r, s;\n        scalar_swizzle&lt;1&gt; y, g, t;\n        scalar_swizzle&lt;2&gt; z, b, p;\n        vec2_swizzle&lt;vec2, 0, 1&gt; xy;\n        vec2_swizzle&lt;vec2, 1, 2&gt; yz;\n        vec3_swizzle&lt;vec3, 0, 1, 2&gt; xyz;\n        vec3_swizzle&lt;vec3, 2, 1, 0&gt; zyx;\n    };\n    vec3() {}\n    vec3(float all)\n    {\n        x = y = z = all;\n    }\n    vec3(float a, float b, float c)\n    {\n        x = a;\n        y = b;\n        z = c;\n    }\n};\n/* Debugging */\ninline std::ostream&amp; operator&lt;&lt;(std::ostream &amp;os, vec3 vec)\n{\n    os &lt;&lt; \"(\" &lt;&lt; vec.x &lt;&lt; \", \" &lt;&lt; vec.y &lt;&lt; \", \" &lt;&lt; vec.z &lt;&lt; \")\";\n    return os;\n}\n</code></pre>\n\n<p>Of course, you can add/create more swizzlings. Now with a little test.</p>\n\n<pre><code>int main()\n{\n    vec3 v0(10, 20, 30);\n    std::cout &lt;&lt; v0.zyx &lt;&lt; std::endl;\n    vec2 c(-5, -5);\n    v0.xy = c;\n    vec2 v1(v0.yz);\n    std::cout &lt;&lt; v0 &lt;&lt; std::endl;\n    std::cout &lt;&lt; v1 &lt;&lt; std::endl;\n    vec3 v(50, 60, 70);\n    vec2 d = v.yz;\n    std::cout &lt;&lt; d &lt;&lt; std::endl;\n    float f = d.x * d.y;\n    std::cout &lt;&lt; f &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Out:</strong></p>\n\n<pre><code>(30, 20, 10)\n(-5, -5, 30)\n(-5, 30)\n(60, 70)\n4200\n</code></pre>\n\n<p>You can print the vectors for debugging with <code>std::cout</code> if you're not using an <strong>IDE</strong> as I did in gcc.</p>\n"}], "owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2385, "favorite_count": 1, "accepted_answer_id": 51822107, "answer_count": 3, "score": 12, "last_activity_date": 1546772788, "creation_date": 1533152352, "last_edit_date": 1534363858, "question_id": 51641131, "link": "https://stackoverflow.com/questions/51641131/how-to-achieve-vector-swizzling-in-c", "title": "How to achieve vector swizzling in C++?", "body": "<pre><code>struct vec2\n{\n    union\n    {\n        struct { float x, y; };\n        struct { float r, g; };\n        struct { float s, t; };\n    };\n    vec2() {}\n    vec2(float a, float b) : x(a), y(b) {}\n};\nstruct vec3\n{\n    union\n    {\n        struct { float x, y, z; };\n        struct { float r, g, b; };\n        struct { float s, t, p; };\n        // Here is the problem with g++.\n        struct { vec2 xy; float z; };\n        struct { float x; vec2 yz; };\n    };\n    vec3() {}\n    vec3(float a, float b, float c) : x(a), y(b), z(c) {}\n};\n</code></pre>\n\n<p>The code above compiles and works as expected in Visual Studio and so I can use it like</p>\n\n<pre><code>vec3 v1(1.f, 2.f, 3.f);\nvec2 v2 = v1.yz; // (2, 3)\n</code></pre>\n\n<p><strong>Not</strong> in g++ (MinGW).</p>\n\n<pre><code>src/main.cpp:22:23: error: member 'vec2 vec3::&lt;unnamed union&gt;::&lt;unnamed struct&gt;::xy' with constructor not allowed in anonymous aggregate\nsrc/main.cpp:22:33: error: redeclaration of 'float vec3::&lt;unnamed union&gt;::&lt;unnamed struct&gt;::z'\nsrc/main.cpp:18:30: note: previous declaration 'float vec3::&lt;unnamed union&gt;::&lt;unnamed struct&gt;::z'\nsrc/main.cpp:23:32: error: member 'vec2 vec3::&lt;unnamed union&gt;::&lt;unnamed struct&gt;::yz' with constructor not allowed in anonymous aggregate\nsrc/main.cpp:23:24: error: redeclaration of 'float vec3::&lt;unnamed union&gt;::&lt;unnamed struct&gt;::x'\nsrc/main.cpp:18:24: note: previous declaration 'float vec3::&lt;unnamed union&gt;::&lt;unnamed struct&gt;::x'\n</code></pre>\n\n<p>I think I shouldn't be doing it like that in the first place. Any Ideas?<br></p>\n\n<p><strong>Edit:</strong> After reading a lot of articles and exploring open-source projects, I started to get how vector swizzling should be like and posted the solution below, still waiting for better answers though.</p>\n\n<blockquote>\n  <p><strong>Edit 2:</strong> All <code>vec*</code> members <strong><em>must be accessed only from the parent</em></strong> like the <strong>GLM</strong> library.</p>\n</blockquote>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1575, "user_id": 3056501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215f27224256fccc7e3083d0d248cac6?s=128&d=identicon&r=PG&f=1", "display_name": "divinas", "link": "https://stackoverflow.com/users/3056501/divinas"}, "edited": false, "score": 8, "creation_date": 1533152320, "post_id": 51641103, "comment_id": 90246643, "body": "You&#39;re most probably looking for a std::map, not std::set. std::set is a container that holds only keys, but not values"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533152820, "post_id": 51641103, "comment_id": 90246887, "body": "Welcome to Stack Overflow. Please take the time to go through the <a href=\"http://stackoverflow.com/tour\">The Tour</a> and refer to the material from the <a href=\"http://stackoverflow.com/help/asking\">Help Center</a> on what and how you can ask here.It&#39;s specially important to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1533152822, "post_id": 51641103, "comment_id": 90246888, "body": "This doesn&#39;t address the question, but you don&#39;t need that <code>typedef enum ...</code> dance (even if it was written correctly). That&#39;s a C-ism. Drop the <code>typedef</code>."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1533153146, "post_id": 51641103, "comment_id": 90247024, "body": "Missing semicolon after typedef. Next..."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "edited": false, "score": 0, "creation_date": 1533159618, "post_id": 51641390, "comment_id": 90249693, "body": "Thanks for the answer. Here, if i print SEND_DATA_1 or modules[&quot;poop&quot;] then both will give me 0 value. I want to use my enum as key values and add my data for each key. For example, if SEND_DATA_1 = &quot;ABC&quot;, &quot;SEND_DATA_2&quot; = &quot;CDE&quot;. How can i achieve that?"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "edited": false, "score": 0, "creation_date": 1533160791, "post_id": 51641390, "comment_id": 90250051, "body": "@RookieDev If I understand right, you want the enum to be the key and the string to be the value. Change the map to &#39;std::map&lt;SendDataElements, std::string&gt; modules;&#39; and the assignment to &#39;modules[SEND_DATA_1] = &quot;ABC&quot;;&#39;"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "edited": false, "score": 0, "creation_date": 1533160915, "post_id": 51641390, "comment_id": 90250083, "body": "Also, keep in mind that the enums SEND_DATA_1 is 0, SEND_DATA_2 is 1, etc. Enums evaluate to integral values. What you will want to evaluate is the elements in your map after you initialize the map and set up all your associations with the strings you want."}], "tags": [], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "is_accepted": false, "score": 4, "last_activity_date": 1533153518, "creation_date": 1533153518, "answer_id": 51641390, "question_id": 51641103, "link": "https://stackoverflow.com/questions/51641103/how-to-use-set-and-enum-together/51641390#51641390", "title": "How to use set and enum together?", "body": "<pre><code>#include &lt;map&gt;\n\nint main()\n{\n    enum SendDataElements\n    {\n        SEND_DATA_1,\n        SEND_DATA_2,\n        SEND_DATA_3,\n        SEND_DATA_4,\n    };\n\n    std::map&lt;std::string, SendDataElements&gt; modules;\n    modules[\"poop\"] = SEND_DATA_1;\n}\n</code></pre>\n\n<p>As others have said in the comments of your original question, std::set only accepts keys, while you are trying to store keys and values. You are probably looking to use a map. I also updated the style of your enum.</p>\n"}], "owner": {"reputation": 43, "user_id": 10167681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06afd12933439869fd932b1d2eb845d3?s=128&d=identicon&r=PG&f=1", "display_name": "RookieDev", "link": "https://stackoverflow.com/users/10167681/rookiedev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533153518, "creation_date": 1533152231, "question_id": 51641103, "link": "https://stackoverflow.com/questions/51641103/how-to-use-set-and-enum-together", "title": "How to use set and enum together?", "body": "<p>I just started coding in c++. My first task is to create set of an enum and pass string values in set using enum values as keys for each string value. I have no idea how to do that.</p>\n\n<p>my best guess.</p>\n\n<pre><code>typedef enum sendDataElements\n{\n    Data1,\n    Data2,\n    Data3,\n    Data4,\n}\nstd::set&lt;string, sendDataElements&gt; m_modules;\nm_modules.insert(message, Data1);\n</code></pre>\n\n<p>Doesn't compile though. Please help.</p>\n"}, {"tags": ["c++", "eigen3"], "answers": [{"tags": [], "owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "is_accepted": false, "score": 17, "last_activity_date": 1536679803, "last_edit_date": 1536679803, "creation_date": 1533154010, "answer_id": 51641512, "question_id": 51640997, "link": "https://stackoverflow.com/questions/51640997/how-to-get-the-number-of-rows-and-columns-of-an-eigenmatrixxd/51641512#51641512", "title": "How to get the number of rows and columns of an Eigen::MatrixXd?", "body": "<p>This should work...</p>\n\n<pre><code>#include &lt;Eigen/Dense&gt;\n\nint main()\n{\n    Eigen::MatrixXd matrix(3, 4);\n\n    int r = matrix.rows();\n    int c = matrix.cols();\n\n    for (int i = 0; i &lt; r; ++i)\n    {\n        for (int j = 0; j &lt; c; ++j)\n        {\n            std::cout &lt;&lt; matrix(i,j);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 243, "user_id": 9646358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8518b96572e49e078883cec4f181fb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Oconnor", "link": "https://stackoverflow.com/users/9646358/tom-oconnor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8301, "favorite_count": 0, "answer_count": 1, "score": 13, "last_activity_date": 1536679803, "creation_date": 1533151812, "question_id": 51640997, "link": "https://stackoverflow.com/questions/51640997/how-to-get-the-number-of-rows-and-columns-of-an-eigenmatrixxd", "title": "How to get the number of rows and columns of an Eigen::MatrixXd?", "body": "<p>I am trying to traverse <code>Eigen::MatrixXd matrix</code>. However, there does not seem to be a function that returns the columns size nor the row size. Does anybody have an idea on how to do this?</p>\n"}, {"tags": ["c++", "c++11", "vector", "c++14"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1533151780, "post_id": 51640949, "comment_id": 90246358, "body": "<code>gltf</code> is not copyable, it likely has at least one member, <code>asset</code>, that is not copyable."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 1, "creation_date": 1533151825, "post_id": 51640949, "comment_id": 90246381, "body": "The error message is telling you that <code>gltf</code> does not define a copy-constructor. You should write a copy constructor (keeping in mind the <a href=\"https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\">rule-of-three</a>), or define a move-constructor (which brings you to the <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">rule-of-five</a>) and then <code>push_back(std::move(stagingModel));</code>"}, {"owner": {"reputation": 947, "user_id": 1788024, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1e0dc0ea761caf9029402fa3d9527aed?s=128&d=identicon&r=PG&f=1", "display_name": "BulBul", "link": "https://stackoverflow.com/users/1788024/bulbul"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533157314, "post_id": 51640949, "comment_id": 90248861, "body": "@Fran&#231;oisAndrieux but what makes it not copyable? is there a way around this issue?"}], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 1788024, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1e0dc0ea761caf9029402fa3d9527aed?s=128&d=identicon&r=PG&f=1", "display_name": "BulBul", "link": "https://stackoverflow.com/users/1788024/bulbul"}, "edited": false, "score": 0, "creation_date": 1533157917, "post_id": 51641042, "comment_id": 90249105, "body": "previously i was able to use this class to load 3d models (without using a vector for the class), so i presume the non copyable member is a direct member of gltf (probably asset as someone mentioned in the comments) i will modify the code and give feedback here."}, {"owner": {"reputation": 947, "user_id": 1788024, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1e0dc0ea761caf9029402fa3d9527aed?s=128&d=identicon&r=PG&f=1", "display_name": "BulBul", "link": "https://stackoverflow.com/users/1788024/bulbul"}, "edited": false, "score": 0, "creation_date": 1533322319, "post_id": 51641042, "comment_id": 90320248, "body": "i created an explicit copy constructor and it worked, thanks for your help"}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 5, "last_activity_date": 1533151975, "creation_date": 1533151975, "answer_id": 51641042, "question_id": 51640949, "link": "https://stackoverflow.com/questions/51640949/vector-push-back-gives-the-compiler-error-c2280/51641042#51641042", "title": "vector push_back() gives the compiler error C2280", "body": "<p>The error you're getting is the consequence of <code>gltf</code> being a non-copyable object, because its copy constructor was implicitly deleted. Calling <code>push_back</code> on a vector requires that the pushed object either be copyable or movable, and in the latter case, you need to expressly pass an r-value, which you are not doing.</p>\n\n<p>You haven't explicitly deleted the copy constructor in <code>gltf</code>, so what I have to presume is that one or more of the objects stored in <code>gltf</code>, or possibly one of the objects stored in the (many) vectors inside <code>gltf</code>, is itself non-copyable, which caused your class to implicitly delete its own copy constructor. Do a code audit to find out which object isn't copyable, and either remove it or write your own copy constructor (and probably also move constructor) for this class, or retrofit that object to be properly copyable.</p>\n"}], "owner": {"reputation": 947, "user_id": 1788024, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1e0dc0ea761caf9029402fa3d9527aed?s=128&d=identicon&r=PG&f=1", "display_name": "BulBul", "link": "https://stackoverflow.com/users/1788024/bulbul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 51641042, "answer_count": 1, "score": 0, "last_activity_date": 1533151975, "creation_date": 1533151618, "question_id": 51640949, "link": "https://stackoverflow.com/questions/51640949/vector-push-back-gives-the-compiler-error-c2280", "title": "vector push_back() gives the compiler error C2280", "body": "<p>I am trying to append a custom class object to a vector of the same type, however when i try to compile my code, the compiler gives the following error</p>\n\n<p><code>gltf::gltf(const gltf &amp;): attempting to reference a deleted function</code></p>\n\n<p>my function takes a string (file name) as an argument and loads that file, then parses the file and populates it's variables</p>\n\n<p>the function is as follows:-</p>\n\n<pre><code>void enigma::loadModel(std::string file)\n{       \n\n    gltf stagingModel;\n    stagingModel.loadAsset(file);   // populates my object with data\n    model.push_back(stagingModel);  // appends the populated object to a vector array (this line generates the error)\n\n    ....   // the rest of the code\n}\n</code></pre>\n\n<p>my gltf class decleration is as follows:-</p>\n\n<pre><code>#pragma once\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;sstream&gt;\n#include &lt;fstream&gt;\n#include \"meshClass.h\"\n#include \"bufferClass.h\"\n#include &lt;gtx/quaternion.hpp&gt;\n#include &lt;gtx/transform.hpp&gt;\n\n#include\"stagingNodeClass.h\"\n#include\"stagingMeshClass.h\"\n#include\"stagingAccessorClass.h\"\n#include\"stagingBufferViewClass.h\"\n#include\"stagingImageClass.h\"\n#include\"stagingSamplerClass.h\"\n#include\"stagingTextureClass.h\"\n#include\"stagingMaterialClass.h\"\n#include\"stagingSkinClass.h\"\n\nclass gltf\n{\npublic:\n    gltf();\n    ~gltf();\n\n    std::vector&lt;meshClass&gt; mesh;\n    std::vector&lt;char&gt; bin;\n    glm::mat4 camera;\n    glm::mat4 scale;\n    void loadAsset(std::string);\n\nprivate:\n    std::vector&lt;stagingNodeClass&gt; stagingNode;\n    std::vector&lt;stagingMeshClass&gt; stagingMesh;\n    std::vector&lt;stagingAccessorClass&gt; stagingAccessor;\n    std::vector&lt;stagingBufferViewClass&gt;  stagingBufferView;\n    std::vector&lt;stagingImageClass&gt; stagingImage;\n    stagingSamplerClass stagingSampler;\n    std::vector&lt;stagingTextureClass&gt; stagingTexture;\n    std::vector&lt;stagingMaterialClass&gt; stagingMaterial;\n    stagingSkinClass stagingSkins;\n    bufferClass stagingBuffer;\n    bool isCamera = false;\n\n    bool node(std::string, std::string);\n    int getValue(std::string);\n    int getCamIndex(std::string);\n    glm::mat4 getMatrix(std::string);\n    glm::vec3 getVec3();\n    glm::vec4 getVec4();\n    float getFloatValue(std::string);\n    void initScale();\n\n    std::vector&lt;int&gt; getIntArray();\n    std::vector&lt;float&gt; getFloatArray();\n\n    std::string getName(std::string);\n\n    std::fstream  asset;\n    std::string line;\n\n};\n</code></pre>\n"}, {"tags": ["c++", "c", "templates", "void-pointers"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1533151857, "post_id": 51640931, "comment_id": 90246402, "body": "This is more a C++ question than a C one.  Tags edited."}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1533152221, "post_id": 51640931, "comment_id": 90246604, "body": "Just allocate it with a smart pointer (<code>shared_ptr</code>, <code>unique_ptr</code> etc.) and let it collect itself later. <code>void*</code> isn&#39;t used all that much in C++. Otherwise, you&#39;ll have to keep track of the type of the pointee and cast it before you delete."}], "answers": [{"comments": [{"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1533152398, "post_id": 51641116, "comment_id": 90246677, "body": "Will that call the correct destructor for derived types? (Not saying it won&#39;t - I&#39;m honestly not sure.)"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1533152438, "post_id": 51641116, "comment_id": 90246698, "body": "@3Dave,  Yes, it will. That&#39;s what <code>virtual</code> destructors are for."}, {"owner": {"reputation": 301, "user_id": 5286435, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c377241bb619c9254d07897baaa86a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dnj Abc", "link": "https://stackoverflow.com/users/5286435/dnj-abc"}, "edited": false, "score": 1, "creation_date": 1533154693, "post_id": 51641116, "comment_id": 90247686, "body": "That&#39;s exactly what I was looking for. Thank you."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 2, "last_activity_date": 1533154734, "last_edit_date": 1533154734, "creation_date": 1533152290, "answer_id": 51641116, "question_id": 51640931, "link": "https://stackoverflow.com/questions/51640931/invoke-a-templated-member-from-a-c-function-using-void-pointer/51641116#51641116", "title": "Invoke a templated member from a c-function using void pointer", "body": "<p>Instead of using <code>Wrapper</code>, use a base class, if that's an option.</p>\n\n<pre><code>class MyBase\n{\n   public:\n      virtual ~MyBase() {};\n};\n\ntemplate &lt;typename T&gt;\nclass MyClass : public MyBase\n{\n   public:\n     explicit MyClass(int x) : mVar(x) {}\n\n   private:\n     int mVar;\n};\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>void c_delete_handler(void* data)\n{\n  Base* basePtr = reinterpret_cast&lt;Base*&gt;(data);\n  delete basePtr;\n}\n</code></pre>\n\n<p>This approach obviates the need for keeping track of whether <code>MyClass</code> was instantiated using <code>int</code>, <code>double</code>, <code>std::string</code>, or ....</p>\n"}], "owner": {"reputation": 301, "user_id": 5286435, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c377241bb619c9254d07897baaa86a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dnj Abc", "link": "https://stackoverflow.com/users/5286435/dnj-abc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51641116, "answer_count": 1, "score": 0, "last_activity_date": 1533154734, "creation_date": 1533151568, "last_edit_date": 1533152611, "question_id": 51640931, "link": "https://stackoverflow.com/questions/51640931/invoke-a-templated-member-from-a-c-function-using-void-pointer", "title": "Invoke a templated member from a c-function using void pointer", "body": "<p>My c++ code has to work with an underlying c-library. I have a c++ object that looks somewhat like this:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass MyClass\n{\npublic:\n  explicit MyClass(int x)\n  : mVar(x)\n  {\n  }\n\nprivate:\n  int mVar;\n};\n</code></pre>\n\n<p>Later in my c++ code I do the following:</p>\n\n<pre><code>  auto p = new MyClass&lt;int&gt;(10);\n\n  call_c_lib_function((void*) p);\n</code></pre>\n\n<p>The c function saves the pointer 'p' in a larger c-structure. Later when the large\nc object is getting destroyed, it invokes the delete handler.</p>\n\n<pre><code>void\nc_delete_handler(void* data)\n{\n  // data is holding the pointer value 'p' from above.\n}\n</code></pre>\n\n<p>Since the object is getting destroyed, I need to free the object that allocated.\nPer the c++ spec, 'delete void_ptr' is undefined since it doesn't know how to\ninvoke the appropriate destructor. How do I invoke delete on the appropriate\ntemplate object?</p>\n\n<p>One solution I could think of was to create a wrapper structure around my MyClass pointer.</p>\n\n<pre><code>struct Wrapper {\n  enum template_type {\n    template_int,\n    template_double,\n    template_string,\n    ...\n  };\n\n  int template_type;\n  void* obj_ptr;\n};\n</code></pre>\n\n<p>before callign the call_c_lib_function, I'd do the following:</p>\n\n<pre><code>  auto p = new MyClass&lt;int&gt;(10);\n  auto w = new Wrapper()\n  w.template_type = Wrapper::template_int;\n  w.obj_ptr = (void*) p;\n\n  call_c_lib_function((void) w);\n</code></pre>\n\n<p>and now in the delete handler, I can do the following:</p>\n\n<pre><code>void\nc_delete_handler(void* data)\n{\n  Wrapper* w = (Wrapper*) data;\n\n  switch (w-&gt;template_type) {\n    case Wrapper::template_int:\n      delete (MyClass&lt;int&gt;*) w-&gt;obj_ptr;\n      break;\n\n    case Wrapper::template_double:\n      delete (MyClass&lt;double&gt;*) w-&gt;obj_ptr;\n      break;\n    ...\n  }\n}\n</code></pre>\n\n<p>Is this a correct approach? is there a better alternative?\nWould appreciate any inputs. Thanks.</p>\n"}, {"tags": ["c++", "c", "linux", "multiprocessing", "signals"], "comments": [{"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533150980, "post_id": 51640723, "comment_id": 90245910, "body": "You can try some online compiler"}], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 483281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a010bdb2a778ab79b662843b0facf3cc?s=128&d=identicon&r=PG", "display_name": "basil", "link": "https://stackoverflow.com/users/483281/basil"}, "edited": false, "score": 0, "creation_date": 1533152281, "post_id": 51640844, "comment_id": 90246628, "body": "so the value for sig will be one of those three, else EINVAL?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 630, "user_id": 483281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a010bdb2a778ab79b662843b0facf3cc?s=128&d=identicon&r=PG", "display_name": "basil", "link": "https://stackoverflow.com/users/483281/basil"}, "edited": false, "score": 0, "creation_date": 1533152845, "post_id": 51640844, "comment_id": 90246900, "body": "No, @basil.  On success, which is indicated to you by a <i>return value</i> of 0, the function will set the signal number to one of <code>SIGHUP</code>, <code>SIGINT</code>, <code>SIGTERM</code>.  On failure, it <i>returns</i> an error code, with <code>EINVAL</code> being the only one documented, but (probably) does not modify the signal number at all.  If this function fails, you should not rely on or make any assumption about the value recorded in the signal number variable.  Setting the value of the object pointed to by the second argument is an altogether different thing from returning a value."}, {"owner": {"reputation": 630, "user_id": 483281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a010bdb2a778ab79b662843b0facf3cc?s=128&d=identicon&r=PG", "display_name": "basil", "link": "https://stackoverflow.com/users/483281/basil"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1533153495, "post_id": 51640844, "comment_id": 90247178, "body": "@JohnBollinger I included an edit example, would my understanding there be correct?"}, {"owner": {"reputation": 1036, "user_id": 10095817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd397fc62377f0e1f1e53c5b22f9b72a?s=128&d=identicon&r=PG&f=1", "display_name": "RalfFriedl", "link": "https://stackoverflow.com/users/10095817/ralffriedl"}, "edited": false, "score": 2, "creation_date": 1533153817, "post_id": 51640844, "comment_id": 90247321, "body": "I added to the answer. Regarding the examples you added, the first is correct, you send a signal from the set, the function returns. The second is not correct. You send a signal not from the set, the function will continue to wait."}, {"owner": {"reputation": 630, "user_id": 483281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a010bdb2a778ab79b662843b0facf3cc?s=128&d=identicon&r=PG", "display_name": "basil", "link": "https://stackoverflow.com/users/483281/basil"}, "edited": false, "score": 0, "creation_date": 1533167703, "post_id": 51640844, "comment_id": 90251710, "body": "@RalfFriedl one thing I am noticing, now that I am at a linux machine, if i send it any signal, the process won&#39;t catch it and will die. I am doing this through <b>kill</b>. Am I missing something?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 630, "user_id": 483281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a010bdb2a778ab79b662843b0facf3cc?s=128&d=identicon&r=PG", "display_name": "basil", "link": "https://stackoverflow.com/users/483281/basil"}, "edited": false, "score": 0, "creation_date": 1533168314, "post_id": 51640844, "comment_id": 90251847, "body": "@basil Yes, any signal not in the mask passed to <code>sigwait</code> will behave normally.  What did you want to happen instead?"}, {"owner": {"reputation": 630, "user_id": 483281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a010bdb2a778ab79b662843b0facf3cc?s=128&d=identicon&r=PG", "display_name": "basil", "link": "https://stackoverflow.com/users/483281/basil"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1533171066, "post_id": 51640844, "comment_id": 90252337, "body": "@zwol the problem is that it is not handling the signals that have been passed either"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 630, "user_id": 483281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a010bdb2a778ab79b662843b0facf3cc?s=128&d=identicon&r=PG", "display_name": "basil", "link": "https://stackoverflow.com/users/483281/basil"}, "edited": false, "score": 0, "creation_date": 1533172287, "post_id": 51640844, "comment_id": 90252549, "body": "@basil I don&#39;t understand what you mean by &quot;handling&quot;.  Please be more specific.  <i>Exactly</i> what does it do, and what did you want to happen instead?"}], "tags": [], "owner": {"reputation": 1036, "user_id": 10095817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd397fc62377f0e1f1e53c5b22f9b72a?s=128&d=identicon&r=PG&f=1", "display_name": "RalfFriedl", "link": "https://stackoverflow.com/users/10095817/ralffriedl"}, "is_accepted": false, "score": 1, "last_activity_date": 1533153637, "last_edit_date": 1533153637, "creation_date": 1533151259, "answer_id": 51640844, "question_id": 51640723, "link": "https://stackoverflow.com/questions/51640723/understanding-sigwait-and-how-it-sets-parameters/51640844#51640844", "title": "Understanding sigwait() and how it sets parameters", "body": "<p>As you say, in your example <code>sigwait</code> will wait for one of SIGHUP, SIGINT, SIGTERM.</p>\n\n<blockquote>\n  <p>Otherwise, it will set the signal number to 0.</p>\n</blockquote>\n\n<p>There is no otherwise. The only defined error is</p>\n\n<blockquote>\n  <p>EINVAL The set argument contains an invalid or unsupported signal number.</p>\n</blockquote>\n\n<p><strong>Edit</strong>\nTo state this explicitly, the only defined error for this function is an invalid input for the <code>set</code> argument. As the set you constructed in your example is not invalid, the function will not return an error, it will wait until one of the signals arrives.</p>\n"}], "owner": {"reputation": 630, "user_id": 483281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a010bdb2a778ab79b662843b0facf3cc?s=128&d=identicon&r=PG", "display_name": "basil", "link": "https://stackoverflow.com/users/483281/basil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533153637, "creation_date": 1533150698, "last_edit_date": 1533153460, "question_id": 51640723, "link": "https://stackoverflow.com/questions/51640723/understanding-sigwait-and-how-it-sets-parameters", "title": "Understanding sigwait() and how it sets parameters", "body": "<p>The man page for sigwait() is a big confusing to me. The signature for sigwait is</p>\n\n<pre><code> int sigwait(const sigset_t *set, int *sig);\n</code></pre>\n\n<p>Say I have code similar to the following</p>\n\n<pre><code> sigset_t wset;\n sigemptyset(&amp;wset);\n sigaddset(&amp;wset,SIGHUP);\n sigaddset(&amp;wget,SIGINT);\n sigaddset(&amp;wget,SIGTERM);\n int sig;\n sigwait(&amp;wset,&amp;sig);\n</code></pre>\n\n<p>If I understand correctly, this will wait on a signal to be sent. If the signal is found in the signal set (i.e. <strong>sigset_t wset</strong>), it will set the signal number (i.e. <strong>int sig</strong>), as found in the set (i.e. <strong>SIGHUP, SIGINT, SIGTERM</strong> in this example). Otherwise, it will set the signal number to 0. Is my understanding correct?</p>\n\n<p>I would try this out, but I don't have access to a compiler at the moment.</p>\n\n<p>edit: for further clarification</p>\n\n<p>Ok so, I send one of the signals above:</p>\n\n<pre><code> int res = sigwait(&amp;wset,&amp;sig);\n // res = 0, sig = SIGHUP, SIGINT, or SIGTERM\n</code></pre>\n\n<p>And I send a signal not included in the set:</p>\n\n<pre><code>int res = sigwait(&amp;wset,&amp;sig);\n// res = EINVAL (i.e. non-zero) and don't worry about sig\n</code></pre>\n\n<p>Is this correct?</p>\n"}, {"tags": ["c++", "constructor", "initialization", "constants"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1533150967, "post_id": 51640718, "comment_id": 90245902, "body": "Just fyi, both of those pointers (<code>m_w</code> and <code>m_a</code>) are dangling the moment that constructor returns. They no longer point to anything viable."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1533151048, "post_id": 51640718, "comment_id": 90245948, "body": "In <code>m_w = &amp;w;</code> the object <code>w</code> is a local object. It ceases to exist after your constructor returns."}, {"owner": {"reputation": 11, "user_id": 10167488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/73eXr.png?s=128&g=1", "display_name": "Wesley Richmond", "link": "https://stackoverflow.com/users/10167488/wesley-richmond"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533151639, "post_id": 51640718, "comment_id": 90246277, "body": "@Fran&#231;oisAndrieux Why does the call to userInputManager.m_w-&gt;execute(); on line 4 directly after the creation of the userInputManager work if the object no longer exists? (line 4 of my first block of code)."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533152684, "post_id": 51640718, "comment_id": 90246826, "body": "Invoking on an invalid reference results in Undefined Behaviour. The really annoying thing about Undefined Behaviour is, being undefined, the results can be anything from looking like it worked to visibly failing and <a href=\"https://www.youtube.com/watch?v=73wMnU7xbwE\" rel=\"nofollow noreferrer\">everything in between.</a>"}, {"owner": {"reputation": 11, "user_id": 10167488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/73eXr.png?s=128&g=1", "display_name": "Wesley Richmond", "link": "https://stackoverflow.com/users/10167488/wesley-richmond"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533153180, "post_id": 51640718, "comment_id": 90247038, "body": "@user4581301 Is there some way to ensure this never happens to me again? Like some sort of c++17 magical features."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533155152, "post_id": 51640718, "comment_id": 90247885, "body": "In general, no. Need more information in order to ansewr for this specific case. In this specific case, I assume you&#39;re going through the-hell-that-is-pointers in order to remap keys at some later point? Is there a possibility of multiple instances of <code>UserInputManager</code>? If there are multiple <code>UserInputManager</code>, then your <code>static</code> solution may not work. All <code>UserInputManager</code>s will start with the same keys and mess with each other&#39;s data."}], "owner": {"reputation": 11, "user_id": 10167488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/73eXr.png?s=128&g=1", "display_name": "Wesley Richmond", "link": "https://stackoverflow.com/users/10167488/wesley-richmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533152378, "creation_date": 1533150686, "last_edit_date": 1533152378, "question_id": 51640718, "link": "https://stackoverflow.com/questions/51640718/pointers-in-const-object-are-changing-after-being-passed-into-another-objects-co", "title": "Pointers in const object are changing after being passed into another objects constructor", "body": "<p>My problem is that when I call userInputManager.m_w->execute(); on line 6, (using VC 2017) I get</p>\n\n<pre><code>Exception thrown: read access violation. userInputManager.m_w-&gt; was 0xFFFFFFFFFFFFFFFF.\n</code></pre>\n\n<p>I mean line 6 of this code here:</p>\n\n<pre><code>        1 Graphics graphics{ window };\n        2 Camera camera{ graphics };\n        3 const UserInputManager userInputManager{ window };\n        4 userInputManager.m_w-&gt;execute();\n        5 Game theGame{camera, userInputManager };\n        6 userInputManager.m_w-&gt;execute();\n        7 while(window.ProcessMessage() )\n</code></pre>\n\n<p>Notice that line 4 does not give me an exception even though it is the same call.  Something is happening in line 5, Game theGame constructor, which is changing my userInputManager and making line 6 (which is identical to line 4) give exception.</p>\n\n<p>Notice that I have made userInputManager const in line 3.</p>\n\n<p>Here is the code for theGame constructor:</p>\n\n<pre><code>Game::Game(Camera &amp; camera, const UserInputManager &amp; userInputManager)\n    :\n    m_camera{ camera },\n    m_userInputManager{userInputManager}\n{   \n}\n</code></pre>\n\n<p>Notice that I am passing in userInputManager as a const reference and setting m_userInputManager to the userInputManager reference.</p>\n\n<p>Here is the UserInputManager class</p>\n\n<pre><code> class UserInputManager\n{\npublic:\n    UserInputManager(MainWindow &amp; window)\n    :\n    m_window{window}\n{\n        LeftCommand a;\n        m_a = &amp;a;\n        UpCommand w;\n        m_w = &amp;w;\n        m_w-&gt;execute();\n}\n\n    MainWindow &amp; m_window;\n\n    Command * m_w = 0;\n    Command * m_s = 0;\n    Command * m_a = 0;\n    Command * m_d = 0;\n\n};\n</code></pre>\n\n<p>In this class I am attempting to implement the command design pattern as is outlined in this book: <a href=\"http://gameprogrammingpatterns.com/command.html\" rel=\"nofollow noreferrer\">http://gameprogrammingpatterns.com/command.html</a>.</p>\n\n<p>In the constructor I am attempting to assign some commands to buttons. I assign LeftCommand to m_a and UpCommand to m_w. I then call  m_w->execute(); just as a test which always works.</p>\n\n<p>Here are the classes for the Commands:</p>\n\n<pre><code>/* Represents game actions. Uses Command pattern */\nclass Command\n{\npublic:\n    virtual void execute() = 0;\n};\n\nclass UpCommand : public Command\n{\npublic:\n    virtual void execute()\n    {\n        executionN++;\n    }\n    int executionN = 0;\n};\n\n\nclass LeftCommand : public Command\n{\npublic:\n    virtual void execute()\n    {\n        executionN++;\n    }\n    int executionN = 0;\n};\n\nclass NullCommand : public Command\n{\npublic:\n    virtual void execute() { }\n};\n</code></pre>\n\n<p>Right now UpCommand and LeftCommand just increment a value in order to test the function call.</p>\n\n<p>This is my first post on this site. I tried to search for answers to this but couldn't really figure out even what to search for. </p>\n\n<p>Please let me know if my post could be improved or clarified.</p>\n\n<p>Thank you.</p>\n\n<p>EDIT 1 : I changed the local creation of LeftCommand a and UpCommand w and made them static objects of the UserInputManager class. Now everything works great. My problem was indeed related to the dangling pointers. But is my solution of making  themstatic objects the best way to fix this? I just thought of it randomly</p>\n"}, {"tags": ["c++", "visual-studio", "msvcrt"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1533150273, "post_id": 51640568, "comment_id": 90245569, "body": "Since looks like this function has to do with SEH, did you try disabling SEH and C++ exceptions in your settings?"}, {"owner": {"reputation": 125, "user_id": 6736043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/an0mG.jpg?s=128&g=1", "display_name": "Amrane Abdelkader", "link": "https://stackoverflow.com/users/6736043/amrane-abdelkader"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1533151299, "post_id": 51640568, "comment_id": 90246108, "body": "@SergeyA,  After disabling <b>C++ Exceptions</b> it worked fine, I appreciate it!"}], "answers": [{"tags": [], "owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "is_accepted": false, "score": 1, "last_activity_date": 1533151323, "creation_date": 1533151323, "answer_id": 51640858, "question_id": 51640568, "link": "https://stackoverflow.com/questions/51640568/prevent-my-project-from-calling-the-cxxframehandler3-crt-function/51640858#51640858", "title": "Prevent my project from calling the __CxxFrameHandler3 (CRT function)", "body": "<p>That function is part of VS's exception handling infrastructure. In order to safely avoid using the CRT, you'll need to either provide your own (compatible!) implementations of the exception-handling functions, or compile with exceptions disabled and religiously avoid anything that can throw an exception. (An exception you've explicitly unprepared yourself for, is a memory leak waiting to happen.)</p>\n"}, {"comments": [{"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1533151742, "post_id": 51640876, "comment_id": 90246337, "body": "Not sure if it&#39;s specifically SEH...it might just be regular C++ exceptions. (Exceptions aren&#39;t directly implemented by the compiler; it just inserts calls to CRT functions that do the heavy lifting.)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1533151796, "post_id": 51640876, "comment_id": 90246366, "body": "@cHao according MSDN, it deals with SEH: <a href=\"https://msdn.microsoft.com/en-us/library/ff770594.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ff770594.aspx</a> AFAIK, in MSVC C++ exceptions are implemented on top of SEH, so I would imagine you need to disable  both."}, {"owner": {"reputation": 2325, "user_id": 7194773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rg9K2.png?s=128&g=1", "display_name": "Lewis Kelsey", "link": "https://stackoverflow.com/users/7194773/lewis-kelsey"}, "reply_to_user": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1587757491, "post_id": 51640876, "comment_id": 108645618, "body": "@cHao you are right, it is used for C++ exceptions and not for SEH (which uses _C_specific_handler). c.f. <a href=\"https://sanseolab.tistory.com/category/?page=6\" rel=\"nofollow noreferrer\">sanseolab.tistory.com/category/?page=6</a>"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 4, "last_activity_date": 1533151375, "creation_date": 1533151375, "answer_id": 51640876, "question_id": 51640568, "link": "https://stackoverflow.com/questions/51640568/prevent-my-project-from-calling-the-cxxframehandler3-crt-function/51640876#51640876", "title": "Prevent my project from calling the __CxxFrameHandler3 (CRT function)", "body": "<p>Reposting my comment as an answer:</p>\n\n<p>This functions has to do with SEH (Structured Exceptions Handling), so to stop calling it, one needs to disable exceptions (SEH and C++ exceptions) in the project.</p>\n"}], "owner": {"reputation": 125, "user_id": 6736043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/an0mG.jpg?s=128&g=1", "display_name": "Amrane Abdelkader", "link": "https://stackoverflow.com/users/6736043/amrane-abdelkader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2700, "favorite_count": 1, "accepted_answer_id": 51640876, "answer_count": 2, "score": 1, "last_activity_date": 1597936127, "creation_date": 1533150044, "question_id": 51640568, "link": "https://stackoverflow.com/questions/51640568/prevent-my-project-from-calling-the-cxxframehandler3-crt-function", "title": "Prevent my project from calling the __CxxFrameHandler3 (CRT function)", "body": "<p>I was working on a <strong>none Visual C++ Runtime Library project</strong> for a few days from now, however, I had a smooth ingoing until my linker start complaining about the unresolved external symbol of the <code>__CxxFrameHandler3</code> CRT function, so after searching for the reason which produces this error I found that calling a method of any custom class from the main entry point is calling this CRT function, simple example :</p>\n\n<pre><code>// /No Common Language RunTime Support\n// /Ignore All Default Libraries \n\nclass A\n{\npublic:\n    A();\n    ~A();\n\n    int do_something();\nprivate:\n\n};\n\nint A::do_something()\n{\n    return 0;\n}\n\nint EntryPoint()\n{\n    A a;\n    a.do_something(); // Calls the __CxxFrameHandler3 CRT function.\n\n    return 0;\n}\n</code></pre>\n\n<p>Error :</p>\n\n<pre><code> LNK2019    unresolved external symbol ___CxxFrameHandler3 referenced in function __unwindfunclet$?UmbraServerMain@@YGHPAUHINSTANCE__@@0PA_WH@Z$0   \n</code></pre>\n\n<p>Is there a way to prevent the call to this CRT function?</p>\n"}, {"tags": ["c++", "c++11", "language-lawyer", "inheriting-constructors"], "comments": [{"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1533165357, "post_id": 51640562, "comment_id": 90251226, "body": "I don&#39;t know. But if this bug encourages you to write the more clear <code>using base_type::base_type;</code> or <code>using T::T;</code>, I am for it."}, {"owner": {"reputation": 1369, "user_id": 4751858, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a732b3d1b6dfd64ee232d10dcbbc7fec?s=128&d=identicon&r=PG&f=1", "display_name": "Junekey Jeon", "link": "https://stackoverflow.com/users/4751858/junekey-jeon"}, "reply_to_user": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 1, "creation_date": 1533185575, "post_id": 51640562, "comment_id": 90255324, "body": "@alfC Ridiculously, indeed I wrote (and always write) <code>using base_type::base_type</code>. The above code is a translation generated by the nvidia CUDA compiler (NVCC). I have no idea why NVCC makes the translation of <code>base_type::base_type</code> into <code>base_type::T</code>, but that&#39;s how I encountered this issue."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1533185737, "post_id": 51640562, "comment_id": 90255369, "body": "good to know. Maybe there is a way to force nvcc not to change certain parts of the code."}], "answers": [{"tags": [], "owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "is_accepted": true, "score": 5, "last_activity_date": 1533151664, "creation_date": 1533151664, "answer_id": 51640958, "question_id": 51640562, "link": "https://stackoverflow.com/questions/51640562/inheriting-constructor-with-a-type-alias-in-a-template-derived-class/51640958#51640958", "title": "Inheriting constructor with a type alias in a template derived class", "body": "<p><code>using base_type::T;</code> is a <a href=\"https://en.cppreference.com/w/cpp/language/using_declaration\" rel=\"noreferrer\">declaration</a>, and the <code>using</code> before it is an <a href=\"https://en.cppreference.com/w/cpp/language/type_alias\" rel=\"noreferrer\">alias</a>. This is a bit of an edge case in the standard, since the real question boils down to where does the <code>T</code> get expanded. The C++ committee was referenced <a href=\"https://bugs.llvm.org/show_bug.cgi?id=23107#c1\" rel=\"noreferrer\">here</a> as saying that they did not intend for that syntax to be valid, so LLVM explicitly removed it. It doesn't look like there's anything in the standard preventing it, so gcc isn't incorrect in allowing the conversion. Who is 'correct' is up to you.</p>\n"}], "owner": {"reputation": 1369, "user_id": 4751858, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a732b3d1b6dfd64ee232d10dcbbc7fec?s=128&d=identicon&r=PG&f=1", "display_name": "Junekey Jeon", "link": "https://stackoverflow.com/users/4751858/junekey-jeon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "closed_date": 1533185685, "accepted_answer_id": 51640958, "answer_count": 1, "score": 4, "last_activity_date": 1533163217, "creation_date": 1533150023, "last_edit_date": 1533163217, "question_id": 51640562, "link": "https://stackoverflow.com/questions/51640562/inheriting-constructor-with-a-type-alias-in-a-template-derived-class", "closed_reason": "Duplicate", "title": "Inheriting constructor with a type alias in a template derived class", "body": "<p>Please see the following code:</p>\n\n<pre><code>struct base {};\n\ntemplate &lt;class T&gt;\nstruct derived : T {\n  using base_type = T;\n  using base_type::T;\n};\n\nint main()\n{\n  derived&lt;base&gt; x;\n}\n</code></pre>\n\n<p>GCC accepts this code, but Clang and MSVC reject it. Who is right and why?</p>\n"}, {"tags": ["c++", "casting"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1533149164, "post_id": 51640225, "comment_id": 90245020, "body": "Unless you are certain that your <code>const uint8_t*</code> <i>always</i> points to a <i>non-const</i> buffer, this could lead to <i>undefined behavior</i>."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 0, "creation_date": 1533149192, "post_id": 51640225, "comment_id": 90245027, "body": "See <a href=\"https://ideone.com/4SMImR\" rel=\"nofollow noreferrer\">ideone.com/4SMImR</a>. When compiling this code, I get the error <code>prog.cpp:11:43: error: reinterpret_cast from type \u2018const uint8_t* {aka const unsigned char*}\u2019 to type \u2018char*\u2019 casts away qualifiers</code>"}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1533149200, "post_id": 51640225, "comment_id": 90245031, "body": "@Galik That&#39;s only if the C-API in question actually tries to write to the buffer. If it only reads, then the behavior is well defined."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1533149215, "post_id": 51640225, "comment_id": 90245042, "body": "@Galik It could also point to a <code>const</code> buffer, provided the use of the now-non-const pointer doesn&#39;t try to modify the buffer. For example a non-const correct API function which only reads from it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1533149231, "post_id": 51640225, "comment_id": 90245049, "body": "@Xirema, nope. The behavior is defined if original object was not created const."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 0, "creation_date": 1533149252, "post_id": 51640225, "comment_id": 90245060, "body": "Yes, exactly, this is an interface that takes a <code>char*</code> but doesn&#39;t actually modify its contents (the interface designer should have added a <code>const</code>, but I can&#39;t change it)."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1533149272, "post_id": 51640225, "comment_id": 90245074, "body": "&quot;Another option is this monstrosity&quot; - the fact that you need to use such a monstrosity should be a pretty big hint that you are <i>probably</i> doing something wrong (if having to use a cast wasn&#39;t a bit enough hint in the first place). At least, by using the C++ casts rather than the C cast you make it very clear (and visible) that something nasty is going on (and you are being <i>explicit</i> about <i>what</i> nastiness is happening)."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533149289, "post_id": 51640225, "comment_id": 90245081, "body": "@Fran&#231;oisAndrieux and nope as well. Like I said above, const_cast being defined or undefined doesn&#39;t depend on how the casted object is used. It depends on the cv-qualification of original object."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1533149350, "post_id": 51640225, "comment_id": 90245111, "body": "Do you need this cast once, or several times? If once, then you have to live with this. If several times, you may want to create an inline function which does the cast."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1533149357, "post_id": 51640225, "comment_id": 90245115, "body": "Then you could write a const correct wrapper function and send a patch to the authors :)"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1533149389, "post_id": 51640225, "comment_id": 90245135, "body": "@SergeyA <a href=\"https://en.cppreference.com/w/cpp/language/const_cast\" rel=\"nofollow noreferrer\">cppreference</a> disagrees with you. Can you provide a source for your claim? It says <i>&quot;const_cast makes it possible to form a reference or pointer to non-const type that is actually referring to a const object&quot;</i>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1533149401, "post_id": 51640225, "comment_id": 90245141, "body": "Answering question as asked: if you are using C++ casts, you&#39;d have to use two, unless <code>char</code> is defined as unsgined type/"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533149792, "post_id": 51640225, "comment_id": 90245322, "body": "@Fran&#231;oisAndrieux, ok I was wrong. If the object is not modified through casted pointer, const_cast is defined."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 1, "creation_date": 1533150362, "post_id": 51640225, "comment_id": 90245626, "body": "The API in question is part of the STL :( I&#39;m trying to do what&#39;s asked in this question, but also go from uint8_t to char: <a href=\"https://stackoverflow.com/questions/13059091/creating-an-input-stream-from-constant-memory\" title=\"creating an input stream from constant memory\">stackoverflow.com/questions/13059091/&hellip;</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1533150476, "post_id": 51640225, "comment_id": 90245691, "body": "@KerrickStaley Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The standard library is fully <code>const</code> correct. That means if at any point you think you need <code>const_cast</code> to use a standard library feature, you are making a big mistake somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "is_accepted": false, "score": 5, "last_activity_date": 1533151000, "last_edit_date": 1533151000, "creation_date": 1533149893, "answer_id": 51640519, "question_id": 51640225, "link": "https://stackoverflow.com/questions/51640225/how-to-cast-const-uint8-t-to-char/51640519#51640519", "title": "How to cast const uint8_t* to char*", "body": "<blockquote>\n  <p>Is there any way I can perform this cast using a C++-style cast without nesting two separate cast operations?</p>\n</blockquote>\n\n<p>Not portably, no.  There is no single \"the type is wrong and the const is also wrong\" cast.</p>\n\n<blockquote>\n  <p>Another option is this monstrosity, which I find pretty unreadable:</p>\n</blockquote>\n\n<pre><code>char *cptr = reinterpret_cast&lt;char*&gt;(const_cast&lt;uint8_t*&gt;(ptr));\n</code></pre>\n\n<p>Do that.</p>\n\n<p>Both C++ casts and your internal style guide are striving to make this look monstrous. </p>\n\n<p>You can prevent the <em>repetition</em> of these casts by writing your own cast.</p>\n\n<pre><code>template&lt; typename T &gt;\nchar* awful_monster_cast( const T * ptr )\n{\n    return reinterpret_cast&lt;char*&gt;(const_cast&lt;T*&gt;(ptr));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 4, "last_activity_date": 1533149924, "creation_date": 1533149924, "answer_id": 51640530, "question_id": 51640225, "link": "https://stackoverflow.com/questions/51640225/how-to-cast-const-uint8-t-to-char/51640530#51640530", "title": "How to cast const uint8_t* to char*", "body": "<blockquote>\n  <p>Is there any way I can perform this cast using a C++-style cast without nesting two separate cast operations?</p>\n</blockquote>\n\n<p>If you want it done in a single line like <code>char* foo = some_cast(source)</code> then no.  The only cast that can remove <code>const</code> is <code>const_cast</code> so you need that plus an additional one to convert that now non const pointer into your source type.  That leaves you with the monstrosity</p>\n\n<pre><code>char *cptr = reinterpret_cast&lt;char*&gt;(const_cast&lt;uint8_t*&gt;(aptr));\n</code></pre>\n\n<p>as the single line solution.  This is a safety feature and makes it so it is painfully obvious you are removing constness.</p>\n"}, {"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": false, "score": 2, "last_activity_date": 1533149946, "last_edit_date": 1592644375, "creation_date": 1533149946, "answer_id": 51640538, "question_id": 51640225, "link": "https://stackoverflow.com/questions/51640225/how-to-cast-const-uint8-t-to-char/51640538#51640538", "title": "How to cast const uint8_t* to char*", "body": "<blockquote>\n<p>Another option is this monstrosity, which I find pretty unreadable:</p>\n<pre><code>char *cptr = reinterpret_cast&lt;char*&gt;(const_cast&lt;uint8_t*&gt;(aptr));\n</code></pre>\n</blockquote>\n<p>You might find it unreadable, but this is the ideomatic way to express this conversion in C++.</p>\n<p>Here's what's important:</p>\n<ul>\n<li>You are using a C-style API that, for whatever reason, is not itself const-correct, but you want to preserve the const-correctness of your own code, as much as possible, necessitating a cast to remove the cv-qualifications of the type.</li>\n<li>The C-style API uses signed data types, whereas your application uses unsigned data types.</li>\n</ul>\n<p>In total, those are two conversions that your code needs to make\u2014removing the const-ness, and converting to a signed type. This demands that you make two explicitly expressed conversions, if you want to obey these coding practices. You may not agree with this principle, but your company/coding practices certainly do.</p>\n<p>Of course, I don't think anything is stopping you from writing something like this:</p>\n<pre><code>char * convert_to_c_data_buffer(uint8_t const* ptr) {\n    return reinterpret_cast&lt;char*&gt;(const_cast&lt;uint8_t*&gt;(ptr));\n}\n\nchar* dptr = convert_to_c_data_buffer(aptr);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 737, "user_id": 4860693, "user_type": "registered", "profile_image": "https://graph.facebook.com/838129839615438/picture?type=large", "display_name": "Anthony Monterrosa", "link": "https://stackoverflow.com/users/4860693/anthony-monterrosa"}, "edited": false, "score": 0, "creation_date": 1533245057, "post_id": 51640732, "comment_id": 90288140, "body": "what&#39;s <code>v</code>? [garbage to pass needed comment length]"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 737, "user_id": 4860693, "user_type": "registered", "profile_image": "https://graph.facebook.com/838129839615438/picture?type=large", "display_name": "Anthony Monterrosa", "link": "https://stackoverflow.com/users/4860693/anthony-monterrosa"}, "edited": false, "score": 1, "creation_date": 1533252814, "post_id": 51640732, "comment_id": 90290297, "body": "@AnthonyMonterrosa It&#39;s what I get occasionally when I try to paste text (my ctrl key has a loose connection)."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1533252734, "last_edit_date": 1533252734, "creation_date": 1533150727, "answer_id": 51640732, "question_id": 51640225, "link": "https://stackoverflow.com/questions/51640225/how-to-cast-const-uint8-t-to-char/51640732#51640732", "title": "How to cast const uint8_t* to char*", "body": "<blockquote>\n  <p>Is there any way I can perform this cast using a C++-style cast without <strong>nesting</strong> two separate cast operations?</p>\n</blockquote>\n\n<p>Certainly. There is no need to nest those cast operations. Instead, you can use two separate expressions:</p>\n\n<pre><code>auto cuint = const_cast&lt;uint8_t*&gt;(aptr);\nauto cptr  = reinterpret_cast&lt;char*&gt;(cuint);\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4816, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1533252734, "creation_date": 1533148818, "question_id": 51640225, "link": "https://stackoverflow.com/questions/51640225/how-to-cast-const-uint8-t-to-char", "title": "How to cast const uint8_t* to char*", "body": "<p>I have a <code>const uint8_t*</code> that I want to convert to a <code>char*</code> for an interface that expects a <code>char*</code>.</p>\n\n<p>The easiest way to do this is with a C-style cast:</p>\n\n<pre><code>const uint8_t* aptr = &amp;some_buffer;\nchar* bptr = (char*)aptr;\n</code></pre>\n\n<p>However, our internal style guide (which is based on the <a href=\"https://google.github.io/styleguide/cppguide.html#Casting\" rel=\"nofollow noreferrer\">Google C++ Style Guide</a>) bans C-style casts.</p>\n\n<p>Another option is this monstrosity, which I find pretty unreadable:</p>\n\n<pre><code>char *cptr = reinterpret_cast&lt;char*&gt;(const_cast&lt;uint8_t*&gt;(aptr));\n</code></pre>\n\n<p>These other options I tried all failed to compile:</p>\n\n<pre><code>char* dptr = reinterpret_cast&lt;char*&gt;(aptr);\nchar* eptr = const_cast&lt;char*&gt;(aptr);\nchar* fptr = static_cast&lt;char*&gt;(aptr);\n</code></pre>\n\n<p>Is there any way I can perform this cast using a C++-style cast without nesting two separate cast operations?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1533148831, "post_id": 51640171, "comment_id": 90244861, "body": "<code>valid_</code> should probably be left <code>true</code>. By returning an rvalue reference to your value, it means that the value may shortly become moved-from but it&#39;s still an instance of <code>T</code>. Since there&#39;s no easy way to detect when it actually  gets moved from, the simple solution would be to not touch <code>valid_</code> and let the moved-from instance be destroyed normally by your destructor."}], "answers": [{"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533148926, "post_id": 51640203, "comment_id": 90244916, "body": "That makes sense, thank you.  I&#39;ll elide invalidating it when the operator&#39;s called, and just document that&#39;s it undefined to access a maybe after std::move()-ing from it."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533149001, "post_id": 51640203, "comment_id": 90244951, "body": "@SeanMcAllister For your operator to be called, you need to be operating on an rvalue reference of <code>maybe</code> already. Afterwards, the user should already be in a situation where they can&#39;t really expect their <code>maybe</code> to hold a value anymore."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533149180, "post_id": 51640203, "comment_id": 90245024, "body": "@Fran&#231;oisAndrieux That why <code>valid_</code> is set to <code>false</code>, isn&#39;t it?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533149496, "post_id": 51640203, "comment_id": 90245177, "body": "@VTT <code>valid_</code> seems to indicate whether or not <code>value_</code> contains an object. A moved-from object is still an object. It seems to me like it&#39;s still valid, as far as the use of <code>valid_</code> is concerned."}], "tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": true, "score": 3, "last_activity_date": 1533149143, "last_edit_date": 1533149143, "creation_date": 1533148747, "answer_id": 51640203, "question_id": 51640171, "link": "https://stackoverflow.com/questions/51640171/do-i-need-to-explicitly-call-a-destructor-here/51640203#51640203", "title": "Do I need to explicitly call a destructor here?", "body": "<p>No, there is no need to call destructor manually. Move is only used to invoke overload taking an rvalue reference. If calling code does nothing with function result then this would be noop. Even if calling code does actually mess with the value is supposed to stay in some valid (but unspecified) state and still needs to be properly destructed (and this will happen when <code>maybe</code> object is destructed).</p>\n"}, {"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533154518, "post_id": 51640588, "comment_id": 90247608, "body": "This was a stripped down example ( I don&#39;t actually build from a value, I take a const T&amp;), but the thoughts on exceptions and such were very useful, thank you."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1533150123, "creation_date": 1533150123, "answer_id": 51640588, "question_id": 51640171, "link": "https://stackoverflow.com/questions/51640171/do-i-need-to-explicitly-call-a-destructor-here/51640588#51640588", "title": "Do I need to explicitly call a destructor here?", "body": "<pre><code>// move value out of maybe\noperator T&amp;&amp;() &amp;&amp; {\n    valid_ = false;\n    return std::move(value());\n}\n</code></pre>\n\n<p>Your problem is <code>valid_ = false;</code> -- that line is wrong.</p>\n\n<p>Your class has the invariant that either it contains a value and <code>valid_</code> is <code>true</code>, or it doesn't contain a value and <code>valid_</code> is <code>false</code>.</p>\n\n<p>Your <code>operator T&amp;&amp;()&amp;&amp;</code> violates this invariant.</p>\n\n<p>Options include:</p>\n\n<pre><code>// move value out of maybe\noperator T&amp;&amp;() &amp;&amp; {\n    return std::move(value());\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>// move value out of maybe\noperator T() &amp;&amp; {\n  T tmp = std::move(value());\n  value().~T();\n  valid_ = false;\n  return tmp;\n}\n</code></pre>\n\n<p><code>std::optional</code> uses the first one, the second one is also possible.</p>\n\n<p>As an aside:</p>\n\n<pre><code>maybe(T value) : valid_(true)  { new (&amp;value_) T(value); }\n</code></pre>\n\n<p>needs a <code>std::move</code>:</p>\n\n<pre><code>maybe(T value) : valid_(true)  { new (&amp;value_) T(std::move(value)); }\n</code></pre>\n\n<p>and some other defensive measures:</p>\n\n<pre><code>maybe(T value) : valid_(true)  { ::new ((void*)&amp;value_) T(std::move(value)); }\n</code></pre>\n\n<p>to deal with <code>operator new</code> overloading.</p>\n\n<p>Next, you need to deal with throwing constructors:</p>\n\n<pre><code>maybe(T value) : maybe()  {\n  ::new ((void*)&amp;value_) T(std::move(value));\n  valid_ = true;\n}\n</code></pre>\n\n<p>you should go even further</p>\n\n<pre><code>template&lt;class...Args&gt;\nvoid emplace(Args&amp;&amp;...args) {\n  if (*this)\n    clear();\n  ::new( (void*)&amp;value_ ) T( std::forward&lt;Args&gt;(args)... );\n  valid_ = true;\n}\nvoid clear() {\n  if (*this)\n  {\n    valid_ = false; // set false first in case ~T throws\n    value().~T(); \n  }\n}\n</code></pre>\n\n<p>now we:</p>\n\n<pre><code>maybe(T value)\n: maybe() {\n  emplace( std::move(value ) );\n}\n\n~maybe()\n{\n  clear();\n}\n</code></pre>\n\n<p>and only manually fiddle with the lifetime of <code>value_</code> and <code>valid_</code> inside <code>emplace()</code> and <code>clear()</code>.</p>\n\n<p>We should also have valid <code>noexcept</code> values:</p>\n\n<pre><code>template&lt;class...Args&gt;\nvoid emplace(Args&amp;&amp;...args)\n  noexcept(\n    noexcept( T( std::forward&lt;Args&gt;(args)... )\n    &amp;&amp; noexcept( std::declval&lt;maybe&amp;&gt;().clear() )\n )\n{\n  if (*this)\n    clear();\n  ::new( (void*)&amp;value_ ) T( std::forward&lt;Args&gt;(args)... );\n  valid_ = true;\n}\nvoid clear() noexcept(noexcept( std::declval&lt;T&amp;&gt;().~T() ) ) {\n  if (*this)\n  {\n    valid_ = false; // set false first in case ~T throws\n    value().~T(); \n  }\n}\n</code></pre>\n\n<p>now we:</p>\n\n<pre><code>maybe(T value)\n  noexcept( noexcept( std::declval&lt;maybe&amp;&gt;().emplace( std::declval&lt;T&amp;&amp;&gt;() ) ) )\n: maybe() {\n  emplace( std::move(value ) );\n}\n\n~maybe()\n  noexcept( noexcept( std::declval&lt;maybe&amp;&gt;().clear() ) )\n{\n  clear();\n}\n</code></pre>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 51640203, "answer_count": 2, "score": 3, "last_activity_date": 1533150123, "creation_date": 1533148614, "question_id": 51640171, "link": "https://stackoverflow.com/questions/51640171/do-i-need-to-explicitly-call-a-destructor-here", "title": "Do I need to explicitly call a destructor here?", "body": "<p>I've got an optional-like type (can't use optional because it's C++17):</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct maybe {\n    maybe()        : valid_(false) {}\n    maybe(T value) : valid_(true)  { new (&amp;value_) T(value); }\n\n    // destructor\n    ~maybe() {\n        if (valid_) {\n            value_.~T();\n        }\n    }\n\n    // move value out of maybe\n    operator T&amp;&amp;() &amp;&amp; {\n        valid_ = false;\n        return std::move(value());\n    }\n\n    // explicit validity \n    explicit operator bool() const {\n        return valid_;\n    }\n\n    T&amp; value() {\n        if (!valid_) {\n            throw std::runtime_error(\"boom\");\n        }\n        return value_;\n    }\n\nprivate:\n    union {\n        T value_;\n    };\n    bool valid_;\n};\n</code></pre>\n\n<p>I'm curious in the <code>operator T&amp;&amp;</code> if it's improper to just move the value out, since the destructor will no longer do it.  It seems like I would need to move the value to a temporary, destruct my storage, and then return.  Which way is correct?</p>\n"}, {"tags": ["c++", "qt", "qt5", "qlineedit", "qstylesheet"], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "edited": false, "score": 0, "creation_date": 1533193639, "post_id": 51646135, "comment_id": 90258527, "body": "thanks a lot for your explanation eyllanesc. Have a nice day! :)"}], "tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 2, "last_activity_date": 1533214567, "last_edit_date": 1533214567, "creation_date": 1533187838, "answer_id": 51646135, "question_id": 51640031, "link": "https://stackoverflow.com/questions/51640031/cursor-still-appears-in-lineedit-although-it-is-not-focused-any-more/51646135#51646135", "title": "Cursor still appears in LineEdit although it is not focused any more", "body": "<p>When you return True in <code>eventFilter()</code> you are preventing the widget where the event was going to be sent from not receiving it, and in this case it is necessary that the <code>FocusIn</code> and <code>FocusOut</code> event is received by the <code>QLineEdit</code>. Using that consideration, the following solution could be proposed:</p>\n\n<pre><code>bool MainWindow::eventFilter( QObject *obj, QEvent *event )\n{\n    if ( obj == ui-&gt;m_lineEdit )\n    {\n        if ( event-&gt;type() == QEvent::FocusIn )\n        {\n            ui-&gt;m_lineEdit-&gt;setStyleSheet( \"QLineEdit{padding-left: 10px; padding-right: 10px; border-width: 1px 0px 1px 1px; border-style: solid; border-color:rgb(249,125,25)}\" );\n            ui-&gt;m_button-&gt;setStyleSheet( \"QAbstractButton{ border-width: 1px 1px 1px 0px; border-style: solid; border-color: rgb(249,125,25)}\" );\n        }\n        else if ( event-&gt;type() == QEvent::FocusOut)\n        {\n            ui-&gt;m_lineEdit-&gt;setStyleSheet( \"QLineEdit{ padding-left: 10px; padding-right: 10px; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(204,204,204)}\" );\n            ui-&gt;m_button-&gt;setStyleSheet( \"QAbstractButton{ border-width: 1px 1px 1px 0px; border-style: solid; border-color: rgb(204,204,204) } \");\n        }\n    }\n    return QMainWindow::eventFilter( obj, event );\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 2450589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d5ee67d38b0eb28c55c3c746e9241b?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/2450589/krishna"}, "is_accepted": false, "score": 0, "last_activity_date": 1533191596, "creation_date": 1533191596, "answer_id": 51646922, "question_id": 51640031, "link": "https://stackoverflow.com/questions/51640031/cursor-still-appears-in-lineedit-although-it-is-not-focused-any-more/51646922#51646922", "title": "Cursor still appears in LineEdit although it is not focused any more", "body": "<p>FocusIn and FocusOut would be enough for QLineEdit event. Remaining all event need to be handled by QMainWindow. By removing the return false statement in else part could solve the issue.</p>\n"}], "owner": {"reputation": 267, "user_id": 6385931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9fafc2536d895b11117a6670e1f4533?s=128&d=identicon&r=PG&f=1", "display_name": "trangan", "link": "https://stackoverflow.com/users/6385931/trangan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 51646135, "answer_count": 2, "score": 1, "last_activity_date": 1533214567, "creation_date": 1533148114, "last_edit_date": 1533187919, "question_id": 51640031, "link": "https://stackoverflow.com/questions/51640031/cursor-still-appears-in-lineedit-although-it-is-not-focused-any-more", "title": "Cursor still appears in LineEdit although it is not focused any more", "body": "<p>I need to combine a LineEdit and a Button together into such an element and I want the lineEdit works as usual. \nBut when I click on the lineEdit, the cursor does not appear, only when I click 3 times, then cursor appears but does not blink.\n<a href=\"https://i.stack.imgur.com/U2KLr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U2KLr.png\" alt=\"enter image description here\"></a></p>\n\n<p>After that I click to another place to lose focus for the lineEdit, I hope the cursor is not there any more but then the cursor is still there.</p>\n\n<p><a href=\"https://i.stack.imgur.com/78szX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/78szX.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know the problem is in my stylesheet but I can not find out where. Could you guys help me?</p>\n\n<p>This is my code:</p>\n\n<pre><code>MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent), ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n    ui-&gt;lineEdit1-&gt;setPlaceholderText(\"another LineEdit to lose focus for the LineEdit below\");\n    QHBoxLayout *lineEditWithButtonForm = new QHBoxLayout( this );\n    lineEditWithButtonForm-&gt;setSpacing(0);\n    lineEditWithButtonForm-&gt;setContentsMargins(0,0,0,0);\n    ui-&gt;m_lineEdit-&gt;setContentsMargins(10,0,10,0);\n    ui-&gt;m_lineEdit-&gt;setFixedHeight( 25 );\n    ui-&gt;m_lineEdit-&gt;setStyleSheet(\"QLineEdit{ padding-left: 10px; padding-right: 10px; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(204,204,204); }\");\n    lineEditWithButtonForm-&gt;addWidget(ui-&gt;m_lineEdit);\n    ui-&gt;m_button-&gt;setFixedHeight( 25 );\n    ui-&gt;m_button-&gt;setCursor( QCursor( Qt::PointingHandCursor ) );\n    ui-&gt;m_button-&gt;setFocusPolicy(Qt::ClickFocus);\n    ui-&gt;m_button-&gt;setStyleSheet( \"QAbstractButton{ border-width: 1px 1px 1px 0px; border-style: solid; border-color: rgb(204,204,204); }\");\n    lineEditWithButtonForm-&gt;addWidget(ui-&gt;m_lineEdit);\n\n    ui-&gt;m_lineEdit-&gt;installEventFilter( this );\n}\n\nbool MainWindow::eventFilter( QObject *obj, QEvent *event )\n{\n    if ( obj == ui-&gt;m_lineEdit )\n    {\n        if ( event-&gt;type() == QEvent::FocusIn )\n        {\n            ui-&gt;m_lineEdit-&gt;setStyleSheet( \"QLineEdit{padding-left: 10px; padding-right: 10px; border-width: 1px 0px 1px 1px; border-style: solid; border-color:rgb(249,125,25)}\" );\n            ui-&gt;m_button-&gt;setStyleSheet( \"QAbstractButton{ border-width: 1px 1px 1px 0px; border-style: solid; border-color: rgb(249,125,25)}\" );\n            return true;\n        }\n        else if ( event-&gt;type() == QEvent::FocusOut)\n        {\n            ui-&gt;m_lineEdit-&gt;setStyleSheet( \"QLineEdit{ padding-left: 10px; padding-right: 10px; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(204,204,204)}\" );\n            ui-&gt;m_button-&gt;setStyleSheet( \"QAbstractButton{ border-width: 1px 1px 1px 0px; border-style: solid; border-color: rgb(204,204,204) } \");\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n    else\n    {\n        return MainWindow::eventFilter( obj, event );\n    }\n }\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1533147543, "post_id": 51639864, "comment_id": 90244159, "body": "Can you provide a direct quote just to make sure you didn&#39;t misunderstand it?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533147583, "post_id": 51639864, "comment_id": 90244183, "body": "Show the definition of <code>n</code> and <code>m</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1533147632, "post_id": 51639864, "comment_id": 90244212, "body": "Sounds like you could use a better <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">C++ book</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1533147772, "post_id": 51639864, "comment_id": 90244286, "body": "Although books like that might be a better fit for your learning style, having a solid <a href=\"http://www.stroustrup.com/4th.html\" rel=\"nofollow noreferrer\">reference</a> is not optional. C++ is an unforgiving language so it&#39;s important to have a manual that you can consult tha explains things in depth, not just superficially."}], "answers": [{"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1533147861, "post_id": 51639903, "comment_id": 90244350, "body": "@tadman: It certainly does :) However, the OP&#39;s wording seems to suggest that there are other elements in the array."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1533147911, "post_id": 51639903, "comment_id": 90244383, "body": "Certainly! Any C++ book that spends a lot of time talking about C arrays, though, is immediately suspect."}, {"owner": {"reputation": 2291, "user_id": 8773597, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w9ZfPZR_pqg/AAAAAAAAAAI/AAAAAAAAAD4/UWy3eUzG4-o/photo.jpg?sz=128", "display_name": "Lev Zakharov", "link": "https://stackoverflow.com/users/8773597/lev-zakharov"}, "edited": false, "score": 0, "creation_date": 1533147929, "post_id": 51639903, "comment_id": 90244394, "body": "Thanks for answer:) So this behavior only works if you specify zero?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 2291, "user_id": 8773597, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w9ZfPZR_pqg/AAAAAAAAAAI/AAAAAAAAAD4/UWy3eUzG4-o/photo.jpg?sz=128", "display_name": "Lev Zakharov", "link": "https://stackoverflow.com/users/8773597/lev-zakharov"}, "edited": false, "score": 2, "creation_date": 1533148002, "post_id": 51639903, "comment_id": 90244441, "body": "@Lev Zakharov: Not sure what you mean by &quot;works&quot;. If you want to initialize all elements to the same value, then yes, it only works for zero. Otherwise, it works as I described above. In C++ you can simply say <code>int x[n][m] = {}</code> or <code>int x[n][m]{}</code> to zero-out everything."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1533148047, "post_id": 51639903, "comment_id": 90244459, "body": "I&#39;m not certain the remaining elements are initialized to 0. Their values are undefined, aren&#39;t they?"}, {"owner": {"reputation": 2291, "user_id": 8773597, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w9ZfPZR_pqg/AAAAAAAAAAI/AAAAAAAAAD4/UWy3eUzG4-o/photo.jpg?sz=128", "display_name": "Lev Zakharov", "link": "https://stackoverflow.com/users/8773597/lev-zakharov"}, "edited": false, "score": 0, "creation_date": 1533148131, "post_id": 51639903, "comment_id": 90244511, "body": "@AnT The book says: &quot;Initializing all elements to zero could not be any simpler...&quot;. So I assumed that this rule applies to other values."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1533148142, "post_id": 51639903, "comment_id": 90244517, "body": "@tadman: That&#39;s false. C++, just like C, follows the &quot;All-Or-Nothing&quot; principle in aggregate initialization. When you supply explicit initializer for just a portion of the aggregate, the rest invariably gets default-initialized for you. In C the <code>= { 0 }</code> initializer is well-known as a universal/idiomatic way to zero-initialize anything."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1533148187, "post_id": 51639903, "comment_id": 90244537, "body": "@ant Thanks for clarifying."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 8, "last_activity_date": 1533147904, "last_edit_date": 1533147904, "creation_date": 1533147627, "answer_id": 51639903, "question_id": 51639864, "link": "https://stackoverflow.com/questions/51639864/multidimensional-array-initialization-in-c/51639903#51639903", "title": "Multidimensional array initialization in C++", "body": "<p>Well, this declaration will indeed initialize <em>all</em> elements of the array. However, only element <code>x[0][0]</code> will get initialized to <code>1</code>. The remaining elements (if any) will get initialized to <code>0</code>.</p>\n\n<p>So, formally the book is right (if you quoted it correctly). You simply misinterpreted what it said.</p>\n"}], "owner": {"reputation": 2291, "user_id": 8773597, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w9ZfPZR_pqg/AAAAAAAAAAI/AAAAAAAAAD4/UWy3eUzG4-o/photo.jpg?sz=128", "display_name": "Lev Zakharov", "link": "https://stackoverflow.com/users/8773597/lev-zakharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 51639903, "answer_count": 1, "score": 1, "last_activity_date": 1533147904, "creation_date": 1533147500, "last_edit_date": 1533147790, "question_id": 51639864, "link": "https://stackoverflow.com/questions/51639864/multidimensional-array-initialization-in-c", "title": "Multidimensional array initialization in C++", "body": "<p>I'm reading \"Sams Teach Yourself C++ in One Hour a Day\" and get stuck with \"Lesson 4\". It says that I can initialize all elements of multidimensional array with the following code:</p>\n\n<pre><code>int x[n][m] = {1};\n</code></pre>\n\n<p>But as I understand it's wrong. This code creates array with only one element (x[0][0]) equals 1. Is it a mistake in the book or what?</p>\n"}, {"tags": ["c++", "undefined-behavior", "integer-overflow", "unsigned-integer"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1533146281, "post_id": 51639509, "comment_id": 90243470, "body": "Related: <a href=\"https://stackoverflow.com/q/9193880/1896169\">stackoverflow.com/q/9193880/1896169</a> , <a href=\"https://stackoverflow.com/q/18195715/1896169\">stackoverflow.com/q/18195715/1896169</a> , <a href=\"https://stackoverflow.com/q/16056758/1896169\">stackoverflow.com/q/16056758/1896169</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1533146410, "post_id": 51639509, "comment_id": 90243538, "body": "@Justin Those are about unsigned integer <i>overflow</i>, not underflow that happens here."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533146548, "post_id": 51639509, "comment_id": 90243618, "body": "Best dupe I have found so far: <a href=\"https://stackoverflow.com/questions/15172936/unsigned-signed-underflow-mechanism\" title=\"unsigned signed underflow mechanism\">stackoverflow.com/questions/15172936/&hellip;</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533146604, "post_id": 51639509, "comment_id": 90243652, "body": "What about <a href=\"https://stackoverflow.com/questions/2760502/question-about-c-behaviour-for-unsigned-integer-underflow\">this one</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 6, "last_activity_date": 1533146847, "last_edit_date": 1592644375, "creation_date": 1533146485, "answer_id": 51639605, "question_id": 51639509, "link": "https://stackoverflow.com/questions/51639509/if-i-decrement-stdsize-t0-is-that-guaranteed-to-be-equal-to-stdsize-t/51639605#51639605", "title": "If I decrement `std::size_t(0)` is that guaranteed to be equal to `std::size_t(-1)`?", "body": "<h1>Yes</h1>\n<p><code>size_t</code> is an unspecified unsigned integer.</p>\n<p>All unsigned integers in C++ are modelled as elements of the ring of integers modulo 2<sup>n</sup> for some number n specific to that unsigned integer type.</p>\n<p>When you convert a signed integer to an unsigned integer you get the value in the ring of integers modulo 2<sup>n</sup> for the constant n for that unsigned type.  For -1, this is 2<sup>n</sup>-1.</p>\n<p>When you decrement 0 as an unsigned integer type, you get 2<sup>n</sup>-1.</p>\n<p>These two values are the same.</p>\n<p>See [basic.fundamental] 3.9.1/4 from the C++ standard:</p>\n<blockquote>\n<p>Unsigned integers shall obey the laws of arithmetic modulo\n2<sup>n</sup>\nwhere\nn\nis the number of bits in the value\nrepresentation of that particular size of integer.</p>\n</blockquote>\n<p>(Quote taken from N3690, a recent draft standard, but the truth it represents isn't going to change any time soon; the paragraph number might.)</p>\n<p>Finding quotes on how conversion from a signed integer works would involve more standard chasing; but it ends up being what you want.</p>\n"}, {"comments": [{"owner": {"reputation": 6556, "user_id": 874660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/45a7738c334183bff552bcf73c4dcd65?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/874660/ben"}, "edited": false, "score": 0, "creation_date": 1533218384, "post_id": 51639609, "comment_id": 90274540, "body": "You get the green check because of the details on increment and decrement operators."}], "tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": true, "score": 5, "last_activity_date": 1533146797, "last_edit_date": 1533146797, "creation_date": 1533146496, "answer_id": 51639609, "question_id": 51639509, "link": "https://stackoverflow.com/questions/51639509/if-i-decrement-stdsize-t0-is-that-guaranteed-to-be-equal-to-stdsize-t/51639609#51639609", "title": "If I decrement `std::size_t(0)` is that guaranteed to be equal to `std::size_t(-1)`?", "body": "<p>Yes, this behavior is guaranteed.</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/types/size_t\" rel=\"nofollow noreferrer\"><code>std::size_t</code></a> is an unsigned integer type. <a href=\"https://en.cppreference.com/w/cpp/language/operator_arithmetic#Overflows\" rel=\"nofollow noreferrer\">Arithmetic on unsigned integers always has well defined semantics</a>:</p>\n\n<blockquote>\n  <p>Unsigned integer arithmetic is always performed modulo 2<sup>n</sup>\n  where n is the number of bits in that particular integer. </p>\n</blockquote>\n\n<p>Specifically considering the built-in <a href=\"https://en.cppreference.com/w/cpp/language/operator_incdec\" rel=\"nofollow noreferrer\">pre-decrement and post-decrement operators</a>:</p>\n\n<blockquote>\n  <p>[T]he expression <code>--x</code> is exactly equivalent to <code>x -= 1</code>. ... <br>\n  [T]he expression <code>x--</code> modifies the value of its operand as if by evaluating <code>x -= 1</code></p>\n</blockquote>\n\n<p>So the decrement operator <em>does</em> perform an arithmetic operation.</p>\n"}], "owner": {"reputation": 6556, "user_id": 874660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/45a7738c334183bff552bcf73c4dcd65?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/874660/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "accepted_answer_id": 51639609, "answer_count": 2, "score": 3, "last_activity_date": 1533146847, "creation_date": 1533146137, "question_id": 51639509, "link": "https://stackoverflow.com/questions/51639509/if-i-decrement-stdsize-t0-is-that-guaranteed-to-be-equal-to-stdsize-t", "title": "If I decrement `std::size_t(0)` is that guaranteed to be equal to `std::size_t(-1)`?", "body": "<p>Here's evidence that it is:</p>\n\n<pre><code>inline\nconstexpr std::size_t prev(std::size_t i) {\n    --i;\n    return i;\n}\n\nint main() {\n    static const std::size_t i = 0;\n    static_assert(prev(i) == std::size_t(-1), \"Decrementing should give     std::size_t(-1)\");    \n    return 0;\n}\n</code></pre>\n\n<p>That compiles happily with <code>-std=c++14</code>.</p>\n\n<p>I came upon this because I had a loop indexing over a <code>std::vector</code> and wanted to loop backward, so I changed it to</p>\n\n<pre><code>for (std::size_t i = std::min(idx, v.size() - 1); i != std::size_t(-1); --i) { ... }\n</code></pre>\n\n<p>Now, I realize I could use <code>std::vector::reverse_iterator</code>, but my real question now is, is the behavior I'm expecting well-defined?</p>\n"}, {"tags": ["c++", "qt", "ascii", "qstring", "iso-8859-1"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1533145992, "post_id": 51639347, "comment_id": 90243325, "body": "<code>i&lt;=s.length();</code> is not right. It needs be <code>i&lt;s.length();</code>  What is the value of <code>k</code>?"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1533147739, "post_id": 51639347, "comment_id": 90244267, "body": "What do you want to do? Feel free to use pseudocode. Describe what you want the behavior to be first. I&#39;m guessing that you want to add a constant value to each element&#39;s ASCII code?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1533151414, "post_id": 51639347, "comment_id": 90246166, "body": "Please turn on compiler warnings, and fix them. You can do this by adding <code>QMAKE_CXXFLAGS += -Wall -Wextra</code> to your <i>.pro</i> file (assuming you have <i>qmake</i> project and are using Linux, Mac or Windows/MinGW)."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1533151576, "post_id": 51639347, "comment_id": 90246248, "body": "After you have warnings on, compiler should warn that <code>i</code> is uninitialized. Fix that, as a starter. Then you&#39;ll want to check what <code>k.toInt()</code> actually returns (try <code>qDebug() &lt;&lt; k.toInt();</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1533259183, "creation_date": 1533259183, "answer_id": 51664092, "question_id": 51639347, "link": "https://stackoverflow.com/questions/51639347/get-ascii-value-from-qstring-and-replace-it-with-other-ascii/51664092#51664092", "title": "Get ASCII value from QString and replace it with other ASCII", "body": "<p>The example below demonstrates one solution. The <em>Offset</em> control determines by how much is the character code offset from the original value. Conversion to ASCII is unnecessary: Unicode code points correspond to ASCII where the ranges of the two overlap (i.e. 32 to 127, inclusive). The <em>Modulo printable ASCII range</em> option keeps the results within the printable ASCII range by performing addition modulo the range (i.e. the results are wrapped to fit in the range).</p>\n\n<p><a href=\"https://i.stack.imgur.com/FoyVW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FoyVW.png\" alt=\"screenshot\"></a></p>\n\n<pre><code>// https://github.com/KubaO/stackoverflown/tree/master/questions/ascii-add-ui-51639347\n#include &lt;QtWidgets&gt;\n\nint main(int argc, char *argv[]) {\n   QApplication a(argc, argv);\n   QWidget ui;\n   QFormLayout layout(&amp;ui);\n   QLineEdit input(\"Hello, World!\");\n   QLabel output;\n   QLineEdit offset;\n   QIntValidator offsetValidator(-65535, 65535);\n   QCheckBox ascii(\"Modulo printable ASCII range 32-127\");\n   output.setFrameShape(QFrame::Panel);\n   layout.addRow(\"Input Text\", &amp;input);\n   layout.addRow(\"Output\", &amp;output);\n   layout.addRow(\"Offset\", &amp;offset);\n   layout.addRow(&amp;ascii);\n   layout.setFieldGrowthPolicy(QFormLayout::AllNonFixedFieldsGrow);\n   offset.setValidator(&amp;offsetValidator);\n   offset.setPlaceholderText(\"0\");\n   ascii.setChecked(true);\n   ui.show();\n\n   auto const calculate = [&amp;] {\n      bool limit = ascii.isChecked();\n      auto text = input.text();\n      int delta = offset.text().toInt();\n      for (QChar &amp;ch : text) {\n         auto doLimit = limit &amp;&amp; ch &gt;= 32 &amp;&amp; ch &lt;= 127;\n         ch = {ch.unicode() + delta};\n         if (doLimit) ch = {((ch.unicode() - 32) % (128 - 32)) + 32};\n      }\n      output.setText(text);\n   };\n   for (auto ed : {&amp;input, &amp;offset})\n      QObject::connect(ed, &amp;QLineEdit::textChanged, calculate);\n   QObject::connect(&amp;ascii, &amp;QCheckBox::toggled, calculate);\n\n   offset.setText(\"1\");\n   return a.exec();\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10162248, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G4KHiK4x-2Y/AAAAAAAAAAI/AAAAAAAAAEc/g8-p51GoWEU/photo.jpg?sz=128", "display_name": "GabryLinux", "link": "https://stackoverflow.com/users/10162248/gabrylinux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 51664092, "answer_count": 1, "score": 0, "last_activity_date": 1533259183, "creation_date": 1533145528, "question_id": 51639347, "link": "https://stackoverflow.com/questions/51639347/get-ascii-value-from-qstring-and-replace-it-with-other-ascii", "title": "Get ASCII value from QString and replace it with other ASCII", "body": "<p>I need to get ASCII value from each QString's elements, then replace it\nwith others ASCII. \nI have these QString: <code>QString s = ui-&gt;lineEdit_3-&gt;text();</code>\nand <code>QString k = ui-&gt;lineEdit_2-&gt;text();</code>, then i converted s to Latin1 <code>s.at(i).toLatin1();</code> but when i print <code>f</code>, nothing happens.<br>\nThis is my code:</p>\n\n<pre><code>QString s = ui-&gt;lineEdit_3-&gt;text();\nQString k = ui-&gt;lineEdit_2-&gt;text();\nQString f;\nk.toInt();\ns.toStdString();\n\n\nfor(int i; i&lt;=s.length(); i++)\n{\n    f.append(QChar(s.at(i).toLatin1()+k.toInt()));\n}\n\nui-&gt;lineEdit-&gt;setText(f);\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 6, "creation_date": 1533144259, "post_id": 51639001, "comment_id": 90242435, "body": "No it doesn&#39;t. C++ I/O is <i>abstract</i> and doesn&#39;t contain any concept of a screen."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1533144423, "post_id": 51639001, "comment_id": 90242523, "body": "Are you running the program in a terminal? What OS are you using? If Unix, you may be able to use the magic that is <a href=\"https://stackoverflow.com/q/4062045/2602718\">ANSI codes</a>."}], "owner": {"reputation": 17, "user_id": 9370381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0638d0d831a0fd2e3e645c3b5206e6a5?s=128&d=identicon&r=PG&f=1", "display_name": "komal", "link": "https://stackoverflow.com/users/9370381/komal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1533144363, "answer_count": 0, "score": 0, "last_activity_date": 1533144336, "creation_date": 1533144188, "last_edit_date": 1533144336, "question_id": 51639001, "link": "https://stackoverflow.com/questions/51639001/is-there-any-function-in-iostream-which-allows-clear-screen-in-c", "closed_reason": "Duplicate", "title": "Is there any function in iostream which allows clear screen in c++?", "body": "<p>I want to know whether iostream contain any function to clear the screen in C++ programming?</p>\n"}, {"tags": ["c++", "arrays", "pointers", "hash", "null"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1533143616, "post_id": 51638841, "comment_id": 90242136, "body": "Don&#39;t use <code>NULL</code>, use <code>nullptr</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1533143837, "post_id": 51638841, "comment_id": 90242229, "body": "None of that code should invoke the constructor of <code>HashLin</code>. Post all <i>real</i> code required for <i>us</i> to produce your error. Your posted code appears to be using <code>HashLin primHash[10];</code> (i.e. an array of instances, not an array of pointers), then using a conversion construction to a temporary prior to the assignment."}, {"owner": {"reputation": 11, "user_id": 10167043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/824018c50d5cc4bfdf79582806a159c0?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10167043/nate"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1533150932, "post_id": 51638841, "comment_id": 90245882, "body": "@JesperJuhl my instructor has explicitly told us to use NULL, not nullptr."}, {"owner": {"reputation": 11, "user_id": 10167043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/824018c50d5cc4bfdf79582806a159c0?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10167043/nate"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1533151034, "post_id": 51638841, "comment_id": 90245941, "body": "@WhozCraig I&#39;m not quite sure what you&#39;re saying but I&#39;m happy to post more code. I am intending to create an array of pointers - is that not what I&#39;m doing here? still pretty new to c++"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1533200662, "post_id": 51638841, "comment_id": 90262667, "body": "@Nate: WhozCraig is pointing out that you are not posting the actual code. The code you posted defines 10 pointers. The error message appears to be from code which defined <code>primHash[]</code> as an array of objects. We can&#39;t help if you&#39;re not posting the actual code you tried to compile."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10167043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/824018c50d5cc4bfdf79582806a159c0?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10167043/nate"}, "edited": false, "score": 0, "creation_date": 1533174488, "post_id": 51638977, "comment_id": 90252919, "body": "that hasn&#39;t worked for me either, and my instructor has explicity said to use &quot;NULL&quot;"}, {"owner": {"reputation": 11, "user_id": 10167043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/824018c50d5cc4bfdf79582806a159c0?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10167043/nate"}, "edited": false, "score": 0, "creation_date": 1533174517, "post_id": 51638977, "comment_id": 90252927, "body": "my compiler tells me &quot;nullptr hasn&#39;t been declared in this scope&quot; when I&#39;ve tried it"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 11, "user_id": 10167043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/824018c50d5cc4bfdf79582806a159c0?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10167043/nate"}, "edited": false, "score": 0, "creation_date": 1533200396, "post_id": 51638977, "comment_id": 90262480, "body": "@Nate: Your instructor is not up to date. <code>nullptr</code> replaced <code>NULL</code> 7 years ago. That said, there&#39;s probably more wrong with the course looking at your question."}], "tags": [], "owner": {"reputation": 415, "user_id": 10166712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S5Jai.jpg?s=128&g=1", "display_name": "zbys", "link": "https://stackoverflow.com/users/10166712/zbys"}, "is_accepted": false, "score": -1, "last_activity_date": 1533144104, "creation_date": 1533144104, "answer_id": 51638977, "question_id": 51638841, "link": "https://stackoverflow.com/questions/51638841/initializing-an-array-of-object-pointers-to-null/51638977#51638977", "title": "Initializing an Array of Object Pointers to NULL", "body": "<p>Try setting the Objects to nullptr instead:\n<code>primHash[i] = nullptr</code></p>\n"}], "owner": {"reputation": 11, "user_id": 10167043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/824018c50d5cc4bfdf79582806a159c0?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10167043/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533151445, "creation_date": 1533143518, "last_edit_date": 1533151445, "question_id": 51638841, "link": "https://stackoverflow.com/questions/51638841/initializing-an-array-of-object-pointers-to-null", "title": "Initializing an Array of Object Pointers to NULL", "body": "<p>I have a project that requires creation of an array of object pointers which must be initialized to NULL by an init() method. Here is the code:</p>\n\n<pre><code>HashLin *primHash[10];\n\nvoid HashPerfect:: init() {         //FIX ME\nfor (int i=0; i&lt;10; i++){\n    primHash[i] = NULL;\n}\n</code></pre>\n\n<p>And I'm receiving the following error message when attempting to compile the code:</p>\n\n<pre><code>hashperfect.cpp: In member function 'void HashPerfect::init()':\nhashperfect.cpp:17:15: warning: passing NULL to non-pointer argument 1 of \n'HashLin::HashLin(int)' [Wconversion-null]\nprimHash[i] = NULL;\n            ^\n</code></pre>\n\n<p>I feel like this could be something to do with my the constructor of class HashLin, but I'm not sure. If that would help diagnose the problem, here are the constructors for class HashLin:</p>\n\n<pre><code>HashLin::HashLin(){\n    //size = 0;\n    hashTable = vector&lt;string&gt;(1);\n    init();\n};\n\nHashLin::HashLin(int mySize){\n\n    hashTable = vector&lt;string&gt;(mySize);\n\n    init();\n};\n</code></pre>\n\n<p>Any help is greatly appreciated! Thanks.</p>\n\n<p>My intention is to create an array of pointers to HashLin objects - here is the code for the HashLin object class...</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include \"HashLin.hpp\"\nusing namespace std;\n\n\nbool success;\nvector&lt;string&gt; hashTable;\n\nvoid HashLin:: init() {\n    //hashTable = vector&lt;string&gt;(1);\n    for (int i=0; i&lt;hashTable.size(); i++)\n        hashTable[i] = \"\";\n}       \n\nint HashLin:: hashMe(string myString) {\n\n    //char foo[] = myString;\n\n\n    char *s = new char[(myString.length())];\n    unsigned int hash;\n    for (hash = 0; *s != '\\0'; s++)\n        hash = 37*hash + *s;\n\n    hash = hash % hashTable.size();\n\n\n    return hash;\n\n}\n\n\n\n\n\n    HashLin::HashLin(){\n        //size = 0;\n        hashTable = vector&lt;string&gt;(1);\n        init();\n    };\n\n    HashLin::HashLin(int mySize){\n\n        hashTable = vector&lt;string&gt;(mySize);\n\n        init();\n    };\n\n    bool HashLin:: insert(string insertMe){\n        //hashMe(insertMe);\n        int hashVal = hashMe(insertMe);\n\n        success = false;\n        int count = 0;\n\n        while (hashVal &lt; hashTable.size() &amp;&amp; success==false &amp;&amp; \ncount&lt;hashTable.size()) {\n\n            if (hashTable[hashVal] == \"\"){\n                hashTable[hashVal] = insertMe;\n                success = true;\n            }\n            else if (hashVal == hashTable.size()-1)\n                hashVal = 0;\n            else{\n                hashVal++;\n                count++;\n            }   \n\n\n        }\n\n        if (count == hashTable.size())\n            cout &lt;&lt; \"Failed to Hash: \" &lt;&lt; insertMe &lt;&lt; endl;\n        return success;\n    }\n\n    void HashLin:: printOut(){\n\n        for (int i=0; i&lt;hashTable.size(); i++){\n            cout &lt;&lt; i &lt;&lt; \": \" &lt;&lt; hashTable[i] &lt;&lt; endl;\n        }\n    }\n\n    int HashLin:: getSize(){\n        return hashTable.size();\n\n    }\n\n    bool HashLin:: getSuccess(){\n        return success;\n\n    }\n\n    void HashLin:: setSize(int toSet){\n        hashTable.resize(toSet);\n    }\n</code></pre>\n"}, {"tags": ["c++", "performance", "loops", "testing"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1533143411, "post_id": 51638811, "comment_id": 90242032, "body": "<code>int i = 0; while ( i &lt; 100000000 ) {i++;}</code> likely gets optimized to <code>int i = 100000000;</code> or something similar."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1533143473, "post_id": 51638811, "comment_id": 90242062, "body": "Beware that appending text to a string is a significantly more involved process than incrementing an integer."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1533143549, "post_id": 51638811, "comment_id": 90242106, "body": "You can play around with <a href=\"https://godbolt.org/g/wMr9DR\" rel=\"nofollow noreferrer\">goldbolt.org</a> to see what exactly the compiler produces. Don&#39;t forget optimization flags, as profiling unoptimized code is almost never relevant."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1533143566, "post_id": 51638811, "comment_id": 90242112, "body": "It likely gets optimised away altogether. I have a short blog article on this at <a href=\"https://latedev.wordpress.com/2011/10/15/the-joy-of-benchmarks/\" rel=\"nofollow noreferrer\">latedev.wordpress.com/2011/10/15/the-joy-of-benchmarks</a>"}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1533143593, "post_id": 51638811, "comment_id": 90242119, "body": "Which one do you think takes more time? Incrementing a variable 100 million times or creating a 1.6-gigabyte string? # of lines != execution time. Incrementing an int is done directly by your processor with a few instructions while appending to a string is a lot more complicated. For starters, all 16 characters need to be copied."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533143600, "post_id": 51638811, "comment_id": 90242123, "body": "(1) compile with optimisations on and list the relevant compilation options in the question. (2) <code>std::string::reserve(a big number)</code> outside the loop."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1533144242, "post_id": 51638811, "comment_id": 90242428, "body": "&quot;Its one extra line, should it really take that much longer?&quot; I can easily write one line of code that will make your program slower in infinite times. What is the point?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533145300, "post_id": 51638811, "comment_id": 90242949, "body": "<a href=\"http://www.eviloverlord.com/lists/overlord.html\" rel=\"nofollow noreferrer\">Evil overlord rule 46</a>: <i>If an advisor says to me &quot;My liege, he is but one man. What can one man possibly do?&quot;, I will reply &quot;This.&quot; and kill the advisor.</i>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533147116, "post_id": 51638811, "comment_id": 90243905, "body": "Search the internet for &quot;How to benchmark c++ programs&quot; for information on benchmarking (measuring performance of) C++ programs.  There is a lot to take into consideration before comparing with other languages, executables or platforms."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 10079234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef68aaf5778899a2c72bd53f3c471e6?s=128&d=identicon&r=PG&f=1", "display_name": "QrazyNeo", "link": "https://stackoverflow.com/users/10079234/qrazyneo"}, "edited": false, "score": 0, "creation_date": 1533149706, "post_id": 51639591, "comment_id": 90245286, "body": "So the string size should be predefined and as precise as possible, if I have understood you correctly"}, {"owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "reply_to_user": {"reputation": 65, "user_id": 10079234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef68aaf5778899a2c72bd53f3c471e6?s=128&d=identicon&r=PG&f=1", "display_name": "QrazyNeo", "link": "https://stackoverflow.com/users/10079234/qrazyneo"}, "edited": false, "score": 0, "creation_date": 1533150159, "post_id": 51639591, "comment_id": 90245523, "body": "@QrazyNeo I&#39;m not sure what you mean. predefined and as precise as possible?"}, {"owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "reply_to_user": {"reputation": 65, "user_id": 10079234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef68aaf5778899a2c72bd53f3c471e6?s=128&d=identicon&r=PG&f=1", "display_name": "QrazyNeo", "link": "https://stackoverflow.com/users/10079234/qrazyneo"}, "edited": false, "score": 0, "creation_date": 1533150398, "post_id": 51639591, "comment_id": 90245648, "body": "Oh, if you mean to avoid teststring having to make a new region of memory, yes absolutely. Better to make it a bit bigger too since the copy operation is expensive and a bigger string is no big deal. <code>string::reserve</code> will help. Even if you do this though, the inner for loop iterates 16 times, so it should theoretically still be much longer than the <code>i++</code> alone, even if the CPU tries to run as much as it can in parallel (Doing all the <code>teststring[end+i]</code> writes at the same time since they&#39;re independent)."}, {"owner": {"reputation": 65, "user_id": 10079234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef68aaf5778899a2c72bd53f3c471e6?s=128&d=identicon&r=PG&f=1", "display_name": "QrazyNeo", "link": "https://stackoverflow.com/users/10079234/qrazyneo"}, "edited": false, "score": 0, "creation_date": 1533152238, "post_id": 51639591, "comment_id": 90246611, "body": "Thank you very much. This helped a little. Will also take a closer look at optimization as others here have suggested"}], "tags": [], "owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "is_accepted": true, "score": 4, "last_activity_date": 1538430321, "last_edit_date": 1538430321, "creation_date": 1533146441, "answer_id": 51639591, "question_id": 51638811, "link": "https://stackoverflow.com/questions/51638811/c-execution-time-test/51639591#51639591", "title": "C++ execution time test", "body": "<p>How would <code>teststring += \"something random\";</code> be implemented? Something like:</p>\n\n<pre><code>str = \"something random\";\nfor( int i = 0; i &lt; sizeof(str); i++ )\n    teststring[teststring.length+i] = str[i];\n</code></pre>\n\n<p>Not to mention if <code>teststring</code> isn't big enough, it has to make a new region of memory twice as large, and copy every single byte over, and then continue (teststring will grow very large in your code, making that copy operation quite expensive). This is very complicated in comparison to <code>i++</code>, so it makes sense that the latter is much faster.</p>\n"}, {"tags": [], "owner": {"reputation": 291, "user_id": 3063727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgNzc.jpg?s=128&g=1", "display_name": "mike", "link": "https://stackoverflow.com/users/3063727/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1533156332, "creation_date": 1533156332, "answer_id": 51642000, "question_id": 51638811, "link": "https://stackoverflow.com/questions/51638811/c-execution-time-test/51642000#51642000", "title": "C++ execution time test", "body": "<p>In addition to Nicholas Pipitone's point, an optimizing compiler can legitimately eliminate the original for loop and replace it with:</p>\n\n<p>int i=100000001;</p>\n\n<p>The optimizing compiler could do the same for the string concatentation, but it probably didn't bother catching that case (possibly because the string concatentation function may indicate it can throw exceptions, which the compiler may not know how to deal with).</p>\n"}], "owner": {"reputation": 65, "user_id": 10079234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef68aaf5778899a2c72bd53f3c471e6?s=128&d=identicon&r=PG&f=1", "display_name": "QrazyNeo", "link": "https://stackoverflow.com/users/10079234/qrazyneo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 51639591, "answer_count": 2, "score": 0, "last_activity_date": 1538430321, "creation_date": 1533143364, "last_edit_date": 1533143386, "question_id": 51638811, "link": "https://stackoverflow.com/questions/51638811/c-execution-time-test", "title": "C++ execution time test", "body": "<p>Im testing this code: </p>\n\n<pre><code>string teststring = \"\";\nint i = 0;\n\nwhile ( i &lt; 100000000 ) {\n\ni++;\n\n}\n</code></pre>\n\n<p>The execution time is: 0.359 s.</p>\n\n<p>Then I try to do the exact same test again, but this time Ive added one extra line within the loop:</p>\n\n<pre><code>string teststring = \"\";\nint i = 0;\n\nwhile ( i &lt; 100000000 ) {\n\ni++;\nteststring += \"something random\";\n\n\n}\n</code></pre>\n\n<p>The execution time is 4 s. </p>\n\n<p>Its one extra line, should it really take that much longer? Can I do something different to improve this?</p>\n"}, {"tags": ["c++", "type-conversion"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1533143174, "post_id": 51638731, "comment_id": 90241926, "body": "To type pun an array of char to integer use <a href=\"https://stackoverflow.com/a/51228315/1708801\">use memcpy or maybe bit_cast</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1533143226, "post_id": 51638731, "comment_id": 90241950, "body": "What is the <i>real</i> problem that you want  to solve this way? With an <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and some example input, what would the output be? What output do your current attempt give? And please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and also <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1533143233, "post_id": 51638731, "comment_id": 90241954, "body": "It is not clear what &quot;conversion&quot; you need"}, {"owner": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "edited": false, "score": 0, "creation_date": 1533144281, "post_id": 51638731, "comment_id": 90242448, "body": "Because an integer is 32 bit, it is impossible to narrow more than 4 chars (8 bit) to it&#39;s size without losing information."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "edited": false, "score": 0, "creation_date": 1533144493, "post_id": 51638731, "comment_id": 90242555, "body": "@Czipperz &quot;Because an integer is 32 bit&quot; no it is not, it can be 32 bit but can be different"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1533144495, "post_id": 51638731, "comment_id": 90242557, "body": "Begin by saying, in words, what characters the array is allowed to contain, and how they should be converted into an integer value."}, {"owner": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1533144865, "post_id": 51638731, "comment_id": 90242730, "body": "@Slava I am aware that the standard just requires them to be greater in size than a <code>short</code>, less than a <code>long</code>, and not even having 8 bits per byte.  But on MSVC, it is 32 bits, and I have reason to believe it is the same on other platforms."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "edited": false, "score": 0, "creation_date": 1533145158, "post_id": 51638731, "comment_id": 90242872, "body": "@Czipperz you aware wrong, <code>int</code> must be greater or <b>equal</b> to short and less or <b>equal</b> to long. And there are platforms where it is different than 32bits indeed."}, {"owner": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1533145586, "post_id": 51638731, "comment_id": 90243114, "body": "@Slava MSVC has 32 bit integers.  x86_64 Linux on GCC and CLANG have 32 bit integers.  On Mac OSX GCC int is 32 bit."}, {"owner": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "edited": false, "score": 0, "creation_date": 1533145642, "post_id": 51638731, "comment_id": 90243138, "body": "You are completely correct that the standard does not specify, but in actuality all major platforms use 32 bit ints"}, {"owner": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "edited": false, "score": 0, "creation_date": 1533145684, "post_id": 51638731, "comment_id": 90243167, "body": "And ARM uses 32 bit ints as well."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "edited": false, "score": 0, "creation_date": 1533152690, "post_id": 51638731, "comment_id": 90246830, "body": "@Czipperz -- you&#39;re absolutely right that there are platforms where <code>int</code> is 32 bits wide. There are also platforms where it is not. If you write code on the assumption that an <code>int</code> is 32 bits wide, sooner or later you&#39;ll get burned."}, {"owner": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "edited": false, "score": 0, "creation_date": 1533154389, "post_id": 51638731, "comment_id": 90247546, "body": "Ok.  I guess the point of my example is that event if int is a million bytes wide, it still looses information stored in the original string.  This is because <code>char array[REALLY_BIG_SIZE]</code> still can&#39;t store all strings."}], "answers": [{"comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1533143728, "post_id": 51638854, "comment_id": 90242184, "body": "And that could quite quickly lead to a shift larger than the size of <code>unsigned int</code>, which leads to UB."}, {"owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1533143806, "post_id": 51638854, "comment_id": 90242214, "body": "@OP If your issue was with the casting syntax, and not with programming in general, then you obviously know what a for loop is, so know that my comment wasn&#39;t intending to be condescending, but rather informative for a newb."}, {"owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1533143925, "post_id": 51638854, "comment_id": 90242273, "body": "@Someprogrammerdude Well, yes, but there&#39;s nothing to do in that case. <code>long</code> is also valid, but if the OP wants to use more than just a couple characters then it&#39;s a useless endeavor as C++ just can&#39;t store those integers at all."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1533143934, "post_id": 51638854, "comment_id": 90242276, "body": "I think <code>ret = (ret &lt;&lt; 8) | *buffer++;</code> would be simpler, but it is not clear if OP needs such conversion at all."}], "tags": [], "owner": {"reputation": 3469, "user_id": 2574612, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4b008a3d7ce933943329e84c1dbe6db7?s=128&d=identicon&r=PG", "display_name": "Nicholas Pipitone", "link": "https://stackoverflow.com/users/2574612/nicholas-pipitone"}, "is_accepted": false, "score": 0, "last_activity_date": 1533144031, "last_edit_date": 1533144031, "creation_date": 1533143581, "answer_id": 51638854, "question_id": 51638731, "link": "https://stackoverflow.com/questions/51638731/convert-unsigned-char-array-of-characters-to-int-c/51638854#51638854", "title": "Convert unsigned char array of characters to int C++", "body": "<p>It looks like you're trying to use a <code>for</code> loop, i.e. repeating a task over and over again, for an in-determinant amount of steps.</p>\n\n<pre><code>unsigned int buffToInteger(char * buffer, unsigned int size)\n{\n    // assert(size &lt;= sizeof(int));\n    unsigned int ret = 0;\n    int shift = 0;\n    for( int i = size - 1; i &gt;= 0, i-- ) {\n        ret |= static_cast&lt;unsigned int&gt;(buffer[i]) &lt;&lt; shift;\n        shift += 8;\n    }\n    return ret;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3046, "user_id": 1692584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91b95bf73cfe4dc84cf414371aabb825?s=128&d=identicon&r=PG", "display_name": "Czipperz", "link": "https://stackoverflow.com/users/1692584/czipperz"}, "is_accepted": false, "score": 0, "last_activity_date": 1533144633, "creation_date": 1533144633, "answer_id": 51639118, "question_id": 51638731, "link": "https://stackoverflow.com/questions/51638731/convert-unsigned-char-array-of-characters-to-int-c/51639118#51639118", "title": "Convert unsigned char array of characters to int C++", "body": "<p>What I think you are going for is called a hash -- converting an object to a unique integer.  The problem is a hash IS NOT REVERSIBLE.  This hash will produce different results for <code>hash(\"WXYZABCD\", 8)</code> and <code>hash(\"ABCD\", 4)</code>.  The answer by @Nicholas Pipitone DOES NOT produce different outputs for these different inputs.</p>\n\n<p>Once you compute this hash, there is no way to get the original string back.  If you want to keep knowledge of the original string, you MUST keep the original string as a variable.</p>\n\n<pre><code>int hash(char* buffer, size_t size) {\n    int res = 0;\n    for (size_t i = 0; i &lt; size; ++i) {\n        res += buffer[i];\n        res *= 31;\n    }\n    return res;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2473, "user_id": 4490706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nmMcD.jpg?s=128&g=1", "display_name": "Ton Plooij", "link": "https://stackoverflow.com/users/4490706/ton-plooij"}, "is_accepted": false, "score": 0, "last_activity_date": 1533146740, "creation_date": 1533146740, "answer_id": 51639672, "question_id": 51638731, "link": "https://stackoverflow.com/questions/51638731/convert-unsigned-char-array-of-characters-to-int-c/51639672#51639672", "title": "Convert unsigned char array of characters to int C++", "body": "<p>Here's how to convert the first sizeof(int) bytes of the char array to an int:</p>\n\n<pre><code>int val = *(unsigned int *)buffer;\n</code></pre>\n\n<p>and to convert in back:</p>\n\n<pre><code>*(unsigned int *)buffer = val;\n</code></pre>\n\n<p>Note that your buffer must be at least the length of your int type size. You should check for this.</p>\n"}], "owner": {"reputation": 1, "user_id": 6748371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df37c266945c111e4d78ec938532bdd?s=128&d=identicon&r=PG&f=1", "display_name": "Doku Software", "link": "https://stackoverflow.com/users/6748371/doku-software"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1533146740, "creation_date": 1533143051, "question_id": 51638731, "link": "https://stackoverflow.com/questions/51638731/convert-unsigned-char-array-of-characters-to-int-c", "title": "Convert unsigned char array of characters to int C++", "body": "<p>How can I convert an unsigned char array that contains letters into an integer. I have tried this so for but it only converts up to four bytes. I also need a way to convert the integer back into the unsigned char array .</p>\n\n<pre><code>int buffToInteger(char * buffer)\n{\n    int a = static_cast&lt;int&gt;(static_cast&lt;unsigned char&gt;(buffer[0]) &lt;&lt; 24 |\n        static_cast&lt;unsigned char&gt;(buffer[1]) &lt;&lt; 16 | \n        static_cast&lt;unsigned char&gt;(buffer[2]) &lt;&lt; 8 | \n        static_cast&lt;unsigned char&gt;(buffer[3]));\n    return a;\n}\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "c++11"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1533144641, "post_id": 51638715, "comment_id": 90242614, "body": "As you say, pop until the queue is empty. Condition variables don&#39;t keep track of how many notify calls are pending."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1533174264, "post_id": 51638715, "comment_id": 90252865, "body": "What&#39;s the problem with A acting on only one of the <code>notify</code> calls? What do you think A will do next?"}, {"owner": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "edited": false, "score": 0, "creation_date": 1533175403, "post_id": 51638715, "comment_id": 90253084, "body": "The issue is if A doesn\u2019t act on both notify calls, I have items in the queue I\u2019m not processing."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "edited": false, "score": 0, "creation_date": 1533154523, "post_id": 51639046, "comment_id": 90247612, "body": "When waking, the predicate is checked on cv.wait(lock, verify_pred), to avoid issues with spurious wake up. However at this point I still need to handle the fact that there may be more than one item in the queue that must be processed. Do you see any other reasonable alternative, other than just popping until the queue is empty before waiting again?"}, {"owner": {"reputation": 1583, "user_id": 2103736, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vIuk3.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2103736/andy"}, "reply_to_user": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "edited": false, "score": 1, "creation_date": 1533157004, "post_id": 51639046, "comment_id": 90248724, "body": "cv.wait() will return immediately when your predicate is true (i.e. not block) regardless of whether it was notified. Thus if the predicate is (!queue.empty()) or something similar, and there are two items in the queue, it&#39;s going to return immediately until the queue is empty (not necessarily the number of notifications it gets!) and go around twice. So you probably don&#39;t need to do anything other than pop the queue once when wait() returns as wait() will continue to return immediately until the queue is empty. What exactly is your predicate?"}, {"owner": {"reputation": 1583, "user_id": 2103736, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vIuk3.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2103736/andy"}, "reply_to_user": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "edited": false, "score": 0, "creation_date": 1533157075, "post_id": 51639046, "comment_id": 90248755, "body": "And sorry I didn&#39;t go into detail before - I&#39;d assumed you were using pthreads.  Boost or C++ threads changes the dynamics a little."}, {"owner": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "edited": false, "score": 0, "creation_date": 1533157240, "post_id": 51639046, "comment_id": 90248831, "body": "C++ threads, and so that&#39;s where my confusion lies. My predicate is {return !queue.empty()}. My understanding is that even though the predicate is satisfied, it blocks at wait until it acquires the lock, or is that wrong? In which case, that&#39;s also not what I want."}, {"owner": {"reputation": 1583, "user_id": 2103736, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vIuk3.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2103736/andy"}, "reply_to_user": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "edited": false, "score": 1, "creation_date": 1533157512, "post_id": 51639046, "comment_id": 90248954, "body": "Ok, you should have the lock acquired <i>before</i> you call wait, that&#39;s a precondition of using wait.  <i>Wait then unlocks the mutex and waits after it checks the predicate</i>.  If the predicate is false, it returns with the lock still locked.  And yes, once unlocked, it will wait until signalled (or spuriously woken) and then reacquire the lock before returning."}, {"owner": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "edited": false, "score": 0, "creation_date": 1533157801, "post_id": 51639046, "comment_id": 90249054, "body": "Right, so I think we are on the same page now, I would just need to ensure the queue was empty before releasing the lock."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "edited": false, "score": 1, "creation_date": 1533174217, "post_id": 51639046, "comment_id": 90252859, "body": "@nromer It shouldn&#39;t matter whether you check if the queue is empty or not before releasing the lock. Whatever consumer thread next gets the lock should find the queue non-empty and not wait for anything. Just don&#39;t wait for something that has already happened."}], "tags": [], "owner": {"reputation": 1583, "user_id": 2103736, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vIuk3.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2103736/andy"}, "is_accepted": true, "score": 2, "last_activity_date": 1533144369, "creation_date": 1533144369, "answer_id": 51639046, "question_id": 51638715, "link": "https://stackoverflow.com/questions/51638715/can-a-conditional-variable-miss-a-notify-call/51639046#51639046", "title": "Can a conditional variable &quot;miss&quot; a notify call?", "body": "<blockquote>\n  <p>If you are trying to process the items in the queue one by one, this\n  seems to create a pile up.</p>\n  \n  <p>Is this a situation that can occur? And do we have to be aware of it?\n  For example, within A, pop UNTIL the queue is empty? Or is this\n  handled by the language?</p>\n</blockquote>\n\n<p>Yes it is a situation that can occur and you should be aware of it.  In your described scenario, the wait could wake once (with two items in the queue), twice (once per item in the queue) or even N times (spurious wakeups with no items in the queue.  This is why <em>you always check your predicate after waking and then make sure the predicate is false prior to re-waiting on the condition</em>.  Popping until the queue is empty is a reasonable solution.</p>\n"}], "owner": {"reputation": 131, "user_id": 7080900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c8836440ec713f7419b28d919cd25a?s=128&d=identicon&r=PG&f=1", "display_name": "hromer", "link": "https://stackoverflow.com/users/7080900/hromer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 51639046, "answer_count": 1, "score": 1, "last_activity_date": 1533171554, "creation_date": 1533142949, "last_edit_date": 1533171554, "question_id": 51638715, "link": "https://stackoverflow.com/questions/51638715/can-a-conditional-variable-miss-a-notify-call", "title": "Can a conditional variable &quot;miss&quot; a notify call?", "body": "<p>I was wondering if it were possible for a conditional variable to \"miss\" a notify call. My scenario is as follows.</p>\n\n<p>Given a mutex mu, and a Pred P (!queue.empty())...</p>\n\n<p>Thread A: Persists for the entirety of the program's life span. Holds a conditional variable waiting on mu and P. Upon acquiring mu and verifying the queue is not empty, it will pop an item from the queue.</p>\n\n<p>Thread B: A function that will acquire mu, push to the queue.</p>\n\n<p>Thread C: Same as B.</p>\n\n<p>Thread B and C are spawned simultaneously. </p>\n\n<p>In this scenario B acquires mu first, pushes to the queue, drops mu and calls notify. In between B calling notify and dropping mu, C acquires mu, pushes to the queue, and calls notify. Finally A acquires mu, proceeds to pop an item from the queue and process it. However A only acts on one of the notify calls.</p>\n\n<p>If you are trying to process the items in the queue one by one, this seems to create a pile up.</p>\n\n<p>Is this a situation that can occur? And do we have to be aware of it? For example, within A, pop UNTIL the queue is empty? Or is this handled by the language?</p>\n"}, {"tags": ["c++", "qt"], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 6213427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ca3c0334fbdd3b3d1115a0ca3f089d0?s=128&d=identicon&r=PG", "display_name": "behruz montazeri", "link": "https://stackoverflow.com/users/6213427/behruz-montazeri"}, "is_accepted": false, "score": 0, "last_activity_date": 1533184989, "creation_date": 1533184989, "answer_id": 51645646, "question_id": 51638687, "link": "https://stackoverflow.com/questions/51638687/qtextcursorclearselection-doesnt-clear-my-selection/51645646#51645646", "title": "QTextCursor::clearSelection() doesn&#39;t clear my selection", "body": "<pre><code>    ui-&gt;textEdit-&gt;setText(qry.value(2).toString());\n    // ui-&gt;textEdit-&gt;selectAll();\n    QTextCursor cursor = ui-&gt;textEdit-&gt;textCursor();\n    cursor.select( QTextCursor::Document );\n\n    QTextBlockFormat textBlockFormat = cursor.blockFormat();\n    textBlockFormat.setAlignment(Qt::AlignCenter);\n    cursor.mergeBlockFormat(textBlockFormat);\n    cursor.movePosition( QTextCursor::Start );\n    ui-&gt;textEdit-&gt;setTextCursor(cursor);\n    cursor.clearSelection();\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6213427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ca3c0334fbdd3b3d1115a0ca3f089d0?s=128&d=identicon&r=PG", "display_name": "behruz montazeri", "link": "https://stackoverflow.com/users/6213427/behruz-montazeri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1534693849, "creation_date": 1533142825, "last_edit_date": 1534693849, "question_id": 51638687, "link": "https://stackoverflow.com/questions/51638687/qtextcursorclearselection-doesnt-clear-my-selection", "title": "QTextCursor::clearSelection() doesn&#39;t clear my selection", "body": "<p><a href=\"https://i.stack.imgur.com/DY8JP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DY8JP.jpg\" alt=\"Each line is center\"></a></p>\n\n<pre><code>    ui-&gt;textEdit-&gt;setText(qry.value(2).toString());\n    ui-&gt;textEdit-&gt;selectAll();\n    QTextCursor cursor = ui-&gt;textEdit-&gt;textCursor();\n\n    QTextBlockFormat textBlockFormat = cursor.blockFormat();\n    textBlockFormat.setAlignment(Qt::AlignCenter);\n    cursor.mergeBlockFormat(textBlockFormat);\n\n    cursor.clearSelection();\n</code></pre>\n\n<p>I try to clear the selection but does nothing. <pre>cursor.clearSelection();</pre></p>\n"}, {"tags": ["c++", "qt", "audio", "opus"], "comments": [{"owner": {"reputation": 397, "user_id": 4766254, "user_type": "registered", "profile_image": "https://graph.facebook.com/968119739885888/picture?type=large", "display_name": "ChannelJuanNews", "link": "https://stackoverflow.com/users/4766254/channeljuannews"}, "edited": false, "score": 0, "creation_date": 1606967674, "post_id": 51638654, "comment_id": 115126039, "body": "were you able to solve this? I am interested in finding a solution to a similar problem. Please let me know if you solved it."}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 6909605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f820a846774a23ea0cb411ccfed920ff?s=128&d=identicon&r=PG&f=1", "display_name": "Logan S.", "link": "https://stackoverflow.com/users/6909605/logan-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1533403002, "creation_date": 1533403002, "answer_id": 51687925, "question_id": 51638654, "link": "https://stackoverflow.com/questions/51638654/how-to-encode-and-decode-audio-data-with-opus/51687925#51687925", "title": "How to encode and decode audio data with opus?", "body": "<p>I had a long answer ready about how you are misinterpreting the return value of opus.decodeData as the number of bytes, where the correct interpretation is \"number of decoded samples per channel\". But it still looks like you account for that in the byte conversion routine later on. So I'm not precisely sure where the bug is.</p>\n\n<p>In general I think you are making the conversion from unsigned char &lt;-> int16 more complicated than it needs to be. You should be able to just pass the audio buffer directly to / from opus and reinterpret its pointer to the needed type inline, without having to manually do bit manipulations to convert and copy between different buffers. The audio device should give you little-endian data but if there is a mismatch you can do a basic byte swapping routine</p>\n\n<pre><code>for (int c = 0; c &lt; numSamples; c++)\n{\n    unsigned char tmp = data[2 * c];\n    data[2 * c] = data[2 * c + 1];\n    data[2 * c + 1] = tmp;\n}\n</code></pre>\n\n<p>I don't see it here but I assume you also have code to only consume exactly 960 samples at a time from the mic and keep the rest in the buffer for the next frame, otherwise you'll drop data.</p>\n\n<p>Not that it matters much, but you can also replace 4000 in cbits with 1275, which is the maximum opus packet size.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12308873, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCC7xGqB3GuKPOyndAxv5OQGus2nXX2wD6udUXM=k-s128", "display_name": "\u0430\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u0434\u043c\u0438\u0442\u0440\u044b\u0447", "link": "https://stackoverflow.com/users/12308873/%d0%b0%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%b4%d0%bc%d0%b8%d1%82%d1%80%d1%8b%d1%87"}, "is_accepted": false, "score": 1, "last_activity_date": 1572631210, "last_edit_date": 1572631210, "creation_date": 1572628305, "answer_id": 58663201, "question_id": 51638654, "link": "https://stackoverflow.com/questions/51638654/how-to-encode-and-decode-audio-data-with-opus/58663201#58663201", "title": "How to encode and decode audio data with opus?", "body": "<p>1)You encode only 960 bytes, while the buffer is much larger. You must split the buffer into several equal parts and pass them to the encoder. The size of the part is 120, 240, 480, 960, 1920, and 2880.</p>\n\n<p>2)Use qFromLittleEndian()/qToLittleEndian() functions or type casting when converting from char array to opus_int16 array/from opus_int16 array to char array. This will prevent cracking and poor sound quality.</p>\n\n<p>Example: </p>\n\n<pre><code>void voice::slot_read_audio_input()\n{\n\n    //    Audio settings:\n    //    Sample Rate=48000\n    //    Sample Size=16\n    //    Channel Count=1\n    //    Byte Order=Little Endian\n    //    Sample Type= UnSignedInt\n\n    //    Encoder settings:\n    //    Sample Rate=48000\n    //    Channel Count=1\n    //    OPUS_APPLICATION_VOIP\n\n    //    Decoder settings:\n    //    Sample Rate=48000\n    //    Channel Count=1\n\n    QByteArray audio_buffer;//mic\n    QByteArray output_audio_buffer;//speaker\n\n    int const OPUS_INT_SIZE=2;//sizeof(opus_int16)\n    int const FRAME_SIZE=960;\n    int const MAX_FRAME_SIZE=1276;\n    int FRAME_COUNT=3840/FRAME_SIZE/OPUS_INT_SIZE;// 3840 is a sample size= voice_input-&gt;bytesReady;\n\n    opus_int16 input_frame[FRAME_SIZE] = {};\n    opus_int16 output_frame[FRAME_SIZE] = {};\n    unsigned char compressed_frame[MAX_FRAME_SIZE] = {};\n    unsigned char decompressed_frame[FRAME_SIZE*OPUS_INT_SIZE] = {};\n\n    audio_buffer.resize(voice_input-&gt;bytesReady());   \n    output_audio_buffer.resize(FRAME_SIZE*OPUS_INT_SIZE);\n\n    input-&gt;read(audio_buffer.data(),audio_buffer.size());\n\n    for(int i=0;i&lt;FRAME_COUNT;i++)\n    {\n        //    convert from LittleEndian\n        for(int j=0;j&lt;FRAME_SIZE;j++)\n        {\n            input_frame[j]=qFromLittleEndian&lt;opus_int16&gt;(audio_buffer.data()+j*OPUS_INT_SIZE);\n            //    or use this:\n            //    input_frame[j]=static_cast&lt;short&gt;(static_cast&lt;unsigned char&gt;(audio_buffer.at(OPUS_INT_SIZE*j+1))&lt;&lt;8|static_cast&lt;unsigned char&gt;(audio_buffer.at(OPUS_INT_SIZE*j)));\n        }\n\n        opus_int32 compressedBytes = opus_encode(enc, input_frame,FRAME_SIZE,compressed_frame,MAX_FRAME_SIZE);\n        opus_int32 decompressedBytes = opus_decode(dec,compressed_frame,compressedBytes,output_frame,FRAME_SIZE,0);\n\n        //    conver to LittleEndian\n        for(int j = 0; j&lt;decompressedBytes;j++)\n        {\n            qToLittleEndian(output_frame[j],output_audio_buffer.data()+j*OPUS_INT_SIZE);\n            //    or use this:\n            //    decompressed_frame[OPUS_INT_SIZE*j]=output_frame[j]&amp;0xFF;\n            //    decompressed_frame[OPUS_INT_SIZE*j+1]=(output_frame[j]&gt;&gt;8)&amp;0xFF;\n        }\n\n        audio_buffer.remove(0,FRAME_SIZE*OPUS_INT_SIZE);\n        output-&gt;write(output_audio_buffer,FRAME_SIZE*OPUS_INT_SIZE);\n        //    or use this:\n        //    output-&gt;write(reinterpret_cast&lt;char*&gt;(decompressed_frame),FRAME_SIZE*OPUS_INT_SIZE);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9663867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0aba523235ba14cd8b5d16d04c18e91?s=128&d=identicon&r=PG&f=1", "display_name": "MooN_Tiga", "link": "https://stackoverflow.com/users/9663867/moon-tiga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1844, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572631210, "creation_date": 1533142689, "last_edit_date": 1533390485, "question_id": 51638654, "link": "https://stackoverflow.com/questions/51638654/how-to-encode-and-decode-audio-data-with-opus", "title": "How to encode and decode audio data with opus?", "body": "<p>I'm working on a voice chat and I need to compress my audio data. I record and play the audio data via the Qt Framework. If I record and play the audio data without compressing it everything is fine. If I compress,decompress and play the audio data I just hear a cracking sound.</p>\n\n<p>Edit: I had a look at the demo code and I tried to use that code.\nI can hear something but it is very laggy. If I increase the size of pcm_bytes to e.g 40000 it sounds better but my voice has still lags and cracking sounds.</p>\n\n<p>This is the line (audioinput.cpp at the bottom):</p>\n\n<pre><code>speaker-&gt;write((const char*)pcm_bytes,3840);\n</code></pre>\n\n<p>codecopus.cpp:</p>\n\n<pre><code>#include \"codecopus.h\"\n\nCodecOpus::CodecOpus()\n{\n\n}\n\nvoid CodecOpus::initDecoder(opus_int32 samplingRate, int channels) //decoder\n{\n    int error;\n    decoderState = opus_decoder_create(samplingRate,channels,&amp;error);\n    if(error == OPUS_OK){\n        std::cout &lt;&lt; \"Created Opus Decoder struct\" &lt;&lt; std::endl;\n    }\n\n}\n\nvoid CodecOpus::initEncoder(opus_int32 samplingRate, int channels) // Encoder\n{\n    int error;\n    encoderState = opus_encoder_create(samplingRate,channels,OPUS_APPLICATION_VOIP,&amp;error);\n    error = opus_encoder_ctl(encoderState,OPUS_SET_BITRATE(64000));\n    if(error == OPUS_OK){\n        std::cout &lt;&lt; \"Created Opus Encoder struct\" &lt;&lt; std::endl;\n    }\n}\n\nopus_int32 CodecOpus::encodeData(const opus_int16 *pcm, int frameSize, unsigned char *data, opus_int32 maxDataBytes) //Encoder\n{\n    opus_int32 i = opus_encode(encoderState,pcm,frameSize,data,maxDataBytes);\n    return i;\n}\n\nint CodecOpus::decodeData(const unsigned char *data, opus_int32 numberOfBytes,opus_int16* pcm,int frameSizeInSec) //Decoder\n{\n\n    int i = opus_decode(decoderState,data,numberOfBytes,pcm,frameSizeInSec,0);\n\n    return i;\n}\n\nCodecOpus::~CodecOpus()\n{\n    opus_decoder_destroy(this-&gt;decoderState);\n    opus_encoder_destroy(this-&gt;encoderState);\n\n}\n</code></pre>\n\n<p>audioinput.h:</p>\n\n<pre><code>#ifndef AUDIOINPUT_H\n#define AUDIOINPUT_H\n#include &lt;QAudioFormat&gt;\n#include &lt;iostream&gt;\n#include &lt;QAudioInput&gt;\n#include &lt;QAudioOutput&gt;\n#include &lt;thread&gt;\n#include \"codecopus.h\"\n#include \"QDebug\"\nclass AudioInput : public QObject\n{\n    Q_OBJECT\n\npublic:\n    AudioInput();\n    ~AudioInput();\n    void startRecording();\n    void CreateNewAudioThread();\n\nprivate:\n\n    CodecOpus opus;\n    unsigned char cbits[4000] = {};\n    opus_int16 in[960*2*sizeof(opus_int16)] = {};\n    opus_int16 out[5760*2] = {};\n\n    unsigned char *pcm_bytes;\n\n    int MAX_FRAME_SIZE;\n\n    QAudioFormat audioFormat;\n    QAudioInput *audioInput;\n    QIODevice *mic;\n    QByteArray data;\n    int micFrameSize;\n\n\n    QAudioOutput *audioOutput;\n    QIODevice *speaker;\n    QAudioFormat speakerAudioFormat;\n\n\n\n\npublic slots:\n    void OnAudioNotfiy();\n};\n\n#endif // AUDIOINPUT_H\n</code></pre>\n\n<p>audioinput.cpp:</p>\n\n<pre><code>#include \"audioinput.h\"\n\nAudioInput::AudioInput() : audioFormat(),pcm_bytes(new unsigned char[40000])\n{\n    audioFormat.setSampleRate(48000);\n    audioFormat.setChannelCount(2);\n    audioFormat.setSampleSize(16);\n    audioFormat.setSampleType(QAudioFormat::SignedInt);\n    audioFormat.setByteOrder(QAudioFormat::LittleEndian);\n    audioFormat.setCodec(\"audio/pcm\");\n\n\n    speakerAudioFormat.setSampleRate(48000);\n    speakerAudioFormat.setChannelCount(2);\n    speakerAudioFormat.setSampleSize(16);\n    speakerAudioFormat.setSampleType(QAudioFormat::SignedInt);\n    speakerAudioFormat.setByteOrder(QAudioFormat::LittleEndian);\n    speakerAudioFormat.setCodec(\"audio/pcm\");\n\n    QAudioDeviceInfo info = QAudioDeviceInfo::defaultInputDevice();\n    if(!info.isFormatSupported(audioFormat)){\n        std::cout &lt;&lt; \"Mic Format not supported!\" &lt;&lt; std::endl;\n        audioFormat = info.nearestFormat(audioFormat);\n    }\n    QAudioDeviceInfo speakerInfo = QAudioDeviceInfo::defaultOutputDevice();\n    if(!speakerInfo.isFormatSupported(speakerAudioFormat)){\n        std::cout &lt;&lt; \"Speaker Format is not supported!\" &lt;&lt; std::endl;\n        speakerAudioFormat = info.nearestFormat(speakerAudioFormat);\n\n    }\n    std::cout &lt;&lt; speakerAudioFormat.sampleRate() &lt;&lt; audioFormat.sampleRate() &lt;&lt; speakerAudioFormat.channelCount() &lt;&lt; audioFormat.channelCount() &lt;&lt; std::endl;\n    audioInput = new QAudioInput(audioFormat);\n    audioOutput = new QAudioOutput(speakerAudioFormat);\n    audioInput-&gt;setNotifyInterval(20);\n    micFrameSize = (audioFormat.sampleRate()/1000)*20;\n\n    opus.initEncoder(audioFormat.sampleRate(),audioFormat.channelCount());\n    opus.initDecoder(speakerAudioFormat.sampleRate(),speakerAudioFormat.channelCount());\n\n    MAX_FRAME_SIZE = 6*960;\n\n\n\n    connect(audioInput,SIGNAL(notify()),this,SLOT(OnAudioNotfiy()));\n}\n\nAudioInput::~AudioInput()\n{\n\n}\n\nvoid AudioInput::startRecording()\n{\n\n    mic = audioInput-&gt;start();\n    speaker = audioOutput-&gt;start();\n    std::cout &lt;&lt; \"Recording started!\" &lt;&lt; std::endl;\n\n\n}\n\n\nvoid AudioInput::CreateNewAudioThread()\n{\n    std::thread t1(&amp;AudioInput::startRecording,this);\n    t1.detach();\n}\n\n\n\n\n\nvoid AudioInput::OnAudioNotfiy()\n{\n    data = mic-&gt;readAll();\n\n\n    std::cout &lt;&lt; \"data size\" &lt;&lt;data.size() &lt;&lt; std::endl;\n    if(data.size() &gt; 0){\n    pcm_bytes = reinterpret_cast&lt;unsigned char*&gt;(data.data());\n\n//convert\n\n    for(int i=0;i&lt;2*960;i++){ //TODO HARDCODED\n        in[i]=pcm_bytes[2*i+1]&lt;&lt;8|pcm_bytes[2*i];\n    }\n    opus_int32 compressedBytes = opus.encodeData(in,960,cbits,4000);\n\n    opus_int32 decompressedBytes = opus.decodeData(cbits,compressedBytes,out,MAX_FRAME_SIZE);\n\n    for(int i = 0; i&lt;2*decompressedBytes;i++) //TODO HARDCODED\n    {\n        pcm_bytes[2*i]=out[i]&amp;0xFF;\n        pcm_bytes[2*i+1]=(out[i]&gt;&gt;8)&amp;0xFF;\n    }\n\n\n    speaker-&gt;write((const char*)pcm_bytes,3840);\n}\n\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "kinect-v2"], "comments": [{"owner": {"reputation": 453, "user_id": 3719323, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/54ec9ddce183a25228d1035a71532812?s=128&d=identicon&r=PG&f=1", "display_name": "userDtrm", "link": "https://stackoverflow.com/users/3719323/userdtrm"}, "edited": false, "score": 0, "creation_date": 1533921001, "post_id": 51638482, "comment_id": 90539766, "body": "I observed that adding delay prior to acquiring a frame can help to reduce the frame rate. I have a feeling that this is not the best approach but seem to do the trick. Any thoughts?"}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 835226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FOAQj.png?s=128&g=1", "display_name": "zeFrenchy", "link": "https://stackoverflow.com/users/835226/zefrenchy"}, "is_accepted": false, "score": 0, "last_activity_date": 1542189302, "creation_date": 1542189302, "answer_id": 53297353, "question_id": 51638482, "link": "https://stackoverflow.com/questions/51638482/set-kinect-v2-frame-rates-rgb-depth-skeleton-to-25-fps/53297353#53297353", "title": "Set Kinect v2 frame rates (rgb, depth, skeleton) to 25 fps", "body": "<p>The KINECT SDK offers no way of setting the frame rate. Moreover, the RGB frame rate is not fixed and may drop down to 15 fps (from 30 fps) in low light conditions. Your approach of adding delay does not change the native frame rate of the devices. All you are doing is selectively dropping some frames based on timing. If regular spacing between frame capture times is important to your application you should be implementing an interpolation method instead.</p>\n"}], "owner": {"reputation": 453, "user_id": 3719323, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/54ec9ddce183a25228d1035a71532812?s=128&d=identicon&r=PG&f=1", "display_name": "userDtrm", "link": "https://stackoverflow.com/users/3719323/userdtrm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542189302, "creation_date": 1533142025, "last_edit_date": 1533142979, "question_id": 51638482, "link": "https://stackoverflow.com/questions/51638482/set-kinect-v2-frame-rates-rgb-depth-skeleton-to-25-fps", "title": "Set Kinect v2 frame rates (rgb, depth, skeleton) to 25 fps", "body": "<p>I'm working on a project which requires all three streams from the Kinect v2 sensor (RGB, Depth, and Skeleton) to be captured, processed and streamed at 25 fps. \nMy program works with default settings and all three streams seem to be operating at 30fps. Is there a method to reduce this to 25 fps?. </p>\n\n<p>I'm working on a C++ environment.</p>\n"}, {"tags": ["c++", "visual-studio", "vector", "casting", "eigen3"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533142391, "post_id": 51638460, "comment_id": 90241530, "body": "Your attempt actually tries to initialize using a <code>double*</code> and an integer, so <code>std::vector</code> is not involved directly.  So is there a way to construct an <code>Eigen::Map</code> using an array or pointer to a buffer?"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1533142681, "post_id": 51638460, "comment_id": 90241691, "body": "VectorXi does not contain double. Did you mean VectorXd?"}, {"owner": {"reputation": 243, "user_id": 9646358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8518b96572e49e078883cec4f181fb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Oconnor", "link": "https://stackoverflow.com/users/9646358/tom-oconnor"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533143076, "post_id": 51638460, "comment_id": 90241888, "body": "@PaulMcKenzie I am confused about the reason why that is happening. What would be a way to fix this?"}, {"owner": {"reputation": 243, "user_id": 9646358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8518b96572e49e078883cec4f181fb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Oconnor", "link": "https://stackoverflow.com/users/9646358/tom-oconnor"}, "reply_to_user": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1533143158, "post_id": 51638460, "comment_id": 90241920, "body": "@MarcGlisse Maybe? My point was to create a dynamic vector, and the documentation said that was the way to do so. Is VectorXd still dynamic?"}, {"owner": {"reputation": 243, "user_id": 9646358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8518b96572e49e078883cec4f181fb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Oconnor", "link": "https://stackoverflow.com/users/9646358/tom-oconnor"}, "reply_to_user": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1533143320, "post_id": 51638460, "comment_id": 90241984, "body": "@MarcGlisse I tried doing &quot;Eigen::VectorXd X(_0to99.data());&quot; and I got the following error: YOU_CALLED_A_FIXED_SIZE_METHOD_ON_A_DYNAMIC_SIZE_MATRIX_OR_V&zwnj;&#8203;ECTOR"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533143416, "post_id": 51638460, "comment_id": 90242039, "body": "@TomOconnor -- Forget about <code>sd::vector</code> for the moment.  What if you had a plain old <code>double myData[100]</code> and filled it with values.  How would you get that to populate <code>Eigen::Map</code>?  Is that possible?  If not, then using <code>vector::data()</code> isn&#39;t going to work."}, {"owner": {"reputation": 243, "user_id": 9646358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8518b96572e49e078883cec4f181fb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Oconnor", "link": "https://stackoverflow.com/users/9646358/tom-oconnor"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533144110, "post_id": 51638460, "comment_id": 90242365, "body": "@PaulMcKenzie Sorry for the dumb follow up question, but I guess I am sort of stuck after following your advice. I declared &quot;double _0to99[100];&quot; and then I wrote the following statement &quot;Eigen::VectorXi X = Eigen::Map&lt;Eigen::VectorXi&gt;(_0to99, 100);&quot;. However, I still got the errors mentioned in my question on top. Could you please guide me a little bit further?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533144219, "post_id": 51638460, "comment_id": 90242408, "body": "Yes, you get the same error because you&#39;re doing the same thing with vector.  So basically you should be investigating how to populate <code>Eigen::Map</code> using a plain array first.  Once you find the right function(s) to do that, then you can use the <code>std::vector::data()</code> method.  I would be surprised if there was not a way to use a plain array, and instead you have to &quot;package&quot; your data into some special type first just to initialize (again, I have never used <code>Eigen</code>)."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1533144775, "post_id": 51638460, "comment_id": 90242684, "body": "&#39;I tried doing &quot;Eigen::VectorXd X(_0to99.data());&quot;&#39; Why are you changing everything at once? Just replacing VectorXi with VectorXd lets your original code compile! The error you get is pretty clear, the size is dynamic so you have to pass it as argument. Please do visit Eigen&#39;s documentation is you need to ask if VectorXd is dynamic."}, {"owner": {"reputation": 243, "user_id": 9646358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8518b96572e49e078883cec4f181fb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Oconnor", "link": "https://stackoverflow.com/users/9646358/tom-oconnor"}, "reply_to_user": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1533145822, "post_id": 51638460, "comment_id": 90243238, "body": "@MarcGlisse Apparently doing either &quot;Eigen::VectorXd X = Eigen::Map&lt;Eigen::VectorXd&gt;(_0to99.data(), 100);&quot; or  \t&quot;Eigen::Map&lt;Eigen::VectorXd&gt; v(_0to99.data(), 100);&quot; works. Thanks a lot for your help!"}, {"owner": {"reputation": 243, "user_id": 9646358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8518b96572e49e078883cec4f181fb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Oconnor", "link": "https://stackoverflow.com/users/9646358/tom-oconnor"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533146096, "post_id": 51638460, "comment_id": 90243378, "body": "^ @PaulMcKenzie ^ Thanks a lot for your help!!!"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533146215, "post_id": 51638460, "comment_id": 90243438, "body": "@TomOconnor -- If that works, then now you can use <code>std::vector</code> in the call (so that it looks like your original attempt):  <code>Eigen::Map&lt;Eigen::VectorXd&gt; v(your_vector.data(), your_vector.size());</code>.  Remeber that <code>std::vector</code> is just a wrapper around a dynamic array, and to get to the array, the <code>vector::data()</code> is used."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10150101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b93e3d19d2d5b67e3217285f0bb028?s=128&d=identicon&r=PG&f=1", "display_name": "CmdteAlphaTigreZ", "link": "https://stackoverflow.com/users/10150101/cmdtealphatigrez"}, "is_accepted": false, "score": -2, "last_activity_date": 1533145978, "creation_date": 1533145978, "answer_id": 51639465, "question_id": 51638460, "link": "https://stackoverflow.com/questions/51638460/typecasting-std-vectordouble-to-eigen-vectorxd/51639465#51639465", "title": "Typecasting std: :vector&lt;double&gt; to Eigen: :VectorXd?", "body": "<p>As I saw in <a href=\"https://eigen.tuxfamily.org/dox/group__TutorialMatrixClass.html\" rel=\"nofollow noreferrer\">https://eigen.tuxfamily.org/dox/group__TutorialMatrixClass.html</a> and <a href=\"https://eigen.tuxfamily.org/dox/classEigen_1_1Map.html\" rel=\"nofollow noreferrer\">https://eigen.tuxfamily.org/dox/classEigen_1_1Map.html</a> , your problem is that you are giving a size_t value to the Eigen::Map object's constructor whose second parameter is an Stride object.</p>\n\n<p>I think that you want to pass the _0to99.size() as an argument for the size of the Eigen::Map object. So... solution is simple.</p>\n\n<pre><code>#include &lt;Eigen/Dense&gt;\n#include &lt;vector&gt;\n/*More code goes here*/\n...\nstd::vector&lt;double&gt; _0to99;\n/*putting values into the vector*/\nEigen::VectorXi X = Eigen::Map&lt;Eigen::VectorXi&gt;(_0to99.data(), _0to99.size(),);\n</code></pre>\n\n<p>The comma after _0to99.size() tells the compiler that you want to call the constructor for Eigen::Map objects that have three parameters.</p>\n\n<pre><code>    Map(PointerArgType dataPtr, Index size, const StrideType &amp;  stride = StrideType() )\n</code></pre>\n\n<p>With the default value for the third parameter.</p>\n\n<hr>\n\n<p>Finally, I think that you would like to use the Eigen::VectorXd instead of Eigen::VectorXi if you want to work with doubles.</p>\n"}], "owner": {"reputation": 243, "user_id": 9646358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8518b96572e49e078883cec4f181fb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Oconnor", "link": "https://stackoverflow.com/users/9646358/tom-oconnor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 854, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1533145978, "creation_date": 1533141940, "question_id": 51638460, "link": "https://stackoverflow.com/questions/51638460/typecasting-std-vectordouble-to-eigen-vectorxd", "title": "Typecasting std: :vector&lt;double&gt; to Eigen: :VectorXd?", "body": "<p>I have looked hard online for an answer; however, none of the provided ones fix my issue.</p>\n\n<p>I have tried this so far</p>\n\n<pre><code>#include &lt;Eigen/Dense&gt;\n#include &lt;vector&gt;\n/*More code goes here*/\n...\nstd::vector&lt;double&gt; _0to99;\n/*putting values into the vector*/\nEigen::VectorXi X = Eigen::Map&lt;Eigen::VectorXi&gt;(_0to99.data(), _0to99.size());\n</code></pre>\n\n<p>However, Visual Studio tells me this error:</p>\n\n<p>no instance of constructor \"Eigen::Map::Map [with PlainObjectType=Eigen::Matrix, MapOptions=0, StrideType=Eigen::Stride&lt;0, 0>]\" matches the argument list</p>\n\n<p>and</p>\n\n<p>'&lt; function-style-cast>': cannot convert from 'initializer list' to 'Eigen::Map>'</p>\n\n<p>Any sort of help would be highly appreciated! Have a wonderful day!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1533141300, "post_id": 51638255, "comment_id": 90240928, "body": "Why should the <code>llist</code> constructor be called? You&#39;re not creating any <code>llist</code> objects, instead you&#39;re creating <code>llist*</code> objects."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1533141395, "post_id": 51638255, "comment_id": 90240982, "body": "<code>v = new llist* [s]</code> dynamically allocates an array of pointers.  A pointer of type <code>llist *</code> is a different thing from a <code>llist</code>.   If you want the constructor of <code>llist</code> to be called, you need to construct one or more <code>llist</code>s, not pointers to them,"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1533141728, "post_id": 51638255, "comment_id": 90241159, "body": "Seems you are trying to create a 2d array of linked lists? It&#39;s not entirely clear. But in any case the procedure for creating a 2d array is the same whether it&#39;s a 2d array of linked lists or a 2d array of integers, Suggest you google how to allocate a 2d array."}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533141876, "post_id": 51638255, "comment_id": 90241256, "body": "I&#39;ve explained that I&#39;m trying to create a 2d linked list. And Google wasn&#39;t of help since I&#39;m trying to call the constructor"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1533141944, "post_id": 51638255, "comment_id": 90241292, "body": "Sorry but I don&#39;t know what a 2d linked list is, or how it relates to your code. Do you mean a 1d array of linked lists?"}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142053, "post_id": 51638255, "comment_id": 90241346, "body": "I don&#39;t know the exact term for it, but basically I&#39;m trying to create pointer to a bunch of other pointers of linked list so it    ressemble a 2d array"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1533142216, "post_id": 51638255, "comment_id": 90241437, "body": "@TraiVi\u1ec7tNam I suspect you have got too many pointers, and Neil&#39;s answer is the correct one. Your <code>llist</code> object already has pointers internally, and you&#39;re add two more levels of pointers in <code>list_graph</code>. That&#39;s <b>three</b> levels of pointers. Change <code>list_graph</code> to be <code>llist * v</code> and your constructor will be called"}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142361, "post_id": 51638255, "comment_id": 90241519, "body": "Can you elaborate on this please ?"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1533142530, "post_id": 51638255, "comment_id": 90241613, "body": "@TraiVi\u1ec7tNam Elaborate on what exactly? Stop thinking about pointers. If you want an array of linked lists and you don&#39;t want to use <code>std::vector</code> or <code>std::list</code> then <code>llist * v</code> and <code>v = new llist [s];</code> is the correct code."}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1533142666, "post_id": 51638255, "comment_id": 90241681, "body": "@john oh it just snapped in my head, wonder what I was thinking"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533141741, "post_id": 51638327, "comment_id": 90241169, "body": "Well that&#39;s the problem, I&#39;m trying to avoid vectors, so I ran into this"}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533141951, "post_id": 51638327, "comment_id": 90241293, "body": "This kinda defeats my purpose of creating a 2d linked list though"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142020, "post_id": 51638327, "comment_id": 90241326, "body": "Why do you want to create one? What are you going to use it for?"}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142115, "post_id": 51638327, "comment_id": 90241382, "body": "I&#39;m using it for my graph class file, I want to be able to specify the size so this happens"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142286, "post_id": 51638327, "comment_id": 90241479, "body": "Why can&#39;t you do that with std::list or std::vector?"}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142544, "post_id": 51638327, "comment_id": 90241617, "body": "I&#39;m trying to do everything myself so I can grasp what&#39;s going on instead of just slamming stl everywhere"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142980, "post_id": 51638327, "comment_id": 90241836, "body": "@TraiVi\u1ec7tNam -- <i>I&#39;m trying to do everything myself</i> -- Note you haven&#39;t mentioned how you&#39;re going to clean up all the memory you&#39;ve allocated."}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533226142, "post_id": 51638327, "comment_id": 90279687, "body": "As  you  can see I&#39;m not  that proficient yet, so I&#39;m going to assume the answer you&#39;re hoping for is delete lol"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": true, "score": 2, "last_activity_date": 1533141730, "last_edit_date": 1533141730, "creation_date": 1533141418, "answer_id": 51638327, "question_id": 51638255, "link": "https://stackoverflow.com/questions/51638255/double-pointer-doesnt-call-object-constructor-when-using-new/51638327#51638327", "title": "Double pointer doesn&#39;t call object constructor when using new", "body": "<p>This:</p>\n\n<pre><code>  v = new llist* [s] ; \n</code></pre>\n\n<p>creates an array of pointers to type <code>llist</code>, but it doesn't create any <code>llist</code> objects. If you want an array of such things, then you want:</p>\n\n<pre><code>  llist * v ;  \n</code></pre>\n\n<p>and:</p>\n\n<pre><code>  v = new llist[s] ; \n</code></pre>\n\n<p>Or better still, if this is not a homework assignment, use std::vector. And don't think of things like <code>llist ** v</code> as \"double pointers\"; think of them as what they are - pointers to pointers.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142246, "post_id": 51638423, "comment_id": 90241456, "body": "Is there anyway to do this that doesn&#39;t involve a loop ? It&#39;s going to cost me my precious runtime"}, {"owner": {"reputation": 588, "user_id": 2133098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCzMG.jpg?s=128&g=1", "display_name": "Taylor Nichols", "link": "https://stackoverflow.com/users/2133098/taylor-nichols"}, "reply_to_user": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533142483, "post_id": 51638423, "comment_id": 90241583, "body": "@Trai: You could initialize them all at once in a contiguous array, but that means you can&#39;t delete them individually. Is this OK?"}, {"owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "edited": false, "score": 0, "creation_date": 1533143787, "post_id": 51638423, "comment_id": 90242204, "body": "No but I&#39;ve found my bugs, thanks for the help  anyways"}], "tags": [], "owner": {"reputation": 588, "user_id": 2133098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCzMG.jpg?s=128&g=1", "display_name": "Taylor Nichols", "link": "https://stackoverflow.com/users/2133098/taylor-nichols"}, "is_accepted": false, "score": 0, "last_activity_date": 1533142826, "last_edit_date": 1533142826, "creation_date": 1533141802, "answer_id": 51638423, "question_id": 51638255, "link": "https://stackoverflow.com/questions/51638255/double-pointer-doesnt-call-object-constructor-when-using-new/51638423#51638423", "title": "Double pointer doesn&#39;t call object constructor when using new", "body": "<p>If you want to keep <code>v</code> as a array of pointers to <code>llist</code> objects, as opposed to an array of <code>llist</code> objects (suggested by Neil Butterworth), dynamically allocate each pointer by changing your <code>list_graph</code> constructor to</p>\n\n<pre><code>  list_graph(int s) : size(0), s(s), v(new llist* [s]) {\n    for (int i(0); i &lt; s; ++i)\n      v[i] = new llist();\n  }\n</code></pre>\n\n<p>EDIT: To avoid calling <code>new</code> <code>s</code> times in the for loop, you could pre-allocate all <code>s</code> <code>llist</code> objects at once. However, this would mean they can not be deleted individually. Your class would look like</p>\n\n<pre><code>class list_graph {\n  int size, s;\n  llist* buffer;\n  llist ** v ;\npublic:\n  list_graph(int s) : size(0), s(s),\n      buffer(new llist[s]), v(new llist* [s]) {\n    for (int i(0); i &lt; s; ++i)\n      v[i] = &amp;buffer[i];\n  }\n  ~list_graph() {\n    delete[] v;\n    delete[] buffer;\n  }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": false, "score": 1, "last_activity_date": 1533141926, "creation_date": 1533141926, "answer_id": 51638458, "question_id": 51638255, "link": "https://stackoverflow.com/questions/51638255/double-pointer-doesnt-call-object-constructor-when-using-new/51638458#51638458", "title": "Double pointer doesn&#39;t call object constructor when using new", "body": "<p>If you want to allocate a 2D pointer array, you can do it a couple ways:</p>\n\n<p>Using a dynamic array of pointer arrays, given some <code>width</code> and <code>height</code>:</p>\n\n<pre><code>llist** data = new llist*[width];\nfor (int i = 0; i &lt; width; ++i){\n    data[i] = new llist[height]; // constructors get called here\n}\n\n// accessing a linked list, make sure x is in [0, width) and y is in [0, height):\ndata[x][y]-&gt;value;\n</code></pre>\n\n<p>Using a single pointer array:</p>\n\n<pre><code>llist* data = new llist[width * height]; // constructors get called here\n\n// accessing a linked list:\n// again, make sure x is in [0, width) and y is in [0, height)\ndata[x + (y * width)]-&gt;value;\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 4702099, "user_type": "registered", "profile_image": "https://graph.facebook.com/342892189233728/picture?type=large", "display_name": "Trai Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/4702099/trai-vi%e1%bb%87t-nam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 51638327, "answer_count": 3, "score": 0, "last_activity_date": 1533142826, "creation_date": 1533141178, "question_id": 51638255, "link": "https://stackoverflow.com/questions/51638255/double-pointer-doesnt-call-object-constructor-when-using-new", "title": "Double pointer doesn&#39;t call object constructor when using new", "body": "<p>My problem seems to be answered with only single pointers. I'm trying to dynamically allocate for a 2d linked list. The problem I ran into when I'm trying to use class llist constructor to set head and tail pointer to NULL :</p>\n\n<pre><code>//I've included only the parts that I see are neccesary\n struct node {\n    int value ;\n    int weight ;\n    node* next ;\n } ;\n class  llist{\n      private :\n          node* tail, *head ;\n      public :\n           llist(){tail = NULL ;  head = NULL ;} /* this unneccesary retype is to make sure \n                                                    that it wasn't a typo*/\n}\nclass list_graph\n{\n    private :\n        int size, s;\n        llist ** v ;\n    public :\n        list_graph(int s){\n             this -&gt; s = s ;\n             size = 0 ;\n        v = new llist* [s] ; \n        }\n}\n</code></pre>\n\n<p>I've use the debugger and ran through every steps and it seems that my constructor for <code>llist</code> is not called after I create a object of <code>list_graph</code> type, so every other function that relies on this fails and gives me segmentation  fault. Is there anything I'm doing wrong, or is there any workarounds beside using the STL list, many thanks</p>\n"}, {"tags": ["c++", "debugging", "winapi", "disassembly"], "comments": [{"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1533142132, "post_id": 51638254, "comment_id": 90241392, "body": "Could you be more specific about your concerns and the errors your current solution may cause?"}, {"owner": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "reply_to_user": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1533142808, "post_id": 51638254, "comment_id": 90241750, "body": "What if the buffer size will be not enought?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1533163497, "post_id": 51638254, "comment_id": 90250814, "body": "&quot;<i>how I can get excatly 10 instructions started from e.g 0x4000bcda?</i>&quot; - by starting at the address and decoding instructions one at a time until you have decoded 10 instructions.  Instructions are variable length, so you have to decode them in sequence."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1533194747, "post_id": 51638254, "comment_id": 90259179, "body": "One instruction is at most 15 bytes, 10 instructions are at most 150 bytes. Seems straightforward to me."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1533200637, "post_id": 51638254, "comment_id": 90262648, "body": "Let&#39;s face it, 15 byte instructions are a pathological case.  I believe it is to stop the CPU from trying to decode an infinitely long sequence of prefixes (an unfortunate fill pattern, maybe)."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 1, "creation_date": 1533200678, "post_id": 51638254, "comment_id": 90262683, "body": "<i>What if the buffer size will be not enough?</i>  Then <code>GetProcessMemory</code> some more!"}], "answers": [{"tags": [], "owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "is_accepted": false, "score": 0, "last_activity_date": 1587601658, "creation_date": 1587601658, "answer_id": 61377330, "question_id": 51638254, "link": "https://stackoverflow.com/questions/51638254/disassembling-x-instruction-from-program-memory/61377330#61377330", "title": "Disassembling x instruction from program memory", "body": "<p>You said the max bytes per instruction is 15 and you want to read 10 instructions, so 15 x 10 = 150.  That is how much memory you should read in your call to ReadProcessMemory.</p>\n\n<p>But the instructions won't consume that much memory, once you read that memory into your local buffer, you will have to read each instruction starting at buffer[0], decode it, get it's length, index into the next instruction, decode the instruction and continue until the number of instructions decoded is reached 10.  The combined length of all the instructions you decoded represents the last byte in the buffer of your 10 instructions.</p>\n\n<p>You will have to increase the instruction counter and a seperate number of bytes counter one each iteration.</p>\n"}], "owner": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587601658, "creation_date": 1533141174, "last_edit_date": 1533142032, "question_id": 51638254, "link": "https://stackoverflow.com/questions/51638254/disassembling-x-instruction-from-program-memory", "title": "Disassembling x instruction from program memory", "body": "<p>I'm working on simple debugger for Windows x86 platform, just for tests. I have implemented almost all functionality I need, except code disassembling. I decide that I use udis86 library but it is not important in my case. </p>\n\n<p>In 0x86 - 0x64 architecture any instruction can has at most 15 bytes lenght, so\nhow I can get excatly 10 instructions started from e.g 0x4000bcda? </p>\n\n<p>I have following code. </p>\n\n<pre><code>void disassembly(HANDLE hProcess, DWORD address) \n{\n  BYTE buffer[15];   \n  SIZE_T bytes_read;\n\n GetProcessMemory(hProcess, (LPBYTE) address, buffer, sizeof(buffer),   &amp;bytes_read);\n}\n</code></pre>\n\n<p>When the GetProcessMemory function doesn't failed, buffer should be filled with data. </p>\n\n<p>But I can't assume that buffer contains fixed amount of instructuions. It may be one, two or whatever.</p>\n\n<p>Maybe you have any ideas how it should be implemented?</p>\n\n<p>Here is my current solution:</p>\n\n<pre><code>SIZE_T bytes_read;\nBYTE buffer[4096];\n\n\nif (!ReadProcessMemory(hProcess, (LPBYTE)address, buffer, sizeof(buffer), &amp;bytes_read)) {\n    std::cout &lt;&lt; \"Cannot read process memory -&gt; dissasembly.\" &lt;&lt; std::endl;\n\n    return;\n}\nprintf(\"Address : %#010x\\n\", address);\nstd::cout &lt;&lt; \"Disassembled code: \" &lt;&lt; std::endl;\nud_t ud_obj;\n\nud_init(&amp;ud_obj);\nud_set_input_buffer(&amp;ud_obj, buffer, sizeof(buffer));\nud_set_mode(&amp;ud_obj, 64);\nud_set_syntax(&amp;ud_obj, UD_SYN_INTEL);\n\nint counter = 0;\nint instructionAmount = 10;\n\nwhile (ud_disassemble(&amp;ud_obj)) {\n    printf(\"\\t%s\\n\", ud_insn_asm(&amp;ud_obj));\n\n    counter++;\n\n    if (counter == instructionAmount) {\n        break;\n    }\n}\n</code></pre>\n\n<p>It basically works but in m opinion it does not good solution and it may cause errors</p>\n"}, {"tags": ["c++", "performance", "profiling", "clock"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1533141708, "post_id": 51638246, "comment_id": 90241145, "body": "To begin with, you should probably not do the initialization of <code>tspec</code> in the section you&#39;re measuring. There&#39;s also some overhead in getting the clocks and initializing the <code>start</code> and <code>end</code> objects. And according to <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/nanosleep.html\" rel=\"nofollow noreferrer\">this POSIX reference</a> the actual time may depend on other things as well."}], "answers": [{"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 3, "last_activity_date": 1533142307, "creation_date": 1533142307, "answer_id": 51638554, "question_id": 51638246, "link": "https://stackoverflow.com/questions/51638246/measuring-precise-time-in-nanoseconds-c/51638554#51638554", "title": "measuring precise time in nanoseconds C++", "body": "<p>What you're trying to do is not going to work on every platform, or even most platforms. There's a couple of reasons why.</p>\n\n<p>The first, and biggest, reason is that measuring the precise time that code is executed at/within is, by its very nature, imprecise. It requires a black-box OS call to determine, and if you've ever looked at how those calls are implemented in the first place, it's quickly apparent that there's inherent imprecision in the technique. On Windows, this is done by measuring both the current \"tick\" of the processor, and its reported frequency, and multiplying one by the other to determine how many nanoseconds have passed between two successive calls. But Windows only reports with accuracy of Microseconds to begin with, and if the CPU changes its frequency, even if only modestly (which is common in modern CPUs, to lower the frequency when the CPU isn't being maxed out, to save power) that can skew results.</p>\n\n<p>Linux also has similar quirks, and every OS is at the mercy of the CPU's ability to accurately report its own tick counter/tick rate.</p>\n\n<p>The second reason you're going to get results like what you've observed is in the fact that, for similar reasons to the first reason, \"Sleep\"-ing a thread is usually very imprecise. CPUs usually can't sleep with better precision than microsecond precision, and it's often not possible to sleep any faster than half a millisecond at a time. Your particular environment seems to be at least capable of a few hundred microseconds of precision, but it's clearly not more precise than that. Some environments will even drop Nanosecond resolution altogether.</p>\n\n<p>Altogether, it's probably a mistake to presume that, without programming for an explicitly Real-Time OS, using the specific API of that OS, that you can get the kind of precision you're expecting/desiring. If you want reliable information about the timing of individual snippets of code, you'll need to run said code over-and-over, get a sample of the entire execution, and then take the average, to get you a broad idea of the timing for each run. It'll still be imprecise, but it'll help get around these limitations.</p>\n"}, {"tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 1, "last_activity_date": 1533143188, "last_edit_date": 1592644375, "creation_date": 1533143188, "answer_id": 51638767, "question_id": 51638246, "link": "https://stackoverflow.com/questions/51638246/measuring-precise-time-in-nanoseconds-c/51638767#51638767", "title": "measuring precise time in nanoseconds C++", "body": "<p>Here's part of the description of nanosleep:</p>\n<blockquote>\n<p>If the interval specified in req is not an exact multiple of the granularity underlying clock (see time(7)), then the interval will be rounded up to the next multiple.  Furthermore, after the sleep completes, there may still be a delay before the CPU becomes free to once again execute the calling thread.</p>\n</blockquote>\n<p>The behavior you're getting seems to fit pretty well with the description.</p>\n<p>For extremely short pauses, you're probably going to have to do some (most?) of the work on your own. The system clock source will often have a granularity of a microsecond or so.</p>\n<p>One possible way to pause for less than the system clock time would be to measure how often you can execute a loop before the clock changes. During startup (for example) do that a few times, to get a good idea of how many loops you can execute per microsecond.</p>\n<p>Then to pause for some fraction of that time, you can do linear interpolation to guess at a number of times to execute a loop to get about the same length of pause.</p>\n<p>Note: this will generally run the CPU at 100% for the duration of the pause, so you only want to do it for really <em>short</em> pauses--up to a microsecond or two is fine, but if you want much more than that, you probably want to fall back to nanosleep.</p>\n<p>Even with that, however, you need to be aware that a pause could end up substantially longer than you planned. The OS does time slicing. If your process' time slice expires in the middle of your pause loop, it could easily be tens of milliseconds (or more) before it's scheduled to run again.</p>\n<p>If you really need an assurance of response times on this order, you'll probably need to consider another OS (but even that's not a panacea--what you're asking for isn't trivial, regardless of how you approach it).</p>\n<h3>Reference</h3>\n<p><a href=\"http://man7.org/linux/man-pages/man2/nanosleep.2.html\" rel=\"nofollow noreferrer\">nanosleep man page</a></p>\n"}], "owner": {"reputation": 187, "user_id": 299570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8730a2823fa1b4b6cc841e5a63e89abf?s=128&d=identicon&r=PG", "display_name": "rizwanhudda", "link": "https://stackoverflow.com/users/299570/rizwanhudda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 51638554, "answer_count": 2, "score": 1, "last_activity_date": 1533143188, "creation_date": 1533141140, "question_id": 51638246, "link": "https://stackoverflow.com/questions/51638246/measuring-precise-time-in-nanoseconds-c", "title": "measuring precise time in nanoseconds C++", "body": "<p>I wanted to test a way to measure the precise execution time of a piece of code in nanoseconds (accuracy upto 100 nanoseconds is ok) in C++.</p>\n\n<p>I tried using chrono::high_resolution_clock for this purpose. In order to test whether it is working properly or not. I do the following:</p>\n\n<ol>\n<li>Get current time in nanoseconds using high_resolution_clock, call it \"start\"</li>\n<li>sleep for \"x\" nanoseconds using nanosleep(x)</li>\n<li>Get current time in nanoseconds using high_resolution_clock, call it \"end\"</li>\n<li>Now \"end\" - \"start\" should be roughly same as \"x\". Lets call this difference \"diff\"</li>\n</ol>\n\n<p>I ran the above test for x varying from 10 to 1000000. I get the diff to be around 100000 i.e (100 microseconds)</p>\n\n<p>Where as this shouldn't be more than say 100 nanoseconds. Please help me fix this.</p>\n\n<pre><code>#include &lt;ctime&gt;\n#include &lt;unistd.h&gt;\n#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n\nusing namespace std;\n\nint main() {\n    int sleep_ns[] = {10, 50, 100, 500, 1000, 2000, 5000, 10000, 20000, 50000, 100000, 200000, 500000, 1000000};\n    int n = sizeof(sleep_ns)/sizeof(int);\n    for (int i = 0; i &lt; n; i++) {\n        auto start = std::chrono::high_resolution_clock::now();\n        timespec tspec = {0, sleep_ns[i]};\n        nanosleep(&amp;tspec, NULL);\n        auto end = std::chrono::high_resolution_clock::now();\n        chrono::duration&lt;int64_t, nano&gt; dur_ns = (end - start);\n        int64_t measured_ns = dur_ns.count();\n        int64_t diff = measured_ns - sleep_ns[i];\n        cout &lt;&lt; \"diff: \" &lt;&lt; diff\n             &lt;&lt; \" sleep_ns: \" &lt;&lt; sleep_ns[i]\n             &lt;&lt; \" measured_ns: \" &lt;&lt; measured_ns &lt;&lt; endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Following was the output of this code on my machine. Its running \"Ubuntu 16.04.4 LTS\"</p>\n\n<pre><code>diff: 172747 sleep_ns: 10 measured_ns: 172757\ndiff: 165078 sleep_ns: 50 measured_ns: 165128\ndiff: 164669 sleep_ns: 100 measured_ns: 164769\ndiff: 163855 sleep_ns: 500 measured_ns: 164355\ndiff: 163647 sleep_ns: 1000 measured_ns: 164647\ndiff: 162207 sleep_ns: 2000 measured_ns: 164207\ndiff: 160904 sleep_ns: 5000 measured_ns: 165904\ndiff: 155709 sleep_ns: 10000 measured_ns: 165709\ndiff: 145306 sleep_ns: 20000 measured_ns: 165306\ndiff: 115915 sleep_ns: 50000 measured_ns: 165915\ndiff: 125983 sleep_ns: 100000 measured_ns: 225983\ndiff: 115470 sleep_ns: 200000 measured_ns: 315470\ndiff: 115774 sleep_ns: 500000 measured_ns: 615774\ndiff: 116473 sleep_ns: 1000000 measured_ns: 1116473\n</code></pre>\n"}, {"tags": ["c++", "streambuf", "istream-iterator"], "answers": [{"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1533142300, "creation_date": 1533142300, "answer_id": 51638552, "question_id": 51638231, "link": "https://stackoverflow.com/questions/51638231/c-istreambuf-iterator-template-parameter/51638552#51638552", "title": "C++ istreambuf_iterator template parameter", "body": "<p>Yes you can only use the streambuf iterators to read \"characters\", since it gets characters directly from the buffer. There's no formatted input involved which means it can not convert the data.</p>\n"}], "owner": {"reputation": 177, "user_id": 6442455, "user_type": "registered", "profile_image": "https://graph.facebook.com/1152036294848719/picture?type=large", "display_name": "Sean Ian", "link": "https://stackoverflow.com/users/6442455/sean-ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 51638552, "answer_count": 1, "score": 0, "last_activity_date": 1533142300, "creation_date": 1533141076, "question_id": 51638231, "link": "https://stackoverflow.com/questions/51638231/c-istreambuf-iterator-template-parameter", "title": "C++ istreambuf_iterator template parameter", "body": "<p>Based on this question: <a href=\"https://stackoverflow.com/questions/10564013/c-streams-confusion-istreambuf-iterator-vs-istream-iterator\">C++ streams confusion: istreambuf_iterator vs istream_iterator?</a> on <code>istreambuf_iterator</code>, my understanding is that <code>istreambuf_iterator</code> is an iterator for raw input rather than formatted input. In that case, is it correct to assume that the template parameter of <code>istreambuf_iterator</code> can only be those related to <code>char</code>, such as <code>istreambuf_iterator&lt;char&gt;</code>, <code>istreambuf_iterator&lt;wchar_t&gt;</code>, and that something like <code>istreambuf_iterator&lt;int&gt;</code> would be invalid?</p>\n"}, {"tags": ["c++", "visual-studio", "debugging", "dll"], "comments": [{"owner": {"reputation": 1221, "user_id": 6610379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869458e7097eb3f538a64ab550a0aa4b?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Brubaker", "link": "https://stackoverflow.com/users/6610379/phil-brubaker"}, "edited": false, "score": 0, "creation_date": 1533142599, "post_id": 51638200, "comment_id": 90241645, "body": "One technique is to use a Post Build Event to copy associated/related <code>.lib</code> and <code>.dll</code> files to appropriate directories for Debug vs. Release builds.  Example here: <a href=\"https://stackoverflow.com/a/3719097/6610379\">stackoverflow.com/a/3719097/6610379</a>"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1533201390, "post_id": 51638200, "comment_id": 90263122, "body": "&quot;On Debug and Release configurations, I need to specify different link paths for A.lib such that both are linking the right library.&quot; - is that really necessary? As long as the public interfaces both versions expose are the same, either .lib ought to work."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1533201533, "post_id": 51638200, "comment_id": 90263210, "body": "You could also put the .lib paths in an .h file somewhere, with <code>#ifdef DEBUG</code> and <a href=\"https://docs.microsoft.com/en-gb/cpp/preprocessor/comment-c-cpp\" rel=\"nofollow noreferrer\"><code>#pragma comment (lib)</code></a>"}, {"owner": {"reputation": 51483, "user_id": 7460777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938b7ee32587b28c8634edec4a0f90c2?s=128&d=identicon&r=PG&f=1", "display_name": "Leo Liu-MSFT", "link": "https://stackoverflow.com/users/7460777/leo-liu-msft"}, "edited": false, "score": 0, "creation_date": 1533608370, "post_id": 51638200, "comment_id": 90396784, "body": "Any update for this issue? Have you resolved this issue? If not, would you please let me know the latest information about this issue?"}, {"owner": {"reputation": 5606, "user_id": 6601554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d8e70907365c8fce9135ffe1e5868f?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Zhai-MSFT", "link": "https://stackoverflow.com/users/6601554/jack-zhai-msft"}, "edited": false, "score": 0, "creation_date": 1535774040, "post_id": 51638200, "comment_id": 91200423, "body": "@paduraru2009, What bout this issue in your side? If this issue has been resolved, please mark helpful reply as the answer or share your answer here. If not, feel free to share the latest information."}], "answers": [{"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 0, "last_activity_date": 1533201056, "creation_date": 1533201056, "answer_id": 51649813, "question_id": 51638200, "link": "https://stackoverflow.com/questions/51638200/how-to-point-to-the-right-dlls-in-different-visual-studio-configurations/51649813#51649813", "title": "How to point to the right DLLs in different visual studio configurations?", "body": "<p>For building, you don't <em>need</em> the DLL.</p>\n\n<p>When debugging, look at the per-configuration properties of the project, in particular the top-level Debugging entry.</p>\n\n<p>However, you probably don't need <code>PATH</code> anyway. It's only used as a last resort when finding DLL's. The first directory searched is the application directory, and when debugging that will be the <code>x64\\Debug</code> or <code>x64\\Release</code> folder.</p>\n\n<p>I'm not sure what your Python script is doing, but it sounds weird that it's looking for DLLs in a way that's totally unlike Windows.</p>\n"}], "owner": {"reputation": 485, "user_id": 1129574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772ed34b8c5ef8432bd7f766f82176ee?s=128&d=identicon&r=PG", "display_name": "paduraru2009", "link": "https://stackoverflow.com/users/1129574/paduraru2009"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 51649813, "answer_count": 1, "score": 0, "last_activity_date": 1533201056, "creation_date": 1533140996, "question_id": 51638200, "link": "https://stackoverflow.com/questions/51638200/how-to-point-to-the-right-dlls-in-different-visual-studio-configurations", "title": "How to point to the right DLLs in different visual studio configurations?", "body": "<p>Let's say I have a visual studio project using some external code in A.lib and A.dll.   </p>\n\n<p>On Debug and Release configurations, I need to specify different link paths for A.lib such that both are linking the right library. </p>\n\n<p>But how about DLLs? How do I specify them to take higher priority than the PATH system environment variable ?</p>\n\n<p>The point is that I have a python script which uses the PATH env variable to get the release version of the DLL. I just need a way to override this and point to a different path of the DLL in visual studio and DEbug configuration. </p>\n"}, {"tags": ["c++", "template-meta-programming", "boost-hana"], "answers": [{"comments": [{"owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1533142300, "post_id": 51638247, "comment_id": 90241483, "body": "thanks! one more thing to be clear, if the macro were to be written like     ` #define BOOST_HANA_STRING(s) `                `  []{  `                                        <code>return s;</code>                 <code>};  </code> and when i do <code>auto obj = BOOST_HANA_STRING(&quot;123&quot;);</code> <code>constexpr auto s = sizeof(obj());</code> am getting result <code>8</code> which is same as a <code>ptr</code>  been passed, it is because  something got to do with the return type <code>operator()</code> in lambda?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1533142838, "post_id": 51638247, "comment_id": 90241766, "body": "A function can only return a reference to an array or a pointer (decayed array). A lamba will always choose the later. That&#39;s why the struct trick is needed."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": true, "score": 2, "last_activity_date": 1533141144, "creation_date": 1533141144, "answer_id": 51638247, "question_id": 51638182, "link": "https://stackoverflow.com/questions/51638182/finding-the-length-of-a-character-literalsconst-char/51638247#51638247", "title": "Finding the length of a character literals(const char *)", "body": "<blockquote>\n  <p>Detects the length of the <code>const char*</code> at compile time!! how did it happen?</p>\n</blockquote>\n\n<p>Well, it doesn't. It detects the size of a <code>const char[]</code>. You can try it yourself:</p>\n\n<pre><code>const char hello[] = \"world\";\nconst auto size = sizeof(hello)-1;\n</code></pre>\n\n<p>Anything else is sugar.</p>\n\n<blockquote>\n  <p>My question is, how it has got deduced to <code>char [21]</code> [...]?</p>\n</blockquote>\n\n<p>In C++, the type of a string literal is <em>array of cont char of size X</em> where <em>X</em> is appropriately chosen.</p>\n\n<blockquote>\n  <p>Why it only works when I wrapped in struct but not in a free function?</p>\n</blockquote>\n\n<p>It's not about free function vs. struct, it's about macro argument vs. function argument. In <code>#define BOOST_HANA_STRING(s)</code>, <code>return s;</code> returns a string literal. In <code>decltype(auto) get(constcharstar ptr)</code>, <code>return ptr;</code> returns an already decayed <code>const char*</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1533142446, "post_id": 51638419, "comment_id": 90241564, "body": "NathanOliver what that tripped me is though I figure out it is an array of chars I did things like   `  static_assert(std::is_same&lt;decltype(object.get()),char[21]&gt;:&zwnj;&#8203;:value,&quot;&quot;);`   ` static_assert(std::is_same&lt;decltype(object.get()),const char[21]&gt;::value,&quot;&quot;);`   ` static_assert(std::is_same&lt;decltype(object.get()),char const[21]&gt;::value,&quot;&quot;);`  the results are negative, did anything I miss here?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1533142630, "post_id": 51638419, "comment_id": 90241665, "body": "@Explorer_N You are getting a reference to an array so you need <code>std::is_same&lt;decltype(object.get()),const char(&amp;)[21]&gt;::value</code>"}, {"owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1533143158, "post_id": 51638419, "comment_id": 90241921, "body": "NathanOliver,  <code>static_assert(std::is_same&lt;decltype(object.get()),const char(&amp;)[21]&gt;::value,&quot;&quot;)</code>  it failed, also tried (just out of curiousity) <code>std::is_same&lt;decay_t&lt;decltype(object.get())&gt;,const char[21]&gt;::value</code> failed too."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1533143704, "post_id": 51638419, "comment_id": 90242173, "body": "@Explorer_N Are you using my example or yours?  <code>std::is_same&lt;decltype(object.get()),const char(&amp;)[3]&gt;::value</code> works for my example: <a href=\"http://coliru.stacked-crooked.com/a/e88d9e5164850538\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/e88d9e5164850538</a>"}, {"owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1533144207, "post_id": 51638419, "comment_id": 90242403, "body": "NathanOliver, you are right, there was a typo in my subscript value."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 2, "last_activity_date": 1533141778, "creation_date": 1533141778, "answer_id": 51638419, "question_id": 51638182, "link": "https://stackoverflow.com/questions/51638182/finding-the-length-of-a-character-literalsconst-char/51638419#51638419", "title": "Finding the length of a character literals(const char *)", "body": "<p>First lets take a look at exactly what</p>\n\n<pre><code>#define BOOST_HANA_STRING(s)                                                \\\n    (::boost::hana::string_detail::prepare([]{                              \\\n        struct tmp {                                                        \\\n            static constexpr decltype(auto) get() { return s; }             \\\n        };                                                                  \\\n        return tmp{};                                                       \\\n    }()))   \n</code></pre>\n\n<p>is doing.  What it essential does is create an object that has a function that returns the string literal.  If we were to make our own it could look like</p>\n\n<pre><code>struct string_size\n{\n    decltype(auto) get() { return \"12\"; }\n};\n</code></pre>\n\n<p>and if we do</p>\n\n<pre><code>std::cout &lt;&lt; sizeof(string_size().get()); \n</code></pre>\n\n<p>we would get <code>3</code>.  This works becuase a string literal has the type <code>const char[N]</code>, not <code>const char *</code>.  Since it is an array, <code>decltype(auto)</code>, gives us a reference to it and <code>sizeof</code> will display the correct size of the string literal.</p>\n\n<p>Another way you can do this is to use a template function</p>\n\n<pre><code>template &lt;std::size_t N&gt;\nstd::size_t size(const char (&amp;arr)[N]) { return N; }\n</code></pre>\n\n<p>Does the same kind of thing.  We take the array in by reference and since the size of the array is part of the type we can deduce that and return it.</p>\n"}], "owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 51638247, "answer_count": 2, "score": -1, "last_activity_date": 1533141778, "creation_date": 1533140927, "last_edit_date": 1533141167, "question_id": 51638182, "link": "https://stackoverflow.com/questions/51638182/finding-the-length-of-a-character-literalsconst-char", "title": "Finding the length of a character literals(const char *)", "body": "<p>I am not sure about others, but to this day when I want to find out the length of a \ncharacter literals ex:<code>\"somevalue\"</code> I use <code>strlen()</code>, now I've been reading a metaprogramming library <a href=\"http://boostorg.github.io/hana/\" rel=\"nofollow noreferrer\">Hana</a> which I assume would well known in the C++ community, it has some code to deal with string at compile time and then here is a piece of some code </p>\n\n<pre><code>#define BOOST_HANA_STRING(s)                                                \\\n    (::boost::hana::string_detail::prepare([]{                              \\\n        struct tmp {                                                        \\\n            static constexpr decltype(auto) get() { return s; }             \\\n        };                                                                  \\\n        return tmp{};                                                       \\\n    }()))   \n</code></pre>\n\n<p>basically what it does is </p>\n\n<pre><code> auto temp = BOOST_HANA_STRING(\"123\");\n constexpr auto sze = sizeof(temp.get())-1; //mov QWORD PTR [rbp-8], 3\n</code></pre>\n\n<p>Detects the length of the <code>const char *</code> at compile time!! how did it happen? I thought the <code>decltype(auto)</code> kinda did a trick while deducing the  <code>return</code> statement, so I wrote like </p>\n\n<pre><code>template&lt;typename constcharstar&gt;\ndecltype(auto) get(constcharstar ptr) { return ptr; }\nconstexpr auto sze = sizeof(get(\"123\")); //`mov QWORD PTR [rbp-8], 8`(64-bit arch)\n</code></pre>\n\n<p>My guess sucks!!, so to figure out  what the <code>return s</code> is actually being deduced to, I've used the boost's <code>type_index.hpp</code></p>\n\n<pre><code>   auto  G = BOOST_HANA_STRING(\"abcd\");\n   cout&lt;&lt;boost::typeindex::type_id&lt;decltype(G.get())&gt;().raw_name();\n   Result : which prints `A21_c`\n</code></pre>\n\n<p>My intuition says that the <code>const char *</code> is being deduced to an <code>array of 21 char's</code> (I could be wrong though)</p>\n\n<blockquote>\n  <p>Edit : I figured out it is <code>char [21]</code> used <code>pretty_name()</code></p>\n</blockquote>\n\n<p>My question is, how it has got deduced to <code>char [21]</code> and why it only works when I wrapped in <code>struct</code> but not in a free function?</p>\n"}, {"tags": ["c++", "arrays", "reverse"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1533140865, "post_id": 51638149, "comment_id": 90240675, "body": "change <code>int arr[n];</code> to <code>std::vector&lt;int&gt; arr(n);</code>.  VLA&#39;s (<code>int arr[n]</code>) are not standard in C++."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 4, "creation_date": 1533140899, "post_id": 51638149, "comment_id": 90240696, "body": "&quot;<code>cin &gt;&gt; n;     int arr[n] ;</code>&quot; - variable length arrays are <i>not</i> supported by standard C++. Use <code>std::vector</code>."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1533141003, "post_id": 51638149, "comment_id": 90240752, "body": "Are you compiling your code as modern C++ (C++11/C++14/C++17)? Otherwise that <code>begin(arr)</code> has <i>no</i> chance of working."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1533141015, "post_id": 51638149, "comment_id": 90240761, "body": "And once you&#39;ve changed to a <code>std::vector</code>, and if all you want to do is to print the input in reverse, then use the vectors reverse iterators <code>rbegin</code> and <code>rend</code> instead."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1533141417, "post_id": 51638149, "comment_id": 90240990, "body": "&quot;<code>using namespace std;</code>&quot; - bad habit."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1533142751, "post_id": 51638149, "comment_id": 90241720, "body": "Stuff like <code>int arr[n]</code> isn&#39;t valid C++, because <a href=\"https://stackoverflow.com/q/1887097/9254539\">C++ doesn&#39;t have variable length arrays</a>. Your code only compiles because of a GCC non-standard extension. You should use an <code>std::vector</code> instead to make your code portable and avoid blowing out the stack."}], "answers": [{"tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": false, "score": 1, "last_activity_date": 1533150345, "last_edit_date": 1533150345, "creation_date": 1533143798, "answer_id": 51638917, "question_id": 51638149, "link": "https://stackoverflow.com/questions/51638149/no-matching-function-for-call-to-beginint-n/51638917#51638917", "title": "no matching function for call to \u2018begin(int [n])\u2019", "body": "<blockquote>\n  <p>error:no matching function for call to \u2018begin(int [n])\u2019</p>\n</blockquote>\n\n<p>This is because of that you have used <strong>non-standard</strong> <a href=\"https://www.geeksforgeeks.org/variable-length-arrays-in-c-and-c/\" rel=\"nofollow noreferrer\"><strong>Variable Length Array</strong></a>, here:</p>\n\n<pre><code>cin &gt;&gt; n;\nint arr[n] ;\n</code></pre>\n\n<p>Therefore, it's not possible to apply the standard algorithms like <code>std::reverse</code> to this kind of non-standard arrays.</p>\n\n<p>if you change it normal array with a size, like:</p>\n\n<pre><code>const int n = 3;\nint arr[n] ;\n</code></pre>\n\n<p>The code what you wrote is valid and will work. <a href=\"https://www.ideone.com/AaoWmp\" rel=\"nofollow noreferrer\"><strong><kbd>See here</kbd></strong></a></p>\n\n<p>However, now you can not input the size of the array.</p>\n\n<hr>\n\n<blockquote>\n  <p>Whats the best approach?</p>\n</blockquote>\n\n<p>Use <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><strong><code>std::vector</code></strong></a> instead.</p>\n\n<p>Now you also have the option for reverse printing without using <code>std::reverse</code>, but using <code>std::vector::reverse_iterator</code>.(If that's all you wanted)</p>\n\n<p>For instance: <a href=\"https://www.ideone.com/K0strr\" rel=\"nofollow noreferrer\"><strong><kbd>See output here</kbd></strong></a></p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\nint main() \n{\n   int n;\n   std::cin &gt;&gt; n;\n   std::vector&lt;int&gt; arr(n);\n   for(int&amp; ele: arr) std::cin &gt;&gt; ele;\n   //std::reverse(std::begin(arr), std::end(arr));\n   //for(const int ele: arr) std::cout &lt;&lt; ele &lt;&lt; \" \";\n   //or simply\n   std::for_each(arr.rbegin(), arr.rend(),[](const int ele){ std::cout &lt;&lt; ele &lt;&lt; \" \"; });\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9489224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b614a6a7df6bd88642746a192896214a?s=128&d=identicon&r=PG&f=1", "display_name": "nidhisoni", "link": "https://stackoverflow.com/users/9489224/nidhisoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533150345, "creation_date": 1533140786, "last_edit_date": 1533150195, "question_id": 51638149, "link": "https://stackoverflow.com/questions/51638149/no-matching-function-for-call-to-beginint-n", "title": "no matching function for call to \u2018begin(int [n])\u2019", "body": "<p>I tried many things but still, it's giving an error: </p>\n\n<pre><code>no matching function for call to \u2018begin(int [n])\u2019\n</code></pre>\n\n<p>What's the best approach?</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\nint main() \n{\n    int n;\n    cin &gt;&gt; n;\n    int arr[n];\n    for(int i = 0; i &lt; n; i++){\n        cin &gt;&gt; arr[i];\n    }\n    reverse(begin(arr), end(arr));\n    for(int j = 0; j &lt; n; j++){\n        cout &lt;&lt; arr[j] &lt;&lt;\" \";\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 5875, "user_id": 2702398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87402651ed56717034035915b95c1ae0?s=128&d=identicon&r=PG&f=1", "display_name": "oakad", "link": "https://stackoverflow.com/users/2702398/oakad"}, "edited": false, "score": 1, "creation_date": 1533140896, "post_id": 51638116, "comment_id": 90240694, "body": "-- boost::fusion"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 5875, "user_id": 2702398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87402651ed56717034035915b95c1ae0?s=128&d=identicon&r=PG&f=1", "display_name": "oakad", "link": "https://stackoverflow.com/users/2702398/oakad"}, "edited": false, "score": 0, "creation_date": 1533141391, "post_id": 51638116, "comment_id": 90240981, "body": "@oakad Would you mind elaborating how you think this solves the problem?"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1533169635, "creation_date": 1533169635, "answer_id": 51643983, "question_id": 51638116, "link": "https://stackoverflow.com/questions/51638116/automatically-converting-from-tuple-array-to-struct-and-back/51643983#51643983", "title": "Automatically converting from tuple/array to struct... and back?", "body": "<p>A simple way is to use meaningful getter</p>\n\n<pre><code>struct Params\n{\n    double pressure() const { return data[0]; }\n    double&amp; pressure() { return data[0]; }\n\n    double distance() const { return data[1]; }\n    double&amp; distance() { return data[1]; }\n\n    double safetyFactor() const { return data[2]; }\n    double&amp; safetyFactor() { return data[2]; }\n\n    std::array&lt;double, 3&gt; data;\n};\n</code></pre>\n\n<p>So you have both access.</p>\n"}, {"tags": [], "owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "is_accepted": false, "score": 1, "last_activity_date": 1533175463, "creation_date": 1533175463, "answer_id": 51644533, "question_id": 51638116, "link": "https://stackoverflow.com/questions/51638116/automatically-converting-from-tuple-array-to-struct-and-back/51644533#51644533", "title": "Automatically converting from tuple/array to struct... and back?", "body": "<p>What you probably want is a Fusion-adapted sequence:</p>\n\n<pre><code>#include &lt;boost/fusion/adapted.hpp&gt;\n\nBOOST_FUSION_ADAPT_STRUCT(\n    Params,\n    (double, pressure)\n    (double, distance)\n    (double, safetyFractor))\n</code></pre>\n"}], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 51643983, "answer_count": 2, "score": -1, "last_activity_date": 1533175463, "creation_date": 1533140689, "question_id": 51638116, "link": "https://stackoverflow.com/questions/51638116/automatically-converting-from-tuple-array-to-struct-and-back", "title": "Automatically converting from tuple/array to struct... and back?", "body": "<p>I have an application where I am handed a <code>std::array&lt;double, N&gt;</code> where each double is a distinct (and more or less unrelated) parameter. Just for example, they could represent pressure, a distance and a safety factor.</p>\n\n<p>As the number and meaning of these parameters might change over the course of development, I would like to convert this to a less error-prone representation before doing anything else - for example, a struct like this:</p>\n\n<pre><code>struct Params\n{\n  double pressure, distance, safetyFactor;\n};\n</code></pre>\n\n<p>From there on, chances are low that anyone messes up.</p>\n\n<p>Without further assumptions about struct layouts etc., <code>std::memcpy</code> is out of the question (and let's not even think about strict aliasing violations). Manually writing and updating conversion functions would be tedious and prone to introducing errors.</p>\n\n<p>I noticed that you could automatically convert this array (and potentially any tuple) to a matching struct by combining brace initialization with parameter pack expansion:</p>\n\n<pre><code>template&lt;class T, class Array, std::size_t... Is&gt;\nT toTyped_impl(const Array&amp; arr, std::index_sequence&lt;Is...&gt;)\n{\n    return { arr[Is]... };\n}\n\ntemplate&lt;class T&gt;\nT toTyped(std::array&lt;double, T::Dim&gt; arr)\n{\n    return toTyped_impl&lt;T&gt;(arr, std::make_index_sequence&lt;T::Dim&gt;());\n}\n\n\nstruct Params\n{\n  static constexpr unsigned Dim = 3;\n  double pressure, distance, safetyFactor;\n};\n\nParams foo()\n{\n    return toTyped&lt;Params&gt;({1, 2.0, 3});\n}\n</code></pre>\n\n<p>The <code>Dim</code> member is not strictly necessary but is convenient here and also provides insurance against passing an array of the wrong size. Manually ensuring its correctness is easy.</p>\n\n<p><strong>My question:</strong><br>\nIs there a way to go back from the struct to the array representation?</p>\n\n<p>If not, is there another good way to convert from the double array to a more expressive type (that is unlikely to cause problems from changing the used parameters)? I considered indexing the array by enum values but it's suboptimal in every way (need to manually update conversion functions <em>and</em> the enum definition, and possibly also a collection of all these enum values)...</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1533140521, "post_id": 51637953, "comment_id": 90240471, "body": "What are you trying to achieve? Why are you inheriting from <code>std::ostringstream</code>? Are you trying to create class that can only convert to string your struct? If so, there is no need for inheritance."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1533140833, "post_id": 51637953, "comment_id": 90240659, "body": "Disregarding the propriety of inheriting from <code>std::ostringstream</code>, the code appears to be syntactically valid. <a href=\"https://ideone.com/1AGWMh\" rel=\"nofollow noreferrer\">ideone.com/1AGWMh</a>"}, {"owner": {"reputation": 11, "user_id": 5636601, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zXk9sWfd4T4/AAAAAAAAAAI/AAAAAAAAABY/icc9QeSNFqs/photo.jpg?sz=128", "display_name": "Barney Madison", "link": "https://stackoverflow.com/users/5636601/barney-madison"}, "edited": false, "score": 0, "creation_date": 1533143013, "post_id": 51637953, "comment_id": 90241861, "body": "I was trying to compile a certain open source project, following the instructions, in Ubuntu with latest g++, and the build fails because of this error.  I can&#39;t open an issue on their site or contact developers.  Similar questions have been asked and they say to use some type of enable_if pattern."}], "answers": [{"comments": [{"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 2, "creation_date": 1533554536, "post_id": 51692662, "comment_id": 90373588, "body": "<i>This definition will cause ambiguity for any rvalue reference that is convertible to <code>std::ostream</code>.</i> I&#39;d expect that for any compiler with a correct implementation of <a href=\"https://wg21.link/lwg2534\" rel=\"nofollow noreferrer\">LWG 2534</a> (the precise requirement is unimplementable as currently specified, so GCC gets as close to the intent as we can)."}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1533555579, "post_id": 51692662, "comment_id": 90374133, "body": "Thank you pointing this out. It is interesting that &lt;&lt; for ostream&amp;&amp;, which is specified in <a href=\"http://eel.is/c++draft/ostream.rvalue\" rel=\"nofollow noreferrer\">eel.is/c++draft/ostream.rvalue</a> , is neither in <a href=\"https://en.cppreference.com/w/cpp/io/basic_ostream/operator_ltlt(cppreference)\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/basic_ostream/&hellip;</a> , or in <a href=\"http://www.cplusplus.com/reference/ostream/basic_ostream/operator%3C%3C/(cplusplus)\" rel=\"nofollow noreferrer\">cplusplus.com/reference/ostream/basic_ostream/operator%3C%3C&zwnj;&#8203;/&hellip;</a>."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 1, "creation_date": 1533557906, "post_id": 51692662, "comment_id": 90375665, "body": "It&#39;s not at either of those pages because they list the <code>basic_ostream::operator&lt;&lt;</code> <b>member functions</b>, and it&#39;s a non-member. It&#39;s at <a href=\"https://en.cppreference.com/w/cpp/io/basic_ostream/operator_ltlt2\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/basic_ostream/operator_ltlt2</a> with the other non-members, see (3), and at cplusplus.com/reference/ostream/basic_ostream/operator-free (on the C++11 tab)."}], "tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": false, "score": 1, "last_activity_date": 1533556046, "last_edit_date": 1533556046, "creation_date": 1533457523, "answer_id": 51692662, "question_id": 51637953, "link": "https://stackoverflow.com/questions/51637953/what-enable-if-or-other-hint-is-need-for-the-following-overloaded-to-compile/51692662#51692662", "title": "What enable_if or other hint is need for the following overloaded &lt;&lt; to compile?", "body": "<p>This is a bug in GCC. In contrast, the code works flawlessly on clang and Visual Studio.</p>\n\n<p>edit: apparently, according to the standard (see comments), GCC is correct.</p>\n\n<p>The conflict you have is due to the way GCC deals with rvalue references in this case. GCC has the following definition:</p>\n\n<pre><code>template&lt;typename _Ostream, typename _Tp&gt;\ninline\ntypename enable_if&lt;__and_&lt;__not_&lt;is_lvalue_reference&lt;_Ostream&gt;&gt;,\n                   __is_convertible_to_basic_ostream&lt;_Ostream&gt;,\n                   __is_insertable&lt;\n                   __rvalue_ostream_type&lt;_Ostream&gt;,\n                   const _Tp&amp;&gt;&gt;::value,\n                   __rvalue_ostream_type&lt;_Ostream&gt;&gt;::type\n                   operator&lt;&lt;(_Ostream&amp;&amp; __os, const _Tp&amp; __x)\n{ .... }\n</code></pre>\n\n<p>This definition will cause ambiguity for any rvalue reference that is convertible to <code>std::ostream</code>. As a work-around, you can stop using rvalue references for <code>std::ostream</code> and instead write:</p>\n\n<pre><code>struct Memory_type {\n    std::string to_string() const \n    { \n        // Defining a variable avoids passing an rvalue references of St\n        St st;\n        return st &lt;&lt; \"s=\" &lt;&lt; s; \n    }\n    const char* s;\n};\n</code></pre>\n\n<p>This should work on all modern compilers.</p>\n"}, {"tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": false, "score": 2, "last_activity_date": 1533558140, "last_edit_date": 1533558140, "creation_date": 1533554871, "answer_id": 51706579, "question_id": 51637953, "link": "https://stackoverflow.com/questions/51637953/what-enable-if-or-other-hint-is-need-for-the-following-overloaded-to-compile/51706579#51706579", "title": "What enable_if or other hint is need for the following overloaded &lt;&lt; to compile?", "body": "<p>The problem is that since C++11 there is an <code>operator&lt;&lt;</code> overload that works with rvalue ostreams, see <a href=\"http://eel.is/c++draft/ostream.rvalue\" rel=\"nofollow noreferrer\">[ostream.rvalue]</a>. This causes the ambiguity, because <code>St() &lt;&lt; \"s=\"</code> could call the <code>St::operator&lt;&lt;</code> overload, or the [ostream.rvalue] one. That can be solved by making the <code>St::operator&lt;&lt;</code> overload only valid for lvalues, by adding a <code>&amp;</code> ref-qualifier to it:</p>\n\n<pre><code>template&lt;typename Tp&gt; St&amp; operator&lt;&lt;( const Tp&amp; value ) &amp;\n</code></pre>\n\n<p>However, that just reveals a further problem, which is that the expression <code>return St() &lt;&lt; \"s=\" &lt;&lt; s;</code> assumes that the <code>&lt;&lt;</code> operators will return the original type, not the <code>std::ostream&amp;</code> base class (so that it can implicitly  convert from <code>St</code> to <code>std::string</code>, which seems like a questionable design). Returning the derived type is not how ostream operations typically work. Operations on <code>ostream</code> objects usually return a reference to the base class, not the derived type that was passed to it.</p>\n\n<p>The problem can be solved by using an lvalue object instead of trying to write it all as a single expression on an rvalue:</p>\n\n<pre><code>St st;\nst &lt;&lt; \"s=\" &lt;&lt; s;\nreturn st;\n</code></pre>\n\n<p>This works, because <code>return st;</code> sees the original type, not just the <code>ostream</code> base class.</p>\n"}], "owner": {"reputation": 11, "user_id": 5636601, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zXk9sWfd4T4/AAAAAAAAAAI/AAAAAAAAABY/icc9QeSNFqs/photo.jpg?sz=128", "display_name": "Barney Madison", "link": "https://stackoverflow.com/users/5636601/barney-madison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1533558140, "creation_date": 1533140063, "last_edit_date": 1533140490, "question_id": 51637953, "link": "https://stackoverflow.com/questions/51637953/what-enable-if-or-other-hint-is-need-for-the-following-overloaded-to-compile", "title": "What enable_if or other hint is need for the following overloaded &lt;&lt; to compile?", "body": "<p>What is needed to allow the &lt;&lt; overload to work?  t.cxx is:</p>\n\n<pre><code>#include &lt;sstream&gt;\n#include &lt;string&gt;\n\nstruct St : std::ostringstream {\n    template&lt;typename Tp&gt; St&amp; operator&lt;&lt;( const Tp&amp; value ) { return *this; }\n    operator std::string() const { return str(); }\n    friend std::ostream&amp; operator&lt;&lt;( std::ostream&amp; s, const St&amp; ss ) { return \n    s &lt;&lt; ss.str(); }\n};\nstruct Memory_type {\n    std::string to_string() const { return St() &lt;&lt; \"s=\" &lt;&lt; s; }\n    const char* s;\n};\n</code></pre>\n\n<blockquote>\n  <p>g++ t.cxx</p>\n</blockquote>\n\n<pre><code>t.cxx: In member function 'std::__cxx11::string Memory_type::to_string() const':\nt.cxx:10:46: error: ambiguous overload for 'operator&lt;&lt;' (operand types are 'St' and 'const char [3]')\n  std::string to_string() const { return St() &lt;&lt; \"s=\" &lt;&lt; s; }\n                                         ~~~~~^~~~~~~\nt.cxx:5:28: note: candidate: St&amp; St::operator&lt;&lt;(const Tp&amp;) [with Tp = char [3]]\n  template&lt;typename Tp&gt; St&amp; operator&lt;&lt;( const Tp&amp; value ) { return *this; }\n                        ^~~~~~~~\n</code></pre>\n"}, {"tags": ["c++", "arduino", "atmega"], "comments": [{"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1533140691, "post_id": 51637917, "comment_id": 90240570, "body": "Define a new object using an internal StepperX object?"}, {"owner": {"reputation": 1, "user_id": 10166747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c7N7RamcGpU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qzwuRpHe9_e5-odNBfSbAZDpYPCQ/mo/photo.jpg?sz=128", "display_name": "Utriv", "link": "https://stackoverflow.com/users/10166747/utriv"}, "reply_to_user": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1533143904, "post_id": 51637917, "comment_id": 90242264, "body": "Could you paste sample of this? I cant imagine how should it look like."}], "owner": {"reputation": 1, "user_id": 10166747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c7N7RamcGpU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qzwuRpHe9_e5-odNBfSbAZDpYPCQ/mo/photo.jpg?sz=128", "display_name": "Utriv", "link": "https://stackoverflow.com/users/10166747/utriv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533141409, "creation_date": 1533139937, "last_edit_date": 1533141409, "question_id": 51637917, "link": "https://stackoverflow.com/questions/51637917/use-same-object-form-class-in-few-independent-functions", "title": "Use same object form class in few independent functions", "body": "<p>When trying to create my first 3D printer (with electronic and program) I was stopped with problem.</p>\n\n<p>I create big library-class to work with my stepper motors.</p>\n\n<p>My simplified code looks like: </p>\n\n<pre><code>#include \"Config_TIMER.h\"\n#include \"Stepper_Control.h\"\n\nSMotor StepperX(41,40); // Constructor to create new X stepper motor object)\n\nvoid setup(){\nStepperX.MaxSpeed = 11; // set value of object max speed\nInitializeTimer();\n}\n\nvoid loop(){\nStepperX.Move(500);  // move function \n}\n\nISR(TIMER5_COMPA_vect){\n\nTimerTick(); // using one of Steper motor function\n}\n</code></pre>\n\n<p>Now is my problem: All of my function need to use <code>StepperX.MaxSpeed</code> which was determined in <code>setup()</code> function (all other function use value of <code>.MaxSpeed</code> determined by constructor). Is there any easy trick to  connect all function - to use the same object?</p>\n\n<p>Currently all my methods and variables are public.</p>\n"}, {"tags": ["c++", "vector", "compiler-errors"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1533139870, "post_id": 51637823, "comment_id": 90240084, "body": "<code>sir[0].push_back()</code> pushes back nothing. <code>push_back</code>here requires an <code>int</code> to push back. <code>push_back</code> also returns <code>void</code>, so there is no return value to compare <code>i</code> against."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1533140010, "post_id": 51637823, "comment_id": 90240154, "body": "There are more than one ways to fix the compiler problem(s). It&#39;s not clear from our code what you are attempting to do."}, {"owner": {"reputation": 1, "user_id": 10166816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725d85ff3e18ed120bd98a5dbb724101?s=128&d=identicon&r=PG&f=1", "display_name": "B.Botzki", "link": "https://stackoverflow.com/users/10166816/b-botzki"}, "edited": false, "score": 0, "creation_date": 1533140327, "post_id": 51637823, "comment_id": 90240346, "body": "i want to have a 2D int vector"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1533141016, "post_id": 51637823, "comment_id": 90240763, "body": "@B.Botzki Look at your own code carefully -- <code>{whatever_type} sir[NMAX];</code>.  The <code>sir</code> is an array of {whatever_type}.  Then you do this:  <code>sir.</code>.  There is no <code>.</code> operator that can be applied to arrays.  So your issue is <i>not</i> <code>std::vector</code>."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1533141192, "post_id": 51637823, "comment_id": 90240874, "body": "The first problem here is that from the declaration <code>vector &lt;int&gt;sir[NMAX];</code>, <code>sir</code> is an <i>array of vectors</i>, not a single vector. C-style arrays obviously don&#39;t have a <code>push_back()</code> method which is where your compiler error is coming from. You should also ask yourself what <code>i&lt;sir[0].push_back()</code> is supposed to do, <code>push_back</code> expects an argument and returns <code>void</code>"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1533141283, "post_id": 51637823, "comment_id": 90240920, "body": "It would help us give you a better answer if you told us what you want <code>sir</code> to represent and what exactly you are trying to do with it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10166816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725d85ff3e18ed120bd98a5dbb724101?s=128&d=identicon&r=PG&f=1", "display_name": "B.Botzki", "link": "https://stackoverflow.com/users/10166816/b-botzki"}, "edited": false, "score": 0, "creation_date": 1533140224, "post_id": 51637898, "comment_id": 90240291, "body": "I have the same problem."}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1533141169, "post_id": 51637898, "comment_id": 90240854, "body": "<a href=\"https://ideone.com/aAJaUd\" rel=\"nofollow noreferrer\">Seems to work</a> (at least it should compile)"}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 1, "creation_date": 1533141309, "post_id": 51637898, "comment_id": 90240935, "body": "Although there are a couple of things to watch out for now.  <code>NMAX</code> is no longer used, and you may get a segfault if <code>n</code> is greater than <b>or equal to</b> <code>10</code>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1533148289, "post_id": 51637898, "comment_id": 90244592, "body": "A segfault would be fine. It&#39;s all the other possible outcomes of this UB that you need to worry about"}], "tags": [], "owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "is_accepted": false, "score": 1, "last_activity_date": 1533139871, "creation_date": 1533139871, "answer_id": 51637898, "question_id": 51637823, "link": "https://stackoverflow.com/questions/51637823/rquest-for-member-push-back-vectors-c/51637898#51637898", "title": "Rquest for member &#39;push_back&#39; vectors c++", "body": "<p>Either go with arrays or vectors, but there's no reason to mix them.</p>\n\n<p>In addition, it looks like you meant <code>.size()</code> when you do <code>.push_back()</code></p>\n\n<p>Assuming you want vectors, we can make this a 2D vector and fix the <code>.size()</code> mistake:</p>\n\n<pre><code>const int NMAX=10;\nvector &lt;vector&lt;int&gt;&gt; sir;\nvector&lt;int&gt; s(10);\n\nint main()\n{\n    int n, i;\n    cin&gt;&gt;n;\n    for(i=1;i&lt;=n;i++)\n        cin &gt;&gt; s[i];\n    sir.push_back(s);\n    for(i=0;i &lt; sir[0].size();i++)\n        cout&lt;&lt;sir[0][i]&lt;&lt;\" \";\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10166816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725d85ff3e18ed120bd98a5dbb724101?s=128&d=identicon&r=PG&f=1", "display_name": "B.Botzki", "link": "https://stackoverflow.com/users/10166816/b-botzki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1533147562, "creation_date": 1533139629, "last_edit_date": 1533147562, "question_id": 51637823, "link": "https://stackoverflow.com/questions/51637823/rquest-for-member-push-back-vectors-c", "title": "Rquest for member &#39;push_back&#39; vectors c++", "body": "<p>I have this code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\nconst int NMAX=10;\nvector &lt;int&gt;sir[NMAX];\nint s[10];\n\nint main()\n{\n    int n, i;\n    cin&gt;&gt;n;\n    for(i=1;i&lt;=n;i++)\n        cin&gt;&gt;s[i];\n    sir.push_back(s);\n    for(i=0;i&lt;sir[0].push_back();i++)\n        cout&lt;&lt;sir[0][i]&lt;&lt;\" \";\n    return 0;\n}\n</code></pre>\n\n<p>And at line 15 I have an error: </p>\n\n<blockquote>\n  <p>request for a member 'push_back' in 'sir', which is not-class type 'std::vector[10]'.</p>\n</blockquote>\n\n<p>Why do I get this error?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1533139991, "post_id": 51637791, "comment_id": 90240140, "body": "I am not sure if this is the case, but I suspect it being related to the fact, that any integral value can be used in the boolean context (where zero is consider to be false, and anything but zero, is considered to be false), hence, <code>double</code> can be used in such a context, due to being integral, while <code>pair</code> cannot, to not being integral value."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1533140044, "post_id": 51637791, "comment_id": 90240183, "body": "double is considered an integral value?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533140132, "post_id": 51637791, "comment_id": 90240229, "body": "Amended: <code>if (static_cast&lt;bool&gt;(m1))</code> still converts to <code>double</code> live: <a href=\"https://godbolt.org/g/WFaZk8\" rel=\"nofollow noreferrer\">godbolt.org/g/WFaZk8</a>  This surprised me"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1533140457, "post_id": 51637791, "comment_id": 90240434, "body": "@RichardCritten <code>static_cast&lt;bool&gt;(const_cast&lt;const maybe&lt;double&gt;&amp;&gt;(m1))</code>."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1533141127, "post_id": 51637791, "comment_id": 90240826, "body": "@SeanMcAllister As a side note: why do you have a union with only one member? Is there some deeper meaning to this?"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1533145143, "post_id": 51637791, "comment_id": 90242863, "body": "@freakish A union like that will provide properly aligned and sized space for the types it holds, but won&#39;t initialize them.  That lets me use placement new and not require default constructibility."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1533147717, "post_id": 51637791, "comment_id": 90244254, "body": "@SeanMcAllister <code>if (0.0) { &#47;*Something*&#47; }</code> compiled fine for me, on ideone, so I guess that it is, at least, valid in such a context. I am not certain if my wording is correct, or my thought process is correct, hence why I didn&#39;t write an answer.."}], "answers": [{"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533140149, "post_id": 51637952, "comment_id": 90240243, "body": "I guess I didn&#39;t know double was convertible to bool.  I guess bool is an integral type so it does double -&gt; bool directly rather than double -&gt; int -&gt; bool which I guess I had in my head.  I think you&#39;re right, I&#39;ll just rely on the .valid() function I&#39;ve got."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533140151, "post_id": 51637952, "comment_id": 90240246, "body": "If I were you, I&#39;d only keep the bool conversion operator."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533140183, "post_id": 51637952, "comment_id": 90240267, "body": "@SeanMcAllister No, <code>double</code> is an arithmetic type."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533140409, "post_id": 51637952, "comment_id": 90240400, "body": "I actually want to be able to do <code>type val = func_returning_maybe</code> in my programs and have it throw an exception and terminate if it&#39;s invalid, makes file I/O nice and clean."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533140536, "post_id": 51637952, "comment_id": 90240478, "body": "@SeanMcAllister I see your an Haskell fan, why won&#39;t you use another operator? What about <code>func_returning_maybe &gt;&gt; val</code>?"}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533140895, "post_id": 51637952, "comment_id": 90240693, "body": "I&#39;d have to declare the variable separately in that case, no?  I don&#39;t know any other good unary operators to use, * seems like it&#39;d be a little to clever..."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533140950, "post_id": 51637952, "comment_id": 90240714, "body": "Doesn&#39;t shock me. I&#39;d use it."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 1, "last_activity_date": 1533140841, "last_edit_date": 1533140841, "creation_date": 1533140059, "answer_id": 51637952, "question_id": 51637791, "link": "https://stackoverflow.com/questions/51637791/understanding-c-choice-of-conversion-operator/51637952#51637952", "title": "Understanding C++ choice of conversion operator", "body": "<p>As soon as <code>T</code> is convertible to <code>bool</code> (<a href=\"https://stackoverflow.com/a/8591324/5470596\"><code>double</code> is</a>, <code>std::pair</code> is not) your two operators will match and you'll get an ambiguous call, or one may be a better match for some reason.</p>\n\n<p>You should only provide one of the two operators, not both.</p>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 4, "last_activity_date": 1533140165, "creation_date": 1533140165, "answer_id": 51637981, "question_id": 51637791, "link": "https://stackoverflow.com/questions/51637791/understanding-c-choice-of-conversion-operator/51637981#51637981", "title": "Understanding C++ choice of conversion operator", "body": "<p>Whenever you write:</p>\n\n<pre><code>if (x)\n</code></pre>\n\n<p>That is equivalent to having written:</p>\n\n<pre><code>bool __flag(x);\nif (__flag)\n</code></pre>\n\n<p>This is called a contextual conversion to <code>bool</code> (note that it's direct-initialization, so the <code>explicit</code> conversion function is a candidate).</p>\n\n<p>When we do overload resolution on that construction for <code>m0</code>, there's only one valid candidate: <code>explicit operator bool() const</code>.</p>\n\n<p>But when we do overload resolution on that construction for <code>m1</code>, there are two: <code>explicit operator bool() const</code> and <code>operator double&amp;&amp;()</code>, because <code>double</code> is convertible to <code>bool</code>. The latter is a better match because of the extra <code>const</code> qualification on the <code>bool</code> conversion function, even though we have to do an extra <code>double</code> conversion. Hence, it wins. </p>\n\n<p>Would simply remove <code>operator T&amp;&amp;()</code> from your interface, as it doesn't make much sense for this type. </p>\n"}, {"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1533140567, "post_id": 51638064, "comment_id": 90240498, "body": "Can you elaborate on the trailing &amp;s in the conversion operator definitions?  I haven&#39;t seen that syntax before."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 2, "creation_date": 1533140890, "post_id": 51638064, "comment_id": 90240689, "body": "See the section on <b>ref-qualified member functions</b> <a href=\"https://en.cppreference.com/w/cpp/language/member_functions\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1533141056, "post_id": 51638064, "comment_id": 90240790, "body": "Or actually, <a href=\"https://stackoverflow.com/q/8610571/212858\">this question</a> might be more informative."}, {"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1533141254, "post_id": 51638064, "comment_id": 90240902, "body": "@Useless Ah thank you, lets you more precisely define the overload behavior, neat."}], "tags": [], "owner": {"reputation": 588, "user_id": 2133098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCzMG.jpg?s=128&g=1", "display_name": "Taylor Nichols", "link": "https://stackoverflow.com/users/2133098/taylor-nichols"}, "is_accepted": false, "score": 1, "last_activity_date": 1533140945, "last_edit_date": 1533140945, "creation_date": 1533140461, "answer_id": 51638064, "question_id": 51637791, "link": "https://stackoverflow.com/questions/51637791/understanding-c-choice-of-conversion-operator/51638064#51638064", "title": "Understanding C++ choice of conversion operator", "body": "<p>Your <code>operator bool</code> and conversion operator are ambiguous in this design.</p>\n\n<ul>\n<li><p>In the first context, <code>std::pair&lt;int,int&gt;</code> does <em>not</em> cast to <code>bool</code>\nso the explicit bool conversion operator is used.</p></li>\n<li><p>In the second context, <code>double</code> <em>does</em> cast to <code>bool</code> so the <code>T</code>\nconversion operator is used, which returns a <code>double</code>, which then\ncasts to <code>bool</code> implicitly.</p></li>\n</ul>\n\n<p>Note in the second context, you are calling <code>std::move</code> which puts <code>value</code> in a valid but undefined state, which leads to undefined behavior when you cast <code>value</code> to <code>double</code> a second time in the <code>if</code> block.</p>\n\n<p>I'd use a named member function to indicate if it is valid, and modify the conversion operator:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;stdexcept&gt;\n\ntemplate &lt;typename T&gt;\nstruct maybe {\n    maybe()        : valid_(false) {}\n    maybe(T value) : valid_(true)  { new (&amp;value_) T(value); }\n\n    operator T&amp;&amp;() &amp;&amp; { return std::move(value_); } // if rvalue\n    operator T&amp;() &amp; { return value_; } // if lvalue\n    operator const T&amp;() const &amp; { return value_; } // if const lvalue\n\n    bool valid() const { return valid_; }\n\n    T&amp; value() {\n        if (!valid_) {\n            throw std::runtime_error(\"boom\");\n        }\n        return value_;\n    }\n\nprivate:\n    union {\n        T value_;\n    };\n    bool valid_;\n};\n\nint main() {\n    // fine, uses operator bool()\n    maybe&lt;std::pair&lt;int,int&gt;&gt; m0;\n    if (m0.valid()) {\n        std::pair&lt;int,int&gt; p = m0;\n        (void)p;\n    }\n\n    // throws error, uses operator T&amp;&amp;()\n    maybe&lt;double&gt; m1;\n    if (m1.valid()) {\n        double p = m1;\n        (void)p;\n    }\n}   \n</code></pre>\n\n<p>EDIT: The conversion operator should only move from member <code>value_</code> if the <code>maybe</code> object is an rvalue reference. Using <code>&amp;&amp;</code> after a functions signature specializes for this case -- please see <a href=\"https://stackoverflow.com/a/20928086/2133098\">Kerrek SB's answer</a> for more information.</p>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 51637981, "answer_count": 3, "score": 3, "last_activity_date": 1533140945, "creation_date": 1533139531, "question_id": 51637791, "link": "https://stackoverflow.com/questions/51637791/understanding-c-choice-of-conversion-operator", "title": "Understanding C++ choice of conversion operator", "body": "<p>I've got an optional-like class (I can't use optional since it's in C++17).  It contains a (possible) value along with a flag indicating if it's valid.  I've got an explicit bool operator and a conversion operator to get the value out.  The problem is, sometimes C++ will choose the bool operator in an explicitly bool context (an if statement), and other times it won't.  Can anyone help me understand this behavior:</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;stdexcept&gt;\n\ntemplate &lt;typename T&gt;\nstruct maybe {\n    maybe()        : valid_(false) {}\n    maybe(T value) : valid_(true)  { new (&amp;value_) T(value); }\n\n    operator T&amp;&amp;() {\n        return std::move(value());\n    }\n\n    explicit operator bool() const {\n        return valid_;\n    }\n\n    T&amp; value() {\n        if (!valid_) {\n            throw std::runtime_error(\"boom\");\n        }\n        return value_;\n    }\n\nprivate:\n    union {\n        T value_;\n    };\n    bool valid_;\n};\n\n\nint main() {\n    // fine, uses operator bool()\n    maybe&lt;std::pair&lt;int,int&gt;&gt; m0;\n    if (m0) {\n        std::pair&lt;int,int&gt; p = m0;\n        (void)p;\n    }\n\n    // throws error, uses operator T&amp;&amp;()\n    maybe&lt;double&gt; m1;\n    if (m1) {\n        double p = m1;\n        (void)p;\n    }\n}   \n</code></pre>\n"}, {"tags": ["c++", "3d", "formatting", "visualization", "file-format"], "comments": [{"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1533140379, "post_id": 51637787, "comment_id": 90240381, "body": "Could you give an example what this visualization should look like? It&#39;ll be hard to recommend a file format without knowing which capabilities your visualization will require\u2026"}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1533140904, "post_id": 51637787, "comment_id": 90240698, "body": "X3D/VRML perhaps?"}, {"owner": {"reputation": 1111, "user_id": 7119460, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7c9dc795a95074aa66c6cd3e80f25704?s=128&d=identicon&r=PG&f=1", "display_name": "user7119460", "link": "https://stackoverflow.com/users/7119460/user7119460"}, "reply_to_user": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1533141372, "post_id": 51637787, "comment_id": 90240971, "body": "@MichaelKenzel I&#39;ve attached an example from my opengl program"}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1533145815, "post_id": 51637787, "comment_id": 90243235, "body": "gLTF ... perhaps?"}], "owner": {"reputation": 1111, "user_id": 7119460, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7c9dc795a95074aa66c6cd3e80f25704?s=128&d=identicon&r=PG&f=1", "display_name": "user7119460", "link": "https://stackoverflow.com/users/7119460/user7119460"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533141345, "creation_date": 1533139522, "last_edit_date": 1533141345, "question_id": 51637787, "link": "https://stackoverflow.com/questions/51637787/simple-3d-scene-visualisation-data-format", "title": "Simple 3D scene visualisation data format", "body": "<p>My PhD project revoles around simulating the paths of photons through objects of different optical properties. My code has classes which create ccd images etc, but it would be much more useful to be able to create a simple rendering of the 3D objects and the paths the photons take through them.</p>\n\n<p>I've written an opengl system for viewing such a scene, but it would be much better if I could use something much more lightweight where I could simply specify the vertices of an object, and then a photon path as a list of connected vertices.</p>\n\n<p>Exporting all the data and then visualising it in another program isn't ideal, as things like mesh transformations need to be taken into account, and I'd rather avoid exporting several new mesh objects just to import them all into another program.</p>\n\n<p>What I essentially need is to be able to create the three dimensional equivalent of a svg image. Does such a '3D scene' file format with a simple visualiser exist?</p>\n\n<p>I write in C++ on MacOS, though I'd prefer to avoid using a visualisation library. I appreciate that what I'm asking for is rather niece and picky, but that's why I'm asking the internet as someone might have come across a similar need for such a tool.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lg5fu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lg5fu.png\" alt=\"An example of the opengl visualisation\"></a></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1533139363, "post_id": 51637706, "comment_id": 90239808, "body": "1) Not all problems are parallelizable. 2) If this is the question about the performance only, <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> is better place for such a question."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1533139548, "post_id": 51637706, "comment_id": 90239905, "body": "If the code inside the loop depends on the previous loops, then it can&#39;t really be turned into threaded code easily or at all. Threads and parallelism is good only if the data each thread works on is independent of the data the other threads work on."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 2, "creation_date": 1533139638, "post_id": 51637706, "comment_id": 90239950, "body": "The easy way to ensure no other thread modifies data from under you is to not let threads access each other&#39;s data. You <i>copy in</i> the inputs to your threaded functions"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1533139749, "post_id": 51637706, "comment_id": 90240005, "body": "Your code is not an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 7, "user_id": 8898957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72996782b1d7f14d1bc427e9ec361c66?s=128&d=identicon&r=PG", "display_name": "Emirhan G.", "link": "https://stackoverflow.com/users/8898957/emirhan-g"}, "edited": false, "score": 0, "creation_date": 1533140059, "post_id": 51637706, "comment_id": 90240190, "body": "Ok, thank you all, I guess this code can&#39;t be parallelized after all. Should the question be removed or kept intact?@BasileStarynkevitch I made it short and easy enough to read and comprehend, I think, no?"}], "owner": {"reputation": 7, "user_id": 8898957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72996782b1d7f14d1bc427e9ec361c66?s=128&d=identicon&r=PG", "display_name": "Emirhan G.", "link": "https://stackoverflow.com/users/8898957/emirhan-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533139205, "creation_date": 1533139205, "question_id": 51637706, "link": "https://stackoverflow.com/questions/51637706/implementing-thread-in-a-nested-loop-using-c", "title": "Implementing thread in a nested loop using C++", "body": "<p>Background info:</p>\n\n<p>I am trying to make some complex mathematical series calculations, and these calculations end up with either extremely big numbers, exceeding 1000 digits, or numbers that are too precise, having more than 1000 decimal digits. In order to handle mathematical operations between such numbers, I made my own string functions that take 2 numbers as parameter and make the mathematical operations on them digit by digit. Let me provide you some information regarding those functions that I made and their return types, because I think that you will have to understand my code well in order to decide whether or not implementing threads is possible in my case.</p>\n\n<p>string product(string sx, string sy) -> returns product of sx and sy</p>\n\n<p>string smaller_number(string sx, string sy) -> returns the smaller of the two numbers. If the 2 numbers are mathematically equal, the functions returns \"EQUAL\"</p>\n\n<p>Necessary info:</p>\n\n<p>In my code, I'm basically trying to find the square root of 5; I do this by declaring [string root = \"2.\";]. And then, my program goes into a nested loop.\nThe outer loop adds 1 zero at the end of 'root' each turn and its (outer loop's) index corresponds to the index of the decimal digit, and each inner loop is used to increment the last digit of 'root' until (root^2) is equal to 5 or exceeds 5.\nAlso, in my code, the number that will be square rooted is called 'sx', and it's a string.</p>\n\n<p>The reason that I can't figure out how to implement threads on my own is that pretty much everything in my code needs information from something that is above. Here is my code:</p>\n\n<pre><code>    for(int k = 1; k &lt;= precision; k++)// outer loop\n    {\n        root = root + \"0\";\n\n        if(sx_is_decimal) // Don't mind this scope\n        {\n            if(smaller_number(product(root, root), sx) == \"EQUAL\")\n            {\n                return root;\n            }\n        }\n\n        for(int i = 1; smaller_number(sx, product(root, root)) != sx; i++)// inner loop\n        {\n            root.back() = i + '0';\n        }\n        root.back() = (int)root.back() - 1; // Un-does the last execution of the inner loop\n        cout &lt;&lt; endl &lt;&lt; \"Digit \" &lt;&lt; k &lt;&lt; \" done\";\n    }\n</code></pre>\n\n<p>I will also appreciate it if you can suggest some optimizations here. I tried my very best and spent hours in order to optimize my 'product' and 'smaller_number' functions. Also the use of my string functions is a must, I can't use standard integral-types.</p>\n"}, {"tags": ["c++", "c++11", "inheritance", "virtual-functions", "overload-resolution"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10164735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y-KJvMdcpy0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rd1caaTnJqi6zb4x-Q425ZQo68Ag/mo/photo.jpg?sz=128", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10164735/gaurav"}, "edited": false, "score": 0, "creation_date": 1533139801, "post_id": 51637806, "comment_id": 90240035, "body": "I think there is not any condition that name should start from capital letter. Secondly, in derived class both of the versions should be there, and then float is better match than char."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "reply_to_user": {"reputation": 11, "user_id": 10164735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y-KJvMdcpy0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rd1caaTnJqi6zb4x-Q425ZQo68Ag/mo/photo.jpg?sz=128", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10164735/gaurav"}, "edited": false, "score": 0, "creation_date": 1533140038, "post_id": 51637806, "comment_id": 90240181, "body": "Not from a compiler perspective (you could name everything random-cased gibberish and it&#39;d be 100% happy), but from a human perspective it&#39;s the standard convention (open any C++ book or look at any C++ code on Github or Stack Overflow and see). On your second point: what is your question and expected output, then? It seems to me you were expecting to see &quot;derived&quot; but if that&#39;s not the case, what are you asking about?"}, {"owner": {"reputation": 11, "user_id": 10164735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y-KJvMdcpy0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rd1caaTnJqi6zb4x-Q425ZQo68Ag/mo/photo.jpg?sz=128", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10164735/gaurav"}, "edited": false, "score": 0, "creation_date": 1533140630, "post_id": 51637806, "comment_id": 90240525, "body": "I agree with you, as best coding practices goes . My Question is why the output in this case is &quot;base&quot;, why not &quot;derived&quot;?"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "reply_to_user": {"reputation": 11, "user_id": 10164735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y-KJvMdcpy0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rd1caaTnJqi6zb4x-Q425ZQo68Ag/mo/photo.jpg?sz=128", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10164735/gaurav"}, "edited": false, "score": 0, "creation_date": 1533140811, "post_id": 51637806, "comment_id": 90240643, "body": "Ah, I see a little more clearly what&#39;s going on. I&#39;ll try to edit. Thanks."}], "tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": false, "score": 1, "last_activity_date": 1618090655, "last_edit_date": 1618090655, "creation_date": 1533139558, "answer_id": 51637806, "question_id": 51637677, "link": "https://stackoverflow.com/questions/51637677/c-virtual-function-base-class-function-is-called-instead-of-derived/51637806#51637806", "title": "C++ virtual function: Base class function is called instead of derived", "body": "<p>When you declare <code>Base* d = new Derived;</code>, the type of the class is Base, as printed by <code>typeid(d).name()</code>, so this instance doesn't have access to child class methods. If you change the type to Derived, you'll call the child method:</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;typeinfo&gt;\n\nclass Base\n{\n  public:\n    virtual void print(char a) {\n        std::cout &lt;&lt; &quot; Base &quot; &lt;&lt; std::endl;\n    }\n};\n\nclass Derived : public Base\n{\n  public:\n    void print(float a) {\n        std::cout &lt;&lt; &quot; Derived &quot; &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    Derived* d = new Derived;\n    std::cout &lt;&lt; &quot;class type is: &quot; &lt;&lt; typeid(d).name() &lt;&lt; std::endl;\n    d-&gt;print(1.5);\n\n    return 0;\n}\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>class type is: P7Derived\n Derived \n</code></pre>\n<p>Furthermore, declaring the parent class <code>print</code> method <code>virtual</code> doesn't allow an instance of Base to call the child version of <code>print</code> because the child hasn't overridden it (different headers). Creating an instance of Base with <code>Base *d = new Derived;</code> and changing the Derived <code>print</code> method header to <code>void print(char a)</code> in the Derived class would allow you to call the child <code>print</code> method and output <code>Derived</code>, even from an instance of Base, using the <code>virtual</code> keyword.</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;typeinfo&gt;\n\nclass Base\n{\n  public:\n    virtual void print(char a) {\n        std::cout &lt;&lt; &quot; Base &quot; &lt;&lt; std::endl;\n    }\n};\n\nclass Derived : public Base\n{\n  public:\n    void print(char a) {\n        std::cout &lt;&lt; &quot; Derived &quot; &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    Base* d = new Derived;\n    std::cout &lt;&lt; &quot;class type is: &quot; &lt;&lt; typeid(d).name() &lt;&lt; std::endl;\n        d-&gt;print(1.5);\n\n    return 0;\n}\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>class type is: P4Base\n Derived\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1575565523, "post_id": 59199790, "comment_id": 104617875, "body": "&quot;will print&quot;. Not really. Try it."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1575566275, "post_id": 59199790, "comment_id": 104618246, "body": "@n.&#39;pronouns&#39;m. Ah, good catch :-) Completely forgot about shadowing. Will update my answer to take care of this. Thanks."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1575566513, "post_id": 59199790, "comment_id": 104618351, "body": "@n.&#39;pronouns&#39;m. Done."}], "tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1575566493, "last_edit_date": 1575566493, "creation_date": 1575564570, "answer_id": 59199790, "question_id": 51637677, "link": "https://stackoverflow.com/questions/51637677/c-virtual-function-base-class-function-is-called-instead-of-derived/59199790#59199790", "title": "C++ virtual function: Base class function is called instead of derived", "body": "<p>You have not <strong>overridden</strong> the function in the base class, you have <strong>overloaded</strong> it: The version in the derived class takes a <code>float</code> as an argument, and is quite a different beast from the base class method which takes a <code>char</code>. Moreover, the <code>float</code> version in the derived class <strong>shadows</strong> the base class version: The base class version becomes inaccessible for calls on the derived type.</p>\n\n<p>As such, the following code</p>\n\n<pre><code>Derived d;\nd.print('a');\nd.print(1.5);\n</code></pre>\n\n<p>will print</p>\n\n<pre><code>Derived\nDerived\n</code></pre>\n\n<p>because the call is resolved by the compiler to the only version of <code>print()</code> that's available in <code>Derived</code>.</p>\n\n<p>Likewise, when you call <code>d-&gt;print(1.5)</code> through a pointer to <code>Base</code>, the derived class' version is inaccessible to the call: The compiler looks at the base class, sees that there is no <code>print()</code> method defined with a <code>float</code> argument, and converts the argument to <code>char</code> instead. It then calls the only implementation of <code>print(char)</code>, which happens to be supplied by the base class.</p>\n\n<hr>\n\n<p>If you simply change the signature of the <code>print()</code> method in the derived class to match that of the base class, the odd behavior will go away.</p>\n"}], "owner": {"reputation": 11, "user_id": 10164735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y-KJvMdcpy0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rd1caaTnJqi6zb4x-Q425ZQo68Ag/mo/photo.jpg?sz=128", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10164735/gaurav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1618092353, "creation_date": 1533139117, "last_edit_date": 1618092353, "question_id": 51637677, "link": "https://stackoverflow.com/questions/51637677/c-virtual-function-base-class-function-is-called-instead-of-derived", "title": "C++ virtual function: Base class function is called instead of derived", "body": "<p>I have following code snippet:</p>\n<pre><code>class base\n{\npublic:\n    virtual void print(char a){ std::cout &lt;&lt; &quot; Base\\n&quot;; }\n};\n\nclass derived : public base\n{\npublic:\n    void print(float a)  { std::cout &lt;&lt; &quot; Derived\\n&quot;; }\n};\n\nint main() {\n    base* d = new derived;\n    d-&gt;print(1.5);\n}\n</code></pre>\n<p>Output is <code>Base</code>.</p>\n<p>Why is the output coming from the base function and not from the derived one?</p>\n"}, {"tags": ["c++", "regex"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1533138059, "post_id": 51637327, "comment_id": 90239056, "body": "How about <code>instruction \\d((,\\d)*)</code>? (IMHO, this is meant in the cited text.) Though, this leaves still the task to separate the inner matches..."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1533138328, "post_id": 51637327, "comment_id": 90239216, "body": "Though I like reg. expressions in general, I&#39;m not so enthusiastic about usage in C++. This language has enough power to write any parsers in &quot;readable&quot; code with any context dependency beyond what reg. ex. can do (though the code size will surely become a bit larger). ;-) (It&#39;s just an opinion.)"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533138406, "post_id": 51637327, "comment_id": 90239261, "body": "I love regexp, but I hate hardcoded regular expressions - IMO this bad practice. RE should be used as configuration option or as user input. IMO problem here is trying match everything at once instead do constitutive searches."}, {"owner": {"reputation": 1195, "user_id": 1686564, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c053d77cdc343c2d83a379c845592d06?s=128&d=identicon&r=PG", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/1686564/vladimir"}, "edited": false, "score": 0, "creation_date": 1533138429, "post_id": 51637327, "comment_id": 90239283, "body": "I also understood that is what the comment reffered to, but nothing changes, see <a href=\"https://regex101.com/r/DO1hQx/5\" rel=\"nofollow noreferrer\">regex101.com/r/DO1hQx/5</a>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1533138549, "post_id": 51637327, "comment_id": 90239348, "body": "<i>but nothing changes</i>? Now, you get two groups: \t<code>,2,3,4,5</code> and <code>,5</code>. Isn&#39;t it what you were looking for?"}, {"owner": {"reputation": 1195, "user_id": 1686564, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c053d77cdc343c2d83a379c845592d06?s=128&d=identicon&r=PG", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/1686564/vladimir"}, "edited": false, "score": 0, "creation_date": 1533138666, "post_id": 51637327, "comment_id": 90239414, "body": "Actually, I made a regex to match .char(or .byte) directive in assembly, it looks like this ^.char\\s*(-?\\d+|&quot;.*&quot;|&#39;.&#39;|\\w+)(\\s*,\\s*(-?\\d+|&quot;.*&quot;|&#39;.&#39;|\\w+))*$&zwnj;&#8203;, and I need to catch all those arguments split by a comma, (although a comma might appear in one of arguments like &quot;ad,c&quot;). So, what do you guys suggest I should do?"}, {"owner": {"reputation": 1195, "user_id": 1686564, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c053d77cdc343c2d83a379c845592d06?s=128&d=identicon&r=PG", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/1686564/vladimir"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1533138842, "post_id": 51637327, "comment_id": 90239530, "body": "@Scheff I want to extract 1, 2, 3, 4 and 5 but each of them separately. The example catches only the last iteration (,5), I would like to catch (,2), (,3) and (,4) as well"}, {"owner": {"reputation": 1802, "user_id": 3421618, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/TQAL7.jpg?s=128&g=1", "display_name": "ProXicT", "link": "https://stackoverflow.com/users/3421618/proxict"}, "edited": false, "score": 0, "creation_date": 1533138876, "post_id": 51637327, "comment_id": 90239550, "body": "How about <a href=\"https://en.cppreference.com/w/cpp/regex/regex_iterator\" rel=\"nofollow noreferrer\"><code>std::regex_iterator</code></a>?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1533138938, "post_id": 51637327, "comment_id": 90239588, "body": "In such situations, I prefer pure C++ code: <a href=\"https://stackoverflow.com/a/50021308/7478597\">Appetizer</a>. An alternative could be something based on <code>lex</code> and <code>yacc</code> (or <code>flex</code> and <code>bison</code>). I must admit that <code>lex</code> uses reg. expressions as well but they are translated into a state machine implemented in C (and output as source code)."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1533139413, "post_id": 51637327, "comment_id": 90239836, "body": "@Vladimir Is it important to match the numbers only after <code>instruction</code>?"}, {"owner": {"reputation": 1195, "user_id": 1686564, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c053d77cdc343c2d83a379c845592d06?s=128&d=identicon&r=PG", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/1686564/vladimir"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1533139562, "post_id": 51637327, "comment_id": 90239913, "body": "@WiktorStribi\u017cew yeah, I don&#39;t need commas. Actually this answer which was posted looks to solve the problem, don&#39;t you guys agree? <a href=\"https://regex101.com/r/svPWt9/2\" rel=\"nofollow noreferrer\">regex101.com/r/svPWt9/2</a>"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1533139586, "post_id": 51637327, "comment_id": 90239922, "body": "@Vladimir It is a PCRE pattern. Are you using PCRE? All you indicated is that you want to use built-in libraries, right? Please add the regex flavor/library you are using. With PCRE, you can use <a href=\"https://regex101.com/r/svPWt9/4\" rel=\"nofollow noreferrer\"><code>(?:instruction\\s|(?!^)\\G,)\\K\\d+</code></a>, too, but is it helpful <i>for you</i>?"}, {"owner": {"reputation": 1195, "user_id": 1686564, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c053d77cdc343c2d83a379c845592d06?s=128&d=identicon&r=PG", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/1686564/vladimir"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1533140461, "post_id": 51637327, "comment_id": 90240437, "body": "@WiktorStribi\u017cew I need it to work in C++, and it looks like that regex I posted doesn&#39;t work in C++"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1533140804, "post_id": 51637327, "comment_id": 90240639, "body": "See <a href=\"https://stackoverflow.com/a/7257415/3832970\">this post</a> that explains what to do."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533155559, "post_id": 51637327, "comment_id": 90248076, "body": "IMO closing this question was premature. Especially duplicate doesn&#39;t have a good answer, here is <a href=\"https://wandbox.org/permlink/Bgs6YAKv0lee4vyU\" rel=\"nofollow noreferrer\">my solution of the problem</a>."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533156048, "post_id": 51637327, "comment_id": 90248295, "body": "I&#39;ve provided an <a href=\"https://stackoverflow.com/a/51641925/1387438\">answer under a duplicate</a>."}], "owner": {"reputation": 1195, "user_id": 1686564, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c053d77cdc343c2d83a379c845592d06?s=128&d=identicon&r=PG", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/1686564/vladimir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "closed_date": 1533140170, "answer_count": 0, "score": 0, "last_activity_date": 1533139033, "creation_date": 1533137878, "question_id": 51637327, "link": "https://stackoverflow.com/questions/51637327/regex-how-to-capture-all-iterations-of-a-repeating-pattern", "closed_reason": "Duplicate", "title": "Regex - How to capture all iterations of a repeating pattern?", "body": "<p>Take a look at this <a href=\"https://regex101.com/r/DO1hQx/3\" rel=\"nofollow noreferrer\">example</a>, I want to capture not just the last iteration (which is 5), but also 2, 3 and 4. It says here: </p>\n\n<blockquote>\n  <p>A repeated capturing group will only capture the last iteration. Put a capturing group around the repeated group to capture all iterations...</p>\n</blockquote>\n\n<p>but I don't know how to do this. Since I need this in C++, I was looking for a way to get all iterations of capturing group using some regex functions in C++, but I always end up with same groups which the website finds.</p>\n"}, {"tags": ["c++", "c++11", "unique-ptr"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1533167761, "post_id": 51637247, "comment_id": 90251725, "body": "Both are UB, and may so behave differently."}], "answers": [{"comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 3, "creation_date": 1533137924, "post_id": 51637312, "comment_id": 90238962, "body": "You probably can make it work correctly with stack-allocated objects using a no-op deleter...just out of curiosity."}, {"owner": {"reputation": 427, "user_id": 5295448, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2838aad1a1c90ed3bc005987ab71399c?s=128&d=identicon&r=PG&f=1", "display_name": "Raees Rajwani", "link": "https://stackoverflow.com/users/5295448/raees-rajwani"}, "edited": false, "score": 0, "creation_date": 1533138285, "post_id": 51637312, "comment_id": 90239198, "body": "You are right. Running with -O0 is producing an error. However running with <code>volatile std::unique_ptr&lt;int&gt; p(&amp;x);</code> with -O3 still produces no error despite the volatile qualifier which I thought prevents optimizations."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 427, "user_id": 5295448, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2838aad1a1c90ed3bc005987ab71399c?s=128&d=identicon&r=PG&f=1", "display_name": "Raees Rajwani", "link": "https://stackoverflow.com/users/5295448/raees-rajwani"}, "edited": false, "score": 2, "creation_date": 1533138391, "post_id": 51637312, "comment_id": 90239246, "body": "@RaeesRajwani Making <code>p</code> <code>volatile</code> does nothing interesting here."}, {"owner": {"reputation": 427, "user_id": 5295448, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2838aad1a1c90ed3bc005987ab71399c?s=128&d=identicon&r=PG&f=1", "display_name": "Raees Rajwani", "link": "https://stackoverflow.com/users/5295448/raees-rajwani"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533138440, "post_id": 51637312, "comment_id": 90239294, "body": "@LightnessRacesinOrbit I thought the volatile qualifier would prevent p from being optimized out."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 427, "user_id": 5295448, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2838aad1a1c90ed3bc005987ab71399c?s=128&d=identicon&r=PG&f=1", "display_name": "Raees Rajwani", "link": "https://stackoverflow.com/users/5295448/raees-rajwani"}, "edited": false, "score": 2, "creation_date": 1533138518, "post_id": 51637312, "comment_id": 90239337, "body": "@RaeesRajwani That is a massive oversimplification of what <code>volatile</code> does, and it is probably your whole program that is optimised out because it doesn&#39;t do anything. (In the case with the list, this is harder for your compiler to prove so perhaps it doesn&#39;t bother.)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 427, "user_id": 5295448, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2838aad1a1c90ed3bc005987ab71399c?s=128&d=identicon&r=PG&f=1", "display_name": "Raees Rajwani", "link": "https://stackoverflow.com/users/5295448/raees-rajwani"}, "edited": false, "score": 2, "creation_date": 1533138565, "post_id": 51637312, "comment_id": 90239360, "body": "@RaeesRajwani It does but it still doesn&#39;t change the fact that he code doesn&#39;t have to crash.  Undefined behavior means no error need happen."}], "tags": [], "owner": {"reputation": 1802, "user_id": 3421618, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/TQAL7.jpg?s=128&g=1", "display_name": "ProXicT", "link": "https://stackoverflow.com/users/3421618/proxict"}, "is_accepted": true, "score": 1, "last_activity_date": 1533138022, "last_edit_date": 1533138022, "creation_date": 1533137836, "answer_id": 51637312, "question_id": 51637247, "link": "https://stackoverflow.com/questions/51637247/unique-ptr-pointer-being-freed-was-not-allocated-when-emplaced-in-list/51637312#51637312", "title": "Unique_ptr: pointer being freed was not allocated when emplaced in list", "body": "<p>I think what happened is that the variable <code>p</code> in your second example got just optimized away and thus not resulted in a run-time error.</p>\n\n<p>But the error which occurs is clear, it is trying to free a memory which was allocated on a stack. Note that smart pointers are usually used in conjunction with heap allocated memory, not a memory allocated on a stack.</p>\n"}, {"comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 1802, "user_id": 3421618, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/TQAL7.jpg?s=128&g=1", "display_name": "ProXicT", "link": "https://stackoverflow.com/users/3421618/proxict"}, "edited": false, "score": 0, "creation_date": 1533138011, "post_id": 51637321, "comment_id": 90239024, "body": "Sure it does as does my 5.3...what happens when you run the binary?"}, {"owner": {"reputation": 1802, "user_id": 3421618, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/TQAL7.jpg?s=128&g=1", "display_name": "ProXicT", "link": "https://stackoverflow.com/users/3421618/proxict"}, "edited": false, "score": 0, "creation_date": 1533138121, "post_id": 51637321, "comment_id": 90239101, "body": "I didn&#39;t run in because <a href=\"https://godbolt.org\" rel=\"nofollow noreferrer\">godbolt</a> only allows compiling the code but not running it. But even if I ran that, it would throw the same error, as freeing a memory allocated on stack is just a no-no."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1533138127, "post_id": 51637321, "comment_id": 90239105, "body": "That is not a level of indirection."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 1802, "user_id": 3421618, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/TQAL7.jpg?s=128&g=1", "display_name": "ProXicT", "link": "https://stackoverflow.com/users/3421618/proxict"}, "edited": false, "score": 0, "creation_date": 1533138614, "post_id": 51637321, "comment_id": 90239391, "body": "@ProXicT No, you cannot rely on an error/diagnostic here (as shown by the question)."}, {"owner": {"reputation": 1802, "user_id": 3421618, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/TQAL7.jpg?s=128&g=1", "display_name": "ProXicT", "link": "https://stackoverflow.com/users/3421618/proxict"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533138769, "post_id": 51637321, "comment_id": 90239481, "body": "@LightnessRacesinOrbit Yes, you are right. What I meant was that freeing a stack memory can result in anything."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533154671, "post_id": 51637321, "comment_id": 90247678, "body": "@LightnessRacesinOrbit Thank you, Captain Obvious."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533203718, "post_id": 51637321, "comment_id": 90264609, "body": "@bipll If it&#39;s so obvious, why did you claim the exact opposite in your answer? And watch your tone."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1533206370, "post_id": 51637321, "comment_id": 90266252, "body": "Yes, Captain Serious!"}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": -3, "last_activity_date": 1533137868, "creation_date": 1533137868, "answer_id": 51637321, "question_id": 51637247, "link": "https://stackoverflow.com/questions/51637247/unique-ptr-pointer-being-freed-was-not-allocated-when-emplaced-in-list/51637321#51637321", "title": "Unique_ptr: pointer being freed was not allocated when emplaced in list", "body": "<p>I've copied your code and compiled it:</p>\n\n<pre><code>$ g++ omg.cpp &amp;&amp; ./a.exe\nAborted (core dumped)\n</code></pre>\n\n<p>You may try to add another level of indirection:</p>\n\n<pre><code>int main(void) {\n    int x = 5;\n    {\n        std::unique_ptr&lt;int&gt; p(&amp;x);\n    }\n}\n</code></pre>\n\n<p>and see if it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 3, "last_activity_date": 1533138278, "creation_date": 1533138278, "answer_id": 51637442, "question_id": 51637247, "link": "https://stackoverflow.com/questions/51637247/unique-ptr-pointer-being-freed-was-not-allocated-when-emplaced-in-list/51637442#51637442", "title": "Unique_ptr: pointer being freed was not allocated when emplaced in list", "body": "<p>Undefined behaviour can result in anything, from a crash, to an apparently successful run, to Britain voting to leave the European Union (whoops, sorry about that, guys&hellip; it's amazing what a null pointer dereference can do).</p>\n\n<p>Compilers are <em>extremely complicated things</em>. Your program is not a one-to-one mapping of instructions that will be executed by the target computer in sequence; it is a description of roughly how you want the computer to behave. The conversion between the two is highly esoteric and complex. When you go off-piste, you break the language in such a way that the compiler's internal workings &mdash; which are constantly making assumptions and taking shortcuts that it knows it's allowed to do, especially when applying so-called \"optimisations\" &mdash; are broken in unpredictable ways.</p>\n\n<p>This is one of them.</p>\n\n<p>In short, if you are <em>expecting</em> UB to do anything in particular, you have already failed.</p>\n\n<p>It may be possible, by analysing your compiler's source code and the assembly that came out of your build, to determine exactly why your UB behaved as it did in this case. But this would be a long, arduous and ultimately entirely pointless process.</p>\n\n<p>Just don't make smart pointers out of things you didn't dynamically allocate (or, if you really want to for some reason, provide a custom deleter that won't attempt to <code>delete</code> something that wasn't <code>new</code>d). Simple!</p>\n"}], "owner": {"reputation": 427, "user_id": 5295448, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2838aad1a1c90ed3bc005987ab71399c?s=128&d=identicon&r=PG&f=1", "display_name": "Raees Rajwani", "link": "https://stackoverflow.com/users/5295448/raees-rajwani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 51637312, "answer_count": 3, "score": 1, "last_activity_date": 1533138278, "creation_date": 1533137641, "last_edit_date": 1533138097, "question_id": 51637247, "link": "https://stackoverflow.com/questions/51637247/unique-ptr-pointer-being-freed-was-not-allocated-when-emplaced-in-list", "title": "Unique_ptr: pointer being freed was not allocated when emplaced in list", "body": "<p>I have a simple C++ program like so:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;list&gt;\n#include &lt;memory&gt;\n\nint main(void) {\n  std::list&lt;std::unique_ptr&lt;int&gt;&gt; l;\n  int x = 5;\n  // throws runtime error: pointer being freed was not allocated\n  l.emplace_back(&amp;x);\n}\n</code></pre>\n\n<p>When the program is run I obtain the following output:</p>\n\n<p><code>a.out(59842,0x7fffb13d1380) malloc: *** error for object 0x7ffee81489ac: pointer being freed was not allocated\n*** set a breakpoint in malloc_error_break to debug\n[1]    59842 abort      ./a.out</code></p>\n\n<p>This tells me that during the destruction of the list the unique_ptr object that had been created is being destroyed, and during that destruction the pointer to <code>x</code> is being freed when it was never <code>malloc</code>ed.</p>\n\n<p>However I would expect that the same would occur in this situation where a <code>unique_ptr</code> falls out of scope and is <code>destroyed</code>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;list&gt;\n#include &lt;memory&gt;\n\nint main(void) {\n  int x = 5;\n\n  // does not throw runtime error when falling out of scope and being destructed\n  std::unique_ptr&lt;int&gt; p(&amp;x);\n}\n</code></pre>\n\n<p>However when the <code>unique_ptr p</code> above falls out of scope and is destroyed the program runs fine. Why is the first program giving me an error when destroying the <code>unique_ptr</code> but the second one is not? Why does emplacing the <code>unique_ptr</code> in a list cause its destruction to fail? </p>\n"}, {"tags": ["c++", "r", "math", "rcpp"], "comments": [{"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1533137400, "post_id": 51636968, "comment_id": 90238599, "body": "Welcome to Stack Overflow. Can you <a href=\"https://stackoverflow.com/posts/51636968/edit\">edit</a> your post to include the R code you used to determine the correct result?"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 4, "creation_date": 1533137467, "post_id": 51636968, "comment_id": 90238653, "body": "Also, there no fee or tax on indenting code, and it makes it easier for other people to read.  Also ensure you <code>&#47;&#47; [[Rcpp::export]]</code> tags <i>directly</i> precede the function definition."}], "answers": [{"comments": [{"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1533211088, "post_id": 51653025, "comment_id": 90269333, "body": "Very nicely detailed answer. Even with indented code. :)"}, {"owner": {"reputation": 13, "user_id": 10160557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qfx7ieWqmU8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p2N8pthkxI0J2GV_ORZEzH6R_6NQ/mo/photo.jpg?sz=128", "display_name": "PD9154", "link": "https://stackoverflow.com/users/10160557/pd9154"}, "edited": false, "score": 0, "creation_date": 1533220359, "post_id": 51653025, "comment_id": 90275928, "body": "@RalfStubner Forgive my ignorance but the line of code........                 Rcpp::NumericVector xp = sample - theta.........  Where has theta been defined?  Thanks"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 13, "user_id": 10160557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qfx7ieWqmU8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p2N8pthkxI0J2GV_ORZEzH6R_6NQ/mo/photo.jpg?sz=128", "display_name": "PD9154", "link": "https://stackoverflow.com/users/10160557/pd9154"}, "edited": false, "score": 0, "creation_date": 1533222498, "post_id": 51653025, "comment_id": 90277401, "body": "@PD9154 The lambda function <code>f</code> is defined as taking one argument <code>double theta</code>, so I can use it within the function body. The definition starts one line above from the quoted line."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 13, "user_id": 10160557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qfx7ieWqmU8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p2N8pthkxI0J2GV_ORZEzH6R_6NQ/mo/photo.jpg?sz=128", "display_name": "PD9154", "link": "https://stackoverflow.com/users/10160557/pd9154"}, "edited": false, "score": 0, "creation_date": 1533226507, "post_id": 51653025, "comment_id": 90279864, "body": "@PD9154 No, the value of <code>theta</code> is the one that is given when the function <code>f</code> is called within <code>secant</code>"}, {"owner": {"reputation": 13, "user_id": 10160557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qfx7ieWqmU8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p2N8pthkxI0J2GV_ORZEzH6R_6NQ/mo/photo.jpg?sz=128", "display_name": "PD9154", "link": "https://stackoverflow.com/users/10160557/pd9154"}, "edited": false, "score": 0, "creation_date": 1533226532, "post_id": 51653025, "comment_id": 90279878, "body": "@RalfStubner  Therefore is <code>theta</code> taking its values from the <code>Numericvector</code> that has been input into the <code>mlecauchy</code> function hence the <code>[&amp;sample]</code> beside the definition?"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 13, "user_id": 10160557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qfx7ieWqmU8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p2N8pthkxI0J2GV_ORZEzH6R_6NQ/mo/photo.jpg?sz=128", "display_name": "PD9154", "link": "https://stackoverflow.com/users/10160557/pd9154"}, "edited": false, "score": 0, "creation_date": 1533228093, "post_id": 51653025, "comment_id": 90280595, "body": "@PD9154 No, theta takes the successive estimates for the root starting with a and b. See the updated answer for an implementation in R. Hopefully this makes it a bit clearer how lambda functions work in C++. BTW, it is definitely worth starting with modern C++ right away, i.e. C++ &gt;= C++11."}, {"owner": {"reputation": 13, "user_id": 10160557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qfx7ieWqmU8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p2N8pthkxI0J2GV_ORZEzH6R_6NQ/mo/photo.jpg?sz=128", "display_name": "PD9154", "link": "https://stackoverflow.com/users/10160557/pd9154"}, "edited": false, "score": 0, "creation_date": 1533231136, "post_id": 51653025, "comment_id": 90282061, "body": "@RalfStubner Thanks for everything, You&#39;ve been a great help!"}], "tags": [], "owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "is_accepted": true, "score": 2, "last_activity_date": 1533227931, "last_edit_date": 1533227931, "creation_date": 1533210911, "answer_id": 51653025, "question_id": 51636968, "link": "https://stackoverflow.com/questions/51636968/cauchy-distribution-secant-method-c-rcpp-mle-root/51653025#51653025", "title": "Cauchy Distribution Secant Method C++ Rcpp MLE/Root", "body": "<p>With the <code>optimize()</code>function you are directly searching for an extremum of the likelihood. An alternative is to use a root finding algorithm (e.g. the secant method) together with the <em>derivative</em> of the (log-)likelihood. From <a href=\"https://en.wikipedia.org/wiki/Cauchy_distribution#Estimation_of_parameters\" rel=\"nofollow noreferrer\">Wikipedia</a> we get the formula we have to solve. In R this could look like this: </p>\n\n<pre><code>x &lt;- c( 11.262307 , 10.281078 , 10.287090 , 12.734039 ,\n        11.731881 , 8.861998 , 12.246509 , 11.244818 ,\n        9.696278 , 11.557572 , 11.112531 , 10.550190 ,\n        9.018438 , 10.704774 , 9.515617 , 10.003247 ,\n        10.278352 , 9.709630 , 10.963905 , 17.314814)\n\nld &lt;- function(sample, theta){\n  xp &lt;- outer(sample, theta, FUN = \"-\")\n  colSums(xp/(1+xp^2))\n}\nuniroot(ld, sample = x, lower = 0, upper = 20)$root\n#&gt; [1] 10.59724\n</code></pre>\n\n<p>Note that the derivative of the log-likelihood is vectorized on both arguments. This allows for easy plotting:</p>\n\n<pre><code>theta &lt;- seq(0, 20, length=500)\nplot(theta, ld(x, theta), type=\"l\",\n     xlab=expression(theta), ylab=expression(ld(x, theta)))\n</code></pre>\n\n<p><img src=\"https://i.imgur.com/yxx2BjE.png\" alt=\"\"></p>\n\n<p>From this plot we already see that it will be tricky to find the correct starting points for the secant method to work.</p>\n\n<p>Let's move this to C++ (C++11 to be precise):</p>\n\n<pre><code>#include &lt;Rcpp.h&gt;\n// [[Rcpp::plugins(cpp11)]]\n\nRcpp::List secant(const std::function&lt;double(double)&gt;&amp; f, \n              double a, double b, int maxIterations, double epsilon) {\n  double c(0.0);\n  do {\n    c = b * (1 - (1 - a/b) / (1 - f(a)/f(b)));\n    a = b;\n    b = c;\n  } while (maxIterations-- &gt; 0 &amp;&amp; std::abs(a - b) &gt; epsilon);\n  return Rcpp::List::create(Rcpp::Named(\"root\") = c,\n                            Rcpp::Named(\"f.root\") = f(c),\n                            Rcpp::Named(\"converged\") = (maxIterations &gt; 0));\n}\n\n// [[Rcpp::export]]\nRcpp::List mleCauchy(const Rcpp::NumericVector&amp; sample, double a, double b,\n                     int maxIterations = 100, double epsilon = 0.0001) {\n  auto f = [&amp;sample](double theta) {\n    Rcpp::NumericVector xp = sample - theta;\n    xp = xp / (1 + xp * xp);\n    return Rcpp::sum(xp);\n  };\n  return secant(f, a, b, maxIterations, epsilon);\n}\n\n\n/*** R\nx &lt;- c( 11.262307 , 10.281078 , 10.287090 , 12.734039 ,\n        11.731881 , 8.861998 , 12.246509 , 11.244818 ,\n        9.696278 , 11.557572 , 11.112531 , 10.550190 ,\n        9.018438 , 10.704774 , 9.515617 , 10.003247 ,\n        10.278352 , 9.709630 , 10.963905 , 17.314814)\n\nmleCauchy(x, 11, 15)\n#-&gt; does not converge\nmleCauchy(x, 11, 14)\n#-&gt; 10.59721\nmleCauchy(x, mean(x), median(x))\n#-&gt; 10.59721\n*/\n</code></pre>\n\n<p>The <code>secant()</code> function works for any <a href=\"https://en.cppreference.com/w/cpp/utility/functional/function\" rel=\"nofollow noreferrer\"><code>std::function</code></a> that takes a <code>double</code> as argument and returns a <code>double</code>. Such a function is than defined as <a href=\"https://en.cppreference.com/w/cpp/language/lambda\" rel=\"nofollow noreferrer\">lambda function</a> that depends on the provided sample values. As expected one gets the correct root only when starting with values that are close to the correct value.</p>\n\n<p>Lambda functions might be a bit confusing at first sight, but they are very close to what we are used to in R. Here the same algorithm written in R:</p>\n\n<pre><code>secant &lt;- function(f, a, b, maxIterations, epsilon) {\n  for (i in seq.int(maxIterations)) {\n    c &lt;- b * (1 - (1 - a/b) / (1 - f(a)/f(b)))\n    a &lt;- b\n    b &lt;- c\n    if (abs(a - b) &lt;= epsilon)\n      break\n  }\n  list(root = c, f.root = f(c), converged = (i &lt; maxIterations))\n}\n\nmleCauchy &lt;- function(sample, a, b, maxIterations = 100L, epsilon = 0.001) {\n  f &lt;- function(theta) {\n    xp &lt;- sample - theta\n    sum(xp/(1 + xp^2))\n  }\n  secant(f, a, b, maxIterations, epsilon)\n}\n\nx &lt;- c( 11.262307 , 10.281078 , 10.287090 , 12.734039 ,\n        11.731881 , 8.861998 , 12.246509 , 11.244818 ,\n        9.696278 , 11.557572 , 11.112531 , 10.550190 ,\n        9.018438 , 10.704774 , 9.515617 , 10.003247 ,\n        10.278352 , 9.709630 , 10.963905 , 17.314814)\nmleCauchy(x, 11, 12)\n#-&gt; 10.59721\n</code></pre>\n\n<p>The R function <code>f</code> and the lambda function <code>f</code> take the vector <code>sample</code> from the environment where they are defined. In R this happens implicitly, while in C++ we have to explicitly tell that this value should be captured. The numeric <code>theta</code> is the argument supplied when the function is called, i.e. the successive estimates for the root starting with <code>a</code> and <code>b</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 10160557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qfx7ieWqmU8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p2N8pthkxI0J2GV_ORZEzH6R_6NQ/mo/photo.jpg?sz=128", "display_name": "PD9154", "link": "https://stackoverflow.com/users/10160557/pd9154"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 1, "accepted_answer_id": 51653025, "answer_count": 1, "score": -3, "last_activity_date": 1564968533, "creation_date": 1533136793, "last_edit_date": 1564968533, "question_id": 51636968, "link": "https://stackoverflow.com/questions/51636968/cauchy-distribution-secant-method-c-rcpp-mle-root", "title": "Cauchy Distribution Secant Method C++ Rcpp MLE/Root", "body": "<p>I am quite new to C++ and Rcpp integration. I am required to create a program using C++ with R integration to find the MLE/root of a Cauchy Distribution. </p>\n\n<p>Below is my code thus far. </p>\n\n<pre><code>#include &lt;Rcpp.h&gt; \n#include &lt;math.h&gt;\n#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\nusing namespace std;\nusing namespace Rcpp;\n\n// [[Rcpp::export]]\ndouble Cauchy(double x, double y); //Declare Function\ndouble Cauchy(double x,double y)   //Define Function\n{\n    return 1/(M_PI*(1+(pow(x-y,2)))); //write the equation whose roots are to be determined x=chosen y=theta \n}\n\nusing namespace std;\n// [[Rcpp::export]]\n\nint Secant (NumericVector x){\n   NumericVector xvector(x) ; //Input of x vector\n   double eplison= 0.001; //Threshold\n   double a= xvector[3]; //Select starting point\n   double b= xvector[4];//Select end point\n   double c= 0.0; //initial value for c\n   double Theta= 10.6; //median value for theta estimate\n   int noofIter= 0; //Iterations\n   double error = 0.0; \n\n   if (std::abs(Cauchy(a, Theta) &lt;(std::abs(Cauchy(a, Theta))))) {  \n      do {\n         a=b;\n         b=c; \n         error= (b-(Cauchy(b, Theta)))*((a-b)/(Cauchy(a, Theta)-Cauchy(b, Theta))); \n         error= Cauchy(c,Theta); \n         //return number of iterations\n         noofIter++;\n\n      for (int i = 0; i &lt; noofIter; i += 1) {\n         cout &lt;&lt; \"The Value is \" &lt;&lt; c &lt;&lt; endl;\n         cout &lt;&lt; \"The Value is \" &lt;&lt; a &lt;&lt; endl;\n         cout &lt;&lt; \"The Value is \" &lt;&lt; b &lt;&lt; endl;\n         cout &lt;&lt; \"The Value is \" &lt;&lt; Theta &lt;&lt; endl;\n       }\n      } while (std::abs(error)&gt;eplison);\n    }\n\n    cout&lt;&lt;\"\\nThe root of the equation is occurs at \"&lt;&lt;c&lt;&lt;endl;    //print the root\n    cout &lt;&lt; \"The number of iterations is \" &lt;&lt; noofIter;\n    return 0;\n}\n</code></pre>\n\n<p>With a few amendments, the program either goes into a never ending loop or returns a value which is infinitely small. </p>\n\n<p>My understanding of this mathematics is limited. Therefore any help or correction in that would be greatly appreciated. </p>\n\n<p>The X vector that we have been given as an output is </p>\n\n<pre><code>x &lt;- c( 11.262307 , 10.281078 , 10.287090 , 12.734039 ,\n         11.731881 , 8.861998 , 12.246509 , 11.244818 ,\n         9.696278 , 11.557572 , 11.112531 , 10.550190 ,\n         9.018438 , 10.704774 , 9.515617 , 10.003247 ,\n         10.278352 , 9.709630 , 10.963905 , 17.314814)\n</code></pre>\n\n<p>Using previous R code we know that the MLE/Root for this distribution occurs at 10.5935 approx </p>\n\n<p>The code used to obtain this MLE was </p>\n\n<pre><code> optimize(function(theta)-sum(dcauchy(x, location=theta, \n     log=TRUE)),  c(-100,100))\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "pointers", "matrix", "physics", "inverse"], "comments": [{"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1533137010, "post_id": 51636954, "comment_id": 90238372, "body": "So, you&#39;re saying you have a matrix with a lot of zeros and then you divide a vector with elements from the matrix?"}, {"owner": {"reputation": 1, "user_id": 10166553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d526faeceba45f10bae57323e11382e?s=128&d=identicon&r=PG&f=1", "display_name": "SegFault", "link": "https://stackoverflow.com/users/10166553/segfault"}, "reply_to_user": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1533227274, "post_id": 51636954, "comment_id": 90280212, "body": "That&#39;s what I understood studying the inversion routine for sparse matrices, but it doesn&#39;t make much sense to me."}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1533368087, "post_id": 51636954, "comment_id": 90329489, "body": "Why don&#39;t you simply take some distribution of LAPACK and use that, it&#39;s much easier than writing your own code (and possibly faster), not to mention it will force you to optimise the way you store your matrices (assuming they are not stored contiguously right now)."}], "owner": {"reputation": 1, "user_id": 10166553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d526faeceba45f10bae57323e11382e?s=128&d=identicon&r=PG&f=1", "display_name": "SegFault", "link": "https://stackoverflow.com/users/10166553/segfault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533136768, "creation_date": 1533136768, "question_id": 51636954, "link": "https://stackoverflow.com/questions/51636954/numerical-recipes-lubksb-routine-not-working", "title": "Numerical Recipes lubksb routine not working", "body": "<p>Context: I am writing a code in order to solve the Lippmann-Schwinger equation and verify experimental results after using different potentials.\nIn order to do this I have to compute the inverse of a sparse and large matrix. I am using NR routines ludcmp and lubksb but something is not right. After ludcmp the matrix has many zeros and lubksb computes the vector b as b[i]/a[i][j], generating -nan most of the time. I can't understand what I am doing wrong.\nThanks for the help!</p>\n\n<p>Here is the portion of my code daling with matrix inversion.</p>\n\n<pre><code>    //lu decomp algorithm\n    void ludcmp(double **a, int n, int *indx, double d)\n    {\n     int i,imax,j,k;\n     double big,dum,sum,temp;\n      double *vv;    //vv stores the implicit scaling of each row.\n      vv= new double[n];//vector(1,n);\n      d=1.0; //No row interchanges yet.\n\n      for (i=0;i&lt;n;i++) \n      {//Loop over rows to get the implicit scaling information.\n       big=0.0;\n       for (j=0;j&lt;n;j++)\n       if ((temp=fabs(a[i][j])) &gt; big) big=temp;\n       //char const *p = \"Singular matrix in routine ludcmp\"; //\n       if (big == 0.0) std::cout&lt;&lt;(\"Singular matrix in routine ludcmp\");                            \n       //No nonzero largest element.\n       vv[i]=1.0/big; //Save the scaling.\n      }\n\n      for (j=0;j&lt;n;j++)\n      {//This is the loop over columns of Crout\u2019s method.\n       for (i=0;i&lt;j;i++) \n       {//This is equation (2.3.12) except for i=j.\n       sum=a[i][j];\n       for (k=0;k&lt;i;k++) sum -= a[i][k]*a[k][j];\n       a[i][j]=sum;\n       }\n\n       big=0.0;\n       //Initialize for the search for largest pivot element.\n       for (i=j;i&lt;n;i++) \n       {//This is i=j of equation (2.3.12) and i = j+1...N\n        sum=a[i][j];\n        for (k=0;k&lt;j-1;k++)\n        sum -= a[i][k]*a[k][j];\n        a[i][j]=sum;\n        if ( (dum=vv[i]*fabs(sum)) &gt;= big) \n        {//Is the figure of merit for the pivot \n          better than the best so          far?\n         big=dum;\n         imax=i;\n        }\n                         }\n\n       if (j != imax) \n       {//Do we need to interchange rows?\n        for (k=0;k&lt;n;k++) \n        {//Yes, do so...\n         dum=a[imax][k];\n         a[imax][k]=a[j][k];\n         a[j][k]=dum;\n        }\n        d = -d;  //...and change the parity of d.\n        vv[imax]=vv[j]; //Also interchange the scale factor.\n       }\n\n       indx[j]=imax;\n       if (a[j][j] == 0.0) a[j][j]=TINY;\n       /*If the pivot element is zero the matrix is singular \n       (at least to  the precision of the algorithm). \n       For some applications on singular matrices, \n       it is desirable to  substitute TINY for zero.*/\n       if (j != n) \n       {//Now, finally, divide by the pivot element.\n        dum=1.0/(a[j][j]);\n        for (i=j+1;i&lt;n;i++) a[i][j] *= dum;\n       }\n      }\n      //Go back for the next column in the reduction.\n\n        delete[] vv;\n     }\n\n     void lubksb(double **a, int n, int *indx, double b[])\n     {\n      int i,ii=0,ip,j;\n      double sum;\n      //for (i=1;i&lt;n;i++) \n      for (i=0;i&lt;n;i++)\n      {//When ii is set to a positive value, \n      it will become the index of the first nonvanishing \n      element of b.\n       //We now do the forward substitution, equation (2.3.6).\n     //The only new wrinkle is to unscramble\n     //the permutation as we go.\n       ip=indx[i];\n       sum=b[ip];\n       b[ip]=b[i];\n       if (ii)\n       for (j=ii;j&lt;i-1;j++) sum -= a[i][j]*b[j];\n       else if (sum) ii=i;\n       //A nonzero element was encountered, \n       //so from now on we will have to do the sums in the loop above.\n       b[i]=sum;\n      }\n      //for (i=n-2;i&gt;(-1);i--) \n      for (i=n-1;i&gt;=0;i--) \n      {//Now we do the backsubstitution, equation (2.3.7).\n       sum=b[i];\n       for (j=i+1;j&lt;n;j++) sum -= a[i][j]*b[j]; \n       b[i]=sum/a[i][i];\n       //Store a component of the solution vector X.\n      }\n         for(int i=0; i&lt;n; i++) std::cout&lt;&lt; \n     \"b[\"&lt;&lt;i&lt;&lt;\"]= \"&lt;&lt;b[i]&lt;&lt;std::endl;\n     }\n\n\n     //matrix inversion\n\n     void invmat(double **a, double **y, int N, int *indx, double *b,          double d)\n     {\n      ludcmp(a,N,indx,d);\n      std::ofstream oo; oo.open(\"invmattttt.txt\",std::ios::out);\n      oo&lt;&lt; \"after lu dec\" &lt;&lt; std::endl;\n      for(int i=0; i&lt; N; i++)\n         for(int j=0; j&lt;N; j++) oo &lt;&lt; \"a[\"&lt;&lt;i&lt;&lt;\"][\"&lt;&lt;j&lt;&lt;\"]= \" &lt;&lt; a[i][j] &lt;&lt; std::endl;\n      //Decompose the matrix just once.\n      //for(int j=1;j&lt;=N;j++) \n      for(int j=0;j&lt;N;j++)\n      {\n      //Find inverse by columns.\n      //for(int i=1;i&lt;=N;i++) b[i]=0.0;\n      for(int i=0;i&lt;N;i++) b[i]=0.0;\n      b[j]=1.0;\n      lubksb(a,N,indx,b);\n      oo&lt;&lt; \"\\n\\nafter lubksb\" &lt;&lt; std::endl;\n      for(int i=0; i&lt; N; i++)\n         for(int j=0; j&lt;N; j++) oo &lt;&lt;\"a[\"&lt;&lt;i&lt;&lt;\"][\"&lt;&lt;j&lt;&lt;\"]= \" &lt;&lt; a[i][j] &lt;&lt;          std::endl;\n      //for(int i=1;i&lt;N;i++) {y[i][j]=b[i]; std::clog&lt;&lt;i&lt;&lt;std::endl;}          std::clog&lt;&lt;\"hey there\"&lt;&lt;std::endl;\n      for(int i=0;i&lt;(N);i++) {y[i][j]=b[i];}}\n      oo&lt;&lt; \"\\n\\nafter all\" &lt;&lt; std::endl;\n      for(int i=0; i&lt; N; i++)\n         for(int j=0; j&lt;N; j++) oo &lt;&lt; y[i][j] &lt;&lt; std::endl;\n     }\n</code></pre>\n"}, {"tags": ["c++", "linker"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1533136431, "post_id": 51636787, "comment_id": 90237972, "body": "First method is more universal - it will look multiple directories and would support either dynamic or static lib. Also first one will work on different OS, second one only where shared lib have <code>.so</code> extention"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1533137050, "creation_date": 1533137050, "answer_id": 51637057, "question_id": 51636787, "link": "https://stackoverflow.com/questions/51636787/using-l-and-l-flags-vs-giving-library-file-as-input/51637057#51637057", "title": "Using -L and -l flags vs giving library file as input", "body": "<p>The difference is that</p>\n\n<blockquote>\n<pre><code>g++ test.cc -L/my/dir/ -lname\n</code></pre>\n</blockquote>\n\n<p>may succeed even if <code>/my/dir/libname.so</code> does not exist:</p>\n\n<ul>\n<li>It can find <code>libname.so</code> from a system library directory (usually <code>/lib</code>, <code>/usr/lib</code>).</li>\n<li>It can find <code>libname.a</code>, and do static linking.</li>\n</ul>\n\n<p>Furthermore, it allows you to link to multiple libraries from the same directory without repeating the parent directory.</p>\n"}, {"tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1533137534, "creation_date": 1533137534, "answer_id": 51637207, "question_id": 51636787, "link": "https://stackoverflow.com/questions/51636787/using-l-and-l-flags-vs-giving-library-file-as-input/51637207#51637207", "title": "Using -L and -l flags vs giving library file as input", "body": "<p>The first method looks into /my/dir directory for the library file at link time. However  only a short library name <code>libname.so</code> (or whatever it finds according to OS) is written into the image. When the program starts, it will look for the library in some library path, i.e. LD_LIBRARY_PATH on linux. Now you can relocate the executable and the library into different new places and set a correct search path after relocation.</p>\n\n<p>The second method writes the full path of the library into the image: <code>/my/dir/libname.so</code>. When the program starts, it will look for this particular path to get the library. This makes the image non-relocatable, unless the same library path exists in the new environment. The effect is similar to the '-rpath' method.</p>\n"}], "owner": {"reputation": 548, "user_id": 7432927, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/875c26e9002856e5184f08012753f279?s=128&d=identicon&r=PG&f=1", "display_name": "Przemys\u0142aw Czechowski", "link": "https://stackoverflow.com/users/7432927/przemys%c5%82aw-czechowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533137534, "creation_date": 1533136234, "question_id": 51636787, "link": "https://stackoverflow.com/questions/51636787/using-l-and-l-flags-vs-giving-library-file-as-input", "title": "Using -L and -l flags vs giving library file as input", "body": "<p>What's the difference between writing:</p>\n\n<p><code>g++ test.cc -L/my/dir/ -lname</code></p>\n\n<p>and</p>\n\n<p><code>g++ test.cc /my/dir/libname.so</code> ? </p>\n\n<p>Are both correct?</p>\n\n<p>The things that I can think of:</p>\n\n<ol>\n<li>First one is cross platform, g++ from MINGW will look for DLL's</li>\n<li>In the second one we explicitly specify we want dynamic linking</li>\n</ol>\n"}, {"tags": ["c++", "graphics", "iteration", "sfml", "fractals"], "comments": [{"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1533137972, "post_id": 51636708, "comment_id": 90239000, "body": "Shouldn&#39;t the code draw a line from <code>x, y</code> to <code>nx, ny</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 413, "user_id": 6919966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c15d07520b16f9fa9abd46dc750582?s=128&d=identicon&r=PG&f=1", "display_name": "beyond", "link": "https://stackoverflow.com/users/6919966/beyond"}, "is_accepted": false, "score": 0, "last_activity_date": 1533201876, "creation_date": 1533201876, "answer_id": 51650045, "question_id": 51636708, "link": "https://stackoverflow.com/questions/51636708/fractal-tree-branches-not-drawn/51650045#51650045", "title": "Fractal Tree - branches not drawn", "body": "<p>I would advice you to use recursion with a function that 1) draws the current branch (as a line), and then 2) creates two new branches from the current branch. Using global variables doesn't help you either. Looks like you should rethink your approach.</p>\n"}, {"tags": [], "owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "is_accepted": false, "score": 4, "last_activity_date": 1534505481, "creation_date": 1534505481, "answer_id": 51894496, "question_id": 51636708, "link": "https://stackoverflow.com/questions/51636708/fractal-tree-branches-not-drawn/51894496#51894496", "title": "Fractal Tree - branches not drawn", "body": "<p>I share @beyond opinion, I think you're complicating things too much. It will be easier with a different approach. Let's make things easier.</p>\n\n<p>With a recursive function, we can easily understand what should be done each step.\nConsider we start from a <strong>initial point</strong>, then trace a <strong>line</strong> on an <strong>angle</strong> of a given <strong>lenght</strong>, so we need a function like:</p>\n\n<pre><code>void createTreeRecursive(sf::VertexArray &amp;tree, sf::Vector2f point, float angle, float lenght)\n</code></pre>\n\n<p>Where <code>tree</code> will be our line set, which compose the tree itself.</p>\n\n<p>First thing we can do, is to set the first point, which is already known:</p>\n\n<pre><code>// Add first point\ntree.append(sf::Vertex(point, treeColor));\n</code></pre>\n\n<p>Now we need to calculate our next point, to form a line. With simple trigonometric functions we can determine that point:</p>\n\n<pre><code>float newX = point.x + (cos((2.f * PI / 360.f) * angle) * lenght);\nfloat newY = point.y - (sin((2.f * PI / 360.f) * angle) * lenght);  // Caution here! Minus(-) sign because we're drawing upwards\n</code></pre>\n\n<p>So we add this second point, and then split the tree into 2 new branches, each one rotated some certain degrees:</p>\n\n<pre><code>// Add second point\ntree.append(sf::Vertex(nextPoint, treeColor));\n\n// Create sub-tree from 2nd point, rotating +45 degrees (i.e. counterclockwise), reducing lenght of the new branch by 0.6 factor\ncreateTreeRecursive(tree, nextPoint, angle + O, lenght * R);\n\n// Same with the other sub-tree, but rotating -45 (i.e. clockwise)\ncreateTreeRecursive(tree, nextPoint, angle - O, lenght * R);\n</code></pre>\n\n<p>We need a base case for our recursive function, in this case, I choose 3 as minimum lenght:</p>\n\n<pre><code>if (lenght &lt; 3)\n    // End condition, can be modified\n    return;\n</code></pre>\n\n<p>this must be out first check.</p>\n\n<p>So we're done, we only need the initial call:</p>\n\n<pre><code>sf::VertexArray createTree(){\n    // Our tree will be made out of lines\n    sf::VertexArray ret(sf::PrimitiveType::Lines);\n    // Initial point at botton-center(250, 450), with a 90 degrees rotation, first branch lenght 200 \n    createTreeRecursive(ret, sf::Vector2f(250, 450), 90, 200);\n    return ret;\n}\n</code></pre>\n\n<p>And the result is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yCFEG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yCFEG.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Full code</h2>\n\n<pre><code>#include &lt;SFML/Graphics.hpp&gt;\n\nconst double PI = 3.141592;\nconst double R = 0.57;  // Reduction factor\nconst double O = 45;    // Degree rotation each time\nsf::Color treeColor = sf::Color::Blue;\n\nvoid createTreeRecursive(sf::VertexArray &amp;tree, sf::Vector2f point, float angle, float lenght){\n    if (lenght &lt; 3)\n        // End condition, can be modified\n        return;\n\n    // Add first point\n    tree.append(sf::Vertex(point, treeColor));\n    float newX = point.x + (cos((2.f * PI / 360.f) * angle) * lenght);\n    float newY = point.y - (sin((2.f * PI / 360.f) * angle) * lenght);  // Caution here! Minus(-) sign because we're drawing upwards\n    sf::Vector2f nextPoint(newX, newY);\n    // Add second point\n    tree.append(sf::Vertex(nextPoint, treeColor));\n\n    // Create sub-tree from 2nd point, rotating +45 degrees (i.e. counterclockwise), reducing lenght of the new branch by 0.6 factor\n    createTreeRecursive(tree, nextPoint, angle + O, lenght * R);\n\n    // Same with the other sub-tree, but rotating -45 (i.e. clockwise)\n    createTreeRecursive(tree, nextPoint, angle - O, lenght * R);\n}\n\nsf::VertexArray createTree(){\n    // Our tree will be made out of lines\n    sf::VertexArray ret(sf::PrimitiveType::Lines);\n    // Initial point at botton-center(250, 450), with a 90 degrees rotation, first branch lenght 200 \n    createTreeRecursive(ret, sf::Vector2f(250, 450), 90, 200);\n    return ret;\n}\n\nint main()\n{\n    RenderWindow window({ 500, 500 }, \"SFML Tree\", Style::Close);\n\n    auto tree = createTree();\n\n    while (window.isOpen())\n    {\n        for (Event event; window.pollEvent(event);){\n            if (event.type == Event::Closed)\n                window.close();\n        }\n\n        window.clear();\n        window.draw(tree);\n        window.display();\n    }\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10166572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb0b6edf0a83407c18f324f0a7c9c2c1?s=128&d=identicon&r=PG&f=1", "display_name": "helpme_pliz", "link": "https://stackoverflow.com/users/10166572/helpme-pliz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1534505481, "creation_date": 1533135994, "last_edit_date": 1533136686, "question_id": 51636708, "link": "https://stackoverflow.com/questions/51636708/fractal-tree-branches-not-drawn", "title": "Fractal Tree - branches not drawn", "body": "<p>Currently, I'm trying to draw a symmetric binary tree through IFS (Iterated Function Systems):</p>\n\n<p><img src=\"https://i.stack.imgur.com/9mooB.gif\" alt=\"\"></p>\n\n<p>but the result is always only the branch tips:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3MlrI.gif\" alt=\"\">. </p>\n\n<p>I can't figure out what I'm doing wrong or what I'm missing. </p>\n\n<p>This is the IFS: </p>\n\n<p><img src=\"https://i.stack.imgur.com/x2J15.png\" alt=\"here\"></p>\n\n<p>This is my code:</p>\n\n<pre><code>RenderWindow window(VideoMode(480, 640), \"fractals everywhere\");\nCircleShape point(1);\nint chance;\nfloat x, y, w, h, nx, ny, px, py;\n\nvoid SymmetricBinaryTrees()\n{\n    float r = 0.57f;\n    float o = 0.785f;\n\n    chance = rand() % 3;\n\n    switch (chance)\n    {\n    case 0:\n        nx = r * cos(o) * x + (-1 * r * sin(o) * y);\n        ny = r * sin(o) * x + r * cos(o) * y + 1;\n        break;\n    case 1:\n        nx = r * cos(o) * x + r * sin(o) * y;\n        ny = -1 * r * sin(o) * x + r * cos(o) * y + 1;\n        break;\n    case 2:\n        nx = x;\n        ny = y;\n        break;\n    }\n}\n\nvoid nextPoint()\n{\n    SymmetricBinaryTrees();\n\n    x = nx; y = ny;\n}\n\nvoid drawPoint()\n{\n    px = _map(x, -1.078, 1.078f, 0, w); py = _map(y, 0.f, 2.078f, h, 0); // maps the position accordingly\n    point.setPosition(px, py);\n\n    window.draw(point);\n}\n\nint main()\n{\n    srand(time(NULL));\n\n    w = window.getSize().x * 1.f;\n    h = window.getSize().y * 1.f;\n\n    x = 0.f; y = 0.f;\n\n    window.setFramerateLimit(60);\n\n    while (window.isOpen())\n    {\n        Event e;\n\n        while (window.pollEvent(e))\n            if (e.type == Event::Closed) window.close();\n\n        for (int i = 1; i &lt;= 500; i++)\n        {\n            drawPoint();\n            nextPoint();\n        }\n\n        window.display();\n    }\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://ecademy.agnesscott.edu/~lriddle/ifs/pythagorean/symbinarytree.htm\" rel=\"nofollow noreferrer\">This</a> is the website that I'm using for my code.</p>\n\n<p>If anyone could help me or has any idea I'd be very grateful, thank you.</p>\n"}, {"tags": ["c++", "qt", "dll", "qmediaplayer"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10166132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qgx3D.png?s=128&g=1", "display_name": "zrg", "link": "https://stackoverflow.com/users/10166132/zrg"}, "is_accepted": true, "score": 1, "last_activity_date": 1533296381, "creation_date": 1533296381, "answer_id": 51671830, "question_id": 51636660, "link": "https://stackoverflow.com/questions/51636660/qmediaplayer-not-working-in-dll/51671830#51671830", "title": "QMediaPlayer not working in dll", "body": "<p>Qt does not export plug-ins when creating dll.</p>\n\n<p>tst_play_dll.pro</p>\n\n<pre><code>QTDIR = C:/Qt/5.7.1\n\nQT += core multimedia\nCONFIG += c++14\n\nTARGET = tst_play_dll\nTEMPLATE = lib\nCONFIG += dll\n\nHEADERS += \\\n    tst_play_dll.h   \\\n\nSOURCES += \\\n    tst_play_dll.cpp \\\n\nLIBS += \\\n    -L$$QTDIR/plugins/mediaservice                  \\\n        $$QTDIR/plugins/mediaservice/libdsengine.a  \\\n        $$QTDIR/lib/libQt5Widgets.a                 \\\n        -ldxva2 -levr -lmf -lmfplat -lmfuuid -ld3d9 \\\n    -L$$QTDIR/plugins/audio                         \\\n        -lstrmiids                                  \\\n</code></pre>\n\n<p>tst_play_dll.h</p>\n\n<pre><code>#ifndef TST_PLAY_DLL\n#define TST_PLAY_DLL\n\n#include &lt;QtPlugin&gt;\n\nQ_IMPORT_PLUGIN(DSServicePlugin)\n\n#endif // TST_PLAY_DLL\n</code></pre>\n\n<p><strong>Working</strong>.</p>\n"}], "owner": {"reputation": 21, "user_id": 10166132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qgx3D.png?s=128&g=1", "display_name": "zrg", "link": "https://stackoverflow.com/users/10166132/zrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 51671830, "answer_count": 1, "score": 1, "last_activity_date": 1533296381, "creation_date": 1533135856, "question_id": 51636660, "link": "https://stackoverflow.com/questions/51636660/qmediaplayer-not-working-in-dll", "title": "QMediaPlayer not working in dll", "body": "<p>QMediaPlayer statically compilled in exe - works correctly. \nCompilled in dll - does not work. </p>\n\n<p>Qt 5.7.1, <strong>static</strong> build.</p>\n\n<hr>\n\n<p>tst_play_exe.pro</p>\n\n<pre><code>QT += widgets multimedia\nCONFIG += c++14\nTARGET = tst_play_exe\nSOURCES = tst_play_exe.cpp\n</code></pre>\n\n<p>tst_play_exe.cpp</p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;QPushButton&gt;\n#include &lt;QMediaPlayer&gt;\n\nQMediaPlayer ply;\n\nint main(int argc, char *argv[]) {\n    QApplication app(argc, argv);\n    QPushButton btn(\"play\"); btn.resize(100, 30);\n\n    QObject::connect(&amp;btn, &amp;QPushButton::clicked, &amp;ply, &amp;QMediaPlayer::play);\n    ply.setMedia(QUrl::fromLocalFile(\"d:/temp/19/example/example.mp3\"));\n\n    btn.show();\n    return app.exec();\n}// main\n</code></pre>\n\n<p>It <strong>works</strong>.</p>\n\n<hr>\n\n<p>tst_play_dll.pro</p>\n\n<pre><code>QT += core multimedia\nCONFIG += c++14\n\nTARGET = tst_play_dll\nTEMPLATE = lib\nCONFIG += dll\n\nHEADERS += \\\n    tst_play_dll.h   \\\n\nSOURCES += \\\n    tst_play_dll.cpp \\\n</code></pre>\n\n<p>tst_play_dll.h</p>\n\n<pre><code>#ifndef TST_PLAY_DLL\n#define TST_PLAY_DLL\n\n#endif // TST_PLAY_DLL\n</code></pre>\n\n<p>tst_play_dll.cpp</p>\n\n<pre><code>#include &lt;QMediaPlayer&gt;\n#include \"tst_play_dll.h\"\n\n#define VERSION 0\n#define ERR -1000\n#define EXTERN_DLL_EXPORT extern \"C\" __declspec(dllexport)\n\ntypedef long long si64;\ntypedef const char* cstr;\n\nQMediaPlayer *ply = nullptr; /* !!! */\n\nEXTERN_DLL_EXPORT int  version(void) { return VERSION; }\nEXTERN_DLL_EXPORT void initial(void) { if(!ply) { ply = new QMediaPlayer; }}\nEXTERN_DLL_EXPORT void destroy(void) { delete ply; ply = nullptr; }\n\nEXTERN_DLL_EXPORT void open(cstr fnme)\n    { initial(); ply-&gt;setMedia(QUrl::fromLocalFile(QString(fnme))); }\nEXTERN_DLL_EXPORT void play(cstr fnme)\n    {  open(fnme); ply-&gt;play(); }\nEXTERN_DLL_EXPORT void rest(void)    { if(ply) { ply-&gt;pause(); }}\nEXTERN_DLL_EXPORT void cont(void)    { if(ply) { ply-&gt;play();  }}\nEXTERN_DLL_EXPORT void stop(void)    { if(ply) { ply-&gt;stop();  }}\nEXTERN_DLL_EXPORT si64 lgth(void)\n    { return ply == nullptr ? ERR : ply-&gt;duration(); }\n\nEXTERN_DLL_EXPORT cstr lerr(void)\n    { return ply == nullptr ? nullptr : qPrintable(ply-&gt;errorString()); }\n</code></pre>\n\n<p>This does <strong>not</strong> work (err: defaultServiceProvider::requestService(): no service found for - \"org.qt-project.qt.mediaplayer\").</p>\n\n<p>Why? How to fix it?</p>\n"}, {"tags": ["c++", "openmp", "intel", "auto-vectorization"], "comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1533141391, "post_id": 51636450, "comment_id": 90240980, "body": "What does the asm look like?  Doesn&#39;t the <code>OpenMP SIMD LOOP WAS VECTORIZED</code> for the outer loop mean something was vectorized with SIMD?"}, {"owner": {"reputation": 606, "user_id": 4759339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkL09.jpg?s=128&g=1", "display_name": "jan.sende", "link": "https://stackoverflow.com/users/4759339/jan-sende"}, "edited": false, "score": 0, "creation_date": 1533207831, "post_id": 51636450, "comment_id": 90267227, "body": "What do you mean with <i>vectorize</i>? Do you want the compiler to use SIMD instructions? If that is the case, then I don&#39;t think it is possible with your current algorithm, because you are accessing your data in a non-sequential order. (You are jumping in memory as soon as you increment <code>I</code> or <code>j</code>.)"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 2, "creation_date": 1533209213, "post_id": 51636450, "comment_id": 90268137, "body": "Vectorizing the inner loop over <code>k</code> should be no problem for your compiler I think. Did you look at the assembly?"}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1533212405, "post_id": 51636450, "comment_id": 90270250, "body": "When you throw omp simd on a reduction loop without declaring the reduction, you are asking for trouble; certainly there is no point in asking us what will happen.   Perhaps the loop has been discarded as dead code.  We might wish for an option to point out dead code elimination in an opt-report."}, {"owner": {"reputation": 801, "user_id": 646993, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba9f016c1608cbd1257e8c43860f1b?s=128&d=identicon&r=PG&f=1", "display_name": "boraas", "link": "https://stackoverflow.com/users/646993/boraas"}, "reply_to_user": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1533219318, "post_id": 51636450, "comment_id": 90275205, "body": "@tim18: Dead code means, that I should not get the correct result, but I get the correct result, so the loop does not get discarded."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1533325574, "post_id": 51636450, "comment_id": 90321592, "body": "Dead code means the compiler determines it may be skipped without changing results.  In this case you are likely correct, the code is optimized by loop nest interchange so the original inner loop is gone."}], "answers": [{"tags": [], "owner": {"reputation": 801, "user_id": 646993, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba9f016c1608cbd1257e8c43860f1b?s=128&d=identicon&r=PG&f=1", "display_name": "boraas", "link": "https://stackoverflow.com/users/646993/boraas"}, "is_accepted": true, "score": 1, "last_activity_date": 1533225328, "creation_date": 1533225328, "answer_id": 51657783, "question_id": 51636450, "link": "https://stackoverflow.com/questions/51636450/auto-vectorization-of-scalar-product-in-loop/51657783#51657783", "title": "Auto-vectorization of scalar product in loop", "body": "<p>Looking into the assembly really helps. Code is already vectorized. <code>OpenMP SIMD LOOP WAS VECTORIZED</code> takes also care of inner loop in this particular case.</p>\n"}], "owner": {"reputation": 801, "user_id": 646993, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba9f016c1608cbd1257e8c43860f1b?s=128&d=identicon&r=PG&f=1", "display_name": "boraas", "link": "https://stackoverflow.com/users/646993/boraas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 51657783, "answer_count": 1, "score": 0, "last_activity_date": 1533225328, "creation_date": 1533135286, "last_edit_date": 1533224980, "question_id": 51636450, "link": "https://stackoverflow.com/questions/51636450/auto-vectorization-of-scalar-product-in-loop", "title": "Auto-vectorization of scalar product in loop", "body": "<p>I am trying to autovectorize the following loop. In the following we loop with the <code>i-</code> and <code>j-</code>loop over the lower triangle of a matrix. Unfortunetly the vectorization report cannot vectorize (=translate to AVX SIMD instructions) the j- and the k-loop. But I think it is straightforward, because there are no pointer aliases (<code>#pragma ivdep</code> and compiler option <code>-D NOALIAS</code>) and the data (x: 1D-array and p: 1D-array) is aligned to 64 bytes. </p>\n\n<p>It could be, that the <code>if</code>-statement is a problem, but even with the <code>if</code>-free solution (expensive shifting operation and count the sign of a double) the compiler is not able to vectorize this loop. </p>\n\n<pre><code>__assume_aligned(x, 64);\n__assume_aligned(p, 64);\n#pragma omp parallel for simd reduction(+:accum)\nfor ( int i = 1 ; i &lt; N ; i++ ){ // loop over lower triangle (i,j), OpenMP SIMD LOOP WAS VECTORIZED\n    for ( int j = 0 ; j &lt; i ; j++ ){ // &lt;-- remark #25460: No loop optimizations reported\n        double __attribute__((aligned(64))) scalarp = 0.0;\n        #pragma omp simd\n        for ( int k=0 ; k &lt; D ; k++ ){ // &lt;-- remark #25460: No loop optimizations reported\n            // scalar product of \\sum_k x_{i,k} \\cdot x_{j,k}\n            scalarp += x[i*D + k] * x[j*D + k];\n        }\n\n        // Alternative to following if:\n        // accum +=  - ( (long long) floor( - ( scalarp + p[i] + p[j] ) ) &gt;&gt; 63);\n        #pragma ivdep\n        if ( scalarp + p[i] + p[j] &gt;= 0 ){ // check if condition is satisfied\n            accum += 1;\n        }\n    }\n}\n</code></pre>\n\n<p>Does it refer to the problem, that OpenMP starting points for each OpenMP thread are not known until run-time? I thought it this resolves the <code>simd</code> clause and Intels auto-vectorization is aware of that.</p>\n\n<p>Intel Compiler: 18.0.2 20180210</p>\n\n<p>edit: I've looked into the assembly and now it is clear that the code is already vectorized, sorry for boardering all of you.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 3, "creation_date": 1533135138, "post_id": 51636375, "comment_id": 90237089, "body": "Have you tried it?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 6, "creation_date": 1533135183, "post_id": 51636375, "comment_id": 90237122, "body": "You could just split your string <code>&quot;\\xfd&quot; &quot;a&quot;</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1533135415, "post_id": 51636375, "comment_id": 90237306, "body": "@slava that dupe doesn&#39;t answers the question.  The OP is asking how to have the chars <code>&#39;\\xfd&#39;</code> and <code>&#39;a&#39;</code> in a string one after the other."}, {"owner": {"reputation": 1455, "user_id": 1633272, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/dd9f3e112c0bc4646702c18041d2f94d?s=128&d=identicon&r=PG", "display_name": "user1633272", "link": "https://stackoverflow.com/users/1633272/user1633272"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1533135632, "post_id": 51636375, "comment_id": 90237449, "body": "@ThomasJager See updated content."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1533135756, "post_id": 51636375, "comment_id": 90237524, "body": "-1717986919 is 0x99999999 @Osiris you should post it as an answer"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1533135811, "post_id": 51636375, "comment_id": 90237574, "body": "This question <a href=\"https://stackoverflow.com/q/47571520/509868\">here</a> is also close."}, {"owner": {"reputation": 1455, "user_id": 1633272, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/dd9f3e112c0bc4646702c18041d2f94d?s=128&d=identicon&r=PG", "display_name": "user1633272", "link": "https://stackoverflow.com/users/1633272/user1633272"}, "edited": false, "score": 0, "creation_date": 1533136052, "post_id": 51636375, "comment_id": 90237729, "body": "Yes, duplicated with those 2 topics."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1533136187, "post_id": 51636375, "comment_id": 90237820, "body": "probably a better dupe: <a href=\"https://stackoverflow.com/q/31239524/995714\">Tell where escaped hexadecimal ends in a string</a>"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 2, "last_activity_date": 1533136067, "last_edit_date": 1533136067, "creation_date": 1533135727, "answer_id": 51636610, "question_id": 51636375, "link": "https://stackoverflow.com/questions/51636375/how-to-mix-hexadecimal-char-and-normal-char-in-string-literal-in-c/51636610#51636610", "title": "How to mix hexadecimal char and normal char in string literal in C++?", "body": "<p>You will not be able to do so using a hex character literal in a single string.  <a href=\"https://timsong-cpp.github.io/cppwp/lex.ccon#8\" rel=\"nofollow noreferrer\">[lex.ccon]/8</a> states</p>\n\n<blockquote>\n  <p>The escape \\ooo consists of the backslash followed by one, two, or three octal digits that are taken to specify the value of the desired character. <strong>The escape \\xhhh consists of the backslash followed by x followed by one or more hexadecimal digits that are taken to specify the value of the desired character. There is no limit to the number of digits in a hexadecimal sequence.</strong> A sequence of octal or hexadecimal digits is terminated by the first character that is not an octal digit or a hexadecimal digit, respectively. The value of a character literal is implementation-defined if it falls outside of the implementation-defined range defined for char (for character literals with no prefix) or wchar_\u00adt (for character literals prefixed by L). [\u2009Note: If the value of a character literal prefixed by u, u8, or U is outside the range defined for its type, the program is ill-formed. \u2014\u2009end note\u2009]</p>\n</blockquote>\n\n<p><sup>emphasis mine</sup></p>\n\n<p>This means <code>'\\xfda'</code> is considered a single hex character literal since all of its digits are valid hex digits.  What you can do is use multiple string literals that will be concatenated for you to break it up like</p>\n\n<pre><code>unsigned char buff1[] = \"\\xfd\" \"a\";\n</code></pre>\n\n<p>Another option would be to switch to using an octal literal if you want <code>'a'</code> to be part of the string.  That would be <code>\"\\375a\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": true, "score": 2, "last_activity_date": 1533136060, "creation_date": 1533136060, "answer_id": 51636731, "question_id": 51636375, "link": "https://stackoverflow.com/questions/51636375/how-to-mix-hexadecimal-char-and-normal-char-in-string-literal-in-c/51636731#51636731", "title": "How to mix hexadecimal char and normal char in string literal in C++?", "body": "<p>As mentioned by the other answer <code>'\\xfda'</code> is considered as a single hex character literal. To get a string literal with <code>'\\xfd'</code>  and <code>'a'</code> you need to split the string.</p>\n\n<pre><code>\"\\xfd\" \"a\"\n</code></pre>\n\n<p>Adjacent string literal tokens are concatenated, which means that for example <code>\"ab\" \"cd\"</code> is the same as <code>\"abcd\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1533136082, "creation_date": 1533136082, "answer_id": 51636742, "question_id": 51636375, "link": "https://stackoverflow.com/questions/51636375/how-to-mix-hexadecimal-char-and-normal-char-in-string-literal-in-c/51636742#51636742", "title": "How to mix hexadecimal char and normal char in string literal in C++?", "body": "<p>Not possible, as explained well in NathanOliver's answer. But there is also no need you can simply use two literals:</p>\n\n<pre><code>unsigned char buff1[] = \"\\x0f\\x00\"\"15899999999\";\n</code></pre>\n"}], "owner": {"reputation": 1455, "user_id": 1633272, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/dd9f3e112c0bc4646702c18041d2f94d?s=128&d=identicon&r=PG", "display_name": "user1633272", "link": "https://stackoverflow.com/users/1633272/user1633272"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "closed_date": 1533137516, "accepted_answer_id": 51636731, "answer_count": 3, "score": 2, "last_activity_date": 1533136082, "creation_date": 1533135082, "last_edit_date": 1533135553, "question_id": 51636375, "link": "https://stackoverflow.com/questions/51636375/how-to-mix-hexadecimal-char-and-normal-char-in-string-literal-in-c", "closed_reason": "Duplicate", "title": "How to mix hexadecimal char and normal char in string literal in C++?", "body": "<p>Is it possible to mix '\\xfd' and 'a' in a single string literal?\nFor example:</p>\n\n<pre><code>unsigned char buff1[] = \"\\xfda\";\n</code></pre>\n\n<hr>\n\n<pre><code>unsigned char buff1[] = \"\\x0f\\x0015899999999\";\n</code></pre>\n\n<p>VC++2015 reports: </p>\n\n<blockquote>\n  <p>Error C2022   '-1717986919': too big for character</p>\n</blockquote>\n"}, {"tags": ["c++", "qt", "qml"], "comments": [{"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533134217, "post_id": 51635985, "comment_id": 90236434, "body": "<code>qmlRegisterType&lt;test&gt;(&quot;com.mycompany.testing&quot;, 1, 0, &quot;test&quot;);</code> See <a href=\"http://doc.qt.io/qt-5/qtqml-cppintegration-definetypes.html\" rel=\"nofollow noreferrer\">documentation</a>. Note that in your case also <code>qmlRegisterSingletonType</code> is needed (you are exposing some object to QML)."}], "answers": [{"tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1533144303, "creation_date": 1533144303, "answer_id": 51639031, "question_id": 51635985, "link": "https://stackoverflow.com/questions/51635985/qt-connecting-c-and-qml-referenceerror-xxx-is-not-defined/51639031#51639031", "title": "Qt - Connecting C++ and QML - ReferenceError: xxx is not defined", "body": "<p>You have 3 main errors:</p>\n\n<ul>\n<li><p>If you are going to use a .qml from a qresource you should not use <code>QUrl::fromLocalFile()</code> since the qresource is not a local file but virtual. </p></li>\n<li><p><code>testObj</code> is a local variable so it will be eliminated as soon as the function where it was created is finished, one solution is to make <code>testObj</code> a member of the class.</p></li>\n<li><p>And for the last one, the main error, <code>QQuickWidget</code> already has a <code>QQmlEngine</code>, you do not have to create another one.</p></li>\n</ul>\n\n<hr>\n\n<p><strong>*.h</strong></p>\n\n<pre><code>Ui::MainWindow *ui;\ntest testObj;\n</code></pre>\n\n<p><strong>*.cpp</strong></p>\n\n<pre><code>ui-&gt;quickWidget-&gt;setSource(QUrl(\"qrc:/main.qml\"));\nui-&gt;quickWidget-&gt;engine()-&gt;rootContext()-&gt;setContextProperty(\"test\", &amp;testObj);\n</code></pre>\n\n<p>My full test can be found at the following <a href=\"https://github.com/eyllanesc/stackoverflow/tree/master/51635985\" rel=\"nofollow noreferrer\">link</a></p>\n"}], "owner": {"reputation": 33, "user_id": 10165198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46415e36d96cf196f5073aa6293e0cb4?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/10165198/lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 51639031, "answer_count": 1, "score": 0, "last_activity_date": 1533144303, "creation_date": 1533133972, "question_id": 51635985, "link": "https://stackoverflow.com/questions/51635985/qt-connecting-c-and-qml-referenceerror-xxx-is-not-defined", "title": "Qt - Connecting C++ and QML - ReferenceError: xxx is not defined", "body": "<p>I am new to Qt and am currently trying to connect a c++ part of my program with the qml part. The goal of th connection is to pass the currently selected item of a TreeView to qml (possibly via on_treeView_doubleClicked). Since that didnt work I tried all the suggested connections on here for a very basic programm, but I am always receiving the following error:</p>\n\n<p><code>file::/main.qml:10: ReferenceError: test is not defined</code></p>\n\n<p>This is the piece of my code regarding the connection:</p>\n\n<p>test.h:</p>\n\n<pre><code>#ifndef TEST_H\n#define TEST_H\n\n#include &lt;QObject&gt;\n#include &lt;QDebug&gt;\n\nclass test : public QObject\n{\n    Q_OBJECT\npublic:\n    explicit test(QObject *parent = nullptr);\n    Q_INVOKABLE void testFunc();\n\nsignals:\n\npublic slots:\n};\n\n#endif // TEST_H\n</code></pre>\n\n<p>test.cpp:</p>\n\n<pre><code>#include \"test.h\"\n\ntest::test(QObject *parent) : QObject(parent)\n{\n\n}\n\nvoid test::testFunc()\n{\n    qDebug() &lt;&lt;  \"Hello from C++!\";\n}\n</code></pre>\n\n<p>mainwindow.cpp:</p>\n\n<pre><code>test testObj;\nQQmlApplicationEngine engine;\nui-&gt;quickWidget-&gt;setSource(QUrl::fromLocalFile(\":/main.qml\"));\n\nengine.rootContext()-&gt;setContextProperty(\"test\", &amp;testObj);\n</code></pre>\n\n<p>main.qml:</p>\n\n<pre><code>import QtQuick 2.0\nimport QtQuick.Window 2.3\n\nItem {\n    Timer{\n        id: timer\n        interval: 1000; running: true; repeat:true\n        onTriggered:{\n            console.log(\"ex\")\n            test.testFunc();\n        }\n    }\n}\n</code></pre>\n\n<p>I would be really thankful for any help (not only for the simple programm, but possibly for passing the currently selected item of my treeView). I know there a a couple suggestions in other threads, but they dont seem to work for me, so please dont mark this as duplicate.</p>\n\n<p>Thanks in advance,</p>\n\n<p>Lucas</p>\n"}, {"tags": ["c++", "qt", "cppcheck"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1533134014, "post_id": 51635959, "comment_id": 90236291, "body": "Show the declaration of the function in which this code is located. What&#39;s its return type?"}, {"owner": {"reputation": 12853, "user_id": 356726, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PhH4C.gif?s=128&g=1", "display_name": "Horst Walter", "link": "https://stackoverflow.com/users/356726/horst-walter"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1533134315, "post_id": 51635959, "comment_id": 90236500, "body": "updated as requested"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "edited": false, "score": 2, "creation_date": 1533134500, "post_id": 51635959, "comment_id": 90236646, "body": "&quot;why an auto variable would be returned&quot;, because <code>directories</code> is a local object. I don&#39;t understand the &quot;reference part&quot; either. The return type of the lambda should be <code>FilePerApplication</code>, it seems Cppcheck thinks it&#39;s <code>FilePerApplication&amp;</code>."}, {"owner": {"reputation": 4795, "user_id": 683905, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7bc5b9f8f9c6f0e5d25b2d88e2cc1386?s=128&d=identicon&r=PG", "display_name": "Jaa-c", "link": "https://stackoverflow.com/users/683905/jaa-c"}, "edited": false, "score": 1, "creation_date": 1533142312, "post_id": 51635959, "comment_id": 90241492, "body": "Generally, cppcheck doesn&#39;t do very well with lambdas. You can expect these types of false positives. The <code>auto</code> here means the variable has automatic storage. If I had to wildly guess, the reference comes from the method&#39;s signature... it just doesn&#39;t parse the lambda and thinks the return statement belongs to the method...."}], "owner": {"reputation": 12853, "user_id": 356726, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PhH4C.gif?s=128&g=1", "display_name": "Horst Walter", "link": "https://stackoverflow.com/users/356726/horst-walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1533412622, "creation_date": 1533133886, "last_edit_date": 1533412622, "question_id": 51635959, "link": "https://stackoverflow.com/questions/51635959/reason-for-failed-cppcheck-reference-to-auto-variable-returned", "title": "Reason for failed Cppcheck &quot;Reference to auto variable returned&quot;?", "body": "<p>I see the following <code>Cppcheck</code>, but do not understand why I am getting it:</p>\n\n<p><code>directoryutils.cpp 173 error   returnReference false   Reference to auto variable returned.</code></p>\n\n<p>Neither I understand why an <code>auto</code> variable would be returned, nor the \"reference part\". Is that a false positive?</p>\n\n<p>header: <code>static const FilePerApplication &amp;applicationDataDirectoryMapWithoutCurrentVersion();</code></p>\n\n<pre><code>const CDirectoryUtils::FilePerApplication &amp;CDirectoryUtils::applicationDataDirectoryMapWithoutCurrentVersion()\n{\n  static const FilePerApplication dirs = [ = ] {\n      FilePerApplication directories;\n      for (const QFileInfo &amp;info : CDirectoryUtils::applicationDataDirectories())\n      {\n        .... fill in data ....\n        directories.insert(info.filePath(), appInfo);\n      }\n      return directories; // LINE 173 why auto???\n  }();\n\n  return dirs;\n}\n</code></pre>\n\n<ol>\n<li>Remark: <code>using FilePerApplication = QMap&lt;QString, CApplicationInfo&gt;;</code></li>\n<li>Remark: Also giving it an explicit return type <code>-&gt; FilePerApplication</code> like here <a href=\"https://stackoverflow.com/a/9620143/356726\">https://stackoverflow.com/a/9620143/356726</a> does not silence the check error</li>\n</ol>\n"}, {"tags": ["c++", "graphics", "iteration", "sfml", "fractals"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1533134113, "post_id": 51635892, "comment_id": 90236361, "body": "Please don\u2019t post code as images. It\u2019s text so include it in the question and format it accordingly"}, {"owner": {"reputation": 1, "user_id": 10166231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3e281783a80e34b7a7ab0c4f2ccd3e3?s=128&d=identicon&r=PG&f=1", "display_name": "fractals_are_lit", "link": "https://stackoverflow.com/users/10166231/fractals-are-lit"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1533134606, "post_id": 51635892, "comment_id": 90236713, "body": "ok i edited it&#39;s there now"}, {"owner": {"reputation": 2213, "user_id": 1034248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/be63e5221accb92b50f75ad083fe3e65?s=128&d=identicon&r=PG", "display_name": "Lukas", "link": "https://stackoverflow.com/users/1034248/lukas"}, "edited": false, "score": 0, "creation_date": 1533479239, "post_id": 51635892, "comment_id": 90351739, "body": "You&#39;re only drawing points. Do you understand how the current actually works?"}], "owner": {"reputation": 1, "user_id": 10166231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3e281783a80e34b7a7ab0c4f2ccd3e3?s=128&d=identicon&r=PG&f=1", "display_name": "fractals_are_lit", "link": "https://stackoverflow.com/users/10166231/fractals-are-lit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533134463, "creation_date": 1533133707, "last_edit_date": 1533134463, "question_id": 51635892, "link": "https://stackoverflow.com/questions/51635892/cant-draw-ifs-fractal-tree-branches", "title": "Can&#39;t draw IFS fractal tree branches", "body": "<p>Currently, I'm trying to draw a <a href=\"https://i.stack.imgur.com/9mooB.gif\" rel=\"nofollow noreferrer\">symmetric binary tree</a>\n through IFS (Iterated Function Systems) but the result is always only the\n<a href=\"https://i.stack.imgur.com/3MlrI.gif\" rel=\"nofollow noreferrer\">branch tips</a>. </p>\n\n<p>I can't figure out what I'm doing wrong or what I'm missing. </p>\n\n<p>This is the IFS: <a href=\"https://i.stack.imgur.com/x2J15.png\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>This is my code:</p>\n\n<pre><code>RenderWindow window(VideoMode(480, 640), \"fractals everywhere\");\nCircleShape point(1);\nint chance;\nfloat x, y, w, h, nx, ny, px, py;\n\nvoid SymmetricBinaryTrees()\n{\n    float r = 0.57f;\n    float o = 0.785f;\n\n    chance = rand() % 3;\n\n    switch (chance)\n    {\n    case 0:\n        nx = r * cos(o) * x + (-1 * r * sin(o) * y);\n        ny = r * sin(o) * x + r * cos(o) * y + 1;\n        break;\n    case 1:\n        nx = r * cos(o) * x + r * sin(o) * y;\n        ny = -1 * r * sin(o) * x + r * cos(o) * y + 1;\n        break;\n    case 2:\n        nx = x;\n        ny = y;\n        break;\n    }\n}\n\nvoid nextPoint()\n{\n    SymmetricBinaryTrees();\n\n    x = nx; y = ny;\n}\n\nvoid drawPoint()\n{\n    px = _map(x, -1.078, 1.078f, 0, w); py = _map(y, 0.f, 2.078f, h, 0); // maps the position accordingly\n    point.setPosition(px, py);\n\n    window.draw(point);\n}\n\nint main()\n{\n    srand(time(NULL));\n\n    w = window.getSize().x * 1.f;\n    h = window.getSize().y * 1.f;\n\n    x = 0.f; y = 0.f;\n\n    window.setFramerateLimit(60);\n\n    while (window.isOpen())\n    {\n        Event e;\n\n        while (window.pollEvent(e))\n            if (e.type == Event::Closed) window.close();\n\n        for (int i = 1; i &lt;= 500; i++)\n        {\n            drawPoint();\n            nextPoint();\n        }\n\n        window.display();\n    }\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://ecademy.agnesscott.edu/~lriddle/ifs/pythagorean/symbinarytree.htm\" rel=\"nofollow noreferrer\">This</a> is the website that I'm using for my code.</p>\n\n<p>If anyone could help me or has any idea I'd be very grateful, thank you.</p>\n"}, {"tags": ["c++", "function", "c++11", "constexpr"], "comments": [{"owner": {"reputation": 781, "user_id": 3013108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811dd61039ad617bae9e3469815cc7fc?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Semenov", "link": "https://stackoverflow.com/users/3013108/andrey-semenov"}, "edited": false, "score": 1, "creation_date": 1533133489, "post_id": 51635762, "comment_id": 90235894, "body": "<a href=\"https://godbolt.org/g/GNhfum\" rel=\"nofollow noreferrer\">godbolt.org/g/GNhfum</a> no"}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 1, "creation_date": 1533133557, "post_id": 51635762, "comment_id": 90235946, "body": "It only works in some compilers. Better check what the standard says about it."}, {"owner": {"reputation": 3926, "user_id": 3004698, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/adc6701aaba8834c47779319be4ea252?s=128&d=identicon&r=PG&f=1", "display_name": "SLN", "link": "https://stackoverflow.com/users/3004698/sln"}, "reply_to_user": {"reputation": 781, "user_id": 3013108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811dd61039ad617bae9e3469815cc7fc?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Semenov", "link": "https://stackoverflow.com/users/3013108/andrey-semenov"}, "edited": false, "score": 0, "creation_date": 1533133945, "post_id": 51635762, "comment_id": 90236241, "body": "@AndreySemenov I have no idea why, I got compiled successfully on my machine. I&#39;m using cmake to do all the jobs and set it to c++ 11. That might be a the problem?"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 3, "last_activity_date": 1533134096, "creation_date": 1533134096, "answer_id": 51636029, "question_id": 51635762, "link": "https://stackoverflow.com/questions/51635762/constexpr-qualifier-added-on-a-non-constexpr-function-does-not-trigger-any-warni/51636029#51636029", "title": "constexpr qualifier added on a non constexpr function does not trigger any warning", "body": "<p>The reason this happens is because the standard allows it to do so.  <a href=\"https://timsong-cpp.github.io/cppwp/dcl.constexpr#5\" rel=\"nofollow noreferrer\">[dcl.constexpr]/5</a> states</p>\n\n<blockquote>\n  <p>For a constexpr function or constexpr constructor that is neither defaulted nor a template, if no argument values exist such that an invocation of the function or constructor could be an evaluated subexpression of a core constant expression (8.20), or, for a constructor, a constant initializer for some object (6.6.2), the program is ill-formed, no diagnostic required.</p>\n</blockquote>\n\n<p>So, since the function can never be a core constant expression the behavior is undefined and the compiler is not required to notify you.</p>\n"}], "owner": {"reputation": 3926, "user_id": 3004698, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/adc6701aaba8834c47779319be4ea252?s=128&d=identicon&r=PG&f=1", "display_name": "SLN", "link": "https://stackoverflow.com/users/3004698/sln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 51636029, "answer_count": 1, "score": 0, "last_activity_date": 1533134254, "creation_date": 1533133357, "last_edit_date": 1533134254, "question_id": 51635762, "link": "https://stackoverflow.com/questions/51635762/constexpr-qualifier-added-on-a-non-constexpr-function-does-not-trigger-any-warni", "title": "constexpr qualifier added on a non constexpr function does not trigger any warning", "body": "<p>Seems the compiler ignores the constexpr qualifier when it is added to a non-constexpr function.  Why is that? </p>\n\n<p>The following code compiles fine and runs.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing std::string; using std::cout; using std::endl;\n\nconstexpr bool is_shorter(const string &amp;lft, const string &amp;rht) // this is not a constexpr function\n{\n    return lft.size() &lt; rht.size();\n}\n\nint main()\n{\n    bool restul =  is_shorter(\"Hello\", \"World!\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 2, "creation_date": 1533133242, "post_id": 51635657, "comment_id": 90235698, "body": "Looks like a classical XY Problem. Why would you want to enforce child classes to implement those?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 3, "creation_date": 1533133291, "post_id": 51635657, "comment_id": 90235729, "body": "Just... leave it be? It&#39;s a compile error if left undefined."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1533133293, "post_id": 51635657, "comment_id": 90235731, "body": "And this part: <i>&quot;However, my object type is known at compile-time&quot;</i> is unclear, could you elaborate please?"}, {"owner": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1533133355, "post_id": 51635657, "comment_id": 90235781, "body": "@PasserBy I do not want virtual method calls....."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 1, "creation_date": 1533133426, "post_id": 51635657, "comment_id": 90235838, "body": "When object&#39;s type is known compile time then all C++ compilers make the call non-virtual already. And sometimes even inline those. So the problem is unclear."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1533133844, "post_id": 51635657, "comment_id": 90236164, "body": "@PasserBy Well, no, it isn&#39;t. But the build will fail."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533134470, "post_id": 51635657, "comment_id": 90236627, "body": "@Aconcagua I&#39;ve retracted my comment. I was mistaken about an aspect of <code>virtual</code>."}], "answers": [{"comments": [{"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "edited": false, "score": 2, "creation_date": 1533133708, "post_id": 51635852, "comment_id": 90236063, "body": "You advise against using templates?!"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "edited": false, "score": 2, "creation_date": 1533133840, "post_id": 51635852, "comment_id": 90236155, "body": "@imreal Obviously this specific pattern here is addressed, not templates in general..."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1533133868, "post_id": 51635852, "comment_id": 90236179, "body": "yes, I advise against using templates to enforce pure virtual functions - because there&#39;s a better way to do that; they&#39;re called pure virtual functions."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1533133986, "post_id": 51635852, "comment_id": 90236271, "body": "Templates are the specific way to achieve <b>static polymorphism</b>. That is basically what the question is asking for."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1533134064, "post_id": 51635852, "comment_id": 90236322, "body": "People only know what functions expect by reading documentation. That&#39;s also true of inheritance based polymorphism. People should not be guessing how to implement a subclass based on the source code of the parent class alone. Same with templates."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1533134229, "post_id": 51635852, "comment_id": 90236441, "body": "@Galik not true.  static can only be done by reading documentation which goes out of date trivially if it exists at all; while the other can be done by looking at the header."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1533134387, "post_id": 51635852, "comment_id": 90236568, "body": "@UKMonkey My documentation does not go out of date, trivially or otherwise, because I am a professional. If yours does, you may wish to review your processes and approach to programming ;) Keep your documentation <i>in the header</i>, <i>next to the code</i>, for ease of maintenance. It&#39;s quite trivial to do it correctly and to keep it up-to-date"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533134483, "post_id": 51635852, "comment_id": 90236637, "body": "@LightnessRacesinOrbit A professional what?  Hitman?  Is that how you keep the team in line?  (Wish I never had to work on badly maintained brown field projects too - but that&#39;s just a difference in industries)"}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "edited": false, "score": 0, "creation_date": 1533134565, "post_id": 51635852, "comment_id": 90236696, "body": "@UKMonkey Stop fighting and see Caleth&#39;s answer."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533134600, "post_id": 51635852, "comment_id": 90236710, "body": "@UKMonkey You&#39;d be surprised how effective a machine gun in the office can be"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "edited": false, "score": 0, "creation_date": 1533134760, "post_id": 51635852, "comment_id": 90236822, "body": "@imreal Who&#39;s fighting?  I&#39;m just correcting false assertions.  I don&#39;t disagree with Lighness at all; if documentation can be maintained then great.  I&#39;ve just never been at a company where documentation gets the time it needs by the team."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1533134864, "post_id": 51635852, "comment_id": 90236880, "body": "@UKMonkey The problem with relying on reading the source code is it can change without notice when you upgrade your library. Coding to a library&#39;s exposed source is a form of breaking encapsulation. You can also make mistakes reading the source code. Also libraries often do the hard to understand tricky stuff so their users don&#39;t need to. So following the source code can be tricky. Especially if not all of the source code is exposed for every function."}], "tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1533133602, "creation_date": 1533133602, "answer_id": 51635852, "question_id": 51635657, "link": "https://stackoverflow.com/questions/51635657/statically-enforcing-a-c-class-interface-without-using-virtual-methods/51635852#51635852", "title": "Statically-enforcing a C++ class interface without using virtual methods", "body": "<p>The most obvious way, although having worked with code like this I strongly recommend you don't do it, is to use templates:</p>\n\n<pre><code>template&lt;Impl&gt;\nvoid thing(Impl thingy) {\n    thingy.mustDefine();\n}\n</code></pre>\n\n<p>The result will be that Impl must have the function \"mustDefine\", else you'll get compile errors, but it's truely a maintenance nightmare.  People won't know what Impl really is, and when they decide they want to write a new one, they can't work out the full list of things that they need to implement.</p>\n\n<p>I would suggest though that this is an XY question, and that the reason for you not wanting to call virtual methods be addressed.</p>\n"}, {"comments": [{"owner": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "edited": false, "score": 0, "creation_date": 1533133964, "post_id": 51635970, "comment_id": 90236256, "body": "I don&#39;t wish to hide the bass class, I just wish to enforce the child class provides an implementation."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "edited": false, "score": 2, "creation_date": 1533133996, "post_id": 51635970, "comment_id": 90236279, "body": "@user997112 Providing an implementation <i>does</i> hide the base class implementation. That&#39;s the technical term for it. (It&#39;s not &quot;overriding&quot; unless things are polymorphic.)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1533135082, "post_id": 51635970, "comment_id": 90237040, "body": "Some user might break the intended effect, though, by simply providing his own implementation for <code>Parent::mustDefine</code> -- on the other hand, it would be a handy way to provide a custom default for all inheriting classes, so maybe even a good thing?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1533136092, "post_id": 51635970, "comment_id": 90237753, "body": "@YSC there&#39;s a difference between &quot;child.cpp&quot; defining <code>Child::mustDefine</code> and it defining <code>Parent::mustDefine</code>. The latter silently allows all the &quot;otherchild.cpp&quot;s that &quot;shouldn&#39;t&quot; link to &quot;succeed&quot;"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1533136457, "post_id": 51635970, "comment_id": 90237990, "body": "Ho, yes, that&#39;s true."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1533134033, "last_edit_date": 1533134033, "creation_date": 1533133925, "answer_id": 51635970, "question_id": 51635657, "link": "https://stackoverflow.com/questions/51635657/statically-enforcing-a-c-class-interface-without-using-virtual-methods/51635970#51635970", "title": "Statically-enforcing a C++ class interface without using virtual methods", "body": "<p>If you need to enforce your programmers to hide a base class member function by implementing a function of the same name in the derived class.... then leave the base class member function undefined. Attempts to call it will result in linker errors and build failure.</p>\n\n<p>If your users <em>don't</em> try to call the function then the build will still work, which is not necessarily true of virtual functions. But do you care about that?</p>\n\n<pre><code>struct Parent\n{\n    void mustDefine();\n};\n\nstruct Child : Parent\n{\n    // Link failure if this is missing, due to call in main().\n    // That's because, without Child::mustDefine() hiding\n    // Parent::mustDefine(), lookup for `mustDefine` will find\n    // Parent::mustDefine() instead... which is, well, undefined.\n    void mustDefine() {}\n};\n\nint main()\n{\n    Child c;\n    c.mustDefine();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 3, "creation_date": 1533134303, "post_id": 51636062, "comment_id": 90236494, "body": "Now you need a function template for every &quot;must define&quot; function, which is not very extensible. Also you need to start moving definitions into headers when they didn&#39;t necessarily need to be before. Finally, the OP seems to suggest they already have a Parent/Child hierarchy for some reason (though admittedly it&#39;s not clear whether that&#39;s solely due to their attempt to solve this problem). All that being said, this is probably what I&#39;d do :)"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533134964, "post_id": 51636062, "comment_id": 90236967, "body": "What if <code>mustDefine</code> takes hard to get arguments or mutates the instance? This seems like a fine approach, though it seems like it&#39;s missing that last step where <code>mustDefine</code> wouldn&#39;t actually be called. For example just getting the return type for <code>mustDefine</code> should be sufficient."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533135281, "post_id": 51636062, "comment_id": 90237198, "body": "@Fran&#231;oisAndrieux Return type: auto; parameters: variadic template with perfect forwarding would make the approach more flexible..."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533135641, "post_id": 51636062, "comment_id": 90237460, "body": "@Fran&#231;oisAndrieux I was following the signature of <code>Parent::mustDefine</code>. Whatever the non-minimised interface is, it would be repeated this way for <code>virtual</code>s too"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1533134508, "last_edit_date": 1533134508, "creation_date": 1533134213, "answer_id": 51636062, "question_id": 51635657, "link": "https://stackoverflow.com/questions/51635657/statically-enforcing-a-c-class-interface-without-using-virtual-methods/51636062#51636062", "title": "Statically-enforcing a C++ class interface without using virtual methods", "body": "<p>You don't need a <code>class Parent</code> here. What you have is a <a href=\"https://en.cppreference.com/w/cpp/named_req\" rel=\"nofollow noreferrer\">Named Requirement</a></p>\n\n<pre><code>class Child1\n{\n    void mustDefine() { ... }\n};\n\nclass Child2\n{\n    void mustDefine() { ... }\n};\n\nclass NotChild\n{\n};\n\ntemplate&lt;typename T&gt;\nvoid usesMustDefine(T t)\n{\n    t.mustDefine();\n}\n\nint main()\n{\n    Child1 c1;\n    Child2 c2;\n    NotChild c3;\n\n    usesMustDefine(c1); // Succeeds\n    usesMustDefine(c2); // Succeeds\n    // usesMustDefine(c3); // Fails\n\n    c1.mustDefine(); // Succeeds\n    c2.mustDefine(); // Succeeds\n    // c3.mustDefine(); // Fails\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 51635970, "answer_count": 3, "score": -1, "last_activity_date": 1533134508, "creation_date": 1533133089, "question_id": 51635657, "link": "https://stackoverflow.com/questions/51635657/statically-enforcing-a-c-class-interface-without-using-virtual-methods", "title": "Statically-enforcing a C++ class interface without using virtual methods", "body": "<p>I have a parent and child class:</p>\n\n<pre><code>class Parent\n{\n    virtual void mustDefine() = 0;\n};\n\nclass Child : public Parent\n{\n    virtual void mustDefine(){}\n};\n</code></pre>\n\n<p>I want to force all child classes of <code>Parent</code> to implement <code>mustDefine()</code>. However, my object type is known at compile-time and I therefore don't want a polymorphic v-table lookup.</p>\n\n<p>Is there a static way to force child classes to implement parent methods? </p>\n"}, {"tags": ["c++", "templates", "types", "arguments", "default"], "comments": [{"owner": {"reputation": 916, "user_id": 2532768, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/fb1e6af9b4282933954bd2da9d5df682?s=128&d=identicon&r=PG", "display_name": "ruhig brauner", "link": "https://stackoverflow.com/users/2532768/ruhig-brauner"}, "edited": false, "score": 0, "creation_date": 1533135394, "post_id": 51635583, "comment_id": 90237280, "body": "OK, seems to be a thing that C++17 solved but not C+11 which I&#39;m stuck with. <a href=\"https://stackoverflow.com/questions/48608830/template-template-parameter-of-unknown-type\" title=\"template template parameter of unknown type\">stackoverflow.com/questions/48608830/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3923, "user_id": 8309701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S44bo.png?s=128&g=1", "display_name": "Chris Uzdavinis", "link": "https://stackoverflow.com/users/8309701/chris-uzdavinis"}, "is_accepted": true, "score": 1, "last_activity_date": 1533135825, "creation_date": 1533135825, "answer_id": 51636646, "question_id": 51635583, "link": "https://stackoverflow.com/questions/51635583/template-argument-with-default-type-and-value/51636646#51636646", "title": "Template argument with default type and value", "body": "<p>In C++17 you can use an <em>auto</em> template parameter:</p>\n\n<pre><code>template &lt;typename T, auto = 0&gt;\nclass DataAction : public Action\n{\n}\n</code></pre>\n\n<p>Here 0 is an int, but you could assign (char)0 or other types too, if you really want to be confusing with different types of the same value.  :)</p>\n\n<p>Personally I prefer a single type and no defaults for this kind of thing.  This avoids most accidental key reuse and confusion by onlookers. </p>\n"}], "owner": {"reputation": 916, "user_id": 2532768, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/fb1e6af9b4282933954bd2da9d5df682?s=128&d=identicon&r=PG", "display_name": "ruhig brauner", "link": "https://stackoverflow.com/users/2532768/ruhig-brauner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 51636646, "answer_count": 1, "score": 2, "last_activity_date": 1533135825, "creation_date": 1533132886, "last_edit_date": 1533133401, "question_id": 51635583, "link": "https://stackoverflow.com/questions/51635583/template-argument-with-default-type-and-value", "title": "Template argument with default type and value", "body": "<p>I would like to give a template argument a default type and value. The argument isn't really used, it's only relevant to distinguish class instances. I want to use the mechanic for to give classes a key. </p>\n\n<p>I'm trying something like this but the compiler doesn't like it</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename K = int&gt;\ntemplate&lt;typename T, K Key = K(0)&gt;\nclass DataAction : public Action\n{\n    // ...\n};\n</code></pre>\n\n<p>Type <code>T</code> hold data for me. Type <code>Key</code> is of some value to allow for easy use of <code>enum class</code> types and should default to <code>int 0</code> if not assigned.</p>\n\n<p>The following would work.\n</p>\n\n<pre><code>template&lt;typename T, typename K = int, K Key = K(0)&gt;\nclass DataAction : public Action\n</code></pre>\n\n<p>But it requires me to first define the type and then the value, which is not nice.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto instance = DatatAction&lt;int, SomeEnumType, SomeEnumType::SomeKey&gt;();\n</code></pre>\n\n<p>The intention is that the user might want to use multiple class instances of DataAction with the same data type <code>T</code>. To be able to distinguish between them in a dynamic_cast, which is required anyway, an additional key type is used.</p>\n"}, {"tags": ["c++", "cross-compiling"], "comments": [{"owner": {"reputation": 577, "user_id": 7200859, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8b36a5883c42690004f991c0edf36396?s=128&d=identicon&r=PG&f=1", "display_name": "ge45mue", "link": "https://stackoverflow.com/users/7200859/ge45mue"}, "edited": false, "score": 0, "creation_date": 1533147004, "post_id": 51635507, "comment_id": 90243861, "body": "Seems to be a bug <a href=\"https://bugs.launchpad.net/gcc-arm-embedded/+bug/1698539\" rel=\"nofollow noreferrer\">bugs.launchpad.net/gcc-arm-embedded/+bug/1698539</a>"}, {"owner": {"reputation": 577, "user_id": 7200859, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8b36a5883c42690004f991c0edf36396?s=128&d=identicon&r=PG&f=1", "display_name": "ge45mue", "link": "https://stackoverflow.com/users/7200859/ge45mue"}, "edited": false, "score": 0, "creation_date": 1604913905, "post_id": 51635507, "comment_id": 114481956, "body": "Seems resolved with GNU Arm Embedded Toolchain Version 9-2020-q2-update :)"}], "owner": {"reputation": 577, "user_id": 7200859, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8b36a5883c42690004f991c0edf36396?s=128&d=identicon&r=PG&f=1", "display_name": "ge45mue", "link": "https://stackoverflow.com/users/7200859/ge45mue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1533132709, "creation_date": 1533132709, "question_id": 51635507, "link": "https://stackoverflow.com/questions/51635507/arm-none-eabi-g-system-include-path", "title": "arm-none-eabi-g++ system include path", "body": "<p>I have following header file Foo.h:</p>\n\n<pre><code>#ifndef _FOO_H_\n#define _FOO_H_\n\n#include &lt;type_traits&gt;\n\nclass FooC\n{\npublic:\n    FooC();\n   ~FooC() = default;\n};\n\n#endif // _FOO_H_\n</code></pre>\n\n<p>and the corresponding source file Foo.cpp:</p>\n\n<pre><code>#include \"Foo.h\"\n\nFooC::FooC()\n{\n}\n</code></pre>\n\n<p>I can compile the source file with following command</p>\n\n<pre><code>C:\\\\GNU-Tools-ARM-Embedded\\\\6-2017-q2-update\\\\bin\\\\arm-none-eabi-g++.exe -IC:/gnu-tools-arm-embedded/6-2017-q2-update/arm-none-eabi/include/c++/6.3.1 -std=gnu++14 -o Foo.cpp.obj -c Foo.cpp\n</code></pre>\n\n<p>or </p>\n\n<pre><code>C:\\\\GNU-Tools-ARM-Embedded\\\\7-2018-q2-update\\\\bin\\\\arm-none-eabi-g++.exe -IC:/gnu-tools-arm-embedded/7-2018-q2-update/arm-none-eabi/include/c++/7.3.1 -std=gnu++14 -o Foo.cpp.obj -c Foo.cpp\n</code></pre>\n\n<p>but when I exchange the <em>-IC:/gnu-tools-arm-embedded/...</em> with <em>-isystem C:/gnu-tools-arm-embedded/...</em></p>\n\n<pre><code>C:\\\\GNU-Tools-ARM-Embedded\\\\6-2017-q2-update\\\\bin\\\\arm-none-eabi-g++.exe -isystem C:/gnu-tools-arm-embedded/6-2017-q2-update/arm-none-eabi/include/c++/6.3.1 -std=gnu++14 -o Foo.cpp.obj -c Foo.cpp\n</code></pre>\n\n<p>or </p>\n\n<pre><code>C:\\\\GNU-Tools-ARM-Embedded\\\\7-2018-q2-update\\\\bin\\\\arm-none-eabi-g++.exe -isystem C:/gnu-tools-arm-embedded/7-2018-q2-update/arm-none-eabi/include/c++/7.3.1 -std=gnu++14 -o Foo.cpp.obj -c Foo.cpp\n</code></pre>\n\n<p>then I get many compile errors like:</p>\n\n<pre><code>In file included from Foo.h:4:0,\n                 from Foo.cpp:1:\nC:/gnu-tools-arm-embedded/6-2017-q2-update/arm-none-eabi/include/c++/6.3.1/type_traits:68:3: error: template with C linkage\n   template&lt;typename _Tp, _Tp __v&gt;\n   ^~~~~~~~\n...\n    C:/gnu-tools-arm-embedded/6-2017-q2-update/arm-none-eabi/include/c++/6.3.1/type_traits:2660:3: error: template with C linkage\n       template&lt;typename _Tp&gt;\n       ^~~~~~~~\n</code></pre>\n\n<p>I need this include path and the include of <em>type_traits</em> and can not change to <em>-I</em>. Does somebody know a nice solution for this problem?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "io", "directx", "screenshot", "direct3d"], "comments": [{"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1533141397, "post_id": 51635406, "comment_id": 90240984, "body": "<code>GetFrontBufferData</code> is not fast. You are also calling <code>CreateOffscreenPlainSurface</code> every frame, which you can reuse (and ideally more than one for double buffering). <code>D3DXSaveSurfaceToFile</code> is also blocking. For screenshots every frame, you need to copy the data out of the offscreen surface and then have a writer on another thread so you don&#39;t keep blocking the rendering. For DX11, <a href=\"https://github.com/Microsoft/DirectXTK/blob/master/Src/ScreenGrab.cpp\" rel=\"nofollow noreferrer\">this code</a> is a good reference for the writing screenshots, but you are still using deprecated, legacy Direct3D 9 for some reason."}, {"owner": {"reputation": 4933, "user_id": 1095495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/65ff646226e0b868f8d0d232c3eb9089?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1095495/john"}, "reply_to_user": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1533188096, "post_id": 51635406, "comment_id": 90256057, "body": "@ChuckWalbourn good info, but has absolutely nothing to do with my question."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 1, "creation_date": 1533188343, "post_id": 51635406, "comment_id": 90256160, "body": "The first 60 are probably in your file system cache."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1533200664, "post_id": 51635406, "comment_id": 90262670, "body": "Recording  1920x1080@60 would produce <code>1920 * 1080 * 4 * 60 = 497664000 B&#47;s = 0.5 GB&#47;s</code> of uncompressed data. Is your disk fast enough to consume it? You may want to start using some compression."}], "owner": {"reputation": 4933, "user_id": 1095495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/65ff646226e0b868f8d0d232c3eb9089?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1095495/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533132354, "creation_date": 1533132354, "question_id": 51635406, "link": "https://stackoverflow.com/questions/51635406/d3dxsavesurfacetofile-speed-drops-when-not-overwriting-files", "title": "D3DXSaveSurfaceToFile speed drops when not overwriting files", "body": "<p>I am attempting to record my desktop screen with DirectX9.\nFor the first 120ish frames, it records at 60 FPS.\nHowever, once it gets past that, it drops to 15 FPS.</p>\n\n<p>But, if I set it to replace the same first 60 files/frames by changing <code>iTotalFrameCount</code> to <code>iCurrentFrameCount</code> in the file name I pass.</p>\n\n<p>The framerate stays at 60 FPS.</p>\n\n<p>What could be causing the file writing speed to drop so significantly if it is overwriting the same files on every run?</p>\n\n<p>There is over 700 frames in that folder from the previous runs and it always overwrites them.</p>\n\n<p>What makes the first 60 so special that they write fast?</p>\n\n<pre><code>bool TakeScreenShot(IDirect3DDevice9 *Device, char *FileName, int ScreenX, int ScreenY)\n{\n    static IDirect3DSurface9 *FrontBuffer = NULL; \n\n    HRESULT Result;\n\n    IDirect3DSwapChain9* chain;\n\n\n\n    if(FrontBuffer == NULL)\n    {\n        Result = Device-&gt;CreateOffscreenPlainSurface(ScreenX, ScreenY, D3DFMT_A8R8G8B8, D3DPOOL_SCRATCH, &amp;FrontBuffer, NULL);\n\n        if(Result == D3DERR_INVALIDCALL)\n            printf(\"Invalid call\\n\");\n\n        if (Result != D3D_OK)\n        {\n            printf(\"Last error %d\\n\", GetLastError());\n\n            return false;\n        }\n    }\n\n    Device-&gt;GetSwapChain(0, &amp;chain);\n\n    chain-&gt;GetFrontBufferData(FrontBuffer);\n\n    Result = D3DXSaveSurfaceToFile(FileName, D3DXIFF_BMP, FrontBuffer, NULL, NULL);\n\n    if (Result != D3D_OK)\n        return false;\n\n    return true;\n}\n\n\n\n\n\nstatic long long startTime;\n\n\n\n// this is the function used to render a single frame\nvoid render_frame(void)\n{\n    static DWORD dwTime = 0;\n\n    static float fFrameRate;\n\n    static int iCurrentFrameCount = 0,\n                iTotalFrameCount = 0;\n\n\n    if(startTime == 0)\n        startTime = milliseconds_now();\n\n\n\n    if(GetTickCount() - dwTime &gt;= 1000)\n    {\n        stringstream sstream; \n        sstream &lt;&lt; \"Framerate: \" &lt;&lt; iCurrentFrameCount &lt;&lt; endl;\n\n        printf(\"%s\\n\", sstream.str().c_str());\n\n        iCurrentFrameCount = 0;\n        dwTime = GetTickCount();\n    }\n\n\n    stringstream sstream;\n\n    sstream &lt;&lt; \"C:\\\\frames\\\\\" &lt;&lt; iTotalFrameCount &lt;&lt; \".bmp\";\n\n    TakeScreenShot(d3ddev, (char*)sstream.str().c_str(), 1920, 1080);\n\n\n    iCurrentFrameCount++;\n    iTotalFrameCount++;\n\n\n    if(GetAsyncKeyState(VK_ESCAPE) != 0)\n    {\n        long long recordTime = milliseconds_now() - startTime;\n\n\n        float seconds = recordTime / 1000.0f;\n\n\n        float frameRate = (float)iTotalFrameCount / seconds;\n\n\n        printf(\"FPS: %f\\n\", frameRate);\n\n\n        Sleep(10000);\n\n        exit(0);\n    }\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "cython", "python-extensions"], "comments": [{"owner": {"reputation": 6394, "user_id": 3327666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717bb7cd1896b19837f5ab1f4264bc9d?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre de Buyl", "link": "https://stackoverflow.com/users/3327666/pierre-de-buyl"}, "edited": false, "score": 1, "creation_date": 1533199428, "post_id": 51635113, "comment_id": 90261908, "body": "Tests 2 and 3 sound fine on the principle. There are many projects on PyPI that distribute C or C++ code that is built on the destination machine. For 2 and 3 however, you must not access the C++ code as &quot;cdef extern&quot; but by &quot;cimporting&quot; it as it is already available at the Cython level. Maybe that was the issue? For more help, we&#39;d need a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "reply_to_user": {"reputation": 6394, "user_id": 3327666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717bb7cd1896b19837f5ab1f4264bc9d?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre de Buyl", "link": "https://stackoverflow.com/users/3327666/pierre-de-buyl"}, "edited": false, "score": 0, "creation_date": 1533199866, "post_id": 51635113, "comment_id": 90262173, "body": "Yeap, I&#39;m accessing the C++ code by &quot;cimporting&quot;. The only &quot;cdef extern&quot; blocks are located in the <code>.pxd</code> wrapper. Could you redirect me to any of those projects? I believe that a working example could help me gratly. So far I&#39;ve tried checking on lxml, sciPy, spaCy and some others. I&#39;ll prepare an example otherwise."}, {"owner": {"reputation": 6394, "user_id": 3327666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717bb7cd1896b19837f5ab1f4264bc9d?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre de Buyl", "link": "https://stackoverflow.com/users/3327666/pierre-de-buyl"}, "edited": false, "score": 0, "creation_date": 1533202636, "post_id": 51635113, "comment_id": 90263928, "body": "For the specific case of accessing global variables, it is a bit harder to find examples actually. The simulation code <a href=\"https://github.com/espressomd/espresso\" rel=\"nofollow noreferrer\">ESPResSo</a> uses global variables, see <code>src&#47;python&#47;espressomd&#47;globals.pxd</code> there. They use a more complex build procedure but for a simple C++ project that should not be an issue."}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1533282660, "post_id": 51635113, "comment_id": 90298240, "body": "That problem is not uncommon when using cython. However, it seems as if a good answer is lacking here on SO. Probably adding a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would help to understand the problem better (the minimal-part is quite important though)."}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1533282851, "post_id": 51635113, "comment_id": 90298334, "body": "A somewhat related answer <a href=\"https://stackoverflow.com/a/45655654/5769463\">stackoverflow.com/a/45655654/5769463</a>, however it isn&#39;t concise enough too be of much use."}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1533283393, "post_id": 51635113, "comment_id": 90298608, "body": "If your pxd-file has <code>cdef extern from header.h</code> using the functionality will result in going directly to C++-functionality and thus *.so-library is needed during linkage/run time. If you wrap the functionality in cdef-functions and expose only those wrappers in the pxd-file, you will not need the so-library directly it would be enough to cimport the wrapper-extension. However, not sure this could work for something more complex (classes) than simple functions."}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1533283633, "post_id": 51635113, "comment_id": 90298740, "body": "When I face this issue, I just put all extensions into one to avoid the hassle... With time I got pretty good at muting the voice of the purist in my head, which screams every time I do it."}, {"owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1533808463, "post_id": 51635113, "comment_id": 90486576, "body": "@ead How do you do that? Do you have any open source code I could have a look into? That was my first intention but I run into trouble and found everywhere people telling me to use one Extension per <code>.pyx</code> file!"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1533812012, "post_id": 51635113, "comment_id": 90488734, "body": "I put them all into the same pyx-file. This is the part where the voice start screaming:)"}, {"owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "edited": false, "score": 0, "creation_date": 1533812087, "post_id": 51635113, "comment_id": 90488786, "body": "Ugh, if I do that with 4000+ lines of code, the next developer touching my code is going to kill me"}, {"owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1601480450, "post_id": 51635113, "comment_id": 113423108, "body": "@ead I&#39;m back with this old problem. Do you have any particular answers in SO that could point me in the right direction? I had a look at <a href=\"https://stackoverflow.com/questions/63875206/how-to-share-a-c-singleton-between-multiple-c-extensions\" title=\"how to share a c singleton between multiple c extensions\">stackoverflow.com/questions/63875206/&hellip;</a> but couldn&#39;t find a solution. I can prepare an example for my case otherwise"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1601493958, "post_id": 51635113, "comment_id": 113429068, "body": "The approach from the linked answer is well suited for libraries with a very small public interface and works best with C rather than C++ (classes being kind of a problem). So the options I can thing of are either to distribute precompiled so/dll (which reduces the number of platforms for which the extension can be used) or to override <code>build_clib</code> to build shared libraries. My plan was to add a second answer, which describes <code>build_clib</code>-option in more detail, but haven&#39;t found the time yet. Here is a prototype for such solution: <a href=\"https://github.com/realead/commonso/blob/master/setup.py\" rel=\"nofollow noreferrer\">github.com/realead/commonso/blob/master/setup.py</a>"}, {"owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1601569985, "post_id": 51635113, "comment_id": 113455431, "body": "@ead, I just found the Holy Grial you were hiding in your garden <a href=\"https://github.com/realead/solinks\" rel=\"nofollow noreferrer\">github.com/realead/solinks</a> . Have you ever thought of writing a book about Cython?"}, {"owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "edited": false, "score": 0, "creation_date": 1601583844, "post_id": 51635113, "comment_id": 113461003, "body": "One small extra question: I tried your approach from github.com/realead/commonso/blob/master/setup.py , and while it works perfectly in Linux (Ubuntu), it fails for Windows, complaining that it cannot find the <code>*.lib</code> file. Indeed, when compiling the shared <code>dll</code> library in windows, I only get a <code>dll</code> file, and not a <code>lib</code> file. You won&#39;t happen to know how to generate both the <code>dll</code> and the <code>lib</code> files, do you?"}, {"owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "edited": false, "score": 0, "creation_date": 1601583916, "post_id": 51635113, "comment_id": 113461026, "body": "Note: Since this is getting extremely complex, once I get a working solution I will prepare a smaller example and post it at SO for further reference."}, {"owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "edited": false, "score": 0, "creation_date": 1601668280, "post_id": 51635113, "comment_id": 113487620, "body": "INFO: I ended up building it as a static library (much like in <a href=\"https://stackoverflow.com/questions/57673283/prevent-double-compilation-of-c-files-in-cython\" title=\"prevent double compilation of c files in cython\">stackoverflow.com/questions/57673283/&hellip;</a>). Dynamic libraries need to be stored and found on all OS. I couldn&#39;t find a clean way to do this."}], "owner": {"reputation": 3927, "user_id": 9670056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo8oI.png?s=128&g=1", "display_name": "ibarrond", "link": "https://stackoverflow.com/users/9670056/ibarrond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1533131592, "creation_date": 1533131592, "question_id": 51635113, "link": "https://stackoverflow.com/questions/51635113/cython-avoid-compiling-all-c-c-files-on-each-extension-objective-distribute", "title": "Cython: avoid compiling all C/C++ files on each extension. Objective: distribute in PyPi", "body": "<p>The Cython project I am currently working on includes some 20 C++ files that act as C++ implementation. On top I have built three Extension Modules written in Cython, each of them capturing different but interconnected functionalities of the C++ implementation. In order to wrap the required functionalities form C++ I used one single <code>.pxd</code> file that defines all the <code>cdef extern</code> blocks. Later on, the 3 <code>.pyx</code> files with the 3 Extension Modules (one Extension Module per .pyx file) cimport the <code>pxd</code> wrapper and add extra functionality. </p>\n\n<p>Now, my objective is to pack the whole library and distribute it using PyPi. My problem arises when using setup.py: I don't know how to make the C++ code available for all Extension Modules. For development I have installed the C++ as a dynamic library in Linux, which clearly has a lot of portability issues. I am more than willing to export the C++ source code to be compiled locally (thus creating a source distribution using <code>python setup.py sdist</code>).</p>\n\n<p>These are the approaches I've taken so far, all of them failed:</p>\n\n<ol>\n<li>Including the C++ source files in the <code>sources</code> of all extensions. It compiles all the C++ files for each Extension. This creates multiple copies of global objects.</li>\n<li>Including the C++ source files in the most important Extension and importing it always first. The other Extension modules throw <code>undefined symbol</code> errors because they don't have access to the C++ implementation.</li>\n<li>Creating a 4th Extension module with the name of the Cython <code>.pxd</code> wrapper and importing it first. Same result as above (#2).</li>\n</ol>\n\n<p>Any tips will be highly appreciated!</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1533131256, "post_id": 51634896, "comment_id": 90234212, "body": "You can do that for <code>std::map::find()</code> but you cannot do that for <code>std::map::operator[]</code> so you either create temprorary <code>Type</code> or only use <code>find</code>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1533131340, "post_id": 51634896, "comment_id": 90234279, "body": "Sounds like you just need to give <code>Type</code> constructors that take either type. The challenge then might be to make them properly comparable."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533131387, "post_id": 51634896, "comment_id": 90234324, "body": "@Fran&#231;oisAndrieux that is not necessary for <code>std::map::find()</code> since c++14"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1533131700, "post_id": 51634896, "comment_id": 90234544, "body": "@Slava I&#39;m not sure what <i>&quot;that&quot;</i> refers to in your comment."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1533131816, "post_id": 51634896, "comment_id": 90234632, "body": "@Fran&#231;oisAndrieux by &quot;that&quot; I mean that you do not have to create instance of <code>Type</code> to pass it to <code>find</code>"}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1533131779, "post_id": 51634983, "comment_id": 90234606, "body": "Are you sure? This doesn&#39;t compile. Where did you find this?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1533132730, "post_id": 51634983, "comment_id": 90235314, "body": "You need <code>std::less&lt;&gt;</code> actually."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1533132994, "post_id": 51634983, "comment_id": 90235515, "body": "@n.m. <code>std::less&lt;void&gt;</code> seems to enable heterogenous lookup indeed <a href=\"https://en.cppreference.com/w/cpp/utility/functional/less_void\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/utility/functional/less_void</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1533133065, "post_id": 51634983, "comment_id": 90235566, "body": "@Slava yes the feature is here, just with a bit different syntax."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 0, "last_activity_date": 1533139811, "last_edit_date": 1533139811, "creation_date": 1533131252, "answer_id": 51634983, "question_id": 51634896, "link": "https://stackoverflow.com/questions/51634896/overload-stdmap-with-different-key-type/51634983#51634983", "title": "Overload std::map with different key type", "body": "<p>Try simply this:</p>\n\n<pre><code>std::map&lt;Type, std::vector&lt;int&gt;, std::less&lt;&gt; &gt; index;\n</code></pre>\n\n<p>This requires C++14.  Note the use of <code>std::less</code> with no template argument, which allows searching for \"compatible\" keys, not only the exact <code>key_type</code>.  That's what you need to \"unlock\" the use of <code>find()</code> with your custom comparison functions.</p>\n\n<p>The default third template argument for <code>std::map</code> is <code>std::less&lt;key_type&gt;</code>, which is more limited.  It remains this way for backward compatibility with pre-C++14 code, but much new code would do well to use <code>std::less</code> without template arguments.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1533138885, "post_id": 51635344, "comment_id": 90239556, "body": "I had no idea this was possible. I have so much catching up to do since C++11."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": true, "score": 7, "last_activity_date": 1533139501, "last_edit_date": 1533139501, "creation_date": 1533132173, "answer_id": 51635344, "question_id": 51634896, "link": "https://stackoverflow.com/questions/51634896/overload-stdmap-with-different-key-type/51635344#51635344", "title": "Overload std::map with different key type", "body": "<p>What you need is called heterogeneous lookup and supported by <code>std::map</code> since C++14. For that you can define your own comparator structure and provide type <code>is_transparent</code> in it to enable this functionality. Details on how to enable heterogeneous lookup can be found here <a href=\"https://stackoverflow.com/questions/31923715/how-can-i-search-an-stdmap-using-a-key-of-a-different-type\">How can I search an std::map using a key of a different type</a></p>\n\n<p>Also note, while <code>std::map::find()</code> does support it <code>std::map::operator[]</code> does not, so you have to replace your code:</p>\n\n<pre><code>if (index.find(\"test\") != index.end())\n{\n   index[\"test\"].push_back(0);\n}\n</code></pre>\n\n<p>to something like:</p>\n\n<pre><code> auto it = index.find(\"test\");\n if( it != index.end()) \n     it-&gt;second.push_back(0);\n</code></pre>\n\n<p>and you should do that anyway, as you would do two lookups instead of one otherwise and that is significantly expensive operation on map.</p>\n\n<p>So for your case comparator should be something like:</p>\n\n<pre><code>struct CompareType\n{\n    using is_transparent = std::true_type;\n\n    // standard comparison (between two instances of Type)\n    bool operator()(const Type&amp; lhs, const Type&amp; rhs) const { return lhs.key &lt; rhs.key; }\n    // comparisons btw Type and std::string\n    bool operator()( const Type&amp; lhs, const std::string &amp;rhs) const { return lhs.key &lt; rhs; }\n    bool operator()(const std::string &amp;lhs, const Type&amp; rhs) const { return lhs &lt; rhs.key; }\n};\n</code></pre>\n\n<p>then you create your map by:</p>\n\n<pre><code>std::map&lt;Type, std::vector&lt;int&gt;,CompareType&gt; index;\n</code></pre>\n\n<p>and you do not need comparison methods in <code>Type</code> itself anymore</p>\n\n<p>Another way is to submit <code>std::less&lt;&gt;</code> as third parameter to <code>std::map</code>, but in that case you are missing the comparison operator, that takes <code>std::string</code> as left operand and <code>Type</code> as right and as that comparison operator cannot be member of <code>Type</code> I think it is cleaner to do it through a separate comparator (code there is consistent).</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2137859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bee4abfe05718b85707f7ed14802704?s=128&d=identicon&r=PG", "display_name": "JayRock", "link": "https://stackoverflow.com/users/2137859/jayrock"}, "is_accepted": false, "score": 1, "last_activity_date": 1533271851, "creation_date": 1533271851, "answer_id": 51665522, "question_id": 51634896, "link": "https://stackoverflow.com/questions/51634896/overload-stdmap-with-different-key-type/51665522#51665522", "title": "Overload std::map with different key type", "body": "<p>I see two problems in the code as provided: </p>\n\n<ol>\n<li>The Type class doesn't support less-than operation, which is required when used as std::map&lt;> key type.</li>\n<li>A string (char array constant) is used in two places where Type is expected: argument of <code>map::find()</code> and <code>map::operator[]</code>. Compiler can't convert from const char* to Type.</li>\n</ol>\n\n<p>First, meet requirement for Type as a key type of std::map&lt;>: </p>\n\n<pre><code>// Define comparison/ordering of two Type instances\nbool operator&lt;(const Type&amp; a, const Type&amp; b)\n{\n   return a.key &lt; b.key;\n}\n</code></pre>\n\n<p>Second, define how const char* (e.g. \"test\") may be implicitly converted to Type using single-arg ctor: </p>\n\n<pre><code>class Type \n{\npublic:\n   // Implicitly converts const char* value to instance of Type.\n   Type(const char* k) : key(k), support(0) {}\n   //...\n};\n</code></pre>\n\n<p>This doesn't require any newer (C++11 or C++14) language features.</p>\n"}], "owner": {"reputation": 870, "user_id": 4864088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abcd51dd21af1ef2dee9a8c25ae7a1a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mini Fridge", "link": "https://stackoverflow.com/users/4864088/mini-fridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 2, "accepted_answer_id": 51635344, "answer_count": 3, "score": 3, "last_activity_date": 1533271851, "creation_date": 1533131022, "question_id": 51634896, "link": "https://stackoverflow.com/questions/51634896/overload-stdmap-with-different-key-type", "title": "Overload std::map with different key type", "body": "<p>So I have the following STL <code>std::map</code> container</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;vector&gt;\n// ...\nclass Type\n{\n std::string key;\n int support;\n};\nstd::map&lt;Type, std::vector&lt;int&gt; &gt; index;\n</code></pre>\n\n<p>I want to overload the map so both if clauses below work:</p>\n\n<pre><code>int main()\n{\n  std::map&lt;Type, std::vector&lt;int&gt; &gt; index;\n  Type type1;\n  type1.key = \"test\";\n  type1.support = 10;\n  index[type1] = std::vector&lt;int&gt;();\n  if (index.find(type1) != index.end())\n  {\n    index[type1].push_back(0);\n  }\n  // I can not make this work\n  if (index.find(\"test\") != index.end())\n  {\n    index[\"test\"].push_back(0);\n  }\n\n\n  return 0;\n}\n</code></pre>\n\n<p>I have tried these overloads:</p>\n\n<pre><code>class Type \n{\n public:\n  std::string key;\n  int support;\n  size_t operator()() const\n  {\n    return std::hash&lt;std::string&gt;{}(name);\n  }\n\n  bool operator==(const struct Type&amp; obj) const \n  {\n    return (key == obj.key);\n  }\n\n  bool operator&lt;(const struct Type&amp; obj) const \n  {\n    return key &lt; obj.key;\n  }\n\n  bool operator&lt;(const std::string&amp; other_key) const \n  {\n    return key &lt; other_key;\n  }\n\n\n  bool operator==(const std::string&amp; other_key) const\n  {\n    return other_key == key;\n\n  }\n\n\n};\n\nnamespace std\n{\n\n  template&lt;&gt;\n  struct hash&lt;Type&gt;\n  {\n    size_t operator()(const Type&amp; obj) const\n    {\n      return obj();\n    }\n    // Specialization here does not seem to work\n    size_t operator()(const std::string&amp; name) const\n    {\n      return std::hash&lt;std::string&gt;{}(name);\n    }\n  };\n\n  template&lt;&gt;\n  struct less&lt;Type&gt;\n  {\n\n    bool operator() (const std::string&amp; lname, const std::string&amp; rname)\n    {\n      return lname &lt; rname;\n    }\n  };\n</code></pre>\n\n<p>Since in my model the <code>std::string key</code> field uniquely defines the Type how can I overload the <code>std::map</code> container so that can index the items of the container? Am I able to do that in C++?</p>\n\n<p>PS: I know that some code might be redundant in the overloads</p>\n"}, {"tags": ["c++", "double", "compiler-optimization", "aix"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1533130955, "post_id": 51634785, "comment_id": 90233968, "body": "I seriously doubt this works correctly in <i>any</i> optimization setting... what is <code>ub8</code>? If that&#39;s some 8-bit value, you have just massacred your floating point value down to one byte. Are you aware that <code>ntohll()</code> works on <i>integers</i>? Can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 99, "user_id": 8515356, "user_type": "registered", "profile_image": "https://graph.facebook.com/1804869356205096/picture?type=large", "display_name": "\u042d\u043b\u044c\u0444\u0438\u044f \u0412\u0430\u043b\u0438\u0435\u0432\u0430", "link": "https://stackoverflow.com/users/8515356/%d0%ad%d0%bb%d1%8c%d1%84%d0%b8%d1%8f-%d0%92%d0%b0%d0%bb%d0%b8%d0%b5%d0%b2%d0%b0"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1533131130, "post_id": 51634785, "comment_id": 90234098, "body": "ub8 has size as 8 byte, unsigned long long"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1533131136, "post_id": 51634785, "comment_id": 90234101, "body": "The code is so nasty that you&#39;ll probably need to turn off strict aliasing, at the very least."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1533131385, "post_id": 51634785, "comment_id": 90234323, "body": "@\u042d\u043b\u044c\u0444\u0438\u044f\u0412\u0430\u043b\u0438\u0435\u0432\u0430: Again, why are you storing a floating point value in an integer, <i>process</i> that integer with an integer function intended to correct <i>byte order</i>, then expect the mash you made of all those bits to still be a valid floating point value?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1533131549, "post_id": 51634785, "comment_id": 90234444, "body": "And why is floating point data passed around as <code>char *</code> in the first place? The mind boggles..."}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1533131785, "post_id": 51634785, "comment_id": 90234611, "body": "Works for me (with gcc, I don&#39;t have xlc). Mind you, in PowerPC (big endian) <code>ntohll</code> should be identical."}, {"owner": {"reputation": 99, "user_id": 8515356, "user_type": "registered", "profile_image": "https://graph.facebook.com/1804869356205096/picture?type=large", "display_name": "\u042d\u043b\u044c\u0444\u0438\u044f \u0412\u0430\u043b\u0438\u0435\u0432\u0430", "link": "https://stackoverflow.com/users/8515356/%d0%ad%d0%bb%d1%8c%d1%84%d0%b8%d1%8f-%d0%92%d0%b0%d0%bb%d0%b8%d0%b5%d0%b2%d0%b0"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1533131914, "post_id": 51634785, "comment_id": 90234726, "body": "@DevSolar We get double value in the char array format from binary file. We parsing data from transaction logs of oracle database. And oracle writes , for example, double value as &#39;40 0d 94 8f e6 10 3e 93&#39; and we should convert is as &#39;-1,1512299550195975&#39; in the double type value. But in the only aix we get &#39;3,6975400899608046&#39; incorrect value"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 3, "creation_date": 1533132537, "post_id": 51634785, "comment_id": 90235186, "body": "This is very strange, these values are consistent with <i>complementing</i> the raw value before reinterpreting it as double, instead of rearranging its bytes."}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1533132870, "post_id": 51634785, "comment_id": 90235418, "body": "indeed, the binary values of these numbers are <code>-1.15123: bff26b7019efc16c</code> and <code>3.69754: 400d948fe6103e93</code>, their sum is <code>ffffffffffffffff</code>"}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1533138023, "post_id": 51634785, "comment_id": 90239037, "body": "Maybe a simpler code wouldn&#39;t provoke the optimizer&#39;s bug: <code>ub8 tmp= ntohll(*(ub8 *)szData); return *(double *)&amp;tmp;</code>"}, {"owner": {"reputation": 99, "user_id": 8515356, "user_type": "registered", "profile_image": "https://graph.facebook.com/1804869356205096/picture?type=large", "display_name": "\u042d\u043b\u044c\u0444\u0438\u044f \u0412\u0430\u043b\u0438\u0435\u0432\u0430", "link": "https://stackoverflow.com/users/8515356/%d0%ad%d0%bb%d1%8c%d1%84%d0%b8%d1%8f-%d0%92%d0%b0%d0%bb%d0%b8%d0%b5%d0%b2%d0%b0"}, "edited": false, "score": 0, "creation_date": 1533210045, "post_id": 51634785, "comment_id": 90268659, "body": "thank you,  I used  -qnoansialias to turn off aling strict, and it is help"}], "answers": [{"comments": [{"owner": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "reply_to_user": {"reputation": 99, "user_id": 8515356, "user_type": "registered", "profile_image": "https://graph.facebook.com/1804869356205096/picture?type=large", "display_name": "\u042d\u043b\u044c\u0444\u0438\u044f \u0412\u0430\u043b\u0438\u0435\u0432\u0430", "link": "https://stackoverflow.com/users/8515356/%d0%ad%d0%bb%d1%8c%d1%84%d0%b8%d1%8f-%d0%92%d0%b0%d0%bb%d0%b8%d0%b5%d0%b2%d0%b0"}, "edited": false, "score": 0, "creation_date": 1533203669, "post_id": 51635452, "comment_id": 90264572, "body": "@\u042d\u043b\u044c\u0444\u0438\u044f\u0412\u0430\u043b\u0438\u0435\u0432\u0430 If it solved your issue, please, accept the answer."}, {"owner": {"reputation": 99, "user_id": 8515356, "user_type": "registered", "profile_image": "https://graph.facebook.com/1804869356205096/picture?type=large", "display_name": "\u042d\u043b\u044c\u0444\u0438\u044f \u0412\u0430\u043b\u0438\u0435\u0432\u0430", "link": "https://stackoverflow.com/users/8515356/%d0%ad%d0%bb%d1%8c%d1%84%d0%b8%d1%8f-%d0%92%d0%b0%d0%bb%d0%b8%d0%b5%d0%b2%d0%b0"}, "edited": false, "score": 0, "creation_date": 1533209924, "post_id": 51635452, "comment_id": 90268580, "body": "no, we decided to use -qnoansialias  flag, and It is help. We think that using union can be occurred some errors, because this union data can be stored differently for different platforms and we supported several platforms  of them"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533210897, "post_id": 51635452, "comment_id": 90269207, "body": "The union version also causes UB, it would be better not to mention it. The memcpy version is best."}, {"owner": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "edited": false, "score": 0, "creation_date": 1533223389, "post_id": 51635452, "comment_id": 90278072, "body": "Yes, that is why I have also posted the memcpy version, which does not rely on UB. Adding the -qnoansialias flag will disable some optimizations based on the strict aliasing, which may impact the performance of your system. Also, it is non portable across compilers."}, {"owner": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1533224559, "post_id": 51635452, "comment_id": 90278825, "body": "@M.M I have added an edit, in order to state that the UB is only in C++, not in C, which is why I have added it as an option"}], "tags": [], "owner": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "is_accepted": true, "score": 0, "last_activity_date": 1533224501, "last_edit_date": 1533224501, "creation_date": 1533132534, "answer_id": 51635452, "question_id": 51634785, "link": "https://stackoverflow.com/questions/51634785/incorrect-double-conversion-by-aix-compiler-13-1-3-for-c/51635452#51635452", "title": "Incorrect double conversion by AIX compiler 13.1.3 for c++", "body": "<p>Your implementation is relying on Undefined Behaviour, particularly violating the Strict Aliasing rule, as somebody has commented.</p>\n\n<p>That is why sometimes it may work (without optimization) and sometimes no.</p>\n\n<p>To avoid violating the Strict Aliasing, you can use one of the following:</p>\n\n<p>Only in C (not C++, More info <a href=\"https://stackoverflow.com/a/25672839/3742943\">here</a>):</p>\n\n<pre><code>typedef union swap64{\n    unsigned long long u64;\n    double d64;\n}swap64;\nswap64 s;\nmemcpy(s.u64, szData, sizeof(swap64));\ns.u64=ntohll(s.u64);\n\n//Following line is UB in C++, but not in C:\nreturn s.d64;\n</code></pre>\n\n<p>Or without UB (code valid in both C++ and C):</p>\n\n<pre><code>unsigned long long u64;\ndouble d64;\n\n//Most compilers will remove the memcpy calls and replace them by simpler instructions\nmemcpy(&amp;u64, szData, sizeof(u64));\nu64=ntohll(u64);\nmemcpy(&amp;d64, &amp;u64, sizeof(u64));\n\nreturn d64;\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8515356, "user_type": "registered", "profile_image": "https://graph.facebook.com/1804869356205096/picture?type=large", "display_name": "\u042d\u043b\u044c\u0444\u0438\u044f \u0412\u0430\u043b\u0438\u0435\u0432\u0430", "link": "https://stackoverflow.com/users/8515356/%d0%ad%d0%bb%d1%8c%d1%84%d0%b8%d1%8f-%d0%92%d0%b0%d0%bb%d0%b8%d0%b5%d0%b2%d0%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 51635452, "answer_count": 1, "score": 1, "last_activity_date": 1533224501, "creation_date": 1533130677, "last_edit_date": 1533131904, "question_id": 51634785, "link": "https://stackoverflow.com/questions/51634785/incorrect-double-conversion-by-aix-compiler-13-1-3-for-c", "title": "Incorrect double conversion by AIX compiler 13.1.3 for c++", "body": "<p>We cast a data from char* array do double as in the following function:</p>\n\n<pre><code>double getDouble(const char* szData, const size_t dataLength)\n{\n    double res = 0;\n    if(dataLength == 8)\n    {\n        ub8 doubleData = *(ub8*)(szData);\n        doubleData = ntohll(doubleData);\n        double* pDoubleData = (double*)(&amp;doubleData);\n        res = *pDoubleData;\n    }\n    return res;\n}\n</code></pre>\n\n<p>ub8 has size as 8 byte, unsigned long long.\nAnd the double value -1.1512299550195975  is converted as 3.6975400899608046. But         input and output should be equal(equal to -1.1512299550195975). This case is only happened in AIX. In the another platforms we get correct result.</p>\n\n<p>We use optimization level O2 for our project. If I used optimization level as O1 , then data is converted correctly.\nCan you help me, please, what do you think, why conversion is correct for optimization level O1 and why it is incorrect for optimization level O2? May be I should to turn off or on some flags  for aix in the compilation? Thank you. Aix compiler version is 13.1.3.</p>\n\n<p>We get double value in the char array format from binary file. We parsing data from transaction logs of oracle database. And oracle writes , for example, double value as '40 0d 94 8f e6 10 3e 93' and we should convert is as '-1,1512299550195975' in the double type value. But in the only aix we get '3,6975400899608046' incorrect value</p>\n"}, {"tags": ["c++", "windows", "service", "wxwidgets", "tray"], "comments": [{"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1533134917, "post_id": 51634706, "comment_id": 90236924, "body": "did you look at the {appropriate} sample?"}, {"owner": {"reputation": 25, "user_id": 8060165, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mdywERHBtWc/AAAAAAAAAAI/AAAAAAAAEbY/vmAop4TdW-Y/photo.jpg?sz=128", "display_name": "Manu Gal&#225;n", "link": "https://stackoverflow.com/users/8060165/manu-gal%c3%a1n"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1533135012, "post_id": 51634706, "comment_id": 90236996, "body": "@Igor what do you mean with {appropiate} sample?"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1533135272, "post_id": 51634706, "comment_id": 90237184, "body": "probably the taskbarbutton one. Or the application is not made with the wxWidgets {yet}?"}, {"owner": {"reputation": 25, "user_id": 8060165, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mdywERHBtWc/AAAAAAAAAAI/AAAAAAAAEbY/vmAop4TdW-Y/photo.jpg?sz=128", "display_name": "Manu Gal&#225;n", "link": "https://stackoverflow.com/users/8060165/manu-gal%c3%a1n"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1533137305, "post_id": 51634706, "comment_id": 90238544, "body": "@Igor I&#39;ve been reading it, but it doesn&#39;t solve my problem. If not clear, the problem is that I can&#39;t gracefully close the tray icon app from the service."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8060165, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mdywERHBtWc/AAAAAAAAAAI/AAAAAAAAEbY/vmAop4TdW-Y/photo.jpg?sz=128", "display_name": "Manu Gal&#225;n", "link": "https://stackoverflow.com/users/8060165/manu-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1533213705, "post_id": 51637951, "comment_id": 90271133, "body": "Right so I&#39;ve been trying this Enumerating all windows with EnumWindows. It seems it works fine, as it finds all the windows but doesn&#39;t find the tray icon app itself, or at least it PID. May it be cause is minimised?"}, {"owner": {"reputation": 25, "user_id": 8060165, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mdywERHBtWc/AAAAAAAAAAI/AAAAAAAAEbY/vmAop4TdW-Y/photo.jpg?sz=128", "display_name": "Manu Gal&#225;n", "link": "https://stackoverflow.com/users/8060165/manu-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1533220577, "post_id": 51637951, "comment_id": 90276082, "body": "Finally the solution seems to work fine, it was a service-related problem. Thanks!"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1533228782, "last_edit_date": 1533228782, "creation_date": 1533140059, "answer_id": 51637951, "question_id": 51634706, "link": "https://stackoverflow.com/questions/51634706/tray-icon-app-to-be-closed-from-service/51637951#51637951", "title": "Tray icon app to be closed from service", "body": "<p>The tray app needs a way of receiving a signal when it should exit gracefully.</p>\n\n<p>If the tray app already has a window, you can send it a <code>WM_CLOSE</code> or <code>WM_QUIT</code> message.  Window messages can't be sent over session boundaries, though. But, if you can change the tray app, you can make it accept an optional command-line parameter that just sends the message to a previous instance of the app and then exits. And then the service can run a new instance of the app with that parameter when needed. Or, if you can't change the app, then just run a second instance of your own service EXE, or another helper app that you write.</p>\n\n<p>Otherwise, if the tray app doesn't have a window yet, but you can change the app, then add a hidden window. Or better, add another IPC mechanism, like a named kernel event via <code>CreateEvent()</code> that the app can wait on, or a pipe, or a socket, etc. Something that the service can then send a signal to directly.</p>\n\n<p>Otherwise, if you can't change the tray app, and if it doesn't have a window you can send messages to, then you are stuck using <code>TerminateProcess()</code>, which is not graceful.</p>\n"}], "owner": {"reputation": 25, "user_id": 8060165, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mdywERHBtWc/AAAAAAAAAAI/AAAAAAAAEbY/vmAop4TdW-Y/photo.jpg?sz=128", "display_name": "Manu Gal&#225;n", "link": "https://stackoverflow.com/users/8060165/manu-gal%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 51637951, "answer_count": 1, "score": 0, "last_activity_date": 1533228782, "creation_date": 1533130441, "last_edit_date": 1533130795, "question_id": 51634706, "link": "https://stackoverflow.com/questions/51634706/tray-icon-app-to-be-closed-from-service", "title": "Tray icon app to be closed from service", "body": "<p>So the title is quite self explanatory.</p>\n\n<p>I have this one service written in C++ that creates a tray icon with CreateProcessAsUser and everything seems to work fine.</p>\n\n<p>The problem comes when stopping the service, which I also want to stop the tray icon application but this has to be done gently, as this application may recieve some data that has to save to a file before exiting.</p>\n\n<p>If useful, the wxWidgets API may be used, but all the process creation is now made with the Windows API, even the tray icon itself is made with wxWiidgets in mind, as well as the service.</p>\n\n<p>Any advice is welcomed!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1533130229, "post_id": 51634601, "comment_id": 90233480, "body": "What problem? What outcome do you expect, what do you observe, and how do the two differ?"}, {"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 0, "creation_date": 1533130231, "post_id": 51634601, "comment_id": 90233481, "body": "Could you elaborate what &quot;some error&quot; means?"}, {"owner": {"reputation": 13, "user_id": 5101133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xV-j3Q4txMQ/AAAAAAAAAAI/AAAAAAAAADk/Kg8vSwP9ukc/photo.jpg?sz=128", "display_name": "light", "link": "https://stackoverflow.com/users/5101133/light"}, "edited": false, "score": 0, "creation_date": 1533130475, "post_id": 51634601, "comment_id": 90233654, "body": "sorry, I have edited for uploading the picture of error info"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5101133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xV-j3Q4txMQ/AAAAAAAAAAI/AAAAAAAAADk/Kg8vSwP9ukc/photo.jpg?sz=128", "display_name": "light", "link": "https://stackoverflow.com/users/5101133/light"}, "edited": false, "score": 0, "creation_date": 1533130626, "post_id": 51634685, "comment_id": 90233748, "body": "I think the unique_lock will be moved to the return value by move constructor, am I wrong?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 13, "user_id": 5101133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xV-j3Q4txMQ/AAAAAAAAAAI/AAAAAAAAADk/Kg8vSwP9ukc/photo.jpg?sz=128", "display_name": "light", "link": "https://stackoverflow.com/users/5101133/light"}, "edited": false, "score": 0, "creation_date": 1533130683, "post_id": 51634685, "comment_id": 90233783, "body": "Yes it will be. What will then happen with that return value? At what point, exactly, do you believe this returned instance of <code>unique_lock</code> is destroyed, and why do you believe that?"}, {"owner": {"reputation": 13, "user_id": 5101133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xV-j3Q4txMQ/AAAAAAAAAAI/AAAAAAAAADk/Kg8vSwP9ukc/photo.jpg?sz=128", "display_name": "light", "link": "https://stackoverflow.com/users/5101133/light"}, "edited": false, "score": 0, "creation_date": 1533131000, "post_id": 51634685, "comment_id": 90234002, "body": "I think the return instance of unique_lock will be destroyed at the end of &quot;if&quot;,such as if(m_data.lock()){...},the returned instance of unique_lock will be destroyed at the &quot;}&quot;"}, {"owner": {"reputation": 13, "user_id": 5101133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xV-j3Q4txMQ/AAAAAAAAAAI/AAAAAAAAADk/Kg8vSwP9ukc/photo.jpg?sz=128", "display_name": "light", "link": "https://stackoverflow.com/users/5101133/light"}, "edited": false, "score": 0, "creation_date": 1533131092, "post_id": 51634685, "comment_id": 90234075, "body": "because the unique_lock will be destroyed at the end of scope of unique_lock"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 13, "user_id": 5101133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xV-j3Q4txMQ/AAAAAAAAAAI/AAAAAAAAADk/Kg8vSwP9ukc/photo.jpg?sz=128", "display_name": "light", "link": "https://stackoverflow.com/users/5101133/light"}, "edited": false, "score": 0, "creation_date": 1533131109, "post_id": 51634685, "comment_id": 90234084, "body": "You think incorrectly. A temporary is destroyed at the end of the full expression - in this case, at the closing paren of <code>if ()</code>, before the body of the statement is reached."}], "tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": true, "score": 4, "last_activity_date": 1533130384, "creation_date": 1533130384, "answer_id": 51634685, "question_id": 51634601, "link": "https://stackoverflow.com/questions/51634601/whats-wrong-with-the-usage-of-thread-and-mutex/51634685#51634685", "title": "What&#39;s Wrong with the usage of thread and mutex", "body": "<p>The temporary <code>unique_lock</code> returned by <code>lock()</code> is destroyed right away, unlocking the mutex. Access to <code>data</code> is not in fact protected from concurrent access. Your program exhibits undefined behavior by way of a data race.</p>\n"}], "owner": {"reputation": 13, "user_id": 5101133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xV-j3Q4txMQ/AAAAAAAAAAI/AAAAAAAAADk/Kg8vSwP9ukc/photo.jpg?sz=128", "display_name": "light", "link": "https://stackoverflow.com/users/5101133/light"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51634685, "answer_count": 1, "score": 1, "last_activity_date": 1533130385, "creation_date": 1533130177, "last_edit_date": 1533130385, "question_id": 51634601, "link": "https://stackoverflow.com/questions/51634601/whats-wrong-with-the-usage-of-thread-and-mutex", "title": "What&#39;s Wrong with the usage of thread and mutex", "body": "<p>I wrote an test project for learning the c++ thread, but some error happened in my program.</p>\n\n<p>the code is sample that a class provide a function that can add data to container and the data will be print in thread, and the data which has been printed will be removed from container.</p>\n\n<p>that is the code:</p>\n\n<pre><code>#include &lt;mutex&gt;\n#include &lt;thread&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nclass Manager\n{\npublic:\n    Manager() \n    {\n        const auto expression = [&amp;]()-&gt;void {return threadProc(); };\n        thread(expression).detach();\n    }\n    ~Manager() {}\n\n    void addData(int num)\n    {\n        if (m_data.lock())\n            m_data.data.push_back(num);\n    }\n\nprivate:\n    struct\n    {\n        vector&lt;int&gt; data;\n        unique_lock&lt;mutex&gt; lock()\n        {\n            return unique_lock&lt;mutex&gt;(m);\n        }\n    private:\n        mutex m;\n    }m_data;\n\n    void threadProc()\n    {\n        while (true)\n        {\n            if (m_data.lock())\n            {\n                for_each(m_data.data.begin(), m_data.data.end(), [](int num)\n                {\n                    cout &lt;&lt; num &lt;&lt; endl;\n                });\n                m_data.data.clear();\n            }\n        }\n    }\n};\n\nint main()\n{\n    Manager manager;\n    manager.addData(1);\n\n    system(\"pause\");\n}\n</code></pre>\n\n<p>when it runs, it will shows </p>\n\n<p><a href=\"https://i.stack.imgur.com/Um851.png\" rel=\"nofollow noreferrer\">error info</a></p>\n\n<p>Could you please tell me where is the problem? thanks!</p>\n"}, {"tags": ["c++", "qt", "plot", "data-structures"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533130312, "post_id": 51634504, "comment_id": 90233539, "body": "Do note that in <code>DataXYv2</code> <code>getTuple</code> returns a reference to a function local object and using that is undefined behavior."}, {"owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "edited": false, "score": 1, "creation_date": 1533130382, "post_id": 51634504, "comment_id": 90233596, "body": "If you store your <code>TupleXY</code> objects in a vector, you can access each point in constant time, I guess, by calling <code>m_tuples.at(i).x</code> and <code>m_tuples.at(i).y</code>, assuming that <code>m_tuples</code> is <code>std::vector&lt;TupleXY&gt;</code> and <code>0 &lt;= i &lt; m_tuples.size()</code>."}, {"owner": {"reputation": 479, "user_id": 2672160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e74b2dfafeb529ea4b2d45fd7b7d763f?s=128&d=identicon&r=PG", "display_name": "LCsa", "link": "https://stackoverflow.com/users/2672160/lcsa"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1533131152, "post_id": 51634504, "comment_id": 90234116, "body": "@NathanOliver Yes, thank you. This would demand the <code>TupleXY</code> class to work with references. I could just <code>get</code> x and y of one tuple separately. @vahancho I use <code>QVector</code>. However, getting access to the member fields is not the question but more the general design of the class if the data shall accessible (which greatly discourages the &quot;two-vectors&quot;-approach) and x-/y-vectors must be constructed..."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533131639, "post_id": 51634504, "comment_id": 90234511, "body": "Do you <b>need</b> an OO design or will fundamental data structures work here?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533131823, "post_id": 51634504, "comment_id": 90234641, "body": "In the graphics world, fundamental drawing is by points or pixels.  Each point has a location.  The graphics API are usually written to either require a Point structure or passing the coordinates separately.  If you want efficiency, design your container around the API of the graphics package.  However, I recommend not using parallel array, or vectors, as they are more prone to maintenance issues versus a container of points."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533131979, "post_id": 51634504, "comment_id": 90234765, "body": "Before optimizing, <b>Profile</b>.  Find out where in your program the most time is spent.  You may want to optimize at the design level.  For example, having the graphics package draw a line or polygon may be more efficient than your program drawing the individual points.  Most graphics packages are optimized for speed."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533132339, "post_id": 51634504, "comment_id": 90235056, "body": "Conceptually, at a low level, you are passing two integers to a function.  This is usually performed using registers; can&#39;t optimize any further here.  The processor will try to load a fixed amount of data, a cache line, from your container into the processor&#39;s data cache.  To help out the processor, you want your X and Y values close to each other.  Thus a container of Points will be more efficient than parallel containers.  With parallel containers, X[0] may not be in the same cache line as Y[0], causing the processor to reload the cache for Y."}, {"owner": {"reputation": 479, "user_id": 2672160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e74b2dfafeb529ea4b2d45fd7b7d763f?s=128&d=identicon&r=PG", "display_name": "LCsa", "link": "https://stackoverflow.com/users/2672160/lcsa"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1533149379, "post_id": 51634504, "comment_id": 90245127, "body": "@ThomasMatthews Thanks for your comments!! As for the first: the OO approach is &quot;necessary&quot;, because several other classes will access the data and I want a clear and consistent representation of it. As for profiling... Yes, I know that you&#39;re right (keyword &quot;premature optimization&quot;... I&#39;m prone to that... but I dared to ask because it&#39;s a quite fundamental design question here...) ---- as for all of your comments: Please copy them into an answer as I would like to accept it. You actually addressed my thoughts and the information you provided helps me to make a choice (and pick version 1). :-)"}], "owner": {"reputation": 479, "user_id": 2672160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e74b2dfafeb529ea4b2d45fd7b7d763f?s=128&d=identicon&r=PG", "display_name": "LCsa", "link": "https://stackoverflow.com/users/2672160/lcsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533129910, "creation_date": 1533129910, "question_id": 51634504, "link": "https://stackoverflow.com/questions/51634504/vector-of-tuples-x1-y1-x2-y2-or-separate-vectors-x1-x2-y1-y2", "title": "Vector of tuples (x1,y1), (x2,y2),... or separate vectors (x1,x2,...), (y1,y2,...)", "body": "<p>I'm looking for a practical and \"good\" object-oriented-C++-Qt way to represent <code>data</code> in the form of tuples (xi,yi):</p>\n\n<pre><code>x  | y\n=======\nx1 | y1\nx2 | y2\n . | .\nxn | yn\n</code></pre>\n\n<p>which will be made available at certain points in my application by <em>reference</em>. This <code>data</code> will be plotted repeatedly in given time intervals during which other functions may access the <code>data</code> reference and modify it, causing the changes to appear in the next plotted \"frame\".</p>\n\n<p>The plotting tool (<code>QCustomPlot</code>) demands the <code>x</code> and <code>y</code> columns as <code>QVector&lt;double&gt;</code>. In the early design stages I made something like (pseudo-code):</p>\n\n<pre><code>class TupleXY {\n    double x;   // xi\n    double y;   // yi\n};\n</code></pre>\n\n<p>used in a <code>QVector&lt;TupleXY&gt; data;</code>.</p>\n\n<p>After the need for the <code>x</code> and <code>y</code> columns/vectors arose <strong>(*)</strong>, when I decided to go for <code>QCustomPlot</code>, I introduced (version 1):</p>\n\n<pre><code>class DataXYv1 {\n    QVector&lt;TupleXY&gt; data; //with direct access\n    QVector&lt;double&gt; getX() const {\n        QVector&lt;double&gt; result;\n        result.reserve(data.size());\n        foreach(TupleXY xy in data)\n            result[i] = xy.x;\n        return result;\n    }\n    QVector&lt;double&gt; getY() const {//analogous}\n};\n</code></pre>\n\n<p>However, <strong>isn't this a very inefficient way to prepare the data for plotting?</strong> This has to be performed for every frame!</p>\n\n<p>Naturally, I created a class (version 2):</p>\n\n<pre><code>class DataXYv2 {\n    QVector&lt;double&gt; x;\n    QVector&lt;double&gt; y;\n    void addTuple(TupleXY xy) {x.append(xy.x); y.append(xy.y);}\n    TupleXY&amp; getTuple(int index) {\n        if (index is valid)\n            return TupleXY(x[index], y[index]) //these have to be references in order to workf or data manipulation...\n        end\n    }\n    ...\n};\n</code></pre>\n\n<p>which delivers the <code>x</code>- and <code>y</code>-vectors directly.</p>\n\n<p>However, this design makes iterating through the vector of data points (xi,yi) more cumbersome, the pairs of (xi,yi) are mapped only via the position in the respective vectors, equal length of the vectors can't be easily assured and, since the data <em>has</em> to be available by reference, the correct mapping can't be guaranteed...</p>\n\n<p>1) Is one of the above versions the preferred/more typical way of doing things? This seems such a trivial situation and yet I can't decide how one would create such a data structure...\n2) How would you, for example, achieve the desired functionality (storing multiple (xi,yi) datapoints, providing direct reference access and the possibility to get x and y vectors)?</p>\n\n<p><strong>(*)</strong> I don't assume that adding the tuples point by point is efficient...</p>\n"}, {"tags": ["c++", "opencv", "image-processing", "opencv-contour"], "comments": [{"owner": {"reputation": 478, "user_id": 9380191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c991dbbe2fbafb9f14ace066c675c8b?s=128&d=identicon&r=PG&f=1", "display_name": "VideoProcessingResearcher", "link": "https://stackoverflow.com/users/9380191/videoprocessingresearcher"}, "edited": false, "score": 0, "creation_date": 1533193197, "post_id": 51634210, "comment_id": 90258321, "body": "You have std::vector of detected points and you know coordinates of all rectangles. Maybe you will simply process all rectangles with existence/absence at least one element of point from your point set inside a rectangle (one &quot;for&quot; operator inside the second &quot;for&quot; operator)?"}, {"owner": {"reputation": 664, "user_id": 5707440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54a4defbda5f9d7982bde84371a83c87?s=128&d=identicon&r=PG&f=1", "display_name": "Grillteller", "link": "https://stackoverflow.com/users/5707440/grillteller"}, "edited": false, "score": 0, "creation_date": 1533198583, "post_id": 51634210, "comment_id": 90261406, "body": "You could use the openCV function <code>cv::pointPolygonTest</code>. I would iterate through all n points and all m rectangles and if the function returns true, you could change the color of rectangle m."}, {"owner": {"reputation": 25, "user_id": 10165745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84f8ab57841a48279ae35bbbb70cda2?s=128&d=identicon&r=PG&f=1", "display_name": "user10165745", "link": "https://stackoverflow.com/users/10165745/user10165745"}, "reply_to_user": {"reputation": 664, "user_id": 5707440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54a4defbda5f9d7982bde84371a83c87?s=128&d=identicon&r=PG&f=1", "display_name": "Grillteller", "link": "https://stackoverflow.com/users/5707440/grillteller"}, "edited": false, "score": 0, "creation_date": 1533366054, "post_id": 51634210, "comment_id": 90329133, "body": "Hi, @Grillteller appreciate your idea. I&#39;ve gone through your idea but when i use vector&lt;Rect&gt; it&#39;s not working. I have to make a rectangle using polylines and after that the function cv::pointPolygonTest works fine."}], "owner": {"reputation": 25, "user_id": 10165745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84f8ab57841a48279ae35bbbb70cda2?s=128&d=identicon&r=PG&f=1", "display_name": "user10165745", "link": "https://stackoverflow.com/users/10165745/user10165745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533129097, "creation_date": 1533129097, "question_id": 51634210, "link": "https://stackoverflow.com/questions/51634210/change-border-color-of-rectangle-when-it-contains-a-point-or-the-points-in-c-u", "title": "change border color of rectangle when it contains a point or the points in c++ using opencv", "body": "<p>I need help changing the color of a rectangle in a grid. So far, I have the rectangles and the grid (which are lines drawn separating the rectangles), and I want to change the color of a single rectangle when it contains any point or points.<a href=\"https://i.stack.imgur.com/G32DW.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>my code looks like below:</p>\n\n<pre><code>#include &lt;opencv2\\highgui\\highgui.hpp&gt;\n#include &lt;opencv2\\imgproc.hpp&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\nusing namespace cv;\nusing namespace std;\n\nMat src; Mat src_gray;\nint thresh = 254;\nint max_thresh = 255;\nRNG rng(12345);\n\nvoid myDrawGrid(Mat &amp;img, int Rows, int Cols, int R, int C)\n{\n    float Height = (img.rows - 1) / Rows;\n    float Width = (img.cols - 1) / Cols;\n\n\n    for (int i = 0; i &lt;= Rows; ++i) {\n        line(img, Point(0, i*Height), Point(img.cols, i*Height), Scalar(255, 0, 0), 2);\n    }\n\n    for (int i = 0; i &lt;= Cols; ++i) {\n        line(img, Point(i*Width, 0), Point(i*Width, img.rows), Scalar(255, 0, 0), 2);\n    }\n\n    int pixel_Dist = 3;\n\n    rectangle(img, Point(C*Width + pixel_Dist, R*Height + pixel_Dist), Point((C + 1)*Width - pixel_Dist, (R + 1)*Height - pixel_Dist), Scalar(0, 255, 0), 1);\n}\n\n\nint main(int argc, char** argv)\n{\n    src = imread(\"E:/emptyhighway.jpg\", 1);\n    cvtColor(src, src_gray, CV_BGR2GRAY);\n\n\n    int ROWS = 11, COLS = 11;\n    for (int r = 0; r &lt; ROWS; ++r) {\n        for (int c = 0; c &lt; COLS; ++c) {\n            myDrawGrid(src, ROWS, COLS, r, c);\n        }\n    }\n\n    Mat threshold_output;\n    vector&lt;vector&lt;Point&gt; &gt; contours;\n    vector&lt;Vec4i&gt; hierarchy;\n    threshold(src_gray, threshold_output, thresh, 255, THRESH_BINARY);\n    findContours(threshold_output, contours, hierarchy, CV_RETR_TREE, CV_CHAIN_APPROX_SIMPLE, Point(0, 0));\n\n    vector&lt;vector&lt;Point&gt; &gt; contours_poly(contours.size());\n    vector&lt;Rect&gt; boundRect(contours.size());\n    vector&lt;Point2f&gt;center(contours.size());\n    vector&lt;float&gt;radius(contours.size());\n\n    for (int i = 0; i &lt; contours.size(); i++)\n    {\n        approxPolyDP(Mat(contours[i]), contours_poly[i], 3, true);\n        boundRect[i] = boundingRect(Mat(contours_poly[i]));\n        minEnclosingCircle(contours_poly[i], center[i], radius[i]);\n    }\n\n    Mat drawing = Mat::zeros(threshold_output.size(), CV_8UC3);\n\n    for (int i = 0; i&lt; contours.size(); i++)\n    {\n        Scalar color = Scalar(0, 0, 240);\n        circle(src, center[i], 2, color, 2, 8, 0);\n        circle(drawing, center[i], 2, color, 2, 8, 0);\n\n        cout &lt;&lt; \"{id:\" &lt;&lt; i &lt;&lt; \",x:\" &lt;&lt; center[i].x &lt;&lt; \",y:\" &lt;&lt; center[i].y &lt;&lt; \"},\" &lt;&lt; flush;\n\n    }\n\n    cout &lt;&lt; \"\\n \\n\" &lt;&lt; flush;\n\n\n    imwrite(\"FinalImg.jpg\", src);\n    namedWindow(\"Contours\", CV_WINDOW_AUTOSIZE);\n    imshow(\"Contours\", drawing);\n    char* source_window = \"Source\";\n    namedWindow(source_window, CV_WINDOW_AUTOSIZE);\n    imshow(source_window, src);\n\n    waitKey(0);\n    return(0);\n\n}\n</code></pre>\n\n<p>Is there any method to achieve it?</p>\n"}, {"tags": ["c++", "qt", "user-interface", "layout", "qt5"], "comments": [{"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533128870, "post_id": 51633994, "comment_id": 90232415, "body": "why do you have <code>ui-&gt;setupUi(this);</code>? This is used when you have UI created in Qt Designer (by mouse). If you have some layout setup in Designer than your widget already have a layout and layout can&#39;t be replaced (Qt logs respective warring about that)."}, {"owner": {"reputation": 71, "user_id": 5176370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936b2871df5bfd65b803e599be952f0f?s=128&d=identicon&r=PG&f=1", "display_name": "k111", "link": "https://stackoverflow.com/users/5176370/k111"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533129241, "post_id": 51633994, "comment_id": 90232720, "body": "Actually I forgot to remove this. But I am not getting at the final point that how to make this structure."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1533131250, "post_id": 51633994, "comment_id": 90234205, "body": "looks like your items are getting stretched . Use <code>addStretch</code> so the free space is stretched instead your labels."}], "answers": [{"tags": [], "owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "is_accepted": true, "score": 1, "last_activity_date": 1533320887, "creation_date": 1533320887, "answer_id": 51678236, "question_id": 51633994, "link": "https://stackoverflow.com/questions/51633994/adding-widgets-and-arranging-them-to-the-corner-of-the-screen-on-qt/51678236#51678236", "title": "Adding widgets and arranging them to the corner of the screen on Qt", "body": "<p>Play around with the layouts like this:</p>\n\n<pre><code>#include \"screen.h\"\n#include &lt;QVBoxLayout&gt;\n#include &lt;QLabel&gt;\n#include &lt;QBitmap&gt;\n#include &lt;QFrame&gt;\n\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent)\n{\n    auto *widget = new QWidget(this);\n    auto *frmLogin = new QFrame(this);\n    auto *layoutMain = new QVBoxLayout(widget);\n    auto *layoutTitle = new QHBoxLayout();\n    auto *layoutLogin = new QHBoxLayout(frmLogin);\n    auto *layoutInfo = new QVBoxLayout();\n    auto *labTitle = new QLabel(tr(\"Some other stuff you want in the title\"), this);\n    auto *labBody = new QLabel(tr(\"Some other stuff you want in the body\"), this);\n    auto *labAvatar = new QLabel(this);\n    auto *labUser = new QLabel(tr(\"User\"), this);\n    auto *labValue = new QLabel(tr(\"Value\"), this);\n    QPixmap p(\":/pix/images/avatars/user.png\");\n\n    labTitle-&gt;setAlignment(Qt::AlignCenter);\n    labTitle-&gt;setStyleSheet(\".QLabel { background-color: white; }\");\n\n    labBody-&gt;setAlignment(Qt::AlignCenter);\n\n    labAvatar-&gt;setPixmap(p);\n    labAvatar-&gt;setMask(p.mask());\n\n    layoutInfo-&gt;addWidget(labUser);\n    layoutInfo-&gt;addWidget(labValue);\n\n    layoutLogin-&gt;addWidget(labAvatar);\n    layoutLogin-&gt;addLayout(layoutInfo);\n\n    frmLogin-&gt;setStyleSheet(\".QFrame { background-color : orange; }\");\n    frmLogin-&gt;setSizePolicy(QSizePolicy::Fixed, QSizePolicy::Fixed);\n\n    layoutTitle-&gt;addWidget(labTitle);\n    layoutTitle-&gt;addWidget(frmLogin);\n\n    layoutMain-&gt;addLayout(layoutTitle);\n    layoutMain-&gt;addWidget(labBody);\n    layoutMain-&gt;setContentsMargins(0, 0, 0, 0);\n    layoutMain-&gt;setSpacing(0);\n\n    setCentralWidget(widget);\n    showFullScreen();\n}\n</code></pre>\n\n<p>The code above results in the following layout:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2SZkb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2SZkb.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 71, "user_id": 5176370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936b2871df5bfd65b803e599be952f0f?s=128&d=identicon&r=PG&f=1", "display_name": "k111", "link": "https://stackoverflow.com/users/5176370/k111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "accepted_answer_id": 51678236, "answer_count": 1, "score": 1, "last_activity_date": 1533320887, "creation_date": 1533128509, "last_edit_date": 1533128823, "question_id": 51633994, "link": "https://stackoverflow.com/questions/51633994/adding-widgets-and-arranging-them-to-the-corner-of-the-screen-on-qt", "title": "Adding widgets and arranging them to the corner of the screen on Qt", "body": "<p>I tried to arrange some widgets which includes two labels and one image on the top right of the screen. I am using a HBoxlayout. When I tried to add the widgets to the screen in HBoxlayout, all the widgets are not getting arranged at the position I want them to placed at. So how can I arrange these to the top of the screen.Here is the code which I tried</p>\n\n<pre><code>#include \"screen.h\"\n#include \"ui_screen.h\"\n#include&lt;QGridLayout&gt;\n#include&lt;QLabel&gt;\n#include&lt;QBitmap&gt;\n\nscreen::screen(QWidget *parent) :\n    QWidget(parent),\n    ui(new Ui::screen)\n{\n    ui-&gt;setupUi(this);\n    QGridLayout *g=new QGridLayout();\n    QHBoxLayout *h=new QHBoxLayout();\n    QLabel *l=new QLabel();\n    QLabel *l2=new QLabel();\n    QLabel *l3=new QLabel();\n    QPixmap p(\":/img/img/user.jpg\");\n    l-&gt;setPixmap(p);\n    l-&gt;setMask(p.mask());\n    l-&gt;show();\n    l-&gt;setStyleSheet(\"QLabel { background-color : red; color : blue; }\");\n    l2-&gt;setText(\"User\");\n    l3-&gt;setText(\"Value\");\n    h-&gt;addWidget(l,0,Qt::AlignRight);\n    h-&gt;addWidget(l2,0,Qt::AlignRight);\n    h-&gt;addWidget(l3,0,Qt::AlignRight);\n    g-&gt;addLayout(h,0,0,1,1,Qt::AlignTop);\n    this-&gt;setLayout(g);\n    this-&gt;showFullScreen();\n}\n\nscreen::~screen()\n{\n    delete ui;\n}\n</code></pre>\n\n<p>The layout which I tried to make <a href=\"https://i.stack.imgur.com/kOl4d.png\" rel=\"nofollow noreferrer\">Sample layout</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/kOl4d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kOl4d.png\" alt=\"enter image description here\"></a></p>\n\n<p>right now I haven't added the left sided labels yet in my code. Thanks in advance :)</p>\n"}, {"tags": ["c++", "oop"], "comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 1, "creation_date": 1533128282, "post_id": 51633851, "comment_id": 90231960, "body": "Why should one care. Use auto and your life is easy :) And also your title says the type ;)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533129187, "post_id": 51633851, "comment_id": 90232681, "body": "your title and your text are two complementary questions... the answer for one is the other"}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1533128325, "creation_date": 1533128325, "answer_id": 51633923, "question_id": 51633851, "link": "https://stackoverflow.com/questions/51633851/what-is-type-int/51633923#51633923", "title": "What is type int(*)[]", "body": "<p><code>auto</code> here gets the type that the function should return automatically. In that case that type is:</p>\n\n<pre><code>int (*)[10]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10165836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64ffa6e6dd1e6b67e2c8a29bd16598b?s=128&d=identicon&r=PG", "display_name": "Hujuk", "link": "https://stackoverflow.com/users/10165836/hujuk"}, "edited": false, "score": 0, "creation_date": 1533129021, "post_id": 51633996, "comment_id": 90232541, "body": "OK, How to do convertation to this type? It does not work <code>((*)[10])matrix</code>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 23, "user_id": 10165836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64ffa6e6dd1e6b67e2c8a29bd16598b?s=128&d=identicon&r=PG", "display_name": "Hujuk", "link": "https://stackoverflow.com/users/10165836/hujuk"}, "edited": false, "score": 0, "creation_date": 1533129153, "post_id": 51633996, "comment_id": 90232654, "body": "@Hujuk - I see you joined only recently, so welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>! This is not a discussion forum, it&#39;s a Q&amp;A platform. We ask questions, and receive answers. If you have a new question, please <a href=\"https://stackoverflow.com/questions/ask\">post it</a>, instead of asking in comments. Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to learn more."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 23, "user_id": 10165836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64ffa6e6dd1e6b67e2c8a29bd16598b?s=128&d=identicon&r=PG", "display_name": "Hujuk", "link": "https://stackoverflow.com/users/10165836/hujuk"}, "edited": false, "score": 0, "creation_date": 1533129267, "post_id": 51633996, "comment_id": 90232734, "body": "@Hujuk - Also, please note I posted a complete function definition. I didn&#39;t say you need to convert anything by casting."}, {"owner": {"reputation": 23, "user_id": 10165836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64ffa6e6dd1e6b67e2c8a29bd16598b?s=128&d=identicon&r=PG", "display_name": "Hujuk", "link": "https://stackoverflow.com/users/10165836/hujuk"}, "edited": false, "score": 0, "creation_date": 1533129404, "post_id": 51633996, "comment_id": 90232848, "body": "@StroryTeller Ok, I understand. Thanks"}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1533128527, "creation_date": 1533128527, "answer_id": 51633996, "question_id": 51633851, "link": "https://stackoverflow.com/questions/51633851/what-is-type-int/51633996#51633996", "title": "What is type int(*)[]", "body": "<p>You don't really want to specify the return type without <code>auto</code> or a type alias. The usual rules for declarators make it quite ugly. But here it is, just follow the spiral rule:</p>\n\n<pre><code>int (*getter())[10] {return matrix;}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 9717380, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dBd_dogEHyw/AAAAAAAAAAI/AAAAAAAAABU/UFP9o9wKGPY/photo.jpg?sz=128", "display_name": "Ekin Ersan", "link": "https://stackoverflow.com/users/9717380/ekin-ersan"}, "is_accepted": false, "score": 0, "last_activity_date": 1533128699, "creation_date": 1533128699, "answer_id": 51634058, "question_id": 51633851, "link": "https://stackoverflow.com/questions/51633851/what-is-type-int/51634058#51634058", "title": "What is type int(*)[]", "body": "<p>Auto means type is going to be decided according to what you returned. So in this case i believe it is and array that holds int arrays. You can just put the type you want to return instead of auto.</p>\n"}], "owner": {"reputation": 23, "user_id": 10165836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64ffa6e6dd1e6b67e2c8a29bd16598b?s=128&d=identicon&r=PG", "display_name": "Hujuk", "link": "https://stackoverflow.com/users/10165836/hujuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 1, "accepted_answer_id": 51633996, "answer_count": 3, "score": 2, "last_activity_date": 1533128699, "creation_date": 1533128102, "last_edit_date": 1533128203, "question_id": 51633851, "link": "https://stackoverflow.com/questions/51633851/what-is-type-int", "title": "What is type int(*)[]", "body": "<p>I've class with matrix and getter</p>\n\n<pre><code>class A\n{\n  int matrix[20][10];\n public:\n   auto getter(){return matrix;}\n};\n</code></pre>\n\n<p>What is a type that <code>auto</code> returned?\nAnd how to return it without using <code>auto</code></p>\n"}, {"tags": ["c++", "makefile"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 3, "creation_date": 1533127861, "post_id": 51633718, "comment_id": 90231695, "body": "Change <code>%.o: %.c</code> to <code>%.o: %.cpp</code> :-)"}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 6796396, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-tWDEXS7vRzs/AAAAAAAAAAI/AAAAAAAAABY/8JP3JW96EBI/photo.jpg?sz=128", "display_name": "Jacob Garby", "link": "https://stackoverflow.com/users/6796396/jacob-garby"}, "edited": false, "score": 0, "creation_date": 1533128139, "post_id": 51633769, "comment_id": 90231874, "body": "You and @Galik are both right, and I&#39;m kicking myself for not noticing that. I&#39;ll accept your answer as soon as I can."}], "tags": [], "owner": {"reputation": 6120, "user_id": 9214517, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uHHGLaUqJK4/AAAAAAAAAAI/AAAAAAAAAAA/EMWzo-f2N9c/photo.jpg?sz=128", "display_name": "adrtam", "link": "https://stackoverflow.com/users/9214517/adrtam"}, "is_accepted": true, "score": 3, "last_activity_date": 1533127860, "creation_date": 1533127860, "answer_id": 51633769, "question_id": 51633718, "link": "https://stackoverflow.com/questions/51633718/makefile-not-building-objects-how-im-telling-it-to/51633769#51633769", "title": "Makefile not building objects how I&#39;m telling it to", "body": "<p>You named your files as *.cpp while your rules said *.c, that's why.</p>\n"}, {"tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 2, "last_activity_date": 1533128048, "creation_date": 1533128048, "answer_id": 51633841, "question_id": 51633718, "link": "https://stackoverflow.com/questions/51633718/makefile-not-building-objects-how-im-telling-it-to/51633841#51633841", "title": "Makefile not building objects how I&#39;m telling it to", "body": "<p>It looks like a half converted Makefile for <code>C</code>. It uses the wrong variables and looks for <code>C</code> files rather than <code>C++</code>. Try this (untested):</p>\n\n<pre><code>CXX := g++\nCXXFLAGS := -Wall -pg\nLDFLAGS := -lsfml-graphics -lsfml-window -lsfml-system\nEXE := gametest\n\nall: $(EXE)\n\n%.o: %.cpp\n    $(CXX) -c $(CXXFLAGS) -o $@ $&lt; \n\n$(EXE): main.o entity.o player.o\n    $(CXX) -o $@ $^ $(LDFLAGS)\n</code></pre>\n\n<p><code>C++</code> uses <code>CXX</code> whereas <code>C</code> uses <code>CC</code>, same with <code>CXXFLAGS</code>.</p>\n\n<p><strong>Note:</strong> Remember the indentations are <code>TAB</code>s not spaces!</p>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 1, "last_activity_date": 1533133136, "creation_date": 1533133136, "answer_id": 51635669, "question_id": 51633718, "link": "https://stackoverflow.com/questions/51633718/makefile-not-building-objects-how-im-telling-it-to/51635669#51635669", "title": "Makefile not building objects how I&#39;m telling it to", "body": "<p>The built-in <code>%.o: %.cpp</code> rule uses <strong><code>CXX</code></strong> (not <code>CC</code>) to specify the compiler, and <strong><code>CXXFLAGS</code></strong> (not <code>CFLAGS</code>) for the flags.  So re-write your Makefile to set those variables, and you don't need to specify the pattern rule yourself:</p>\n\n<pre class=\"lang-make prettyprint-override\"><code>CXX = g++\nCXXFLAGS = -Wall -Wextra -pg\nLIBS = -lsfml-graphics -lsfml-window -lsfml-system\n\ngametest: main.o entity.o player.o\ngametest: LINK.o = LINK.cc\n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 6796396, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-tWDEXS7vRzs/AAAAAAAAAAI/AAAAAAAAABY/8JP3JW96EBI/photo.jpg?sz=128", "display_name": "Jacob Garby", "link": "https://stackoverflow.com/users/6796396/jacob-garby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 51633769, "answer_count": 3, "score": 1, "last_activity_date": 1533133136, "creation_date": 1533127706, "question_id": 51633718, "link": "https://stackoverflow.com/questions/51633718/makefile-not-building-objects-how-im-telling-it-to", "title": "Makefile not building objects how I&#39;m telling it to", "body": "<p>This is my project directory file tree:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 entity.cpp\n\u251c\u2500\u2500 entity.hpp\n\u251c\u2500\u2500 entitytypes.hpp\n\u251c\u2500\u2500 main.cpp\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 player.cpp\n\u2514\u2500\u2500 player.hpp\n</code></pre>\n\n<p><code>Makefile</code>'s contents is this:</p>\n\n<pre><code>CC=g++\nCFLAGS=-Wall -pg\nLDFLAGS=-lsfml-graphics -lsfml-window -lsfml-system\nEXE=gametest\n\nall: $(EXE)\n\n%.o: %.c\n    $(CC) -c $&lt; -o $@ $(CFLAGS)\n\n$(EXE): main.o entity.o player.o\n    g++ $^ -o $@ $(LDFLAGS)\n</code></pre>\n\n<p>And very oddly, this is the output when I type <code>make</code>:</p>\n\n<pre><code>g++    -c -o main.o main.cpp\ng++    -c -o entity.o entity.cpp\ng++    -c -o player.o player.cpp\ng++ main.o entity.o player.o -o gametest -lsfml-graphics -lsfml-window -lsfml-system\n</code></pre>\n\n<p>So as you can see, the last line of the output corresponds to the <code>$(EXE)</code> section of the Makefile. It's linking the program with the correct flags, etc. My problem is that when each individual object file is build, it's not at all taking into account my <code>%.o: %.c</code> rule. This is clear since when it builds the objects, there is a long gap between <code>g++</code> and <code>-c</code>, which I didn't write. Also, it's missing out my $(CFLAGS). Even weirder, when I comment out the <code>%.o: %.c</code> section, the Makefile does the <em>exact</em> same thing.</p>\n\n<p>It seems to me like it's using some kind of default build command, and just ignoring mine.</p>\n\n<p>I've looked at Makefiles I've written in the past which as far as I can tell use the exact same macros in the same way, so I'm very confused as to why this is happening.</p>\n"}, {"tags": ["c++", "mysql", "visual-studio", "visual-studio-2017", "mysql-connector"], "comments": [{"owner": {"reputation": 83, "user_id": 6075992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f512c93d9b612483c9b4be5bc150e74b?s=128&d=identicon&r=PG&f=1", "display_name": "warchiefbinar", "link": "https://stackoverflow.com/users/6075992/warchiefbinar"}, "edited": false, "score": 0, "creation_date": 1533201748, "post_id": 51633717, "comment_id": 90263332, "body": "Anyone? Everything is laid out, it should be pretty simple. It has to be some dummy mistake of mine.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7075574"}, "edited": false, "score": 0, "creation_date": 1553395897, "post_id": 51633717, "comment_id": 97367495, "body": "Did you fix it ?"}, {"owner": {"reputation": 83, "user_id": 6075992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f512c93d9b612483c9b4be5bc150e74b?s=128&d=identicon&r=PG&f=1", "display_name": "warchiefbinar", "link": "https://stackoverflow.com/users/6075992/warchiefbinar"}, "edited": false, "score": 0, "creation_date": 1553593090, "post_id": 51633717, "comment_id": 97431484, "body": "Nope, I didn&#39;t."}], "owner": {"reputation": 83, "user_id": 6075992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f512c93d9b612483c9b4be5bc150e74b?s=128&d=identicon&r=PG&f=1", "display_name": "warchiefbinar", "link": "https://stackoverflow.com/users/6075992/warchiefbinar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1091, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1533149282, "creation_date": 1533127697, "last_edit_date": 1533149282, "question_id": 51633717, "link": "https://stackoverflow.com/questions/51633717/mysql-c-connector-visual-studio-2017", "title": "mySQL C++ connector Visual Studio 2017", "body": "<p>I am pretty new to Visual Studio.. Couldn't find similar topic so starting the new one.\nI'm developig an MFC app and I'd like to use mySQL database engine.\nI believe I have followed instructions from the official site to install the C++ connector:\n<a href=\"https://dev.mysql.com/doc/connector-cpp/8.0/en/connector-cpp-apps-general-considerations.html\" rel=\"nofollow noreferrer\">Building Connector/C++ Applications: General Considerations</a> and\n<a href=\"https://dev.mysql.com/doc/connector-cpp/8.0/en/connector-cpp-apps-windows-visual-studio.html\" rel=\"nofollow noreferrer\">Building Connector/C++ Applications on Windows with Microsoft Visual Studio</a></p>\n\n<p>i.e:</p>\n\n<ol>\n<li><p>I downloaded c++ connector (together with mySQL database engine)</p></li>\n<li><p>I chose to link dynamically against precompiled (by Oracle) c++ connector\nwhich means I need : LIB/vs14/mysqlcppconn8.lib (import library), LIB/mysqlcppconn8-1-vs14.dll</p></li>\n<li><p>I selected debug mode in my configuration (according to the official docs I can do it even though the library itself may be compiled in release mode)</p></li>\n<li>I added Additional Include Directories (Compiler->General) - which in my case is: \"C:\\Program Files\\MySQL\\Connector C++ 8.0\\include\" - this is where mysqlx/xdevapi.h resides</li>\n<li>I added Additional Library Directories (Linker->General) - which in my case is: \"C:\\Program Files\\MySQL\\Connector C++ 8.0\\lib64\"</li>\n<li>I added Additional Dependencies (Linker->Input) which in my case is mysqlcppconn8.lib (static import lib for the dll)</li>\n<li>I changed option for Runtime Library (C++ -> Code Generation) from MDd to MT (as suggested in the documentation)</li>\n<li>I extended the PATH env variable by adding the directory where the actual dll library is located (in my case the location of the file is C:\\Program Files\\MySQL\\Connector C++ 8.0\\lib64\\mysqlcppconn8-1-vs14.dll so the path is C:\\Program Files\\MySQL\\Connector C++ 8.0\\lib64)</li>\n<li>In the wizard-generated MFC project I added #include  and I get following error: fatal error C1083: Cannot open include file: 'mysqlx/xdevapi.h': No such file or directory</li>\n</ol>\n\n<p>I'm wondering what is causing this since I have added Include search path in step 4.</p>\n\n<p>The directory structure for the library is as follows:</p>\n\n<pre><code> C:\\Program Files\\MySQL\\Connector C++ 8.0\\include\\mysqlx\\xdevapi.h\n\n C:\\Program Files\\MySQL\\Connector C++ 8.0\\lib64\\mysqlcppconn8-1-vs14.dll\n\n C:\\Program Files\\MySQL\\Connector C++ 8.0\\lib64\\vs14\\mysqlcppconn8.lib\n</code></pre>\n\n<p>The complier command:</p>\n\n<pre><code> /Yu\"stdafx.h\" /GS /analyze- /W3 /Zc:wchar_t /I\"C:\\Program \n Files\\MySQL\\Connector C++ 8.0\\include\\mysqlx\" /I\"C:\\Program \n Files\\MySQL\\Connector C++ 8.0\\include\" /ZI /Gm /Od /sdl \n /Fd\"Debug\\vc141.pdb\" /Zc:inline /fp:precise /D \"WIN32\" /D \"_WINDOWS\" /D \n \"_DEBUG\" /D \"_UNICODE\" /D \"UNICODE\" /D \"_AFXDLL\" /errorReport:prompt /WX- \n /Zc:forScope /RTC1 /Gd /Oy- /MT /Fa\"Debug\\\" /EHsc /nologo /Fo\"Debug\\\" \n /Fp\"Debug\\exam-questions.pch\" /diagnostics:classic \n</code></pre>\n\n<p>The linker command:</p>\n\n<pre><code>  /OUT:\"C:\\Users\\Kamilek\\source\\repos\\exam-questions\\Debug\\exam- \n  questions.exe\" /MANIFEST /NXCOMPAT \n  /PDB:\"C:\\Users\\Kamilek\\source\\repos\\exam-questions\\Debug\\exam- \n  questions.pdb\" /DYNAMICBASE \"mysqlcppconn8.lib\" /DEBUG:FASTLINK \n  /MACHINE:X86 /INCREMENTAL /PGD:\"C:\\Users\\Kamilek\\source\\repos\\exam- \n  questions\\Debug\\exam-questions.pgd\" /SUBSYSTEM:WINDOWS \n  /MANIFESTUAC:\"level='asInvoker' uiAccess='false'\" \n  /ManifestFile:\"Debug\\exam-questions.exe.intermediate.manifest\" \n  /ERRORREPORT:PROMPT /NOLOGO /LIBPATH:\"C:\\Program Files\\MySQL\\Connector \n  C++ 8.0\\lib64\\\" /TLBID:1 \n</code></pre>\n"}, {"tags": ["c++", "templates", "template-specialization"], "comments": [{"owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 4, "creation_date": 1533127545, "post_id": 51633594, "comment_id": 90231456, "body": "Template parameters are resolved at compile-time, while the variable <code>i</code> is changed at run-time. I.e. you cannot use the variable <code>i</code> as template parameter"}, {"owner": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "reply_to_user": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1533127621, "post_id": 51633594, "comment_id": 90231515, "body": ":( Oh, I see. Probably I need to close this question."}, {"owner": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "reply_to_user": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 1, "creation_date": 1533127693, "post_id": 51633594, "comment_id": 90231565, "body": "@MikevanDyke can you post as an answer I can make it green if you wish."}, {"owner": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "reply_to_user": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1533128088, "post_id": 51633594, "comment_id": 90231839, "body": "@tyker How can I iterate compile time?"}], "answers": [{"tags": [], "owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "is_accepted": false, "score": 2, "last_activity_date": 1533129238, "last_edit_date": 1533129238, "creation_date": 1533128884, "answer_id": 51634122, "question_id": 51633594, "link": "https://stackoverflow.com/questions/51633594/c-using-index-as-template-parameter-in-for-loop/51634122#51634122", "title": "C++ : using index as template parameter in for loop", "body": "<p>As I said in the comments, templates are resolved at compile-time. I.e. only constant values can be used as template parameters, which the variable <code>i</code> is not.</p>\n\n<p>What you can do is some kind of recursive template iteration:</p>\n\n<pre><code>template&lt;CountryName c&gt;\nstruct ForLoop {\n    template&lt;template &lt;CountryName&gt; class Func&gt;\n    static void iterate() {\n        ForLoop&lt;static_cast&lt;CountryName&gt;(c - 1)&gt;::template iterate&lt;Func&gt;();\n        Func&lt;c&gt;()();\n    }\n};\n\n//so that compiler knows when to stop\ntemplate &lt;&gt;\nstruct ForLoop&lt;Armenia&gt; {\n  template &lt;template &lt;CountryName&gt; class Func&gt;\n  static void iterate() {\n    Func&lt;Armenia&gt;()();\n  }\n};\n\n// CountryInfo needs an overloaded ()-operator, whcih get's called in the ForLoop\ntemplate &lt;CountryName n&gt;\nstruct CountryInfo {\n  void operator()() { std::cout &lt;&lt; n &lt;&lt; std::endl; }\n};\n\nint main() {\n  ForLoop&lt;Georgia&gt;::iterate&lt;CountryInfo&gt;();\n  return 0;\n}\n</code></pre>\n\n<p>In the <code>main</code>-function the static <code>ForLoop&lt;Georgia&gt;::iterate</code>-function get's called, this function then substracts 1 from Georgia and calls the function <code>iterate</code> again, until it hits the <code>ForLoop&lt;Armenia&gt;::iterate</code> which is the last function which get's called.\nIn case you have any questions, let me know.</p>\n"}, {"tags": [], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "is_accepted": false, "score": 2, "last_activity_date": 1533128913, "creation_date": 1533128913, "answer_id": 51634131, "question_id": 51633594, "link": "https://stackoverflow.com/questions/51633594/c-using-index-as-template-parameter-in-for-loop/51634131#51634131", "title": "C++ : using index as template parameter in for loop", "body": "<p>What you want is convert a run-time variable into a compile-time variable (which is the requirement for a template argument). There are various ways to achieve this, for example</p>\n\n<pre><code>enum struct Country {\n    Armenia, Georgia, India\n};\n\ntemplate&lt;template&lt;County&gt; class Functor, typename... Args&gt;\nvoid LoopCountries(Args&amp;&amp;...args)\n{\n    { Functor&lt;Armenia&gt; func; func(std::forward&lt;Args&gt;(args)...); }\n    { Functor&lt;Georgia&gt; func; func(std::forward&lt;Args&gt;(args)...); }\n    { Functor&lt;India&gt; func; func(std::forward&lt;Args&gt;(args)...); }\n}\n</code></pre>\n\n<p>which assumes that <code>Functor&lt;&gt;</code> has a member <code>operator()</code>. Now you can simply</p>\n\n<pre><code>LoopCountries&lt;CountryInfo&gt;();\n</code></pre>\n\n<p>A more common situation is to pick one value (instead of looping over all):</p>\n\n<pre><code>template&lt;template&lt;County&gt; class Functor, typename... Args&gt;\nvoid SwitchCountry(Country country, Args&amp;&amp;...args)\n{\n    switch(country) {\n    case Armenia: { Functor&lt;Armenia&gt; func; func(std::forward&lt;Args&gt;(args)...); }\n    case Georgia: { Functor&lt;Georgia&gt; func; func(std::forward&lt;Args&gt;(args)...); }\n    case India: { Functor&lt;India&gt; func; func(std::forward&lt;Args&gt;(args)...); }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "edited": false, "score": 0, "creation_date": 1534260151, "post_id": 51634195, "comment_id": 90643007, "body": "This is close to what I am looking for, but your solution creates tuple with special type.What I would like to have an iteration which creates objects of all specalization types."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "edited": false, "score": 0, "creation_date": 1534265025, "post_id": 51634195, "comment_id": 90645643, "body": "@libxelar.so - sorry but I don&#39;t understand what do you mean. My solution create a <code>std::tuple&lt;CountryInfo&lt;Armenia&gt;, CountryInfo&lt;Georgia&gt;&gt;</code> (see the final <code>static_assert()</code>). What&#39;s your target?"}, {"owner": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "edited": false, "score": 0, "creation_date": 1534278280, "post_id": 51634195, "comment_id": 90651717, "body": "consider following example, I have a lot specializations by value , like CountryInfo&lt;Armenia&gt; , CountryInfo&lt;Russia&gt; etc, where values are from CountryName enum. I would like automate following statement using some compiletime trick ` new  CountryInfo&lt;Armenia&gt;; new  CountryInfo&lt;Russia&gt;; new  CountryInfo&lt;Georgia&gt;; .. 1000 similar expressions here ...  new  CountryInfo&lt;N&gt;;`"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "edited": false, "score": 0, "creation_date": 1534282444, "post_id": 51634195, "comment_id": 90653383, "body": "@libxelar.so - so do you want a <code>std::tuple</code> of dynamic allocated pointers to all different <code>CountryInfo</code> types instead of a <code>std::tuple</code> of objects?"}, {"owner": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "edited": false, "score": 0, "creation_date": 1534337100, "post_id": 51634195, "comment_id": 90669963, "body": "I was seeking for way to somehow iterate over countries and create objects. <a href=\"https://github.com/mm-project/qt_sms_partying/blob/master/src/sms/country.hpp\" rel=\"nofollow noreferrer\">link</a>  line 5344. It was just out of curiosity, off course parsing like that should be completed in run-time. but in any case."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "edited": false, "score": 1, "creation_date": 1534339525, "post_id": 51634195, "comment_id": 90671352, "body": "@libxelar.so - answer modified; hope this helps"}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 2, "last_activity_date": 1541877688, "last_edit_date": 1541877688, "creation_date": 1533129069, "answer_id": 51634195, "question_id": 51633594, "link": "https://stackoverflow.com/questions/51633594/c-using-index-as-template-parameter-in-for-loop/51634195#51634195", "title": "C++ : using index as template parameter in for loop", "body": "<p>As explained by Mike van Dike, a template parameter needs to be known compile-time but your <code>i</code> is modified run time.</p>\n\n<p>You have to use compile-time known indexes.</p>\n\n<p>If you can use C++14, you can use variadic templates, <code>std::make_index_sequence</code> and <code>std::index_sequence</code> so you can do something as follows (see <code>iterateCountry()</code>)</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;type_traits&gt;\n\nenum CountryName \n{\n    Armenia = 0 ,\n    Georgia,\n    Size = 2\n};\n\ntemplate &lt;CountryName variable&gt;\nclass CountryInfo;\n\ntemplate &lt;&gt;\nclass CountryInfo&lt;Armenia&gt; \n{\n    /* CODE HERE */\n};\n\ntemplate &lt;&gt;\nclass CountryInfo&lt;Georgia&gt; \n{\n    /* CODE HERE */\n};\n\ntemplate &lt;std::size_t ... Is&gt;\nauto iterateCountry (std::index_sequence&lt;Is...&gt; const &amp;)\n { return std::make_tuple(CountryInfo&lt;static_cast&lt;CountryName&gt;(Is)&gt;{}...); }\n\n\nint main ()\n {\n   auto ict { iterateCountry(\n                 std::make_index_sequence&lt;static_cast&lt;std::size_t&gt;(\n                    CountryName::Size)&gt;{}) };\n\n   static_assert(std::is_same&lt;decltype(ict),\n                              std::tuple&lt;CountryInfo&lt;Armenia&gt;,\n                                         CountryInfo&lt;Georgia&gt;&gt;&gt;{}, \"!\");\n }\n</code></pre>\n\n<p><strong>-- EDIT --</strong></p>\n\n<p>The OP ask</p>\n\n<blockquote>\n  <p>I was seeking for way to somehow iterate over countries and create objects. link line 5344. </p>\n</blockquote>\n\n<p>It seem's to me that my solution make exactly this.</p>\n\n<p>For your line 5344 case, I suppose you should apply my solution adding a delegating constructor; something as </p>\n\n<pre><code>template &lt;std::size_t ... Is&gt;\nCountryInfoManager (std::index_sequence&lt;Is...&gt; const &amp;)\n  : m_countries{ new CountryInfo&lt;static_cast&lt;CountryName&gt;(Is)&gt;{}... }\n { }\n\nCountryInfoManager ()\n : CountryInfoManager(\n      std::make_index_sequence&lt;static_cast&lt;std::size_t&gt;(\n                CountryName::Size)&gt;{})\n { }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1533129474, "last_edit_date": 1533129474, "creation_date": 1533129082, "answer_id": 51634203, "question_id": 51633594, "link": "https://stackoverflow.com/questions/51633594/c-using-index-as-template-parameter-in-for-loop/51634203#51634203", "title": "C++ : using index as template parameter in for loop", "body": "<p>You could use something like this:</p>\n\n<pre><code>template&lt;std::size_t... I&gt;\nconstexpr auto\ncountries(std::index_sequence&lt;I...&gt;)\n{\n    return std::make_tuple(CountryInfo&lt;static_cast&lt;CountryName&gt;(I)&gt;{}...);\n}\n\nconstexpr auto\nall_countries()\n{\n    return countries(std::make_index_sequence&lt;Size&gt;());\n}\n</code></pre>\n\n<p>The result will be a tuple, with each index containing a country of corresponding type.</p>\n"}], "owner": {"reputation": 320, "user_id": 7153813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vgq2A.jpg?s=128&g=1", "display_name": "libxelar.so", "link": "https://stackoverflow.com/users/7153813/libxelar-so"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1381, "favorite_count": 0, "answer_count": 4, "score": 5, "last_activity_date": 1541877688, "creation_date": 1533127394, "question_id": 51633594, "link": "https://stackoverflow.com/questions/51633594/c-using-index-as-template-parameter-in-for-loop", "title": "C++ : using index as template parameter in for loop", "body": "<p>given following templates and specialization</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>enum CountryName \n{\n    Armenia = 0 ,\n    Georgia,\n    Size = 2\n};\n\ntemplate &lt;CountryName variable&gt;\nclass CountryInfo;\n\ntemplate &lt;&gt;\nclass CountryInfo&lt;Armenia&gt; \n{\n    /* CODE HERE */\n};\n\ntemplate &lt;&gt;\nclass CountryInfo&lt;Georgia&gt; \n{\n    /* CODE HERE */\n};\n</code></pre>\n\n<p>I would like to iterate over enum and create object for each specialization.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>main() {\n    for(auto i=0; i&lt;CountryName::Size; ++i) {\n        CountryInfo&lt;(static_cast&lt;CountryName&gt;(i))&gt;();\n    }       \n}   \n</code></pre>\n\n<p>I get following error:\n<strong>error: the value of 'i' is not usable in a constant expression\n   CountryInfo&lt;(static_cast(i))>();</strong></p>\n"}, {"tags": ["python", "c++", "ctypes"], "comments": [{"owner": {"reputation": 10059, "user_id": 4819449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Sbkk.png?s=128&g=1", "display_name": "FHTMitchell", "link": "https://stackoverflow.com/users/4819449/fhtmitchell"}, "edited": false, "score": 0, "creation_date": 1533127180, "post_id": 51633430, "comment_id": 90231191, "body": "The <code>*</code> means unpack, so <code>list1 = (ctypes.c_int * 3)(*temp1) </code> is expanded to <code>list1 = (ctypes.c_int * 3)(1, 1, 1) </code>"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4353331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/171eb7e6fda29d6bc24b9a77ca8a5bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Leon Brasero", "link": "https://stackoverflow.com/users/4353331/leon-brasero"}, "edited": false, "score": 0, "creation_date": 1533128126, "post_id": 51633667, "comment_id": 90231866, "body": "Thanks! I will try this. Also, when passing it to C++ as an argument, how should I do it? <code>py_function.argtypes = [ctypes.ARRAY]</code> or what is the exact type of this structure in ctypes? Thanks a lot FHTMitchell"}, {"owner": {"reputation": 10059, "user_id": 4819449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Sbkk.png?s=128&g=1", "display_name": "FHTMitchell", "link": "https://stackoverflow.com/users/4819449/fhtmitchell"}, "reply_to_user": {"reputation": 105, "user_id": 4353331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/171eb7e6fda29d6bc24b9a77ca8a5bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Leon Brasero", "link": "https://stackoverflow.com/users/4353331/leon-brasero"}, "edited": false, "score": 0, "creation_date": 1533128299, "post_id": 51633667, "comment_id": 90231978, "body": "the type is <code>ctypes.c_int * 3 * 3</code>, you can just use that. You can save it as <code>c_long_Array_3_Array_3</code> or something (that&#39;s what it&#39;s internal name is)."}], "tags": [], "owner": {"reputation": 10059, "user_id": 4819449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Sbkk.png?s=128&g=1", "display_name": "FHTMitchell", "link": "https://stackoverflow.com/users/4819449/fhtmitchell"}, "is_accepted": true, "score": 1, "last_activity_date": 1533127876, "last_edit_date": 1533127876, "creation_date": 1533127563, "answer_id": 51633667, "question_id": 51633430, "link": "https://stackoverflow.com/questions/51633430/how-to-pass-non-empty-list-of-lists-from-python-to-c-via-ctypes/51633667#51633667", "title": "How to pass (non-empty) list of lists from Python to C++ via ctypes?", "body": "<p><code>??????</code> should be <code>ctypes.c_int * 3 * 3</code></p>\n\n<pre><code>data_final = (ctypes.c_int * 3 * 3)(*data)\n[list(a) for a in data_final]\n# --&gt; [[1, 1, 1], [2, 2, 2], [3, 3, 3]]\n</code></pre>\n\n<hr>\n\n<p>For the record, don't do</p>\n\n<pre><code>data = []\ndata.append(list1)\ndata.append(list2)\ndata.append(list3)\n</code></pre>\n\n<p>This is python, not c++, do</p>\n\n<pre><code>data = [list1, list2, list3]\n</code></pre>\n\n<p>Hell since you're just going to pass it to a function do</p>\n\n<pre><code>data_final = (ctypes.c_int * 3 * 3)(list1, list2, list3)\n</code></pre>\n\n<p>and skip the <code>data</code> step entirely</p>\n\n<hr>\n\n<p>Just for the most pythonic way, if I had data in a <code>N x M</code> list of lists <code>py_list</code>, I'd do</p>\n\n<pre><code>c_array = (c_types.c_int * M * N)(*[(c_types.c_int * M)(*lst) for lst in py_list])\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4353331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/171eb7e6fda29d6bc24b9a77ca8a5bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Leon Brasero", "link": "https://stackoverflow.com/users/4353331/leon-brasero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 51633667, "answer_count": 1, "score": 0, "last_activity_date": 1533127876, "creation_date": 1533126819, "last_edit_date": 1533127191, "question_id": 51633430, "link": "https://stackoverflow.com/questions/51633430/how-to-pass-non-empty-list-of-lists-from-python-to-c-via-ctypes", "title": "How to pass (non-empty) list of lists from Python to C++ via ctypes?", "body": "<p>I have some data in the format:</p>\n\n<pre><code>data = [[1,1,1],[2,2,2],[3,3,3]]\n</code></pre>\n\n<p>How can I pass it to C++ via ctypes?</p>\n\n<p>I can pass individually each one of the lists like this:</p>\n\n<pre><code>import ctypes\n\ntemp1 = [1,1,1]\ntemp2 = [2,2,2]\ntemp3 = [3,3,3]\n\nlist1 = (ctypes.c_int * 3)(*temp1)     #NO IDEA WHAT THE * MEANS\nlist2 = (ctypes.c_int * 3)(*temp2)\nlist3 = (ctypes.c_int * 3)(*temp3)\n</code></pre>\n\n<p>But after that if I try to append all these lists into 'data'...</p>\n\n<pre><code>data.append(list1)\ndata.append(list2)\ndata.append(list3)\n\ndata_final = (ctypes.?????? * 3)(*data)\n</code></pre>\n\n<p>What type am I supposed to put in the ????? Thanks</p>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1533126557, "post_id": 51633306, "comment_id": 90230729, "body": "What error exactly?  Is <code>lib_9_3.so</code> something you built and can modify?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1533126605, "post_id": 51633306, "comment_id": 90230767, "body": "<code>dlopen()</code> doesn&#39;t return a (pointer to a) function, so this code looks fishy..."}, {"owner": {"reputation": 165, "user_id": 5354674, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHJgbdkBHc8/AAAAAAAAAAI/AAAAAAAAABQ/Ctl7q3eTOe8/photo.jpg?sz=128", "display_name": "Mayank Kataruka", "link": "https://stackoverflow.com/users/5354674/mayank-kataruka"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1533127895, "post_id": 51633306, "comment_id": 90231718, "body": "@JohnZwinck , Yea Its something I built and I can modify."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1533131462, "post_id": 51633306, "comment_id": 90234386, "body": "I suggest you build your <code>lib_9_3.so</code> with <code>-Wl,--no-undefined</code> to prevent it building with unsatisfied dependencies.  See <a href=\"https://stackoverflow.com/questions/2356168/force-gcc-to-notify-about-undefined-references-in-shared-libraries\" title=\"force gcc to notify about undefined references in shared libraries\">stackoverflow.com/questions/2356168/&hellip;</a>"}], "owner": {"reputation": 165, "user_id": 5354674, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHJgbdkBHc8/AAAAAAAAAAI/AAAAAAAAABQ/Ctl7q3eTOe8/photo.jpg?sz=128", "display_name": "Mayank Kataruka", "link": "https://stackoverflow.com/users/5354674/mayank-kataruka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1533128009, "answer_count": 0, "score": 0, "last_activity_date": 1533127739, "creation_date": 1533126443, "last_edit_date": 1533127739, "question_id": 51633306, "link": "https://stackoverflow.com/questions/51633306/load-multiple-library-in-c-program", "closed_reason": "Duplicate", "title": "Load Multiple Library in C program", "body": "<p>I dont know if this is a bad question, but I am having some problem of an undefined symbol when my program is run.</p>\n\n<p>I have more than 20 dynamic libraries,</p>\n\n<p>When I run my program that loads my library </p>\n\n<pre><code> void *encode_func  = dlopen(\"lib_9_3.so\", RTLD_LAZY  );\n</code></pre>\n\n<p>It returns error as undefined symbol,</p>\n\n<p>All its symbol depends upon those 20 dynamic libraries\nCan I load all those dynamic libraries in my C program ??? </p>\n\n<p>EDIT::</p>\n\n<pre><code>if ( encode_func == NULL)\n    {\n            fprintf(stderr, \"dlopen failed: %s\\n\", dlerror());\n            return 1;\n    }\n</code></pre>\n\n<p>Code is fine,\ndlerror is returning</p>\n\n<pre><code> dlopen failed: ./lib_9_3.so: undefined symbol: sip_getExtensionParamCountFromFromHdr\n</code></pre>\n\n<p>These symbols are present in my 20 dynamic libraries,\nI found this out by doing  \"nm\"</p>\n\n<p>One more thing, these undefined symbols are not system specific.</p>\n\n<p>Can I load all those dynamic libraries in my C program ??? </p>\n"}, {"tags": ["c#", "c++", "tcp", "winsock", "winsock2"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 2, "creation_date": 1533126469, "post_id": 51633248, "comment_id": 90230662, "body": "When writing communicating programs, you should always <b>look</b> what actually transits between them, because if you don&#39;t, you can never be sure what programm messed up. Install Wireshark or tcpdump and listen to the communication."}, {"owner": {"reputation": 23, "user_id": 10165737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j51ooZAYq60/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qbTsnGiwp0FHubSF-TcYuaSbYy-Q/mo/photo.jpg?sz=128", "display_name": "John John", "link": "https://stackoverflow.com/users/10165737/john-john"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1533126544, "post_id": 51633248, "comment_id": 90230716, "body": "I saw, the dump from the send is different from the receive end. I&#39;m pretty sure its a small convertion thing in the C++ side that I&#39;m missing"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1533126550, "post_id": 51633248, "comment_id": 90230724, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is needed."}, {"owner": {"reputation": 23, "user_id": 10165737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j51ooZAYq60/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qbTsnGiwp0FHubSF-TcYuaSbYy-Q/mo/photo.jpg?sz=128", "display_name": "John John", "link": "https://stackoverflow.com/users/10165737/john-john"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1533126862, "post_id": 51633248, "comment_id": 90230958, "body": "@JonathonReinhart - Added the code, sorry - forgot about :)"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1533127399, "post_id": 51633248, "comment_id": 90231340, "body": "What do you mean by <code>winsock doesn&#39;t support it in the recv() function</code> - isn&#39;t the buffer argument for <code>recv()</code> declared as a <code>void*</code>?"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1533127426, "post_id": 51633248, "comment_id": 90231364, "body": "Okay, well you&#39;re sending a byte array on the C# sode, but it appears you&#39;re trying to interpret it as a string on the C++ side. You have the data in a buffer, but you&#39;re calling the string constructor, which is probably where you&#39;re going wring. Before writing code, you should define your protocol  (on paper). Lay out the fields, their data types, and endianness. Then you can go about implementing it in whatever language. Because we don&#39;t kow what you&#39;re sending, we can&#39;t really tell you how to dissect it."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1533127466, "post_id": 51633248, "comment_id": 90231400, "body": "Concerning C/C++: <code>char</code> is either signed or unsigned. Per standard this is implementation defined by compiler. (If a specific signed-ness is required use <code>signed char</code> or <code>unsigned char</code>.) In your case, I bet <code>char</code> is signed. So, everything &gt;= 0x80 appears as negative number."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1533127582, "post_id": 51633248, "comment_id": 90231490, "body": "<i>&quot;The C++ client receives it with negative values&quot;</i> - what does that mean? The return from <code>recv()</code> is negative? Or what?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1533127679, "post_id": 51633248, "comment_id": 90231556, "body": "You need to show the code sending the data (we need to see the data you send) and the code interpreting the data - why do you think it is &quot;negative&quot;?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1533127982, "post_id": 51633248, "comment_id": 90231778, "body": "When you read elements from <code>char recv[]</code>, just convert them to <code>unsigned char</code> and they will appear positive. E.g. <code>int value0 = (unsigned char)recv[0];</code> (in opposition to <code>int value0 = recv[0];</code> where sign bit extension happens so that <code>value0</code> stores the same negative value as <code>recv[0]</code> does.)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1533128262, "post_id": 51633248, "comment_id": 90231948, "body": "Btw. in you code sample, the argument <code>recv</code> has the same name than the function <code>recv()</code> you intend to use. I wonder if this compiles without error. (<code>int iResult = ::recv(m_socket, recv, BUFFER_LENGTH, 0);</code> has probably better chances but I recommend simply to rename argument <code>recv</code>.)"}, {"owner": {"reputation": 23, "user_id": 10165737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j51ooZAYq60/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qbTsnGiwp0FHubSF-TcYuaSbYy-Q/mo/photo.jpg?sz=128", "display_name": "John John", "link": "https://stackoverflow.com/users/10165737/john-john"}, "edited": false, "score": 0, "creation_date": 1533129281, "post_id": 51633248, "comment_id": 90232750, "body": "Thanks everyone, I&#39;ll try with the unsigned comment, I think it&#39;s just that. I&#39;m sorry about the vagueness of the question, it just that simple thing that doesn&#39;t work, the structure, layout and surroundings work OK."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1533129355, "post_id": 51633248, "comment_id": 90232811, "body": "Btw. if provided address for argument <code>recv</code> has really only <code>BUFFER_LENGTH</code> elements then <code>recv[iResult] = &#39;\\0&#39;</code> is out of range access if the ful amount of <code>BUFFER_LENGTH</code> bytes has been received. (For this, you need storage for at least <code>BUFFER_LENGTH + 1</code> elements.)"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 10165737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j51ooZAYq60/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qbTsnGiwp0FHubSF-TcYuaSbYy-Q/mo/photo.jpg?sz=128", "display_name": "John John", "link": "https://stackoverflow.com/users/10165737/john-john"}, "is_accepted": false, "score": 0, "last_activity_date": 1533130963, "creation_date": 1533130963, "answer_id": 51634877, "question_id": 51633248, "link": "https://stackoverflow.com/questions/51633248/tcp-c-client-to-receive-a-byte-array-from-a-c-server/51634877#51634877", "title": "TCP C++ client to receive a byte array from a c# server", "body": "<p>Well, after some years of working with C# and Python I forgot about the signed and unsigned char*. That was the problem.. Thanks for helping!</p>\n"}], "owner": {"reputation": 23, "user_id": 10165737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j51ooZAYq60/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qbTsnGiwp0FHubSF-TcYuaSbYy-Q/mo/photo.jpg?sz=128", "display_name": "John John", "link": "https://stackoverflow.com/users/10165737/john-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1533130963, "creation_date": 1533126265, "last_edit_date": 1533126830, "question_id": 51633248, "link": "https://stackoverflow.com/questions/51633248/tcp-c-client-to-receive-a-byte-array-from-a-c-server", "title": "TCP C++ client to receive a byte array from a c# server", "body": "<p>I have a C++ client waiting for an answer from a C# server using winsock2.\nThe C# server sends the answer as a Byte Array.\nThe C++ client receives it with negative values.\nI tried using an unsigned char array in C++ but winsock doesn't support it in the recv() function.\nWhat am I missing?</p>\n\n<p>C# side:</p>\n\n<pre><code>private void Send(byte[] arrayToSend, NetworkStream stream)\n{\nif (stream.CanWrite) { stream.Write(arrayToSend, 0, arrayToSend.Length); stream.Flush(); }\nelse { ... }\n}\n</code></pre>\n\n<p>C++ Side:</p>\n\n<pre><code>TCPConnection::Receive(int timeout, char recv[BUFFER_LENGTH])\n{\nint iResult = recv(m_socket, recv, BUFFER_LENGTH, 0);\nif (iResult &lt;= 0) { ... }\nrecv[iResult] = '\\0';\n\n//FOR DEBUG\nstd::string s(recv, iResult);\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "gcc", "visual-studio-2017"], "answers": [{"comments": [{"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533130157, "post_id": 51633884, "comment_id": 90233426, "body": "Thank you. Now I am confident this is a bug :)"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533131522, "post_id": 51633884, "comment_id": 90234428, "body": "Let me know if you report the bug."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533189261, "post_id": 51633884, "comment_id": 90256512, "body": "I have found my way to report it :P"}], "tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": true, "score": 2, "last_activity_date": 1533128602, "last_edit_date": 1533128602, "creation_date": 1533128227, "answer_id": 51633884, "question_id": 51632690, "link": "https://stackoverflow.com/questions/51632690/when-giving-a-template-parameter-a-default-argument-vs-2017-cannot-find-previou/51633884#51633884", "title": "When giving a template parameter a default argument, VS 2017 cannot find previously defined types properly", "body": "<p>I would say that this is definitely a compiler bug. Using the name of a previous template parameter in the default argument of a subsequent parameter is common practice, the standard library itself does it all over the place (e.g., allocators and comparison functions for standard containers). The standard even explicitly mentions this possibility in a note in <a href=\"http://eel.is/c++draft/basic.scope.temp#3\" rel=\"nofollow noreferrer\">[basic.scope.temp] \u00a73</a>.</p>\n\n<p>VS 2015 seems to be affected too. Note that the template doesn't even have to be in another namespace. I stripped down your example a bit further:</p>\n\n<pre><code>template &lt;typename A, typename B = A&gt;\nstruct S;\n\ntemplate &lt;typename C, typename D&gt;\nstruct S {};\n\nint main()\n{\n    S&lt;int&gt; s;\n}\n</code></pre>\n\n<p>and this seems to already trigger the issue\u2026</p>\n"}, {"comments": [{"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533130088, "post_id": 51634241, "comment_id": 90233353, "body": "But here, the parameter is itself a <b>type</b>, I am just changing the <i>name</i> of it. <b>It must not be an error</b> if you write this: <code>double example(double a, int b); &#47;*...*&#47; double example(double c, int d);</code> right? Nothing conflicts."}, {"owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533130298, "post_id": 51634241, "comment_id": 90233529, "body": "You\u2019ve changed the type, not the parameter, so the compiler gives error."}, {"owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533130916, "post_id": 51634241, "comment_id": 90233943, "body": "@L.F. TYPE is not the same as formal parameter. \u2018A\u2019 in \u2018template&lt;typename A&gt;\u2019 is a placeholder for a type, not a parameter. Read the webpage shown in my answer."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533185666, "post_id": 51634241, "comment_id": 90255349, "body": "IMO The equivalent of <code>template&lt;typename A, typename B&gt; class Foo; &#47;*...*&#47; template &lt;typename C, typename D&gt; class Foo;</code> is <code>double example(double a, int b); &#47;*...*&#47; double example(double c, int d);</code>, while the equivalent of <code>double example(double a, int b); &#47;*...*&#47; double example(double a, double b);</code> might be something like <code>template &lt;typename A, typename B&gt; class Foo; &#47;*...*&#47; template &lt;typename A, int B&gt; class Foo;</code> since what changed is the (meta)type of the parameter."}, {"owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533186024, "post_id": 51634241, "comment_id": 90255447, "body": "@L.F. \u2018typename A\u2019 is a placeholder for a type rather than a variable name of formal parameter. You\u2019re totally wrong. The compiler is right."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533187690, "post_id": 51634241, "comment_id": 90255940, "body": "You mean VS is right and GCC and Clang are totally wrong?"}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533187773, "post_id": 51634241, "comment_id": 90255957, "body": "Then how do you interpret the fact that the compiler rejects a in-scope type name <code>A</code> and accepts a never previously defined name <code>C</code>?"}, {"owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533188030, "post_id": 51634241, "comment_id": 90256041, "body": "@L.F. I mean you are wrong and compiler is right. I didn\u2019t say which compiler is better when addressing your error. \u2018B\u2019 in \u2018typename B\u2019 holds a type while \u2018B\u2019 in \u2018int B\u2019 is only a variable name. They\u2019re totally different."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533188199, "post_id": 51634241, "comment_id": 90256096, "body": "Yeah, I agree with you that one is a type while the other is a non-type entity. But this does not mean <code>A</code> and <code>C</code> are conflicting types."}, {"owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533188214, "post_id": 51634241, "comment_id": 90256102, "body": "@L.F. It may be a bug that the complier accept a undefined type C but that\u2019s because your code has error on syntax."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533188243, "post_id": 51634241, "comment_id": 90256111, "body": "So you mean even <code>template &lt;typename A&gt; class Foo; template &lt;typename B&gt; class Foo { };</code> is wrong?"}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533188278, "post_id": 51634241, "comment_id": 90256135, "body": "This may deserve another question though."}, {"owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533188406, "post_id": 51634241, "comment_id": 90256186, "body": "@L.F. Yes, it\u2019s wrong. You defined a type in your definition which is different from that in your declaration."}, {"owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533189072, "post_id": 51634241, "comment_id": 90256430, "body": "@L.F. \u2018A\u2019 in \u2018typename A\u2019 is a placeholder for a type but \u2018A\u2019 is not a concrete type, so compiler won\u2019t compare the type of actual argument with the type defined in your declaration.But compiler will see your definition when running the function. So in your example the compiler accept the undefined type C which is actually defined in your definition. After all, it\u2019s impossible for compilers to report ALL of mistakes in code."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533189210, "post_id": 51634241, "comment_id": 90256488, "body": "If I understand correctly, you mean that the compiler was fooled by my ill-formed declarations and did not manage to diagnose the bug? That&#39;s even worse than I ever thought :P"}, {"owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533189391, "post_id": 51634241, "comment_id": 90256567, "body": "@L.F. Yes, the compiler didn\u2019t manage to diagnose the bug. :P"}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1533189520, "post_id": 51634241, "comment_id": 90256622, "body": "Thank you for all your attention and explanation. I will do further research :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 10165298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f7a484b2c797679c6bda11b934dd06?s=128&d=identicon&r=PG", "display_name": "KeepFurther", "link": "https://stackoverflow.com/users/10165298/keepfurther"}, "is_accepted": false, "score": -1, "last_activity_date": 1533129225, "creation_date": 1533129225, "answer_id": 51634241, "question_id": 51632690, "link": "https://stackoverflow.com/questions/51632690/when-giving-a-template-parameter-a-default-argument-vs-2017-cannot-find-previou/51634241#51634241", "title": "When giving a template parameter a default argument, VS 2017 cannot find previously defined types properly", "body": "<p>Try this.</p>\n\n<pre><code>namespace N {\n    template &lt;typename A, typename B = A&gt;\n    class Foo;\n}\n\ntemplate &lt;typename A, typename B&gt; //A and B is TYPE\nclass N::Foo {\npublic:\n    Foo() = default;\n};\n\nint main()\n{\n    N::Foo&lt;char&gt; foo;\n}\n</code></pre>\n\n<p>You can check the reason in the webpage:<a href=\"https://docs.microsoft.com/en-us/cpp/cpp/templates-cpp\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/cpp/cpp/templates-cpp</a></p>\n\n<blockquote>\n  <p>T is a template parameter; the typename keyword says that this\n  parameter is a placeholder for a type. When the function is called,\n  the compiler will <strong>replace every instance of T</strong> with the concrete type\n  argument that is either specified by the user or deduced by the\n  compiler.</p>\n</blockquote>\n\n<p>For example, <strong>it must be an error</strong> if you write a code like:</p>\n\n<pre><code>double example(double,int);\n\nint main()\n{\n//...\n}\n\ndouble example(double a,double b)\n{\n//...\n}\n</code></pre>\n\n<p>because the TYPE you specified conflicts with the prototype.</p>\n\n<p>(Sorry for my poor English)</p>\n"}], "owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 51633884, "answer_count": 2, "score": 2, "last_activity_date": 1533129225, "creation_date": 1533124605, "question_id": 51632690, "link": "https://stackoverflow.com/questions/51632690/when-giving-a-template-parameter-a-default-argument-vs-2017-cannot-find-previou", "title": "When giving a template parameter a default argument, VS 2017 cannot find previously defined types properly", "body": "<p>The following code:</p>\n\n<pre><code>namespace N {\n    template &lt;typename A, typename B = A&gt;\n    class Foo;\n}\n\ntemplate &lt;typename C, typename D&gt;\nclass N::Foo {\npublic:\n    Foo() = default;\n};\n\nint main()\n{\n    N::Foo&lt;char&gt; foo;\n}\n</code></pre>\n\n<p>involves a (forward) declaration of the class template <code>Foo</code> inside namespace <code>N</code>\nwith two type parameters (<code>A</code> and <code>B</code>). The (forward) declaration gives the second parameter a default value which is identical to the first parameter (<code>A</code>). Later, this class is defined with its parameters differently named (<code>C</code> and <code>D</code>). Since it is already specified, the default is not given.</p>\n\n<p>This compiles in GCC 7.1 and Clang 3.8 (in C++17 mode) except that the unused variable <code>foo</code> is warned. However, VS 2017 15.7.5 (in C++17 mode) says <code>A</code> is undefined identifier, and says it is not a valid type name for parameter <code>D</code>.</p>\n\n<p>To my surprise, when I changed the code into this:</p>\n\n<pre><code>namespace N {\n    template &lt;typename A, typename B = C&gt; //note: A changed into C\n    class Foo;\n}\n\ntemplate &lt;typename C, typename D&gt;\nclass N::Foo {\npublic:\n    Foo() = default;\n};\n\nint main()\n{\n    N::Foo&lt;char&gt; foo;\n}\n</code></pre>\n\n<p>VS accepts it! (It does not compile in GCC or Clang, though)</p>\n\n<p>I think VS is wrong here. It tries to interpret the default argument in a different context (in this specific case, the definition of <code>Foo</code>) whereas GCC and Clang don't. At which step was I wrong? Or is this a bug of VS?</p>\n\n<p>Any help will be appreciated.</p>\n\n<p>(Sorry for my bad English)</p>\n"}, {"tags": ["c++", "c", "recursion", "subset"], "comments": [{"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 0, "creation_date": 1533129218, "post_id": 51632667, "comment_id": 90232706, "body": "And the subset must be contiguous in the original set?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9762426"}, "reply_to_user": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 0, "creation_date": 1533129610, "post_id": 51632667, "comment_id": 90232983, "body": "@Surt yes, subset must be contiguous"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9762426"}, "edited": false, "score": 0, "creation_date": 1533126616, "post_id": 51632745, "comment_id": 90230776, "body": "yah i can do that. But what i want actually is to compare all the subset sum values in the recursive function and then return the maximum value in the main function so that I can use that value for another purpose"}, {"owner": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "edited": false, "score": 1, "creation_date": 1533126868, "post_id": 51632745, "comment_id": 90230963, "body": "Hmm, why can&#39;t you use the value in this way? It seems the same to me."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533128082, "post_id": 51632745, "comment_id": 90231838, "body": "@MavishA it doesnt matter how you compute the value ;) NiVeRs approach is valid, so even if you also need the other subset sums, you can use this approach to calculate the maximum...."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533128144, "post_id": 51632745, "comment_id": 90231878, "body": "@MavishA ... but if you already have all the subset sums, then finding the maximum value amongst them should actually be easier"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9762426"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533129699, "post_id": 51632745, "comment_id": 90233050, "body": "@user463035818  yah, but I&#39;ve not found any good way to store the subset sum. If you look at my code, you can see i want to compare the &quot;sum&quot; values and then find the max from them"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1533130214, "post_id": 51632745, "comment_id": 90233466, "body": "@MavishA remove the C tag and use a <code>std::vector</code> ;)"}], "tags": [], "owner": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "is_accepted": false, "score": 2, "last_activity_date": 1533124762, "creation_date": 1533124762, "answer_id": 51632745, "question_id": 51632667, "link": "https://stackoverflow.com/questions/51632667/finding-the-maximum-sum-from-the-subset-sum-using-recursion/51632745#51632745", "title": "Finding the maximum sum from the subset sum using recursion", "body": "<p>If you are interested in the <em>subset</em> of size <code>k</code> out of set with cardinality <code>n</code> then you don't need to do any of the combination generation stuff. You can just sort the array in <strong>decreasing order</strong> and pick the top <code>k</code> elements, as they are sorted in decreasing order they will give the maximum sum of subset of size <code>k</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "is_accepted": false, "score": 0, "last_activity_date": 1533130675, "creation_date": 1533130675, "answer_id": 51634782, "question_id": 51632667, "link": "https://stackoverflow.com/questions/51632667/finding-the-maximum-sum-from-the-subset-sum-using-recursion/51634782#51634782", "title": "Finding the maximum sum from the subset sum using recursion", "body": "<p>Let see if we can do it using std::algorithms (untested code).</p>\n\n<pre><code>std::partial_sum(data.begin(), data.end(), std::plus&lt;int&gt;);\nstd::vector&lt;int&gt; subSetSum;\nsubSetSum.reserve(data.size()); // -3 but meh.\nstd::transform(data.begin(), data.begin()+subSetLength-1, std::back_inserter(subSetSum), std::minus&lt;int&gt;); // will be negative\nauto maxSum = -std::min_element(subSetSum.begin(), subSetSum.end());\n</code></pre>\n\n<p>But there is no recursion here ...</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9762426"}, "is_accepted": true, "score": 1, "last_activity_date": 1533203018, "creation_date": 1533203018, "answer_id": 51650385, "question_id": 51632667, "link": "https://stackoverflow.com/questions/51632667/finding-the-maximum-sum-from-the-subset-sum-using-recursion/51650385#51650385", "title": "Finding the maximum sum from the subset sum using recursion", "body": "<p>finally I've been able to solve this by setting max globally.\nthis's the modified version</p>\n\n<pre><code>int max1 = 0;\nint combinationRecursion(int start, int end, int index, int r, int *arr, int *data){\n\nif(r == index){\n        int sum = 0;\n    for(int i=0; i&lt;r; i++){\n        int val = data[i];\n        sum = sum + data[i];\n    }\n     if(max1&lt;sum){\n        max1 = sum;\n   }\n\n}\nfor(int i=start; i&lt;end; i++){\n    data[index] = arr[i];\n    combinationRecursion(i+1, end, index+1, r, arr, data);\n}\n return max1;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9762426"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 1, "accepted_answer_id": 51650385, "answer_count": 3, "score": 1, "last_activity_date": 1533203018, "creation_date": 1533124533, "last_edit_date": 1533126803, "question_id": 51632667, "link": "https://stackoverflow.com/questions/51632667/finding-the-maximum-sum-from-the-subset-sum-using-recursion", "title": "Finding the maximum sum from the subset sum using recursion", "body": "<p>I want to print only the maximum sum from the subset sum. What I want actually is to compare all the subset sum values in the function and then return only the maximum sum in the main function. </p>\n\n<p>What I tried to do was to save the subset sum values in a new array. Then compare the values in there. But I couldn't manage to do that as it returns nothing.\n I want suppose input <code>array</code> size is <code>n = 5</code>, <em>number of elements to sum</em> is <code>r = 3</code> And array is :</p>\n\n<pre><code>{1,2,3,4,5}\n</code></pre>\n\n<p>Then maximum sum should be <code>3 + 4 + 5 = 12</code>. But my code returns all the sum. </p>\n\n<p>I want to save the sum values in the newArray</p>\n\n<pre><code>newArray[] = sum;\n</code></pre>\n\n<p>then find the maximum values from the newArray.</p>\n\n<p>This is my <code>code</code> :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nvoid combinationRecursion(int start, int end, int index, int r, int *arr, int *data, int sum){\n\nif(r == index){\n    for(int i=0; i&lt;r; i++){\n        int val = data[i];\n        cout&lt;&lt;val&lt;&lt;' ';\n        sum = sum + data[i];\n\n    }\n    printf(\"sum %d\\n\",sum);\n    printf(\"\\n\");\n\n}\nfor(int i=start; i&lt;end; i++){\n    data[index] = arr[i];\n    combinationRecursion(i+1, end, index+1, r, arr, data, sum);\n   }\n }\n\n int main() {\n     int arr[100], n, data[100], r;\n     scanf(\"%d%d\",&amp;n,&amp;r);\n\nfor(int i=0; i&lt;n; i++) {\n    scanf(\"%d\",&amp;arr[i]);\n}\ncombinationRecursion(0, n, 0, r, arr, data, 0);\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "qt5", "qgraphicsitem"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533124105, "post_id": 51632471, "comment_id": 90229120, "body": "How are you changing the size?"}, {"owner": {"reputation": 67, "user_id": 9762748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d2d3f296b20aecd2c03c2fa1ff450f6?s=128&d=identicon&r=PG&f=1", "display_name": "RaduSR", "link": "https://stackoverflow.com/users/9762748/radusr"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533124554, "post_id": 51632471, "comment_id": 90229410, "body": "I have two QDoubleSpinBox, one for height and one for weight. When the user updates the value in these two I will update the size in the model and also in the Scene."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 1, "creation_date": 1533124737, "post_id": 51632471, "comment_id": 90229507, "body": "you could show the code of that, for me it is that apart from changing the size you are changing the position without realizing it."}, {"owner": {"reputation": 67, "user_id": 9762748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d2d3f296b20aecd2c03c2fa1ff450f6?s=128&d=identicon&r=PG&f=1", "display_name": "RaduSR", "link": "https://stackoverflow.com/users/9762748/radusr"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1533127539, "post_id": 51632471, "comment_id": 90231447, "body": "You were right , I was changing also the position. I found a fix for my issue. Thanks!"}], "owner": {"reputation": 67, "user_id": 9762748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d2d3f296b20aecd2c03c2fa1ff450f6?s=128&d=identicon&r=PG&f=1", "display_name": "RaduSR", "link": "https://stackoverflow.com/users/9762748/radusr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533124123, "creation_date": 1533123924, "last_edit_date": 1533124123, "question_id": 51632471, "link": "https://stackoverflow.com/questions/51632471/qgraphicsitemitempositionhaschanged-issues", "title": "QGraphicsItem::ItemPositionHasChanged issues", "body": "<p>I have a QGraphicsItem and I just want to detect when the position of the object is changed.</p>\n\n<p>I have this function:</p>\n\n<pre><code>QVariant ObjectGraphicsItem::itemChange(GraphicsItemChange change, const \n                                        QVariant &amp;value) {\n   if (change == QGraphicsItem::ItemSelectedHasChanged) {\n      //do something\n   }\n   if (change == QGraphicsItem::ItemPositionHasChanged ) { \n      //here is the issue   \n   }\n      return QGraphicsItem::itemChange(change, value);\n}\n</code></pre>\n\n<p>My problem is that the following condition </p>\n\n<pre><code>change == QGraphicsItem::ItemPositionHasChanged \n</code></pre>\n\n<p>is meet also when I change the size of the object.\nWhat I need is something like below:</p>\n\n<pre><code>if (change == QGraphicsItem::ItemPositionHasChanged ) { \n   objectPositionChanged();\n}\nif (change == QGraphicsItem::ItemSizeHasChanged ) { \n   objectSizeChanged();\n}\n</code></pre>\n\n<p>but QT does not have <strong>QGraphicsItem::ItemSizeHasChanged</strong></p>\n\n<p>Thank you in advance for your help.</p>\n"}, {"tags": ["c++", "smart-pointers", "freertos"], "comments": [{"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 1, "creation_date": 1533124509, "post_id": 51632219, "comment_id": 90229378, "body": "How do you allocate <code>sound</code> ? It&#39;s hard to tell what you&#39;re doing without a minimal example of SoundControl implementation and without knowing how you declare and allocate sound"}, {"owner": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "reply_to_user": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533124716, "post_id": 51632219, "comment_id": 90229497, "body": "@Clonk Is there enought details for now?"}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533125060, "post_id": 51632219, "comment_id": 90229723, "body": "Try to provide a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. Remove unnecessary attribute member to struct. It&#39;s really important to show HOW you allocate your object and store it and how you move reference around."}, {"owner": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "reply_to_user": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533127622, "post_id": 51632219, "comment_id": 90231516, "body": "@Clonk I made complete example. Can you check it now?"}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 0, "creation_date": 1533127650, "post_id": 51632219, "comment_id": 90231534, "body": "I&#39;ll take a look ! Thanks for your effort in making a quality question :)"}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 5, "creation_date": 1533128161, "post_id": 51632219, "comment_id": 90231889, "body": "FreeRTOS <code>queue</code> is a <code>C</code> (con)struct. I highly doubt it was designed with C++ classes in mind and as such it probably can&#39;t handle anything but PODs/trivial classes. I.e. no destructors and such. Looking at the documentation, it just accepts plain <code>void *</code> and copies it to its storage byte-by-byte. You won&#39;t be able to fix it unless they provide C++ API or at least a way to pass deleter."}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1533128213, "post_id": 51632219, "comment_id": 90231919, "body": "My best guess is, that RTOS needs a raw pointer and you pass it, but then the destructor of shared_ptr will clean up the pointer regardless of the passed raw pointer. You have to that manually I&#39;m afraid."}, {"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 4, "creation_date": 1533128300, "post_id": 51632219, "comment_id": 90231980, "body": "FREERTOS queue functions use plain memcpy to add items to queue, just look at source code. Queue is created with sizeof(item) parameter, and then it just copies n bytes to/from the queue. Plain C."}, {"owner": {"reputation": 5576, "user_id": 1794345, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILvFk.jpg?s=128&g=1", "display_name": "Rerito", "link": "https://stackoverflow.com/users/1794345/rerito"}, "edited": false, "score": 0, "creation_date": 1533128361, "post_id": 51632219, "comment_id": 90232036, "body": "When you feed the queue with your <code>container</code> object, I suspect it just does a <code>memcpy</code>, assuming the object is a POD of size <code>sizeof (container)</code>. This doesn&#39;t do well at all with object oriented design and RAII"}, {"owner": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "edited": false, "score": 0, "creation_date": 1533128384, "post_id": 51632219, "comment_id": 90232058, "body": "Thank you for all your comments! It proves my suggestions, but is there any solution to that?"}, {"owner": {"reputation": 5576, "user_id": 1794345, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILvFk.jpg?s=128&g=1", "display_name": "Rerito", "link": "https://stackoverflow.com/users/1794345/rerito"}, "edited": false, "score": 0, "creation_date": 1533128457, "post_id": 51632219, "comment_id": 90232104, "body": "Use a C++ friendly serialization framework?"}, {"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 4, "creation_date": 1533128458, "post_id": 51632219, "comment_id": 90232105, "body": "Pass plain pointers and manage object lifetime yourself, don&#39;t expect this from  FREERTOS."}], "answers": [{"comments": [{"owner": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "edited": false, "score": 0, "creation_date": 1533129535, "post_id": 51634212, "comment_id": 90232937, "body": "Thank you. I probably have to write C++ FreeRTOS queue from scratch."}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "reply_to_user": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "edited": false, "score": 0, "creation_date": 1533131085, "post_id": 51634212, "comment_id": 90234072, "body": "I know that there are C++ wrapper on git hub for freeRTOS, maybe someone already developed something similar. But usually the best solution is to develop something suited to your need."}, {"owner": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "edited": false, "score": 0, "creation_date": 1534601332, "post_id": 51634212, "comment_id": 90769012, "body": "After thinking a lot, I&#39;m using C++ queue with mutex (it is enought in my case)."}], "tags": [], "owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "is_accepted": true, "score": 2, "last_activity_date": 1533129102, "creation_date": 1533129102, "answer_id": 51634212, "question_id": 51632219, "link": "https://stackoverflow.com/questions/51632219/using-shared-ptr-with-freertos-queue/51634212#51634212", "title": "Using shared_ptr with FreeRTOS queue", "body": "<p>A C-style queue of raw pointers will only works for C++ shared_ptr iff <code>std::is_trivial&lt;T&gt;::value</code> is true (mainly POD or trivially copyable object).</p>\n\n<p>Since there are memcpy and other plain C operation manipulating memory the reference count will not be handled properly (because it is C-code behind the scene and it does not call destructor among other thing) and you could end up with a memory leak.</p>\n\n<p>There is no easy way to circumvent this, but the best way is to manage the memory yourself.</p>\n\n<p>See this question also : <a href=\"https://stackoverflow.com/questions/45513057/shared-pointers-and-queues-in-freertos\">Shared pointers and queues in FreeRTOS</a></p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 5157958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec7feed743a5b100e4af8901e484fcb8?s=128&d=identicon&r=PG&f=1", "display_name": "Spacefish", "link": "https://stackoverflow.com/users/5157958/spacefish"}, "is_accepted": false, "score": 0, "last_activity_date": 1588865948, "creation_date": 1588865948, "answer_id": 61661898, "question_id": 51632219, "link": "https://stackoverflow.com/questions/51632219/using-shared-ptr-with-freertos-queue/61661898#61661898", "title": "Using shared_ptr with FreeRTOS queue", "body": "<p>I managed to transform unique pointer into a raw format which could be sent via a message queue.\nSee here: <a href=\"https://codereview.stackexchange.com/questions/241886/using-unique-ptr-in-freertos\">https://codereview.stackexchange.com/questions/241886/using-unique-ptr-in-freertos</a>.</p>\n\n<p>Please note I posted it in code review because I am not sure whether there are really no memory leaks or this can be implemented much more cleanly.\nI will test whether I can actually use this for the IPC in our project.</p>\n"}], "owner": {"reputation": 1257, "user_id": 5697743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00199350bd70257e700ff327d4944efb?s=128&d=identicon&r=PG", "display_name": "val is still with Monica", "link": "https://stackoverflow.com/users/5697743/val-is-still-with-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 51634212, "answer_count": 2, "score": 4, "last_activity_date": 1588865948, "creation_date": 1533123238, "last_edit_date": 1533128042, "question_id": 51632219, "link": "https://stackoverflow.com/questions/51632219/using-shared-ptr-with-freertos-queue", "title": "Using shared_ptr with FreeRTOS queue", "body": "<p>I use ESP-32 and need to pass <code>std::shared_ptr</code> using FreeRTOS queue. However, it loose one link. I think that this is source of a problem:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#define PRINT_USE_COUNT(p) std::cout &lt;&lt; \"Use count: \" &lt;&lt; p.use_count() &lt;&lt; std::endl;\n\nextern \"C\" {\n    #include &lt;freertos/FreeRTOS.h&gt;\n    #include &lt;freertos/task.h&gt;\n    #include &lt;freertos/queue.h&gt;\n}\n\nclass testClass {\n    public:\n        testClass() {\n            std::cout &lt;&lt; \"Class is constructed\" &lt;&lt; std::endl;\n        };\n        virtual ~testClass() {\n            std::cout &lt;&lt; \"Class is destructed\" &lt;&lt; std::endl;\n        };\n};\n\nstruct container {\n    std::shared_ptr&lt;testClass&gt; field;\n};\n\nextern \"C\" void app_main(void) {\n    auto queue = xQueueCreate(1, sizeof(container));\n    auto p = std::make_shared&lt;testClass&gt;();\n    PRINT_USE_COUNT(p); // 1\n    {\n        container c;\n        c.field = p;\n        PRINT_USE_COUNT(p); // 2\n        xQueueSendToBack(queue, &amp;c, 0);\n        PRINT_USE_COUNT(p); // 2\n    }\n    PRINT_USE_COUNT(p); // 1 (Ooops!)\n    {\n        container c;\n        assert(xQueueReceive(queue, &amp;c, 0) == pdTRUE);\n        PRINT_USE_COUNT(c.field); // 1\n    }\n    // Class is destructed\n    std::cout &lt;&lt; \"Test finished\" &lt;&lt; std::endl;\n    vQueueDelete(queue);\n}\n</code></pre>\n\n<p>So there is a pointer in queue, but it isn't counted!</p>\n\n<p>How can I solve this issue (and keep using FreeRTOS queue if possible)? Using <code>std::move</code> doesn't help.</p>\n"}]