[{"tags": ["c++"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 1, "creation_date": 1505347109, "post_id": 46208419, "comment_id": 79380272, "body": "@Brandon, because you should debug your code before asking on StackOverflow"}, {"owner": {"reputation": 787, "user_id": 3011079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d19adde0ec048b371297996ed207a09f?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirM", "link": "https://stackoverflow.com/users/3011079/vladimirm"}, "edited": false, "score": 2, "creation_date": 1505347193, "post_id": 46208419, "comment_id": 79380300, "body": "the expression &#39;a == &lt;something&gt; &amp;&amp; a == &lt;something else&gt;&#39; is always false"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1505348525, "post_id": 46208419, "comment_id": 79380652, "body": "<code>scode</code> is a <code>double</code> when it should be a <code>char</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1505347225, "post_id": 46208488, "comment_id": 79380311, "body": "It&#39;s even more glaring than that. take a look at the definition of <code>scode</code>."}], "tags": [], "owner": {"reputation": 197, "user_id": 8094907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Bbq9G.png?s=128&g=1", "display_name": "JordanOcokoljic", "link": "https://stackoverflow.com/users/8094907/jordanocokoljic"}, "is_accepted": false, "score": 1, "last_activity_date": 1505348448, "last_edit_date": 1505348448, "creation_date": 1505347165, "answer_id": 46208488, "question_id": 46208419, "link": "https://stackoverflow.com/questions/46208419/telephone-bill-project-c/46208488#46208488", "title": "Telephone Bill Project: C++", "body": "<p>As far as I can see (and people in follow-up answers might find more errors), the glaring issue is that you have used the <strong>AND</strong> operator instead of the <strong>OR</strong> operator.</p>\n\n<p>This statement:</p>\n\n<pre><code>if (scode == 'R' &amp;&amp; scode == 'r') {     // Values for Regular service\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>if (scode == 'R' || scode == 'r') {     // Values for Regular service\n</code></pre>\n\n<p>Similarly, this statement:</p>\n\n<pre><code>if (scode == 'P' &amp;&amp; scode == 'p') {  //Values for Premium service\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>if (scode == 'P' || scode == 'p') {  //Values for Premium service\n</code></pre>\n\n<p>A variable can't match two different values at the same time, so the <code>if</code> blocks will never be entered when using <code>&amp;&amp;</code> instead of <code>||</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8606085, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BdsVNBke5iU/AAAAAAAAAAI/AAAAAAAACjI/CCX089AhZuo/photo.jpg?sz=128", "display_name": "Shawn Batz", "link": "https://stackoverflow.com/users/8606085/shawn-batz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1505353530, "creation_date": 1505346572, "last_edit_date": 1505353530, "question_id": 46208419, "link": "https://stackoverflow.com/questions/46208419/telephone-bill-project-c", "title": "Telephone Bill Project: C++", "body": "<p>Alright, I have edited some of the code, so now the question is how it calculates the right final total? I am working on the regular service, and I want it to subtract the 50 free minutes first, then add the extra minutes the user has overused, then multiply the extra minutes by $0.20 and make that into the finaltotal.\nAnd if I have any more mistakes please tell me. I know I have made a lot of mistakes, sorry!\nI have a project to do, and here is the requested functionalities list:</p>\n\n<ul>\n<li><p>Prompts the user to enter an account number, a service code, and the number of minutes the service was used.</p>\n\n<ul>\n<li><p>Regular: Values are \u201cR\u201d and \u201cr\u201d:</p>\n\n<ul>\n<li>$10.00/month</li>\n<li>First 50 min. are free</li>\n<li>Charges for over 50 min. are $0.20 per min.</li>\n</ul></li>\n<li><p>Premium: Values are \u201cP\u201d and \u201cp\u201d:</p>\n\n<p>$25.00/month plus:</p>\n\n<ul>\n<li>Calls between 6 - 18 first 75 min are free, after that they\u2019re $0.10 per min</li>\n<li>Calls between 18 - 6 first 100 min are free, after that they\u2019re $0.05 per min</li>\n</ul></li>\n</ul></li>\n<li><p>If any other character is used then display an error message</p></li>\n<li>Calculate the total and print the bill (display it out)</li>\n</ul>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\nint main()\n{\n// VARIABLES //\nint accnum, minnum, minnumm;\ndouble total, finaltotal, grandtotal, finaltotall;\nchar scode;\n\ncout &lt;&lt; \"Hello, thank you for paying your phone bill.\" &lt;&lt; ends;\ncout &lt;&lt; endl;\ncout &lt;&lt; endl;\n\ncout &lt;&lt; \"Please enter your account number: \";\ncin &gt;&gt; accnum ; //Enter some number\n\ncout &lt;&lt; \"Please enter your service code (r as regular service or p for premium service): \";\ncin &gt;&gt; scode ;  //Enter R or r for regular service and P or p for premium service\n\n        ////////////// THIS IS FOR REGULAR SERVICE //////////////\n\nif (scode == 'R' || scode == 'r') {     // Values for Regular service\n    cout &lt;&lt; \"This service provides 50 minutes for phone calls for 50 minutes for free for $10.00 a month, and charge $0.20 every minute over 50 minutes.\" &lt;&lt; endl;\n    cout &lt;&lt; \"How many minutes have you used up?: \";\n    cin &gt;&gt; minnum;\n    if (minnum &gt; 50) {\n        total = minnum * .20;\n        finaltotal = total + 10;\n        cout &lt;&lt; \"You have made phone calls over 50 minutes, your total will be \" &lt;&lt; finaltotal &lt;&lt; \".\" &lt;&lt; endl;\n        cout &lt;&lt; \"Your account number is \" &lt;&lt; accnum &lt;&lt; \" , with a Regular service. You have used \" &lt;&lt; minnum &lt;&lt; \"/50 minutes. Your total is $\" &lt;&lt; finaltotal &lt;&lt; \" . Thank you for your time.\" &lt;&lt; endl;    //Displays the acc. #, type of service, # of min the phone service used, and amount due from user\n        cout &lt;&lt; endl;\n    } else {\n        cout &lt;&lt; \"You have not made phone calls over 50 minutes, your total will be $\" &lt;&lt; finaltotal &lt;&lt; \".\" &lt;&lt; endl;\n        cout &lt;&lt; \"Your account number is \" &lt;&lt; accnum &lt;&lt; \" , with a Regular service. You have used \" &lt;&lt; minnum &lt;&lt; \"/50 minutes. Your total is $\" &lt;&lt; finaltotal &lt;&lt; \" . Thank you for your time.\" &lt;&lt; endl; //Displays the acc. #, type of service, # of min the phone service used, and amount due from user\n    }\n\n       ////////////// THIS IS FOR PREMIUM SERVICE //////////////\n\n} else if (scode == 'P' || scode == 'p') {  //Values for Premium service\n    cout &lt;&lt; \"This service provides your first 75 minutes phone calls from 6:00 - 18:00, and charge $0.10 for every minute over. Your first 100 minutes for phone calls from 18:00 - 6:00 are free, and charge $0.05 for every minute over.\" &lt;&lt; endl;\n    cout &lt;&lt; \"How many minutes have you used up between 6:00 - 18:00? \";    //Time between 6am - 6pm\n    cin &gt;&gt; minnumm;\n        if (minnumm &gt; 75) {                  //If # of minutes is over 75\n            total = minnumm * .10;           //Then it multiplies total * $.10\n            finaltotall = total + 25;   //Then adds the $10/month\n            cout &lt;&lt; \"You have made phone calls over 75 minutes, your total will be $\" &lt;&lt; finaltotall &lt;&lt; \".\" &lt;&lt; endl;\n        } else {\n            cout &lt;&lt; \"How many minutes have you used up between 18:00 - 6:00? \";  }   //Time between 6pm - 6am\n            cin &gt;&gt; minnum;\n        if (minnum &gt; 100) {                 //If # of minutes is over 100\n            total = minnum * .05;           //Then it multiplies total * $.05\n            finaltotal = total + 25;\n            //Then adds the $25/month\n            cout &lt;&lt; \"You have made phone calls over 100 minutes, your total will be $\" &lt;&lt; finaltotal &lt;&lt; \".\" &lt;&lt; endl;\n\n            grandtotal = finaltotall + finaltotal;  //Calculates both the 6am-6pm and 6pm-6am totals together\n            cout &lt;&lt; \"Your account number is \" &lt;&lt; accnum &lt;&lt; \" , with a Premium service. You have used \" &lt;&lt; minnumm &lt;&lt; \"/75 minutes from 6:00-18:00. You have used\" &lt;&lt; minnum &lt;&lt; \"/100 from 18:00-6:00. Your total is $\" &lt;&lt; grandtotal &lt;&lt; \" . Thank you for your time.\" &lt;&lt; endl; //Displays the acc. #, type of service, # of min the phone service used, and amount due from user\n        } else {\n            cout &lt;&lt; \"You have not made phone calls over 100 minutes, your total will be $\" &lt;&lt; finaltotal &lt;&lt; \".\" &lt;&lt; endl;\n            cout &lt;&lt; \"Your account number is \" &lt;&lt; accnum &lt;&lt; \" , with a Premium service. You have used \" &lt;&lt; minnumm &lt;&lt; \"/75 minutes from 6:00-18:00. You have used \" &lt;&lt; minnum &lt;&lt; \"/100 from 18:00-6:00. Your total is \" &lt;&lt; grandtotal &lt;&lt; \" . Thank you for your time.\" &lt;&lt; endl;\n            cout &lt;&lt; endl;\n            cout &lt;&lt; endl; } //Displays the acc. #, type of service, # of min the phone service used, and amount due from user\n\n        ////////////// THIS IS IF THEY TYPED IN ANY LETTER OTHER THAN R, r, P, p //////////////\n\n} else {        //If user doesn't type P or R, then this is error message\n    cout &lt;&lt; \"Sorry, that service does not exist. Please try again.\" &lt;&lt; endl;\n    cout &lt;&lt; endl; }\n\n\nsystem(\"pause\");\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1505343987, "post_id": 46208065, "comment_id": 79379526, "body": "Pretty sure you have this backwards: <code>members1 = membership_type;</code> The value on the right is assigned into the variable on the left."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1505344271, "post_id": 46208065, "comment_id": 79379594, "body": "In <code>personType::personType()</code>, <code>int personNum = 0;</code> creates a new local (Automatic) variable that <a href=\"https://en.wikipedia.org/wiki/Variable_shadowing\" rel=\"nofollow noreferrer\">shadows</a> the <code>personNum</code> member variable. The local variable is set to 0. The member variable is left uninitialized."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1505344919, "post_id": 46208065, "comment_id": 79379752, "body": "Please rewrite your question, and replace that hard to follow stream of consciousness with a clearly defined and stated question, specifically: instead of paragraphrasing or interpreting whatever compilation errors occur, show the exact compilation errors, verbatim. Figure out how to copy-paste them, and indicate which lines those compilation errors are referencing."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505346482, "post_id": 46208347, "comment_id": 79380106, "body": "On re-read, this is a useful answer, it just needs a bit more explanation up front of what the Asker got wrong, why it is wrong, and how your proposed code solves the problem. Otherwise it is essentially a code-only answer, and all people seem to get from code-only answers is practice cutting and pasting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8556290"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505346573, "post_id": 46208347, "comment_id": 79380130, "body": "@user4581301 nothing wrong just it was a patchwork :) lol. Sorry i didn&#39;t read when i open i was alone and out and i posted without looking after my come back ..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8556290"}, "is_accepted": false, "score": 0, "last_activity_date": 1505345956, "creation_date": 1505345956, "answer_id": 46208347, "question_id": 46208065, "link": "https://stackoverflow.com/questions/46208065/already-defined-in-persontype-error/46208347#46208347", "title": "already defined in persontype error", "body": "<p>You need to organize you class separately :</p>\n\n<pre><code>//main.cpp \n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n#include \"membershipType.h\"\n\n\nmembershipType::membershipType()\n{\n    membership_type = ' ';\n    membership_status = ' ';\n}\nmembershipType::membershipType(char members1, char members2)\n{\n    members1 = membership_type;\n    members2 = membership_status;;\n}\nvoid membershipType::print_member_type()\n{\n    cout &lt;&lt; firstName &lt;&lt; \" \" &lt;&lt; lastName &lt;&lt; \" \" &lt;&lt; gender &lt;&lt; \" \" &lt;&lt;\n    personID &lt;&lt; \" \" &lt;&lt; address.streetAddressNum &lt;&lt; \" \"\n    &lt;&lt; address.streetName &lt;&lt; \" \" &lt;&lt; address.streetType\n    &lt;&lt; \" \" &lt;&lt; address.city &lt;&lt; \" \" &lt;&lt; address.stateInitials\n    &lt;&lt; \" \" &lt;&lt; address.zipCode &lt;&lt; \" \" &lt;&lt; membership_status &lt;&lt; membership_type &lt;&lt; endl;\n}\n\n\npersonType::personType()\n{//constructor\n    int personNum = 0;\n    int personID = 0;\n}\naddressType::addressType() {\n    int zipCode = 0;\n}\nvoid personType::setInterest1(string interest1) {\n    SetInterest1 = interest1;\n}//mutator\nvoid personType::setInterest2(string interest2) {\n    SetInterest2 = interest2;\n}\nstring personType::GetInterest1() const\n{\n    return SetInterest1;\n}// Accessor\nstring personType::GetInterest2() const {\n    return SetInterest2;\n}\n\nvoid personType::printPerson() {//constructor\n\n    cout &lt;&lt; firstName &lt;&lt; \" \" &lt;&lt; lastName &lt;&lt; \" \" &lt;&lt; gender &lt;&lt; \" \" &lt;&lt;\n    personID &lt;&lt; \" \" &lt;&lt; address.streetAddressNum &lt;&lt; \" \"\n    &lt;&lt; address.streetName &lt;&lt; \" \" &lt;&lt; address.streetType\n    &lt;&lt; \" \" &lt;&lt; address.city &lt;&lt; \" \" &lt;&lt; address.stateInitials\n    &lt;&lt; \" \" &lt;&lt; address.zipCode &lt;&lt; \" \" &lt;&lt; SetInterest1 &lt;&lt; \" \" &lt;&lt; SetInterest2 &lt;&lt; endl;\n}\n\nint main() {\n    personType* p = new personType;\n    p-&gt;printPerson();\n}\n</code></pre>\n\n<p>The personType.h :</p>\n\n<pre><code>#include \"addressType.h\"\nclass personType\n{\npublic:\n    personType();\n    std::string firstName;\n    std::string lastName;\n    int personNum;\n    char gender;\n    int personID;\n    addressType address;\n    void setInterest1(std::string interest1);//mutator\n    void setInterest2(std::string interest2);\n    void printPerson();\n    std::string  GetInterest1() const;    // Accessor\n    std::string  GetInterest2() const;\nprivate:\n    std::string SetInterest1;\n    std::string SetInterest2;\n};\n</code></pre>\n\n<p>You addressType.h</p>\n\n<pre><code>class addressType {  //class defintions and prototypes member variables\npublic:\n    addressType();\n    std::string streetAddressNum, streetName, streetType, city, stateInitials;\n    int zipCode;\n};\n</code></pre>\n\n<p>Your membershipType.h</p>\n\n<pre><code>//define membershipType class\nclass membershipType :public personType\n{\npublic:\n    char membership_type;\n    char membership_status;\n    membershipType();  // 1st constructor\n    membershipType(char, char);  // 2nd constructor\n    void print_member_type();\n};\n</code></pre>\n\n<p>1>------ D\u00e9but de la g\u00e9n\u00e9ration\u00a0: Projet\u00a0: ConsoleApplication2, Configuration\u00a0: Release Win32 ------\n1>  main.cpp\n1>  G\u00e9n\u00e9ration de code en cours\n1>  All 52 functions were compiled because no usable IPDB/IOBJ from previous compilation was found.\n1>  Fin de la g\u00e9n\u00e9ration du code\n1>  ConsoleApplication2.vcxproj -> C:\\out\\frosbite_sdk_typeinfo\\SDK\\ConsoleApplication2\\Release\\ConsoleApplication2.exe\n========== G\u00e9n\u00e9ration\u00a0: 1 a r\u00e9ussi, 0 a \u00e9chou\u00e9, 0 mis \u00e0 jour, 0 a \u00e9t\u00e9 ignor\u00e9 ==========</p>\n"}], "owner": {"reputation": 1, "user_id": 7217634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cffe8812c624073f7c4f71e5310fe6a5?s=128&d=identicon&r=PG&f=1", "display_name": "rich", "link": "https://stackoverflow.com/users/7217634/rich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505345956, "creation_date": 1505343698, "question_id": 46208065, "link": "https://stackoverflow.com/questions/46208065/already-defined-in-persontype-error", "title": "already defined in persontype error", "body": "<p>I keep an error basically saying all membershiptype functions are already declared created in the persontype class i was wondering how do i fix this error the first error message says that membershiptime::membershiptype is also defined in the person type object which it is not,and also the second error message says that the second construcor is also already defined in persontype how do i fix this error?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\nclass addressType {  //class defintions and prototypes member variables\npublic:\n    addressType();\n    string streetAddressNum, streetName, streetType, city, stateInitials;\n    int zipCode;\n};\nclass personType\n{\npublic:\n    personType();\n    string firstName;\n    string lastName;\n    int personNum;\n    char gender;\n    int personID;\n    addressType address;\n    void setInterest1(string interest1);//mutator\n    void setInterest2(string interest2);\n    void printPerson();\n    string  GetInterest1() const;    // Accessor\n    string  GetInterest2() const;\nprivate:\n    string SetInterest1;\n    string SetInterest2;\n};\n\n//define membershipType class\nclass membershipType :public personType\n{\npublic:\n    char membership_type;\n    char membership_status;\n    membershipType();  // 1st constructor\n    membershipType(char, char);  // 2nd constructor\n    void print_member_type();\n};\n membershipType::membershipType() \n{\n     membership_type = ' ';\n     membership_status = ' ';\n}\n membershipType::membershipType(char members1, char members2)\n {\n     members1 = membership_type;\n     members2 = membership_status;;\n }\nvoid membershipType::print_member_type()\n{\n    cout &lt;&lt; firstName &lt;&lt; \" \" &lt;&lt; lastName &lt;&lt; \" \" &lt;&lt; gender &lt;&lt; \" \" &lt;&lt;\n        personID &lt;&lt; \" \" &lt;&lt; address.streetAddressNum &lt;&lt; \" \"\n        &lt;&lt; address.streetName &lt;&lt; \" \" &lt;&lt; address.streetType\n        &lt;&lt; \" \" &lt;&lt; address.city &lt;&lt; \" \" &lt;&lt; address.stateInitials\n        &lt;&lt; \" \" &lt;&lt; address.zipCode &lt;&lt; \" \" &lt;&lt;membership_status&lt;&lt;membership_type&lt;&lt;endl;\n}\n\n\n#include \"personType.h\"\npersonType::personType()\n{//constructor\n    int personNum = 0;\n    int personID = 0;\n}\naddressType::addressType() {\n    int zipCode = 0;\n}\nvoid personType::setInterest1(string interest1) {\n    SetInterest1 = interest1;\n}//mutator\nvoid personType::setInterest2(string interest2) {\n    SetInterest2 = interest2;\n}\nstring personType::  GetInterest1() const\n{\n    return SetInterest1;\n}// Accessor\nstring personType:: GetInterest2() const {\n    return SetInterest2;\n}\n\nvoid personType :: printPerson() {//constructor\n\n    cout &lt;&lt; firstName &lt;&lt; \" \" &lt;&lt; lastName &lt;&lt; \" \" &lt;&lt; gender &lt;&lt; \" \" &lt;&lt;\n        personID &lt;&lt; \" \" &lt;&lt; address.streetAddressNum &lt;&lt; \" \"\n        &lt;&lt; address.streetName &lt;&lt; \" \" &lt;&lt; address.streetType\n        &lt;&lt; \" \" &lt;&lt; address.city &lt;&lt; \" \" &lt;&lt; address.stateInitials\n        &lt;&lt; \" \" &lt;&lt; address.zipCode &lt;&lt; \" \" &lt;&lt; SetInterest1 &lt;&lt; \" \" &lt;&lt; SetInterest2 &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "gcc"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1505346944, "post_id": 46207999, "comment_id": 79380222, "body": "Why not expose a <code>CreateInstance</code> function rather than requiring user code to define (some) functions?  <a href=\"http://coliru.stacked-crooked.com/a/5e84854041391a9c\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/5e84854041391a9c</a>"}, {"owner": {"reputation": 166, "user_id": 7269461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/963hx.png?s=128&g=1", "display_name": "David R", "link": "https://stackoverflow.com/users/7269461/david-r"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1505400274, "post_id": 46207999, "comment_id": 79407066, "body": "@aschepler - I like that pattern. But say I have a board object, and I want to initialize a <code>Uart&amp;</code> reference with a call to <code>GetInstance(2)</code>. How do I guarantee that <code>CreateInstance(2)</code> will be invoked some time prior to that object reference being initialized?"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1505344943, "last_edit_date": 1505344943, "creation_date": 1505344147, "answer_id": 46208132, "question_id": 46207999, "link": "https://stackoverflow.com/questions/46207999/c-must-all-static-class-methods-be-defined-even-when-not-used/46208132#46208132", "title": "c++ - Must all static class methods be defined, even when not used?", "body": "<blockquote>\n  <p>TL;DR - Am I required to define all static methods within a class, even if those static methods are never called by the application</p>\n</blockquote>\n\n<p>You may be required to define such static methods, even if they are never called by the application.</p>\n\n<p>But, in general, you might not need to, if those functions are not <a href=\"http://en.cppreference.com/w/cpp/language/definition\" rel=\"nofollow noreferrer\">odr-used</a> (one definition rule). For static member functions, this is equivalent to</p>\n\n<blockquote>\n  <p>A function whose name appears as a potentially-evaluated expression</p>\n</blockquote>\n\n<p>The difference is subtle. I hope this demonstrates it:</p>\n\n<pre><code>if(false)\n    function();\n</code></pre>\n\n<p><code>function</code> is never called, but appears in a potentially-evaluated expression, and is therefore odr-used and therefore must be defined. </p>\n\n<hr>\n\n<blockquote>\n  <p>My question here is... does C++11 require me to have all three storage methods defined in my executable?</p>\n</blockquote>\n\n<p>Yes. They all appear in potentially-evaluated expressions and are therefore odr-used and therefore must be defined.</p>\n\n<blockquote>\n  <p>I was developing an earlier application using ... GCC 4.8.4 and compiles and links with no errors.</p>\n</blockquote>\n\n<p>Odr violations have undefined behaviour, which explains why you didn't get an error / warning in the other tool chain.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1505344688, "last_edit_date": 1592644375, "creation_date": 1505344688, "answer_id": 46208197, "question_id": 46207999, "link": "https://stackoverflow.com/questions/46207999/c-must-all-static-class-methods-be-defined-even-when-not-used/46208197#46208197", "title": "c++ - Must all static class methods be defined, even when not used?", "body": "<blockquote>\n<p>[basic.def.odr]</p>\n<ol start=\"4\">\n<li>Every program shall contain exactly one definition of every non-inline function or variable that is odr-used in\nthat program outside of a discarded statement (9.4.1); no diagnostic required.</li>\n</ol>\n</blockquote>\n<p>This is from a relatively new draft standard, but all versions contain a similar statement.</p>\n<p>The &quot;no diagnostic required&quot; clause gives your compiler permission to accept your program even if it violates the rule. An odr-use within an unreachable piece of code is exactly the case when it is reasonable to do so: a compiler may or may not optimise away dead code that contains the offending call. Your program is still in violation and another implementation may reject it.</p>\n"}], "owner": {"reputation": 166, "user_id": 7269461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/963hx.png?s=128&g=1", "display_name": "David R", "link": "https://stackoverflow.com/users/7269461/david-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 46208132, "answer_count": 2, "score": 2, "last_activity_date": 1505344943, "creation_date": 1505343184, "question_id": 46207999, "link": "https://stackoverflow.com/questions/46207999/c-must-all-static-class-methods-be-defined-even-when-not-used", "title": "c++ - Must all static class methods be defined, even when not used?", "body": "<p>So, I've got an issue, and I'm not sure if it's a language issue, or a compiler/GCC issue.</p>\n\n<p><strong>TL;DR</strong> - Am I required to <strong>define</strong> all static methods within a class, even if those static methods are <strong>never called</strong> by the application (i.e. could be legitimately dropped by the linker anyway)?</p>\n\n<p>I have a library class that implements a device driver for a UART in a microcontroller.  Because I don't want multiple UART objects pointing to the same resource, each UART object is a singleton, retrieved using one of several <code>GetInstance()</code> methods, one for each UART instance in the device (UART0, UART1, etc).  Each UART instance needs to have two FIFOs (Tx and Rx) for storage.  Each FIFO needs to be explicitly sized by the <strong>application</strong> and allocated at the time that the UART object is instantiated (ideally).  So I also have several static <code>GetStorage()</code> methods, again, once for each UART.</p>\n\n<p>I've created some stripped down code for my proof of concept.  Here's static_instance.h:</p>\n\n<pre><code>#ifndef STATIC_INSTANCE_H_\n#define STATIC_INSTANCE_H_\n\n#ifdef __cplusplus\n#include &lt;vector&gt;\nnamespace foo {\nclass Uart {\n public:\n  /* Retrieve a singleton instance, using lazy static initialization.  Note\n   * that not all instances will be present for a given device. */\n  static Uart&amp; Uart1GetInstance(void);\n  static Uart&amp; Uart2GetInstance(void);\n  static Uart&amp; Uart3GetInstance(void);\n  /* Does something. */\n  void DoSomething(void) { ++counter; }\n private:\n  /* Structure for the storage that each static Uart instance requires. */\n  struct Storage {\n    Storage(std::vector&lt;char&gt;&amp; vector)\n        : my_vector_(vector) { }\n    std::vector&lt;char&gt;&amp; my_vector_;   // Buffer for data.\n  };\n  /* Instantiate object using provided register base and FIFO structures. */\n  Uart(int instance, Storage&amp; storage)\n      : instance_(instance), storage_(storage) { }\n  ~Uart() { }\n  /* Retrieves the storage required for the static Uart object instances.\n   * These methods are NOT implemented in static_instance.cc, but must be\n   * implemented in the application code, only for those Uart instances\n   * that are invoked in the application. */\n  static Storage&amp; Uart1GetStorage(void);\n  static Storage&amp; Uart2GetStorage(void);\n  static Storage&amp; Uart3GetStorage(void);\n  int const instance_;    // Instance number of this object.\n  Storage&amp; storage_;      // Allocated storage for this object.\n  int counter = 0;        // Dummy counter.\n};\n} // namespace foo\n#endif  // __cplusplus\n\n#endif\n</code></pre>\n\n<p>And here's static_instance.cc:</p>\n\n<pre><code>#include &lt;static_instance.h&gt;\nnamespace foo {\n\nUart&amp; Uart::Uart1GetInstance(void) {\n  static Uart uart(1, Uart1GetStorage());\n  return uart;\n}\nUart&amp; Uart::Uart2GetInstance(void) {\n  static Uart uart(2, Uart2GetStorage());\n  return uart;\n}\nUart&amp; Uart::Uart3GetInstance(void) {\n  static Uart uart(3, Uart3GetStorage());\n  return uart;\n}\n\n} // namespace foo\n</code></pre>\n\n<p>The idea is that you only call <code>GetInstance()</code> for the UART instance you actually need, and then only define <code>GetStorage()</code> for that UART instance.  (For this example, I'm only defining one buffer, and using <code>std::vector&lt;char&gt;</code> as a stand-in.)  Further, it's left to the application to define the storage method, because each application is going to have its own requirements for how big a given UART's buffer needs to be.  (What I absolutely won't do is put macros in my C++ module, because, ew.)  Here's the code snippet in main.cc to instantiate UART2:</p>\n\n<pre><code>namespace foo {\n\nUart::Storage&amp; Uart::Uart2GetStorage(void) {\n  static std::vector&lt;char&gt; rx_vector(256, 0);\n  static Uart::Storage storage(rx_vector);\n  return storage;\n}\nstatic foo::Uart&amp; uart_ = foo::Uart::Uart2GetInstance();\nvoid wibble(void) {\n  uart_.DoSomething();\n}\n\n} // namespace foo\n</code></pre>\n\n<p>Now, I was developing an earlier application using an earlier IDE for this chip (Kinetis Design Studio v3.2.0 for the curious), which uses <strong>GCC 4.8.4</strong> and compiles and links with <strong>no errors</strong>.</p>\n\n<p>But NXP has deprecated KDS for another toolchain (MCUXpresso 10.0), which uses <strong>GCC 5.4.1</strong>, and using the exact same code, this time I get <strong>two linker errors</strong>:</p>\n\n<pre><code>./source/static_instance.o: In function 'foo::Uart::Uart1GetInstance()':\n../source/static_instance.cc:5: undefined reference to 'foo::Uart::Uart1GetStorage()'\n./source/static_instance.o: In function 'foo::Uart::Uart3GetInstance()':\n../source/static_instance.cc:13: undefined reference to 'foo::Uart::Uart3GetStorage()'\n</code></pre>\n\n<p>I'm not sure why the linker cares that the <code>GetStorage()</code> methods for UART1 and UART3 aren't defined, because I'm not calling <code>GetInstance()</code> for either UART1 or UART3 in my application, and thus never calling the corresponding <code>GetStorage()</code> methods either.</p>\n\n<p>My question here is... does C++11 <strong>require</strong> me to have all three storage methods defined in my executable?  That is, was GCC 4.8.4 letting me get away with something that I shouldn't have been able to?  Or is this some GCC 5.4 option that I need to toggle, to allow me to drop unused static members from a class?</p>\n\n<p>If the answer is \"you have to define them regardless\", then I'll define them, or maybe engineer some other way to allow.  If the answer is \"that should be OK\", and there's no option that I can set on the command line to make GCC 5.4 do it, then I'll take the next step and report a bug in the NXP forums.  Thanks.</p>\n"}, {"tags": ["c++", "opengl", "3d", "glfw", "glm-math"], "comments": [{"owner": {"reputation": 8756, "user_id": 416274, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa38a4e372afb202e6ab7eb1619372a8?s=128&d=identicon&r=PG", "display_name": "Robinson", "link": "https://stackoverflow.com/users/416274/robinson"}, "edited": false, "score": 0, "creation_date": 1505343976, "post_id": 46207996, "comment_id": 79379524, "body": "Have you checked glGetError() after every call?"}, {"owner": {"reputation": 111, "user_id": 6109789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab24b05c4c3e5dd337234dbaabc7bfde?s=128&d=identicon&r=PG&f=1", "display_name": "questions", "link": "https://stackoverflow.com/users/6109789/questions"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1505404577, "post_id": 46207996, "comment_id": 79410050, "body": "@Rabbid76 yup I did check that, they are loaded"}, {"owner": {"reputation": 111, "user_id": 6109789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab24b05c4c3e5dd337234dbaabc7bfde?s=128&d=identicon&r=PG&f=1", "display_name": "questions", "link": "https://stackoverflow.com/users/6109789/questions"}, "reply_to_user": {"reputation": 8756, "user_id": 416274, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa38a4e372afb202e6ab7eb1619372a8?s=128&d=identicon&r=PG", "display_name": "Robinson", "link": "https://stackoverflow.com/users/416274/robinson"}, "edited": false, "score": 0, "creation_date": 1505405070, "post_id": 46207996, "comment_id": 79410432, "body": "@Robinson tried &quot;while ((err = glGetError()) != GL_NO_ERROR) \t\t{ \t\t\tstd::cout &lt;&lt; err &lt;&lt; &quot;test&quot; &lt;&lt; std::endl; \t\t} &quot; and got no errors after every call"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user755921"}, "is_accepted": false, "score": 2, "last_activity_date": 1505361016, "creation_date": 1505361016, "answer_id": 46210227, "question_id": 46207996, "link": "https://stackoverflow.com/questions/46207996/opengl-3d-cube-wont-render-correctly-on-windows/46210227#46210227", "title": "Opengl 3D cube won&#39;t render correctly on Windows", "body": "<p>You are setting a uniform on the shader before you activate the shader, that seems wrong.</p>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 6109789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab24b05c4c3e5dd337234dbaabc7bfde?s=128&d=identicon&r=PG&f=1", "display_name": "questions", "link": "https://stackoverflow.com/users/6109789/questions"}, "edited": false, "score": 0, "creation_date": 1505404513, "post_id": 46211061, "comment_id": 79410014, "body": "made all the necessary changes but still the same result"}, {"owner": {"reputation": 111, "user_id": 6109789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab24b05c4c3e5dd337234dbaabc7bfde?s=128&d=identicon&r=PG&f=1", "display_name": "questions", "link": "https://stackoverflow.com/users/6109789/questions"}, "edited": false, "score": 1, "creation_date": 1505414236, "post_id": 46211061, "comment_id": 79415805, "body": "I tried that too. I think this my be my computer instead. I went back to the mac and it still worked. I am gonna ask a friend if I can borrow their computer tomorrow and test it out there instead. I will let you know if that was the problem"}, {"owner": {"reputation": 111, "user_id": 6109789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab24b05c4c3e5dd337234dbaabc7bfde?s=128&d=identicon&r=PG&f=1", "display_name": "questions", "link": "https://stackoverflow.com/users/6109789/questions"}, "edited": false, "score": 0, "creation_date": 1523605460, "post_id": 46211061, "comment_id": 86638036, "body": "sorry forgot to reply to this!! it turns it was my computer - in particular my graphics card"}], "tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 5, "last_activity_date": 1505366345, "creation_date": 1505366345, "answer_id": 46211061, "question_id": 46207996, "link": "https://stackoverflow.com/questions/46207996/opengl-3d-cube-wont-render-correctly-on-windows/46211061#46211061", "title": "Opengl 3D cube won&#39;t render correctly on Windows", "body": "<p>In the fragment shader the name of the texture sampler uniform is <code>\"ourTexture1\"</code>:</p>\n\n<pre><code>uniform sampler2D ourTexture1;\n</code></pre>\n\n<p>but when you try to get the location of the texture sampler uniform you use the name <code>\"ourTexture\"</code>:</p>\n\n<pre><code>glGetUniformLocation(ourShader.Program, \"ourTexture\")\n</code></pre>\n\n<p><br/>\nThe second issue is, that you set the texture sampler uniform <code>ourTexture1</code> before the program is part of the current rendering state.</p>\n\n<pre><code>glUniform1i(glGetUniformLocation(ourShader.Program, \"ourTexture\"), 0);\nourShader.Use();\n</code></pre>\n\n<p>The locations of the uniforms, can be retrieved (<a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetUniformLocation.xhtml\" rel=\"noreferrer\"><code>glGetUniformLocation</code></a>) at any time after the program is linked (<a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glLinkProgram.xhtml\" rel=\"noreferrer\"><code>glLinkProgram</code></a>).</p>\n\n<pre><code>glLinkProgram( ourShader.Program );\n\nGLint modelLoc = glGetUniformLocation( ourShader.Program, \"model\" );\nGLint viewLoc  = glGetUniformLocation( ourShader.Program, \"view\" );\nGLint projLoc  = glGetUniformLocation( ourShader.Program, \"projection\" );\nGLint texLoc   = glGetUniformLocation( ourShader.Program, \"ourTexture1\" );\n</code></pre>\n\n<p>But the uniforms can not be set (<a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glUniform.xhtml\" rel=\"noreferrer\"><code>glUniform</code></a>) until the program is the active program (<a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glUseProgram.xhtml\" rel=\"noreferrer\"><code>glUseProgram</code></a>).</p>\n\n<pre><code>glUseProgram( ourShader.Program );\n\nglUniformMatrix4fv( modelLoc, 1, GL_FALSE, glm::value_ptr(model) );\nglUniformMatrix4fv( viewLoc, 1, GL_FALSE, glm::value_ptr(view) );\nglUniformMatrix4fv( projLoc, 1, GL_FALSE, glm::value_ptr(projection) );\nglUniform1i( texLoc, 0 );\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 6109789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab24b05c4c3e5dd337234dbaabc7bfde?s=128&d=identicon&r=PG&f=1", "display_name": "questions", "link": "https://stackoverflow.com/users/6109789/questions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 46211061, "answer_count": 2, "score": 0, "last_activity_date": 1560679916, "creation_date": 1505343171, "last_edit_date": 1560679916, "question_id": 46207996, "link": "https://stackoverflow.com/questions/46207996/opengl-3d-cube-wont-render-correctly-on-windows", "title": "Opengl 3D cube won&#39;t render correctly on Windows", "body": "<p>I am following a tutorial on Udemy - Modern Opengl 3.0. I have managed to get to the basic tutorial part 5 \"Projections and Coordinate Systems\". This works perfectly on a Mac, with the same code, but I can't get it to work on Windows. I even restarted the tutorial to make sure I didn't miss something and all previous tutorials worked, but I get the same result. It just won't render correctly. I did this on Visual Studio 2015 on Windows. On the mac I got it to work with by using vim and a Makefile... you would think it would be easier with an IDE that compiles for you, but apparently not.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aP3Br.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aP3Br.png\" alt=\"the rendered cube\"></a></p>\n\n<p>This is what is displayed on my screen, only it flashes really fast and moves a lot, instead of the rotating cube I should be getting.</p>\n\n<p>Here is the code:</p>\n\n<p>Shader.h:</p>\n\n<pre><code>#ifndef SHADER_H\n#define SHADER_H\n\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;iostream&gt;\n\n#include &lt;GL/glew.h&gt;\n\nclass Shader\n{\npublic:\n    GLuint Program;\n    // Constructor generates the shader on the fly\n    Shader(const GLchar *vertexPath, const GLchar *fragmentPath)\n    {\n        // 1. Retrieve the vertex/fragment source code from filePath\n        std::string vertexCode;\n        std::string fragmentCode;\n        std::ifstream vShaderFile;\n        std::ifstream fShaderFile;\n        // ensures ifstream objects can throw exceptions:\n        vShaderFile.exceptions(std::ifstream::badbit);\n        fShaderFile.exceptions(std::ifstream::badbit);\n        try\n        {\n            // Open files\n            vShaderFile.open(vertexPath);\n            fShaderFile.open(fragmentPath);\n            std::stringstream vShaderStream, fShaderStream;\n            // Read file's buffer contents into streams\n            vShaderStream &lt;&lt; vShaderFile.rdbuf();\n            fShaderStream &lt;&lt; fShaderFile.rdbuf();\n            // close file handlers\n            vShaderFile.close();\n            fShaderFile.close();\n            // Convert stream into string\n            vertexCode = vShaderStream.str();\n            fragmentCode = fShaderStream.str();\n        }\n        catch (std::ifstream::failure e)\n        {\n            std::cout &lt;&lt; \"ERROR::SHADER::FILE_NOT_SUCCESFULLY_READ\" &lt;&lt; std::endl;\n        }\n        const GLchar *vShaderCode = vertexCode.c_str();\n        const GLchar *fShaderCode = fragmentCode.c_str();\n        // 2. Compile shaders\n        GLuint vertex, fragment;\n        GLint success;\n        GLchar infoLog[512];\n        // Vertex Shader\n        vertex = glCreateShader(GL_VERTEX_SHADER);\n        glShaderSource(vertex, 1, &amp;vShaderCode, NULL);\n        glCompileShader(vertex);\n        // Print compile errors if any\n        glGetShaderiv(vertex, GL_COMPILE_STATUS, &amp;success);\n        if (!success)\n        {\n            glGetShaderInfoLog(vertex, 512, NULL, infoLog);\n            std::cout &lt;&lt; \"ERROR::SHADER::VERTEX::COMPILATION_FAILED\\n\" &lt;&lt; infoLog &lt;&lt; std::endl;\n        }\n        // Fragment Shader\n        fragment = glCreateShader(GL_FRAGMENT_SHADER);\n        glShaderSource(fragment, 1, &amp;fShaderCode, NULL);\n        glCompileShader(fragment);\n        // Print compile errors if any\n        glGetShaderiv(fragment, GL_COMPILE_STATUS, &amp;success);\n        if (!success)\n        {\n            glGetShaderInfoLog(fragment, 512, NULL, infoLog);\n            std::cout &lt;&lt; \"ERROR::SHADER::FRAGMENT::COMPILATION_FAILED\\n\" &lt;&lt; infoLog &lt;&lt; std::endl;\n        }\n        // Shader Program\n        this-&gt;Program = glCreateProgram();\n        glAttachShader(this-&gt;Program, vertex);\n        glAttachShader(this-&gt;Program, fragment);\n        glLinkProgram(this-&gt;Program);\n        // Print linking errors if any\n        glGetProgramiv(this-&gt;Program, GL_LINK_STATUS, &amp;success);\n        if (!success)\n        {\n            glGetProgramInfoLog(this-&gt;Program, 512, NULL, infoLog);\n            std::cout &lt;&lt; \"ERROR::SHADER::PROGRAM::LINKING_FAILED\\n\" &lt;&lt; infoLog &lt;&lt; std::endl;\n        }\n        // Delete the shaders as they're linked into our program now and no longer necessery\n        glDeleteShader(vertex);\n        glDeleteShader(fragment);\n\n    }\n    // Uses the current shader\n    void Use()\n    {\n        glUseProgram(this-&gt;Program);\n    }\n};\n\n#endif\n</code></pre>\n\n<p>core.frag:</p>\n\n<pre><code>#version 330 core\nin vec2 TexCoord;\n\nout vec4 color;\n\nuniform sampler2D ourTexture1;\n\nvoid main()\n{\n    color = texture(ourTexture1, TexCoord);\n}\n</code></pre>\n\n<p>core.vs:</p>\n\n<pre><code>#version 330 core\nlayout (location = 0) in vec3 position;\nlayout (location = 2) in vec2 texCoord;\n\nout vec2 TexCoord;\n\nuniform mat4 model;\nuniform mat4 view;\nuniform mat4 projection;\n\nvoid main()\n{\n    gl_Position = projection * view * model * vec4(position, 1.0f);\n    TexCoord = vec2(texCoord.x, 1.0 - texCoord.y);\n}\n</code></pre>\n\n<p>main.cpp:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n// GLEW\n#define GLEW_STATIC\n#include &lt;GL/glew.h&gt;\n\n// GLFW\n#include &lt;GLFW/glfw3.h&gt;\n\n// Other Libs\n#include \"SOIL2/SOIL2.h\"\n\n#include &lt;glm/glm.hpp&gt;\n#include &lt;glm/gtc/matrix_transform.hpp&gt;\n#include &lt;glm/gtc/type_ptr.hpp&gt;\n\n// Other includes\n#include \"Shader.h\"\n\n// Window dimensions\nconst GLuint WIDTH = 800, HEIGHT = 600;\n\n// The MAIN function, from here we start the application and run the game loop\nint main()\n{\n    // Init GLFW\n    glfwInit();\n\n    // Set all the required options for GLFW\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);\n    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\n    glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE);\n\n    glfwWindowHint(GLFW_RESIZABLE, GL_FALSE);\n\n    // Create a GLFWwindow object that we can use for GLFW's functions\n    GLFWwindow *window = glfwCreateWindow(WIDTH, HEIGHT, \"LearnOpenGL\", nullptr, nullptr);\n\n    int screenWidth, screenHeight;\n    glfwGetFramebufferSize(window, &amp;screenWidth, &amp;screenHeight);\n\n    if (nullptr == window)\n    {\n        std::cout &lt;&lt; \"Failed to create GLFW window\" &lt;&lt; std::endl;\n        glfwTerminate();\n\n        return EXIT_FAILURE;\n    }\n\n    glfwMakeContextCurrent(window);\n\n    // Set this to true so GLEW knows to use a modern approach to retrieving function pointers and extensions\n    glewExperimental = GL_TRUE;\n    // Initialize GLEW to setup the OpenGL Function pointers\n    if (GLEW_OK != glewInit())\n    {\n        std::cout &lt;&lt; \"Failed to initialize GLEW\" &lt;&lt; std::endl;\n        return EXIT_FAILURE;\n    }\n\n    // Define the viewport dimensions\n    glViewport(0, 0, screenWidth, screenHeight);\n\n    glEnable(GL_DEPTH_TEST);\n    // enable alpha support\n    glEnable(GL_BLEND);\n    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);//enables jpegs and alphas\n\n    // Build and compile our shader program\n    Shader ourShader(\"res/shaders/core.vs\", \"res/shaders/core.frag\");\n\n    // use with Perspective Projection\n    GLfloat vertices[] = {\n        //x     y       z      normalized texture coordinates \n        -0.5f, -0.5f, -0.5f,  0.0f, 0.0f,\n        0.5f, -0.5f, -0.5f,  1.0f, 0.0f,\n        0.5f,  0.5f, -0.5f,  1.0f, 1.0f,\n        0.5f,  0.5f, -0.5f,  1.0f, 1.0f,\n        -0.5f,  0.5f, -0.5f,  0.0f, 1.0f,\n        -0.5f, -0.5f, -0.5f,  0.0f, 0.0f,\n\n        -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,\n        0.5f, -0.5f,  0.5f,  1.0f, 0.0f,\n        0.5f,  0.5f,  0.5f,  1.0f, 1.0f,\n        0.5f,  0.5f,  0.5f,  1.0f, 1.0f,\n        -0.5f,  0.5f,  0.5f,  0.0f, 1.0f,\n        -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,\n\n        -0.5f,  0.5f,  0.5f,  1.0f, 0.0f,\n        -0.5f,  0.5f, -0.5f,  1.0f, 1.0f,\n        -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,\n        -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,\n        -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,\n        -0.5f,  0.5f,  0.5f,  1.0f, 0.0f,\n\n        0.5f,  0.5f,  0.5f,  1.0f, 0.0f,\n        0.5f,  0.5f, -0.5f,  1.0f, 1.0f,\n        0.5f, -0.5f, -0.5f,  0.0f, 1.0f,\n        0.5f, -0.5f, -0.5f,  0.0f, 1.0f,\n        0.5f, -0.5f,  0.5f,  0.0f, 0.0f,\n        0.5f,  0.5f,  0.5f,  1.0f, 0.0f,\n\n        -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,\n        0.5f, -0.5f, -0.5f,  1.0f, 1.0f,\n        0.5f, -0.5f,  0.5f,  1.0f, 0.0f,\n        0.5f, -0.5f,  0.5f,  1.0f, 0.0f,\n        -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,\n        -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,\n\n        -0.5f,  0.5f, -0.5f,  0.0f, 1.0f,\n        0.5f,  0.5f, -0.5f,  1.0f, 1.0f,\n        0.5f,  0.5f,  0.5f,  1.0f, 0.0f,\n        0.5f,  0.5f,  0.5f,  1.0f, 0.0f,\n        -0.5f,  0.5f,  0.5f,  0.0f, 0.0f,\n        -0.5f,  0.5f, -0.5f,  0.0f, 1.0f\n    };\n\n    GLuint VBO, VAO;//Vertex Buffer Object, Vertex Array Object\n    glGenVertexArrays(1, &amp;VAO);\n    glGenBuffers(1, &amp;VBO);\n\n    // Bind the Vertex Array Object first, then bind and set vertex buffer(s) and attribute pointer(s).\n    glBindVertexArray(VAO);\n\n    glBindBuffer(GL_ARRAY_BUFFER, VBO);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n\n    // Position attribute\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (GLvoid *)0);\n    glEnableVertexAttribArray(0);\n    // TexCoord attribute\n    glVertexAttribPointer(2, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (GLvoid *)(3 * sizeof(GLfloat)));\n    glEnableVertexAttribArray(2);\n\n    glBindVertexArray(0); // Unbind VAO\n\n    // Load and create a texture\n    GLuint texture;\n\n    int width, height;\n\n    glGenTextures(1, &amp;texture);\n    glBindTexture(GL_TEXTURE_2D, texture);\n    // Set our texture parameters\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);\n    // Set texture filtering\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n    // Load, create texture and generate mipmaps\n    unsigned char *image = SOIL_load_image(\"res/images/image1.jpg\", &amp;width, &amp;height, 0, SOIL_LOAD_RGBA);\n    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0, GL_RGBA, GL_UNSIGNED_BYTE, image);\n    glGenerateMipmap(GL_TEXTURE_2D);\n    SOIL_free_image_data(image);\n    glBindTexture(GL_TEXTURE_2D, 0);\n\n\n    glm::mat4 projection;\n    projection = glm::perspective(45.0f, (GLfloat)screenWidth / (GLfloat)screenHeight, 0.1f, 1000.0f); \n\n    // Game loop\n    while (!glfwWindowShouldClose(window))\n    {\n        // Check if any events have been activiated (key pressed, mouse moved etc.) and call corresponding response functions\n        glfwPollEvents();\n\n        // Render\n        // Clear the colorbuffer\n        glClearColor(0.9f, 0.5f, 0.3f, 1.0f);\n        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\n\n        glActiveTexture(GL_TEXTURE0);\n        glBindTexture(GL_TEXTURE_2D, texture);\n        glUniform1i(glGetUniformLocation(ourShader.Program, \"ourTexture\"), 0);\n        ourShader.Use();\n\n        glm::mat4 model;\n        glm::mat4 view;\n        model = glm::rotate(model, (GLfloat)glfwGetTime() * 1.0f, glm::vec3(0.5f, 1.0f, 0.0f));\n        view = glm::translate(view, glm::vec3(0.0f, 0.0f, -3.0f));\n\n        GLint modelLoc = glGetUniformLocation(ourShader.Program, \"model\");\n        GLint viewLoc = glGetUniformLocation(ourShader.Program, \"view\");\n        GLint projLoc = glGetUniformLocation(ourShader.Program, \"projection\");\n\n        glUniformMatrix4fv(modelLoc, 1, GL_FALSE, glm::value_ptr(model));\n        glUniformMatrix4fv(viewLoc, 1, GL_FALSE, glm::value_ptr(view));\n        glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(projection));\n\n        glBindVertexArray(VAO);\n        glDrawArrays(GL_TRIANGLES, 0, 36);\n        glBindVertexArray(0);\n\n        // Swap the screen buffers\n        glfwSwapBuffers(window);\n    }    \n\n    // Properly de-allocate all resources once they've outlived their purpose\n    glDeleteVertexArrays(1, &amp;VAO);\n    glDeleteBuffers(1, &amp;VBO);\n\n    // Terminate GLFW, clearing any resources allocated by GLFW.\n    glfwTerminate();\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c++", "class", "oop", "inheritance"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505347540, "post_id": 46207944, "comment_id": 79380394, "body": "What should happen if <code>n</code> and/or <code>m</code> are NOT bigger than 0? Do you want to pass 0s to <code>a()</code>, or do you want the code to fail?"}, {"owner": {"reputation": 95, "user_id": 8473377, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd46a4c744c9b1390db2123cf8575610?s=128&d=identicon&r=PG&f=1", "display_name": "Mate Gvenetadze", "link": "https://stackoverflow.com/users/8473377/mate-gvenetadze"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505347721, "post_id": 46207944, "comment_id": 79380442, "body": "i just want to understand how can i use if/else statement before i put into the notbase class constructor..."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505347964, "post_id": 46207944, "comment_id": 79380503, "body": "You can&#39;t use <code>if&#47;else</code> like that. But you can write a function that is called while preparing to pass values to the base constructor, eg: <code>int verify(int n, int m, int result) { return ((n &gt; 0) &amp;&amp; (m &gt; 0)) ? result : 0; } ... b(int n, int m) : a(verify(n, m, n), verify(n , m, m)) {}</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505348086, "post_id": 46207944, "comment_id": 79380533, "body": "What you can do in a constructor&#39;s initialization list is very limited. If you need to do complex things, do them inside the constructor body instead. Change <code>x</code> and <code>y</code> to <code>protected</code>, initialize <code>a</code> using defaults, and let <code>b()</code> override <code>x</code> and <code>y</code> as needed after <code>a</code> is initialized."}, {"owner": {"reputation": 95, "user_id": 8473377, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd46a4c744c9b1390db2123cf8575610?s=128&d=identicon&r=PG&f=1", "display_name": "Mate Gvenetadze", "link": "https://stackoverflow.com/users/8473377/mate-gvenetadze"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505348686, "post_id": 46207944, "comment_id": 79380683, "body": "okay i think it&#39;s a best way to use function to check variable as you want and than put it in to the constructor. But what you mean initialize a using default and let b()  override i ?dont understand."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505350891, "post_id": 46207944, "comment_id": 79381153, "body": "<code>b(int n, int m) : a() { if ((n &gt; 0) &amp;&amp; (m &gt; 0)) { x = n; y = m; } }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "reply_to_user": {"reputation": 95, "user_id": 8473377, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd46a4c744c9b1390db2123cf8575610?s=128&d=identicon&r=PG&f=1", "display_name": "Mate Gvenetadze", "link": "https://stackoverflow.com/users/8473377/mate-gvenetadze"}, "edited": false, "score": 0, "creation_date": 1505346196, "post_id": 46208060, "comment_id": 79380041, "body": "Downvoter: I get that this is a bit ugly, but a comment about why you don&#39;t like it and a better way to do it would be appreciated."}, {"owner": {"reputation": 95, "user_id": 8473377, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd46a4c744c9b1390db2123cf8575610?s=128&d=identicon&r=PG&f=1", "display_name": "Mate Gvenetadze", "link": "https://stackoverflow.com/users/8473377/mate-gvenetadze"}, "edited": false, "score": 0, "creation_date": 1505346971, "post_id": 46208060, "comment_id": 79380236, "body": "who said that i don&#39;t like it ? it was very smart"}, {"owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "reply_to_user": {"reputation": 95, "user_id": 8473377, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd46a4c744c9b1390db2123cf8575610?s=128&d=identicon&r=PG&f=1", "display_name": "Mate Gvenetadze", "link": "https://stackoverflow.com/users/8473377/mate-gvenetadze"}, "edited": false, "score": 0, "creation_date": 1505750254, "post_id": 46208060, "comment_id": 79530106, "body": "@MateGvenetadze someone downvoted it, it has +2/-1 right now.  I only want feedback from whoever did it."}], "tags": [], "owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "is_accepted": true, "score": 1, "last_activity_date": 1505343620, "creation_date": 1505343620, "answer_id": 46208060, "question_id": 46207944, "link": "https://stackoverflow.com/questions/46207944/i-want-to-check-parameters-before-puting-them-into-constructor/46208060#46208060", "title": "I want to check parameters before puting them into constructor", "body": "<p>There must be a more elegant approach to this, but this is the best I've got right now. You can use the <a href=\"http://www.cprogramming.com/reference/operators/ternary-operator.html\" rel=\"nofollow noreferrer\">ternary operator</a> to check the variables as they are being passed into the call to <code>a</code>'s constructor.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass a\n{\nprivate:\n    int x; int y;\npublic:\n    a(int x = 0, int y = 0)\n    {\n        this-&gt;x = x; this-&gt;y = y;\n    }\n\n    void print()\n    {\n        std::cout &lt;&lt; x &lt;&lt; \" \" &lt;&lt; y &lt;&lt; \"\\n\";\n    }\n};\n\nclass b : public a\n{\npublic:\n    b(int n,int m) : a( \n        n &gt; 0 &amp;&amp; m &gt; 0 ? n : 0, \n        n &gt; 0 &amp;&amp; m &gt; 0 ? m : 0\n    )\n    {\n\n    }\n};\n\nint main()\n{\n  b B(-1, 1);\n  B.print();\n\n  b B2(1, 1);\n  B2.print();\n\n  b B3(-1, -1);\n  B3.print();\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>0 0\n1 1\n0 0\n</code></pre>\n\n<p>This approach might be frowned upon depending on your standard for code style, and doesn't take advantage of your default values in <code>a</code>'s constructor, but it will get the job done, at least in this simple example.</p>\n"}], "owner": {"reputation": 95, "user_id": 8473377, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd46a4c744c9b1390db2123cf8575610?s=128&d=identicon&r=PG&f=1", "display_name": "Mate Gvenetadze", "link": "https://stackoverflow.com/users/8473377/mate-gvenetadze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 46208060, "answer_count": 1, "score": 0, "last_activity_date": 1505347863, "creation_date": 1505342835, "last_edit_date": 1505347863, "question_id": 46207944, "link": "https://stackoverflow.com/questions/46207944/i-want-to-check-parameters-before-puting-them-into-constructor", "title": "I want to check parameters before puting them into constructor", "body": "<p>In class b I want to check if n and m are bigger than 0 and then put them into the constructor of a. How can I do it?</p>\n\n<pre><code>class a{\nprivate:\n    int x; int y;\npublic:\n    a(int x, int y){\n        this-&gt;x=x; this-&gt;y=y;\n    }\n    void print(){\n        cout&lt;&lt;x&lt;&lt;\" \"&lt;&lt;y&lt;&lt;endl;\n    }\n};\n\nclass b:public a{\npublic:\n    b(int n,int m):a(){\n        ///\n    }\n}; \n</code></pre>\n"}, {"tags": ["c++", "windows", "opencv"], "comments": [{"owner": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1505343256, "post_id": 46207926, "comment_id": 79379316, "body": "Are you sure the problem is with <code>imwrite</code>? Your nested loops look strange. You&#39;re splitting the Mat <code>image</code> for each pixel. What are you trying to do in the loops?"}, {"owner": {"reputation": 23680, "user_id": 2414957, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0MuAW.jpg?s=128&g=1", "display_name": "Mona Jalal", "link": "https://stackoverflow.com/users/2414957/mona-jalal"}, "reply_to_user": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1505343600, "post_id": 46207926, "comment_id": 79379411, "body": "yes, I have tested that separately and works ok."}, {"owner": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1505343850, "post_id": 46207926, "comment_id": 79379484, "body": "Does <code>imshow</code> work before <code>imwrite</code>? Also try changing file path to another drive and see if it works."}, {"owner": {"reputation": 23680, "user_id": 2414957, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0MuAW.jpg?s=128&g=1", "display_name": "Mona Jalal", "link": "https://stackoverflow.com/users/2414957/mona-jalal"}, "reply_to_user": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1505343897, "post_id": 46207926, "comment_id": 79379502, "body": "yes, imshow works separately if I comment imwrite"}, {"owner": {"reputation": 23680, "user_id": 2414957, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0MuAW.jpg?s=128&g=1", "display_name": "Mona Jalal", "link": "https://stackoverflow.com/users/2414957/mona-jalal"}, "reply_to_user": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1505343941, "post_id": 46207926, "comment_id": 79379512, "body": "I don&#39;t have another drive available but my friend who is using similar lab setting and similar drive with same exact opencv property sheet had no problem"}, {"owner": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1505344820, "post_id": 46207926, "comment_id": 79379725, "body": "There are many errors in your code. I don&#39;t know why its running for you. You&#39;re already reading your image as grayscale: <code>image = imread(&quot;mona1.jpg&quot;, IMREAD_GRAYSCALE);</code>. This means the image is a single channel, grayscale image. So the <code>split</code> function here: <code>split(image, channels);</code> returns <code>channels</code> as empty. You check by <code>if(channels[1].empy()) cout&lt;&lt;&quot;Image is empty&quot;&lt;&lt;endl;</code>."}, {"owner": {"reputation": 23680, "user_id": 2414957, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0MuAW.jpg?s=128&g=1", "display_name": "Mona Jalal", "link": "https://stackoverflow.com/users/2414957/mona-jalal"}, "reply_to_user": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "edited": false, "score": 0, "creation_date": 1505346768, "post_id": 46207926, "comment_id": 79380176, "body": "editted the code not still working"}], "answers": [{"comments": [{"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 1, "creation_date": 1505354395, "post_id": 46208489, "comment_id": 79381914, "body": "So the only change you made was the extension of the output image?  I also think you meant <code>bmp</code>, not <code>bpm</code>."}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 1, "creation_date": 1505354845, "post_id": 46208489, "comment_id": 79382025, "body": "Cool... but I would chalk that up to a temporary fix though.  Not being able to write JPEG to disk seems to be a very glaring issue to me.  Either way, I&#39;m glad to see that you resolved your problem."}, {"owner": {"reputation": 23680, "user_id": 2414957, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0MuAW.jpg?s=128&g=1", "display_name": "Mona Jalal", "link": "https://stackoverflow.com/users/2414957/mona-jalal"}, "reply_to_user": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1505355481, "post_id": 46208489, "comment_id": 79382194, "body": "Yeah I do agree with you. I am working on a lab machine which has lots of restrictions and I am not an admin on it. Once I get my own station, I look into this issue further. Thanks!"}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 1, "creation_date": 1505356077, "post_id": 46208489, "comment_id": 79382325, "body": "Ah that makes sense. Good luck!"}], "tags": [], "owner": {"reputation": 23680, "user_id": 2414957, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0MuAW.jpg?s=128&g=1", "display_name": "Mona Jalal", "link": "https://stackoverflow.com/users/2414957/mona-jalal"}, "is_accepted": false, "score": 1, "last_activity_date": 1505354738, "last_edit_date": 1505354738, "creation_date": 1505347173, "answer_id": 46208489, "question_id": 46207926, "link": "https://stackoverflow.com/questions/46207926/imwrite-in-opencv3-1-doesnt-work/46208489#46208489", "title": "imwrite in OpenCV3.1 doesn&#39;t work", "body": "<p>This worked for me:</p>\n\n<pre><code> imwrite(\"10_iteration_blurring.bmp\", image);\n</code></pre>\n"}], "owner": {"reputation": 23680, "user_id": 2414957, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0MuAW.jpg?s=128&g=1", "display_name": "Mona Jalal", "link": "https://stackoverflow.com/users/2414957/mona-jalal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505354738, "creation_date": 1505342727, "last_edit_date": 1505346759, "question_id": 46207926, "link": "https://stackoverflow.com/questions/46207926/imwrite-in-opencv3-1-doesnt-work", "title": "imwrite in OpenCV3.1 doesn&#39;t work", "body": "<p>When I am trying to save the image using imwrite I get the following error:</p>\n\n<pre><code>Files that help describe the problem:\n  C:\\Users\\jalal\\AppData\\Local\\Temp\\WER64CE.tmp.WERInternalMetadata.xml\n  C:\\Users\\jalal\\AppData\\Local\\Temp\\WER7092.tmp.appcompat.txt\n  C:\\Users\\jalal\\AppData\\Local\\Temp\\WER70C2.tmp.mdmp\n\nRead our privacy statement online:\n  http://go.microsoft.com/fwlink/?linkid=104288&amp;clcid=0x0409\n\nIf the online privacy statement is not available, please read our privacy statement offline:\n  C:\\Windows\\system32\\en-US\\erofflps.txt\n</code></pre>\n\n<p>Here's my entire code (the code works --imshow shows the blurred image):</p>\n\n<pre><code>#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/imgcodecs.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace cv;\nusing namespace std;\n\n//void tintImageBlue(Mat&amp; image);\n\nint main()\n{\n    Mat image;\n    Mat channels[3];\n\n    image = imread(\"mona1.jpg\", IMREAD_GRAYSCALE);\n    split(image, channels);\n    //image = 0.2*channels[0] + 0.4*channels[1] + 0.4*channels[2]; //gives us a black and white image (grey)\n    image = 0.2126*channels[0] + 0.7152*channels[1] + 0.0722*channels[2]; //wikipedia formula \n    //Colorimetric (luminance-preserving) conversion to grayscale\n\n\n\n    if (image.empty())                      // Check for invalid input\n    {\n        cout &lt;&lt; \"Could not open or find the image\" &lt;&lt; std::endl;\n        return 0;\n    }\n\n    float neighbors[8];\n    float neighbors_mean = 0;\n    float neighbors_sum;\n\n    for (int iter = 0; iter &lt; 3; iter++){\n        for (int i = 0; i &lt; image.rows; i++) {\n            for (int j = 0; j &lt; image.cols; j++) {\n\n\n                neighbors[0] = (((i - 1) &gt;= 0 &amp;&amp; (j - 1) &gt;= 0) ? image.at&lt;uchar&gt;(i - 1, j - 1) : 0.0f);\n                neighbors[1] = (((i - 1) &gt;= 0) ? image.at&lt;uchar&gt;(i - 1, j) : 0.0f);\n                neighbors[2] = (((i - 1) &gt;= 0 &amp;&amp; (j + 1) &lt; image.cols) ? image.at&lt;uchar&gt;(i - 1, j + 1) : 0.0f);\n                neighbors[3] = (((j + 1) &lt; image.cols) ? image.at&lt;uchar&gt;(i, j + 1) : 0.0f);\n                neighbors[4] = (((i + 1) &lt; image.rows &amp;&amp; (j + 1) &lt; image.cols) ? image.at&lt;uchar&gt;(i + 1, j + 1) : 0.0f);\n                neighbors[5] = (((i + 1) &lt; image.rows &amp;&amp; (j - 1) &gt;= 0) ? image.at&lt;uchar&gt;(i + 1, j) : 0.0f);\n                neighbors[6] = (((i + 1) &lt; image.rows &amp;&amp; (j - 1) &gt;= 0) ? image.at&lt;uchar&gt;(i + 1, j - 1) : 0.0f);\n                neighbors[7] = (((j - 1) &gt;= 0) ? image.at&lt;uchar&gt;(i, j - 1) : 0.0f);\n\n                neighbors_sum = neighbors[0] + neighbors[1] + neighbors[2] + neighbors[3] +\n                    neighbors[4] + neighbors[5] + neighbors[6] + neighbors[7];\n\n                neighbors_mean = neighbors_sum / 8.0f;\n                image.at&lt;uchar&gt;(i, j) = neighbors_mean;\n\n\n                neighbors_sum = 0;\n                neighbors_mean = 0;\n\n            }\n        }\n    }\n\n\n\n\n\n\n\n\n\n\n\n\n    //tintImageBlue(image);\n\n    //namedWindow(\"Grey Mona\", WINDOW_AUTOSIZE); // Create a window for display.\n    //imshow(\"Grey Mona\", image);                // Show our image inside it.\n\n    //resizeWindow(\"Grey Mona\",800, 1000);\n\n    //waitKey(0); // Wait for a keystroke in the window\n    imwrite(\"10_iteration_blurring.jpg\", image);\n    return 0;\n}\n</code></pre>\n\n<p>But with imwrite it becomes unresponsive. How should I fix this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/I6RWi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I6RWi.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "struct", "codeblocks", "header-files"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8286006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a33de7c9b46bc40cc368cc81393989?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa\u0142 My\u015bliwczyk", "link": "https://stackoverflow.com/users/8286006/rafa%c5%82-my%c5%9bliwczyk"}, "edited": false, "score": 0, "creation_date": 1505342534, "post_id": 46207856, "comment_id": 79379110, "body": "Thanks, but I think that it clearly says #include &quot;global.h&quot; in logic.h file. I thought that this will do the job but somehow it doesn&#39;t :("}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 3, "user_id": 8286006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a33de7c9b46bc40cc368cc81393989?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa\u0142 My\u015bliwczyk", "link": "https://stackoverflow.com/users/8286006/rafa%c5%82-my%c5%9bliwczyk"}, "edited": false, "score": 0, "creation_date": 1505342992, "post_id": 46207856, "comment_id": 79379229, "body": "@Rafa\u0142My\u015bliwczyk you&#39;ve also included logic.h in global.h file. What do you think happens when you include logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h which includes global.h which includes logic.h ...?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505343288, "post_id": 46207856, "comment_id": 79379329, "body": "A good cautionary tale about both avoiding circular dependencies and using <a href=\"https://en.wikipedia.org/wiki/Include_guard\" rel=\"nofollow noreferrer\">include guards</a>. Two for the price of one."}, {"owner": {"reputation": 3, "user_id": 8286006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a33de7c9b46bc40cc368cc81393989?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa\u0142 My\u015bliwczyk", "link": "https://stackoverflow.com/users/8286006/rafa%c5%82-my%c5%9bliwczyk"}, "edited": false, "score": 0, "creation_date": 1505343733, "post_id": 46207856, "comment_id": 79379445, "body": "Thanks, you&#39;re right. It seemes that once I separated the .h so it only includes the struct definition and I get all my includes from somewhere else it all works now."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 3, "user_id": 8286006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a33de7c9b46bc40cc368cc81393989?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa\u0142 My\u015bliwczyk", "link": "https://stackoverflow.com/users/8286006/rafa%c5%82-my%c5%9bliwczyk"}, "edited": false, "score": 0, "creation_date": 1505370703, "post_id": 46207856, "comment_id": 79386939, "body": "@Rafa\u0142My\u015bliwczyk: I failed to notice the circular dependency. Total fail on my end. Rewrote answer to discuss that instead."}], "tags": [], "owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "is_accepted": true, "score": 0, "last_activity_date": 1505370625, "last_edit_date": 1505370625, "creation_date": 1505342360, "answer_id": 46207856, "question_id": 46207819, "link": "https://stackoverflow.com/questions/46207819/c-struct-in-separate-header-file/46207856#46207856", "title": "C++ struct in separate header file", "body": "<p>When you <code>include \"global.h\"</code>, one of the <em>first</em> things it says is <code>include \"logic.h\"</code>, so the processor opens that file, finds an <code>include \"global.h\"</code>, which does nothing because of the include guard, then it finds <code>void initCharacter(Character &amp;newCharacter,</code> and gets confused because it doesn't yet know what a <code>Character</code> is. Then it returns from that include, lexes <code>enum directions</code>, then <em>finally</em> lexes <code>struct Character</code>, so <em>then</em> it knows what a <code>Character</code> is, far too late.</p>\n\n<p>In general, try to make sure includes only go one way. Make sure <code>logic</code> includes <code>global</code>, or that <code>global</code> includes <code>logic</code>, but not both.</p>\n\n<p>Or, if you're really lazy, there's a trick that sometimes sidesteps the issue: Put function and class definitions before the includes, as often as possible. Then <code>global</code> will tell the compiler that <code>class Character</code> exists, then when it includes <code>logic.h</code>, it won't have an issue.</p>\n\n<pre><code>#ifndef GLOBAL_H\n#define GLOBAL_H\n\nenum directions;\nstruct Character; //If you're really lazy, this usually works\n\n#include \"logic.h\"\n#include &lt;SDL.h&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include \"graphics.h\"\n\n//Global variables and structs\nenum directions\n{\n    D_UP,\n    D_LEFT,\n    D_DOWN,\n    D_RIGHT,\n    D_TOTAL\n};\n\nstruct Character\n{\n    ...\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8286006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a33de7c9b46bc40cc368cc81393989?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa\u0142 My\u015bliwczyk", "link": "https://stackoverflow.com/users/8286006/rafa%c5%82-my%c5%9bliwczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1210, "favorite_count": 0, "closed_date": 1505342405, "accepted_answer_id": 46207856, "answer_count": 1, "score": -1, "last_activity_date": 1505370625, "creation_date": 1505342140, "last_edit_date": 1505342808, "question_id": 46207819, "link": "https://stackoverflow.com/questions/46207819/c-struct-in-separate-header-file", "closed_reason": "Duplicate", "title": "C++ struct in separate header file", "body": "<p>I've tried to organize my project so I thought that I will include all of my global variables, #includes and struct definition in a global.h header. However I can't fully understand this concept and the errors during build seem to prove that. When i try to access my global.h in logic.h this is what happens.</p>\n\n<p>global.h:</p>\n\n<pre><code>#ifndef GLOBAL_H\n#define GLOBAL_H\n#include \"logic.h\"\n#include &lt;SDL.h&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include \"graphics.h\"\n\n//Global variables and structs\nenum directions\n{\n    D_UP,\n    D_LEFT,\n    D_DOWN,\n    D_RIGHT,\n    D_TOTAL\n};\n\nstruct Character\n{\n    float health;\n    float x;\n    float y;\n    float velocity;\n    bool collision[D_TOTAL];\n    directions direction;\n    SDL_Rect animation;\n    SDL_Rect sprite;\n};\n\nconst int windowWidth = 800;\nconst int windowHeight = 600;\nconst int frameWidth = 64;\nconst int frameHeight = 64;\n#endif // GLOBAL_H\n</code></pre>\n\n<p>logic.h:</p>\n\n<pre><code>#include \"global.h\"\n//Header for gamelogic functions\n\n//Initialization of all variables for a new character\nvoid initCharacter(Character &amp;newCharacter, float x, float y, directions startingDirection);\n</code></pre>\n\n<p>When i try to build it this is the error I'm getting:</p>\n\n<pre><code>||=== Build: Debug in GameProject0.2 (compiler: GNU GCC Compiler) ===|\nC:\\Users\\Rafa\u0142\\Documents\\GameProject0.2\\GameProject0.2\\logic.h|5|error: variable or field 'initCharacter' declared void|\nC:\\Users\\Rafa\u0142\\Documents\\GameProject0.2\\GameProject0.2\\logic.h|5|error: 'Character' was not declared in this scope|\nC:\\Users\\Rafa\u0142\\Documents\\GameProject0.2\\GameProject0.2\\logic.h|5|error: 'newCharacter' was not declared in this scope|\nC:\\Users\\Rafa\u0142\\Documents\\GameProject0.2\\GameProject0.2\\logic.h|5|error: expected primary-expression before 'float'|\nC:\\Users\\Rafa\u0142\\Documents\\GameProject0.2\\GameProject0.2\\logic.h|5|error: expected primary-expression before 'float'|\nC:\\Users\\Rafa\u0142\\Documents\\GameProject0.2\\GameProject0.2\\logic.h|5|error: 'directions' was not declared in this scope|\n||=== Build failed: 6 error(s), 0 warning(s) (0 minute(s), 0 second(s)) ===|\n</code></pre>\n\n<p>I am not sure what I'm missing. Thanks for any advice!</p>\n"}, {"tags": ["c++", "c", "buffer"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505342135, "post_id": 46207765, "comment_id": 79378978, "body": "<code>fflush(stdin)</code> only works on buffered input streams (like disk files), it does not work on pipes and terminals.  In C++, you can use <code>std::cin.ignore()</code> to ignore buffered unread input, eg: <code>std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), &#39;\\n&#39;)</code>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505343437, "post_id": 46207765, "comment_id": 79379366, "body": "@Remy: Doesn&#39;t <code>std::cin.ignore</code> also ignore unread input not yet buffered, until it finds the delimiter character?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1505343684, "post_id": 46207765, "comment_id": 79379429, "body": "@rici: yes. To clear just the previously buffered data, you would likely have to access <code>std::cin</code>&#39;s underlying <code>streambuf</code> object directly and read from it until it has nothing to read without going back to the terminal for more data."}, {"owner": {"reputation": 1, "user_id": 8173903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b86cf69235ee615263917bb688ad16a?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley Alves", "link": "https://stackoverflow.com/users/8173903/wesley-alves"}, "edited": false, "score": 0, "creation_date": 1505343692, "post_id": 46207765, "comment_id": 79379433, "body": "And for C, what is the solution?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505344003, "post_id": 46207765, "comment_id": 79379528, "body": "@WesleyAlves: There isn&#39;t really a cross-platform solution. There is <code>fpurge()</code> on Linux, but no equivalent on Windows (unless you count <code>FlushConsoleInputBuffer()</code>, which flushes what the user has already typed in the console that hasn&#39;t been read in by your app yet). You could try using <code>freopen()</code> to close and reopen stdin, if your compiler&#39;s RTL implements it."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1505344322, "post_id": 46207765, "comment_id": 79379606, "body": "There are also <code>ioctl</code> invocations you can use on Unix/Linux to clear the terminal input buffer (if it&#39;s terminal input you care about, naturally)."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505344822, "post_id": 46207765, "comment_id": 79379726, "body": "@RemyLebeau I think what you meant to write is along the lines of &quot;<code>fflush</code> is only guaranteed to <i>do anything</i> for files with which the last operation was a write&quot;... Please tell me you meant to write that, right?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1505347127, "post_id": 46207765, "comment_id": 79380278, "body": "@Sebivor: <code>fflush()</code> is defined only for output streams, not input streams.  However, Linux does implement <code>fflush()</code> for input streams of seekable files."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505368788, "post_id": 46207765, "comment_id": 79386049, "body": "@RemyLebeau as of POSIX.1-2008, fflush() is defined to remove unread characters from an input stream."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1519769445, "post_id": 46207765, "comment_id": 85042752, "body": "The buffer is provided by the operating system so you can&#39;t do anything with it independent of the operating system..."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1505344827, "post_id": 46208114, "comment_id": 79379727, "body": "Nitpick: that would be line feed, not carriage return (which is <code>\\r</code>)."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1505345069, "post_id": 46208114, "comment_id": 79379788, "body": "@NominalAnimal Right back at ya, <code>&#39;\\n&#39;</code> in C isn&#39;t required to be a line feed; in fact, the character &quot;line feed&quot; isn&#39;t required to exist (though oddly enough, carriage returns are required). The C standard describes characters with the value <code>&#39;\\n&#39;</code> as &quot;newline characters&quot;..."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1505345539, "post_id": 46208114, "comment_id": 79379894, "body": "@Sebivor: Wrong. <code>\\n</code> in C is &quot;newline&quot;, and <code>\\r</code> is &quot;carriage return&quot;, according to C11 5.2.2p2. However, Unicode and ASCII call <code>\\n</code> line feed. That said, I do prefer &quot;newline&quot; over &quot;line feed&quot; myself."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1505345544, "post_id": 46208114, "comment_id": 79379896, "body": "I learned my terminology from 80s micros (yeah, I&#39;m that old) and they consistently called it a &quot;carriage return,&quot; because everyone writing the documentation was familiar with mechanical typewriters.  &quot;Newline&quot; is perhaps the better term in the context of C, though."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1505346503, "post_id": 46208114, "comment_id": 79380114, "body": "Yes, I fully agree, <i>newline</i> is the best term here for <code>&#39;\\n&#39;</code>. This is quite a complex set of details, when one gets to the OS level, and that&#39;s the only reason I bothered with the nitpick. For example, in POSIXy systems the pseudoterminal layer (tty/pty) maps the <code>\\n</code> (<i>newline</i>) output by programs to <code>\\r\\n</code> (<i>carriage return</i> followed by <i>linefeed</i>) by default (<code>ONLCR</code> termios flag is set by default). There is a clear layer boundary, and when using e.g. curses or &quot;raw&quot; terminal (or writing a master!), this often surprises programmers. Exact terms help with untangling this mess, I believe."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 1, "last_activity_date": 1519767684, "last_edit_date": 1519767684, "creation_date": 1505344090, "answer_id": 46208114, "question_id": 46207765, "link": "https://stackoverflow.com/questions/46207765/clear-buffer-independent-of-the-operating-system/46208114#46208114", "title": "Clear buffer independent of the operating system", "body": "<p>Depending on what you mean by \"clear the standard input buffer\", this may do:</p>\n\n<pre><code>int c;\ndo c = getchar(); while (c != EOF &amp;&amp; c != '\\n');\n</code></pre>\n\n<p>This absorbs up to EOF or a newline, whichever comes first.</p>\n\n<p>The main situation where this wouldn't be what you want is if you don't want it to maybe block until the user presses Enter.  In that case, you're SOL; there is no universal mechanism.</p>\n"}], "owner": {"reputation": 1, "user_id": 8173903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b86cf69235ee615263917bb688ad16a?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley Alves", "link": "https://stackoverflow.com/users/8173903/wesley-alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 46208114, "answer_count": 1, "score": 0, "last_activity_date": 1519767684, "creation_date": 1505341898, "question_id": 46207765, "link": "https://stackoverflow.com/questions/46207765/clear-buffer-independent-of-the-operating-system", "title": "Clear buffer independent of the operating system", "body": "<p>I'd like to know how I can do to clear the standard input buffer, regardless of the operating system I'm using.\nI know that in Windows I can use <code>fflush</code> and Linux <code>fpurge</code>, but I would like a single solution that works for both (does not necessarily have to be a function).</p>\n"}, {"tags": ["c++", "class", "directx"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1505341663, "post_id": 46207690, "comment_id": 79378825, "body": "Looks like you need to us <code>*(DWORD*)(&amp;(d3ddev-&gt;EndScene()))</code>"}, {"owner": {"reputation": 45, "user_id": 7099486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaf435dc12031e09e7344dafa2e55e0?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Mackday", "link": "https://stackoverflow.com/users/7099486/matthew-mackday"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1505341776, "post_id": 46207690, "comment_id": 79378854, "body": "That won&#39;t work man like that I&#39;m just calling the function"}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "edited": false, "score": 0, "creation_date": 1505342362, "post_id": 46207690, "comment_id": 79379054, "body": "It&#39;s not clear whether you want the address of the return value of end scene, or you want something a bit like a function pointer except it can store a method and an object to call that method on. In the second case, you probably want to combine two concepts: use &quot;std::function&quot; as the type of variable / parameter you pass around, and use a &quot;C++ lambda function&quot; to create the value you put in that variable. Search the web for those two terms and you&#39;ll get most of the information you need."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1505342477, "post_id": 46207690, "comment_id": 79379094, "body": "@RSahu This is not a duplicate of that question."}, {"owner": {"reputation": 45, "user_id": 7099486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaf435dc12031e09e7344dafa2e55e0?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Mackday", "link": "https://stackoverflow.com/users/7099486/matthew-mackday"}, "edited": false, "score": 0, "creation_date": 1505342669, "post_id": 46207690, "comment_id": 79379146, "body": "I want to simply be aple to printf the EndScene address"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1505343289, "post_id": 46207690, "comment_id": 79379330, "body": "@MatthewMackday, The compiler error message indicates that <code>EndSection</code> is a member function. The problem with what you are trying to do is two fold: 1) You cannot get the address of a member function using <code>&amp;d3ddev-&gt;EndScene</code>. You&#39;ll have to use <code>&amp;D3D9Device::EndScene</code>. 2) Printing the address of a member function is doable but not straight forward. Do a search on that topic in SO."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1505343469, "post_id": 46207690, "comment_id": 79379375, "body": "@MatthewMackday, when you use <code>d3ddev-&gt;EndScene</code>, you are not calling the function. You need to use <code>d3ddev-&gt;EndScene()</code> to call the function."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1505344136, "post_id": 46207690, "comment_id": 79379558, "body": "@MatthewMackday, the comment <i>you guys should really stop trying to farm rep</i> is uncalled for. We are all volunteers here, trying our best to help others. A closed post can be reopened if necessary by others. I don&#39;t think the that would be the case here."}, {"owner": {"reputation": 45, "user_id": 7099486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaf435dc12031e09e7344dafa2e55e0?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Mackday", "link": "https://stackoverflow.com/users/7099486/matthew-mackday"}, "edited": false, "score": 0, "creation_date": 1505344208, "post_id": 46207690, "comment_id": 79379574, "body": "How is it uncalled for? You marked the post as a duplicate of a TOTALLY different post/situation and I don&#39;t think you&#39;ve read the original one"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505374049, "post_id": 46207690, "comment_id": 79388844, "body": "@MatthewMackday noone gets any rep for closing a question. That comment should be in the comments, where it belongs. It does not belong in the body of the question."}, {"owner": {"reputation": 21422, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 0, "creation_date": 1505382660, "post_id": 46207690, "comment_id": 79394291, "body": "@R Sahu: I agree that the comment about rep farming was inappropriate. However, I don&#39;t think this question is a duplicate of that other one (that one was an error where there was no &quot;&amp;&quot; and there needed to be one; this one there is a &quot;&amp;&quot; that is in appropriate). Voting to reopen..."}], "answers": [{"tags": [], "owner": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "is_accepted": true, "score": 1, "last_activity_date": 1505485975, "last_edit_date": 1505485975, "creation_date": 1505484854, "answer_id": 46241689, "question_id": 46207690, "link": "https://stackoverflow.com/questions/46207690/class-member-function-address/46241689#46241689", "title": "Class member function address", "body": "<p>Member function pointers are not per object, they are per type. In your example, you could have multiple instances of a <code>IDirect3DDevice9</code>, all of which would have the same pointer value for their <code>EndScene</code> member function (assuming they aren't different concrete types - but this isn't likely). </p>\n\n<p>The specific error you are getting is because you are attempting to get the address of a pointer-to-member function from an object, which isn't valid (eg. see <a href=\"https://stackoverflow.com/questions/38288531/illegal-operation-on-bound-member-function-expression-error\">&#39;&amp;&#39; illegal operation on bound member function expression error</a>). </p>\n\n<p>It is possible to get the value of a member function using the type, instead of an object pointer. However, it's extremely ugly:</p>\n\n<pre><code>// Value is stored in 'end_scene':\nHRESULT (IDirect3DDevice9::* end_scene)() = &amp;IDirect3DDevice9::EndScene;\n// Call the function, with the value of 'end_scene'.\n(*d3ddev.*(end_scene))();\n// Print the address of the pointer-to-member function:\nprintf(\"%p\\n\", end_scene);\n</code></pre>\n\n<p>I wouldn't suggest doing this here, because most functions in <code>IDirect3DDevice9</code> don't have the same prototype. In fact, only <code>BeginScene</code> has the same prototype as <code>EndScene</code>, and it's hard to imagine a situation in which the call could be one or the other, since they need to be called in a specific order. You could make the case about using this for the functions that get/set vertex/pixel shader constants, as they have the same prototypes, but, it's just as easy to store some other external state to determine which function to call, and much more straightforward.</p>\n"}], "owner": {"reputation": 45, "user_id": 7099486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daaf435dc12031e09e7344dafa2e55e0?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Mackday", "link": "https://stackoverflow.com/users/7099486/matthew-mackday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 46241689, "answer_count": 1, "score": 0, "last_activity_date": 1505485975, "creation_date": 1505341468, "last_edit_date": 1505341860, "question_id": 46207690, "link": "https://stackoverflow.com/questions/46207690/class-member-function-address", "title": "Class member function address", "body": "<p><em>Edit</em> How is this in any way related to the supposed post? They are both completely different errors, you guys should really stop trying to farm rep</p>\n\n<p>So I've been searching around google and stackoverflow but I couldn't find one solution that would help my case.\nI have a D3D9Device pointer and I want the EndScene address of that device, how would I approach so?</p>\n\n<pre><code>DWORD aEndScene = *(DWORD*)(&amp;d3ddev-&gt;EndScene);\n</code></pre>\n\n<p>won't work with the following error</p>\n\n<pre><code>'&amp;': illegal operation on bound member function expression\n</code></pre>\n\n<p>I think that's wrong because I'm actually trying to get the address of the d3ddev class</p>\n"}, {"tags": ["c++", "c++11", "types", "typedef"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1505341396, "post_id": 46207623, "comment_id": 79378745, "body": "<code>&#47;&#47; this is ugly and I&#39;d want to be able to use: return a+a</code> So, why not overload <code>operator int()</code>? <a href=\"https://ideone.com/VKA0DO\" rel=\"nofollow noreferrer\">Example</a>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1505341613, "post_id": 46207623, "comment_id": 79378813, "body": "So is it OK to add two IDs? Should the result be an ID again? What about multiplication, would  you want to get ID squared?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1505342033, "post_id": 46207623, "comment_id": 79378947, "body": "see also <a href=\"https://stackoverflow.com/questions/34287842/c-strongly-typed-using-and-typedef\" title=\"c strongly typed using and typedef\">stackoverflow.com/questions/34287842/&hellip;</a> et al."}, {"owner": {"reputation": 193, "user_id": 3742016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bab35711fb7617331f54a43ace47828?s=128&d=identicon&r=PG&f=1", "display_name": "I want to make games", "link": "https://stackoverflow.com/users/3742016/i-want-to-make-games"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1505342051, "post_id": 46207623, "comment_id": 79378955, "body": "@AlgirdasPreid\u017eius - Thanks so much. I was not aware you could do something like that. I suppose that will work for any primitive type?"}, {"owner": {"reputation": 193, "user_id": 3742016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bab35711fb7617331f54a43ace47828?s=128&d=identicon&r=PG&f=1", "display_name": "I want to make games", "link": "https://stackoverflow.com/users/3742016/i-want-to-make-games"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1505342254, "post_id": 46207623, "comment_id": 79379021, "body": "@n.m. Oh yeah, that&#39;s a valid point, Algirdas&#39;s solution makes no restrictions on nonsensical operations. I guess I will just overload the selected operators by hand. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 1, "last_activity_date": 1505341481, "creation_date": 1505341481, "answer_id": 46207694, "question_id": 46207623, "link": "https://stackoverflow.com/questions/46207623/how-to-create-nice-to-use-type-checked-aliases-for-primitive-types-in-c/46207694#46207694", "title": "How to create nice-to-use type-checked aliases for primitive types in C++?", "body": "<p>I don't know about the \"best\" way but one thing you can do is create <strong>one</strong> type that overloads all the relevant operators and takes an integral template parameter so you can differentiate your types with a number:</p>\n\n<pre><code>template&lt;std::size_t ID&gt;\nclass strongly_typed_int\n{\npublic:\n    explicit strongly_typed_int(int i = 0): i(i) {}\n\n    // ...\n\n    strongly_typed_int operator+(strongly_typed_int i) { /*...*/ }\n    // etc...\n\nprivate:\n    int i;\n};\n\nusing security_id = strongly_typed_int&lt;0&gt;;\nusing access_code = strongly_typed_int&lt;1&gt;;\n// etc...\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3742016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bab35711fb7617331f54a43ace47828?s=128&d=identicon&r=PG&f=1", "display_name": "I want to make games", "link": "https://stackoverflow.com/users/3742016/i-want-to-make-games"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "closed_date": 1505341912, "answer_count": 1, "score": -2, "last_activity_date": 1505341481, "creation_date": 1505340999, "question_id": 46207623, "link": "https://stackoverflow.com/questions/46207623/how-to-create-nice-to-use-type-checked-aliases-for-primitive-types-in-c", "closed_reason": "Duplicate", "title": "How to create nice-to-use type-checked aliases for primitive types in C++?", "body": "<p>I'm writing code where I'm creating multiple aliases for primitive types, e.g. <em>Address</em> and <em>Id</em> being <em>int</em>s.</p>\n\n<p>I want to avoid using Addresses and Ids together, e.g. in arithmetic operations.</p>\n\n<p>Thus I would like to have type-checking on these aliases, so that the following result can be obtained:</p>\n\n<pre><code>typedef int A;\ntypedef int B;\n\nA f(A a) { return a+a; };\n\nint main()\n{\n  A a = 5;\n  B b = 5;\n  f(a);     // I would like this to work...\n  f(b);     // and this not to compile.\n}\n</code></pre>\n\n<p>Now this does not work, but I know I can use a wrapper struct/class with just one member:</p>\n\n<pre><code>class A { public: int x; A(int xx) { x = xx; }};\nclass B { public: int x; B(int xx) { x = xx; }};\n\nA f(A a) { return A(a.x+a.x); }; // this is ugly and I'd want to be able to use: return a+a\n\nint main()\n{\n  A a = 5;\n  B b = 5;\n  f(a);     // This will work...\n  f(b);     // This won't compile...\n}\n</code></pre>\n\n<p><strong>My question is</strong> - what's the best way I can get code working like the 2nd snippet, but without having to explicitly getting <em>x</em> all the time and construct new objects (as noted in the line with the \"this is ugly\" comment)?</p>\n\n<p>I guess I can overload all relevant operators for all my 'aliases' but that's a lot of work and I'm hoping there's a faster/nicer solution.</p>\n\n<p>Thanks.</p>\n\n<p>PS To make this a concrete SO question, not a discussion: I'm just asking for a different way of achieving the result I want, than overloading everything. Thank you.</p>\n"}, {"tags": ["c++", "winapi", "visual-studio-2017"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505343071, "post_id": 46207616, "comment_id": 79379254, "body": "Drag&amp;Drop between windows is implemented using the <code>IDragSource</code> and <code>IDropTarget</code> interfaces with the <code>RegisterDragDrop()</code> and <code>DoDragDrop()</code> functions. The source window creates an <code>IDataObject</code> to represent the item(s) be dragged, and passes that to <code>DoDragDrop()</code> along with its <code>IDragSource</code>. The target window&#39;s <code>IDropTarget</code> receives the <code>IDataObject</code> and can extract the items from it. <code>IDragSourceHelper&#47;2</code> and <code>IDropTargetHelper</code> can optionally be implemented to display custom images during dragging"}, {"owner": {"reputation": 1, "user_id": 7508969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e06d8b200cd6f169279b1c4dd11fdbf?s=128&d=identicon&r=PG&f=1", "display_name": "Wyxe", "link": "https://stackoverflow.com/users/7508969/wyxe"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505356781, "post_id": 46207616, "comment_id": 79382481, "body": "Thanks for responding, but I was looking to just use buttons instead. There are a lot of things that the user will be able to put in the main window, and many instances of each, so the shorter the code can be the better. I was just hoping and wondering if there was anything I could do similar to AppInventor&#39;s code block controls. The Drag and Drop thing was just added as an alternative to buttons, which isn&#39;t the main thing I&#39;m asking.  Still, thanks for getting back to me!"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505357192, "post_id": 46207616, "comment_id": 79382565, "body": "AppInventor is a 3rd party app that many people here likely have not heard of (I haven&#39;t). It would help if you could post screenshots or a video/GIF of the functionality you want to replicate. What problem are you having with clicking a button in one window that adds an item in another window? That is a pretty basic operation to perform even with core Win32 UI controls. You need to provide more details about your issue, or your question is likely to get closed as off-topic."}, {"owner": {"reputation": 1, "user_id": 7508969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e06d8b200cd6f169279b1c4dd11fdbf?s=128&d=identicon&r=PG&f=1", "display_name": "Wyxe", "link": "https://stackoverflow.com/users/7508969/wyxe"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505504288, "post_id": 46207616, "comment_id": 79457090, "body": "Thanks for the suggestion, Remy. I went to the site and found what I was talking about and took a screenshot, then edited the relevant information to it, as well as reposted my question onto it, refined. <a href=\"https://imgur.com/a/ARfKE\" rel=\"nofollow noreferrer\">imgur.com/a/ARfKE</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505505947, "post_id": 46207616, "comment_id": 79457803, "body": "That AppInventor UI is clearly not a multi-window UI, so dragging objects around is probably pretty simple for it to do. <a href=\"http://appinventor.mit.edu/appinventor-sources/\" rel=\"nofollow noreferrer\">AppInventor is open source</a>, so feel free to see how they actually implemented it. But you haven&#39;t answered my question yet. What actual problem are you having in implementing your goal? Clicking a button to add something in another window is not difficult to do, so what are you hung up on exactly? You could use a PictureBox for your controls, but I would use a custom-drawn control for better performance, custom shapes, etc."}, {"owner": {"reputation": 1, "user_id": 7508969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e06d8b200cd6f169279b1c4dd11fdbf?s=128&d=identicon&r=PG&f=1", "display_name": "Wyxe", "link": "https://stackoverflow.com/users/7508969/wyxe"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505520081, "post_id": 46207616, "comment_id": 79461893, "body": "Working with picturebox controls in the past have been rather restricting. I must say though, that I&#39;ve never worked with them in C++, only with Visual Basic. Are you actually able to allow the user to click a picture in a picture box, then take that picture and move it around according to where the user&#39;s cursor is, and then leave it where the cursor rests once the user clicks again? And can I get the x and y of where it is located? My hang up is that I don&#39;t understand how I will implement this system, not that I can&#39;t. I don&#39;t have the knowledge, but I have the ability. Character limitsSuck"}, {"owner": {"reputation": 1, "user_id": 7508969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e06d8b200cd6f169279b1c4dd11fdbf?s=128&d=identicon&r=PG&f=1", "display_name": "Wyxe", "link": "https://stackoverflow.com/users/7508969/wyxe"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505520260, "post_id": 46207616, "comment_id": 79461926, "body": "The problem with that though, is that this program is a level editing program for a game, and must not only be able to do this picture thing, but also scroll to the right and back to the left. I currently have a group box set up, so multiple picture boxes would allow me to do that, but if it&#39;s just one, I doubt it&#39;ll work correctly."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505521426, "post_id": 46207616, "comment_id": 79462116, "body": "That doesn&#39;t change what I said. I would still create a custom drawn control for the pictures (that way, you can load a given bitmap in memory once and share it across all controls that need it), and simply place them on a scrollable parent window. But even if you use a separate PictureBox for each image, that&#39;s fine too (at the cost of more memory used)."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505521649, "post_id": 46207616, "comment_id": 79462161, "body": "As for dragging, that is easy if it is within a single parent window. <code>WM_LBUTTONDOWN</code> can save the current mouse position, <code>WM_MOUSEMOVE</code> can move the image relative to the last mouse position while the mouse is held down, and <code>WM_LBUTTONUP</code> can finalize the drag. Dragging over parent window boundaries is a bit harder. I would have <code>WM_LBUTTONDOWN</code> set a flag, <code>WM_MOUSEMOVE</code> create a floating window that shows the same image if the flag is set, and then move that window around, and then <code>WM_LBUTTONUP</code> applies the image to the new parent window and destroy the floating window."}, {"owner": {"reputation": 1, "user_id": 7508969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e06d8b200cd6f169279b1c4dd11fdbf?s=128&d=identicon&r=PG&f=1", "display_name": "Wyxe", "link": "https://stackoverflow.com/users/7508969/wyxe"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505532991, "post_id": 46207616, "comment_id": 79463725, "body": "I&#39;ll look into that. That sounds pretty feasible. I&#39;m gonna learn all of that and see if it&#39;ll work out for me.Thank you for all the help"}], "owner": {"reputation": 1, "user_id": 7508969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e06d8b200cd6f169279b1c4dd11fdbf?s=128&d=identicon&r=PG&f=1", "display_name": "Wyxe", "link": "https://stackoverflow.com/users/7508969/wyxe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505505560, "creation_date": 1505340945, "last_edit_date": 1505505560, "question_id": 46207616, "link": "https://stackoverflow.com/questions/46207616/putting-a-code-block-like-control-from-app-inventor-in-desktop-app", "title": "putting a code-block-like control from App Inventor in desktop app", "body": "<p>I'm trying to make a simple program that allows you to click and drag an item from one window, a child window, to another, the parent window. It's going to be a game level editor of sorts that I'm working on for a video game I need for a school project. I have months to do it, so I'm in no rush.</p>\n\n<p>The thing I'm curious about is how I'll get an item from the child window to the parent window during runtime. I can have buttons in the child window that place objects in the parent window. That was my original idea - so having the Drag and Drop functionality isn't exactly necessary. I just want to know if I can do that with images, in a format similar to App Inventor - how it writes code in the background while you fiddle around with the building window, placing various blocks down. My version would be exactly like App Inventor, but it's in a desktop application and there are no words, only pictures.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GaAt4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GaAt4.png\" alt=\"image\"></a></p>\n\n<p>Does WINAPI have a control like that already built in? If so, I would love to know the name or where to find information about it. I'm just not sure how to begin to search for that, except for this site. </p>\n\n<p>My original idea was to use picturebox controls, but I'd either have to litter the entire window with them and allow the user to click and drag them to \"move\" them around while it sets the image to one or the other picturebox, while in the background setting the code automatically, or something else. Either way, I'm sure it's possible, but I really doubt that's the way I want to go. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 3, "creation_date": 1505341069, "post_id": 46207604, "comment_id": 79378644, "body": "Consider learning from a <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good book</a>, rather than trying to code randomly."}, {"owner": {"reputation": 93, "user_id": 6508060, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0b582718187ecf3a75f8efb12cdd7077?s=128&d=identicon&r=PG&f=1", "display_name": "Blake K Akiti", "link": "https://stackoverflow.com/users/6508060/blake-k-akiti"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1505342244, "post_id": 46207604, "comment_id": 79379015, "body": "Not very useful. but thanks for visiting"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1505392161, "post_id": 46207604, "comment_id": 79400792, "body": "Why isn&#39;t it useful? The mistakes that you made, so trivial, that syntax regarding those, should be covered in the first chapters of any good book. By suggesting reading one, I could prevent you from making more of the similar problems in the future."}, {"owner": {"reputation": 93, "user_id": 6508060, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0b582718187ecf3a75f8efb12cdd7077?s=128&d=identicon&r=PG&f=1", "display_name": "Blake K Akiti", "link": "https://stackoverflow.com/users/6508060/blake-k-akiti"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1505511138, "post_id": 46207604, "comment_id": 79459713, "body": "Which book would you suggest?"}], "answers": [{"comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1505341804, "post_id": 46207642, "comment_id": 79378865, "body": "The error is in the missing parenthesis in <i>attempted</i> function <code>getbase</code>/<code>getheight</code> calls, as well."}, {"owner": {"reputation": 93, "user_id": 6508060, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0b582718187ecf3a75f8efb12cdd7077?s=128&d=identicon&r=PG&f=1", "display_name": "Blake K Akiti", "link": "https://stackoverflow.com/users/6508060/blake-k-akiti"}, "edited": false, "score": 0, "creation_date": 1505510954, "post_id": 46207642, "comment_id": 79459640, "body": "Thanks, that clarified a few things. The code below now works perfectly"}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": false, "score": 4, "last_activity_date": 1505342039, "last_edit_date": 1505342039, "creation_date": 1505341098, "answer_id": 46207642, "question_id": 46207604, "link": "https://stackoverflow.com/questions/46207604/error-calculating-the-area-of-a-triangle/46207642#46207642", "title": "Error calculating the area of a triangle?", "body": "<p>The issue is in these lines:</p>\n\n<pre><code>cin &gt;&gt; isoscoles1.setheight;\ncin &gt;&gt; isoscoles1.setbase;\n</code></pre>\n\n<p>Remember that <code>setheight</code> and <code>setbase</code> are member functions, not actual variables. This would be like writing something like this:</p>\n\n<pre><code>void doSomething(double arg) {\n    ...\n}\n\ncin &gt;&gt; doSomething; // Error - can't read into a function!\n</code></pre>\n\n<p>In the above case, you'd really do something like this:</p>\n\n<pre><code>double value;\ncin &gt;&gt; value;\ndoSomething(value);\n</code></pre>\n\n<p>This separates out reading the value from calling the function.</p>\n\n<p>Based on that, see if you can think about how you'd use an analogous solution to solve your own problem.</p>\n\n<hr>\n\n<p>There's another issue here, as was pointed out in the comments. Take a look at these lines:</p>\n\n<pre><code>isoscoles1.setbase;\nisoscoles1.setheight;\n</code></pre>\n\n<p>Think back to our <code>doSomething</code> function. Would you normally have a line of code like this?</p>\n\n<pre><code>doSomething;\n</code></pre>\n\n<p>You can safely delete those two lines; they don't actually do anything and they're causing some of the errors you're seeing.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 6508060, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0b582718187ecf3a75f8efb12cdd7077?s=128&d=identicon&r=PG&f=1", "display_name": "Blake K Akiti", "link": "https://stackoverflow.com/users/6508060/blake-k-akiti"}, "is_accepted": false, "score": 0, "last_activity_date": 1505343710, "creation_date": 1505343710, "answer_id": 46208068, "question_id": 46207604, "link": "https://stackoverflow.com/questions/46207604/error-calculating-the-area-of-a-triangle/46208068#46208068", "title": "Error calculating the area of a triangle?", "body": "<p>This works perfectly.</p>\n\n<p><code>class Triangle {</code>\n<code>public:\n    void setbase(double x) { //was void but changed it to double\n        base = x;\n    }</code></p>\n\n<pre><code>void setheight(double y) {\n    height = y;\n}\ndouble getbase() {\n    return base;\n}\ndouble getheight() {\n    return height;\n}\n</code></pre>\n\n<p><code>private:\n    double base;\n    double height;\n};</code></p>\n\n<p><code>double area(double, double);</code></p>\n\n<p><code>int main() {</code></p>\n\n<pre><code>Triangle isoscoles1;\ndouble x;\ndouble y;\ncin &gt;&gt; x &gt;&gt; y;\n\nisoscoles1.setheight(y);\nisoscoles1.setbase(x);\ndouble b = isoscoles1.getbase();\ndouble h = isoscoles1.getheight();\n\ncout &lt;&lt; \"Triangle Area=\" &lt;&lt; area(x,y) &lt;&lt; endl;\nsystem(\"pause&gt;nul\");\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p><code>double area(double x, double y) {\n    double a;\n    a = (x*y) / 2;</code></p>\n\n<pre><code>    return a;\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 93, "user_id": 6508060, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0b582718187ecf3a75f8efb12cdd7077?s=128&d=identicon&r=PG&f=1", "display_name": "Blake K Akiti", "link": "https://stackoverflow.com/users/6508060/blake-k-akiti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1505343710, "creation_date": 1505340897, "last_edit_date": 1505341343, "question_id": 46207604, "link": "https://stackoverflow.com/questions/46207604/error-calculating-the-area-of-a-triangle", "title": "Error calculating the area of a triangle?", "body": "<p>I'm working on a program that reads the base and height of a triangle of a triangle and then reports the area. Here's what I have so far:</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\n// a simple triangle class with a base and a height\n\nclass Triangle {\n\npublic:    \n    double setbase(double x) { //was void but changed it to double\n        base = x;\n    }    \n    double setheight(double y) {\n        height = y;\n    }\n    double getbase() {\n        return base;\n    }\n    double getheight() {\n        return height;\n    }\n\nprivate:\n    double base, height;\n};    \n\n\ndouble area(double, double);    \n\nint main() {    \n\n    Triangle isoscoles1;\n    isoscoles1.setbase;\n    isoscoles1.setheight;\n\n\n    cin &gt;&gt; isoscoles1.setheight;\n    cin &gt;&gt; isoscoles1.setbase;\n    double x = isoscoles1.getbase;\n    double y = isoscoles1.getheight;\n\n    cout &lt;&lt; \"Triangle Area=\" &lt;&lt; area(x,y) &lt;&lt; endl;\n    system(\"pause&gt;nul\");\n}\n\n\ndouble area(double x, double y) {\n    double a;\n    a = (x*y) / 2;    \n\n    return a;\n}\n</code></pre>\n\n<p>This is the error it gives me:-</p>\n\n<pre><code>Severity    Code    Description Project File    Line    Suppression State\nError   C3867   'Triangle::setbase': non-standard syntax; use '&amp;' to create a pointer to member Project1    c:\\users\\ku\\desktop\\test\\project1\\main.cpp  50  \nError   C3867   'Triangle::setheight': non-standard syntax; use '&amp;' to create a pointer to member   Project1    c:\\users\\ku\\desktop\\test\\project1\\main.cpp  51  \nError   C2679   binary '&gt;&gt;': no operator found which takes a right-hand operand of type 'overloaded-function' (or there is no acceptable conversion)    Project1    c:\\users\\ku\\desktop\\test\\project1\\main.cpp  54  \nError   C2679   binary '&gt;&gt;': no operator found which takes a right-hand operand of type 'overloaded-function' (or there is no acceptable conversion)    Project1    c:\\users\\ku\\desktop\\test\\project1\\main.cpp  55  \nError   C3867   'Triangle::getbase': non-standard syntax; use '&amp;' to create a pointer to member Project1    c:\\users\\ku\\desktop\\test\\project1\\main.cpp  56  \nError   C3867   'Triangle::getheight': non-standard syntax; use '&amp;' to create a pointer to member   Project1    c:\\users\\ku\\desktop\\test\\project1\\main.cpp  57  \n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1505340727, "post_id": 46207555, "comment_id": 79378529, "body": "a reference can&#39;t refer to nothing while a pointer can point to null"}, {"owner": {"reputation": 271, "user_id": 7432759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf4f8ca1cdcdc91d67e6e726f240f5a4?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/7432759/j-b"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1505340787, "post_id": 46207555, "comment_id": 79378543, "body": "@vu1p3n0x But why would that be better on this case?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1505340818, "post_id": 46207555, "comment_id": 79378552, "body": "Try to implement using lvalue reference and you will understand."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1505340992, "post_id": 46207555, "comment_id": 79378621, "body": "@user7432759 <a href=\"http://doc.qt.io/qt-5/qstring.html#toInt\" rel=\"nofollow noreferrer\">You could have looked at the Qt docs and function declaration</a> to infer why they use a pointer."}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1505394527, "post_id": 46207589, "comment_id": 79402595, "body": "I do not think described problems are real, lib can just compare address of passed <code>bool</code> to predefined one and treat it as null. Real issue is readability - it is clear from function signature for a reader why pointer is used."}], "tags": [], "owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "is_accepted": false, "score": 5, "last_activity_date": 1505344384, "last_edit_date": 1505344384, "creation_date": 1505340799, "answer_id": 46207589, "question_id": 46207555, "link": "https://stackoverflow.com/questions/46207555/why-qstringtoint-receives-a-pointer-and-not-a-reference/46207589#46207589", "title": "Why QString::toInt() receives a pointer and not a reference?", "body": "<p>In C++ it is mandatory that references refer to something. There is no null reference check, so it cannot be an optional parameter with a default null value, as it is with a pointer, which can be null, and can be checked to determine whether it should be used or not.</p>\n\n<p>They could have used a reference if they made an overload of the function with different parameters. But this is easier and more straightforward. </p>\n\n<p>EDIT: As R Sahu noted, it is indeed possible to provide a default value for a reference parameter. However, this can lead to several overheads:</p>\n\n<ul>\n<li><p>best case scenario, the default bool will end up being set every time, regardless whether you actually pass one. This could end up occupying a whole line cache, wasting like 64 bytes of precious L1 cache over nothing</p></li>\n<li><p>worse case scenario, the default bool will not be cached, which would require a RAM access, which will take a lot of CPU cycles before that data reaches a register</p></li>\n<li><p>worst case scenario, that memory will happened to be paged, god forbid on mechanical storage, which will take tremendously more than the previous scenario</p></li>\n<li><p>additionally, in a multi-threaded scenario, which is very usual, this might require some basic synchronization, on the odd chance someone decides to use the default bool rather than a user provided one, which will require even more overhead, even in the cases where the usage scenario is thread safe</p></li>\n</ul>\n\n<p>Granted, this penalty might get masked out to a certain extent because of the lack of need to read it. But it will still be there nonetheless and will take its toll. Which can be totally avoided by using a null pointer and simply omitting that access if the pointer is null. So the need to use the <code>&amp;</code> operator is actually a small price to pay for avoiding all this.</p>\n"}, {"tags": [], "owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "is_accepted": false, "score": 0, "last_activity_date": 1505341142, "creation_date": 1505341142, "answer_id": 46207645, "question_id": 46207555, "link": "https://stackoverflow.com/questions/46207555/why-qstringtoint-receives-a-pointer-and-not-a-reference/46207645#46207645", "title": "Why QString::toInt() receives a pointer and not a reference?", "body": "<p>Using a pointer <strong>with a default parameter</strong> allows the user to just call <code>int res = QString::toInt()</code> with no parameters. This can be very tricky with references, you need several overloads of <code>toInt()</code>.\n<p>For the case the user is interested in if conversion was successful or using another base, the pointers are there ready for use.</p>\n"}, {"comments": [{"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1505344529, "post_id": 46207674, "comment_id": 79379664, "body": "Providing such an object will have an array of downsides on its own, which I outlined in my answer edit. Overall, I&#39;d say in this particular aspect Qt provides the most efficient solution, whose only limitation is only due to C++&#39;s lack of support for null references."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1505395181, "post_id": 46207674, "comment_id": 79403084, "body": "@dtech there is no lack of support for null references, they are not supported by design. You can simulate nullptr by providing special library provided <code>bool</code>, but providing such value when user need to pass different value for <code>base</code> is convoluted."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1505395824, "post_id": 46207674, "comment_id": 79403630, "body": "@Slava I think that &quot;by design&quot; is implied, since I talk about the language itself, not about any particular compiler or runtime implementation."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 4, "last_activity_date": 1505341314, "creation_date": 1505341314, "answer_id": 46207674, "question_id": 46207555, "link": "https://stackoverflow.com/questions/46207555/why-qstringtoint-receives-a-pointer-and-not-a-reference/46207674#46207674", "title": "Why QString::toInt() receives a pointer and not a reference?", "body": "<blockquote>\n  <p>I know it could be implemented using either, but I don't see any advantage of using a pointer over a reference.</p>\n</blockquote>\n\n<p>You could use a reference also with a default value with </p>\n\n<pre><code>int QString::toInt(bool&amp; ok = some_bool_guaranteed_by_the_library,\n                   int base = 10) const;\n</code></pre>\n\n<p>The downside of this is that the library has to provide <code>some_bool_guaranteed_by_the_library</code> as a globally available <code>bool</code> object. It sounds like the designers of the library did not see enough benefits to provide such an object.</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 0, "last_activity_date": 1505395044, "creation_date": 1505395044, "answer_id": 46220250, "question_id": 46207555, "link": "https://stackoverflow.com/questions/46207555/why-qstringtoint-receives-a-pointer-and-not-a-reference/46220250#46220250", "title": "Why QString::toInt() receives a pointer and not a reference?", "body": "<blockquote>\n  <p>Why is 'ok' a pointer and not a reference?</p>\n</blockquote>\n\n<p>Because it is common practice to pass parameter by pointer if caller need to signal - do not use this parameter. So user of the library can understand how to skip using this parameter without any further explanation in documentation ie function signature is self documented.</p>\n"}], "owner": {"reputation": 271, "user_id": 7432759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf4f8ca1cdcdc91d67e6e726f240f5a4?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/7432759/j-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 46207674, "answer_count": 4, "score": 0, "last_activity_date": 1505395044, "creation_date": 1505340551, "question_id": 46207555, "link": "https://stackoverflow.com/questions/46207555/why-qstringtoint-receives-a-pointer-and-not-a-reference", "title": "Why QString::toInt() receives a pointer and not a reference?", "body": "<p>QString has a few methods such as toInt(), toLong(), etc.</p>\n\n<p>These methods receive a pointer to bool that determines if the conversion was successful as shown here:</p>\n\n<pre><code>int QString::toInt(bool * ok = 0, int base = 10) const\n</code></pre>\n\n<p>My question is:</p>\n\n<p>Why is 'ok' a pointer and not a reference? </p>\n\n<p>I know it could be implemented using either, but I don't see any advantage of using a pointer over a reference.</p>\n"}, {"tags": ["c++", "protocol-buffers", "cross-compiling", "yocto", "grpc"], "comments": [{"owner": {"reputation": 1167, "user_id": 5339807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5db3c9fa9b80760fc44ae03008f7a1?s=128&d=identicon&r=PG&f=1", "display_name": "mascoj", "link": "https://stackoverflow.com/users/5339807/mascoj"}, "edited": false, "score": 0, "creation_date": 1505341156, "post_id": 46207527, "comment_id": 79378673, "body": "Why can&#39;t you just compile with C through yocto and use as a library as intended by the provided recipe?"}, {"owner": {"reputation": 47, "user_id": 8508906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1ef4a784fb791d96833bb710e1cd60?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier", "link": "https://stackoverflow.com/users/8508906/xavier"}, "reply_to_user": {"reputation": 1167, "user_id": 5339807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5db3c9fa9b80760fc44ae03008f7a1?s=128&d=identicon&r=PG&f=1", "display_name": "mascoj", "link": "https://stackoverflow.com/users/5339807/mascoj"}, "edited": false, "score": 0, "creation_date": 1505350251, "post_id": 46207527, "comment_id": 79381036, "body": "@mascoj Hi Mascoj. The problem is my programs depends on grpc++. To cross compile my program I have to cross compile gRPC++ first so that bitbake can find all gRPC++ dependencies."}, {"owner": {"reputation": 1167, "user_id": 5339807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5db3c9fa9b80760fc44ae03008f7a1?s=128&d=identicon&r=PG&f=1", "display_name": "mascoj", "link": "https://stackoverflow.com/users/5339807/mascoj"}, "edited": false, "score": 0, "creation_date": 1505430097, "post_id": 46207527, "comment_id": 79422652, "body": "Sorry, I misread and didn&#39;t see you meant gRPC++ and not gRPC. gRPC++ comes with a Makefile so you should be able to create a recipe that pulls from github and runs make."}], "answers": [{"tags": [], "owner": {"reputation": 3208, "user_id": 1389358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/000245bcb0910007a54d67e5ba34f1ef?s=128&d=identicon&r=PG", "display_name": "Ross Burton", "link": "https://stackoverflow.com/users/1389358/ross-burton"}, "is_accepted": false, "score": 0, "last_activity_date": 1505900013, "creation_date": 1505900013, "answer_id": 46318382, "question_id": 46207527, "link": "https://stackoverflow.com/questions/46207527/how-to-write-a-yocto-recipe-for-grpc/46318382#46318382", "title": "How to write a yocto recipe for gRPC++?", "body": "<p>Unless you've specific problems you just need to write another recipe.  Use recipetool to create a starting point for the recipe and edit it as required.</p>\n"}], "owner": {"reputation": 47, "user_id": 8508906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1ef4a784fb791d96833bb710e1cd60?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier", "link": "https://stackoverflow.com/users/8508906/xavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 721, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517229344, "creation_date": 1505340384, "question_id": 46207527, "link": "https://stackoverflow.com/questions/46207527/how-to-write-a-yocto-recipe-for-grpc", "title": "How to write a yocto recipe for gRPC++?", "body": "<p>So i am trying to cross compile gRPC for yocto (target) on a Ubuntu host. The recipe located here <a href=\"https://github.com/intel-iot-devkit/meta-iot-cloud/tree/master/recipes-support/grpc\" rel=\"nofollow noreferrer\">https://github.com/intel-iot-devkit/meta-iot-cloud/tree/master/recipes-support/grpc</a> is only for C and Python but not C++.</p>\n\n<p>Can I get some help on writing a yocto recipe for cross-compiling gRPC++ as well? Thanks! </p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1505341184, "post_id": 46207490, "comment_id": 79378681, "body": "an example of possible failure without fences: <a href=\"https://bartoszmilewski.com/2008/11/05/who-ordered-memory-fences-on-an-x86/\" rel=\"nofollow noreferrer\">bartoszmilewski.com/2008/11/05/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1927, "user_id": 2017412, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c55a6dedf87df0058a6f2031079102f5?s=128&d=identicon&r=PG", "display_name": "Monku", "link": "https://stackoverflow.com/users/2017412/monku"}, "edited": false, "score": 0, "creation_date": 1505341373, "post_id": 46207607, "comment_id": 79378735, "body": "Sorry but could you please point me the text in the link where it says so. I don&#39;t see where it says MOV implicitly results into acquire-release semantics."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 1927, "user_id": 2017412, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c55a6dedf87df0058a6f2031079102f5?s=128&d=identicon&r=PG", "display_name": "Monku", "link": "https://stackoverflow.com/users/2017412/monku"}, "edited": false, "score": 0, "creation_date": 1505341408, "post_id": 46207607, "comment_id": 79378750, "body": "@Monku &quot;Load Acquire:\tMOV (from memory)&quot; &quot;Store Release:\tMOV (into memory)&quot;"}, {"owner": {"reputation": 1927, "user_id": 2017412, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c55a6dedf87df0058a6f2031079102f5?s=128&d=identicon&r=PG", "display_name": "Monku", "link": "https://stackoverflow.com/users/2017412/monku"}, "edited": false, "score": 0, "creation_date": 1505341484, "post_id": 46207607, "comment_id": 79378766, "body": "Yea but my load and stores above are <code>explicitly</code> using relaxed ordering."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 1927, "user_id": 2017412, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c55a6dedf87df0058a6f2031079102f5?s=128&d=identicon&r=PG", "display_name": "Monku", "link": "https://stackoverflow.com/users/2017412/monku"}, "edited": false, "score": 1, "creation_date": 1505341551, "post_id": 46207607, "comment_id": 79378793, "body": "@Monku That&#39;s not the point. There is no x86 instruction that is less strict than <code>MOV</code>. So you are getting acquire-release semantics at minimum whether you ask for it or not. That&#39;s built into the x86 architecture."}, {"owner": {"reputation": 1927, "user_id": 2017412, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c55a6dedf87df0058a6f2031079102f5?s=128&d=identicon&r=PG", "display_name": "Monku", "link": "https://stackoverflow.com/users/2017412/monku"}, "edited": false, "score": 0, "creation_date": 1505341605, "post_id": 46207607, "comment_id": 79378809, "body": "Got it. Thanks."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 3, "last_activity_date": 1505340920, "creation_date": 1505340920, "answer_id": 46207607, "question_id": 46207490, "link": "https://stackoverflow.com/questions/46207490/relaxed-memory-ordering-in-c/46207607#46207607", "title": "Relaxed Memory Ordering in C++", "body": "<p>On Intel x86 architecture processors, the <code>MOV</code> instruction automatically has acquire-release semantics, so it might not be possible to observe the reordering you would expect from relaxed semantics. However, you should not rely on this, because the compiler is still allowed to reorder instructions for optimization purposes.</p>\n\n<p>See <a href=\"https://www.cl.cam.ac.uk/~pes20/cpp/cpp0xmappings.html\" rel=\"nofollow noreferrer\">https://www.cl.cam.ac.uk/~pes20/cpp/cpp0xmappings.html</a></p>\n"}], "owner": {"reputation": 1927, "user_id": 2017412, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c55a6dedf87df0058a6f2031079102f5?s=128&d=identicon&r=PG", "display_name": "Monku", "link": "https://stackoverflow.com/users/2017412/monku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "accepted_answer_id": 46207607, "answer_count": 1, "score": 2, "last_activity_date": 1505340920, "creation_date": 1505340142, "question_id": 46207490, "link": "https://stackoverflow.com/questions/46207490/relaxed-memory-ordering-in-c", "title": "Relaxed Memory Ordering in C++", "body": "<p>I am trying to understand <code>Relaxed Memory Ordering</code> of C++11. My understanding is as :</p>\n\n<pre><code>This ordering guarantees that the ordering of operations on a \nparticular atomic variable doesn't change but ordering\nof operations of different atomic variables can change. The ordering here is\nwithin the same thread. For example, \n\nThread 1\noperation A on atomic X\noperation B on atomic Y\noperation C on atomic Y\noperation D on atomic X\n\nRelaxed ordering guarantees that operation A will always happen-before\noperation D and operation B will always happen-before operation C. \nHaving said that, the ordering of operations between X &amp; Y can still change.\nThat is, suppose the original code was like above. One possible execution\norder could be:\noperation A on atomic X\noperation D on atomic X\noperation B on atomic Y\noperation C on atomic Y\n</code></pre>\n\n<p>Please correct me if my understanding is wrong.</p>\n\n<p>I wrote a sample code below to test <code>Relaxed Memory Ordering</code> and expected <code>assert</code> to fail sometime. But it never fails. I built this program on <code>Visual Studio 2017</code> and running on <code>Windows 10</code> with <code>Intel(R) Core(TM) i7-6600U CPU@ 2.60GHz 2.80GHz</code></p>\n\n<pre><code>class RelaxedMemoryOrdering{\n#define ARRAY_SIZE 4096\npublic:\n  static int var_array[ARRAY_SIZE];\n  RelaxedMemoryOrdering() {\n    for (int index = 0; index &lt; ARRAY_SIZE; ++index) {\n      var_array[index] = 0;\n    }\n    sync1 = 0;\n    sync2 = 0;\n    sync3 = 0;\n    sync4 = 0;\n    sync5 = 0;\n    }\n\n  void thread1() {\n    sync1.store(1, std::memory_order_relaxed);\n    sync2.store(1, std::memory_order_relaxed);\n    sync3.store(1, std::memory_order_relaxed);\n\n    for (int index = 0; index &lt; ARRAY_SIZE; ++index) {\n        var_array[index] = index + 1;\n    }\n\n    sync4.store(1, std::memory_order_relaxed);\n    sync5.store(1, std::memory_order_relaxed);\n  }\n\n  void thread2() {\n    while (!sync5.load(std::memory_order_relaxed)) {\n      ;\n    }\n\n    assert(sync4.load(std::memory_order_relaxed) == 1);\n\n    for (int index = 0; index &lt; ARRAY_SIZE; ++index) {\n        assert(RelaxedMemoryOrdering::var_array[index] == (index + 1));\n    }\n\n    assert(sync3.load(std::memory_order_relaxed) == 1);\n    assert(sync2.load(std::memory_order_relaxed) == 1);\n    assert(sync1.load(std::memory_order_relaxed) == 1);\n  }\n\n  void Test() {\n    std::thread t1(&amp;RelaxedMemoryOrdering::thread1, this);\n    std::thread t2(&amp;RelaxedMemoryOrdering::thread2, this);\n    t1.join();\n    t2.join();\n  }\n\nprivate:\n  std::atomic_int sync1{0};\n  std::atomic_int sync2{0};\n  std::atomic_int sync3{0};\n  std::atomic_int sync4{0};\n  std::atomic_int sync5{0};\n};\n\nstatic void TestRelaxedMemoryOrdering() {\n  while (1) {\n    {\n      RelaxedMemoryOrdering rmo;\n      rmo.Test();\n    }\n    std::this_thread::sleep_for(std::chrono::milliseconds(10));\n  }//while loop\n}\n\n\nint main()\n{\n    TestRelaxedMemoryOrdering();\n}\n</code></pre>\n"}, {"tags": ["c++", "global", "shared-memory"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1505339019, "post_id": 46207263, "comment_id": 79377942, "body": "This doesn&#39;t address the question, but names that contain two consecutive underscores (<code>__DIM_DEFINE_H__</code>) and names that begin with an underscore followed by a capital letter are reserved for use by the implementation. Don&#39;t use them in your code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1505339115, "post_id": 46207263, "comment_id": 79377981, "body": "&quot;I don&#39;t want to have to change the hard-coded dimension every time I run&quot; So don&#39;t hard code it."}, {"owner": {"reputation": 13, "user_id": 8605779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847163e6c6711c89b16acf217f7e2305?s=128&d=identicon&r=PG&f=1", "display_name": "Emichael", "link": "https://stackoverflow.com/users/8605779/emichael"}, "edited": false, "score": 0, "creation_date": 1505340312, "post_id": 46207263, "comment_id": 79378359, "body": "Making the code dimension agnostic is an unacceptable increase in run-time unfortunately. Otherwise I&#39;d be with you, I know that globals and hard-coded constants are bad form."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1505340398, "post_id": 46207263, "comment_id": 79378399, "body": "What evidence do you have  thinking making the dimensions non-hard coded would cause performance problems?"}, {"owner": {"reputation": 13, "user_id": 8605779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847163e6c6711c89b16acf217f7e2305?s=128&d=identicon&r=PG&f=1", "display_name": "Emichael", "link": "https://stackoverflow.com/users/8605779/emichael"}, "edited": false, "score": 0, "creation_date": 1505340986, "post_id": 46207263, "comment_id": 79378619, "body": "Implementation, unfortunately. This code has a pretty small time window it has to fit into. I bet there are other places that I can optimize, but this is the one I&#39;m working on today."}, {"owner": {"reputation": 13, "user_id": 8605779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847163e6c6711c89b16acf217f7e2305?s=128&d=identicon&r=PG&f=1", "display_name": "Emichael", "link": "https://stackoverflow.com/users/8605779/emichael"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1505404334, "post_id": 46207263, "comment_id": 79409898, "body": "@PeteBecker I fixed that privileged variable name, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8605779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847163e6c6711c89b16acf217f7e2305?s=128&d=identicon&r=PG&f=1", "display_name": "Emichael", "link": "https://stackoverflow.com/users/8605779/emichael"}, "edited": false, "score": 0, "creation_date": 1505340232, "post_id": 46207300, "comment_id": 79378333, "body": "This works in general, unfortunately I&#39;m in a pretty rigid environment and I can&#39;t even really add more flags to the automated system&#39;s compiling method."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 13, "user_id": 8605779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847163e6c6711c89b16acf217f7e2305?s=128&d=identicon&r=PG&f=1", "display_name": "Emichael", "link": "https://stackoverflow.com/users/8605779/emichael"}, "edited": false, "score": 0, "creation_date": 1505340581, "post_id": 46207300, "comment_id": 79378469, "body": "@Emichael can you build the header file from a template prior to compilation?"}, {"owner": {"reputation": 13, "user_id": 8605779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847163e6c6711c89b16acf217f7e2305?s=128&d=identicon&r=PG&f=1", "display_name": "Emichael", "link": "https://stackoverflow.com/users/8605779/emichael"}, "edited": false, "score": 0, "creation_date": 1505341391, "post_id": 46207300, "comment_id": 79378742, "body": "I&#39;m not sure what&#39;s involved in that, can you point me to any examples?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 13, "user_id": 8605779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847163e6c6711c89b16acf217f7e2305?s=128&d=identicon&r=PG&f=1", "display_name": "Emichael", "link": "https://stackoverflow.com/users/8605779/emichael"}, "edited": false, "score": 0, "creation_date": 1505341724, "post_id": 46207300, "comment_id": 79378843, "body": "use a makefile rule to produce the header file from a template file. you could use a tool like <code>sed</code> to do the transformation."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 6, "last_activity_date": 1505339153, "creation_date": 1505339153, "answer_id": 46207300, "question_id": 46207263, "link": "https://stackoverflow.com/questions/46207263/including-constants-without-importing-header-file/46207300#46207300", "title": "Including constants without importing header file", "body": "<pre><code>const int dimension = THE_DIMENSION;\n</code></pre>\n\n<p>then compile with</p>\n\n<pre><code>g++ -DTHE_DIMENSION=6 code.cpp\n</code></pre>\n\n<p>No header needed.</p>\n"}], "owner": {"reputation": 13, "user_id": 8605779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847163e6c6711c89b16acf217f7e2305?s=128&d=identicon&r=PG&f=1", "display_name": "Emichael", "link": "https://stackoverflow.com/users/8605779/emichael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 46207300, "answer_count": 1, "score": 0, "last_activity_date": 1505408528, "creation_date": 1505338948, "last_edit_date": 1505408528, "question_id": 46207263, "link": "https://stackoverflow.com/questions/46207263/including-constants-without-importing-header-file", "title": "Including constants without importing header file", "body": "<p>I have a piece of code set up to take a constant integer parameter (dimension of the problem), but it could run with many different dimensions. </p>\n\n<p>I don't want to have to change the hard-coded dimension every time I run, I would ideally define several dummy header functions that are basically just:</p>\n\n<pre><code>#ifndef dim_define_h \n#define dim_define_h \n\n    const int dimension = [DIMENSION SPECIFIC TO THIS HEADER FILE];\n\n#endif\n</code></pre>\n\n<p>Then when compiling I could use whichever header file I needed for that instance like:</p>\n\n<pre><code>g++ dimension_6.h code.cpp\n</code></pre>\n\n<p>Is such a thing possible? Defining a constant in a header file and using it in another file that doesn't explicitly import that header file?</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>My next attempt was to take the main function only, stick it along with the dimension definition in a different file, and make copies of that. Then the compilation looks like: </p>\n\n<pre><code>g++ dim_specific_main.cpp lots.cpp more.cpp helpers.cpp\n</code></pre>\n\n<p>And I think it's making it through the compilation of main now, which depend on helper functions defined in all the helper files. Unfortunately when it tries to compile the helper functions it needs the constant that's defined in main.h and it seems to have forgotten it. </p>\n\n<p>EDIT 2: I realize now that I'm trying to use this variable in places where it needs to be known at compile time, and I think that the linkage happens after compiling, so I do not believe this particular approach is possible. </p>\n"}, {"tags": ["c++", "c++11", "templates", "vector"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1505338617, "post_id": 46207158, "comment_id": 79377799, "body": "Firstly, you need to use <code>sizeof...</code> to determine how many parameters, and make sure that you have enough <code>capacity</code> for that. Then, probably <code>(data[size++]=args)...</code> would work. Dunno really, never had to hack something like that up."}, {"owner": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1505338796, "post_id": 46207158, "comment_id": 79377863, "body": "@SamVarshavchik actually Emplace is supposed to take those parameters and pass them to the constructor of T, to construct a single object of type T. So if I call myVec.Emplace(0, 1.0f); it should translate to data[size++] = T(0, 1.0f);"}, {"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 1, "creation_date": 1505338945, "post_id": 46207158, "comment_id": 79377911, "body": "<code>data[size++] = T(std::forward&lt;ARGS&gt;(args)...);</code> then vOv. Note: <code>std::vector</code> needs to handle non-default constructible types, which your (and this code above) code doesn&#39;t seem to handle."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 1, "creation_date": 1505338968, "post_id": 46207158, "comment_id": 79377921, "body": "@milleniumbug This is not emplacement, except maybe in C++17."}, {"owner": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "edited": false, "score": 0, "creation_date": 1505339169, "post_id": 46207158, "comment_id": 79378001, "body": "data[size++] = T(Forward&lt;ARGS&gt;(args)...); seems to work, thanks very much, and yes, it seems my vector can&#39;t handle classes without default constructor, I will have to tinker with that as well."}, {"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 1, "creation_date": 1505339224, "post_id": 46207158, "comment_id": 79378026, "body": "@NirFriedman See my remark about non-default constructible types."}], "answers": [{"comments": [{"owner": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "edited": false, "score": 0, "creation_date": 1505339311, "post_id": 46207304, "comment_id": 79378060, "body": "It seems to work, however why must I use placement new? I already have enough memory allocated and I can just set the object at data[size++] to the newly created one?"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "edited": false, "score": 0, "creation_date": 1505339330, "post_id": 46207304, "comment_id": 79378067, "body": "@shortage_radeon Because, there is no object there."}, {"owner": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "edited": false, "score": 0, "creation_date": 1505339434, "post_id": 46207304, "comment_id": 79378100, "body": "Ok, but assuming I have specialized my vector with a default constructible type and have allocated the internal array, then it would work?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "edited": false, "score": 0, "creation_date": 1505339436, "post_id": 46207304, "comment_id": 79378102, "body": "@shortage_radeon, that will 1) Create an object from the RHS, and then 2) Assign that object to the location defined by <code>data[size++]</code>."}, {"owner": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "edited": false, "score": 0, "creation_date": 1505339539, "post_id": 46207304, "comment_id": 79378136, "body": "Ok, so for default-constructible types, as long as I maintain the internal array bigger than the size, it will work. I just tested it in debug with a breakpoint in the constructor of a small class i made to test the vector with. I made a custom constructor that takes two parameters and it hits the breakpoint inside it, and everything carries on properly."}, {"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "reply_to_user": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "edited": false, "score": 1, "creation_date": 1505339969, "post_id": 46207304, "comment_id": 79378261, "body": "@shortage_radeon Real-world impls of <code>std::vector</code> don&#39;t use <code>new T[]</code>/<code>delete[]</code> directly, they separate between &quot;raw memory allocation&quot; (<code>Allocator::allocate</code>), &quot;creating objects on the allocated memory&quot; (placement new), &quot;destroying the object&quot; (direct destructor call), &quot;memory deallocation&quot; (<code>Allocator::deallocate</code>)"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "edited": false, "score": 0, "creation_date": 1505340184, "post_id": 46207304, "comment_id": 79378320, "body": "@shortage_radeon To tag on to millenium&#39;s comment, and come back to something you asked about, that <code>construct</code> is likely related to <code>allocator_traits::construct</code>: <a href=\"http://en.cppreference.com/w/cpp/memory/allocator_traits/construct\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/memory/allocator_traits/construct</a>. This is actually how containers construct objects. <code>construct</code> in turn basically defaults to placement new; allocators can override it if they wish but that&#39;s very, very rare."}], "tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": true, "score": 4, "last_activity_date": 1505339799, "last_edit_date": 1505339799, "creation_date": 1505339167, "answer_id": 46207304, "question_id": 46207158, "link": "https://stackoverflow.com/questions/46207158/how-to-construct-any-object-from-variadic-constructor-parameters/46207304#46207304", "title": "How to construct any object from variadic constructor parameters?", "body": "<p>Normally, if <code>date</code> itself was a <code>vector&lt;T&gt;</code> or some such, you could do:</p>\n\n<pre><code>date[size++] = T(std::forward&lt;ARGS&gt;(args)...);\n</code></pre>\n\n<p>However, if you are writing your own vector, then <code>data</code> basically holds some raw memory. What you need is to construct an object directly into that raw memory. To do that, you need placement new:</p>\n\n<pre><code>new (date + size++) T(std::forward&lt;ARGS&gt;(args)...);\n</code></pre>\n\n<p>Note that this placement new issue is orthogonal to using variadics and such; you need placement new when writing <code>push_back</code> as well.</p>\n\n<p>Edit: because you did not tells us the type or content of <code>date</code>, and based on your comments here, I'm assuming you did something like this:</p>\n\n<pre><code>data = new T[capacity];\n</code></pre>\n\n<p><em>If</em> this is what you did, then you <em>must</em> use the first form I gave; using the second form would be undefined because you are constructing an object over another object (and then you can never call its destructor).</p>\n\n<p>However, this is not the correct way to write a vector (or any other generic container). When a vector grabs more memory, it should <em>only</em> grab more memory and not construct anything (<code>new T[capacity]</code> default constructs all the entries in the dynamic array), in that case you <em>must</em> use the second form.</p>\n"}], "owner": {"reputation": 2091, "user_id": 1906587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f81eb80f65ad86bdf820621ff7c68f8?s=128&d=identicon&r=PG", "display_name": "ulak blade", "link": "https://stackoverflow.com/users/1906587/ulak-blade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 46207304, "answer_count": 1, "score": 0, "last_activity_date": 1505339799, "creation_date": 1505338391, "question_id": 46207158, "link": "https://stackoverflow.com/questions/46207158/how-to-construct-any-object-from-variadic-constructor-parameters", "title": "How to construct any object from variadic constructor parameters?", "body": "<p>I am experimenting with making my own containers, and I am writing an Emplace method for my Vector class.</p>\n\n<p>First, here are my Forward functions:</p>\n\n<pre><code>template&lt;typename T&gt;\nT&amp;&amp; Forward(typename remove_reference&lt;T&gt;::Type&amp; arg)\n{\n    return static_cast&lt;T&amp;&amp;&gt;(arg);\n}\n\ntemplate&lt;typename T&gt;\nT&amp;&amp; Forward(typename remove_reference&lt;T&gt;::Type&amp;&amp; arg)\n{\n    static_assert(!Internal::is_lvalue_reference&lt;T&gt;::Result);\n\n    return static_cast&lt;T&amp;&amp;&gt;(arg);\n}\n</code></pre>\n\n<p>They are basically identical to the <code>std</code> ones.</p>\n\n<p>Now here is my <code>Emplace</code> method:</p>\n\n<pre><code>template&lt;typename T&gt;\ntemplate&lt;class... ARGS&gt;\nvoid MyVector&lt;T&gt;::Emplace(ARGS&amp;&amp;... args)\n{\n    Add(Forward&lt;ARGS&gt;(args)...);\n}\n</code></pre>\n\n<p>This gives me an error \"function does not take 2 arguments\", because Add isn't designed to work with variadic arguments. So instead I just do it in place:</p>\n\n<pre><code>template&lt;typename T&gt;\ntemplate&lt;class... ARGS&gt;\nvoid MyVector&lt;T&gt;::Emplace(ARGS&amp;&amp;... args)\n{\n    if(size &gt;= capacity)\n    {\n        AdaptCapacity();\n    }\n\n    data[size++] = value;\n}\n</code></pre>\n\n<p>What am I supposed to put at <code>_data[_size++] = value;</code>? How can I construct any 'T' with the variadic arguments? If I pass a call of Forward to the constructor of T, it would just give me the same error as passing it to Add, because of the '...' syntax. What else can I do?</p>\n\n<p>I tried looking inside std::vector and all I found was some function <code>_Alty_traits::construct</code> that doesn't seem to have any definition(a compiler intrinsic?)</p>\n\n<p>Does that mean it's impossible for me to write a custom Emplace method?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1505336029, "post_id": 46206624, "comment_id": 79376670, "body": "Are you reading any C++ book?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1505336030, "post_id": 46206624, "comment_id": 79376671, "body": "From a security point of vue, it&#39;s hard to do worse than passing arbitrary user data to <code>std::system</code>."}, {"owner": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 0, "creation_date": 1505336210, "post_id": 46206624, "comment_id": 79376769, "body": "How is this code relevant to the functions you mentioned at the beginning?  Where is your complete program?  Where are any error messages that you might be getting?  Where is any research on this problem (whatever it is) that you are having?  What is the intended result?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505336240, "post_id": 46206624, "comment_id": 79376789, "body": "why do you write this code at all? No offense, but it seems a bit pointless to write a c++ program that does nothing else than forwarding what the user typed to a <code>system</code> call. Isnt it easier if you type <code>square(10)</code> directly into your console?"}, {"owner": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505336557, "post_id": 46206624, "comment_id": 79376932, "body": "@tobi303 This is just a example. I have a large tool with interactive c++ interface. All the functions will be in background and the user will want to have leniency in c++ syntax."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505336603, "post_id": 46206624, "comment_id": 79376955, "body": "if this is just an example you should mention it, because honestly it does not look like a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for the problem you describe ;)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1505336807, "post_id": 46206624, "comment_id": 79377053, "body": "@Fran&#231;oisAndrieux I didn&#39;t know typing commands at a shell prompt is a security breach..."}, {"owner": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1505336936, "post_id": 46206624, "comment_id": 79377113, "body": "@Fran&#231;oisAndrieux Is there any other way to do this. I already have background ready. I am just nnot sure how to make a intractive window. But you are right this could be fatal"}, {"owner": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "reply_to_user": {"reputation": 259, "user_id": 7886227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hec3U.jpg?s=128&g=1", "display_name": "Dr t", "link": "https://stackoverflow.com/users/7886227/dr-t"}, "edited": false, "score": 0, "creation_date": 1505337062, "post_id": 46206624, "comment_id": 79377164, "body": "@Drt I am sorry. I just posted the main(). the squre and cube are return statements x*x.The intended result is executing the arg[0] funct on argv[1] and returning the result"}, {"owner": {"reputation": 2007, "user_id": 5834077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N7N3H.jpg?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5834077/carl"}, "edited": false, "score": 0, "creation_date": 1505337300, "post_id": 46206624, "comment_id": 79377254, "body": "@ChinmoyKulkarni if you want to read only argv[1] and argv[2] then you might as well just construct two strings directly: <code>string command(argv[1]);</code> and <code>string argument(argv[2]);</code>. And you&#39;d want to use argv[1] and argv[2] since argv[0] is the command used to execute your program."}, {"owner": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "reply_to_user": {"reputation": 2007, "user_id": 5834077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N7N3H.jpg?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5834077/carl"}, "edited": false, "score": 0, "creation_date": 1505337496, "post_id": 46206624, "comment_id": 79377350, "body": "@Carl I still don&#39;t get you. argv[0] could be &quot;square&quot; or &quot;root&quot;. and argv[1] could be any double. How do I execute argv[0](string to function ?)"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "edited": false, "score": 0, "creation_date": 1505336855, "post_id": 46206839, "comment_id": 79377076, "body": "Thanks. But I still did not see how it will call the command[0] function?"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "reply_to_user": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "edited": false, "score": 0, "creation_date": 1505336900, "post_id": 46206839, "comment_id": 79377098, "body": "@ChinmoyKulkarni Make an <code>std::map&lt;std::string, std::function&lt;std::string(std::string)&gt;&gt;</code> and look up the function in the map."}, {"owner": {"reputation": 2007, "user_id": 5834077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N7N3H.jpg?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5834077/carl"}, "edited": false, "score": 0, "creation_date": 1505336908, "post_id": 46206839, "comment_id": 79377102, "body": "You could pass it through an if statement: <code>if (command[0] == &quot;cube&quot;) cube(stoi(command[1]));</code> Assuming you wanted an integer passed to cube. And of course assuming the user actually entered a number. If you don&#39;t know that, you might want to do some validation up front."}, {"owner": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "edited": false, "score": 0, "creation_date": 1505337194, "post_id": 46206839, "comment_id": 79377215, "body": "As I said this is an example without breaching privacy and legality. But I have more than a few thousand functions. Is using map still the best option?"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "reply_to_user": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "edited": false, "score": 0, "creation_date": 1505337220, "post_id": 46206839, "comment_id": 79377226, "body": "@ChinmoyKulkarni Yes. <i><code>system()</code> doesn&#39;t even do what you want.</i>"}, {"owner": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1505337612, "post_id": 46206839, "comment_id": 79377383, "body": "@cdhowie I see, then what could be the best method to do this? As suggested map all functions?"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "reply_to_user": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "edited": false, "score": 0, "creation_date": 1505338177, "post_id": 46206839, "comment_id": 79377608, "body": "@ChinmoyKulkarni Yes. See my answer for a possible approach."}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1505338216, "post_id": 46206839, "comment_id": 79377621, "body": "If you have thousands of functions and you want to distribute the registration of user-callable functions, you could create a class whose constructor inserts data into a singleton registry map, and then put static global variables of that class next to their corresponding functions.  (Then just be careful if there are static libraries involved to make sure there&#39;s something forcing all the machine object files containing such registration objects to get linked in.)"}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1505338635, "post_id": 46206839, "comment_id": 79377806, "body": "Or, maybe use some tool like Swig to create Python bindings to your functions, create a Python extension module out of your code, and then let Swig and Python handle all the dispatching for you. :)"}], "tags": [], "owner": {"reputation": 2007, "user_id": 5834077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N7N3H.jpg?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5834077/carl"}, "is_accepted": false, "score": 0, "last_activity_date": 1505336891, "last_edit_date": 1505336891, "creation_date": 1505336704, "answer_id": 46206839, "question_id": 46206624, "link": "https://stackoverflow.com/questions/46206624/call-a-function-with-user-arguments-as-function-name-and-its-arguments/46206839#46206839", "title": "Call a function with user arguments as function name and its arguments", "body": "<p>Okay, so first of all you do not need an array of 70 strings in order to parse your commands. For your requirements, it looks like you're going to need to parse a command and then an argument. In this case I used an std::array, to create an array of 2 strings. However, you can make as many as you like, and then process the command in a loop, rather than manually with <code>command[0/1]</code>. Or use a vector if you need one command, and then some arguments.</p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nint main() {\n    string quote;\n    array&lt;string, 2&gt; command;\n    while (quote != \"quit\") {\n        cout &lt;&lt; \"Enter: \";\n        getline(cin, quote);\n\n        auto separator = quote.find(' ');\n        if (separator == string::npos) continue;\n\n        command[0] = quote.substr(0, separator);\n        command[1] = quote.substr(separator + 1);\n\n        cout &lt;&lt; \"Command executed was \" &lt;&lt; command[0] &lt;&lt; '(' &lt;&lt; command[1] &lt;&lt; \")\\n\";\n    }\n}\n</code></pre>\n\n<p>I also used the <code>string.find()</code> method to look for a space in the parsed command, and then if a space was not found, to continue awating valid input. Now, if the user entered quit, the program will still quit. At the bottom it will <code>cout</code> the command you entered for clarity. However, in order to call a function based on what was entered you would have to for example check the string in <code>command[0]</code> for a valid value, and then convert the argument in <code>command[1]</code> to the required type. For example, if an integer is required, convert it using <code>stoi(s)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "is_accepted": true, "score": 2, "last_activity_date": 1505338131, "creation_date": 1505338131, "answer_id": 46207106, "question_id": 46206624, "link": "https://stackoverflow.com/questions/46206624/call-a-function-with-user-arguments-as-function-name-and-its-arguments/46207106#46207106", "title": "Call a function with user arguments as function name and its arguments", "body": "<p>There are multiple parts to your goal:</p>\n\n<ul>\n<li>Parsing input.</li>\n<li>Parsing arguments to pass them to the command function.</li>\n<li>Figuring out which command function to call.</li>\n<li>Displaying the results.</li>\n</ul>\n\n<p>First, lets start with the functions you want to call:</p>\n\n<pre><code>double square(float x) {\n    return static_cast&lt;double&gt;(x) * x;\n}\n\ndouble cube(float x) {\n    return static_cast&lt;double&gt;(x) * x * x;\n}\n</code></pre>\n\n<p>Now, we need a \"command type,\" which we'll define as a function that takes a string as an argument and returns a string:</p>\n\n<pre><code>using command_fn = std::function&lt;std::string(std::string const &amp;)&gt;;\n</code></pre>\n\n<p>Great, but the functions we have don't accept strings, and they don't return strings.  No matter, we will wrap them in a lambda that parses the arguments using standard input streaming operators, and formats the result into a string:</p>\n\n<pre><code>template &lt;typename R, typename A&gt;\ncommand_fn create_command(R (*fn)(A)) {\n    return [fn] (std::string const &amp;string_arg) {\n        std::istringstream s{string_arg};\n        A arg;\n\n        if (!(s &gt;&gt; arg)) {\n            return std::string(\"Failed to convert argument\");\n        }\n\n        return std::to_string(fn(arg));\n    };\n}\n</code></pre>\n\n<p>Now we can create an <code>std::map&lt;std::string, command_fn&gt;</code> that maps command names to the wrapper functions:</p>\n\n<pre><code>std::map&lt;std::string, command_fn&gt; commands{\n    { \"square\", create_command(square) },\n    { \"cube\", create_command(cube) }\n};\n</code></pre>\n\n<p>Finally, we parse the input and dispatch the calls in a loop:</p>\n\n<pre><code>int main() {\n    std::string line;\n\n    while (std::getline(std::cin, line)) {\n        auto space = line.find(' ');\n\n        std::string cmd, arg;\n        if (space == std::string::npos) {\n            cmd = std::move(line);\n        } else {\n            cmd = line.substr(0, space);\n            arg = line.substr(space + 1);\n        }\n\n        auto const &amp;cmdfn = commands.find(cmd);\n\n        if (cmdfn != commands.end()) {\n            std::cout &lt;&lt; cmdfn-&gt;second(arg) &lt;&lt; std::endl;\n        } else {\n            std::cout &lt;&lt; \"No such command: \" &lt;&lt; cmd &lt;&lt; std::endl;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>(<a href=\"http://coliru.stacked-crooked.com/a/30e749dd31444503\" rel=\"nofollow noreferrer\">See a demo</a>)</p>\n\n<p>Some notes about this code:</p>\n\n<ul>\n<li>We only accept one argument per command. You may want to allow more than one argument. This could be implemented in the <code>create_command()</code> function by accepting a parameter pack for <code>A</code>.</li>\n<li><code>create_command()</code> only checks if the conversion was successful. Ideally you would also want to make sure that the input string was totally consumed.</li>\n<li><code>create_command()</code> will only instantiate for a function if:\n\n<ul>\n<li>The argument of the function is of a type for which there is a streaming input operator.</li>\n<li>The return type is of a type that can be passed to <code>std::to_string()</code>.</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 147, "user_id": 8217678, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3cb1b3182789770a2fb3e1bad1c527eb?s=128&d=identicon&r=PG&f=1", "display_name": "Chinmoy Kulkarni", "link": "https://stackoverflow.com/users/8217678/chinmoy-kulkarni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 46207106, "answer_count": 2, "score": -3, "last_activity_date": 1505338625, "creation_date": 1505335810, "last_edit_date": 1505337537, "question_id": 46206624, "link": "https://stackoverflow.com/questions/46206624/call-a-function-with-user-arguments-as-function-name-and-its-arguments", "title": "Call a function with user arguments as function name and its arguments", "body": "<p>I am new to C++, and would appreciate if you could help me with this.</p>\n\n<p>Suppose I have a few functions defined:</p>\n\n<pre><code>double square(float x) {return x*x}\ndouble cube (float x) {return x*x*x}\nread_lib(const string &amp;file_name)\n</code></pre>\n\n<p>Now, when my user inputs <code>square 10</code>, I want to call the square function, with <code>10</code> as the argument, and return <code>100</code>.</p>\n\n<p>Similarly, when my user inputs <code>cube 3</code>, I want to return <code>27</code>.</p>\n\n<p>Similarly, when my user inputs <code>read_lib /path/to/file/library.gz</code>, I want to process the file.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>int main()\n{ \n    string quote;\n    while(quote != \"quit\") {\n\n        cout &lt;&lt; \"Enter: - \";\n        string sa[70];\n        getline(cin, quote);\n        istringstream iss(quote);\n        int count = 0;\n\n        while(iss){\n            string sub;\n            iss&gt;&gt;sub;\n            if(sub == \"\") \n                break;\n            sa[count] = sub;\n            cout &lt;&lt; \"sub \"&lt;&lt;count &lt;&lt;\" is \" &lt;&lt; sa[count]&lt;&lt;endl;\n            count ++; \n        }\n\n        string str = sa[0] + \"(\" + sa[1] + \")\"; \n        // How do I dynamically switch quotations depending on sa[0]\n        cout &lt;&lt; \"command executed was \"&lt;&lt; str.c_str() &lt;&lt;endl;\n        system(str.c_str());\n    }\n}\n</code></pre>\n\n<p>If this cannot work, what other option do I have to get the intended result?</p>\n\n<p>Please help me re-write this code if I have messed up too much.</p>\n\n<p>This is how it executes:</p>\n\n<pre>\n sub 0 is cube\n\n sub 1 is 3\n\n command executed was cube (\"3\")\n\nsh: -c: line 0: syntax error near unexpected token `\"3\"'\nsh: -c: line 0: `cube (\"3\")'\n</pre>\n"}, {"tags": ["python", "c++", "performance", "numpy", "eigen"], "comments": [{"owner": {"reputation": 478030, "user_id": 279627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2dceea858ad8f1577bec6ddaa0485d15?s=128&d=identicon&r=PG", "display_name": "Sven Marnach", "link": "https://stackoverflow.com/users/279627/sven-marnach"}, "edited": false, "score": 1, "creation_date": 1505335881, "post_id": 46206580, "comment_id": 79376584, "body": "The code doing the actual work for Numpy is written in C.  If you want to understand the speed difference, you need to look at the algorithms the different underlying libraries use.  What laguage you write the program making the library call in is completely irrelevant."}, {"owner": {"reputation": 1434, "user_id": 2501747, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dPJWC.png?s=128&g=1", "display_name": "Wikunia", "link": "https://stackoverflow.com/users/2501747/wikunia"}, "reply_to_user": {"reputation": 478030, "user_id": 279627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2dceea858ad8f1577bec6ddaa0485d15?s=128&d=identicon&r=PG", "display_name": "Sven Marnach", "link": "https://stackoverflow.com/users/279627/sven-marnach"}, "edited": false, "score": 0, "creation_date": 1505335990, "post_id": 46206580, "comment_id": 79376646, "body": "Yes @SvenMarnach I don&#39;t expect that c++ is faster I just would expect that they should have a similar speed because they should both use MKL or OpenBLAS in the back end."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1505336248, "post_id": 46206580, "comment_id": 79376791, "body": "What&#39;s the timing when compiling with <code>-DNDEBUG</code>?"}, {"owner": {"reputation": 1434, "user_id": 2501747, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dPJWC.png?s=128&g=1", "display_name": "Wikunia", "link": "https://stackoverflow.com/users/2501747/wikunia"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1505336313, "post_id": 46206580, "comment_id": 79376822, "body": "@HenriMenke its 2.4s as well"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 0, "creation_date": 1505337613, "post_id": 46206580, "comment_id": 79377384, "body": "What&#39;s your CPU? Here, on a 2.6GHz core7 (Haswell), I get 1.4s using Eigen only and no openmp, and 0.7s if using openmp. Of course you need to compile with -march=native to fully exploit your CPU."}, {"owner": {"reputation": 1434, "user_id": 2501747, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dPJWC.png?s=128&g=1", "display_name": "Wikunia", "link": "https://stackoverflow.com/users/2501747/wikunia"}, "reply_to_user": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 0, "creation_date": 1505337879, "post_id": 46206580, "comment_id": 79377504, "body": "@ggael Intel(R) Core(TM) i5-3320M CPU @ 2.60GHz Looks like Henri Menke found the bug ;)"}, {"owner": {"reputation": 25324, "user_id": 1641621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h50hY.png?s=128&g=1", "display_name": "ggael", "link": "https://stackoverflow.com/users/1641621/ggael"}, "edited": false, "score": 0, "creation_date": 1505338644, "post_id": 46206580, "comment_id": 79377811, "body": "Well, the speed ratio between Eigen and MKL is also too much, make sure to compile with <code>-march=native</code> and Eigen 3.x to leverage the AVX instructions of your CPU. Since I get 0.7s here, you should get something between 1s and max 2s."}], "answers": [{"comments": [{"owner": {"reputation": 1434, "user_id": 2501747, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dPJWC.png?s=128&g=1", "display_name": "Wikunia", "link": "https://stackoverflow.com/users/2501747/wikunia"}, "edited": false, "score": 0, "creation_date": 1505336519, "post_id": 46206746, "comment_id": 79376914, "body": "They are indeed equally fast then BUT numpy uses <code>float64</code> which is the same as double in C++."}, {"owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "reply_to_user": {"reputation": 1434, "user_id": 2501747, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dPJWC.png?s=128&g=1", "display_name": "Wikunia", "link": "https://stackoverflow.com/users/2501747/wikunia"}, "edited": false, "score": 0, "creation_date": 1505337022, "post_id": 46206746, "comment_id": 79377150, "body": "Numpy uses openblas and MKL too. So its using the 32bit precision for the LU factorization anyway."}], "tags": [], "owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "is_accepted": false, "score": 0, "last_activity_date": 1505336349, "creation_date": 1505336349, "answer_id": 46206746, "question_id": 46206580, "link": "https://stackoverflow.com/questions/46206580/eigen-mkl-or-openblas-slower-than-numpy-scipy-openblas/46206746#46206746", "title": "Eigen + MKL or OpenBLAS slower than Numpy/Scipy + OpenBLAS", "body": "<p>This is not a fair comparison. The python routine is operating on float precision while the c++ code needs to crunch doubles. This exactly doubles the computation time.</p>\n\n<pre><code>&gt;&gt;&gt; type(np.random.random_sample())\n&lt;type 'float'&gt;\n</code></pre>\n\n<p>You should compare with <code>MatrixXf</code> instead of <code>MatrixXd</code> and your MKL code should be equally fast. </p>\n"}, {"tags": [], "owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "is_accepted": true, "score": 4, "last_activity_date": 1505337116, "creation_date": 1505337116, "answer_id": 46206907, "question_id": 46206580, "link": "https://stackoverflow.com/questions/46206580/eigen-mkl-or-openblas-slower-than-numpy-scipy-openblas/46206907#46206907", "title": "Eigen + MKL or OpenBLAS slower than Numpy/Scipy + OpenBLAS", "body": "<p>The timing is just wrong.  That's a typical symptom of <a href=\"https://stackoverflow.com/q/7335920/1944004\">wall clock time vs. CPU time</a>.  When I use the <code>system_clock</code> from the <code>&lt;chrono&gt;</code> header it \u201cmagically\u201d becomes faster.</p>\n\n<pre><code>#define EIGEN_USE_MKL_ALL\n#include &lt;iostream&gt;\n#include &lt;Eigen/Dense&gt;\n#include &lt;Eigen/LU&gt;\n#include &lt;chrono&gt;\n\nint main()\n{\n    int const n = Eigen::nbThreads( );\n    std::cout &lt;&lt; \"#Threads: \" &lt;&lt; n &lt;&lt; std::endl;\n\n    int const size = 4000;\n    Eigen::MatrixXd a = Eigen::MatrixXd::Random(size,size);\n\n    auto start = std::chrono::system_clock::now();\n\n    Eigen::PartialPivLU&lt;Eigen::MatrixXd&gt; lu(a);\n\n    auto stop = std::chrono::system_clock::now();\n\n    std::cout &lt;&lt; \"Elasped time is \"\n              &lt;&lt; std::chrono::duration&lt;double&gt;{stop - start}.count()\n              &lt;&lt; \" seconds.\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>I compile with</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>icc -O3 -mkl -std=c++11 -DNDEBUG -I/usr/include/eigen3/ test.cpp\n</code></pre>\n\n<p>and get the output</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>#Threads: 1\nElasped time is 0.295782 seconds.\n</code></pre>\n\n<p>Your Python version reports <code>0.399146080017</code> on my machine.</p>\n\n<hr>\n\n<p>Alternatively, to obtain comparable timing you could use <code>time.clock()</code> (CPU time) in Python instead of <code>time.time()</code> (wall clock time).</p>\n"}], "owner": {"reputation": 1434, "user_id": 2501747, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dPJWC.png?s=128&g=1", "display_name": "Wikunia", "link": "https://stackoverflow.com/users/2501747/wikunia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1213, "favorite_count": 0, "accepted_answer_id": 46206907, "answer_count": 2, "score": 2, "last_activity_date": 1505337116, "creation_date": 1505335638, "last_edit_date": 1505336090, "question_id": 46206580, "link": "https://stackoverflow.com/questions/46206580/eigen-mkl-or-openblas-slower-than-numpy-scipy-openblas", "title": "Eigen + MKL or OpenBLAS slower than Numpy/Scipy + OpenBLAS", "body": "<p>I'm starting with c++ atm and want to work with matrices and speed up things in general. Worked with Python+Numpy+OpenBLAS before.\nThought c++ + Eigen + MKL might be faster or at least not slower.</p>\n\n<p>My c++ code:</p>\n\n<pre><code>#define EIGEN_USE_MKL_ALL\n#include &lt;iostream&gt;\n#include &lt;Eigen/Dense&gt;\n#include &lt;Eigen/LU&gt;\n#include &lt;chrono&gt;\n\nusing namespace std;\nusing namespace Eigen;\n\nint main()\n{\n    int n = Eigen::nbThreads( );\n    cout &lt;&lt; \"#Threads: \" &lt;&lt; n &lt;&lt; endl;\n\n    uint16_t size = 4000;\n    MatrixXd a = MatrixXd::Random(size,size);\n\n    clock_t start = clock ();\n    PartialPivLU&lt;MatrixXd&gt; lu = PartialPivLU&lt;MatrixXd&gt;(a);\n\n    float timeElapsed = double( clock() - start ) / CLOCKS_PER_SEC; \n    cout &lt;&lt; \"Elasped time is \" &lt;&lt; timeElapsed &lt;&lt; \" seconds.\" &lt;&lt; endl ;\n}\n</code></pre>\n\n<p>My Python code:</p>\n\n<pre><code>import numpy as np\nfrom time import time\nfrom scipy import linalg as la\n\nsize = 4000\n\nA = np.random.random((size, size))\n\nt = time()\nLU, piv = la.lu_factor(A)\nprint(time()-t)\n</code></pre>\n\n<p>My timings: </p>\n\n<pre><code>C++     2.4s\nPython  1.2s\n</code></pre>\n\n<p>Why is c++ slower than Python?</p>\n\n<p>I am compiling c++ using:</p>\n\n<pre><code>g++ main.cpp -o main -lopenblas -O3 -fopenmp  -DMKL_LP64 -I/usr/local/include/mkl/include\n</code></pre>\n\n<p>MKL is definiely working: If I disable it the running time is around 13s.</p>\n\n<p>I also tried C++ + OpenBLAS which gives me around 2.4s as well.</p>\n\n<p>Any ideas why C++ and Eigen are slower than numpy/scipy?</p>\n"}, {"tags": ["c++", "arrays", "memory-management"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 3, "creation_date": 1505335617, "post_id": 46206554, "comment_id": 79376453, "body": "<code>double q[rows][columns];</code> VLAs aren&#39;t standard c++."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1505335891, "post_id": 46206554, "comment_id": 79376590, "body": "This isn&#39;t the problem, but do you really need the extra stuff that <code>std::endl</code> does? <code>&#39;\\n&#39;</code> ends a line."}, {"owner": {"reputation": 55, "user_id": 4059696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4nW5.jpg?s=128&g=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/4059696/josh-m"}, "edited": false, "score": 0, "creation_date": 1505336155, "post_id": 46206554, "comment_id": 79376740, "body": "No, I don&#39;t, you&#39;re right for this example <code>\\n</code> would have been fine."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1505336210, "post_id": 46206554, "comment_id": 79376770, "body": "It isn&#39;t related to allocating on the heap vs the stack, BTW. You could have allocated a single, contiguous block of memory on &quot;the heap&quot;."}, {"owner": {"reputation": 2007, "user_id": 5834077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N7N3H.jpg?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5834077/carl"}, "edited": false, "score": 0, "creation_date": 1505337748, "post_id": 46206554, "comment_id": 79377448, "body": "Yep, just allocating <code>arr = new double[rows * columns];</code> would yield better results. And then to access row 3, col 2 you could do: <code>arr[row * columns + col]</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1505339946, "post_id": 46206554, "comment_id": 79378254, "body": "@JoshM. -- <a href=\"https://stackoverflow.com/questions/21943621/how-to-create-a-contiguous-2d-array-in-c/21944048#21944048\">Related information</a>, if you want a contiguous 2D array and keep the <code>[ ][ ]</code> syntax."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1505340321, "post_id": 46206554, "comment_id": 79378363, "body": "@JoshM. -- Also, note that using the code at the SO link I provided, the <code>double **</code> created array shows the same results as the (non-standard) VLA version you posted,  <a href=\"https://ideone.com/f7CufD\" rel=\"nofollow noreferrer\">as seen here</a>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1505341328, "post_id": 46206554, "comment_id": 79378724, "body": "@JoshM.So the real issue is <i>how</i> you&#39;re allocating from the heap.  You can allocate from the heap, have contiguous data, and still use <code>double **</code>.  Your attempt allocated arrays in a naive fashion -- one allocation per row."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4059696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4nW5.jpg?s=128&g=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/4059696/josh-m"}, "edited": false, "score": 3, "creation_date": 1505336030, "post_id": 46206640, "comment_id": 79376672, "body": "Ah, so my problem is that I&#39;m assuming that the allocation from the heap was contiguous, but it actually isn&#39;t?  Presumably each row of columns is quite near the others, because in my output I am getting some of the appropriate values, just not where they should be."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 55, "user_id": 4059696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4nW5.jpg?s=128&g=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/4059696/josh-m"}, "edited": false, "score": 2, "creation_date": 1505336545, "post_id": 46206640, "comment_id": 79376924, "body": "@JoshM. Your heap allocations are not contiguous at all. You allocate 1 block containing <code>rows</code> count of pointers to double and then <code>rows</code> count of blocks containing <code>columns</code> count of doubles each. Though it makes sense that they are allocated one after another (with some padding in between) in this particular case since heap is not cluttered yet. But one should not rely on any assumptions of this kind about allocator behavior."}, {"owner": {"reputation": 216, "user_id": 3049939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366abfa0c6dbe26f9fdea1b74192614b?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Fleming", "link": "https://stackoverflow.com/users/3049939/todd-fleming"}, "edited": false, "score": 0, "creation_date": 1505348394, "post_id": 46206640, "comment_id": 79380615, "body": "You might add this to your answer: the &quot;pointer dereferencing method&quot; invokes UB even on the stack-allocated array since it indexes past the bounds of the first subarray. Even though memory is contiguous, this is still illegal."}], "tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": true, "score": 11, "last_activity_date": 1505335869, "creation_date": 1505335869, "answer_id": 46206640, "question_id": 46206554, "link": "https://stackoverflow.com/questions/46206554/why-am-i-seeing-different-behavior-between-arrays-allocated-on-the-heap-and-the/46206640#46206640", "title": "Why am I seeing different behavior between arrays allocated on the heap and the stack?", "body": "<p><code>&amp;q[0][0]</code> gives you a pointer to the first double in a block containing <code>rows</code>x<code>columns</code> doubles. While <code>&amp;a[0][0]</code> gives you a pointer the first double in a block containing <code>columns</code> doubles (you've allocated it using <code>a[0] = new double[columns];</code>, remember?). So accessing it <code>columns*i + j</code> will be out of bounds and will triggers Undefined Behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 1317, "user_id": 3849688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/07WR3.jpg?s=128&g=1", "display_name": "Khouri Giordano", "link": "https://stackoverflow.com/users/3849688/khouri-giordano"}, "is_accepted": false, "score": 3, "last_activity_date": 1505335979, "creation_date": 1505335979, "answer_id": 46206662, "question_id": 46206554, "link": "https://stackoverflow.com/questions/46206554/why-am-i-seeing-different-behavior-between-arrays-allocated-on-the-heap-and-the/46206662#46206662", "title": "Why am I seeing different behavior between arrays allocated on the heap and the stack?", "body": "<p>Arrays are usually a single allocation, on the stack in this case. The array value <code>q[1][0]</code> is being positioned right after <code>q[0][columns-1]</code>. The pointer implementation is allocating a disjoint block of memory for each row from the heap. By referencing beyond the end of the first row, you are in <strong>undefined behavior</strong> territory.</p>\n"}, {"tags": [], "owner": {"reputation": 3923, "user_id": 8309701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S44bo.png?s=128&g=1", "display_name": "Chris Uzdavinis", "link": "https://stackoverflow.com/users/8309701/chris-uzdavinis"}, "is_accepted": false, "score": 2, "last_activity_date": 1505336474, "creation_date": 1505336474, "answer_id": 46206784, "question_id": 46206554, "link": "https://stackoverflow.com/questions/46206554/why-am-i-seeing-different-behavior-between-arrays-allocated-on-the-heap-and-the/46206784#46206784", "title": "Why am I seeing different behavior between arrays allocated on the heap and the stack?", "body": "<p>The stack based array is fully contiguous memory.  Your heap based one is one allocation per row, plus an allocation to hold all those allocations.  The memory for each allocation may be scattered throughout your heap in any order, with any amount of space between them.  You cannot assume that adding offsets to the base of the first row's allocation is valid if you go past its end, and it's certainly a bug to try to reach a separate allocation by walking far enough off the end of a previous allocation.</p>\n\n<p>If you want to do what you're trying, change your new[] expression to be flattened into a single array:</p>\n\n<pre><code>double * q = new [rows * columns];\n</code></pre>\n\n<p>Then you can index into it as if it is a 2d array.</p>\n\n<p>Also, in your original post you use the wrong type of delete call on a, which is also an array and needs to be deleted as one (with [] after it.)</p>\n"}], "owner": {"reputation": 55, "user_id": 4059696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4nW5.jpg?s=128&g=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/4059696/josh-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 46206640, "answer_count": 3, "score": 4, "last_activity_date": 1505336994, "creation_date": 1505335515, "question_id": 46206554, "link": "https://stackoverflow.com/questions/46206554/why-am-i-seeing-different-behavior-between-arrays-allocated-on-the-heap-and-the", "title": "Why am I seeing different behavior between arrays allocated on the heap and the stack?", "body": "<p>I am inspecting the behavior of two 2D arrays in C++, one allocated from the stack, and one allocated from the heap.</p>\n\n<p>I create two, 2D arrays of the same shape, and populate those arrays with some data.  Then I attempt to read the arrays in two different methods, the first being with the simple array index format \"Arr[ROW][COLUMN]\".  Then I read the arrays using a pointer dereference, and I get two different results for the heap allocated array, but identical results for the stack allocated array.  I am trying to understand why the results differ.  I would appreciate any clarification that someone can provide.  Thanks in advance.</p>\n\n<p>The code I am running is below:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main(){\n\n    int rows = 6;\n    int columns = 3;\n\n    // allocate from the stack.\n    double q[rows][columns];\n\n    // allocate from the heap.\n    double ** a;\n    a = new double*[rows];\n\n    for(int i = 0; i &lt; rows; ++i){\n        a[i] = new double[columns];\n    }\n\n    // populate the arrays.\n    for(int i = 0; i &lt; rows; ++i){\n        for(int j = 0; j &lt; columns; ++j){\n            a[i][j] = columns*i+j;\n            q[i][j] = columns*i+j;\n        }\n    }\n\n    cout &lt;&lt; \"*****************\" &lt;&lt; endl;\n    cout &lt;&lt; \"Array indexing method.\" &lt;&lt; endl;\n    cout &lt;&lt; \"*****************\" &lt;&lt; endl;\n\n    // print the heap allocated array using array indexing.\n    for(int i = 0; i &lt; rows; ++i){\n        for(int j = 0; j &lt; columns; ++j){\n            cout &lt;&lt; a[i][j] &lt;&lt; '\\t';\n        }\n        cout &lt;&lt; endl;\n    }\n\n    cout &lt;&lt; \"*****************\" &lt;&lt; endl;\n\n    // print the stack allocated array using array indexing.\n    for(int i = 0; i &lt; rows; ++i){\n        for(int j = 0; j &lt; columns; ++j){\n            cout &lt;&lt; q[i][j] &lt;&lt; '\\t';\n        }\n        cout &lt;&lt; endl;\n    }\n\n    cout &lt;&lt; \"*****************\" &lt;&lt; endl;\n    cout &lt;&lt; \"Pointer dereferencing method.\" &lt;&lt; endl;\n    cout &lt;&lt; \"*****************\" &lt;&lt; endl;\n\n    // print the heap allocated array.\n    for(int i = 0; i &lt; rows; ++i){\n        for(int j = 0; j &lt; columns; ++j){\n            cout &lt;&lt; *(&amp;a[0][0] + columns*i + j) &lt;&lt; '\\t';\n        }\n        cout &lt;&lt; endl;\n    }\n\n    cout &lt;&lt; \"*****************\" &lt;&lt; endl;\n\n    // print the stack allocated array.\n    for(int i = 0; i &lt; rows; ++i){\n        for(int j = 0; j &lt; columns; ++j){\n            cout &lt;&lt; *(&amp;q[0][0] + columns*i + j) &lt;&lt; '\\t';\n        }\n        cout &lt;&lt; endl;\n    }\n    cout &lt;&lt; \"*****************\" &lt;&lt; endl;\n\n    // release the memory allocated to the heap.\n    for(int i = 0; i &lt; rows; ++i){\n        delete[] a[i];\n    }\n\n    delete a;\n\n    return 0;\n}\n</code></pre>\n\n<p>And the results I obtain are:</p>\n\n<pre><code>*****************\nArray indexing method.\n*****************\n0       1       2\n3       4       5\n6       7       8\n9       10      11\n12      13      14\n15      16      17\n*****************\n0       1       2\n3       4       5\n6       7       8\n9       10      11\n12      13      14\n15      16      17\n*****************\nPointer dereferencing method.\n*****************\n0       1       2\n0       3       4\n5       0       6\n7       8       0\n9       10      11\n0       12      13\n*****************\n0       1       2\n3       4       5\n6       7       8\n9       10      11\n12      13      14\n15      16      17\n*****************\n</code></pre>\n\n<p>And I can see that in the third block of output, the heap allocated array isn't being read properly, but the stack allocated array is.</p>\n\n<p>Thanks again.</p>\n"}, {"tags": ["c++", "memory"], "comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1505335862, "post_id": 46206527, "comment_id": 79376572, "body": "If you have a virtual function in that class, then yes. Otherwise, no. But it&#39;s generally a (compiler) implementation decision, i.e., not defined by the standard of the C++ language. And the same goes for the size of an <code>int</code> being 4 bytes, by the way."}], "answers": [{"comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1505336700, "post_id": 46206574, "comment_id": 79376998, "body": "<code>#pragma pack(push, 1)</code> (followed by <code>#pragma pack(pop)</code> after the class definition, to ensure it only affects the target class) works on MSVC and GCC."}, {"owner": {"reputation": 599, "user_id": 4594262, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f3559a3d97720f3a605ae39aecdc43c4?s=128&d=identicon&r=PG&f=1", "display_name": "BadProgrammer99", "link": "https://stackoverflow.com/users/4594262/badprogrammer99"}, "edited": false, "score": 0, "creation_date": 1505348602, "post_id": 46206574, "comment_id": 79380664, "body": "I actually just asked out of curiosity, I&#39;m not planning on using it for anything."}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": true, "score": 5, "last_activity_date": 1505336069, "last_edit_date": 1505336069, "creation_date": 1505335630, "answer_id": 46206574, "question_id": 46206527, "link": "https://stackoverflow.com/questions/46206527/are-classes-larger-in-memory-than-their-members-in-c/46206574#46206574", "title": "Are classes larger in memory than their members in C++?", "body": "<p>The decision about how big a class ends up being is implementation-specific and depends on a lot of different factors. Sometimes, due to structure and class padding, a class might end up bigger than the size of its members. If you have any virtual functions in your class, then you'll typically end up with a <a href=\"https://en.wikipedia.org/wiki/Virtual_method_table\" rel=\"nofollow noreferrer\">virtual function table pointer</a> (vtable pointer) at the front of the class that adds a bit of space. And it's entirely possible that the compiler might just For The Heck Of It make your class bigger than the size of its members if it think it will help out in some way (or if you have a lazy compiler!)</p>\n\n<p>In your case, with a single 32-bit integer, I'd be surprised if the class ended up being any larger than the integer itself, since you aren't using any virtual functions and there aren't any members to insert padding bytes between. However, you cannot necessarily rely on this across systems.</p>\n\n<p>If you're working on an application where it's <em>absolutely essential</em> that your class be the same size as the fields - perhaps, for example, if you're reading raw bytes and want to reinterpret them as class objects - you could use a <code>static_assert</code> to check for this:</p>\n\n<pre><code>class MyClass {\n   ...\n};\nstatic_assert(sizeof(MyClass) == sizeof(int), \"MyClass must have the same size as an integer.\");\n</code></pre>\n\n<p>Many compilers have custom options (often through <code>#pragma</code> directives) that you can tune to ensure that classes get sized in a way that you'd like, so you could also consider reading up on that.</p>\n"}, {"comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1505335779, "post_id": 46206601, "comment_id": 79376534, "body": "Please flag the question as duplicate instead of linking that in another answer."}, {"owner": {"reputation": 831, "user_id": 3789324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pxqcq.jpg?s=128&g=1", "display_name": "auserdude", "link": "https://stackoverflow.com/users/3789324/auserdude"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505335814, "post_id": 46206601, "comment_id": 79376549, "body": "It&#39;s not a duplicate to me, it&#39;s a more generic one."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505335870, "post_id": 46206601, "comment_id": 79376581, "body": "Then you should have posted that as comment."}, {"owner": {"reputation": 831, "user_id": 3789324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pxqcq.jpg?s=128&g=1", "display_name": "auserdude", "link": "https://stackoverflow.com/users/3789324/auserdude"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505335974, "post_id": 46206601, "comment_id": 79376638, "body": "I think an user with low experience that doesn&#39;t even know about virtual functions can search for a more generic question like this one, and then he can read about virtual functions using the link. So that&#39;s why I think it&#39;s better to keep both questions and my answer."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1505337710, "post_id": 46206601, "comment_id": 79377420, "body": "the answer should be selfcontained. Links can break at any time (even within SO) so you should at least summarize what is relevant to answer the question here"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1505339130, "post_id": 46206601, "comment_id": 79377987, "body": "Don&#39;t ignore padding. Left to it&#39;s own devices, <code>struct test {char a; int b}</code> probably isn&#39;t going to be <code>sizeof(char) + sizeof(int)</code>"}, {"owner": {"reputation": 831, "user_id": 3789324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pxqcq.jpg?s=128&g=1", "display_name": "auserdude", "link": "https://stackoverflow.com/users/3789324/auserdude"}, "edited": false, "score": 0, "creation_date": 1505339371, "post_id": 46206601, "comment_id": 79378078, "body": "Lets do a quick switch of the first two lines so."}], "tags": [], "owner": {"reputation": 831, "user_id": 3789324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pxqcq.jpg?s=128&g=1", "display_name": "auserdude", "link": "https://stackoverflow.com/users/3789324/auserdude"}, "is_accepted": false, "score": 0, "last_activity_date": 1505339501, "last_edit_date": 1505339501, "creation_date": 1505335721, "answer_id": 46206601, "question_id": 46206527, "link": "https://stackoverflow.com/questions/46206527/are-classes-larger-in-memory-than-their-members-in-c/46206601#46206601", "title": "Are classes larger in memory than their members in C++?", "body": "<p>The actual size is implementation-dependent, so it can change across different compilers and architectures due to padding and other implementation details. Never trust a simple sum like in the following pseudocode:</p>\n\n<pre><code>size = sizeof(member1) + ... + sizeof(memberN)\n</code></pre>\n\n<p>Also if the class has virtual functions, yes, it can be more than 4 bytes.</p>\n\n<p>Moreover, in the case of virtual functions and class inheritance the size can be complicated to be understood at first sight: </p>\n\n<ul>\n<li>Each class that include virtual functions will store a vtable in memory with function pointers to these virtual functions.</li>\n<li>Class A, with virtual functions, that inherit from another class B, that has virtual functions too, could need more than one table to store both A and B function pointers.</li>\n</ul>\n\n<p>See this answer for more details: <a href=\"https://stackoverflow.com/questions/4766323/how-to-determine-sizeof-class-with-virtual-functions\">how to determine sizeof class with virtual functions?</a></p>\n"}], "owner": {"reputation": 599, "user_id": 4594262, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f3559a3d97720f3a605ae39aecdc43c4?s=128&d=identicon&r=PG&f=1", "display_name": "BadProgrammer99", "link": "https://stackoverflow.com/users/4594262/badprogrammer99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 46206574, "answer_count": 2, "score": 4, "last_activity_date": 1505339501, "creation_date": 1505335425, "question_id": 46206527, "link": "https://stackoverflow.com/questions/46206527/are-classes-larger-in-memory-than-their-members-in-c", "title": "Are classes larger in memory than their members in C++?", "body": "<p>Let's say I have some class who's only member is an int. If it wasn't in a class, the int alone would be 4 bytes. Does the class take more than 4 bytes of memory (in C++)?</p>\n"}, {"tags": ["c++", "parsing", "c++11", "bison"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1505336596, "post_id": 46206516, "comment_id": 79376954, "body": "&quot;it&#39;s tough to specify the right disambiguation rules&quot;. Which is probably exactly the reason you don&#39;t see many Bison grammars for C++11 around."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1505337989, "post_id": 46206516, "comment_id": 79377558, "body": "Yes, it&#39;s possible to parse C++ with a GLR parser, and yes, it has been done. See the last paragraph in Ira Baxter&#39;s answer here: <a href=\"https://stackoverflow.com/questions/243383/why-cant-c-be-parsed-with-a-lr1-parser/1004737\" title=\"why cant c be parsed with a lr1 parser\">stackoverflow.com/questions/243383/&hellip;</a>. That&#39;s not bison, of course. But note that &quot;parsing&quot; is just a small part of analyzing C++ code. First you need to preprocess and afterwards (or during) you need to deduce templates."}, {"owner": {"reputation": 21, "user_id": 8605593, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209855233484660/picture?type=large", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/8605593/kent-g-budge"}, "edited": false, "score": 0, "creation_date": 1505344925, "post_id": 46206516, "comment_id": 79379755, "body": "I&#39;ve already read what Ira Baxer wrote, and I&#39;m not sure s/he actually said what you think s/he said. The tool is not Bison, it does not use the scanner hack, and it does not return a single parse tree based on precedence rules. It returns a collection of possible parse trees that are disambiguated later."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1505347393, "post_id": 46206516, "comment_id": 79380355, "body": "@kent: i said that its not bison. When the disambiguation happens doesn&#39;t seem to me relevant; bison&#39;s glr parser provides a dynamic merging mechanism (necessary to parse c++) which can either disambiguate immediately or collect alternatives for later. It could consult the symbol table to disambiguate, obviating the need for the &quot;scanner hack&quot;. In any event, the most difficult disambiguation is related to template deduction, and that&#39;s not amenable to the scanner hack."}, {"owner": {"reputation": 21, "user_id": 8605593, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209855233484660/picture?type=large", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/8605593/kent-g-budge"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1505349059, "post_id": 46206516, "comment_id": 79380774, "body": "@rici: Okay, that&#39;s very helpful. I have been using bison in LALR(1) mode for decades, but am less familiar with the newer glr capability and did not appreciate the power of the dynamic merging mechanism. I was experimenting with the %dprec mechanism and it has significant limitations for deep ambiguities."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1505405825, "post_id": 46206516, "comment_id": 79410941, "body": "@Kent: At the end of <a href=\"https://stackoverflow.com/a/14589567/1566221\">this answer</a> there is an example of a C++ parse which requires template deduction. The punchline is <code>auto b = foo&lt;IsPrime&lt;234799&gt;&gt;::typen&lt;1&gt;(); &#47;&#47; Syntax error if not prime</code>..."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1505405828, "post_id": 46206516, "comment_id": 79410946, "body": "although it could also have been written as the choice of two parses by using <code>auto b = foo&lt;IsPrime&lt;234799&gt;&gt;::typen&lt;1&gt;(0);</code>: depending on whether <code>typen</code> is a static template function member or a static intenger member, the expression is either a constructor invocation or a slightly odd arithmetic operation which compares the result of a comparison with 0. And what <code>typen</code> is depends in turn on the (compile-time constant) value of <code>IsPrime&lt;234799&gt;</code>"}, {"owner": {"reputation": 21, "user_id": 8605593, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209855233484660/picture?type=large", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/8605593/kent-g-budge"}, "edited": false, "score": 1, "creation_date": 1505508903, "post_id": 46206516, "comment_id": 79458902, "body": "Yes, I&#39;ve seen that clever example before.  gLR is supposed to be able to parse any context-free grammar and let you resolve ambiguities; but since C++ is not a context-free language if you use the scanner hack, I was curious if it was known for sure that a Bison-generated gLR parser using the scanner hack could do the job correctly. The answer I&#39;m hearing is that you can parse C++ with gLR by discarding the scanner hack, since it then really is a context-free grammar you&#39;re parsing, but at the cost of having to do a lot of post-parsing disambiguation. Which shouldn&#39;t bother me."}], "owner": {"reputation": 21, "user_id": 8605593, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209855233484660/picture?type=large", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/8605593/kent-g-budge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1505335991, "creation_date": 1505335384, "last_edit_date": 1505335991, "question_id": 46206516, "link": "https://stackoverflow.com/questions/46206516/is-it-possible-to-parse-c11-with-the-bison-glr-option-and-the-scanner-hack", "title": "Is it possible to parse C++11 with the Bison gLR option and the scanner hack?", "body": "<p>I am interested in the evolution of programming languages and the likely directions this will take the in the future. C++ is of particular interest as a widely-used language that puts a heavy burden on compiler writers in order to give users a richly featured language with less \"obnoxious\" grammar.</p>\n\n<p>My impression is that the most widely used C++11 parsers use some variation of recursive descent. I am curious if anyone has built a C++11 parser using the Bison gLR option and the scanner hack. I've taken a couple of stabs at it myself but find that it's tough to specify the right disambiguation rules for the reduce/reduce and shift/reduce conflicts that inevitably come up with any grammar resembling the published grammar.</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1505335951, "post_id": 46206495, "comment_id": 79376627, "body": "<code>Can anybody explain it clearly</code> - too broad. Should someone repeat <a href=\"https://cmake.org/cmake/help/v3.9/manual/cmake-generator-expressions.7.html\" rel=\"nofollow noreferrer\">CMake documentation</a>? Or other manual? Otherwise, explain <b>what exactly</b> you don&#39;t understand, e.g. which expression, or which example."}, {"owner": {"reputation": 985, "user_id": 5475431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/432a142ff6bc266e25d4724431d867ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mauri", "link": "https://stackoverflow.com/users/5475431/mauri"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1505336854, "post_id": 46206495, "comment_id": 79377074, "body": "@Tsyvarev I added the documentation of the part, that I didn&#39;t understand"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 3, "creation_date": 1505339812, "post_id": 46206495, "comment_id": 79378221, "body": "<code>$&lt;xxx:yy&gt;</code> is nearly a half of all usage of generator expressions. Its meaning in short: if generator expression <code>xxx</code> is evaluated to TRUE (as boolean), then value of generator expression <code>yy</code> is used. Otherwise, empty string is used. Usefullness of this kind of expression is: when value of the left generator expressions depends on configuration option, and build system supports multiconfiguration (e.g. Visual Studio), then such expression cannot be rewritten with <code>if</code>, as concrete configuration isn&#39;t known at this stage."}], "answers": [{"tags": [], "owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "is_accepted": true, "score": 34, "last_activity_date": 1505501050, "last_edit_date": 1505501050, "creation_date": 1505415506, "answer_id": 46226453, "question_id": 46206495, "link": "https://stackoverflow.com/questions/46206495/cmake-generator-expressions/46226453#46226453", "title": "Cmake generator expressions", "body": "<p>CMake does first parse the <code>CMakeLists.txt</code> files in your project - named \"Configuration Phase\" - and then it generates your build environment - named \"Generation Phase\".</p>\n\n<p>So basically the generator expressions are for everything only the generator could know:</p>\n\n<ul>\n<li>The name and path of target outputs (mainly when cross-compiling and in multi-configuration environments)</li>\n<li>Or more generally any target property that the generator evaluates to mingle together the compiler/linker calls</li>\n</ul>\n\n<p>Here are examples where I use generator expressions in my project:</p>\n\n<ol>\n<li><p>Copying files next to the executable (in multi-configuration environments you can't just use variables like <code>CMAKE_CURRENT_BINARY_DIR</code>)</p>\n\n<pre><code>add_custom_command(\n    TARGET library1 \n    POST_BUILD\n    COMMAND ${CMAKE_COMMAND} -E copy\n        \"$&lt;TARGET_FILE:library1&gt;\"\n        \"$&lt;TARGET_FILE_DIR:mainProject&gt;/$&lt;TARGET_FILE_NAME:library1&gt;\"\n)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/40696990/cmake-post-build-event-copy-compiled-libraries\">CMake post-build-event: copy compiled libraries</a></p>\n\n<pre><code>add_custom_command(\n    TARGET myBinary \n    POST_BUILD\n        COMMAND ${CMAKE_COMMAND} -E copy  \n                     \"${CMAKE_CURRENT_SOURCE_DIR}/myTest.txt\" \n                     \"$&lt;TARGET_FILE_DIR:myBinary&gt;/myTest.txt\"\n)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/34007428/how-do-i-add-external-test-files-to-a-cmake-project\">how do I add external test files to a cmake project</a></p></li>\n<li><p>Differentiate e.g. <code>DEBUG</code> or <code>RELEASE</code> configurations</p>\n\n<pre><code>add_compile_options(\"$&lt;$&lt;CONFIG:DEBUG&gt;:/MDd&gt;\")\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/33829152/for-cmake-can-you-modify-the-release-debug-compiler-flags-with-add-compiler-fl\">For Cmake, can you modify the release/debug compiler flags with `add_compiler_flags()` command?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/45955272/modern-way-to-set-compiler-flags-in-cross-platform-cmake-project\">Modern way to set compiler flags in cross-platform cmake project</a></p></li>\n<li><p>With the <code>TARGET_PROPERTY</code> generator expression you could do a lot of things e.g.</p>\n\n<pre><code>file(GENERATE \n    OUTPUT \"includes.txt\" \n    CONTENT \"$&lt;TARGET_PROPERTY:motor,INCLUDE_DIRECTORIES&gt;\\n\"\n)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/24091287/cmake-doesnt-pick-up-interface-include-directories-of-linked-library\">CMake doesn&#39;t pick up INTERFACE_INCLUDE_DIRECTORIES of linked library</a></p></li>\n</ol>\n"}], "owner": {"reputation": 985, "user_id": 5475431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/432a142ff6bc266e25d4724431d867ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mauri", "link": "https://stackoverflow.com/users/5475431/mauri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13260, "favorite_count": 14, "accepted_answer_id": 46226453, "answer_count": 1, "score": 28, "last_activity_date": 1505501050, "creation_date": 1505335264, "last_edit_date": 1505336693, "question_id": 46206495, "link": "https://stackoverflow.com/questions/46206495/cmake-generator-expressions", "title": "Cmake generator expressions", "body": "<p>I'm trying for long time to understand the benefit of <a href=\"https://cmake.org/cmake/help/v3.2/manual/cmake-generator-expressions.7.html\" rel=\"noreferrer\">generator expressions</a>  such as <code>$&lt;xxx:yy&gt;</code> in CMake, when and how  to use them.\nCan anybody explain it clearly with some examples.\nMany thank in advance</p>\n"}, {"tags": ["c++", "opencv", "opencv-contour", "best-fit"], "comments": [{"owner": {"reputation": 9770, "user_id": 888688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e1a439c266dcf5015373dbeae410ff5?s=128&d=identicon&r=PG", "display_name": "api55", "link": "https://stackoverflow.com/users/888688/api55"}, "edited": false, "score": 0, "creation_date": 1505338678, "post_id": 46206466, "comment_id": 79377827, "body": "your results looks weird for doing only findcontours... with that function you should be able to get the black blob completely... you can try fitellipse. <a href=\"http://docs.opencv.org/3.1.0/dd/d49/tutorial_py_contour_features.html\" rel=\"nofollow noreferrer\">here</a> is a tutorial of some of the opencv functions that may help you (it is in python, but the functions exist in c++ as well)"}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 5649980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a7d2960a5a0f7d9bfc1426d36e6bb5?s=128&d=identicon&r=PG&f=1", "display_name": "M Tauqeer", "link": "https://stackoverflow.com/users/5649980/m-tauqeer"}, "edited": false, "score": 0, "creation_date": 1505338926, "post_id": 46207195, "comment_id": 79377905, "body": "Thanks. Let me try. Also, can you explain the second loop?"}, {"owner": {"reputation": 138, "user_id": 5649980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a7d2960a5a0f7d9bfc1426d36e6bb5?s=128&d=identicon&r=PG&f=1", "display_name": "M Tauqeer", "link": "https://stackoverflow.com/users/5649980/m-tauqeer"}, "edited": false, "score": 0, "creation_date": 1505341981, "post_id": 46207195, "comment_id": 79378925, "body": "This is not give right results for this kind of image <a href=\"https://drive.google.com/open?id=0BxP3s-9QVdsEUlJlYUZiSWJSZjQ\" rel=\"nofollow noreferrer\">binary</a> <a href=\"https://drive.google.com/open?id=0BxP3s-9QVdsEWUhPa18xQ2oyUTQ\" rel=\"nofollow noreferrer\">rgb result</a>"}, {"owner": {"reputation": 138, "user_id": 5649980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a7d2960a5a0f7d9bfc1426d36e6bb5?s=128&d=identicon&r=PG&f=1", "display_name": "M Tauqeer", "link": "https://stackoverflow.com/users/5649980/m-tauqeer"}, "edited": false, "score": 0, "creation_date": 1505342611, "post_id": 46207195, "comment_id": 79379135, "body": "It also won&#39;t give right results if the hole is more white inside rather then ouside. i-e for this kind of example, we have to find max of the height and width of rotated rect instead of min of height and width."}], "tags": [], "owner": {"reputation": 3225, "user_id": 5294258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5270296f9c4ec3fae89195328e9bc7?s=128&d=identicon&r=PG&f=1", "display_name": "sturkmen", "link": "https://stackoverflow.com/users/5294258/sturkmen"}, "is_accepted": false, "score": 0, "last_activity_date": 1505339446, "last_edit_date": 1505339446, "creation_date": 1505338641, "answer_id": 46207195, "question_id": 46206466, "link": "https://stackoverflow.com/questions/46206466/best-fit-a-circle-from-a-binary-image-using-contours-or-any-other-technique/46207195#46207195", "title": "Best fit a circle from a binary image using contours or any other technique", "body": "<p>check the code below</p>\n\n<p><a href=\"https://i.stack.imgur.com/xRa7a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xRa7a.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>#include \"opencv2/imgcodecs.hpp\"\n#include \"opencv2/highgui.hpp\"\n#include \"opencv2/imgproc.hpp\"\n#include &lt;iostream&gt;\n\nusing namespace cv;\nusing namespace std;\n\n\nint main(int, char** argv)\n{\n    Mat src, src_gray;\n\n    /// Load source image and convert it to gray\n    src = imread(\"e:/test/ifFz9.png\");\n    resize(src, src, Size(), 0.25, 0.25);\n\n    /// Convert image to gray and blur it\n    cvtColor(src, src_gray, COLOR_BGR2GRAY);\n    blur(src_gray, src_gray, Size(3, 3));\n\n    imshow(\"Source\", src);\n\n    Mat threshold_output;\n    vector&lt;vector&lt;Point&gt; &gt; contours;\n\n    /// Detect edges using Threshold\n    threshold(src_gray, threshold_output, 127, 255, THRESH_BINARY);\n    /// Find contours\n    findContours(threshold_output, contours, RETR_TREE, CHAIN_APPROX_SIMPLE);\n\n    for (size_t i = 0; i &lt; contours.size(); i++)\n    {\n        if (contours[i].size() &gt; 50)\n        {\n            RotatedRect minEllipse = fitEllipse(contours[i]);\n\n            int size = min(minEllipse.size.width, minEllipse.size.height) / 2;\n            // ellipse\n            if (size &lt; src.rows / 2)\n                ellipse(src, minEllipse.center, Size(size, size), 0, 360, 0, Scalar(0, 0, 0255), 2, 8);\n        }\n    }\n\n    imshow(\"Contours\", src);\n    waitKey(0);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 5649980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a7d2960a5a0f7d9bfc1426d36e6bb5?s=128&d=identicon&r=PG&f=1", "display_name": "M Tauqeer", "link": "https://stackoverflow.com/users/5649980/m-tauqeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 890, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1505339446, "creation_date": 1505335170, "question_id": 46206466, "link": "https://stackoverflow.com/questions/46206466/best-fit-a-circle-from-a-binary-image-using-contours-or-any-other-technique", "title": "Best fit a circle from a binary image using contours or any other technique", "body": "<p>I've have a binary image computed from some algorithms. There is a hole in the image and I want to best fit a circle in this hole. I tried using <code>bestminEnclosingCircle</code> function but it don't give best results.</p>\n\n<p>Here is binary image</p>\n\n<p><a href=\"https://i.stack.imgur.com/ifFz9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ifFz9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is what I get from this function</p>\n\n<p><a href=\"https://i.stack.imgur.com/yuaVz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yuaVz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is what expected</p>\n\n<p><a href=\"https://i.stack.imgur.com/gsVSU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gsVSU.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to exclude this part</p>\n\n<p><a href=\"https://i.stack.imgur.com/K7vsW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K7vsW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is my code for finding contours</p>\n\n<pre><code>    vector&lt;Vec4i&gt; hierarchy;\n    vector&lt;vector&lt;Point&gt; &gt; contours;\n\n\n    findContours(src, contours, hierarchy, RETR_TREE, CHAIN_APPROX_SIMPLE, Point(0, 0));\n</code></pre>\n"}, {"tags": ["c++", "c++11", "vector"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1505335346, "post_id": 46206455, "comment_id": 79376330, "body": "<code>v.push_back(4);</code> <i>invalidates</i> the iterator (in case the contents of the vector need to be moved, which is probably the case here), meaning that everything afterwards is invoking <i>undefined behavior</i>"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505335353, "post_id": 46206455, "comment_id": 79376334, "body": "You are changing the vector while iterating through it? That&#39;s a weird idea."}, {"owner": {"reputation": 624, "user_id": 7445289, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-GHwkvczrbwE/AAAAAAAAAAI/AAAAAAAAAKM/6zYmCdhsfsY/photo.jpg?sz=128", "display_name": "Nagarjun Prasad", "link": "https://stackoverflow.com/users/7445289/nagarjun-prasad"}, "edited": false, "score": 0, "creation_date": 1505335470, "post_id": 46206455, "comment_id": 79376394, "body": "I wanted to test out what would happen if I were to do the same but the output was unexpected hence the question."}, {"owner": {"reputation": 1066, "user_id": 5960850, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tnJbUrwp8gM/AAAAAAAAAAI/AAAAAAAAABg/iPOhz7bBu8g/photo.jpg?sz=128", "display_name": "Matthew Woo", "link": "https://stackoverflow.com/users/5960850/matthew-woo"}, "edited": false, "score": 0, "creation_date": 1505337728, "post_id": 46206455, "comment_id": 79377431, "body": "Please post the text output rather than in a separate image (the image could be invalidated over time)"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1505339815, "post_id": 46206998, "comment_id": 79378222, "body": "Note that <code>push_back()</code> invalidates existing non-end iterators only if the underlying array has to be reallocated (when the new <code>size()</code> would exceed the current <code>capacity()</code>)."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505341462, "post_id": 46206998, "comment_id": 79378763, "body": "my point was, the statement &quot;<i>The push_back changes the begin and end iterator</i>&quot; is a little misleading.  It <i>MAY</i> change the <code>begin</code> iterator, or it <i>MAY NOT</i>. It depends on the current <code>size</code> and <code>capacity</code> of the vector at the time <code>push_back()</code> is called.  It <i>WILL</i> change the <code>end</code> iterator, though, since it is inserting at the end of the vector."}, {"owner": {"reputation": 985, "user_id": 5475431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/432a142ff6bc266e25d4724431d867ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mauri", "link": "https://stackoverflow.com/users/5475431/mauri"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505342245, "post_id": 46206998, "comment_id": 79379016, "body": "@RemyLebeau I agree with you and I updated the answer"}], "tags": [], "owner": {"reputation": 985, "user_id": 5475431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/432a142ff6bc266e25d4724431d867ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mauri", "link": "https://stackoverflow.com/users/5475431/mauri"}, "is_accepted": true, "score": 3, "last_activity_date": 1505342187, "last_edit_date": 1505342187, "creation_date": 1505337549, "answer_id": 46206998, "question_id": 46206455, "link": "https://stackoverflow.com/questions/46206455/why-is-the-contents-of-the-vector-being-printed-wrong-here/46206998#46206998", "title": "Why is the contents of the vector being printed wrong here?", "body": "<p>The push_back can change the begin and end iterators if the new item doesn't fit in the vector-capacity (the internal size). In your example the push_back implies a reallocation of the internal buffer and the begin and end iterators get new values. The problem in your example is the end-iterator will be evaluated for each step and it gets the new value but the begin Iterator is still keeping the old(invalid) value and that causes undefined behavior.\nFollowing changes will illustrate what happens:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;string&gt;\n#include&lt;vector&gt;\nusing namespace std;\nint main()\n{\n    int test=0;\n    vector&lt;int&gt;v{1,2,3};\n    for(auto i=v.cbegin();i!=v.cend();++i)\n    {\n        ++test;\n        if(test==2)\n        {\n            std::cout &lt;&lt; &amp;*v.cbegin()&lt;&lt;std::endl;\n            std::cout &lt;&lt; &amp;*v.cend()&lt;&lt;std::endl;\n            v.push_back(4);\n            std::cout &lt;&lt; &amp;*v.cbegin()&lt;&lt;std::endl;\n            std::cout &lt;&lt; &amp;*v.cend()&lt;&lt;std::endl;\n        }\n        cout&lt;&lt;*i&lt;&lt;endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>As you can see, the begin and end iterators changes completely</p>\n\n<p><a href=\"http://cpp.sh/6gsyz\" rel=\"nofollow noreferrer\">show result</a></p>\n"}], "owner": {"reputation": 624, "user_id": 7445289, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-GHwkvczrbwE/AAAAAAAAAAI/AAAAAAAAAKM/6zYmCdhsfsY/photo.jpg?sz=128", "display_name": "Nagarjun Prasad", "link": "https://stackoverflow.com/users/7445289/nagarjun-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 46206998, "answer_count": 1, "score": 1, "last_activity_date": 1505342187, "creation_date": 1505335149, "last_edit_date": 1505339705, "question_id": 46206455, "link": "https://stackoverflow.com/questions/46206455/why-is-the-contents-of-the-vector-being-printed-wrong-here", "title": "Why is the contents of the vector being printed wrong here?", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nint main()\n{\n    int test=0;\n    vector&lt;int&gt;v{1,2,3};\n    for(auto i=v.cbegin();i!=v.cend();++i)\n    {\n        ++test;\n        if(test==2)\n        {\n            v.push_back(4);\n        }\n        cout&lt;&lt;*i&lt;&lt;endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I expected the output to be only <code>1 2 3 4</code> but I received the output as shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/AbSjx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AbSjx.jpg\" alt=\"image\"></a></p>\n"}, {"tags": ["c++", "c++11", "templates"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1505335616, "post_id": 46206407, "comment_id": 79376452, "body": "What is the use case for such <code>vector</code>s? Does <a href=\"http://en.cppreference.com/w/cpp/utility/bitset\" rel=\"nofollow noreferrer\"><code>std::bitset</code></a> solve your issue?"}, {"owner": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1505335727, "post_id": 46206407, "comment_id": 79376512, "body": "I want to sort the resulting vector so I think bitset will not be feasible."}, {"owner": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1505335936, "post_id": 46206407, "comment_id": 79376620, "body": "To give some more context: it is a class that represents billions of strings with fixed length from an alphabet of 4 characters (genome). N is the number of characters and the maximum value is 32. 32 characters out of an alphabet of 4 can be represented with 64 bits. So the vector is basically lots of small genome samples and the size of those samples should be generic."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1505338265, "post_id": 46206407, "comment_id": 79377653, "body": "@eclipse based on your comment, it looks like <code>test&lt;16&gt;</code> should use <code>uint32_t</code> (16 bases each of which takes 2 bits to store, for a total of 32 bits), but based on your question it looks like you want <code>uint16_t</code>. Which do you want?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1505338667, "post_id": 46206407, "comment_id": 79377821, "body": "Is there a reason it needs to be an integer type, or would any other type of the right size work if it had comparison operators to allow sorting? Also, since you want something sorted, do you need a <code>std::vector</code> instead of <code>std::set</code>?"}, {"owner": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1505370434, "post_id": 46206407, "comment_id": 79386798, "body": "@DanielH I simplified the question but yes <code>test&lt;16&gt;</code> should have 32 bits. Since performance is an issue I figured that a preallocated <code>std::vector</code> with one <code>std::sort</code> is the fastest. Other data types would be fine, as long as they are directly in the <code>std::vector</code> i.e. not pointers to objects. I am actually not aware of any other primitive type that works without pointers. Is there such a thing? Or can you add an object to a vector without a using a pointer?"}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 3, "last_activity_date": 1505337714, "last_edit_date": 1505337714, "creation_date": 1505335494, "answer_id": 46206549, "question_id": 46206407, "link": "https://stackoverflow.com/questions/46206407/c-array-type-dependent-on-template-type/46206549#46206549", "title": "C++ Array type dependent on template type", "body": "<p>What about using conditional?</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;cstdint&gt;\n#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;std::size_t N&gt;\nstruct foo\n {\n   static_assert( N &lt; 65U, \"foo 64 limit\");\n\n   using vType = typename std::conditional&lt;\n      (N &lt; 9U), std::uint8_t,\n        typename std::conditional&lt; (N &lt; 17U), std::uint16_t,\n           typename std::conditional&lt; (N &lt; 33U), std::uint32_t, std::uint64_t\n   &gt;::type&gt;::type&gt;::type;\n\n   std::vector&lt;vType&gt; data;\n };\n\nint main()\n {\n   static_assert( 1U == sizeof(foo&lt;1&gt;::vType), \"!\");\n   static_assert( 1U == sizeof(foo&lt;8&gt;::vType), \"!\");\n   static_assert( 2U == sizeof(foo&lt;9&gt;::vType), \"!\");\n   static_assert( 2U == sizeof(foo&lt;16&gt;::vType), \"!\");\n   static_assert( 4U == sizeof(foo&lt;17&gt;::vType), \"!\");\n   static_assert( 4U == sizeof(foo&lt;32&gt;::vType), \"!\");\n   static_assert( 8U == sizeof(foo&lt;33&gt;::vType), \"!\");\n   static_assert( 8U == sizeof(foo&lt;64&gt;::vType), \"!\");\n\n   // foo&lt;65&gt; f65; compilation error\n }\n</code></pre>\n\n<p>Or, in a more elegant way (IMHO), you can define a type traits (<code>selectTypeByDim</code>, in the following example) that select the first useful type in a list</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;vector&gt;\n#include &lt;cstdint&gt;\n#include &lt;climits&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;std::size_t N, typename T,\n   bool = (N &lt;= sizeof(typename std::tuple_element&lt;0U, T&gt;::type)*CHAR_BIT)&gt;\nstruct stbdH;\n\ntemplate &lt;std::size_t N, typename T0, typename ... Ts&gt;\nstruct stbdH&lt;N, std::tuple&lt;T0, Ts...&gt;, true&gt;\n { using type = T0; };\n\ntemplate &lt;std::size_t N, typename T0, typename ... Ts&gt;\nstruct stbdH&lt;N, std::tuple&lt;T0, Ts...&gt;, false&gt;\n { using type = typename stbdH&lt;N, std::tuple&lt;Ts...&gt;&gt;::type; };\n\ntemplate &lt;std::size_t N, typename ... Ts&gt;\nstruct selectTypeByDim : stbdH&lt;N, std::tuple&lt;Ts...&gt;&gt;\n { };\n\ntemplate &lt;std::size_t N&gt;\nstruct foo\n {\n   static_assert( N &lt; 65U, \"foo 64 limit\");\n\n   using vType = typename selectTypeByDim&lt;N,\n         std::uint8_t, std::uint16_t, std::uint32_t, std::uint64_t&gt;::type;\n\n   std::vector&lt;vType&gt; data;\n };\n\nint main()\n {\n   static_assert( 1U == sizeof(foo&lt;1U&gt;::vType), \"!\");\n   static_assert( 1U == sizeof(foo&lt;CHAR_BIT&gt;::vType), \"!\");\n   static_assert( 2U == sizeof(foo&lt;CHAR_BIT+1U&gt;::vType), \"!\");\n   static_assert( 2U == sizeof(foo&lt;(CHAR_BIT&lt;&lt;1)&gt;::vType), \"!\");\n   static_assert( 4U == sizeof(foo&lt;(CHAR_BIT&lt;&lt;1)+1U&gt;::vType), \"!\");\n   static_assert( 4U == sizeof(foo&lt;(CHAR_BIT&lt;&lt;2)&gt;::vType), \"!\");\n   static_assert( 8U == sizeof(foo&lt;(CHAR_BIT&lt;&lt;2)+1U&gt;::vType), \"!\");\n   static_assert( 8U == sizeof(foo&lt;(CHAR_BIT&lt;&lt;3)&gt;::vType), \"!\");\n\n   //foo&lt;(CHAR_BIT&lt;&lt;3)+1U&gt; f65; compilation error\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "edited": false, "score": 0, "creation_date": 1505420044, "post_id": 46222681, "comment_id": 79418786, "body": "I actually used the solution with the byte array first. But I think I got one thing wrong which made me consider other options. When I have a class with only one field <code>std::array&lt;std::byte, N&gt;</code> how are objects of that class layed out inside the vector? I read today about &#39;placement new&#39;. But I am not a hundred percent sure how it would work in this case. You say that it does not add overhead, how so?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "edited": false, "score": 1, "creation_date": 1505421859, "post_id": 46222681, "comment_id": 79419682, "body": "A vector has a bunch of objects laid out consecutively, one after the other, just like an array but created at runtime. A class is laid out exactly like each of its members one after the other, perhaps with some padding between members or at the end for alignment purposes. Since it would only have one data member, there would be no additional alignment requirements over just using that, and besides that data member would be <code>byte</code>s which don\u2019t have alignment requirements anyway, so there would be no padding."}, {"owner": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "edited": false, "score": 0, "creation_date": 1505422006, "post_id": 46222681, "comment_id": 79419751, "body": "Hm okay I see how it would work like this with <code>std::byte[]</code> but <code>std::array</code> has more than one member that would be in the vector?!"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "edited": false, "score": 1, "creation_date": 1505422138, "post_id": 46222681, "comment_id": 79419808, "body": "No, <code>std::array&lt;T,N&gt;</code> is usually implemented to have a single member, of type <code>T[N]</code>, except I there\u2019s a complication if <code>N</code> is zero. Even if they did something else, it probably wouldn\u2019t be something which added space or time overhead."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "edited": false, "score": 1, "creation_date": 1505422358, "post_id": 46222681, "comment_id": 79419917, "body": "Are you perhaps used to some other languages? In C++, classes are pretty much a zero-cost abstraction, but in a lot of other languages there is more indirection involved and wrapping things in a class can make them bigger or slower."}, {"owner": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "edited": false, "score": 0, "creation_date": 1505422473, "post_id": 46222681, "comment_id": 79419974, "body": "Java :D shame on me. I found this: &quot;This container is an aggregate type with the same semantics as a struct holding a C-style array T[N] as its only non-static data member. &quot; here: <a href=\"http://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/array</a>. Which confirms your answers."}, {"owner": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "edited": false, "score": 0, "creation_date": 1505423903, "post_id": 46222681, "comment_id": 79420633, "body": "I think you are mistaken however since <code>std::array</code> can use extra padding. See here: <a href=\"https://stackoverflow.com/questions/19103244/is-the-size-of-stdarray-defined-by-standard?noredirect=1&amp;lq=1\" title=\"is the size of stdarray defined by standard\">stackoverflow.com/questions/19103244/&hellip;</a>"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "edited": false, "score": 0, "creation_date": 1505424068, "post_id": 46222681, "comment_id": 79420688, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/154486/discussion-between-daniel-h-and-eclipse\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1505401830, "creation_date": 1505401830, "answer_id": 46222681, "question_id": 46206407, "link": "https://stackoverflow.com/questions/46206407/c-array-type-dependent-on-template-type/46222681#46222681", "title": "C++ Array type dependent on template type", "body": "<p>Based on the comments to your question, you don't actually need a built-in type. Any copy-able move-able object can be put into a vector.</p>\n\n<p>If all you want to do with the data is sort it, I would recommend either <code>std::bitset&lt;2*N&gt;</code> or <code>std::array&lt;std::byte, (2*N+7)/8&gt;</code> (or <code>std::array&lt;std::byte,\n (2*N+CHAR_BIT-1)/CHAR_BIT&gt;</code> if you run on a weird system) with custom <code>Compare</code> for sorting. If you have any other uses for it (which you probably do), I would recommend a custom class with one of those as its underlying storage; this lets you add more features like getting a specific base.</p>\n\n<p>On most systems, a <code>std::bitset</code> will have no overhead if <code>N</code> is a multiple of either 32 or 64 (implementation dependent), but that isn't guaranteed. The byte array won't have any more overhead than is required by C++ in general. Both of these can be expanded beyond 64 bits if necessary, and the byte array will have the least space overhead, less even than using integral types because it doesn't force the size to be a power of two. Adding a custom class on top of either of these doesn't give any overhead at all.</p>\n\n<p>(If you are using C++14 or below you can use <code>char</code> or <code>uint8_t</code> instead of <code>byte</code>; a <code>byte</code> is closer to what you want but is only available in C++17. If you're using C++14 now but might switch, I'd recommend putting <code>using byte = uint8_t</code> in your code somewhere and then switching it out when you upgrade)</p>\n"}], "owner": {"reputation": 2323, "user_id": 1106899, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a17b8274a21cd1a62ce67f4cd0d02b7?s=128&d=identicon&r=PG", "display_name": "eclipse", "link": "https://stackoverflow.com/users/1106899/eclipse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 46206549, "answer_count": 2, "score": 1, "last_activity_date": 1505401830, "creation_date": 1505334936, "last_edit_date": 1505337358, "question_id": 46206407, "link": "https://stackoverflow.com/questions/46206407/c-array-type-dependent-on-template-type", "title": "C++ Array type dependent on template type", "body": "<p>I have a class that has an integral template parameter <code>N</code>. </p>\n\n<pre><code>template&lt;unsigned int N&gt;\nclass test {\n}\n</code></pre>\n\n<p>Now I want to have a <code>std::vector</code> with an integral type that is as small as possible to hold <code>N</code> bits.</p>\n\n<p>E.g.</p>\n\n<pre><code>class test&lt;8&gt; {\n    std::vector&lt;uint8_t&gt; data;\n}\n\nclass test&lt;9&gt; {\n    std::vector&lt;uint16_t&gt; data;\n}\n\nclass test&lt;10&gt; {\n    std::vector&lt;uint16_t&gt; data;\n}\n...\n</code></pre>\n\n<p>Is there any better way to do this for <code>N=1</code> to <code>N=64</code>?</p>\n"}, {"tags": ["c++", "winapi", "unicode"], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1505335004, "post_id": 46206353, "comment_id": 79376177, "body": "With C++17 you can also write immediately into a <code>std::wstring</code>, by passing the result of <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/data\" rel=\"nofollow noreferrer\"><code>std::string::data()</code></a> into <code>file.read()</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1505335073, "post_id": 46206353, "comment_id": 79376213, "body": "Prior to C++17, you can use the string&#39;s <code>operator[]</code> instead."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1505344156, "post_id": 46206353, "comment_id": 79379565, "body": "If you use <code>std::vector</code> there&#39;s no need to set the terminator yourself, it will be default-initialized to zero already."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1505344397, "post_id": 46206353, "comment_id": 79379628, "body": "@MarkRansom: yes, and that is one thing I don&#39;t like about <code>std::vector</code> - no way to allocate its buffer without it initializing new elements. For  raw memory buffers, default-initializing can be a waste of time. Unless you use <code>reserve()</code> and then <code>push_back()</code> the elemetns individually, which is not good for file I/O."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1505349291, "post_id": 46206353, "comment_id": 79380828, "body": "I&#39;m in complete agreement about the unnecessary overhead of <code>std::vector</code>. But I suppose that&#39;s why they invented <code>std::unique_ptr</code>."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1505335141, "last_edit_date": 1505335141, "creation_date": 1505334688, "answer_id": 46206353, "question_id": 46206313, "link": "https://stackoverflow.com/questions/46206313/end-of-wchar-contains-junk/46206353#46206353", "title": "End of WCHAR* contains junk", "body": "<p>You are calling the <code>std::wstring</code> constructor that expects a null-terminated <code>wchar_t*</code> string, but you are not null-terminating your buffer.  Allocate +1 more wchar and set it to 0:</p>\n\n<pre><code>WCHAR * resultBuffer = new WCHAR[nChars+1];\nfile.read(resultBuffer, nChars); \nresultBuffer[nChars] = L'\\0'; \nstd::wstring result = resultBuffer;\ndelete[] resultBuffer;\nreturn result;\n</code></pre>\n\n<p>Alternatively, if you specify the buffer length when constructing the <code>std::wstring</code>, you don't need the null terminator:</p>\n\n<pre><code>WCHAR * resultBuffer = new WCHAR[nChars];\nfile.read(resultBuffer, nChars); \nstd::wstring result(resultBuffer, nChars);\ndelete[] resultBuffer;\nreturn result;\n</code></pre>\n\n<p>Either way, you should use <code>std::vector</code> to manage the memory buffer instead of using <code>new[]</code>/<code>delete[]</code> manually:</p>\n\n<pre><code>std::vector&lt;WCHAR&gt; resultBuffer(nChars+1);\nfile.read(&amp;resultBuffer[0], nChars); \nresultBuffer[nChars] = L'\\0'; \nreturn std::wstring(resultBuffer.data());\n</code></pre>\n\n<p></p>\n\n<pre><code>std::vector&lt;WCHAR&gt; resultBuffer(nChars);\nfile.read(&amp;resultBuffer[0], nChars); \nreturn std::wstring(resultBuffer.data(), nChars);\n</code></pre>\n\n<p>Or, you can get rid of the buffer altogether and just read directly into the <code>std::wstring</code> itself:</p>\n\n<pre><code>std::wstring result;\nresult.resize(nChars);\nfile.read(&amp;result[0], nChars); // or result.data() in C++17\nreturn result;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": false, "score": 1, "last_activity_date": 1505335393, "last_edit_date": 1505335393, "creation_date": 1505334960, "answer_id": 46206416, "question_id": 46206313, "link": "https://stackoverflow.com/questions/46206313/end-of-wchar-contains-junk/46206416#46206416", "title": "End of WCHAR* contains junk", "body": "<p>When you have read n characters from a buffer, the mechanism to create a <code>std::string</code> is to use the sized constructor</p>\n\n<pre><code>file.read(resultBuffer, nChars);\nstd::wstring temp(resultBuffer, nChars);\n</code></pre>\n\n<p>This is slightly difference from null-terminating your input, as it allows resultBuffer to include L'\\0', which becomes part of the new string.  If this is not correct, then ensure the data is null-terminated after the number of bytes read from the <code>file.read</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4515695"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 46206353, "answer_count": 2, "score": 1, "last_activity_date": 1505374142, "creation_date": 1505334501, "last_edit_date": 1505374142, "question_id": 46206313, "link": "https://stackoverflow.com/questions/46206313/end-of-wchar-contains-junk", "title": "End of WCHAR* contains junk", "body": "<p>i'm working on a small project where i have to manage file I/O (this is something i'm quit new to). I'm using the WIN32 API with unicode as the character-set and therefore store all the file-data using wide-characters, and all strings in the program is  stored using std::wstring. This is the part of function that reads and returns the strings:</p>\n\n<pre><code>            //Get the string from file and return it\n            //(nChars is the amount of characters to read)\n            WCHAR * resultBuffer = new WCHAR[nChars];\n            file.read(resultBuffer, nChars); \n            std::wstring result = resultBuffer;\n            delete[] resultBuffer;\n            return result;\n</code></pre>\n\n<p>However i noticed that result contains a bunch of garbage characters at the end (the entire string is read correctly from file, but with  garbage characters appended at the end). Upon further inspection i noticed that these characters also appear just after resultBuffer gets allocated. Now this wouldn't be a problem if they would be over-written  but just appear to appended, and they get copied to result aswell (meaning result gets more elements than intended), which leads to a lot of problems using them later. I managed to fix the problem by adding some to it: </p>\n\n<pre><code>            //Get the string from file and return it\n            WCHAR * resultBuffer = new WCHAR[nChars];\n            file.read(resultBuffer, nChars);\n            std::wstring temp = resultBuffer;\n            std::wstring result;\n            for (INT i = 0; i &lt; nChars; i++) { //NOTE: This shouldn't be necessary \n                result.push_back(temp.at(i));\n            }               \n            delete[] resultBuffer;\n            return result;\n</code></pre>\n\n<p>This fixes the problem but i feel as though it shouldn't be needed. I suspected it might have something to do with how the read function (std::wifstream::read()) works, but i looked at the documentation for it and found no clue. I don't have much experience with using unicode and wide chars so it might be something obvious that i'm missing, but i'm really out clue. Anyone got any ideas? This is how resultBuffer looks after read() has been called (stackoverflow prints them as some kind of middle-eastern characters, but they appear as some asian ones in visual studio).</p>\n\n<ul>\n<li>resultBuffer L\"\\\\.\\DISPLAY1\ufdfd\ufdfd\u2610\u2610\ufc3e\ud5cf\u2700\u8000\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\u2610\"    wchar_t *</li>\n</ul>\n\n<p><strong>EDIT:</strong>\nThanks to Remy Lebeau and mksteve for providing great explanations aswell as answers! This is the working code:</p>\n\n<pre><code>            //Get the string from file and return it\n            std::wstring result;\n            result.resize(nChars);\n            file.read(&amp;result[0], nChars);\n            return result;\n</code></pre>\n"}, {"tags": ["c++", "collatz"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1505333755, "post_id": 46206120, "comment_id": 79375578, "body": "115s with what input, on which compiler?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1505333956, "post_id": 46206120, "comment_id": 79375701, "body": "Requests for feedback on working code should be directed to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1505334027, "post_id": 46206120, "comment_id": 79375742, "body": "Your task isn&#39;t very clearly stated, however; it would need to be clearly stated for people to understand what you are even doing"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1505334057, "post_id": 46206120, "comment_id": 79375754, "body": "Code <code>if( isOdd(x) == true )</code> is odd."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1505334161, "post_id": 46206120, "comment_id": 79375810, "body": "I do not understand the point of this function at all. It has no observable side effects, so you could simply replace it with an empty function; that would run quickly."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1505334181, "post_id": 46206120, "comment_id": 79375817, "body": "@Fran&#231;oisAndrieux I&#39;m not entirely sure that this is working code. It seems pretty intuitive that they&#39;re supposed to implement the <a href=\"https://en.wikipedia.org/wiki/Collatz_conjecture\" rel=\"nofollow noreferrer\">Collatz Conjecture</a>, and it doesn&#39;t appear that they&#39;ve implemented it correctly."}, {"owner": {"reputation": 604, "user_id": 7780211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rP7pt.jpg?s=128&g=1", "display_name": "Misho Tek", "link": "https://stackoverflow.com/users/7780211/misho-tek"}, "edited": false, "score": 1, "creation_date": 1505334209, "post_id": 46206120, "comment_id": 79375833, "body": "This function is not working properly at the first place."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1505334228, "post_id": 46206120, "comment_id": 79375847, "body": "Your algorithm is wrong, you want <code>while( x &gt; MAGIC )</code> to be <b>outside</b> of the <code>if</code>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1505334253, "post_id": 46206120, "comment_id": 79375860, "body": "@Justin and with -O3 compiler would completely optimize this function out  and it would take no time, so this is not actual code."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1505334276, "post_id": 46206120, "comment_id": 79375868, "body": "&quot;create a basic algorithm that finds the magic number (which is 1)&quot; uhmmm.... <code>return 1</code> ...."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1505334342, "post_id": 46206120, "comment_id": 79375900, "body": "1) Why doesn&#39;t the compiler optimize-out the entirety of <code>isMagic</code>, since it doesn&#39;t have any side-effects (no output being printed, no return value, no global variables changing)? 2) Are you sure you understood the assignment correctly? Since the loop in the <code>else if (isOdd(x) == true) </code> case would just keep running until the value stored in <code>x</code> overflows, and signed-integer overflow is undefined behavior."}, {"owner": {"reputation": 8409, "user_id": 2001017, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/H0Z0x.jpg?s=128&g=1", "display_name": "Picaud Vincent", "link": "https://stackoverflow.com/users/2001017/picaud-vincent"}, "edited": false, "score": 0, "creation_date": 1505336568, "post_id": 46206120, "comment_id": 79376938, "body": "As said before, looks like Collatz conjecture. Anyway, you also have to take care of possible overflows, for instance with your 5 billion, int of 32 bits is clearly not enough: Log[10^9*5]/Log[2]=32.21 bits"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 3, "creation_date": 1505334427, "post_id": 46206275, "comment_id": 79375933, "body": "If you fixing code, then fix this <code>isOdd(x) == false</code> nonsense"}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1505334532, "post_id": 46206275, "comment_id": 79375974, "body": "@Slava: Is it better now??"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1505334565, "post_id": 46206275, "comment_id": 79375990, "body": "yep, much better."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505334664, "post_id": 46206275, "comment_id": 79376035, "body": "it seems like the whole sentence is wrongly reproduced. It shouldnt say &quot;either dividing an even number by 2 until it&#39;s magic...&quot; but &quot;starting with a number, divide it by two if it is even, do ... when it is odd, until you get the magic number&quot;."}], "tags": [], "owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "is_accepted": false, "score": 4, "last_activity_date": 1505335210, "last_edit_date": 1505335210, "creation_date": 1505334325, "answer_id": 46206275, "question_id": 46206120, "link": "https://stackoverflow.com/questions/46206120/basic-algorithm-optimization/46206275#46206275", "title": "Basic Algorithm Optimization", "body": "<p>I think you misunderstood the assignment.\nThe \"either dividing an even number by 2 until it's magic, or multiplying an odd number by 3 and adding 1\" should be implemeneted as</p>\n\n<pre><code>while( x &gt; 1 )\n{\n  if( isEven(x) )\n  {\n    x /= 2;\n  }\n  else\n  {\n    x *= 3;\n    x += 1;\n  }\n}\n</code></pre>\n\n<p>Assuming the validity of <a href=\"https://en.wikipedia.org/wiki/Collatz_conjecture\" rel=\"nofollow noreferrer\">Collatz conjecture</a>, this can be further optimized as</p>\n\n<pre><code>x = 1;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 1, "creation_date": 1505335006, "post_id": 46206323, "comment_id": 79376181, "body": "This is wrong since you divide an odd number by 2 instead of an even number."}], "tags": [], "owner": {"reputation": 604, "user_id": 7780211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rP7pt.jpg?s=128&g=1", "display_name": "Misho Tek", "link": "https://stackoverflow.com/users/7780211/misho-tek"}, "is_accepted": false, "score": 0, "last_activity_date": 1505335057, "last_edit_date": 1505335057, "creation_date": 1505334566, "answer_id": 46206323, "question_id": 46206120, "link": "https://stackoverflow.com/questions/46206120/basic-algorithm-optimization/46206323#46206323", "title": "Basic Algorithm Optimization", "body": "<p>Your function runs just once, so if it won't get magic number in one turn it will give you wrong result, also in this case:</p>\n\n<pre><code> while( x &gt; MAGIC )\n{\n\n  x *= START;\n  x += MAGIC;\n  x /= DIV;\n\n};\n</code></pre>\n\n<p>when x is 3 or greater u get an infinite loop, and that's why it runs \"slow\"\nThe correct code will be:</p>\n\n<pre><code>MAGIC = 1;\n\nDIV = 2;\n\nSTART = 3;\n\nvoid isMagic(int x) {\n   while (x != MAGIC){\n         if(isOdd(x)){\n               x *= START;\n               x++;\n         } else {\n               x /= DIV;\n         }\n   }\n}\n</code></pre>\n\n<p>Note that isOdd(x) returns boolean so there is no need in == true</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1505335870, "last_edit_date": 1505335870, "creation_date": 1505335460, "answer_id": 46206541, "question_id": 46206120, "link": "https://stackoverflow.com/questions/46206120/basic-algorithm-optimization/46206541#46206541", "title": "Basic Algorithm Optimization", "body": "<p>Arguably the <strong>most</strong> important optimisation you want to implement is not solving the same problem over and over again while checking all numbers from 1 to 5 billion.</p>\n\n<p>Example: when running <code>isMagic(1742)</code>, you can run the loop for 179 or so iterations --- or recognize that you have already solved <code>isMagic(871)</code> and finish the check at the second iteration.</p>\n\n<p>And when you solve <code>isMagic(871)</code>, you shouldn't just record that you have solved 871, you should record <strong>all</strong> the numbers you encounter while solving it, which would be 2614 1307 3922 1961 5884 2942 1471 4414 2207 6622 3311 9934 4967 14902 7451 22354 11177 33532 16766 8383 25150 12575 37726 18863 56590 28295 84886 42443 127330 63665 190996 95498 47749 143248 71624 and so on --- that is, many numbers that are <strong>larger</strong> than the original 871. Finding a way to achieve that is the essence of your assignment.</p>\n\n<p>As a side note, <code>void isMagic(int x)</code> is a rather <em>odd</em> function signature. Normally a name like <code>isXYZ(...)</code> suggests a predicate, that is, a function that returns a boolean. A <code>void</code> function with no side effects can be optimised down to <code>void isMagic(int){}</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7763558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af95c22a4a558e1b4a500f815b04251e?s=128&d=identicon&r=PG&f=1", "display_name": "Aeternal", "link": "https://stackoverflow.com/users/7763558/aeternal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1505427158, "creation_date": 1505333635, "last_edit_date": 1505427158, "question_id": 46206120, "link": "https://stackoverflow.com/questions/46206120/basic-algorithm-optimization", "title": "Basic Algorithm Optimization", "body": "<p>My current assignment is to create a basic algorithm that finds the magic number (which is 1). The magic number can be found by either dividing an even number by 2 until it's magic, or multiplying an odd number by 3, adding 1, the dividing by 2 until 1. We must do this for each positive integer from 3 up until 5 billion.</p>\n\n<p><code>MAGIC = 1;</code></p>\n\n<p><code>DIV = 2;</code></p>\n\n<p><code>START = 3;</code></p>\n\n<p><code>MAX = 5000000000;</code></p>\n\n<pre><code>bool isOdd(int x);\nvoid isMagic(int x);\n\nint main () {\n\n  clock_t startTime = clock();\n  cout &lt;&lt; \"Beginning loop\" &lt;&lt; endl;\n\n  for (int i = START; i &lt; MAX; i++) \n  {\n\n    if ( isOdd(i) == false ) \n      isMagic(i);\n    else if ( isOdd(i) == true )\n      isMagic(i);\n\n   }\n\n  clock_t finishTime = clock();\n  cout &lt;&lt; \"Looping took \" &lt;&lt; double(finishTime - startTime) / CLOCKS_PER_SEC &lt;&lt; \" seconds\" &lt;&lt; endl;\n\n  return 0;\n}\n\n\nbool isOdd(int x) {\n\n  if( x % DIV == 0 )\n    return false;\n  else\n    return true;\n\n}\n\nvoid isMagic(int x) {\n\n  if( isOdd(x) == false ) //Is even\n  {\n\n    while( x &gt; MAGIC )\n    {\n        x /= DIV;\n    };\n\n  }\n  else if( isOdd(x) == true ) //Is odd\n  {\n\n    while( x &gt; MAGIC )\n    {\n\n      x *= START;\n      x += MAGIC;\n      x /= DIV;\n\n    };\n\n  }\n\n  return;\n}\n</code></pre>\n\n<p>This works, however, it is rather slow. Even with the <code>-o3</code> flag in my <code>makefile</code> it takes around 115 seconds to complete the task. My professor stated that a decent time would be ~60 seconds. How would I be able to optimize this?</p>\n"}, {"tags": ["c++", "containers", "derived-class", "upcasting"], "comments": [{"owner": {"reputation": 1338, "user_id": 4360353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16f921d78049db0195bb3fc3cda8e0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Basya", "link": "https://stackoverflow.com/users/4360353/basya"}, "edited": false, "score": 0, "creation_date": 1505333487, "post_id": 46205928, "comment_id": 79375425, "body": "You can use base class pointers anywhere you don&#39;t have to actually use functions that exist only in the derived class.  You haven&#39;t shown what you are doing with the object, so we can&#39;t tell if the cast is necessary."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505333803, "post_id": 46205928, "comment_id": 79375615, "body": "Think you might be over-designing. Consider keeping the <code>Node</code> dead generic. Keep it stupid and don&#39;t inherit from it. Place the smarts inside a class that the <code>Node</code> contains."}, {"owner": {"reputation": 21, "user_id": 8605082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f9eba44f0f585047fb9c85a5445ec5?s=128&d=identicon&r=PG&f=1", "display_name": "LMNCA", "link": "https://stackoverflow.com/users/8605082/lmnca"}, "edited": false, "score": 0, "creation_date": 1505333840, "post_id": 46205928, "comment_id": 79375636, "body": "Yes, sorry, I am running under some assumptions which I have not explained: the derived class will contain many more methods and/or members that are not available to the base classes (both for graph and node) and therefore I need the base class pointers to be converted to derived if I want to use them in the client code of these classes."}, {"owner": {"reputation": 21, "user_id": 8605082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f9eba44f0f585047fb9c85a5445ec5?s=128&d=identicon&r=PG&f=1", "display_name": "LMNCA", "link": "https://stackoverflow.com/users/8605082/lmnca"}, "edited": false, "score": 0, "creation_date": 1505334254, "post_id": 46205928, "comment_id": 79375862, "body": "For instance, I could want to acces the name_ member from the myDerivedClassFunction method of my derived class."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505338424, "post_id": 46205928, "comment_id": 79377726, "body": "I stand by my earlier comment. You are combining different, unrelated responsibilities within the same class. This will result in a more complicated  architecture and more difficulties working with it."}, {"owner": {"reputation": 21, "user_id": 8605082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f9eba44f0f585047fb9c85a5445ec5?s=128&d=identicon&r=PG&f=1", "display_name": "LMNCA", "link": "https://stackoverflow.com/users/8605082/lmnca"}, "edited": false, "score": 0, "creation_date": 1505389844, "post_id": 46205928, "comment_id": 79399042, "body": "Actually, I am doing the exact opposite: I refactored a class that used to have both some responsibility of supporting some GUI functions with lots of bells and whistles having to do with how to color/manage drawing style of arcs, and representing graph connectivity, and since I want to share only the connectivity representation with some other parts of the code, I am moving this functionality to a base class that different parts of the code will be able to inherit. I don&#39;t understand what you mean &quot;keep it stupid&quot;. Could you try to provide more specific details about how you would change it?"}, {"owner": {"reputation": 1338, "user_id": 4360353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16f921d78049db0195bb3fc3cda8e0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Basya", "link": "https://stackoverflow.com/users/4360353/basya"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1505409719, "post_id": 46205928, "comment_id": 79413302, "body": "A node representing connectivity only should not need a base and a derived class at all.  Any functionality needing a class hierarchy would usually be best off in the class that a node contains, not in the node.  Perhaps that is what @user4581301 is getting at."}, {"owner": {"reputation": 21, "user_id": 8605082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f9eba44f0f585047fb9c85a5445ec5?s=128&d=identicon&r=PG&f=1", "display_name": "LMNCA", "link": "https://stackoverflow.com/users/8605082/lmnca"}, "edited": false, "score": 0, "creation_date": 1505420504, "post_id": 46205928, "comment_id": 79419015, "body": "Ok, let&#39;s just assume that I have good reasons for wanting to share the way to represent connectivity information using a unified representation between different derived classes. So essentially, you all agree that there is no way to avoid the down-casting in a design like this?"}], "owner": {"reputation": 21, "user_id": 8605082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f9eba44f0f585047fb9c85a5445ec5?s=128&d=identicon&r=PG&f=1", "display_name": "LMNCA", "link": "https://stackoverflow.com/users/8605082/lmnca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505335789, "creation_date": 1505332829, "last_edit_date": 1505335789, "question_id": 46205928, "link": "https://stackoverflow.com/questions/46205928/c-avoid-casting-in-derived-class-code-for-twin-container-contained-object-desi", "title": "C++ avoid casting in derived class code for twin container/contained object design", "body": "<p>I have twin base classes for a container class and contained object (in my case, for a generic graph class made of linked nodes, but I guess the question would stand in all cases where you want to derive from both a container class and a contained object class from twin container/contained base classes). I want to use derived classes of both the container and contained object. How do I avoid having to constantly downcast the contained object to the derived contained object type when I access the container of the derived container class?</p>\n\n<pre><code>// a class that represents the graph\ntemplate &lt;typename WrappedObject&gt; class BaseGraph  {\n  ... // constructor, virtual destructor, ...\npublic:\n  std::map&lt;WrappedObject*, BaseNode&lt;WrappedObject&gt; *&gt; obj_to_node_map_;\n  bool addEdge(WrappedObject *scr, WrappedObject *trg) {\n    BaseNode&lt;WrappedObject &gt; * srcNode = getOrCreateNode(src);\n    BaseNode&lt;WrappedObject &gt; * dstNode = getOrCreateNode(trg);\n    return addEdge(srcNode, dstNode);\n  }\n\n  bool addEdge(BaseNode&lt;WrappedObject&gt; * src, BaseNode&lt;WrappedObject&gt; * trg) {\n    if (src == trg) {\n      return false;\n    }\n\n    src-&gt;suc_.insert(trg);\n    trg-&gt;pre_.insert(src);\n    return true;\n  }\n\n  BaseNode&lt;WrappedObject&gt;* getOrCreateNode(WrappedObject*obj){\n    BaseNode&lt;WrappedObject&gt; *node = getNode(obj);\n    if (node == nullptr) {\n      node = createNode(obj);\n      obj_to_node_map_[obj] = node;\n    }\n    return node;\n  }\n\n  BaseNode&lt;WrappedObject&gt;* createNode(WrappedObject* obj){\n    BaseNode&lt;WrappedObject&gt; *node = allocateNode(obj);\n    nodes_.push_back(node);\n    return node;\n  }\n  BaseNode&lt;WrappedObject&gt;* getNode(WrappedObject*obj) const {\n    auto it = obj_to_node_map_.find(obj);\n    if (it == obj_to_node_map_.end()) {\n      return nullptr;\n    }\n    return it-&gt;second;\n  }\nprivate:\n  virtual BaseNode&lt;Object&gt; * allocateNode(Object *obj) = 0;\n\n};\n// a class that represents the vertices of the graph\ntemplate &lt;typename WrappedObject&gt;\nclass BaseNode {\n  friend class BaseGraph&lt;WrappedObject&gt;;\npublic:\n  typedef std::set&lt;BaseNode *&gt; Set;\n  BaseNode(WrappedObject*obj):obj_(obj) {\n  }\n  virtual ~BaseNode() {};\n\n  WrappedObject *obj_;\n  Set suc_;\n  Set pre_;\n};\n\n// derived classes for node and graph\nclass RealObject;\nclass MyNode : public BaseNode&lt;RealObject&gt; {\nprivate:\n  std::string name_;\n  MyNode(RealObject *obj, std::string &amp; name): BaseGraph&lt;RealObject&gt;(obj), name_(name) {}\n...\n};\nclass MyGraph: public BaseGraph&lt;RealObject&gt; {\n  // constructor, virtual destructor, ...\nprivate:\n  virtual BaseNode&lt;RealObject&gt; * allocateNode(RealObject *obj) {\n    return new MyNode(obj, this);\n  }\n  std::map&lt;std::string, MyNode *&gt; name_lu_map_;\npublic:\n  MyNode * getNode(std:string &amp; name) {\n    return(name_lu_map_[name]);\n  }\n  // Have to have this otherwise any call to getNode on a MyGraph instance\n  // will cause compiler error as getNode is overloaded in derived class\n  MyNode * getNode(RealObject *obj) const {\n    return static_cast&lt;MyNode *&gt;(BaseGraph&lt;RealObject&gt;::getNode(obj));\n  }\n\n  void myDerivedClassFunction(RealObject *obj) {\n    // Lines like the following when I call a method of the base class\n    // returning a base class pointer will require casting, which I find\n    // ugly\n    MyNode *node = static_cast&lt;MyNode *&gt;(getOrCreateNode(obj));\n    node-&gt;name_ = &lt;something&gt;;\n    ...\n  }\n};\n</code></pre>\n\n<p>Is there a design pattern that would allow to avoid all the awkward downcast to the derived class whenever I use methods of the container base class that return base class contained object pointers? I thought of using a template argument to define what the derived contained object type will be, but I do not see how I can describe in C++ the fact that a typename template argument derives from another class. Possibly, I am looking at this from the wrong angle. Any ideas?</p>\n"}, {"tags": ["c++", "c++11", "gdb", "unordered-map"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1505332030, "post_id": 46205687, "comment_id": 79374712, "body": "This is definitely something I&#39;ve noticed as well. gdb seems to have problems resolving overloaded operators, and it frequently can&#39;t find the definition of commonly used functions"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1505332499, "post_id": 46205687, "comment_id": 79374943, "body": "Possibly relevant <a href=\"https://stackoverflow.com/questions/34894381/python-pretty-printing-with-gdb-does-not-support-maps-indexing-operator\" title=\"python pretty printing with gdb does not support maps indexing operator\">stackoverflow.com/questions/34894381/&hellip;</a>  - and look up other answers on prettyprinting."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 4, "creation_date": 1505332691, "post_id": 46205687, "comment_id": 79375038, "body": "gdb isn&#39;t a C++ compiler, so while it does know a lot of C++, it does not have all the C++ rules built in (In this case it seems it cant figure it should create a std::string temporary object from a string literal and then resolve the proper overload of the map)"}, {"owner": {"reputation": 365, "user_id": 7561372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I7vFuv6E3zY/AAAAAAAAAAI/AAAAAAAAF6w/drR575Nd8oo/photo.jpg?sz=128", "display_name": "GAURAV SRIVASTAVA", "link": "https://stackoverflow.com/users/7561372/gaurav-srivastava"}, "edited": false, "score": 0, "creation_date": 1505342769, "post_id": 46205687, "comment_id": 79379173, "body": "Thanks for the replies. Based on the comments, I should not try to operator [] with unordered_map. Instead, I could print all the members of the map using print mymap in gdb."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1505378326, "post_id": 46205687, "comment_id": 79391276, "body": "Related <a href=\"https://stackoverflow.com/q/427589/72178\">stackoverflow.com/q/427589/72178</a>."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 0, "creation_date": 1522069290, "post_id": 46205687, "comment_id": 85987556, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/427589/inspecting-standard-container-stdmap-contents-with-gdb\">Inspecting standard container (std::map) contents with gdb</a>"}, {"owner": {"reputation": 516, "user_id": 4200617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/520c060da7a770b3adce33389f290259?s=128&d=identicon&r=PG&f=1", "display_name": "anakin", "link": "https://stackoverflow.com/users/4200617/anakin"}, "edited": false, "score": 0, "creation_date": 1523141701, "post_id": 46205687, "comment_id": 86438931, "body": "There is a &#39;most expressive&#39; option -ggdb as described in the documentation of gcc. Also there is an optimization for debugging -Og"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1529934284, "post_id": 46205687, "comment_id": 89042390, "body": "See also: <a href=\"https://stackoverflow.com/questions/7429462/creating-c-string-in-gdb\" title=\"creating c string in gdb\">stackoverflow.com/questions/7429462/creating-c-string-in-gdb</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": false, "score": 8, "last_activity_date": 1532460649, "last_edit_date": 1532460649, "creation_date": 1532440338, "answer_id": 51500407, "question_id": 46205687, "link": "https://stackoverflow.com/questions/46205687/using-operator-with-unordered-map-in-gdb-give-unresolved-operator/51500407#51500407", "title": "Using [] operator with unordered_map in gdb give unresolved operator", "body": "<p>The problem you are facing is that <code>std::unordered_map&lt;std::string,int&gt;::at(key)</code> \nexpects a key of type <code>std::string</code>, not a <code>const char*</code> literal. This means that\nyou'd like to create a temporary std::string object, before passing it to <code>at()</code>.</p>\n\n<p>Creating a temporary object from within GDB does not work well for me, and I may be\nmissing something but this is what I get:</p>\n\n<pre><code>(gdb) p std::string(\"Mars\")\nA syntax error in expression, near `\"Mars\")'.\n(gdb) p 'std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::basic_string(char const*, std::allocator&lt;char&gt; const&amp;)'(\"Mars\")\n$9 = -161888904\n</code></pre>\n\n<p>So it does not seem possible to construct an <code>std::string</code> object inside GDB without \nsome additional C++ code, so just add to your C++ code:</p>\n\n<pre><code>std::string make_string(const char *x)\n{\n        return x;\n}\n</code></pre>\n\n<p>And now everything works:</p>\n\n<pre><code>(gdb) p mymap.at(make_string(\"Mars\"))\n$1 = (std::unordered_map&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, int, std::hash&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;, std::equal_to&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;, std::allocator&lt;std::pair&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const, int&gt; &gt; &gt;::mapped_type &amp;) @0x60005e5f0: 3000\n(gdb) p mymap.at(make_string(\"Jupiter\"))\n[New Thread 14608.0x16f4]\n$2 = (std::unordered_map&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, int, std::hash&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;, std::equal_to&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;, std::allocator&lt;std::pair&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const, int&gt; &gt; &gt;::mapped_type &amp;) @0x60005e650: 70000\n</code></pre>\n\n<p>But</p>\n\n<pre><code>(gdb) p mymap[make_string(\"Jupiter\")]\nCould not find operator[].\n</code></pre>\n\n<p>This does not work because it was never instantiated. What your code instantiated by:</p>\n\n<pre><code>std::cout&lt;&lt; mymap[\"Mars\"];\n</code></pre>\n\n<p>was <code>T&amp; operator[]( Key&amp;&amp; key );</code> which is tricky to invoke from GDB. \nHad you instantiated <code>T&amp; operator[]( const Key&amp; key );</code> instead, then things would\nhave fared better.</p>\n\n<p>The solution: instantiate the <code>operator[](const std::string &amp;)</code> variant in your C++ code. So here\nis the new code:</p>\n\n<pre><code>std::string make_string(const char *x)\n{\n        return x;\n}\n\nint main()\n{\n std::unordered_map&lt;std::string,int&gt; mymap = {\n                      { \"Mars\", 3000},\n                      { \"Saturn\", 60000},\n                      { \"Jupiter\", 70000 } };\n\n    std::string mars{\"Mars\"};\n    std::cout&lt;&lt; mymap.at(mars);\n    std::cout&lt;&lt; mymap[mars];\n}\n</code></pre>\n\n<p>With this, debugging becomes possible:</p>\n\n<pre><code>print mymap.at(make_string(\"Jupiter\"))\nprint mymap[make_string(\"Jupiter\")]\n</code></pre>\n\n<p>just work.</p>\n"}], "owner": {"reputation": 365, "user_id": 7561372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I7vFuv6E3zY/AAAAAAAAAAI/AAAAAAAAF6w/drR575Nd8oo/photo.jpg?sz=128", "display_name": "GAURAV SRIVASTAVA", "link": "https://stackoverflow.com/users/7561372/gaurav-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4454, "favorite_count": 1, "answer_count": 1, "score": 13, "last_activity_date": 1532460649, "creation_date": 1505331923, "last_edit_date": 1505332482, "question_id": 46205687, "link": "https://stackoverflow.com/questions/46205687/using-operator-with-unordered-map-in-gdb-give-unresolved-operator", "title": "Using [] operator with unordered_map in gdb give unresolved operator", "body": "<p>I have a C++ code where I am instantiating an unordered_map and then printing it's values using cout. This works fine. But, when I try to run this in gdb and print the values of the unordered_map, this gives me error. Below, is the code snippet:</p>\n\n<pre><code>  std::unordered_map&lt;std::string,int&gt; mymap = {\n                      { \"Mars\", 3000},\n                      { \"Saturn\", 60000},\n                      { \"Jupiter\", 70000 } };\n\n    std::cout&lt;&lt; mymap.at(\"Mars\");\n    std::cout&lt;&lt; mymap[\"Mars\"];\n</code></pre>\n\n<p>Both the cout statements above print the unordered_map value for key \"Mars\". However, when I use gdb and then try using below statements to print the value of mymap at key \"Mars\", I get errors.</p>\n\n<pre><code>(gdb) print mymap.at(\"Mars\")\nCannot resolve method std::unordered_map&lt;std::basic_string&lt;char, \nstd::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, int, \nstd::hash&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, \nstd::allocator&lt;char&gt; &gt; &gt;, std::equal_to&lt;std::basic_string&lt;char, \nstd::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;, \nstd::allocator&lt;std::pair&lt;std::basic_string&lt;char, std::char_traits&lt;char&gt;, \nstd::allocator&lt;char&gt; &gt; const, int&gt; &gt; &gt;::at to any overloaded instance\n\n(gdb) print mymap[\"Mars\"]\nCannot resolve function operator[] to any overloaded instance\n</code></pre>\n\n<p>I do not get what is wrong when I use gdb.</p>\n\n<p>I have tried using whatis mymap, in gdb, to see if mymap is present in current context and it gives that it is present. Also, I tried initializing an int variable and printing it in gdb and it prints it. I do not understand what is the problem with unordered_map. </p>\n\n<p>I am using below statement to generate executable</p>\n\n<pre><code>gsrivas4@TitanX01:~/lcode1$ g++ -std=gnu++11 -O0 -g test1.cpp -o test1.out\n</code></pre>\n"}, {"tags": ["c++", "c++11", "templates", "g++"], "comments": [{"owner": {"reputation": 1136, "user_id": 5147158, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7f5a49ac25a325cbd8293c5c6793c40f?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lenkefi", "link": "https://stackoverflow.com/users/5147158/peter-lenkefi"}, "edited": false, "score": 2, "creation_date": 1505331698, "post_id": 46205577, "comment_id": 79374547, "body": "I&#39;m guessing that the time the function pointer is passed, it already selected an overload for the function that needs 2 parameters."}, {"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1505382960, "post_id": 46205577, "comment_id": 79394521, "body": "Language lawyer alert\u2026 <code>a</code> and <code>b</code> are function <i>parameters</i>. These parameters have default <i>arguments</i> of 2 and 1, rsp.  So <code>a</code> is a parameter, and the value of <code>a</code> at run time is the argument."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505332027, "post_id": 46205622, "comment_id": 79374708, "body": "is there any possibility (without <code>bind</code>) to get a <code>int(*)(int)</code> or <code>int(*)()</code> from <code>g</code> ?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 1, "creation_date": 1505332040, "post_id": 46205622, "comment_id": 79374718, "body": "Maybe soon we will able to do this <code>generic([]() =&gt; g());</code>, right? :P (thanks)"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1505332118, "post_id": 46205622, "comment_id": 79374754, "body": "@tobi303 You can&#39;t do it with <code>bind</code> at all - same problem as here. Has to be a lambda."}, {"owner": {"reputation": 841, "user_id": 3450869, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4cd9f192289fd574ad0c67b24b096684?s=128&d=identicon&r=PG&f=1", "display_name": "ampawd", "link": "https://stackoverflow.com/users/3450869/ampawd"}, "edited": false, "score": 0, "creation_date": 1505332334, "post_id": 46205622, "comment_id": 79374849, "body": "hmm that&#39;s interesting, it seems to be working that way. But how does lambda preserve the context ?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505332621, "post_id": 46205622, "comment_id": 79375005, "body": "@Barry yes. Its the first time I think about it and somehow makes completely sense"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 841, "user_id": 3450869, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4cd9f192289fd574ad0c67b24b096684?s=128&d=identicon&r=PG&f=1", "display_name": "ampawd", "link": "https://stackoverflow.com/users/3450869/ampawd"}, "edited": false, "score": 1, "creation_date": 1505332852, "post_id": 46205622, "comment_id": 79375128, "body": "@ampawd Because <code>g()</code> is a valid expression, you&#39;re invoking it directly by name. It&#39;s the name lookup via <code>g</code> that gets you the default arguments, not through the type of <code>g</code>"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 22, "last_activity_date": 1505331715, "creation_date": 1505331715, "answer_id": 46205622, "question_id": 46205577, "link": "https://stackoverflow.com/questions/46205577/function-default-parameters-are-ignored/46205622#46205622", "title": "Function default parameters are ignored", "body": "<p><code>g</code> may have default arguments, but the type of <code>&amp;g</code> is still <code>int(*)(int, int)</code>, which is not a type that can be called with no arguments. Within <code>generic</code>, we can't differentiate that - we've already lost the context about default arguments. </p>\n\n<p>You can just wrap <code>g</code> in a lambda to preserve the context:</p>\n\n<pre><code>generic([]{ return g(); });\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1505334723, "post_id": 46205804, "comment_id": 79376052, "body": "If you&#39;re going to go boilerplate, you should make <code>g</code> a function object instead - so you can still do <code>generic(g)</code>"}, {"owner": {"reputation": 841, "user_id": 3450869, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4cd9f192289fd574ad0c67b24b096684?s=128&d=identicon&r=PG&f=1", "display_name": "ampawd", "link": "https://stackoverflow.com/users/3450869/ampawd"}, "edited": false, "score": 0, "creation_date": 1505336609, "post_id": 46205804, "comment_id": 79376961, "body": "yeah, nice solution with function object as well"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 841, "user_id": 3450869, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4cd9f192289fd574ad0c67b24b096684?s=128&d=identicon&r=PG&f=1", "display_name": "ampawd", "link": "https://stackoverflow.com/users/3450869/ampawd"}, "edited": false, "score": 1, "creation_date": 1505336780, "post_id": 46205804, "comment_id": 79377038, "body": "@ampawd function objects are just the poor mans lambdas (or lambdas are just function objects with some fancier syntax). I was just curious to see how one would do it in C++98. For me this always helps to better understand the C++11 features as most of them were invented to overcome C++98 shortcomings"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 7, "last_activity_date": 1505342269, "last_edit_date": 1505342269, "creation_date": 1505332333, "answer_id": 46205804, "question_id": 46205577, "link": "https://stackoverflow.com/questions/46205577/function-default-parameters-are-ignored/46205804#46205804", "title": "Function default parameters are ignored", "body": "<p>I think the error message to this code quite nicely demonstrates why this isn't possible:</p>\n\n<pre><code>int g(int a=0,int b=0){return 0;}\n\ntypedef int (*F1)(int);\n\nint main() {\n    F1 x = g;\n}\n\nerror: cannot initialize a variable of type 'F1' (aka 'int (*)(int)') with\nan lvalue of type 'int (int, int)': different number of parameters (1 vs 2)\n    F1 x = g;\n       ^   ~\n</code></pre>\n\n<p>Even with default parameters, the type of <code>g</code> is still</p>\n\n<pre><code>int (*) (int,int)\n</code></pre>\n\n<p>and that's what gets deduced when you instantiate the template.</p>\n\n<p>If for some reason you cannot use C++11 or later (i.e. no lambdas, see Barry's answer) and you don't mind a little boilerplate, then you can use a function object:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct g_functor {\n    int operator()(int a=0,int b=0){ return a;}\n};\n\ntemplate &lt;typename T&gt; void foo(T t) { t(); }\n\nint main() { foo(g_functor()); }\n</code></pre>\n\n<p>Note that you have to create an instance of <code>g_functor</code> to pass it as a parameter.</p>\n"}], "owner": {"reputation": 841, "user_id": 3450869, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4cd9f192289fd574ad0c67b24b096684?s=128&d=identicon&r=PG&f=1", "display_name": "ampawd", "link": "https://stackoverflow.com/users/3450869/ampawd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 3, "accepted_answer_id": 46205622, "answer_count": 2, "score": 18, "last_activity_date": 1505342269, "creation_date": 1505331464, "last_edit_date": 1505342171, "question_id": 46205577, "link": "https://stackoverflow.com/questions/46205577/function-default-parameters-are-ignored", "title": "Function default parameters are ignored", "body": "<p>For this simplified piece of code I'm getting following error:</p>\n\n<blockquote>\n  <p>error: too few arguments to function\n    std::cout &lt;&lt; f();</p>\n</blockquote>\n\n<pre><code>int g(int a = 2, int b = 1)\n{\n    return a + b;\n}\n\ntemplate&lt;class Func&gt;\nvoid generic(Func f)\n{\n    std::cout &lt;&lt; f();\n}\n\nint main()\n{\n    generic(g);\n}\n</code></pre>\n\n<p>I cannot clue the reason for why the default parameters of function <code>f</code> are not passing into a function <code>generic</code>. It behaves like <code>f</code> doesn't have any default parameters ...</p>\n\n<p>What's wrong there?</p>\n\n<p>How do I forward default parameters correctly?</p>\n"}, {"tags": ["c++", "windows", "visual-studio", "window"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1505331316, "post_id": 46205527, "comment_id": 79374354, "body": "It&#39;s not possible (or  desirable). And the iostream library is not really intended for interactive use."}, {"owner": {"reputation": 559, "user_id": 8298003, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Nl25z.jpg?s=128&g=1", "display_name": "hannacreed", "link": "https://stackoverflow.com/users/8298003/hannacreed"}, "edited": false, "score": 0, "creation_date": 1505331470, "post_id": 46205527, "comment_id": 79374439, "body": "well idk, this is just what we are learning in school, so I am trying to make it user friendly for myself I guess..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1505331507, "post_id": 46205527, "comment_id": 79374457, "body": "Don&#39;t waste your time - it can&#39;t be done."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505332718, "post_id": 46205527, "comment_id": 79375052, "body": "You&#39;ll have to abandon <code>cin</code> and use something like the curses library. Neil Butterworth has the right of it. Unless it&#39;s required by the assignment, you&#39;re better off spending your time on something that will get you a better grade."}], "answers": [{"tags": [], "owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 0, "last_activity_date": 1505334745, "creation_date": 1505334745, "answer_id": 46206365, "question_id": 46205527, "link": "https://stackoverflow.com/questions/46205527/how-to-add-char-directly-after-cin-in-c/46206365#46206365", "title": "How to add char directly after (cin) in c++", "body": "<p>It is definitely possible, however <code>iostream</code> does not really provide a proper interface to perform it. Typically achieving greater control over console io requires use of some platform-specific functions. On Windows with VS this could be done with <code>_getch</code> like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;conio.h&gt;\n#include &lt;iso646.h&gt;\n\nint main()\n{\n    ::std::string accum{};\n    bool loop{true};\n    do\n    {\n        char const c{static_cast&lt;char&gt;(::_getch())};\n        switch(c)\n        {\n            case '0':\n            case '1':\n            case '2':\n            case '3':\n            case '4':\n            case '5':\n            case '6':\n            case '7':\n            case '8':\n            case '9':\n            {\n                //  TODO limit accumullated chars count...\n                accum.push_back(c);\n                ::std::cout &lt;&lt; c &lt;&lt; \"%\" \"\\b\" &lt;&lt; ::std::flush;\n                break;\n            }\n            case 'q':\n            {\n                loop = false;\n                accum.clear();\n                break;\n            }\n            case '\\r': // Enter pressed\n            {\n                //  TODO convert accumullated chars to number...\n                ::std::cout &lt;&lt; \"\\r\" \"Number set to \" &lt;&lt; accum &lt;&lt; \"%\" \"\\r\" \"\\n\" &lt;&lt; ::std::flush;\n                accum.clear();\n                break;\n            }\n            default: // Something else pressed.\n            {\n                loop = false;\n                accum.clear();\n                ::std::cout &lt;&lt; \"\\r\" \"oops!!                              \" \"\\r\" &lt;&lt; ::std::flush;\n                break;\n            }\n        }\n    }\n    while(loop);\n    ::std::cout &lt;&lt; \"done\" &lt;&lt; ::std::endl;\n    return(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 559, "user_id": 8298003, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Nl25z.jpg?s=128&g=1", "display_name": "hannacreed", "link": "https://stackoverflow.com/users/8298003/hannacreed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 869, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505334745, "creation_date": 1505331248, "question_id": 46205527, "link": "https://stackoverflow.com/questions/46205527/how-to-add-char-directly-after-cin-in-c", "title": "How to add char directly after (cin) in c++", "body": "<p>I am trying to add a percent sign directly after a users input (so that the user doesn't have to type the percent symbol). When I try this, it either goes to the next line or doesn't work at all. </p>\n\n<p><strong>What I want:</strong> _%<br>\n// the blank is for the user's input.</p>\n\n<p>Sorry if this is messy, I'm not sure how to add c++ here.</p>\n\n<p><strong>Here are some things that I have attempted:</strong> </p>\n\n<pre><code>// used a percent as a variable:\nconst char percent = '%';\n\ncout &lt;&lt; \"Enter the tax rate: \" &lt;&lt; percent; // obviously here the percent \nsymbol goes before the number. \n\ndouble taxRate = 0.0;\ncin &gt;&gt; taxRate &gt;&gt; percent; // here I tried adding it into the cin after the cin.\n\ncin &gt;&gt; taxRate &gt;&gt; '%'; // here I tried adding the char itself, but yet another failed attempt...\n</code></pre>\n\n<p>So, is it even possible to do what I am wanting? </p>\n"}, {"tags": ["c++", "lua"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1505331360, "post_id": 46205435, "comment_id": 79374382, "body": "Wouldn&#39;t it be easier to use <code>lua_type</code>, rather than repeated <code>lua_is*</code> calls?"}, {"owner": {"reputation": 601, "user_id": 8150130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1629543837056783/picture?type=large", "display_name": "Treyten Carey", "link": "https://stackoverflow.com/users/8150130/treyten-carey"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1505331563, "post_id": 46205435, "comment_id": 79374484, "body": "Yeah that might be more efficient too considering integers are placed in isstring since isstring is before isnumber."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 7556173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8p3x.png?s=128&g=1", "display_name": "\u4e0a\u5c71\u8001\u4eba", "link": "https://stackoverflow.com/users/7556173/%e4%b8%8a%e5%b1%b1%e8%80%81%e4%ba%ba"}, "edited": false, "score": 0, "creation_date": 1505376302, "post_id": 46212128, "comment_id": 79390102, "body": "There is a another method: <i>void getValues(lua_State</i> L1, lua_State* L2, const char* cszFormat, ...)* ,for example: cszFormat = &quot;sd&gt;ds&quot;, there are two input(string,number) and two output(number,string)"}], "tags": [], "owner": {"reputation": 302, "user_id": 7556173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8p3x.png?s=128&g=1", "display_name": "\u4e0a\u5c71\u8001\u4eba", "link": "https://stackoverflow.com/users/7556173/%e4%b8%8a%e5%b1%b1%e8%80%81%e4%ba%ba"}, "is_accepted": false, "score": 0, "last_activity_date": 1505371001, "creation_date": 1505371001, "answer_id": 46212128, "question_id": 46205435, "link": "https://stackoverflow.com/questions/46205435/transfer-multidimensional-lua-array-from-lua-state-to-lua-state-c/46212128#46212128", "title": "Transfer multidimensional lua array from lua_State to lua_State C++", "body": "<p>You can try <a href=\"https://github.com/zupet/LuaTinker\" rel=\"nofollow noreferrer\">lua_tinker::table:</a></p>\n"}, {"tags": [], "owner": {"reputation": 601, "user_id": 8150130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1629543837056783/picture?type=large", "display_name": "Treyten Carey", "link": "https://stackoverflow.com/users/8150130/treyten-carey"}, "is_accepted": true, "score": 2, "last_activity_date": 1505430327, "creation_date": 1505430327, "answer_id": 46229424, "question_id": 46205435, "link": "https://stackoverflow.com/questions/46205435/transfer-multidimensional-lua-array-from-lua-state-to-lua-state-c/46229424#46229424", "title": "Transfer multidimensional lua array from lua_State to lua_State C++", "body": "<p>Solved.</p>\n\n<p>For anyone this might be useful:</p>\n\n<pre><code>void getValues(lua_State* L1, lua_State* L2, int ind)\n{\n    if (lua_type(L1, -1) == LUA_TTABLE)\n    {\n        lua_newtable(L2);\n        lua_pushnil(L1);\n        ind = 0;\n        while (lua_next(L1, -2))\n        {\n            // push the key\n            if (lua_type(L1, -2) == LUA_TSTRING)\n                lua_pushstring(L2, lua_tostring(L1, -2));\n            else if (lua_type(L1, -2) == LUA_TNUMBER)\n                lua_pushnumber(L2, lua_tonumber(L1, -2));\n            else\n                lua_pushnumber(L2, ind);\n\n            getValues(L1, L2, ind++);\n            lua_pop(L1, 1);\n\n            lua_settable(L2, -3);\n        }\n    }\n    else if (lua_type(L1, -1) == LUA_TSTRING)\n    {\n        lua_pushstring(L2, lua_tostring(L1, -1));\n    }\n    else if (lua_type(L1, -1) == LUA_TNUMBER)\n    {\n        lua_pushnumber(L2, lua_tonumber(L1, -1));\n    }\n    else if (lua_type(L1, -1) == LUA_TBOOLEAN)\n    {\n        lua_pushboolean(L2, lua_toboolean(L1, -1));\n    }\n    else if (lua_type(L1, -1) == LUA_TUSERDATA)\n    {\n        // replace with your own user data. This is mine\n        LuaElement* e = Luna&lt;LuaElement&gt;::to_object(L1, -1);\n        if (e != NULL)\n        {\n            Luna&lt;LuaElement&gt;::push_object(L2, e);\n        }\n    }\n}\n</code></pre>\n\n<p>Warning: L1 and L2 must be different states.</p>\n"}], "owner": {"reputation": 601, "user_id": 8150130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1629543837056783/picture?type=large", "display_name": "Treyten Carey", "link": "https://stackoverflow.com/users/8150130/treyten-carey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 46229424, "answer_count": 2, "score": 2, "last_activity_date": 1505430327, "creation_date": 1505330809, "question_id": 46205435, "link": "https://stackoverflow.com/questions/46205435/transfer-multidimensional-lua-array-from-lua-state-to-lua-state-c", "title": "Transfer multidimensional lua array from lua_State to lua_State C++", "body": "<p>I have 2 scripts, each are in a different lua_State.</p>\n\n<p>I am trying to be able to get a variable from one state and use it in the other.</p>\n\n<p>My code below works for single variables and unidirectional arrays. Could I get some guidance on also making it work for multidimensional arrays?</p>\n\n<pre><code>void getValues(lua_State* L1, lua_State* L2, int&amp; returns)\n{\n    if (lua_isuserdata(L1, -1))\n    {\n        LuaElement* e = Luna&lt;LuaElement&gt;::to_object(L1, -1);\n        if (e != NULL)\n        {\n            Luna&lt;LuaElement&gt;::push_object(L2, e);\n        }\n    }\n    else if (lua_isstring(L1, -1))\n    {\n        lua_pushstring(L2, lua_tostring(L1, -1));\n    }\n    else if (lua_isnumber(L1, -1))\n        lua_pushnumber(L2, lua_tonumber(L1, -1));\n    else if (lua_isboolean(L1, -1))\n        lua_pushboolean(L2, lua_toboolean(L1, -1));\n    else if (lua_istable(L1, -1))\n    {\n        lua_pushnil(L1);\n        lua_newtable(L2);\n        while (lua_next(L1, -2))\n        {\n            getValues(L1, L2, returns);\n\n            lua_rawseti(L2,-2,returns-1);\n            lua_pop(L1, 1);\n        }\n        // lua_rawseti(L2,-2,returns); // this needs work\n    }\n    returns++;\n}\n</code></pre>\n\n<p>Unfortunately I'm having a tough time getting the recursion right for this to work for multidimensional arrays.</p>\n"}, {"tags": ["c++", "eclipse", "eclipse-cdt", "iostream"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505331036, "post_id": 46205420, "comment_id": 79374185, "body": "How did you setup your toolchain?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1505331095, "post_id": 46205420, "comment_id": 79374212, "body": "Be aware that Eclipse is a pretty piss-poor C++ IDE."}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505331131, "post_id": 46205420, "comment_id": 79374235, "body": "@Neil I totally disagree."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505331188, "post_id": 46205420, "comment_id": 79374279, "body": "@user0042 Which one do you think is worse?"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505331285, "post_id": 46205420, "comment_id": 79374333, "body": "@Neil Let&#39;s take CodeBlocks for instance. I don&#39;t like Visual Studio much either."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505331416, "post_id": 46205420, "comment_id": 79374406, "body": "@user Probably not the place for this discussion, but I find both of them far superior to Eclipse - CodeBlocks for its much greater speed, VS for its much greater power."}, {"owner": {"reputation": 381, "user_id": 2701272, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/z3XPB.jpg?s=128&g=1", "display_name": "BharathYes", "link": "https://stackoverflow.com/users/2701272/bharathyes"}, "edited": false, "score": 0, "creation_date": 1505331570, "post_id": 46205420, "comment_id": 79374490, "body": "Guys. There has been enough debate on the best IDE. I choose Eclipse to get back into coding because I felt it has more flexibility incase I decide to try Java."}, {"owner": {"reputation": 381, "user_id": 2701272, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/z3XPB.jpg?s=128&g=1", "display_name": "BharathYes", "link": "https://stackoverflow.com/users/2701272/bharathyes"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505331831, "post_id": 46205420, "comment_id": 79374612, "body": "@user0042 not sure what exactly you mean by tool chain. I downloaded and installed the latest ide from Eclipse two days back. I had installed both MinGW and Cygwin a while back but did update MinGW using its package manager tool and that is what I select as my compiler while creating the project on Eclipse."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1505332264, "post_id": 46205420, "comment_id": 79374814, "body": "@Bhar If you want to use basically the same IDE for both C++ and Java programming (though that may not be a good idea), check out the JetBrains tools, such as CLion and IDEA."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505332357, "post_id": 46205420, "comment_id": 79374862, "body": "Fools. You should all use ed. It&#39;s the standard editor. As for Eclipse, it should detect mingw. If it needs some help, and it sure sounds like it, add the bin folder (eg: X:\\DevApps\\Mingw\\mingw64\\bin) to the system path. (Warning: Assumes Windows OS and a reboot may be required to force the update through everything that&#39;s already running)"}, {"owner": {"reputation": 381, "user_id": 2701272, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/z3XPB.jpg?s=128&g=1", "display_name": "BharathYes", "link": "https://stackoverflow.com/users/2701272/bharathyes"}, "edited": false, "score": 0, "creation_date": 1505333013, "post_id": 46205420, "comment_id": 79375204, "body": "@NeilButterworth I had them installed on my old laptop and was using my edu email for the license. But I thought it was unnecessary to get it  all again especially I am only starting out and Eclipse being free was a bonus. I did look at few articles on &quot;Eclipse vs NetBeans vs IntelliJ&quot; and most of the differences being mentioned there didn&#39;t make any sense to me. They probably would be a concern for a serious developer handling large projects and not for someone following &quot;C++: the complete reference&quot;. Will settle on a ide as my experience grows."}, {"owner": {"reputation": 381, "user_id": 2701272, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/z3XPB.jpg?s=128&g=1", "display_name": "BharathYes", "link": "https://stackoverflow.com/users/2701272/bharathyes"}, "edited": false, "score": 0, "creation_date": 1505333078, "post_id": 46205420, "comment_id": 79375235, "body": "@NeilButterworth But if you do know of a significant advantage for InteliJ IDEA applicable to a beginner do let me know."}, {"owner": {"reputation": 44207, "user_id": 141719, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5026f7977fda423dc990cc74b2ad4c9d?s=128&d=identicon&r=PG&f=1", "display_name": "HighCommander4", "link": "https://stackoverflow.com/users/141719/highcommander4"}, "edited": false, "score": 0, "creation_date": 1505339868, "post_id": 46205420, "comment_id": 79378241, "body": "@NeilButterworth: CLion is not open-source, nor is it free to use."}, {"owner": {"reputation": 44207, "user_id": 141719, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5026f7977fda423dc990cc74b2ad4c9d?s=128&d=identicon&r=PG&f=1", "display_name": "HighCommander4", "link": "https://stackoverflow.com/users/141719/highcommander4"}, "edited": false, "score": 0, "creation_date": 1505339974, "post_id": 46205420, "comment_id": 79378265, "body": "Does Building the project from within Eclipse succeed? If so, the problem might be that the Built-in Compiler Settings provider is disabled (and so Eclipse is not picking up the compiler&#39;s built-in include paths)."}, {"owner": {"reputation": 381, "user_id": 2701272, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/z3XPB.jpg?s=128&g=1", "display_name": "BharathYes", "link": "https://stackoverflow.com/users/2701272/bharathyes"}, "reply_to_user": {"reputation": 44207, "user_id": 141719, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5026f7977fda423dc990cc74b2ad4c9d?s=128&d=identicon&r=PG&f=1", "display_name": "HighCommander4", "link": "https://stackoverflow.com/users/141719/highcommander4"}, "edited": false, "score": 0, "creation_date": 1505373435, "post_id": 46205420, "comment_id": 79388523, "body": "@HighCommander4 The program builds and executes without much problem. But it shows 12 errors under the Problems tab. <a href=\"https://imgur.com/a/mYm5y\" rel=\"nofollow noreferrer\">Screencaps</a>. The full &#39;Localtion&#39; text in the first error is <code>Project Properties, C++ Preprocessor Include...&#47;Providers, [CDT Cross GCC Built-in Compiler Settings] options</code>"}, {"owner": {"reputation": 1, "user_id": 4348656, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003324082177/picture?type=large", "display_name": "Peng  Zup", "link": "https://stackoverflow.com/users/4348656/peng-zup"}, "edited": false, "score": 0, "creation_date": 1571985461, "post_id": 46205420, "comment_id": 103426493, "body": "The following steps works for me: <a href=\"https://stackoverflow.com/a/58552865/4348656\">stackoverflow.com/a/58552865/4348656</a>"}], "answers": [{"tags": [], "owner": {"reputation": 44207, "user_id": 141719, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5026f7977fda423dc990cc74b2ad4c9d?s=128&d=identicon&r=PG&f=1", "display_name": "HighCommander4", "link": "https://stackoverflow.com/users/141719/highcommander4"}, "is_accepted": false, "score": 1, "last_activity_date": 1505411626, "creation_date": 1505411626, "answer_id": 46225506, "question_id": 46205420, "link": "https://stackoverflow.com/questions/46205420/what-causes-the-eclipse-cdt-unresolved-inclusion-iostream/46225506#46225506", "title": "What causes the Eclipse CDT Unresolved inclusion: &lt;iostream&gt;", "body": "<p>That first error in the screenshot linked in the comments provides a clue to the problem. </p>\n\n<p>If you go to the preference page mentioned in the error's \"Location\", you'll see that there is a field called \"Command to get compiler specs\" with the contents something like:</p>\n\n<pre><code>${COMMAND} ${FLAGS} -E -P -v -dD \"${INPUTS}\"\n</code></pre>\n\n<p>This is a command that Eclipse tries to run to get your compiler to output its built-in include paths and other similar information.</p>\n\n<p>The fact that you're getting the error <code>Program \"-E\" not found in PATH</code> suggests that the variables <code>${COMMAND}</code> and <code>${FLAGS}</code> are evaluating to empty strings, so that the first actual token in the command (which the shell then tries to interpret as the program name) is <code>-E</code>.</p>\n\n<p>I'm not sure <em>why</em> those variables are evaluating to empty, but you should be able to work around the issue by replacing <code>${COMMAND}</code> with <code>g++</code> (presumably <code>g++</code> is in your PATH).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4348656, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003324082177/picture?type=large", "display_name": "Peng  Zup", "link": "https://stackoverflow.com/users/4348656/peng-zup"}, "is_accepted": false, "score": 0, "last_activity_date": 1572311511, "last_edit_date": 1572311511, "creation_date": 1571985691, "answer_id": 58553461, "question_id": 46205420, "link": "https://stackoverflow.com/questions/46205420/what-causes-the-eclipse-cdt-unresolved-inclusion-iostream/58553461#58553461", "title": "What causes the Eclipse CDT Unresolved inclusion: &lt;iostream&gt;", "body": "<p>I've searched for a few hours and tried a lot solutions.</p>\n\n<p>Envirment: windows, Eclipse IDE for C/C++ Developers</p>\n\n<p>Version: Kepler Service Release 2</p>\n\n<p>CDT: 8.3.0</p>\n\n<p>Following steps works for me:</p>\n\n<p>make sure the envirement is clear. => <strong>I suggest delete the eclipse and unzip it again from your orginal download. Remove all variable relatated to eclipse and MinGW you set to PATH of envirment variables.</strong></p>\n\n<p>make sure the workspace is clear. => <strong>Delete .metadata folder in your workspace folder.</strong></p>\n\n<p>use valid MinGW. => the one using download tool is slow and I'm not sure which one to select. I suggest <strong>download MinGWStudio which contains an unzip MinGW</strong> from <a href=\"http://vaultec.mbnet.fi/mingwstudio.php\" rel=\"nofollow noreferrer\">http://vaultec.mbnet.fi/mingwstudio.php</a> This is a IDE tool like eclipse contains a downloaded unzip MinGW. Make sure you download the one plus MinGW compiler which is about 20M. You can use this studio if you want or copy the MinGW folder to C:/ if you still prefer eclipse. <strong>Copy /MinGW inside /MinGWStudio to C:/</strong>.</p>\n\n<p>close your eclipse and reopen it, create a new project, you should able to see MinGW section for new project option, and it will auto map g++, gcc and include files under C:/MinGW folder. Just make sure you copy MinGW folder from MinGWStudio to the root of C:/. </p>\n\n<p>You will able to see your include after these steps. Build your project, everything should goes well even there may some warning hint.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3ERf6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3ERf6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 381, "user_id": 2701272, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/z3XPB.jpg?s=128&g=1", "display_name": "BharathYes", "link": "https://stackoverflow.com/users/2701272/bharathyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1311, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1572311511, "creation_date": 1505330781, "question_id": 46205420, "link": "https://stackoverflow.com/questions/46205420/what-causes-the-eclipse-cdt-unresolved-inclusion-iostream", "title": "What causes the Eclipse CDT Unresolved inclusion: &lt;iostream&gt;", "body": "<p>Just installed the latest Eclipse IDE and am following the included <a href=\"http://help.eclipse.org/oxygen/topic/org.eclipse.cdt.doc.user/concepts/cdt_o_home.htm?cp=13\" rel=\"nofollow noreferrer\" title=\"C/C++ Development User Guide\">C++ User Guide</a> right from 'Before you begin' section.</p>\n\n<p>The <a href=\"http://help.eclipse.org/oxygen/topic/org.eclipse.cdt.doc.user/getting_started/cdt_w_basic.htm?cp=13_1_1\" rel=\"nofollow noreferrer\">simple application</a> was successfully completed but once I got to the <a href=\"http://help.eclipse.org/oxygen/topic/org.eclipse.cdt.doc.user/getting_started/cdt_w_newproj.htm?cp=13_1_2\" rel=\"nofollow noreferrer\">makefile project</a> and the <a href=\"http://help.eclipse.org/oxygen/topic/org.eclipse.cdt.doc.user/getting_started/cdt_w_newcpp.htm?cp=13_1_4\" rel=\"nofollow noreferrer\">C++ file</a> tutorials, I got the \"Unresolved inclusion: <code>&lt;iostream&gt;</code>\" error and a bunch of others related to \"cout, cin, endl\" because of it.</p>\n\n<p>I followed the tutorials exactly as instructed and am not sure why this occurred. I have since corrected it by following <a href=\"https://stackoverflow.com/questions/11543198/unresolved-inclusion-iostream-in-eclipse-on-mac\">this answer</a>, but now want to know why this happens, especially since I am following the official tutorial and do I have to add the C++ include path for every project on Eclipse?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10373788/c-unresolved-inclusion-iostream#\">Related Question</a></p>\n"}, {"tags": ["c++", "language-lawyer"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1505329957, "post_id": 46205151, "comment_id": 79373607, "body": "<code>x</code> and <code>y</code> are private here."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1505329988, "post_id": 46205151, "comment_id": 79373622, "body": "<code>Base b = new Base;</code> gives you a <code>Base</code>.  You can&#39;t just magically get a <code>Derived</code> out of it."}, {"owner": {"reputation": 4567, "user_id": 1320751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eee0011ba2ca995b31e464fc2e2ad885?s=128&d=identicon&r=PG", "display_name": "Anon Mail", "link": "https://stackoverflow.com/users/1320751/anon-mail"}, "edited": false, "score": 0, "creation_date": 1505330026, "post_id": 46205151, "comment_id": 79373650, "body": "And just because this simple example works doesn&#39;t mean you can rely on it working for other cases."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1505330077, "post_id": 46205151, "comment_id": 79373678, "body": "The rules for when a <code>static_cast</code> is well defined can be found here : <a href=\"http://en.cppreference.com/w/cpp/language/static_cast\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/static_cast</a>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1505330200, "post_id": 46205151, "comment_id": 79373729, "body": "@NathanOliver actually question is not so obvious, OP mention that he only going to access <code>Base</code> members through <code>d</code>"}, {"owner": {"reputation": 3558, "user_id": 1732563, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b51d68c0232ecc9de87719a203ccb428?s=128&d=identicon&r=PG", "display_name": "Sean Perry", "link": "https://stackoverflow.com/users/1732563/sean-perry"}, "edited": false, "score": 0, "creation_date": 1505330830, "post_id": 46205151, "comment_id": 79374068, "body": "This works because the common layout has the derived class after the base class in memory. But the compiler could behave differently. Besides, this is a trap waiting to spring. The next coder in line may not notice the Derived is not safe to use."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505340639, "post_id": 46205151, "comment_id": 79378486, "body": "Regardless of how <code>Base</code> and <code>Derived</code> are laid out in memory, the compiler knows how they are related to each other, and how it needs to adjust a <code>Derived</code> pointer so it can reach a <code>Base</code> object to access its members. And since <code>d</code> does not point at a valid <code>Derived</code> object, that adjustment will result in undefined behavior."}], "answers": [{"tags": [], "owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "is_accepted": true, "score": 11, "last_activity_date": 1505331113, "last_edit_date": 1505331113, "creation_date": 1505330202, "answer_id": 46205275, "question_id": 46205151, "link": "https://stackoverflow.com/questions/46205151/accessing-base-class-members-with-incorrect-downcast-in-c/46205275#46205275", "title": "Accessing base class members with incorrect downcast in C++", "body": "<p>This is reasonably straightforward in <a href=\"http://eel.is/c++draft/expr.static.cast#11\" rel=\"nofollow noreferrer\">[expr.static.cast]/11</a> (emphasis mine):</p>\n\n<blockquote>\n  <p><strong>A prvalue of type \u201cpointer to cv1 B\u201d, where B is a class type, can be converted to a prvalue of type \u201cpointer to cv2 D\u201d, where D is a class derived from B</strong>, if cv2 is the same cv-qualification as, or greater cv-qualification than, cv1. If B is a virtual base class of D or a base class of a virtual base class of D, or if no valid standard conversion from \u201cpointer to D\u201d to \u201cpointer to B\u201d exists ([conv.ptr]), the program is ill-formed. The null pointer value is converted to the null pointer value of the destination type. <strong>If the prvalue of type \u201cpointer to cv1 B\u201d points to a B that is actually a subobject of an object of type D, the resulting pointer points to the enclosing object of type D. Otherwise, the behavior is undefined.</strong></p>\n</blockquote>\n\n<p>You don't have a subobject of a <code>Derived</code>, so it's undefined behaviour.</p>\n\n<hr>\n\n<p>Note there are no special cases for lvalue or xvalue pointers, and /8 mentions that the operand undergoes an lvalue-to-rvalue conversion.</p>\n"}], "owner": {"reputation": 373, "user_id": 8035619, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bf6aad7e5c1a10d48fc006dd2fa1d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Koban", "link": "https://stackoverflow.com/users/8035619/koban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 46205275, "answer_count": 1, "score": 2, "last_activity_date": 1505331113, "creation_date": 1505329769, "last_edit_date": 1505330433, "question_id": 46205151, "link": "https://stackoverflow.com/questions/46205151/accessing-base-class-members-with-incorrect-downcast-in-c", "title": "Accessing base class members with incorrect downcast in C++", "body": "<p>Is the following C++ code correct?</p>\n\n<pre><code>struct Base { int x; };\nstruct Derived : Base { int y; }\nBase * b = new Base;\nDerived * d = static_cast&lt;Derived *&gt;(b);\n//below we access only d-&gt;x, but not d-&gt;y\nstd::cout &lt;&lt; d-&gt;x;\n</code></pre>\n\n<p>If not, what exactly is wrong? What C++ standard say about this? At least I have not seen it ever crashed.</p>\n"}, {"tags": ["c++", "makefile", "cygwin", "wxwidgets"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8556290"}, "edited": false, "score": 1, "creation_date": 1505327092, "post_id": 46204386, "comment_id": 79372020, "body": "No sure, you probably need to add as dependency the path C:\\wxWidgets-3.1.0\\ where your header are located. Regards"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1505327376, "post_id": 46204386, "comment_id": 79372192, "body": "@Squazz, also, did you just installed wxWidgets or you also compiled the library? You should compile the library prior to using it."}, {"owner": {"reputation": 3464, "user_id": 1955317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Veaa.jpg?s=128&g=1", "display_name": "Squazz", "link": "https://stackoverflow.com/users/1955317/squazz"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1505327460, "post_id": 46204386, "comment_id": 79372239, "body": "@Igor I installed it with the windows installer from the wxwidgets website. If I should do anything else, I don&#39;t know how to :)"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1505327466, "post_id": 46204386, "comment_id": 79372246, "body": "You probably just need to change (or add to) the include paths you pass to the compiler so that it knows where to find the required header."}, {"owner": {"reputation": 3464, "user_id": 1955317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Veaa.jpg?s=128&g=1", "display_name": "Squazz", "link": "https://stackoverflow.com/users/1955317/squazz"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1505327900, "post_id": 46204386, "comment_id": 79372485, "body": "@JesperJuhl that actually did change something. Changing wx/app.h to C:\\wxWidgets-3.1.0\\include\\wx/app.h gave me a new error, and now I start seeing the rabbithole... app.h includes &quot;wx/event.h&quot; which is now the next file the compiler cannot find. I don&#39;t intend to change all paths in all of the files in wxWidgets, I must be doing something wrong?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1505328230, "post_id": 46204386, "comment_id": 79372668, "body": "@Squazz I did <i>not</i> mean &quot;change the include directive in the source file&quot;. I meant &quot;pass an extra include path (<code>-I</code> for gcc) to the compiler so it searches that directory as well&quot; - that way it will also find all the <i>other</i> includes.. Edit the <i>build files</i>, <i>not</i> the <i>source files</i>."}], "answers": [{"tags": [], "owner": {"reputation": 462, "user_id": 8547128, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-VdtX8-xzgi4/AAAAAAAAAAI/AAAAAAAAADY/Qpj1DlW3s4M/photo.jpg?sz=128", "display_name": "Ali Sepehri-Amin", "link": "https://stackoverflow.com/users/8547128/ali-sepehri-amin"}, "is_accepted": false, "score": 0, "last_activity_date": 1505328005, "last_edit_date": 1505328005, "creation_date": 1505327357, "answer_id": 46204526, "question_id": 46204386, "link": "https://stackoverflow.com/questions/46204386/wx-app-h-no-souch-file-or-directory-with-cygwin64/46204526#46204526", "title": "wx/app.h: no souch file or directory with cygwin64", "body": "<p>You must include/edit path of the wxWidgets header files in your project. Try this:\nGo to your Enviroment Variables by Click on the This pc -> Properties -> Advanced system settings -> Enviroment Variables. In the System variables click New and Set the Variable name as: <strong>WXCONFIG</strong> that uses in the makefile. Set the <strong>variable value</strong> as your wxWidgets folder path.</p>\n"}, {"comments": [{"owner": {"reputation": 3464, "user_id": 1955317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Veaa.jpg?s=128&g=1", "display_name": "Squazz", "link": "https://stackoverflow.com/users/1955317/squazz"}, "edited": false, "score": 0, "creation_date": 1505328866, "post_id": 46204761, "comment_id": 79373016, "body": "I didn&#39;t understand anything of this. I may be too new with the to understand your answer, but, how do I use this information to solve the problem at hand? :)"}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "reply_to_user": {"reputation": 3464, "user_id": 1955317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Veaa.jpg?s=128&g=1", "display_name": "Squazz", "link": "https://stackoverflow.com/users/1955317/squazz"}, "edited": false, "score": 0, "creation_date": 1505329022, "post_id": 46204761, "comment_id": 79373108, "body": "Install <code>libwx_baseu3.0-devel</code> package. Add <code>&#47;usr&#47;include&#47;wx-3.0</code> to your include search path"}], "tags": [], "owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "is_accepted": false, "score": 0, "last_activity_date": 1505328217, "creation_date": 1505328217, "answer_id": 46204761, "question_id": 46204386, "link": "https://stackoverflow.com/questions/46204386/wx-app-h-no-souch-file-or-directory-with-cygwin64/46204761#46204761", "title": "wx/app.h: no souch file or directory with cygwin64", "body": "<p>to search file on cygwin packages you can use\n<a href=\"https://cygwin.com/packages/\" rel=\"nofollow noreferrer\">https://cygwin.com/packages/</a> </p>\n\n<p>looking for <code>wx/app.h</code></p>\n\n<p><a href=\"https://cygwin.com/cgi-bin2/package-cat.cgi?file=x86_64%2Flibwx_baseu3.0-devel%2Flibwx_baseu3.0-devel-3.0.3-1&amp;grep=wx%2Fapp.h\" rel=\"nofollow noreferrer\">https://cygwin.com/cgi-bin2/package-cat.cgi?file=x86_64%2Flibwx_baseu3.0-devel%2Flibwx_baseu3.0-devel-3.0.3-1&amp;grep=wx%2Fapp.h</a></p>\n\n<p>will show you that it is included in the package <code>libwx_baseu3.0-devel</code>  the <code>wxWidgets C++ application framework</code></p>\n"}, {"tags": [], "owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "is_accepted": false, "score": 0, "last_activity_date": 1505328255, "creation_date": 1505328255, "answer_id": 46204770, "question_id": 46204386, "link": "https://stackoverflow.com/questions/46204386/wx-app-h-no-souch-file-or-directory-with-cygwin64/46204770#46204770", "title": "wx/app.h: no souch file or directory with cygwin64", "body": "<p>If you look inside wxWidgets samples you will find projects set to include wxWidgets correctly. The thing that matters sometimes is to create a new project in a custiom location so you must set the include and library directories correctly.</p>\n\n<p>This is an example of wxWidgets:</p>\n\n<pre><code>// additional include directories\n.\\..\\..\\lib\\vc_lib\\mswud\n.\\..\\..\\include\n.\n.\\..\\..\\samples\n</code></pre>\n\n<p>To set a project on the desktop for example:</p>\n\n<pre><code>D:\\wxWidgets-3.1.0\\lib\\vc_lib\\mswud\nD:\\wxWidgets-3.1.0\\include\nD:\\wxWidgets-3.1.0\nD:\\wxWidgets-3.1.0\\samples\n</code></pre>\n\n<p>Above as you can see my wxWidgets is installed on drive D so if I want to use it in my projects I set the directories as above.</p>\n\n<ul>\n<li><p>Also do the same thing with additional libraries:</p>\n\n<pre><code>D:\\wxWidgets-3.1.0\\lib\\vc_lib\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 18238, "user_id": 15275, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WNTZ3.jpg?s=128&g=1", "display_name": "VZ.", "link": "https://stackoverflow.com/users/15275/vz"}, "is_accepted": false, "score": 0, "last_activity_date": 1505386658, "creation_date": 1505386658, "answer_id": 46217286, "question_id": 46204386, "link": "https://stackoverflow.com/questions/46204386/wx-app-h-no-souch-file-or-directory-with-cygwin64/46217286#46217286", "title": "wx/app.h: no souch file or directory with cygwin64", "body": "<p>Cygwin is (supposed to be like) Unix, so you should follow Unix instructions for building wxWidgets itself and applications using it, see, for example, <code>docs/gtk/install.txt</code> in the distribution.</p>\n\n<p>Notice that you will need to build wxWidgets itself first and then build the application using <code>wx-config --cxxflags</code> as explained in the file above.</p>\n\n<p>Also notice that you've probably chosen the <em>least</em> simple way to build the application by using Cygwin as your platform. Using MinGW+MSys would be simpler.</p>\n"}], "owner": {"reputation": 3464, "user_id": 1955317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Veaa.jpg?s=128&g=1", "display_name": "Squazz", "link": "https://stackoverflow.com/users/1955317/squazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 606, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1505386658, "creation_date": 1505326729, "question_id": 46204386, "link": "https://stackoverflow.com/questions/46204386/wx-app-h-no-souch-file-or-directory-with-cygwin64", "title": "wx/app.h: no souch file or directory with cygwin64", "body": "<p>Its nearly impossible to find a compiled version of Meteorite. And when you find one, it doesn't work.</p>\n\n<p>Trying to compile meteorite myself from this github fork: <a href=\"https://github.com/cbielow/meteorite\" rel=\"nofollow noreferrer\">https://github.com/cbielow/meteorite</a> I am met with the following error message when I try to execute the \"make\" command in Cygwin64: </p>\n\n<pre><code>In file included from src/MeteoriteApp.cpp:18:0:\nsrc/MeteoriteApp.h:13:20: fatal error : wx/app.h: no souch file or directory with cygwin64\n</code></pre>\n\n<p>One of the prerequisites are wxWidgets that I have installed with the windows installer from there: <a href=\"https://www.wxwidgets.org/downloads/\" rel=\"nofollow noreferrer\">https://www.wxwidgets.org/downloads/</a></p>\n\n<p>I am extremely new to c++ everything related to it. What can I be doing wrong? Is there an include in the source from Meteorite that I should change?</p>\n\n<p>wxWidgets installed under <code>C:\\wxWidgets-3.1.0</code> and here (<code>C:\\wxWidgets-3.1.0\\include\\wx</code>) I found a <code>wx</code> folder with the <code>app.h</code> file that the compiler is telling me about. I tried copying this wx folder to different places around the source, and in the  source I tried changing the include from  to &lt;../wx/app.h>. But none of this helped.</p>\n\n<p>Is there anything other than the references given I can provide here to help you guys help me?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 7, "creation_date": 1505326687, "post_id": 46204371, "comment_id": 79371760, "body": "It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1505326871, "post_id": 46204371, "comment_id": 79371893, "body": "Don&#39;t use recursive function calls. They don&#39;t scale well. Use a loop and a <code>std::stack</code> instead."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1505326912, "post_id": 46204371, "comment_id": 79371921, "body": "Unless this is a learning exercise, you should just use <code>std::list</code> (or <code>std::vector</code>) and be done already, rather than re-inventing the wheel."}, {"owner": {"reputation": 756, "user_id": 1584435, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/91e08d2198292677f855c45c81e3c5a0?s=128&d=identicon&r=PG", "display_name": "Sinapse", "link": "https://stackoverflow.com/users/1584435/sinapse"}, "edited": false, "score": 2, "creation_date": 1505327140, "post_id": 46204371, "comment_id": 79372050, "body": "provide a main function too, write an example along with what you expect as its output and what it actually is printing"}, {"owner": {"reputation": 573, "user_id": 6212793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Sseq.png?s=128&g=1", "display_name": "Cimmerian_Perspective", "link": "https://stackoverflow.com/users/6212793/cimmerian-perspective"}, "edited": false, "score": 0, "creation_date": 1505327690, "post_id": 46204371, "comment_id": 79372367, "body": "Thanks for all the answers,I&#39;ve edited the post with the info .Normally I create the list iteratively.It&#39;s a learning exercise actually, so I&#39;m not allowed to use std::list or vector."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505328091, "post_id": 46204371, "comment_id": 79372591, "body": "Unrelated: No need for a dynamic allocation and the extra management overhead it brings here: <code>List&lt;int&gt; *l = new List&lt;int&gt;();</code>. <code>List&lt;int&gt; l;</code> will do everything you need. You&#39;ll have to replace a bunch of <code>-&gt;</code> with <code>.</code>  since you aren&#39;t working with a pointer anymore."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505328163, "post_id": 46204371, "comment_id": 79372631, "body": "Unrelated: <code>NodeList</code>&#39;s constructor leaves <code>prev</code> uninitialized. This may come back to bite you later"}, {"owner": {"reputation": 4125, "user_id": 3426025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yxLev.png?s=128&g=1", "display_name": "BeyelerStudios", "link": "https://stackoverflow.com/users/3426025/beyelerstudios"}, "edited": false, "score": 0, "creation_date": 1505328215, "post_id": 46204371, "comment_id": 79372661, "body": "Hint: what happens to <code>head</code> in <code>ins(H key)</code>?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505328850, "post_id": 46204371, "comment_id": 79373003, "body": "Important note: passing a pointer to an object passes the object by reference but the pointer is still passed by value and is a local (Automatic) variable. Changing what this local pointer points at will have no effect on the source. If you want to update a pointer inside a function, pass the pointer by reference."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505328913, "post_id": 46204371, "comment_id": 79373042, "body": "Slightly less important note: C++ has no garbage collection. That which you <code>new</code> you must also <code>delete</code>."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 6212793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Sseq.png?s=128&g=1", "display_name": "Cimmerian_Perspective", "link": "https://stackoverflow.com/users/6212793/cimmerian-perspective"}, "edited": false, "score": 0, "creation_date": 1505333479, "post_id": 46205083, "comment_id": 79375419, "body": "But in this case I provide an head insertion,not tail. Why my  nod = new NodeList&lt;H&gt;(nod,key) won&#39;t work?"}, {"owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "reply_to_user": {"reputation": 573, "user_id": 6212793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Sseq.png?s=128&g=1", "display_name": "Cimmerian_Perspective", "link": "https://stackoverflow.com/users/6212793/cimmerian-perspective"}, "edited": false, "score": 0, "creation_date": 1505334207, "post_id": 46205083, "comment_id": 79375830, "body": "You are assigning <code>nod</code> to new. This does not affect <code>head</code>. It will remain <code>nullptr</code>."}, {"owner": {"reputation": 573, "user_id": 6212793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Sseq.png?s=128&g=1", "display_name": "Cimmerian_Perspective", "link": "https://stackoverflow.com/users/6212793/cimmerian-perspective"}, "edited": false, "score": 0, "creation_date": 1505336397, "post_id": 46205083, "comment_id": 79376861, "body": "Right! Many Thanks,I&#39;ve misinterpreted your comment before.I&#39;ve resolved adding a control on head node."}, {"owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "reply_to_user": {"reputation": 573, "user_id": 6212793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Sseq.png?s=128&g=1", "display_name": "Cimmerian_Perspective", "link": "https://stackoverflow.com/users/6212793/cimmerian-perspective"}, "edited": false, "score": 0, "creation_date": 1505337071, "post_id": 46205083, "comment_id": 79377169, "body": "Love you back :)"}], "tags": [], "owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "is_accepted": true, "score": 1, "last_activity_date": 1505329463, "creation_date": 1505329463, "answer_id": 46205083, "question_id": 46204371, "link": "https://stackoverflow.com/questions/46204371/recursion-on-linked-list/46205083#46205083", "title": "Recursion on Linked List", "body": "<p>You're almost there: <code>head</code> needs to be assigned the result of insTail:</p>\n\n<pre><code>head = insTail(head,&amp;key);\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 6212793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Sseq.png?s=128&g=1", "display_name": "Cimmerian_Perspective", "link": "https://stackoverflow.com/users/6212793/cimmerian-perspective"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 2, "accepted_answer_id": 46205083, "answer_count": 1, "score": 0, "last_activity_date": 1505336755, "creation_date": 1505326646, "last_edit_date": 1505336755, "question_id": 46204371, "link": "https://stackoverflow.com/questions/46204371/recursion-on-linked-list", "title": "Recursion on Linked List", "body": "<p>I'm trying to create a recursive Linked List.\nAt the moment I simply provide the class with two methods, one for tail insertion and a print.\nI don't understand why it doesn't print anything.\nI think the main problem is on recInsert(node,key) method who interprets the head node always as NULL.\nWhat I'm doing wrong?</p>\n\n<p>I want to print the sequence <code>8-&gt;7-&gt;12-&gt;22</code></p>\n\n<p>Here's my code:</p>\n\n<pre><code> template&lt;class H&gt;class NodeList{\n        private:\n            NodeList&lt;H&gt; *prev,*next;\n            H* key;\n\n        public:\n            NodeList(NodeList&lt;H&gt; *next,H *key){\n            this-&gt;next = next;\n            this-&gt;key = new H(*key);\n        }\n\n            NodeList&lt;H&gt; *getPrev(){return prev;}\n            NodeList&lt;H&gt; *getNext(){return next;}\n\n            void setPrev(NodeList&lt;H&gt; *prev){this-&gt;prev = prev;}\n            void setNext(NodeList&lt;H&gt; *next){this-&gt;next = next;}\n\n            void setKey(H *key){this-&gt;key = new H(*key);}\n            H *getKey(){return key;}    \n    };\n\n    template&lt;class H&gt;class List{\n        private:\n            NodeList&lt;H&gt; *head;\n\n        public:\n            List(){\n                head = NULL;\n            }\n\n        NodeList&lt;H&gt;* insTail(NodeList&lt;H&gt; *nod,H *key){\n            if(nod == NULL){\n                 nod = new NodeList&lt;H&gt;(nod,key);\n            }\n            else{\n                nod-&gt;setNext(insTail(nod-&gt;getNext(),key));\n            }\n                return nod;\n        }\n\n        List&lt;H&gt; *ins(H key){\n            insTail(head,&amp;key);\n            return this;\n        }\n\n        void recPrint(NodeList&lt;H&gt; *head){\n            if(head == NULL){\n                return;\n            }\n            else{\n                cout&lt;&lt;*head-&gt;getKey();\n                recPrint(head-&gt;getNext());\n            }\n        }\n\n        void print(){\n            recPrint(head);\n            cout&lt;&lt;endl;\n    }\n        };\n\n int main(){\n        List&lt;int&gt; *l = new List&lt;int&gt;();\n        l-&gt;ins(8)-&gt;ins(7)-&gt;ins(12)-&gt;ins(22);\n        l-&gt;print();\n</code></pre>\n\n<h2>        }</h2>\n\n<p>I've resolved adding a control on head node on insTail() method</p>\n\n<pre><code>NodeList&lt;H&gt;* insTail(NodeList&lt;H&gt; *nod,H *key){\n        if(head == NULL)\n            head = new NodeList&lt;H&gt;(NULL,key);\n        if(nod == NULL){\n             return new NodeList&lt;H&gt;(NULL,key);\n        }\n        else{\n            nod-&gt;setNext(insTail(nod-&gt;getNext(),key));\n            return nod;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++", "mfc", "c++-cli", "clr", "wrapper"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505326220, "post_id": 46204138, "comment_id": 79371495, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 179, "user_id": 850193, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dca9bae19084806f46bdab2b8ca21925?s=128&d=identicon&r=PG", "display_name": "Bagaboo", "link": "https://stackoverflow.com/users/850193/bagaboo"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505326435, "post_id": 46204138, "comment_id": 79371612, "body": "I have seen it and tried to read it. Great and detailed explanation, maybe too detailed, unfortunately there is still some missing detail that i have failed to understand. I have based most of the implementation on it, but i must have missed something."}], "answers": [{"tags": [], "owner": {"reputation": 462, "user_id": 8547128, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-VdtX8-xzgi4/AAAAAAAAAAI/AAAAAAAAADY/Qpj1DlW3s4M/photo.jpg?sz=128", "display_name": "Ali Sepehri-Amin", "link": "https://stackoverflow.com/users/8547128/ali-sepehri-amin"}, "is_accepted": false, "score": 0, "last_activity_date": 1505326643, "creation_date": 1505326643, "answer_id": 46204370, "question_id": 46204138, "link": "https://stackoverflow.com/questions/46204138/native-to-c-cli-unresolved-symboles/46204370#46204370", "title": "Native to C++ CLI unresolved symboles", "body": "<p>You don't need your step 4. Also, try to don't use Precompiled headers like <code>stdafx.h</code> in your project, Go to C/C++ -> Precompiled Headers -> Not using precompiled headers and Check Linker -> Additional Dependecies -> <strong>Inherit from parent or project defaults</strong>. Finally, check the error message link if it's point to windows library use missing try to include <strong>.lib</strong> library using <code>#pragma comment (lib, \"yourlib.lib\")</code></p>\n"}], "owner": {"reputation": 179, "user_id": 850193, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dca9bae19084806f46bdab2b8ca21925?s=128&d=identicon&r=PG", "display_name": "Bagaboo", "link": "https://stackoverflow.com/users/850193/bagaboo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505326965, "creation_date": 1505325841, "last_edit_date": 1505326965, "question_id": 46204138, "link": "https://stackoverflow.com/questions/46204138/native-to-c-cli-unresolved-symboles", "title": "Native to C++ CLI unresolved symboles", "body": "<p>We have an excellent MFC/C++ project that handles the data to and from a legacy database. All classes are exported with AFX_EXT_CLASS (which is dllexport if i am not misunderstanding it). I am currently writing a wrapper so that we can use it in C# applications. This is my first real wrapper, so please bear with me. </p>\n\n<p>This is what i have done:</p>\n\n<ol>\n<li>Compiled the project with /Yc /Gm- /Clr. It produces a .lib and a .dll. </li>\n<li>I have access to the source so, i added the path of the header files in my C++/Cli project. It therefore recognises the types. </li>\n<li>I added the .lib to the linker input in the C++/Cli project.</li>\n<li>I have added the .dll as a reference in the C++/Cli project. </li>\n<li>In the C++/Cli project, i have a stdafx.h that looks like the stdafx.h in the native project. </li>\n</ol>\n\n<p>If i understand this correctly, the .lib is the implementation, the .dll is the \"wrapper\" to be able to reference it as a .net-dll, and the header files are the class definition. </p>\n\n<p>Now, i can define native objects in the C++/Cli project, but when i access functions therein and try to build it, it throws external reference not found errors on the objects that i am trying to define. </p>\n\n<p>This is understandable because it can not know that the header files point to the implementation in the .lib. The header files are used as is. </p>\n\n<p>What am i doing wrong? Am i supposed to point at the header files? Should it not use the .dll to find the class definitions that are implemented in the .lib file? Should i create a .def file to point at the library?</p>\n\n<p>There seem to be a missing piece to this puzzle and i am expecting to experience an aha-moment any moment now... </p>\n\n<p>Please note that this is not a general linkage question, it is specifically about the practical use of AFX_EXT_CLASS exported classes, MFC and C++/CLI. </p>\n\n<p>Cheers and thank you</p>\n"}, {"tags": ["c++", "c++11", "visual-c++", "unique-ptr"], "comments": [{"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1505326497, "post_id": 46204082, "comment_id": 79371653, "body": "Why don&#39;t you just do <code>MyType* pv = u.get();</code>? <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr/get\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/memory/unique_ptr/get</a>"}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 0, "creation_date": 1505326761, "post_id": 46204082, "comment_id": 79371824, "body": "What do you mean by <i>works/doesn&#39;t work</i> for each of the above? Are you trying to get a pointer to the object owned by the <code>unique_ptr</code> in each case? If yes, what&#39;s with the <code>MyType**</code> casts? Just use <code>void *pv = u.get();</code> A <code>unique_ptr</code> that has a stateless deleter, which yours does, typically contains just a pointer to the managed object, which is why your type punning seems to work."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1505326892, "post_id": 46204082, "comment_id": 79371909, "body": "You are just lucky because <code>std::unique_ptr</code> is likely a struct with a single pointer attribute, and it happens that the address of an object of type <code>std::unique_ptr</code> is the same as the address of the first attribute of this object, which is the pointer."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1505327152, "post_id": 46204082, "comment_id": 79372057, "body": "Ditch the unsafe C-style casts. If you <i>must</i> cast (always try <i>not</i> to), use C++ casts. But it&#39;s not even clear that what you really want is a cast."}, {"owner": {"reputation": 707, "user_id": 443766, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ef7152b44064acbe1d13ee110c59263?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/443766/matthew"}, "edited": false, "score": 0, "creation_date": 1505330245, "post_id": 46204082, "comment_id": 79373754, "body": "The code I&#39;m writing is not doing this casting/type punning. It is generic serialization code that does the C-style casts. It was made not made for smart pointers, It is legacy code that is not going to change in the near future. I just tried using a unique_ptr in a struct that goes through the serialization. From the answers so far, it sounds like I should stick with raw pointers and a destructor."}, {"owner": {"reputation": 11569, "user_id": 502399, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccf39757e9c47ae99df42bdb286c6e5c?s=128&d=identicon&r=PG", "display_name": "Tavian Barnes", "link": "https://stackoverflow.com/users/502399/tavian-barnes"}, "edited": false, "score": 0, "creation_date": 1505336083, "post_id": 46204082, "comment_id": 79376698, "body": "This happens to work because the representation of <code>unique_ptr</code> in memory, with the default deleter, is the same as a raw pointer, in common implementations.  Absolutely nothing guarantees that though, and furthermore there are probably aliasing issues even if the representation is given."}], "answers": [{"comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1505327973, "post_id": 46204639, "comment_id": 79372524, "body": "I&#39;m under the impression that the behavior here is <i>unspecified</i>, not <i>undefined</i>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1505328211, "post_id": 46204639, "comment_id": 79372658, "body": "@Xirema Dereferencing a pointer to an object that isn&#39;t that object?  That triggers undefined behavior.  I suppose a particular unique ptr implementation could be standard layout with a prefix compatible with a <code>T*</code> and guaranteed by the compiler&#39;s standard library to be like that."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1505327767, "creation_date": 1505327767, "answer_id": 46204639, "question_id": 46204082, "link": "https://stackoverflow.com/questions/46204082/how-does-casting-from-a-void-of-unique-ptrt-to-t-work/46204639#46204639", "title": "How does casting from a void* of unique_ptr&lt;T&gt; to T** work?", "body": "<p>This is undefined behavior that happens to work because the unique pointer happens to store only a single pointer as its state, and that state is a pointer to <code>T</code>.</p>\n\n<p>Undefined behavior can do anything, including time travel and format your hard drive.  I know people say this and others think it is a joke, but these are actually true statements you can experimentally verify.</p>\n\n<p>As it happens, your undefined behavior here has reinterpreted some memory in a way that \"works\".</p>\n\n<p>You cannot serialize/deserialize non-pod structures in a defined way using your library.  You can hack it to work, but any compiler update (even a compiler flag update!) could suddenly behave completely differently.</p>\n\n<p>Consider having a structure for serialization/deserialization, and another for runtime use.  Marshall from one to the other.  Yes, this sucks.</p>\n"}, {"comments": [{"owner": {"reputation": 707, "user_id": 443766, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ef7152b44064acbe1d13ee110c59263?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/443766/matthew"}, "edited": false, "score": 0, "creation_date": 1505334931, "post_id": 46204656, "comment_id": 79376148, "body": "You are right. I tested my SSCCE on a couple of online compilers, and they behaved exactly the same as my VS2015, but in the end it is UB and should be avoided."}], "tags": [], "owner": {"reputation": 2033, "user_id": 5578644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cff0d89f9814ec52fbb2854dea0ada?s=128&d=identicon&r=PG&f=1", "display_name": "TimVdG", "link": "https://stackoverflow.com/users/5578644/timvdg"}, "is_accepted": false, "score": 1, "last_activity_date": 1505327829, "creation_date": 1505327829, "answer_id": 46204656, "question_id": 46204082, "link": "https://stackoverflow.com/questions/46204082/how-does-casting-from-a-void-of-unique-ptrt-to-t-work/46204656#46204656", "title": "How does casting from a void* of unique_ptr&lt;T&gt; to T** work?", "body": "<p>Essentially you are doing something like this:</p>\n\n<pre><code>std::unique_ptr&lt;MyType&gt; up = ...;\nMyType* p = *reinterpret_cast&lt;MyType**&gt;(&amp;up);\n</code></pre>\n\n<p>With some detours and C-style casts. You take the pointer to the <code>unique_ptr</code> and reinterpret it as a pointer to pointer of <code>MyType</code></p>\n\n<p>This is pure luck and results in undefined behavior, you shouldn't use this type of code for any reason. If you need the internal pointer use the <code>get()</code> method on unique_ptr.</p>\n"}, {"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 2, "last_activity_date": 1505327900, "creation_date": 1505327900, "answer_id": 46204681, "question_id": 46204082, "link": "https://stackoverflow.com/questions/46204082/how-does-casting-from-a-void-of-unique-ptrt-to-t-work/46204681#46204681", "title": "How does casting from a void* of unique_ptr&lt;T&gt; to T** work?", "body": "<p>This is basically just you getting lucky.</p>\n\n<p>In the ABI of your particular compiler, the <code>T*</code> that stores the object maintained by the <code>unique_ptr</code> is the first member of the object, so it has the same address as the object itself. In much the same way as this example:</p>\n\n<pre><code>struct container {\n    int val;\n};\n\nint main() {\n    container c{15};\n\n    intptr_t val1 = reinterpret_cast&lt;intptr_t&gt;(&amp;c);\n    intptr_t val2 = reinterpret_cast&lt;intptr_t&gt;(&amp;(c.val));\n\n    assert(val1 == val2); //will pretty much always be true\n}\n</code></pre>\n\n<p>Of course, <strong>this is not behavior you should depend on!</strong> It's unspecified by the Standard, and could change if the vendor decides they have a better format for storing pointers inside <code>std::unique_ptr</code>.</p>\n"}], "owner": {"reputation": 707, "user_id": 443766, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ef7152b44064acbe1d13ee110c59263?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/443766/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "accepted_answer_id": 46204681, "answer_count": 3, "score": 0, "last_activity_date": 1505332819, "creation_date": 1505325598, "last_edit_date": 1505332819, "question_id": 46204082, "link": "https://stackoverflow.com/questions/46204082/how-does-casting-from-a-void-of-unique-ptrt-to-t-work", "title": "How does casting from a void* of unique_ptr&lt;T&gt; to T** work?", "body": "<p>I was surprised by the results I'm seeing in VC++ 2015, and need help understanding how it works.</p>\n\n<pre><code>struct MyType\n{\n  MyType(int x_) : x(x_) { }\n  int x;\n};\n\nauto u = std::make_unique&lt;MyType&gt;(10);\nvoid* pv = &amp;u;\n</code></pre>\n\n<p>This obviously fails because <code>u</code>'s address is not a pointer to <code>MyType</code>:</p>\n\n<pre><code>MyType *pM = (MyType*)pv;\n</code></pre>\n\n<p>But this works, <code>pM2</code> gets the address of the <code>MyType</code> object stored in <code>u</code>:</p>\n\n<pre><code>MyType** ppM = (MyType**)pv;\nMyType* pM2 = *ppM;\n</code></pre>\n\n<p>Is there anything in the standard that says this is supposed to work? Or is it only working due to a non-portable implementation detail of my compiler? Something that allows me to treat <code>unique_ptr</code> like a pointer-to-pointer in a round about way?</p>\n\n<p>And before you say, \"that's stupid, don't use <code>void*</code> or C-style casts\", please understand that I'm working with legacy code that handles serialization of structs through void pointers and offsets to struct members. I can't change that part right now. But I want to use a <code>unique_ptr</code> for a struct member to simplify memory ownership and cleanup. And I'd like to know how fragile my <code>unique_ptr</code> is in this legacy environment.</p>\n"}, {"tags": ["c++", "algorithm", "templates", "optimization"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1505325526, "post_id": 46204012, "comment_id": 79371126, "body": "The short answer: no there isn&#39;t. Sure, you can restructure it so that it&#39;s ugly in some other way. Perhaps it can be cleaned up with some macros. But this is fundamental to C++. Something, somewhere, needs to generate all this code bloat, for optimization purposes, and conditionally execute it. The End."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1505325620, "post_id": 46204012, "comment_id": 79371171, "body": "Out of curiosity, if you make the the parameters <code>const</code> do it help at all?"}, {"owner": {"reputation": 2476, "user_id": 677202, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5544d46b2d8a81515a4704b3e2048e38?s=128&d=identicon&r=PG", "display_name": "nosbor", "link": "https://stackoverflow.com/users/677202/nosbor"}, "edited": false, "score": 0, "creation_date": 1505325711, "post_id": 46204012, "comment_id": 79371219, "body": "Unfortunately the const don&#39;t help. I was thinking about metaprogamming solution but I don&#39;t have experience in that."}, {"owner": {"reputation": 12925, "user_id": 4668606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9l7Y.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4668606/paul"}, "edited": false, "score": 0, "creation_date": 1505325912, "post_id": 46204012, "comment_id": 79371336, "body": "It should be completely sufficient to create a mapping from the input to the respective output (well, since the method is <code>void</code>, side-effects would be more correct here). Conversion of a pair of integers in limited ranges into a single integer is fairly simple to achieve and in combination with an array as lookup-structure should do the job (depends on the application of the code you presented though)."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1505326502, "post_id": 46204012, "comment_id": 79371655, "body": "@SamVarshavchik No, this is C++.  You can generate quadratic amounts of code and dispatch to it easily."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1505326723, "post_id": 46204012, "comment_id": 79371787, "body": "Why is is 10x slower as a function?  What does your release build profiling tell you is the bottleneck?  Is it memory accesses, branches, etc.  Your assertion of a 10x slow down on function calls vs templates is quite the claim and seems to say that process() is very, very fast per iteration."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1505327055, "post_id": 46204012, "comment_id": 79371993, "body": "Looks like XY problem and problem is in rewriting of template to regular function"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1505327139, "post_id": 46204012, "comment_id": 79372048, "body": "@Slava not really, I&#39;ve seen many problems just like this.  A classic example is per-pixel operations.  Or many kinds of signal processing, where a fixed width window leads to a much more efficient implementation (and the compiler can take nearly identical code, and with the fixed width window optimize it a ridiculous amount)."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1505327370, "post_id": 46204012, "comment_id": 79372191, "body": "@Yakk cascade if with 100 steps would be faster than one short function vs template? I would like to see that implementation."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1505327492, "post_id": 46204012, "comment_id": 79372264, "body": "@Slava First, 100 steps of an if is going to be what, a few milliseconds even with horrible branch prediction?  Why do you think the function is <i>short</i> in time it takes to run?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1505327597, "post_id": 46204012, "comment_id": 79372313, "body": "@Yakk per-pixel operation is a long function? Anyway I would like to see actual code where <code>templated</code> would be 10 times faster."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1505328087, "post_id": 46204012, "comment_id": 79372589, "body": "@Slava No, the per-pixel operation might be executed a million or billion times in a loop.  The values being compile time constants change how things work.  You can write a branch-full per-pixel operation with a myraid of ifs, and if the things being branched on are constant the compiler dead-code eliminates every branch, and then can often vectorize the adjacent per-pixel calls."}], "answers": [{"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 8, "last_activity_date": 1505326309, "creation_date": 1505326309, "answer_id": 46204270, "question_id": 46204012, "link": "https://stackoverflow.com/questions/46204012/optimize-c-template-executions/46204270#46204270", "title": "Optimize C++ template executions", "body": "<p>Like this.</p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;utility&gt;\n\ntemplate&lt;int PARAM1, int PARAM2&gt;\nvoid process() {\n    // processing the data\n}\n\n// make a jump table to call process&lt;X, Y&gt; where X is known and Y varies    \ntemplate&lt;std::size_t P1, std::size_t...P2s&gt;\nconstexpr auto make_table_over_p2(std::index_sequence&lt;P2s...&gt;)\n{\n    return std::array&lt;void (*)(), sizeof...(P2s)&gt;\n    {\n        &amp;process&lt;int(P1), int(P2s)&gt;...\n    };\n}\n\n// make a table of jump tables to call process&lt;X, Y&gt; where X and Y both vary    \ntemplate&lt;std::size_t...P1s, std::size_t...P2s&gt;\nconstexpr auto make_table_over_p1_p2(std::index_sequence&lt;P1s...&gt;, std::index_sequence&lt;P2s...&gt; p2s)\n{\n    using element_type = decltype(make_table_over_p2&lt;0&gt;(p2s));\n    return std::array&lt;element_type, sizeof...(P1s)&gt;\n    {\n        make_table_over_p2&lt;P1s&gt;(p2s)...\n    };\n}\n\n\nvoid processTheData (int param1, int param2) { // wrapper\n\n    // make a 10x10 jump table\n    static const auto table = make_table_over_p1_p2(\n        std::make_index_sequence&lt;10&gt;(), \n        std::make_index_sequence&lt;10&gt;()\n    ) ;\n\n    // todo - put some limit checks here\n\n    // dispatch\n    table[param1][param2]();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1505326754, "post_id": 46204298, "comment_id": 79371814, "body": "ow! my eyes hurt :)"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1505326855, "post_id": 46204298, "comment_id": 79371877, "body": "Ugh - I don&#39;t even know if I trust OP&#39;s initial assertion of where the bottlenecks are and this code... hide it 3 layers deep in headers so I never need to see it again :)"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1505327022, "post_id": 46204298, "comment_id": 79371975, "body": "@MichaelDorgan The other way that I think I almost prefer is <code>switch_upto&lt;max_factor_1&gt;(factor1)</code> returning a lambda that in turn does the magic switch.  Then I could get <code>switch_upto&lt;max_factor_1, max_factor_2&gt;(factor1, factor2)</code> and pass that a lambda that gets passed 2 arguments..."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1505327392, "post_id": 46204298, "comment_id": 79372199, "body": "@Yakk I actually think there should be language feature or standard idiom for this kind of thing. It seems to come up a lot."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 4, "last_activity_date": 1505326840, "last_edit_date": 1505326840, "creation_date": 1505326406, "answer_id": 46204298, "question_id": 46204012, "link": "https://stackoverflow.com/questions/46204012/optimize-c-template-executions/46204298#46204298", "title": "Optimize C++ template executions", "body": "<p>This is what I call the matic switch.  It takes a runtime value (within a specified range), and turns it into a compile time value.</p>\n\n<pre><code>namespace details \n{\n  template&lt;std::size_t I&gt;\n  using index_t = std::integral_constant&lt;std::size_t, I&gt;;\n\n  template&lt;class F&gt;\n  using f_result = std::result_of_t&lt; F&amp;&amp;(index_t&lt;0&gt;) &gt;;\n  template&lt;class F&gt;\n  using f_ptr = f_result&lt;F&gt;(*)(F&amp;&amp; f);\n  template&lt;class F, std::size_t I&gt;\n  f_ptr&lt;F&gt; get_ptr() {\n    return [](F&amp;&amp; f)-&gt;f_result&lt;F&gt; {\n      return std::forward&lt;F&gt;(f)(index_t&lt;I&gt;{});\n    };\n  }\n  template&lt;class F, std::size_t...Is&gt;\n  auto dispatch( F&amp;&amp; f, std::size_t X, std::index_sequence&lt;Is...&gt; ) {\n    static const f_ptr&lt;F&gt; table[]={\n      get_ptr&lt;F, Is&gt;()...\n    };\n    return table[X](std::forward&lt;F&gt;(f));\n  }\n}\ntemplate&lt;std::size_t max, class F&gt;\ndetails::f_result&lt;F&gt;\ndispatch( F&amp;&amp; f, std::size_t I ) {\n  return details::dispatch( std::forward&lt;F&gt;(f), I, std::make_index_sequence&lt;max&gt;{} );\n}\n</code></pre>\n\n<p>what this does is build a jump table to convert runtime data to a compile time constant.  I use a lambda, because it makes it nice and generic, and pass it an integral constant.  An integral constant is a runtime stateless object whose type carries the constant with it.</p>\n\n<p>An example use:</p>\n\n<pre><code>template&lt;std::size_t a, std::size_t b&gt;\nvoid process() {\n    static_assert( sizeof(int[a+1]) + sizeof(int[b+1]) &gt;= 0 );\n}\n\nconstexpr int max_factor_1 = 10;\nconstexpr int max_factor_2 = 10;\n\nint main() {\n    int factor1 = 1;\n    int factor2 = 5;\n\n    dispatch&lt;max_factor_1&gt;(\n      [factor2](auto factor1) {\n        dispatch&lt;max_factor_2&gt;(\n          [factor1](auto factor2) {\n            process&lt; decltype(factor1)::value, decltype(factor2)::value &gt;();\n          },\n          factor2\n        );\n      },\n      factor1\n    );\n}\n</code></pre>\n\n<p>where <code>max_factor_1</code> and <code>max_factor_2</code> are <code>constexpr</code> values or expressions.</p>\n\n<p>This uses C++14 for auto lambdas and constexpr implicit cast from integral constants.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/fd763174759f2bea\" rel=\"nofollow noreferrer\">Live example</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "is_accepted": false, "score": 0, "last_activity_date": 1505332013, "creation_date": 1505332013, "answer_id": 46205706, "question_id": 46204012, "link": "https://stackoverflow.com/questions/46204012/optimize-c-template-executions/46205706#46205706", "title": "Optimize C++ template executions", "body": "<p>This is what I came up with. It uses less fancy features (only <code>enable_if</code>, no variadic templates or function pointers) but it is also less generic. Pasting the code into <a href=\"https://godbolt.org/g/XXWJUr\" rel=\"nofollow noreferrer\">godbolt</a> indicates that compilers are able to optimize this completely away for the example code which may have a performance advantage in the real code.</p>\n\n<pre><code>#include &lt;type_traits&gt;\n\ntemplate &lt;int param1, int param2&gt;\nvoid process() {\n    static_assert(sizeof(int[param1 + 1]) + sizeof(int[param2 + 1]) &gt; 0);\n}\n\ntemplate &lt;int limit2, int param1, int param2&gt;\nstd::enable_if_t&lt;(param2 &gt; limit2)&gt; pick_param2(int) {\n    static_assert(\"Invalid value for parameter 2\");\n}\n\ntemplate &lt;int limit2, int param1, int param2&gt;\nstd::enable_if_t&lt;param2 &lt;= limit2&gt; pick_param2(int p) {\n    if (p &gt; 0) {\n        pick_param2&lt;limit2, param1, param2 + 1&gt;(p - 1);\n    } else {\n        process&lt;param1, param2&gt;();\n    }\n}\n\ntemplate &lt;int limit1, int limit2, int param&gt;\nstd::enable_if_t&lt;(param &gt; limit1)&gt; pick_param1(int, int) {\n    static_assert(\"Invalid value for parameter 1\");\n}\n\ntemplate &lt;int limit1, int limit2, int param&gt;\nstd::enable_if_t&lt;param &lt;= limit1&gt; pick_param1(int p1, int p2) {\n    if (p1 &gt; 0) {\n        pick_param1&lt;limit1, limit2, param + 1&gt;(p1 - 1, p2);\n    } else {\n        pick_param2&lt;limit2, param, 0&gt;(p2);\n    }\n}\n\ntemplate &lt;int limit_param1, int limit_param2&gt;\nvoid pick_params(int param1, int param2) {\n    pick_param1&lt;limit_param1, limit_param2, 0&gt;(param1, param2);\n}\n\nint main() {\n    int p1 = 3;\n    int p2 = 5;\n    pick_params&lt;10, 10&gt;(p1, p2);\n}\n</code></pre>\n\n<p>I'd be interested in profiling results.</p>\n"}], "owner": {"reputation": 2476, "user_id": 677202, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5544d46b2d8a81515a4704b3e2048e38?s=128&d=identicon&r=PG", "display_name": "nosbor", "link": "https://stackoverflow.com/users/677202/nosbor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 46204270, "answer_count": 3, "score": 3, "last_activity_date": 1505332013, "creation_date": 1505325400, "question_id": 46204012, "link": "https://stackoverflow.com/questions/46204012/optimize-c-template-executions", "title": "Optimize C++ template executions", "body": "<p>I am working on project where the performance is critical. The application is processing a huge amount of data. Code is written in C++ and I need to do some changes. </p>\n\n<p>There is given following code (It is NOT my code and I simplified it to minimum):</p>\n\n<pre><code>void process&lt;int PARAM1, int PARAM2&gt;() {\n    // processing the data\n}\n\nvoid processTheData (int param1, int param2) { // wrapper\n\n    if (param1 == 1 &amp;&amp; param2 == 1) { // Ugly looking block of if's\n        process&lt;1, 1&gt;();\n    else if(param1 == 1 &amp;&amp; param2 == 2) {\n        process&lt;1, 2&gt;();\n    else if(param1 == 1 &amp;&amp; param2 == 3) {\n        process&lt;1, 3&gt;();\n    else if(param1 == 1 &amp;&amp; param2 == 4) {\n        process&lt;1, 4&gt;();\n    else if(param1 == 2 &amp;&amp; param2 == 1) {\n        process&lt;2, 1&gt;();\n    else if(param1 == 2 &amp;&amp; param2 == 2) {\n        process&lt;2, 2&gt;();\n    else if(param1 == 2 &amp;&amp; param2 == 3) {\n        process&lt;2, 3&gt;();\n    else if(param1 == 2 &amp;&amp; param2 == 4) {\n        process&lt;2, 4&gt;();\n    }   // and so on....\n\n}\n</code></pre>\n\n<p>And the main function:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n\n    factor1 = atoi(argv[1]);\n    factor2 = atoi(argv[2]);\n\n    // choose some optimal param1 and param2\n    param1 = choseTheOptimal(factor1, factor2);\n    param2 = choseTheOptimal(factor1, factor2);\n\n    processTheData(param1, param2); //start processing\n\n    return 0;\n}\n</code></pre>\n\n<p>Hopefully the code looks clear. </p>\n\n<p>The functions:</p>\n\n<ul>\n<li><strong>process</strong> is the core function that is processing the data,</li>\n<li><strong>processTheData</strong> is a wrapper of the process function.</li>\n</ul>\n\n<p>There is a limited number of values that the params (<em>param1</em> and <em>param2</em>) takes (Let's say about 10 x 10).</p>\n\n<p>The values of <em>param1</em> and <em>param2</em> are NOT known before execution.</p>\n\n<p>If I simply rewrite the <strong>process</strong> function so it uses the function parameters instead of template constants (means <em>process(int PARAM1, int PARAM2)</em>) then the processing is about 10 times slower.</p>\n\n<p>Because of the above the <em>PARAM1</em> and <em>PARAM2</em> must be the constant of <strong>process</strong> function.</p>\n\n<p>Is there any smart way to get rid of this ugly block of if's located in <strong>processTheData</strong> function?</p>\n"}, {"tags": ["c++", "jsoncpp"], "answers": [{"tags": [], "owner": {"reputation": 2374, "user_id": 8491726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550562035006492/picture?type=large", "display_name": "Artemy Vysotsky", "link": "https://stackoverflow.com/users/8491726/artemy-vysotsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1505329246, "creation_date": 1505329246, "answer_id": 46205021, "question_id": 46203948, "link": "https://stackoverflow.com/questions/46203948/reading-array-of-the-json-in-jsoncpp/46205021#46205021", "title": "Reading Array of the json in JsonCpp", "body": "<ol>\n<li><p>your root contains 2 elements \"return\" and \"entries\" so or\n<code>root[\"return\"]</code> or  <code>root[\"entries\"]</code></p></li>\n<li><p>Then - array contains a list of members - so even if it only one entry - you still have to get it.</p></li>\n<li><p>if value is quoted - it is string - you cannot use getInt on it. For example getInt is applicable to \"status\" not \"sender\"</p></li>\n</ol>\n\n<p>Here is the whole sample</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;json/json.h&gt;\nint main()\n{\n\n    std::string s = R\"({\n        \"return\":\n        {\n        \"status\":200,\n        \"message\":\"Accepted\"\n        },\n        \"entries\":\n        [\n        {\n        \"messageid\":185002992,\n        \"message\":\"CplusItsGood\",\n        \"status\":1,\n        \"statustext\":\"test\",\n        \"sender\":\"1234567\",\n        \"receptor\":\"123456789\",\n        \"date\":1234,\n        \"cost\":140\n        }\n        ]\n    })\";\n\n\n    Json::Reader reader;\n    Json::Value root;\n\n    reader.parse(s, root, false);\n\n    auto entriesArray = root[\"entries\"];\n\n    auto firstelem = entriesArray[0];\n    std::string sender = firstelem[\"sender\"].asString();\n    int i = std::stoi(sender);\n    std::cout &lt;&lt; \"array:\" &lt;&lt; entriesArray &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"element:\" &lt;&lt; firstelem &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"value:\" &lt;&lt; sender &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"parsed value:\" &lt;&lt; i &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>array:[\n        {\n                \"cost\" : 140,\n                \"date\" : 1234,\n                \"message\" : \"CplusItsGood\",\n                \"messageid\" : 185002992,\n                \"receptor\" : \"123456789\",\n                \"sender\" : \"1234567\",\n                \"status\" : 1,\n                \"statustext\" : \"test\"\n        }\n]\nelement:{\n        \"cost\" : 140,\n        \"date\" : 1234,\n        \"message\" : \"CplusItsGood\",\n        \"messageid\" : 185002992,\n        \"receptor\" : \"123456789\",\n        \"sender\" : \"1234567\",\n        \"status\" : 1,\n        \"statustext\" : \"test\"\n}\nvalue:1234567\nparsed value:1234567\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 8547128, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-VdtX8-xzgi4/AAAAAAAAAAI/AAAAAAAAADY/Qpj1DlW3s4M/photo.jpg?sz=128", "display_name": "Ali Sepehri-Amin", "link": "https://stackoverflow.com/users/8547128/ali-sepehri-amin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11102, "favorite_count": 2, "accepted_answer_id": 46205021, "answer_count": 1, "score": 0, "last_activity_date": 1505329246, "creation_date": 1505325153, "question_id": 46203948, "link": "https://stackoverflow.com/questions/46203948/reading-array-of-the-json-in-jsoncpp", "title": "Reading Array of the json in JsonCpp", "body": "<p>I tried to write a simple JSON reader for my program then I use JsonCpp. I have this JSON from my web server:</p>\n\n<pre><code>{\n  \"return\":\n  {\n    \"status\":200,\n    \"message\":\"Accepted\"\n  },\n  \"entries\":\n  [\n   {\n     \"messageid\":185002992,\n     \"message\":\"CplusItsGood\",\n     \"status\":1,\n     \"statustext\":\"test\",\n     \"sender\":\"1234567\",\n     \"receptor\":\"123456789\",\n     \"date\":1234,\n     \"cost\":140\n   }\n  ]\n}\n</code></pre>\n\n<p>And this is my C++ code:</p>\n\n<pre><code>    Json::Reader reader;\n    Json::Value root;\n\n    reader.parse(jsonContext, root, false);\n\n    const Json::Value entriesArray = root[\"return\"][\"entries\"];\n\n    int A = entriesArray[\"sender\"].asInt();\n\n    cout &lt;&lt; A;\n</code></pre>\n\n<p>It's print only <strong>0</strong>, I can't read the <strong><code>sender</code></strong> or any other element of the <code>entries</code> array.\nI want get the value of the <code>cost</code> or <code>sender</code> for example.</p>\n\n<p>How can I do that?</p>\n"}, {"tags": ["c++", "opencv", "camera"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1505330496, "post_id": 46203828, "comment_id": 79373876, "body": "Found <a href=\"http://answers.opencv.org/question/96137/is-there-any-range-of-values-for-the-exposure-flag/\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1263, "user_id": 5208061, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tBVze.jpg?s=128&g=1", "display_name": "Saeed Masoomi", "link": "https://stackoverflow.com/users/5208061/saeed-masoomi"}, "is_accepted": true, "score": 0, "last_activity_date": 1516564470, "creation_date": 1516564470, "answer_id": 48371060, "question_id": 46203828, "link": "https://stackoverflow.com/questions/46203828/how-can-set-exposure-time-for-dmm-27uj003-ml-camera-using-opencv/48371060#48371060", "title": "How can set exposure time for DMM 27UJ003-ML camera using opencv", "body": "<p>If you use Linux based machine you can install a package that will help you about that, which it's name is v4l2ucp,this package can be install by below command in ubuntu</p>\n\n<pre><code>sudo apt install v4l2ucp\n</code></pre>\n\n<p>this is a package that give you graphical control on camera with using great <code>v4l2</code> package <em>(by installing v4l2ucp there is no need to install <code>v4l2</code> again)</em>. if you can change exposure time in the <code>v4l2ucp</code> then you can use <code>v4l2</code> inside of your program.</p>\n\n<p>you can get whole information about your camera by below command in ubuntu terminal.</p>\n\n<pre><code>v4l2-ctl --all\n</code></pre>\n\n<p>after knowing which parameters are available for you by using above command you can change value of that parameter. for example of my output is like below</p>\n\n<pre><code> brightness (int)    : min=-10 max=10 step=1 default=0 value=0\n</code></pre>\n\n<p>you can see there is a variable of camera,which it's name is brightness and defalut value of that is 0 and there is boundary for value (min=-10, and max =10) so how can I set this value to 10 for instance? I can do this by below command(please test it by open camera)</p>\n\n<pre><code>v4l2-ctl --set-ctrl brightness=10\n</code></pre>\n\n<p>after doing that in terminal you can see brightness changes in camera.</p>\n\n<p>So how we could use v4l2 command inside <code>Qt</code> programming? by using <code>QProcess</code> class, this command let you to run terminal commands inside of Qt program. I write a simple example</p>\n\n<pre><code> #include &lt;QProcess&gt;\n int main()\n {\n     QProcess process;\n     process.start(\"v4l2-ctl --set-ctrl brightness=10\");\n     pro.waitForFinished(-1);\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8426450, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ehk-hxGdbXE/AAAAAAAAAAI/AAAAAAAAAB8/Axn8a0DqzVs/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/8426450/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1537499484, "last_edit_date": 1537499484, "creation_date": 1537498366, "answer_id": 52435952, "question_id": 46203828, "link": "https://stackoverflow.com/questions/46203828/how-can-set-exposure-time-for-dmm-27uj003-ml-camera-using-opencv/52435952#52435952", "title": "How can set exposure time for DMM 27UJ003-ML camera using opencv", "body": "<p>Add the following code at the beginning:</p>\n\n<pre><code>cap.set(CV_CAP_PROP_AUTO_EXPOSURE,0.25);\n</code></pre>\n\n<p><code>0.25</code> means 'manual mode'.</p>\n"}], "owner": {"reputation": 1263, "user_id": 5208061, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tBVze.jpg?s=128&g=1", "display_name": "Saeed Masoomi", "link": "https://stackoverflow.com/users/5208061/saeed-masoomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 48371060, "answer_count": 2, "score": 1, "last_activity_date": 1537499484, "creation_date": 1505324643, "last_edit_date": 1505329694, "question_id": 46203828, "link": "https://stackoverflow.com/questions/46203828/how-can-set-exposure-time-for-dmm-27uj003-ml-camera-using-opencv", "title": "How can set exposure time for DMM 27UJ003-ML camera using opencv", "body": "<p>I'm using a camera  which is called <code>DMM 27UJ003-ML</code>and the documents are available via <a href=\"https://www.theimagingsource.com/products/board-cameras/usb-3.0-monochrome/dmm27uj003ml/\" rel=\"nofollow noreferrer\">this link</a>. This camera has some features such as  <code>Brightness</code> which can be set in <code>OpenCV</code>, see the following code for instance</p>\n\n<pre><code>//Header \n#include &lt;opencv2/opencv.hpp&gt;\n#include &lt;iostream&gt;\n\nusing namespace cv;\nusing namespace std;\n\nint main()\n{\n   VideoCapture cap(0);   //Access to camera with ID = 0\n   double brightness = cap.get(CV_CAP_PROP_BRIGHTNESS); // get value of brightness\n   cout&lt;&lt;brightness&lt;&lt;endl;   //print brightness value in console\n}\n</code></pre>\n\n<p>result is <code>0.5</code> and it's OK,I can set <code>Brightness</code> as well, but if i want to change <code>Exposure time</code> the problem will be appear!!(<code>Exposure time</code> is another camera property that can be variable)</p>\n\n<pre><code>int main()\n{\n    VideoCapture cap(0);\n    cap.set(CV_CAP_PROP_EXPOSURE,0.1);\n}\n</code></pre>\n\n<p>But<code>Exposure time</code> can't be set in appropriate way and if want to use <code>get</code> method to knowing what set as <code>Exposure time</code> value,result is strange</p>\n\n<pre><code>VideoCapture cap(0);\ndouble Exposure = cap.get(CV_CAP_PROP_EXPOSURE);\ncout&lt;&lt;Exposure&lt;&lt;endl;\n</code></pre>\n\n<p>result of <code>Exposure</code> is <code>inf</code> and camera doesn't response to outside environment(it seems that <code>Exposure time</code> is <code>inf</code> actually) so the only way to reset <code>Exposure time</code>is software that company gave to me and i don't know how i can set this feature in <code>opencv</code></p>\n\n<p>thanks for your help. </p>\n"}, {"tags": ["c++", "visual-c++", "visual-studio-2017"], "comments": [{"owner": {"reputation": 4567, "user_id": 1320751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eee0011ba2ca995b31e464fc2e2ad885?s=128&d=identicon&r=PG", "display_name": "Anon Mail", "link": "https://stackoverflow.com/users/1320751/anon-mail"}, "edited": false, "score": 0, "creation_date": 1505323756, "post_id": 46203575, "comment_id": 79370095, "body": "You don&#39;t state what error you are getting?"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505323987, "post_id": 46203575, "comment_id": 79370230, "body": "<code>#define TEA_API __declspec(dllexport) &lt;-- Compiling the lib</code> I suspect you don&#39;t have these statement verbatim there, no? Use comment to highlight that."}, {"owner": {"reputation": 165, "user_id": 3442617, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003323594515/picture?type=large", "display_name": "Bretzelus", "link": "https://stackoverflow.com/users/3442617/bretzelus"}, "edited": false, "score": 0, "creation_date": 1505324614, "post_id": 46203575, "comment_id": 79370574, "body": "Anon Mail : LNKC2019. It&#39;s &quot;embedded&quot; as comment in the code...:)"}, {"owner": {"reputation": 165, "user_id": 3442617, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003323594515/picture?type=large", "display_name": "Bretzelus", "link": "https://stackoverflow.com/users/3442617/bretzelus"}, "edited": false, "score": 0, "creation_date": 1505324665, "post_id": 46203575, "comment_id": 79370603, "body": "user0042: Thank you for noticing. Corrected."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 3442617, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003323594515/picture?type=large", "display_name": "Bretzelus", "link": "https://stackoverflow.com/users/3442617/bretzelus"}, "is_accepted": false, "score": 1, "last_activity_date": 1505326082, "last_edit_date": 1505326082, "creation_date": 1505324158, "answer_id": 46203690, "question_id": 46203575, "link": "https://stackoverflow.com/questions/46203575/to-me-a-strange-linker-error-in-c-msvc-visual-studio-2017-dll-implicit-link/46203690#46203690", "title": "To me, a strange linker error in C++, MSVC/Visual Studio 2017; DLL implicit linking", "body": "<p>Oh! No! \nI didn't know that I have to apply \"TEA_API\" attr to inner structs as well !! \nClient project is compiling and linking now.</p>\n\n<p>Sorry. <strong><em>I am learning</em></strong>....</p>\n\n<pre><code>class TEA_API tstring{\n\n//... \n\n    struct TEA_API word{\n        string::iterator begin;\n        string::iterator end;\n        string operator ()();\n\n        using array_t = std::vector&lt;word&gt;;\n    };\n\n    struct TEA_API cword {\n        const char* begin;\n        const char* end;\n        string operator ()();\n\n        using array_t = std::vector&lt;cword&gt;;\n    };\n\n    //...\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>libtea.dll: size of tstring::word=[48] &lt;&gt; std::string:[40] &lt;&gt; tstring::cword[16]\ntstring::words : token_separators:\"\\\"'();,%&lt;&gt;=+-*/:.\":\nwords: 26:\n[tstring]\n[.]\n[dll]\n[:]\n[size]\n[of]\n[tstring]\n[:]\n[:]\n[word]\n[=]\n[[48]]\n[&lt;]\n[&gt;]\n[std]\n[:]\n[:]\n[string]\n[:]\n[[40]]\n[&lt;]\n[&gt;]\n[tstring]\n[:]\n[:]\n[cword[16]]\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 3442617, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003323594515/picture?type=large", "display_name": "Bretzelus", "link": "https://stackoverflow.com/users/3442617/bretzelus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1505326082, "creation_date": 1505323690, "last_edit_date": 1505324545, "question_id": 46203575, "link": "https://stackoverflow.com/questions/46203575/to-me-a-strange-linker-error-in-c-msvc-visual-studio-2017-dll-implicit-link", "title": "To me, a strange linker error in C++, MSVC/Visual Studio 2017; DLL implicit linking", "body": "<p>Below code that compiles by itself. \nIt produces \"libtea.dll\" and the .lib to be used to link libtea.dll with another object (executable or another dll )</p>\n\n<p>As a U*/Linux old g++ user, I really can't undestand in MSVC (Windows), why tstring::word::operator()(), implemented in the tstring.cc file  cannot be shared (resolved) at link time on the \"client\" project, while the rest of the tstring class members are all accessible... ?? </p>\n\n<p>P.S.: Please, don't judge the too common name lib\"tea\"...  Because I like drinking tea a lot! :) </p>\n\n<pre><code>    //...\n[libtea.h]\n#pragma once\n\n#ifdef TEA_EXPORTS // Well defined\n#define TEA_API __declspec(dllexport) // &lt;-- Compiling the lib\n#else\n#define TEA_API __declspec(dllimport) // &lt;-- Compiling the client project\n#endif\n[EOF libtea.h]\n\n// ...\n[tstring.h]\n#pragma once\n#include &lt;libtea.h&gt;\n#include ...\n//...\nclass TEA_API tstring{\n//...\n    struct word { // x64: 48 bytes;\n        string::iterator begin;\n        string::iterator end;\n        string operator ()(); // ---&gt; LNKC2019 ...external unresolved...\n\n        using array_t = std::vector&lt;word&gt;;\n    };\n\n    struct cword { // x64: 16 bytes;\n        const char* begin;\n        const char* end;\n        string operator ()(); // -----&gt; LNKC2019 ...external unresolved...\n\n        using array_t = std::vector&lt;cword&gt;;\n    };\n//...\n[EOF tstring.h]\n\n\nClient(-test) program main:\n#include &lt;tstring.h&gt;\n//...\nusing namespace std;\nauto main() -&gt; int { // c++ 14 : why not ?  :-)\n\n    tstring str;\n    str &lt;&lt; \"libtea.dll: size of tstring::word=[%d] &lt;&gt; std::string:[%d] &lt;&gt; tstring::cword[%d]\\n\";\n\n    str.arg(sizeof(tstring::word)).arg(sizeof(string)).arg(sizeof(tstring::cword));\n    cout &lt;&lt; str();\n    tstring::cword::array_t words;\n    size_t sz = str.cwords(words, \"\", true);\n    cout &lt;&lt; \"words: \" &lt;&lt; sz &lt;&lt; \":\\n\";\n    for (auto&amp; w : words) {\n        cout &lt;&lt; \"[\" &lt;&lt; w() &lt;&lt; \"]\\n\"; // tstring::cword::operator()(void): cannot be resolved....LNKC2019 ...external unresolved...\n    }\n\n    Sleep(2000);\n    return 0;\n}\n</code></pre>\n\n<p>I hope the code shows clearly what I face against MSVC ...\nThank you very much for your attention :)</p>\n"}, {"tags": ["c++", "visual-c++", "visual-studio-2013", "mfc", "cil"], "comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1505324585, "post_id": 46203519, "comment_id": 79370555, "body": "Generally a header file will specify libraries to link in. Try scanning all the header files you include to see if any of them are the cause."}, {"owner": {"reputation": 11371, "user_id": 481061, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4876d67fda212cee59d97ac5a676c2d?s=128&d=identicon&r=PG", "display_name": "Felix Dombek", "link": "https://stackoverflow.com/users/481061/felix-dombek"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1505327625, "post_id": 46203519, "comment_id": 79372336, "body": "@MarkRansom thanks. I think the error message is actually misleading, and has nothing at all to do with a Common Intermediate Language."}], "answers": [{"comments": [{"owner": {"reputation": 4887, "user_id": 7442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/073ebde743b9b53def0230a7e90907ef?s=128&d=identicon&r=PG", "display_name": "DougN", "link": "https://stackoverflow.com/users/7442/dougn"}, "edited": false, "score": 0, "creation_date": 1542210694, "post_id": 46204541, "comment_id": 93488874, "body": "Any hints on what is different or what to look at when adapting?"}, {"owner": {"reputation": 11371, "user_id": 481061, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4876d67fda212cee59d97ac5a676c2d?s=128&d=identicon&r=PG", "display_name": "Felix Dombek", "link": "https://stackoverflow.com/users/481061/felix-dombek"}, "reply_to_user": {"reputation": 4887, "user_id": 7442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/073ebde743b9b53def0230a7e90907ef?s=128&d=identicon&r=PG", "display_name": "DougN", "link": "https://stackoverflow.com/users/7442/dougn"}, "edited": false, "score": 0, "creation_date": 1542218598, "post_id": 46204541, "comment_id": 93493225, "body": "@DougN I don&#39;t work with VS anymore, but just create two new projects and compare their <code>dllmain.cpp</code> files to see the differences."}], "tags": [], "owner": {"reputation": 11371, "user_id": 481061, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4876d67fda212cee59d97ac5a676c2d?s=128&d=identicon&r=PG", "display_name": "Felix Dombek", "link": "https://stackoverflow.com/users/481061/felix-dombek"}, "is_accepted": true, "score": 6, "last_activity_date": 1505327412, "creation_date": 1505327412, "answer_id": 46204541, "question_id": 46203519, "link": "https://stackoverflow.com/questions/46203519/why-is-my-c-atl-project-linking-in-a-cil-library/46204541#46204541", "title": "Why is my C++ ATL project linking in a CIL library?", "body": "<p>OK, if anyone needs this for future reference:</p>\n\n<p>This happens when MFC headers are added to an ATL project for which <em>Use MFC</em> was not selected during project creation in the ATL wizard.</p>\n\n<p>Reason: The generated <code>dllmain.cpp</code> is a bit different for MFC-enabled COM DLLs, but is easily adaptible later when looking at the wizard outputs.</p>\n"}], "owner": {"reputation": 11371, "user_id": 481061, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4876d67fda212cee59d97ac5a676c2d?s=128&d=identicon&r=PG", "display_name": "Felix Dombek", "link": "https://stackoverflow.com/users/481061/felix-dombek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 46204541, "answer_count": 1, "score": 4, "last_activity_date": 1542391104, "creation_date": 1505323491, "last_edit_date": 1542278449, "question_id": 46203519, "link": "https://stackoverflow.com/questions/46203519/why-is-my-c-atl-project-linking-in-a-cil-library", "title": "Why is my C++ ATL project linking in a CIL library?", "body": "<p>I am getting this linker error from VC++2013:</p>\n\n<pre><code>1&gt;* CIL library *(* CIL module *) : \nerror LNK2005: _DllMain@12 already defined in mfcs120u.lib(dllmodul.obj)\n</code></pre>\n\n<p>This is a pure C++ project, a COM DLL containing an \"ATL simple object\", and  \"No Common Language Runtime Support\" is selected in the <em>General</em> project settings. I literally just wizard-created it and it has the same settings as other, working, COM DLLs.</p>\n\n<p>I need to link with the MFC library, not a .NET related library. How could this CIL library possibly end up in the build?</p>\n"}, {"tags": ["c++", "sockets", "boost"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8194825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1336f29c08560d9a08e45960c3776329?s=128&d=identicon&r=PG&f=1", "display_name": "A.Teator", "link": "https://stackoverflow.com/users/8194825/a-teator"}, "is_accepted": true, "score": 1, "last_activity_date": 1505329624, "creation_date": 1505329624, "answer_id": 46205116, "question_id": 46203430, "link": "https://stackoverflow.com/questions/46203430/boost-sockets-working-code-no-longer-working-after-format-reinstall-of-ubuntu/46205116#46205116", "title": "Boost sockets. Working code no longer working after format / reinstall of ubuntu. permission problems?", "body": "<p>So it turns out that this issue was unrelated to Boost Sockets. The error came from the connection to the LiDAR itself. It showed as connected via my network connections but it was not actually connected to the LiDAR. After I switched that conecttion IPv4 method to Link-Local, it worked immediately.thank you to everyone who read and considered my issue</p>\n"}], "owner": {"reputation": 11, "user_id": 8194825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1336f29c08560d9a08e45960c3776329?s=128&d=identicon&r=PG&f=1", "display_name": "A.Teator", "link": "https://stackoverflow.com/users/8194825/a-teator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 46205116, "answer_count": 1, "score": 0, "last_activity_date": 1505329624, "creation_date": 1505323157, "last_edit_date": 1505324449, "question_id": 46203430, "link": "https://stackoverflow.com/questions/46203430/boost-sockets-working-code-no-longer-working-after-format-reinstall-of-ubuntu", "title": "Boost sockets. Working code no longer working after format / reinstall of ubuntu. permission problems?", "body": "<p>i am running ubuntu 16.04 and using ROS kinetic (irrelevant for this question). unrelated to this project, i broke my system and decided to reinstall ubuntu. everything went fine and i thought that i had put my system back together. so now i have this code to send a packet to a LiDAR and decode the information i get back. you can see i put a couple cout's for debugging. the program freezes after sending the packet and waiting for the data back. this code has been working correctly for several months now and has not changed after the reinstall of ubuntu.</p>\n\n<p>things i have tried</p>\n\n<pre><code>sudo adduser my_username dialout\nsudo adduser my_username root\nsudo adduser my_username sudo\n</code></pre>\n\n<p>I have also edited <code>/etc/sudoers.d</code> to add my username in there with all permissions.</p>\n\n<p>the reason i suspect that the hangup is due to permissions is because i have another piece of code that uses UART communication through /dev/ttyUSB1 and i must use <code>sudo chmod a+rw /dev/ttyUSB1</code> before it will work. this was not necessary before.</p>\n\n<p>The relevant code is below although i strongly suspect this is not the issue. the code compiles and runs as expected except for the hangup. i would appreciate any feedback and suggestions and i will do my best to keep on top of replies.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/array.hpp&gt;\n#include &lt;boost/asio.hpp&gt;\n#include &lt;sensor_msgs/LaserScan.h&gt;\n\nusing boost::asio::ip::udp;\n\n\nclass KeyenceLaser\n{\n    public:\n        KeyenceLaser(boost::asio::io_service&amp; io_service, const std::string&amp; host, const std::string&amp; port):io_service_(io_service), socket_(io_service, udp::endpoint(udp::v4(), 0))\n        {\n            udp::resolver resolver(io_service_);\n            udp::resolver::query query(udp::v4(), host, port);\n            udp::resolver::iterator iter = resolver.resolve(query);\n            endpoint_ = *iter;\n\n            if (socket_.is_open()){std::cout&lt;&lt;\"socket open\"&lt;&lt;std::endl;;}else{std::cout&lt;&lt;\"socket not open\"&lt;&lt;std::endl;}\n        }\n\n        ~KeyenceLaser()\n        {\n            socket_.close();\n        }\n\n        void send(const std::string&amp; msg) \n        {\n            socket_.send_to(boost::asio::buffer(msg, msg.size()), endpoint_); \n        }\n        void poll(sensor_msgs::LaserScan::Ptr scan) \n        {\n            char request[1920];\n                            char srequest[]={0x90,0,1,0,0,0,0,0,0,0};// sends the request to get all beam data back\n            size_t request_length = strlen(srequest);\n            unsigned char reply[1920];\n            scan-&gt;ranges.resize(953);\n\n            try\n            {\nstd::cout&lt;&lt;\"1 sending request\"&lt;&lt;std::endl;\n                boost::system::error_code errcode;\n                boost::asio::socket_base::message_flags flags=NULL;\n                int bytesSent =-1;\n                bytesSent= socket_.send_to(boost::asio::buffer(srequest, 10), endpoint_ );\nstd::cout&lt;&lt;\"sent \" &lt;&lt; bytesSent &lt;&lt; \" bytes\\n2 waiting for data back\"&lt;&lt;std::endl;\n                size_t reply_length = socket_.receive_from(boost::asio::buffer(reply, 1920), endpoint_);\nstd::cout&lt;&lt;\"3 got data back\"&lt;&lt;std::endl;\n\n                scan-&gt;angle_min = -.090757;\n                scan-&gt;angle_max = 3.23234;\n                scan-&gt;angle_increment = 3.323106 / 953.0;\n                scan-&gt;range_min = 0.00;\n                scan-&gt;range_max = 5.0;\n                scan-&gt;ranges.reserve(953);\n                scan-&gt;ranges.resize(953);\n                scan-&gt;ranges.clear();\n\n                for (int i=14;i &lt; 1921; i++)\n                    {\n                    //std::cout &lt;&lt; i/2-7&lt;&lt;\":\"&lt;&lt;(((reply[i+1]&lt;&lt;8) + reply[i])/1000.0) &lt;&lt; std::endl;\n                    scan-&gt;ranges.push_back(((reply[i+1]&lt;&lt;8) + reply[i])/1000.0);\n\n                        i++;\n                    }\n\n            }\n            catch (std::exception&amp; e)\n            {\n                std::cout &lt;&lt; \"Exception: \" &lt;&lt; e.what() &lt;&lt; \"\\n\";\n            }\n        }\n\n    private:\n        boost::asio::io_service&amp; io_service_;\n        udp::socket socket_;\n        udp::endpoint endpoint_;\n};\n</code></pre>\n\n<p>EDIT 1:</p>\n\n<p>i have modified the code to the following...</p>\n\n<pre><code>std::cout&lt;&lt;\"1 sending request\"&lt;&lt;std::endl;\n                    boost::system::error_code errcode;\n                    boost::asio::socket_base::message_flags flags;\n                    int bytesSent =-1;\n                    bytesSent= socket_.send_to(boost::asio::buffer(srequest, 10), endpoint_ ,flags, errcode);\nstd::cout&lt;&lt;\"sent \" &lt;&lt; bytesSent &lt;&lt; \" bytes\\ngot error code: \" &lt;&lt; errcode &lt;&lt; \"\\n2 waiting for data back\"&lt;&lt;std::endl;\n                    size_t reply_length = socket_.receive_from(boost::asio::buffer(reply, 1920), endpoint_);\nstd::cout&lt;&lt;\"3 got data back\"&lt;&lt;std::endl;\n</code></pre>\n\n<p>and i get error 95 - operation not supported , but i think thats cause i didnt instantiate my flags correctly (and google isnt helping me do that)</p>\n\n<p>EDIT 2:</p>\n\n<p>i just wanted to make it clear that i think i've installed all the required software. i'm open to apt-get some more stuff if you think that i'm just missing some library.\nP.S. i did modify the code again slightly and the socket is being shown as open with 10 bytes sent. the LiDAR \"link\" light does not blink after i send the packet though (it did before), so I don't think the packet is actually getting through the cable</p>\n"}, {"tags": ["java", "android", "c++", "java-native-interface", "google-play-services"], "answers": [{"tags": [], "owner": {"reputation": 892, "user_id": 6791953, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/HUAa7.jpg?s=128&g=1", "display_name": "iLyas", "link": "https://stackoverflow.com/users/6791953/ilyas"}, "is_accepted": true, "score": 0, "last_activity_date": 1505326306, "creation_date": 1505326306, "answer_id": 46204266, "question_id": 46203330, "link": "https://stackoverflow.com/questions/46203330/calling-a-c-function-from-java-jni-cocos2d-x/46204266#46204266", "title": "Calling a C++ function from Java JNI - Cocos2d-x", "body": "<p>I fixed the problem, It seems like he needs to execute in CocosThread so I did like that : </p>\n\n<pre><code> Director::getInstance()-&gt;getScheduler()-&gt;performFunctionInCocosThread([&amp;](){\n        MenuScene::goToScene();\n    });\n</code></pre>\n"}], "owner": {"reputation": 892, "user_id": 6791953, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/HUAa7.jpg?s=128&g=1", "display_name": "iLyas", "link": "https://stackoverflow.com/users/6791953/ilyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 1, "accepted_answer_id": 46204266, "answer_count": 1, "score": 0, "last_activity_date": 1505326306, "creation_date": 1505322799, "last_edit_date": 1505323462, "question_id": 46203330, "link": "https://stackoverflow.com/questions/46203330/calling-a-c-function-from-java-jni-cocos2d-x", "title": "Calling a C++ function from Java JNI - Cocos2d-x", "body": "<p>I am working on a project in <strong>Cocos2d-x (Latest)</strong> in which I worked with Google Play Game Services, I encountered several problems when I tried to integrate Google Play Services with C++ and then I decided to change to JAVA.</p>\n\n<p>When the <strong>user</strong> click to the <strong>Button</strong> \"Invite Friend\", the <strong>method startGame()</strong> is called successfully with JNI, but nothing happening ! The following scene does not display.</p>\n\n<p><strong>C++ Code :</strong></p>\n\n<pre><code>extern \"C\"\n{\nJNIEXPORT void JNICALL Java_sonar_systems_frameworks_GooglePlayServices_GooglePlayServicesGameHelper_startGame(JNIEnv* env, jobject thiz);\n};\n\nJNIEXPORT void JNICALL Java_sonar_systems_frameworks_GooglePlayServices_GooglePlayServicesGameHelper_startGame(JNIEnv* env, jobject thiz)\n{\n\n    MenuScene::goToScene();\n\n}\nvoid MenuScene::goToScene() {\n\n    //Going to the next scene\n    Scene * gameScene=GameScene::createScene();\n    TransitionFade*transition=TransitionFade::create(TRANSITION_TIME, gameScene);\n    //Replace the current Scene with New Game Scene\n    Director::getInstance()-&gt;replaceScene(transition);\n}\n</code></pre>\n\n<p><strong>Java Code from where the above function is called :</strong></p>\n\n<pre><code>private native void startGame();\npublic void inviteFriend() {\n\n    startGame();\n\n    // launch the player selection screen\n    // minimum: 1 other player; maximum: 3 other players\n    //Intent intent = Games.RealTimeMultiplayer.getSelectOpponentsIntent(mGoogleApiClient, 1, 1);\n    //((Activity) GooglePlayServices.ctx).startActivityForResult(intent, RC_SELECT_PLAYERS);\n\n}\n</code></pre>\n\n<p>The communication between C++ and Java is fine, but why I cannot to go to next scene, the code is correct !</p>\n\n<p>Thank you,</p>\n"}, {"tags": ["c++", "priority-queue"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 7, "creation_date": 1505322483, "post_id": 46203116, "comment_id": 79369411, "body": "If your copy constructor causes UB, fix it."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1505322796, "post_id": 46203116, "comment_id": 79369573, "body": "@juanchopanza In this case it does not."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1505322870, "post_id": 46203116, "comment_id": 79369615, "body": "Have you considered deleting the copy constructor and copy assignment operators with <code>A(const A&amp;) = delete</code> and <code>A &amp; operator=(const A&amp;) = delete;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1505322374, "creation_date": 1505322374, "answer_id": 46203234, "question_id": 46203116, "link": "https://stackoverflow.com/questions/46203116/c-avoiding-using-copy-constructor-which-is-called-by-priorityqueue/46203234#46203234", "title": "C++ Avoiding using copy constructor which is called by priorityqueue", "body": "<p>That copy constructor is called when it creates the comparator object, which is also your element type, <code>A</code>.</p>\n\n<p>Use another type for comparator, e.g.:</p>\n\n<pre><code>struct Compare\n{\n    bool operator()(const A* m1, const A* m2) const {\n        return m1-&gt;GetVal() &lt; m2-&gt;GetVal();\n    }\n};\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>std::priority_queue&lt;A*, std::vector&lt;A*&gt;, Compare&gt; pq;\n</code></pre>\n\n<hr>\n\n<p>And, even better, use smart pointers to avoid memory leaks:</p>\n\n<pre><code>struct Compare\n{\n    bool operator()(std::unique_ptr&lt;A&gt; const&amp; m1, std::unique_ptr&lt;A&gt; const&amp; m2) const {\n        return m1-&gt;GetVal() &lt; m2-&gt;GetVal();\n    }\n};\n\nvoid specialPriorityQueue() {\n    std::unique_ptr&lt;A&gt; val(new A());\n    val-&gt;setVal(5);\n    std::priority_queue&lt;std::unique_ptr&lt;A&gt;, std::vector&lt;std::unique_ptr&lt;A&gt;&gt;, Compare&gt; pq;\n    pq.push(move(val));\n\n    std::unique_ptr&lt;A&gt; val2(new A());\n    val2-&gt;setVal(3);\n    pq.push(move(val2));\n}\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 2359879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3f675292839a2c69f5f0be5a33a45105?s=128&d=identicon&r=PG", "display_name": "413X", "link": "https://stackoverflow.com/users/2359879/413x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 46203234, "answer_count": 1, "score": -3, "last_activity_date": 1505322374, "creation_date": 1505321947, "question_id": 46203116, "link": "https://stackoverflow.com/questions/46203116/c-avoiding-using-copy-constructor-which-is-called-by-priorityqueue", "title": "C++ Avoiding using copy constructor which is called by priorityqueue", "body": "<p>I have this current setup:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;queue&gt;\n#include &lt;vector&gt;\nclass A\n    {\n        int val;\n    public:\n        A()\n        {\n            std::cout &lt;&lt; \"Inside A. Constructor with val =\" &lt;&lt; val &lt;&lt; \".\\n\";\n        }\n        A(const A&amp; msg)\n        {\n            std::cout &lt;&lt; \"Inside const A. Never want to come here. val =\" &lt;&lt; msg.val &lt;&lt; \".\\n\";\n        }\n        bool operator()(const A* m1, const A* m2)\n        {\n            std::cout &lt;&lt; \"Inside () function.\\n\";\n            std::cout &lt;&lt; \"m1: \" &lt;&lt; m1-&gt;GetVal() &lt;&lt; \" m2: \" &lt;&lt; m2-&gt;GetVal()&lt;&lt;\"\\n\";\n            return (m1-&gt;GetVal() &lt; m2-&gt;GetVal());\n        }\n        void setVal(int input) { std::cout &lt;&lt; \"inside setVal.\\n\"; val = input; }\n        int GetVal()const { return val; }\n\n    };\n\n\n    void specialPriorityQueue()\n    {\n        //init\n        A* val = new A();\n        val-&gt;setVal(5);\n        std::priority_queue&lt;A*, std::vector&lt;A*&gt;, A&gt; pq;\n        pq.push(val);\n\n        A* val2 = new A();\n        val2-&gt;setVal(3);\n        pq.push(val2);\n\n        delete val;\n        delete val2;\n    }\nint main()\n    {\n        specialPriorityQueue();\nreturn 0;\n    }\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>Inside A. Constructor with val =-85000000...\ninside setVal.\nInside A. Constructor with val =-85000000...\nInside const A. Never want to come here. val =-85000000....\nInside A. Constructor with val =-85000000...\ninside setVal.\nInside const A. Never want to come here. val =-85000000....\nInside () function.\nm1: 5 m2: 3\n</code></pre>\n\n<p>My question is: Is there any way to avoid using the copy constructor by the priority queue. This causes undefined behaviour. I can't remove the function either as it has too much dependencies elsewhere.</p>\n"}, {"tags": ["c++", "arrays", "pointers"], "comments": [{"owner": {"reputation": 2374, "user_id": 8491726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550562035006492/picture?type=large", "display_name": "Artemy Vysotsky", "link": "https://stackoverflow.com/users/8491726/artemy-vysotsky"}, "edited": false, "score": 2, "creation_date": 1505322012, "post_id": 46203092, "comment_id": 79369156, "body": "instead of array use std::vector - you&#39;ll be able to return it from a function"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505322014, "post_id": 46203092, "comment_id": 79369157, "body": "<code>statarr</code> needs to be <code>static</code> if you want that to use like that."}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1505322015, "post_id": 46203092, "comment_id": 79369158, "body": "Why don&#39;t you just do <code>int *arrptr = (int*)arr</code>? What&#39;s the point in putting it into function <code>foo</code>? BTW, the difference is that in the function at the bottom of your question, you are returning the address of a local array, which yields undefined behavior (this array &quot;ceases to exist&quot; outside the scope of that function)."}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 4, "creation_date": 1505322373, "post_id": 46203092, "comment_id": 79369341, "body": "Your &quot;simple&quot; example and your code are very different. You should be using <code>std::vector</code> instead of raw arrays."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1505322798, "post_id": 46203092, "comment_id": 79369576, "body": "Returning a <code>std::array</code> or <code>std::vector</code> and just forgetting about C-style arrays will save you a lot of headaches."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1505322804, "post_id": 46203092, "comment_id": 79369579, "body": "FYI, don&#39;t use <code>while (!eof)</code>. It&#39;s not going to know it&#39;s at EOF until it tries reading something and hits the end, which can easily cause problems like going through the loop with a blank input."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 4, "creation_date": 1505322857, "post_id": 46203092, "comment_id": 79369606, "body": "Helpful hint: the best way to learn C++ is to completely and totally forget everything you know about Java. Start from scratch. C++&#39;s and Java&#39;s syntax is deceptively similar, but C++&#39;s classes, objects, and memory model are fundamentally different from Java&#39;s, and they have very little in common. The mistake in the shown code is typical for someone coming from a Java background, where one doesn&#39;t have to worry about things like object lifetime scopes. Unfortunately, one needs to get this 100% right in C++, and fully understand the fundamental differences between automatic and dynamic scope."}, {"owner": {"reputation": 303, "user_id": 3000794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f2ffb31011589b2bea02ce19c5561208?s=128&d=identicon&r=PG&f=1", "display_name": "Insederec", "link": "https://stackoverflow.com/users/3000794/insederec"}, "edited": false, "score": 0, "creation_date": 1505323514, "post_id": 46203092, "comment_id": 79369946, "body": "I changed the &quot;simple&quot; code to better reflect the way I used it in the example. Its behavior remains the same. As far as vectors, I&#39;m not sure if I should or need to use them, since for this assignment (It&#39;s the first few weeks of the course) we have never gone over vectors and we&#39;re expected to be using arrays. I don&#39;t know any other way to return the type of information I need to return short of finding techniques we haven&#39;t gone over in class."}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1505324565, "post_id": 46203092, "comment_id": 79370543, "body": "@Fran&#231;oisAndrieux: The example at the top of the question (the one I was referring too) converts an <code>int</code> array to an <code>int</code> pointer. I see no alias rule breaking there, and the OP is doing exactly what I wrote, only inside a function (which as I stated, could just as well be done directly)."}, {"owner": {"reputation": 303, "user_id": 3000794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f2ffb31011589b2bea02ce19c5561208?s=128&d=identicon&r=PG&f=1", "display_name": "Insederec", "link": "https://stackoverflow.com/users/3000794/insederec"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1505324741, "post_id": 46203092, "comment_id": 79370653, "body": "@chris Recommended alternative? I need to check that there is no more input in the stream, but <code>eof()</code> was the only thing I could find."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1505325067, "post_id": 46203092, "comment_id": 79370880, "body": "@goodvibration I misread your original comment and have retracted my reply."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1505328287, "post_id": 46203092, "comment_id": 79372703, "body": "@Insederec, You can&#39;t know whether there&#39;s more data without trying to read it. See <a href=\"http://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong\">this question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 3000794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f2ffb31011589b2bea02ce19c5561208?s=128&d=identicon&r=PG&f=1", "display_name": "Insederec", "link": "https://stackoverflow.com/users/3000794/insederec"}, "edited": false, "score": 0, "creation_date": 1505324053, "post_id": 46203207, "comment_id": 79370267, "body": "Oh! So instead of returning a new array, simply modify the data at the address of an already existing array! Is there any reason not to use this solution?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 303, "user_id": 3000794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f2ffb31011589b2bea02ce19c5561208?s=128&d=identicon&r=PG&f=1", "display_name": "Insederec", "link": "https://stackoverflow.com/users/3000794/insederec"}, "edited": false, "score": 0, "creation_date": 1505327815, "post_id": 46203207, "comment_id": 79372435, "body": "@Insederec you can also use <code>std::array</code>, which allows to be returned from functions."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 303, "user_id": 3000794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f2ffb31011589b2bea02ce19c5561208?s=128&d=identicon&r=PG&f=1", "display_name": "Insederec", "link": "https://stackoverflow.com/users/3000794/insederec"}, "edited": false, "score": 0, "creation_date": 1505327941, "post_id": 46203207, "comment_id": 79372508, "body": "@Insederec &quot;Is there any reason not to use this solution?&quot; - well, just returning a <code>std::vector</code> is a lot simpler.. also, <code>static</code> variables open up their own whole new can of worms."}], "tags": [], "owner": {"reputation": 328, "user_id": 2688565, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f7395cb8b2106d7c4da1ab118f40b3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/2688565/arjun"}, "is_accepted": true, "score": 0, "last_activity_date": 1505323591, "last_edit_date": 1505323591, "creation_date": 1505322275, "answer_id": 46203207, "question_id": 46203092, "link": "https://stackoverflow.com/questions/46203092/c-returning-array-data-loss/46203207#46203207", "title": "C++ Returning Array, data loss", "body": "<p>You cannot have pointer references to local arrays in external functions, since once the local function exits it's stack may be reused and the data in the local variables will contain trash.</p>\n\n<p>You can add word static to your local arrays declaration for it's memory to be persistent across other functions (and repeated calls). Although that is not a recommended solution at all here.</p>\n\n<p>Change:</p>\n\n<pre><code>double statarr[6] = {(double)BA, (double)OB, (double)H, (double)BB, (double)K, (double)HBP};\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>static double statarr[6] = {(double)BA, (double)OB, (double)H, (double)BB, (double)K, (double)HBP};\n</code></pre>\n\n<p>Although, a better solution would be to not declare the array local to <strong>calculateStats</strong></p>\n\n<p>Something like:</p>\n\n<pre><code>    //calculate stats for each player, return as formatted string\ndouble* calculateStats(string player, double *outArr){\n   //cut for conciseness, just know it works and the proper values are in the following array\n\n   //create stat array\n   outArr[0] = (double)BA;\n   outArr[1] = (double)OB;\n   outArr[2] = (double)H;\n   outArr[3] = (double)BB;\n   outArr[4] = (double)K;\n   outArr[5] = (double)HBP;\n\n\n   return outArr;\n}\n</code></pre>\n\n<p>Then have:</p>\n\n<pre><code>int main(){\n   stringstream allstats;\n   allstats &lt;&lt; readFile(); //readFile() simply returns a string read from a file\n\n   while(!allstats.eof()){     //check for end of stream\n      string temp;             \n      getline(allstats, temp); //grab a line from allstats and put it into temp\n\n      double arr[6]\n      calculateStats(temp, arr) //create pointer to array of stats calculated for temp\n\n      // print arr\n      for(int x = 0; x &lt; 6; x++)\n         cout &lt;&lt; arr[x] &lt;&lt; endl;\n      //****This spits out the correct value for arr[0] but for the rest of the array\n      //****it is values like 8.58079e-306 which tells me those addresses have been\n      //****overwritten.\n\n   }\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 3000794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f2ffb31011589b2bea02ce19c5561208?s=128&d=identicon&r=PG&f=1", "display_name": "Insederec", "link": "https://stackoverflow.com/users/3000794/insederec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "closed_date": 1505322708, "accepted_answer_id": 46203207, "answer_count": 1, "score": 0, "last_activity_date": 1505323591, "creation_date": 1505321832, "last_edit_date": 1505323362, "question_id": 46203092, "link": "https://stackoverflow.com/questions/46203092/c-returning-array-data-loss", "closed_reason": "Duplicate", "title": "C++ Returning Array, data loss", "body": "<p>I'm new to C++ coming from Java so forgive me for being naive, but I'm trying to pass an array out of a function. I know the way to do this is to pass a pointer, like so:</p>\n\n<pre><code>int *foo(){\n   int arr[3] = {1, 2, 3};\n   int *arrptr = arr;\n   return arrptr;\n}\n</code></pre>\n\n<p>And then to access that array:</p>\n\n<pre><code>int main(){\n   int *arrptr = foo();  //create a pointer to array\n\n   //cout all elements\n   for(int x = 0; x &lt; 3; x++)\n      cout &lt;&lt; arrptr[x];\n\n   return 0;\n}\n</code></pre>\n\n<p>And naturally, this works just fine. But for some reason in a different code, this same process only returns the first value of the array and the rest seem to be random. </p>\n\n<pre><code>int main(){\n   stringstream allstats;\n   allstats &lt;&lt; readFile(); //readFile() simply returns a string read from a file\n\n   while(!allstats.eof()){     //check for end of stream\n      string temp;             \n      getline(allstats, temp); //grab a line from allstats and put it into temp\n\n      double *arr = calculateStats(temp); //create pointer to array of stats calculated for temp\n\n      // print arr\n      for(int x = 0; x &lt; 6; x++)\n         cout &lt;&lt; arr[x] &lt;&lt; endl;\n      //****This spits out the correct value for arr[0] but for the rest of the array\n      //****it is values like 8.58079e-306 which tells me those addresses have been\n      //****overwritten.\n\n   }\n   return 0;\n}\n\n//calculate stats for each player, return as formatted string\ndouble* calculateStats(string player){\n   //cut for conciseness, just know it works and the proper values are in the following array\n\n   //create stat array\n   double statarr[6] = {(double)BA, (double)OB, (double)H, (double)BB, (double)K, (double)HBP};\n\n   //create pointer to stat array\n   double *ptr;\n   ptr = statarr;\n\n   return ptr;\n}\n</code></pre>\n\n<p>In Java it would be as simple as just returning an array and the job is done. Is this even possible in C++ or is this just beyond my level of understanding and the solution is much more complicated than I thought?</p>\n"}, {"tags": ["c++", "enums", "linkage", "compile-time-constant"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1505322300, "post_id": 46203089, "comment_id": 79369301, "body": "Maybe enumerators?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1505323163, "post_id": 46203089, "comment_id": 79369770, "body": "@KerrekSB they can have linkage?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1505323742, "post_id": 46203089, "comment_id": 79370079, "body": "@PasserBy: I&#39;m not sure. Enumerators have names, the names denote values, and the names can be declared in different scopes. But it&#39;s not stated explicitly in the standard."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1505330788, "post_id": 46203089, "comment_id": 79374045, "body": "@KerrekSB Enums introduce named constants. The standard is explicit about that."}, {"owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1505335666, "post_id": 46203089, "comment_id": 79376481, "body": "@skypjack and I guess they are the only named values isn&#39;t? Post it as an answer."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 1, "creation_date": 1505336035, "post_id": 46203089, "comment_id": 79376677, "body": "@Peregring-lk There is already another answer that is almost there. No reason to post something so close to it just to gain reputation. I added a comment to the other one around. Let&#39;s see if the owner integrates it."}], "answers": [{"comments": [{"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1505331115, "post_id": 46203445, "comment_id": 79374222, "body": "Technically they are <a href=\"http://eel.is/c++draft/dcl.enum#1\" rel=\"nofollow noreferrer\">named constants</a>."}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1505389340, "post_id": 46203445, "comment_id": 79398737, "body": "@skypjack Edited."}], "tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": false, "score": 0, "last_activity_date": 1505389328, "last_edit_date": 1505389328, "creation_date": 1505323228, "answer_id": 46203445, "question_id": 46203089, "link": "https://stackoverflow.com/questions/46203089/c-name-of-a-value-may-have-linkage/46203445#46203445", "title": "C++: name of a value may have linkage", "body": "<p>One example of something close to this would be an <a href=\"http://en.cppreference.com/w/cpp/language/enum\" rel=\"nofollow noreferrer\"><code>enum</code></a>'s values, although technically they are <a href=\"http://eel.is/c++draft/dcl.enum#1\" rel=\"nofollow noreferrer\">named constants</a>:</p>\n\n<pre><code>enum class example\n{\n    ONE = 1,\n    TWO\n}\n</code></pre>\n\n<p>In this case, the enum <code>example</code> has names that are values where <code>ONE</code> corresponds to 1, and <code>TWO</code> corresponds to 2.</p>\n\n<p>These aren't just variables since you can't assign to them. </p>\n\n<p>Lastly, according to the link you posted, the enumerators have external linkage.</p>\n"}], "owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1535133626, "creation_date": 1505321819, "last_edit_date": 1535133626, "question_id": 46203089, "link": "https://stackoverflow.com/questions/46203089/c-name-of-a-value-may-have-linkage", "title": "C++: name of a value may have linkage", "body": "<p>Extracted from <a href=\"http://en.cppreference.com/w/cpp/language/storage_duration\" rel=\"nofollow noreferrer\">cppreference.com</a>:</p>\n\n<blockquote>\n  <p>A name that denotes object, reference, function, type, template,\n  namespace, or <strong>value</strong>, may have <em>linkage</em>.</p>\n</blockquote>\n\n<p>What is \"the name of a value\"? Can anybody provide an example where a name of a value is not a name of an object?</p>\n"}, {"tags": ["c++", "pointers", "struct"], "comments": [{"owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "edited": false, "score": 4, "creation_date": 1505321816, "post_id": 46203052, "comment_id": 79369041, "body": "Are you sure that you would like to use c-style arrays over <code>std::vector&lt;Node*&gt;</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1505321829, "post_id": 46203052, "comment_id": 79369052, "body": "You want the size of the thing you are getting memory for"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1505321831, "post_id": 46203052, "comment_id": 79369055, "body": "&quot;it provides the size of a structure and what i need is size of structure pointer&quot;... Well, only you know what you <i>need</i>. If you really need size of structure pointer then calculate size of structure pointer. End of story. However, I don&#39;t see why you&#39;d need &quot;size of structure pointer&quot; here. Even though I don&#39;t know what exactly you are trying to do, it appears that you actually need size of a structure here."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1505321953, "post_id": 46203052, "comment_id": 79369128, "body": "I think am quite fortunate in having grown up and acquire an interest in CS back in the 8-bit days, where you could take your Commodore 64 and know everything that there is to know about it, how it works, and how computers work on a fundamental level, including these kind of basic, elementary concepts. It&#39;s quite disappointing to see people who never had the benefit of actually understanding how CPU and RAM work struggle with what looks to me like simple, fundamental, basic, concepts."}, {"owner": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1505322106, "post_id": 46203052, "comment_id": 79369202, "body": "@AnT since the elements in array stores the address of structure, i need the size of structure address, not the size of structure."}, {"owner": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "edited": false, "score": 0, "creation_date": 1505322210, "post_id": 46203052, "comment_id": 79369241, "body": "@HariKrishnan no you don&#39;t. Enough space for pointers is already allocated in every element of the array. You just need to allocate space for the whole structure for each element, because you are setting each pointer to point to a structure."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1505322827, "post_id": 46203052, "comment_id": 79369590, "body": "@Hari Krishnan: Um... No. You don&#39;t need to allocate memory for array elements (which indeed are pointers). It is already allocated by <code>struct Node *list[10];</code>. Nothing else needs to be done for the pointers themselves. Now you are allocating memory for the <i>structs</i> these pointers will <b>point to</b>. These pointers will point to whole structs. So, you need to allocate memory for whole structs."}, {"owner": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1505322929, "post_id": 46203052, "comment_id": 79369655, "body": "@AnT Ok. now i got it. thanks .:)"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 3, "creation_date": 1505323019, "post_id": 46203052, "comment_id": 79369694, "body": "It is not clear though what language you are trying to use: C or C++. If this is supposed to be C++, you can use <code>Node</code> instead of <code>struct Node</code> and <code>new</code> instead of <code>malloc</code>. If this is supposed to be C, then don&#39;t cast the result of <code>malloc</code>."}, {"owner": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "edited": false, "score": 0, "creation_date": 1505323140, "post_id": 46203052, "comment_id": 79369762, "body": "If this is supposed to be C, then stop casting the result of malloc// why? i can&#39;t get it"}, {"owner": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "edited": false, "score": 1, "creation_date": 1505323664, "post_id": 46203052, "comment_id": 79370031, "body": "Because in C you can assign a <code>void*</code> to any other type of pointer. But not in C++."}], "answers": [{"comments": [{"owner": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "edited": false, "score": 0, "creation_date": 1505322649, "post_id": 46203170, "comment_id": 79369510, "body": "but where i am struggling is, since list is an array of pointers, each of its elements will store an address. So we need to allocate memory to save  that address only rigt? why shoud we allocate memory for the whole structure instead of its addreess&#39;s size? size of Nodes address will be always less than size of the Node ryt?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "edited": false, "score": 0, "creation_date": 1505322824, "post_id": 46203170, "comment_id": 79369588, "body": "@HariKrishnan, <i>So we need to allocate memory to save that address only right?</i> No. <code>list</code> is an array of pointers. It can store the addresses without needing any more dynamic memory allocation."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1505341299, "post_id": 46203170, "comment_id": 79378721, "body": "&quot;<i>So we need to allocate memory to save that address only rigt?</i>&quot; - you already did, when you allocated the <code>list[]</code> array. It already has enough allocated memory to hold the actual pointers. &quot;<i>why shoud we allocate memory for the whole structure instead of its addreess&#39;s size?</i>&quot; - because the <code>list[]</code> array contains pointers that point at <code>Node</code> objects, so you have to allocate the full <code>Node</code> size for each pointer to point at."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1505322121, "creation_date": 1505322121, "answer_id": 46203170, "question_id": 46203052, "link": "https://stackoverflow.com/questions/46203052/size-of-structure-and-structure-pointer-c/46203170#46203170", "title": "Size of structure and structure pointer: C++", "body": "<blockquote>\n  <p>Did i really need <code>malloc(sizeof(struct Node))</code> ?</p>\n</blockquote>\n\n<p>Yes. That is correct.</p>\n\n<p><code>list[0]</code> is of type <code>Node*</code>. It can point to an object of type <code>Node</code>. Hence, you need to allocate enough memory to hold an object of type <code>Node</code> to be able point <code>list[0]</code> to it. Using <code>sizeof(struct Node)</code> as argument to <code>malloc</code> gives you that.</p>\n\n<p>However, there are couple of things you can change to make your program more like a C++ program and less like a C program.</p>\n\n<ol>\n<li>You don't need to use <code>struct Node</code>. You can use just <code>Node</code>.</li>\n<li>Don't use <code>malloc</code>. User the <code>new</code> operator.</li>\n</ol>\n\n<hr>\n\n<pre><code>Node *list[10];\nlist[0]= new Node;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": false, "score": 0, "last_activity_date": 1505322199, "creation_date": 1505322199, "answer_id": 46203189, "question_id": 46203052, "link": "https://stackoverflow.com/questions/46203052/size-of-structure-and-structure-pointer-c/46203189#46203189", "title": "Size of structure and structure pointer: C++", "body": "<pre><code>struct Node *list[10];\nlist[0]=(struct Node*)mal?loc(sizeof(struct Node));\n</code></pre>\n\n<p><code>list[0]</code> is going to store a pointer to some memory which will store <code>Node</code>.You use <code>malloc</code> to allocate memory, so you have to tell <code>malloc</code> how much memory you need to allocate.In return <code>malloc</code> gives you a pointer to that allocated memory.</p>\n"}], "owner": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1505322199, "creation_date": 1505321705, "last_edit_date": 1505321960, "question_id": 46203052, "link": "https://stackoverflow.com/questions/46203052/size-of-structure-and-structure-pointer-c", "title": "Size of structure and structure pointer: C++", "body": "<p>I have a structure as shown below</p>\n\n<pre><code>struct Node\n{\nint data;\nNode* next; \n}\n</code></pre>\n\n<p>and an array of pointers to this Node structure</p>\n\n<pre><code>struct Node *list[10];\nlist[0]=(struct Node*)mal?loc(sizeof(struct Node));\n</code></pre>\n\n<p>Here while allocating memory to the first element of list, Did i really need <code>malloc(sizeof(struct Node))</code>? I have this doubt because it provides the size of a structure and what i need is size of structure addressd to store its adress(struture pointer's size) less than 4B?. Please explain.</p>\n"}, {"tags": ["c++", "qt", "static", "qbs"], "answers": [{"comments": [{"owner": {"reputation": 201, "user_id": 8604608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777fb068f5ef22c1aa797b3d18c8fc49?s=128&d=identicon&r=PG&f=1", "display_name": "Roman Ozhegov", "link": "https://stackoverflow.com/users/8604608/roman-ozhegov"}, "edited": false, "score": 0, "creation_date": 1505381927, "post_id": 46207638, "comment_id": 79393811, "body": "Christan, thank you for your answer. About your offers: 1) does not lead to any changes. 2) I am sure that both projects are building in the release mode. 3) For this tip, thanks. I found that the linking of the project is wrong, after which I fixed the qbs file (Please refer to my answer for this question)/"}], "tags": [], "owner": {"reputation": 701, "user_id": 8172668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4b78cf943703d618fbfa91461c7688?s=128&d=identicon&r=PG", "display_name": "Christian Kandeler", "link": "https://stackoverflow.com/users/8172668/christian-kandeler"}, "is_accepted": false, "score": 1, "last_activity_date": 1505485429, "last_edit_date": 1505485429, "creation_date": 1505341094, "answer_id": 46207638, "question_id": 46203031, "link": "https://stackoverflow.com/questions/46203031/static-build-qtqbs/46207638#46207638", "title": "Static build Qt+Qbs", "body": "<ol>\n<li>The two project files are not entirely corresponding. You should add:</li>\n</ol>\n\n<hr>\n\n<pre><code>consoleApplication: true // CONFIG += console\ncpp.cxxLanguageVersion: \"c++11\" // CONFIG += c++11\n</code></pre>\n\n<p>(I'm ignoring the bundle settings as you are apparently on Windows.)</p>\n\n<ol start=\"2\">\n<li><p>Are you sure that you are building in the same mode (debug vs release)? Note that with qbs, the default is debug. Set qbs.buildVariant to \"release\" on the command line if you want to change that.</p></li>\n<li><p>Comparing the linker command lines produced by qmake and qbs should give you an insight into which libraries get pulled in and how. Use qbs' --command-echo-mode option to see the full command lines used.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 201, "user_id": 8604608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777fb068f5ef22c1aa797b3d18c8fc49?s=128&d=identicon&r=PG&f=1", "display_name": "Roman Ozhegov", "link": "https://stackoverflow.com/users/8604608/roman-ozhegov"}, "is_accepted": true, "score": 2, "last_activity_date": 1505915344, "last_edit_date": 1505915344, "creation_date": 1505381842, "answer_id": 46215581, "question_id": 46203031, "link": "https://stackoverflow.com/questions/46203031/static-build-qtqbs/46215581#46215581", "title": "Static build Qt+Qbs", "body": "<p>Answer was found:</p>\n\n<pre><code>import qbs\n\nCppApplication {\n     Depends{\n         name: \"Qt\"\n         submodules: [\n             \"core\",\n         ]\n     }\n     Properties {\n         condition: Qt.core.staticBuild\n         cpp.linkerFlags: [\n             \"-static\",\n             \"-static-libgcc\"\n         ]\n     }\n     name: \"HelloWorld-minimal\"\n     files: \"main.cpp\"\n}\n</code></pre>\n\n<p>The file size remains larger than when you compile with qmake (I assume that this is due to the fine-tuning of qbs). However, <strong>the main problem is solved</strong>: the application does not require additional dll's.</p>\n\n<p><strong>UPD:</strong> this solution work for QBS 1.6.0. For newest version (1.9.0) linker faild with error:</p>\n\n<pre><code>unrecognized -a option `tic-libgcc'\n</code></pre>\n\n<p><strong>WTF?</strong></p>\n\n<p><strong>SOLUTION:</strong> For QBS 1.9.0 you must used next code:</p>\n\n<pre><code>import qbs\n\nCppApplication {\n    Depends{\n        name: \"Qt\"\n        submodules: [\n            \"core\",\n        ]\n    }\n\n    Properties {\n         condition: Qt.core.staticBuild\n         cpp.driverFlags: [\n             \"-static\",\n             \"-static-libgcc\",\n        ]\n    }\n    name: \"HelloWorld-minimal\"\n    files: \"main.cpp\"\n}\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 8604608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777fb068f5ef22c1aa797b3d18c8fc49?s=128&d=identicon&r=PG&f=1", "display_name": "Roman Ozhegov", "link": "https://stackoverflow.com/users/8604608/roman-ozhegov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 46215581, "answer_count": 2, "score": 1, "last_activity_date": 1505915344, "creation_date": 1505321596, "last_edit_date": 1505385181, "question_id": 46203031, "link": "https://stackoverflow.com/questions/46203031/static-build-qtqbs", "title": "Static build Qt+Qbs", "body": "<p>I create a simple console application \"Hello world\". First, I compile it with qmake: hello.pro</p>\n\n<pre><code>QT += core\nQT -= gui\n\nCONFIG += c++11\n\nTARGET = hello\nCONFIG += console\nCONFIG -= app_bundle\n\nTEMPLATE = app\n\nSOURCES += main.cpp\n</code></pre>\n\n<p>The application is builded normally and on a system without installed Qt and MinGW work fine. The size of the executable is 3.58MB.</p>\n\n<p>Next, we compile the same source code using the QBS build system. Hello.qbs:</p>\n\n<pre><code>import qbs\n\n CppApplication {\n     Depends{\n         name: \"Qt\"\n         submodules: [\n             \"core\",\n         ]\n     }\n     name: \"HelloWorld-minimal\"\n     files: \"main.cpp\"\n }\n</code></pre>\n\n<p>The executable file size is 4.35MB. The application requires \"libwinthread-1.dll\", \"libstdc ++ - 6.dll\" and \"libgcc_s_dw2-1.dll\".</p>\n\n<p><strong>A question</strong>: how correctly to build a static application in QBS with static linking of the above libraries and so that the size of the executable file was the same?</p>\n\n<p>(With the standard build of the project, without statics, the sizes of executable files with Qmake and with Qbs are the same).</p>\n"}, {"tags": ["c++", "templates", "pointers", "vector"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1505320905, "post_id": 46202764, "comment_id": 79368482, "body": "<code>std::cout &lt;&lt; &amp;data[0].data</code> should be <code>std::cout &lt;&lt; (*(int*)data[0].data)</code>, but it will be undefined behaviour after <code>int asdf = 5;</code> goes out of scope."}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 1, "creation_date": 1505321193, "post_id": 46202764, "comment_id": 79368676, "body": "You could use a <code>vector&lt;unique_ptr&lt;Base&gt;&gt;</code> and implement derived classes for <code>int</code>, <code>string</code>, etc."}], "answers": [{"tags": [], "owner": {"reputation": 37828, "user_id": 1629821, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/861cfc0de6bf99a544b500eac16229eb?s=128&d=identicon&r=PG", "display_name": "Mr.C64", "link": "https://stackoverflow.com/users/1629821/mr-c64"}, "is_accepted": true, "score": 5, "last_activity_date": 1505327370, "last_edit_date": 1505327370, "creation_date": 1505321419, "answer_id": 46202988, "question_id": 46202764, "link": "https://stackoverflow.com/questions/46202764/how-can-i-have-an-object-with-differing-parameter-types-while-its-also-in-a-vec/46202988#46202988", "title": "How can I have an object with differing parameter types while it&#39;s also in a vector?", "body": "<p>The objects you put in the vector seem to have two data members: <code>variableName</code>, which is of fixed <code>std::string</code> type, and a <code>data</code> field, which is of <em>varying</em> type.</p>\n\n<p>You may consider using <a href=\"http://en.cppreference.com/w/cpp/utility/variant\" rel=\"nofollow noreferrer\">C++17's <code>std::variant</code></a> (or Boost's <code>variant</code> implementation) for the <code>data</code> field. For example, if you plan to support the types <code>int</code>, <code>float</code> and <code>std::string</code> for your <code>data</code>, you can use a  <code>std::variant&lt;int, float, std::string&gt;</code>.</p>\n\n<p>There's also <a href=\"http://en.cppreference.com/w/cpp/utility/any\" rel=\"nofollow noreferrer\"><code>std::any</code></a>, if you want to store instances of <em>any</em> type (that satisfy the requirements described in the <a href=\"http://en.cppreference.com/w/cpp/utility/any\" rel=\"nofollow noreferrer\"><code>std::any</code> documentation</a>).</p>\n\n<p>In <em>modern</em> C++ I'd suggest to avoid the C-style <code>void*</code>, and use it only if strictly necessary (e.g. if you are at some legacy C API boundary): there are safer, more robust and higher-level alternatives to it.</p>\n\n<hr>\n\n<p>Another option (if it makes better sense for your design) is to define a base class (<strong>interface</strong>) for the objects you want to put in your vector, and define custom classes that implement this interface. In this case, I suggest using <em>smart</em> pointers (like e.g. <code>std::unique_ptr</code> or <code>std::shared_ptr</code>) to manage those objects in a simple and safe way (I saw another answer here that used raw pointers, requiring explicit <code>new</code>/<code>delete</code> - actually in that code there were <code>new</code>s but no <code>delete</code>, with consequent resource leaks).</p>\n\n<p>E.g.:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\n// Interface for an element to be inserted in the vector\nclass IElement\n{\npublic:\n    IElement() {}\n    virtual ~IElement() {}\n\n    virtual string ToString() = 0;\n\n    // Other virtual methods ...\n};\n\nclass IntElement : public IElement\n{\npublic:\n    explicit IntElement(int n) : _n{ n } {}\n\n    virtual string ToString() override\n    {\n        return to_string(_n);\n    }\n\nprivate:\n    int _n;\n};\n\nclass StringElement : public IElement\n{\npublic:\n    explicit StringElement(const string&amp; s) : _s{ s } {}\n\n    virtual string ToString() override\n    {\n        return _s;\n    }\n\nprivate:\n    string _s;\n};\n\nint main() \n{\n    vector&lt;shared_ptr&lt;IElement&gt;&gt; elements;\n    elements.push_back(make_shared&lt;IntElement&gt;(10));\n    elements.push_back(make_shared&lt;IntElement&gt;(20));\n    elements.push_back(make_shared&lt;StringElement&gt;(\"Hello\"));\n    elements.push_back(make_shared&lt;StringElement&gt;(\"World\"));\n\n    for (const auto&amp; e : elements)\n    {\n        cout &lt;&lt; e-&gt;ToString() &lt;&lt; '\\n';\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n<pre><code>10\n20\nHello\nWorld\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1505321683, "post_id": 46203029, "comment_id": 79368960, "body": "You can go through the elements of a tuple, you just have to use a library function rather than a language feature. There already exist tuple-foreach functions out there."}], "tags": [], "owner": {"reputation": 173, "user_id": 3628115, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d2fd5d00e961ab3d1f0bbbc6b37416a0?s=128&d=identicon&r=PG&f=1", "display_name": "Simmovation", "link": "https://stackoverflow.com/users/3628115/simmovation"}, "is_accepted": false, "score": 0, "last_activity_date": 1505321585, "creation_date": 1505321585, "answer_id": 46203029, "question_id": 46202764, "link": "https://stackoverflow.com/questions/46202764/how-can-i-have-an-object-with-differing-parameter-types-while-its-also-in-a-vec/46203029#46203029", "title": "How can I have an object with differing parameter types while it&#39;s also in a vector?", "body": "<p>If you are using C++11 then you can use the tuple class in the standard library. You could make this object like so:</p>\n\n<pre><code>auto v = std::make_tuple(ttSaveObj(5, \"int example\"), ttSaveObj(\"Hello, world!\", \"string example\"))\nstd::cout &lt;&lt; std::get&lt;0&gt;(v).data &lt;&lt; \" \" &lt;&lt; std::get&lt;0&gt;(v).variableName &lt;&lt; std::endl;\n</code></pre>\n\n<p>There is a drawback though that the index for access is a template argument and must therefore be known at compile time, meaning that you can't loop through the elements. Also the types of the elements in the tuple must be known at compile time.</p>\n"}, {"comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 1, "creation_date": 1505323605, "post_id": 46203341, "comment_id": 79370003, "body": "<i>never</i> use <code>delete</code>, use smart pointers instead (<code>std::unique_ptr</code> or <code>std::shared_ptr</code>), e.g. <code>std::vector&lt;std::unique_ptr&lt;Object&gt;&gt;</code>."}], "tags": [], "owner": {"reputation": 124, "user_id": 8597205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jcaU9.jpg?s=128&g=1", "display_name": "A. Knorre", "link": "https://stackoverflow.com/users/8597205/a-knorre"}, "is_accepted": false, "score": 0, "last_activity_date": 1505826819, "last_edit_date": 1505826819, "creation_date": 1505322840, "answer_id": 46203341, "question_id": 46202764, "link": "https://stackoverflow.com/questions/46202764/how-can-i-have-an-object-with-differing-parameter-types-while-its-also-in-a-vec/46203341#46203341", "title": "How can I have an object with differing parameter types while it&#39;s also in a vector?", "body": "<p>If I understood your goals correctly, Java-like approach could take place, but you should wrap the vector to never forget the clean up.</p>\n\n<pre><code>// Example program\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;string.h&gt;\n#include &lt;memory&gt;\n\nusing std::vector;\n\nclass Object \n{\npublic:\n\n    explicit Object() {}\n    virtual ~Object() {}\n\n    virtual const char* toString() const = 0;\n\n};\n\nclass StringObject : public Object\n{\npublic:\n    explicit StringObject(const char* string) : Object()\n    {\n        if(string != 0)\n        {\n            m_value = new char[strlen(string) + 1];\n            strcpy(((char*)m_value), string);\n        } else\n        {\n            m_value = new char[1];\n            m_value[0] = 0;\n        }\n    }\n    virtual ~StringObject()\n    {\n        delete m_value;\n    }\n\n\n    virtual const char* toString() const\n    {\n        return (const char*)m_value;   \n    }\nprivate:\n    char* m_value;\n};\n\nclass IntObject : public Object\n{\npublic:\n    explicit IntObject(int val) : Object()\n    {\n        m_value = val;\n    }\n    virtual ~IntObject()\n    {\n    }\n\n\n    virtual const char* toString() const\n    {\n        return std::to_string(m_value).c_str();\n    }\nprivate:\n    int m_value;\n};\n\nint main()\n{\n\n    auto vec = vector&lt;std::unique_ptr&lt;Object&gt;&gt;();\n    vec.push_back(std::make_unique&lt;IntObject&gt;(9));\n    vec.push_back(std::make_unique&lt;IntObject&gt;(11));\n    vec.push_back(std::make_unique&lt;StringObject&gt;(\"hello\"));\n    vec.push_back(std::make_unique&lt;StringObject&gt;(\"world\"));\n\n    for(const auto&amp; v : vec)\n    {\n        std::cout &lt;&lt; v.get()-&gt;toString() &lt;&lt; \" \";\n    }\n\n}\n</code></pre>\n\n<p>Output, as expected, \"9 11 hello world\".</p>\n"}], "owner": {"reputation": 731, "user_id": 3394603, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/bGT0p.png?s=128&g=1", "display_name": "TrampolineTales", "link": "https://stackoverflow.com/users/3394603/trampolinetales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 2, "accepted_answer_id": 46202988, "answer_count": 3, "score": 1, "last_activity_date": 1505826819, "creation_date": 1505320661, "question_id": 46202764, "link": "https://stackoverflow.com/questions/46202764/how-can-i-have-an-object-with-differing-parameter-types-while-its-also-in-a-vec", "title": "How can I have an object with differing parameter types while it&#39;s also in a vector?", "body": "<p>I currently wish to have a vector of objects where each object has differing properties.</p>\n\n<p><strong>Intended outcome:</strong></p>\n\n<pre><code>//v is a vector\nv.push_back(ttSaveObj(5, \"int example\"));\nv.push_back(ttSaveObj(\"Hello, world!\", \"string example\"));\n\nstd::cout &lt;&lt; v[0].data &lt;&lt; \" \" &lt;&lt; v[0].variableName &lt;&lt; std::endl; //Intended Output: 5 int example\nstd::cout &lt;&lt; v[1].data &lt;&lt; \" \" &lt;&lt; v[1].variableName &lt;&lt; std::endl; //Intended Output: Hello, world! string example\n</code></pre>\n\n<p>Based on <a href=\"https://stackoverflow.com/questions/18199744/data-member-vec-cannot-be-a-member-template/23904055#23904055\">this answer</a> I tried having a constructor function for the class with <code>&lt;void*&gt;</code> in the template, but this seems just create a pointer to <code>void</code> (as I partially expected).</p>\n\n<p><strong>ttSaveObj.hpp:</strong></p>\n\n<pre><code>template &lt;typename T&gt;\nclass ttSaveObj {\n  public:\n\n    ttSaveObj(T pVar, std::string pName) {\n      data = pVar;\n      variableName = pName;\n    };\n    ~ttSaveObj() {};\n\n    std::string variableName;\n    T data;\n};\n</code></pre>\n\n<p><strong>ttGameObj.hpp:</strong></p>\n\n<pre><code>#include \"ttSaveObj.hpp\"\n\nclass ttGameObj {\n  public:\n\n    ttGameObj();\n    ~ttGameObj();\n    std::vector&lt;ttSaveObj&lt;void*&gt;&gt; data;\n};\n</code></pre>\n\n<p><strong>ttGameObj.cpp:</strong></p>\n\n<pre><code>#include \"ttGameObj.hpp\"\n\nttGameObj::ttGameObj() {\n  int asdf = 5;\n  int * test = &amp;asdf;\n  data.push_back(ttSaveObj&lt;void*&gt;(test, \"X\"));\n  std::cout &lt;&lt; &amp;data[0].data &lt;&lt; \" \" &lt;&lt; data[0].variableName &lt;&lt; std::endl; //Output: 0x15fb770 X\n}\n</code></pre>\n\n<p>Anything that will help me get closer to my intended outcome is appreciated, thanks!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 12, "creation_date": 1505319772, "post_id": 46202478, "comment_id": 79367845, "body": "1st of all <code>switch</code> isn&#39;t a loop. And there&#39;s no need to have a <code>break;</code> statement after the <code>return</code>statements."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1505319815, "post_id": 46202478, "comment_id": 79367870, "body": "It depends if you want fall through or not.  If you don&#39;t you need <code>break</code>.  If not then you don&#39;t."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 4, "creation_date": 1505319856, "post_id": 46202478, "comment_id": 79367890, "body": "Read about what <code>break</code> and <code>return</code> do and the answer will become clear. Don&#39;t rely on testing to learn C++."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1505319907, "post_id": 46202478, "comment_id": 79367913, "body": "Also, I would recommend learning C++ from a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a> instead of internet tutorials."}, {"owner": {"reputation": 27492, "user_id": 3773011, "user_type": "moderator", "profile_image": "https://i.stack.imgur.com/Hmfxy.jpg?s=128&g=1", "display_name": "Makyen", "link": "https://stackoverflow.com/users/3773011/makyen"}, "edited": false, "score": 0, "creation_date": 1505368136, "post_id": 46202478, "comment_id": 79385767, "body": "The word &quot;switch&quot; doesn&#39;t exist on the page you link to. Thus, there&#39;s no way to answer. Further, questions <i>must</i> be self contained. All information necessary to know what the question is must be <i>in the question</i>. Thus, asking us to go look at code on some other site is off-topic."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 5, "last_activity_date": 1505319806, "creation_date": 1505319806, "answer_id": 46202495, "question_id": 46202478, "link": "https://stackoverflow.com/questions/46202478/when-can-i-leave-out-break-in-switch-loop/46202495#46202495", "title": "When can I leave out &quot;break&quot; in switch loop?", "body": "<p>Note that C++ does not <em>insist</em> on your using <code>break</code>, but often <code>switch</code> cases depend on them, to obviate the useful <em>follow through</em> feature.</p>\n\n<p>You can remove a <code>break</code> with no effect on your program if program control never reaches it: None of the <code>break</code> statements after the <code>return</code> statements are reachable, so you can safely remove them.</p>\n\n<p>You also don't need an empty <code>default</code> label either.</p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1505324330, "post_id": 46202509, "comment_id": 79370411, "body": "A great example of Fall-through in action is <a href=\"https://stackoverflow.com/questions/514118/how-does-duffs-device-work\">Duff&#39;s Device</a>"}], "tags": [], "owner": {"reputation": 2458, "user_id": 6445069, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tmqHA.jpg?s=128&g=1", "display_name": "Phydeaux", "link": "https://stackoverflow.com/users/6445069/phydeaux"}, "is_accepted": false, "score": 9, "last_activity_date": 1505320878, "last_edit_date": 1505320878, "creation_date": 1505319851, "answer_id": 46202509, "question_id": 46202478, "link": "https://stackoverflow.com/questions/46202478/when-can-i-leave-out-break-in-switch-loop/46202509#46202509", "title": "When can I leave out &quot;break&quot; in switch loop?", "body": "<p>Without <code>break</code>, the flow of execution will simply continue to the next case - unless you jump in some other way of course (like <code>return</code>ing, in your case). This is known as <em>fall-through</em>.</p>\n\n<p>Whether this is a bug or not depends on the program. It can be useful if (for example) you want multiple <code>case</code>s to have the same action:</p>\n\n<pre><code>switch (op)\n{\n    case '+':\n        return add;\n        break;  // these breaks do nothing - we have already returned!\n    case '-':\n        return subtract;\n        break;\n    case 'x':  // fall through to '*'\n    case '*':\n        return multiply;\n        break;\n    case '/':\n        return divide;\n        break;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 8250310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9868a6a37bfaee8b361dd77a5d3e175f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Boucher", "link": "https://stackoverflow.com/users/8250310/eric-boucher"}, "is_accepted": false, "score": 4, "last_activity_date": 1505320788, "creation_date": 1505320788, "answer_id": 46202800, "question_id": 46202478, "link": "https://stackoverflow.com/questions/46202478/when-can-i-leave-out-break-in-switch-loop/46202800#46202800", "title": "When can I leave out &quot;break&quot; in switch loop?", "body": "<p>Since you are new to C++, consider that:</p>\n\n<ul>\n<li><p>Anytime your code reaches a <code>return</code> statement, your current function/method will end and return the specified valued without executing any more line of codes. So your <code>break</code> statements are never going to be reached.</p></li>\n<li><p>When a <code>break</code> is reached, the current <code>switch</code>, <code>while</code> or <code>for</code> will end. And the flow will continue outside of its scope <code>{...}</code>.</p></li>\n<li><p>If you do not use <code>break</code> in a <code>switch case</code> then the flow just continues (even to the next case).</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 3, "last_activity_date": 1505321245, "creation_date": 1505321245, "answer_id": 46202941, "question_id": 46202478, "link": "https://stackoverflow.com/questions/46202478/when-can-i-leave-out-break-in-switch-loop/46202941#46202941", "title": "When can I leave out &quot;break&quot; in switch loop?", "body": "<p>It may be useful to you to understand what a <code>switch</code> is doing under the covers.</p>\n\n<p>essentially this:</p>\n\n<pre><code>enum command {\n    add, subtract, multiply, divide, error\n};\n\ncommand foo(char op)\n{\n    switch (op)\n    {\n    case '+': {\n        return add;\n            break;}\n    case '-': {\n        return subtract;\n        break;}\n    case '*': {\n        return multiply;\n        break;}\n    case '/': {\n        return divide;\n        break;}\n    default: \n      break;\n    }\n    return error;\n}\n</code></pre>\n\n<p>Is logically the same as this:</p>\n\n<pre><code>command foo_that_will_give_people_seizures(char op)\n{\n    if (op == '+') goto plus_;\n    if (op == '-') goto minus_;\n    if (op == '*') goto mpy_;\n    if (op == '/') goto div_;\n    goto break_;\n\n    plus_:\n    return add;\n    goto break_;   // notice how this statement cannot be reached.\n\n    minus_:\n    return subtract;\n\n    mpy_:\n    return multiply;\n\n    div_:\n    return divide;\n\n    break_:\n        ;\n    return error;\n}\n</code></pre>\n\n<p>and the statement <code>break;</code> appearing in any of the cases in the first function is equivalent to <code>goto break_</code> in the second.</p>\n\n<p>ps. you won't win any friends writing code like this. People like to pretend that <code>goto</code> is a bad thing in c++ ;-)</p>\n"}, {"tags": [], "owner": {"reputation": 654, "user_id": 4393935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ftOty.jpg?s=128&g=1", "display_name": "Volkan G&#252;ven", "link": "https://stackoverflow.com/users/4393935/volkan-g%c3%bcven"}, "is_accepted": false, "score": 1, "last_activity_date": 1505321909, "last_edit_date": 1505321909, "creation_date": 1505321393, "answer_id": 46202978, "question_id": 46202478, "link": "https://stackoverflow.com/questions/46202478/when-can-i-leave-out-break-in-switch-loop/46202978#46202978", "title": "When can I leave out &quot;break&quot; in switch loop?", "body": "<p>You should be aware that break should be left out on <code>default:</code> (if the default is the last case) where the code flow basically reaches the end and doesn't need to get <code>break</code>.</p>\n\n<p>The very purpose of <code>break</code> is to prevent code to continue to next case(s) when the actual case is true. <code>return</code> however, returns the given statement in the case and breaks the <code>switch</code>. If you are considering to return inside <code>switch</code> cases, then instead of using <code>break</code>, you may use <code>return foobar;</code> It will break by returning whatever you wish to return.</p>\n"}], "owner": {"reputation": 325, "user_id": 8081595, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/48f612dda5803c8d1dd783462feb9b30?s=128&d=identicon&r=PG&f=1", "display_name": "econ", "link": "https://stackoverflow.com/users/8081595/econ"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "closed_date": 1505367912, "answer_count": 5, "score": 0, "last_activity_date": 1505322158, "creation_date": 1505319736, "question_id": 46202478, "link": "https://stackoverflow.com/questions/46202478/when-can-i-leave-out-break-in-switch-loop", "closed_reason": "Needs details or clarity", "title": "When can I leave out &quot;break&quot; in switch loop?", "body": "<p>I just solved 1st exercise on <a href=\"http://www.learncpp.com/cpp-tutorial/78-function-pointers/\" rel=\"nofollow noreferrer\">learncpp, chaper 7.8</a>. I tested their version of switch loop and it works, but I wonder it's without <code>break</code>, shouldn't in this case such code cause undesired behavior? When can I leave out <code>break</code>?</p>\n\n<p>Here is my version(which also works correctly):</p>\n\n<pre><code>switch (op)\n    {\n    case '+': {\n        return add;\n            break;}\n    case '-': {\n        return subtract;\n        break;}\n    case '*': {\n        return multiply;\n        break;}\n    case '/': {\n        return divide;\n        break;}\n    default: ;\n    }\n</code></pre>\n"}, {"tags": ["c++", "qt", "user-interface", "deployment", "console-application"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1505320175, "post_id": 46202414, "comment_id": 79368059, "body": "AFAIK this only happens if you use the &quot;console subsystem&quot;, in VS you can change this by passing <code>&#47;SUBSYSTEM:WINDOWS</code> in the linker settings, maybe you need something similar for Qt?"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1505320600, "post_id": 46202414, "comment_id": 79368307, "body": "Is this on windows? If yes, see <a href=\"https://stackoverflow.com/q/760323/6525260\">here</a>"}, {"owner": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "edited": false, "score": 0, "creation_date": 1505320981, "post_id": 46202414, "comment_id": 79368518, "body": "Try <a href=\"https://stackoverflow.com/a/6882500/1597714\">this</a>"}], "owner": {"reputation": 14802, "user_id": 800123, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/bZMq5.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/800123/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "closed_date": 1505332974, "answer_count": 0, "score": 2, "last_activity_date": 1505319712, "creation_date": 1505319543, "question_id": 46202414, "link": "https://stackoverflow.com/questions/46202414/why-is-my-qt-gui-application-started-by-console-one", "closed_reason": "Duplicate", "title": "Why is my Qt GUI application started by console one?", "body": "<p>I haven't asked that, I created a Qt GUI application that when on release, outside Qt creator it does generate an executable which starts a console application that then start my GUI application. I've used Qt several times before and it never happend. </p>\n\n<p>My .pro file goes as the following:</p>\n\n<pre><code>QT       += core gui\n\ngreaterThan(QT_MAJOR_VERSION, 4): QT += widgets webkitwidgets network script\n\nTARGET = downloader\nTEMPLATE = app\nCONFIG += c++11\n</code></pre>\n\n<p>and the deployment like this:</p>\n\n<pre><code>windeployqt --webkit2 --release full_path\\to\\release\\downloader.exe\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1505319395, "post_id": 46202326, "comment_id": 79367629, "body": "Do some searching for <code>std::stoi</code> and <code>std::to_string</code>."}, {"owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "edited": false, "score": 1, "creation_date": 1505321964, "post_id": 46202326, "comment_id": 79369136, "body": "And make sure you understand the consequences of overflow for individual integer classes. They are among the most frustrating and common mistakes people make when using <code>std::stoi</code>"}, {"owner": {"reputation": 3, "user_id": 8604486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db59a62e644252bf3b5a355b63789641?s=128&d=identicon&r=PG&f=1", "display_name": "Siddhant Rustagi", "link": "https://stackoverflow.com/users/8604486/siddhant-rustagi"}, "edited": false, "score": 0, "creation_date": 1505325063, "post_id": 46202326, "comment_id": 79370875, "body": "i tried using stoi before had no effect, simply wrote tmp=stoi(expressions[i][j]) and gave me a  compiler error and i know about atoi too, thanks for your response"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1505325206, "post_id": 46202326, "comment_id": 79370950, "body": "<code>expressions[i][j]</code> is a single character, not a string. The <code>s</code> in <code>stoi</code> stands for <i>string</i>. If all numbers are single-digit then doing <code>expressions[i][j] - &#39;0&#39;</code> will give you that digit."}, {"owner": {"reputation": 3, "user_id": 8604486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db59a62e644252bf3b5a355b63789641?s=128&d=identicon&r=PG&f=1", "display_name": "Siddhant Rustagi", "link": "https://stackoverflow.com/users/8604486/siddhant-rustagi"}, "edited": false, "score": 0, "creation_date": 1505325399, "post_id": 46202326, "comment_id": 79371063, "body": "how would I get to position after + or / for the next integer?"}, {"owner": {"reputation": 3, "user_id": 8604486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db59a62e644252bf3b5a355b63789641?s=128&d=identicon&r=PG&f=1", "display_name": "Siddhant Rustagi", "link": "https://stackoverflow.com/users/8604486/siddhant-rustagi"}, "edited": false, "score": 0, "creation_date": 1505326724, "post_id": 46202326, "comment_id": 79371788, "body": "1 2/3+55/4 2 3 5 5 4 y\u2219 \u2514z\u2219 \u2514z\u2219 \u2514z\u2219 \u2514z\u2219 &#201;z\u2219  z\u2219 &#199;z\u2219 \u2261y\u2219 This output comes when I wrote cout&lt;&lt;tmp; after a[count]=a[count]*10 + tmp; some runtime issue is occuring which I cant figure"}, {"owner": {"reputation": 3, "user_id": 8604486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db59a62e644252bf3b5a355b63789641?s=128&d=identicon&r=PG&f=1", "display_name": "Siddhant Rustagi", "link": "https://stackoverflow.com/users/8604486/siddhant-rustagi"}, "edited": false, "score": 0, "creation_date": 1505327093, "post_id": 46202326, "comment_id": 79372022, "body": "1 1/2+1/1 1 2 1 1 /*tmp values */ tor::_M_emplace_back_aux   /*vector value*/ another output for reference if it helps"}], "answers": [{"comments": [{"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1505331942, "post_id": 46204431, "comment_id": 79374666, "body": "Since c++17 there will be <a href=\"http://en.cppreference.com/w/cpp/numeric/gcd\" rel=\"nofollow noreferrer\"><code>std::gcd</code></a>, defined in <code>&lt;numeric&gt;</code>. For now it is <a href=\"https://ideone.com/J4Nrzs\" rel=\"nofollow noreferrer\">experimental</a>."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1505332417, "post_id": 46204431, "comment_id": 79374901, "body": "Consider using <code>while ( s != &quot;&quot;)</code> or <code>while( !s.empty() )</code> instead of <code>while(s.compare(&quot;&quot;)!=0)</code>."}], "tags": [], "owner": {"reputation": 3568, "user_id": 5811973, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/B4tie.jpg?s=128&g=1", "display_name": "Ishpreet", "link": "https://stackoverflow.com/users/5811973/ishpreet"}, "is_accepted": false, "score": 0, "last_activity_date": 1505394219, "last_edit_date": 1505394219, "creation_date": 1505326926, "answer_id": 46204431, "question_id": 46202326, "link": "https://stackoverflow.com/questions/46202326/extract-integer-from-string/46204431#46204431", "title": "Extract integer from string", "body": "<p>Use <code>std::stoi</code> to convert <strong>Single</strong> integer from string, <code>std::to_string</code> to convert integer to string and <code>__gcd</code> to calculate <a href=\"https://en.wikipedia.org/wiki/Greatest_common_divisor\" rel=\"nofollow noreferrer\">GCD</a> which is defined in <code>algorithm</code> header file to find reduced form of fraction. </p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\nvector&lt;int&gt;reduced_fraction(vector&lt;int&gt;v)   // Function to find reduced fraction form\n{\n    int num = v[0]*v[3]+v[1]*v[2];         // numerator = a*d+b*c\n    int den = v[1]*v[3];                   // denominator = b*d\n    int gcd = __gcd(num,den);              // gcd = gcd(greatest common divisor) of numerator and denominator\n    num/=gcd;                              // num/den = e/f(reduced fraction)\n    den/=gcd;                              \n    vector&lt;int&gt;frac;\n    frac.push_back(num);\n    frac.push_back(den);\n    return frac; \n}\n\nint main() {\n    string s,st;\n    vector&lt;string&gt;fr;                       // vector to store strings of form a/b+c/d \n    int n=2;                                //Number of Strings\n    for(int i=0;i&lt;n;i++)\n    {\n        cin&gt;&gt;s;\n        fr.push_back(s);\n    }\n    for(int i=0;i&lt;n;i++)\n    {\n        s=fr[i];\n        vector &lt;int&gt;v,red_frac;\n        while(s.compare(\"\")!=0)\n        {\n            if(s.at(0)=='/' || s.at(0)=='+')\n                s.erase(0,1);\n            else\n           {\n                st=to_string(stoi(s));              // fetch integer from string\n                v.push_back(stoi(s));\n                s=s.erase(0,st.length());           // remove integer from string\n            }\n        }\n        red_frac=reduced_fraction(v);               // red_frac-&gt;reduced fraction\n        cout&lt;&lt;red_frac[0]&lt;&lt;\"/\"&lt;&lt;red_frac[1]&lt;&lt;endl;  \n    }\n    return 0;\n}\n\nInput:\n14/2+9/6\n8/4+5/4\n\nOutput:\n17/2\n13/4\n</code></pre>\n\n<p><strong><a href=\"https://ideone.com/CKbba7\" rel=\"nofollow noreferrer\">Ideone Link</a></strong></p>\n"}], "owner": {"reputation": 3, "user_id": 8604486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db59a62e644252bf3b5a355b63789641?s=128&d=identicon&r=PG&f=1", "display_name": "Siddhant Rustagi", "link": "https://stackoverflow.com/users/8604486/siddhant-rustagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505396239, "creation_date": 1505319254, "last_edit_date": 1505396239, "question_id": 46202326, "link": "https://stackoverflow.com/questions/46202326/extract-integer-from-string", "title": "Extract integer from string", "body": "<p>I am new to C++ strings and vectors and would like to know what the issue with this code is, I was provided a vector input of strings in the form \"a/b+c/d\" and had to print a vector in \"e/f\" for where a, b, c, d are integers and e/f is in the reduced fraction form. Please help as I want to learn concept of strings properly and shift to C++ from C</p>\n\n<pre><code>    vector&lt; string &gt; reducedFractionSums(vector &lt; string &gt; expressions) { int a[4]={0,0,0,0}; vector &lt; string &gt; results;\n\n\n    vector &lt; string &gt; results;\n\n    for(int i=0;i&lt;expressions.size();i++){\n        int tmp=0;\n        int count=0;\n        for(int j=0;j&lt;expressions[i].length();j++){\n            if(isdigit(expressions[i][j])){\n            tmp=expressions[i][j];\n            tmp=tmp-48;\n            a[count]=a[count]*10 + tmp;\n            }\n                else\n                count++;    \n        }\n    int min=a[0];\n    for(int i=1;i&lt;4;i++){\n        if(a[i]&lt;min){\n            min=a[i];\n        }\n    }\n    int e,f,g=1;    //g for GreatestCommonDivisor\n    f=a[1]*a[3];\n    e=(a[0]*a[3])+(a[2]*a[1]);\n    for(int i=1;i&lt;=min;i++){\n        if(e%i==0 &amp;&amp; f%i==0){\n            g=i;\n        }\n    }\n    e=e/g;\n    f=f/g;\n        results.push_back(e + \"/\" + f);\n    }  \n    return results;\n}\nint main(){\n    vector &lt; string &gt; input;\n    vector &lt; string &gt; output;\n    int t;\n    cin&gt;&gt;t;\n    while(t--){\n        string s;\n        cin&gt;&gt;s;\n        input.push_back(s);\n    }\n    output=reducedFractionSums(input);\n    for(int i = 0;i&lt;output.size();i++){\n        cout&lt;&lt;output.at(i);\n    }\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1505318542, "post_id": 46202087, "comment_id": 79367101, "body": "What happens when you call <code>check()</code> when <code>&amp;r == this</code> but <code>&amp;l != this</code>?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1505318911, "post_id": 46202087, "comment_id": 79367331, "body": "@cdhowie Could that happen? Given that the only constructor applies the same rule to both <code>&amp;l</code> and <code>&amp;r</code>?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1505319358, "post_id": 46202087, "comment_id": 79367612, "body": "Hang, not sure actually..."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1505319517, "post_id": 46202087, "comment_id": 79367686, "body": "Could it be that the implementation of <code>deque</code> you&#39;re using is not Standard-compliant and invalidates references?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1505319621, "post_id": 46202087, "comment_id": 79367744, "body": "@VittorioRomeo Could be, this fails on both MSVC and gcc. I haven&#39;t tried clang yet."}, {"owner": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "edited": false, "score": 1, "creation_date": 1505319622, "post_id": 46202087, "comment_id": 79367746, "body": "Could be something with the way arguments are forwarded to the constructor. Replacing <code>emplace_back(d - 1, pool)</code> with <code>emplace_back(Node(d - 1, pool))</code> seems not to crash."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "edited": false, "score": 1, "creation_date": 1505319675, "post_id": 46202087, "comment_id": 79367790, "body": "@AMA that might be undefined behavior as the <code>Node</code> is destroyed after the constructor exits."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "edited": false, "score": 0, "creation_date": 1505321520, "post_id": 46202087, "comment_id": 79368876, "body": "@AMA, upon second thought that might actually work if <code>std::deque</code> uses the copy constructor. It just happens to still fail for the same reasons as the original program."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "edited": false, "score": 0, "creation_date": 1505323795, "post_id": 46202087, "comment_id": 79370120, "body": "@AMA That is a very interesting idea. It does not suffer from the original problem (see my answer) and no parent ends up referring to a temporary child that was already destructed. The problem is that in the leaf nodes, instead <code>this</code> in <code>l</code> and <code>r</code> they end up with a reference to the destroyed temporary."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1505324878, "post_id": 46202087, "comment_id": 79370751, "body": "I think the fundamental problem is that <code>emplace_back</code> returns <code>back()</code>, which will not be the expected element when the constructor of the emplaced element adds another element to the deque."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1505326731, "post_id": 46202087, "comment_id": 79371797, "body": "@1201ProgramAlarm It depends on how <code>std::deque</code> is implemented on what exactly goes wrong. For example, perhaps it does a placement new on the final element, and ends up doing a placement new in the same place. Or some other weird thing."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 3808, "user_id": 1597714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/mH9hv.png?s=128&g=1", "display_name": "AMA", "link": "https://stackoverflow.com/users/1597714/ama"}, "edited": false, "score": 0, "creation_date": 1505326759, "post_id": 46202087, "comment_id": 79371821, "body": "@AMA I actually got your idea to work by just tweaking the copy constructor. I think I have actually finished my answer now :-)"}], "answers": [{"comments": [{"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 1, "creation_date": 1505319973, "post_id": 46202508, "comment_id": 79367946, "body": "I suppose you&#39;re right but... can you imagine a solution (&quot;How can the references be correctly initialized?&quot;)?"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 3, "creation_date": 1505320104, "post_id": 46202508, "comment_id": 79368020, "body": "Standard quote would be a nice addition"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 1, "creation_date": 1505320841, "post_id": 46202508, "comment_id": 79368439, "body": "well... if I understand correctly, the point of your solution is transform <code>l</code> and <code>r</code> in pointer instead of references; I suspect that can be the only reasonable way but (IMHO) would be intriguing a solution that maintain <code>l</code> and <code>r</code> as references (but no idea how to do it)"}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1505323086, "post_id": 46202508, "comment_id": 79369733, "body": "@max66 I added two more solutions, which use reference members instead of pointers. The first allocates <code>l</code> and <code>r</code> before the parent&#39;s constructor is called. The final one doesn&#39;t use <code>std::deque</code> to actually call the <code>Node</code> constructor (so I think that solution is not so nice)."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1505323470, "post_id": 46202508, "comment_id": 79369924, "body": "@ArthurTacca - yes: I was also thinking to something similar to your solution unique-pointer based bat seem to me that your solution is better (sorry but I can&#39;t give you more than a +1 :) ); just a little suggestion: in constructors avoid to call input parameters exactly as the member of the class; works but is confusion prone; I suggest you something like <code>Node(int d, Node* l0, Node* r0) : level{d}, l{l0 ? *l0 : *this}, r{r0 ? *r0 : *this}</code>"}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1505324085, "post_id": 46202508, "comment_id": 79370287, "body": "@max66 Good idea! I actually don&#39;t mind constructor arguments with exactly the same name as members if they are copied or moved exactly, but that isn&#39;t the case here."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1505326643, "post_id": 46202508, "comment_id": 79371733, "body": "@T.C. Thanks! I have added it."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "edited": false, "score": 0, "creation_date": 1505329272, "post_id": 46202508, "comment_id": 79373252, "body": "Solution 4 works because the <code>Node(int, Pool&amp;)</code> constructor calls itself and <code>emplace_back()</code>, but <code>emplace_back()</code> only calls the copy constructor <code>Node(const Node&amp;)</code>. Then, the important bit is that the copy constructor does <i>not</i> call <code>emplace_back()</code>. At the end, all references are to <code>*this</code> or the return value of <code>emplace_back()</code>, so none are to temporaries. Considering that references are syntactic sugar for pointers, it does essentially the same thing as solution 1, in a way that is cleverer but (in my opinion) less clear."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1505332061, "post_id": 46202508, "comment_id": 79374731, "body": "This is going to take me some time to digest, but I think there is more to solution 4 and I can&#39;t shake the feeling that there is still some implementation defined behavior that is being relied upon. Specifically it seems to me as though the constructor is still reentering the deque, but that the copy constructor is saving the day by resetting the l and r references to the <code>this</code> of the copied instance."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1505337037, "post_id": 46202508, "comment_id": 79377157, "body": "@rex I added a diagram showing what calls what in each of the solutions, in case that helps a bit."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1505339059, "post_id": 46202508, "comment_id": 79377956, "body": "@rex BTW The <code>*this</code> stuff is separate from the two-constructor trick really. It&#39;s just a symptom of the fact that sometimes there is no suitable value, and you can&#39;t have a null reference, so you&#39;re using <code>*this</code> as a dummy reference. I&#39;ve made an example using a reference to an actual dummy object, and another using pointers/<code>nullptr</code>, but otherwise the same as solution 4. I put them in <a href=\"https://gist.github.com/arthur-tacca/9c53fa4725b69453062aa226641d04a8\" rel=\"nofollow noreferrer\">this gist</a> because the answer&#39;s getting a bit long. (Warning: I didn&#39;t test that code.)"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1505340451, "post_id": 46202508, "comment_id": 79378417, "body": "I&#39;ll take a look. Thanks for a great answer."}, {"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1505397816, "post_id": 46202508, "comment_id": 79405215, "body": "Wow, this isn&#39;t an answer, it&#39;s an almanach\u2026 one remark: In solution 2, you mention that the order of elements is reversed. If this is even considered a problem, it could be solved by swapping the recursive <code>make</code> calls, and using <code>emplace_front</code> and <code>front</code>."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 1, "creation_date": 1505398431, "post_id": 46202508, "comment_id": 79405659, "body": "@ArneVogel Good idea, although that would still have different behaviour if you built two unrelated trees using the same pool."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1505415023, "post_id": 46202508, "comment_id": 79416223, "body": "@ArthurTacca - greath answer! I&#39;ve written a little answer with (only) a possible solution that is inspired to your 2 and 4 solutions; if you find it interesting, feel free to absorb my solution in your answer."}], "tags": [], "owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "is_accepted": true, "score": 14, "last_activity_date": 1505378614, "last_edit_date": 1505378614, "creation_date": 1505319850, "answer_id": 46202508, "question_id": 46202087, "link": "https://stackoverflow.com/questions/46202087/tree-elements-initialized-with-references-to-emplaced-deque-members-results-in-n/46202508#46202508", "title": "Tree elements initialized with references to emplaced deque members results in nullptr for this", "body": "<h1>Summary</h1>\n\n<p>The problem is that you're calling <code>emplace_back</code> on the <code>deque</code> <em>from</em> a constructor being called by <code>emplace_back</code>. You are not allowed to modify a container while one of its methods is already in progress. This is prohibited by <a href=\"https://timsong-cpp.github.io/cppwp/reentrancy\" rel=\"nofollow noreferrer\">section [reentrancy] of the C++ standard</a> (thanks to @T.C.).</p>\n\n<blockquote>\n  <p>Except where explicitly specified in this International Standard, it is implementation-defined which functions in the C++ standard library may be recursively reentered.</p>\n</blockquote>\n\n<p>To see why this sort of thing isn't allowed, here is a more obvious example. Imagine calling <code>std::vector::push_back()</code> from a copy constructor which is being invoked by <code>std::vector</code> during reallocation for another <code>push_back()</code> in progress. Reallocation works by allocating the new chunk of memory before freeing the old one, so you'd temporarily end up with three chunks, and at best the two new elements might end up in different \"new\" chunks.</p>\n\n<h1>Solution overview</h1>\n\n<p>Fundamentally, the problem is the combination of two things: </p>\n\n<ul>\n<li><code>std::deque&lt;Node&gt;::emplace_back()</code> is being called <em>by</em> <code>Node::Node(...)</code></li>\n<li><code>std::deque&lt;Node&gt;::emplace_back()</code> is making a call <em>to</em> <code>Node::Node(...)</code></li>\n</ul>\n\n<p>Combining these two problems, <code>std::deque::emplace_back()</code> ends up calling itself. The solution is therefore to fix one of these two things.</p>\n\n<h1>Specific solutions</h1>\n\n<ol>\n<li>Use a wrapper function, which I call <code>make()</code>. <code>make()</code> calls itself, and calls <code>emplace_back()</code> (which calls <code>Node::Node(...)</code>), but <code>Node::Node(...)</code> never calls <code>emplace_back()</code>.</li>\n<li>This is a variation on the idea of (1). It also uses a wrapper function, but it uses reference members (like the original question) so it has to construct the child nodes first.</li>\n<li>This fixes the other problem: <code>Node::Node(...)</code> is allowed to <code>emplace_back()</code>, but this time <code>emplace_back()</code> is not allowed to construct <code>Node</code> objects. The way I do this is that I use a deque of <em>pointers</em> to <code>Node</code> objects. However, as written this solution is not exception safe, and I consider it much uglier than the other solutions.</li>\n<li>This is essentially @AMA's ingenious idea: I again use a wrapper function, but this time the wrapper function is called <code>Node::Node(int, Pool&amp;)</code>! The point is, this calls itself and <code>emplace_back()</code>. But <code>emplace_back()</code> calls a <em>different</em> constructor, namely the copy constructor, which I write manually to avoid it copying references to temporaries, and which never calls back to <code>emplace_back()</code>.</li>\n<li>Bonus solution! Part of the complexity here is due to using <code>*this</code> as a sentinel value. Using pointers with <code>nullptr</code> is more conventional. This solution does this (so uses pointer members like solution 1), and creates the child nodes first (like solution 2), and as a bonus the creation is totally non-invasive.</li>\n</ol>\n\n<h2>Solution 1: Wrapper function and pointers</h2>\n\n<pre><code>#include &lt;deque&gt;\n\nstruct Node;\nusing Pool = std::deque&lt;Node&gt;;\n\nstruct Node\n{\n    Node(int d)\n        : level{d}, l{this}, r{this}\n    {\n    }\n    static Node&amp; make(int d, Pool&amp; pool)\n    {\n        pool.emplace_back(d);\n        Node&amp; result = pool.back();\n        if (d &gt; 0) {\n            result.l = &amp;make(d - 1, pool);\n            result.r = &amp;make(d - 1, pool);\n        }\n        return result;\n    }\n\n    int level;\n    const Node* l;\n    const Node* r;\n\n    int check() const\n    {\n        if(l != this)\n            return l-&gt;check() + 1 + r-&gt;check();\n        else\n            return 1;\n    }\n};\n\nint main()\n{\n    int depth{2};\n    Pool pool;\n    Node&amp; c = Node::make(depth, pool);\n    return c.check()==7 ? 0 : 1;\n}\n</code></pre>\n\n<h2>Solution 2: Wrapper function with reference members</h2>\n\n<p>Note: this changes the order of elements in the <code>deque</code>: child elements are inserted first, so they are now earlier than their parents.</p>\n\n<pre><code>#include &lt;deque&gt;\n\nstruct Node;\nusing Pool = std::deque&lt;Node&gt;;\n\nstruct Node\n{\n    static Node&amp; make(int d, Pool&amp; pool)\n    {\n        Node* l = nullptr;\n        Node* r = nullptr;\n        if (d &gt; 0) {\n            l = &amp;make(d - 1, pool);\n            r = &amp;make(d - 1, pool);\n        }\n        pool.emplace_back(d, l, r);\n        return pool.back();\n    }\n\n    Node(int d, Node* l_ptr, Node* r_ptr)\n        : level{d}\n        , l{l_ptr ? *l_ptr : *this}\n        , r{r_ptr ? *r_ptr : *this}\n    {\n    }\n\n    int level;\n    const Node&amp; l;\n    const Node&amp; r;\n\n    int check() const\n    {\n        if(!(&amp;l == this))\n            return l.check() + 1 + r.check();\n        else\n            return 1;\n    }\n};\n\nint main()\n{\n    int depth{2};\n    Pool pool;\n    Node&amp; c = Node::make(depth, pool);\n    return c.check()==7 ? 0 : 1;\n}\n</code></pre>\n\n<h2>Solution 3: pointers in the container</h2>\n\n<p>This uses references, and avoids an auxiliary function, and stores elements in the pool in the correct order. In its current form it is <em>NOT EXCEPTION SAFE</em> e.g. if the call to <code>new</code> for <code>r</code> throws an exception (e.g. <code>std::bad_alloc</code>) then <code>l</code> will not be freed. This would be tricky to sort out, and ultimately I think the other solutions would be neater.</p>\n\n<pre><code>#include &lt;deque&gt;\n#include &lt;memory&gt;\n\nstruct Node;\nusing Pool = std::deque&lt;std::unique_ptr&lt;const Node&gt;&gt;;\n\nstruct Node\n{\n    Node(int d, Pool&amp; pool)\n        : level{d}\n        , l{d &gt; 0 ? *new Node(d - 1, pool) : *this}\n        , r{d &gt; 0 ? *new Node(d - 1, pool) : *this}\n    {\n        if (&amp;l != this) {\n            pool.emplace_back(&amp;l);\n        }\n        if (&amp;r != this) {\n            pool.emplace_back(&amp;r);\n        }\n    }\n\n    int level;\n    const Node&amp; l;\n    const Node&amp; r;\n\n    int check() const\n    {\n        if(!(&amp;l == this))\n            return l.check() + 1 + r.check();\n        else\n            return 1;\n    }\n};\n\nint main()\n{\n    int depth{2};\n    Pool pool;\n    Node c(depth, pool);\n    return c.check()==7 ? 0 : 1;\n}\n</code></pre>\n\n<h2>Solution 4: Two constructors</h2>\n\n<p>This is arguably the simplest solution, but I would argue that it's not completely obvious that it doesn't keep any dangling references to temporary objects, unlike solution 1 and solution 2.</p>\n\n<pre><code>#include &lt;deque&gt;\n\nstruct Node;\nusing Pool = std::deque&lt;Node&gt;;\n\nstruct Node\n{\n    Node(int d, Pool&amp; pool)\n        : level{d}\n        , l{d &gt; 0 ? pool.emplace_back(Node(d - 1, pool)) : *this}\n        , r{d &gt; 0 ? pool.emplace_back(Node(d - 1, pool)) : *this}\n    {\n    }\n\n    Node(const Node&amp; other)\n        : level{other.level}\n        , l{&amp;other.l == &amp;other ? *this : other.l}\n        , r{&amp;other.r == &amp;other ? *this : other.r}\n    {\n    }\n\n    int level;\n    const Node&amp; l;\n    const Node&amp; r;\n\n    int check() const\n    {\n        if(!(&amp;l == this))\n            return l.check() + 1 + r.check();\n        else\n            return 1;\n    }\n};\n</code></pre>\n\n<h2>Bonus solution: Pointers, wrapper function and nullptr</h2>\n\n<p>The simplest solution is if you're prepared to use pointers, construct child nodes first, and use <code>nullptr</code> instead of <code>this</code> as a sentinel value. Note that <code>Node</code> is now cleanly separated from <code>Pool</code> and <code>make()</code>.</p>\n\n<pre><code>#include &lt;deque&gt;\n\nstruct Node {\n    int level;\n    const Node* const l;\n    const Node* const r;\n\n    Node(int level, const Node* l, const Node* r):\n        level(level), l(l), r(r)\n    {\n    }\n\n    int check() const\n    {\n        if(l)\n            return l-&gt;check() + 1 + r-&gt;check();\n        else\n            return 1;\n    }\n};\n\nusing Pool = std::deque&lt;Node&gt;;\n\nNode* make(int d, Pool&amp; pool)\n{\n    Node* l = d &gt; 0 ? make(d - 1, pool) : nullptr;\n    Node* r = d &gt; 0 ? make(d - 1, pool) : nullptr;\n    return &amp;pool.emplace_back(d, l, r);\n}\n</code></pre>\n\n<h1>Diagram of solutions</h1>\n\n<p><a href=\"https://i.stack.imgur.com/IyTuc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IyTuc.png\" alt=\"Diagram showing calling patterns in solutions\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 2, "last_activity_date": 1505414848, "creation_date": 1505414848, "answer_id": 46226296, "question_id": 46202087, "link": "https://stackoverflow.com/questions/46202087/tree-elements-initialized-with-references-to-emplaced-deque-members-results-in-n/46226296#46226296", "title": "Tree elements initialized with references to emplaced deque members results in nullptr for this", "body": "<p>A solution inspired from solutions 2 and 4 from Arthur Tacca answer (if you like it, give a +1 to Arthur; if you don't like it: it's my fault).</p>\n\n<p>This solution use a second constructor (as solution 4) but call it directly (as delegating constructor) an a static method (inspired by solution 2) used to create the childs of the new node.</p>\n\n<p>Remain unaltered the main point from Arthur: it's necessary to avoid a <code>emplace_back()</code> that call itself and insert the child nodes before the father.</p>\n\n<p>Works also with c++11</p>\n\n<pre><code>#include &lt;deque&gt;\n\nstruct Node;\n\nusing Pool = std::deque&lt;Node&gt;;\n\nstruct Node\n {\n   Node (int d, Pool &amp; pool, Node const * pl, Node const * pr)\n      : level { d }, l { pl ? *pl : *this }, r { pr ? *pr : *this }\n    { }\n\n   static Node const * getChild (int d, Pool &amp; pool)\n    {\n      Node const * ret { nullptr };\n\n      if ( d-- &gt; 0 )\n       {\n         pool.emplace_back(d, pool, getChild(d, pool), getChild(d, pool));\n\n         ret = &amp; pool.back();\n       }\n\n      return ret;\n    }\n\n   Node (int d, Pool&amp; pool)\n      : Node { d, pool, getChild(d, pool), getChild(d, pool) }\n    { }\n\n   int level;\n\n   Node const &amp; l;\n   Node const &amp; r;\n\n   int check() const\n    { return (!(&amp;l == this)) ? l.check() + 1 + r.check() : 1 ; }\n };\n\nint main ()\n {\n   int depth{2};\n   Pool pool;\n   Node c(depth, pool);\n\n   return c.check()==7 ? 0 : 1;\n }\n</code></pre>\n"}], "owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 2, "accepted_answer_id": 46202508, "answer_count": 2, "score": 6, "last_activity_date": 1505414848, "creation_date": 1505318368, "question_id": 46202087, "link": "https://stackoverflow.com/questions/46202087/tree-elements-initialized-with-references-to-emplaced-deque-members-results-in-n", "title": "Tree elements initialized with references to emplaced deque members results in nullptr for this", "body": "<p>The <a href=\"http://coliru.stacked-crooked.com/a/6d02e382baf2f26d\" rel=\"noreferrer\">following program</a> attempts to create a tree of nodes consisting of references to <code>std::deque</code> elements.</p>\n\n<pre><code>#include &lt;deque&gt;\n\nstruct Node;\nusing Pool = std::deque&lt;Node&gt;;\n\nstruct Node\n{\n    Node(int d, Pool&amp; pool)\n        : level{d}\n        , l{d &gt; 0 ? pool.emplace_back(d - 1, pool) : *this}\n        , r{d &gt; 0 ? pool.emplace_back(d - 1, pool) : *this}\n    {\n    }\n\n    int level;\n    const Node&amp; l;\n    const Node&amp; r;\n\n    int check() const\n    {\n        if(!(&amp;l == this))\n            return l.check() + 1 + r.check();\n        else\n            return 1;\n    }\n};\n\nint main()\n{\n    int depth{2};\n    Pool pool;\n    Node c(depth, pool);\n    return c.check()==7 ? 0 : 1;\n}\n</code></pre>\n\n<p>It creates the correct number of elements, but not all references are initialized to the emplaced elements and the <code>level</code> variable is not set for levels higher than <code>0</code>.</p>\n\n<p>Finally, program fails due to <code>this</code> being a <code>nullptr</code> when the <code>check()</code> function is executed.</p>\n\n<p>How can the references be correctly initialized?</p>\n"}, {"tags": ["c++", "parsing", "boost", "boost-spirit-qi"], "answers": [{"tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1505320661, "creation_date": 1505320661, "answer_id": 46202765, "question_id": 46202007, "link": "https://stackoverflow.com/questions/46202007/boostspiritqi-grammar-using-grammars-with-different-iterator-types/46202765#46202765", "title": "boost::spirit::qi grammar using grammars with different iterator types", "body": "<p>You can't use sub grammars of different iterator types. For the obvious reason that you won't magically be parsing different sets of input.</p>\n\n<p>A single input implies a single input iterator range.</p>\n\n<p>Just defer the decision about iterator type to the toplevel instantiator:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/8e0cc0127c067888\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/fusion/include/adapt_struct.hpp&gt;\n#include &lt;boost/spirit/home/qi.hpp&gt;\n#include &lt;boost/variant.hpp&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n\nnamespace qi    = boost::spirit::qi;\nnamespace ascii = boost::spirit::ascii;\n\nstruct attr_1 {\n    std::string a;\n};\nBOOST_FUSION_ADAPT_STRUCT(attr_1, (std::string, a))\n\nstruct attr_2 {\n    double a;\n};\nBOOST_FUSION_ADAPT_STRUCT(attr_2, (double, a))\n\ntemplate &lt;typename It = const char *&gt; struct grammar_1 : qi::grammar&lt;It, attr_1()&gt; {\n    grammar_1() : grammar_1::base_type{ rule_ } { rule_ = qi::eps &gt;&gt; +ascii::upper; }\n\n  private:\n    qi::rule&lt;It, attr_1()&gt; rule_;\n};\n\ntemplate &lt;typename It = std::string::const_iterator&gt; struct grammar_2 : qi::grammar&lt;It, attr_2()&gt; {\n    grammar_2() : grammar_2::base_type{ rule_ } { rule_ = qi::double_; }\n\n  private:\n    qi::rule&lt;It, attr_2()&gt; rule_;\n};\n\ntypedef boost::variant&lt;attr_1, attr_2&gt; attr_comp;\n\ntemplate &lt;typename It = std::string::const_iterator&gt; struct grammar_comp : qi::grammar&lt;It, attr_comp()&gt; {\n    grammar_comp() : grammar_comp::base_type{ rule_ } { rule_ = (g1_ | g2_); }\n\n  private:\n    grammar_1&lt;It&gt; g1_;\n    grammar_2&lt;It&gt; g2_;\n    qi::rule&lt;It, attr_comp()&gt; rule_;\n};\n\nint main() {\n    std::istringstream iss(\"3\\n13.2\\nCIAO\\nFOOFOOfoo\\n\");\n\n    grammar_comp&lt;&gt; gg_;\n    attr_comp aa_;\n    std::string s;\n\n    while (std::getline(iss, s)) {\n        auto it = s.cbegin();\n        if (qi::parse(it, s.cend(), gg_, aa_)) {\n            std::cout &lt;&lt; s &lt;&lt; std::endl;\n            std::cout &lt;&lt; std::endl;\n        }\n    }\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>3\n\n13.2\n\nCIAO\n\nFOOFOOfoo\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 3540528, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59d31cc1b5c8087d3c8727a9e41c7552?s=128&d=identicon&r=PG&f=1", "display_name": "Davide", "link": "https://stackoverflow.com/users/3540528/davide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 46202765, "answer_count": 1, "score": 1, "last_activity_date": 1505320661, "creation_date": 1505318127, "question_id": 46202007, "link": "https://stackoverflow.com/questions/46202007/boostspiritqi-grammar-using-grammars-with-different-iterator-types", "title": "boost::spirit::qi grammar using grammars with different iterator types", "body": "<p>I'm facing a problem with <code>boost::spirit::qi</code>. I have defined the following two parsers:</p>\n\n<pre><code>struct attr_1 { std::string a; };\nBOOST_FUSION_ADAPT_STRUCT(attr_1, (std::string, a))\n\nstruct attr_2 { double a; };\nBOOST_FUSION_ADAPT_STRUCT(attr_2, (double, a))\n\nstruct grammar_1 : boost::spirit::qi::grammar&lt;const char*, attr_1()&gt; {\n    grammar_1() : grammar_1::base_type{rule_} { \n        rule_ = boost::spirit::qi::eps &gt;&gt; +boost::spirit::ascii::upper; \n    }\nprivate:\n    boost::spirit::qi::rule&lt;const char*, attr_1()&gt; rule_;\n};\n\nstruct grammar_2 : boost::spirit::qi::grammar&lt;std::string::iterator, attr_2()&gt; {\n    grammar_2() : grammar_2::base_type{rule_} { \n        rule_ = boost::spirit::qi::double_; \n    }\nprivate:\n    boost::spirit::qi::rule&lt;std::string::iterator, attr_2()&gt; rule_;\n};\n</code></pre>\n\n<p>Now, I would like to write a third grammar using the previous ones, as follows:</p>\n\n<pre><code>typedef boost::variant&lt;attr_1, attr_2&gt; attr_comp;\n\nstruct grammar_comp : boost::spirit::qi::grammar&lt;????, attr_comp()&gt; {\n    grammar_comp() : grammar_comp::base_type{rule_} { \n        rule_ = (g1_ | g2_); \n    }\nprivate:\n    grammar_1 g1_;\n    grammar_2 g2_;\n    boost::spirit::qi::rule&lt;????, attr_comp()&gt; rule_;\n};\n</code></pre>\n\n<p>Since <code>grammar_1</code> and <code>grammar_2</code> have different iterators type, which type should I place in the definition of the new grammar?</p>\n\n<p>Here is a (non-compiling) simplified example:</p>\n\n<pre><code>#include &lt;boost/fusion/include/adapt_struct.hpp&gt;\n#include &lt;boost/spirit/home/qi.hpp&gt;\n#include &lt;boost/variant.hpp&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n\nstruct attr_1 { std::string a; };\nBOOST_FUSION_ADAPT_STRUCT(attr_1, (std::string, a))\n\nstruct attr_2 { double a; };\nBOOST_FUSION_ADAPT_STRUCT(attr_2, (double, a))\n\nstruct grammar_1 : boost::spirit::qi::grammar&lt;const char*, attr_1()&gt; {\n    grammar_1() : grammar_1::base_type{rule_} { \n        rule_ = boost::spirit::qi::eps &gt;&gt; +boost::spirit::ascii::upper; \n    }\nprivate:\n    boost::spirit::qi::rule&lt;const char*, attr_1()&gt; rule_;\n};\n\nstruct grammar_2 : boost::spirit::qi::grammar&lt;std::string::iterator, attr_2()&gt; {\n    grammar_2() : grammar_2::base_type{rule_} { \n        rule_ = boost::spirit::qi::double_; \n    }\nprivate:\n    boost::spirit::qi::rule&lt;std::string::iterator, attr_2()&gt; rule_;\n};\n\ntypedef boost::variant&lt;attr_1, attr_2&gt; attr_comp;\n\nstruct grammar_comp : boost::spirit::qi::grammar&lt;????, attr_comp()&gt; {\n    grammar_comp() : grammar_comp::base_type{rule_} { \n        rule_ = (g1_ | g2_); \n    }\nprivate:\n    grammar_1 g1_;\n    grammar_2 g2_;\n    boost::spirit::qi::rule&lt;????, attr_comp()&gt; rule_;\n};\n\nint main() {\n    std::string s;\n    std::istringstream iss(\"3\\n13.2\\nCIAO\\nFOOFOOfoo\\n\");\n    grammar_comp gg_;\n    attr_comp aa_;\n    while (std::getline(iss, s)){\n        auto it = s.begin();\n        if (boost::spirit::qi::parse(it, s.end(), gg_, aa_)) {\n            std::cout &lt;&lt; s &lt;&lt; std::endl;\n            std::cout &lt;&lt; std::endl;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "cmake", "numa"], "answers": [{"comments": [{"owner": {"reputation": 430, "user_id": 2339855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BMtCI.png?s=128&g=1", "display_name": "Marcus Karpoff", "link": "https://stackoverflow.com/users/2339855/marcus-karpoff"}, "reply_to_user": {"reputation": 337, "user_id": 7701969, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1856690234584268/picture?type=large", "display_name": "Khang Truong", "link": "https://stackoverflow.com/users/7701969/khang-truong"}, "edited": false, "score": 0, "creation_date": 1505319406, "post_id": 46202059, "comment_id": 79367631, "body": "you also need to add the include_director for headers this will be <code>include_directories(&#47;home&#47;khangtg&#47;opt&#47;include)</code>"}], "tags": [], "owner": {"reputation": 430, "user_id": 2339855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BMtCI.png?s=128&g=1", "display_name": "Marcus Karpoff", "link": "https://stackoverflow.com/users/2339855/marcus-karpoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1505319616, "last_edit_date": 1505319616, "creation_date": 1505318266, "answer_id": 46202059, "question_id": 46201935, "link": "https://stackoverflow.com/questions/46201935/link-to-static-library-by-cmake/46202059#46202059", "title": "Link to static library by cmake", "body": "<p>you want to set the <code>link_directories</code> to include the directory of the libraries. More can be found <a href=\"https://cmake.org/cmake/help/v3.0/command/link_directories.html\" rel=\"nofollow noreferrer\">in the cmake docs</a>. This tells the linker where to look for the libraries.</p>\n\n<p>It should probably look something like this</p>\n\n<pre><code>link_directories(/home/khangtg/opt/lib)\n</code></pre>\n\n<p>Also add the include directories command from <a href=\"https://cmake.org/cmake/help/v3.0/command/include_directories.html\" rel=\"nofollow noreferrer\">this documentation</a>.\nThis will look like this</p>\n\n<pre><code>include_directories(/home/khangtg/opt/include)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 337, "user_id": 7701969, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1856690234584268/picture?type=large", "display_name": "Khang Truong", "link": "https://stackoverflow.com/users/7701969/khang-truong"}, "edited": false, "score": 0, "creation_date": 1505319219, "post_id": 46202131, "comment_id": 79367521, "body": "It actually fixes the error include, but I see the other error here:      /usr/bin/ld: cannot find -lnuma.     collect2: error: ld returned 1 exit status.     make[2]: *** [src/format] Error 1.     make[1]: *** [src/CMakeFiles/format.dir/all] Error 2.     make[1]: *** Waiting for unfinished jobs...."}], "tags": [], "owner": {"reputation": 333, "user_id": 6168549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04203874c94da7b9bcd58f6096ae8375?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos", "link": "https://stackoverflow.com/users/6168549/carlos"}, "is_accepted": false, "score": 0, "last_activity_date": 1505318515, "creation_date": 1505318515, "answer_id": 46202131, "question_id": 46201935, "link": "https://stackoverflow.com/questions/46201935/link-to-static-library-by-cmake/46202131#46202131", "title": "Link to static library by cmake", "body": "<p>This might be useful to add to your cmake build file:</p>\n\n<pre><code>include_directories(\"/home/khangtg/opt/include\")\n</code></pre>\n\n<p>From: <a href=\"https://cmake.org/cmake-tutorial/\" rel=\"nofollow noreferrer\">cmake tutorial</a></p>\n\n<p>You may also want to change the include to :</p>\n\n<pre><code>#include \"numa.h\"\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 7701969, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1856690234584268/picture?type=large", "display_name": "Khang Truong", "link": "https://stackoverflow.com/users/7701969/khang-truong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2798, "favorite_count": 0, "accepted_answer_id": 46202059, "answer_count": 2, "score": 2, "last_activity_date": 1505319616, "creation_date": 1505317928, "question_id": 46201935, "link": "https://stackoverflow.com/questions/46201935/link-to-static-library-by-cmake", "title": "Link to static library by cmake", "body": "<p>I have a project C++ using libnuma library. Because I don't have permission to install libnuma in the root system, so I have to install it in folder of user: /home/khangtg/opt. This folder contains 2 main folders:</p>\n\n<ul>\n<li>Folder <strong>include</strong> contains: numacompat1.h, numa.h, numaif.h</li>\n<li>Folder <strong>lib</strong> contains: libnuma.a, libnuma.la, libnuma.so, libnuma.so.1, libnuma.so.1.0.0</li>\n</ul>\n\n<p>Now, I have a file .cpp include libnuma library:</p>\n\n<pre><code>#include &lt;numa.h&gt;\n</code></pre>\n\n<p>and I build the project by file CMakeLists.txt with content:</p>\n\n<pre><code>add_library (common Bigraph.cpp AdjList.cpp Vocab.cpp NumaArray.cpp clock.cpp)\nset (LINK_LIBS ${LINK_LIBS} common gflags numa )\n\nadd_executable (warplda main.cpp lda.cpp warplda.cpp)\nadd_executable (format format.cpp)\n\ntarget_link_libraries (warplda ${LINK_LIBS})\ntarget_link_libraries (format ${LINK_LIBS})\n</code></pre>\n\n<p>After run cmake command, I get some error that is \"can not include numa.h\".</p>\n\n<p>So, how can I fix this error and build the project by cmake. Many thanks!</p>\n"}, {"tags": ["c++", "time", "epoch", "filetime"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1505317887, "post_id": 46201834, "comment_id": 79366666, "body": "One millisecond = 1/1000th of a second. Why are you multiplying by ten million?"}, {"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 0, "creation_date": 1505317954, "post_id": 46201834, "comment_id": 79366706, "body": "The first filetime converter I looked up (<a href=\"http://www.silisoftware.com/tools/date.php?inputdate=1505306792&amp;inputformat=unix\" rel=\"nofollow noreferrer\">silisoftware.com/tools/&hellip;</a>), when you use its default settings and enter 1505306792, you get an output of Wednesday, September 13, 2017 12:46:32pm.  Based on its default, I think you need to focus on the input format being unix."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1505318070, "post_id": 46201834, "comment_id": 79366786, "body": "There&#39;s an epoch difference: <a href=\"https://stackoverflow.com/questions/6161776/convert-windows-filetime-to-second-in-unix-linux\" title=\"convert windows filetime to second in unix linux\">stackoverflow.com/questions/6161776/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505318045, "post_id": 46201945, "comment_id": 79366768, "body": "Windows uses January 1, 1601 as an epoch? How utterly bizarre."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1505318086, "post_id": 46201945, "comment_id": 79366796, "body": "Obviously people need spreadsheets that go back that far. And no further."}], "tags": [], "owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "is_accepted": false, "score": 3, "last_activity_date": 1505318128, "last_edit_date": 1505318128, "creation_date": 1505317958, "answer_id": 46201945, "question_id": 46201834, "link": "https://stackoverflow.com/questions/46201834/how-to-convert-milli-seconds-time-to-filetime-in-c/46201945#46201945", "title": "How to convert milli seconds time to FILETIME in c++", "body": "<p>It's about adding 116444736000000000, see <a href=\"https://support.microsoft.com/en-us/help/167296/how-to-convert-a-unix-time-t-to-a-win32-filetime-or-systemtime\" rel=\"nofollow noreferrer\">How To Convert a UNIX time_t to a Win32 FILETIME or SYSTEMTIME</a>:</p>\n\n<pre><code>   #include &lt;winbase.h&gt;\n   #include &lt;winnt.h&gt;\n   #include &lt;time.h&gt;\n\n   void UnixTimeToFileTime(time_t t, LPFILETIME pft)\n   {\n     // Note that LONGLONG is a 64-bit value\n     LONGLONG ll;\n\n     ll = Int32x32To64(t, 10000000) + 116444736000000000;\n     pft-&gt;dwLowDateTime = (DWORD)ll;\n     pft-&gt;dwHighDateTime = ll &gt;&gt; 32;\n   }\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 1773429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/544c44f7f7d6424aaf2adcf0f9e98438?s=128&d=identicon&r=PG", "display_name": "Srikanth", "link": "https://stackoverflow.com/users/1773429/srikanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505318128, "creation_date": 1505317642, "question_id": 46201834, "link": "https://stackoverflow.com/questions/46201834/how-to-convert-milli-seconds-time-to-filetime-in-c", "title": "How to convert milli seconds time to FILETIME in c++", "body": "<p>I have a time in secs (ex:1505306792).</p>\n\n<p>How to convert this into FILETIME?</p>\n\n<p>Here is the code i have tried</p>\n\n<pre><code>    INT64 timer64 = 1505306792;\n\n    timer64 = timer64 *1000 *10000;\n\n    ULONGLONG xx = timer64;\n\n    FILETIME fileTime;\n    ULARGE_INTEGER uliTime;\n\n    uliTime.QuadPart = xx;\n    fileTime.dwHighDateTime = uliTime.HighPart;\n    fileTime.dwLowDateTime = uliTime.LowPart;\n</code></pre>\n\n<p>This result FILETIME is coming as 1648-09-13 15:34:00</p>\n\n<p>I am expecting this date to be 2017-09-13 12:46:31 . I am getting the same when using online converters.</p>\n\n<p>Any idea how to solve this?</p>\n\n<p>I have seen some answers using boost, but it is available in my project.</p>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1505323539, "post_id": 46201568, "comment_id": 79369961, "body": "can&#39;t think of a way. Looks like a job for boost preprocessor macros unfortunately."}], "answers": [{"comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 18240, "user_id": 11449, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89ae6efbbc533445eef32cb9dd7e175e?s=128&d=identicon&r=PG", "display_name": "Roel", "link": "https://stackoverflow.com/users/11449/roel"}, "edited": false, "score": 0, "creation_date": 1505378207, "post_id": 46203957, "comment_id": 79391197, "body": "@Roel for bonus points, #undef the macros MAKE_EXPORT and VARIANTS at the end of the header file. This way you won&#39;t pollute the global namespace with them."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 1, "last_activity_date": 1505325187, "creation_date": 1505325187, "answer_id": 46203957, "question_id": 46201568, "link": "https://stackoverflow.com/questions/46201568/boost-mpl-declare-a-class-for-each-type-in-a-sequence/46203957#46203957", "title": "Boost MPL - declare a class for each type in a Sequence", "body": "<p>I'm afraid you can't do this in as a template expansion but you can do it cleanly and DRYly with boost preprocessor.</p>\n\n<pre><code>#include &lt;boost/preprocessor.hpp&gt;\n\n/*\n * define the variants as a tuple\n */\n#define VARIANTS (char, unsigned char, short, unsigned short, int, unsigned int, float, double)\n\n/*\n * our enumeration function which defines an export\n */\n#define MAKE_EXPORT(r, data, elem) template class __declspec(dllexport) Container&lt;elem&gt;;\n\n/*\n * enumerate cast the tuple to a sequence and enumerate, calling MAKE_EXPORT once for each enumeration\n */\nBOOST_PP_SEQ_FOR_EACH(MAKE_EXPORT, _, BOOST_PP_TUPLE_TO_SEQ(VARIANTS))\n</code></pre>\n"}], "owner": {"reputation": 18240, "user_id": 11449, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89ae6efbbc533445eef32cb9dd7e175e?s=128&d=identicon&r=PG", "display_name": "Roel", "link": "https://stackoverflow.com/users/11449/roel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 46203957, "answer_count": 1, "score": 0, "last_activity_date": 1505325187, "creation_date": 1505316916, "question_id": 46201568, "link": "https://stackoverflow.com/questions/46201568/boost-mpl-declare-a-class-for-each-type-in-a-sequence", "title": "Boost MPL - declare a class for each type in a Sequence", "body": "<p>I have a boost::mpl Sequence like this:</p>\n\n<pre><code>typedef boost::mpl::vector&lt;\n    char, unsigned char, short, unsigned short, int, unsigned int, float, double\n&gt; TTypes;\n</code></pre>\n\n<p>I have a specific-purpose container class which I want to export from my dll:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass Container { T* _elements; }\n</code></pre>\n\n<p>Now what I need in my header (MSVC compiler) is several lines like this:</p>\n\n<pre><code>template class __declspec(dllexport) Container&lt;char&gt;;\ntemplate class __declspec(dllexport) Container&lt;short&gt;;\n</code></pre>\n\n<p>and so on (and I need the same but with dllimport for the clients of this library to include).</p>\n\n<p>Now my question is, is there a way to generate these lines from my mpl vector?</p>\n\n<p>I suspect this isn't possible, so my fallback: is there a way to get the preprocessor to do this for me? So, are there any (boost) macros that will somehow loop over the elements in a Sequence (it's fine if I have to use some special syntax to define my Sequence) so that I can do something with the type names in preprocessor strings?</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505316677, "post_id": 46201457, "comment_id": 79365780, "body": "<code>s[strlen(s) - 1] = &#39;\\0&#39;;</code> sets the terminating c-string character to one less position it was before."}, {"owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 2, "creation_date": 1505316682, "post_id": 46201457, "comment_id": 79365786, "body": "<a href=\"http://en.cppreference.com/w/cpp/string/byte/strlen\" rel=\"nofollow noreferrer\">Do you know what strlen does?</a>"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1505316693, "post_id": 46201457, "comment_id": 79365798, "body": "He you looked up what <code>strlen</code> does?"}, {"owner": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "edited": false, "score": 0, "creation_date": 1505319273, "post_id": 46201457, "comment_id": 79367556, "body": "Your code doesn&#39;t print the whole string. Is it intentional? Is it part of the requirements?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1505322394, "post_id": 46201457, "comment_id": 79369349, "body": "Use std::string, not char arrays!"}, {"owner": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "reply_to_user": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 0, "creation_date": 1505361226, "post_id": 46201457, "comment_id": 79383535, "body": "@Simple and Carcigenicate, I read up about it, length of string...right?"}, {"owner": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "reply_to_user": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "edited": false, "score": 0, "creation_date": 1505361471, "post_id": 46201457, "comment_id": 79383601, "body": "@Stefano Buora, the requirement is to print the in loop the character will reduce by 1 character everytime."}, {"owner": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "edited": false, "score": 0, "creation_date": 1505361475, "post_id": 46201457, "comment_id": 79383604, "body": "@manni66 , I know string is better but then the question say use char array"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1505374314, "post_id": 46201457, "comment_id": 79388979, "body": "That doesn&#39;t speak for the questioner."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "edited": false, "score": 0, "creation_date": 1505362407, "post_id": 46201548, "comment_id": 79383857, "body": "There a few codes to show the length of string or char right? such as <code>str.size</code> and <code>str.length</code> ,and i see <code>size_t</code>, which I don&#39;t understand how it works."}, {"owner": {"reputation": 2275, "user_id": 7458927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03baa06e976e374201e74a42e8cc8a4b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Hendren", "link": "https://stackoverflow.com/users/7458927/lucas-hendren"}, "reply_to_user": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "edited": false, "score": 0, "creation_date": 1505363724, "post_id": 46201548, "comment_id": 79384218, "body": "So str.length() works for strings.<a href=\"http://www.cplusplus.com/reference/string/string/length/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/string/string/length</a> . and str.size() works for arrays <a href=\"http://www.cplusplus.com/reference/array/array/size/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/array/array/size</a>"}, {"owner": {"reputation": 2275, "user_id": 7458927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03baa06e976e374201e74a42e8cc8a4b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Hendren", "link": "https://stackoverflow.com/users/7458927/lucas-hendren"}, "reply_to_user": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "edited": false, "score": 0, "creation_date": 1505363743, "post_id": 46201548, "comment_id": 79384223, "body": "and here is the reference for size_t.  I dont use that one that much <a href=\"http://en.cppreference.com/w/cpp/types/size_t\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/types/size_t</a>"}], "tags": [], "owner": {"reputation": 2275, "user_id": 7458927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03baa06e976e374201e74a42e8cc8a4b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Hendren", "link": "https://stackoverflow.com/users/7458927/lucas-hendren"}, "is_accepted": false, "score": 0, "last_activity_date": 1505316845, "creation_date": 1505316845, "answer_id": 46201548, "question_id": 46201457, "link": "https://stackoverflow.com/questions/46201457/outputs-a-char-array-with-one-less-character-everytime-it-loops/46201548#46201548", "title": "Outputs a char array with one less character everytime it loops", "body": "<p>strlen get the length of your string.</p>\n\n<p><a href=\"http://www.cplusplus.com/reference/cstring/strlen/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstring/strlen/</a></p>\n\n<p>'\\0' is a null terminating character</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Null-terminated_string\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Null-terminated_string</a></p>\n\n<p>So basically your going through your string and making it so that it terminates with null one character earlier every time</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "edited": false, "score": 0, "creation_date": 1505362705, "post_id": 46202130, "comment_id": 79383937, "body": "Thank you for explaining! for <code>s[strlen(s) - 1] = &#39;\\0&#39;;</code> the content inside <code>[ ]</code> is the index of array right?"}], "tags": [], "owner": {"reputation": 5879, "user_id": 8150685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WV7OV.jpg?s=128&g=1", "display_name": "Error - Syntactical Remorse", "link": "https://stackoverflow.com/users/8150685/error-syntactical-remorse"}, "is_accepted": false, "score": 1, "last_activity_date": 1505318507, "creation_date": 1505318507, "answer_id": 46202130, "question_id": 46201457, "link": "https://stackoverflow.com/questions/46201457/outputs-a-char-array-with-one-less-character-everytime-it-loops/46202130#46202130", "title": "Outputs a char array with one less character everytime it loops", "body": "<p>A c-string has a null terminator (i.e. <code>\\0</code>) so in your case you string is actually:</p>\n\n<pre><code>H e l l o   W o r l d \\0\n</code></pre>\n\n<p><code>strlen</code> counts the number of characters upto the <strong>first</strong> null terminator (<code>\\0</code>) so your initial length is 11.  Every time you run your while loop you march the null character back one so:</p>\n\n<pre><code>H e l l o   W o r l \\0 \\0\nH e l l o   W o r \\0 \\0 \\0\nH e l l o   W o \\0 \\0 \\0 \\0\n</code></pre>\n\n<p>which in essence reduces the size of <code>strlen</code>.</p>\n\n<p>Similarly <code>cout</code> prints up to first null terminator (<code>\\0</code>) .</p>\n\n<p>Another thing to note is <code>strlen</code> returns the count of characters however a c-string is 0 based which is why the <code>-1</code> is in <code>s[strlen(s) - 1] = '\\0';</code> (to point to the last character in the c-string).</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "edited": false, "score": 0, "creation_date": 1505365837, "post_id": 46202467, "comment_id": 79384926, "body": "Thanks a lot! Some questions about 1st solution: I don&#39;t understand <code>while (p!=pEnd)</code>, it mean p not equal to <code>pEnd</code> but that will be false, then the loop will not executed. Correct me if I am wrong.  and for 2nd solution: By using string, it will not contain <code>\\0</code> right?"}, {"owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 0, "creation_date": 1505373218, "post_id": 46202467, "comment_id": 79388383, "body": "<code>str.resize(str.length()-1);</code> is <code>str.pop_back();</code>"}, {"owner": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "reply_to_user": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "edited": false, "score": 0, "creation_date": 1505386332, "post_id": 46202467, "comment_id": 79396775, "body": "@engkhsky, that&#39;s a good question though (about \\0 in the string object). I believe for the sake of speed it may be in, but, but.. in order to access to the string as a standard array of (const) char (or a const char*), you need to access through c_str(). So I believe the answer is: you cannot assume that the internal rappresentation in a std:string of a string is an array of char null terminated. As the std library is always trying to be very efficent I believe for the sake of mind that it&#39;s internal rappresentation include an \\0 at the end, but do not assume it while you are coding."}], "tags": [], "owner": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "is_accepted": true, "score": 0, "last_activity_date": 1505386940, "last_edit_date": 1505386940, "creation_date": 1505319708, "answer_id": 46202467, "question_id": 46201457, "link": "https://stackoverflow.com/questions/46201457/outputs-a-char-array-with-one-less-character-everytime-it-loops/46202467#46202467", "title": "Outputs a char array with one less character everytime it loops", "body": "<p>As someone already answered, <code>s[strlen(s) - 1] = '\\0';</code> it's a way to shorten the string moving backward the null ('\\0') character at the end of the string.</p>\n\n<p>As you are asking about another way to do the same thing, here two examples:</p>\n\n<p>Trying to avoid a double call to strlen in ever loop:</p>\n\n<pre><code>   char p[] = \"Hello World\";\n    char* pEnd = &amp;p[strlen(p)];\n    while (p!=pEnd)\n    {\n        *--pEnd = '\\0';\n        cout &lt;&lt; p &lt;&lt; endl;\n    }\n</code></pre>\n\n<p>A more modern approach keeping the mainline you drawn with your example:</p>\n\n<pre><code>std::string str(\"Hello World\");\nwhile(str.length() &gt; 0) {\n    str.pop_back();\n    cout &lt;&lt; str &lt;&lt; endl;\n}\n</code></pre>\n\n<p><em>(2nd solution updated thanks to @Simple contribution)</em></p>\n"}], "owner": {"reputation": 45, "user_id": 8604256, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0b223c7524b19450ddc8e7c344d0df4?s=128&d=identicon&r=PG&f=1", "display_name": "skyzhuzhu", "link": "https://stackoverflow.com/users/8604256/skyzhuzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 46202467, "answer_count": 3, "score": 1, "last_activity_date": 1505386940, "creation_date": 1505316587, "question_id": 46201457, "link": "https://stackoverflow.com/questions/46201457/outputs-a-char-array-with-one-less-character-everytime-it-loops", "title": "Outputs a char array with one less character everytime it loops", "body": "<p>I am new to C++. Trying out a simple question:</p>\n\n<blockquote>\n  <p>Create a while loop that outputs a char array with one less character\n  every time it loops until it holds only '\\0' values within it.</p>\n</blockquote>\n\n<p>The answer is :</p>\n\n<pre><code>char s[] = \"Hello World\";\nwhile (strlen(s))\n{\n    s[strlen(s) - 1] = '\\0';\n    cout &lt;&lt; s &lt;&lt; endl;\n}\n</code></pre>\n\n<p>However I do not under the use of strlen. \nEspecially this part : <code>s[strlen(s) - 1] = '\\0';</code> \nCan someone explain what this part mean?</p>\n\n<p>And lastly is there another way to solve this question?</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "mergesort"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 2, "creation_date": 1505316265, "post_id": 46201266, "comment_id": 79365443, "body": "What did you observe when stepping through your code line by line with the debugger?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1505316305, "post_id": 46201266, "comment_id": 79365472, "body": "<code>std::ref(A)</code> doesn&#39;t look correct.  You&#39;re nut using references so you shouldn&#39;t need it."}, {"owner": {"reputation": 43, "user_id": 5400402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yhJWWVFJqek/AAAAAAAAAAI/AAAAAAAAE_U/_-ITCEGoWP8/photo.jpg?sz=128", "display_name": "Moi", "link": "https://stackoverflow.com/users/5400402/moi"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505320106, "post_id": 46201266, "comment_id": 79368023, "body": "@user0042 I&#39;m using geany on windows and I don&#39;t think Geany allow debugging mode."}, {"owner": {"reputation": 43, "user_id": 5400402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yhJWWVFJqek/AAAAAAAAAAI/AAAAAAAAE_U/_-ITCEGoWP8/photo.jpg?sz=128", "display_name": "Moi", "link": "https://stackoverflow.com/users/5400402/moi"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1505320147, "post_id": 46201266, "comment_id": 79368044, "body": "@NathanOliver I removed the std::ref(A) but I&#39;m still getting the error"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505320174, "post_id": 46201266, "comment_id": 79368058, "body": "@Moi You can always use a debugger from the command line if the IDE doesn&#39;t support it. Also not there&#39;s already an implementation for <code>std::shuffle()</code> you don&#39;t need to roll your own."}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1505321905, "last_edit_date": 1505321905, "creation_date": 1505319188, "answer_id": 46202306, "question_id": 46201266, "link": "https://stackoverflow.com/questions/46201266/terminate-called-without-an-active-exception-multithreaded-merge-sort/46202306#46202306", "title": "terminate called without an active exception (Multithreaded merge sort)", "body": "<p>This code creates too many threads.</p>\n\n<p>When it cannot create more threads <code>std::thread</code> constructor throws an exception. The exception starts unwinding the stack calling destructors of existing <code>std::thread</code> objects. <a href=\"http://en.cppreference.com/w/cpp/thread/thread/~thread\" rel=\"nofollow noreferrer\"><code>std::thread::~thread</code> destructor is problematic because it calls <code>std::terminate</code> if the thread is joinable but has not been joined</a>.</p>\n\n<p>See <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0206r0.html\" rel=\"nofollow noreferrer\">Discussion about std::thread and RAII</a> for more details.</p>\n\n<p>A fix for this code would be to:</p>\n\n<ul>\n<li>Keep the current thread busy sorting, instead of waiting on the other 2 threads, hence halving the thread count.</li>\n<li>Sort small arrays without creating new threads.</li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>void mergeSort(int A[], int low, int high) {\n    if (low &lt; high) {\n        int mid = (low + high) / 2;\n        if(high - mid &gt; 500) {\n            thread sort_thread1(mergeSort,std::ref(A), low, mid);\n            mergeSort(A, mid + 1, high); // Keep this thread busy.\n            sort_thread1.join();\n        }\n        else { // Sort small arrays using 1 thread only.\n            mergeSort(A, low, mid);\n            mergeSort(A, mid + 1, high);\n        }\n        merge(A, low, high, mid);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5400402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yhJWWVFJqek/AAAAAAAAAAI/AAAAAAAAE_U/_-ITCEGoWP8/photo.jpg?sz=128", "display_name": "Moi", "link": "https://stackoverflow.com/users/5400402/moi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505321905, "creation_date": 1505316070, "question_id": 46201266, "link": "https://stackoverflow.com/questions/46201266/terminate-called-without-an-active-exception-multithreaded-merge-sort", "title": "terminate called without an active exception (Multithreaded merge sort)", "body": "<p>Hey I am new to c++ and I'm trying to create a multi threaded merge sort however i keep on getting this error.\n*When the array is 1000 integers the threaded merge sort seems to work however when I initialize the array to a larger number such as 10000 integers, it gives me such exception: \"terminate called without an active exception\"\nYour help will be much appreciated!\nDown below is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;thread&gt;\n#include &lt;pthread.h&gt;\n#include &lt;ctime&gt;// include this header \n\nusing namespace std;\n\n\nvoid shuffle(int *arr, size_t n)\n{\n    if (n &gt; 1) \n    {\n        size_t i;\n        srand(time(NULL));\n        for (i = 0; i &lt; n - 1; i++) \n        {\n          size_t j = i + rand() / (RAND_MAX / (n - i) + 1);\n          int t = arr[j];\n          arr[j] = arr[i];\n          arr[i] = t;\n        }\n    }\n}\n\n\n// A function to merge the two half into a sorted data.\nvoid merge(int *a, int low, int high, int mid)\n{\n    // We have low to mid and mid+1 to high already sorted.\n    int i, j, k, temp[high-low+1];\n    i = low;\n    k = 0;\n    j = mid + 1;\n\n    // Merge the two parts into temp[].\n    while (i &lt;= mid &amp;&amp; j &lt;= high)\n    {\n        if (a[i] &lt; a[j])\n        {\n            temp[k] = a[i];\n            k++;\n            i++;\n        }\n        else\n        {\n            temp[k] = a[j];\n            k++;\n            j++;\n        }\n    }\n\n    // Insert all the remaining values from i to mid into temp[].\n    while (i &lt;= mid)\n    {\n        temp[k] = a[i];\n        k++;\n        i++;\n    }\n\n    // Insert all the remaining values from j to high into temp[].\n    while (j &lt;= high)\n    {\n        temp[k] = a[j];\n        k++;\n        j++;\n    }\n\n\n    // Assign sorted data stored in temp[] to a[].\n    for (i = low; i &lt;= high; i++)\n    {\n        a[i] = temp[i-low];\n    }\n}\n\nvoid mergeSort(int A[], int low, int high){\n\n        if (low &lt; high) {\n        int mid = (low + high) / 2;\n        thread sort_thread1(mergeSort,std::ref(A),low,mid);\n        thread sort_thread2(mergeSort,std::ref (A), mid + 1, high);\n        sort_thread1.join();\n        sort_thread2.join();\n        merge(A, low, high, mid);\n    }\n    return;\n}\nint main(){\n\n    int size =10000;\n    int A[size];\n    for (int i=0; i&lt;size; i++){\n        A[i] = i;\n    }\n    shuffle(A, size);\n    //for (int i=0; i&lt;size; i++){//\n      //  printf(\"%d \", A[i]);\n    //}//\n    int low = 0;\n    int high = size-1;\n    int start_s=clock();\n    // the code you wish to time goes here\n    mergeSort(A,low,high);\n\n    int stop_s=clock();\n    cout &lt;&lt; \"time: \" &lt;&lt; (stop_s-start_s)/double(CLOCKS_PER_SEC) &lt;&lt; endl;\n\n    //for(int i = 0; i&lt;size;i++){\n        //cout &lt;&lt; A[i] &lt;&lt; endl;`\n    //}\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "hash", "unordered-map", "c++-standard-library"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1505316039, "post_id": 46201224, "comment_id": 79365278, "body": "<a href=\"https://stackoverflow.com/questions/18222926/why-is-list-initialization-using-curly-braces-better-than-the-alternatives\" title=\"why is list initialization using curly braces better than the alternatives\">stackoverflow.com/questions/18222926/&hellip;</a>"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 2, "creation_date": 1505316129, "post_id": 46201224, "comment_id": 79365338, "body": "I wish C++ allowed <code>static operator()</code>s."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1505316207, "post_id": 46201224, "comment_id": 79365402, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/40024008/how-to-understand-two-pairs-of-parentheses-in-this-code-fragment\" title=\"how to understand two pairs of parentheses in this code fragment\">stackoverflow.com/questions/40024008/&hellip;</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1505316240, "post_id": 46201224, "comment_id": 79365421, "body": "@DanielH why? C++ allows static functions, and the name of the function doesnt really matter, does it? It is rather the advantage (or the use case) of functors that you want to have a state attached to the function you call"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1505316462, "post_id": 46201224, "comment_id": 79365597, "body": "@DanielH Which would basically be ... constructors which return a type of your choosing.  Madness."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505316736, "post_id": 46201224, "comment_id": 79365838, "body": "@tobi303 For an example of where this would be useful, look at the question I commented on. <code>std::hash</code> would be easier to use if it were called as <code>std::hash&lt;std::string&gt;(s)</code> instead of having the extra <code>{}</code>. You can\u2019t do partial function specialization, or lambda specialization or overloading at all, but you can do partial type specialization."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1505316759, "post_id": 46201224, "comment_id": 79365858, "body": "@Yakk There are a number of differences between constructors and functions other than their names."}, {"owner": {"reputation": 485, "user_id": 7180357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e25f1f32aa29286ab615159b0b294d?s=128&d=identicon&r=PG&f=1", "display_name": "Corey Taylor", "link": "https://stackoverflow.com/users/7180357/corey-taylor"}, "edited": false, "score": 0, "creation_date": 1505325264, "post_id": 46201224, "comment_id": 79370983, "body": "it is a somewhat duplicate question, sorry. I didn&#39;t think to search using the words curly bracket.  The answer is obvious now, and I added a comment to the answer below specifically calling out documentation for lines of code like that."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 0, "creation_date": 1505316404, "post_id": 46201248, "comment_id": 79365558, "body": "@erip will you give me an upvote if I do the same? Just kidding :P I was actually going to draw something similar but I was too slow"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1505316428, "post_id": 46201248, "comment_id": 79365576, "body": "@tobi303 I&#39;ll upvote if you add freehand red circles."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505316738, "post_id": 46201248, "comment_id": 79365839, "body": "you are quite demanding, but I am also quite not motivated to do anything else :P"}, {"owner": {"reputation": 485, "user_id": 7180357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e25f1f32aa29286ab615159b0b294d?s=128&d=identicon&r=PG&f=1", "display_name": "Corey Taylor", "link": "https://stackoverflow.com/users/7180357/corey-taylor"}, "edited": false, "score": 0, "creation_date": 1505324284, "post_id": 46201248, "comment_id": 79370390, "body": "So it is just aggregate initialization of the object.  I had never written it in a line like that so it threw me off.  2nd form in Syntax list for c++11 <a href=\"http://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/aggregate_initialization</a>"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1505337230, "post_id": 46201248, "comment_id": 79377231, "body": "class template, not type :-P"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1505337717, "post_id": 46201248, "comment_id": 79377421, "body": "@barry the section ends at the <code>&gt;</code> not the <code>&lt;</code>."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1505338507, "post_id": 46201248, "comment_id": 79377753, "body": "@Yakk Talking about your first sentence."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 8, "last_activity_date": 1505346747, "last_edit_date": 1505346747, "creation_date": 1505316026, "answer_id": 46201248, "question_id": 46201224, "link": "https://stackoverflow.com/questions/46201224/why-is-used-to-access-operator-in-stdhash/46201248#46201248", "title": "Why is {} used to access operator() in std::hash?", "body": "<p><code>std::hash&lt;T&gt;</code> is a type not a function.</p>\n\n<p>An instance of <code>std::hash</code> has an <code>operator()</code> that does the hash.</p>\n\n<p>So <code>std::hash&lt;std::string&gt;</code> is a hashing type.  <code>{}</code> then creates an instance of that type.  <code>(s.first_name)</code> calls <code>operator()</code> on a <code>std::hash&lt;std::string&gt;</code>.</p>\n\n<pre><code>std::hash&lt;std::string&gt;{}(s.first_name);\n^                     ^       ^\n|                     |   call operator() on that instance\ntype of hasher        |\n                create an instance of that type\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13337, "user_id": 4324224, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YF2EX.png?s=128&g=1", "display_name": "W.F.", "link": "https://stackoverflow.com/users/4324224/w-f"}, "edited": false, "score": 0, "creation_date": 1505316964, "post_id": 46201257, "comment_id": 79365991, "body": "is it really a freehand? :&gt;"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1505317002, "post_id": 46201257, "comment_id": 79366017, "body": "Looks freehand.  Sadly I didn&#39;t say &quot;only if&quot;, so I had already upvoted.  ;)  But +1 freehand red circles."}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 4, "last_activity_date": 1505316742, "last_edit_date": 1505316742, "creation_date": 1505316041, "answer_id": 46201257, "question_id": 46201224, "link": "https://stackoverflow.com/questions/46201224/why-is-used-to-access-operator-in-stdhash/46201257#46201257", "title": "Why is {} used to access operator() in std::hash?", "body": "<p><code>std::hash</code> is not a function, but a class, more specifically a functor. So you have to create an object of that class before you can call its <code>operator()</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bXUXv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bXUXv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 485, "user_id": 7180357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e25f1f32aa29286ab615159b0b294d?s=128&d=identicon&r=PG&f=1", "display_name": "Corey Taylor", "link": "https://stackoverflow.com/users/7180357/corey-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 1, "accepted_answer_id": 46201248, "answer_count": 2, "score": 6, "last_activity_date": 1505346747, "creation_date": 1505315943, "question_id": 46201224, "link": "https://stackoverflow.com/questions/46201224/why-is-used-to-access-operator-in-stdhash", "title": "Why is {} used to access operator() in std::hash?", "body": "<p>While reading the examples of std::hash used for std::unordered_map, I noticed that the operator() function was being accessed by {}.</p>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/utility/hash\" rel=\"noreferrer\">http://en.cppreference.com/w/cpp/utility/hash</a></p>\n\n<pre><code>result_type operator()(argument_type const&amp; s) const\n{\n    result_type const h1 ( std::hash&lt;std::string&gt;{}(s.first_name) );\n    result_type const h2 ( std::hash&lt;std::string&gt;{}(s.last_name) );\n    return h1 ^ (h2 &lt;&lt; 1); // or use boost::hash_combine (see Discussion)\n}\n</code></pre>\n\n<p>What does the use of {} here represent?</p>\n"}, {"tags": ["c++", "ios", "tensorflow"], "answers": [{"tags": [], "owner": {"reputation": 1683, "user_id": 4736556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/X10dc.png?s=128&g=1", "display_name": "jshapy8", "link": "https://stackoverflow.com/users/4736556/jshapy8"}, "is_accepted": true, "score": 3, "last_activity_date": 1505791178, "last_edit_date": 1505791178, "creation_date": 1505776614, "answer_id": 46289470, "question_id": 46201109, "link": "https://stackoverflow.com/questions/46201109/inference-error-with-tensorflow-c-on-ios-invalid-argument-session-was-not-c/46289470#46289470", "title": "Inference error with TensorFlow C++ on iOS: &quot;Invalid argument: Session was not created with a graph before Run()!&quot;", "body": "<p>The primary issue here is that you are exporting your graph to a <a href=\"https://www.tensorflow.org/api_docs/python/tf/saved_model\" rel=\"nofollow noreferrer\"><code>SavedModel</code></a> in Python but then reading it in as a <a href=\"https://www.tensorflow.org/extend/tool_developers/#graphdef\" rel=\"nofollow noreferrer\"><code>GraphDef</code></a> in C++. While both have a <code>.pb</code> extension and are similar, they are not equivalent. </p>\n\n<p>What is happening is you are reading in the <code>SavedModel</code> with <code>PortableReadFileToProto()</code> and it is failing, leaving an empty pointer (<code>model_graph</code>) to a <code>GraphDef</code> object. So after the execution of <code>PortableReadFileToProto()</code>, <code>model_graph</code> remains an empty, but valid, <code>GraphDef</code>, which is why the error says <em>Session was not created with a graph before Run()</em>. <code>session-&gt;Create()</code> succeeds because you successfully created a session with an empty graph. </p>\n\n<p>The way to check if <code>PortableReadFileToProto()</code> fails is to check its return value. It returns a bool, which will be 0 if reading in the graph failed. If you wish to obtain a descriptive error here, use <a href=\"https://www.tensorflow.org/versions/r0.12/api_docs/cc/namespace/tensorflow#namespacetensorflow_1a79f05d00b536b44dcd07e3e63b642d72\" rel=\"nofollow noreferrer\"><code>ReadBinaryProto()</code></a>. Another way you can tell if reading the graph failed is by checking the value of <code>model_graph.node_size()</code>. If this is 0, then you have an empty graph and reading it in has failed. </p>\n\n<p>While you can use TensorFlow's C API to perform inference on a <code>SavedModel</code> by using <a href=\"https://github.com/tensorflow/tensorflow/blob/66eed3646677dc7a8c8e94cd1936b45f6cb3609b/tensorflow/c/c_api.cc#L2223\" rel=\"nofollow noreferrer\"><code>TF_LoadSessionFromSavedModel()</code></a> and <a href=\"https://github.com/tensorflow/tensorflow/blob/66eed3646677dc7a8c8e94cd1936b45f6cb3609b/tensorflow/c/c_api.h#L1198\" rel=\"nofollow noreferrer\"><code>TF_SessionRun()</code></a>, the recomended method is to export your graph to a frozen model using <a href=\"https://www.tensorflow.org/extend/tool_developers/#Freezing\" rel=\"nofollow noreferrer\"><code>freeze_graph.py</code></a> or write to a <code>GraphDef</code> using <a href=\"https://www.tensorflow.org/api_docs/python/tf/train/write_graph\" rel=\"nofollow noreferrer\"><code>tf.train.write_graph()</code></a>. I will demonstrate successful inference with a model exported using <code>tf.train.write_graph()</code>:</p>\n\n<p>In Python:</p>\n\n<pre><code># Build graph, call it g\ng = tf.Graph()\n\nwith g.as_default():\n    input_tensor_a = tf.placeholder(dtype=tf.int32, name=\"InputTensorA\")\n    input_tensor_b = tf.placeholder(dtype=tf.int32, name=\"InputTensorB\")\n    output_tensor_a = tf.stack([input_tensor_a], name=\"OutputTensorA\")\n    output_tensor_b = tf.stack([input_tensor_b], name=\"OutputTensorB\")\n\n# Save graph g\nwith tf.Session(graph=g) as sess:\n    sess.run(tf.global_variables_initializer())\n    tf.train.write_graph(\n        graph_or_graph_def=sess.graph_def,\n        logdir='/path/to/export',\n        name='saved_model.pb',\n        as_text=False\n    )\n</code></pre>\n\n<p>In C++ (Xcode):</p>\n\n<pre><code>using namespace tensorflow;\nusing namespace std;\n\nNSMutableArray* predictions = [NSMutableArray array];\n\nInput::Initializer input_tensor_a(1, TensorShape({1}));\nInput::Initializer input_tensor_b(2, TensorShape({1}));\n\nSessionOptions options;\nSession* session_pointer = nullptr;\nStatus session_status = NewSession(options, &amp;session_pointer);\nunique_ptr&lt;Session&gt; session(session_pointer);\n\nGraphDef model_graph;\nstring model_path = string([FilePathForResourceName(@\"saved_model\", @\"pb\") UTF8String]);\n\nStatus load_graph = ReadBinaryProto(Env::Default(), model_path, &amp;model_graph);\n\nStatus session_init = session-&gt;Create(model_graph);\n\ncout &lt;&lt; \"Session creation Status: \" &lt;&lt; session_init.ToString() &lt;&lt; endl;\ncout &lt;&lt; \"Number of nodes in model_graph: \" &lt;&lt; model_graph.node_size() &lt;&lt; endl;\ncout &lt;&lt; \"Load graph Status: \" &lt;&lt; load_graph.ToString() &lt;&lt; endl;\n\nvector&lt;pair&lt;string, Tensor&gt;&gt; feed_dict = {\n    {\"InputTensorA:0\", input_tensor_a.tensor},\n    {\"InputTensorB:0\", input_tensor_b.tensor}\n};\n\nvector&lt;Tensor&gt; outputs;\nStatus session_run = session-&gt;Run(feed_dict, {\"OutputTensorA:0\", \"OutputTensorB:0\"}, {}, &amp;outputs);\n\n[predictions addObject:outputs[0].scalar&lt;int&gt;()];\n[predictions addObject:outputs[1].scalar&lt;int&gt;()];\n\nStatus session_close = session-&gt;Close();\n</code></pre>\n\n<p>This general method will work, but you will likely experience issues with required operations missing from the TensorFlow library you built and therefore inference would still fail. To combat this, first make sure that you have built the latest <a href=\"https://github.com/tensorflow/tensorflow/releases/tag/v1.3.0\" rel=\"nofollow noreferrer\">TensorFlow <code>1.3</code></a> by cloning the repo on your machine and running <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/makefile/build_all_ios.sh\" rel=\"nofollow noreferrer\"><code>tensorflow/contrib/makefile/build_all_ios.sh</code></a> from the root <code>tensorflow-1.3.0</code> directory. It is unlikely that inference will work for a custom, non-canned model if you use the <a href=\"https://cocoapods.org/pods/TensorFlow-experimental\" rel=\"nofollow noreferrer\"><code>TensorFlow-experimental</code></a> Pod like the examples. Once you have a static library built using <code>build_all_ios.sh</code>, you need to link it up in your <code>.xcconfig</code> by following the instructions <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/ios/\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Once you successfully link the static library built using the makefile with Xcode, you will likely still get errors that prevent inference. While the actual errors you will get depend on your implementation, you will receive errors that fall into two different forms:</p>\n\n<ol>\n<li><blockquote>\n  <p>OpKernel ('op: \"[operation]\" device_type: \"CPU\"') for unknown op:\n  [operation]</p>\n</blockquote></li>\n<li><blockquote>\n  <p>No OpKernel was registered to support Op '[operation]' with these\n  attrs.  Registered devices: [CPU], Registered kernels: [...]</p>\n</blockquote></li>\n</ol>\n\n<p>Error #1 means that the <code>.cc</code> file from <code>tensorflow/core/ops</code> or <code>tensorflow/core/kernels</code> for the corresponding operation (or closely associated operation) is not in the <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/makefile/tf_op_files.txt\" rel=\"nofollow noreferrer\"><code>tf_op_files.txt</code></a> file in <code>tensorflow/contrib/makefile</code>. You will have to find the <code>.cc</code> that contains <code>REGISTER_OP(\"YourOperation\")</code> and add it to <code>tf_op_files.txt</code>. You must rebuild by running <code>tensorflow/contrib/makefile/build_all_ios.sh</code> again.</p>\n\n<p>Error #2 means that the <code>.cc</code> file for the corresponding operation is in your <code>tf_op_files.txt</code> file, but you have supplied the operation with a data type that it (a) doesn't support or (b) is stripped off to reduce the size of the build. </p>\n\n<p>One \"gotcha\" is that if you are using <code>tf.float64</code> in the implementation of your model, this is exported as <code>TF_DOUBLE</code> in your <code>.pb</code> file and this is not supported by most operations. Use <code>tf.float32</code> in place of <code>tf.float64</code> and then re-save your model using <code>tf.train.write_graph()</code>.</p>\n\n<p>If you are still receiving error #2 after checking you are providing the correct datatype to the operation, you will need to either remove <code>__ANDROID_TYPES_SLIM__</code> in the makefile located at <code>tensorflow/contrib/makefile</code> or replace it with <code>__ANDROID_TYPES_FULL__</code> and then rebuild.</p>\n\n<p>After getting passed errors #1 and #2, you will likely have successful inference. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9715143, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155009673750359/picture?type=large", "display_name": "Ben Mattes", "link": "https://stackoverflow.com/users/9715143/ben-mattes"}, "is_accepted": false, "score": 0, "last_activity_date": 1524951117, "last_edit_date": 1524951117, "creation_date": 1524936635, "answer_id": 50079273, "question_id": 46201109, "link": "https://stackoverflow.com/questions/46201109/inference-error-with-tensorflow-c-on-ios-invalid-argument-session-was-not-c/50079273#50079273", "title": "Inference error with TensorFlow C++ on iOS: &quot;Invalid argument: Session was not created with a graph before Run()!&quot;", "body": "<p>One addition to the very comprehensive explanation above:</p>\n\n<p>@jshapy8 is right in saying \"You will have to find the .cc that contains REGISTER_OP(\"YourOperation\") and add it to tf_op_files.txt\" and there is a process that can simplify that a bit:</p>\n\n<pre><code>## build the print_selective_register_header tool. Run from tensorflow root\nbazel build tensorflow/python/tools:print_selective_registration_header\nbazel-bin/tensorflow/python/tools/print_selective_registration_header \\\n--graphs=&lt;path to your frozen model file here&gt;/model_frozen.pb &gt; ops_to_register.h\n</code></pre>\n\n<p>This creates a .h file that lists only the ops needed for your specific model. </p>\n\n<p>Now when compiling your static libraries follow the <strong>Build By Hand</strong> instructions <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/makefile\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>The instructions say to do the following:</p>\n\n<pre><code>make -f tensorflow/contrib/makefile/Makefile \\\nTARGET=IOS \\\nIOS_ARCH=ARM64\n</code></pre>\n\n<p>But you can pass a lot to the makefile specific to your needs and I've found the following your best bet:</p>\n\n<pre><code>make -f tensorflow/contrib/makefile/Makefile \\\nTARGET=IOS IOS_ARCH=ARM64,x86_64 OPTFLAGS=\"-O3 -DANDROID_TYPES=ANDROID_TYPES_FULL -DSELECTIVE_REGISTRATION -DSUPPORT_SELECTIVE_REGISTRATION\"\n</code></pre>\n\n<p>In particular you are telling it here to compile for just two of the 5 architectures to speed up compiling time (full list is: i386 x86_64 armv7 armv7s arm64 and obviously takes longer) - IOS_ARCH=ARM64,x86_64 - and then you are telling it not to compile for ANDROID_TYPES_SLIM (which will give you the Float/Int casting issues referred to above) and then finally you are telling it to pull all the necessary ops kernel files and include them in the make process.</p>\n\n<p><strong>Update</strong> . Not sure why this wasn't working for me yesterday, but this is probably a cleaner and safer method:</p>\n\n<pre><code>build_all_ios.sh OPTFLAGS=\"-O3 -DANDROID_TYPES=ANDROID_TYPES_FULL -DSELECTIVE_REGISTRATION -DSUPPORT_SELECTIVE_REGISTRATION\"\n</code></pre>\n\n<p>If you want to speed things up edit compile_ios_tensorflow.sh in the /Makefile directory. Look for the following line:</p>\n\n<pre><code>BUILD_TARGET=\"i386 x86_64 armv7 armv7s arm64\"\n</code></pre>\n\n<p>and change it to:</p>\n\n<pre><code>BUILD_TARGET=\"x86_64 arm64\"\n</code></pre>\n"}], "owner": {"reputation": 1683, "user_id": 4736556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/X10dc.png?s=128&g=1", "display_name": "jshapy8", "link": "https://stackoverflow.com/users/4736556/jshapy8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2843, "favorite_count": 2, "accepted_answer_id": 46289470, "answer_count": 2, "score": 5, "last_activity_date": 1524951117, "creation_date": 1505315604, "last_edit_date": 1505635990, "question_id": 46201109, "link": "https://stackoverflow.com/questions/46201109/inference-error-with-tensorflow-c-on-ios-invalid-argument-session-was-not-c", "title": "Inference error with TensorFlow C++ on iOS: &quot;Invalid argument: Session was not created with a graph before Run()!&quot;", "body": "<p>I am trying to run my model on iOS using TensorFlow's C++ API. The model is a <code>SavedModel</code> saved as a <code>.pb</code> file. However, calls to <code>Session::Run()</code> result in the error:</p>\n\n<blockquote>\n  <p>\"Invalid argument: Session was not created with a graph before Run()!\"</p>\n</blockquote>\n\n<p>In Python, I can successfully run inference on the model with the following code:</p>\n\n<pre><code>with tf.Session() as sess:\n    tf.saved_model.loader.load(sess, ['serve'], '/path/to/model/export')\n    result = sess.run(['OutputTensorA:0', 'OutputTensorB:0'], feed_dict={\n        'InputTensorA:0': np.array([5000.00] * 1000).reshape(1, 1000),\n        'InputTensorB:0': np.array([300.00] * 1000).reshape(1, 1000)\n    })\n    print(result[0])\n    print(result[1])\n</code></pre>\n\n<p>In C++ on iOS, I try to mimick this working snippit as follows:</p>\n\n<pre><code>tensorflow::Input::Initializer input_a(5000.00, tensorflow::TensorShape({1, 1000}));\ntensorflow::Input::Initializer input_b(300.00, tensorflow::TensorShape({1, 1000}));\n\ntensorflow::Session* session_pointer = nullptr;\n\ntensorflow::SessionOptions options;\ntensorflow::Status session_status = tensorflow::NewSession(options, &amp;session_pointer);\n\nstd::cout &lt;&lt; session_status.ToString() &lt;&lt; std::endl; // prints OK\n\nstd::unique_ptr&lt;tensorflow::Session&gt; session(session_pointer);\n\ntensorflow::GraphDef model_graph;\n\nNSString* model_path = FilePathForResourceName(@\"saved_model\", @\"pb\");\nPortableReadFileToProto([model_path UTF8String], &amp;model_graph);\n\ntensorflow::Status session_init = session-&gt;Create(model_graph);\n\nstd::cout &lt;&lt; session_init.ToString() &lt;&lt; std::endl; // prints OK\n\nstd::vector&lt;tensorflow::Tensor&gt; outputs;\ntensorflow::Status session_run = session-&gt;Run({{\"InputTensorA:0\", input_a.tensor}, {\"InputTensorB:0\", input_b.tensor}}, {\"OutputTensorA:0\", \"OutputTensorB:0\"}, {}, &amp;outputs);\n\nstd::cout &lt;&lt; session_run.ToString() &lt;&lt; std::endl; // Invalid argument: Session was not created with a graph before Run()!\n</code></pre>\n\n<p>The methods <code>FilePathForResourceName</code> and <code>PortableReadFileToProto</code> are taken from the TensorFlow iOS sample found <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/ios/simple/RunModelViewController.mm\" rel=\"noreferrer\">here</a>.</p>\n\n<p>What is the problem? I noticed that this happens regardless of how simple the model is (<a href=\"https://github.com/tensorflow/tensorflow/issues/13090\" rel=\"noreferrer\">see my issue report on GitHub</a>), which means the problem is not with the specifics of the model.</p>\n"}, {"tags": ["c++", "arrays", "templates", "storing-data", "class-members"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 3, "creation_date": 1505313994, "post_id": 46200566, "comment_id": 79363837, "body": "<i>&quot;My idea is to use void*&quot;</i> A very bad idea."}, {"owner": {"reputation": 173, "user_id": 5582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebe3d29bc9995cc2fa59c0c14c223b6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/5582368/markus"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505314079, "post_id": 46200566, "comment_id": 79363913, "body": "@user0042 I know, any better idea?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 2, "creation_date": 1505314102, "post_id": 46200566, "comment_id": 79363922, "body": "There are libraries like <code>Boost.TypeErasure</code> and <code>dyno</code> that deal well with this, or the traditional base class."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1505314228, "post_id": 46200566, "comment_id": 79364030, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/3348936/array-of-arrays-of-different-size\" title=\"array of arrays of different size\">stackoverflow.com/questions/3348936/&hellip;</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1505315083, "post_id": 46200566, "comment_id": 79364652, "body": "It&#39;s not worth the trouble. Use <code>std::vector</code>."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 5582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebe3d29bc9995cc2fa59c0c14c223b6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/5582368/markus"}, "edited": false, "score": 0, "creation_date": 1505314906, "post_id": 46200760, "comment_id": 79364540, "body": "Your answer is write, my question was wrong. So I edit it: (you can&#39;t change grid, it represents a more difficult object, I don&#39;t like to change):"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "reply_to_user": {"reputation": 173, "user_id": 5582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebe3d29bc9995cc2fa59c0c14c223b6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/5582368/markus"}, "edited": false, "score": 0, "creation_date": 1505315642, "post_id": 46200760, "comment_id": 79364995, "body": "You might be better off starting another question and being more specific about the grid class you have."}], "tags": [], "owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "is_accepted": false, "score": 1, "last_activity_date": 1505314546, "creation_date": 1505314546, "answer_id": 46200760, "question_id": 46200566, "link": "https://stackoverflow.com/questions/46200566/c-storing-arbitrary-number-of-different-classes-in-one-class-member-array/46200760#46200760", "title": "c++ storing arbitrary number of different classes in one class-member-array", "body": "<p>The size is part of your type. By resorting to <code>void *</code> you nuke it, to an extent.</p>\n\n<p>An alternative is to just use vectors.\nThis will still allow you to have different sized grids in an container and get or set the data.</p>\n\n<pre><code>#include &lt;vector&gt;\n\nclass grid\n{\npublic:\n    grid(int x, int y)\n    {\n        data.resize(x);\n        //and each y\n    }\n//private: //maybe - up to you\n    std::vector&lt;std::vector&lt;double&gt;&gt;data;\n};\n\nint main()\n{\n    std::vector&lt;grid&gt; my_grids;\n    my_grids.emplace_back(1, 3);\n}\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 5582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebe3d29bc9995cc2fa59c0c14c223b6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/5582368/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505314828, "creation_date": 1505313937, "last_edit_date": 1505314828, "question_id": 46200566, "link": "https://stackoverflow.com/questions/46200566/c-storing-arbitrary-number-of-different-classes-in-one-class-member-array", "title": "c++ storing arbitrary number of different classes in one class-member-array", "body": "<p>Let's say I have a class template like this (you can't change grid, it represents a more difficult object, I don't like to change):</p>\n\n<pre><code>template&lt;int x, int y&gt;\nclass grid{\npublic:\ndouble S[x][y];\ngrid();\n~grid();};\n</code></pre>\n\n<p>Now I wish a new class template (named multi_grid), which owns an array my_grids. I like to store into my_grids different grids like (pseudo code):</p>\n\n<pre><code>my_grids[0]=grid&lt;x*1,y*1&gt;,\nmy_grids[1]=grid&lt;x*2,y*2&gt;\nmy_grids[n]=grid&lt;(x&lt;&lt;n),(y&lt;&lt;n)&gt;\n</code></pre>\n\n<p>My idea is to use void* for my_grids and set it via constructor. My trouble starts in the constructor:</p>\n\n<pre><code>template&lt;int x, int y, int degree&gt;\nclass multi_grid{\npublic:\nvoid* my_grids[degree];\n\n~multi_grid(){};\nmulti_grid(){\n    create_grid&lt;degree-1&gt;();\n    }\n\ntemplate&lt;int grid_number&gt;\nvoid create_grid(void){\n    my_grid[grid_number]=new grid&lt;(x&lt;&lt;grid_number), (y&lt;&lt;grid_number)&gt;;\n    create_grid&lt;grid_number-1&gt;();\n    }\n\n};\n\ntemplate&lt;int x, int y, int degree&gt;\ntemplate&lt;int grid_number&gt;\nvoid multi_grid&lt;x, y, degree&gt;::create_grid&lt;-1&gt;(){}\n</code></pre>\n\n<p>I have 2 questions:</p>\n\n<ol>\n<li>Is the concept of the idea possible?</li>\n<li>and if first answer is true, how to do it? \nI started with a simple for_loop, which leads to trouble, since i++ is not static. \nSo I tried template recursion, than I run into different problems like:\n\"shadows template parm\" or  \"function template partial specialization \u2018create_grid&lt;-1>\u2019 is not allowed\" and a lot more trouble.</li>\n</ol>\n\n<p>I tried the whole to solve it and couldn't figure it out. Thanks in advance.</p>\n"}, {"tags": ["c++", "rsa"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 1, "creation_date": 1505313671, "post_id": 46200416, "comment_id": 79363589, "body": "All the values get set to 0? That seems really easy to track down with some breakpoints."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 3, "creation_date": 1505314836, "post_id": 46200416, "comment_id": 79364490, "body": "Most, if not all, of these (__uint128_t) casts seem unnecessary and confusing."}], "answers": [{"tags": [], "owner": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "is_accepted": false, "score": 0, "last_activity_date": 1505315332, "creation_date": 1505315332, "answer_id": 46201017, "question_id": 46200416, "link": "https://stackoverflow.com/questions/46200416/implementing-rsa-unit-for-128bits-c/46201017#46201017", "title": "Implementing RSA unit for 128bits-C++", "body": "<p>You multiply two 128-bit number, which will give a 128-bit number in your code - but you need the full result (a 256-bit number) and then compute the result mod n.</p>\n"}], "owner": {"reputation": 72, "user_id": 8263088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc104a067217edcc07f5af8743ed65e6?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Karundia", "link": "https://stackoverflow.com/users/8263088/yash-karundia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505315332, "creation_date": 1505313566, "question_id": 46200416, "link": "https://stackoverflow.com/questions/46200416/implementing-rsa-unit-for-128bits-c", "title": "Implementing RSA unit for 128bits-C++", "body": "<p>I am able to work this out for small numbers. Encryption works fine for even big numbers. However, there is some issue with the decryption unit. Can someone help me out?</p>\n\n<pre><code>main()\n{\n   //__uint128_t secret=((__uint128_t)3502532219136638976) &lt;&lt;64 |1161929539123609600; \n   //__uint128_t pvtkey=((__uint128_t)14605469131018042215) &lt;&lt;64 |1281687108645159073;\n   //__uint128_t n=((__uint128_t)16156614574048939703) &lt;&lt;64| 17372945349702060311;\n\n   decrypt(1434,1293,2491);\n}\n\n\n\n\n__uint128_t decrypt(__uint128_t secret,__uint128_t pvtkey,__uint128_t n)\n{\n   cout&lt;&lt; \"Decrypting...\"&lt;&lt;\"\\n\";\n\n\n   __uint128_t imsg_copy2=pvtkey;\n    uint64_t imsg64_lo2,imsg64_hi2;\n    imsg64_lo2=imsg_copy2;\n    imsg_copy2=imsg_copy2&gt;&gt;64;\n    imsg64_hi2=imsg_copy2;\n    cout &lt;&lt; \"Pvt key recvd here:\"&lt;&lt;imsg64_lo2&lt;&lt;\"\\n\";\n    cout &lt;&lt; \"Pvt key recvd here  hi:\"&lt;&lt;imsg64_hi2&lt;&lt;\"\\n\";\n    __uint128_t r=1;\n    int ctr=0;\n    while(1)\n     {\n       if(((__uint128_t)pvtkey)%2==1)\n          {r=(((__uint128_t)r)*((__uint128_t)secret))%((__uint128_t)n);\n           cout&lt;&lt;\" r:\" &lt;&lt; r &lt;&lt; \"\\n\" ;\n          }\n     //      cout &lt;&lt;\"Dividing\";\n      pvtkey=((__uint128_t)pvtkey)/2;\n      cout &lt;&lt; \"r:\";\n      printf_128(r);\n      cout &lt;&lt; ctr &lt;&lt; \"\\n\";\n\n      if(pvtkey==0)\n            break;\n      cout&lt;&lt;\"secret:\";\n      secret=(((__uint128_t)secret)*((__uint128_t)secret)%((__uint128_t)n));\n      printf_128(secret);\n      ctr++;\n\n      cout &lt;&lt; \"Decryption inside function_lo:\"&lt;&lt;\"\\n\";\n      printf_128(r);\n      return ((__uint128_t)r);\n     }\n\n\n void printf_128(__uint128_t v)\n {\n\n              __uint128_t imsg_copy=v;\n              uint64_t imsg64_lo,imsg64_hi;\n              imsg64_lo=imsg_copy;\n              imsg_copy=imsg_copy&gt;&gt;64;\n              imsg64_hi=imsg_copy;\n              cout  &lt;&lt;imsg64_hi&lt;&lt;imsg64_lo&lt;&lt;\"\\n\";\n\n  }\n</code></pre>\n\n<p>So, when I run this function for smaller numbers, the decryption unit works fine. However, when i do this for large public keys, all the values get set to 0.Can someone help ?</p>\n"}, {"tags": ["c++", "ubuntu-16.04", "gsl"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1505313338, "post_id": 46200312, "comment_id": 79363328, "body": "Did you try installing the library again?"}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 1, "creation_date": 1505313354, "post_id": 46200312, "comment_id": 79363348, "body": "It looks like the upgrade removed older packages; where those deprecated/obsoleted? Did you try re-installing them?"}], "answers": [{"comments": [{"owner": {"reputation": 1002, "user_id": 886878, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3b4ee9bc3b69059b76a8dd3b323d237?s=128&d=identicon&r=PG", "display_name": "Jonathan Lindgren", "link": "https://stackoverflow.com/users/886878/jonathan-lindgren"}, "edited": false, "score": 0, "creation_date": 1505317860, "post_id": 46200544, "comment_id": 79366643, "body": "Ah, I had only tried to install the gsl-bin and it did not help. installing libgsl-dev indeed solved the problem. thanks!"}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "reply_to_user": {"reputation": 1002, "user_id": 886878, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3b4ee9bc3b69059b76a8dd3b323d237?s=128&d=identicon&r=PG", "display_name": "Jonathan Lindgren", "link": "https://stackoverflow.com/users/886878/jonathan-lindgren"}, "edited": false, "score": 0, "creation_date": 1505320458, "post_id": 46200544, "comment_id": 79368232, "body": "@JonathanLindgren Indeed. Libraries are generally offered in two &quot;flavors&quot;, one for users, which comes in binary form for a specific platform/arch, and another for developers, in source form."}], "tags": [], "owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "is_accepted": true, "score": 1, "last_activity_date": 1505313895, "creation_date": 1505313895, "answer_id": 46200544, "question_id": 46200312, "link": "https://stackoverflow.com/questions/46200312/gnu-scientific-library-stopped-working-in-ubuntu-16-04/46200544#46200544", "title": "Gnu Scientific Library stopped working in Ubuntu 16.04", "body": "<p>The upgrade appears to have removed older packages. You will need to re-install them from the repository. The command <code>apt-cache search gsl</code> includes the following relevant packages:</p>\n\n<pre><code>libgsl-dev - GNU Scientific Library (GSL) -- development package\nlibgsl2 - GNU Scientific Library (GSL) -- library package\ngsl-bin - GNU Scientific Library (GSL) -- binary package\n</code></pre>\n\n<p>Since you're doing dev work, you should install <code>libgsl-dev</code>.</p>\n"}], "owner": {"reputation": 1002, "user_id": 886878, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3b4ee9bc3b69059b76a8dd3b323d237?s=128&d=identicon&r=PG", "display_name": "Jonathan Lindgren", "link": "https://stackoverflow.com/users/886878/jonathan-lindgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 46200544, "answer_count": 1, "score": 0, "last_activity_date": 1505313895, "creation_date": 1505313255, "question_id": 46200312, "link": "https://stackoverflow.com/questions/46200312/gnu-scientific-library-stopped-working-in-ubuntu-16-04", "title": "Gnu Scientific Library stopped working in Ubuntu 16.04", "body": "<p>I had GSL (Gnu Scientific library) installed on my Ubuntu 14.04 and it was working fine. I then upgraded to Ubuntu 16.04 and now if I try to compile C++ code using GSL I obtain the error message</p>\n\n<pre><code>g++ -c FILE.cpp\nIn file included from FILE.cpp:1:0:\nFILE.h:3:28: fatal error: gsl/gsl_matrix.h: No such file or directory\ncompilation terminated.\nMakefile:42: recipe for target 'FILE.o' failed\nmake: *** [FILE.o] Error 1\n</code></pre>\n\n<p>How do I fix this issue?</p>\n"}, {"tags": ["c++", "vb.net", "unhandled", "dep"], "comments": [{"owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 0, "creation_date": 1505312428, "post_id": 46199928, "comment_id": 79362658, "body": "Do you have a crash dump that you can open in your IDE? It will show you the state of your program when it crashed."}, {"owner": {"reputation": 21, "user_id": 6062444, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa55eab4ffd642eb9f7140ab775e96ca?s=128&d=identicon&r=PG", "display_name": "Ricky Layman", "link": "https://stackoverflow.com/users/6062444/ricky-layman"}, "reply_to_user": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 0, "creation_date": 1505313176, "post_id": 46199928, "comment_id": 79363214, "body": "I&#39;m not sure... not a computer programmer by trade, just an electrical engineer who has to dabble in it sometimes. I have attached the windows logs in relation, and the application runs from a .exe on a customers machine in the field."}, {"owner": {"reputation": 1280, "user_id": 2659161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29e7a0497c9070fbb0b9df262eef3dbd?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2659161/craig"}, "edited": false, "score": 1, "creation_date": 1505313282, "post_id": 46199928, "comment_id": 79363298, "body": "In general, this error is thrown any time the program tries to access an invalid memory address.  There are any number of classes of bugs that might lead to it (e.g. buffer overrun, use after free).  They generally involve some kind of undefined behavior, which is undefined partly because it&#39;s impractical for the compiler to identify them."}, {"owner": {"reputation": 876, "user_id": 5082245, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0b681a8964626eda6cf2a4895a3abb6b?s=128&d=identicon&r=PG&f=1", "display_name": "0xBADF00", "link": "https://stackoverflow.com/users/5082245/0xbadf00"}, "edited": false, "score": 0, "creation_date": 1505313466, "post_id": 46199928, "comment_id": 79363422, "body": "maybe this thread can help you <a href=\"https://stackoverflow.com/questions/12228297/automatically-create-visual-c-crash-dump\" title=\"automatically create visual c crash dump\">stackoverflow.com/questions/12228297/&hellip;</a>&#39;"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1505317844, "post_id": 46199928, "comment_id": 79366632, "body": "You are going to need an experienced programmer to get this problem resolved.  Preferably whomever worked on the project.  Not just because AVE is a very gritty mishap, this also looks like a threading bug."}], "answers": [{"tags": [], "owner": {"reputation": 3923, "user_id": 8309701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S44bo.png?s=128&g=1", "display_name": "Chris Uzdavinis", "link": "https://stackoverflow.com/users/8309701/chris-uzdavinis"}, "is_accepted": false, "score": 2, "last_activity_date": 1505314276, "creation_date": 1505314276, "answer_id": 46200673, "question_id": 46199928, "link": "https://stackoverflow.com/questions/46199928/interpreting-access-violation-exceptions/46200673#46200673", "title": "Interpreting Access Violation Exceptions?", "body": "<p>There are exceptions that are thrown by the c++ runtime environment, as a result of executing a throw expression, and there are other types of errors caused by the operating system or hardware trapping your instruction.  Invalid access to memory is generally not thrown by code in c++, but is a side effect of evaluating an expression trying to access memory at an invalid address, resulting in the OS signaling the process, usually killing it.  Because it's outside C++, it tends to be platform specific, but typical errors are:</p>\n\n<ul>\n<li>reading a null pointer</li>\n<li>using a pointer to an object that has been deleted</li>\n<li>going outside an array's valid range of elements</li>\n<li>using invalidated iterators into STL containers</li>\n</ul>\n\n<p>Generally speaking, you can test for null and array bounds at runtime to detect the problem before it happens.  Using a dangling pointer is more difficult to track down, because the time between the delete and the mis-use of that pointer can be long, and it can be difficult to find why it happened without a memory debugger, such as valgrind.  Using smart pointers instead of raw pointers can help mitigate the problems of mis-managing memory, and can help avoid such errors.  </p>\n\n<p>Invalid iterators are subset of the general dangling pointer problem, but are common enough to be worth mentioning as their own category.  Understanding your containers and which operations invalidate them is crucial, and some implementations can be compiled in \"debug mode\" which can help detect use of invalidated iterators.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 6062444, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa55eab4ffd642eb9f7140ab775e96ca?s=128&d=identicon&r=PG", "display_name": "Ricky Layman", "link": "https://stackoverflow.com/users/6062444/ricky-layman"}, "edited": false, "score": 0, "creation_date": 1505339172, "post_id": 46201727, "comment_id": 79378003, "body": "I cannot run the majority of example 1 in practice. Many of these c++ codes are talking to real world hard ware devices worth over a grand total sum of hundreds of thousands of dollars. I may get access for a few days or maybe even a week if im lucky, but the error often goes months (like 6 months or more pretty commonly) without occuring. I&#39;m not sure if these diagnostic tools would flush that out in a shorter time constraint?  Is there any indicator from those fault logs where to look specifically? Or would the problem be in any of those listed locations?"}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "reply_to_user": {"reputation": 21, "user_id": 6062444, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa55eab4ffd642eb9f7140ab775e96ca?s=128&d=identicon&r=PG", "display_name": "Ricky Layman", "link": "https://stackoverflow.com/users/6062444/ricky-layman"}, "edited": false, "score": 0, "creation_date": 1505401203, "post_id": 46201727, "comment_id": 79407755, "body": "The exception details are not particularly helpful in cases like this because a wayward pointer or threading bug can corrupt other parts of memory far afield from what the program is doing at the time. Many times, I&#39;ve seen the program crash in some seemingly unrelated place because of a problem like yours. Possibly the best thing you can do in the circumstances you describe is instrument the code to log program state (tool 3) and then compare good and bad runs. This won&#39;t be fast or accurate, but it may be all you&#39;ve got."}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "reply_to_user": {"reputation": 21, "user_id": 6062444, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa55eab4ffd642eb9f7140ab775e96ca?s=128&d=identicon&r=PG", "display_name": "Ricky Layman", "link": "https://stackoverflow.com/users/6062444/ricky-layman"}, "edited": false, "score": 0, "creation_date": 1505401234, "post_id": 46201727, "comment_id": 79407783, "body": "Really, you and your bosses need to decide how important it is to fix. It is not likely going to be a simple fix, so count the cost. Are there other workarounds -- e.g. automatically restarting the process when it exits -- that would be acceptable? If not, what sort of investment will it take to fix? In theory, hardware can be spoofed in testing by dependency injection. Your biggest problem to overcome is the indeterminacy and intermittency."}, {"owner": {"reputation": 21, "user_id": 6062444, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa55eab4ffd642eb9f7140ab775e96ca?s=128&d=identicon&r=PG", "display_name": "Ricky Layman", "link": "https://stackoverflow.com/users/6062444/ricky-layman"}, "edited": false, "score": 0, "creation_date": 1505481717, "post_id": 46201727, "comment_id": 79444842, "body": "I think the only threading in the application is that generated by VS to do it&#39;s timers. Many of the forms are updated by timers to show difference in machine states on the fly, for example on the form it mentions the crash in there are a few or more timers running for different update loops. Similar to what you said though, the form it lists in the crash is not the form it&#39;s on when the system drops out. I did verify the timer is stopped and disposed of in the form as well, so it may prove very hard to track like you said."}, {"owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "reply_to_user": {"reputation": 21, "user_id": 6062444, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa55eab4ffd642eb9f7140ab775e96ca?s=128&d=identicon&r=PG", "display_name": "Ricky Layman", "link": "https://stackoverflow.com/users/6062444/ricky-layman"}, "edited": false, "score": 0, "creation_date": 1505484834, "post_id": 46201727, "comment_id": 79447181, "body": "That&#39;s good news on the threading. So as I see it, your non-exclusive options are: (1) run it offline in a test environment with spoofed hardware etc. to try to repro, (2) instrument the code to try to capture more details about what is going wrong and when in the production environment, and/or (3) do static analysis of the code to see if it turns up any real bugs."}], "tags": [], "owner": {"reputation": 5569, "user_id": 201787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vgB9F.jpg?s=128&g=1", "display_name": "metal", "link": "https://stackoverflow.com/users/201787/metal"}, "is_accepted": false, "score": 1, "last_activity_date": 1505328344, "last_edit_date": 1505328344, "creation_date": 1505317307, "answer_id": 46201727, "question_id": 46199928, "link": "https://stackoverflow.com/questions/46199928/interpreting-access-violation-exceptions/46201727#46201727", "title": "Interpreting Access Violation Exceptions?", "body": "<p>As others have noted, this type of error is tricky to identify without digging into the code and running tests (automated or manual). The more pieces of the system you can pull out and still reproduce it, the better. Divide and conquer is your friend here.</p>\n\n<p>Beyond that, it all depends how important it is for you to resolve this and how much effort you're willing to put in. There are at least three classes of tools that can help with such intermittent problems:</p>\n\n<ol>\n<li>Application monitors that track potential errors as your application runs. These tend to slow your program significantly (10x or more slowdown). Examples include:\n\n<ol>\n<li>Microsoft's <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/application-verifier\" rel=\"nofollow noreferrer\">Application Verifier</a></li>\n<li>Open-source and cross-platform <a href=\"http://www.drmemory.org/\" rel=\"nofollow noreferrer\">Dr. Memory</a> </li>\n<li>Google's <a href=\"https://chromium.googlesource.com/crashpad/crashpad/+/HEAD/README.md\" rel=\"nofollow noreferrer\">Crashpad</a>. Unlike the previous two programs, this one requires instrumenting your code. It is also (allegedly -- haven't tried it) easier to use with helpers like <a href=\"https://documentation.backtrace.io/product_integration_minidump_crashpad/index.html\" rel=\"nofollow noreferrer\">Backtrace's commercial integration for analyzing Crashpad output</a></li>\n<li>Google's <a href=\"https://github.com/google/sanitizers\" rel=\"nofollow noreferrer\">Sanitizers</a> - free and some are built into gcc and clang. There's also a <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerWindowsPort\" rel=\"nofollow noreferrer\">Windows port of Address Sanitizer</a>, but a cursory look suggests it may be a little bit of a second-class citizen.</li>\n<li>If you can run and repro it also run it on Linux, you could use <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>; <a href=\"http://rr-project.org/\" rel=\"nofollow noreferrer\">rr</a> (see <a href=\"http://cppcast.com/2015/12/robert-ocallahan/\" rel=\"nofollow noreferrer\">this CppCast ep</a>) which is a free extension for gdb that records and replays your program so you can record a debug session that crashed and then step through it to see what went wrong; and/or <a href=\"https://undo.io/products/undodb/\" rel=\"nofollow noreferrer\">UndoDB</a> and friends from Undo software, which is a more sophisticated, commercial product like rr.</li>\n</ol></li>\n<li>Static analysis of the code. This is a set of tools that looks for common errors in your code. It generally has a low signal-to-noise ratio, so there are a lot of minor things to dig through if your run it on a large, existing project (best to start a project using these things from the beginning if possible). That said, many of the warnings are invaluable. Examples:\n\n<ol>\n<li>Most compilers have a subset of this functionality built in. If you're using Visual Studio, add <code>/W4 /WX</code> to your compilation flags for the C++ code to force maximum warnings, then fix all the warnings. For gcc and clang, add '-Wall -Wpedantic -Werror` to enforce no warnings.</li>\n<li><a href=\"https://www.viva64.com/en/pvs-studio-download/?win\" rel=\"nofollow noreferrer\">PVS-Studio</a> (commercial)</li>\n<li><a href=\"http://www.gimpel.com/html/pcl.htm\" rel=\"nofollow noreferrer\">PC-Lint</a> (commercial)</li>\n</ol></li>\n<li>If you can instrument the code to write log messages, something like <a href=\"https://github.com/djeedjay/DebugViewPP/\" rel=\"nofollow noreferrer\">Debugview++</a> may be of assistance.</li>\n</ol>\n\n<p>Things get harder if you have multithreading going on, which it looks like you do, because the non-determinism gets harder to track, there are new classes of possible errors that are introduced, and some of the above tools won't work well (e.g., I think rr is single-threaded only). Beyond a full IDE like Visual Studio, you'd need to go with something like Intel's <a href=\"https://software.intel.com/en-us/intel-inspector-xe\" rel=\"nofollow noreferrer\">Inspector</a> (formerly Intel Thread Checker), or on Linux, Valgrind's <a href=\"http://valgrind.org/docs/manual/hg-manual.html\" rel=\"nofollow noreferrer\">Helgrind</a> and <a href=\"http://valgrind.org/docs/manual/drd-manual.html\" rel=\"nofollow noreferrer\">DRD</a> and ThreadSanitizer (in the sanitizers above, but also Linux only AFAIK). But hopefully this list gives you a place to start. </p>\n"}], "owner": {"reputation": 21, "user_id": 6062444, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa55eab4ffd642eb9f7140ab775e96ca?s=128&d=identicon&r=PG", "display_name": "Ricky Layman", "link": "https://stackoverflow.com/users/6062444/ricky-layman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1505328344, "creation_date": 1505312194, "last_edit_date": 1505313091, "question_id": 46199928, "link": "https://stackoverflow.com/questions/46199928/interpreting-access-violation-exceptions", "title": "Interpreting Access Violation Exceptions?", "body": "<p>We have a custom application we use built around VB/C++ code.\nThis code will run for days, weeks, months, without this throwing up an exception error.</p>\n\n<p>I'm trying to learn more about how this error is thrown, and how to interpret (if you can) the error listed when an exception is thrown. I've googled some information and read the Microsoft provided error description, but I'm still stuck with the task of trouble shooting something that occurs once in a blue moon. There is no known set of interactions with the software that causes this and appears to happen randomly.</p>\n\n<p>Is the first exception the root cause? Is it all the way down the stack call? Can anyone provide any insight on how to read these codes so I could interpret where I actually need to look.</p>\n\n<p>Any information or guidance on reading the exception or making any use of it, and then trouble shooting it would be helpful. The test below is copied from  windows log when the event was thrown. </p>\n\n<p>Thanks in advance for any help.</p>\n\n<pre><code>Application: Epic.exe Framework Version: v4.0.30319 Description: The process was terminated due to an unhandled exception. Exception Info: System.AccessViolationException [![enter image description here][1]][1]\nat MemMap.ComBuf.IsCharAvailable(Int32) \nat HMI.frmPmacStat.RefreshTimer_Elapsed(System.Object, System.Timers.ElapsedEventArgs) \nat System.Timers.Timer.MyTimerCallback(System.Object) \nat System.Threading.TimerQueueTimer.CallCallbackInContext(System.Object) \nat System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, \nSystem.Threading.ContextCallback, System.Object, Boolean) \nat System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, \nSystem.Threading.ContextCallback, System.Object, Boolean) \nat System.Threading.TimerQueueTimer.CallCallback() \nat System.Threading.TimerQueueTimer.Fire() \nat System.Threading.TimerQueue.FireQueuedTimerCompletion(System.Object) \nat System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem() \nat System.Threading.ThreadPoolWorkQueue.Dispatch() \nat System.Threading._ThreadPoolWaitCallback.PerformWaitCallback()\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/faCGY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/faCGY.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/eLNr7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eLNr7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 3, "creation_date": 1505311619, "post_id": 46199692, "comment_id": 79362035, "body": "What&#39;s the point of <code>vary_result = rand() % range + minimum_value;</code>? That doesn&#39;t seem to have anything to do with the stated goal"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1505311620, "post_id": 46199692, "comment_id": 79362036, "body": "check if the value is in the array, call the result <code>x</code> then the check if it is not in the array is <code>!x</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1505311822, "post_id": 46199692, "comment_id": 79362169, "body": "<a href=\"http://en.cppreference.com/w/cpp/algorithm/all_any_none_of\" rel=\"nofollow noreferrer\"><code>std::none_off</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 4, "last_activity_date": 1505312900, "last_edit_date": 1505312900, "creation_date": 1505312121, "answer_id": 46199897, "question_id": 46199692, "link": "https://stackoverflow.com/questions/46199692/is-there-a-way-to-check-if-an-int-not-equal-to-all-values-in-an-array-c/46199897#46199897", "title": "Is there a way to check if an int not equal to all values in an array? (C++)", "body": "<blockquote>\n  <p>I know there is a way to check if a value is in an array, but is there a way to check if a value is not?</p>\n</blockquote>\n\n<p>Second is just opposite to the first:</p>\n\n<pre><code>auto begin = buffer_array;\nauto end   = buffer_array + buffer;\nauto it = std::find(begin, end, value );\nif( it == end ) // value not found which means none of the elements equal to value, which means value is not in array\n    // do whatever, but do not dereference it\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8603171, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-llBX_5Ceofk/AAAAAAAAAAI/AAAAAAAAAKA/EA5qlOi4SL4/photo.jpg?sz=128", "display_name": "Tze Zhao Chong", "link": "https://stackoverflow.com/users/8603171/tze-zhao-chong"}, "edited": false, "score": 0, "creation_date": 1505398945, "post_id": 46202901, "comment_id": 79406061, "body": "Your code has a problem, let&#39;s say if the second last value of the array was equal to the test value, notInIt would be false. However, if the last value of the array was not equal to the test value, notIntIt would be true. Hence, it would seem that the test variable was not in the array even though it was."}], "tags": [], "owner": {"reputation": 61, "user_id": 8604526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8cc3639af1755db1a506b8683c81773?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Dullea", "link": "https://stackoverflow.com/users/8604526/nathan-dullea"}, "is_accepted": false, "score": 2, "last_activity_date": 1505322381, "last_edit_date": 1505322381, "creation_date": 1505321129, "answer_id": 46202901, "question_id": 46199692, "link": "https://stackoverflow.com/questions/46199692/is-there-a-way-to-check-if-an-int-not-equal-to-all-values-in-an-array-c/46202901#46202901", "title": "Is there a way to check if an int not equal to all values in an array? (C++)", "body": "<p>Yes there is a way to test if a value is not in an array. Here is how I did it:</p>\n\n<pre><code> bool valueInArray;\n bool valueNotInArray = true;\n int valueToTest = 10;\n int valuesArray[] = [1, 2, 3, 5, 9];\n\n\n for(int i = valuesArray.length(); i &lt;= valuesArray.length(); i++) {\n if(valueToTest == valuesArray[i]) \n    notInIt == false;\n }\n\n if (notInIt == false) \n    valueInArray = true;\n else\n    valueInArray = false;\n</code></pre>\n\n<p>Essentially, I created two booleans, a number to test, and an array. I went through the array with a for loop to test if the number was in the array. Then, I used a if/else to set the other boolean opposite of previous one. In this way, the final boolean reflects if the value is not in the array. </p>\n"}], "owner": {"reputation": 1, "user_id": 8603171, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-llBX_5Ceofk/AAAAAAAAAAI/AAAAAAAAAKA/EA5qlOi4SL4/photo.jpg?sz=128", "display_name": "Tze Zhao Chong", "link": "https://stackoverflow.com/users/8603171/tze-zhao-chong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1505363877, "creation_date": 1505311527, "last_edit_date": 1505363877, "question_id": 46199692, "link": "https://stackoverflow.com/questions/46199692/is-there-a-way-to-check-if-an-int-not-equal-to-all-values-in-an-array-c", "title": "Is there a way to check if an int not equal to all values in an array? (C++)", "body": "<p>I know there is a way to check if a value is in an array, but is there a way to \ncheck if a value is not?</p>\n\n<p>This code will check through every index but will ignore the past indexes when it goes on to the next one.\n(i.e. Is there a code that checks that vary_result!= \"all values in array\"?)</p>\n\n<pre><code>int buffer; //all variables\nint vary_result;\nint range;\nint minimum_value;\nfor(int j = 0; j &lt; buffer; j++) {\n    if(vary_result == buffer_array[j]){\n        vary_result = rand() % range + minimum_value; // creates a random value and saves it at vary_result\n        };\n    };\ncout &lt;&lt; vary_result &lt;&lt; endl;\n</code></pre>\n"}, {"tags": ["c++", "opencv", "computer-vision"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1505311568, "post_id": 46199558, "comment_id": 79362007, "body": "<code>using namespace std;</code> is a bad habit to get into and if you can stop now you might avoid a whole lot of headaches in the future. The <code>std::</code> prefix is there for a reason: It avoids conflict with your own classes, structures and variables."}, {"owner": {"reputation": 869, "user_id": 5252807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c450edfed672155562bf4ee91a8c71bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ozlu", "link": "https://stackoverflow.com/users/5252807/ozlu"}, "edited": false, "score": 1, "creation_date": 1505545538, "post_id": 46199558, "comment_id": 79465972, "body": "<a href=\"https://github.com/ahmetozlu/open_source_markerless_augmented_reality/wiki/Markerless-Augmented-Reality-Tutorial\" rel=\"nofollow noreferrer\">Here</a> is the tutorial for marker-less augmented reality project (programmed in c++). This project has future matching part and more things about image matching, it can be helpful for you. <a href=\"https://www.youtube.com/watch?v=nPfR5ACrqu0\" rel=\"nofollow noreferrer\">This</a> is the demo video of the project."}, {"owner": {"reputation": 145, "user_id": 5761108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1kzhj.jpg?s=128&g=1", "display_name": "Althaf", "link": "https://stackoverflow.com/users/5761108/althaf"}, "edited": false, "score": 0, "creation_date": 1505623326, "post_id": 46199558, "comment_id": 79484848, "body": "Thank You Olzu, Will check that :) Thank you very much again!"}], "answers": [{"tags": [], "owner": {"reputation": 904, "user_id": 3666130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cf623aa29e419265b9d44360a9e524?s=128&d=identicon&r=PG&f=1", "display_name": "RevJohn", "link": "https://stackoverflow.com/users/3666130/revjohn"}, "is_accepted": false, "score": 2, "last_activity_date": 1519843388, "creation_date": 1519843388, "answer_id": 49036458, "question_id": 46199558, "link": "https://stackoverflow.com/questions/46199558/orb-feature-matching-with-flann-in-c/49036458#49036458", "title": "ORB feature matching with FLANN in C++", "body": "<p>ORB is a binary descriptor and needs a different (Hamming distance) matcher for that:</p>\n\n<pre><code>Ptr&lt;DescriptorMatcher&gt; matcher = DescriptorMatcher::create(\"BruteForce-Hamming\");\n</code></pre>\n\n<p>(taken from: <a href=\"https://docs.opencv.org/3.4.1/dc/d16/tutorial_akaze_tracking.html\" rel=\"nofollow noreferrer\">https://docs.opencv.org/3.4.1/dc/d16/tutorial_akaze_tracking.html</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10962706, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hLVPbnGSWAM/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM1lRw04ChJpOvjXqYnMqUWbz03Vw/mo/photo.jpg?sz=128", "display_name": "ArthurOnion", "link": "https://stackoverflow.com/users/10962706/arthuronion"}, "is_accepted": false, "score": 2, "last_activity_date": 1575647854, "creation_date": 1575647854, "answer_id": 59216457, "question_id": 46199558, "link": "https://stackoverflow.com/questions/46199558/orb-feature-matching-with-flann-in-c/59216457#59216457", "title": "ORB feature matching with FLANN in C++", "body": "<pre><code>im_left = imread(\"im_left.png\", IMREAD_GRAYSCALE);\nim_left = imread(\"im_right.png\", IMREAD_GRAYSCALE);\n</code></pre>\n\n<p>You have read images into the same variable twice. </p>\n"}], "owner": {"reputation": 145, "user_id": 5761108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1kzhj.jpg?s=128&g=1", "display_name": "Althaf", "link": "https://stackoverflow.com/users/5761108/althaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2360, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1575647854, "creation_date": 1505311138, "last_edit_date": 1530608191, "question_id": 46199558, "link": "https://stackoverflow.com/questions/46199558/orb-feature-matching-with-flann-in-c", "title": "ORB feature matching with FLANN in C++", "body": "<p>I'm trying to get the match feature points from two images, for further processing. I wrote the following code by referring an <a href=\"http://docs.opencv.org/2.4/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html\" rel=\"nofollow noreferrer\">example</a> of a SURF Feature Matching by FLANN, but in ORB.</p>\n\n<p>here is the code:</p>\n\n<pre><code>#include \"opencv2/video/tracking.hpp\"\n#include \"opencv2/imgproc.hpp\"\n#include \"opencv2/videoio.hpp\"\n#include \"opencv2/highgui.hpp\"\n#include \"opencv2/features2D.hpp\"\n\n\nusing namespace cv;\nusing namespace std;\n\n\n\nint main(int argc, char** argv)\n{\nMat im_left, im_right;\nMat descriptor_1, descriptor_2;\n\nvector&lt;KeyPoint&gt; keypoints_1, keypoints_2;\n\nim_left = imread(\"im_left.png\", IMREAD_GRAYSCALE);\nim_left = imread(\"im_right.png\", IMREAD_GRAYSCALE);\n\nPtr&lt;ORB&gt; detector = ORB::create();\nvector&lt;DMatch&gt; matches;\nFlannBasedMatcher matcher;\nPtr&lt;DescriptorExtractor&gt; extractor;\n\n\ndetector-&gt;detect(im_right, keypoints_1, descriptor_1);\ndetector-&gt;detect(im_left, keypoints_2, descriptor_2);\n\nmatcher.match(descriptor_1, descriptor_2, matches);\n\nMat img_match;\n\ndrawMatches(im_left, keypoints_1, im_right, keypoints_2, matches, img_match);\nimshow(\"Matches\", img_match);\n\n\n\nwaitKey(10000);\nreturn 0;\n}\n</code></pre>\n\n<p>But this throws an exception error saying:</p>\n\n<blockquote>\n  <p>Unhandled exception at 0x00007FF97D3B9E08 in Project1.exe: Microsoft C++ exception: cv::Exception at memory location 0x0000009E5D4FE3B0. occurred</p>\n</blockquote>\n\n<p>May be my code is full of nonsense, appreciate if someone can help me out on solving this.</p>\n"}, {"tags": ["c++", "boost-asio"], "comments": [{"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1505313005, "post_id": 46199459, "comment_id": 79363093, "body": "I don&#39;t understand the difference between the two possibilities you mentioned. Both will lead to blocking after a task is executed. Also consider that there are no priorities (or anything similar) assigned to tasks when pushed to the queue... how do you expect <code>io_service</code> to make any difference between tasks?"}, {"owner": {"reputation": 3297, "user_id": 1537441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75aa876d98894ceda825017af4b035df?s=128&d=identicon&r=PG", "display_name": "krzychu", "link": "https://stackoverflow.com/users/1537441/krzychu"}, "reply_to_user": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1505313703, "post_id": 46199459, "comment_id": 79363615, "body": "If thread is busy, and new work is assigned to it, it will be able to handle the new work item only after it finished processing whatever it was busy with. Hence the work item has to wait for processing, even though other threads in the pool are available. In the other possibility, tasks are assigned only to non-busy threads, and hence if there are any available threads, the work item processing starts immediately."}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1505313935, "post_id": 46199459, "comment_id": 79363790, "body": "OK, now I see the issue. Actually I don&#39;t believe that. I often used <code>io_service</code> for thread pools (not the best practice, I know), and never noticed this. You could easily create an <a href=\"https://stackoverflow.com/help/mcve\">MVCE</a> where you demonstrate the problem with simple sleep functions, and then we can discuss based on evidence. Guessing what a library does is futile."}], "answers": [{"comments": [{"owner": {"reputation": 3297, "user_id": 1537441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75aa876d98894ceda825017af4b035df?s=128&d=identicon&r=PG", "display_name": "krzychu", "link": "https://stackoverflow.com/users/1537441/krzychu"}, "edited": false, "score": 0, "creation_date": 1505386787, "post_id": 46203708, "comment_id": 79397080, "body": "Thanks for the answer. Do you maybe have a reference to a documentation or code, which would show that?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 3297, "user_id": 1537441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75aa876d98894ceda825017af4b035df?s=128&d=identicon&r=PG", "display_name": "krzychu", "link": "https://stackoverflow.com/users/1537441/krzychu"}, "edited": false, "score": 0, "creation_date": 1505391892, "post_id": 46203708, "comment_id": 79400584, "body": "It&#39;s all over. The fact that it doesn&#39;t say that there&#39;s task-to-thread affinity is enough. I mean, really. You don&#39;t ask me to quote the docs where it says that it doesn&#39;t kill puppies&#185; (&#185; with the exception of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined Behaviour</a>)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 3297, "user_id": 1537441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75aa876d98894ceda825017af4b035df?s=128&d=identicon&r=PG", "display_name": "krzychu", "link": "https://stackoverflow.com/users/1537441/krzychu"}, "edited": false, "score": 0, "creation_date": 1505392105, "post_id": 46203708, "comment_id": 79400752, "body": "This might help <a href=\"http://www.boost.org/doc/libs/master/doc/html/boost_asio/overview/core/threads.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/master/doc/html/boost_asio/overview/core/&zwnj;&#8203;&hellip;</a>"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1505324236, "creation_date": 1505324236, "answer_id": 46203708, "question_id": 46199459, "link": "https://stackoverflow.com/questions/46199459/behavior-of-boostasioio-service-thread-pool-during-uneven-load/46203708#46203708", "title": "Behavior of boost::asio::io_service thread pool during uneven load", "body": "<blockquote>\n  <p>When executing a handler, a thread is not considered waiting, and hence no new handlers to execute are assigned to it. Is that correct? </p>\n</blockquote>\n\n<p>Yes. It's a pull model queue.</p>\n\n<p>A notable \"apparent\" exception is when strands are used: handlers wrapped on a on a strand do synchronize with other handlers running on that same strand.</p>\n"}], "owner": {"reputation": 3297, "user_id": 1537441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75aa876d98894ceda825017af4b035df?s=128&d=identicon&r=PG", "display_name": "krzychu", "link": "https://stackoverflow.com/users/1537441/krzychu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505324236, "creation_date": 1505310835, "question_id": 46199459, "link": "https://stackoverflow.com/questions/46199459/behavior-of-boostasioio-service-thread-pool-during-uneven-load", "title": "Behavior of boost::asio::io_service thread pool during uneven load", "body": "<p>I have hard time finding out how exactly does thread pool built with <code>boost::asio::io_service</code> behave. </p>\n\n<p>The <a href=\"http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/reference/io_service/run/overload1.html\" rel=\"nofollow noreferrer\">documentation</a> says:</p>\n\n<blockquote>\n  <p>Multiple threads may call the <code>run()</code> function to set up a pool of\n  threads from which the io_service may execute handlers. <strong>All threads\n  that are waiting in the pool are equivalent and the io_service may\n  choose any one of them to invoke a handler.</strong></p>\n</blockquote>\n\n<p>I would imagine, that when threads executing <code>run()</code> are taking a handler to execute, they execute it, and then come back to wait for next handlers to execute. When executing a handler, a thread is not considered waiting, and hence no new handlers to execute are assigned to it. Is that correct? Or does <code>io_service</code> assign work to threads, without considering whether these are busy or not?</p>\n\n<p>I am asking, because in one project that we are using (<a href=\"https://github.com/Project-OSRM/osrm-backend\" rel=\"nofollow noreferrer\">OSRM</a>), that uses <code>boost::asio::io_service</code> based thread pool to handle incoming HTTP requests, I noticed that long running request, <strong>sometimes</strong> block other, fast requests, even though more threads and cores are available.</p>\n"}, {"tags": ["c++", "direct3d", "direct3d11"], "comments": [{"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1505317800, "post_id": 46199404, "comment_id": 79366601, "body": "You can try two things: use DXGI_FORMAT_R8G8B8A8_UNORM, DXGI_FORMAT_R8G8B8X8_UNORM, DXGI_FORMAT_B8G8R8X8_UNORM or even better use the format from the D3D11SwapChain-&gt;GetBuffer(0... texture; AND/OR replace CopyResource with CopySubresource: <a href=\"https://stackoverflow.com/a/10624205/2440728\">stackoverflow.com/a/10624205/2440728</a>"}, {"owner": {"reputation": 504, "user_id": 2802627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19841e15694b046c067157d392615d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Hide", "link": "https://stackoverflow.com/users/2802627/alex-hide"}, "reply_to_user": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1505318587, "post_id": 46199404, "comment_id": 79367135, "body": "@VuVirt Thanks, I&#39;ll try it. Original texture is DXGI_FORMAT_R8G8B8A8_UNORM_SRGB aswell."}, {"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1505319409, "post_id": 46199404, "comment_id": 79367634, "body": "is it always DXGI_FORMAT_R8G8B8A8_UNORM_SRGB when running on other GPUs?"}, {"owner": {"reputation": 504, "user_id": 2802627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19841e15694b046c067157d392615d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Hide", "link": "https://stackoverflow.com/users/2802627/alex-hide"}, "reply_to_user": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1505319794, "post_id": 46199404, "comment_id": 79367858, "body": "@VuVirt Yes, it is"}, {"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1505320102, "post_id": 46199404, "comment_id": 79368019, "body": "the reason for the crash could be wrong or not up-to-date video drivers"}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1505324934, "post_id": 46199404, "comment_id": 79370790, "body": "Are you still calling <code>Present</code> every frame?"}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1505324971, "post_id": 46199404, "comment_id": 79370816, "body": "BTW, you should take a look at the <a href=\"https://github.com/Microsoft/DirectXTK/blob/master/Src/ScreenGrab.cpp\" rel=\"nofollow noreferrer\">ScreenGrab</a> source code in the <i>DirectX Tool Kit</i>."}, {"owner": {"reputation": 504, "user_id": 2802627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19841e15694b046c067157d392615d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Hide", "link": "https://stackoverflow.com/users/2802627/alex-hide"}, "reply_to_user": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1505325638, "post_id": 46199404, "comment_id": 79371179, "body": "@ChuckWalbourn As I&#39;m injecting to another application, I don&#39;t know, but it&#39;s the same every time. Thanks for the link."}, {"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1505378587, "post_id": 46199404, "comment_id": 79391437, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ff476392(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a> CopyResource might fail if the source and destination dimensions/formats  are different; or when the source texture is Map&#39;ed; or when the backbuffer is multisampled (in this case you should call ResolveSubResource first)."}, {"owner": {"reputation": 504, "user_id": 2802627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19841e15694b046c067157d392615d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Hide", "link": "https://stackoverflow.com/users/2802627/alex-hide"}, "reply_to_user": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1505380910, "post_id": 46199404, "comment_id": 79393052, "body": "@VuVirt desc.SampleDesc.Count is 1 always. As I mentioned above, I use format and dimensions from original texture (GetDesc and then applied it to create my texture). I&#39;ve tried to check if texture is _STAGING, but it never was. Is there any way to check whether texture is already mapped?"}, {"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 1, "creation_date": 1505381006, "post_id": 46199404, "comment_id": 79393120, "body": "Not that I know of, but you can try to call your extract function in a different moment from your hook, to see if it changes anything."}], "answers": [{"tags": [], "owner": {"reputation": 504, "user_id": 2802627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19841e15694b046c067157d392615d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Hide", "link": "https://stackoverflow.com/users/2802627/alex-hide"}, "is_accepted": true, "score": 0, "last_activity_date": 1505672877, "creation_date": 1505672877, "answer_id": 46267493, "question_id": 46199404, "link": "https://stackoverflow.com/questions/46199404/direct3d11-screenshot-crash/46267493#46267493", "title": "Direct3D11 Screenshot crash", "body": "<p>Got it wokring. I was running my code in separate thread. After I moved it to hooked Present(), application did not crash.</p>\n"}], "owner": {"reputation": 504, "user_id": 2802627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19841e15694b046c067157d392615d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Hide", "link": "https://stackoverflow.com/users/2802627/alex-hide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 46267493, "answer_count": 1, "score": 0, "last_activity_date": 1505672877, "creation_date": 1505310657, "last_edit_date": 1505322955, "question_id": 46199404, "link": "https://stackoverflow.com/questions/46199404/direct3d11-screenshot-crash", "title": "Direct3D11 Screenshot crash", "body": "<p>I'm trying to get, basically, screenshot (each 1 second, without saving) of Direct3D11 application. Code works fine on my PC(Intel CPU, Radeon GPU) but crashes after few iterations on 2 others (Intel CPU + Intel integrated GPU, Intel CPU + Nvidia GPU).</p>\n\n<pre><code>void extractBitmap(void* texture) {\n\n    if (texture) {\n        ID3D11Texture2D* d3dtex = (ID3D11Texture2D*)texture;\n        ID3D11Texture2D* pNewTexture = NULL;\n\n        D3D11_TEXTURE2D_DESC desc;\n        d3dtex-&gt;GetDesc(&amp;desc);\n\n        desc.BindFlags = 0;\n        desc.CPUAccessFlags = D3D11_CPU_ACCESS_READ | D3D11_CPU_ACCESS_WRITE;\n        desc.Usage = D3D11_USAGE_STAGING;\n        desc.Format = DXGI_FORMAT_R8G8B8A8_UNORM_SRGB;\n\n        HRESULT hRes = D3D11Device-&gt;CreateTexture2D(&amp;desc, NULL, &amp;pNewTexture);\n\n        if (FAILED(hRes)) {\n            printCon(std::string(\"CreateTexture2D FAILED:\" + format_error(hRes)).c_str());\n            if (hRes == DXGI_ERROR_DEVICE_REMOVED)\n                printCon(std::string(\"DXGI_ERROR_DEVICE_REMOVED -- \" + format_error(D3D11Device-&gt;GetDeviceRemovedReason())).c_str());\n        }\n        else {\n            if (pNewTexture) {\n                D3D11DeviceContext-&gt;CopyResource(pNewTexture, d3dtex);\n\n                // Wokring with texture\n\n                pNewTexture-&gt;Release();\n            }\n        }\n    }\n    return;\n}\n\n\nD3D11SwapChain-&gt;GetBuffer(0, __uuidof(ID3D11Texture2D), reinterpret_cast&lt; void** &gt;(&amp;pBackBuffer));\nextractBitmap(pBackBuffer);\npBackBuffer-&gt;Release();\n</code></pre>\n\n<p>Crash log:</p>\n\n<pre><code>CreateTexture2D FAILED:887a0005\nDXGI_ERROR_DEVICE_REMOVED -- 887a0020\n</code></pre>\n\n<p>Once I comment out <code>D3D11DeviceContext-&gt;CopyResource(pNewTexture, d3dtex);</code> code works fine on all 3 PC's.</p>\n"}, {"tags": ["c++", "boost", "iterator", "boost-iterators"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1505311313, "post_id": 46199343, "comment_id": 79361847, "body": "There&#39;s no way it will know what you&#39;re storing these into. <code>myc</code> is non-const, so the tuple will contain non-const iterators. It&#39;s up to the tuple type to make <code>get</code> return something non-modifiable when used with a const tuple of references. It would have to go out of its way because <code>const T&amp;</code> when <code>T</code> is a non-const reference collapses to the same non-const reference type."}], "answers": [{"tags": [], "owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "is_accepted": true, "score": 2, "last_activity_date": 1505311436, "creation_date": 1505311436, "answer_id": 46199672, "question_id": 46199343, "link": "https://stackoverflow.com/questions/46199343/boost-zip-iterator-ignoring-const-correctness/46199672#46199672", "title": "boost zip_iterator ignoring const correctness", "body": "<p>If you iterate over a <code>const MyClass</code> then you will get the compile error you desire:</p>\n\n<pre><code>for (const auto &amp;ab: const_cast&lt;MyClass const&amp;&gt;(myc))\n    ab.get&lt;0&gt;() = 66;\n</code></pre>\n\n<p>You can use <code>std::as_const</code> instead of the <code>const_cast</code>:</p>\n\n<pre><code>for (const auto &amp;ab: std::as_const(myc))\n    ab.get&lt;0&gt;() = 66;\n</code></pre>\n\n<p>This works because the <code>const</code> overloads of <code>begin</code> and <code>end</code> will be called instead, and they return a <code>zip_iterator</code> of const iterators.</p>\n"}, {"tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1505311555, "creation_date": 1505311555, "answer_id": 46199701, "question_id": 46199343, "link": "https://stackoverflow.com/questions/46199343/boost-zip-iterator-ignoring-const-correctness/46199701#46199701", "title": "boost zip_iterator ignoring const correctness", "body": "<p>Your problem is that <code>myc</code> is not const, so you are iterating through it with a <code>myc::iterator</code>, not a <code>myc::const_iterator</code>.</p>\n\n<p>You then bind <code>ab</code> to the result of indirecting through that iterator.  <code>ab.get&lt;0&gt;</code>() will be a const method (because it doesn't change <code>ab</code>), but it returns a reference to a <em>non</em>-const int.</p>\n\n<p>The solution is to use <code>std::as_const(myc)</code> (where you won't even need the <code>const</code> on the declaration of <code>ab</code>).</p>\n\n<pre><code>for (auto &amp;ab: std::as_const(myc))\n    ab.get&lt;0&gt;() = 66;  // Error.  Cannot write to const object.\n</code></pre>\n"}], "owner": {"reputation": 1211, "user_id": 2928970, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/65acc98fc43bf4eee13ae060a7e7b730?s=128&d=identicon&r=PG&f=1", "display_name": "hovnatan", "link": "https://stackoverflow.com/users/2928970/hovnatan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 46199672, "answer_count": 2, "score": 1, "last_activity_date": 1505311555, "creation_date": 1505310492, "last_edit_date": 1505310699, "question_id": 46199343, "link": "https://stackoverflow.com/questions/46199343/boost-zip-iterator-ignoring-const-correctness", "title": "boost zip_iterator ignoring const correctness", "body": "<p>In the for loop inside the <code>main()</code> function of the following code, I can change the variables inside the variable <code>ab</code> even when the <code>const auto&amp;</code> is used in the loop. Is there any way to avoid this?</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\n#include &lt;boost/iterator/zip_iterator.hpp&gt;\n#include &lt;boost/tuple/tuple.hpp&gt;\n\nusing namespace std;\n\nstruct MyClass {\n  std::vector&lt;int&gt; a{11, 21, 41};\n  std::vector&lt;int&gt; b{1, 2, 4};\n  typedef boost::zip_iterator&lt;boost::tuple&lt;std::vector&lt;int&gt;::const_iterator, std::vector&lt;int&gt;::const_iterator&gt;&gt; const_iterator;\n  typedef boost::zip_iterator&lt;boost::tuple&lt;std::vector&lt;int&gt;::iterator, std::vector&lt;int&gt;::iterator&gt;&gt; iterator;\n\n  const_iterator begin() const {\n    return const_iterator(boost::make_tuple(a.cbegin(), b.cbegin()));\n  }\n  const_iterator end() const {\n    return const_iterator(boost::make_tuple(a.cend(), b.cend()));\n  }\n  iterator begin() {\n    return iterator(boost::make_tuple(a.begin(), b.begin()));\n  }\n  iterator end() {\n    return iterator(boost::make_tuple(a.end(), b.end()));\n  }\n};\n\n\nint main(int argc, char** argv)  \n{\n  MyClass myc;\n  for (const auto &amp;ab: myc)\n    ab.get&lt;0&gt;() = 66;\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "qt", "qfile", "qnetworkreply"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1505310394, "post_id": 46199236, "comment_id": 79361148, "body": "You don&#39;t even attempt to check if <code>file.write</code> wrote all the data. Read what functions do and what their return values mean."}], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 5654683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd499ce8374ac271843948353695ddd2?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Semkin", "link": "https://stackoverflow.com/users/5654683/philip-semkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1505413607, "creation_date": 1505413607, "answer_id": 46226007, "question_id": 46199236, "link": "https://stackoverflow.com/questions/46199236/wrong-donwloaded-filesize-in-qt-5-6/46226007#46226007", "title": "Wrong donwloaded filesize in Qt 5.6", "body": "<p>You should call DownloadManager::saveToDisk by signal QNetworkReply::readyRead</p>\n\n<pre><code>void DownloadManager::onDownloadReadyRead( QNetworkReply *reply )\n{\n    ...\n    saveToDisk( filename, reply );\n    ...\n}\n\nvoid DownloadManager::saveToDisk( QNetworkReply* reply )\n{\n    ...\n    file.write( reply-&gt;read( reply_-&gt;bytesAvailable() ) );\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 7998081, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b5c1cef3dff3bec5202c767e7ba163ef?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/7998081/john-smith"}, "is_accepted": true, "score": 0, "last_activity_date": 1505475641, "last_edit_date": 1505475641, "creation_date": 1505470531, "answer_id": 46237185, "question_id": 46199236, "link": "https://stackoverflow.com/questions/46199236/wrong-donwloaded-filesize-in-qt-5-6/46237185#46237185", "title": "Wrong donwloaded filesize in Qt 5.6", "body": "<p>It's ok. I replaced this line :</p>\n\n<pre><code>file.write(data-&gt;readAll());\nfile.close();\nreturn true;\n</code></pre>\n\n<p>by </p>\n\n<pre><code>ByteArray ba = data-&gt;readAll();\nint nbTries = 99;\nint n = ba.size();\nint idx = 0;\n\nwhile (n &gt; 0 &amp;&amp; nbTries &gt; 0)\n{\n  int ret = file.write(ba.data() + idx, std::min(16*1024, n));\n  if (ret &gt; 0)\n  {\n      n -= ret;\n      idx += ret;\n  }\n  else\n  {\n     nbTries --;\n  }\n}\n\nfile.close();\nreturn nbTries &gt; 0;\n</code></pre>\n\n<p>I wrote several chunks instead of one big</p>\n"}], "owner": {"reputation": 123, "user_id": 7998081, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b5c1cef3dff3bec5202c767e7ba163ef?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/7998081/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 46237185, "answer_count": 2, "score": 0, "last_activity_date": 1505475724, "creation_date": 1505310221, "last_edit_date": 1505475724, "question_id": 46199236, "link": "https://stackoverflow.com/questions/46199236/wrong-donwloaded-filesize-in-qt-5-6", "title": "Wrong donwloaded filesize in Qt 5.6", "body": "<p>I used a DownloadManager class like that but the problem is that for large file I have a wrong size 65536KB instead of 51328022 bytes. There are something wrong in the saveDisk method.</p>\n\n<p>ps: I used Qt 5.6 cuz I need to run the app on Windows Vista &amp; XP</p>\n\n<pre><code>bool DownloadManager::saveToDisk(const QString &amp;filename, QIODevice *data)\n{\n    LogManager* logmgr = LogManager::GetInstance();\n    FileManager* filemgr = FileManager::GetInstance();\n\n    QFileInfo fileinfo(filename);\n    QString dirpath = fileinfo.absoluteDir().absolutePath();\n\n    if (!filemgr-&gt;DirectoryIsPresent(dirpath))\n    {\n        if (!filemgr-&gt;CreateDirectory(dirpath)) {\n            logmgr-&gt;Log(LOG_LEVEL_ERROR, QString(\"cannot create directory (\") + dirpath + \")\");\n        }\n    }\n\n    QFile file(filename);\n    if (!file.open(QIODevice::WriteOnly)) {\n        const QString errorText = QString(\"Could not open \") + filename + QString(\" for writing:\") + file.errorString();\n        logmgr-&gt;Log(LOG_LEVEL_ERROR, errorText);\n        return false;\n    }\n\n    file.write(data-&gt;readAll());\n    file.close();\n\n    return true;\n}\n\nvoid DownloadManager::downloadFinished(QNetworkReply *reply)\n{\n    LogManager* logmgr = LogManager::GetInstance();\n\n    if (m_currentDownloads.contains(reply))\n    {\n        QUrl url = reply-&gt;url();\n        if (reply-&gt;error() != QNetworkReply::NoError) {\n            m_nbFailedDownload++;\n            const QString errorText = QString(\"Download of \")+ url.toString() +\" failed: \" + reply-&gt;errorString() + \" (\" + QString::number(reply-&gt;error()) + \")\";\n            logmgr-&gt;Log(LOG_LEVEL_ERROR, errorText);\n        } else {\n            m_nbSucceededDownload++;\n            QString filename = saveFileName(url);\n            if (saveToDisk(filename, reply))\n            {\n                const QString infoText = QString(\"Download of \") + url.toString() + \" succeeded (saved to \" + filename + \")\";\n                logmgr-&gt;Log(LOG_LEVEL_INFO, infoText);\n            }\n        }\n\n        m_currentDownloads.removeAll(reply);\n        reply-&gt;deleteLater();\n    }\n\n    int total = m_nbTotalDownload == 0? 1:m_nbTotalDownload;\n    emit onProgress((m_nbFailedDownload + m_nbSucceededDownload) * 100 / total);\n\n\n    if (m_currentDownloads.isEmpty()){\n        logmgr-&gt;Log(LOG_LEVEL_INFO, \"DownloadManager downloads finished\");\n        emit onFinished();\n    }\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 8, "creation_date": 1505308716, "post_id": 46198648, "comment_id": 79359824, "body": "No authoritative answer can be given without more context. C++&#39;s grammar is quite complicated. For example &#39;X *p&#39; could mean either multipliation, or a pointer declaration. You need to provide more context."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1505308765, "post_id": 46198648, "comment_id": 79359867, "body": "Lots of BS in the comments thus far. Comments are not for guessing answers. Correct answer below."}, {"owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 2, "creation_date": 1505308801, "post_id": 46198648, "comment_id": 79359893, "body": "This is a valid question and shouldn&#39;t be getting downvotes."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1505308815, "post_id": 46198648, "comment_id": 79359903, "body": "Actually, @Bathsheba, given the additional context posted, the answer below is not correct."}, {"owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "reply_to_user": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 0, "creation_date": 1505310068, "post_id": 46198648, "comment_id": 79360895, "body": "@Simple Actually, it should get downvotes, as I do not see in his code what is being asked"}, {"owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "reply_to_user": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "edited": false, "score": 2, "creation_date": 1505310134, "post_id": 46198648, "comment_id": 79360941, "body": "@B\u0408\u043e\u0432\u0438\u045b did you not read the last sentence or the title of the question?"}, {"owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "reply_to_user": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 1, "creation_date": 1505310207, "post_id": 46198648, "comment_id": 79361002, "body": "@Simple No, I am looking for <code>a(), void(), b();</code> in the code that is posted. It is nowhere to be found. No strange <code>void()</code> anywhere to be seen. Closing the question."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1505315650, "post_id": 46198648, "comment_id": 79365003, "body": "Where is <code>void()</code> in the posted code?"}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 3, "creation_date": 1505308834, "post_id": 46198700, "comment_id": 79359920, "body": "Wow. I&#39;ve never heard that someone overloads <code>operator,</code>."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 5, "creation_date": 1505308881, "post_id": 46198700, "comment_id": 79359958, "body": "@iBug - This is C++, we can overload everything. EVERYTHING!"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1505309118, "post_id": 46198700, "comment_id": 79360136, "body": "Not quite yet: the member selection operator and ternary conditional operators being important exceptions. (Although doesn&#39;t Stroustrup want to relax the former?)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1505309229, "post_id": 46198700, "comment_id": 79360219, "body": "@Bathsheba - That proposal fell through, too much weirdness comes along with it, IIRC. Still, it&#39;s a damn impressive feat to make almost any expression context dependent :)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505309277, "post_id": 46198700, "comment_id": 79360269, "body": "@StoryTeller: I guess we got <code>operator&quot;&quot;</code> in compensation."}, {"owner": {"reputation": 4123, "user_id": 3378179, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3mmbS.png?s=128&g=1", "display_name": "Caduchon", "link": "https://stackoverflow.com/users/3378179/caduchon"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 2, "creation_date": 1505309280, "post_id": 46198700, "comment_id": 79360272, "body": "@iBug: fun fact : I did it to manage date/time format depending on the language. <code>(std::cout, lang::fr) &lt;&lt; time;</code>. It was funny. :-p"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1505309342, "post_id": 46198700, "comment_id": 79360334, "body": "So at last, are these six the only operators that can&#39;t be overloaded? <code>:: . .* ?: sizeof typeid</code> (double-colon, dot, dot-asterisk, ternary, sizeof, typeid)"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1505309373, "post_id": 46198700, "comment_id": 79360361, "body": "<code>decltype</code> as well."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1505309390, "post_id": 46198700, "comment_id": 79360371, "body": "@iBug - If you throw in <code>sizeof</code> than you should also bring up <code>alignof</code> and <code>decltype</code>."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 4123, "user_id": 3378179, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3mmbS.png?s=128&g=1", "display_name": "Caduchon", "link": "https://stackoverflow.com/users/3378179/caduchon"}, "edited": false, "score": 1, "creation_date": 1505309517, "post_id": 46198700, "comment_id": 79360481, "body": "@Caduchon By overloading <code>std::ostream&amp; operator,(std::ostream&amp;, LangType)</code> (where <code>LangType</code> is the type of <code>lang::fr</code>)?"}, {"owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 0, "creation_date": 1505310057, "post_id": 46198700, "comment_id": 79360883, "body": "There&#39;s also been a proposal to make <code>void</code> a regular old type (i.e. like <code>int</code>), which would stop this trick from working, and you&#39;d be unable to protect yourself from overloaded <code>operator,</code>"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1505312961, "post_id": 46198700, "comment_id": 79363066, "body": "@Simple Naw, you&#39;d just do <code>void(a()), void(b())</code> instead."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1505313015, "post_id": 46198700, "comment_id": 79363100, "body": "@StoryTeller Damn impressive feat, yes. Sanity lies in another direction, though (imho)."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1505313098, "post_id": 46198700, "comment_id": 79363156, "body": "@Simple If you have to defend against overloaded <code>operator,</code>, you are working with the wrong people, imho."}, {"owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505314000, "post_id": 46198700, "comment_id": 79363844, "body": "@cmaster you would do it when you are the author of some generic function in some library. It needs to work correctly in the presence of an overloaded <code>operator,</code> in the same way the standard library needs to work correctly in the presence of <code>operator&amp;</code> or <code>operator&amp;&amp;</code> or <code>operator||</code>."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1505315931, "post_id": 46198700, "comment_id": 79365199, "body": "@Simple But, if that <code>operator,</code> is present, <b>shouldn&#39;t</b> I be using that to use the type the way that it&#39;s supposed to be? Saying <code>foo(), void(), bar()</code> is like saying: I know, you may want to do something special in this situation, but I&#39;m not going to allow you to. Don&#39;t understand me wrong, I understand the problems of not using <code>, void(),</code> as well. I just want to point out that both <code>,</code> and <code>, void(),</code> can be considered wrong in the presence of an overloaded <code>operator,</code>. And, unless I know the precise <code>operator,</code> that I would be using, <i>I cannot make a sound decision</i>."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1505364299, "post_id": 46198700, "comment_id": 79384402, "body": "@cmaster Typical generic code uses <code>,</code> for its built-in meaning: evaluate the left, discard the result, evaluate the right, and return it. The &quot;discard the result&quot; part is part of the intended behavior; the comma is merely a tool to combine multiple disparate expressions into a single one where syntactically required. In the <code>unpack</code> example, the intended action is simply <code>do_something(pack.[0]); do_something(pack.[1]); ...</code> (using some imaginary syntax to index a pack); note that the results of these expressions are implicitly discarded. The <code>void()</code> trick merely made the discarding explicit."}], "tags": [], "owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "is_accepted": true, "score": 47, "last_activity_date": 1505309532, "last_edit_date": 1505309532, "creation_date": 1505308703, "answer_id": 46198700, "question_id": 46198648, "link": "https://stackoverflow.com/questions/46198648/usage-of-void-in-a-comma-separated-list/46198700#46198700", "title": "Usage of `void()` in a comma-separated list?", "body": "<p>The <code>void()</code> prevents an overloaded <code>operator,</code> from being called (where one of the parameters is of the type <code>SomeClass&lt;T&gt;</code>), as such an overload can't have a parameter of type <code>void</code>.</p>\n\n<p>You will most often see this used in templates, and is used in variadic pack expansions:</p>\n\n<pre><code>// C++11/14:\nint unpack[] = {0, (do_something(pack), void(), 0)...};\n// C++17 (fold expression):\n(void(do_something(pack)), ...);\n</code></pre>\n\n<p>Where an overloaded <code>operator,</code> could ruin the <a href=\"http://en.cppreference.com/w/cpp/language/eval_order\" rel=\"noreferrer\">sequencing guarantees</a> of the language.</p>\n"}], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2121, "favorite_count": 4, "accepted_answer_id": 46198700, "answer_count": 1, "score": 37, "last_activity_date": 1505314268, "creation_date": 1505308588, "last_edit_date": 1505314268, "question_id": 46198648, "link": "https://stackoverflow.com/questions/46198648/usage-of-void-in-a-comma-separated-list", "title": "Usage of `void()` in a comma-separated list?", "body": "<p>I was looking into a piece of code written by others when I saw this:</p>\n\n<pre><code>a(), void(), b();\n</code></pre>\n\n<p>where both <code>a</code> and <code>b</code> are instances of a user-defined template class, which is intended to act like a function by overloading <code>operator()</code> that returns the calling instance itself.</p>\n\n<p>Part of the class:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass SomeClass{\n    public:\n    SomeClass&amp; operator()(void);\n    const SomeClass&amp; operator()(void) const;\n}\n</code></pre>\n\n<p>The return statements for both overloads are the following:</p>\n\n<pre><code>template &lt;typename T&gt;\nSomeClass&lt;T&gt;&amp; SomeClass&lt;T&gt;::operator()(void){\n    // do stuff\n    return *this;\n}\n\ntemplate &lt;typename T&gt;\nconst SomeClass&lt;T&gt;&amp; SomeClass&lt;T&gt;::operator()(void) const{\n    // do stuff\n    return *this;\n}\n</code></pre>\n\n<p>What does the <code>void()</code> between them do? I feel it strange.</p>\n"}, {"tags": ["c++", "image", "bitmap", "splash-screen"], "comments": [{"owner": {"reputation": 639, "user_id": 1671661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8db94e53e65d244d49d87e506907a6?s=128&d=identicon&r=PG", "display_name": "KonstantinL", "link": "https://stackoverflow.com/users/1671661/konstantinl"}, "edited": false, "score": 0, "creation_date": 1505309567, "post_id": 46198594, "comment_id": 79360515, "body": "In 2004 bmp-files with alpha-channel was non-standard format. Probably you are better to search for newer CSplash :) And btw, &quot;RGB transparent color key&quot; does not mean &quot;alpha channel&quot;."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "reply_to_user": {"reputation": 639, "user_id": 1671661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8db94e53e65d244d49d87e506907a6?s=128&d=identicon&r=PG", "display_name": "KonstantinL", "link": "https://stackoverflow.com/users/1671661/konstantinl"}, "edited": false, "score": 0, "creation_date": 1505309735, "post_id": 46198594, "comment_id": 79360628, "body": "@KonstantinL Alright, thank you. and yea I have no idea what to label it as!"}], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1505309778, "post_id": 46199014, "comment_id": 79360669, "body": "Yeah I think you&#39;re right, must be anti-aliasing, I&#39;ll try it now"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1505310973, "post_id": 46199014, "comment_id": 79361609, "body": "Yepppppppppppppppppppppppppp fixed it in Photoshop! Ty!"}], "tags": [], "owner": {"reputation": 124, "user_id": 8597205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jcaU9.jpg?s=128&g=1", "display_name": "A. Knorre", "link": "https://stackoverflow.com/users/8597205/a-knorre"}, "is_accepted": true, "score": 0, "last_activity_date": 1505309611, "creation_date": 1505309611, "answer_id": 46199014, "question_id": 46198594, "link": "https://stackoverflow.com/questions/46198594/bmp-transparent-color-key-not-displaying-correctly/46199014#46199014", "title": "BMP transparent color key not displaying correctly", "body": "<p>The problem as I see it is that you original png image has transparent parts (glasses borders are not strictly opaque but more like smoothly transitioning to transparent), which is a common case. So having absolutely green background with this image above it results in green being altered a bit around glasses border and other images. And it is no longe (50, 200, 25), it could be (51, 201, 25) and no longer removed by CSplash.</p>\n\n<p>What you need to do is save you original PNG in transparent format where alpha channel is only 1 bit (0 or 1, transparent or opaque) - thus transitions will be lost, reopen it, and the do the green background trick again. </p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 46199014, "answer_count": 1, "score": 0, "last_activity_date": 1505309611, "creation_date": 1505308444, "question_id": 46198594, "link": "https://stackoverflow.com/questions/46198594/bmp-transparent-color-key-not-displaying-correctly", "title": "BMP transparent color key not displaying correctly", "body": "<p>I'm using a C++ class called <a href=\"https://www.codeproject.com/Articles/7658/CSplash-A-Splash-Window-Class\" rel=\"nofollow noreferrer\">CSplash</a> which is used to display a splash window in the center of the screen. It is designed to load only bitmap file types. It allows an RGB transparent color key to display the BMP with a transparent background.</p>\n\n<hr>\n\n<p>I have a PNG image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LSmBQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LSmBQ.png\" alt=\"Transparent PNG\"></a></p>\n\n<p>I opened this image in Photoshop and added a background color (50, 200, 25) as a transparent key.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ljElY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ljElY.png\" alt=\"Image Green BG\"></a></p>\n\n<p>I then save this image as a bitmap file in my project.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eOUSC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eOUSC.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am left with a file: <strong>PowerUp.bmp</strong></p>\n\n<p>In my C++ code, I imported the class mentioned above and in <code>WM_NCCREATE</code> I have the following code:</p>\n\n<pre><code>CSplash splash = CSplash(\"PowerUp.bmp\", RGB(50, 200, 25));\nsplash.WindowProc(hWnd, uMsg, wParam, lParam);\nsplash.ShowSplash();\nsplash.DoLoop();\n</code></pre>\n\n<p>When I run my program, the splash image shows with a transparent background, but not as expected. The result has some of the transparent color left around the icons.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qlBCi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qlBCi.png\" alt=\"Splash Result\"></a></p>\n\n<p>How can I fix this to make it look exactly like the transparent original PNG file?</p>\n"}, {"tags": ["c++", "multithreading", "qt5"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1505308053, "post_id": 46198391, "comment_id": 79359315, "body": "Sharing data between threads is really easy, since all threads in a single process shares the same memory. The problem is usually the <i>synchronization</i> of the data, so no two threads try to write the data simultaneously, or one try to write while another try to read. This is where semaphores, mutexes, atomics and conditional variables all comes into play. This is also a long solved problem, and there should be enough examples all over the Internet to help you figure out how to do it with any framework or API supporting the basic thread-synchronization primitives."}], "owner": {"reputation": 1485, "user_id": 1035671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/152b7c29ede1135a40bccbea0fd8817e?s=128&d=identicon&r=PG", "display_name": "bLAZ", "link": "https://stackoverflow.com/users/1035671/blaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505307908, "creation_date": 1505307908, "question_id": 46198391, "link": "https://stackoverflow.com/questions/46198391/qt5-cross-thread-data-sharing", "title": "Qt5: cross-thread data sharing", "body": "<p>I have a main application thread where I create another thread:</p>\n\n<pre><code>QThread* TxThread = new QThread;\nTxFTDI* Tx = new TxFTDI();\nTx-&gt;moveToThread(TxThread);\n</code></pre>\n\n<p>Then, under some condition, in one of the main thread functions I create object:</p>\n\n<pre><code>Ftdi* ftdiChA = new Ftdi;\n</code></pre>\n\n<p>where ftdi device information are stored (handler, serial number, description, etc.). When it is created I would like to use that object data (at least handler) in <code>Tx</code> thread.</p>\n\n<p>I can't find working solution. Could you please help?</p>\n"}, {"tags": ["c++", "macros", "mutex"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1505306650, "post_id": 46197902, "comment_id": 79358216, "body": "Are you using C or C++?  If you&#39;re using C++ I would suggest something other than a macro and use lock guards."}, {"owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "edited": false, "score": 1, "creation_date": 1505306667, "post_id": 46197902, "comment_id": 79358226, "body": "What exactly is your problem? You can try this yourself and see, if it works. Just add the missing parenthesis and you&#39;re done."}, {"owner": {"reputation": 31, "user_id": 6621164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924337e00ca87f95d18160d5929e1071?s=128&d=identicon&r=PG&f=1", "display_name": "HunterLee", "link": "https://stackoverflow.com/users/6621164/hunterlee"}, "edited": false, "score": 0, "creation_date": 1505306962, "post_id": 46197902, "comment_id": 79358463, "body": "We use C++. The project uses a macro to wrap API calls for log4CXX. log4CXX is threadsafe; however, two threads utilizing this macro, who make a write call at the same time is not thread safe. Helgrind complains when running Valgrind about that. Mutex protecting the macro in the code fixes the problem, but instead of mutex protection every single call, have the macro protect its own call."}, {"owner": {"reputation": 31, "user_id": 6621164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924337e00ca87f95d18160d5929e1071?s=128&d=identicon&r=PG&f=1", "display_name": "HunterLee", "link": "https://stackoverflow.com/users/6621164/hunterlee"}, "edited": false, "score": 0, "creation_date": 1505307294, "post_id": 46197902, "comment_id": 79358715, "body": "It&#39;s simple to state to use something other than a macro and use lock guards, that is ideal; however, the code affects multiple projects and that would require too many changes."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505307328, "post_id": 46197902, "comment_id": 79358745, "body": "@HunterLee please <a href=\"https://stackoverflow.com/posts/46197902/edit\">edit</a> your question and put clarifications <i>there</i>."}, {"owner": {"reputation": 31, "user_id": 6621164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924337e00ca87f95d18160d5929e1071?s=128&d=identicon&r=PG&f=1", "display_name": "HunterLee", "link": "https://stackoverflow.com/users/6621164/hunterlee"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505307773, "post_id": 46197902, "comment_id": 79359081, "body": "@MichaelWalz, thanks - I did just that."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6621164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924337e00ca87f95d18160d5929e1071?s=128&d=identicon&r=PG&f=1", "display_name": "HunterLee", "link": "https://stackoverflow.com/users/6621164/hunterlee"}, "edited": false, "score": 0, "creation_date": 1505307199, "post_id": 46197979, "comment_id": 79358639, "body": "Thanks for your answer. I have one more question when it comes to the mutex. This file is header with no namespace or class. Declaring a mutex results in a complaint during compilation of multiple definitions existing. Bear in mind, this mutex is a wrapper of pthread_mutex_t."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 31, "user_id": 6621164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924337e00ca87f95d18160d5929e1071?s=128&d=identicon&r=PG&f=1", "display_name": "HunterLee", "link": "https://stackoverflow.com/users/6621164/hunterlee"}, "edited": false, "score": 0, "creation_date": 1505307367, "post_id": 46197979, "comment_id": 79358774, "body": "@HunterLee that should be a new question."}], "tags": [], "owner": {"reputation": 1252, "user_id": 5057449, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e61f47a00cc4f5402872e1bdfb6e967d?s=128&d=identicon&r=PG&f=1", "display_name": "GPS", "link": "https://stackoverflow.com/users/5057449/gps"}, "is_accepted": true, "score": 0, "last_activity_date": 1505306696, "creation_date": 1505306696, "answer_id": 46197979, "question_id": 46197902, "link": "https://stackoverflow.com/questions/46197902/mutex-protect-macro/46197979#46197979", "title": "Mutex Protect Macro", "body": "<p>You have the code. Just cover it up.\nThis should do:</p>\n\n<pre><code>#define FUNCTION_ \\\ndo { \\\n    mutex.lock() \\\n    doSomething() \\\n    mutex.unlock() \\\n} while(0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1505310126, "last_edit_date": 1505310126, "creation_date": 1505308378, "answer_id": 46198574, "question_id": 46197902, "link": "https://stackoverflow.com/questions/46197902/mutex-protect-macro/46198574#46198574", "title": "Mutex Protect Macro", "body": "<p>If you have already this</p>\n\n<pre><code>#define FUNCTION_ \\\ndoSomething()\n</code></pre>\n\n<p>and if there is really no chance to stop such macro madness, then at least dont take it one step further. If you need a lock in <code>doSomething()</code> then the easiest would be to acquire the lock in the function:</p>\n\n<pre><code>void doSomething() {\n    mutex.lock();\n    /* .... */ \n    mutex.unlock();\n}\n</code></pre>\n\n<p>or if for some reason you cannot change the function then wrap it </p>\n\n<pre><code>#define FUNCTION_ \\\ndoSoemthingLocked()\n\nvoid doSomethingLocked() {\n    mutex.lock();\n    doSomething();\n    mutex.unlock();\n}\n</code></pre>\n\n<p>(maybe declared as inline if you need to put it in a header, and maybe passing a reference to the mutex as parameter)</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6621164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924337e00ca87f95d18160d5929e1071?s=128&d=identicon&r=PG&f=1", "display_name": "HunterLee", "link": "https://stackoverflow.com/users/6621164/hunterlee"}, "is_accepted": false, "score": 0, "last_activity_date": 1505320076, "creation_date": 1505320076, "answer_id": 46202585, "question_id": 46197902, "link": "https://stackoverflow.com/questions/46197902/mutex-protect-macro/46202585#46202585", "title": "Mutex Protect Macro", "body": "<p>The solution for the problem is as follows:</p>\n\n<pre><code>#define FUNCTION_ \\\n{ \\\n   mutex.lock(); \\\n   doSomething(); \\\n   mutex.unlock(); \\\n} \\\n</code></pre>\n\n<p>However, for the mutex itself I have a mutex that wraps the pthread_mutex_t so in this situation I declared the mutex as:</p>\n\n<p>extern Mutex mutex;</p>\n\n<p>Then in a .cpp file:</p>\n\n<pre><code>#include &lt;headerFile.hpp&gt;\n\nMutex mutex;\n</code></pre>\n\n<p>This creates a single instance of the mutex and prevents issues with multiple instances of the same name being discovered. </p>\n"}], "owner": {"reputation": 31, "user_id": 6621164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924337e00ca87f95d18160d5929e1071?s=128&d=identicon&r=PG&f=1", "display_name": "HunterLee", "link": "https://stackoverflow.com/users/6621164/hunterlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 46197979, "answer_count": 3, "score": 0, "last_activity_date": 1505320076, "creation_date": 1505306531, "last_edit_date": 1505307748, "question_id": 46197902, "link": "https://stackoverflow.com/questions/46197902/mutex-protect-macro", "title": "Mutex Protect Macro", "body": "<p>This is one of my first posts on this community, so please bear with me.</p>\n\n<p>Is there a way to mutex protect a macro, in the macro itself. </p>\n\n<p>For example, </p>\n\n<pre><code>#define FUNCTION_ \\\ndoSomething()\n</code></pre>\n\n<p>Basically, I'm looking to do something like this</p>\n\n<pre><code>#define FUNCTION_ \\\nmutex.lock \\\ndoSomething() \\\nmutex.unlock\n</code></pre>\n\n<p>For further information, the macros are all declared within a header file, by themselves ( no namespace or class), which handles calls to an API. We are utilizing C++. This header file is utilized by multiple projects therefore an overhaul of the macro itself is out of the question. For more detail on the Macro, it wraps calls to log4CXX.log4CXX is threadsafe; however, two threads utilizing this macro, who make a write call at the same time is not thread safe. Helgrind complains when running Valgrind about that. Mutex protecting the macro in the code fixes the problem, but instead of mutex protection every single call, have the macro protect its own call.</p>\n"}, {"tags": ["c++", "pointers", "vector", "fortran", "ublas"], "comments": [{"owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "edited": false, "score": 0, "creation_date": 1505307729, "post_id": 46197892, "comment_id": 79359042, "body": "You don&#39;t cast this at all, because these are two different types. If <code>ublas::bounded_vector</code> had a constructor taking a <code>double*</code> and a length, you could initialize it, e.g. <code>boost::numeric::ublas::bounded_vector&lt;double&gt; var1(var1_, var1_len)</code>. But I haven&#39;t seen such a constructor, so the only choice might be via a temporary <code>vector</code>."}], "owner": {"reputation": 11, "user_id": 8601558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871ec1b285371876fab58c0426ef8aaa?s=128&d=identicon&r=PG&f=1", "display_name": "don", "link": "https://stackoverflow.com/users/8601558/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505306506, "creation_date": 1505306506, "question_id": 46197892, "link": "https://stackoverflow.com/questions/46197892/reinterpret-pointer-as-ublasvector", "title": "Reinterpret pointer as ublas::vector", "body": "<p>I'm trying to write a C++ function which is called from Fortran. Fortran is therefore passing all arguments (vectors) by reference to the C++ function. In order to omit copying of the data I want to create a data structure which interprets the Fortran references as ublas::vectors. So far I managed to get this working using standard arrays with doubles (see variable declaration in struct):</p>\n\n<pre><code>#include &lt;boost/numeric/ublas/vector.hpp&gt;\n#include &lt;boost/numeric/ublas/matrix.hpp&gt;\n#include &lt;boost/numeric/ublas/io.hpp&gt;\n\ntemplate&lt;unsigned int sizeVector&gt;\nstruct DataContainer\n{\n    typedef boost::numeric::ublas::bounded_vector&lt;double,sizeVector&gt; Vector;\n\n    // Variable declaration\n    double (&amp;var1)[sizeVector];\n    double (&amp;var2)[sizeVector];\n\n    // Constructor\n    DataContainer(double *var1_, double *var2_): var1(*static_cast&lt;double(*)[sizeVector]&gt;(static_cast&lt;void*&gt;(var1_))),\n                                                 var2(*static_cast&lt;double(*)[sizeVector]&gt;(static_cast&lt;void*&gt;(var2_)))   {           \n    }\n}\n\n// var1 and var2 are vectors (arrays) by reference as input\nextern \"C\" void someFunction_(double *var1, double *var2)\n{\n    // Example --&gt; DataContainer with vectors of sizeVector=6\n    DataContainer&lt;6&gt; mydata(var1, var2);\n}\n</code></pre>\n\n<p>Unfortunately I don't know how to cast the pointer to ublas:vector (see typedef in struct) instead of a array of doubles. Something like this does not work:</p>\n\n<pre><code>boost::numeric::ublas::bounded_vector&lt;double,2&gt; &amp;var1 = *reinterpret_cast&lt;boost::numeric::ublas::bounded_vector&lt;double,2&gt;*&gt; (var1_);    \n</code></pre>\n"}, {"tags": ["c++", "dll", "architecture", "structure"], "comments": [{"owner": {"reputation": 4567, "user_id": 1320751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eee0011ba2ca995b31e464fc2e2ad885?s=128&d=identicon&r=PG", "display_name": "Anon Mail", "link": "https://stackoverflow.com/users/1320751/anon-mail"}, "edited": false, "score": 0, "creation_date": 1505311129, "post_id": 46197882, "comment_id": 79361715, "body": "Unless there&#39;s a <i>reason</i> to separate the library into multiple libraries I would not do this.  It just causes more headaches."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1505311260, "post_id": 46197882, "comment_id": 79361809, "body": "Object inheritance doesn&#39;t have anything to do with it.  A dll does not &quot;inherit&quot; another dll, it simply uses it.  It automagically becomes &quot;super&quot; when a lot of dlls use it, no help necessary.  Do google &quot;dll hell&quot; so you at least have some idea what can go wrong."}], "owner": {"reputation": 89, "user_id": 7810978, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f5e21afb91d5040e82ed1ccdc798fef?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Kentish", "link": "https://stackoverflow.com/users/7810978/peter-kentish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505306482, "creation_date": 1505306482, "question_id": 46197882, "link": "https://stackoverflow.com/questions/46197882/using-a-superdll-within-a-set-of-dlls", "title": "Using a &#39;superdll&#39; within a set of DLLs", "body": "<p>I am redesigning the architecture of a program which interacts with hardware. Currently, it is in two parts, a <code>dll</code> and an <code>exe</code>. The <code>exe</code> handles the general process, and the <code>dll</code> handles the device drivers. Currently, the <code>dll</code> is very bloated and has loads of <code>if/else</code> statements about which driver to use.</p>\n\n<p>My plan in the redesign is to separate the <code>dll</code> into a multitude of <code>dll</code>'s, one for each device driver. All of the drivers would have similar properties, so my thoughts are currently that there would be a kind of 'superclass' for all the <code>dll</code>'s, which would in itself be a <code>dll</code>.</p>\n\n<p>As far as I can see, it is not possible to have inheritance across <code>dll</code>'s, having read <a href=\"https://support.microsoft.com/en-gb/help/815065/what-is-a-dll\" rel=\"nofollow noreferrer\">this</a> article. So my question is, is it possible to have a 'superdll' and have other <code>dll</code>'s that inherit from that? Is this even a good idea?</p>\n"}, {"tags": ["c++", "arrays", "pointers", "object"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1505306451, "post_id": 46197805, "comment_id": 79358044, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You are only showing pseudo code. For example it is not possible to know if your forgot to assign a suitable value to <code>ptrSSDaten</code> or it is just hidden in the code you are not showing."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 2, "creation_date": 1505306491, "post_id": 46197805, "comment_id": 79358080, "body": "You have a major bug in your code, you&#39;re not using <code>std::vector</code>."}, {"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 1, "creation_date": 1505306585, "post_id": 46197805, "comment_id": 79358162, "body": "<code>SS_Daten* ptrSSDaten[Number];</code> Is an array of pointers that is not initialized yet. And inside your loop you are using it. It is a UB."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 0, "creation_date": 1505306704, "post_id": 46197805, "comment_id": 79358263, "body": "@Raindrop7 OP is assigning to it in a loop, that&#39;s not UB."}, {"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1505307063, "post_id": 46197805, "comment_id": 79358542, "body": "@RickAstley: Thanks! I really didn&#39;t notice that"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1505308069, "post_id": 46197805, "comment_id": 79359328, "body": "You <i>never</i> allocated them one-by-one, so you can&#39;t delete them one-by-one. <code>delete</code>-ing them separately is a dangerous operation. As other&#39;s have suggested, using a STL container such as <code>std::vector&lt;&gt;</code> may make your work easier."}, {"owner": {"reputation": 3, "user_id": 8542617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72145268466ed5b842ba13fc54c9c3f5?s=128&d=identicon&r=PG&f=1", "display_name": "mrtn", "link": "https://stackoverflow.com/users/8542617/mrtn"}, "edited": false, "score": 0, "creation_date": 1505308283, "post_id": 46197805, "comment_id": 79359503, "body": "i have allocated them one by one and now it workes. thanks for the help and the tip with vecor."}], "answers": [{"comments": [{"owner": {"reputation": 1605, "user_id": 4179302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-71QIq2eev8E/AAAAAAAAAAI/AAAAAAAAA0c/KCUZGf1P-7Y/photo.jpg?sz=128", "display_name": "apalomer", "link": "https://stackoverflow.com/users/4179302/apalomer"}, "edited": false, "score": 0, "creation_date": 1505306505, "post_id": 46197865, "comment_id": 79358094, "body": "Moreover, if you have to share the elements, you can probably use <code>shared_ptr</code> so you make sure that it will be deleted when nothing points to that object."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "reply_to_user": {"reputation": 1605, "user_id": 4179302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-71QIq2eev8E/AAAAAAAAAAI/AAAAAAAAA0c/KCUZGf1P-7Y/photo.jpg?sz=128", "display_name": "apalomer", "link": "https://stackoverflow.com/users/4179302/apalomer"}, "edited": false, "score": 0, "creation_date": 1505306580, "post_id": 46197865, "comment_id": 79358160, "body": "@apalomer You probably could, but you should try to avoid it as much as reasonable."}, {"owner": {"reputation": 1605, "user_id": 4179302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-71QIq2eev8E/AAAAAAAAAAI/AAAAAAAAA0c/KCUZGf1P-7Y/photo.jpg?sz=128", "display_name": "apalomer", "link": "https://stackoverflow.com/users/4179302/apalomer"}, "edited": false, "score": 0, "creation_date": 1505321038, "post_id": 46197865, "comment_id": 79368553, "body": "Why would you? I don&#39;t see why avoiding smart pointers. However, I probably not read enough about smart pointers so you might be most likely right."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1605, "user_id": 4179302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-71QIq2eev8E/AAAAAAAAAAI/AAAAAAAAA0c/KCUZGf1P-7Y/photo.jpg?sz=128", "display_name": "apalomer", "link": "https://stackoverflow.com/users/4179302/apalomer"}, "edited": false, "score": 1, "creation_date": 1505321172, "post_id": 46197865, "comment_id": 79368661, "body": "@apalomer Generally you wan&#39;t to avoid <code>std::shared_ptr</code>.  It is a lot more expensive then <code>std::unique_ptr</code> (if you really need a pointer this should be your first consideration).  But, you might not even need a pointer at all and, IMHO, that&#39;s the best option."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 1, "last_activity_date": 1505306442, "creation_date": 1505306442, "answer_id": 46197865, "question_id": 46197805, "link": "https://stackoverflow.com/questions/46197805/c-array-of-pointer-to-objects-program-crash-when-elements-are-deleted/46197865#46197865", "title": "c++: array of pointer to objects -&gt; program crash when elements are deleted", "body": "<p>You have undefined behavior.  You use <code>new[]</code> to allocate the array.  To get rid of the array you must then use <code>delete []</code>.  You cannot call <code>delete</code> on the individual elements as they were never allocated with <code>new</code>.</p>\n\n<p>I would suggest you use a <code>std::vector</code> instead.  If you need to remove an element of the vector you can <code>erase</code> it.</p>\n"}], "owner": {"reputation": 3, "user_id": 8542617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72145268466ed5b842ba13fc54c9c3f5?s=128&d=identicon&r=PG&f=1", "display_name": "mrtn", "link": "https://stackoverflow.com/users/8542617/mrtn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 46197865, "answer_count": 1, "score": -1, "last_activity_date": 1505306442, "creation_date": 1505306265, "question_id": 46197805, "link": "https://stackoverflow.com/questions/46197805/c-array-of-pointer-to-objects-program-crash-when-elements-are-deleted", "title": "c++: array of pointer to objects -&gt; program crash when elements are deleted", "body": "<p>I have a pointer Array to objekts of a class \"SS_Daten\". The class \"SS_Daten\" has a static instances counter \"NumberInstances\" that goes up when the construtor of the class is called and goes down when the destructor is called. i run the test with Number = 20.</p>\n\n<pre><code>SS_Daten* SSDaten = new SS_Daten[Number];\nSS_Daten* ptrSSDaten[Number];\n\nfor (int i = 0; i &lt; Number; i++)  {\n   ptrSSDaten[i] = &amp;SSDaten[i];\n}\n</code></pre>\n\n<p>I can delete all of the array elements without a problem. The counter goes from 20 to 0 like expected.</p>\n\n<pre><code>cout &lt;&lt; endl &lt;&lt; \"Number of Instances before: \" &lt;&lt; SS_Daten::NumberInstances &lt;&lt; endl;\ndelete [] *ptrSSDaten;\ncout &lt;&lt; endl &lt;&lt; \"Number of Instances after: \" &lt;&lt; SS_Daten::NumberInstances &lt;&lt; endl;\n</code></pre>\n\n<p>When i delete some (like 5 or 6) of the array elements one by one it workes without a problem but when i delete all of the elements the programm crashes. In case i delete between 10 and 15 it sometimes workes and somethimes crashes.</p>\n\n<pre><code>cout &lt;&lt; endl &lt;&lt; \"Number of Instances before: \" &lt;&lt; SS_Daten::NumberInstances &lt;&lt; endl;\ndelete ptrSSDaten[0];\ndelete ptrSSDaten[1];\ndelete ptrSSDaten[2];\ndelete ptrSSDaten[3];\ndelete ptrSSDaten[4];\ndelete ptrSSDaten[5];\n.....\ndelete ptrSSDaten[19];\ncout &lt;&lt; endl &lt;&lt; \"Number of Instances after: \" &lt;&lt; SS_Daten::NumberInstances &lt;&lt; endl;\n</code></pre>\n\n<hr>\n\n<p>The array of pointers to objects gets passed around to functions that sometimes delete elements and change the position of the Elements in the array.\n<strong>What i need</strong> is a way too clean the rest of the elements up at the end of the main instance like this. But that crashes programm.</p>\n\n<pre><code>cout &lt;&lt; endl &lt;&lt; \"Number of Instances before: \" &lt;&lt; SS_Daten::NumberInstances &lt;&lt; endl;\nint AA = SS_Daten::NumberInstances;\nfor (int i = 0; i &lt; AA; i++)    {\n    delete ptrSSDaten[i];\n}\ncout &lt;&lt; endl &lt;&lt; \"Number of Instances after: \" &lt;&lt; SS_Daten::NumberInstances &lt;&lt; endl;\n</code></pre>\n"}, {"tags": ["c++", "c++11", "constructor", "rtti", "typeinfo"], "comments": [{"owner": {"reputation": 1073, "user_id": 3763139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gkUYr.jpg?s=128&g=1", "display_name": "Sopel", "link": "https://stackoverflow.com/users/3763139/sopel"}, "edited": false, "score": 9, "creation_date": 1505305720, "post_id": 46197573, "comment_id": 79357511, "body": "by doing <code>failingMap[1]</code> you create a default entry if it wasn&#39;t found in the map. Use <code>::try_emplace</code> for example"}], "answers": [{"tags": [], "owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "is_accepted": true, "score": 19, "last_activity_date": 1505305746, "creation_date": 1505305746, "answer_id": 46197628, "question_id": 46197573, "link": "https://stackoverflow.com/questions/46197573/use-stdtype-index-as-value-in-a-map/46197628#46197628", "title": "Use std::type_index as value in a map", "body": "<p>The issue is <code>operator[]</code>, not the actual use of the map. The problem is if the key is <strong>not</strong> found, <code>operator[]</code> will assign a default value and return  a modifiable reference to that value, which is impossible with <code>std::type_index</code>. You may use <code>emplace</code>, <code>insert</code>, <code>try_emplace</code>, or any other modifier that does not require a default constructor.</p>\n"}, {"comments": [{"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1505331964, "post_id": 46199217, "comment_id": 79374678, "body": "This is a good answer for <code>std::optional</code>, and backports for C++11 exist in a single header (as well as a Boost version for C++03). I honestly believe a nullable version is overkill, since the excellent alternatives exist. Still, excellent answer."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 2, "last_activity_date": 1505310174, "creation_date": 1505310174, "answer_id": 46199217, "question_id": 46197573, "link": "https://stackoverflow.com/questions/46197573/use-stdtype-index-as-value-in-a-map/46199217#46199217", "title": "Use std::type_index as value in a map", "body": "<p>We could of course always create a nullable wrapper for <code>type_info</code>.</p>\n\n<pre><code>#include &lt;typeindex&gt;\n#include &lt;functional&gt;\n#include &lt;unordered_map&gt;\n#include &lt;cassert&gt;\n\n\nstruct nullable_type_index\n{\n    constexpr nullable_type_index() : ptr_(nullptr) {}\n    constexpr nullable_type_index(std::type_info const&amp; ti) : ptr_(std::addressof(ti)) {}\n\n    constexpr operator bool() const\n    {\n        return bool(ptr_);\n    }\n\n    // I have avoided implicit conversion, but it could probably work\n    // without any surprises.\n    std::type_info const&amp; get_type_info() const {\n        assert(ptr_);\n        return *ptr_;\n    }\n\n    constexpr bool operator==(nullable_type_index const&amp; other) const {\n        return ptr_ &amp;&amp; other.ptr_ \n        ? *ptr_ == *other.ptr_\n        : ptr_ == other.ptr_;\n    }\n\nprivate:\n    std::type_info const* ptr_;\n};\n\nstd::size_t hash_value(const nullable_type_index&amp; nti)\n{\n    return nti ? 0 : nti.get_type_info().hash_code();\n}\n\nbool operator==(nullable_type_index const&amp; l, std::type_info const&amp; r)\n{\n    return l == nullable_type_index(r);\n}\n\nbool operator==(std::type_info const&amp; l, nullable_type_index const&amp; r)\n{\n    return nullable_type_index(l) == r;\n}\n\nnamespace std {\n\n    template&lt;&gt;\n    struct hash&lt;nullable_type_index&gt;\n    {\n        std::size_t operator()(nullable_type_index const&amp; arg) const {\n            return hash_value(arg);\n        }\n    };\n}\n\nint main()\n{\n    std::unordered_map&lt;std::type_index, int&gt; workingMap;\n    workingMap[typeid(int)] = 1;\n    workingMap[typeid(char)] = 2;    \n\n    std::unordered_map&lt;int, nullable_type_index&gt; failingMap;\n    failingMap[1] = typeid(int);\n    failingMap[2] = typeid(char);\n}\n</code></pre>\n\n<p>or of course, now we have std::optional...</p>\n\n<pre><code>int main()\n{\n    std::unordered_map&lt;std::type_index, int&gt; workingMap;\n    workingMap[typeid(int)] = 1;\n    workingMap[typeid(char)] = 2;    \n\n    std::unordered_map&lt;int, std::optional&lt;std::type_index&gt;&gt; failingMap;\n    failingMap[1] = typeid(int);\n    failingMap[2] = typeid(char);\n}\n</code></pre>\n"}], "owner": {"reputation": 3489, "user_id": 1350184, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/EQnef.jpg?s=128&g=1", "display_name": "tversteeg", "link": "https://stackoverflow.com/users/1350184/tversteeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2219, "favorite_count": 0, "accepted_answer_id": 46197628, "answer_count": 2, "score": 16, "last_activity_date": 1505310174, "creation_date": 1505305584, "last_edit_date": 1505305778, "question_id": 46197573, "link": "https://stackoverflow.com/questions/46197573/use-stdtype-index-as-value-in-a-map", "title": "Use std::type_index as value in a map", "body": "<p>I am trying to create a <code>std::unordered_map</code> where the <em>value</em> is a <code>std::type_index</code>. The following snippet works:</p>\n\n<pre><code>std::unordered_map&lt;std::type_index, int&gt; workingMap;\nworkingMap[typeid(int)] = 1;\nworkingMap[typeid(char)] = 2;\n</code></pre>\n\n<p>But this one doesn't run and throws an error:</p>\n\n<pre><code>std::unordered_map&lt;int, std::type_index&gt; failingMap;\nfailingMap[1] = typeid(int);\nfailingMap[2] = typeid(char);\n</code></pre>\n\n<blockquote>\n  <p>CS2512: 'std::type_index::type_index': no appropriate default constructor available.</p>\n</blockquote>\n\n<p>I don't fully understand this error, what is the difference between the constructors in these examples? Is it possible to make a map where <code>typeid(..)</code> is the <em>value</em> instead of the key?</p>\n"}, {"tags": ["c++", "c++11", "callstack", "self-destruction"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1505305116, "post_id": 46197334, "comment_id": 79357031, "body": "Yes. ]]]]]]]]]]]"}], "answers": [{"comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 3, "creation_date": 1505305245, "post_id": 46197429, "comment_id": 79357114, "body": "You answered faster than I could find a suitable duplicate. That&#39;s not praise, btw."}, {"owner": {"reputation": 805, "user_id": 5134012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/DOs5I.jpg?s=128&g=1", "display_name": "Xeren Narcy", "link": "https://stackoverflow.com/users/5134012/xeren-narcy"}, "edited": false, "score": 0, "creation_date": 1505305854, "post_id": 46197429, "comment_id": 79357607, "body": "this came up for me not so much because of <code>delete this</code> but because of a garbage collector running parallel to a queue of objects. the way that queue is processed involves recursive method calls at times, so it&#39;s possible to detect when an object is deleted in my case, not worried about interacting with dead objects. however had doubts about stack unwinding behavior, turns out it&#39;s fine if you&#39;re careful, thanks!"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 2, "last_activity_date": 1505305266, "last_edit_date": 1505305266, "creation_date": 1505305204, "answer_id": 46197429, "question_id": 46197334, "link": "https://stackoverflow.com/questions/46197334/c-returning-into-method-of-deleted-object/46197429#46197429", "title": "c++ returning into method of deleted object", "body": "<p>It's fine subject to:</p>\n\n<ol>\n<li><p>The object must have been created with <code>new</code>. (Note that a <code>delete</code> following a placement <code>new</code> would not be fine).</p></li>\n<li><p>Don't call any member functions or access member data after calling <code>delete this;</code> (functions re-entered due to stack unwinding are fine).</p></li>\n<li><p>Don't attempt to assign a pointer type to <code>this</code>.</p></li>\n</ol>\n\n<p>So, in your case, there is no issue (assuming you're compliant with 1).</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1505305323, "post_id": 46197440, "comment_id": 79357177, "body": "You woudn&#39;t mind clarifying what you mean by &quot;in particular&quot;?"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1505305379, "post_id": 46197440, "comment_id": 79357220, "body": "@Bathsheba I have no idea."}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 2, "last_activity_date": 1505305384, "last_edit_date": 1505305384, "creation_date": 1505305234, "answer_id": 46197440, "question_id": 46197334, "link": "https://stackoverflow.com/questions/46197334/c-returning-into-method-of-deleted-object/46197440#46197440", "title": "c++ returning into method of deleted object", "body": "<p>Nothing bad would happen. Of course there are  obvious things to pay attention to like:</p>\n\n<ul>\n<li>Be sure that the object <code>this</code> points to was allocated with <code>new</code>.</li>\n<li>Do not call any other member functions after <code>B()</code> and do not access any member variables after <code>B()</code>.</li>\n<li>Do not use <code>this</code> for anything after <code>B()</code>, no, not even the pointer itself.</li>\n</ul>\n"}], "owner": {"reputation": 805, "user_id": 5134012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/DOs5I.jpg?s=128&g=1", "display_name": "Xeren Narcy", "link": "https://stackoverflow.com/users/5134012/xeren-narcy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1505305220, "accepted_answer_id": 46197429, "answer_count": 2, "score": 1, "last_activity_date": 1505305384, "creation_date": 1505304942, "question_id": 46197334, "link": "https://stackoverflow.com/questions/46197334/c-returning-into-method-of-deleted-object", "closed_reason": "Duplicate", "title": "c++ returning into method of deleted object", "body": "<p>This is a variation on the <code>delete this</code> debate, to do with what happens with <em>intermediate</em> method calls.</p>\n\n<p>Basically, if method A calls method B, and method B destroys the object, does anything particular happen inside method A when returning from B? Something like this:</p>\n\n<pre><code>struct test {\n  void A() {\n    B();\n    // what happens here besides being unable to dereference `this` anymore?\n  }\n  void B() {delete this;}\n};\n</code></pre>\n\n<p>Can it be assumed that returning into a method of an expired object will proceed as normal as long as the memory location of the former object isn't interacted with any further?</p>\n"}, {"tags": ["c++", "regex"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1505304840, "post_id": 46197263, "comment_id": 79356842, "body": "Brute force does not really help here :) What do you consider a word? How can you define the boundaries for these &quot;words&quot;? I am asking because <code>.</code> is not a word char (from the regex point of view)"}, {"owner": {"reputation": 2063, "user_id": 3442097, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a4289403eeb28d143b5dcf1b202aa22?s=128&d=identicon&r=PG&f=1", "display_name": "AlexVestin", "link": "https://stackoverflow.com/users/3442097/alexvestin"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1505304922, "post_id": 46197263, "comment_id": 79356916, "body": "it&#39;s from a dictionary"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1505304970, "post_id": 46197263, "comment_id": 79356954, "body": "Could you please provide a code snippet illustrating the problem? An <a href=\"http://stackoverflow.com/help/mcve\">MCVE (minimal complete verifiable example)</a>."}, {"owner": {"reputation": 2063, "user_id": 3442097, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a4289403eeb28d143b5dcf1b202aa22?s=128&d=identicon&r=PG&f=1", "display_name": "AlexVestin", "link": "https://stackoverflow.com/users/3442097/alexvestin"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1505305256, "post_id": 46197263, "comment_id": 79357130, "body": "edited the uestion"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1505305697, "post_id": 46197263, "comment_id": 79357488, "body": "Sorry, does not it mean you iterate over the string and check some specific substrings for the presence of the <code>guess</code> char? You might check <a href=\"https://stackoverflow.com/questions/2340281/\">Check if a string contains a string in C++</a> rather than look for a regex."}], "answers": [{"tags": [], "owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "is_accepted": true, "score": 1, "last_activity_date": 1505308330, "creation_date": 1505308330, "answer_id": 46198553, "question_id": 46197263, "link": "https://stackoverflow.com/questions/46197263/regex-excluding-characters-from-positions-in-words/46198553#46198553", "title": "Regex excluding characters from positions in words", "body": "<p>The regular expression <code>h^[c]^[c]^[c]o</code> doesn't work, because it looks for <code>h</code>, followed by a <code>^</code>, followed by a <code>c</code>, and so on.</p>\n\n<p>To negate a character set, you must put the caret <code>^</code> inside the brackets, see <a href=\"http://www.regular-expressions.info/charclass.html#negated\" rel=\"nofollow noreferrer\">Negated Character Classes</a>. In your case, this would be </p>\n\n<pre><code>h[^c][^c][^c]o\n</code></pre>\n\n<p>Now it looks for <code>h</code>, followed by any character <em>not</em> <code>c</code>, followed by another character <em>not</em> <code>c</code>, ...</p>\n"}], "owner": {"reputation": 2063, "user_id": 3442097, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a4289403eeb28d143b5dcf1b202aa22?s=128&d=identicon&r=PG&f=1", "display_name": "AlexVestin", "link": "https://stackoverflow.com/users/3442097/alexvestin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1242, "favorite_count": 0, "accepted_answer_id": 46198553, "answer_count": 1, "score": 0, "last_activity_date": 1505308330, "creation_date": 1505304771, "last_edit_date": 1505305247, "question_id": 46197263, "link": "https://stackoverflow.com/questions/46197263/regex-excluding-characters-from-positions-in-words", "title": "Regex excluding characters from positions in words", "body": "<p>I've been trying to match a pattern excluding a certain char.</p>\n\n<p>Lets say the characters given is \"h...o\", and I want to match all words not including a certain char, let's say 'c'\nI've tried a ton of different ways of going about this.\nSome of those include,</p>\n\n<pre><code>\"h^[c]^[c]^[c]o\"\n\n\"h(!?c)(?!c)(!?c)o\"\n</code></pre>\n\n<p>But none of those works, does anyone know whats up?</p>\n\n<p>the point of this is kind of like a cheating hang man, where I return all the words not containing the guess.</p>\n\n<pre><code>vector&lt;string&gt; getWords(string currentWord, char guess){\n    for(auto&amp; i: currentWord){\n        string reg = \"\"\n        if(i == '_'){\n           string t = [[regex expression for acception any char except 'guess']]\n           reg += t;\n        }else{\n          reg += i;  \n        }\n    }\n\n  return getMatchingWords(mapOfWords, reg)\n}\n</code></pre>\n\n<p>Only accepting all words that doesn't contain the guess doesn't work here as the exclusion is indexbound </p>\n"}, {"tags": ["c++", "linux", "gdb"], "answers": [{"comments": [{"owner": {"reputation": 4248, "user_id": 443878, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YiNTB.jpg?s=128&g=1", "display_name": "OopsUser", "link": "https://stackoverflow.com/users/443878/oopsuser"}, "edited": false, "score": 0, "creation_date": 1505309919, "post_id": 46198502, "comment_id": 79360784, "body": "Unfortunately it does not work for me, <code>info vtbl this</code> gives me : &quot;Undefined info command: &quot;vtbl this&quot;.  Try &quot;help info&quot;.&quot; And <code>p *this</code> gives me : &quot;$19 = {&lt;father&gt; = {_vptr.father = 0x743b70}, &lt;No data fields&gt;}&quot;"}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "reply_to_user": {"reputation": 4248, "user_id": 443878, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YiNTB.jpg?s=128&g=1", "display_name": "OopsUser", "link": "https://stackoverflow.com/users/443878/oopsuser"}, "edited": false, "score": 0, "creation_date": 1505311154, "post_id": 46198502, "comment_id": 79361734, "body": "Did you build with debug info (with <code>-g</code>)? What is your gdb version?"}, {"owner": {"reputation": 4248, "user_id": 443878, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YiNTB.jpg?s=128&g=1", "display_name": "OopsUser", "link": "https://stackoverflow.com/users/443878/oopsuser"}, "edited": false, "score": 0, "creation_date": 1505312592, "post_id": 46198502, "comment_id": 79362794, "body": "My GDB version is : &quot;GNU gdb (GDB) Red Hat Enterprise Linux (7.2-92.el6)&quot;"}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 1, "creation_date": 1505314186, "post_id": 46198502, "comment_id": 79363992, "body": "This: <code>$19 = {&lt;father&gt; = {_vptr.father = 0x743b70},...</code> most likely means that <code>this</code> is a dangling pointer which doesn&#39;t point into a valid object."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 1, "creation_date": 1505314711, "post_id": 46198502, "comment_id": 79364410, "body": "Also gdb 7.2 is rather old release. According to <a href=\"https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;a=blob;f=gdb/NEWS;hb=HEAD\" rel=\"nofollow noreferrer\">NEWS</a> file, <code>info vtbl</code> appeared in 7.5 release. I would try to upgrade to 7.5 or even better to the latest release. (I used 8.0 for my tests)"}, {"owner": {"reputation": 4248, "user_id": 443878, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YiNTB.jpg?s=128&g=1", "display_name": "OopsUser", "link": "https://stackoverflow.com/users/443878/oopsuser"}, "reply_to_user": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 0, "creation_date": 1505389196, "post_id": 46198502, "comment_id": 79398634, "body": "@EmployedRussian why does it mean what you said ?"}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "reply_to_user": {"reputation": 4248, "user_id": 443878, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YiNTB.jpg?s=128&g=1", "display_name": "OopsUser", "link": "https://stackoverflow.com/users/443878/oopsuser"}, "edited": false, "score": 0, "creation_date": 1505397828, "post_id": 46198502, "comment_id": 79405228, "body": "@OopsUser &quot;Why...?&quot; GDB shows that <code>_vptr</code> points to location <code>0x743b70</code>, which is not inside a valid symbol (at least not one known to GDB). My experience tells me that the most likely way (though certainly not the only way) this happens is when <code>this</code> points into deleted object."}], "tags": [], "owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "is_accepted": true, "score": 5, "last_activity_date": 1505308209, "creation_date": 1505308209, "answer_id": 46198502, "question_id": 46197009, "link": "https://stackoverflow.com/questions/46197009/know-who-is-the-inheritor-while-debugging-core-dumps-with-gdb/46198502#46198502", "title": "Know who is the inheritor while debugging core dumps with GDB", "body": "<p>You can use <code>info vtbl this</code> or just print <code>*this</code>. You will see the inheritor in output (<code>son1</code> in my example):</p>\n\n<pre><code>(gdb) info vtbl this \nvtable for 'father' @ 0x400920 (subobject @ 0x613c20):\n[0]: 0x4007d8 &lt;son1::runVirtualFunc()&gt;\n(gdb) p *this\n$2 = {_vptr.father = 0x400920 &lt;vtable for son1+16&gt;}\n(gdb) \n</code></pre>\n"}], "owner": {"reputation": 4248, "user_id": 443878, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YiNTB.jpg?s=128&g=1", "display_name": "OopsUser", "link": "https://stackoverflow.com/users/443878/oopsuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 46198502, "answer_count": 1, "score": 5, "last_activity_date": 1505308209, "creation_date": 1505304065, "last_edit_date": 1505307641, "question_id": 46197009, "link": "https://stackoverflow.com/questions/46197009/know-who-is-the-inheritor-while-debugging-core-dumps-with-gdb", "title": "Know who is the inheritor while debugging core dumps with GDB", "body": "<p>My process has crashed, and I have a core dump.\nI see that the process crashed while running a code similar to that : </p>\n\n<pre><code>class father\n{\npublic:\n  void virtual runVirtualFunc() = 0;\n  void func()\n  {\n    runVirtualFunc();\n    // ... crash here ...  THIS IS THE PLACE I NEED TO KNOW WHO IS THE INHERITOR (so I could analyze which \"runVirtualFunc\" ran).\n  }\n  virtual ~father() {}\n};\n\nclass son1 : public father\n{\npublic:\n  void virtual runVirtualFunc() { /* do something 1*/} \n};\n\nclass son2 : public father\n{\npublic:\n  void virtual runVirtualFunc() { /* do something 2*/} \n};\n</code></pre>\n\n<p>I have a full call stack in the core dump, but I don't know who is the inheritor that runs the \"func\". Is there a way to figure it out (maybe by some pointer calculation tricks on <code>this</code> ? ) </p>\n\n<p>I don't have a live attached process, only core dump.</p>\n"}, {"tags": ["c++", "c++11", "gcc"], "comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 5, "creation_date": 1505304104, "post_id": 46196967, "comment_id": 79356332, "body": "Latest gcc is 7.2, not 4.9. You&#39;re a few years behind."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1505304326, "post_id": 46196967, "comment_id": 79356488, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1, "user_id": 8603066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f6b3074db1387c87f2d6ee9b306997?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Ng", "link": "https://stackoverflow.com/users/8603066/andy-ng"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1505321821, "post_id": 46196967, "comment_id": 79369044, "body": "updated to GCC 5.3, but I get the same error... :("}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1505321862, "post_id": 46196967, "comment_id": 79369080, "body": "Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or no-one will be able to help"}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 4, "last_activity_date": 1505304121, "creation_date": 1505304121, "answer_id": 46197028, "question_id": 46196967, "link": "https://stackoverflow.com/questions/46196967/c-error-braces-around-scalar-initializer-for-type-bool/46197028#46197028", "title": "C++ error: braces around scalar initializer for type &#39;bool&#39;", "body": "<p>Seems to be bug <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=60859\" rel=\"nofollow noreferrer\">#60859</a>, which appeared in 4.9 and was resolved in 5.x.</p>\n"}], "owner": {"reputation": 1, "user_id": 8603066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f6b3074db1387c87f2d6ee9b306997?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Ng", "link": "https://stackoverflow.com/users/8603066/andy-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505304175, "creation_date": 1505303938, "last_edit_date": 1505304175, "question_id": 46196967, "link": "https://stackoverflow.com/questions/46196967/c-error-braces-around-scalar-initializer-for-type-bool", "title": "C++ error: braces around scalar initializer for type &#39;bool&#39;", "body": "<p>I moved to latest GXX compiler and I have the following error:</p>\n\n<pre><code>error: braces around scalar initializer for type 'bool'\n</code></pre>\n\n<p>the call is:</p>\n\n<pre><code>m_ForReset{std::make_pair(false,false), std::make_pair(false,false)}\n</code></pre>\n\n<p>where <code>m_ForReset</code> is:</p>\n\n<pre><code>std::pair&lt;bool,bool&gt; m_ForReset[2];\n</code></pre>\n\n<p>Any ideas what may have changed in the (GCC) 4.9.3</p>\n\n<p>my build flags:</p>\n\n<pre><code>-pipe -Wno-write-strings -Wno-enum-compare -Wno-write-strings -Wno-psabi -fno-omit-frame-pointer -fmessage-length=0 -fPIC  -fpermissive -std=c++11 -O2  -g -feliminate-unused-debug-types -fvisibility-inlines-hidden\n</code></pre>\n"}, {"tags": ["c++", "windows", "vulkan"], "comments": [{"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1505321410, "post_id": 46196940, "comment_id": 79368809, "body": "Does it return the same error with layers disabled?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6678646"}, "edited": false, "score": 0, "creation_date": 1505365849, "post_id": 46201584, "comment_id": 79384933, "body": "Thanks for reply, i do get validation errors in console when i use unavailable/invalid features in structs, but didn&#39;t manage it with CreateDebugReportCallbackEXT it may reveal more i&#39;ll check it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6678646"}, "edited": false, "score": 1, "creation_date": 1505391615, "post_id": 46201584, "comment_id": 79400350, "body": "Using CreateDebugReportCallbackEXT I got the validation error &quot;internal drawable creation failed&quot; which led me to this : <a href=\"https://stackoverflow.com/questions/41379529/wat-does-the-vkcreateswapchainkhrinternal-drawable-creation-failed-means\" title=\"wat does the vkcreateswapchainkhrinternal drawable creation failed means\">stackoverflow.com/questions/41379529/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "is_accepted": true, "score": 1, "last_activity_date": 1505316945, "creation_date": 1505316945, "answer_id": 46201584, "question_id": 46196940, "link": "https://stackoverflow.com/questions/46196940/vkcreateswapchainkhr-error/46201584#46201584", "title": "vkCreateSwapchainKHR Error", "body": "<p>There are a huge number of reasons validation of <code>vkCreateSwapchainKHR</code> will fail (check out <code>PreCallValidateCreateSwapchainKHR</code> in <a href=\"https://github.com/KhronosGroup/Vulkan-LoaderAndValidationLayers/blob/master/layers/core_validation.cpp\" rel=\"nofollow noreferrer\">core_validation.cpp</a>). </p>\n\n<p>There may not be enough code here to tell why it is failing, for example, the failure might be because of an invalid surface. But, to pinpoint the problem, it should give a failure message in the debug log, which will tell you exactly why. You should enable it by calling <code>CreateDebugReportCallbackEXT</code>, before trying to create the swapchain. This will also require you to enable the <code>VK_EXT_debug_report</code> extension. See <a href=\"https://vulkan-tutorial.com/Drawing_a_triangle/Setup/Validation_layers\" rel=\"nofollow noreferrer\">here</a> for details.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6678646"}, "edited": false, "score": 0, "creation_date": 1505365598, "post_id": 46203431, "comment_id": 79384833, "body": "Thanks for reply, capturing result on previous commands is a good point i&#39;ll check it out once i rewrite the whole thing (accidentally deleted the project folder...), and about those checks you mentioned, as far as i tested them, they&#39;re all available in my graphics card/surface and using the wrong features causes a validation error."}, {"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1505389030, "post_id": 46203431, "comment_id": 79398520, "body": "c\u0336a\u0336u\u0336s\u0336e\u0336s\u0336   <b>should</b> cause a validation error. Do not assume the validation layers are complete and bugless."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6678646"}, "edited": false, "score": 0, "creation_date": 1505391860, "post_id": 46203431, "comment_id": 79400554, "body": "Thanks for help, issue was GLFW creating an OpenGL context.    <a href=\"https://stackoverflow.com/questions/41379529/wat-does-the-vkcreateswapchainkhrinternal-drawable-creation-failed-means\" title=\"wat does the vkcreateswapchainkhrinternal drawable creation failed means\">stackoverflow.com/questions/41379529/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "is_accepted": false, "score": 1, "last_activity_date": 1505342575, "last_edit_date": 1505342575, "creation_date": 1505323162, "answer_id": 46203431, "question_id": 46196940, "link": "https://stackoverflow.com/questions/46196940/vkcreateswapchainkhr-error/46203431#46203431", "title": "vkCreateSwapchainKHR Error", "body": "<p>Just a few points about your code (potentially cause of problems):</p>\n\n<ul>\n<li>You are not checking <code>VkResult</code> of all the <code>vkGet*</code> commands</li>\n<li>You are not checking <code>swapChainInfo.imageFormat</code> against supported formats in your <code>deviceFormats</code></li>\n<li>You are not accounting for the situation that <code>surfCaps.currentExtent</code> can be <code>0xFFFFFFFF</code></li>\n<li><code>swapChainInfo.pQueueFamilyIndices</code> is a pointer not a handle; use <code>nullptr</code></li>\n<li>You are not checking <code>swapChainInfo.preTransform</code> against <code>surfCaps.supportedTransforms</code></li>\n<li>You are not checking <code>swapChainInfo.compositeAlpha</code> against <code>surfCaps.supportedCompositeAlpha</code></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6678646"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1711, "favorite_count": 0, "accepted_answer_id": 46201584, "answer_count": 2, "score": 2, "last_activity_date": 1505379286, "creation_date": 1505303839, "last_edit_date": 1505379286, "question_id": 46196940, "link": "https://stackoverflow.com/questions/46196940/vkcreateswapchainkhr-error", "title": "vkCreateSwapchainKHR Error", "body": "<p>Even though validation layers and debug callback extensions are enabled and working (they respond to wrong structs etc.), I'm still getting a \"VK_ERROR_VALIDATION_FAILED_EXT\" result from <code>vkCreateSwapchainKHR()</code>, and there's no validation layer error to pinpoint the mistake...\nSwap chain creation (using GTX 970 ) :</p>\n\n<pre><code>VkBool32 isSupported = false;\nvkGetPhysicalDeviceSurfaceSupportKHR( physicalDevices[0], 0, surface, &amp;isSupported);\n\nif (!isSupported) {\n    std::cout &lt;&lt; \"*ERROR* This device doesn't support surfaces\" &lt;&lt; std::endl;\n}\n\nVkSurfaceCapabilitiesKHR surfCaps;\nvkGetPhysicalDeviceSurfaceCapabilitiesKHR(physicalDevices[0], surface, &amp;surfCaps);\n\nstd::vector&lt;VkSurfaceFormatKHR&gt; deviceFormats;\nuint32_t formatCount;\nvkGetPhysicalDeviceSurfaceFormatsKHR(physicalDevices[0], surface, &amp;formatCount, nullptr);\ndeviceFormats.resize(formatCount);\nvkGetPhysicalDeviceSurfaceFormatsKHR(physicalDevices[0], surface, &amp;formatCount, deviceFormats.data());\n\n\nswapChainInfo.sType = VK_STRUCTURE_TYPE_SWAPCHAIN_CREATE_INFO_KHR;\nswapChainInfo.pNext = nullptr;\nswapChainInfo.flags = 0;\nswapChainInfo.surface = surface;\n\nswapChainInfo.minImageCount = surfCaps.minImageCount; \nswapChainInfo.imageFormat = VK_FORMAT_B8G8R8A8_UNORM;\nswapChainInfo.imageColorSpace = VK_COLOR_SPACE_SRGB_NONLINEAR_KHR;\nswapChainInfo.imageExtent = surfCaps.currentExtent;\nswapChainInfo.imageArrayLayers = 1;\nswapChainInfo.imageUsage = VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT;\nswapChainInfo.imageSharingMode = VK_SHARING_MODE_EXCLUSIVE;\n\nswapChainInfo.queueFamilyIndexCount = 0;\nswapChainInfo.pQueueFamilyIndices = VK_NULL_HANDLE;\nswapChainInfo.preTransform = VK_SURFACE_TRANSFORM_IDENTITY_BIT_KHR; \nswapChainInfo.compositeAlpha = VK_COMPOSITE_ALPHA_OPAQUE_BIT_KHR;\nswapChainInfo.presentMode = VK_PRESENT_MODE_FIFO_KHR;\nswapChainInfo.clipped = VK_TRUE; // TODO : TEST clipping against another window\nswapChainInfo.oldSwapchain = VK_NULL_HANDLE;\n\nresult = vkCreateSwapchainKHR( device, &amp;swapChainInfo, nullptr, &amp;swapChain );\nif (result) {\n    std::cout &lt;&lt; \"*ERROR* Swapchain Creation Failed :\" &lt;&lt; result &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Surface Creation using GLFW (Which doesn't return any error):</p>\n\n<pre><code>if (result = glfwCreateWindowSurface(instance, window, nullptr, &amp;surface)) \n    {\n        std::cout &lt;&lt; \"*ERROR* Surface Creation Failed : \" &lt;&lt; result &lt;&lt; std::endl;\n    }\n</code></pre>\n"}, {"tags": ["c++", "sfml"], "comments": [{"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 3, "creation_date": 1505302808, "post_id": 46196490, "comment_id": 79355430, "body": "Its a waste of resources to create the texture and sprite <i>every</i> iteration."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1505302818, "post_id": 46196490, "comment_id": 79355435, "body": "Why load the texture and set the sprite in every call? That&#39;s just wasted cycles. Do it once only. Perhaps the texture, the sprite <i>and</i> the clock should be member variables in the <code>Game</code> class instead?"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1505302886, "post_id": 46196490, "comment_id": 79355489, "body": "<a href=\"https://www.sfml-dev.org/documentation/2.4.2/classsf_1_1Clock.php#a123e2627f2943e5ecaa1db0c7df3231b\" rel=\"nofollow noreferrer\"><code>sf::Clock::restart()</code></a> returns the elapsed time and <i>then</i> restarts it @Someprogrammerdude. The clock is static, so  that shouldn&#39;t make a difference"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1505302960, "post_id": 46196490, "comment_id": 79355539, "body": "Lastly, is the code you show your <i>actual</i> code, or just something you written in the question? Because the code you show is invalid. You should really create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> to show us."}, {"owner": {"reputation": 317, "user_id": 5418904, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78ca500b536ef2fe98267e85edc21199?s=128&d=identicon&r=PG&f=1", "display_name": "Koosshh56", "link": "https://stackoverflow.com/users/5418904/koosshh56"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1505302981, "post_id": 46196490, "comment_id": 79355558, "body": "@Someprogrammerdude yeah, I had those as member of the class, I put a comment in the code to say that. About the clock, it works fine like it is in another project"}, {"owner": {"reputation": 317, "user_id": 5418904, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78ca500b536ef2fe98267e85edc21199?s=128&d=identicon&r=PG&f=1", "display_name": "Koosshh56", "link": "https://stackoverflow.com/users/5418904/koosshh56"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1505303034, "post_id": 46196490, "comment_id": 79355599, "body": "@Someprogrammerdude no, this isn&#39;t the actual code, just the functions involved in the problem"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 5418904, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78ca500b536ef2fe98267e85edc21199?s=128&d=identicon&r=PG&f=1", "display_name": "Koosshh56", "link": "https://stackoverflow.com/users/5418904/koosshh56"}, "edited": false, "score": 0, "creation_date": 1505303180, "post_id": 46196699, "comment_id": 79355702, "body": "I already clarified this in the comments. I had it outside, if you look at the comments I put in the code"}, {"owner": {"reputation": 199, "user_id": 8572843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jf3W8.png?s=128&g=1", "display_name": "gotocoffee", "link": "https://stackoverflow.com/users/8572843/gotocoffee"}, "reply_to_user": {"reputation": 317, "user_id": 5418904, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78ca500b536ef2fe98267e85edc21199?s=128&d=identicon&r=PG&f=1", "display_name": "Koosshh56", "link": "https://stackoverflow.com/users/5418904/koosshh56"}, "edited": false, "score": 0, "creation_date": 1505303275, "post_id": 46196699, "comment_id": 79355762, "body": "yeah but where? just outside of the play function but in the running function is bad as well"}, {"owner": {"reputation": 317, "user_id": 5418904, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78ca500b536ef2fe98267e85edc21199?s=128&d=identicon&r=PG&f=1", "display_name": "Koosshh56", "link": "https://stackoverflow.com/users/5418904/koosshh56"}, "edited": false, "score": 0, "creation_date": 1505303330, "post_id": 46196699, "comment_id": 79355807, "body": "They&#39;re not in the running function, they are outside the loop"}], "tags": [], "owner": {"reputation": 199, "user_id": 8572843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jf3W8.png?s=128&g=1", "display_name": "gotocoffee", "link": "https://stackoverflow.com/users/8572843/gotocoffee"}, "is_accepted": false, "score": 0, "last_activity_date": 1505303135, "creation_date": 1505303135, "answer_id": 46196699, "question_id": 46196490, "link": "https://stackoverflow.com/questions/46196490/sfml-sprite-movement-not-updating-correctly/46196699#46196699", "title": "SFML Sprite movement not updating correctly", "body": "<p>You should declare <code>myTextureand</code> and <code>mySprite</code> outside of the loop on a place where they stay as long as they should.\nCurrently you are creating them again in each iteration, which is bad for performance (espacially <code>myTexture.loadFromFile(\"res/img/player.png\");</code>). The recreation resets also the transform (position, rotation, etc.)</p>\n"}, {"tags": [], "owner": {"reputation": 100, "user_id": 7863842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aecfd9f39d1563ed855f39219101856?s=128&d=identicon&r=PG&f=1", "display_name": "MEHM-", "link": "https://stackoverflow.com/users/7863842/mehm"}, "is_accepted": true, "score": 1, "last_activity_date": 1505321217, "creation_date": 1505321217, "answer_id": 46202931, "question_id": 46196490, "link": "https://stackoverflow.com/questions/46196490/sfml-sprite-movement-not-updating-correctly/46202931#46202931", "title": "SFML Sprite movement not updating correctly", "body": "<p>I am not familiar with SFML so I hope I am not off base here, however, looking at your code. In your play() method, you create a local variable move. From the looks of it, move contains the x and y coordinate for your Sprite. Since you define move inside the play() method, a local copy of \nthis variable is created on the stack at run time each time your code runs through the play() method. Then you check for key presses, and inc or dec\nmove accordingly. move needs to be at global scope so that it is not reset every time you call play().\nYou were correct when you moved myTexture and mySprite outside the function play(). You should also move move outside of the play() method.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Texture myTexture;   //I've also tried to declare these outside the method\nSprite mySprite;\nVector2f move;\n\n    void Game::play()\n    {\n\n    ///////////Graphics\n\n        myTexture.loadFromFile(\"res/img/player.png\");\n\n        mySprite.setTexture(myTexture);\n\n    //////////Movement\n\n        static sf::Clock clock;\n        float dt = clock.restart().asSeconds();\n\n        if (Keyboard::isKeyPressed(Keyboard::A)) \n            {\n                move.x--;\n            }\n\n            std::cout &lt;&lt; mySprite.getPosition().x &lt;&lt; \"\\n\";\n        }\n\n        if (Keyboard::isKeyPressed(Keyboard::D))\n            {\n                move.x++;\n            }\n\n            std::cout &lt;&lt; mySprite.getPosition().x &lt;&lt; \"\\n\";\n        }\n\n        mySprite.move(move*300.0f*dt);\n\n        window.draw(mySprite);\n\n    }\n</code></pre>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 317, "user_id": 5418904, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78ca500b536ef2fe98267e85edc21199?s=128&d=identicon&r=PG&f=1", "display_name": "Koosshh56", "link": "https://stackoverflow.com/users/5418904/koosshh56"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 46202931, "answer_count": 2, "score": 0, "last_activity_date": 1505321217, "creation_date": 1505302445, "question_id": 46196490, "link": "https://stackoverflow.com/questions/46196490/sfml-sprite-movement-not-updating-correctly", "title": "SFML Sprite movement not updating correctly", "body": "<p>I' creating a simple game, using game states.\nI have a <code>gameLoop()</code> method that calls a <code>running()</code>method, which contains the switching states, which works correctly.\nThis is the <code>gameLoop()</code> method:</p>\n\n<pre><code>void Game::gameLoop()\n{\n  while (window.isOpen()) {\n    Event event;\n    while (window.pollEvent(event)) {\n      if (event.type == Event::Closed){\n        window.close();\n      }\n    }\n    if (Keyboard::isKeyPressed(Keyboard::Escape)) {\n      window.close();\n    }\n\n    window.clear();\n    running();              //this calls the states\n    window.display();\n}\n</code></pre>\n\n<p><code>running()</code> method calls all the states:</p>\n\n<pre><code>void Game::running()\n{\n\n    switch (state)\n    {\n        //other cases here\n\n        case s_play:\n            play();\n            break;\n\n        default:\n            break;\n    }\n}\n</code></pre>\n\n<p>And the <code>play()</code> method draws the sprite and moves it:</p>\n\n<pre><code>void Game::play()\n{\n    Texture myTexture;   //I've also tried to declare these outside the method\n    Sprite mySprite;\n\n///////////Graphics\n\n    myTexture.loadFromFile(\"res/img/player.png\");\n\n    mySprite.setTexture(myTexture);\n\n//////////Movement\n\n    static sf::Clock clock;\n    float dt = clock.restart().asSeconds();\n    Vector2f move;\n\n    if (Keyboard::isKeyPressed(Keyboard::A)) \n        {\n            move.x--;\n        }\n\n        std::cout &lt;&lt; mySprite.getPosition().x &lt;&lt; \"\\n\";\n    }\n\n    if (Keyboard::isKeyPressed(Keyboard::D))\n        {\n            move.x++;\n        }\n\n        std::cout &lt;&lt; mySprite.getPosition().x &lt;&lt; \"\\n\";\n    }\n\n    mySprite.move(move*300.0f*dt);\n\n    window.draw(mySprite);\n\n}\n</code></pre>\n\n<p>The problem is that the sprite just moves on the spot, and the output obtained from the std::cout is the following, when pressing A or D:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TeCc0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TeCc0.png\" alt=\"enter image description here\"></a></p>\n\n<p>The function of the movement works, because it was tested elsewhere. I think that I'm updating correctly or initializing something in the wrong way, but I can't figure it out.</p>\n"}, {"tags": ["c++", "windows", "clang", "mingw", "llvm"], "owner": {"reputation": 129, "user_id": 7403565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0WHyQ.jpg?s=128&g=1", "display_name": "ed95", "link": "https://stackoverflow.com/users/7403565/ed95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1505303306, "creation_date": 1505302361, "last_edit_date": 1505303306, "question_id": 46196454, "link": "https://stackoverflow.com/questions/46196454/unable-to-build-llvm-with-build-shared-libs-on-using-mingw", "title": "Unable to build LLVM with BUILD_SHARED_LIBS=ON using MinGW", "body": "<p>When building LLVM in debug mode, the resulting clang and clang++ executables are > 2GB in size and cannot be run on Windows. In order to reduce the final executable size I have set the LLVM BUILD_SHARED_LIBS flag to ON in CMake however the build fails at 100% when linking clang++.exe in clangDynamicASTMatchers.dll with hundreds of 'undefined reference to `vtable for clang::ast_matchers...' errors.</p>\n\n<p>The <a href=\"https://llvm.org/docs/CMake.html\" rel=\"nofollow noreferrer\">LLVM CMake docs</a> indicate that shared libraries can be used on Windows when building with MinGW, which I am, so I was wondering whether anyone has successfully built LLVM with this flag enabled on Windows?</p>\n"}, {"tags": ["c++", "memory-management", "boost", "allocator"], "comments": [{"owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "edited": false, "score": 1, "creation_date": 1505302143, "post_id": 46196337, "comment_id": 79354952, "body": "IMHO <code>std::allocator</code> is the choice. Where do you see the problem with your implementation?"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1505302201, "post_id": 46196337, "comment_id": 79354993, "body": "This might be better suited for <a href=\"https://cs.stackexchange.com/\">Computer Science</a>."}, {"owner": {"reputation": 87, "user_id": 7820869, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c1db15fce8b015154b0d93023b3f5bc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/7820869/robert"}, "reply_to_user": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "edited": false, "score": 1, "creation_date": 1505302447, "post_id": 46196337, "comment_id": 79355172, "body": "@KavehVahedipour The problem of std::allocator in my solution lies in being just able to track the total amount of memory used by all the Container Lists. If I would use two different allocators to separate the tracked memory counters, I&#39;m not able to use std::list::splice because that requires the same allocator to be used. Even if that would be possible, a transfer does not track the bytes because just the pointers are rearranged (no allocate of the std::allocator is called)."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 3, "creation_date": 1505304853, "post_id": 46196337, "comment_id": 79356851, "body": "This sounds like the original C++98 problem - a list cannot have both an O(1) size and an O(1) splice. You have to choose, because someone has to do the counting. Can you not count the bytes when you need the value?"}, {"owner": {"reputation": 87, "user_id": 7820869, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c1db15fce8b015154b0d93023b3f5bc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/7820869/robert"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1505307671, "post_id": 46196337, "comment_id": 79358998, "body": "@BoPersson Nice mentioning about list::size() method. In C++11 Splice is  O(1) and the call to size() is calculating that size by iterating over the elements instead of storing it as a member, so O(n). Memory Tracking here is kinda like that too. Unfortunately I cannot count the bytes by traversing through the Storage Lists, because I don&#39;t really have a byte count associated with these std::lists. It would be good to have a byte count instead of a size count on std::lists. The Allocator I implemented just stores the bytes in a variable but added for all the Storage Lists."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1505311486, "post_id": 46196337, "comment_id": 79361957, "body": "&quot;I don&#39;t really have a byte count associated with these std::lists&quot; You don&#39;t need the byte count stored anywhere, you can calculate it from the size. You should know how many bytes an empty list and a list of 1 element take. It should scale linearly. These sizes are pretty much constant for a given element type, so you can discover them by running a small test program with a custom allocator."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 7820869, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c1db15fce8b015154b0d93023b3f5bc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/7820869/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1507789701, "creation_date": 1507789701, "answer_id": 46702845, "question_id": 46196337, "link": "https://stackoverflow.com/questions/46196337/how-to-keep-track-of-the-allocated-memory-of-a-list-of-lists/46702845#46702845", "title": "How to keep track of the allocated memory of a list of lists?", "body": "<p>I found out that you can use EASTL allocators, because they are bound on each list object.</p>\n\n<p>So on EASTL::CustomAllocator::allocate and EASTL::CustomAllocator::deallocate you can notify the main list that the allocated bytes of the sub-list (here: Storage List) has changed their weight (here: size in number of bytes allocated by Storage List).</p>\n\n<p>This way the main list (here: Container List) always get a updated weight, which is cached and bound to the main list.</p>\n\n<p>For the CustomAllocator which should notify the main list see my answer on:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/42565582/how-to-track-memory-usage-using-eastl/46278588#46278588\">How to track memory usage using EASTL?</a></p>\n"}], "owner": {"reputation": 87, "user_id": 7820869, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c1db15fce8b015154b0d93023b3f5bc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/7820869/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507789701, "creation_date": 1505302020, "question_id": 46196337, "link": "https://stackoverflow.com/questions/46196337/how-to-keep-track-of-the-allocated-memory-of-a-list-of-lists", "title": "How to keep track of the allocated memory of a list of lists?", "body": "<p>I'm trying to find out how much memory (in Bytes) a list of lists is using.</p>\n\n<p><strong>The Problem is illustrated here:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/itG3W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/itG3W.png\" alt=\"enter image description here\"></a></p>\n\n<p>It Shows a Container List storing pointers to other lists (the Storage Lists) each storing uniformly size elements (let's say 10 Bytes each). So the first Storage List is storing 4 Elements, next 30, then the next one 12 and 10 and the last one 5 Elements. All the Elements are of the same C++ Type (which is just a struct of plain old data).</p>\n\n<p><strong>My Aim:</strong>\nThe Container List above should have current size variable, which keeps track of the number of bytes the lists he is pointing to (with all tracked space for *prev and *next pointers).</p>\n\n<p>So far, what I tried, is using allocators to track the number of bytes allocated by the lists (through a static class variable). Although that leads to a problem with std::list::splice, when moving elements from list  <a href=\"https://stackoverflow.com/questions/46051740/why-is-there-an-error-message-when-splicing-list-elements-from-lists-with-differ\">see here</a>: The elements which are spliced to another Container List are not tracked. It should even be able to track the bytes transfered to add that bytes-Count to the current size of another Container List.</p>\n\n<ul>\n<li><p>Do I have to avoid using the STD allocators for memory tracking and\ninstead use boost's intrusive lists somehow for tracking memory like\nthat?</p></li>\n<li><p>What kind of C++ feature does possibly support me by solving my<br>\nproblem?</p></li>\n</ul>\n"}, {"tags": ["c++", "inheritance", "constants", "mutable"], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1505301846, "last_edit_date": 1505301846, "creation_date": 1505301353, "answer_id": 46196085, "question_id": 46196043, "link": "https://stackoverflow.com/questions/46196043/c-discards-qualifier-even-if-the-member-variables-are-mutable/46196085#46196085", "title": "c++ : discards qualifier even if the member variables are mutable", "body": "<p>Const member function <code>foo</code> calls non-const member function <code>bar</code>. Calling <code>bar</code> requires a non-const <code>this</code>, whereas <code>this</code> is a pointer to <code>const</code> inside <code>foo</code>.</p>\n\n<p>Either <code>bar</code> must be const or <code>foo</code> must be non-const.</p>\n"}, {"comments": [{"owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "edited": false, "score": 0, "creation_date": 1505303689, "post_id": 46196088, "comment_id": 79356057, "body": "Interesting: I can see why the OP might object to making the bar() method const, because it changes the object. Perhaps  C++ should have a mutable qualifier for methods that affect only mutable members. // Perhaps only for documentation. Perhaps only for private or protected methods - with const methods being allowed to call const or mutable methods. Perhaps const qualification visible to the caller interface would map to (public) mutable qualification in the implementation. // Perhaps more verbose &quot;mutable const&quot;, mutable internal, const externally visible."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "edited": false, "score": 0, "creation_date": 1505304256, "post_id": 46196088, "comment_id": 79356438, "body": "@KrazyGlew - Interesting proposal. But I don&#39;t think it will be voted in. Mutable members should be the exception, not the rule."}, {"owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "edited": false, "score": 0, "creation_date": 1505304490, "post_id": 46196088, "comment_id": 79356614, "body": "Perhaps &quot;const const&quot; would be an implementation qualifier for pure read-only objects, that could be placed in true read-only-memory (ROM). Whereas &quot;mutable const&quot; would be an implementation qualifier that says that the object cannot be placed in ROM, although it should be treated as const for the purposes of checking user code."}, {"owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "edited": false, "score": 0, "creation_date": 1505304839, "post_id": 46196088, "comment_id": 79356841, "body": "I don&#39;t care if C++ won&#39;t vote on stuff like this - C++ is in many ways a dying language. I care about collecting ideas that are appropriate for the next generation of systems programming languages. // C was a good systems programming language, in many ways a portable assembler. But C and C++ never managed to truly support hardware concepts like ROM. // As for &quot;mutable members should be exception, not the rule&quot;, consider a large (gigabyte) lookup table. Don&#39;t you want to be able to cache the most recently accessed items? Exposing the cache is bad abstraction."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1505301362, "creation_date": 1505301362, "answer_id": 46196088, "question_id": 46196043, "link": "https://stackoverflow.com/questions/46196043/c-discards-qualifier-even-if-the-member-variables-are-mutable/46196088#46196088", "title": "c++ : discards qualifier even if the member variables are mutable", "body": "<p>From inside a const qualified function (such as <code>foo</code>), you may only call other const qualified functions. And <code>bar</code> is a not a const qualified function.</p>\n\n<p>The fact <code>bar</code> only touches <code>d_x</code> is immaterial. The mutability of <code>d_x</code> only means that a const qualified member function can modify it <strong>directly</strong>. And formally, <code>bar</code> is allowed to modify <em>any</em> member (if they were to exist).</p>\n"}], "owner": {"reputation": 4897, "user_id": 1113997, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0b81915021f87732e45938efc6942947?s=128&d=identicon&r=PG", "display_name": "ghostrider", "link": "https://stackoverflow.com/users/1113997/ghostrider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "accepted_answer_id": 46196088, "answer_count": 2, "score": 2, "last_activity_date": 1505301846, "creation_date": 1505301230, "question_id": 46196043, "link": "https://stackoverflow.com/questions/46196043/c-discards-qualifier-even-if-the-member-variables-are-mutable", "title": "c++ : discards qualifier even if the member variables are mutable", "body": "<p>I am having some issues with const/mutable and protected. Maybe these are confusing me a little bit so I will give an example.</p>\n\n<pre><code>class Base \n    {\n       virtual void foo() const ;\n       protected :\n          void bar( int y ){ d_x = y } ;\n       private :\n         mutable int d_x ;\n    }\n</code></pre>\n\n<p>So base class has as a virtual <code>foo</code>.</p>\n\n<pre><code>class Derived : public Base\n{\n   void foo() const { bar(5); }\n   private :\n      mutable int d_x ;\n}\n</code></pre>\n\n<p>so in my derived class I have implemented <code>foo</code>, which class <code>bar</code> which then writes to the private d_x.</p>\n\n<p>I would assume is fine - but compiler says :</p>\n\n<pre><code>passing 'Derived' as 'this' argument of bar discards qualifier.\n</code></pre>\n\n<p>Why is that? I thought by using mutable I could make my member function to be const.</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 375, "user_id": 8355846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/fd4b5ef0728f28d16add3bf427e15ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Edit", "link": "https://stackoverflow.com/users/8355846/edit"}, "edited": false, "score": 1, "creation_date": 1505301178, "post_id": 46195982, "comment_id": 79354286, "body": "can you please put your code what you try with your idea."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1505301222, "post_id": 46195982, "comment_id": 79354323, "body": "To begin with, I suggest you read the full line. Then go backwards over the string, passing, the year, the day and the month. Then you know where the book title ends."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1505310357, "post_id": 46195982, "comment_id": 79361117, "body": "Regex might be useful here (but it has its own learning curve)."}], "answers": [{"tags": [], "owner": {"reputation": 1860, "user_id": 7943474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47ce5c2efa9b8f5ac5f5af032625fac?s=128&d=identicon&r=PG&f=1", "display_name": "Neb", "link": "https://stackoverflow.com/users/7943474/neb"}, "is_accepted": false, "score": 0, "last_activity_date": 1505301713, "creation_date": 1505301713, "answer_id": 46196213, "question_id": 46195982, "link": "https://stackoverflow.com/questions/46195982/input-data-into-two-strings/46196213#46196213", "title": "Input data into two strings", "body": "<p>For this kind of work, it's better to use a <a href=\"https://it.wikipedia.org/wiki/Comma-separated_values\" rel=\"nofollow noreferrer\">Comma-Separated Value</a>, in which each element to read is separated by a symbol you choose, e.g <code>';'</code>.</p>\n\n<pre><code>Book title here;Month Day, Year\n</code></pre>\n\n<p>Then you can read your file using</p>\n\n<pre><code>std::string title, date;\n\nstd::getline(yourFile, title, ';');\nstd::getline(yourFile, date);\n</code></pre>\n\n<p>The third parameter of <code>getline()</code> specifies the symbol to use as string separator.</p>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "is_accepted": false, "score": 0, "last_activity_date": 1505301819, "creation_date": 1505301819, "answer_id": 46196256, "question_id": 46195982, "link": "https://stackoverflow.com/questions/46195982/input-data-into-two-strings/46196256#46196256", "title": "Input data into two strings", "body": "<p>When a line-based format becomes to complex to be parsed start to finish, it's best to pre-read the whole line and then analyze the line contents in more detail.</p>\n\n<p>This seems to be the case for your question, since you can't know whether you read part of the book title or the book date, unless there is a defined delimiter or you reached the end of line. Consider the following example  lines:</p>\n\n<pre><code>\"Book Horror Story September 11, 2001\"\n\"Book Horror Story September 11, 2001 October 12, 2019\"\n</code></pre>\n\n<p>If you parse this text left-right, you can't know whether \"September 11, 2001\" is part of the title or part of the date, until you reach the end of line.</p>\n\n<p>So you start with <code>std::getline</code> to read a whole line into a string and then you extract the details from each line. You can do it by manually parsing the line right-to-left as @Someprogrammerdude commented, by developing a regular expression that accepts the line format or use any other appropriate technique.</p>\n"}], "owner": {"reputation": 1, "user_id": 8602297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc42d238bc319ab1530a38422bead875?s=128&d=identicon&r=PG", "display_name": "Fool", "link": "https://stackoverflow.com/users/8602297/fool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1505302538, "creation_date": 1505301062, "last_edit_date": 1505302515, "question_id": 46195982, "link": "https://stackoverflow.com/questions/46195982/input-data-into-two-strings", "title": "Input data into two strings", "body": "<p>Let's say we have an input stream for c++. It contains a list of books with their release dates and then name. A line in the input data looks something like this.</p>\n\n<pre><code> Book title here        Month Day, Year\n</code></pre>\n\n<p>I want to put the book title in one string, and then the year the book was released on in another string. Such that <code>string foo = Book title here ;</code> and that <code>string bar = Month Day, Year;</code> But if you simply do <code>data &gt;&gt; string</code> it will only go up to the next whitespace. In which foo would be <code>foo = Month</code> and bar being <code>bar = Day,</code>. Getline gets the whole line in which foo would become <code>foo = Month Day, Year    Book title here</code>and bar being either the next line or who knows what.</p>\n\n<p>How exactly would I go about this?</p>\n"}, {"tags": ["c++", "scanf", "sign", "cppcheck", "conversion-specifier"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1505301355, "post_id": 46195980, "comment_id": 79354405, "body": "Is there a reason you use <code>sscanf</code> to &quot;parse&quot; the string? Why not simply put it into an <a href=\"http://en.cppreference.com/w/cpp/io/basic_istringstream\" rel=\"nofollow noreferrer\"><code>std::istringstream</code></a> and use normal stream extraction with the <code>&gt;&gt;</code> operator? Of if you&#39;re certain that the string can only contain a valid number then perhaps use <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/stol\" rel=\"nofollow noreferrer\"><code>std::stoi</code></a>?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1505301470, "post_id": 46195980, "comment_id": 79354489, "body": "If you use <code>%u</code> with an <code>unsigned int</code>, you will get the expected output: <a href=\"https://ideone.com/XUaZmV\" rel=\"nofollow noreferrer\">ideone.com/XUaZmV</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1505301516, "post_id": 46195980, "comment_id": 79354517, "body": "Regarding documentation, the reference you link to (or its <a href=\"http://en.cppreference.com/w/cpp/io/c/fscanf\" rel=\"nofollow noreferrer\">C++ counterpart</a>) is very good. Otherwise you can also go to the <a href=\"https://isocpp.org/\" rel=\"nofollow noreferrer\">official homepage of the C++ standards commite</a> and read <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4687.pdf\" rel=\"nofollow noreferrer\">the latest draft</a>."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1505301917, "post_id": 46195980, "comment_id": 79354793, "body": "@mch I think <code>sscanf</code> has as well the opportunity to block the sign. In my opinion, the result is not the expected one."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1505302147, "post_id": 46195980, "comment_id": 79354958, "body": "@Someprogrammerdude thanks for the ref. I&#39;m using <code>sscanf</code> because <b>it</b> is the function in question. I found it easier to check it within a C++ environment. (the original sources mix parts from both worlds)"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1505302302, "post_id": 46195980, "comment_id": 79355057, "body": "<a href=\"http://en.cppreference.com/w/cpp/io/c/fscanf\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/c/fscanf</a> says that <code>%u</code> expect a decimal number like <code>strtoul</code>. <a href=\"http://en.cppreference.com/w/cpp/string/byte/strtoul\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/byte/strtoul</a> says &quot;(optional) plus or minus sign&quot; and &quot;If the minus sign was part of the input sequence, the numeric value calculated from the sequence of digits is negated as if by unary minus in the result type, which applies unsigned integer wraparound rules.&quot;"}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1505302917, "post_id": 46195980, "comment_id": 79355516, "body": "@mch Thanks for helping me having a closer look. I last time learned that *scanf functions are supporting a (limited!) flavour of regex (things like <code>[^1-5]</code>) so I&#39;m surprised to find it treating possible signs characters different. Maybe your are interested in writing one more answer?"}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1505303762, "post_id": 46195980, "comment_id": 79356101, "body": "@Someprogrammerdude (concerning c/c++) sorry I mixed the references (corrected). Have a more specific standard (draft) reference - maybe a page number?"}], "answers": [{"comments": [{"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1505303018, "post_id": 46196021, "comment_id": 79355591, "body": "So <code>&quot;%u&quot;</code> and <code>&quot;%d&quot;</code> control whether <code>strtoul</code> or <code>strtol</code> is being used?"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1505301178, "creation_date": 1505301178, "answer_id": 46196021, "question_id": 46195980, "link": "https://stackoverflow.com/questions/46195980/sscanfs-u-v-matching-signed-integers/46196021#46196021", "title": "sscanf(s, &quot;%u&quot;, &amp;v) matching signed integers", "body": "<p>No, it's not standard compliant. In fact the behaviour of your program is <em>undefined</em>: the format specifier for <code>sscanf</code> must match the types of the arguments.</p>\n"}, {"comments": [{"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1505302376, "post_id": 46196356, "comment_id": 79355120, "body": "I see, I should better have been following this link. I stuck to the headline &quot;matches an unsigned decimal integer.&quot; (with explicit <i>unsigned</i> here)"}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 4, "last_activity_date": 1505310466, "last_edit_date": 1505310466, "creation_date": 1505302088, "answer_id": 46196356, "question_id": 46195980, "link": "https://stackoverflow.com/questions/46195980/sscanfs-u-v-matching-signed-integers/46196356#46196356", "title": "sscanf(s, &quot;%u&quot;, &amp;v) matching signed integers", "body": "<p>There are two separate issues.</p>\n\n<ol>\n<li><code>%u</code> expects a <code>unsigned int*</code> argument; passing a <code>int*</code> is UB.</li>\n<li>Does <code>%u</code> match <code>-4</code>? Yes. The expected format is that of <code>strtoul</code> with base 10, and if you read <a href=\"http://en.cppreference.com/w/c/string/byte/strtoul\" rel=\"nofollow noreferrer\">the documentation</a> it's quite clear that a leading minus sign is allowed.</li>\n</ol>\n"}], "owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 46196356, "answer_count": 2, "score": 4, "last_activity_date": 1505331956, "creation_date": 1505301056, "last_edit_date": 1505331956, "question_id": 46195980, "link": "https://stackoverflow.com/questions/46195980/sscanfs-u-v-matching-signed-integers", "title": "sscanf(s, &quot;%u&quot;, &amp;v) matching signed integers", "body": "<p>After Cppcheck was complaining about <code>\"%u\"</code> as the wrong format specifier to scan into an <code>int</code> variable, I changed the format into <code>\"%d\"</code>, but when having a second look on it before committing the change, I thought that the intention could be to prevent for negative inputs. I wrote two small programs to see the difference:</p>\n\n<h2>Specifier %d</h2>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\nusing namespace std;\n\nint main() {\n    const char* s = \"-4\";\n    int value = -1;\n    int res = sscanf(s, \"%d\", &amp;value);\n    cout &lt;&lt; \"value:\" &lt;&lt; value &lt;&lt; endl;\n    cout &lt;&lt; \"res:\" &lt;&lt; res &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>see also <a href=\"https://ideone.com/OR3IKN\" rel=\"nofollow noreferrer\">https://ideone.com/OR3IKN</a></p>\n\n<h2>Specifier %u</h2>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\nusing namespace std;\n\nint main() {\n    const char* s = \"-4\";\n    int value = -1;\n    int res = sscanf(s, \"%u\", &amp;value);\n    cout &lt;&lt; \"value:\" &lt;&lt; value &lt;&lt; endl;\n    cout &lt;&lt; \"res:\" &lt;&lt; res &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>see also <a href=\"https://ideone.com/WPWdqi\" rel=\"nofollow noreferrer\">https://ideone.com/WPWdqi</a></p>\n\n<h1>Result(s)</h1>\n\n<p>Surprisingly in both conversion specifiers accept the sign:\n</p>\n\n<pre><code>value:-4\nres:1\n</code></pre>\n\n<p>I had a look into the documentation on cppreference.com. For C (<a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">scanf, fscanf, sscanf, scanf_s, fscanf_s, sscanf_s - cppreference.com</a>) as well as C++ (<a href=\"http://en.cppreference.com/w/cpp/io/c/fscanf\" rel=\"nofollow noreferrer\">std::scanf, std::fscanf, std::sscanf - cppreference.com</a>) the description for the <code>\"%u\"</code> conversion specifier is the same (emphasis mine):</p>\n\n<blockquote>\n  <p>matches an <strong>unsigned</strong> decimal integer. <br/>\n  The format of the number is the same as expected by strtoul() with the value 10 for the base argument.</p>\n</blockquote>\n\n<p>Is the observed behaviour standard complient? Where can I find this documented?</p>\n\n<h1>[Update] Undefined Behaviour, really, why?</h1>\n\n<p>I read that it was <a href=\"https://stackoverflow.com/a/46196021/2932052\">simply UB</a>, well, to add to the confusion, here is the version declaring value as <code>unsigned</code> <a href=\"https://ideone.com/nNBkqN\" rel=\"nofollow noreferrer\">https://ideone.com/nNBkqN</a> - I think the assignment of <code>-1</code> is still as expected, but \"%u\" obviously still matches the sign:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n\nusing namespace std;\n\nint main() {\n    const char* s = \"-4\";\n    unsigned value = -1;\n    cout &lt;&lt; \"value before:\" &lt;&lt; value &lt;&lt; endl;\n    int res = sscanf(s, \"%u\", &amp;value);\n    cout &lt;&lt; \"value after:\" &lt;&lt; value &lt;&lt; endl;\n    cout &lt;&lt; \"res:\" &lt;&lt; res &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>value before:4294967295\nvalue after:4294967292\nres:1\n</code></pre>\n"}, {"tags": ["c++", "opencv", "image-processing", "plot", "graph"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 1, "creation_date": 1505300891, "post_id": 46195828, "comment_id": 79354098, "body": "The plot module is in the <i>contrib modules</i>. You need to rebuild OpenCV to use it"}, {"owner": {"reputation": 9770, "user_id": 888688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e1a439c266dcf5015373dbeae410ff5?s=128&d=identicon&r=PG", "display_name": "api55", "link": "https://stackoverflow.com/users/888688/api55"}, "edited": false, "score": 1, "creation_date": 1505300893, "post_id": 46195828, "comment_id": 79354099, "body": "this plot library is in <a href=\"https://github.com/opencv/opencv_contrib\" rel=\"nofollow noreferrer\">opencv contrib library</a>, other than that one, there is no direct way of doing it, manually you can do it, if you see the examples of <a href=\"http://docs.opencv.org/2.4/doc/tutorials/imgproc/histograms/histogram_calculation/histogram_calculation.html\" rel=\"nofollow noreferrer\">histogram calculation</a>, you will see line plot there... Nevertheless, I would recommend to use any other library for this purpose, since OpenCV alternatives usually look pretty bad"}, {"owner": {"reputation": 636, "user_id": 8249210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EU8kG.jpg?s=128&g=1", "display_name": "DivyaMaheswaran", "link": "https://stackoverflow.com/users/8249210/divyamaheswaran"}, "edited": false, "score": 0, "creation_date": 1505301192, "post_id": 46195828, "comment_id": 79354300, "body": "Alright guys, thank you. Looks like there is a additional setup process to add the contributing modules. I will try doing that and also take into account that there are better libraries to plot graphs."}, {"owner": {"reputation": 3225, "user_id": 5294258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5270296f9c4ec3fae89195328e9bc7?s=128&d=identicon&r=PG&f=1", "display_name": "sturkmen", "link": "https://stackoverflow.com/users/5294258/sturkmen"}, "edited": false, "score": 2, "creation_date": 1505305030, "post_id": 46195828, "comment_id": 79356985, "body": "you can test it without compiling contrib module. <a href=\"https://raw.githubusercontent.com/sturkmen72/opencv_samples/master/plot-test.cpp\" rel=\"nofollow noreferrer\">here is the test code</a>"}, {"owner": {"reputation": 636, "user_id": 8249210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EU8kG.jpg?s=128&g=1", "display_name": "DivyaMaheswaran", "link": "https://stackoverflow.com/users/8249210/divyamaheswaran"}, "reply_to_user": {"reputation": 3225, "user_id": 5294258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5270296f9c4ec3fae89195328e9bc7?s=128&d=identicon&r=PG&f=1", "display_name": "sturkmen", "link": "https://stackoverflow.com/users/5294258/sturkmen"}, "edited": false, "score": 0, "creation_date": 1505320748, "post_id": 46195828, "comment_id": 79368390, "body": "@sturkmen please have a look at my answer below. Thanks for your awesome solution."}, {"owner": {"reputation": 636, "user_id": 8249210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EU8kG.jpg?s=128&g=1", "display_name": "DivyaMaheswaran", "link": "https://stackoverflow.com/users/8249210/divyamaheswaran"}, "reply_to_user": {"reputation": 3225, "user_id": 5294258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5270296f9c4ec3fae89195328e9bc7?s=128&d=identicon&r=PG&f=1", "display_name": "sturkmen", "link": "https://stackoverflow.com/users/5294258/sturkmen"}, "edited": false, "score": 0, "creation_date": 1505321903, "post_id": 46195828, "comment_id": 79369096, "body": "@sturkmen Is there a way to scale the graph?"}, {"owner": {"reputation": 3225, "user_id": 5294258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5270296f9c4ec3fae89195328e9bc7?s=128&d=identicon&r=PG&f=1", "display_name": "sturkmen", "link": "https://stackoverflow.com/users/5294258/sturkmen"}, "edited": false, "score": 1, "creation_date": 1505322998, "post_id": 46195828, "comment_id": 79369684, "body": "you can use <code>setMinX</code>,<code>setMinY</code>,<code>setMaxX</code>,<code>setMaxY</code> i think change of these values works to scale the graph."}, {"owner": {"reputation": 636, "user_id": 8249210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EU8kG.jpg?s=128&g=1", "display_name": "DivyaMaheswaran", "link": "https://stackoverflow.com/users/8249210/divyamaheswaran"}, "edited": false, "score": 0, "creation_date": 1505477402, "post_id": 46195828, "comment_id": 79441838, "body": "Ptr&lt;plot::Plot2d&gt; plot = plot::Plot2d::create(data); plot-&gt;setPlotBackgroundColor(Scalar(50, 50, 50));  plot-&gt;setPlotLineColor(Scalar(50, 50, 255)); plot-&gt;setMinX(0); plot-&gt;setMinY(0); plot-&gt;setMaxX(4000); plot-&gt;setMaxY(1000);  plot-&gt;render(plot_result);            imshow(&quot;Graph&quot;, plot_result); waitKey();  return 0; }"}, {"owner": {"reputation": 636, "user_id": 8249210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EU8kG.jpg?s=128&g=1", "display_name": "DivyaMaheswaran", "link": "https://stackoverflow.com/users/8249210/divyamaheswaran"}, "reply_to_user": {"reputation": 3225, "user_id": 5294258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5270296f9c4ec3fae89195328e9bc7?s=128&d=identicon&r=PG&f=1", "display_name": "sturkmen", "link": "https://stackoverflow.com/users/5294258/sturkmen"}, "edited": false, "score": 0, "creation_date": 1505477561, "post_id": 46195828, "comment_id": 79441957, "body": "@sturkmen including the above codes doesn&#39;t scale the graph. Is this what you meant?"}, {"owner": {"reputation": 3225, "user_id": 5294258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5270296f9c4ec3fae89195328e9bc7?s=128&d=identicon&r=PG&f=1", "display_name": "sturkmen", "link": "https://stackoverflow.com/users/5294258/sturkmen"}, "edited": false, "score": 0, "creation_date": 1505503575, "post_id": 46195828, "comment_id": 79456805, "body": "could you post screenshots of graph before adding this code and after"}, {"owner": {"reputation": 636, "user_id": 8249210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EU8kG.jpg?s=128&g=1", "display_name": "DivyaMaheswaran", "link": "https://stackoverflow.com/users/8249210/divyamaheswaran"}, "edited": false, "score": 0, "creation_date": 1505749830, "post_id": 46195828, "comment_id": 79529854, "body": "All it does is it sets the value for X and Y axis but I wanted the axis numbering on the graph. Anyway, I used GNUPlot to plot a graph. Now, I am trying to LOG the graphical data using BOOST C++. I have posted a question <a href=\"https://stackoverflow.com/questions/46282226/trying-to-find-a-way-to-log-graphical-data-in-opencv-boost\" title=\"trying to find a way to log graphical data in opencv boost\">stackoverflow.com/questions/46282226/&hellip;</a> on this. Please have a look and give me your valuable suggestion genius."}], "answers": [{"tags": [], "owner": {"reputation": 5482, "user_id": 2286337, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/A8dkr.jpg?s=128&g=1", "display_name": "zindarod", "link": "https://stackoverflow.com/users/2286337/zindarod"}, "is_accepted": false, "score": 0, "last_activity_date": 1505301893, "creation_date": 1505301893, "answer_id": 46196284, "question_id": 46195828, "link": "https://stackoverflow.com/questions/46195828/is-there-a-way-to-plot-graphs-in-opencv/46196284#46196284", "title": "Is there a way to plot graphs in OpenCV?", "body": "<p>In addition to needing the opencv_contrib modules, you need to change the line:</p>\n\n<pre><code>Ptr&lt;plot::Plot2d&gt; plot = plot::create2DPlot(data);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Ptr&lt;plot::Plot2d&gt; plot = plot::Plot2d::create(data);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3225, "user_id": 5294258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5270296f9c4ec3fae89195328e9bc7?s=128&d=identicon&r=PG&f=1", "display_name": "sturkmen", "link": "https://stackoverflow.com/users/5294258/sturkmen"}, "edited": false, "score": 0, "creation_date": 1505323265, "post_id": 46202761, "comment_id": 79369824, "body": "plot module still needs some improvements. you can share your remarks about using it in the <a href=\"https://github.com/opencv/opencv_contrib/issues/1306\" rel=\"nofollow noreferrer\">related issue page</a>"}], "tags": [], "owner": {"reputation": 636, "user_id": 8249210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EU8kG.jpg?s=128&g=1", "display_name": "DivyaMaheswaran", "link": "https://stackoverflow.com/users/8249210/divyamaheswaran"}, "is_accepted": true, "score": 2, "last_activity_date": 1505320656, "creation_date": 1505320656, "answer_id": 46202761, "question_id": 46195828, "link": "https://stackoverflow.com/questions/46195828/is-there-a-way-to-plot-graphs-in-opencv/46202761#46202761", "title": "Is there a way to plot graphs in OpenCV?", "body": "<p>I have found a way to plot graphs in OpenCV. Here it goes, </p>\n\n<p>From the <a href=\"https://raw.githubusercontent.com/sturkmen72/opencv_samples/master/plot-test.cpp\" rel=\"nofollow noreferrer\">https://raw.githubusercontent.com/sturkmen72/opencv_samples/master/plot-test.cpp</a> link provided by Sturkmen, I took the codes and made it as my header file. </p>\n\n<p><strong>plot.h</strong></p>\n\n<pre><code>#pragma once\n#include &lt;opencv2/core.hpp&gt;\n#include &lt;opencv2/imgproc.hpp&gt;\n#include &lt;opencv2/highgui.hpp&gt;\n\nnamespace cv\n{\nnamespace plot\n{\n    //! @addtogroup plot\n    //! @{\n\n    class CV_EXPORTS_W Plot2d : public Algorithm\n    {\n    public:\n\n        CV_WRAP virtual void setMinX(double _plotMinX) = 0;\n        CV_WRAP virtual void setMinY(double _plotMinY) = 0;\n        CV_WRAP virtual void setMaxX(double _plotMaxX) = 0;\n        CV_WRAP virtual void setMaxY(double _plotMaxY) = 0;\n        CV_WRAP virtual void setPlotLineWidth(int _plotLineWidth) = 0;\n        /**\n        * @brief Switches data visualization mode\n        *\n        * @param _needPlotLine if true then neighbour plot points will be connected by lines.\n        * In other case data will be plotted as a set of standalone points.\n        */\n        CV_WRAP virtual void setNeedPlotLine(bool _needPlotLine) = 0;\n        CV_WRAP virtual void setPlotLineColor(Scalar _plotLineColor) = 0;\n        CV_WRAP virtual void setPlotBackgroundColor(Scalar _plotBackgroundColor) = 0;\n        CV_WRAP virtual void setPlotAxisColor(Scalar _plotAxisColor) = 0;\n        CV_WRAP virtual void setPlotGridColor(Scalar _plotGridColor) = 0;\n        CV_WRAP virtual void setPlotTextColor(Scalar _plotTextColor) = 0;\n        CV_WRAP virtual void setPlotSize(int _plotSizeWidth, int _plotSizeHeight) = 0;\n        CV_WRAP virtual void setShowGrid(bool needShowGrid) = 0;\n        CV_WRAP virtual void setShowText(bool needShowText) = 0;\n        CV_WRAP virtual void setGridLinesNumber(int gridLinesNumber) = 0;\n        /**\n        * @brief Sets the index of a point which coordinates will be printed on the top left corner of the plot (if ShowText flag is true).\n        *\n        * @param pointIdx index of the required point in data array.\n        */\n        CV_WRAP virtual void setPointIdxToPrint(int pointIdx) = 0;\n        CV_WRAP virtual void render(OutputArray _plotResult) = 0;\n\n        /**\n        * @brief Creates Plot2d object\n        *\n        * @param data \\f$1xN\\f$ or \\f$Nx1\\f$ matrix containing \\f$Y\\f$ values of points to plot. \\f$X\\f$ values\n        * will be equal to indexes of correspondind elements in data matrix.\n        */\n        CV_WRAP static Ptr&lt;Plot2d&gt; create(InputArray data);\n\n        /**\n        * @brief Creates Plot2d object\n        *\n        * @param dataX \\f$1xN\\f$ or \\f$Nx1\\f$ matrix \\f$X\\f$ values of points to plot.\n        * @param dataY \\f$1xN\\f$ or \\f$Nx1\\f$ matrix containing \\f$Y\\f$ values of points to plot.\n        */\n        CV_WRAP static Ptr&lt;Plot2d&gt; create(InputArray dataX, InputArray dataY);\n    };\n    //! @}\n}\n}\n\nnamespace cv\n{\nnamespace plot\n{\n    using namespace std;\n\n    class Plot2dImpl : public Plot2d\n    {\n    public:\n\n        Plot2dImpl(InputArray plotData)\n        {\n            Mat _plotData = plotData.getMat();\n            //if the matrix is not Nx1 or 1xN\n            if (_plotData.cols &gt; 1 &amp;&amp; _plotData.rows &gt; 1)\n                CV_Error(Error::StsBadArg, \"ERROR: Plot data must be a 1xN or Nx1 matrix.\\n\");\n\n            CV_Assert(_plotData.type() == CV_64F);\n\n            //in case we have a row matrix than needs to be transposed\n            if (_plotData.cols &gt; _plotData.rows)\n            {\n                _plotData = _plotData.t();\n            }\n\n            plotDataY = _plotData;\n            plotDataX = plotDataY * 0;\n            for (int i = 0; i&lt;plotDataY.rows; i++)\n            {\n                plotDataX.at&lt;double&gt;(i, 0) = i;\n            }\n\n            //calling the main constructor\n            plotHelper(plotDataX, plotDataY);\n\n        }\n\n        Plot2dImpl(InputArray plotDataX_, InputArray plotDataY_)\n        {\n            Mat _plotDataX = plotDataX_.getMat();\n            Mat _plotDataY = plotDataY_.getMat();\n            //f the matrix is not Nx1 or 1xN\n            if ((_plotDataX.cols &gt; 1 &amp;&amp; _plotDataX.rows &gt; 1) || (_plotDataY.cols &gt; 1 &amp;&amp; _plotDataY.rows &gt; 1))\n                CV_Error(Error::StsBadArg, \"ERROR: Plot data must be a 1xN or Nx1 matrix.\\n\");\n\n            CV_Assert(_plotDataX.type() == CV_64F &amp;&amp; _plotDataY.type() == CV_64F);\n\n            //in case we have a row matrix than needs to be transposed\n            if (_plotDataX.cols &gt; _plotDataX.rows)\n            {\n                _plotDataX = _plotDataX.t();\n            }\n            if (_plotDataY.cols &gt; _plotDataY.rows)\n            {\n                _plotDataY = _plotDataY.t();\n            }\n\n            plotHelper(_plotDataX, _plotDataY);\n        }\n\n        //set functions\n        void setMinX(double _plotMinX)\n        {\n            plotMinX = _plotMinX;\n            plotMinX_plusZero = _plotMinX;\n        }\n        void setMaxX(double _plotMaxX)\n        {\n            plotMaxX = _plotMaxX;\n            plotMaxX_plusZero = _plotMaxX;\n        }\n        void setMinY(double _plotMinY)\n        {\n            plotMinY = _plotMinY;\n            plotMinY_plusZero = _plotMinY;\n        }\n        void setMaxY(double _plotMaxY)\n        {\n            plotMaxY = _plotMaxY;\n            plotMaxY_plusZero = _plotMaxY;\n        }\n        void setPlotLineWidth(int _plotLineWidth)\n        {\n            plotLineWidth = _plotLineWidth;\n        }\n        void setNeedPlotLine(bool _needPlotLine)\n        {\n            needPlotLine = _needPlotLine;\n        }\n        void setPlotLineColor(Scalar _plotLineColor)\n        {\n            plotLineColor = _plotLineColor;\n        }\n        void setPlotBackgroundColor(Scalar _plotBackgroundColor)\n        {\n            plotBackgroundColor = _plotBackgroundColor;\n        }\n        void setPlotAxisColor(Scalar _plotAxisColor)\n        {\n            plotAxisColor = _plotAxisColor;\n        }\n        void setPlotGridColor(Scalar _plotGridColor)\n        {\n            plotGridColor = _plotGridColor;\n        }\n        void setPlotTextColor(Scalar _plotTextColor)\n        {\n            plotTextColor = _plotTextColor;\n        }\n        void setPlotSize(int _plotSizeWidth, int _plotSizeHeight)\n        {\n            if (_plotSizeWidth &gt; 400)\n                plotSizeWidth = _plotSizeWidth;\n            else\n                plotSizeWidth = 400;\n\n            if (_plotSizeHeight &gt; 300)\n                plotSizeHeight = _plotSizeHeight;\n            else\n                plotSizeHeight = 300;\n        }\n        void setShowGrid(bool _needShowGrid)\n        {\n            needShowGrid = _needShowGrid;\n        }\n        void setShowText(bool _needShowText)\n        {\n            needShowText = _needShowText;\n        }\n        void setGridLinesNumber(int _gridLinesNumber)\n        {\n            if (_gridLinesNumber &lt;= 0)\n                _gridLinesNumber = 1;\n            gridLinesNumber = _gridLinesNumber;\n        }\n        void setPointIdxToPrint(int _cursorPos)\n        {\n            if (_cursorPos &gt;= plotDataX.rows || _cursorPos &lt; 0)\n                _cursorPos = plotDataX.rows - 1;\n            cursorPos = _cursorPos;\n        }\n        //render the plotResult to a Mat\n        void render(OutputArray _plotResult)\n        {\n            //create the plot result\n            _plotResult.create(plotSizeHeight, plotSizeWidth, CV_8UC3);\n            plotResult = _plotResult.getMat();\n            plotResult.setTo(plotBackgroundColor);\n\n            int NumVecElements = plotDataX.rows;\n\n            Mat InterpXdata = linearInterpolation(plotMinX, plotMaxX, 0, plotSizeWidth, plotDataX);\n            Mat InterpYdata = linearInterpolation(plotMinY, plotMaxY, 0, plotSizeHeight, plotDataY);\n\n            //Find the zeros in image coordinates\n            Mat InterpXdataFindZero = linearInterpolation(plotMinX_plusZero, plotMaxX_plusZero, 0, plotSizeWidth, plotDataX_plusZero);\n            Mat InterpYdataFindZero = linearInterpolation(plotMinY_plusZero, plotMaxY_plusZero, 0, plotSizeHeight, plotDataY_plusZero);\n\n            int ImageXzero = (int)InterpXdataFindZero.at&lt;double&gt;(NumVecElements, 0);\n            int ImageYzero = (int)InterpYdataFindZero.at&lt;double&gt;(NumVecElements, 0);\n\n            double CurrentX = plotDataX.at&lt;double&gt;(cursorPos, 0);\n            double CurrentY = plotDataY.at&lt;double&gt;(cursorPos, 0);\n\n            drawAxis(ImageXzero, ImageYzero, CurrentX, CurrentY, plotAxisColor, plotGridColor);\n\n            if (needPlotLine)\n            {\n                //Draw the plot by connecting lines between the points\n                Point p1;\n                p1.x = (int)InterpXdata.at&lt;double&gt;(0, 0);\n                p1.y = (int)InterpYdata.at&lt;double&gt;(0, 0);\n\n                for (int r = 1; r&lt;InterpXdata.rows; r++)\n                {\n                    Point p2;\n                    p2.x = (int)InterpXdata.at&lt;double&gt;(r, 0);\n                    p2.y = (int)InterpYdata.at&lt;double&gt;(r, 0);\n\n                    line(plotResult, p1, p2, plotLineColor, plotLineWidth, 8, 0);\n\n                    p1 = p2;\n                }\n            }\n            else\n            {\n                for (int r = 0; r&lt;InterpXdata.rows; r++)\n                {\n                    Point p;\n                    p.x = (int)InterpXdata.at&lt;double&gt;(r, 0);\n                    p.y = (int)InterpYdata.at&lt;double&gt;(r, 0);\n\n                    circle(plotResult, p, 1, plotLineColor, plotLineWidth, 8, 0);\n                }\n            }\n        }\n\n    protected:\n\n        Mat plotDataX;\n        Mat plotDataY;\n        Mat plotDataX_plusZero;\n        Mat plotDataY_plusZero;\n        const char * plotName;\n\n        //dimensions and limits of the plot\n        int plotSizeWidth;\n        int plotSizeHeight;\n        double plotMinX;\n        double plotMaxX;\n        double plotMinY;\n        double plotMaxY;\n        double plotMinX_plusZero;\n        double plotMaxX_plusZero;\n        double plotMinY_plusZero;\n        double plotMaxY_plusZero;\n        int plotLineWidth;\n        bool needShowGrid;\n        bool needShowText;\n        int gridLinesNumber;\n        int cursorPos;\n\n        //colors of each plot element\n        Scalar plotLineColor;\n        Scalar plotBackgroundColor;\n        Scalar plotAxisColor;\n        Scalar plotGridColor;\n        Scalar plotTextColor;\n\n        //the final plot result\n        Mat plotResult;\n\n        //flag which enables/disables connection of plotted points by lines\n        bool needPlotLine;\n\n        void plotHelper(Mat _plotDataX, Mat _plotDataY)\n        {\n            plotDataX = _plotDataX;\n            plotDataY = _plotDataY;\n\n            int NumVecElements = plotDataX.rows;\n\n            plotDataX_plusZero = Mat::zeros(NumVecElements + 1, 1, CV_64F);\n            plotDataY_plusZero = Mat::zeros(NumVecElements + 1, 1, CV_64F);\n\n            for (int i = 0; i&lt;NumVecElements; i++)\n            {\n                plotDataX_plusZero.at&lt;double&gt;(i, 0) = plotDataX.at&lt;double&gt;(i, 0);\n                plotDataY_plusZero.at&lt;double&gt;(i, 0) = plotDataY.at&lt;double&gt;(i, 0);\n            }\n\n            double MinX;\n            double MaxX;\n            double MinY;\n            double MaxY;\n            double MinX_plusZero;\n            double MaxX_plusZero;\n            double MinY_plusZero;\n            double MaxY_plusZero;\n\n            needPlotLine = true;\n\n            //Obtain the minimum and maximum values of Xdata\n            minMaxLoc(plotDataX, &amp;MinX, &amp;MaxX);\n\n            //Obtain the minimum and maximum values of Ydata\n            minMaxLoc(plotDataY, &amp;MinY, &amp;MaxY);\n\n            //Obtain the minimum and maximum values of Xdata plus zero\n            minMaxLoc(plotDataX_plusZero, &amp;MinX_plusZero, &amp;MaxX_plusZero);\n\n            //Obtain the minimum and maximum values of Ydata plus zero\n            minMaxLoc(plotDataY_plusZero, &amp;MinY_plusZero, &amp;MaxY_plusZero);\n\n            //setting the min and max values for each axis\n            plotMinX = MinX;\n            plotMaxX = MaxX;\n            plotMinY = MinY;\n            plotMaxY = MaxY;\n            plotMinX_plusZero = MinX_plusZero;\n            plotMaxX_plusZero = MaxX_plusZero;\n            plotMinY_plusZero = MinY_plusZero;\n            plotMaxY_plusZero = MaxY_plusZero;\n\n            //setting the default size of a plot figure\n            setPlotSize(600, 400);\n\n            //setting the default plot line size\n            setPlotLineWidth(1);\n\n            //setting default colors for the different elements of the plot\n            setPlotAxisColor(Scalar(0, 0, 255));\n            setPlotGridColor(Scalar(255, 255, 255));\n            setPlotBackgroundColor(Scalar(0, 0, 0));\n            setPlotLineColor(Scalar(0, 255, 255));\n            setPlotTextColor(Scalar(255, 255, 255));\n            setShowGrid(true);\n            setShowText(true);\n            setGridLinesNumber(10);\n            setPointIdxToPrint(-1);\n        }\n\n        void drawAxis(int ImageXzero, int ImageYzero, double CurrentX, double CurrentY, Scalar axisColor, Scalar gridColor)\n        {\n            if (needShowText)\n            {\n                drawValuesAsText(0, ImageXzero, ImageYzero, 10, 20);\n                drawValuesAsText(0, ImageXzero, ImageYzero, -20, 20);\n                drawValuesAsText(0, ImageXzero, ImageYzero, 10, -10);\n                drawValuesAsText(0, ImageXzero, ImageYzero, -20, -10);\n                drawValuesAsText((format(\"X_%d = \", cursorPos) + \"%g\").c_str(), CurrentX, 0, 0, 40, 20);\n                drawValuesAsText((format(\"Y_%d = \", cursorPos) + \"%g\").c_str(), CurrentY, 0, 20, 40, 20);\n            }\n\n            //Horizontal X axis and equispaced horizontal lines\n            int LineSpace = cvRound(plotSizeHeight / (float)gridLinesNumber);\n            int TraceSize = 5;\n            drawLine(0, plotSizeWidth, ImageYzero, ImageYzero, axisColor);\n\n            if (needShowGrid)\n                for (int i = -plotSizeHeight; i&lt;plotSizeHeight; i = i + LineSpace)\n                {\n\n                    if (i != 0)\n                    {\n                        int Trace = 0;\n                        while (Trace&lt;plotSizeWidth)\n                        {\n                            drawLine(Trace, Trace + TraceSize, ImageYzero + i, ImageYzero + i, gridColor);\n                            Trace = Trace + 2 * TraceSize;\n                        }\n                    }\n                }\n\n\n            //Vertical Y axis\n            drawLine(ImageXzero, ImageXzero, 0, plotSizeHeight, axisColor);\n            LineSpace = cvRound(LineSpace * (float)plotSizeWidth / plotSizeHeight);\n\n            if (needShowGrid)\n                for (int i = -plotSizeWidth; i&lt;plotSizeWidth; i = i + LineSpace)\n                {\n\n                    if (i != 0)\n                    {\n                        int Trace = 0;\n                        while (Trace&lt;plotSizeHeight)\n                        {\n                            drawLine(ImageXzero + i, ImageXzero + i, Trace, Trace + TraceSize, gridColor);\n                            Trace = Trace + 2 * TraceSize;\n                        }\n                    }\n                }\n        }\n\n        Mat linearInterpolation(double Xa, double Xb, double Ya, double Yb, Mat Xdata)\n        {\n\n            Mat Ydata = Xdata * 0;\n\n            for (int i = 0; i&lt;Xdata.rows; i++)\n            {\n\n                double X = Xdata.at&lt;double&gt;(i, 0);\n                Ydata.at&lt;double&gt;(i, 0) = int(Ya + (Yb - Ya)*(X - Xa) / (Xb - Xa));\n\n                if (Ydata.at&lt;double&gt;(i, 0)&lt;0)\n                    Ydata.at&lt;double&gt;(i, 0) = 0;\n\n            }\n\n            return Ydata;\n        }\n\n        void drawValuesAsText(double Value, int Xloc, int Yloc, int XMargin, int YMargin)\n        {\n\n            char AxisX_Min_Text[20];\n            double TextSize = 1;\n\n            sprintf(AxisX_Min_Text, \"%g\", Value);\n            Point AxisX_Min_Loc;\n            AxisX_Min_Loc.x = Xloc + XMargin;\n            AxisX_Min_Loc.y = Yloc + YMargin;\n\n            putText(plotResult, AxisX_Min_Text, AxisX_Min_Loc, FONT_HERSHEY_COMPLEX_SMALL, TextSize, plotTextColor, 1, 8);\n        }\n\n        void drawValuesAsText(const char *Text, double Value, int Xloc, int Yloc, int XMargin, int YMargin)\n        {\n\n            char AxisX_Min_Text[20];\n            int TextSize = 1;\n\n            sprintf(AxisX_Min_Text, Text, Value);\n            Point AxisX_Min_Loc;\n            AxisX_Min_Loc.x = Xloc + XMargin;\n            AxisX_Min_Loc.y = Yloc + YMargin;\n\n            putText(plotResult, AxisX_Min_Text, AxisX_Min_Loc, FONT_HERSHEY_COMPLEX_SMALL, TextSize, plotTextColor, 1, 8);\n        }\n\n\n        void drawLine(int Xstart, int Xend, int Ystart, int Yend, Scalar lineColor)\n        {\n\n            Point Axis_start;\n            Point Axis_end;\n            Axis_start.x = Xstart;\n            Axis_start.y = Ystart;\n            Axis_end.x = Xend;\n            Axis_end.y = Yend;\n\n            line(plotResult, Axis_start, Axis_end, lineColor, plotLineWidth, 8, 0);\n        }\n\n    };\n\n    Ptr&lt;Plot2d&gt; Plot2d::create(InputArray _plotData)\n    {\n        return Ptr&lt;Plot2dImpl&gt;(new Plot2dImpl(_plotData));\n\n    }\n\n    Ptr&lt;Plot2d&gt; Plot2d::create(InputArray _plotDataX, InputArray _plotDataY)\n    {\n        return Ptr&lt;Plot2dImpl&gt;(new Plot2dImpl(_plotDataX, _plotDataY));\n    }\n}\n}\n</code></pre>\n\n<p>Now, the header file is ready. I added this <strong>plot.h</strong> to my cpp file.</p>\n\n<p>Here is my Graph plotting function in OpenCV C++:</p>\n\n<p><strong>Plot.cpp</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;opencv2/opencv.hpp&gt;\n#include \"plot.h\"\n\n\nint PlotGraph(Mat &amp; data) {\n\n//converting the Mat to CV_64F\ndata.convertTo(data, CV_64F);\nMat plot_result;\n\nPtr&lt;plot::Plot2d&gt; plot = plot::Plot2d::create(data);\nplot-&gt;setPlotBackgroundColor(Scalar(50, 50, 50)); \nplot-&gt;setPlotLineColor(Scalar(50, 50, 255));\nplot-&gt;render(plot_result);          \n\nimshow(\"Graph\", plot_result);\nwaitKey();\n\nreturn 0;\n}\n</code></pre>\n\n<p>so, we can create our own plot.h header file and plot graphs in OpenCV without using external libraries. </p>\n"}, {"tags": [], "owner": {"reputation": 170, "user_id": 3929196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C5Hbp.jpg?s=128&g=1", "display_name": "palfi", "link": "https://stackoverflow.com/users/3929196/palfi"}, "is_accepted": false, "score": 1, "last_activity_date": 1584265714, "last_edit_date": 1584265714, "creation_date": 1584263943, "answer_id": 60691370, "question_id": 46195828, "link": "https://stackoverflow.com/questions/46195828/is-there-a-way-to-plot-graphs-in-opencv/60691370#60691370", "title": "Is there a way to plot graphs in OpenCV?", "body": "<p>There is no plot support in OpenCV. You can use the <a href=\"https://github.com/opencv/opencv_contrib/tree/master/modules/plot\" rel=\"nofollow noreferrer\">plot contrib module</a>, but it is very basic.</p>\n\n<p>You could try Profactor CvPlot <a href=\"https://github.com/Profactor/cv-plot\" rel=\"nofollow noreferrer\">https://github.com/Profactor/cv-plot</a>. (I am the developer). It is very easy to integrate, purely opencv based and can be extended with custom controls. This is how you can plot to a cv::Mat or show a diagram with an interactive viewer:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;CvPlot/cvplot.h&gt;\nstd::vector&lt;double&gt; x(20*1000), y1(x.size()), y2(x.size()), y3(x.size());\nfor (size_t i = 0; i &lt; x.size(); i++) {\n    x[i] = i * CV_2PI / x.size();\n    y1[i] = std::sin(x[i]);\n    y2[i] = y1[i] * std::sin(x[i]*50);\n    y3[i] = y2[i] * std::sin(x[i]*500);\n}\nauto axes = CvPlot::makePlotAxes();\naxes.create&lt;CvPlot::Series&gt;(x, y3, \"-g\");\naxes.create&lt;CvPlot::Series&gt;(x, y2, \"-b\");\naxes.create&lt;CvPlot::Series&gt;(x, y1, \"-r\");\n\n//plot to a cv::Mat\ncv::Mat mat = axes.render(300, 400);\n\n//or show with interactive viewer\nCvPlot::show(\"mywindow\", axes);\n</code></pre>\n\n<p><img src=\"https://raw.githubusercontent.com/Profactor/cv-plot/master/doc/img/zoom-series.gif\" alt=\"CvPlot\"></p>\n\n<p>You may also want to try <a href=\"https://github.com/leonardvandriel/cvplot\" rel=\"nofollow noreferrer\">Leonardvandriel's cvplot</a>. It works similar but cannot be extended with custom drawables.</p>\n"}], "owner": {"reputation": 636, "user_id": 8249210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EU8kG.jpg?s=128&g=1", "display_name": "DivyaMaheswaran", "link": "https://stackoverflow.com/users/8249210/divyamaheswaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10430, "favorite_count": 0, "accepted_answer_id": 46202761, "answer_count": 3, "score": 0, "last_activity_date": 1584265714, "creation_date": 1505300597, "question_id": 46195828, "link": "https://stackoverflow.com/questions/46195828/is-there-a-way-to-plot-graphs-in-opencv", "title": "Is there a way to plot graphs in OpenCV?", "body": "<p><strong>To begin with:</strong> I am working on image processing in OpenCV C++. </p>\n\n<p><strong>The Requirement</strong> is to plot a graph out of the Vector values of a 1D image. I referred <a href=\"http://answers.opencv.org/question/73233/how-do-you-plot-graphs-in-opencv-projects/\" rel=\"nofollow noreferrer\">http://answers.opencv.org/question/73233/how-do-you-plot-graphs-in-opencv-projects/</a>  and found a solution for it. It is a brilliant one that one could make in OpenCV but, the <code>plot</code> is not recognized by the OpenCV original libraries. </p>\n\n<p><strong>To find a solution</strong> for this, I went through all the library files and came to a conclusion that the header file<br>\n         <code> #include opencv2/plot.hpp </code> is not in the original OpenCV library(latest version). It must be implemented in some additional library but hasn't been on live I suppose. </p>\n\n<p>Here is my <strong>CODE</strong> for your reference:</p>\n\n<pre><code>#include &lt;opencv2/plot.hpp&gt;\n\nint PlotGraph(Mat &amp; data) {\n\n\nMat plot_result;\n\nPtr&lt;plot::Plot2d&gt; plot = plot::createPlot2d(data);\n\n//Set Background color\nplot-&gt;setPlotBackgroundColor(Scalar(50, 50, 50)); \n\n//Set plot line color\nplot-&gt;setPlotLineColor(Scalar(50, 50, 255));\nplot-&gt;render(plot_result);\n\nimshow(\"plot\", plot_result);\nwaitKey();\n\nplot-&gt;setPlotLineColor(Scalar(50, 255, 255));\ndata = data / 3;\nplot-&gt;render(plot_result);\n\nimshow(\"plot\", plot_result);\nwaitKey();\n\nplot-&gt;setPlotGridColor(Scalar(255, 0, 255));\ndata = data * 4;\nplot-&gt;render(IMREAD_UNCHANGEDplot_result);\n\nimshow(\"plot\", plot_result);\nwaitKey();\n\nplot-&gt;setPlotTextColor(Scalar(255, 0, 0));\nrandu(data, 100, 400);\nplot-&gt;render(plot_result);\n\nimshow(\"plot\", plot_result);\nwaitKey();\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>There are many ways in C++ and other libraries such as GNU to plot graphs but, I am being bit curious and not want to give up on this. </p>\n\n<p>I would appreciate if anyone gives me a solution to this or suggest a way to plot graphs in OpenCV C++. </p>\n"}, {"tags": ["c++", "visual-c++", "cmake", "ogre"], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1375748, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4439c36601e926b159329b480f07a777?s=128&d=identicon&r=PG", "display_name": "Mamad R", "link": "https://stackoverflow.com/users/1375748/mamad-r"}, "edited": false, "score": 0, "creation_date": 1505303132, "post_id": 46196254, "comment_id": 79355664, "body": "thanks you! very nice explanation. its worked in creating .sln with cmake . im going to write my hello word . so if i have question about Cmake let me ask it here. and 1 question why that site dont use link libraries ? they do it when calling package required?"}], "tags": [], "owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "is_accepted": true, "score": 3, "last_activity_date": 1505302130, "last_edit_date": 1505302130, "creation_date": 1505301810, "answer_id": 46196254, "question_id": 46195809, "link": "https://stackoverflow.com/questions/46195809/cmake-add-new-project-to-solution/46196254#46196254", "title": "Cmake Add new project to solution", "body": "<p>The CMake terminology is slightly different from Visual Studio's.</p>\n\n<p>In particular, each CMake <a href=\"https://cmake.org/cmake/help/v3.8/command/project.html\" rel=\"nofollow noreferrer\"><code>project</code></a> will create a Visual Studio solution (<code>.sln</code> file), while all of the <a href=\"https://cmake.org/cmake/help/v3.8/manual/cmake-buildsystem.7.html#introduction\" rel=\"nofollow noreferrer\">CMake targets</a> belonging to that CMake project will appear as Visual Studio projects within the corresponding solution.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>CMake       Visual Studio\n\nproject &lt;-&gt; Solution (.sln)\nTarget  &lt;-&gt; Project (.vcxproj)\n</code></pre>\n\n<p>So your project is clearly missing a target. In your case, you probably want an executable target, which is added using <a href=\"https://cmake.org/cmake/help/v3.8/command/add_executable.html\" rel=\"nofollow noreferrer\"><code>add_executable</code></a>. The executable can have the same name as the project. Note that an executable cannot be completely empty in CMake. While the concept of an empty executable project exists in Visual Studio, it is not valid in other build systems, so CMake cannot not support it either. So you need to specify at least one source file here:</p>\n\n<pre><code>add_executable(og1 og1.cpp)\n</code></pre>\n\n<p>With that in place, you can also attach the remaining build options to the target instead. This step is optional, as your code would have also worked here, but is considered good style in modern CMake:</p>\n\n<pre><code>target_include_directories(og1 PUBLIC ${OGRE_INCLUDE_DIRS})\ntarget_link_libraries(og1 PUBLIC ${OGRE_LIBRARIES})\n</code></pre>\n\n<p>Note that in CMake, <a href=\"https://stackoverflow.com/a/31471772/577603\">we prefer to not use the library directory for telling the build system of the library's location</a>, but instead always use the full path to the library file.</p>\n"}], "owner": {"reputation": 580, "user_id": 1375748, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4439c36601e926b159329b480f07a777?s=128&d=identicon&r=PG", "display_name": "Mamad R", "link": "https://stackoverflow.com/users/1375748/mamad-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2660, "favorite_count": 0, "accepted_answer_id": 46196254, "answer_count": 1, "score": 1, "last_activity_date": 1597805854, "creation_date": 1505300557, "last_edit_date": 1597805854, "question_id": 46195809, "link": "https://stackoverflow.com/questions/46195809/cmake-add-new-project-to-solution", "title": "Cmake Add new project to solution", "body": "<p>I am totally new in cmake so excuse me if asking this low question but cannot find the answer on google.</p>\n<p>I'm trying to create an empty project on top of Ogre3d SDK.\nI built an ogre3d source with cmake and vs2015, now I want to create my project on top of ogre libs and headers. so as explained <a href=\"https://ogrecave.github.io/ogre/api/1.10/setup.html\" rel=\"nofollow noreferrer\">here</a>\nI create a cmakelists.txt file and add these lines to it :</p>\n<pre><code># specify which version you need\nfind_package(OGRE 1.10 REQUIRED)\n\nproject(OG1)\n\n# the search paths\ninclude_directories(${OGRE_INCLUDE_DIRS})\nlink_directories(${OGRE_LIBRARY_DIRS})\n\n # copy essential config files next to our binary where OGRE autodiscovers them\n file(COPY ${OGRE_CONFIG_DIR}/plugins.cfg ${OGRE_CONFIG_DIR}/resources.cfg \n  DESTINATION ${CMAKE_BINARY_DIR})\n</code></pre>\n<p>everything is ok and success on creating cmake files and generate .sln with cmake-gui <strong>but</strong> I hope cmake creates an empty project with the name OG1 then I can run my first ogre helloword but it generates a .sln file that only contains just ALL_BUILD and ZERO_CHECK.\nHow can I create a clean project that has all configuration and is ready for just using ogre classes (i mean it automatically configure link, includes, etc)?</p>\n"}, {"tags": ["c++", "inheritance", "c++17", "typetraits"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505299595, "post_id": 46195465, "comment_id": 79353202, "body": "If it has a base <i>in general</i>? Don&#39;t think you can do that without &quot;cheating&quot;."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1505299940, "post_id": 46195465, "comment_id": 79353480, "body": "you need to wait for introspection to be added to C++, or find a compiler specific trick. I don&#39;t think you can do it otherwise. But as  Vittorio Romeo suggested, this could be a XY problem. Why do you need this? There could be a better way to solve your original problem."}, {"owner": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "edited": false, "score": 0, "creation_date": 1505300074, "post_id": 46195465, "comment_id": 79353568, "body": "Yep, in general, detect the given type has any base, dont like the std::is_base_of where i must give 2 types and the trait returns is the X inherits Y."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1505300242, "post_id": 46195465, "comment_id": 79353695, "body": "@Nyufu the question is what do you need this for? How would you use it? If we know the problem you are trying to solve we could maybe offer viable alternatives, which in fact could be better solution even if you could do what you are asking for. Or is this a philosophical question?"}, {"owner": {"reputation": 949, "user_id": 6730520, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fe891db9556b2dc7ef69c7e3f4cd9942?s=128&d=identicon&r=PG&f=1", "display_name": "Eyal K.", "link": "https://stackoverflow.com/users/6730520/eyal-k"}, "edited": false, "score": 0, "creation_date": 1505300439, "post_id": 46195465, "comment_id": 79353817, "body": "You can hack around this by having a <code>bool</code> that is set to <code>true</code> in the base and <code>false</code> in the derived classes. However, this does require you to do it manually. There are proposals to add reflection to C++, but I doubt it will be in C++17"}, {"owner": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "edited": false, "score": 0, "creation_date": 1505300550, "post_id": 46195465, "comment_id": 79353897, "body": "Why is need this? Because of in my library I need to detect  is the given type is c++03 POD, and my solution has worked until C++ 17, where changed the aggregate rule, and the type can be aggregate even if has base class. And to make my is_cpp03 pod working again i need to detect the type has any kind of base class/struct."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 4, "creation_date": 1505300657, "post_id": 46195465, "comment_id": 79353961, "body": "There are a couple of things that come close, <code>std::is_trivial</code>, or <code>std::is_aggregate</code>. But what exactly is the problem are you trying to solve. No, not the one about figuring out whether a class has any base classes. But whatever problem to which you believe the solution involves determining whether a class has any base classes."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1505300931, "post_id": 46195465, "comment_id": 79354117, "body": "Isn&#39;t <code>std::is_pod</code> what you are after, really? Why should a base matter, so long as it&#39;s compatible with any C datatypes?"}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1505308877, "post_id": 46195465, "comment_id": 79359952, "body": "It&#39;s nice of them to specify that <code>std::is_pod</code> doesn&#39;t work, but it would be easier for everyone if they actually provided a solution which does :("}], "answers": [{"comments": [{"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 0, "creation_date": 1505302990, "post_id": 46196397, "comment_id": 79355571, "body": "std::is_base_of"}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 9, "last_activity_date": 1505302193, "creation_date": 1505302193, "answer_id": 46196397, "question_id": 46195465, "link": "https://stackoverflow.com/questions/46195465/with-c17-is-it-possible-to-detect-if-a-struct-class-has-any-base/46196397#46196397", "title": "With C++17 is it possible to detect if a struct/class has any base?", "body": "<p>I believe that checking if \"<code>T</code> derives from anything\" is not possible, at least not in a standard-compliant way. If you are using this technique to check whether or not a type is a POD/trivial/aggregate, there are some type traits that might help you:</p>\n\n<ul>\n<li><p><a href=\"http://en.cppreference.com/w/cpp/types/is_pod\" rel=\"noreferrer\"><code>std::is_pod</code></a></p></li>\n<li><p><a href=\"http://en.cppreference.com/w/cpp/types/is_trivial\" rel=\"noreferrer\"><code>std::is_trivial</code></a></p></li>\n<li><p><a href=\"http://en.cppreference.com/w/cpp/types/is_aggregate\" rel=\"noreferrer\"><code>std::is_aggregate</code></a></p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 699, "user_id": 2715978, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7d5b299575be3c02edbc2fca9e2e0da9?s=128&d=identicon&r=PG&f=1", "display_name": "gu1d0", "link": "https://stackoverflow.com/users/2715978/gu1d0"}, "edited": false, "score": 4, "creation_date": 1505307775, "post_id": 46196936, "comment_id": 79359083, "body": "if I had a class like <code>class E { E(B&amp;) { }  };</code> I fear has_any_base_v would say true"}, {"owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 699, "user_id": 2715978, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7d5b299575be3c02edbc2fca9e2e0da9?s=128&d=identicon&r=PG&f=1", "display_name": "gu1d0", "link": "https://stackoverflow.com/users/2715978/gu1d0"}, "edited": false, "score": 1, "creation_date": 1505310993, "post_id": 46196936, "comment_id": 79361617, "body": "@gu1d0 oh yeah, I forgot that <code>std::is_base_of</code> says that a class is its own base. Fixed to permit proper bases only. Thanks!"}, {"owner": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "reply_to_user": {"reputation": 699, "user_id": 2715978, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7d5b299575be3c02edbc2fca9e2e0da9?s=128&d=identicon&r=PG&f=1", "display_name": "gu1d0", "link": "https://stackoverflow.com/users/2715978/gu1d0"}, "edited": false, "score": 0, "creation_date": 1505311325, "post_id": 46196936, "comment_id": 79361853, "body": "@gu1d0 yep, but if  the E has any constructor  then it isn&#39;t trivial therefore  isn&#39;t aggregate. ecatmur wrote this solution works &quot;at least for aggregates&quot;.  This will be part of my C++03 POD detection trait, therefore this solution is sufficient for me. <code>template&lt;class T&gt; struct is_cpp03_pod : std::bool_constant&lt;std::is_trivial_v&lt;T&gt; &amp;&amp; std::is_aggregate_v&lt;T&gt; &amp;&amp; !has_any_base_v&lt;T&gt;&gt; {};</code>"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1505311447, "post_id": 46196936, "comment_id": 79361928, "body": "At least for aggregates... in which all of the subobjects after the first base class are default-constructible :)"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "edited": false, "score": 0, "creation_date": 1505311858, "post_id": 46196936, "comment_id": 79362199, "body": "@Nyufu How about <code>struct D { B b; };</code>?"}, {"owner": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1505312584, "post_id": 46196936, "comment_id": 79362785, "body": "@T.C. according the <a href=\"http://en.cppreference.com/w/cpp/concept/PODType\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/concept/PODType</a> &quot;has no non-static members that are non-POD&quot;, so if the B is c++03 POD the D also will be POD. <a href=\"https://godbolt.org/g/JMSBX6\" rel=\"nofollow noreferrer\">Example</a>"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "edited": false, "score": 0, "creation_date": 1505322967, "post_id": 46196936, "comment_id": 79369669, "body": "@Nyufu I&#39;m talking about your own <code>B</code> in the question. What does your <code>is_c++03_pod</code> say for <code>D</code>? What should it say?"}, {"owner": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1505329139, "post_id": 46196936, "comment_id": 79373179, "body": "@T.C. Nice catch, and the answer is confusing me. Theoretically the D is non-POD. The B is non-POD because has base, and one of the D&#39;s member (b) non-POD therefore the D also. this is the theory. But according the msvc&#39;s <a href=\"https://godbolt.org/g/Z5S4E9\" rel=\"nofollow noreferrer\">generated code</a> in this case the D is POD because the main in the example code doesn&#39;t give the address of ret through RCX, but if you swap the func header,  the func expect the NRVO address in the RCX. That means according the msvc the D is POD and the B isn&#39;t. That&#39;s confusing. IDK, maybe something wrong in the msvc or in the documentation."}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1505337088, "post_id": 46196936, "comment_id": 79377175, "body": "Uhh, I don&#39;t understand this. If it&#39;s a derived class then it&#39;s not an aggregate in the first place, right?"}, {"owner": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "reply_to_user": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1505375995, "post_id": 46196936, "comment_id": 79389919, "body": "@Mehrdad Yes, you rigth. And i dont know, maybe i should write a mail for the microsoft to specify better the rules."}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "edited": false, "score": 0, "creation_date": 1505376595, "post_id": 46196936, "comment_id": 79390262, "body": "@Nyufu: It&#39;s weird that you accepted this answer if you also understand why it doesn&#39;t make sense... I&#39;d have accepted the other one."}, {"owner": {"reputation": 591, "user_id": 1102294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878405ef25b8837f7d15b1b2dc0e8265?s=128&d=identicon&r=PG", "display_name": "Jonathan O&#39;Connor", "link": "https://stackoverflow.com/users/1102294/jonathan-oconnor"}, "edited": false, "score": 0, "creation_date": 1505475086, "post_id": 46196936, "comment_id": 79440362, "body": "So, operator T() = delete is used to disallow conversion to itself. Neat."}], "tags": [], "owner": {"reputation": 137021, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "is_accepted": true, "score": 32, "last_activity_date": 1505310979, "last_edit_date": 1505310979, "creation_date": 1505303836, "answer_id": 46196936, "question_id": 46195465, "link": "https://stackoverflow.com/questions/46195465/with-c17-is-it-possible-to-detect-if-a-struct-class-has-any-base/46196936#46196936", "title": "With C++17 is it possible to detect if a struct/class has any base?", "body": "<p>Yes, this is possible, at least for aggregates.</p>\n\n<p>First we construct a class template that is convertible to any proper base of its template parameter:</p>\n\n<pre><code>template&lt;class T&gt;\nstruct any_base {\n    operator T() = delete;\n    template&lt;class U, class = std::enable_if_t&lt;std::is_base_of_v&lt;U, T&gt;&gt;&gt; operator U();\n};\n</code></pre>\n\n<p>Then we detect whether a template parameter <code>T</code> is aggregate constructible from a value of type <code>any_base&lt;T&gt;</code>:</p>\n\n<pre><code>template&lt;class, class = void&gt; struct has_any_base : std::false_type {};\ntemplate&lt;class T&gt;\nstruct has_any_base&lt;T, std::void_t&lt;decltype(T{any_base&lt;T&gt;{}})&gt;&gt; : std::true_type {};\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/pG5RXq\" rel=\"noreferrer\">Example</a>.</p>\n"}], "owner": {"reputation": 339, "user_id": 2471710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUiGc.jpg?s=128&g=1", "display_name": "Nyufu", "link": "https://stackoverflow.com/users/2471710/nyufu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3178, "favorite_count": 6, "accepted_answer_id": 46196936, "answer_count": 2, "score": 36, "last_activity_date": 1505398970, "creation_date": 1505299551, "last_edit_date": 1505398970, "question_id": 46195465, "link": "https://stackoverflow.com/questions/46195465/with-c17-is-it-possible-to-detect-if-a-struct-class-has-any-base", "title": "With C++17 is it possible to detect if a struct/class has any base?", "body": "<p>I need a type trait which will be true if the given type derives from anything, and false otherwise.</p>\n\n<p>For example:</p>\n\n<pre><code>template&lt;class T&gt;\nstruct is_inherit\n    //... logic of inheritance detection\n    ;\n\ntemplate&lt;class T&gt;\nvoid AppLogic(){\n    if constexpr(is_inherit&lt;T&gt;::value) {\n        puts(\"T has base\");\n        //...\n    } else {\n        puts(\"T doesn't have base\");\n        //...\n    }\n}\n\nstruct A {};\nstruct C {};\nstruct B: C {};\n\nint main() {\n    AppLogic&lt;A&gt;(); // print: T doesn't have base \n    AppLogic&lt;B&gt;(); // print: T has base\n}\n</code></pre>\n\n<p>Is it possible to somehow implement that \"is_inherit\" trait struct?</p>\n\n<hr>\n\n<p>Why?</p>\n\n<p>I am developing a manual stack frame builder for Windows x64. According the <a href=\"https://docs.microsoft.com/en-us/cpp/build/return-values-cpp\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/cpp/build/return-values-cpp</a> documentation, if a type:</p>\n\n<ul>\n<li>has a length of 1, 2, 4, 8, 16, 32, or 64 bits;</li>\n<li>has no user-defined constructor, destructor, or copy assignment operator;</li>\n<li>has no private or protected non-static data members;</li>\n<li>has no non-static data members of reference type;</li>\n<li>has no base classes;</li>\n<li>has no virtual functions;</li>\n<li>and has no data members that do not also meet these requirements;</li>\n</ul>\n\n<p>then its return value is in the RAX register, otherwise the function\nhas a hidden argument that I must detect and handle.</p>\n\n<p>This used to be the definition of a C++03 POD, however in C++11 this changed:</p>\n\n<blockquote>\n  <p>Because the definition has changed in the C++11 standard, we do not recommend using <code>std::is_pod</code> for this test.</p>\n</blockquote>\n\n<p>Up until now, with some conjugated traits I could detect if the type met the definition of a C++03 POD or not. However with C++17 the aggregate rules have changed, and that broke my solution.</p>\n\n<p>If I can somehow detect whether a type T has any base class, my solution will work again.</p>\n"}, {"tags": ["c++", "v8", "mmap"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1505298686, "post_id": 46194987, "comment_id": 79352587, "body": "Your code is no valid C but it is C++. C and C++ are different languages. Please use correct language tag."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505298966, "post_id": 46194987, "comment_id": 79352778, "body": "Don&#39;t spam tags and get the text right. You used a very different language! And this is not related to JS either."}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505299728, "post_id": 46194987, "comment_id": 79353299, "body": "@olaf This <i>does</i> have to do with JS as it&#39;s the V8 javascript engine."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1505299943, "post_id": 46194987, "comment_id": 79353483, "body": "@Qix: Not the language, but the framework. But I&#39;m fine with tagging the engine. I was not aware which one it was and a bit upset by another obviously wrongly tagged C++ question, so I left the node.js."}], "owner": {"reputation": 705, "user_id": 2824661, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c729d449a2941cd090ba3be630399db?s=128&d=identicon&r=PG", "display_name": "jugglingcats", "link": "https://stackoverflow.com/users/2824661/jugglingcats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505299702, "creation_date": 1505298153, "last_edit_date": 1505299702, "question_id": 46194987, "link": "https://stackoverflow.com/questions/46194987/simple-node-c-addon-for-memory-mapped-file-crashes-node", "title": "Simple node C addon for memory mapped file crashes node", "body": "<p>My goal is to create a simple addon that opens a memory mapped file and gives node raw access to the buffer. The memory mapped file already exists so I don't need to create a new file -- error will be thrown if file not already created (by another process).</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>#include &lt;nan.h&gt;\n#include &lt;windows.h&gt;\n\nusing namespace v8;\n\nvoid get_shm(const Nan::FunctionCallbackInfo &lt;v8::Value&gt; &amp;info) {\n    if (info.Length() != 1) {\n        return Nan::ThrowTypeError(\"Wrong number of arguments. You must specify size of mapped file!\");\n    }\n\n    if (!info[0]-&gt;IsNumber()) {\n        return Nan::ThrowTypeError(\"Bad argument. Size of mapped file must be a number!\");\n    }\n\n    int len = info[0]-&gt;Uint32Value();\n\n    HANDLE h = OpenFileMappingA(FILE_MAP_WRITE | FILE_MAP_READ, 1, \"Global\\\\_GB_SharedMemory_Read\");\n    if (h == NULL) {\n        Nan::ThrowTypeError(\"Couldn't open memory mapped file\");\n    }\n\n    char *buf = (char *) MapViewOfFile(h, FILE_MAP_WRITE | FILE_MAP_READ, 0, 0, len);\n\n    Nan::MaybeLocal&lt;Object&gt; jsbuf = Nan::NewBuffer(buf, len);\n    info.GetReturnValue().Set(jsbuf.ToLocalChecked());\n}\n\nvoid Init(v8::Local &lt;v8::Object&gt; exports) {\n    exports-&gt;Set(Nan::New(\"get_shm\").ToLocalChecked(), \n       Nan::New&lt;v8::FunctionTemplate&gt;(get_shm)-&gt;GetFunction());\n}\n\nNODE_MODULE(addon_shm, Init)\n</code></pre>\n\n<p>Unfortunately node is crashing (presumably due to access violation) at some point after the NewBuffer is returned. It doesn't crash immediately but some unpredictable time after.</p>\n\n<p>I'm not attempting to read/write from the buffer in Javascript. The only line using the add on is this:</p>\n\n<pre><code>const buf=shm.get_shm(10);\n</code></pre>\n\n<p>Mapped file created by the other process is bigger than 10.</p>\n\n<p>If I use malloc to create the buffer, problem doesn't occur.</p>\n\n<p>If I just call get_shm(10) without storing the result, problem doesn't occur.</p>\n\n<p>Struggling to understand the issue...</p>\n"}, {"tags": ["c++", "dll", "atl"], "comments": [{"owner": {"reputation": 302, "user_id": 5917770, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1067479839989518/picture?type=large", "display_name": "Kapil Dhaimade", "link": "https://stackoverflow.com/users/5917770/kapil-dhaimade"}, "edited": false, "score": 0, "creation_date": 1505301805, "post_id": 46194815, "comment_id": 79354715, "body": "The first parameter to <code>CoCreateInstance()</code> is supposed to be the CoClass ID (CLSID) of the CoClass we want an instance of. You seem to be passing it an Interface ID (IID) of your interface <code>ICBSNullRenderer</code>. Isn&#39;t there a CoClass like <code>CCBSNullRendered</code> you want to get an instance of?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1505301847, "post_id": 46194815, "comment_id": 79354737, "body": "What does the log show for the result of the 2 calls to <code>CoCreateInstance</code> ?"}, {"owner": {"reputation": 119, "user_id": 8537240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eb88b6d02c3b0693b8fcc9781cf30b3?s=128&d=identicon&r=PG&f=1", "display_name": "Kasper Ingdahl Andkj&#230;r", "link": "https://stackoverflow.com/users/8537240/kasper-ingdahl-andkj%c3%a6r"}, "reply_to_user": {"reputation": 302, "user_id": 5917770, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1067479839989518/picture?type=large", "display_name": "Kapil Dhaimade", "link": "https://stackoverflow.com/users/5917770/kapil-dhaimade"}, "edited": false, "score": 0, "creation_date": 1505303382, "post_id": 46194815, "comment_id": 79355840, "body": "@KapilDhaimade Apologies, that was an error on my part of writing the question. What you suggests has been done to no effect."}, {"owner": {"reputation": 119, "user_id": 8537240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eb88b6d02c3b0693b8fcc9781cf30b3?s=128&d=identicon&r=PG&f=1", "display_name": "Kasper Ingdahl Andkj&#230;r", "link": "https://stackoverflow.com/users/8537240/kasper-ingdahl-andkj%c3%a6r"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1505303389, "post_id": 46194815, "comment_id": 79355846, "body": "@RichardCritten The first returns S_OK and the second returns a DISP_E_BADVARTYPE both from winerr.h."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1505479999, "post_id": 46194815, "comment_id": 79443593, "body": "<code>HRESULT res = CoCreateInstance(..., __uuidof(IDispatch), (void**)&amp;m_pRenderer);</code> That&#39;s illegal. You are asking for <code>IDispatch*</code> pointer, but you store it in a variable of a type other than <code>IDispatch*</code>. In effect, you retrieve <code>IDispatch*</code> pointer and then <code>reinterpret_cast</code> it to another type. Either pass the actual <code>IID</code> of the interface you want; or retrieve the pointer into an <code>IDispatch*</code> variable and then <code>QueryInterface</code> for the interface you actually want."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1505480342, "post_id": 46194815, "comment_id": 79443838, "body": "You say the second <code>CoCreateInstance</code> call failed. What&#39;s the numeric value of <code>res2</code>? <code>DISP_E_BADVARTYPE</code> seems unlikely, you might be mis-interpreting the value. <code>E_NOINTERFACE</code> is more likely, and would mean that the type library describing <code>ICBSNullRenderer</code> was not registered."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 8537240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eb88b6d02c3b0693b8fcc9781cf30b3?s=128&d=identicon&r=PG&f=1", "display_name": "Kasper Ingdahl Andkj&#230;r", "link": "https://stackoverflow.com/users/8537240/kasper-ingdahl-andkj%c3%a6r"}, "is_accepted": false, "score": -1, "last_activity_date": 1576508877, "last_edit_date": 1576508877, "creation_date": 1505828602, "answer_id": 46302119, "question_id": 46194815, "link": "https://stackoverflow.com/questions/46194815/atl-structures-break-on-com-objects-from-dll/46302119#46302119", "title": "ATL structures break on COM objects from dll", "body": "<p>So, I solved the problem. Apparently properly calling a dll-function in my program requires that '<em>Common Language Runtime Support</em>' is turned off and that '<em>Whole Program Optimization</em>' is set to '<em>Use Link Time Code Generation</em>'</p>\n"}], "owner": {"reputation": 119, "user_id": 8537240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eb88b6d02c3b0693b8fcc9781cf30b3?s=128&d=identicon&r=PG&f=1", "display_name": "Kasper Ingdahl Andkj&#230;r", "link": "https://stackoverflow.com/users/8537240/kasper-ingdahl-andkj%c3%a6r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576508877, "creation_date": 1505297684, "last_edit_date": 1505302979, "question_id": 46194815, "link": "https://stackoverflow.com/questions/46194815/atl-structures-break-on-com-objects-from-dll", "title": "ATL structures break on COM objects from dll", "body": "<p>So, we are currently upgrading an ancient program from visual studio 2008 (where everything works) to 2017. We use a dll, whose classes the application connects to through ATL and a project-dependency.</p>\n\n<p>Unfortunately all attempts at calling functions from these classes return exceptions, presumably because it can't find them. </p>\n\n<p>The dll's classes are successfully added to the registry through regedit when built, and the uuids correspond correctly with the registered values. The classes can also be found in the OLE/COM-viewer.</p>\n\n<p>It also only breaks when attempting to call from one of our classes. An attempt to call functions from IDispatch, which the classes in question inherits from, worked correctly.</p>\n\n<p>In the below code the first attempt 'm_pRenderer' throws the exception. The second attempt 'test2' does not enter it's if-statement as CoCreateInstance returns a bad variable type-error </p>\n\n<pre><code>HRESULT res = CoCreateInstance(__uuidof(CBSNullRenderer), NULL, CLSCTX_INPROC_SERVER, __uuidof(IDispatch), (void**)&amp;m_pRenderer);\nLog(\"\\nCreateInstance: %ld\", res);\n\nICBSNullRendererPtr test2 = NULL;\n\nHRESULT res2 = CoCreateInstance(__uuidof(CBSNullRenderer), NULL, CLSCTX_INPROC_SERVER, __uuidof(ICBSNullRenderer), (void**)&amp;test2);\nLog(\"\\nres2: %ld\", res2);\n\n\nwireHWND mainHwnd = (wireHWND)GetParent(p_hWnd);\n\nif(mainHwnd == NULL)\n    Log(\"\\nWARNING mainHWND is NULL!\");\n\ntry {\n    if (test2)\n    {\n        Log(\"\\nDid create NullRenderer!\");\n        test2-&gt;SetMainWnd(mainHwnd);\n    }\n    if (m_pRenderer)\n    {\n        Log(\"\\nDid create NullRenderer!\");\n        m_pRenderer-&gt;SetMainWnd(mainHwnd);\n    }\n}\ncatch (...)\n{\n\n}\n</code></pre>\n\n<p>Which breaks on line 2 for m_pRenderer for:</p>\n\n<pre><code>inline HRESULT ICBSNullRenderer::SetMainWnd ( wireHWND hwnd ) {\n    HRESULT _hr = raw_SetMainWnd(hwnd);\n\n    if (FAILED(_hr)) _com_issue_errorex(_hr, this, __uuidof(this));\n        return _hr;\n}\n</code></pre>\n\n<p>In the dll's .tli file.</p>\n\n<p>The error creates an \"Exception Thrown\" dialog with the following:</p>\n\n<blockquote>\n  <p>Exception thrown at 0x00007FF9153ED7F2 (oleaut32.dll) in\n  AnimgramPro.exe: 0xC0000005: Access violation executing location\n  0x00007FF9153ED7F2</p>\n</blockquote>\n\n<p>We also attempted to use QueryInterface on the m_pRenderer with the nullrenderer's uuid. This ended in another bad variable type-error.</p>\n\n<p>Any advice or information of the errors which could be associated would be greatly appreciated.</p>\n"}, {"tags": ["c++", "opencv", "aruco"], "answers": [{"tags": [], "owner": {"reputation": 1235, "user_id": 8602076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6POo.png?s=128&g=1", "display_name": "Piotr Sieka\u0144ski", "link": "https://stackoverflow.com/users/8602076/piotr-sieka%c5%84ski"}, "is_accepted": true, "score": 1, "last_activity_date": 1505389635, "creation_date": 1505389635, "answer_id": 46218278, "question_id": 46194768, "link": "https://stackoverflow.com/questions/46194768/opencv-aruco-markers-are-not-recognized-on-industrial-cameras/46218278#46218278", "title": "OpenCV Aruco Markers are not recognized on industrial cameras", "body": "<p>The problem is solved. I have to flip the image and now markers are detected flawlessly. </p>\n"}, {"tags": [], "owner": {"reputation": 543, "user_id": 1105371, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ed7f8913d273514c5504b380d6d0326?s=128&d=identicon&r=PG", "display_name": "Joker", "link": "https://stackoverflow.com/users/1105371/joker"}, "is_accepted": false, "score": 0, "last_activity_date": 1576761016, "creation_date": 1576761016, "answer_id": 59410470, "question_id": 46194768, "link": "https://stackoverflow.com/questions/46194768/opencv-aruco-markers-are-not-recognized-on-industrial-cameras/59410470#59410470", "title": "OpenCV Aruco Markers are not recognized on industrial cameras", "body": "<p>Yes, flip the image in the x-direction will solve it.</p>\n\n<pre><code>opencv cv::flip(image, flippedImage, 1)\n</code></pre>\n"}], "owner": {"reputation": 1235, "user_id": 8602076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6POo.png?s=128&g=1", "display_name": "Piotr Sieka\u0144ski", "link": "https://stackoverflow.com/users/8602076/piotr-sieka%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 46218278, "answer_count": 2, "score": 1, "last_activity_date": 1576761016, "creation_date": 1505297514, "question_id": 46194768, "link": "https://stackoverflow.com/questions/46194768/opencv-aruco-markers-are-not-recognized-on-industrial-cameras", "title": "OpenCV Aruco Markers are not recognized on industrial cameras", "body": "<p>I'm working on detection of ARUCO markers on an industrial Automation Technology C2 cameras that are designed to detect laser fringe in triangulation scanner but they can also capture images.\nMy problem is that the same markers are detected regardless the camera I use except the one I mentioned earlier.\nMinimal working example of my code is below:</p>\n\n<pre><code>#include &lt;opencv2/highgui.hpp&gt;\n#include &lt;opencv2/aruco/charuco.hpp&gt;\n\nusing namespace std;\nusing namespace cv;\n\nint main(int argc, char *argv[]) {\n\nint squaresX = 10;\nint squaresY = 7;\nfloat squareLength = 28;\nfloat markerLength = 19;\nint dictionaryId = 6;\nbool showRejected = true;\nbool refindStrategy = true;\n\nPtr&lt;aruco::DetectorParameters&gt; detectorParams = aruco::DetectorParameters::create();\n\nPtr&lt;aruco::Dictionary&gt; dictionary =\n    aruco::getPredefinedDictionary(aruco::PREDEFINED_DICTIONARY_NAME(dictionaryId));\n\n// create charuco board object\nPtr&lt;aruco::CharucoBoard&gt; charucoboard =\n    aruco::CharucoBoard::create(squaresX, squaresY, squareLength, markerLength, dictionary);\nPtr&lt;aruco::Board&gt; board = charucoboard.staticCast&lt;aruco::Board&gt;();\n\nMat image = imread(\"C:\\\\Users\\\\Piotrek\\\\Desktop\\\\calib\\\\022.jpg\"), imageCopy;\n\nvector&lt; int &gt; markerIds, charucoIds;\nvector&lt; vector&lt; Point2f &gt; &gt; markerCorners, rejectedMarkers;\nvector&lt; Point2f &gt; charucoCorners;\n\n// detect markers\naruco::detectMarkers(image, dictionary, markerCorners, markerIds, detectorParams,\n    rejectedMarkers);\n\nimage.copyTo(imageCopy);\nif (markerIds.size() &gt; 0) {\n    aruco::drawDetectedMarkers(imageCopy, markerCorners);\n}\n\nif (showRejected &amp;&amp; rejectedMarkers.size() &gt; 0)\n    aruco::drawDetectedMarkers(imageCopy, rejectedMarkers, noArray(), Scalar(100, 0, 255));\n\n//display results\nimshow(\"out\", imageCopy);\nwaitKey(0);\n\nreturn 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/AhGH0.png\" rel=\"nofollow noreferrer\">Sample image from camera:</a></p>\n\n<p>The problem is that markers are detected but for unknown reason they are rejected:</p>\n\n<p><a href=\"https://i.stack.imgur.com/O7pJk.png\" rel=\"nofollow noreferrer\">Rejected markers</a></p>\n\n<p>I use OpenCV 3.1. </p>\n"}, {"tags": ["c++", "enums", "operator-overloading"], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1505298190, "last_edit_date": 1505298190, "creation_date": 1505297561, "answer_id": 46194781, "question_id": 46194734, "link": "https://stackoverflow.com/questions/46194734/operator-overloading-enum-class/46194781#46194781", "title": "Operator overloading enum class", "body": "<p>Nice question but your tremendously helpful compiler diagnostic tells you everything you need to know.</p>\n\n<p>You are missing the *bitwise AND assignment operator\" : <code>operator&amp;=</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1505297588, "post_id": 46194784, "comment_id": 79351760, "body": "Ha. I love your similar take to the answer I gave. Have an upvote."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1505297618, "post_id": 46194784, "comment_id": 79351784, "body": "@Bathsheba - Damn useful those compiler messages :)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1505297668, "post_id": 46194784, "comment_id": 79351818, "body": "Probably the most ignored text in the universe, and it must take the compiler writers so long to generate them. Why don&#39;t they just say &quot;error, innit&quot; and be done with it?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1505297726, "post_id": 46194784, "comment_id": 79351860, "body": "Or go back to 199x where a small mistake with a template procuded 2M of output"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1505297726, "post_id": 46194784, "comment_id": 79351861, "body": "@Bathsheba - I know! It often amazes me how insightful the diagnostics by Clang and GCC have become. More often than not there&#39;s a note saying &quot;maybe you meant this...&quot;."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1505298176, "post_id": 46194784, "comment_id": 79352240, "body": "@UKMonkey - That hasn&#39;t changed all that much, to be honest. Template error message (especially of the more clever templates) are as long as War and Peace."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1505298273, "post_id": 46194784, "comment_id": 79352312, "body": "@StoryTeller: And you don&#39;t get 80 pages on Freemasonry to trudge through."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1505313877, "last_edit_date": 1505313877, "creation_date": 1505297568, "answer_id": 46194784, "question_id": 46194734, "link": "https://stackoverflow.com/questions/46194734/operator-overloading-enum-class/46194784#46194784", "title": "Operator overloading enum class", "body": "<p>The compiler is telling exactly what's wrong. You didn't overload <code>&amp;=</code>.</p>\n\n<p>Despite the expected semantics, <code>&amp;=</code> doesn't automatically expand to <code>a = a &amp; Numbers::one;</code></p>\n\n<p>If you want to have both, the canonical way is to usually implement <code>op</code> in terms of <code>op=</code>. So your original function is adjusted as follows:</p>\n\n<pre><code>inline int&amp; operator &amp;=(int&amp; a, Numbers b)\n{ // Note the pass by reference\n    return (a &amp;= static_cast&lt;int&gt;(b));\n}\n</code></pre>\n\n<p>And the new one uses it:</p>\n\n<pre><code>inline int operator &amp;(int a, Numbers b)\n{ // Note the pass by value\n    return (a &amp;= b);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1346, "user_id": 7917910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75c481e1da6fee556c223936f4a23f83?s=128&d=identicon&r=PG&f=1", "display_name": "Martin B.", "link": "https://stackoverflow.com/users/7917910/martin-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1505297594, "creation_date": 1505297594, "answer_id": 46194792, "question_id": 46194734, "link": "https://stackoverflow.com/questions/46194734/operator-overloading-enum-class/46194792#46194792", "title": "Operator overloading enum class", "body": "<p>Yes you are overloading the operator <code>&amp;</code>. But then you are using the operator <code>&amp;=</code> which is a different one. Overload that too and you'll be fine.</p>\n"}], "owner": {"reputation": 135, "user_id": 3841542, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b61d112845bdb848271f42c78c64f31?s=128&d=identicon&r=PG&f=1", "display_name": "JOK", "link": "https://stackoverflow.com/users/3841542/jok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1548, "favorite_count": 0, "accepted_answer_id": 46194784, "answer_count": 3, "score": 3, "last_activity_date": 1505313877, "creation_date": 1505297430, "question_id": 46194734, "link": "https://stackoverflow.com/questions/46194734/operator-overloading-enum-class", "title": "Operator overloading enum class", "body": "<p>I'm trying to overload the <code>&amp;</code> operator of an enum class, but I'm getting this compiler error: error: no match for 'operator&amp;=' (operand types are 'int' and 'Numbers'). Any ideas about this?</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nenum class Numbers : int\n{\n    zero                    = 0, \n    one                     = 0x01,\n    two                     = 0x02\n};\n\ninline int operator &amp;(int a, Numbers b)\n{\n    return ((a) &amp; static_cast&lt;int&gt;(b));\n}\n\nint main() {\n    int a=1;\n    a&amp;=Numbers::one;\n    cout &lt;&lt; a ;\n    return 0;\n}\n</code></pre>\n"}]