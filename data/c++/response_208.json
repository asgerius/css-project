[{"tags": ["c++", "unique-ptr", "forward-declaration"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1546472017, "post_id": 54014531, "comment_id": 94866238, "body": "I&#39;m not sure what you mean by &quot;forward-declare&quot; here. <code>std::unique_ptr&lt;myStruct,mmap_deleter&gt; ptr;</code> is a definition, not just a declaration. Where exactly are you trying to put this line?"}, {"owner": {"reputation": 462, "user_id": 4068350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oJi3Pk7K-r8/AAAAAAAAAAI/AAAAAAAAAVk/Su6nDLc_WVM/photo.jpg?sz=128", "display_name": "aybassiouny", "link": "https://stackoverflow.com/users/4068350/aybassiouny"}, "edited": false, "score": 0, "creation_date": 1546472299, "post_id": 54014531, "comment_id": 94866303, "body": "Please split your code to .h and .cpp, fwd declaration does not really make sense in one cpp file. Code above compiles just fine."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1546474502, "post_id": 54014531, "comment_id": 94866759, "body": "Side-note: While <i>your</i> <code>struct myStruct</code> doesn&#39;t require any special actions during destruction, other types might; you explicitly invoke placement <code>new</code> to construct into the memory, but have no matching destructor invocation in <code>mmap_deleter</code>. Not good for reusability."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1546475145, "post_id": 54014531, "comment_id": 94866886, "body": "Where is the code that does not compile here?  I don&#39;t see <code>std::unique_ptr&lt;myStruct,mmap_deleter&gt; ptr;</code> in the code provided.  Am I right in thinking the code provided compiles?"}, {"owner": {"reputation": 303, "user_id": 9329592, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TiRxKNiMBQc/AAAAAAAAAAI/AAAAAAAAAEg/T1Y8kwlG-qA/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/9329592/rob"}, "edited": false, "score": 0, "creation_date": 1546506997, "post_id": 54014531, "comment_id": 94874673, "body": "I added my attempt at forward declaration. In the end I want it to go in the private: section of a class header so I can allocate and mmap shared memory once in the constructor rather than 4800 times per second in a member function which it would currently do in my application."}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 9329592, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TiRxKNiMBQc/AAAAAAAAAAI/AAAAAAAAAEg/T1Y8kwlG-qA/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/9329592/rob"}, "edited": false, "score": 1, "creation_date": 1546508487, "post_id": 54015441, "comment_id": 94875356, "body": "But how to declare ptr above main? Make it global in this example but really to be able use it as a private class member. In my application, myStruct is POD in special memory. Could be POSIX shared memory or a PCIe interface."}, {"owner": {"reputation": 4026, "user_id": 8414561, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa61454588bc140dada53391e1eb3c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Null", "link": "https://stackoverflow.com/users/8414561/dev-null"}, "reply_to_user": {"reputation": 303, "user_id": 9329592, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TiRxKNiMBQc/AAAAAAAAAAI/AAAAAAAAAEg/T1Y8kwlG-qA/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/9329592/rob"}, "edited": false, "score": 0, "creation_date": 1546510383, "post_id": 54015441, "comment_id": 94876368, "body": "@Rob I&#39;m not exactly sure what you are trying to do by &quot;declaring ptr&quot;, could you please elaborate?"}, {"owner": {"reputation": 303, "user_id": 9329592, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TiRxKNiMBQc/AAAAAAAAAAI/AAAAAAAAAEg/T1Y8kwlG-qA/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/9329592/rob"}, "edited": false, "score": 0, "creation_date": 1546525039, "post_id": 54015441, "comment_id": 94884265, "body": "I added an example using a raw pointer that illustrates what I want to do with smart pointers."}, {"owner": {"reputation": 303, "user_id": 9329592, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TiRxKNiMBQc/AAAAAAAAAAI/AAAAAAAAAEg/T1Y8kwlG-qA/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/9329592/rob"}, "edited": false, "score": 0, "creation_date": 1546636097, "post_id": 54015441, "comment_id": 94927673, "body": "This does what I asked for and provides enough of an understanding to expand this further meet my needs. Thank-you."}], "tags": [], "owner": {"reputation": 4026, "user_id": 8414561, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa61454588bc140dada53391e1eb3c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Null", "link": "https://stackoverflow.com/users/8414561/dev-null"}, "is_accepted": true, "score": 0, "last_activity_date": 1546662580, "last_edit_date": 1546662580, "creation_date": 1546480723, "answer_id": 54015441, "question_id": 54014531, "link": "https://stackoverflow.com/questions/54014531/how-to-forward-declare-custom-unique-ptr-for-shared-memory/54015441#54015441", "title": "How to forward declare custom unique_ptr for shared memory", "body": "<p>After some massaging your code does compile and work (I added some debug prints to demonstrate it), see the <a href=\"http://coliru.stacked-crooked.com/a/5358bd8e7800b3c4\" rel=\"nofollow noreferrer\">live example</a>. (Also, be aware that <code>mmap_deleter</code> doesn't call <code>obj</code>'s destructor, but it should).</p>\n\n<p>Given that you use C++14, I would suggest to remove <code>mmap_deleter</code> and simplify the code as follows:</p>\n\n<pre><code>template &lt;typename T&gt;\nusing unique_mapped_ptr = std::unique_ptr&lt;T, void(*)(T*)&gt;;\n\ntemplate&lt;typename T, typename ...Args&gt;\nunique_mapped_ptr&lt;T&gt; mmap_unique(Args... args)\n{\n    constexpr auto PROT_RW = PROT_READ | PROT_WRITE;\n    constexpr auto MAP_ALLOC = MAP_PRIVATE | MAP_ANONYMOUS;\n\n    if (auto ptr = mmap(0, sizeof(T), PROT_RW, MAP_ALLOC, -1, 0)) {\n        return {\n            new (ptr) T{args...},\n            [](T*p) {\n                p-&gt;~T();\n                munmap(p, sizeof(T));\n            }\n        };\n    }\n\n    throw std::bad_alloc();\n}\n</code></pre>\n\n<p>You can then use <code>unique_mapped_ptr&lt;myStruct&gt;</code> to define pointers to mmapped objects.</p>\n\n<p>See <a href=\"http://coliru.stacked-crooked.com/a/ee2ea1209de3000c\" rel=\"nofollow noreferrer\">the example with <code>myClass</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1546509370, "creation_date": 1546509370, "answer_id": 54019901, "question_id": 54014531, "link": "https://stackoverflow.com/questions/54014531/how-to-forward-declare-custom-unique-ptr-for-shared-memory/54019901#54019901", "title": "How to forward declare custom unique_ptr for shared memory", "body": "<p>The line</p>\n\n<pre><code>std::unique_ptr&lt;myStruct,mmap_deleter&gt; ptr;\n</code></pre>\n\n<p>tries to <em>default construct</em> a <code>mmap_deleter</code>, because that is a <em>definition</em> of an object. Your <code>size_t</code> constructor suppresses the compiler generated default (which is <em>good</em> for you here). </p>\n\n<p>You can instead provide it as a template parameter, which also allows you to apply <code>~T</code> to your objects as required.</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct mmap_deleter\n{\n    void operator()(T* ptr) const\n    {\n        ptr-&gt;~T();\n        munmap(ptr, sizeof(T));\n    }\n};\n\ntemplate&lt;typename T, typename... Args&gt;\nstd::unique_ptr&lt;T, mmap_deleter&lt;T&gt;&gt; mmap_unique(Args&amp;&amp;... args)\n{\n    if (auto ptr = mmap(0, sizeof(T), PROT_RW, MAP_ALLOC, -1, 0)) {\n\n        return { new (ptr) T(std::forward&lt;Args&gt;(args)...) };\n    }\n\n    throw std::bad_alloc();\n}\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 9329592, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TiRxKNiMBQc/AAAAAAAAAAI/AAAAAAAAAEg/T1Y8kwlG-qA/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/9329592/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 54015441, "answer_count": 2, "score": 0, "last_activity_date": 1546662580, "creation_date": 1546471747, "last_edit_date": 1546524957, "question_id": 54014531, "link": "https://stackoverflow.com/questions/54014531/how-to-forward-declare-custom-unique-ptr-for-shared-memory", "title": "How to forward declare custom unique_ptr for shared memory", "body": "<p>I've taken the example below from Dr. Rian Quinn's book \"Hands-On System Programming with C/C++\" modified just a bit. It wraps mmap with a unique_ptr{}. It works almost just like I need. I would like to forward declare the pointer to the mapped memory so I can use it as a private class member. My application is multi-task, each single-threaded, hard real-time with shared memory for cross-task communication. Dr. Quinn has a second example with shared memory that's a little longer than the one shown here but it this one illustrates the problem. The shm_open/mmap is relatively expensive time-wise. I need it to be done once during setup and have no idea how to go about it. I know how to do this with raw pointers. I'm using g++ 4.8.5.</p>\n\n<p>I've tried:</p>\n\n<pre><code>std::unique_ptr&lt;myStruct,mmap_deleter&gt; ptr;\n</code></pre>\n\n<p>Which results in:</p>\n\n<blockquote>\n<pre><code> /usr/include/c++/4.8.2/tuple:132:22: error: no matching function for call to \u2018mmap_deleter::mmap_deleter()\u2019\n   : _M_head_impl() { }\n</code></pre>\n</blockquote>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;iostream&gt;\n\n#include &lt;string.h&gt;\n#include &lt;sys/mman.h&gt;\n\nconstexpr auto PROT_RW = PROT_READ | PROT_WRITE;\nconstexpr auto MAP_ALLOC = MAP_PRIVATE | MAP_ANONYMOUS;\n\nclass mmap_deleter\n{\n    std::size_t m_size;\n\npublic:\n    mmap_deleter(std::size_t size) :\n        m_size{size}\n    { }\n\n    void operator()(void *ptr) const\n    {\n        munmap(ptr, m_size);\n    }\n};\n\ntemplate&lt;typename T&gt;\nauto mmap_unique()\n{\n    if (auto ptr = mmap(0, sizeof(T), PROT_RW, MAP_ALLOC, -1, 0)) {\n\n        auto obj = new (ptr) T(args...);\n        auto del = mmap_deleter(sizeof(T));\n\n        return std::unique_ptr&lt;T, mmap_deleter&gt;(obj, del);\n    }\n\n    throw std::bad_alloc();\n}\n\nstruct myStruct{\n    double foo;\n    double bar;\n};\n// Forward declare pointer, neither compiles\nstd::unique_ptr&lt;myStruct&gt; ptr;\n// or\n// std::unique_ptr&lt;myStruct,mmap_deleter&gt; ptr;\n\nint main()\n{\n    ptr = mmap_unique&lt;myStruct&gt;();\n    ptr-&gt;foo = 55.;\n    std::cout &lt;&lt; ptr-&gt;foo &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Here's a silly example that will compile and run that uses a raw pointer that illustrates what I want to do with a smart pointer.</p>\n\n<pre><code>// myClass.h\nclass myClass\n{\npublic:\n    myClass();\n    ~myClass();\n    int get_i();\n    int get_j();\nprivate:\n    void myFunc1();\n    void myFunc2();\n    void myFunc3();\n\n    struct myStruct{\n         int i;\n         int j;\n    };\n// FORWARD Declaration of ptr here!!!!!!!!!!!!!!!!!!!!!\n// I would like to use a smart pointer\n    myStruct* ptr_myStruct{nullptr};\n};\n#include &lt;sys/mman.h&gt;\n#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n#include &lt;cerrno&gt;\n//#include \"myClass.h\"\nmyClass::myClass(){\n   // Set the pointer to the mmap'ed address\n   ptr_myStruct = (myStruct*)mmap(NULL,sizeof(myStruct),PROT_READ|PROT_WRITE,MAP_SHARED|MAP_ANONYMOUS, -1, 0);\n   memset(ptr_myStruct,0,sizeof(myStruct));\n   // The three member functions use ptr_myStruct\n   myFunc1();\n   myFunc2();\n   myFunc3();\n}\n\nmyClass::~myClass(){\n   munmap(ptr_myStruct,sizeof(myStruct));\n   ptr_myStruct = nullptr;\n}\n\nvoid myClass::myFunc1(){\nptr_myStruct-&gt;i++;\n}\nvoid myClass::myFunc2(){\nptr_myStruct-&gt;j++;\n}\nvoid myClass::myFunc3(){\nptr_myStruct-&gt;i++;\n}\nint myClass::get_i(){return ptr_myStruct-&gt;i;}\nint myClass::get_j(){return ptr_myStruct-&gt;j;}\nint main(){\n  myClass a;\n  std::cout&lt;&lt; a.get_i()&lt;&lt;\"   \"&lt;&lt;a.get_j()&lt;&lt;\"\\n\";\n}\n</code></pre>\n"}, {"tags": ["c++", "gcc", "openmp"], "comments": [{"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546471868, "post_id": 54014391, "comment_id": 94866191, "body": "I put a fair amount of research into this question and it seems to concern a lot of people. Rather than anonymously, and unhelpfully, downvote, why not provide heads-up on what should be improved?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 4, "creation_date": 1546474138, "post_id": 54014391, "comment_id": 94866682, "body": "Not the downvoter, but it would be helpful if you included a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, enough to make what you believe is a self-contained, correct piece of code that <i>should</i> be compilable but isn&#39;t."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1546525008, "post_id": 54014391, "comment_id": 94884247, "body": "Fair does, I changed the question slightly."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1546525046, "post_id": 54014391, "comment_id": 94884273, "body": "Please give some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in your question. What actual C++ code have you compiled, and with what exact compilation command?"}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546525208, "post_id": 54014391, "comment_id": 94884373, "body": "will do in a moment though the second link has one, too."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1546533772, "post_id": 54014391, "comment_id": 94889130, "body": "@BasileStarynkevitch I have added the MWE. About the compiler, I use the -fopenmp flag and updated to the latest version of gcc. However, I use clion and cmake, so they&#39;re all a bit lengthy. The program compiles fine without the threadprivate directive."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546536534, "post_id": 54014391, "comment_id": 94890425, "body": "It would already be helpful if someone with an Intel compiler could compile this and see if it works, but I think I need some help on how to handle the instance as a private variable."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 2, "creation_date": 1546591138, "post_id": 54014391, "comment_id": 94906342, "body": "Could you explain why you want to preserve private variables between parallel regions? I usually can find a workaround for this and I almost never need thread private. Explain what you want to do."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546615307, "post_id": 54014391, "comment_id": 94918455, "body": "You&#39;re right, I don&#39;t need preservation between regions because there is only one. I&#39;m simply looking to make the instance &#39;production&#39; private rather than selected public variables because my class inherits from an optimiser class which has a call bfgsSolver(*this, param) which in turn calls a method of my class that uses public variables I know and could declare private manually. However given there is another invocation of the current instance via *this it is likely to use more public variables particular to the optimiser class. To be safe I therefore wish to make the whole instance private"}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546615482, "post_id": 54014391, "comment_id": 94918541, "body": "@Z boson further there is only one parallel for loop so yes I definitely don&#39;t need preservation but so far struggled with the private/first private constructs where entire instances are concerned. Threadprivate seemed easier were it not for gcc&#39;s lack of dynamic support. So if you could help me how to use the threadprivate functionality id much grateful. This question / answer would also then be a good workaround to point others to."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546648898, "post_id": 54014391, "comment_id": 94931250, "body": "Im sorry I meant to say &#39;to use the firstprivate functionality&#39; as it pertains to my instance as a workaround for threadprivate."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546649454, "post_id": 54014391, "comment_id": 94931328, "body": "Hm maybe to be clearer, I would like to have a parallel for loop within a method of my class that uses public/global variables. Moreover, my class inherits from a class <a href=\"https://github.com/PatWie/CppNumericalSolvers/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/PatWie/CppNumericalSolvers/blob/master/README.md</a> from which I use a method that invokes the current instance via *this. I am unsure about the thread-safety but know that thanks to my public variables, my method is not thread-safe for sure. Hence, Id like to make my whole instance private. @Z boson"}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 1, "creation_date": 1546698446, "post_id": 54014391, "comment_id": 94940068, "body": "Are you sure you don&#39;t mix-up the <code>private</code> from C++ which corresponds to &quot;visibility&quot; within the class hierarchy and the <code>private</code> from OpenMP which corresponds to be replicated on a per-thread basis? Both are completely orthogonal concepts. And so far, I really don&#39;t understand what&#39;s your problem and what you&#39;re trying to achieve..."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546699306, "post_id": 54014391, "comment_id": 94940304, "body": "I am pretty sure, yes. I could declare the public variables private to prevent other classes seeing them but the issue here is that my method &#39;carryout&#39; once operating on two or more concurrent threads will start reading from and writing to global variables. In the real implementation that I have, my class encapsulates an optimisation problem that computes starting values and an objective function value along with several intermediate results which I would like to repeat 100k or more times, in parallel. Each repetition or for loop execution would involve read/write access."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546699681, "post_id": 54014391, "comment_id": 94940431, "body": "to several variables that would then be treated as &#39;shared&#39; by default. So while starting values are written for thread a, thread b would get around to doing the same, overwrite them. Meanwhile thread a picks up the overwritten starting values instead of the proper ones... etc. and if this was one or two vars, I would say fine I will write it out, but there are about 30 plus those that come from the optimiser class itself which I don&#39;t even now (it&#39;s thousands of lines of code)."}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "reply_to_user": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1546699754, "post_id": 54014391, "comment_id": 94940446, "body": "Hence the need to declare the instance private, which if gcc did not have that lacking functionality would be a charm using threadprivate. As things stand, I am stuck with just &#39;private&#39; and don&#39;t know how to apply this to an instance when declaring private happens within one of the methods. I guess I could do it in &#39;main&#39; but using something like pragma omp single firstprivate(myinstance) and then include the omp pragma parallel for where applicable and be done? Anyhow, thanks for listening and any support. @Gilles"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1547316557, "post_id": 54014391, "comment_id": 95154710, "body": "A class cannot &quot;contain global variables&quot;; that literally makes no sense. I agree with Gilles - it&#39;s really hard to see what you&#39;re trying to ask here, and what problem you perceive that needs solving, sorry."}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1546799836, "post_id": 54054430, "comment_id": 94962510, "body": "Thanks for pointing this out. I might just bite the bullet and declare a laundry list of variables private for my one measly region."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": true, "score": 4, "last_activity_date": 1546709379, "creation_date": 1546709379, "answer_id": 54054430, "question_id": 54014391, "link": "https://stackoverflow.com/questions/54014391/class-declaring-itself-this-private-to-avoid-race-conditions-quest-for-thre/54054430#54054430", "title": "Class declaring itself (*this) private to avoid race conditions / quest for threadprivate in gcc abandoned", "body": "<p>This is a long-standing missing GCC feature:</p>\n\n<ul>\n<li><a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=27557\" rel=\"nofollow noreferrer\">OpenMP threadprivate directive does not work with non-POD types</a></li>\n</ul>\n\n<p>With current GCC versions, <code>thread_local</code> is expected to work, though:</p>\n\n<pre><code>int main() {\n  thread_local lotswork production(0);\n  production.carryout();\n}\n</code></pre>\n\n<p>However, I do not think this will work in your case because the parallel loop in <code>carryout</code> will still operate on a single <code>lotswork</code> instance.  I believe this would apply to the original code using <code>threadprivate</code>, too.  You probably need to move the parallel loop outside of the <code>carryout</code> member function.</p>\n"}, {"comments": [{"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1547214986, "post_id": 54141222, "comment_id": 95126857, "body": "&#39;default(firstprivate)&#39; won&#39;t work or at least CLion complains saying it&#39;s expecting &#39;none&#39; or &#39;shared.&#39; I shall read the OpenMP doc to see about your suggestion that &quot;it is possible to make private or firstprivate the default&quot;"}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1547215176, "post_id": 54141222, "comment_id": 95126968, "body": "soo I checked and what you say is true in general only for Fortran, see here <a href=\"https://computing.llnl.gov/tutorials/openMP/#DEFAULT\" rel=\"nofollow noreferrer\">computing.llnl.gov/tutorials/openMP/#DEFAULT</a>  although there is a mysterious note that &quot;[h]owever, actual implementations may provide this option.&quot;"}, {"owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1547215364, "post_id": 54141222, "comment_id": 95127061, "body": "Yup, won&#39;t compile and gives the error &quot;expected &#39;non&#39; or &#39;shared&#39; before &#39;firstprivate&#39;.&quot; I guess the good folks of LLNL are referring to custom-built versions of OpenMP?"}, {"owner": {"reputation": 852, "user_id": 2486527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acb06de48f6a07656b7189e46f0e131c?s=128&d=identicon&r=PG", "display_name": "Tom Scogland", "link": "https://stackoverflow.com/users/2486527/tom-scogland"}, "reply_to_user": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "edited": false, "score": 0, "creation_date": 1547268620, "post_id": 54141222, "comment_id": 95144232, "body": "You\u2019re quite right. Even those of us who help write the thing make these mistakes sometimes. Answer edited."}], "tags": [], "owner": {"reputation": 852, "user_id": 2486527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acb06de48f6a07656b7189e46f0e131c?s=128&d=identicon&r=PG", "display_name": "Tom Scogland", "link": "https://stackoverflow.com/users/2486527/tom-scogland"}, "is_accepted": false, "score": 4, "last_activity_date": 1547312897, "last_edit_date": 1547312897, "creation_date": 1547187112, "answer_id": 54141222, "question_id": 54014391, "link": "https://stackoverflow.com/questions/54014391/class-declaring-itself-this-private-to-avoid-race-conditions-quest-for-thre/54141222#54141222", "title": "Class declaring itself (*this) private to avoid race conditions / quest for threadprivate in gcc abandoned", "body": "<p>It seems like there is some confusion about OpenMP constructs here.  <code>threadprivate</code> is used, much like thread_local, to create a per-thread copy of an object of static lifetime, either a global or a static variable.  As noted, there are some implementation issues with this, but even if the implementations could handle the class, using <code>threadprivate</code> on a non-static local variable would produce an error.</p>\n\n<p>As to the error, it's hard to say without output, but it is likely multiple things:</p>\n\n<ol>\n<li>The unmatched closing brace.  Placing a <code>{</code> on the end of a pragma line does not open a block, it needs to be on the following line.</li>\n<li>It is not valid to privatize an enclosing class instance that way</li>\n</ol>\n\n<p>If you need to create a private copy of the enclosing class in each thread, it's possible by either copy-constructing the class into a variable declared inside a parallel region:</p>\n\n<pre><code>#pragma omp parallel\n{\n  lotswork tmp(*this);\n  // do things with private version\n}\n</code></pre>\n\n<p>Note however that the entire thing is private, so this means that <code>f</code> in the original copy will not be updated unless you perform the <code>addInt</code> equivalents all on the private copies then the <code>f[n]</code> assignments on the original. </p>\n\n<p>Edit: I originally mentioned using the <code>default(firstprivate)</code> clause, but the\ndefault clause only offers private and first private for FORTRAN. To get the\nsame effect in c++, do the above and copy construct into a new instance of each,\nor use a lambda with capture by value by default then firstprivate that, <code>*this</code>\nrequires c++17 to work, but does exactly what's requested:</p>\n\n<pre><code>auto fn = [=,*this](){\n  // do things with private copies\n  // all updates to persist in shared state through pointers\n};\n#pragma omp parallel firstprivate(fn)\nfn();\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 4470128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c6b3f8a151398253ec74bc93b409ad?s=128&d=identicon&r=PG&f=1", "display_name": "Hirek", "link": "https://stackoverflow.com/users/4470128/hirek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 1, "accepted_answer_id": 54054430, "answer_count": 2, "score": 10, "last_activity_date": 1547312897, "creation_date": 1546470828, "last_edit_date": 1546684944, "question_id": 54014391, "link": "https://stackoverflow.com/questions/54014391/class-declaring-itself-this-private-to-avoid-race-conditions-quest-for-thre", "title": "Class declaring itself (*this) private to avoid race conditions / quest for threadprivate in gcc abandoned", "body": "<p>I want to avoid a race condition in parallel code. The issue is that my class contains several global variables, let's say just one <code>x</code> for simplicity as well as a <code>for</code> loop that I wish to make parallel. The actual code also has a method that takes a pointer to a class, in this case itself, as its argument, accessing even more global variables. So it might make sense to make the entire instance <code>threadprivate.</code> I am using OpenMP. A MWE is</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;omp.h&gt;\nclass lotswork {\npublic:\n    int x;\n    int f[10];\n\n    lotswork(int i = 0) { x = i; };\n\n    void addInt(int y) { x = x + y; }\n\n    void carryout(){\n\n        #pragma omp parallel for\n        for (int n = 0; n &lt; 10; ++n) {\n            this-&gt;addInt(n);\n            f[n] = x;\n        }\n        for(int j=0;j&lt;10;++j){\n            std::cout &lt;&lt; \" array at \" &lt;&lt; j &lt;&lt; \" = \" &lt;&lt; f[j] &lt;&lt; std::endl;\n        }\n        std::cout &lt;&lt; \"End result = \" &lt;&lt; x &lt;&lt; std::endl;\n    }\n};\n\n\n\nint main() {\n    lotswork production(0);\n    #pragma omp threadprivate(production)\n    production.carryout();\n\n}\n</code></pre>\n\n<p>My question is, how can I do this? Using the keyword <code>threadprivate</code> returns the following compiler error message:\n <code>error: \u2018production\u2019 declared \u2018threadprivate\u2019 after first use</code> \nI think this compiler issue here still hasn't been <a href=\"https://stackoverflow.com/questions/32347008/confused-about-firstprivate-and-threadprivate-in-openmp-context/32347782#32347782\">solved</a>:</p>\n\n<blockquote>\n  <p>This brings us to why I used the Intel compiler. Visual Studio 2013 as\n  well as g++ (4.6.2 on my computer, Coliru (g++ v5.2), codingground\n  (g++ v4.9.2)) allow only POD types (source). This is listed as a bug\n  for almost a decade and still hasn't been fully addressed. The Visual\n  Studio error given is error C3057: 'globalClass' : dynamic\n  initialization of 'threadprivate' symbols is not currently supported\n  and the error given by g++ is error: 'globalClass' declared\n  'threadprivate' after first use The Intel compiler works with classes.</p>\n</blockquote>\n\n<p>Unfortunately, I haven't got access to Intel's compiler but use GCC 8.1.0. I did a bit of background research and found a discussion on this <a href=\"http://forum.openmp.org/forum/viewtopic.php?f=3&amp;t=552\" rel=\"noreferrer\">here</a>, but that trail runs cold, ten years ago. I am asking this question because several people have had issues with this and solved it either by declaring a class pointer as <a href=\"https://stackoverflow.com/questions/47475074/making-static-class-members-threadprivate-in-openmp\">here</a> or proposing terrible <a href=\"https://stackoverflow.com/questions/8051108/using-the-openmp-threadprivate-directive-on-static-instances-of-c-stl-types\">workarounds</a>. The latter approach seems misguided because a pointer is usually declared as a constant but then we have <code>threadprivate</code> pointers while the instance is still shared.</p>\n\n<h2>Attempt at solution</h2>\n\n<p>I believe I can use the <code>private</code> keyword but am unsure how to do this with an entire instance of a class although I'd prefer the <code>threadprivate</code> keyword. A similar example to mine above on which I modeled my MWE has also been discussed in Chapter 7, Figure 7.17 in <a href=\"https://mitpress.mit.edu/books/using-openmp\" rel=\"noreferrer\">this book</a>, but without solution. (I am well aware about the race condition and why it's a problem.)</p>\n\n<p>If necessary I can give evidence that the output of the above programme without any extra keywords is nondeterministic.</p>\n\n<h2>Another attempt at solution</h2>\n\n<p>I have now thought of a solution but for some reason, it won't compile. From a thread-safety and logical standpoint my problem should be solved by the following code. Yet, there must be some sort of error.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;omp.h&gt;\nclass lotswork : public baseclass {\npublic:\n    int x;\n    int f[10];\n\n    lotswork(int i = 0) { x = i; };\n\n    void addInt(int y) { x = x + y; }\n\n        void carryout(){\n    //idea is to declare the instance private\n    #pragma omp parallel firstprivate(*this){\n    //here, another instance of the base class will be instantiated which is inside the parallel region and hence automatically private\n    baseclass&lt;lotswork&gt; solver;\n\n  #pragma omp for\n  for (int n = 0; n &lt; 10; ++n) \n      {\n          this-&gt;addInt(n);\n          f[n] = x;\n          solver.minimize(*this,someothervariablethatisprivate);\n      }\n                                             } //closing the pragma omp parallel region\n                for(int j=0;j&lt;10;++j){\n                    std::cout &lt;&lt; \" array at \" &lt;&lt; j &lt;&lt; \" = \" &lt;&lt; f[j] &lt;&lt; std::endl;\n                }\n                std::cout &lt;&lt; \"End result = \" &lt;&lt; x &lt;&lt; std::endl;\n            }\n        };\n\n\n\n    int main() {\n        lotswork production(0);\n        #pragma omp threadprivate(production)\n        production.carryout();\n\n    }\n</code></pre>\n\n<p>So this code, based on the definitions, should do the trick but somehow it doesn't compile. Can someone help me put this code together so it achieves the desired thread-safety and compiles, respecting the constraint that threadprivate is not an option for non-Intel compiler folks? Thank you very much in advance for your help.</p>\n"}, {"tags": ["c++", "qt", "qml"], "comments": [{"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1546494356, "post_id": 54014320, "comment_id": 94870462, "body": "Probably you have some error in your costom component and so QML fails to create it."}, {"owner": {"reputation": 799, "user_id": 3304185, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0ce488b04da2d55abadef7a3afb9308c?s=128&d=identicon&r=PG&f=1", "display_name": "gpsugy", "link": "https://stackoverflow.com/users/3304185/gpsugy"}, "reply_to_user": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1546530438, "post_id": 54014320, "comment_id": 94887351, "body": "@folibis that unfortunately is not true. I have confirmed that the nested custom component renders just fine when I implement it entirely through QML."}, {"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1546533172, "post_id": 54014320, "comment_id": 94888826, "body": "Ok, it would be great if you can provide code of both components so we could test it."}, {"owner": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1546533299, "post_id": 54014320, "comment_id": 94888888, "body": "Btw, I&#39;ve just looked at the question. Do you really wrap one component with another one? How do you thing the inner one should be instantiated?"}, {"owner": {"reputation": 799, "user_id": 3304185, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0ce488b04da2d55abadef7a3afb9308c?s=128&d=identicon&r=PG&f=1", "display_name": "gpsugy", "link": "https://stackoverflow.com/users/3304185/gpsugy"}, "reply_to_user": {"reputation": 10381, "user_id": 2981610, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/BYsd3.jpg?s=128&g=1", "display_name": "folibis", "link": "https://stackoverflow.com/users/2981610/folibis"}, "edited": false, "score": 0, "creation_date": 1546550145, "post_id": 54014320, "comment_id": 94896126, "body": "Thanks for your help. I&#39;ve updated my entry to include the <code>CustomTextBox.qml</code> file, and modified the <code>CustomComponent.qml</code> accordingly. Can you also elaborate on what you mean by &quot;wrapping one component with another one?&quot; If you meant to ask if I need to, as of now, yet - because I am trying to dynamically set <code>sourceComponent</code> of QML&#39;s <code>Loader</code> component. As for your second question, do you mean how each newly generated Component through C++ should be instantiated? In the code I updated the entry with, I imagine a simple <code>setProperty</code> of <code>text</code> with metadata I have retrieved elsewhere."}], "owner": {"reputation": 799, "user_id": 3304185, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0ce488b04da2d55abadef7a3afb9308c?s=128&d=identicon&r=PG&f=1", "display_name": "gpsugy", "link": "https://stackoverflow.com/users/3304185/gpsugy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 640, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1546550010, "creation_date": 1546470213, "last_edit_date": 1546550010, "question_id": 54014320, "link": "https://stackoverflow.com/questions/54014320/creating-a-nested-custom-qml-component-component-in-a-c-class", "title": "Creating a Nested Custom QML Component `Component` in a C++ Class", "body": "<h2>The Problem</h2>\n\n<p>I am trying to create a QML Component (and by component, I mean a QML component of type <code>Component</code> that gets used by a <code>Loader</code>'s <code>sourceComponent</code> property) in a C++ class and pass it down to a QML File. I am using a <code>Loader</code> particularly to dynamically change a single area of the view based on user interaction with the UI elsewhere on that view. Here is how I am approaching the implementation:</p>\n\n<p><code>DynamicLoader.h</code></p>\n\n<pre><code>class DynamicLoader: public QQuickItem {\n    Q_OBJECT\n    Q_PROPERTY(QObject *mainComp READ getMainComp NOTIFY mainCompChanged)\n\npublic:\n    DynamicLoader(QQuickItem *parent = Q_NULLPTR);\n\n    QObject* getMainComp() const;\n\nprivate:\n    QObject* m_mainComp;\n\n    QObject* createComponent();\n\nsignals:\n    void mainCompChanged();\n\n};\n</code></pre>\n\n<p><code>DynamicLoader.cpp</code></p>\n\n<pre><code>DynamicLoader::DynamicLoader(QQuickItem* parent)\n    : QQuickItem(parent)\n    , m_mainComp(new QObject(this)) {\n    m_mainComp = createCustomComponent();\n}\n\nQObject *DynamicLoader::getMainComp() const {\n    return m_mainComp;\n}\n\nQObject* DynamicLoader::createComponent() {\n    QQmlEngine engine;\n\n    QQmlComponent component(&amp;engine,                     \n    QUrl::fromLocalFile(\"://imports/components/CustomComponent.qml\"));\n    QObject* object = component.create();\n    Q_ASSERT(object);\n\n    QQuickItem* childItem = qobject_cast&lt;QQuickItem*&gt;(object);\n    childItem-&gt;setParent(this);\n    return childItem;\n}\n</code></pre>\n\n<p><code>CustomComponent.qml</code></p>\n\n<pre><code>Component {\n    CustomTextBox {\n        text: \"Custom Text\"\n    }\n}\n</code></pre>\n\n<p><code>CustomTextBox.qml</code></p>\n\n<pre><code>import QtQuick 2.0\n\nItem {\n    property int containerWidth: 580\n    property alias text: customText.text\n\n    anchors.fill: parent\n\n    Text {\n        id: customText\n        text: \"Default Text\"\n        anchors.top: parent.top\n        anchors.horizontalCenter: parent.horizontalCenter\n        width: parent.width\n        verticalAlignment: Text.AlignVCenter\n        horizontalAlignment: Text.AlignHCenter\n        font.weight: Font.Bold\n        font.pointSize: 100\n        color: \"white\"\n    }\n}\n</code></pre>\n\n<p><strong>This, however, crashes the program with the following error message:</strong></p>\n\n<p><strong><code>QQmlComponent: Component is not ready</code></strong>, and fails at the <code>Q_ASSERT</code>.</p>\n\n<h2>Other Findings</h2>\n\n<p>This same error occurs even when <code>CustomComponent.qml</code> is changed to simply <code>Component {}</code>. When I discovered this, I suspected that perhaps <code>QQmlComponent</code> already wraps the QML file with a <code>Component</code> type (please correct me if I am wrong), so I went ahead and converted the file to:</p>\n\n<pre><code>Item {\n    CustomTextBox {\n        text: \"Custom Text\"\n    }\n}\n</code></pre>\n\n<p>and got the same error.</p>\n\n<p>Only when I change the file to the following does it not error out:</p>\n\n<pre><code>Item {\n    Item {\n    }\n}\n</code></pre>\n\n<p>Lastly, the error does not occur when I implement <code>CustomComponent.qml</code> entirely in QML.</p>\n\n<h2>Questions</h2>\n\n<ol>\n<li><p>Am I correct in thinking that declaring a QQmlComponent already wraps a QML file with the <code>Component</code> type? If not, how should I be creating a <code>Component</code> QML component in C++?</p></li>\n<li><p>Why does the program crash when I create a nested custom component? Do I need to create the component through other means?</p></li>\n</ol>\n\n<p><em>Any help and corrections to fundamental misconceptions would be greatly appreciated. Thank you.</em></p>\n"}, {"tags": ["c++", "stdtuple"], "comments": [{"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 1, "creation_date": 1546466804, "post_id": 54013777, "comment_id": 94864647, "body": "If you have access to C++17: <code>std::apply(foo, t);</code>"}, {"owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "reply_to_user": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1546467110, "post_id": 54013777, "comment_id": 94864761, "body": "@MilesBudnek I&#39;ve updated the question which adds an additional parameter to <code>foo</code> (other than the tuple elements) - <code>apply</code> would no longer work directly would it? I&#39;d have to capture the other parameter in a lambda first, and then pass that to <code>apply</code>?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 1, "creation_date": 1546467389, "post_id": 54013777, "comment_id": 94864856, "body": "That or make a tuple that contains all the arguments.  Perhaps <a href=\"https://en.cppreference.com/w/cpp/utility/tuple/tuple_cat\" rel=\"nofollow noreferrer\"><code>std::tuple_cat</code></a> is relevant?"}], "answers": [{"tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 2, "last_activity_date": 1546469413, "last_edit_date": 1546469413, "creation_date": 1546467814, "answer_id": 54013947, "question_id": 54013777, "link": "https://stackoverflow.com/questions/54013777/single-line-stdget-stdindex-sequence/54013947#54013947", "title": "single-line std::get std::index_sequence?", "body": "<p>If you don't want to or can't use <code>std::apply</code>, I can suggest a few alternatives.</p>\n\n<p>The snippets below are based on the previous revision of your question that didn't have the <code>class Bar</code> in it. The same solutions work for the new revision as well.</p>\n\n<p><strong>(1)</strong> You could replace <code>call_foo</code> with a C++20 lambda with an explicit template parameter list:</p>\n\n<pre><code>#include &lt;cstddef&gt;\n#include &lt;iostream&gt;\n#include &lt;tuple&gt;\n#include &lt;utility&gt;\n\ntemplate&lt;typename... Ts&gt;\nvoid foo(const std::string&amp; s, Ts... ts)\n{\n    std::cout &lt;&lt; \"foo called with \" &lt;&lt; s &lt;&lt; \" and \" &lt;&lt; sizeof...(Ts) &lt;&lt; \" ts\\n\";\n}\n\ntemplate&lt;typename... Ts&gt;\nvoid bar(Ts... ts)\n{\n    const std::string s = \"hello world\";\n    const auto t = std::make_tuple(ts...);\n\n    [&amp;]&lt;std::size_t ...I&gt;(std::index_sequence&lt;I...&gt;)\n    {\n        foo(s, std::get&lt;I&gt;(t)...);\n    }\n    (std::make_index_sequence&lt;std::tuple_size_v&lt;decltype(t)&gt;&gt;{});\n}\n\nint main()\n{\n    bar(1, 'a', 2.3);\n}\n</code></pre>\n\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/26bc2cce86367d59\" rel=\"nofollow noreferrer\">Try it live</a></kbd></p>\n\n<p>Unfortunately, GCC 8 currently seems to be the only major compiler that supports those.</p>\n\n<hr>\n\n<p><strong>(2)</strong> If your compiler doesn't have the new fancy lambdas, or you don't want to write the <code>index_sequence</code> boilerplate every time you need to expand the tuple, I suggest following:</p>\n\n<pre><code>#include &lt;cstddef&gt;\n#include &lt;iostream&gt;\n#include &lt;tuple&gt;\n#include &lt;utility&gt;\n\ntemplate &lt;std::size_t ...I, typename F&gt; void with_sequence_impl(F &amp;&amp;func, std::index_sequence&lt;I...&gt;)\n{\n    func(std::integral_constant&lt;std::size_t, I&gt;{}...);\n}\n\ntemplate &lt;std::size_t N, typename F&gt; void with_sequence(F &amp;&amp;func)\n{\n    with_sequence_impl(std::forward&lt;F&gt;(func), std::make_index_sequence&lt;N&gt;{});\n}\n\ntemplate&lt;typename... Ts&gt;\nvoid foo(const std::string&amp; s, Ts... ts)\n{\n    std::cout &lt;&lt; \"foo called with \" &lt;&lt; s &lt;&lt; \" and \" &lt;&lt; sizeof...(Ts) &lt;&lt; \" ts\\n\";\n}\n\ntemplate&lt;typename... Ts&gt;\nvoid bar(Ts... ts)\n{\n    const std::string s = \"hello world\";\n    const auto t = std::make_tuple(ts...);\n\n    with_sequence&lt;std::tuple_size_v&lt;decltype(t)&gt;&gt;([&amp;](auto ... i)\n    {\n        foo(s, std::get&lt;i.value&gt;(t)...);\n    });\n}\n\nint main()\n{\n    bar(1, 'a', 2.3);\n}\n</code></pre>\n\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/d3ca31868346e564\" rel=\"nofollow noreferrer\">Try it live</a></kbd></p>\n"}], "owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 54013947, "answer_count": 1, "score": 0, "last_activity_date": 1546469413, "creation_date": 1546466651, "last_edit_date": 1546468341, "question_id": 54013777, "link": "https://stackoverflow.com/questions/54013777/single-line-stdget-stdindex-sequence", "title": "single-line std::get std::index_sequence?", "body": "<p>I have a <code>std::tuple</code>, and I want to unwrap the contents using <code>std::index_sequence</code> in order to call a variadic function template</p>\n\n<p>Consider the following example code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;tuple&gt;\n\ntemplate&lt;typename... Ts&gt;\nvoid foo(const std::string&amp; s, Ts... ts)\n{\n    std::cout &lt;&lt; \"foo called with \" &lt;&lt; s &lt;&lt; \" and \" &lt;&lt; sizeof...(Ts) &lt;&lt; \" ts\\n\";\n}\n\ntemplate&lt;typename Tuple, std::size_t... Ixs&gt;\nvoid call_foo(const std::string&amp; s, Tuple&amp; t, std::index_sequence&lt;Ixs...&gt;)\n{\n    foo(s, std::get&lt;Ixs&gt;(t)...);\n}\n\ntemplate&lt;typename... Ts&gt;\nstruct Bar\n{\n    Bar(Ts... ts) : t(ts...)\n    { }\n\n    void do_it()\n    {\n        call_foo(\"hi\", t, std::make_index_sequence&lt;std::tuple_size&lt;decltype(t)&gt;::value&gt;{});\n    }\n\n    std::tuple&lt;Ts...&gt; t;\n};\n\ntemplate&lt;typename... Ts&gt; Bar&lt;Ts...&gt; make_bar(Ts... ts) { return Bar&lt;Ts...&gt;(ts...); }\n\nint main ()\n{\n    auto bar = make_bar(1, 'a', 2.3);\n    bar.do_it();\n}\n</code></pre>\n\n<p>Note that I have to call through <code>call_foo</code> with my <code>index_sequence</code> in order to <em>\"unwrap\"</em> the <code>index_sequence</code> for calling <code>std::get...</code></p>\n\n<p>Is it possible to forego the intermediate <code>call_foo</code> function, and call <code>foo</code> directly?</p>\n\n<p>That is, unwrap the tuple directly at the call-site?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1546464264, "post_id": 54013356, "comment_id": 94863676, "body": "These are <i>member function pointers</i>."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 9, "creation_date": 1546464430, "post_id": 54013356, "comment_id": 94863736, "body": "C (and C++) preprocessor macros are just parameterized text substitutions.  These lines of code are macro invocations, but the result of substitution has to be real C++ code."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1546464462, "post_id": 54013356, "comment_id": 94863754, "body": "They\u2019re not statements, they are macros that expand to a table declaration."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1546464496, "post_id": 54013356, "comment_id": 94863766, "body": "If you ask about <code>wxBEGIN_EVENT_TABLE</code> and <code>EVT_MENU</code>, those are most likely macros. Macros have their definitions somewhere and preprocessor (before compilation starts) will copy and paste those definitions in places of macro calls. Not a good practice usually."}], "answers": [{"tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": true, "score": 6, "last_activity_date": 1546465156, "last_edit_date": 1546465156, "creation_date": 1546464538, "answer_id": 54013408, "question_id": 54013356, "link": "https://stackoverflow.com/questions/54013356/what-kind-of-c-statements-is-the-wxwidgets-event-table/54013408#54013408", "title": "What kind of C++ statement(s) is the wxWidgets event table?", "body": "<ol>\n<li><p>You are correct.  <code>wxBEGIN_EVENT_TABLE</code> is an example of a \"macro\":</p></li>\n<li><p>So what's a \"macro\"?  Here's a reasonable definition:</p></li>\n</ol>\n\n<blockquote>\n  <p><a href=\"https://gcc.gnu.org/onlinedocs/cpp/Macros.html\" rel=\"noreferrer\">https://gcc.gnu.org/onlinedocs/cpp/Macros.html</a></p>\n  \n  <p>A macro is a fragment of code which has been given a name. Whenever\n  the name is used, it is replaced by the contents of the macro. There\n  are two kinds of macros. They differ mostly in what they look like\n  when they are used. Object-like macros resemble data objects when\n  used, function-like macros resemble function calls.</p>\n</blockquote>\n\n<ol start=\"3\">\n<li>In this case, <a href=\"https://docs.wxwidgets.org/3.0/group__group__funcmacro__events.html#ga383fad2a46e1d6c220fbe03ecfbc9c17\" rel=\"noreferrer\">wxBEGIN_EVENT_TABLE</a>, in conjunction with <a href=\"https://docs.wxwidgets.org/3.0/group__group__funcmacro__events.html#ga383fad2a46e1d6c220fbe03ecfbc9c17\" rel=\"noreferrer\">wxEND_EVENT_TABLE</a>, \"expands\" to a list of wx \"Event handlers\":</li>\n</ol>\n\n<blockquote>\n  <p><a href=\"https://docs.wxwidgets.org/3.0/group__group__funcmacro__events.html#\" rel=\"noreferrer\">https://docs.wxwidgets.org/3.0/group__group__funcmacro__events.html#</a></p>\n\n<pre><code>    #define wxBEGIN_EVENT_TABLE   (       theClass,\n          baseClass \n  )       \n</code></pre>\n  \n  <p>Use this macro in a source file to start listing static event handlers\n  for a specific class.</p>\n  \n  <p>Use wxEND_EVENT_TABLE() to terminate the event-declaration block.</p>\n</blockquote>\n\n<ol start=\"4\">\n<li><p>\"Macros\" were introduced in the very earliest assembly languages.  They simply do \"text substitution\" - modify the source code the actual compiler sees.  </p>\n\n<p>Macros (and the macro preprocessor) were an integral part of the original \"C\" language, carried forward into C++ (and many other high-level languages).</p>\n\n<p>You can read more about C/C++ macros here:</p>\n\n<p><a href=\"https://www.programiz.com/c-programming/c-preprocessor-macros\" rel=\"noreferrer\">https://www.programiz.com/c-programming/c-preprocessor-macros</a></p></li>\n</ol>\n\n<p>'Hope that helps </p>\n"}, {"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 2, "last_activity_date": 1546468616, "creation_date": 1546468616, "answer_id": 54014078, "question_id": 54013356, "link": "https://stackoverflow.com/questions/54013356/what-kind-of-c-statements-is-the-wxwidgets-event-table/54014078#54014078", "title": "What kind of C++ statement(s) is the wxWidgets event table?", "body": "<p>Event tables are normally some type of a <code>struct</code> which contains an event message identifier along with a pointer to the function that is to handle the event message.</p>\n\n<p>This type of data structure is fairly commonly used among a number of GUI frameworks. For instance the Microsoft MFC framework uses it.</p>\n\n<p>Event tables are actual data structures and are not part of the C++ programming language. You use C++ to define the event tables.</p>\n\n<p>Some of the parts needed to make this approach work are:</p>\n\n<ul>\n<li><p>a table structure to allow for searching for a message identifier to find its associated handler</p></li>\n<li><p>a way for the framework to find the event table so that it can use it to do the message identifier lookup and call the correct function with the correct interface</p></li>\n<li><p>a way to know the first and last entries in the event table</p></li>\n</ul>\n\n<p>A simple version of a framework table element when hand coded may look like the following. This would be an element that is used to create an array of event table elements, one per event message identifier.</p>\n\n<pre><code>typedef struct {\n    int  msgId;   // the identifier for the message type\n    void (*handler)(int msgId, void *msgData);   // function pointer to handler\n} SimpleEventTable;\n</code></pre>\n\n<p>An incomplete example of this being used in source code without macros would be something along the lines of the following. In this example MSG_ID_ONE and MSG_ID_TWO are defined with <code>int</code> values while <code>handler1</code> and <code>handler2</code> are functions that will handle those messages:</p>\n\n<pre><code>void handler1 (int msgId, void *msgData)\n{\n    // do things with the data associated with message identifier MSG_ID_ONE\n}\n\nvoid handler2 (int msgId, void *msgData)\n{\n    // do things with the data associated with message identifier MSG_ID_TWO\n}\n\nSimpleEventTable myTable[] = {\n    {MSG_ID_ONE, handler1},\n    {MSG_ID_TWO, handler2},\n    {0, NULL}\n};\n</code></pre>\n\n<p>The framework then uses the event table to determine if the code is handling a particular message identifier or not and if the application is handling the message identifier what function to call to handle it. The framework will provide a default handler which in many cases does nothing other than to indicate that the message has been handled.</p>\n\n<p>Most frameworks, wanting to make it easier to do what amounts to boilerplate source code will provide a set of Preprocessor macros that makes the event table easier to create.</p>\n\n<p><strong>Example macros from MFC</strong></p>\n\n<p>I do not have access to wxWidgets however the Microsoft MFC framework provides something similar to the wxWidgets framework though there is a lot more stuffed into MFC than window management.</p>\n\n<p>An event table using MFC looks like the following which is actually quite similar to the framework you are using. This message map is part of the implementation file for an MFC window class. In this case the application class <code>CFrameworkWndDoc</code> is derived from the MFC class <code>CWindowDocument</code> which is part of the MFC framework.</p>\n\n<pre><code>BEGIN_MESSAGE_MAP(CFrameworkWndDoc, CWindowDocument)\n    ON_WM_CHAR()\n    ON_WM_TIMER()\n    ON_MESSAGE(WU_EVS_DFLT_LOAD, OnDefaultWinLoad)\n    ON_MESSAGE(WM_APP_SHOW_HIDE_GROUP, OnShowHideGroupMsgRcvd)\nEND_MESSAGE_MAP()\n</code></pre>\n\n<p>Along with the above message map that is in the implementation source file, the .c file, there is also the use of the <code>DECLARE_MESSAGE_MAP()</code> define in the class definition, typically located in a header file, so that there is a linkage between the class and the message map.</p>\n\n<p>The <code>DECLARE_MESSAGE_MAP()</code> macro just puts into the class definition the necessary declarations that ties the actual message map in the implementation file to the class.</p>\n\n<pre><code>#define DECLARE_MESSAGE_MAP() \\\nprotected: \\\n    static const AFX_MSGMAP* PASCAL GetThisMessageMap(); \\\n    virtual const AFX_MSGMAP* GetMessageMap() const; \\\n</code></pre>\n\n<p>The MFC include files have definitions like the following. First of all the two definitions for the beginning and ending of the event table or what MFC calls the message map. As you can see this creates a new member to the MFC class which is called by the MFC framework in order to get access to the message map when the MFC framework is processing a message. The <code>DECLARE_MESSAGE_MAP()</code> macro in the <code>class</code> definition declares the functions which are generated by the following macros.</p>\n\n<pre><code>#define BEGIN_MESSAGE_MAP(theClass, baseClass) \\\n    PTM_WARNING_DISABLE \\\n    const AFX_MSGMAP* theClass::GetMessageMap() const \\\n        { return GetThisMessageMap(); } \\\n    const AFX_MSGMAP* PASCAL theClass::GetThisMessageMap() \\\n    { \\\n        typedef theClass ThisClass;                        \\\n        typedef baseClass TheBaseClass;                    \\\n        static const AFX_MSGMAP_ENTRY _messageEntries[] =  \\\n        {\n\n#define END_MESSAGE_MAP() \\\n        {0, 0, 0, 0, AfxSig_end, (AFX_PMSG)0 } \\\n    }; \\\n        static const AFX_MSGMAP messageMap = \\\n        { &amp;TheBaseClass::GetThisMessageMap, &amp;_messageEntries[0] }; \\\n        return &amp;messageMap; \\\n    }                                 \\\n    PTM_WARNING_RESTORE\n</code></pre>\n\n<p>Then there are a number of macros that are used to simplify the building of the event table. These used by MFC are much more complicated than the simple example above as these are designed to be used with the MFC windows classes and to be inserted into a source code file and managed by the Visual Studio development environment.</p>\n\n<p>Also notice that the MFC message map technology uses a set of special identifiers, the <code>AfxSig_vwww</code> and <code>AfxSig_lwl</code>, which tells the MFC framework what the interface to the handler function is supposed to be, <code>(UINT, UINT, UINT)</code> and <code>(WPARAM, LPARAM)</code> respectively.</p>\n\n<pre><code>#define ON_WM_CHAR() \\\n    { WM_CHAR, 0, 0, 0, AfxSig_vwww, \\\n        (AFX_PMSG)(AFX_PMSGW) \\\n        (static_cast&lt; void (AFX_MSG_CALL CWnd::*)(UINT, UINT, UINT) &gt; ( &amp;ThisClass :: OnChar)) },\n\n#define ON_MESSAGE(message, memberFxn) \\\n    { message, 0, 0, 0, AfxSig_lwl, \\\n        (AFX_PMSG)(AFX_PMSGW) \\\n        (static_cast&lt; LRESULT (AFX_MSG_CALL CWnd::*)(WPARAM, LPARAM) &gt; \\\n        (memberFxn)) },\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10859775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa83ae0c7316b41135d7b23d603dbf66?s=128&d=identicon&r=PG", "display_name": "Emmanuel", "link": "https://stackoverflow.com/users/10859775/emmanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 54013408, "answer_count": 2, "score": 4, "last_activity_date": 1546468616, "creation_date": 1546464191, "question_id": 54013356, "link": "https://stackoverflow.com/questions/54013356/what-kind-of-c-statements-is-the-wxwidgets-event-table", "title": "What kind of C++ statement(s) is the wxWidgets event table?", "body": "<p>I just started learning wxWidgets, and I came across a group of lines of code which looks like this:</p>\n\n<pre><code>wxBEGIN_EVENT_TABLE(MyFrame, wxFrame)\n    EVT_MENU(Minimal_Quit,  MyFrame::OnQuit)\n    EVT_MENU(Minimal_About, MyFrame::OnAbout)\nwxEND_EVENT_TABLE()\n</code></pre>\n\n<p>wxWidgets calls it \"event tables\". I'd like to know what kind of statement this is, because I've gone through a couple of C++ tutorials, and I've not seen anything like this. They look like function calls, but without semicolons. I know it has something to do with MACROS, but I don't really get how this works. Is this kind of statement a thing with MACROS, or it's a general thing in C++ I've not yet encountered?</p>\n"}, {"tags": ["c++", "c++11", "templates", "variadic-templates", "variadic-functions"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1546472868, "post_id": 54013345, "comment_id": 94866417, "body": "Could you explain your expected behavior?  And it&#39;s confusing that you use the names <code>f1</code> and <code>f2</code> in two ways - do you want <code>f3</code> to call the function passed to it, or the function actually named <code>f1</code> declared above?  How are these two things related?"}, {"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1546473194, "post_id": 54013345, "comment_id": 94866481, "body": "@aschepler what max66 added answers my question well. I have two functions: f1 and f2, both are variadic templates functions. Now I want to pass them to a new function, f3. At the same time, I need to pass the params for f1 and f2 to f3 as well. If f1 and f2 share the same params, it&#39;s easy. But for my case they don&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546465061, "post_id": 54013459, "comment_id": 94863975, "body": "In this case, how do I pass in the params to f1 and f2?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546465211, "post_id": 54013459, "comment_id": 94864025, "body": "@WhatABeautifulWorld - do you mean: to fix a precise set of types of arguments?"}, {"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546465379, "post_id": 54013459, "comment_id": 94864087, "body": "what I mean is when I call f3, I offer f1 and f2. I also need to pass in the params for f1 and f2. How do I do that?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546465728, "post_id": 54013459, "comment_id": 94864220, "body": "@WhatABeautifulWorld: with <code>std::tuple</code> ? but unsure why you need extra parameter with template functor."}, {"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1546465816, "post_id": 54013459, "comment_id": 94864258, "body": "@Jarod42 how do I do that? What&#39;s the f3 function signature?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1546465899, "post_id": 54013459, "comment_id": 94864296, "body": "@max66: Or &quot;directly&quot;: <code>f3([](auto&amp;&amp; args) { f1(decltype(args)(args)...); }, [](auto&amp;&amp; args) { f2(decltype(args)(args)...); });</code>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546466176, "post_id": 54013459, "comment_id": 94864418, "body": "@WhatABeautifulWorld: <code>template&lt;class F1, class F2, class ... Ts1, class ...Ts2&gt; void f3(F1, F2, std::tuple&lt;Ts1...&gt;, std::tuple&lt;Ts2...&gt;)</code>."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546467892, "post_id": 54013459, "comment_id": 94865031, "body": "@WhatABeautifulWorld - improved formatting; hope this helps."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1546467981, "post_id": 54013459, "comment_id": 94865060, "body": "@Jarod42 - yes... maybe better with lambdas... so you can use <code>std::apply()</code> with tuples of arguments; good idea; thanks."}, {"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546471371, "post_id": 54013459, "comment_id": 94866062, "body": "@max66 your answer looks great! &quot;But the argument for f1() and f2() are the same? Or are two different sets?&quot; They are two different sets. This is exactly what I am asking. I know how to do that if they are the same, I don&#39;t know how to do that if they are different. In your answer, can I just replace &quot; std::apply(l1, t1);&quot; with &quot;f1(std::forward&lt;decltype(t1)&gt;(t1)...)&quot;?"}, {"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546471454, "post_id": 54013459, "comment_id": 94866080, "body": "@max66  if I don&#39;t have std::apply how do I do that? Any idea?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546471594, "post_id": 54013459, "comment_id": 94866115, "body": "@WhatABeautifulWorld - &quot;can I just replace &quot; std::apply(l1, t1);&quot; with &quot;f1(std::forward&lt;decltype(t1)&gt;(t1)...)&quot;?&quot; - no, because <code>t1</code> is a <code>std::tuple</code> and <code>f1()</code> receive a variadic set of arguments."}, {"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546471648, "post_id": 54013459, "comment_id": 94866139, "body": "@max66 well, in this case how do I do that without c++17?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 1, "creation_date": 1546471712, "post_id": 54013459, "comment_id": 94866151, "body": "@WhatABeautifulWorld - &quot; if I don&#39;t have std::apply how do I do that?&quot; - through <code>std::make_index_sequence</code> and <code>std::index_sequence</code> (but C++14 is required; in C++11 you have to write a substitute but isn&#39;t really difficult); give me some minutes ans I prepare an example."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 1, "creation_date": 1546472499, "post_id": 54013459, "comment_id": 94866337, "body": "@WhatABeautifulWorld - answer improved."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546504677, "post_id": 54013459, "comment_id": 94873754, "body": "@WhatABeautifulWorld: And <code>f3([](){f1(1, 2l, &#39;3&#39;);}, [](){f2(&#39;4&#39;, 5ull)});</code> seems simpler as interface."}, {"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1546640971, "post_id": 54013459, "comment_id": 94929488, "body": "@Jarod42 yes it&#39;s simpler. But it&#39;s not generic. I have multiple clients. One wants to call f3 with f1(1, &#39;2&#39;) and one wants to call with f1(1). Same for f2."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1546643261, "post_id": 54013459, "comment_id": 94930106, "body": "@WhatABeautifulWorld: How <code>f3(l1, l2, std::make_tuple(1, 2l, &#39;3&#39;), std::make_tuple(&#39;4&#39;, 5ull));</code> is more generic than <code>f3([](){f1(1, 2l, &#39;3&#39;);}, [](){f2(&#39;4&#39;, 5ull)});</code> ? You might avoid some duplication if you have the argument tuple that you want to share between functions... Or if you have different set of argument in <code>f3</code>, my proposal doesn&#39;t fit..."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 2, "last_activity_date": 1546472888, "last_edit_date": 1546472888, "creation_date": 1546464909, "answer_id": 54013459, "question_id": 54013345, "link": "https://stackoverflow.com/questions/54013345/multiple-variadic-templates-function/54013459#54013459", "title": "Multiple variadic templates function", "body": "<p>You can't.</p>\n\n<p>Because a template functions are set of functions. And you can pass a functions, explicating the template types,</p>\n\n<pre><code>f3(f1&lt;int, long, long&gt;, f2&lt;char, int&gt;);\n</code></pre>\n\n<p>and not the full set of functions.</p>\n\n<p>The best I can suggest is to wrap your template functions in structs</p>\n\n<pre><code>struct s1\n {\n   template &lt;typename ... Types&gt;\n   static void f1 (Types ... args1)\n    { }\n };\n\nstruct s2\n {\n   template &lt;typename ... Types&gt;\n   static void f2 (Types ... args2)\n    { }\n };\n</code></pre>\n\n<p>so you can pass to <code>f3()</code> <code>s1</code> and <code>s2</code> objects</p>\n\n<pre><code>s1  a;\ns2  b;\n\nf3(a, b);\n</code></pre>\n\n<p>or simply the types</p>\n\n<pre><code>f3&lt;s1, s2&gt;();\n</code></pre>\n\n<p>As suggested by Jarod42, you can also wrap <code>f1()</code> and <code>f2()</code> inside a couple of lambdas (only from C++14)</p>\n\n<pre><code>auto l1 = [](auto&amp;&amp; ... args) { f1(std::forward&lt;decltype(args)&gt;(args)...); };\nauto l2 = [](auto&amp;&amp; ... args) { f2(std::forward&lt;decltype(args)&gt;(args)...); };\n\nf3(l1, l2)\n</code></pre>\n\n<blockquote>\n  <p>what I mean is when I call f3, I offer f1 and f2. I also need to pass in the params for f1 and f2. How do I do that? </p>\n</blockquote>\n\n<p>But the argument for <code>f1()</code> and <code>f2()</code> are the same? \nOr are two different sets?</p>\n\n<p>In the first case, you can pass they as template variadic arguments; something as (following the Jarod42's suggestion)</p>\n\n<pre><code>template &lt;typename L1, typename L2, typename ... Args&gt;\nvoid f3 (L1 l1, L2 l2, Args const &amp; ... as)\n {\n   L1(as...);\n   L2(as...);\n }  \n\nauto l1 = [](auto&amp;&amp; ... args) { f1(std::forward&lt;decltype(args)&gt;(args)...); };\nauto l2 = [](auto&amp;&amp; ... args) { f2(std::forward&lt;decltype(args)&gt;(args)...); };\n\nf3(l1, l2, 1, '2', 3L, 4ULL);\n</code></pre>\n\n<p>If you need two different set of argument, you need to wrap the arguments in <code>std::tuple</code>'s or something similar.</p>\n\n<pre><code>template &lt;typename L1, typename L2, typename ... As1, typename ... As2&gt;\nvoid f3 (L1 l1, L2 l2, std::tuple&lt;As1...&gt; const &amp; t1, std::tuple&lt;As2...&gt; const &amp; t2)\n {\n   std::apply(l1, t1);\n   std::apply(l2, t2);\n }  \n\nauto l1 = [](auto&amp;&amp; ... args) { f1(std::forward&lt;decltype(args)&gt;(args)...); };\nauto l2 = [](auto&amp;&amp; ... args) { f2(std::forward&lt;decltype(args)&gt;(args)...); };\n\nf3(l1, l2, std::make_tuple(1, 2l, '3'), std::make_tuple('4', 5ull));\n</code></pre>\n\n<p>But take in count that <code>std::apply()</code> is available only from C++17: before is a little more complicated extract the arguments from the tuples.</p>\n\n<blockquote>\n  <p>how do I do that without c++17?</p>\n</blockquote>\n\n<p>The following is a full C++14 example that unpack tuples using <code>std::index_sequence_for</code> and <code>std::index_sequence</code></p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename ... Ts&gt;\nvoid f1 (Ts ... as)\n { std::cout &lt;&lt; \"- f1: \" &lt;&lt; sizeof...(Ts) &lt;&lt; \" arguments\" &lt;&lt; std::endl; }\n\ntemplate &lt;typename ... Ts&gt;\nvoid f2 (Ts ... as)\n { std::cout &lt;&lt; \"- f2: \" &lt;&lt; sizeof...(Ts) &lt;&lt; \" arguments\" &lt;&lt; std::endl; }\n\ntemplate &lt;typename L, typename ... Ts, std::size_t ... Is&gt;\nvoid f3_helper (L l, std::tuple&lt;Ts...&gt; const &amp; t, std::index_sequence&lt;Is...&gt;)\n { l(std::get&lt;Is&gt;(t)...); }\n\ntemplate &lt;typename L1, typename L2, typename ... As1, typename ... As2&gt;\nvoid f3 (L1 l1, L2 l2, std::tuple&lt;As1...&gt; const &amp; t1,\n         std::tuple&lt;As2...&gt; const &amp; t2)\n {\n   f3_helper(l1, t1, std::index_sequence_for&lt;As1...&gt;{});\n   f3_helper(l2, t2, std::index_sequence_for&lt;As2...&gt;{});\n }  \n\nint main()\n {\n   auto l1 = [](auto &amp;&amp; ... args)\n    { f1(std::forward&lt;decltype(args)&gt;(args)...); };\n\n   auto l2 = [](auto &amp;&amp; ... args)\n    { f2(std::forward&lt;decltype(args)&gt;(args)...); };\n\n   f3(l1, l2, std::make_tuple(1, 2l, '3'), std::make_tuple('4', 5ull));\n }\n</code></pre>\n"}], "owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "closed_date": 1546496351, "accepted_answer_id": 54013459, "answer_count": 1, "score": 0, "last_activity_date": 1546513059, "creation_date": 1546464078, "last_edit_date": 1546513059, "question_id": 54013345, "link": "https://stackoverflow.com/questions/54013345/multiple-variadic-templates-function", "closed_reason": "Needs details or clarity", "title": "Multiple variadic templates function", "body": "<p>Assume I have two functions <code>f1()</code> and <code>f2()</code> defined as follow:</p>\n\n<pre><code>template&lt;class ... Types&gt; void f1(Types ... args1)\ntemplate&lt;class ... Types&gt; void f2(Types ... args2)\n</code></pre>\n\n<p>Now I want to create a third function <code>f3()</code> which takes input <code>f1()</code> and <code>f2()</code>, how do I define <code>f3()</code> with both <code>args1...</code> and <code>args2...</code>?</p>\n\n<pre><code>template&lt;class F1, class F2&gt; void f3(F1 f1, F2 f2) {\n  f1();  // how do I call f1? I need to pass in the args... \n}    \n</code></pre>\n"}, {"tags": ["c++", "linux"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 9, "creation_date": 1546464031, "post_id": 54013326, "comment_id": 94863580, "body": "C++ doesn&#39;t know about linux, it is OS independent.  You&#39;ll need to use system calls or get a library."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 4, "creation_date": 1546464265, "post_id": 54013326, "comment_id": 94863678, "body": "Perhaps you&#39;re looking for <a href=\"http://man7.org/linux/man-pages/man3/getpwent.3.html\" rel=\"nofollow noreferrer\"><code>getpwent</code></a>?"}, {"owner": {"reputation": 23, "user_id": 7553478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0600183e20f85e676649bc80476f0995?s=128&d=identicon&r=PG&f=1", "display_name": "Vovas", "link": "https://stackoverflow.com/users/7553478/vovas"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1546464480, "post_id": 54013326, "comment_id": 94863761, "body": "@NathanOliver agree with I edited my question"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7553478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0600183e20f85e676649bc80476f0995?s=128&d=identicon&r=PG&f=1", "display_name": "Vovas", "link": "https://stackoverflow.com/users/7553478/vovas"}, "edited": false, "score": 0, "creation_date": 1546519389, "post_id": 54013514, "comment_id": 94881035, "body": "it is exactly what i was looking for! Thank you!"}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": true, "score": 2, "last_activity_date": 1546465276, "creation_date": 1546465276, "answer_id": 54013514, "question_id": 54013326, "link": "https://stackoverflow.com/questions/54013326/list-all-users-names-of-the-linux-system-by-calling-c-function/54013514#54013514", "title": "List all users names of the Linux system by calling c++ function", "body": "<p>POSIX provides this functionality via the <a href=\"http://man7.org/linux/man-pages/man3/getpwent.3.html\" rel=\"nofollow noreferrer\"><code>getpwent</code></a> function:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;pwd.h&gt;\n\nint main() {\n    while (true) {\n        errno = 0; // so we can distinguish errors from no more entries\n        passwd* entry = getpwent();\n        if (!entry) {\n            if (errno) {\n                std::cerr &lt;&lt; \"Error reading password database\\n\";\n                return EXIT_FAILURE;\n            }\n            break;\n        }\n        std::cout &lt;&lt; entry-&gt;pw_name &lt;&lt; '\\n';\n    }\n    endpwent();\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7553478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0600183e20f85e676649bc80476f0995?s=128&d=identicon&r=PG&f=1", "display_name": "Vovas", "link": "https://stackoverflow.com/users/7553478/vovas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "closed_date": 1546472489, "accepted_answer_id": 54013514, "answer_count": 1, "score": 0, "last_activity_date": 1546519288, "creation_date": 1546463955, "last_edit_date": 1546519288, "question_id": 54013326, "link": "https://stackoverflow.com/questions/54013326/list-all-users-names-of-the-linux-system-by-calling-c-function", "closed_reason": "Needs details or clarity", "title": "List all users names of the Linux system by calling c++ function", "body": "<p>I would like to get all users names of the Posix system by calling c++ function from some library. Found only option to use call bash commands like this  <a href=\"https://stackoverflow.com/questions/39482163/list-all-linux-users-without-systen-users\">List all Linux users without systen users</a> from c++ programm </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1546463480, "post_id": 54013214, "comment_id": 94863358, "body": "<code>float li={};</code> creates a <code>float</code>, not a <code>list</code>."}, {"owner": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1546463637, "post_id": 54013214, "comment_id": 94863423, "body": "how can i fix it?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1546463663, "post_id": 54013214, "comment_id": 94863432, "body": "<code>float li={};</code> means <code>float li=0;</code>. You probably want <code>list&lt;float&gt; li;</code> instead. (Note that I only mentioned <code>std::list</code> because you used it as a return type. I&#39;d say <code>std::vector</code> should be used instead.)"}, {"owner": {"reputation": 20517, "user_id": 8344060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UbPk.png?s=128&g=1", "display_name": "kvantour", "link": "https://stackoverflow.com/users/8344060/kvantour"}, "edited": false, "score": 0, "creation_date": 1546464622, "post_id": 54013214, "comment_id": 94863809, "body": "Be aware of <a href=\"https://en.m.wikipedia.org/wiki/Loss_of_significance\" rel=\"nofollow noreferrer\">Catasrophic cancelation</a>."}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1546469183, "post_id": 54013214, "comment_id": 94865456, "body": "Note: formula for the roots is not  correct..."}, {"owner": {"reputation": 20517, "user_id": 8344060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UbPk.png?s=128&g=1", "display_name": "kvantour", "link": "https://stackoverflow.com/users/8344060/kvantour"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 1, "creation_date": 1546508868, "post_id": 54013214, "comment_id": 94875546, "body": "To go further on @Damien&#39;s comment, there is a serious bracket problem. Eg. <code>-b&#47;2*a</code> is different from <code>-b &#47; (2*a)</code>, the same goes for the square roots."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "edited": false, "score": 0, "creation_date": 1546465568, "post_id": 54013305, "comment_id": 94864161, "body": "Okay but i am really new to this and i cant say that i understand what u explained... so by changing float li={}; to list&lt;float&gt; li; my algoritme worked but when i am trying to find roots of an equation which has 1 roots it gives me the right answer but when i try to find roots of an equation which has 2 roots it gives me the wrong answer and it gives me only one answer"}, {"owner": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "edited": false, "score": 0, "creation_date": 1546465655, "post_id": 54013305, "comment_id": 94864188, "body": "note: yes i  meant -b+sqrt(discr)/2*a"}, {"owner": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "edited": false, "score": 0, "creation_date": 1546465757, "post_id": 54013305, "comment_id": 94864234, "body": "and to be specific i didnt understand the part when u talked about vector and why i shouldnt use list because i didnt learn vecteurs yet"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "edited": false, "score": 0, "creation_date": 1546466163, "post_id": 54013305, "comment_id": 94864411, "body": "The meaning of <code>((-b-sqrt(discr)&#47;2*a),((-b-sqrt(discr)&#47;2*a)))</code> is <b>exactly the same as</b> <code>-b-sqrt(discr)&#47;2*a</code>, because <code>,</code> in this context evaluates the left, discards the result, then evaluates the right. C++ has the &quot;as-if&quot; rule, which basically says that the compiler is allowed to omit parts of the program that have no effect, like calculating a number and discarding it."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "edited": false, "score": 0, "creation_date": 1546466340, "post_id": 54013305, "comment_id": 94864488, "body": "You should remove the <code>()</code>, as in my answer"}, {"owner": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "edited": false, "score": 0, "creation_date": 1546467075, "post_id": 54013305, "comment_id": 94864753, "body": "okay it is working now thank you very much"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "edited": false, "score": 0, "creation_date": 1559678245, "post_id": 54013305, "comment_id": 99494318, "body": "@T.K why you did not accepted that answer ? (  <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a> )"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": true, "score": 2, "last_activity_date": 1546464931, "last_edit_date": 1546464931, "creation_date": 1546463846, "answer_id": 54013305, "question_id": 54013214, "link": "https://stackoverflow.com/questions/54013214/finding-roots-of-an-equation/54013305#54013305", "title": "Finding roots of an equation", "body": "<p>You have an object declared <code>float li</code> and you try to use it as the return value of your function. You also try to assign a sequence of values to it. This won't work, and will use <code>operator,</code> instead of what you want. To fix it, return the list directly:</p>\n\n<pre><code>std::vector&lt;float&gt; Racines (float a, float b, float c)\n{\n    float discr=b*b-4*a*c;\n\n    switch(nbRacines(a,b,c))\n    {\n        case 2: return {-b-sqrt(discr)/2*a, -b-sqrt(discr)/2*a};\n        case 1: return {-b/2*a};\n        throw std::logic_error(\"quadratic equations have two roots\");\n    }\n}  \n</code></pre>\n\n<p>Arithmetic note 1: all quadratic equations have two roots, some just have two <em>equal</em> roots</p>\n\n<p>Arithmetic note 2: I think you mean to return <code>-b+sqrt(discr)/2*a</code> as one of the elements of your two element list</p>\n\n<p>Style note: <code>std::vector</code> is a much better default container than <code>std::list</code>. You should only use <code>list</code> when you need its properties (lack of reference invalidation).</p>\n"}], "owner": {"reputation": 21, "user_id": 10859715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1150b55143d9db2af030c688585059a?s=128&d=identicon&r=PG&f=1", "display_name": "T.K", "link": "https://stackoverflow.com/users/10859715/t-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "closed_date": 1546499741, "accepted_answer_id": 54013305, "answer_count": 1, "score": -2, "last_activity_date": 1546508797, "creation_date": 1546463311, "last_edit_date": 1546508797, "question_id": 54013214, "link": "https://stackoverflow.com/questions/54013214/finding-roots-of-an-equation", "closed_reason": "Not suitable for this site", "title": "Finding roots of an equation", "body": "<p>I am trying to define an algorithm in C++ but there is an error that I can't understand\nI want my algorithm to find the roots of an equation of the second degree, and give me the solution as a list...</p>\n\n<p>I already defined <code>nbRacines</code> which gives the number of the roots and it is working correctly.\nSo this is my definition...</p>\n\n<pre><code>list&lt;float&gt; Racines (float a,float b, float c)\n{\n    float discr=b*b-4*a*c;\n    float li={};\n\n    if (nbRacines(a,b,c)==2)\n    {\n        li={((-b-sqrt(discr)/2*a),((-b-sqrt(discr)/2*a)))};\n    }\n\n    if (nbRacines(a,b,c)==1)\n    {\n        li={(-b/2*a)};\n    }\n\n    return li;\n}  \n</code></pre>\n\n<p>And it gives this error...</p>\n\n<pre><code>$ g++ -Wall -pedantic -std=c++0x -c -Werror definitionsFonctions.cpp\ndefinitionsFonctions.cpp: In function \u2018std::__cxx11::list&lt;float&gt; \nRacines(float, float, float)\u2019:\n`definitionsFonctions.cpp:269:10: error: could not convert \u2018li\u2019 from \u2018float\u2019 to \n\u2018std::__cxx11::list&lt;float&gt;\u2019\n   return li;\n          ^~\nMakefile:8: recipe for target 'definitionsFonctions.o' failed\nmake: *** [definitionsFonctions.o] Error 1\n</code></pre>\n"}, {"tags": ["c++", "visual-studio-2017", "int", "long-integer", "static-assert"], "comments": [{"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 3, "creation_date": 1546462422, "post_id": 54013016, "comment_id": 94862927, "body": "<code>static_assert(sizeof(int) == sizeof(long))</code>?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1546462526, "post_id": 54013016, "comment_id": 94862966, "body": "The types are not the same.  Maybe you want to know if their lengths are the same?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546462825, "post_id": 54013016, "comment_id": 94863089, "body": "If you ever want to port your code to other platforms, you should <i>not</i> assume that <code>int</code> and <code>long</code> are the same."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 7, "last_activity_date": 1546489563, "last_edit_date": 1546489563, "creation_date": 1546462582, "answer_id": 54013076, "question_id": 54013016, "link": "https://stackoverflow.com/questions/54013016/static-assertion-that-a-long-and-int-are-the-same-type/54013076#54013076", "title": "static_assert&#39;ion that a long and int are the Same Type", "body": "<p><code>long</code> and <code>int</code> are different fundamental types.  Even if they are the same size they are not the same type, so <code>is_same_v</code> will never be <code>true</code>.  If you want you can check their sizes are the same then proceed with</p>\n\n<pre><code>static_assert(sizeof(foo) == sizeof(bar));\n</code></pre>\n\n<p>You can even make sure that <code>foo</code> and <code>bar</code> are integral types like</p>\n\n<pre><code>static_assert(sizeof(foo) == sizeof(bar) &amp;&amp; \n              std::is_integral_v&lt;decltype(foo)&gt; &amp;&amp; \n              std::is_integral_v&lt;decltype(bar)&gt;);\n</code></pre>\n\n<p>You can also make sure they have the same signedness like</p>\n\n<pre><code>static_assert(sizeof(foo) == sizeof(bar) &amp;&amp; \n             std::is_integral_v&lt;decltype(foo)&gt; &amp;&amp; \n             std::is_integral_v&lt;decltype(bar)&gt; &amp;&amp;\n             std::is_signed_v&lt;decltype(foo)&gt; == std::is_signed_v&lt;decltype(bar)&gt;);\n</code></pre>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 54013076, "answer_count": 1, "score": 0, "last_activity_date": 1546489563, "creation_date": 1546462276, "last_edit_date": 1546462652, "question_id": 54013016, "link": "https://stackoverflow.com/questions/54013016/static-assertion-that-a-long-and-int-are-the-same-type", "title": "static_assert&#39;ion that a long and int are the Same Type", "body": "<p>So I'm taking a variable from one API, we'll call it <code>long foo</code> and passing it to another API which takes it as the value: <code>int bar</code>.</p>\n\n<p>I'm in <a href=\"/questions/tagged/visual-studio-2017\" class=\"post-tag\" title=\"show questions tagged &#39;visual-studio-2017&#39;\" rel=\"tag\">visual-studio-2017</a> in which these are effectively the same thing: <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/data-type-ranges?view=vs-2017\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/cpp/cpp/data-type-ranges?view=vs-2017</a></p>\n\n<p>But this will fire:</p>\n\n<pre><code>static_assert(is_same_v&lt;decltype(foo), decltype(bar)&gt;);\n</code></pre>\n\n<p>Because even though these are <em>effectively</em> the same, they are not the same type. Is there a workaround for this, other than using the numeric limits library to match a <code>long</code> to an <code>int</code>?</p>\n"}, {"tags": ["c++", "configuration", "mfc", "visual-studio-2017"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546461253, "post_id": 54012773, "comment_id": 94862463, "body": "Sounds to me like a question for the MS VC team. Not SO."}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546461371, "post_id": 54012773, "comment_id": 94862508, "body": "@JesperJuhl: Well, I&#39;m hoping that there&#39;s a setting that I missed somewhere."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546461465, "post_id": 54012773, "comment_id": 94862537, "body": "why does that make it more of a SO than a MSVC team question?"}], "answers": [{"comments": [{"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1546470439, "post_id": 54014232, "comment_id": 94865800, "body": "Oh, I guess they want us to select &quot;Active&quot; to make it match what&#39;s actually selected in the IDE. Well, that&#39;s not exactly what I was looking for but will do for a downfall that VS has become now."}, {"owner": {"reputation": 5944, "user_id": 646173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cb9ef472d0c9c24f216dc6c19af696?s=128&d=identicon&r=PG", "display_name": "Markus Schumann", "link": "https://stackoverflow.com/users/646173/markus-schumann"}, "reply_to_user": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1546523511, "post_id": 54014232, "comment_id": 94883401, "body": "That raises the question - what is better than Visual Studio?. I find VS very productive and now use it for Linux dev as well."}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1546531404, "post_id": 54014232, "comment_id": 94887901, "body": "Older versions of VS that don&#39;t crash, are fast to load, don&#39;t have tons of bloat, and don&#39;t take GBs of data to download for an update."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1546531642, "post_id": 54014232, "comment_id": 94888013, "body": "@c00000fd You only have to select &quot;Active&quot; once. From then on, the project properties dialog always follows your current configuration. Even when closing/reopening a project."}], "tags": [], "owner": {"reputation": 5944, "user_id": 646173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cb9ef472d0c9c24f216dc6c19af696?s=128&d=identicon&r=PG", "display_name": "Markus Schumann", "link": "https://stackoverflow.com/users/646173/markus-schumann"}, "is_accepted": true, "score": 3, "last_activity_date": 1546469662, "creation_date": 1546469662, "answer_id": 54014232, "question_id": 54012773, "link": "https://stackoverflow.com/questions/54012773/how-to-make-vs2017-match-configuration-and-platform-selection-when-i-open-setup/54014232#54014232", "title": "How to make VS2017 match configuration and platform selection when I open Setup Property Pages for a C++ or MFC project?", "body": "<p>Select the active platform in your property page then they should match:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jIMyq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jIMyq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 54014232, "answer_count": 1, "score": 1, "last_activity_date": 1546469662, "creation_date": 1546461085, "question_id": 54012773, "link": "https://stackoverflow.com/questions/54012773/how-to-make-vs2017-match-configuration-and-platform-selection-when-i-open-setup", "title": "How to make VS2017 match configuration and platform selection when I open Setup Property Pages for a C++ or MFC project?", "body": "<p>I'm migrating my C++ and MFC projects to Visual Studio 2017 and this little change that they had made to it caused me a lot of confusion.</p>\n\n<p>Say, if I'm currently working in a <code>Debug</code> <code>x86</code> configuration for my project, when I go to the <code>Property Page</code> for my project, instead of matching the selection for my current configuration, it shows something that, I guess, it remembered since last time I opened it. Here's a screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wY2od.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wY2od.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would expect the property page window to be selected for <code>Debug x86</code> as well to match my current configuration, instead of being set to <code>Release x64</code>.</p>\n\n<p>Is there a way to configure it to match when I open the <code>Property Page</code> settings?</p>\n"}, {"tags": ["c++", "binary-data", "pgm"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546461088, "post_id": 54012755, "comment_id": 94862388, "body": "Could you perhaps post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or <a href=\"http://www.sscce.org\" rel=\"nofollow noreferrer\">SSCCE</a>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1546461095, "post_id": 54012755, "comment_id": 94862393, "body": "<code>unsigned char brightness = m_data[i]*256;</code> doesn&#39;t look right.  What are you trying to do with that?"}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1546461197, "post_id": 54012755, "comment_id": 94862440, "body": "@NathanOliver m_data is an std::array of doubles in the range [0, 1], and is a member object of HeightMap. I am converting each double to the range [0, 255] and storing it an unsigned char, as the internal binary format of unsigned char matches that of the netbpm format. Each unsigned char or entry in m_data contains exactly one pixel."}, {"owner": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "edited": false, "score": 0, "creation_date": 1546461248, "post_id": 54012755, "comment_id": 94862458, "body": "So multiply by 255!"}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546461252, "post_id": 54012755, "comment_id": 94862462, "body": "@JesperJuhl I can, but there is a lot of supporting code needed to make it work (ie. something to generate an image to save). Is there something more specific that you are looking for that I can provide instead?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1546461291, "post_id": 54012755, "comment_id": 94862472, "body": "Where are you writing the max value (which should come after the image sizes according to the wikipedia page you linked)?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1546461298, "post_id": 54012755, "comment_id": 94862475, "body": "You can reproduce the problem with expository input and provide us with that, as the article Jesper linked to explains. You ought to have done this in your debugging phase!"}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "edited": false, "score": 0, "creation_date": 1546461304, "post_id": 54012755, "comment_id": 94862477, "body": "@ravenspoint I&#39;m not sure what you mean by that, but changing 256 to 255 doesn&#39;t help (nor do I know why it would)."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546461343, "post_id": 54012755, "comment_id": 94862498, "body": "<code>fout &lt;&lt; &quot;P5 &quot; &lt;&lt; LENGTH &lt;&lt; &quot; &quot; &lt;&lt; LENGTH;</code> Are we sure that this is correct? How does the parser know where the length ends and the data begins?"}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1546461347, "post_id": 54012755, "comment_id": 94862499, "body": "@UnholySheep There&#39;s the error, thanks! :) EDIT: There is still something else wrong. I will edit the question."}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546461546, "post_id": 54012755, "comment_id": 94862568, "body": "@LightnessRacesinOrbit That was not correct, but is now corrected in edit."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1546461825, "post_id": 54012755, "comment_id": 94862688, "body": "<code>fout &lt;&lt; &quot;P5\\n&quot; &lt;&lt; LENGTH &lt;&lt; &quot; &quot; &lt;&lt; LENGTH &lt;&lt; &quot;\\n255\\n&quot;;</code>"}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546462027, "post_id": 54012755, "comment_id": 94862762, "body": "@LightnessRacesinOrbit I have done what you requested."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1546462261, "post_id": 54012755, "comment_id": 94862865, "body": "Why is your array <code>double</code>? It needs to be <code>unsigned char</code>."}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1546462389, "post_id": 54012755, "comment_id": 94862919, "body": "@MarkSetchell My array is a double because the heightmap is calculated as a double. The minimum example uses an array of doubles to have as little change as possible. The data is converted to an unsigned char, however, before it is written to the file. Consider the data in the array to be input to what is being debugged, and its format immutable with respect to what is being debugged."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1546462441, "post_id": 54012755, "comment_id": 94862934, "body": "You can&#39;t fit a double in an unsigned char - this is not going to work. A NetPBM file can only store unsigned chars between 0..255 or unsigned shorts between 0..65535. If you want to store doubles, you will need to write TIFFs."}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1546462493, "post_id": 54012755, "comment_id": 94862955, "body": "@MarkSetchell The doubles are all in the range [0, 1]. As such, when they are multiplied by 255 or 256 they are bounded into the range of an unsigned char. C++&#39;s rules for assigning doubles to unsigned chars then convert this range to the representation of an unsigned char."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1546462756, "post_id": 54012755, "comment_id": 94863067, "body": "Ok, the <code>256</code> in the header is still incorrect- it should be 255. That&#39;s why it says <code>premature end of file</code> because it is expecting 16 bits per pixel because 256&gt;255."}, {"owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1546462979, "post_id": 54012755, "comment_id": 94863156, "body": "@MarkSetchell That fixed the issue, thanks! I&#39;ll accept it if you decide to write it as an answer."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1546463345, "post_id": 54012755, "comment_id": 94863302, "body": "Excellent! Glad we worked it out."}], "answers": [{"tags": [], "owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": true, "score": 2, "last_activity_date": 1546463321, "creation_date": 1546463321, "answer_id": 54013217, "question_id": 54012755, "link": "https://stackoverflow.com/questions/54012755/what-is-wrong-with-my-code-to-write-netbpm-images/54013217#54013217", "title": "What is wrong with my code to write netbpm images?", "body": "<p>Try writing the NetPBM header like this:</p>\n\n<pre><code>fout &lt;&lt; \"P5\\n\" &lt;&lt; LENGTH &lt;&lt; \" \" &lt;&lt; LENGTH &lt;&lt; \"\\n255\\n\";\n</code></pre>\n\n<p>The reason is that most image readers check the MAXVAL and if it is 255 or less, they assume 8-bits per pixel. If MAXVAL exceeds 255, they assume 16-bits per pixel, so they will complain that your file is too short (as it doesn't provide 2 bytes per pixel).</p>\n"}], "owner": {"reputation": 1646, "user_id": 2985951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3d68092c6e405cffe2c1d067adf6bf1?s=128&d=identicon&r=PG&f=1", "display_name": "john01dav", "link": "https://stackoverflow.com/users/2985951/john01dav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 54013217, "answer_count": 1, "score": 0, "last_activity_date": 1546463321, "creation_date": 1546460980, "last_edit_date": 1546462435, "question_id": 54012755, "link": "https://stackoverflow.com/questions/54012755/what-is-wrong-with-my-code-to-write-netbpm-images", "title": "What is wrong with my code to write netbpm images?", "body": "<p>I am currently working on a project that needs to output generated images. I have decided to the use greyscale <a href=\"https://en.wikipedia.org/wiki/Netpbm_format\" rel=\"nofollow noreferrer\">netbpm format</a> due to its simplicity. One of these images is a heightmap. My code to export it is as follows:</p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n\nint main(){\n    constexpr unsigned LENGTH = 4;\n    std::array&lt;double, LENGTH*LENGTH&gt; m_data = {\n        0, 0, 0, 0,  \n        0, 1, 1, 0,\n        0, 1, 1, 0,\n        0, 0, 0, 0\n    };\n\n    std::ofstream fout;\n    fout.exceptions(std::ios::badbit | std::ios::failbit);\n    fout.open(\"test.pgm\", std::ios::binary);\n    fout &lt;&lt; \"P5 \" &lt;&lt; LENGTH &lt;&lt; \" \" &lt;&lt; LENGTH &lt;&lt; \"\\n256\\n\";\n\n    for(unsigned i=0;i&lt;LENGTH*LENGTH;++i){\n        unsigned char brightness = m_data[i]*255;\n        std::cout &lt;&lt; m_data[i] &lt;&lt; std::endl;\n        fout.write(reinterpret_cast&lt;char*&gt;(&amp;brightness), sizeof(unsigned char));\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This code looks correct to me, after reading <a href=\"https://en.wikipedia.org/wiki/Netpbm_format#File_format_description\" rel=\"nofollow noreferrer\">the specification for the netbpm format on Wikipedia</a>. Yet, when I attempt to open this image in either Gimp or Clion there are various errors:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3MRCj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3MRCj.png\" alt=\"Non-specific error from Clion\"></a>\n<a href=\"https://i.stack.imgur.com/4OJR8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4OJR8.png\" alt=\"&quot;Premature end of file&quot; error from Gimp.\"></a></p>\n\n<p>The file is saved with a <code>pgm</code> extension. What is wrong with my code?</p>\n"}, {"tags": ["c++", "c++11", "exception"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 9, "creation_date": 1546454534, "post_id": 54011523, "comment_id": 94859744, "body": "<code>void f() throw()</code> says that the function <i>doesn&#39;t</i> throw exceptions. And then you do."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546807688, "post_id": 54011523, "comment_id": 94964757, "body": "@JesperJuhl: It&#39;s not <i>undefined behavior</i> to throw from such a function; you call <code>std::unexpected</code>.  That&#39;s just probably not something you <i>want</i>."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10534770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1d72631df024af6d929d820fa4bce8?s=128&d=identicon&r=PG&f=1", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/10534770/hectorj"}, "edited": false, "score": 0, "creation_date": 1546455576, "post_id": 54011577, "comment_id": 94860148, "body": "Thank you! I had an incorrect understanding.  It looks like <code>noexcept(false)</code> will provide the same functionality and looks to not have been deprecated"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 151, "user_id": 10534770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1d72631df024af6d929d820fa4bce8?s=128&d=identicon&r=PG&f=1", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/10534770/hectorj"}, "edited": false, "score": 5, "creation_date": 1546455626, "post_id": 54011577, "comment_id": 94860168, "body": "@HectorJ <code>noexcept(false)</code> is the default for most functions and usually does not need to be provided. I believe destructors are <code>noexcept(true)</code> by default and as far as I know that would be the only time <code>noexcept(false)</code> has meaning (though that&#39;s not recommended)."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 16, "last_activity_date": 1546455565, "last_edit_date": 1546455565, "creation_date": 1546454698, "answer_id": 54011577, "question_id": 54011523, "link": "https://stackoverflow.com/questions/54011523/terminate-called-after-throwing-an-instance-of-an-exception-core-dumped/54011577#54011577", "title": "Terminate called after throwing an instance of an exception, core dumped", "body": "<p>The <code>throw()</code> in <code>void f() throw()</code> is a <a href=\"https://en.cppreference.com/w/cpp/language/except_spec\" rel=\"noreferrer\">dynamic exception specification</a> and is deprecated since c++11. It's was supposed to be used to list the exceptions a function could throw. An empty specification (<code>throw()</code>) means there are no exceptions that your function could throw. Trying to throw an exception from such a function calls <a href=\"https://en.cppreference.com/w/cpp/error/unexpected\" rel=\"noreferrer\"><code>std::unexpected</code></a> which, by default, terminates.</p>\n\n<p>Since c++11 the preferred way of specifying that a function cannot throw is to use <a href=\"https://en.cppreference.com/w/cpp/language/noexcept_spec\" rel=\"noreferrer\"><code>noexcept</code></a>. For example <code>void f() noexcept</code>.</p>\n"}], "owner": {"reputation": 151, "user_id": 10534770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1d72631df024af6d929d820fa4bce8?s=128&d=identicon&r=PG&f=1", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/10534770/hectorj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6883, "favorite_count": 0, "accepted_answer_id": 54011577, "answer_count": 1, "score": 13, "last_activity_date": 1546455565, "creation_date": 1546454411, "last_edit_date": 1546454927, "question_id": 54011523, "link": "https://stackoverflow.com/questions/54011523/terminate-called-after-throwing-an-instance-of-an-exception-core-dumped", "title": "Terminate called after throwing an instance of an exception, core dumped", "body": "<p>I am going over C++ exceptions and am running into an error that I am unsure of why it is giving me issues:</p>\n\n<pre><code> #include &lt;iostream&gt;\n #include &lt;exception&gt;\n\n class err : public std::exception\n {\n public:\n      const char* what() const noexcept { return \"error\"; }\n };\n\n void f() throw()\n {\n      throw err();\n }\n\n int main()\n {\n      try\n      {\n           f();\n      }\n      catch (const err&amp; e)\n      {\n           std::cout &lt;&lt; e.what() &lt;&lt; std::endl;\n      }\n }\n</code></pre>\n\n<p>When I run it, I get the following runtime error:</p>\n\n<pre><code> terminate called after throwing an instance of 'err'\n   what():  error\n Aborted (core dumped)\n</code></pre>\n\n<p>If I move the <code>try/catch</code> logic completely to <code>f()</code>, i.e.</p>\n\n<pre><code> void f() \n {\n      try\n      {\n           throw err();\n      }\n      catch (const err&amp; e)\n      {\n            std::cout &lt;&lt; e.what() &lt;&lt; std::endl;\n      }\n }\n</code></pre>\n\n<p>And just call it from <code>main</code> (without the try/catch block in main), then there is no error.  Am I not understanding something, as it relates to throwing exceptions from functions?</p>\n"}, {"tags": ["c++", "multithreading", "matlab", "boost", "mex"], "answers": [{"comments": [{"owner": {"reputation": 510, "user_id": 5302549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa99228aa80f259739910e49445c775b?s=128&d=identicon&r=PG&f=1", "display_name": "sgmm", "link": "https://stackoverflow.com/users/5302549/sgmm"}, "edited": false, "score": 0, "creation_date": 1546453213, "post_id": 54011062, "comment_id": 94859237, "body": "Thanks for explaining why it&#39;s not possible. Could you expand on you explanation of how I could implement a messaging system? Some example code would really be appreciated."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 510, "user_id": 5302549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa99228aa80f259739910e49445c775b?s=128&d=identicon&r=PG&f=1", "display_name": "sgmm", "link": "https://stackoverflow.com/users/5302549/sgmm"}, "edited": false, "score": 0, "creation_date": 1546454055, "post_id": 54011062, "comment_id": 94859578, "body": "@CrystalPritzker: Sorry, I have little experience with that, I&#39;m afraid I&#39;d recommend something that&#39;s wrong. I imagine you&#39;d do, in main, a <code>while(joinable())</code> loop, with a <code>join_for(boost::chrono::milliseconds(50))</code> wait inside. Then you&#39;d have a linked list of messages, which you&#39;d print and remove from the list within this loop. The worker threads would append to the list. The list would be protected by a <code>std::mutex</code> for multi-threaded access (or use <code>boost::lockfree::queue</code> instead, which has the mutex built in). But this is my low-experience guess at a solution."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 510, "user_id": 5302549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa99228aa80f259739910e49445c775b?s=128&d=identicon&r=PG&f=1", "display_name": "sgmm", "link": "https://stackoverflow.com/users/5302549/sgmm"}, "edited": false, "score": 0, "creation_date": 1546454562, "post_id": 54011062, "comment_id": 94859755, "body": "@CrystalPritzker: I&#39;ve added a bit of code, for how I thought about this solution. I&#39;m not sure even if it would compile... :)"}, {"owner": {"reputation": 510, "user_id": 5302549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa99228aa80f259739910e49445c775b?s=128&d=identicon&r=PG&f=1", "display_name": "sgmm", "link": "https://stackoverflow.com/users/5302549/sgmm"}, "edited": false, "score": 0, "creation_date": 1546454722, "post_id": 54011062, "comment_id": 94859815, "body": "I appreciate the help. Thank you very much!"}], "tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": true, "score": 3, "last_activity_date": 1546454454, "last_edit_date": 1592644375, "creation_date": 1546452177, "answer_id": 54011062, "question_id": 54010898, "link": "https://stackoverflow.com/questions/54010898/how-do-you-print-to-console-in-a-multi-threaded-mex-function/54011062#54011062", "title": "How do you print to console in a Multi-Threaded MEX Function?", "body": "<p>You cannot call <code>mexPrintf</code> from any thread except the main thread. A mutex will not solve your problem.</p>\n<p>From the <a href=\"https://www.mathworks.com/help/matlab/matlab_external/mex-api-is-not-thread-safe.html\" rel=\"nofollow noreferrer\">MATLAB documentation</a>:</p>\n<blockquote>\n<p><strong>MEX API Is Not Thread Safe</strong></p>\n<p>Do not call a single session of MATLAB\u00ae on separate threads from a MEX file. The MEX and Matrix Library APIs are not multi-threaded.</p>\n<p>You can create threads from a C MEX file; however, accessing MATLAB from those threads is not supported. Do not call any MEX API functions from the spawned threads, including <code>printf</code>, which is defined as <code>mexPrintf</code> in the <code>mex.h</code> header file.</p>\n</blockquote>\n<p>If you really need to produce output from these threads, consider implementing a simple messaging system where the threads post a message with the text to be output, and the main thread, instead of waiting with <code>producer_thread.join();</code>, sits in a loop looking for messages to print, and prints them with <code>mexPrintf</code>.</p>\n<hr />\n<p>The code below is <strong>not tested</strong>. It's not even been compiled. Consider it pseudo-code. I think this is a reasonable attempt at a solution but there might be much better approaches. Continue at your own risk. :)</p>\n<pre><code>boost::lockfree::queue&lt;std::string&gt; message_queue;\n\nvoid producer() {\n    //...\n    message_queue.push(&quot;A string to print!&quot;);\n    //...\n}\n\nvoid mexFunction( /*...*/ ) {\n    // ...\n    boost::thread producer_thread(producer);\n    boost::thread consumer_thread(consumer);\n    while(producer_thread.joinable()) {\n        join_for(boost::chrono::milliseconds(50));\n        std::string s;\n        while (message_queue.pop(s)) {\n            mexPrintf(&quot;%s\\n&quot;, s.c_str());\n        }\n    }\n    producer_thread.join();\n    done = true;\n    consumer_thread.join();\n    // ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 665, "user_id": 6792694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505d51038643157ad531f4967507e8f3?s=128&d=identicon&r=PG&f=1", "display_name": "MiB_Coder", "link": "https://stackoverflow.com/users/6792694/mib-coder"}, "is_accepted": false, "score": 1, "last_activity_date": 1609882520, "creation_date": 1609882520, "answer_id": 65586902, "question_id": 54010898, "link": "https://stackoverflow.com/questions/54010898/how-do-you-print-to-console-in-a-multi-threaded-mex-function/65586902#65586902", "title": "How do you print to console in a Multi-Threaded MEX Function?", "body": "<p>It is possible using the new <a href=\"https://de.mathworks.com/help/matlab/cpp-mex-file-applications.html\" rel=\"nofollow noreferrer\">C++ mex interface</a>. Here you can call matlab functions using feval or fevalAsync. fevalAsync is the way to go when calling matlab from another thread.</p>\n<p>A function to print to the command window would look like this:</p>\n<pre><code> void print(const std::string&amp; msg)\n {\n    mattlab::data::ArrayFactory factory;\n    matlabPtr-&gt;fevalAsync(u&quot;fprintf&quot;, 0,\n        std::vector&lt;matlab::data::Array&gt;({ factory.createScalar(msg) }));\n });\n</code></pre>\n<p>The problem however is that the messages are displayed after the mex function has finished. Also subsequent calls like</p>\n<pre><code>matlabPtr-&gt;evalAsync(u&quot;pause(0.001);&quot;);\n</code></pre>\n<p>have no effect. If anyone has an idea, I would also appreciate it.</p>\n"}], "owner": {"reputation": 510, "user_id": 5302549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa99228aa80f259739910e49445c775b?s=128&d=identicon&r=PG&f=1", "display_name": "sgmm", "link": "https://stackoverflow.com/users/5302549/sgmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 54011062, "answer_count": 2, "score": 2, "last_activity_date": 1609882520, "creation_date": 1546451349, "last_edit_date": 1546454493, "question_id": 54010898, "link": "https://stackoverflow.com/questions/54010898/how-do-you-print-to-console-in-a-multi-threaded-mex-function", "title": "How do you print to console in a Multi-Threaded MEX Function?", "body": "<p>I'm writing a simple producer consumer MEX function which uses the Boost library. I  have manged to get the following program to work without any issues.</p>\n\n<pre><code>#include \"mex.h\"\n#include &lt;boost/thread/thread.hpp&gt;\n#include &lt;boost/lockfree/spsc_queue.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;boost/atomic.hpp&gt;\n\nint producer_count = 0;\nboost::atomic_int consumer_count (0);\nboost::lockfree::spsc_queue&lt;int, boost::lockfree::capacity&lt;1024&gt; &gt; spsc_queue;\nconst int iterations = 10000000;\n\nvoid producer()\n{\n    for (int i = 0; i != iterations; ++i) {\n        int value = ++producer_count;\n        while (!spsc_queue.push(value));\n    }\n}\n\nboost::atomic&lt;bool&gt; done (false);\n\nvoid consumer()\n{\n    int value;\n    while (!done) {\n        while (spsc_queue.pop(value))\n            ++consumer_count;\n    }\n\n    while (spsc_queue.pop(value))\n        ++consumer_count;\n}\n\nvoid mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[])\n{\n    if (!spsc_queue.is_lock_free())\n    {\n      mexPrintf(\"boost::lockfree::queue is not lockfree\\n\");\n      mexEvalString(\"drawnow;\");\n    }\n    else\n    {\n      mexPrintf(\"boost::lockfree::queue is lockfree\\n\");\n      mexEvalString(\"drawnow;\");\n    }\n\n    boost::thread producer_thread(producer);\n    boost::thread consumer_thread(consumer);\n\n    producer_thread.join();\n    done = true;\n    consumer_thread.join();\n\n    cout &lt;&lt; \"produced \" &lt;&lt; producer_count &lt;&lt; \" objects.\" &lt;&lt; endl;\n    cout &lt;&lt; \"consumed \" &lt;&lt; consumer_count &lt;&lt; \" objects.\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>The big problem is I try to include a <code>mexPrintf()</code> into the either the producer or consumer method MATLAB just crashes. After doing some investigation I found <a href=\"https://stackoverflow.com/questions/5711801/c-multi-thread-text-output-print-to-dos-console-overlapped-mess-up-the-outputs\">this post</a> which explained this happens because of race conditions. Does anyone know how I can fix this issue? I read what the answer said about Mutex, but I do not understand how I would implement such a functionality.</p>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 7, "creation_date": 1546450217, "post_id": 54010650, "comment_id": 94858027, "body": "Don&#39;t do hackery like this. It&#39;s way outside of what is well-defined in C++, and not necessary."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1546450220, "post_id": 54010650, "comment_id": 94858029, "body": "This code is undefined behavior. It may work mostly by chance with a specific version of a specific compiler on a specific operating system, but there&#39;s <i>never</i> a reason to do this."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1546450220, "post_id": 54010650, "comment_id": 94858030, "body": "<code>*(int**)obj;</code> invokes <i>undefined behavior</i>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1546450285, "post_id": 54010650, "comment_id": 94858056, "body": "That being said, what about the long explanation in the linked article is not clear? We don&#39;t want to repeat the whole explanation only to <i>then</i> find out what part you didn&#39;t get."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1546453563, "post_id": 54010650, "comment_id": 94859386, "body": "That article is talking about implementation details as if they were facts of c++. This isn&#39;t how c++ works. <i>Even if</i> you are on an implementation where what it assumes is true, it uses undefined behavior and might stop working at any time. It doesn&#39;t even specify how it was built or with what compiler versions, so you can&#39;t even semi-reliably use what it describes. There&#39;s hardly anything useful to learn from it. Line 26 is undefined behavior and there is nothing to understand from it other than to not do that."}, {"owner": {"reputation": 13, "user_id": 3774426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec30c977be09cd45c544c2366795897a?s=128&d=identicon&r=PG&f=1", "display_name": "user3774426", "link": "https://stackoverflow.com/users/3774426/user3774426"}, "edited": false, "score": 0, "creation_date": 1546483480, "post_id": 54010650, "comment_id": 94868343, "body": "yeah, i know it may have undefined behavior and out side the scope of c++. I just want to understand the line number 26.."}], "answers": [{"tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": true, "score": 1, "last_activity_date": 1546455046, "creation_date": 1546455046, "answer_id": 54011642, "question_id": 54010650, "link": "https://stackoverflow.com/questions/54010650/understand-the-pointer-pointer-in-c-to-get-the-function-call/54011642#54011642", "title": "understand the pointer pointer in c++ to get the function call", "body": "<p>The code is trying to do a hack base on some <em>possible</em> implementation of a virtual functionality in c++. The implementation of the vtable is not defined in the standard and its could be different with different compilers. It could be a subject to optimization as well. </p>\n\n<p>The article is 10 years old and assumes a particular vtable implementation which was kind of common before those days: </p>\n\n<ol>\n<li><p>first hidden pointer in the object (at object starting address) points to a array of functions. </p></li>\n<li><p>the array of functions represents all virtual functions in the class. \n   Only compiler knows in which order they are put in the array. Declaration order was used usually.</p></li>\n</ol>\n\n<p>Assuming the above implementation, address of 'obj' is really an address of the pointer to the virtual table. The example uses assumes that the function pointers can be represented as <code>int</code>s. It is simply not true for 64-bit OS and many others.  And <code>int *vptr</code> is a pointer to this array. So, <em>obj</em> points to a pointer to an array of int's <code>(int**)</code>. Consequently,  <code>*(int**)obj</code> is the pointer to the array itself.</p>\n\n<p>The example then does another unsafe conversion from the vptr[0] (which is 'int') to a pointer to the function.</p>\n\n<p>So, as a result you have a series of undefined or unsafe behaviors which could work for a particular implementation of a particular version of a particular compiler (probably 10 years old, same as the article). </p>\n\n<p>DO NOT USE IT!!!</p>\n"}], "owner": {"reputation": 13, "user_id": 3774426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec30c977be09cd45c544c2366795897a?s=128&d=identicon&r=PG&f=1", "display_name": "user3774426", "link": "https://stackoverflow.com/users/3774426/user3774426"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1546496607, "accepted_answer_id": 54011642, "answer_count": 1, "score": -3, "last_activity_date": 1546455046, "creation_date": 1546450104, "question_id": 54010650, "link": "https://stackoverflow.com/questions/54010650/understand-the-pointer-pointer-in-c-to-get-the-function-call", "closed_reason": "Needs details or clarity", "title": "understand the pointer pointer in c++ to get the function call", "body": "<p>I am little confused about the pointer statement in the following code.\nThe purpose of the pointer is to access the virtual function from virtual table.here is link of the article.\n<a href=\"http://kaisar-haque.blogspot.com/2008/07/c-accessing-virtual-table.html\" rel=\"nofollow noreferrer\">http://kaisar-haque.blogspot.com/2008/07/c-accessing-virtual-table.html</a></p>\n\n<pre><code>1 #include &lt;iostream&gt;\n  2\n  3 using namespace std;\n  4\n  5 //a simple class\n  6 class X\n  7 {\n  8 public:\n  9  //fn is a simple virtual function\n 10  virtual void fn()\n 11  {\n 12   cout &lt;&lt; \"n = \" &lt;&lt; n &lt;&lt; endl;\n 13  }\n 14\n 15  //a member variable\n 16  int n;\n 17 };\n 18\n 19 int main()\n 20 {\n 21  //create an object (obj) of class X\n 22  X *obj = new X();\n 23  obj-&gt;n = 10;\n 24\n 25  //get the virtual table pointer of object obj\n 26  int* vptr =  *(int**)obj;\n 27\n 28  // we shall call the function fn, but first the following assembly code\n 29  //  is required to make obj as 'this' pointer as we shall call\n 30  //  function fn() directly from the virtual table\n 31  __asm\n 32  {\n 33   mov ecx, obj\n 34  }\n 35\n 36  //function fn is the first entry of the virtual table, so it's vptr[0]\n 37  ( (void (*)()) vptr[0] )();\n 38\n 39  //the above is the same as the following\n 40  //obj-&gt;fn();\n 41\n 42  return 0;\n 43 }\n 44 \n</code></pre>\n\n<p>so, i want to know the how to understand the line number 26.</p>\n"}, {"tags": ["c++", "templates", "template-specialization", "specialization"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1546451677, "post_id": 54010630, "comment_id": 94858612, "body": "One alternative is to have tag and then use overload:: <code>template &lt;typename T&gt; struct tag{}; template &lt;typename T&gt; Wrapper&lt;T&gt; build_wrapped(tag&lt;T&gt;) { return Wrapper&lt;T&gt;{{}};} ExtendedWrapper build_wrapped(tag&lt;Foo&gt;) { return ExtendedWrapper{{}};}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 4396517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d20a12a0638586b073d44e2fe1ba41?s=128&d=identicon&r=PG&f=1", "display_name": "user44168", "link": "https://stackoverflow.com/users/4396517/user44168"}, "edited": false, "score": 0, "creation_date": 1546450489, "post_id": 54010678, "comment_id": 94858140, "body": "Good catch! Thanks!"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 185, "user_id": 4396517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d20a12a0638586b073d44e2fe1ba41?s=128&d=identicon&r=PG&f=1", "display_name": "user44168", "link": "https://stackoverflow.com/users/4396517/user44168"}, "edited": false, "score": 1, "creation_date": 1546450677, "post_id": 54010678, "comment_id": 94858225, "body": "@user44168 If the answer solved your problem you should mark it as accepted to indicate that (and give the person answering a bit of rep), not just comment &quot;good catch&quot;."}, {"owner": {"reputation": 185, "user_id": 4396517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d20a12a0638586b073d44e2fe1ba41?s=128&d=identicon&r=PG&f=1", "display_name": "user44168", "link": "https://stackoverflow.com/users/4396517/user44168"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546451334, "post_id": 54010678, "comment_id": 94858486, "body": "@JesperJuhl yeah, well, SO forces you to wait until 10 minutes had passed since posting before you can accept."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 4, "last_activity_date": 1546450240, "creation_date": 1546450240, "answer_id": 54010678, "question_id": 54010630, "link": "https://stackoverflow.com/questions/54010630/how-to-use-derived-type-in-specialisation-of-return-type-function-template-co/54010678#54010678", "title": "How to use derived type in specialisation of return-type function template? (&quot;couldn&#39;t infer template argument&quot;)", "body": "<p>The compiler already told you what the problem is:</p>\n\n<blockquote>\n  <p>note: candidate template ignored: couldn't infer template argument 'T'</p>\n</blockquote>\n\n<p>You need to specify the template parameter explicitly.</p>\n\n<pre><code>template &lt;&gt;\ntypename ReturnType&lt;Foo&gt;::type build_wrapped&lt;Foo&gt;()\n{ //                                        ^~~~~\n    Foo t{};\n    return typename ReturnType&lt;Foo&gt;::type(t);\n}\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 4396517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d20a12a0638586b073d44e2fe1ba41?s=128&d=identicon&r=PG&f=1", "display_name": "user44168", "link": "https://stackoverflow.com/users/4396517/user44168"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 54010678, "answer_count": 1, "score": 0, "last_activity_date": 1546450240, "creation_date": 1546449998, "question_id": 54010630, "link": "https://stackoverflow.com/questions/54010630/how-to-use-derived-type-in-specialisation-of-return-type-function-template-co", "title": "How to use derived type in specialisation of return-type function template? (&quot;couldn&#39;t infer template argument&quot;)", "body": "<p>I have a template class and a function with a template return type:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass Wrapper {\npublic:\n    Wrapper(const T&amp; _data) : data(_data) { }\n\n    const T&amp; get_data() {return data;};\nprivate:\n    T data;\n};\n\ntemplate &lt;typename T&gt;\nWrapper&lt;T&gt; build_wrapped(){\n    T t{};\n    return Wrapper&lt;T&gt;(t);\n}\n</code></pre>\n\n<p>Suppose that I want to extend the returned <code>Wrapper</code> for one specific type <code>T</code> and specialise the <code>build_wrapped()</code> function for the type. So, let's create a template to hold the return type and use it in <code>build_wrapped()</code>:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct ReturnType {\n    using type = Wrapper&lt;T&gt;;\n};\n\ntemplate &lt;typename T&gt;\ntypename ReturnType&lt;T&gt;::type build_wrapped(){\n    T t{};\n    return typename ReturnType&lt;T&gt;::type(t);\n}\n</code></pre>\n\n<p>And use it to provide the specialization:</p>\n\n<pre><code>struct Foo{};\n\nclass ExtendedWrapper : public Wrapper&lt;Foo&gt; {\npublic:\n    ExtendedWrapper(const Foo&amp; _data) : Wrapper(_data) {}\n    int get_answer() {return 42;};\n};\n\ntemplate&lt;&gt;\nstruct ReturnType&lt;Foo&gt; {\n    using type = ExtendedWrapper;\n};\n\ntemplate&lt;&gt;\ntypename ReturnType&lt;Foo&gt;::type build_wrapped(){\n    Foo t{};\n    return typename ReturnType&lt;Foo&gt;::type(t);\n}\n</code></pre>\n\n<p>However, the final declaration is rejected by both gcc and clang. For example, <a href=\"https://godbolt.org/z/8rITN4\" rel=\"nofollow noreferrer\">clang</a> returns:</p>\n\n<blockquote>\n  <p>error: no function template matches function template specialization\n  'build_wrapped'</p>\n  \n  <p>note: candidate template ignored: couldn't infer template argument 'T'</p>\n</blockquote>\n\n<p>I can get around using <code>ReturnType</code> by creating an explicit specialisation of <code>Wrapper</code> for <code>Foo</code>. However, this requires duplicating all the code in <code>Wrapper</code> (in my real life case it's a substantial class), when I just want to add some new functionality (as in <code>ExtendedWrapper</code>). So, can this be done? What's wrong with the approach above?</p>\n"}, {"tags": ["c++", "stdvector", "std-variant"], "comments": [{"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 1, "creation_date": 1546448213, "post_id": 54010188, "comment_id": 94857191, "body": "Having a reference to something implies having that thing. You don&#39;t have any <code>std::vector&lt;MType&gt;</code> in your code, therefore you cannot have any <code>std::vector&lt;MType&gt;&amp;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 314, "user_id": 5977575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60dce2092d74e1bb099a8dc62a2c08ae?s=128&d=identicon&r=PG&f=1", "display_name": "StephanH", "link": "https://stackoverflow.com/users/5977575/stephanh"}, "edited": false, "score": 0, "creation_date": 1546448918, "post_id": 54010293, "comment_id": 94857498, "body": "Thank you, I can use variant&lt;vector&lt;int&gt;, vector&lt;double&gt;&gt; instead"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 314, "user_id": 5977575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60dce2092d74e1bb099a8dc62a2c08ae?s=128&d=identicon&r=PG&f=1", "display_name": "StephanH", "link": "https://stackoverflow.com/users/5977575/stephanh"}, "edited": false, "score": 1, "creation_date": 1546448969, "post_id": 54010293, "comment_id": 94857522, "body": "@StephanH Okay. Before we go I would caution that this seems potentially unusual and you should double-check that your design is as it should be. Not that I&#39;ve <i>never</i> put vectors in variants though!"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 4, "last_activity_date": 1546448460, "creation_date": 1546448460, "answer_id": 54010293, "question_id": 54010188, "link": "https://stackoverflow.com/questions/54010188/c2017-reference-to-stdvectorstdvariant/54010293#54010293", "title": "C++2017 Reference to std::vector&lt;std::variant&gt;", "body": "<p>You can assign an <code>int</code> to a <code>variant&lt;int, double&gt;</code>, and you can assign a <code>double</code> to a <code>variant&lt;int, double&gt;</code>, but neither <em>is</em> a <code>variant&lt;int, double&gt;</code> and a <code>vector&lt;variant&lt;int, double&gt;&gt;</code> is not a <code>vector&lt;int&gt;</code> or a <code>vector&lt;double&gt;</code>.</p>\n\n<p>You simply can't do this.</p>\n\n<p>Is it possible that you meant <code>variant&lt;vector&lt;int&gt;, vector&lt;double&gt;&gt;</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1546455012, "creation_date": 1546455012, "answer_id": 54011638, "question_id": 54010188, "link": "https://stackoverflow.com/questions/54010188/c2017-reference-to-stdvectorstdvariant/54011638#54011638", "title": "C++2017 Reference to std::vector&lt;std::variant&gt;", "body": "<blockquote>\n  <p>I can create a <code>const std::variant&amp;</code> to a element of a vector,</p>\n</blockquote>\n\n<p>With</p>\n\n<pre><code>const MType&amp; refVar = intVec[0];\n</code></pre>\n\n<p>you don't create reference to element of <code>intVec</code> but create a temporary (with life time extension).</p>\n\n<p>So it is basically:</p>\n\n<pre><code>const std::variant&lt;int, double&gt; var = intVec[0];\n</code></pre>\n\n<blockquote>\n  <p>but i struggle to store the reference to the whole vector</p>\n</blockquote>\n\n<p>In the same way with <code>std::vector</code>, you might create a <code>std::vector&lt;std::variant&lt;int, double&gt;&gt;</code>:</p>\n\n<pre><code>std::vector&lt;std::variant&lt;int, double&gt;&gt; varVec(intVec.begin(), intVec.end());\n</code></pre>\n"}], "owner": {"reputation": 314, "user_id": 5977575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60dce2092d74e1bb099a8dc62a2c08ae?s=128&d=identicon&r=PG&f=1", "display_name": "StephanH", "link": "https://stackoverflow.com/users/5977575/stephanh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1546455224, "creation_date": 1546447970, "last_edit_date": 1546455224, "question_id": 54010188, "link": "https://stackoverflow.com/questions/54010188/c2017-reference-to-stdvectorstdvariant", "title": "C++2017 Reference to std::vector&lt;std::variant&gt;", "body": "<p>I try to store a reference to a <code>std::vector</code> consisting of <code>std::variant</code>.\nI can create a <code>const std::variant&lt;T&gt;&amp;</code> to a element of a <code>vector</code>, but I struggle to store the reference to the whole vector. I guess that the answer is related to this post <a href=\"https://stackoverflow.com/questions/41139135/c-variant-class-member-stored-by-reference\">c++ variant class member stored by reference</a> but I am not able to apply it to my situation.</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;variant&gt;\n\nusing MType = std::variant&lt;int, double&gt;;\nint main()\n{\n      std::vector&lt;int&gt; intVec{ 1,2,3,4 };\n      std::vector&lt;double&gt; dlVec{ 1.1,2.2,3.3,4.4 };\n\n      const MType&amp; refVar = intVec[0];\n      // const std::vector&lt;MType&gt;&amp; refVec = intVec; // compiler error: not suitable construction \n}\n</code></pre>\n"}, {"tags": ["c++", "thread-safety", "ld", "suppress-warnings", "devkitpro"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1546447896, "post_id": 54010151, "comment_id": 94857022, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please. What is <code>Tested</code>? Certainly function-statics are still expected to work overall."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1546448671, "post_id": 54010151, "comment_id": 94857395, "body": "Code doesn&#39;t even compile due to this <code>void testFunction(arg)</code>. Once fixed, <a href=\"http://coliru.stacked-crooked.com/a/638fe03b3046da53\" rel=\"nofollow noreferrer\">norepro with GCC 8.1</a> but you did say it started in 8.2. Have you looked on Bugzilla? Bear in mind <a href=\"https://gcc.gnu.org/develop.html\" rel=\"nofollow noreferrer\">8.2.0 indicates a development/trunk build</a>, not a real, specific version. Have you tried with <a href=\"https://www.gnu.org/software/gcc/gcc-8/\" rel=\"nofollow noreferrer\">the actual releases 8.2.1 or 8.2.2</a>?"}, {"owner": {"reputation": 2493, "user_id": 15304, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f814654faae23dc2e0d7da97ead044b8?s=128&d=identicon&r=PG", "display_name": "PypeBros", "link": "https://stackoverflow.com/users/15304/pypebros"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546448791, "post_id": 54010151, "comment_id": 94857449, "body": "I noted something pretty suspicious in <a href=\"https://github.com/devkitPro/buildscripts/blob/master/dkarm-eabi/patches/newlib-3.0.0.patch\" rel=\"nofollow noreferrer\">github.com/devkitPro/buildscripts/blob/master/dkarm-eabi/&hellip;</a> that I&#39;m using to link this. Apparently that&#39;s the non-GNU library that has no support for this function despite the compiler write code that calls it."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546448889, "post_id": 54010151, "comment_id": 94857488, "body": "I really don&#39;t know where you want us to look in that 8289-line (!) file"}, {"owner": {"reputation": 2493, "user_id": 15304, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f814654faae23dc2e0d7da97ead044b8?s=128&d=identicon&r=PG", "display_name": "PypeBros", "link": "https://stackoverflow.com/users/15304/pypebros"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546448953, "post_id": 54010151, "comment_id": 94857513, "body": "sorry. <a href=\"https://github.com/devkitPro/buildscripts/blob/master/dkarm-eabi/patches/newlib-3.0.0.patch#L7945\" rel=\"nofollow noreferrer\">github.com/devkitPro/buildscripts/blob/master/dkarm-eabi/&hellip;</a> line 7945 has a match for the &quot;legacy ...&quot; error message."}, {"owner": {"reputation": 2493, "user_id": 15304, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f814654faae23dc2e0d7da97ead044b8?s=128&d=identicon&r=PG", "display_name": "PypeBros", "link": "https://stackoverflow.com/users/15304/pypebros"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546449673, "post_id": 54010151, "comment_id": 94857803, "body": "just tried with g++-8 package from ubuntu LTS. did not reproduced. Suggests that the issue is indeed with the devkitpro flavour of newlib rather than with GNU ld itself."}, {"owner": {"reputation": 2493, "user_id": 15304, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f814654faae23dc2e0d7da97ead044b8?s=128&d=identicon&r=PG", "display_name": "PypeBros", "link": "https://stackoverflow.com/users/15304/pypebros"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546449803, "post_id": 54010151, "comment_id": 94857854, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/186060/discussion-between-pypebros-and-lightness-races-in-orbit\">continue this discussion in chat</a>."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1547462794, "post_id": 54010151, "comment_id": 95188257, "body": "@LightnessRacesinOrbit you have it exactly backwards, 8.2.0 is an official release. 8.1.0 is the first release from the 8.x branch, 8.2.0 is the second. And 8.2.1 is an unreleased snapshot from the gcc-8-branch some time after 8.2.0 and before 8.3.0"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1547462889, "post_id": 54010151, "comment_id": 95188317, "body": "@JonathanWakely Interesting - have I always been wrong on that or has version policy changed? I always thought x.y.0 was a placeholder for pre-release trunk builds in GCC, and that x.y.1 was the first real release. Could be I&#39;m thinking of x.0.z? <i>(edit: <a href=\"https://gcc.gnu.org/develop.html\" rel=\"nofollow noreferrer\">yes, I am</a>)</i>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1547462958, "post_id": 54010151, "comment_id": 95188355, "body": "@JonathanWakely Either way thanks for the correction - that suggests there is either a bug in what turns out to be a real release 8.2.0 or something else is afoot."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1547463162, "post_id": 54010151, "comment_id": 95188482, "body": "@LightnessRacesinOrbit you&#39;ve always been wrong on that. It&#39;s been that way since the new <a href=\"https://gcc.gnu.org/develop.html#num_scheme\" rel=\"nofollow noreferrer\">numbering scheme</a> introduced with gcc 5, and was completely different before (there was no part of the x.y.z number that distinguished &quot;release&quot; vs &quot;snapshot&quot;, that&#39;s the benefit of the new scheme). x.0.0 is a trunk build, x.0.1 is a pre-release shortly after trunk branches for a new release, and the scheme doesn&#39;t permit x.0.z with z &gt; 1."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1547463357, "post_id": 54010151, "comment_id": 95188585, "body": "@JonathanWakely Cool cool. FWIW, I like the scheme, even if I don&#39;t always remember it accurately ;)"}, {"owner": {"reputation": 338, "user_id": 132620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d03d44b1aff07924c672aea9ace7176?s=128&d=identicon&r=PG", "display_name": "WinterMute", "link": "https://stackoverflow.com/users/132620/wintermute"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1547477274, "post_id": 54010151, "comment_id": 95195752, "body": "@LightnessRacesinOrbit It&#39;s not a bug, no. It&#39;s simply a toolchain that supports armv4t and multithreading for other platforms. OP is slightly confused."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 338, "user_id": 132620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d03d44b1aff07924c672aea9ace7176?s=128&d=identicon&r=PG", "display_name": "WinterMute", "link": "https://stackoverflow.com/users/132620/wintermute"}, "edited": false, "score": 0, "creation_date": 1547477304, "post_id": 54010151, "comment_id": 95195775, "body": "@WinterMute Got it. I have learned this from Jonathan&#39;s answer!"}, {"owner": {"reputation": 2493, "user_id": 15304, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f814654faae23dc2e0d7da97ead044b8?s=128&d=identicon&r=PG", "display_name": "PypeBros", "link": "https://stackoverflow.com/users/15304/pypebros"}, "reply_to_user": {"reputation": 338, "user_id": 132620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d03d44b1aff07924c672aea9ace7176?s=128&d=identicon&r=PG", "display_name": "WinterMute", "link": "https://stackoverflow.com/users/132620/wintermute"}, "edited": false, "score": 0, "creation_date": 1547477618, "post_id": 54010151, "comment_id": 95195960, "body": "@WinterMute, any chance multithreading was enabled &quot;recently&quot; on that toolchain ? (e.g. to support Switch development ?)"}, {"owner": {"reputation": 338, "user_id": 132620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d03d44b1aff07924c672aea9ace7176?s=128&d=identicon&r=PG", "display_name": "WinterMute", "link": "https://stackoverflow.com/users/132620/wintermute"}, "edited": false, "score": 0, "creation_date": 1547564931, "post_id": 54010151, "comment_id": 95230043, "body": "@PypeBros No. Switch uses devkitA64, not devkitARM. Recent gcc versions comply with newer standards."}], "answers": [{"tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": false, "score": 4, "last_activity_date": 1547463769, "creation_date": 1547463769, "answer_id": 54180253, "question_id": 54010151, "link": "https://stackoverflow.com/questions/54010151/what-can-i-do-about-gnu-ld-legacy-sync-synchronize-warning/54180253#54180253", "title": "what can I do about GNU ld &#39;legacy __sync_synchronize&#39; warning?", "body": "<p>You're getting a linker warning, generated by that version of newlib, to tell you that your application has calls to <code>__sync_synchronize</code> and that there is no implementation of that function that actually synchronizes. The implementation of that function in newlib is a stub that does nothing (it probably just exists to ensure there are no undefined references to that function).</p>\n\n<p>Those calls probably come from within <code>libstdc++.so</code>, as GCC on ARM will emit calls to <code>__sync_synchronize</code> for some atomic operations that happen inside the library (e.g. reference count updates in <code>std::string</code> or <code>shared_ptr</code> objects).</p>\n\n<p>To get a working <code>__sync_synchronize</code> that makes the atomics correct you probably need to link to <code>libatomic</code> (using <code>-latomic</code>) which will have an implementation of that function. Because you aren't linking to that, you get the fallback stub implementation in newlib. If you don't need synchronized atomics (because your application is single-threaded and never tries to update atomics in signal handlers) then I think you can ignore the warning.</p>\n\n<p>Another option would be to use a build of libstdc++.so that explicitly disables all threading, and in theory that wouldn't have any references to <code>__sync_synchronize</code>. But that build of libstdc++.so could only ever be used for single-threaded applications. The build you're using now can be used for both single-threaded and multi-threaded code (even if you get this warning that isn't very relevant for single-threaded cases).</p>\n"}, {"tags": [], "owner": {"reputation": 338, "user_id": 132620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d03d44b1aff07924c672aea9ace7176?s=128&d=identicon&r=PG", "display_name": "WinterMute", "link": "https://stackoverflow.com/users/132620/wintermute"}, "is_accepted": false, "score": -2, "last_activity_date": 1547563719, "creation_date": 1547563719, "answer_id": 54201251, "question_id": 54010151, "link": "https://stackoverflow.com/questions/54010151/what-can-i-do-about-gnu-ld-legacy-sync-synchronize-warning/54201251#54201251", "title": "what can I do about GNU ld &#39;legacy __sync_synchronize&#39; warning?", "body": "<p>It would have been better for you to wait on a reply at <a href=\"https://devkitpro.org/viewtopic.php?f=13&amp;t=8822#p16213\" rel=\"nofollow noreferrer\">https://devkitpro.org/viewtopic.php?f=13&amp;t=8822#p16213</a> rather than asking on a site where most people aren't familiar with devkitARM.</p>\n\n<p>tl;dr; compile your code with -fno-threadsafe-statics &amp; don't worry about it.</p>\n"}], "owner": {"reputation": 2493, "user_id": 15304, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f814654faae23dc2e0d7da97ead044b8?s=128&d=identicon&r=PG", "display_name": "PypeBros", "link": "https://stackoverflow.com/users/15304/pypebros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547563719, "creation_date": 1546447807, "last_edit_date": 1546448903, "question_id": 54010151, "link": "https://stackoverflow.com/questions/54010151/what-can-i-do-about-gnu-ld-legacy-sync-synchronize-warning", "title": "what can I do about GNU ld &#39;legacy __sync_synchronize&#39; warning?", "body": "<p>I have some C++ code that uses a local-scope, program-lifetime object, e.g.</p>\n\n<pre><code>void testFunction(int arg) {\n   static Tested tested(0);\n   tested.use(arg);\n}\n</code></pre>\n\n<p>which built fine with older versions of GCC.\nWith GCC 8.2.0, I get a puzzling warning at link time:</p>\n\n<p><em>warning: legacy compatible __sync_synchronize used. Not suitable for multi-threaded applications</em></p>\n\n<p>It points the line defining tested, and indeed there is a call to __sync_synchronize() that has been generated by the compiler. I guess it is there to ensure that no two threads could run the initializing code at the same time and have the lazy initialization produce the same result as if there was load-time initialization.</p>\n\n<p>Issue is reproduced with this implementation of the Tested class:</p>\n\n<pre><code>class Tested {\n  int sum;\npublic:\n  Tested(int init) : sum(init) {}\n  void use(int arg) {\n    sum += arg;\n  }\n  int current() const {\n    return sum;\n  }\n};\n</code></pre>\n\n<p>This code is expected to run on a mono-thread embedded platform.</p>\n\n<p>Am I right believing that the warning is not relevant for me ?</p>\n\n<p>What can I do (beside stopping using the static object) to get rid of the warning message ?</p>\n"}, {"tags": ["c++", "c++11", "variadic-templates"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6523086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95aa98dad78d8c36e6b8ade589639300?s=128&d=identicon&r=PG", "display_name": "ABotella", "link": "https://stackoverflow.com/users/6523086/abotella"}, "edited": false, "score": 0, "creation_date": 1546450679, "post_id": 54010095, "comment_id": 94858226, "body": "Thanks! Can this class be a friend from another one? <code>class Foo{template &lt;unsigned int, class...&gt; friend class CompleteBuilder};</code>"}, {"owner": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "reply_to_user": {"reputation": 61, "user_id": 6523086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95aa98dad78d8c36e6b8ade589639300?s=128&d=identicon&r=PG", "display_name": "ABotella", "link": "https://stackoverflow.com/users/6523086/abotella"}, "edited": false, "score": 0, "creation_date": 1546450826, "post_id": 54010095, "comment_id": 94858278, "body": "@ABotella - yes, it can"}], "tags": [], "owner": {"reputation": 10521, "user_id": 1316462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de3149d5f602449f41083ca17a5ceab?s=128&d=identicon&r=PG&f=1", "display_name": "Jans", "link": "https://stackoverflow.com/users/1316462/jans"}, "is_accepted": true, "score": 0, "last_activity_date": 1546447569, "creation_date": 1546447569, "answer_id": 54010095, "question_id": 54009911, "link": "https://stackoverflow.com/questions/54009911/multiple-templated-variadic-templates/54010095#54010095", "title": "Multiple templated variadic templates", "body": "<p>Based on the specialization you have of <code>CompleteBuilder</code>; your primary template needs to be defined like this</p>\n\n<pre><code>template &lt;unsigned int dim, class... T&gt;\nclass CompleteBuilder;\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6523086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95aa98dad78d8c36e6b8ade589639300?s=128&d=identicon&r=PG", "display_name": "ABotella", "link": "https://stackoverflow.com/users/6523086/abotella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 54010095, "answer_count": 1, "score": 0, "last_activity_date": 1546447705, "creation_date": 1546446900, "last_edit_date": 1546447705, "question_id": 54009911, "link": "https://stackoverflow.com/questions/54009911/multiple-templated-variadic-templates", "title": "Multiple templated variadic templates", "body": "<p>I would like to use two templated parameter packs but I do not know how to do it. I read a lot of other StackOverflow posts but not one with templated parameter pack.</p>\n\n<pre><code>template &lt; template &lt; unsigned int &gt; class... EntityList &gt;\nstruct Entities{};\n\ntemplate &lt; template &lt; unsigned int &gt; class... EntityBuilderList &gt;\nstruct EntityBuilders{};\n\ntemplate &lt; unsigned int dim, template &lt; unsigned int &gt; class... T &gt;\nclass CompleteBuilder;\n\ntemplate &lt; unsigned int dim, template &lt; unsigned int &gt; class... EntityList, \n    template &lt; unsigned int &gt; class... EntityBuilderList &gt;\nclass CompleteBuilder&lt; dim, Entities&lt; EntityList...&gt;, EntityBuilders&lt; EntityBuilderList...&gt; &gt;\n    : public EntityBuilderList&lt; dim &gt;...\n{};\n</code></pre>\n\n<p>Then, I would  like to use it like <code>CompleteBuilder&lt; 3, Entities&lt; A, B, C &gt;, EntityBuilders&lt; Ab, Bb, Cb &gt; &gt; builder</code>. But I have this error: </p>\n\n<pre><code>error: type/value mismatch at argument 2 in template parameter list for \u2018template&lt;unsigned int dim, template&lt;unsigned int &lt;anonymous&gt; &gt; class ... T&gt; class CompleteBuilder\u2019\n class CompleteBuilder&lt; dim, Entities&lt; EntityList...&gt;, EntityBuilders&lt; EntityBuilderList...&gt; &gt;\n                                                                                                            ^\nnote:   expected a class template, got \u2018Entities&lt;EntityList ...&gt;\u2019\n</code></pre>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["c++", "windows", "console", "console-application"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546446666, "post_id": 54009804, "comment_id": 94856404, "body": "What does your program look like? How is it structured? How are you currently accepting input?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546447373, "post_id": 54009804, "comment_id": 94856761, "body": "Try to avoid calling <code>system</code> - ever. It doesn&#39;t give you very much control and its use is riddled with security risks. There are always better options."}, {"owner": {"reputation": 777, "user_id": 2920692, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76b9c1c524d561324236dec1ffc6ad7e?s=128&d=identicon&r=PG&f=1", "display_name": "NotepadPlusPlus PRO", "link": "https://stackoverflow.com/users/2920692/notepadplusplus-pro"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546447424, "post_id": 54009804, "comment_id": 94856787, "body": "it is just a console application. @JesperJuhl what are the other options?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546447570, "post_id": 54009804, "comment_id": 94856852, "body": "@Cricrazy On Unix/posix like operating systems; <code>fork</code> + one of the <code>exec</code> family of calls is <i>one</i> way to get more control (over the shell that&#39;ll run your program, its environment, its input and output etc)."}, {"owner": {"reputation": 777, "user_id": 2920692, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76b9c1c524d561324236dec1ffc6ad7e?s=128&d=identicon&r=PG&f=1", "display_name": "NotepadPlusPlus PRO", "link": "https://stackoverflow.com/users/2920692/notepadplusplus-pro"}, "edited": false, "score": 0, "creation_date": 1546448315, "post_id": 54009804, "comment_id": 94857240, "body": "I am on windows 10, and not very familiar with Unix system."}, {"owner": {"reputation": 462, "user_id": 4068350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oJi3Pk7K-r8/AAAAAAAAAAI/AAAAAAAAAVk/Su6nDLc_WVM/photo.jpg?sz=128", "display_name": "aybassiouny", "link": "https://stackoverflow.com/users/4068350/aybassiouny"}, "edited": false, "score": 0, "creation_date": 1546451112, "post_id": 54009804, "comment_id": 94858397, "body": "Typing <code>EXIT&lt;Enter&gt;</code> is not a signal and therefore it&#39;s not a handled by your snippet above - it&#39;s probably handled by some other code not shared yet. My guess is, it&#39;s getting passed on to the console as is, and console is exiting on your behalf, and some preprocessing should be done first if you wanna skip that."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1546453081, "post_id": 54009804, "comment_id": 94859189, "body": "<i>how to trap if the user types EXIT and press ENTER.</i> you need somehow handle user input. say call <code>ReadConsole</code> and based on string which user enter - do something"}, {"owner": {"reputation": 777, "user_id": 2920692, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76b9c1c524d561324236dec1ffc6ad7e?s=128&d=identicon&r=PG&f=1", "display_name": "NotepadPlusPlus PRO", "link": "https://stackoverflow.com/users/2920692/notepadplusplus-pro"}, "edited": false, "score": 0, "creation_date": 1546454262, "post_id": 54009804, "comment_id": 94859642, "body": "it definitely seems harder that I thought."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1546492292, "post_id": 54009804, "comment_id": 94869970, "body": "If the user types EXIT, how that&#39;s handled is entirely up to the program. This has nothing to do with the console, other than that the program is reading input from the console."}], "owner": {"reputation": 777, "user_id": 2920692, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76b9c1c524d561324236dec1ffc6ad7e?s=128&d=identicon&r=PG&f=1", "display_name": "NotepadPlusPlus PRO", "link": "https://stackoverflow.com/users/2920692/notepadplusplus-pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546446424, "creation_date": 1546446424, "question_id": 54009804, "link": "https://stackoverflow.com/questions/54009804/trap-console-close-event-when-the-user-types-exit-and-press-enter", "title": "Trap Console Close event When the User types EXIT and press ENTER", "body": "<p>I am modifying a console application in <code>C++</code>. I need to do some clean up when the user types <code>EXIT&lt;ENTER&gt;</code> or press <code>X</code> (i.e. Close) button on top right corner. </p>\n\n<p>I am able to trap console exit when user presses <code>X</code> (close) button as follows:</p>\n\n<pre><code>case CTRL_C_EVENT:\n        fprintf(stderr, \"Ctrl-C is Pressed\\n\");\n        return TRUE;\n    case CTRL_BREAK_EVENT:\n        fprintf(stderr, \"Ctrl-Break is Pressed\\n\");\n        return TRUE;\n\n    case CTRL_CLOSE_EVENT:\n    case CTRL_LOGOFF_EVENT:\n    case CTRL_SHUTDOWN_EVENT:\n        system(cleanup_cmd.c_str());\n</code></pre>\n\n<p>But I cannot figure out how to trap if the user types <code>EXIT</code> and press <code>ENTER</code>.</p>\n\n<p>Can you please help? I did some research here on StackOverFlow. There are number of threads that ask about closing console window with <code>X</code> button. But I could not find any when user actually types <code>EXIT</code>. I apologize if it is a duplicate. </p>\n"}, {"tags": ["c++", "variables", "keyboard", "numbers"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1546446468, "post_id": 54009787, "comment_id": 94856300, "body": "Your question don&#39;t have an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so it is not very clear. Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>. Maybe you want to use <a href=\"https://www.gnu.org/software/ncurses/\" rel=\"nofollow noreferrer\">ncurses</a> (since the standard input is <i>not</i> the keyboard)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9586973, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d9FkzLTq3Sg/AAAAAAAAAAI/AAAAAAAAB9M/V5FLdfxmTZI/photo.jpg?sz=128", "display_name": "Tr19", "link": "https://stackoverflow.com/users/9586973/tr19"}, "edited": false, "score": 0, "creation_date": 1546456152, "post_id": 54011210, "comment_id": 94860395, "body": "It works! Thanks! ;)"}], "tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": true, "score": 1, "last_activity_date": 1546452880, "creation_date": 1546452880, "answer_id": 54011210, "question_id": 54009787, "link": "https://stackoverflow.com/questions/54009787/how-can-a-read-a-variable-number-of-variable-from-the-keyboard-c/54011210#54011210", "title": "How can a read a variable number of variable from the keyboard? C++", "body": "<p>To read two variables from the console:  </p>\n\n<pre><code>int variable_1;\nint variable_2;\nstd::cin &gt;&gt; variable_1 &gt;&gt; variable_2;\n</code></pre>\n\n<p>If the second variable is optional, your best method is to read one line at a time, then parse the line:  </p>\n\n<pre><code>std::string text;\nwhile (std::getline(std::cin, text))\n{\n  std::istringstream input(text);\n  input &gt;&gt; variable_1;\n  if (input &gt;&gt; variable_2)\n  {\n     // Do stuff with variable_2\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9586973, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d9FkzLTq3Sg/AAAAAAAAAAI/AAAAAAAAB9M/V5FLdfxmTZI/photo.jpg?sz=128", "display_name": "Tr19", "link": "https://stackoverflow.com/users/9586973/tr19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1546500151, "accepted_answer_id": 54011210, "answer_count": 1, "score": -1, "last_activity_date": 1546452880, "creation_date": 1546446334, "last_edit_date": 1546447073, "question_id": 54009787, "link": "https://stackoverflow.com/questions/54009787/how-can-a-read-a-variable-number-of-variable-from-the-keyboard-c", "closed_reason": "Needs details or clarity", "title": "How can a read a variable number of variable from the keyboard? C++", "body": "<p>I want to read one or two values from keyboard, the first one represents the <code>length_min</code> and the second one is the <code>length_max</code>. In the input stream I can get one value and I can check if there's another value using <code>cin.get()</code>, but when I read one number from keyboard, I have to introduce another character to print the correct values.</p>\n\n<p>The template for reading:</p>\n\n<p><code>length + 'length_min'</code> and/or not <code>'length_max'</code> (read <code>length_max</code> if in that line exists another digits after <code>length_min</code>).</p>\n\n<pre><code>string length;\ncin &gt;&gt; length;\n\nint length_min, length_max;\ncin &gt;&gt; length_min;\n\ncin.ignore();  // there's a whitespace between length_min and length_max\nchar c = cin.get();\n\nif (isdigit(c)) // I verified if there's a digit which represents the length_max\n{\n    ungetc(c, stdin);\n    cin &gt;&gt; length_max;\n}\nelse\n{\n    cin.ignore(); // if there's no digit go to next line in input stream \n    length_max = 0;\n}\n</code></pre>\n\n<p>For these examples: </p>\n\n<p><code>length 5 8</code> -> it prints <code>5 8</code></p>\n\n<p><code>length 5 + any character</code> -> it prints <code>5 0</code></p>\n\n<p>I what to get rid of that additional character, but I'm not sure how.</p>\n"}, {"tags": ["c++", "c", "traminer"], "answers": [{"comments": [{"owner": {"reputation": 3038, "user_id": 1586731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/17OGA.jpg?s=128&g=1", "display_name": "Gilbert", "link": "https://stackoverflow.com/users/1586731/gilbert"}, "edited": false, "score": 0, "creation_date": 1546849602, "post_id": 54009897, "comment_id": 94974244, "body": "You also find the distancefunctions.cpp file in the src folder in the in the .tar.gz file available on the CRAN."}], "tags": [], "owner": {"reputation": 592, "user_id": 6672815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6c8d74588b5dbf028aeed0e33b8ee5?s=128&d=identicon&r=PG&f=1", "display_name": "virgesmith", "link": "https://stackoverflow.com/users/6672815/virgesmith"}, "is_accepted": false, "score": 1, "last_activity_date": 1546446796, "creation_date": 1546446796, "answer_id": 54009897, "question_id": 54009663, "link": "https://stackoverflow.com/questions/54009663/c-cstringrefseqdistance-and-c-cstringdistance-functions-in-traminer-r-package/54009897#54009897", "title": "C_cstringrefseqdistance and C_cstringdistance functions in TraMineR R package", "body": "<p>The traminer package source is here <a href=\"https://github.com/cran/TraMineR\" rel=\"nofollow noreferrer\">https://github.com/cran/TraMineR</a></p>\n\n<p>The functions you are looking for are in this source file: <a href=\"https://github.com/cran/TraMineR/blob/8db14382ec387d32470c21edd6f473217522c241/src/distancefunctions.cpp\" rel=\"nofollow noreferrer\">https://github.com/cran/TraMineR/blob/8db14382ec387d32470c21edd6f473217522c241/src/distancefunctions.cpp</a></p>\n\n<p>Note the C_ prefix is R automagic, the C functions are actually <code>cstringrefseqdistance</code> and <code>cstringdistance</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 3284568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697e5c675479ce919847430f2fe69be?s=128&d=identicon&r=PG&f=1", "display_name": "user3284568", "link": "https://stackoverflow.com/users/3284568/user3284568"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1546447025, "answer_count": 1, "score": 1, "last_activity_date": 1546446796, "creation_date": 1546445829, "question_id": 54009663, "link": "https://stackoverflow.com/questions/54009663/c-cstringrefseqdistance-and-c-cstringdistance-functions-in-traminer-r-package", "closed_reason": "Not suitable for this site", "title": "C_cstringrefseqdistance and C_cstringdistance functions in TraMineR R package", "body": "<p>I cannot access the source codes for C_cstringrefseqdistance and C_cstringdistance C functions used by the seqdist() function in the TraMineR R package. Do you know if these source codes have been published or how I can retrieve it from the package?</p>\n\n<p>Thanks in advance for your help, best,</p>\n\n<p>t.</p>\n"}, {"tags": ["c++", "list", "linked-list"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 12, "creation_date": 1546445115, "post_id": 54009391, "comment_id": 94855671, "body": "Of course there&#39;s a way not just &quot;to guess the reason behind these function&#39;s existence just by looking at them&quot;, but to determine it conclusively. This is done by reading each function&#39;s code, analyzing it, and determining what the function does. For example, if the only thing that the function contains is <code>a=b;</code> you can proudly conclude that the function&#39;s purpose is to assign <code>b</code> to <code>a</code>. Similarly, by looking at each function&#39;s code, one can easily determine what it does. All of these functions are basic linked list operations, and are not very complicated."}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1546445599, "post_id": 54009391, "comment_id": 94855904, "body": "<code>u</code> will always crash as it sets <code>l</code> to <code>nullptr</code> and promptly dereferences it."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1546445693, "post_id": 54009391, "comment_id": 94855941, "body": "You might try drawing the lists out on scratch paper or a whiteboard, then trace through the code. Note that <code>u</code> uses recursion to traverse the list. <code>q</code> uses iteration instead, and it uses both <code>u</code> and <code>v</code>. Once you understand what those functions do, understanding <code>q</code> should be pretty simple."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1546445836, "post_id": 54009391, "comment_id": 94856017, "body": "@Botje: Quite right. I think that is clearly intended to be <code>==</code> instead of <code>=</code>."}], "answers": [{"comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 1, "creation_date": 1546445983, "post_id": 54009631, "comment_id": 94856081, "body": "This does not answer the question, which was not &quot;what are these functions doing?&quot;, but &quot;how to recognize what they are doing?&quot;"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1546446906, "post_id": 54009631, "comment_id": 94856517, "body": "More than that, this is a bad question, and bad questions should not be rewarded with answers."}], "tags": [], "owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "is_accepted": false, "score": 0, "last_activity_date": 1546445707, "creation_date": 1546445707, "answer_id": 54009631, "question_id": 54009391, "link": "https://stackoverflow.com/questions/54009391/how-to-recognize-the-meaning-of-a-linked-list-function-in-c/54009631#54009631", "title": "How to recognize the meaning of a linked list function in c++", "body": "<p>The function </p>\n\n<pre><code>bool u(List l, int x)\n</code></pre>\n\n<p>checks if list <code>l</code> contains value <code>x</code> in field <code>info</code>. The function </p>\n\n<pre><code>void v(List&amp; l, int x)\n</code></pre>\n\n<p>appends the value <code>x</code> to the list <code>l</code>. The function</p>\n\n<pre><code>List q(List l1, List l2)\n</code></pre>\n\n<p>checks for each value in list <code>l1</code> if it is also an element of list <code>l2</code>. If the value is element of list <code>l2</code>, the value is appended to list <code>aux</code>. The list <code>aux</code> is returned.</p>\n\n<p>There are some errors in the code. The line</p>\n\n<pre><code>if (l=nullptr) return false;\n</code></pre>\n\n<p>does not compare but assign. <code>aux</code> is a pointer to the last element of the list and not to the head.</p>\n"}, {"tags": [], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "is_accepted": false, "score": 0, "last_activity_date": 1546446144, "last_edit_date": 1546446144, "creation_date": 1546445737, "answer_id": 54009638, "question_id": 54009391, "link": "https://stackoverflow.com/questions/54009391/how-to-recognize-the-meaning-of-a-linked-list-function-in-c/54009638#54009638", "title": "How to recognize the meaning of a linked list function in c++", "body": "<p>Let's start with the first function</p>\n\n<pre><code>bool u(List l, int x) {\n    if (l == nullptr) return false;  // corrected: it should be '==' not '='\n    if (l-&gt;info == x) return true;\n    return u(l-&gt;next, x);\n}\n</code></pre>\n\n<p>The key is to understand the likely type of <code>List</code>. From experience with linked lists and from the code, it appears that we have something like</p>\n\n<pre><code>struct Node\n{\n    Node*next;\n    int  info;\n};\n\ntypedef Node *List;\n</code></pre>\n\n<p>Thus, <code>u()</code> takes a <code>List l</code> and a value <code>x</code>. If the list headed by <code>l</code> is empty (<code>l==nullptr</code>), it returns <code>false</code>. Otherwise, it the node info equals <code>x</code> it returns <code>true</code>. Otherwise, it calls itself recursively with <code>l</code> replaced by <code>l-&gt;next</code>.</p>\n\n<p>Thus, <code>u(l,x)</code> will returns true if and only if at least one of the nodes in the linked list contains the value <code>x</code> as <code>info</code>. A more suitable name for this function would have been <code>contains()</code> with the simpler implementation</p>\n\n<pre><code>bool contains(List l, int x)\n{\n    return l &amp;&amp; (l-&gt;info==x || contains(l-&gt;next,x));\n}\n</code></pre>\n\n<p>You can use this same logic now to find the meaning of the other functions.</p>\n"}, {"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 2, "last_activity_date": 1546446258, "creation_date": 1546446258, "answer_id": 54009773, "question_id": 54009391, "link": "https://stackoverflow.com/questions/54009391/how-to-recognize-the-meaning-of-a-linked-list-function-in-c/54009773#54009773", "title": "How to recognize the meaning of a linked list function in c++", "body": "<p>You can take a reasonable guess as to what these functions could do from just the declarations. </p>\n\n<pre><code>bool (List, int)\n</code></pre>\n\n<p>Takes a list and an element and returns a true/false answer. An immediate guess is \"does this list contain this element\". We then look at the definition (*), see that the null list is false, the list starting with <code>x</code> is true, and otherwise we look at the tail for the answer. Thus our guess was correct.</p>\n\n<pre><code>void (List&amp;, int)\n</code></pre>\n\n<p>Takes a list reference, and an element, and returns nothing. An immediate guess is that it adds an element to a list somewhere. Looking at it's definition, we see that a new node is allocated, and initialised as an element and made to be the head of the modified list. Again, our guess helped identify exactly what it does.</p>\n\n<pre><code>List (List, List)\n</code></pre>\n\n<p>Takes two lists and returns a list. An immediate guess is that it joins the two lists together. And we see that it basically does this, but only adds values from the second list that are not present in the first.</p>\n\n<p>(*) and fix the undefined behaviour of assigning <code>nullptr</code> to <code>u</code> rather than comparing it.</p>\n"}], "owner": {"reputation": 45, "user_id": 10575383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d274f404739952d6f044dcf52e5d742?s=128&d=identicon&r=PG&f=1", "display_name": "Chiara", "link": "https://stackoverflow.com/users/10575383/chiara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1546499925, "answer_count": 3, "score": -6, "last_activity_date": 1546446258, "creation_date": 1546444742, "question_id": 54009391, "link": "https://stackoverflow.com/questions/54009391/how-to-recognize-the-meaning-of-a-linked-list-function-in-c", "closed_reason": "Needs more focus", "title": "How to recognize the meaning of a linked list function in c++", "body": "<p>I'm currently stuck on some functions operating on single linked lists made with a struct in c++. </p>\n\n<p>I am supposed to find out what do these functions do without compiling, but I cannot seem to have understood the theory behind it completely, since my guesses are all to generic.</p>\n\n<p>Is there a way to guess the reason behind these function's existence just by looking at them? And what do they do?</p>\n\n<p>Also, what will happen if I call q(la, lb) if la=(2, 3, 4, 5, 1, 6) and lb=(3, 4, 5)?</p>\n\n<pre><code>bool u(List l, int x) {\n  if (l=nullptr) return false;\n  if (l-&gt;info == x) return true;\n  return u(l-&gt;next, x);\n}\n\nvoid v(List&amp; l, int x) {\n  List tmp = new (cell);\n  tmp-&gt;info = x;\n  tmp -&gt; next = l;\n  l = tmp;\n}\n\nList q(List l1, List l2) {\n  List aux = nullptr;\n  while (l1!=nullptr) {\n    if (!u(l2,l1-&gt;info)) v(aux,l1-&gt;info);\n    l1=l1-&gt;next;\n  }\n  return aux;\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "ostream"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546444625, "post_id": 54009236, "comment_id": 94855389, "body": "There are quite a few functions here that you haven&#39;t defined. Is that just because of how you&#39;ve formed the question?"}, {"owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546444734, "post_id": 54009236, "comment_id": 94855451, "body": "I didn&#39;t include the other definitions because they work fine, but if it bothers I shall add them now"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1546444879, "post_id": 54009236, "comment_id": 94855543, "body": "missing <code>std::</code> in the definition of <code>operator&lt;&lt;(std::ostream&amp;, const DynamicArray&lt;Chris&gt;&amp;)</code>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546444912, "post_id": 54009236, "comment_id": 94855559, "body": "Well you&#39;re supposed to present your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> otherwise how are we to know which errors are hidden away in code you didn&#39;t show us?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1546444934, "post_id": 54009236, "comment_id": 94855568, "body": "@Walter That wouldn&#39;t cause an undefined reference and there is a using namespace std anyway"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1546445379, "post_id": 54009236, "comment_id": 94855798, "body": "The friend declaration does not match the template output stream.  It should be a template friend."}, {"owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "edited": false, "score": 0, "creation_date": 1546445601, "post_id": 54009236, "comment_id": 94855905, "body": "are you stating I should write it like this (adding the &lt;&gt;:    friend std::ostream&amp; operator &lt;&lt; &lt;&gt;(std::ostream&amp; outputStream, const DynamicArray&lt;Chris&gt;&amp; obj);"}, {"owner": {"reputation": 799, "user_id": 698679, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7d8e7ba1c6d9226662788db8a1ada2b5?s=128&d=identicon&r=PG", "display_name": "alangab", "link": "https://stackoverflow.com/users/698679/alangab"}, "edited": false, "score": 0, "creation_date": 1546446315, "post_id": 54009236, "comment_id": 94856235, "body": "Try to move the definition of your  std::ostream&amp; operator &lt;&lt; &lt;&gt;(std::ostream&amp; outputStream, const DynamicArray&lt;Chris&gt;&amp; obj);"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1546446706, "post_id": 54009236, "comment_id": 94856422, "body": "No, I&#39;m saying this... <code>template&lt;class Chris&gt; ostream&amp; operator&lt;&lt; (ostream&amp; outputStream, const DynamicArray&lt;Chris&gt;&amp;  obj)</code> does not match this... <code>friend std::ostream&amp; operator &lt;&lt; (std::ostream&amp; outputStream, const DynamicArray&lt;Chris&gt;&amp; obj);</code>.  The first one is a template function, the second one is not a template function it is only a function.  So they don&#39;t match.  Turn the friend declaration into a template friend declaration."}, {"owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "edited": false, "score": 0, "creation_date": 1546446788, "post_id": 54009236, "comment_id": 94856473, "body": "ok, thank you Eljay, I have corrected the code"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "edited": false, "score": 0, "creation_date": 1546447222, "post_id": 54009978, "comment_id": 94856681, "body": "The friend function must be declared at the top of the program as a template otherwise it doesn&#39;t get picked up by the compiler"}, {"owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1546449065, "post_id": 54009978, "comment_id": 94857563, "body": "Done Scheff, I also included the whole program ,so do I have your vote ?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1546449460, "post_id": 54009978, "comment_id": 94857727, "body": "Hmm. Sample code still has a very ... crazy formatting - it&#39;s hard to read. (I even didn&#39;t try.)"}, {"owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1546455383, "post_id": 54009978, "comment_id": 94860080, "body": "are you ever satisfied?"}, {"owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1546456002, "post_id": 54009978, "comment_id": 94860324, "body": "I&#39;m heartbroken but it&#39;s ok Scheff,I&#39;ll fix it at some point.Since I&#39;m new to c++ I mostly care about how well my code works and not so much for the formatting.Although I should a habit before I get employed somewhere."}], "tags": [], "owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "is_accepted": false, "score": 1, "last_activity_date": 1546448990, "last_edit_date": 1546448990, "creation_date": 1546447148, "answer_id": 54009978, "question_id": 54009236, "link": "https://stackoverflow.com/questions/54009236/dynamic-array-template-class-problem-with-ostream-operator-friend-function/54009978#54009978", "title": "Dynamic Array Template Class: problem with ostream&amp; operator friend function", "body": "<p>To fix the issue above friend function must be declared at the top of the program\nbefore the class definition. The class that contains the friend functions should also be declared.I have edited my answer and also included the whole program.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n\nusing std::iostream;\nusing std::cout;\nusing std::endl;\n\n\ntemplate&lt;typename Chris&gt;\nclass DynamicArray; //must add this\n\ntemplate&lt;typename Chris&gt;\nstd::ostream&amp; operator &lt;&lt;(std::ostream&amp; outputStream, const \nDynamicArray&lt;Chris&gt;&amp; \n    obj);// must add this as well\n\n\n\ntemplate &lt;typename Chris&gt;\n class DynamicArray{\n\n\n    private:\n    Chris *myArray;\n    int capacity;\n     int num_items;\n     friend std::ostream&amp; operator &lt;&lt; &lt;&gt;(std::ostream&amp; outputStream, const \n     DynamicArray&amp; \n      obj);\n\n\n    public:\n    DynamicArray();\n    DynamicArray(int initialCapacity);\n    void reSize(int newCapacity);\n    void addElement(const Chris element);\n    Chris&amp; operator[](int index)const;\n    virtual ~DynamicArray();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  };\n\n\n\n  int main(){\n\n\n\n   DynamicArray&lt;int&gt; Array(20);\n\n   Array.addElement(20);\n   Array.addElement(12);\n   Array.addElement(13);\n   Array.addElement(45);\n   Array.addElement(78);\n\n\n\n   cout&lt;&lt;Array&lt;&lt;endl;\n\n    return 0;\n   }\n\n template&lt;typename Chris&gt;\n DynamicArray&lt;Chris&gt;::DynamicArray():capacity(1),num_items(0)\n   {\n\n       myArray=new Chris[capacity];\n    }\n\ntemplate &lt;typename Chris&gt;\nDynamicArray&lt;Chris&gt;::DynamicArray(int initialCapacity):num_items(0)\n    {\n\n          if(initialCapacity&gt;0){\n\n           capacity=initialCapacity;\n            myArray=new Chris[capacity];\n      }\n\n      else{\n\n             cout&lt;&lt;\"ERROR, capacity cannot be negative or 0 \" &lt;&lt;endl;\n              exit(0);\n\n             }\n\n            }\n\n template &lt;typename Chris&gt;\n void DynamicArray&lt;Chris&gt;::reSize(int newCapacity)\n         {\n\n                 if(newCapacity&lt;=capacity){\n\n\n                  cout&lt;&lt;\"ERROR, the new capacity must be greater than the \n                 current capacity\"&lt;&lt;endl;\n                  exit(1);\n                 }\n\n                Chris *biggerArray = new Chris[newCapacity];\n\n               for(int index=0; index&lt;num_items; index++){\n\n               biggerArray[index]=myArray[index];\n\n\n\n              }\n\n              delete [] myArray;\n              capacity=newCapacity;\n              myArray= new Chris[capacity];\n\n               for(int index=0; index&lt;num_items; index++){\n\n               myArray[index]= biggerArray[index];\n\n\n\n              }\n\n              delete [] biggerArray;\n\n\n             }\n\n template &lt;typename Chris&gt;\n Chris&amp; DynamicArray&lt;Chris&gt;::operator [](int index)const\n {\n\n\n    if(index&gt;=num_items){\n\n\n      cout&lt;&lt;\"ERROR,ARRAYINDEX OUT OF BOUNDS \" &lt;&lt;endl;\n       exit(0);\n   }\n\n     return myArray[index];\n\n\n\n   }\n\n\n\ntemplate&lt;typename Chris&gt;\nvoid DynamicArray&lt;Chris&gt;::addElement(const Chris element){\n\n    if(num_items==capacity){\n\n\n        reSize(capacity*2);\n    }\n\n\n    myArray[num_items]=element;\n    num_items++;\n\n\n\n}\n\ntemplate&lt;typename Chris&gt;\nstd::ostream&amp; operator&lt;&lt; (std::ostream&amp; outputStream, const \nDynamicArray&lt;Chris&gt;&amp;\nobj)\n{\n\n   for(int index=0; index&lt;obj.num_items; index++){\n\n   if(index&lt;(obj.num_items-1)){\n    outputStream&lt;&lt;obj.myArray[index]&lt;&lt;\",\";\n }\n\n     else{\n\n         outputStream&lt;&lt;obj.myArray[index];\n    }\n   }\n\n\n      return outputStream;\n  }\n\ntemplate&lt;typename Chris&gt;\nDynamicArray&lt;Chris&gt;::~DynamicArray()\n{\n\n\n   delete [] myArray;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": true, "score": 1, "last_activity_date": 1546509739, "last_edit_date": 1592644375, "creation_date": 1546502933, "answer_id": 54018483, "question_id": 54009236, "link": "https://stackoverflow.com/questions/54009236/dynamic-array-template-class-problem-with-ostream-operator-friend-function/54018483#54018483", "title": "Dynamic Array Template Class: problem with ostream&amp; operator friend function", "body": "<p>Although OP seems to have solved her/his problem on its own, I became curious a bit.</p>\n<p>OP's problem seems to be to declare a free-standing <code>friend operator&lt;&lt;</code> in a class template. OP's sample code is a bit hard to read, thus I made my own <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>:</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;exception&gt;\n#include &lt;algorithm&gt;\n\n// template class for dynamic array\ntemplate &lt;typename VALUE&gt;\nclass VectorT {\n    \n  private:\n    VALUE *_values;\n    size_t _capacity;\n    size_t _size;\n    \n  public:\n    VectorT(): _values(nullptr), _capacity(0), _size(0) { }\n    ~VectorT() { delete[] _values; }\n    VectorT(const VectorT &amp;vec); /// @todo\n    VectorT&amp; operator=(const VectorT &amp;vec); /// @todo\n    \n    size_t capacity() const { return _capacity; }\n    size_t size() const { return _size; }\n    VALUE&amp; operator[](size_t i) { return _values[i]; }\n    const VALUE&amp; operator[](size_t i) const { return _values[i]; }\n    \n    void push_back(const VALUE &amp;value)\n    {\n      if (_size == _capacity) { // realloc necessary\n        const size_t capacity = std::max(2 * _capacity, (size_t)1);\n        VALUE *const values = new VALUE[capacity];\n        if (!values) throw std::bad_array_new_length();\n        std::move(_values, _values + _size, values);\n        delete[] _values;\n        _values = values; _capacity = capacity;\n      }\n      _values[_size++] = value;\n    }\n\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const VectorT&lt;VALUE&gt;&amp;);\n    \n};\n\n// output stream operator for VectorT\ntemplate &lt;typename VALUE&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream &amp;out, const VectorT&lt;VALUE&gt; &amp;vec)\n{\n  const char *sep = &quot;&quot;;\n  for (size_t i = 0; i &lt; vec._size; ++i) {\n    out &lt;&lt; sep &lt;&lt; vec[i];\n    sep = &quot;, &quot;;\n  }\n  return out;\n}\n\n// test\nint main()\n{\n  VectorT&lt;int&gt; vec;\n  // populate vec\n  vec.push_back(20);\n  vec.push_back(12);\n  vec.push_back(13);\n  vec.push_back(45);\n  vec.push_back(78);\n  // test output operator\n  std::cout &lt;&lt; vec &lt;&lt; '\\n';\n  // done\n  return 0;\n}\n</code></pre>\n<p>Note: I changed the concept and names a bit as OP's <code>DynamicArray</code> does actually provide something similar like <code>std::vector</code>. I found it reasonable to resemble it a bit closer.</p>\n<p>I tried to compile this with</p>\n<pre class=\"lang-none prettyprint-override\"><code>g++ --version ; g++ -std=c++11 -O2 -Wall -pedantic main.cpp &amp;&amp; ./a.out\n</code></pre>\n<p>and got the following output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>g++ (GCC) 8.1.0\nCopyright (C) 2018 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\nmain.cpp:38:73: warning: friend declaration 'std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const VectorT&lt;VALUE&gt;&amp;)' declares a non-template function [-Wnon-template-friend]\n     friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const VectorT&lt;VALUE&gt;&amp;);\n                                                                         ^\nmain.cpp:38:73: note: (if this is not what you intended, make sure the function template has already been declared and add &lt;&gt; after the function name here) \n/tmp/ccvsl6kw.o: In function `main':\nmain.cpp:(.text.startup+0x9e): undefined reference to `operator&lt;&lt;(std::ostream&amp;, VectorT&lt;int&gt; const&amp;)'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n<p>It's funny enough that</p>\n<ol>\n<li>the <strong>ful</strong> answer is already given by <code>g++</code></li>\n<li>and it consists actually of two activities:</li>\n</ol>\n<blockquote>\n<p>make sure the function template has already been declared</p>\n<p>and</p>\n<p>add &lt;&gt; after the function name here</p>\n</blockquote>\n<p>Concerning the first part, I remembered a similar issue I once found in my answer to <a href=\"https://stackoverflow.com/a/52370542/7478597\">SO: Why would a struct need a friend function?</a>.</p>\n<p>The second part (<em>add &lt;&gt; after the function name here</em>) is something which raised my attention as I've never seen (nor used) it that way before. So, I'd like to elaborate a bit.</p>\n<p>After having inserted the following forward declarations:</p>\n<pre><code>// forward declaration of VectorT\ntemplate &lt;typename VALUE&gt;\nclass VectorT;\n\n// prototyping of output stream operator\ntemplate &lt;typename VALUE&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const VectorT&lt;VALUE&gt;&amp;);\n</code></pre>\n<p>I tried to compile again and got again:</p>\n<pre class=\"lang-none prettyprint-override\"><code>main.cpp:46:73: warning: friend declaration 'std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const VectorT&lt;VALUE&gt;&amp;)' declares a non-template function [-Wnon-template-friend]\n     friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const VectorT&lt;VALUE&gt;&amp;);\n                                                                         ^\nmain.cpp:46:73: note: (if this is not what you intended, make sure the function template has already been declared and add &lt;&gt; after the function name here) \n/tmp/ccXLnkbV.o: In function `main':\nmain.cpp:(.text.startup+0x9e): undefined reference to `operator&lt;&lt;(std::ostream&amp;, VectorT&lt;int&gt; const&amp;)'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n<p>exactly as before. Oops!</p>\n<p>My first reflex was to change the <code>friend operator</code> to a <code>template friend operator</code>:</p>\n<pre><code>template &lt;typename VALUE_&gt;\nfriend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const VectorT&lt;VALUE_&gt;&amp;);\n</code></pre>\n<p>and this solved the issue: <kbd><a href=\"http://coliru.stacked-crooked.com/a/64f135c59856a3c3\" rel=\"nofollow noreferrer\"><strong>Live Demo on coliru</strong></a></kbd>.</p>\n<hr />\n<p>However, this solution has a little flaw which might or might not be annoying: Any operator instance is friend to any <code>VectorT</code> template instance. Actually, this should be constrained to only one operator instance \u2013 the one with the same <code>VectorT</code> template instance in signature. This is what <code>g++</code> actually suggested:</p>\n<pre><code>friend std::ostream&amp; operator&lt;&lt; &lt;&gt;(std::ostream&amp;, const VectorT&lt;VALUE&gt;&amp;);\n</code></pre>\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/a6f4dc99aed7a7ee\" rel=\"nofollow noreferrer\"><strong>Live Demo on coliru</strong></a></kbd></p>\n<p>I wonder why this isn't mentioned in <a href=\"https://stackoverflow.com/a/54009978/7478597\">theredfox24's answer</a> \u2013 IMHO, this is the actually exciting part of OP's fix.</p>\n<hr />\n<p>Finally, I'd like to mention that (in this case) the \u201cwhole <code>friend</code> magic\u201d is completely unnecessary. This is what raised my attention first \u2013 in the dozens of written output operators (for class templates), I never had any <code>friend</code> issues. This can be easily prevented if the output operator uses <code>public</code> <code>const</code> members of the <code>class</code> exclusively (and I can hardly imagine why they shouldn't be available):</p>\n<pre><code>// output stream operator for VectorT\ntemplate &lt;typename VALUE&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream &amp;out, const VectorT&lt;VALUE&gt; &amp;vec)\n{\n  const char *sep = &quot;&quot;;\n  for (size_t i = 0; i &lt; vec.size(); ++i) {\n    out &lt;&lt; sep &lt;&lt; vec[i];\n    sep = &quot;, &quot;;\n  }\n  return out;\n}\n</code></pre>\n<p>(Forward declarations and <code>friend</code> operator removed because not needed anymore.)</p>\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/ccec56a1c80883f9\" rel=\"nofollow noreferrer\"><strong>Live Demo on coliru</strong></a></kbd></p>\n"}], "owner": {"reputation": 89, "user_id": 7237110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3DewA.png?s=128&g=1", "display_name": "theredfox24", "link": "https://stackoverflow.com/users/7237110/theredfox24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 54018483, "answer_count": 2, "score": -1, "last_activity_date": 1546509739, "creation_date": 1546444052, "last_edit_date": 1546455850, "question_id": 54009236, "link": "https://stackoverflow.com/questions/54009236/dynamic-array-template-class-problem-with-ostream-operator-friend-function", "title": "Dynamic Array Template Class: problem with ostream&amp; operator friend function", "body": "<p>Hi there fellow computer scientists, \nI'm having a lot of issues with my code, everything works except for the friend ostream&amp; operator function. I keep getting a compiler error when sending my class object to cout. I'm thinking a made an error while declaring the friend function or maybe within its declaration.Here is the code:</p>\n\n<p>By the way I know its traditional to use T for templates but I used my professors name, it sounds weird but using unconventional  names in my code helps me remember programming concepts like templates and etc</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n\nusing namespace std;\n\ntemplate &lt;class Chris&gt;\nclass DynamicArray{\n\n\nprivate:\n    Chris *myArray;\n     int capacity;\n     int num_items;\n\n\npublic:\n  DynamicArray();\n  DynamicArray(int initialCapacity);\n  void reSize(int newCapacity);\n  void addElement(const Chris element);\n  Chris&amp; operator[](int index)const;\n  friend std::ostream&amp; operator &lt;&lt; (std::ostream&amp; outputStream, const \n  DynamicArray&lt;Chris&gt;&amp; obj);\n  virtual ~DynamicArray();\n\n\n};\n\n\nint main(){\n\n\n\nDynamicArray&lt;int&gt; Array(20);\n\nArray.addElement(20);\nArray.addElement(12);\nArray.addElement(13);\nArray.addElement(45);\nArray.addElement(78);\n\n\n\ncout&lt;&lt;Array&lt;&lt;endl;\n\n\n\n\n\n\n\n\n\n\n\n\nreturn 0;\n}\n\n\n\ntemplate&lt;class Chris&gt;\nostream&amp; operator&lt;&lt; (ostream&amp; outputStream, const DynamicArray&lt;Chris&gt;&amp; \nobj)\n{\n\nfor(int index=0; index&lt;obj.num_items; index++){\n\n    if(index&lt;(obj.num_items-1)){\n    outputStream&lt;&lt;obj.myArray[index]&lt;&lt;\",\";\n    }\n\n    else{\n\n        outputStream&lt;&lt;obj.myArray[index];\n    }\n   }\n\n\n   return outputStream;\n  }\n\n template&lt;class Chris&gt;\n DynamicArray&lt;Chris&gt;::DynamicArray():capacity(1),num_items(0)\n {\n\n     myArray=new Chris[capacity];\n }\n\ntemplate &lt;class Chris&gt;\nDynamicArray&lt;Chris&gt;::DynamicArray(int initialCapacity):num_items(0)\n{\n\n       if(initialCapacity&gt;0){\n\n    capacity=initialCapacity;\n    myArray=new Chris[capacity];\n}\n\n    else{\n\n       cout&lt;&lt;\"ERROR, capacity cannot be negative or 0 \" &lt;&lt;endl;\n       exit(0);\n\n      }\n\n   }\n\n template &lt;class Chris&gt;\nvoid DynamicArray&lt;Chris&gt;::reSize(int newCapacity)\n {\n\n    if(newCapacity&lt;=capacity){\n\n\n        cout&lt;&lt;\"ERROR, the new capacity must be greater than the current \n      capacity\"&lt;&lt;endl;\n        exit(1);\n    }\n\n    Chris *biggerArray = new Chris[newCapacity];\n\n    for(int index=0; index&lt;num_items; index++){\n\n        biggerArray[index]=myArray[index];\n\n\n\n    }\n\n    delete [] myArray;\n    capacity=newCapacity;\n    myArray= new Chris[capacity];\n\n       for(int index=0; index&lt;num_items; index++){\n\n        myArray[index]= biggerArray[index];\n\n\n\n    }\n\n    delete [] biggerArray;\n\n\n   }\n\ntemplate &lt;class Chris&gt;\nChris&amp; DynamicArray&lt;Chris&gt;::operator [](int index)const\n{\n\n\nif(index&gt;=num_items){\n\n\n    cout&lt;&lt;\"ERROR,ARRAYINDEX OUT OF BOUNDS \" &lt;&lt;endl;\n    exit(0);\n}\n\nreturn myArray[index];\n\n\n\n}\n\n\n\n\n\n template&lt;class Chris&gt;\n void DynamicArray&lt;Chris&gt;::addElement(const Chris element){\n\n    if(num_items==capacity){\n\n\n        reSize(capacity*2);\n    }\n\n\n    myArray[num_items]=element;\n    num_items++;\n\n\n\n}\n\n\n\ntemplate&lt;class Chris&gt;\nDynamicArray&lt;Chris&gt;::~DynamicArray()\n{\n\n\n  delete [] myArray;\n}\n</code></pre>\n\n<p>The compiler error is :undefined reference\n,also it states that my friend ostream&amp; function was not declared as a template.\nI have to idea how to fix this</p>\n"}, {"tags": ["c++", "read-write", "qfile", "resource-files", "qtextstream"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1546442877, "post_id": 54008930, "comment_id": 94854472, "body": "As per <a href=\"https://doc.qt.io/qt-5/resources.html\" rel=\"nofollow noreferrer\">the documentation</a>, resources are embedded in your binary file and are thus <b>read-only</b>, both conceptually and practically."}, {"owner": {"reputation": 32, "user_id": 10473029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43828a2c1d86bea6360f4826d3952afc?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/10473029/max"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1546443044, "post_id": 54008930, "comment_id": 94854561, "body": "So there is no way to write to these files?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1546443179, "post_id": 54008930, "comment_id": 94854621, "body": "No. You will have to save your data to a writable location on the filesystem, for example under <code>QDir::home()</code> or the current working directory <code>QDir::current()</code>."}, {"owner": {"reputation": 32, "user_id": 10473029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43828a2c1d86bea6360f4826d3952afc?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/10473029/max"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1546443274, "post_id": 54008930, "comment_id": 94854666, "body": "Ok i will try it thank you, can you post this as answer that i can mark it, or should i just delete this question?"}], "answers": [{"tags": [], "owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "is_accepted": true, "score": 0, "last_activity_date": 1546443681, "creation_date": 1546443681, "answer_id": 54009146, "question_id": 54008930, "link": "https://stackoverflow.com/questions/54008930/c-write-to-resource-file-with-qfile-qiodevicewrite-qfile-x-device-not/54009146#54009146", "title": "C++ write to resource file with qfile (QIODevice::write (QFile,&quot;x&quot;): device not open)", "body": "<p>As per <a href=\"https://doc.qt.io/qt-5/resources.html\" rel=\"nofollow noreferrer\">the documentation</a>, resources are embedded in your binary file and are thus read-only, both conceptually and practically.\nYou will have to save your data to a writable location on the filesystem, for example under <code>QDir::home()</code> or the current working directory <code>QDir::current()</code> .</p>\n"}], "owner": {"reputation": 32, "user_id": 10473029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43828a2c1d86bea6360f4826d3952afc?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/10473029/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "closed_date": 1546865730, "accepted_answer_id": 54009146, "answer_count": 1, "score": 0, "last_activity_date": 1546443681, "creation_date": 1546442714, "question_id": 54008930, "link": "https://stackoverflow.com/questions/54008930/c-write-to-resource-file-with-qfile-qiodevicewrite-qfile-x-device-not", "closed_reason": "Duplicate", "title": "C++ write to resource file with qfile (QIODevice::write (QFile,&quot;x&quot;): device not open)", "body": "<p>i have the following problem, i have an resource file called data.txt and i want to open it with write permission.\nIm using QFile and QTextStream to work with it.\nI can only open the File with ReadOnly Acces but not with ReadWrite or WriteOnly acces.\nExport functions with similar code working fine its only not working on the resource file.</p>\n\n<p>I already tried to change the front slashes to double backslashes, i runned hunderd times the qmake and rebuild, i restartet my computer and resotre the resource file.\nI already checked alot of entries on Stack but wasnt able to find one that resolves my problem. (Most questions were spelling issues like only one backslash).</p>\n\n<pre><code>QFile file(\":/savelocation/data.txt\");\nif (!file.exists())\n{\n    qDebug()&lt;&lt;\"File not exist\";\n}\n\nfile.open(QIODevice::ReadWrite | QIODevice::Text);\n\nif (file.isOpen())\n{\n    qDebug()&lt;&lt;\"File is open\";\n    QTextStream out(&amp;file);\n    out&lt;&lt; \"something\" &lt;&lt; endl;\n}\nelse\n{\n    qDebug()&lt;&lt;\"File is not open\";\n}\nfile.close();\nfile.open(QIODevice::ReadOnly);\nif (file.isOpen())\n{\n    qDebug()&lt;&lt;\"File is open as read only\";\n}\nelse\n{\n    qDebug()&lt;&lt;\"File is not open as read only\";\n}\nfile.close();\n</code></pre>\n\n<p>Actual result:</p>\n\n<p>My Application output of the code:\nFile is not open\nFile is open as read only\nIts only possible to open it as ReadOnly for me.</p>\n\n<p>Before i implemented the if i got the following output:</p>\n\n<pre><code>QIODevice::write (QFile,\":/savelocation/data.txt\"): device not open\n</code></pre>\n\n<p>Expected result:</p>\n\n<p>The file would be opened with write access.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c++11", "templates"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7835355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XH8WJ.gif?s=128&g=1", "display_name": "Brunplunsu", "link": "https://stackoverflow.com/users/7835355/brunplunsu"}, "is_accepted": false, "score": 1, "last_activity_date": 1546459417, "creation_date": 1546459417, "answer_id": 54012474, "question_id": 54008920, "link": "https://stackoverflow.com/questions/54008920/about-alias-template/54012474#54012474", "title": "About alias template", "body": "<p>About the first question, <code>g++</code> says that \"there are too many parameter lists\" where <code>clang++</code> says \"extraneous template parameter list in alias template declaration\".\nTo make the code compile you should write this:</p>\n\n<pre><code>template &lt;bool AddOrRemove, typename T&gt;\nusing Fun = typename Fun_&lt;AddOrRemove&gt;::template type&lt;T&gt;;\n</code></pre>\n\n<p>About the second function, if I've understand correctly, maybe you want something like</p>\n\n<pre><code>template &lt;typename T&gt;\nusing RomoveRef = Fun&lt;!std::is_reference&lt;T&gt;::value, T&gt;;\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10166663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3b5ec12199a47ca879de6e27770976e?s=128&d=identicon&r=PG&f=1", "display_name": "breaker00", "link": "https://stackoverflow.com/users/10166663/breaker00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546479526, "creation_date": 1546442680, "last_edit_date": 1546479526, "question_id": 54008920, "link": "https://stackoverflow.com/questions/54008920/about-alias-template", "title": "About alias template", "body": "<p></p>\n\n<pre><code>template &lt;bool AddOrRemoveRef&gt;\nstruct Fun_;\n\ntemplate &lt;&gt;\nstruct Fun_&lt;true&gt; {\n    template &lt;typename T&gt; using type = std::add_lvalue_reference&lt;T&gt;;\n};\n\ntemplate &lt;&gt;\nstruct Fun_&lt;false&gt; {\n   template &lt;typename T&gt; using type = std::remove_reference&lt;T&gt;;\n};\n\ntemplate &lt;typename T&gt;\ntemplate&lt;bool AddOrRemove&gt;\nusing Fun = typename Fun_&lt;AddOrRemove&gt;:: template type&lt;T&gt;;\n\n// question 1. I changed the two template &lt;&gt; postion,and got a compile error.So i really can not distinguish the sequence of two template &lt;T&gt; in this situation. Is there some introduction?\n// template &lt;bool AddOrRemove&gt;\n// template &lt;typename T&gt;\n// using Fun = typename Fun_&lt;AddOrRemove&gt;:: template type&lt;T&gt;;\n\ntemplate &lt;typename T&gt; using RomoveRef = Fun&lt;false&gt;;\n\nint main()\n{\n    RomoveRef&lt;int&amp;&gt;::type j = 1; // ok\n    printf(\"%d\\n\", j);\n\n    // question 2. I want to use Fun directly, how can i do?\n    // template Fun&lt;false&gt;::type&lt;int&amp;&gt; i = 1;\n    // printf(\"%d\\n\", i);\n\n    return 0;\n}\n</code></pre>\n\n<p>I have two questions which are written in comments part in above code.Please give me some suggestions if it is possible,thank you.</p>\n\n<p>1.How to understand the two <em>template &lt;></em> postion.\n2.How to use <em>Fun::type</em> or <em>Fun_::type</em> implement the same function as <em>RomoveRef</em></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1546463005, "post_id": 54008803, "comment_id": 94863169, "body": "For the obvious:  one has a space before the &#39;&amp;&#39; and the other doesn&#39;t.  In parsing, there doesn&#39;t need to be a space before or after the &#39;&amp;&#39;.  So you forgot a 3rd equivalent example: <code>int&amp;i;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "is_accepted": false, "score": 3, "last_activity_date": 1546442258, "creation_date": 1546442258, "answer_id": 54008815, "question_id": 54008803, "link": "https://stackoverflow.com/questions/54008803/c-correct-references/54008815#54008815", "title": "C++ correct references", "body": "<p>There is absolutely no difference in meaning between these two, it is a purely stylistic matter. Just pick one and try to be consistent within a project.</p>\n\n<p>I believe the examples in the language standard put the <code>&amp;</code> symbol on the left - that's as good a reason as any to prefer one way over the other, I suppose.</p>\n\n<hr>\n\n<p>That said, as you've written it, neither line is valid code, because you can't have an uninitialised reference. You would need something like:</p>\n\n<pre><code>int a = 10;\nint&amp; b = a;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10858450, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qFnNJvRMpak/AAAAAAAAAAI/AAAAAAAAAEA/p4XLxg2xznM/photo.jpg?sz=128", "display_name": "CeZza_ Gant", "link": "https://stackoverflow.com/users/10858450/cezza-gant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1546442410, "answer_count": 1, "score": -1, "last_activity_date": 1546442474, "creation_date": 1546442207, "question_id": 54008803, "link": "https://stackoverflow.com/questions/54008803/c-correct-references", "closed_reason": "Duplicate", "title": "C++ correct references", "body": "<p>Can someone explain what the difference is, if any, between these two lines:</p>\n\n<pre><code>int&amp; i;\nint &amp;i;\n</code></pre>\n\n<p>I know these are both references and both seem to work fine. Is there a reason to use one over the other? Is there any rule saying what is the right way?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "algorithm", "c++11", "math"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 4, "creation_date": 1546442360, "post_id": 54008802, "comment_id": 94854207, "body": "With floating point numbers, it is <i>unreasonable</i> to test for equality. See <a href=\"http://floating-point-gui.de/\" rel=\"nofollow noreferrer\">floating-point-gui.de</a>"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1546442512, "post_id": 54008802, "comment_id": 94854284, "body": "Why is one return value tested against <code>1.0</code> and the other against just <code>0</code>?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1546442978, "post_id": 54008802, "comment_id": 94854529, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> for tips on debugging your code."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1546446293, "post_id": 54008802, "comment_id": 94856223, "body": "Minimum value of k, or minimum value of 1/k (which corresponds to maximum value of k)? The latter seems more interesting and thus more likely to be the actual problem to be solved."}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1569722813, "post_id": 54008802, "comment_id": 102686985, "body": "(I saw that you deleted your <a href=\"https://stackoverflow.com/questions/58150851/finding-two-integers-without-a-zero-digit-that-sum-to-a-target-integer\">question about the two integer sum</a>. For what it&#39;s worth, I tried to fix my code to handle the counter example you found. Here: <a href=\"https://ideone.com/JKRkqy\" rel=\"nofollow noreferrer\">ideone.com/JKRkqy</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 275, "user_id": 10741173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf2848a1e417f38a10583f48678aad9?s=128&d=identicon&r=PG&f=1", "display_name": "oompa", "link": "https://stackoverflow.com/users/10741173/oompa"}, "edited": false, "score": 1, "creation_date": 1546442855, "post_id": 54008873, "comment_id": 94854458, "body": "Okay, got it. But just one thing -- shouldn&#39;t the loop condition be &quot;fabs(fmod(pow(a, 1.0/k), 1) - 1.0) &gt;= 0.0000001,&quot; since we want to keep looping while the statement is not true?"}, {"owner": {"reputation": 275, "user_id": 10741173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf2848a1e417f38a10583f48678aad9?s=128&d=identicon&r=PG&f=1", "display_name": "oompa", "link": "https://stackoverflow.com/users/10741173/oompa"}, "edited": false, "score": 0, "creation_date": 1546443805, "post_id": 54008873, "comment_id": 94854940, "body": "also in the absolute value, we should be subtracting 0.0 rather than 1.0 right? since they would be congruent to 0 mod 1 ? just making sure..."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 275, "user_id": 10741173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf2848a1e417f38a10583f48678aad9?s=128&d=identicon&r=PG&f=1", "display_name": "oompa", "link": "https://stackoverflow.com/users/10741173/oompa"}, "edited": false, "score": 0, "creation_date": 1546444068, "post_id": 54008873, "comment_id": 94855097, "body": "It is about computing a distance. You could even use an <a href=\"https://en.wikipedia.org/wiki/Euclidean_distance\" rel=\"nofollow noreferrer\">euclidean distance</a>, but then it takes more time to be computed."}, {"owner": {"reputation": 275, "user_id": 10741173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf2848a1e417f38a10583f48678aad9?s=128&d=identicon&r=PG&f=1", "display_name": "oompa", "link": "https://stackoverflow.com/users/10741173/oompa"}, "edited": false, "score": 0, "creation_date": 1546444299, "post_id": 54008873, "comment_id": 94855203, "body": "yes. currently, the boolean tests whether the value of fmod(pow(a, 1.0/k), 1) is within epsilon of 1. but shouldn&#39;t it be testing whether it&#39;s in epsilon of 0? since we want the while condition to evaluate to &quot;false&quot; when they are both integers, which occurs precisely when the kth roots of a and b are equal to 0 mod 1, not 1 mod 1"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 275, "user_id": 10741173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf2848a1e417f38a10583f48678aad9?s=128&d=identicon&r=PG&f=1", "display_name": "oompa", "link": "https://stackoverflow.com/users/10741173/oompa"}, "edited": false, "score": 0, "creation_date": 1546444491, "post_id": 54008873, "comment_id": 94855311, "body": "You want <code>fmod(pow(a, 1.0&#47;k), 1)</code>  (call that <code>x</code>) to be sufficiently different of <code>1.0</code> (call it <code>y</code>). So you want <code>fabs(x-y)</code> to be larger than some <code>EPSILON</code>"}, {"owner": {"reputation": 275, "user_id": 10741173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf2848a1e417f38a10583f48678aad9?s=128&d=identicon&r=PG&f=1", "display_name": "oompa", "link": "https://stackoverflow.com/users/10741173/oompa"}, "edited": false, "score": 0, "creation_date": 1546444815, "post_id": 54008873, "comment_id": 94855508, "body": "But then the code breaks when, for example, (a, b) = (5764801, 1679616). It should return k = 4 since the quantities (5764801)^(1/4) and (1679616)^(1/4) are both integers (namely, 49 and 36). However, when we have k = 4, the value of 5764801^(1/4) mod 1 equals 0, and the quantity fabs(x - y) equals 1. Since this value is greater than epsilon, the first boolean expression becomes &quot;true,&quot; and the loop goes on forever"}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1546521562, "post_id": 54008873, "comment_id": 94882278, "body": "Neither of the two errors in the link you provide were floating-point errors. The first was fixed-point. The second was conversion to a too-narrow integer (for which the source format is irrelevant, as any conversion of a value to a type in which it cannot be represented is an error, regardless of how the source value is represented)."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 4, "last_activity_date": 1546445670, "last_edit_date": 1546445670, "creation_date": 1546442505, "answer_id": 54008873, "question_id": 54008802, "link": "https://stackoverflow.com/questions/54008802/given-a-b-compute-the-maximum-value-of-k-such-that-a1-k-and-b1-k-are-wh/54008873#54008873", "title": "Given (a, b) compute the maximum value of k such that a^{1/k} and b^{1/k} are whole numbers", "body": "<p>Floating numbers are <em>not</em> mathematical real numbers. The computation is \"approximate\". See <a href=\"http://floating-point-gui.de/\" rel=\"nofollow noreferrer\">http://floating-point-gui.de/</a></p>\n\n<p>You could replace the test <code>fmod(pow(a, 1.0/k), 1) != 1.0</code> with something like <code>fabs(fmod(pow(a, 1.0/k), 1) - 1.0) &gt; 0.0000001</code> (and play with various such \ud835\udec6 instead of <code>0.0000001</code>; see also <a href=\"https://en.cppreference.com/w/cpp/types/numeric_limits/epsilon\" rel=\"nofollow noreferrer\">std::numeric_limits::epsilon</a> but use it carefully, since <code>pow</code> might give some error in its computations, and <code>1.0/k</code> also inject imprecisions - details are very complex, dive into <a href=\"https://en.wikipedia.org/wiki/IEEE_754\" rel=\"nofollow noreferrer\">IEEE754</a> specifications).</p>\n\n<p>Of course, you could (and probably should) define your <code>bool almost_equal(double x, double y)</code> function (and use it instead of <code>==</code>, and use its negation instead of <code>!=</code>).</p>\n\n<p>As a rule of thumb, never test floating numbers for equality (i.e. <code>==</code>), but consider instead some small enough <em>distance</em> between them; that is, replace a test like <code>x == y</code> (respectively <code>x != y</code>) with something like <code>fabs(x-y) &lt; EPSILON</code> (respectively <code>fabs(x-y) &gt; EPSILON</code>) where <code>EPSILON</code> is a small positive number, hence testing for a small <a href=\"https://en.wikipedia.org/wiki/Taxicab_geometry\" rel=\"nofollow noreferrer\">L<sub>1</sub> distance</a> (for equality, and a large enough distance for inequality). </p>\n\n<p>And avoid floating point in integer problems.</p>\n\n<p>Actually, predicting or estimating floating point accuracy is <em>very</em> difficult. You might want to consider tools like <a href=\"https://www-pequan.lip6.fr/cadna//\" rel=\"nofollow noreferrer\">CADNA</a>. My colleague Franck V\u00e9drine is an expert on static program analyzers to estimate numerical errors (see e.g. his <a href=\"https://www.teratec.eu/library/pdf/forum/2017/Presentations/A8_03_Forum_TERATEC_2017_%20VEDRINE_CEA.pdf\" rel=\"nofollow noreferrer\">TERATEC 2017 presentation on Fluctuat</a>). It is a difficult research topic, see also D.Monniaux's paper <a href=\"https://dl.acm.org/citation.cfm?doid=1353445.1353446\" rel=\"nofollow noreferrer\"><em>the pitfalls of verifying floating-point computations</em></a> etc. </p>\n\n<p>And floating point errors <a href=\"http://www-users.math.umn.edu/~arnold//455.f96/disasters.html\" rel=\"nofollow noreferrer\">did in some cases</a> cost human lives (or loss of billions of dollars). Search the web for details. There are some cases where <em>all the digits</em> of a computed number are wrong (because the errors may accumulate, and the final result was obtained by combining thousands of operations)! There is some indirect relationship with <a href=\"https://en.wikipedia.org/wiki/Chaos_theory\" rel=\"nofollow noreferrer\">chaos theory</a>, because many programs might have some <a href=\"https://en.wikipedia.org/wiki/Numerical_stability\" rel=\"nofollow noreferrer\">numerical instability</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 1, "last_activity_date": 1546443257, "creation_date": 1546443257, "answer_id": 54009060, "question_id": 54008802, "link": "https://stackoverflow.com/questions/54008802/given-a-b-compute-the-maximum-value-of-k-such-that-a1-k-and-b1-k-are-wh/54009060#54009060", "title": "Given (a, b) compute the maximum value of k such that a^{1/k} and b^{1/k} are whole numbers", "body": "<p>As others have mentioned, comparing floating point values for equality is problematic. If you find a way to work directly with integers, you can avoid this problem. One way to do so is to raise integers to the <code>k</code> power instead of taking the <code>k</code>th root. The details are left as an exercise for the reader.</p>\n"}, {"tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": true, "score": 7, "last_activity_date": 1546449637, "last_edit_date": 1546449637, "creation_date": 1546445306, "answer_id": 54009536, "question_id": 54008802, "link": "https://stackoverflow.com/questions/54008802/given-a-b-compute-the-maximum-value-of-k-such-that-a1-k-and-b1-k-are-wh/54009536#54009536", "title": "Given (a, b) compute the maximum value of k such that a^{1/k} and b^{1/k} are whole numbers", "body": "<p>That is not a programming problem but a mathematical one:</p>\n\n<blockquote>\n  <p>if <code>a</code> is a real, and <code>k</code> a positive integer, and if <code>a^(1./k)</code> is an integer, then <code>a</code> is an integer. (otherwise the aim is to toy with approximation error)</p>\n</blockquote>\n\n<p>So the fastest approach may be to first check if <code>a</code> and <code>b</code> are integer, then do a <a href=\"https://en.wikipedia.org/wiki/Integer_factorization\" rel=\"nofollow noreferrer\">prime decomposition</a> such that a=p<sub>0</sub><sup>e<sub>0</sub></sup> * p<sub>1</sub><sup>e<sub>1</sub></sup> * ..., where p<sub>i</sub> are distinct primes.</p>\n\n<p>Notice that, for a<sup>1/k</sup> to be an integer, each e<sub>i</sub> must also be divisible by k. In other words, k must be a common divisor of the e<sub>i</sub>. The same must be true for the prime powers of b if b<sup>1/k</sup> is to be an integer.</p>\n\n<p>Thus the largest <code>k</code> is the <a href=\"https://en.wikipedia.org/wiki/Greatest_common_divisor\" rel=\"nofollow noreferrer\">greatest common divisor</a> of all e<sub>i</sub> of both <code>a</code> and <code>b</code>.</p>\n\n<hr>\n\n<p>With your approach you will have problem with large numbers. All IIEEE 754 binary64 floating points (the case of double on x86) have 53 significant bits. That means that all double larger than 2<sup>53</sup> are integer.</p>\n\n<p>The function <code>pow(x,1./k)</code> will result in the same value for two different <code>x</code>, so that with your approach you will necessary have false answer, for example the numbers 5<sup>5</sup>*2<sup>90</sup> and 3<sup>5</sup>*2<sup>120</sup> are exactly representable with double. The result of the algorithm is <code>k=5</code>. You may find this value of <code>k</code> with these number but you will also find <code>k=5</code> for   5<sup>5</sup>*2<sup>90</sup>-2<sup>49</sup> and 3<sup>5</sup>*2<sup>120</sup>, because pow(5<sup>5</sup>*2<sup>90</sup>-2<sup>49</sup>,1./5)==pow(5<sup>5</sup>*2<sup>90</sup>). Demo <a href=\"http://coliru.stacked-crooked.com/a/288884cc75c39e16\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>On the other hand, as there are only 53 significant bits, prime number decomposition of double is trivial.</p>\n"}], "owner": {"reputation": 275, "user_id": 10741173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf2848a1e417f38a10583f48678aad9?s=128&d=identicon&r=PG&f=1", "display_name": "oompa", "link": "https://stackoverflow.com/users/10741173/oompa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 1, "accepted_answer_id": 54009536, "answer_count": 3, "score": 5, "last_activity_date": 1550203263, "creation_date": 1546442206, "last_edit_date": 1550203263, "question_id": 54008802, "link": "https://stackoverflow.com/questions/54008802/given-a-b-compute-the-maximum-value-of-k-such-that-a1-k-and-b1-k-are-wh", "title": "Given (a, b) compute the maximum value of k such that a^{1/k} and b^{1/k} are whole numbers", "body": "<p>I'm writing a program that tries to find the minimum value of k > 1 such that the kth root of a and b (which are both given) equals a whole number.</p>\n\n<p>Here's a snippet of my code, which I've commented for clarification.</p>\n\n<pre><code>int main()\n{\n    // Declare the variables a and b.\n    double a;\n    double b;\n    // Read in variables a and b.\n    while (cin &gt;&gt; a &gt;&gt; b) {\n\n        int k = 2;\n\n        // We require the kth root of a and b to both be whole numbers.\n        // \"while a^{1/k} and b^{1/k} are not both whole numbers...\"\n        while ((fmod(pow(a, 1.0/k), 1) != 1.0) || (fmod(pow(b, 1.0/k), 1) != 0)) {\n\n        k++;\n\n        }\n</code></pre>\n\n<p>Pretty much, I read in (a, b), and I start from k = 2 and increment k until the kth roots of a and b are both congruent to 0 mod 1 (meaning that they are divisible by 1 and thus whole numbers). </p>\n\n<p>But, the loop runs infinitely. I've tried researching, and I think it might have to do with precision error; however, I'm not too sure.</p>\n\n<p>Another approach I've tried is changing the loop condition to check whether the floor of a^{1/k} equals a^{1/k} itself. But again, this runs infinitely, likely due to precision error.</p>\n\n<p>Does anyone know how I can fix this issue?</p>\n\n<p>EDIT: for example, when (a, b) = (216, 125), I want to have k = 3 because 216^(1/3) and 125^(1/3) are both integers (namely, 5 and 6).</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1546442776, "post_id": 54008777, "comment_id": 94854419, "body": "If you know about lambda expressions but not constructors, you may have begun your C++ studies at the wrong end."}, {"owner": {"reputation": 7, "user_id": 10858395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08JqONLcdEM/AAAAAAAAAAI/AAAAAAAAAAc/_8J03d-3Fig/photo.jpg?sz=128", "display_name": "philleeroi", "link": "https://stackoverflow.com/users/10858395/philleeroi"}, "edited": false, "score": 0, "creation_date": 1546442779, "post_id": 54008777, "comment_id": 94854421, "body": "Thank you for your answer, i am almost a beginner of c++... i am used to the common usage of the constructor but forget the default one"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10858395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08JqONLcdEM/AAAAAAAAAAI/AAAAAAAAAAc/_8J03d-3Fig/photo.jpg?sz=128", "display_name": "philleeroi", "link": "https://stackoverflow.com/users/10858395/philleeroi"}, "edited": false, "score": 0, "creation_date": 1546442945, "post_id": 54008793, "comment_id": 94854514, "body": "Thank you for your answer. Maybe I really should learn the c++ primer more carefully...."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 7, "user_id": 10858395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08JqONLcdEM/AAAAAAAAAAI/AAAAAAAAAAc/_8J03d-3Fig/photo.jpg?sz=128", "display_name": "philleeroi", "link": "https://stackoverflow.com/users/10858395/philleeroi"}, "edited": false, "score": 0, "creation_date": 1546442999, "post_id": 54008793, "comment_id": 94854535, "body": "@PhilLee Might not be a bad idea ;)"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1546442172, "creation_date": 1546442172, "answer_id": 54008793, "question_id": 54008777, "link": "https://stackoverflow.com/questions/54008777/what-is-the-function-structname-voidnum-threads-stdthreadhardware-concu/54008793#54008793", "title": "What is the function structname (void){num_threads = std::thread::hardware_concurrency();} for in c++? How can I understand it?", "body": "<p>That is <a href=\"https://en.wikipedia.org/wiki/Constructor_(object-oriented_programming)\" rel=\"nofollow noreferrer\">the class's constructor</a>.</p>\n\n<p>This is a special member function that's automatically executed when an instance of the class is instantiated.</p>\n\n<p>Giving it the parameter list <code>(void)</code> is an old-fashioned way of giving it the parameter list <code>()</code>, i.e. no parameters.</p>\n\n<p>For more information, consult the chapter in <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">your C++ book</a> about classes (bearing in mind that <a href=\"https://stackoverflow.com/a/34108140/560648\"><code>struct</code> introduces a <em>class</em></a>).</p>\n"}], "owner": {"reputation": 7, "user_id": 10858395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08JqONLcdEM/AAAAAAAAAAI/AAAAAAAAAAc/_8J03d-3Fig/photo.jpg?sz=128", "display_name": "philleeroi", "link": "https://stackoverflow.com/users/10858395/philleeroi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1546442222, "creation_date": 1546442112, "last_edit_date": 1546442222, "question_id": 54008777, "link": "https://stackoverflow.com/questions/54008777/what-is-the-function-structname-voidnum-threads-stdthreadhardware-concu", "title": "What is the function structname (void){num_threads = std::thread::hardware_concurrency();} for in c++? How can I understand it?", "body": "<p>When I reading code in project of my interest, I come across the function in struct without function name, and maybe it is not the lambda expression capture->return-type{body} either, i just donnot know what kind of this function is?</p>\n\n<pre><code>// file.cc\nstruct AppSettings\n{\n\n    std::string mesh_name;\n\n    std::size_t num_threads;\n\n    AppSettings (void)\n    {\n        num_threads = std::thread::hardware_concurrency();\n    }\n};\n</code></pre>\n\n<p>anyone knows how should i understand this function<br>\n<code>AppSettings (void) {num_threads = std::thread::hardware_concurrency();}</code>?</p>\n"}, {"tags": ["c++", "templates", "inheritance", "namespaces"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 3, "creation_date": 1546441857, "post_id": 54008684, "comment_id": 94853964, "body": "Where does <code>class C</code> come from? You&#39;re missing <code>namespace</code> before <code>NSA</code> and <code>NSB</code>."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1546441885, "post_id": 54008684, "comment_id": 94853974, "body": "Might be related/dup : <a href=\"https://stackoverflow.com/q/495021/5470596\">stackoverflow.com/q/495021/5470596</a>"}, {"owner": {"reputation": 9, "user_id": 9563246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e611daba48a473a78dff66ddd58804c?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Noukou", "link": "https://stackoverflow.com/users/9563246/anna-noukou"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1546441931, "post_id": 54008684, "comment_id": 94853997, "body": "Class C is just a third class where I include the headers of Class A and Template B."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1546441952, "post_id": 54008684, "comment_id": 94854009, "body": "Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1546441977, "post_id": 54008684, "comment_id": 94854021, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8810224/inheriting-from-a-template-class-in-c\">Inheriting from a template class in c++</a>"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1546442031, "post_id": 54008684, "comment_id": 94854045, "body": "@YSC, use the galactic dupe hammer and close this one. That feels like exactly the right dupe."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1546442051, "post_id": 54008684, "comment_id": 94854057, "body": "VTC unclear as it is."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1546442065, "post_id": 54008684, "comment_id": 94854069, "body": "Try to edit the code in question in a way that it compiles instead of explaining what you meant in comments."}], "answers": [{"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 1, "last_activity_date": 1546442294, "creation_date": 1546442294, "answer_id": 54008821, "question_id": 54008684, "link": "https://stackoverflow.com/questions/54008684/how-to-inherit-a-tamplate-and-accessing-its-parameters-in-c/54008821#54008821", "title": "How to inherit a tamplate and accessing its parameters in C++", "body": "<p>You can't derived from a template; you can only derive from a class. So <code>class B</code> has to be derived from an <strong>instantiation</strong> of <code>A</code>:</p>\n\n<pre><code>class B : public A&lt;int&gt; {\n};\n</code></pre>\n\n<p>If you want <code>B</code> to be a template you have to say so:</p>\n\n<pre><code>template &lt;class Ty&gt;\nclass B : public A&lt;Ty&gt; {\n};\n</code></pre>\n\n<p>In either case, accessing members of the base class is a bit tricker than with an ordinary class, because a template can be specialized, and members declared in the template itself might not exist in a particular specialization. So you have to say that you're talking about a member:</p>\n\n<pre><code>class B : public A&lt;int&gt; {\n    unsigned f() { return A&lt;int&gt;::my_var; }\n};\n</code></pre>\n\n<p>Here's another way to say the same thing:</p>\n\n<pre><code>class B : public A&lt;int&gt; {\n    unsigned f() { return this-&gt;my_var; }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41806, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "is_accepted": false, "score": 0, "last_activity_date": 1546442430, "creation_date": 1546442430, "answer_id": 54008858, "question_id": 54008684, "link": "https://stackoverflow.com/questions/54008684/how-to-inherit-a-tamplate-and-accessing-its-parameters-in-c/54008858#54008858", "title": "How to inherit a tamplate and accessing its parameters in C++", "body": "<p>Skipping the 'C' mumbo jumbo, (which you didn't explain clearly) </p>\n\n<p>I believe this is what you are looking for :</p>\n\n<pre><code>namespace NSA{\n    template &lt;typename T&gt; class A{\n    protected:\n       unsigned int my_var;\n    };\n}\n\nnamespace NSB{\n    class B : public NSA::A&lt;int&gt; {\n                        //  ^^^ some type or make class B as template \n    //...\n\n    unsigned int x = my_var;\n    };\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9563246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e611daba48a473a78dff66ddd58804c?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Noukou", "link": "https://stackoverflow.com/users/9563246/anna-noukou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1546442430, "creation_date": 1546441729, "last_edit_date": 1546442051, "question_id": 54008684, "link": "https://stackoverflow.com/questions/54008684/how-to-inherit-a-tamplate-and-accessing-its-parameters-in-c", "title": "How to inherit a tamplate and accessing its parameters in C++", "body": "<p>I am trying to inherit a template in C++. This template is using a namespace NSA, the Child Class has also a namespace called NSB.\nI want to access the protected variables of the template inside a third Class. \nBut I don't know how.</p>\n\n<p>Those are headers:</p>\n\n<pre><code>NSA{\n    template &lt;typename T&gt; class A{\n    protected:\n       unsigned int my_var;\n    }\n}\n\nNSB{\n    class B{ #Don't know how to inherit template A\n    ...\n    }\n}\n</code></pre>\n\n<p>Inside the cpp file of class C (all header files are included)</p>\n\n<pre><code>using namespace NSA;\nNSB{\n    unsigned int x = my_var #Get an error. Unidentified\n    ...\n} \n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "qt", "parsing", "qt5", "qt-creator"], "comments": [{"owner": {"reputation": 1121, "user_id": 3021018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6fhj.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/3021018/aaron"}, "edited": false, "score": 0, "creation_date": 1546441694, "post_id": 54008649, "comment_id": 94853896, "body": "Using Qt version 5.12"}, {"owner": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "edited": false, "score": 0, "creation_date": 1546447384, "post_id": 54008649, "comment_id": 94856766, "body": "Did you try a <code>qmake</code> or build the project ?"}, {"owner": {"reputation": 1121, "user_id": 3021018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6fhj.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/3021018/aaron"}, "reply_to_user": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "edited": false, "score": 0, "creation_date": 1546501052, "post_id": 54008649, "comment_id": 94872462, "body": "The project builds w/o problems. But this is just using Qt creator as code editor."}], "answers": [{"tags": [], "owner": {"reputation": 1121, "user_id": 3021018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6fhj.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/3021018/aaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1546510810, "creation_date": 1546510810, "answer_id": 54020316, "question_id": 54008649, "link": "https://stackoverflow.com/questions/54008649/qt-creator-fails-to-parse-generic-qt-project-but-includes-are-ok/54020316#54020316", "title": "Qt-Creator fails to parse generic Qt-project but includes are OK", "body": "<p><strong>Kind of Solved</strong>: The reason for this is still not clear. For me it seems to work now by using the older Qt Creator that comes with my distribution (based on Qt 5.6). It is able to open and parse correctly the projects created by the not working Qt Creator (based on Qt 5.12) that comes with the downloaded and installed Qt 5.12. The '.includes' file is identical and uses the downloaded Qt 5.12 header files.</p>\n\n<p><strong>Still longing for an explanation ...</strong></p>\n"}], "owner": {"reputation": 1121, "user_id": 3021018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6fhj.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/3021018/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1546510810, "creation_date": 1546441609, "last_edit_date": 1546510698, "question_id": 54008649, "link": "https://stackoverflow.com/questions/54008649/qt-creator-fails-to-parse-generic-qt-project-but-includes-are-ok", "title": "Qt-Creator fails to parse generic Qt-project but includes are OK", "body": "<p>I imported an existing generic project which uses Qt and added all the Qt header paths to the .includes file.</p>\n\n<p>The parser finds the includes but as soon anything Qt related is done, the parser complains about issues I've never seen before.</p>\n\n<p>The code compiles w/o problems on the console.</p>\n\n<p>Among the errors reported by qt creator are  following messages:</p>\n\n<pre><code>* no member named 'qMakeForeachContainer' in namespace 'QtPrivate'\n</code></pre>\n\n<p><em>??? why so</em></p>\n\n<pre><code>* unknown type name 'QComboBox'\n</code></pre>\n\n<p><em>but include  is given an found</em></p>\n\n<pre><code>* type 'QObject' is not a direct or virtual base of '...'\n</code></pre>\n\n<p><em>'QObject' actually IS a direct base ...</em></p>\n\n<p>So what is broken here ? This happens on an newly installed 64bit system with imported generic project (not created as Qt project from within Qt Creator).</p>\n\n<p>This always worked before :-/</p>\n"}, {"tags": ["c++", "qt", "cmake"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1546438725, "post_id": 54007835, "comment_id": 94852439, "body": "Can you inspect the contents of <code>mocs_compilation.cpp</code> in your build tree? It should contain one <code>#include</code> per <code>Q_OBJECT</code> header file. From your error message, it looks like <code>VMS::Factory</code> does not contain a <code>Q_OBJECT</code> declaration."}, {"owner": {"reputation": 326, "user_id": 4532644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e73a60c15edb6141cd387cb00544cea2?s=128&d=identicon&r=PG&f=1", "display_name": "hagor", "link": "https://stackoverflow.com/users/4532644/hagor"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1546438832, "post_id": 54007835, "comment_id": 94852495, "body": "namespace VMS {  \tclass Factory: public VMS::Object \t{ \t\tQ_OBJECT  that&#228;s what I have in Factory class. If I place my Factory /.h and .cpp files in the experimental include and experimental source everything  compiles correctly."}], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 4532644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e73a60c15edb6141cd387cb00544cea2?s=128&d=identicon&r=PG&f=1", "display_name": "hagor", "link": "https://stackoverflow.com/users/4532644/hagor"}, "is_accepted": true, "score": 1, "last_activity_date": 1546440023, "creation_date": 1546440023, "answer_id": 54008267, "question_id": 54007835, "link": "https://stackoverflow.com/questions/54007835/linkage-of-qt-objects-in-cmake/54008267#54008267", "title": "linkage of qt objects in cmake", "body": "<p>Solved.\nI had to  \"set (CMAKE_AUTOMOC ON)\" in my cmake file for library.  </p>\n"}], "owner": {"reputation": 326, "user_id": 4532644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e73a60c15edb6141cd387cb00544cea2?s=128&d=identicon&r=PG&f=1", "display_name": "hagor", "link": "https://stackoverflow.com/users/4532644/hagor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 54008267, "answer_count": 1, "score": -3, "last_activity_date": 1546440023, "creation_date": 1546438229, "question_id": 54007835, "link": "https://stackoverflow.com/questions/54007835/linkage-of-qt-objects-in-cmake", "title": "linkage of qt objects in cmake", "body": "<p>I have a library VMSCore which has VMSObject::public QObject.\nI implemented factory class which inherit from VMSObject class. \nAfter I built my library, I try to link it to my exe project.\nI get linkage error: </p>\n\n<blockquote>\n  <p>Severity  Code    Description Project File    Line    Suppression State\n  Error LNK2019 unresolved external symbol \"public: virtual int __cdecl\n  VMS::Factory::qt_metacall(enum QMetaObject::Call,int,void * *)\"\n  (?qt_metacall@Factory@VMS@@UEAAHW4Call@QMetaObject@@HPEAPEAX@Z)\n  referenced in function \"public: virtual int __cdecl\n  VMS::Algorithm::Factory::qt_metacall(enum QMetaObject::Call,int,void *\n  *)\" (?qt_metacall@Factory@Algorithm@VMS@@UEAAHW4Call@QMetaObject@@HPEAPEAX@Z) CVFnVMSExperimental C:\\Users\\Matvey\\cvfn\\build\\Products\\CVFnVMS\\mocs_compilation.obj    1</p>\n</blockquote>\n\n<p>As far as I understand the error, I don't link functions defined in moc files.\nWhat is a right way to link moc-created files in CMake?  </p>\n"}, {"tags": ["c++", "function", "class", "pointers", "reference"], "comments": [{"owner": {"reputation": 117, "user_id": 10645185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d77fdfe5f09d9816b0f629ab5faea5?s=128&d=identicon&r=PG&f=1", "display_name": "RyanN1220", "link": "https://stackoverflow.com/users/10645185/ryann1220"}, "edited": false, "score": 4, "creation_date": 1546438201, "post_id": 54007781, "comment_id": 94852181, "body": "well to get it to work first, you need to be using something called an Virtual Function. The reason for this is that since A is the Superclass, any subclass will contain all of A&#39;s of methods, to function overload or use the name p for both methods you must declare the virtual void in the super class as whatever the default behavior is, and then you can define the functions in subclasses as normal. <a href=\"https://www.geeksforgeeks.org/virtual-function-cpp/\" rel=\"nofollow noreferrer\">Further Explanation here</a>"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1546441138, "post_id": 54007781, "comment_id": 94853578, "body": "Because C++ is not Java. This is how it works in Java, but not C++."}], "answers": [{"tags": [], "owner": {"reputation": 25661, "user_id": 430766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee7e736eeb33c4b03d4a5e6e813a9abc?s=128&d=identicon&r=PG", "display_name": "bitmask", "link": "https://stackoverflow.com/users/430766/bitmask"}, "is_accepted": false, "score": 1, "last_activity_date": 1546438428, "creation_date": 1546438428, "answer_id": 54007886, "question_id": 54007781, "link": "https://stackoverflow.com/questions/54007781/why-does-a-class-get-referenced-instead-of-its-subclass-when-a-pointer-to-that-s/54007886#54007886", "title": "Why does a class get referenced instead of its subclass when a pointer to that subclass is passed to a function?", "body": "<p>In order to invoke dynamic dispatch (that is, to call the function of the run-time-type), you must mark a function as <code>virtual</code>:</p>\n\n<pre><code>class A {\npublic:\n    virtual void p() {\n        std::cout &lt;&lt; \"boring...\";\n    }\n};\n</code></pre>\n\n<p>This is because of C++'s philosophy of: you don't pay for what you don't need. And dynamic dispatch is not free, as you need to look up the correct function pointer from the object.</p>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1546438554, "creation_date": 1546438554, "answer_id": 54007912, "question_id": 54007781, "link": "https://stackoverflow.com/questions/54007781/why-does-a-class-get-referenced-instead-of-its-subclass-when-a-pointer-to-that-s/54007912#54007912", "title": "Why does a class get referenced instead of its subclass when a pointer to that subclass is passed to a function?", "body": "<p>Virtual dispatch is not automatic in C++. Your object may be a <code>B</code> as well as an <code>A</code>, but <code>f()</code> only knows that you gave it a pointer to an <code>A</code>. It does not know that a <code>B</code> part exists too.</p>\n\n<p>You can get this behaviour using the keyword <code>virtual</code>, with some runtime performance cost.</p>\n\n<p>Consult the chapter in your C++ book about polymorphism for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 1, "last_activity_date": 1546438792, "creation_date": 1546438792, "answer_id": 54007973, "question_id": 54007781, "link": "https://stackoverflow.com/questions/54007781/why-does-a-class-get-referenced-instead-of-its-subclass-when-a-pointer-to-that-s/54007973#54007973", "title": "Why does a class get referenced instead of its subclass when a pointer to that subclass is passed to a function?", "body": "<p>One of the fundamental design rules for the C++ language is \"you don't pay for what you don't use\". Calling functions that are defined in a derived class through a pointer to the base type is a bit tricky, so the rule is that you have to tell the compiler that you mean to do that. So in the code in the question, <code>A* obj = whatever; a-&gt;p();</code> calls <code>A::p</code> (that is, the version of <code>p</code> that's defined in the class <code>A</code>). And <code>B* obj = whatever; b-&gt;p();</code> calls <code>B::p</code>. In order for <code>a-&gt;p()</code> to call the version in <code>B</code> you have to tell the compiler that that's what you want to do, and you do that by marking <code>A::p</code> as <code>virtual</code>:</p>\n\n<pre><code>class A {\npublic:\n    virtual void p() {\n    }\n};\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8963906"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1546440837, "answer_count": 3, "score": 0, "last_activity_date": 1546438792, "creation_date": 1546438044, "question_id": 54007781, "link": "https://stackoverflow.com/questions/54007781/why-does-a-class-get-referenced-instead-of-its-subclass-when-a-pointer-to-that-s", "closed_reason": "Duplicate", "title": "Why does a class get referenced instead of its subclass when a pointer to that subclass is passed to a function?", "body": "<p>Considering a class \"A\", its subclass \"B\" and a function \"f\". The function \"f\" calls a method \"p\" of its single parameter \"A* obj\", which is a pointer to \"A\" objects. Now, after creating an object \"b\" of the class \"B\" and passing its pointer to \"f\", \"A\" gets referenced instead of \"B\", even if \"b\" is a \"B\" object.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass A {\npublic:\n    void p() {\n        std::cout &lt;&lt; \"boring...\";\n    }\n};\n\nclass B : public A {\npublic:\n    void p() {\n        std::cout &lt;&lt; \"woo!\";\n    }\n};\n\nvoid f(A * obj) {\n    obj-&gt;p();\n}\n\nint main(int argc, char **argv) {\n    B b;\n    f(&amp;b);\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>boring...\n</code></pre>\n\n<p>Why does this happen?</p>\n"}, {"tags": ["c++", "memory-leaks", "valgrind"], "comments": [{"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 2, "creation_date": 1546438115, "post_id": 54007764, "comment_id": 94852130, "body": "In the first case, you allocate some memory with <code>new</code>, so you must release it with <code>delete</code>. In the second case, you just take a pointer to an object on the stack - no need to <code>delete</code> it."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 4, "last_activity_date": 1546438081, "creation_date": 1546438081, "answer_id": 54007794, "question_id": 54007764, "link": "https://stackoverflow.com/questions/54007764/why-does-memory-leak-in-one-case-and-not-in-another/54007794#54007794", "title": "Why does memory leak in one case and not in another", "body": "<p>You don't get a memory leak because you have a pointer.</p>\n\n<p>You get a memory leak because you <code>new</code>'d something and did not <code>delete</code> it.</p>\n\n<p>Obtaining a pointer to an automatic storage variable does not stop the variable from being cleaned up automatically.</p>\n\n<p>In fact, attempting to <code>delete &amp;a</code> in that case would be wrong/broken/evil/illegal/heresy.</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1546438262, "creation_date": 1546438262, "answer_id": 54007844, "question_id": 54007764, "link": "https://stackoverflow.com/questions/54007764/why-does-memory-leak-in-one-case-and-not-in-another/54007844#54007844", "title": "Why does memory leak in one case and not in another", "body": "<p>This is no different from:</p>\n\n<pre><code>// first case, leak\nint *j = new int (5);\n//\n// second case, no leak\nint q = 5;\nint *j = &amp;q;\n</code></pre>\n\n<p>In the first case, we've allocated memory with <code>new</code> and it's our responsibility to <code>delete</code> it when we're done. In the second case, we create <code>q</code> on the stack and it's destroyed when it goes out of scope.</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 5, "last_activity_date": 1546441977, "last_edit_date": 1546441977, "creation_date": 1546438263, "answer_id": 54007846, "question_id": 54007764, "link": "https://stackoverflow.com/questions/54007764/why-does-memory-leak-in-one-case-and-not-in-another/54007846#54007846", "title": "Why does memory leak in one case and not in another", "body": "<p>The reason for this behavior is that your class <code>A</code> is not designed to take ownership of <code>std::string*</code> passed into it: its <code>std::string *s</code> member assumes that the object the pointer to which is passed into the constructor would be destroyed externally.</p>\n\n<p>This leads to a memory leak when the object is not destroyed: <code>delete</code> is never called on <code>new string</code> passed into the constructor in the first case, causing a memory leak.</p>\n\n<p>In the second case the pointer points to a string in automatic storage. It gets destroyed when <code>main</code> ends, preventing the memory leak.</p>\n"}, {"tags": [], "owner": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "is_accepted": true, "score": 1, "last_activity_date": 1546438801, "creation_date": 1546438801, "answer_id": 54007977, "question_id": 54007764, "link": "https://stackoverflow.com/questions/54007764/why-does-memory-leak-in-one-case-and-not-in-another/54007977#54007977", "title": "Why does memory leak in one case and not in another", "body": "<p><strong>CASE==0</strong></p>\n\n<pre><code>auto a = A(new std::string(\"Hello\"));\n</code></pre>\n\n<p>This means you are <code>new</code>-ing an object in heap -> you have to <strong>explicitly</strong> <code>delete</code> it - that you didn't in the snippet -> memory leaks.</p>\n\n<p><strong>else</strong></p>\n\n<pre><code>auto s = std::string(\"Hello\");\nauto a = A(&amp;s);\n</code></pre>\n\n<ul>\n<li><code>auto s = std::string(\"Hello\");</code>: This means you are creating an object in stack and,</li>\n<li><code>auto a = A(&amp;s);</code>: take its address (in stack, of course).</li>\n<li>The created object will be auto-deleted once the variable goes out of scope</li>\n</ul>\n\n<p>-> no memory leak.</p>\n"}], "owner": {"reputation": 568, "user_id": 6082378, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/068b373612159246ce9c2e723573e1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jayendra Parmar", "link": "https://stackoverflow.com/users/6082378/jayendra-parmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 54007977, "answer_count": 4, "score": 0, "last_activity_date": 1546595646, "creation_date": 1546438003, "last_edit_date": 1546595646, "question_id": 54007764, "link": "https://stackoverflow.com/questions/54007764/why-does-memory-leak-in-one-case-and-not-in-another", "title": "Why does memory leak in one case and not in another", "body": "<p>I am creating a <code>c++</code> object with two slightly different ways, in the following code when <code>CASE</code> is <code>0</code> there is a memory leak, but no memory leak in the <code>else</code> case.</p>\n\n<pre><code>#include &lt;string&gt;\n#define CASE 1\n\nclass A {\nprivate:\n  std::string *s;\npublic:\n  A(std::string *p_s) { s = p_s; }\n};\n\nint main() {\n#if CASE==0\n  auto a = A(new std::string(\"Hello\"));\n#else\n  auto s = std::string(\"Hello\");\n  auto a = A(&amp;s);\n#endif\n}\n</code></pre>\n\n<p>when I set <code>CASE 0</code> the <code>valgrind</code> says that there is a memory leak</p>\n\n<pre><code>valgrind ./a.out \n==24351== Memcheck, a memory error detector\n==24351== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==24351== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==24351== Command: ./a.out\n==24351== \n==24351== \n==24351== HEAP SUMMARY:\n==24351==     in use at exit: 32 bytes in 1 blocks\n==24351==   total heap usage: 2 allocs, 1 frees, 72,736 bytes allocated\n==24351== \n==24351== LEAK SUMMARY:\n==24351==    definitely lost: 32 bytes in 1 blocks\n==24351==    indirectly lost: 0 bytes in 0 blocks\n==24351==      possibly lost: 0 bytes in 0 blocks\n==24351==    still reachable: 0 bytes in 0 blocks\n==24351==         suppressed: 0 bytes in 0 blocks\n==24351== Rerun with --leak-check=full to see details of leaked memory\n==24351== \n==24351== For counts of detected and suppressed errors, rerun with: -v\n==24351== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>in the else case (i.e. <code>define CASE 1</code>)  it works as expected and valgrind doesn't report any memory leak.</p>\n\n<p>I am not able to understand in either case I am passing a pointer and I am not explicitly freeing the memory then why do they behave differently?</p>\n"}, {"tags": ["c++", "multiplication"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546437519, "post_id": 54007622, "comment_id": 94851848, "body": "You are trying to round to a value that simply does not exist! Why not apply precision limits at the point of use, e.g. output to console? What is the use? What is the goal?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 4, "creation_date": 1546437555, "post_id": 54007622, "comment_id": 94851862, "body": "1) Related: <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a> 2) Sidenote: How can you multiply <code>70.82</code> by <code>100.00</code>, and get <code>70.8199999</code> as a result? O.o"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1546437597, "post_id": 54007622, "comment_id": 94851888, "body": "Are you storing money?  If so you shouldn&#39;t use a floating point type and use an integer representing the number of cents you have.  If this isn&#39;t the case, do you really need to round or just display to decimal places?  If that is the case just tell the output stream to show 2 places."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 3, "creation_date": 1546437600, "post_id": 54007622, "comment_id": 94851890, "body": "And your rounding is truncation, not rounding, use <code>std::lround</code>."}], "answers": [{"tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": true, "score": 2, "last_activity_date": 1546439035, "creation_date": 1546439035, "answer_id": 54008030, "question_id": 54007622, "link": "https://stackoverflow.com/questions/54007622/problem-with-multiplying-2-numbers-in-truncation-procedure/54008030#54008030", "title": "Problem with multiplying 2 numbers in truncation procedure", "body": "<p>The problem is that neither the input <code>value</code> nor the result <code>res</code> is representable in a computer memory accurately for 70.82. As @MatthieuBrucher suggested, you should use <code>std::lround</code>; consider the following code:</p>\n\n<pre><code>auto value = 70.82;\nstd::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(20) &lt;&lt; value &lt;&lt; std::endl;\n\nauto tmp = std::lround(value * 100.0);\nstd::cout &lt;&lt; tmp &lt;&lt; std::endl;\n\ndouble res = static_cast&lt;double&gt;(tmp) / 100.00;\nstd::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(20) &lt;&lt; res &lt;&lt; std::endl;\n</code></pre>\n\n<p>Which gives the following output:</p>\n\n<pre><code>70.81999999999999317879\n7082\n70.81999999999999317879\n</code></pre>\n\n<p>However, you can store the result as a pair of integral numbers, where the first one will represent the integral part and the second one the fractional part:</p>\n\n<pre><code>auto res_integral = tmp / 100;\nauto res_fractional = tmp % 100;\nstd::cout &lt;&lt; res_integral &lt;&lt; \".\" &lt;&lt; res_fractional &lt;&lt; std::endl;\n</code></pre>\n\n<p>Or, simply store it as <code>tmp</code> with the knowledge that you are storing <em>100*x</em> instead of <em>x</em>.</p>\n"}], "owner": {"reputation": 850, "user_id": 3393524, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/114a62c4bb97c83106056189bdf9ef4a?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Yanakiev", "link": "https://stackoverflow.com/users/3393524/vladimir-yanakiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 54008030, "answer_count": 1, "score": -1, "last_activity_date": 1546439035, "creation_date": 1546437417, "last_edit_date": 1546437704, "question_id": 54007622, "link": "https://stackoverflow.com/questions/54007622/problem-with-multiplying-2-numbers-in-truncation-procedure", "title": "Problem with multiplying 2 numbers in truncation procedure", "body": "<p>I need truncation of 2 decimal digits after decimal comma. \nI am using following code in C++:</p>\n\n<pre><code>auto doubleTmp = value * 100.00;\nint64_t tmp = static_cast&lt;int64_t&gt;(doubleTmp);\ndouble res = ( static_cast&lt;double&gt;(tmp) ) /100.00;\n</code></pre>\n\n<p>but for example when I set value = 70.82 doubleTmp is 70.8199999 and result is 70.81. What will better way for this and why?</p>\n"}, {"tags": ["c++", "hex"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1546437114, "post_id": 54007533, "comment_id": 94851674, "body": "Please edit your question to contain <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1546437394, "post_id": 54007533, "comment_id": 94851798, "body": "The suggested duplicate doesn&#39;t address the particular error this poster made."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1546437427, "post_id": 54007533, "comment_id": 94851810, "body": "@john It gives four or five canonical ways to achieve the stated goal. The error the poster made isn&#39;t particularly important. Re-opening this was counter-productive."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "edited": false, "score": 0, "creation_date": 1546437745, "post_id": 54007598, "comment_id": 94851951, "body": "I&#39;ve already tried this, but it does not work.The output is:"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "edited": false, "score": 1, "creation_date": 1546437837, "post_id": 54007598, "comment_id": 94851993, "body": "@nima: This looks good to me. What doesn&#39;t work about it?"}, {"owner": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "edited": false, "score": 0, "creation_date": 1546438204, "post_id": 54007598, "comment_id": 94852182, "body": "The output is: {-124,13,-114,-120,-80,-84} I need exactly {0x84,0x0D,0x8E,0x88,0xB0,0xAC} or even {84,0D,8E,88,B0,AC}"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "edited": false, "score": 0, "creation_date": 1546438566, "post_id": 54007598, "comment_id": 94852366, "body": "@nima -124 and 0x84 are the same, 13 and 0x0D are the same, just different base and different signedness. You&#39;re going to have to be clearer about exactly what you want because it&#39;s not making much sense at the moment"}, {"owner": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "edited": false, "score": 0, "creation_date": 1546438783, "post_id": 54007598, "comment_id": 94852471, "body": "I check the value by watch in visual studio. I need to pass MAC to a function."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "edited": false, "score": 0, "creation_date": 1546438861, "post_id": 54007598, "comment_id": 94852502, "body": "@nima Well Visual Studio is just printing the same numbers in a different way. The code is correct. The number thirteen is 13 in decimal, and 0x0D in hexadecimal, it&#39;s all the same thing."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "edited": false, "score": 0, "creation_date": 1546439132, "post_id": 54007598, "comment_id": 94852639, "body": "@nima Internally C++ just has numbers, it doesn&#39;t have hexadecimal numbers or decimal numbers. Those are just differences in the way numbers are printed. The same number can be printed in several different ways"}, {"owner": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "edited": false, "score": 0, "creation_date": 1546439251, "post_id": 54007598, "comment_id": 94852690, "body": "In fact, your explanation worked! I pass the variable and function work correctly. thank you Bathsheba and john."}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1546437290, "creation_date": 1546437290, "answer_id": 54007598, "question_id": 54007533, "link": "https://stackoverflow.com/questions/54007533/convert-stdstring-to-unsigned-char/54007598#54007598", "title": "convert std::string to unsigned char", "body": "<p>It should be (other errors notwithstanding)</p>\n\n<pre><code>sscanf(s.c_str(), \"%02X%02X%02X%02X%02X%02X\", &amp;MAC[0], &amp;MAC[1], &amp;MAC[2], \n    &amp;MAC[3], &amp;MAC[4], &amp;MAC[5]);\n</code></pre>\n\n<p><code>sscanf</code> (and variants) require pointers in order to change the variables that are being read into.</p>\n\n<p>Surprised your compiler didn't warn you about that error.</p>\n"}], "owner": {"reputation": 1, "user_id": 10858021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d5f87b7b68a994483d0f23c91530a?s=128&d=identicon&r=PG&f=1", "display_name": "nima", "link": "https://stackoverflow.com/users/10858021/nima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "closed_date": 1546437882, "answer_count": 1, "score": -2, "last_activity_date": 1546437989, "creation_date": 1546437026, "last_edit_date": 1546437157, "question_id": 54007533, "link": "https://stackoverflow.com/questions/54007533/convert-stdstring-to-unsigned-char", "closed_reason": "Duplicate", "title": "convert std::string to unsigned char", "body": "<p>I have a string like this:</p>\n\n<pre><code>std::string s=\"840D8E88B0AC\";\n</code></pre>\n\n<p>and an array:</p>\n\n<pre><code>char MAC[6];\n</code></pre>\n\n<p>I want to produce this:</p>\n\n<pre><code>MAC={0x84,0x0D,0x8E,0x88,0xB0,0xAC};\n</code></pre>\n\n<p>I try with sscanf() but I can't make it.</p>\n\n<pre><code>sscanf(s.c_str(), \"%02X%02X%02X%02X%02X%02X\", MAC[0], MAC[1], MAC[2], MAC[3], MAC[4], MAC[5]);\n</code></pre>\n"}, {"tags": ["c++", "windows", "visual-studio-2017", "wininet"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10749893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf333266f35a373985641c9a3aba096?s=128&d=identicon&r=PG&f=1", "display_name": "Apex", "link": "https://stackoverflow.com/users/10749893/apex"}, "edited": false, "score": 0, "creation_date": 1546443604, "post_id": 54007474, "comment_id": 94854845, "body": "Worked for me! But do you mind explaining about the &quot;be careful&quot; part?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 61, "user_id": 10749893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf333266f35a373985641c9a3aba096?s=128&d=identicon&r=PG&f=1", "display_name": "Apex", "link": "https://stackoverflow.com/users/10749893/apex"}, "edited": false, "score": 0, "creation_date": 1546443986, "post_id": 54007474, "comment_id": 94855048, "body": "@Apex Sure - added"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 7, "last_activity_date": 1546444015, "last_edit_date": 1546444015, "creation_date": 1546436752, "answer_id": 54007474, "question_id": 54007437, "link": "https://stackoverflow.com/questions/54007437/using-stdfilesystem-output-as-lpcwstr/54007474#54007474", "title": "Using std::filesystem output as LPCWSTR", "body": "<p><a href=\"https://stackoverflow.com/a/2230888/560648\"><code>LPCWSTR</code> is Microsoft's obfuscation of the <code>const wchar_t*</code> type</a>, and <a href=\"https://en.cppreference.com/w/cpp/filesystem/path/string\" rel=\"nofollow noreferrer\"><code>filesystem</code> paths conveniently have a <code>wstring()</code> member function</a>. As you may recall, C++ strings give you access to their character buffer, too, via <code>c_str()</code>.</p>\n\n<p>So, <code>entry.path().filename().wstring().c_str()</code> is a <code>LPCWSTR</code> you can use (ugh!). Be careful to use that immediately, or store the result of <code>wstring()</code> somewhere for as long as you need the <code>LPCWSTR</code> to survive, because <code>wstring()</code> returns by value and you don't want a dangling pointer.</p>\n\n<pre><code>// Untested, but a logical adaptation of your code\nconst std::string path = \"C:\\\\Programs\";\nstd::experimental::filesystem::recursive_directory_iterator it(path);\nfor (const auto&amp; entry : it)\n{\n    const std::wstring filename = entry.path().filename().wstring();\n\n    FtpPutFile(\n       hIConnect,\n       filename.c_str(),\n       filename.c_str(),\n       FTP_TRANSFER_TYPE_BINARY,\n       0\n    );\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10749893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf333266f35a373985641c9a3aba096?s=128&d=identicon&r=PG&f=1", "display_name": "Apex", "link": "https://stackoverflow.com/users/10749893/apex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "accepted_answer_id": 54007474, "answer_count": 1, "score": 1, "last_activity_date": 1546444015, "creation_date": 1546436580, "last_edit_date": 1546443543, "question_id": 54007437, "link": "https://stackoverflow.com/questions/54007437/using-stdfilesystem-output-as-lpcwstr", "title": "Using std::filesystem output as LPCWSTR", "body": "<p>I'm making a program which recursively lists all files in a certain directory and uploads each file separately to an FTP server using WinINet.\nThe problem I'm encountering is using filesystem::path::filename in the FtpPutFile() function because a LPCWSTR is needed.\nWhats the best and easiest way to convert it (or somehow use it as is)?</p>\n\n<pre><code>    std::string path = \"C:\\\\Programs\";\n    for (const auto &amp; entry : std::experimental::filesystem::recursive_directory_iterator(path))\n        FtpPutFile(hIConnect, entry.path().filename(), entry.path().filename(), FTP_TRANSFER_TYPE_BINARY, 0);\n</code></pre>\n\n<p>The error I get is:\nno suitable conversion function from \"const std::experimental::filesystem::v1::path\" to \"LPCWSTR\" exists    </p>\n\n<p>EDIT: Here is a solution that worked for me, by following Lightness solution:</p>\n\n<pre><code>    std::string path = \"C:\\\\Programs\";\n    for (const auto &amp; entry : std::experimental::filesystem::recursive_directory_iterator(path))\n        FtpPutFile(hIConnect, entry.path().wstring().c_str(), entry.path().filename().wstring().c_str(), FTP_TRANSFER_TYPE_BINARY, 0);\n</code></pre>\n"}, {"tags": ["c++", "game-engine"], "comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1546447066, "post_id": 54007332, "comment_id": 94856597, "body": "Where did you get the half from? do your components generally come in pairs?"}, {"owner": {"reputation": 43, "user_id": 10544850, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BwxsBzS8cVg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBbgHGEdzeqzA-64nbbV0UG1vEOog/mo/photo.jpg?sz=128", "display_name": "Unicorn", "link": "https://stackoverflow.com/users/10544850/unicorn"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1546476118, "post_id": 54007332, "comment_id": 94867087, "body": "With component size less than half of the line size, the cpu can put at least two component in one cache line, so only one cache miss to read 4 continuous component data. If the component size happen to be equal to one line size, then one cache miss per reading, even worse than maybe 68 Bytes. Am I right ?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1546506855, "post_id": 54007332, "comment_id": 94874612, "body": "Not really, if you are accessing sequentially, the CPU can often prefetch. What might be more important is keeping the overall volume of data below the total cache size. But you have to measure to know for sure."}, {"owner": {"reputation": 43, "user_id": 10544850, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BwxsBzS8cVg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBbgHGEdzeqzA-64nbbV0UG1vEOog/mo/photo.jpg?sz=128", "display_name": "Unicorn", "link": "https://stackoverflow.com/users/10544850/unicorn"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1546514020, "post_id": 54007332, "comment_id": 94878319, "body": "I got it. Prefetch will do cache loading as long as I keep components data continuous in memory, just as ECS does. Thank you."}], "owner": {"reputation": 43, "user_id": 10544850, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BwxsBzS8cVg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBbgHGEdzeqzA-64nbbV0UG1vEOog/mo/photo.jpg?sz=128", "display_name": "Unicorn", "link": "https://stackoverflow.com/users/10544850/unicorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546442635, "creation_date": 1546436041, "last_edit_date": 1546442635, "question_id": 54007332, "link": "https://stackoverflow.com/questions/54007332/should-the-component-size-in-ecs-framework-be-less-than-half-of-the-cpu-line-siz", "title": "Should the component size in ECS framework be less than half of the CPU line size?", "body": "<p>I'm working on my game engine based on the ECS framework.\nI have not care much about the size of an component before. While today I learnt something about the cpu cache, and it's said that generally the cache line size is 64 Bytes.</p>\n\n<p>So should I always keep the size of an component lower than half of the cache line size (32 Bytes), in order to take the advantage of cpu cache ?</p>\n"}, {"tags": ["c++", "function", "variadic-functions"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 8, "creation_date": 1546436055, "post_id": 54007321, "comment_id": 94851140, "body": "C or C++?  They are two different languages."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10043112"}, "edited": false, "score": 0, "creation_date": 1546436327, "post_id": 54007321, "comment_id": 94851268, "body": "sorry, that was a typo, I corrected it"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546436894, "post_id": 54007321, "comment_id": 94851562, "body": "Use variadic templates for C++, this will make your function a real <code>int(int, int, long)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 4, "last_activity_date": 1546436261, "creation_date": 1546436261, "answer_id": 54007378, "question_id": 54007321, "link": "https://stackoverflow.com/questions/54007321/variadic-function-to-function-pointer/54007378#54007378", "title": "variadic function to function pointer", "body": "<p>C-style variadic functions are their own special beast. Their arguments must be unwrapped with the <code>va_list</code> family of functions. There is no compatibility with non-variadic functions, and they are not macros, and no.</p>\n\n<p>Given your use of <code>auto</code> I assume that you're asking about C++, despite the double-tagging. <a href=\"https://wiki.sei.cmu.edu/confluence/display/cplusplus/DCL50-CPP.+Do+not+define+a+C-style+variadic+function\" rel=\"noreferrer\">Try to avoid functions like that in C++.</a></p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 2, "last_activity_date": 1546436789, "creation_date": 1546436789, "answer_id": 54007482, "question_id": 54007321, "link": "https://stackoverflow.com/questions/54007321/variadic-function-to-function-pointer/54007482#54007482", "title": "variadic function to function pointer", "body": "<p>You are free to cast a function pointer to a function pointer of a different type, but calling a function through a function pointer of a different type is undefined behaviour. (So the only valid thing you can do with the cast function pointer is to cast it back to rhe correct type.)</p>\n\n<p>Variadic functions are not the same type as functions with a specific number of arguments. So the result of the cast cannot be used to call the function.</p>\n\n<p>If you try it on some compiler, you might find that it does what you expect. But that doesn't make it valid; it may well break on a different platform or compiler version.</p>\n\n<p>(The above is true for both C and C++.)</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1546438738, "last_edit_date": 1546438738, "creation_date": 1546438263, "answer_id": 54007845, "question_id": 54007321, "link": "https://stackoverflow.com/questions/54007321/variadic-function-to-function-pointer/54007845#54007845", "title": "variadic function to function pointer", "body": "<p>In C, these types are <strong>not</strong> compatible.</p>\n\n<p>Section 6.2.7 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> regarding \"Compatible type and composite type\" says the following regarding the compatibility of function pointers:</p>\n\n<blockquote>\n  <p><em>3</em> A composite type can be constructed from two types that are compatible; it is a type that is compatible with both of the two types\n  and satisfies the following conditions:</p>\n  \n  <ul>\n  <li>If both types are array types, the following rules are applied:\n  \n  <ul>\n  <li>If  one  type  is  an  array  of  known  constant  size,  the  composite  type  is  an  array  of that size.</li>\n  <li>Otherwise,  if  one  type  is  a  variable  length  array  whose  size  is  specified  by  an expression that is not evaluated, the\n  behavior is undefined.</li>\n  <li>Otherwise,  if  one  type  is  a  variable  length  array  whose  size  is  specified,  the composite type is a variable length array of\n  that size.</li>\n  <li>Otherwise, if one type is a variable length array of unspecified size, the composite type is a variable length array of unspecified\n  size.</li>\n  <li>Otherwise,  both  types  are  arrays  of  unknown  size  and  the  composite  type  is  an array of unknown size. The  element  type  of \n  the  composite  type  is  the  composite  type  of  the  two  element\n  types.</li>\n  </ul></li>\n  <li><strong>If only  one  type  is  a  function  type  with  a  parameter  type  list  (a  function  prototype), the composite type is a function\n  prototype with the parameter type list.</strong></li>\n  <li><strong>If both types are function types with parameter type lists, the type of each parameter in  the  composite  parameter  type  list  is  the \n  composite  type  of  the  corresponding parameters.</strong></li>\n  </ul>\n  \n  <p>...</p>\n  \n  <p><em>5</em> EXAMPLE     Given the following two file scope declarations:</p>\n\n<pre><code>int f(int (*)(), double (*)[3]);\nint f(int (*)(char *), double (*)[]);\n</code></pre>\n  \n  <p>The resulting composite type for the function is:</p>\n\n<pre><code>int f(int (*)(char *), double (*)[3]);\n</code></pre>\n</blockquote>\n\n<p>Section 6.7.6.3p15 states:</p>\n\n<blockquote>\n  <p>For two  function  types  to  be  compatible,  both  shall  specify \n  compatible  return  types.  <strong>Moreover,  the  parameter  type \n  lists,  if  both  are  present,  shall  agree  in  the  number  of\n  parameters  and  in  use  of  the  ellipsis  terminator;</strong> \n  corresponding  parameters  shall  have compatible types.  If one type\n  has a parameter type list and the other type is specified by a\n  function  declarator  that  is  not  part  of  a  function  definition\n  and  that  contains  an  empty identifier list, the parameter list\n  shall not have an ellipsis terminator and the type of each parameter \n  shall  be  compatible  with  the  type  that  results  from  the \n  application  of  the default argument promotions.  If one type has a\n  parameter type list and the other type is specified by a function\n  definition that contains a (possibly empty) identifier list, both\n  shall agree  in  the  number  of  parameters,  and  the  type  of \n  each  prototype  parameter  shall  be compatible  with  the  type \n  that  results  from  the  application  of  the  default  argument\n  promotions  to  the  type  of  the  corresponding  identifier.   (In \n  the  determination  of  type compatibility  and  of  a  composite \n  type,  each  parameter  declared  with  function  or  array type is\n  taken as having the adjusted type and each parameter declared with\n  qualified type is taken as having the unqualified version of its\n  declared type.)</p>\n</blockquote>\n\n<p>In your example:</p>\n\n<pre><code>int test(int, ...);\n</code></pre>\n\n<p>This function is compatible with the following:</p>\n\n<pre><code>int (*)();            // a function taking an unknown number of parameters and returns an int\nint (*)(int, ...);    // a function taking an int and variable parameters after and returns an int\n</code></pre>\n\n<p>But not:</p>\n\n<pre><code>int (*)(int, int, long);    // a function taking an int, an int, and a long, and returns an int\n</code></pre>\n\n<p>Because both function type specify a parameter list and because the number of parameters nor does the use of ellipsis agree, the types are not compatible.  Attempting to call a function through an incompatible pointer invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> as per section 6.3.2.3p8:</p>\n\n<blockquote>\n  <p>A pointer to a function of one type may be converted to a pointer to a\n  function of another type and back again; the result shall compare\n  equal to the original pointer.  <strong>If a converted pointer is used to call\n  a function whose type is not compatible with the referenced type, the\n  behavior is undefined.</strong></p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10043112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 54007845, "answer_count": 3, "score": 0, "last_activity_date": 1546438738, "creation_date": 1546436018, "last_edit_date": 1546437883, "question_id": 54007321, "link": "https://stackoverflow.com/questions/54007321/variadic-function-to-function-pointer", "title": "variadic function to function pointer", "body": "<p>Is There any way to cast a variadic function to a function pointer like this, is it legal? I am asking both for C and for C++, but since this construct exists in both languages, I have put both questions in one.</p>\n\n<pre><code>extern int test(int, ...);\nauto testptr = (int(*)(int, int, long)) &amp;test;\n</code></pre>\n\n<p>Thanks,\nthejack</p>\n"}, {"tags": ["c++", "dynamic-programming"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 8, "creation_date": 1546434670, "post_id": 54006912, "comment_id": 94850470, "body": "Competitive programming is a load of nonsense. Instead, get yourself a good book on C++ and learn how to solve real-world problems with real-world code."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1546436418, "post_id": 54006912, "comment_id": 94851321, "body": "You probably should have included the diagnostics for the failure and the test case. The site tells you what the problem is <b><i>runtime error: signed integer overflow: 98997 * 8608623459288743937 cannot be represented in type &#39;long long&#39;</i></b> on this line <code>dp[i]=max(dp[i-1],dp[i-2]+i*count1[i]);</code>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1546436729, "post_id": 54006912, "comment_id": 94851472, "body": "Note that when you moved your variables to the local scope inside main() they are no longer initialized to 0 that they were as global variables. So count is full of garbage data."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10857860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f847ca86ad74875cca25a208ddc1006?s=128&d=identicon&r=PG&f=1", "display_name": "akash12121", "link": "https://stackoverflow.com/users/10857860/akash12121"}, "edited": false, "score": 0, "creation_date": 1546441100, "post_id": 54007550, "comment_id": 94853552, "body": "THANK YOU VERY MUCH FOR WRITING SUCH A HELPFUL ANSWER"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 5, "user_id": 10857860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f847ca86ad74875cca25a208ddc1006?s=128&d=identicon&r=PG&f=1", "display_name": "akash12121", "link": "https://stackoverflow.com/users/10857860/akash12121"}, "edited": false, "score": 2, "creation_date": 1546447408, "post_id": 54007550, "comment_id": 94856783, "body": "@akash12121 Please, stop SHOUTING at everybody!"}], "tags": [], "owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "is_accepted": true, "score": 2, "last_activity_date": 1546442647, "last_edit_date": 1546442647, "creation_date": 1546437089, "answer_id": 54007550, "question_id": 54006912, "link": "https://stackoverflow.com/questions/54006912/unexpected-failed-test-case-for-codeforces-455a-boredom/54007550#54007550", "title": "Unexpected failed test case for codeforces 455A boredom", "body": "<p>The difference is that now that you moved <code>long long count1[100005];</code> to be inside <code>int main()</code> it is no longer default initialized to <code>0</code> as it would when it was a global variable. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/2091499/why-are-global-and-static-variables-initialized-to-their-default-values\">Why are global and static variables initialized to their default values?</a> </p>\n\n<p>So when you do this </p>\n\n<pre><code>for(int i=0;i&lt;n;i++){\n    cin &gt;&gt; x;\n    count1[x]++;\n    res=max(res,x);\n}\n</code></pre>\n\n<p>count1[x] has random garbage values that you increment and then use in the calculation here: <code>dp[i]=max(dp[i-1],dp[i-2]+i*count1[i])</code> which caused your runtime error reported by the site:</p>\n\n<blockquote>\n  <p>runtime error: signed integer overflow: 98997 * 8608623459288743937 cannot be represented in type 'long long' on this line dp[i]=max(dp[i-1],dp[i-2]+i*count1[i]);</p>\n</blockquote>\n\n<p>You can see that count1[i] in this case is <code>8608623459288743937</code></p>\n\n<p>To fix this you can replace <code>long long count1[100005];</code> with <code>long long count1[100005]= {};</code></p>\n\n<p><a href=\"https://stackoverflow.com/questions/201101/how-to-initialize-all-members-of-an-array-to-the-same-value\">How to initialize all members of an array to the same value?</a></p>\n\n<p>Note: That <code>dp</code> is also not automatically initialized to 0. However it is not a problem since you don't read uninitialized values of <code>dp</code> like you did with <code>count1</code>. <code>dp[i-1]</code> and <code>dp[i-2]</code> have been initialized when you use them here <code>dp[i]=max(dp[i-1],dp[i-2]+i*count1[i]);</code></p>\n"}], "owner": {"reputation": 5, "user_id": 10857860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f847ca86ad74875cca25a208ddc1006?s=128&d=identicon&r=PG&f=1", "display_name": "akash12121", "link": "https://stackoverflow.com/users/10857860/akash12121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 54007550, "answer_count": 1, "score": -5, "last_activity_date": 1546442647, "creation_date": 1546434367, "last_edit_date": 1546438683, "question_id": 54006912, "link": "https://stackoverflow.com/questions/54006912/unexpected-failed-test-case-for-codeforces-455a-boredom", "title": "Unexpected failed test case for codeforces 455A boredom", "body": "<p>Guys I am new to competitive programming I was solving a problem(<a href=\"https://codeforces.com/problemset/problem/455/A\" rel=\"nofollow noreferrer\">455A BOREDOM</a>) ,I took a solution and tried it to understand it. I believe I understand that that well but I have a small doubt.</p>\n\n<pre><code>   #include&lt;bits/stdc++.h&gt;\n    using namespace std;\n    #define MAX 100005\n    long long dp[100005];\n        long long count1[100005];\n        int main(){\n        int n,x;\n        cin&gt;&gt;n;\n        for(int i=0;i&lt;n;i++){\n            cin &gt;&gt; x;\n            count1[x]++;\n           // res=max(res,x);\n        }\n        dp[0]=0;\n        dp[1]=count1[1];\n        for(int i=2;i&lt;MAX;i++){\n            dp[i]=max(dp[i-1],dp[i-2]+i*count1[i]);\n        }\n        cout&lt;&lt;dp[MAX-1];\n    }\n</code></pre>\n\n<p>However as you can see that the loop is running MAX(100005) even for small test cases. When I tried to optimize that I came up with the following solution:</p>\n\n<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n\nint main(){\n    long long dp[100005];\n    long long count1[100005];\n    int n;\n    cin&gt;&gt;n;\n\n    int x;\n    int res=-100000;\n\n    for(int i=0;i&lt;n;i++){\n        cin &gt;&gt; x;\n        count1[x]++;\n        res=max(res,x);\n    }\n\n    dp[0]=0;\n    dp[1]=count1[1];\n\n    for(int i=2;i&lt;=res;i++){\n        dp[i]=max(dp[i-1],dp[i-2]+i*count1[i]);\n    }\n\n    cout&lt;&lt; dp[res];\n\n\n}\n</code></pre>\n\n<p>However this is giving me the wrong answer on test case 12 <a href=\"https://codeforces.com/contest/455/submission/47841668\" rel=\"nofollow noreferrer\">https://codeforces.com/contest/455/submission/47841668</a></p>\n\n<p>The site reported the following error on test case 12:</p>\n\n<blockquote>\n  <p>runtime error: signed integer overflow: 98997 * 8608623459288743937 cannot be represented in type 'long long' </p>\n</blockquote>\n\n<p>on this line <code>dp[i]=max(dp[i-1],dp[i-2]+i*count1[i]);</code></p>\n\n<p>Can anyone tell me where i did the mistake ?\nWhy that competitive programmer that kind of mistake is that normal?</p>\n"}, {"tags": ["c++", "struct", "unions"], "comments": [{"owner": {"reputation": 97941, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 4, "creation_date": 1546434066, "post_id": 54006806, "comment_id": 94850206, "body": "Field <code>uint8_t a  : 1;</code> is too short for values <code>2</code> or greater."}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "reply_to_user": {"reputation": 97941, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1546434393, "post_id": 54006806, "comment_id": 94850358, "body": "yes but i&#39;m writing in the Bla.Data, ain&#39;t I? I don&#39;t want to write in Bla.a but in Bla.Data. What is the right writing?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1546434515, "post_id": 54006806, "comment_id": 94850405, "body": "No you&#39;re not. You would be if <code>Data</code> was the first member of each union. It is not."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1546435388, "post_id": 54006806, "comment_id": 94850805, "body": "Note that the compiler is allowed to change the order of the members of a bit-field.  Also note that C++ does not allow type-punning with unions, if you write to a member of a union you <i>must</i> read only from that same member."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1546435481, "post_id": 54006806, "comment_id": 94850855, "body": "@Someprogrammerdude ie. No writing to <code>Data</code> and reading from the members of the struct. Look into something like this: <a href=\"https://blog.codef00.com/2014/12/06/portable-bitfields-using-c11\" rel=\"nofollow noreferrer\">blog.codef00.com/2014/12/06/portable-bitfields-using-c11</a>"}, {"owner": {"reputation": 2285, "user_id": 1916711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ebc3c1d0b082618f5db9b06b44c6a2?s=128&d=identicon&r=PG", "display_name": "arayq2", "link": "https://stackoverflow.com/users/1916711/arayq2"}, "edited": false, "score": 0, "creation_date": 1546520384, "post_id": 54006806, "comment_id": 94881624, "body": "What is message 4397?  It used to be that messages in the 300-399 range (mod 1000) were &quot;fatal errors&quot;, which would be bizarre here."}], "answers": [{"comments": [{"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1546512754, "post_id": 54007283, "comment_id": 94877656, "body": "With this solution, it works with IAR and GCC, but i have a PC lint warning (High level): &quot;pc lint constexpr variable &#39;B&#39; must be initialized by a constant expression&quot;"}, {"owner": {"reputation": 2285, "user_id": 1916711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ebc3c1d0b082618f5db9b06b44c6a2?s=128&d=identicon&r=PG", "display_name": "arayq2", "link": "https://stackoverflow.com/users/1916711/arayq2"}, "reply_to_user": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1546519587, "post_id": 54007283, "comment_id": 94881140, "body": "Sorry, don&#39;t know much about PC lint.  It may be complaining that <i>all</i> fields in the bitfield struct haven&#39;t been explicitly initialized, i.e. that the padding fields need initializing zeros too.  B = {{0,1,0,0},{0,0,0},{0,0,0,0,0}}. That&#39;s just a guess, btw."}], "tags": [], "owner": {"reputation": 2285, "user_id": 1916711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ebc3c1d0b082618f5db9b06b44c6a2?s=128&d=identicon&r=PG", "display_name": "arayq2", "link": "https://stackoverflow.com/users/1916711/arayq2"}, "is_accepted": false, "score": 3, "last_activity_date": 1546520494, "last_edit_date": 1546520494, "creation_date": 1546435874, "answer_id": 54007283, "question_id": 54006806, "link": "https://stackoverflow.com/questions/54006806/c-mystic-structure-assignment-with-int-truncated/54007283#54007283", "title": "C++ Mystic structure assignment with int truncated", "body": "<p>The initializations are being applied to the bitfield struct because it is declared first in the union.  (Put the uint8_t Data member first and see the warning go away).  As a result 0x02 and 0x04 are too large for the first member (uint8_t a).</p>\n\n<p>You could fix this by explicitly specifying the bitfield initializations, e.g.</p>\n\n<pre><code>static constexpr TypeStruct B   =   {{0,1},0,0};     \nstatic constexpr TypeStruct C   =   {{0,0,1},0,0};    \n</code></pre>\n\n<p>Note that, in general, there is no guarantee that bitfields will correspond to bit positions in bytes (or other integer types) - it's up to the compiler. So direct initializations of bitfield structs with byte values like 0x02 and 0x04 were a poor idea to begin with. </p>\n"}, {"tags": [], "owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "is_accepted": true, "score": 0, "last_activity_date": 1554834198, "creation_date": 1554834198, "answer_id": 55599012, "question_id": 54006806, "link": "https://stackoverflow.com/questions/54006806/c-mystic-structure-assignment-with-int-truncated/55599012#55599012", "title": "C++ Mystic structure assignment with int truncated", "body": "<p>A solution to get the code compiling with IAR and GCC and to avoid PC-lint error #4397:</p>\n\n<p><code>static const</code> should be used instead of <code>static constexpr</code></p>\n\n<pre><code>static const TypeStruct A   =   {{1,0,0},{0,0},{0,0,0,0}};     \nstatic const TypeStruct B   =   {{0,1,0},{0,0},{0,0,0,0}};      \nstatic const TypeStruct C   =   {{0,0,1},{0,0},{0,0,0,0}};      \nstatic const TypeStruct D   =   {{0,0,1},{1,0},{0,0,0,0}}; \netc...\n</code></pre>\n"}], "owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 55599012, "answer_count": 2, "score": 0, "last_activity_date": 1554834198, "creation_date": 1546433818, "last_edit_date": 1546513271, "question_id": 54006806, "link": "https://stackoverflow.com/questions/54006806/c-mystic-structure-assignment-with-int-truncated", "title": "C++ Mystic structure assignment with int truncated", "body": "<p>I have the following code (c++11) :</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\n//Icons\ntypedef struct\n{\n    union\n    {\n        struct\n        {\n            uint8_t a  : 1;\n            uint8_t b  : 1;\n            uint8_t c  : 1;\n            uint8_t : 5;\n        };\n        uint8_t Data;\n    } Bla;\n\n    union\n    {\n        struct\n        {\n            uint8_t d  : 1;\n            uint8_t e  : 1;\n            uint8_t : 6;\n        };\n        uint8_t Data;\n    } Foo;\n\n    union\n    {\n        struct\n        {\n            uint8_t f   : 1;\n            uint8_t g   : 1;\n            uint8_t h   : 1;\n            uint8_t i   : 1;\n            uint8_t : 4;\n        };\n        uint8_t Data;\n    } Bar;\n}TypeStruct;\n\nint main()\n{\n\n    static constexpr TypeStruct NONE    = {0x00,0,0}; \n    static constexpr TypeStruct A =       {0x01,0,0};    \n    static constexpr TypeStruct B   =     {0x02,0,0};     \n    static constexpr TypeStruct C     =   {0x04,0,0};    \n\n   return 0;\n}\n</code></pre>\n\n<p>Compiling and working fine with IAR, but with GCC in pedantic, I get the following error which troubles me for a few days now...</p>\n\n<pre><code>$g++ -std=c++11 -o main *.cpp\nmain.cpp: In function \u2018int main()\u2019:\nmain.cpp:50:52: warning: large integer implicitly truncated to unsigned type [-Woverflow]\n     static constexpr TypeStruct B   =     {0x02,0,0};\n                                                    ^\nmain.cpp:51:52: warning: large integer implicitly truncated to unsigned type [-Woverflow]\n     static constexpr TypeStruct C     =   {0x04,0,0};\n                                                    ^\n</code></pre>\n\n<p>I don't understand why!\nMaybe something to do with union but I tried different writings with no match:\n {1,0,0} or {{1},{0},{0}}, or {{1,0,0}}\nThe problem is that i need to use something like \"A\" in a specialisation, and this can't be changed, let's say:</p>\n\n<pre><code>MyClass:MyMotherClass(TypeStruct A);\n</code></pre>\n\n<p>Thanks</p>\n\n<hr>\n\n<p>EDIT:\nSolution chosen was using:</p>\n\n<pre><code>static constexpr TypeStruct A   =   {{1,0,0},{0,0},{0,0,0,0}};     \nstatic constexpr TypeStruct B   =   {{0,1,0},{0,0},{0,0,0,0}};      \nstatic constexpr TypeStruct C   =   {{0,0,1},{0,0},{0,0,0,0}};  \netc...\n</code></pre>\n\n<p>However with this solution which compiles like a charm with IAR and GCC, I get the following PC lint message, Priority: High, Category: 4397.</p>\n\n<pre><code> \"pc lint constexpr variable 'A' must be initialized by a constant expression\"\n \"pc lint constexpr variable 'B' must be initialized by a constant expression\"\n \"pc lint constexpr variable 'C' must be initialized by a constant expression\"\n</code></pre>\n"}, {"tags": ["c++", "multithreading"], "comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1546446238, "post_id": 54006799, "comment_id": 94856203, "body": "Why do you feel the need to use dynamic polymorphism (virtual functions)?"}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 7, "last_activity_date": 1546435016, "last_edit_date": 1546435016, "creation_date": 1546434113, "answer_id": 54006867, "question_id": 54006799, "link": "https://stackoverflow.com/questions/54006799/why-daughter-class-objects-call-member-function-of-mother-class/54006867#54006867", "title": "Why daughter class objects call member function of mother class?", "body": "<p>Your code has undefined behaviour, because you join in the wrong place.</p>\n\n<p>Although your class correctly joins the thread on destruction, ensuring that the <code>process</code> is still alive for the duration of the thread, <a href=\"https://isocpp.org/wiki/faq/dtors#order-dtors-for-members\" rel=\"nofollow noreferrer\"><em>the derived sub-object is already dead by then</em></a>.</p>\n\n<p>As a result, you may see <code>product::execute</code> be invoked, or <code>process::execute</code> be invoked, or cats pour out of your monitor and start typing their own program.</p>\n\n<p>You need to join before <em>any</em> of the object is destroyed, either from within <code>main</code> or by adding this code also to the <code>product</code> destructor.</p>\n\n<p>When making this change I get the expected results.</p>\n\n<hr>\n\n<p><strong>tl;dr: the virtual call works fine, but your join is in the wrong place.</strong></p>\n\n<hr>\n\n<p>Furthermore, you include <code>&lt;iostream&gt;</code> but never use it, you store (and move!) a pointer to a <code>std::thread</code> rather than simply having a <code>std::thread</code>, and your \"parameterized constructor\" takes no parameters (and has a useless <code>th!=NULL</code>, and does nothing).</p>\n\n<p>Here's a quick fix for all of the above:</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;iostream&gt;\n\nclass process \n{\nprivate:\n    std::thread th;\n\npublic:\n    virtual void work();\n    virtual void execute();\n    void endExecution();\n\n    ~process();\n}; \n\nprocess::~process()\n{\n    // Just in case, but you don't want to rely on this!\n    // See main() -- or do this also in ~product().\n    endExecution();\n}\n\nvoid process::work() \n{ \n    std::cerr &lt;&lt; \"work of base class\\n\";\n} \n\nvoid process::execute() \n{\n    std::cerr &lt;&lt; \"execute of base class\\n\";\n    th = std::thread(&amp;process::work, this);\n} \n\nvoid process::endExecution()\n{\n    if (th.joinable())\n        th.join();\n}\n\nclass product : public process \n{ \npublic: \n    virtual void work() override;\n};\n\n\nvoid product::work() {\n    std::cerr &lt;&lt; \"work of product class\\n\";\n}\n\nint main()\n{\n    product p;\n    p.execute();\n    p.endExecution();\n}\n</code></pre>\n\n<h3>(<a href=\"http://coliru.stacked-crooked.com/a/2c28340fe035c4f8\" rel=\"nofollow noreferrer\">live demo</a>)</h3>\n\n<p>Better class designs should allow you to do this in a less error-prone way.</p>\n"}], "owner": {"reputation": 9, "user_id": 10857734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ef696e4955671bcc2c3e237581086b?s=128&d=identicon&r=PG&f=1", "display_name": "Mabrouk", "link": "https://stackoverflow.com/users/10857734/mabrouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546435016, "creation_date": 1546433776, "question_id": 54006799, "link": "https://stackoverflow.com/questions/54006799/why-daughter-class-objects-call-member-function-of-mother-class", "title": "Why daughter class objects call member function of mother class?", "body": "<p>I want to create a base class \"process\" with a method \"execute()\" that runs a task \"work()\" in thread. when i create a derived class \"product\" for example, and an object \"p\" with it, p.execute() runs \"work()\" of base class even if it is virtual. can any one tell me why?</p>\n\n<p>here is my code:\n1-for base class:</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;iostream&gt;\n\n\nclass process \n{ \n\nprivate:\n\n        std::thread  *th;                \npublic: \n    virtual void work();\n    virtual void execute();\n\n    //Delete the copy constructor\n    process(const process&amp;) = delete;\n\n    //Delete the Assignment opeartor\n    process&amp; operator=(const process&amp;) = delete;\n\n    // Parameterized Constructor\n    process();\n\n    // Move Constructor\n    process(process &amp;&amp; obj);\n\n    //Move Assignment Operator\n    process &amp; operator=(process &amp;&amp; obj);\n\n    //Destructor\n    ~process();\n\n}; \n\n// Parameterized Constructor\nprocess::process()\n{\n    th!=NULL;\n}\n\n// Move Constructor\nprocess::process(process &amp;&amp; obj) : th(std::move(obj.th))\n{\n    std::cout &lt;&lt; \"Move Constructor is called\" &lt;&lt; std::endl;\n}\n\n//Move Assignment Operator\nprocess &amp; process::operator=(process &amp;&amp; obj)\n{\n    std::cout &lt;&lt; \"Move Assignment is called\" &lt;&lt; std::endl;\n    if (th-&gt;joinable())\n        th-&gt;join();\n    th = std::move(obj.th);\n    return *this;\n}\n\n\n// Destructor\nprocess::~process()\n{\n    if(th!=NULL){\n        if (th-&gt;joinable())\n          th-&gt;join();\n    }\n}\n\n\n\nvoid process::work() \n{ \n    printf(\"work of base class \\n\");\n} \n\n\nvoid process::execute() \n{ \n    printf(\"execute of base class \\n\");\n    th=new  std::thread(&amp;process::work, this);\n} \n</code></pre>\n\n<p>2-for derived class:</p>\n\n<pre><code>class product : public process \n{ \npublic: \n    void work();\n};\n\n\nvoid product::work() {\n    printf(\"work of product class\\n\");\n}\n</code></pre>\n\n<p>3-main function:</p>\n\n<pre><code>int main()\n{\n    product p;\n    p.execute();\n\n    return 0;\n}\n</code></pre>\n\n<p>i expected to get :</p>\n\n<pre><code>execute of base class \nwork of product class \n</code></pre>\n\n<p>but i actually get:</p>\n\n<pre><code>execute of base class \nwork of base class \n</code></pre>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1546434663, "post_id": 54006640, "comment_id": 94850466, "body": "If you use Makefiles generator, you can do <code>make VERBOSE=1</code> to see exact command line used to compile <code>as_math_engine_tests</code>. This might help find the cause."}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1546435344, "post_id": 54006640, "comment_id": 94850781, "body": "<code>include_directories</code> is meant to specify the include paths for the preprocessor/compiler, not to tell CMake where to find the files. You should have <code>add_library(as_math_engine include&#47;as_math_engine&#47;evaluable.h)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1546529949, "post_id": 54010530, "comment_id": 94887126, "body": "Do you have some reference to support that first paragraph? AFAICT, I&#39;ve got a few dozen projects that set up some common <code>include_directories</code> at the top level, and it&#39;s visible in all the <code>CMakeLists.txt</code> processed via <code>add_subdirectory</code>... and it&#39;s been working correctly for quite a few years. (Perhaps it doesn&#39;t propagate in the opposite direction?)"}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1546532190, "post_id": 54010530, "comment_id": 94888303, "body": "@DanMa\u0161ek I wrote that because it didn&#39;t initially work for me but I&#39;ve changed the answer.  The manual for <code>include_directories()</code> states: &quot;They are also added to the INCLUDE_DIRECTORIES target property for each target in the current CMakeLists file.&quot;  I put the <code>include_directories()</code> at the bottom of the file after the  <code>add_subdirectory()</code>.  None of the targets in the sub-directory had the include paths, but the targets in the main <code>CMakeLists.txt</code> did pick up the includes.  But putting <code>include_directories()</code> before <code>add_subdirectory()</code> propagates the includes into the sub-directory."}], "tags": [], "owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "is_accepted": false, "score": 1, "last_activity_date": 1546531291, "last_edit_date": 1546531291, "creation_date": 1546449454, "answer_id": 54010530, "question_id": 54006640, "link": "https://stackoverflow.com/questions/54006640/how-to-use-include-directories-correctly-in-cmake/54010530#54010530", "title": "How to use include_directories correctly in cmake?", "body": "<p><code>include_directories()</code> is best used to set include paths for multiple targets within a project, <code>target_include_directories()</code> is usually preferred.</p>\n\n<p>There are probably better ways of setting up <code>as_math_engine</code> if it is going to be a header-only library.</p>\n\n<p>You also need to use <code>add_library(as_math_engine include/as_math_engine/evaluable.h)</code> because the <code>add_library()</code> doesn't search for files.</p>\n\n<p><a href=\"http://mariobadr.com/creating-a-header-only-library-with-cmake.html\" rel=\"nofollow noreferrer\">Header Only Library</a> shows how to set this up and use it to avoid these kinds of problems.</p>\n\n<p>Alternatively delete both <code>include_directories()</code> and use <code>target_include_directories(as_math_engine_tests PRIVATE \"${CMAKE_SOURCE_DIR}/include/as_math_engine\" libs)</code> so that the <code>as_math_engine_tests</code> uses the proper include path.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7948550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546531291, "creation_date": 1546433136, "question_id": 54006640, "link": "https://stackoverflow.com/questions/54006640/how-to-use-include-directories-correctly-in-cmake", "title": "How to use include_directories correctly in cmake?", "body": "<p>I have two cmake files:</p>\n\n<p>CMakeLists.txt:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.13)\nproject(as_math_engine)\n\nset(CMAKE_CXX_STANDARD 14)\n\ninclude_directories(include/as_math_engine)\nadd_library(as_math_engine evaluable.h)\nadd_subdirectory(tests)\n</code></pre>\n\n<p>tests/CMakeLists.txt:</p>\n\n<pre><code>include_directories(libs)\nadd_executable(as_math_engine_tests src/main.cpp)\n</code></pre>\n\n<p>And I have this <code>include/as_math_engine/evaluable.h</code> file but, CMake tells me: </p>\n\n<blockquote>\n  <p>Cannot find source file: evaluable.h</p>\n</blockquote>\n\n<p>Why is it? And how can I solve this problem?</p>\n"}, {"tags": ["c++", "qt", "opengl"], "answers": [{"tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": false, "score": 1, "last_activity_date": 1546439826, "last_edit_date": 1546439826, "creation_date": 1546439254, "answer_id": 54008093, "question_id": 54006634, "link": "https://stackoverflow.com/questions/54006634/in-opengl-how-to-use-the-mouse-to-click-to-get-the-pixel-information-of-the-gra/54008093#54008093", "title": "In opengl, how to use the mouse to click to get the pixel information of the graphic drawn in the frame buffer", "body": "<p>The issue is caused, because in the color buffer attached to <code>GLCOLOR ATTACHMENT1</code>, never is rendered to.</p>\n\n<p>The name of the enumerator constant for the 1st color buffer, which can be attached by <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glFramebufferTexture.xhtml\" rel=\"nofollow noreferrer\"><code>glFramebufferTexture2D</code></a> to a framebuffer is <code>GL_COLOR_ATTACHMENT0</code>, rather than not <code>GL_COLOR_ATTACHMENT1</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void OpenglWidget::initializeGL()\n{\n    // [...]\n\n    core1-&gt;glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER,\n        GL_COLOR_ATTACHMENT0, // &lt;---- GL_COLOR_ATTACHMENT0 instead of GL_COLOR_ATTACHMENT1\n        GL_TEXTURE_2D,\n        m_pickingTexture, 0);\n\n    // [...]\n}\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void OpenglWidget::mousePressEvent(QMouseEvent *e)\n{\n    // [...]        \n\n    core1-&gt;glBindFramebuffer(GL_READ_FRAMEBUFFER, fbo);\n    core1-&gt;glReadBuffer(GL_COLOR_ATTACHMENT0); // &lt;---- GL_COLOR_ATTACHMENT0\n\n    // [ ...]\n}\n</code></pre>\n\n<p>Note, by default it is rendered to the first color buffer (<code>GL_COLOR_ATTACHMENT0</code>) of a framebuffer. If you want to render to an other color buffer, than the 1st one, then you would have to specify a color buffer (list) explicitly by <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glDrawBuffers.xhtml\" rel=\"nofollow noreferrer\"><code>glDrawBuffers</code></a>.  </p>\n\n<hr>\n\n<p>See <a href=\"https://www.khronos.org/registry/OpenGL/specs/gl/glspec46.core.pdf\" rel=\"nofollow noreferrer\">OpenGL 4.6 API Core Profile Specification; 17.4.1 Selecting Buffers for Writing; page 513</a>:</p>\n\n<blockquote>\n  <p><strong>17.4.1 Selecting Buffers for Writing</strong></p>\n  \n  <p>[...]  The set of buffers of a framebuffer object to which all fragment colors are written is controlled with the commands</p>\n\n<pre><code>void DrawBuffers( sizei n, const enum *bufs );\nvoid NamedFramebufferDrawBuffers( uint framebuffer, sizei n, const enum *bufs );\n</code></pre>\n  \n  <p>[...] <strong>For framebuffer objects, in the initial state the draw buffer for\n  fragment color zero is <code>COLOR_ATTACHMENT0</code>.</strong> For both the default framebuffer\n  and framebuffer objects, the initial state of draw buffers for fragment colors other then zero is <code>NONE</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 10832082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5372e0cf6808cc448e585955f0583f0?s=128&d=identicon&r=PG&f=1", "display_name": "Maple617", "link": "https://stackoverflow.com/users/10832082/maple617"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1546439826, "creation_date": 1546433096, "last_edit_date": 1546433560, "question_id": 54006634, "link": "https://stackoverflow.com/questions/54006634/in-opengl-how-to-use-the-mouse-to-click-to-get-the-pixel-information-of-the-gra", "title": "In opengl, how to use the mouse to click to get the pixel information of the graphic drawn in the frame buffer", "body": "<p>I recently needed to implement a function in the QT+OPENGL environment, that is, I drew a cube (presumably in the center of the view) in my own defined framebuffer (I defined it as fbo) and colored it in red. And nothing is drawn in the default buffer, so I can't see my cube in the view (but it is drawn in the framebuffer fbo)</p>\n\n<p>I hope that when I click in the middle of the view (the position of the cube), I can display the color of the cube----red instead of the color of the background of the view.</p>\n\n<p>Here are the problems I have encountered:\nI can only get the color of the background of the view with the mouse, and the cube drawn in the frame buffer is not picked up (the cube is red).</p>\n\n<p>In the <code>initializeGL()</code> function, I initialized and configured the framebuffer fbo and some of the configuration required to draw the cube.</p>\n\n<p>In the <code>paintGL()</code> function, I bind my defined framebuffer to <code>GL_FRAMEBUFFER</code> and then do the drawing.</p>\n\n<p>In the <code>mousePressEvent(QMouseEvent *e)</code> function, I did the picking work. This is the response function of the QT mouse click. I put the information read by <code>glReadPixels</code> into the array pix and print it out.</p>\n\n<pre><code>void OpenglWidget::initializeGL()\n{   \n        core1 = QOpenGLContext::currentContext()-&gt;versionFunctions&lt;QOpenGLFunctions_4_0_Core&gt;();    \n        core = QOpenGLContext::currentContext()-&gt;versionFunctions&lt;QOpenGLFunctions_3_3_Core&gt;();\n        core-&gt;glGenFramebuffers(1, &amp;fbo);\n        core-&gt;glBindFramebuffer(GL_FRAMEBUFFER, fbo);\n        // Create the texture object for the primitive information buffer\n        core-&gt;glGenTextures(1, &amp;m_pickingTexture);\n        glBindTexture(GL_TEXTURE_2D, m_pickingTexture);\n        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB32UI, SCR_WIDTH, SCR_HEIGHT,\n                    0, GL_RGB_INTEGER, GL_UNSIGNED_INT, NULL);\n        core1-&gt;glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT1, GL_TEXTURE_2D,\n                    m_pickingTexture, 0);\n        // Create the texture object for the depth buffer\n        core-&gt;glGenTextures(1, &amp;m_depthTexture);\n        core-&gt;glBindTexture(GL_TEXTURE_2D, m_depthTexture);\n        core-&gt;glTexImage2D(GL_TEXTURE_2D, 0, GL_DEPTH_COMPONENT, SCR_WIDTH, SCR_HEIGHT,\n                    0, GL_DEPTH_COMPONENT, GL_FLOAT, NULL);\n        core1-&gt;glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_TEXTURE_2D,\n                    m_depthTexture, 0);\n        // Disable reading to avoid problems with older GPUs\n        core-&gt;glReadBuffer(GL_NONE);\n        // Verify that the FBO is correct\n        GLenum Status = core-&gt;glCheckFramebufferStatus(GL_FRAMEBUFFER);\n        if (Status == GL_FRAMEBUFFER_COMPLETE) {\n            qDebug() &lt;&lt; \"ok\";\n        }\n        // Restore the default framebuffer\n        core-&gt;glBindTexture(GL_TEXTURE_2D, 0);\n        core-&gt;glBindFramebuffer(GL_FRAMEBUFFER, 0);\n\n        GLfloat verticPosition[] = {\n        -0.5f, -0.5f, -0.5f,\n         0.5f, -0.5f, -0.5f,\n         0.5f,  0.5f, -0.5f,\n         0.5f,  0.5f, -0.5f,\n        -0.5f,  0.5f, -0.5f,\n        -0.5f, -0.5f, -0.5f,\n\n        -0.5f, -0.5f,  0.5f,\n         0.5f, -0.5f,  0.5f,\n         0.5f,  0.5f,  0.5f,\n         0.5f,  0.5f,  0.5f,\n        -0.5f,  0.5f,  0.5f,\n        -0.5f, -0.5f,  0.5f,\n\n        -0.5f,  0.5f,  0.5f,\n        -0.5f,  0.5f, -0.5f,\n        -0.5f, -0.5f, -0.5f,\n        -0.5f, -0.5f, -0.5f,\n        -0.5f, -0.5f,  0.5f,\n        -0.5f,  0.5f,  0.5f,\n\n         0.5f,  0.5f,  0.5f,\n         0.5f,  0.5f, -0.5f,\n         0.5f, -0.5f, -0.5f,\n         0.5f, -0.5f, -0.5f,\n         0.5f, -0.5f,  0.5f,\n         0.5f,  0.5f,  0.5f,\n\n        -0.5f, -0.5f, -0.5f,\n         0.5f, -0.5f, -0.5f,\n         0.5f, -0.5f,  0.5f,\n         0.5f, -0.5f,  0.5f,\n        -0.5f, -0.5f,  0.5f,\n        -0.5f, -0.5f, -0.5f,\n\n        -0.5f,  0.5f, -0.5f,\n         0.5f,  0.5f, -0.5f,\n         0.5f,  0.5f,  0.5f,\n         0.5f,  0.5f,  0.5f,\n        -0.5f,  0.5f,  0.5f,\n        -0.5f,  0.5f, -0.5f,\n    };\n    GLint beamIndices[] = {\n        0,1,2,3,4,5,6,7\n    };\n\n    core-&gt;glGenVertexArrays(1, &amp;VAOBeam);\n    core-&gt;glGenBuffers(1, &amp;VBOBeam);\n    core-&gt;glGenBuffers(1, &amp;EBOBeam);\n    core-&gt;glBindVertexArray(VAOBeam);\n    core-&gt;glBindBuffer(GL_ARRAY_BUFFER, VBOBeam);\n    core-&gt;glBufferData(GL_ARRAY_BUFFER,sizeof(float) * 3 * 36, verticPosition, GL_STATIC_DRAW);\n    core-&gt;glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBOBeam);\n    core-&gt;glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLint) * 8, beamIndices, GL_STATIC_DRAW);\n\n    core-&gt;glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), (void*)0);\n    core-&gt;glEnableVertexAttribArray(0);\n    core-&gt;glBindBuffer(GL_ARRAY_BUFFER, 0);\n    core-&gt;glBindVertexArray(0);\n}\n\nvoid OpenglWidget::paintGL()\n{\n    core-&gt;glBindFramebuffer(GL_FRAMEBUFFER, fbo);\n    glClearColor(0,0,1,1);\n    glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);\n    float frametime =GetFrameTime();\n    mCamera.Update(frametime);\n    Shader GLprogram =  Shader(\"E:\\\\QT\\\\OpenglTest\\\\vs.vert\",\"E:\\\\QT\\\\OpenglTest\\\\fs.frag\");\n    GLprogram.use();\n    core-&gt;glBindVertexArray(VAOBeam); \n    glm::mat4 model = glm::mat4(1.0f);\n    model = glm::translate(model, mCamera.TempTranslateVrc);\n    glm::mat4 view = glm::mat4(1.0f);\n    //view = glm::lookAt(glm::vec3(0.0f, 0.0f, 1.0f), glm::vec3(0.5f,0.5f,0.0f), glm::vec3(0.0f, 1.0f, 0.0f));\n    view = glm::lookAt(mCamera.mPos,mCamera.mViewCenter,mCamera.mUp);\n    glm::mat4 projection = glm::mat4(1.0f);\n    projection = glm::perspective(glm::radians(45.0f), (float)1.0, 0.1f, 100.0f);\n    GLprogram.setMatrix4f(\"model\",model);\n    GLprogram.setMatrix4f(\"view\",view);\n    GLprogram.setMatrix4f(\"projection\",projection);\n    core-&gt;glDrawArrays(GL_TRIANGLES,0,36);\n    core-&gt;glUseProgram(0);\n    update();\n}\nvoid OpenglWidget::mousePressEvent(QMouseEvent *e)\n{\n    core1 = QOpenGLContext::currentContext()-&gt;versionFunctions&lt;QOpenGLFunctions_4_0_Core&gt;();\n    float pix[4] = {0.0};\n    mCamera.getInitPos(e-&gt;x(),e-&gt;y());//This is the camera's setup function, no need to worry about it.\n    core1-&gt;glBindFramebuffer(GL_READ_FRAMEBUFFER, fbo);\n    core1-&gt;glReadBuffer(GL_COLOR_ATTACHMENT1);\n    core1-&gt;glReadPixels(e-&gt;x() , 500 - e-&gt;y() + 65, 1, 1, GL_RGBA, GL_FLOAT, pix);\n    qDebug() &lt;&lt; e-&gt;x()&lt;&lt; 500 - e-&gt;y() &lt;&lt;pix[0] &lt;&lt; pix[1] &lt;&lt; pix[2] &lt;&lt; pix[3];\n}\n</code></pre>\n\n<p>I can only get the color of the background of the view with the mouse, and the cube drawn in the frame buffer is not picked up (the cube is red).</p>\n\n<p><a href=\"https://i.stack.imgur.com/tX1qu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tX1qu.jpg\" alt=\"\"></a></p>\n"}, {"tags": ["c++", "this", "constants"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1546432847, "post_id": 54006532, "comment_id": 94849594, "body": "Welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1546433225, "post_id": 54006532, "comment_id": 94849775, "body": "To be a bit more specific than @Someprogrammerdude: Add the full error message to your code and indicates on which line it occurs. Provide the necessary members of <code>List</code> so that your code can be compiled (e.g., what are <code>s</code>  and <code>p</code>? <code>outOfScope</code>? And remove everything that&#39;s unecessary to avoid having a too large code block."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546433310, "post_id": 54006532, "comment_id": 94849810, "body": "If the error really appears in the method you provide, I would say that <code>outOfScope</code> is a member-function of <code>List</code> but is not <code>const</code>-qualified, thus you cannot call it from a <code>const</code>-qualified member function. But we would need the declaration / definition of <code>outOfScope</code> to help you precisely..."}, {"owner": {"reputation": 3, "user_id": 8845727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757d400bb850e5279735e51f8a7b32f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ujjwal", "link": "https://stackoverflow.com/users/8845727/ujjwal"}, "edited": false, "score": 0, "creation_date": 1546433483, "post_id": 54006532, "comment_id": 94849907, "body": "Dear Holt, outOfScope is not a member of class List. It is declared in different header file and is being used here. The definition is as follows:"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1546433558, "post_id": 54006532, "comment_id": 94849958, "body": "If you use a more sensible name than <code>s</code> for the size, or just call <code>size</code> after making it const, you don&#39;t need to sprinkle around comments explaining what it is."}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1546433578, "post_id": 54006532, "comment_id": 94849969, "body": "<code>for(int i=0; i&lt;s; i++)</code> what is <code>s</code> ? in this for ?"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 1, "creation_date": 1546433611, "post_id": 54006532, "comment_id": 94849987, "body": "@Ujjwal If <code>outOfScope</code> is not a member function, then I don&#39;t see how your code could create such error. Again, provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable example</a>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1546434142, "post_id": 54006532, "comment_id": 94850248, "body": "Added the missing members and a trivial use, and <a href=\"http://coliru.stacked-crooked.com/a/5a043ff7a5fe6bf4\" rel=\"nofollow noreferrer\">there&#39;s no problem</a>. As has been noted already, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546435359, "post_id": 54006532, "comment_id": 94850787, "body": "Now it&#39;s a massive submission most of which is assuredly not necessary to reproduce the problem. This tells us that you have not performed the steps described in the article <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that you were linked to, which are important/key aspects of debugging, and we do expect you to do that first."}, {"owner": {"reputation": 3, "user_id": 8845727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757d400bb850e5279735e51f8a7b32f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ujjwal", "link": "https://stackoverflow.com/users/8845727/ujjwal"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546435498, "post_id": 54006532, "comment_id": 94850866, "body": "@Holt I have added the complete code. Please have a look"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546435767, "post_id": 54006532, "comment_id": 94850995, "body": "@Ujjwal That&#39;s better but your code compiles fine, so the error is likely on the calling side. Try to create and example that <b>reproduces</b> your error (e.g., adding a list declaration and a call to <code>findAll()</code> that does not compile). Also, most of your code is irrelevant to the question, try making it <b>minimal</b> (remove the comparison operator, the irrelevant constructors/assignments operator, the methods that are not used). You can also add only the declaration of the methods you use but works fine (e.g., <code>insertAtEnd</code>)."}, {"owner": {"reputation": 3, "user_id": 8845727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757d400bb850e5279735e51f8a7b32f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ujjwal", "link": "https://stackoverflow.com/users/8845727/ujjwal"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546436627, "post_id": 54006532, "comment_id": 94851421, "body": "@Holt corrected as per your recommendations. I have posted the implementation code too. Please have a look!"}, {"owner": {"reputation": 3, "user_id": 8845727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757d400bb850e5279735e51f8a7b32f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ujjwal", "link": "https://stackoverflow.com/users/8845727/ujjwal"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1546436867, "post_id": 54006532, "comment_id": 94851544, "body": "@molbdnilo thanks for valuable suggestions. I will take care of it next time!"}, {"owner": {"reputation": 3, "user_id": 8845727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757d400bb850e5279735e51f8a7b32f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ujjwal", "link": "https://stackoverflow.com/users/8845727/ujjwal"}, "reply_to_user": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 0, "creation_date": 1546436943, "post_id": 54006532, "comment_id": 94851585, "body": "@rafix07 s is the size of the list. The whole code is now uploaded. Kindly have a look! Thanks"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1546436959, "post_id": 54006532, "comment_id": 94851591, "body": "Start with making <code>const</code> the inherently non-modifying functions (<code>size</code>, <code>find</code>, <code>lookup</code>). Remove the constructor and assignment that take a non-const parameter."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546437672, "post_id": 54006532, "comment_id": 94851924, "body": "@Ujjwal I&#39;ve created a more standard version of your code with some extra comments, feel free to take a look at it: <a href=\"https://gist.github.com/Holt59/0a9bc4bf327598daf3b841ee7a17bbad\" rel=\"nofollow noreferrer\">gist.github.com/Holt59/0a9bc4bf327598daf3b841ee7a17bbad</a>"}, {"owner": {"reputation": 3, "user_id": 8845727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757d400bb850e5279735e51f8a7b32f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ujjwal", "link": "https://stackoverflow.com/users/8845727/ujjwal"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546439816, "post_id": 54006532, "comment_id": 94852961, "body": "@Holt Thanks Holt! I learnt a lot the way you have done it!"}], "answers": [{"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1546439616, "post_id": 54007757, "comment_id": 94852869, "body": "I&#39;d move the last (most important) bullet point to the top"}], "tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": true, "score": 2, "last_activity_date": 1546440566, "last_edit_date": 1546440566, "creation_date": 1546437971, "answer_id": 54007757, "question_id": 54006532, "link": "https://stackoverflow.com/questions/54006532/error-passing-const-listint-as-this-argument-discards-qualifiers-within-meth/54007757#54007757", "title": "Error &quot;passing const List&lt;int&gt; as this argument discards qualifiers&quot; within method definition", "body": "<p>In this line:</p>\n\n<pre><code>List&lt;int&gt; findList = rollNo.findAll(rollNo[2]);\n</code></pre>\n\n<p>...you are calling the copy constructor of <code>List&lt;int&gt;</code> that takes a <code>const</code>-reference:</p>\n\n<pre><code>List(const List&lt;T&gt;&amp; l)\n</code></pre>\n\n<p>In this constructor, you try to access the size of <code>l</code>:</p>\n\n<pre><code>s = l.size();\n</code></pre>\n\n<p>...but you cannot because <code>l</code> is <code>const</code>-qualified and <code>size()</code> is not, and you can only call <code>const</code>-qualified method on <code>const</code>-qualified variables.</p>\n\n<p>To fix this, you need to <code>const</code>-qualify <code>size()</code>:</p>\n\n<pre><code>int size() const { return s; }\n</code></pre>\n\n<hr>\n\n<p>Here are some advice for your code, try to lookup a good recent C++ book for more:</p>\n\n<ul>\n<li>unless it is an exercice, <strong>do not make your own <code>List</code>, use <code>std::vector</code></strong>;</li>\n<li>use <code>nullptr</code> instead of <code>NULL</code>;</li>\n<li>do not provide constructor or assignment operators that take non-constant lvalue-reference (<code>List(List&lt;T&gt;&amp;)</code> and <code>operator=(List&lt;T&gt;&amp;)</code>;</li>\n<li>provide move-constructor and move-assignment operator (<code>List(List&lt;T&gt;&amp;&amp;)</code> and <code>operator=(List&lt;T&gt;&amp;&amp;)</code>), see the <a href=\"https://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29\" rel=\"nofollow noreferrer\">rule of 0/3/5</a>;</li>\n<li>return <code>List&lt;T&gt;&amp;</code> from your assignment operators;</li>\n<li>check the <a href=\"https://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Copy-and-swap\" rel=\"nofollow noreferrer\">copy-and-swap</a> idiom for your assignment operators;</li>\n<li><code>const</code>-qualify the function that should be: <code>size()</code>, <code>find()</code>, <code>lookup()</code>;</li>\n<li>add <code>const</code>-qualified overload for the relevant method: <code>const T&amp; operator[](int i) const</code>;</li>\n<li>check some C++ utility functions, such as <a href=\"https://en.cppreference.com/w/cpp/algorithm/copy\" rel=\"nofollow noreferrer\"><code>copy</code></a> or <a href=\"https://en.cppreference.com/w/cpp/algorithm/equal_range\" rel=\"nofollow noreferrer\"><code>equal_range</code></a>.</li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 8845727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757d400bb850e5279735e51f8a7b32f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ujjwal", "link": "https://stackoverflow.com/users/8845727/ujjwal"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "closed_date": 1546452041, "accepted_answer_id": 54007757, "answer_count": 1, "score": -4, "last_activity_date": 1546441883, "creation_date": 1546432614, "last_edit_date": 1546441883, "question_id": 54006532, "link": "https://stackoverflow.com/questions/54006532/error-passing-const-listint-as-this-argument-discards-qualifiers-within-meth", "closed_reason": "Not suitable for this site", "title": "Error &quot;passing const List&lt;int&gt; as this argument discards qualifiers&quot; within method definition", "body": "<p>I am trying to make a dynamic list of general type T which has some operators overloaded for better manipulations. I have added some member functions for various accessibility and sorting kind of things also. In the function findAll(), I am getting an error: </p>\n\n<blockquote>\n  <p>error: passing \u2018<code>const List&lt;int&gt;</code>\u2019 as \u2018this\u2019 argument discards qualifiers [-fpermissive]\" </p>\n</blockquote>\n\n<p>in a different header file custom exception handling has be done. It will return an exception when the element of the list accessed is not found or searching is done outside the list size.</p>\n\n<pre><code>struct outOfScope : public exception {\n\nconst char * what () const throw () {\n\n  return \"Couldn't assign or retrieve value!, out of scope \nissue!\\n\";\n\n}\n};\n</code></pre>\n\n<p>I have already added constant keyword at the end of the function findAll, still the same error displays. </p>\n\n<pre><code>template&lt;class T&gt;\nclass List //will not work for a list of arrays, and can't be made a typedef of fixed size\n//\"typedef List&lt;vector&gt; tensor(3)\" will not work\n//you will have to rather use List&lt;List&lt;vector&gt;&gt;\n{\n    public:\n\n    T *p = NULL;\n    int s;//size\n//public:\n    //constructor\n    List(){p=NULL; s=0;}\n\n\n    List(int i)\n    {\n        s = i;\n        if(p!=NULL)\n        {\n            delete [] p;\n            p = NULL;\n        }\n        p = new T [s];\n        if(!p)\n        {\n            throw pointerInitialization();\n        }\n    }\n\n//copy constructor\n    List(const List&lt;T&gt;&amp; l)\n    {\n        if(p!=NULL)\n        {\n            delete [] p;\n            p = NULL;\n        }\n        s = l.size();\n        s = l.size();\n        p = new T [s];  //Don't write in place of 'new T', p = l.p because\n        //it will store value without the need to use for loop but destructor 'delete [] p' will delete it multiple times,\n        //causing 'double delete error'\n\n        if(!p)\n        {\n            throw pointerInitialization();\n        }\n\n        for(int i=0; i&lt;s; i++)\n        {\n            p[i] = l.p[i];\n        }\n    }\n\n    List(List&lt;T&gt;&amp; l)\n    {\n        if(p!=NULL)\n        {\n            delete [] p;\n            p = NULL;\n        }\n        s = l.size();\n        s = l.size();\n        p = new T [s];  //Don't write in place of 'new T', p = l.p because\n        //it will store value without the need to use for loop but destructor 'delete [] p' will delete it multiple times,\n        //causing 'double delete error'\n\n        if(!p)\n        {\n            throw pointerInitialization();\n        }\n\n        for(int i=0; i&lt;s; i++)\n        {\n            p[i] = l.p[i];\n        }\n    }\n\n\n\n\n\n    void operator=(const List&lt;T&gt;&amp; l)\n    {\n        if(p!=NULL)\n        {\n            delete [] p;\n            p = NULL;\n        }\n        s = l.size();\n        p = new T [s];\n        if(!p)\n        {\n            throw pointerInitialization();\n        }\n        for(int i=0; i&lt;s; i++)\n        {\n            p[i] = l.p[i];\n        }\n    }\n\n    void operator=(List&lt;T&gt;&amp; l)\n    {\n        if(p!=NULL)\n        {\n            delete [] p;\n            p = NULL;\n        }\n        s = l.size();\n        p = new T [s];\n        if(!p)\n        {\n            throw pointerInitialization();\n        }\n        for(int i=0; i&lt;s; i++)\n        {\n            p[i] = l.p[i];\n        }\n    }\n\n\n    //member functions\n    void setValues(int i);//can be used to reassign the variables any \n\n\n    T&amp; operator[](int i)\n    {\n        if(i&lt;s &amp;&amp; i&gt;=0)\n        return p[i];\n\n        else\n        {\n            throw outOfScope();\n        }\n    }\n\n    int size(){return s;}\n\n    void addAtEnd(T newEntry)//adding a node at the end of the list\n    {\n        s = s+1;\n        T* newP = new T[s];// new pointer of one greater size is created\n        newP[s-1] = newEntry;//at the last node, newEntry is added\n        for(int i=0; i&lt;s-1; i++)//for the rest of the entry, *newP copies data of the *p\n        {\n            newP[i] = p[i];\n        }\n\n        delete [] p;//deleting the memory pointed by the pointer p, doesn't mean p has lost its existence\n        p = new T[s];//reassigning p to a new memory of size s(no need to use NULL before it as we are already\n        //reassigning it again. Also don't write T* p = new T[s], it will create a different p, because now the\n        //statement becomes a declaration type, there must not be two declarations of the same name p (once already\n        //declared in member variable declaration of class List\n\n        for(int i=0; i&lt;s; i++)\n        {\n            p[i] = newP[i];\n        }\n\n        delete [] newP;\n        newP = NULL;\n    }\n\n    int find(T value); //takes argument as the element of list, returns the location of list (counting zero as first node)\n\n\n    List&lt;int&gt; findAll(T value) const//takes argument as the element of list, returns the location of list (counting zero as first node)\n    {\n        List&lt;int&gt;  locList;\n        for(int i=0; i&lt;s; i++)\n        {\n            if(p[i]==value)\n            {\n                locList.addAtEnd(i);\n            }\n        }\n\n        if(locList.size() != 0)\n            return locList;\n\n        else\n        {\n                throw outOfScope();\n        }\n    }\n\n    bool lookup(T value);\n\n\n\n    //destructor\n    ~List()\n    {\n        delete [] p;//means whenever destructor is called to destroy the object,\n        //first of all, 'p' will delete the variable it is pointing to. Then the List obj will be destroyed\n        p = NULL;\n//      cout&lt;&lt;\"\\ndestructror is called! \\n\";\n    }\n};\n\n//--------------------------------------------------------------------------\n//macros\n#define forAll(List, i)  for(int i=0; i&lt;List.size(); i++)\n</code></pre>\n\n<p>Implementation code:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;exception&gt;\n\nint main()\n{\nList&lt;int&gt; rollNo(5);\nint k=0;\nrollNo[k++] = 2;\nrollNo[k++] = 2;\nrollNo[k++] = 3;\nrollNo[k++] = 2;\nrollNo[k++] = 3;\n\nList&lt;int&gt; findList = rollNo.findAll(rollNo[2]);\n\nforAll(findList, i)\ncout&lt;&lt;findList[i]&lt;&lt;endl;\n\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "linux", "ibm-mq"], "comments": [{"owner": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1546440255, "post_id": 54006379, "comment_id": 94853167, "body": "What does the error log on the queue manager show?  What specific v8.0.0.x do they upgrade to? What specific version is your MQ client?"}, {"owner": {"reputation": 1738, "user_id": 4180950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ea4589934fa5b3e5e0f55cd65f82eb?s=128&d=identicon&r=PG&f=1", "display_name": "Attila Repasi", "link": "https://stackoverflow.com/users/4180950/attila-repasi"}, "edited": false, "score": 0, "creation_date": 1546448764, "post_id": 54006379, "comment_id": 94857435, "body": "You only get 2018, because you are trying to close a connection not opened correctly. Your only error code seems to be 2059, wich suggests the QM isn\u2019t actually running when \u201cmigrated\u201d. Have you checked the QM error logs?"}, {"owner": {"reputation": 69, "user_id": 569389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613c300d9d8d2d1f0095f7b53c4f0563?s=128&d=identicon&r=PG", "display_name": "Syed Mudhasir", "link": "https://stackoverflow.com/users/569389/syed-mudhasir"}, "edited": false, "score": 0, "creation_date": 1546513714, "post_id": 54006379, "comment_id": 94878157, "body": "MQ versions below for your reference:-  $dspmqver -a Name:        WebSphere MQ Version:     8.0.0.9 Level:       p800-009-180321.1 BuildType:   IKAP - (Production) Platform:    WebSphere MQ for Linux (x86-64 platform) Mode:        64-bit O/S:         Linux 2.6.32-754.6.3.el6.x86_64 InstName:    Installation1 InstDesc: Primary:     Yes InstPath:    /opt/mqm DataPath:    /var/mqm MaxCmdLevel: 802 --------------------------------------------------------  $rpm -qa | grep MQSeriesClient MQSeriesClient-8.0.0-4.x86_64 MQSeriesClient-U8009-8.0.0-9.x86_64"}, {"owner": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1546743222, "post_id": 54006379, "comment_id": 94950344, "body": "Both of us asked for what the QM error logs have,  can you provide?"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 569389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613c300d9d8d2d1f0095f7b53c4f0563?s=128&d=identicon&r=PG", "display_name": "Syed Mudhasir", "link": "https://stackoverflow.com/users/569389/syed-mudhasir"}, "edited": false, "score": 0, "creation_date": 1546513891, "post_id": 54015028, "comment_id": 94878258, "body": "I checked in IBM website, for MQ 8 Java 7 seems to be compatible. Are you saying this is causing the issue? Any error log which I can check to confirm ?  Currently this is the version :-   java version &quot;1.7.0_191&quot; OpenJDK Runtime Environment (rhel-2.6.15.4.el6_10-x86_64 u191-b01) OpenJDK 64-Bit Server VM (build 24.191-b01, mixed mode)"}], "tags": [], "owner": {"reputation": 1, "user_id": 9976372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wOhX7kvF5Gk/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3_8zR3EqNwZ6-SWZA8O9Z_N-xJig/mo/photo.jpg?sz=128", "display_name": "Kevin Forster", "link": "https://stackoverflow.com/users/9976372/kevin-forster"}, "is_accepted": false, "score": 0, "last_activity_date": 1546476477, "creation_date": 1546476477, "answer_id": 54015028, "question_id": 54006379, "link": "https://stackoverflow.com/questions/54006379/ibm-mq-upgrade-causing-error-2059-and-error-2018/54015028#54015028", "title": "IBM MQ upgrade causing error 2059 and error 2018", "body": "<p>Check that your software is compatible with MQ 8.0.\nI had a similar issue. It turned out that we needed to upgrade to Java 8.</p>\n"}], "owner": {"reputation": 69, "user_id": 569389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613c300d9d8d2d1f0095f7b53c4f0563?s=128&d=identicon&r=PG", "display_name": "Syed Mudhasir", "link": "https://stackoverflow.com/users/569389/syed-mudhasir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 578, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546742539, "creation_date": 1546431991, "last_edit_date": 1546440629, "question_id": 54006379, "link": "https://stackoverflow.com/questions/54006379/ibm-mq-upgrade-causing-error-2059-and-error-2018", "title": "IBM MQ upgrade causing error 2059 and error 2018", "body": "<p>In my application one interface is connected to external system on MQ. When MQ upgrade is performed by system team from MQ version 7.5 to version 8.0 we are facing error 2059 and error 2018. We could see the below error in our log file. </p>\n\n<p>error from log :- </p>\n\n<pre><code>18.07.24 19:49:11 [mqseries:14610]mqs_process_mb_msg:**MQCONN ended with reason code 2059** \n18.07.24 19:49:11 [mqseries:14610]mqs_exit: signal 0 received\n18.07.24 19:49:11 [mqseries:14610]**ABST.ONLINE.PUT.DBSI.Q Disconnected** \n18.07.24 19:49:11 [mqseries:14610]**MQCLOSE ABST.ONLINE.PUT.DBSI.Q ended with reason 2018** \n18.07.24 19:49:11 [mqseries:14610]**MQDISC ended with reason code 2018**\n</code></pre>\n\n<p>Please note once the system team is downgrading it back to MQ version 7.5 it is working fine and as expected. Kindly help on what could be the missing during the MQ upgrade from version 7.5 to version 8.</p>\n"}, {"tags": ["c++", "arrays", "jsoncpp"], "comments": [{"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 0, "creation_date": 1546432194, "post_id": 54006333, "comment_id": 94849266, "body": "Did you try <code>responseDataCart = responseData[0][&quot;cart&quot;][&quot;name&quot;];</code>"}, {"owner": {"reputation": 11, "user_id": 10857277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20e52f801ab7d785d35cb8c7003e09b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael K.", "link": "https://stackoverflow.com/users/10857277/michael-k"}, "reply_to_user": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 0, "creation_date": 1546432241, "post_id": 54006333, "comment_id": 94849294, "body": "Yes, i tried - it doesn&#39;t work."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546432967, "post_id": 54006333, "comment_id": 94849651, "body": "Your return statement is wasteful. <code>toStyledString()</code> already gives you a <code>std::string</code>, which only needs directly returning (which will move it); you&#39;re obtaining a C-string out of it then constructing a new string from <i>that</i>. It&#39;s not the end of the world, but it does require a <code>strlen</code> invocation and prohibits moving the data."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10857277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20e52f801ab7d785d35cb8c7003e09b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael K.", "link": "https://stackoverflow.com/users/10857277/michael-k"}, "edited": false, "score": 0, "creation_date": 1546437043, "post_id": 54006541, "comment_id": 94851645, "body": "Thanks a lot for the reply! Works perfectly with Json::CharReader* reader = jsonReader.newCharReader();"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 11, "user_id": 10857277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20e52f801ab7d785d35cb8c7003e09b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael K.", "link": "https://stackoverflow.com/users/10857277/michael-k"}, "edited": false, "score": 0, "creation_date": 1546437148, "post_id": 54006541, "comment_id": 94851693, "body": "@MichaelK. Don&#39;t forget to <code>delete</code> it! I like to use <code>std::unique_ptr</code> for the task. I had a memory leak in production where I was doing <code>auto reader = Json::CharReaderBuilder().newCharReader();</code> and forgot that it returns a naked pointer :( Needless to say that area of code now has a massive comment warning slapped all over it"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1546432649, "creation_date": 1546432649, "answer_id": 54006541, "question_id": 54006333, "link": "https://stackoverflow.com/questions/54006333/c-jsoncpp-parse-string-with-escaped-quotes-as-array/54006541#54006541", "title": "c++ JsonCpp parse string with escaped quotes as array", "body": "<p>The same way you parsed the outer JSON!</p>\n\n<p>You started with a string (well, hidden by a stream) and turned it into JSON.</p>\n\n<p>Now that JSON contains a property that is a string and, itself, contains JSON. The problem is recursive. The fact that the inner string originally came from JSON too can be ignored. Just pretend it's a string you typed in.</p>\n\n<p>So, <a href=\"https://stackoverflow.com/a/47284656/560648\">you can use JSON::Reader</a> to in turn get the JSON out of that string.</p>\n\n<p>Something like:</p>\n\n<pre><code>const std::string responseDataCartStr = responseData[0][\"cart\"].asString();\n\nJson::Reader reader;\nif (!reader.parse(responseDataCartStr, responseDataCart))\n   throw std::runtime_error(\"Parsing nested JSON failed\");\n</code></pre>\n\n<p>JsonCpp provides a few ways to parse JSON and it's worth exploring them to find the most appropriate for your use case. The above is just an example.</p>\n\n<p>Ignore the backslashes &mdash; the escaping was meaningful within the encapsulating JSON document, but the outermost parse stage should already have taken that into consideration. You'll see if you print <code>responseDataCartStr</code> to console that it is a valid JSON document in its own right.</p>\n"}], "owner": {"reputation": 11, "user_id": 10857277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20e52f801ab7d785d35cb8c7003e09b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael K.", "link": "https://stackoverflow.com/users/10857277/michael-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1546432649, "creation_date": 1546431821, "question_id": 54006333, "link": "https://stackoverflow.com/questions/54006333/c-jsoncpp-parse-string-with-escaped-quotes-as-array", "title": "c++ JsonCpp parse string with escaped quotes as array", "body": "<p>I've got the following json string:</p>\n\n<pre><code>{\n    \"data\" : \n    [\n        {\n            \"cart\" : \"[{\\\"name\\\":\\\"Test item 1\\\",\\\"price\\\":15,\\\"quantity\\\":1,\\\"sum\\\":15,\\\"tax\\\":\\\"none\\\",\\\"payment_type\\\":\\\"advance\\\",\\\"item_type\\\":\\\"service\\\"},{\\\"name\\\":\\\"Test item 2\\\",\\\"price\\\":13.01,\\\"quantity\\\":2,\\\"sum\\\":26.02,\\\"tax\\\":\\\"none\\\",\\\"payment_type\\\":\\\"part_prepay\\\",\\\"item_type\\\":\\\"work\\\"}]\",\n            \"contact\" : \"noname@google.com\",\n            \"p_id\" : \"603\",\n            \"sum\" : \"100.02\",\n            \"tax_system\" : \"osn\"\n        }\n    ],\n    \"msg\" : null,\n    \"result\" : \"success\"\n}\n</code></pre>\n\n<p>I can parse <strong>cart</strong> as std::string after parsing input json string as stringstream:</p>\n\n<pre><code>const std::string ParseJsonData(std::stringstream ssJsonStream)\n{\n    Json::Value jsonData;\n    Json::Value responseData;\n    Json::Value responseDataCart;\n    Json::CharReaderBuilder jsonReader;\n    std::string errs;\n\n    if (Json::parseFromStream(jsonReader, ssJsonStream, &amp;jsonData, &amp;errs)) {\n        responseData = jsonData[\"data\"];\n        responseDataCart = responseData[0][\"cart\"];\n        return responseDataCart.toStyledString().c_str();\n    }\n    else\n        return \"Could not parse HTTP data as JSON\";\n}\n</code></pre>\n\n<p>Please, tell me, how can i parse <strong>cart</strong> as array with JsonCpp?</p>\n"}, {"tags": ["c++", "graphics", "3d", "mesh", "cgal"], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1546882963, "post_id": 54027480, "comment_id": 94991889, "body": "is there any example of removing/adding cells from read mesh , because all examples about polygon created within code like this: <a href=\"https://doc.cgal.org/latest/Combinatorial_map/Combinatorial_map_2map_3_operations_8cpp-example.html\" rel=\"nofollow noreferrer\">doc.cgal.org/latest/Combinatorial_map/&hellip;</a>  I don&#39;t know how to use dart handle in read mesh @gdamiand"}], "tags": [], "owner": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "is_accepted": false, "score": 1, "last_activity_date": 1546538452, "creation_date": 1546538452, "answer_id": 54027480, "question_id": 54006275, "link": "https://stackoverflow.com/questions/54006275/how-to-remove-vertex-edge-or-face-from-cgallinear-cell-complex-for-combinato/54027480#54027480", "title": "how to remove vertex , edge or face from CGAL::Linear_cell_complex_for_combinatorial_map", "body": "<p>You can use the remove_cell operation. The method is templated by the dimension of the cell to remove: 0 for vertices, 1 for edges, 2 for faces...</p>\n\n<p>See the doc <a href=\"https://doc.cgal.org/latest/Combinatorial_map/index.html#title18\" rel=\"nofollow noreferrer\">here</a> and the example <a href=\"https://doc.cgal.org/latest/Combinatorial_map/index.html#title21\" rel=\"nofollow noreferrer\">there</a>.</p>\n"}], "owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546538452, "creation_date": 1546431583, "question_id": 54006275, "link": "https://stackoverflow.com/questions/54006275/how-to-remove-vertex-edge-or-face-from-cgallinear-cell-complex-for-combinato", "title": "how to remove vertex , edge or face from CGAL::Linear_cell_complex_for_combinatorial_map", "body": "<p>I'm creating an application using qt creator which read .off files as CGAL::Linear_cell_complex_for_combinatorial_map and preview it \nI want to make operations on the read mesh such as removing vertix,edge or face and restore it .</p>\n\n<p>I created a loop to access darts :\nDart_handle dh;</p>\n\n<pre><code>for (LCC_3::Dart_range::iterator it=lcc.darts().begin(),\n           itend=lcc.darts().end(); it!=itend; )\n    {\n      dh=it++;\n      if ( it!=itend &amp;&amp; it==lcc.beta&lt;2&gt;(dh) ) ++it;\n\n}\n</code></pre>\n\n<p>any help or usefull links to simplify mesh or removing vertices , edges or faces ?\nI appreciate any help</p>\n"}, {"tags": ["c++", "string", "stream", "floating-point", "qnx"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546429614, "post_id": 54005536, "comment_id": 94848167, "body": "Please specify what the toolchain is, including version."}, {"owner": {"reputation": 272, "user_id": 10691317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb02cffd3ebd94ba03d5bdf4f2740edc?s=128&d=identicon&r=PG&f=1", "display_name": "I. Hamad", "link": "https://stackoverflow.com/users/10691317/i-hamad"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546429776, "post_id": 54005536, "comment_id": 94848225, "body": "I use this: QCC -V5.4.0,gcc_ntox86_64 main.cpp -o qnxTest -std=gnu++14.  My version: QNX localhost 7.0.3 2018/09/18-00:28:50EDT x86pc x86_64"}], "answers": [{"comments": [{"owner": {"reputation": 272, "user_id": 10691317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb02cffd3ebd94ba03d5bdf4f2740edc?s=128&d=identicon&r=PG&f=1", "display_name": "I. Hamad", "link": "https://stackoverflow.com/users/10691317/i-hamad"}, "edited": false, "score": 0, "creation_date": 1546436340, "post_id": 54006389, "comment_id": 94851281, "body": "thanks for the hint. For unknown reasons <code>errno</code> is not changed. In QNX <code>errno = 0</code>, in Linux <code>errno=34</code>"}, {"owner": {"reputation": 272, "user_id": 10691317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb02cffd3ebd94ba03d5bdf4f2740edc?s=128&d=identicon&r=PG&f=1", "display_name": "I. Hamad", "link": "https://stackoverflow.com/users/10691317/i-hamad"}, "edited": false, "score": 0, "creation_date": 1546436867, "post_id": 54006389, "comment_id": 94851543, "body": "Yes I will do. Thanks for your support."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 272, "user_id": 10691317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb02cffd3ebd94ba03d5bdf4f2740edc?s=128&d=identicon&r=PG&f=1", "display_name": "I. Hamad", "link": "https://stackoverflow.com/users/10691317/i-hamad"}, "edited": false, "score": 0, "creation_date": 1546437237, "post_id": 54006389, "comment_id": 94851732, "body": "@H.Ilyas FYI It&#39;s kind of customary on SO to add a link to the bug report if it is publicly visible. You can write your own answer to the question and update it if it is solved one day."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 2, "last_activity_date": 1546436537, "last_edit_date": 1592644375, "creation_date": 1546432007, "answer_id": 54006389, "question_id": 54005536, "link": "https://stackoverflow.com/questions/54005536/why-stdistringstream-generates-wrong-results-without-raising-the-failbit-flag/54006389#54006389", "title": "Why std::istringstream generates wrong results without raising the failbit flag?", "body": "<p>According to cppreference.com, here is what happen:</p>\n<h3><a href=\"https://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt\" rel=\"nofollow noreferrer\"><code>std::istringstream::operator&lt;&lt;(float&amp;)</code></a>:</h3>\n<blockquote>\n<p>(5) extracts a floating point value by calling <code>std::num_get::get()</code></p>\n</blockquote>\n<h3><a href=\"https://en.cppreference.com/w/cpp/locale/num_get/get\" rel=\"nofollow noreferrer\"><code>std::num_get::get()</code></a></h3>\n<blockquote>\n<h1>Stage 3: conversion and storage</h1>\n<p>The input is parsed as if by <code>std::strtof</code></p>\n<p>In any case, if the conversion function fails <code>std::ios_base::failbit</code> is assigned to <code>err</code>.</p>\n</blockquote>\n<h3><a href=\"https://en.cppreference.com/w/cpp/string/byte/strtof\" rel=\"nofollow noreferrer\"><code>std::strtof</code></a></h3>\n<blockquote>\n<h1>Return value</h1>\n<p>Floating point value corresponding to the contents of str on success. If the converted value falls out of range of corresponding return type, range error occurs and <code>HUGE_VAL</code>, <code>HUGE_VALF</code> or <code>HUGE_VALL</code> is returned. If no conversion can be performed, \u200b0\u200b is returned and <code>*str_end</code> is set to <code>str</code>.</p>\n</blockquote>\n<h3><a href=\"https://en.cppreference.com/w/cpp/numeric/math/HUGE_VAL\" rel=\"nofollow noreferrer\"><code>HUGE_VALF</code></a></h3>\n<blockquote>\n<p><code>HUGE_VALF</code>    Expands to positive float expression that indicates overflow</p>\n</blockquote>\n<hr />\n<p>In your case, it is clear that <code>std::strtof</code> with <code>5.94...e+4931</code> will overflow a <code>float</code>, it should return <code>HUGE_VALF</code>, which is an error value for this function. Under linux:</p>\n<pre><code>float const have_overflown = std::strtof(&quot;1e307&quot;, nullptr);\nstd::cout &lt;&lt; &quot;equals HUGE_VALF: &quot; &lt;&lt; std::boolalpha\n          &lt;&lt; (have_overflown == HUGE_VALF) &lt;&lt; '\\n';     // true\nstd::cout &lt;&lt; &quot;string repr: &quot; &lt;&lt; have_overflown &lt;&lt; '\\n'; // inf\n</code></pre>\n<p><a href=\"http://coliru.stacked-crooked.com/a/f5ab906f72610c72\" rel=\"nofollow noreferrer\">Live demo</a></p>\n<p>Since <code>std::strtof</code> effectively returns <code>HUGE_VALF</code> for overflowing values, the failbit of a stream calling it <em>should</em> be set, as mandated in the spec of <code>std::istringstream::operator&lt;&lt;(float&amp;)</code>.</p>\n<p>QNX fails this requirement. You could try and check where in the chain it fails.</p>\n<hr />\n<p>According to <a href=\"http://www.qnx.com/developers/docs/6.5.0SP1.update/com.qnx.doc.neutrino_lib_ref/s/strtod.html\" rel=\"nofollow noreferrer\">QNX doc on <code>strtof</code></a>:</p>\n<blockquote>\n<p>If the correct value would cause overflow, plus or minus HUGE_VAL is returned according to the sign, and errno is set to ERANGE.</p>\n</blockquote>\n<p>You could check <code>errno</code> against <code>ERANGE</code> in addition to checking the stream failbit:</p>\n<pre><code>errno = 0;\niss &gt;&gt; floatNumber;\nif (iss.fail() || errno == ERANGE) {\n    // fail\n}\n</code></pre>\n<hr />\n<p>Finally, if your implementation fails to conform to its own documentation as you say id does in the comment section, you could check <code>floatNumber</code> against <code>HUGE_VALF</code> to detect overflows.</p>\n"}], "owner": {"reputation": 272, "user_id": 10691317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb02cffd3ebd94ba03d5bdf4f2740edc?s=128&d=identicon&r=PG&f=1", "display_name": "I. Hamad", "link": "https://stackoverflow.com/users/10691317/i-hamad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1546436537, "creation_date": 1546428605, "last_edit_date": 1546429916, "question_id": 54005536, "link": "https://stackoverflow.com/questions/54005536/why-stdistringstream-generates-wrong-results-without-raising-the-failbit-flag", "title": "Why std::istringstream generates wrong results without raising the failbit flag?", "body": "<p>When I convert a <code>string</code> that contains <code>long double</code> to <code>float</code> or <code>double</code>, <code>std::istringstream</code> doesn't raise the failbit flag in <strong>QNX</strong>.</p>\n\n<p>The following is a demonstration code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n#include &lt;iomanip&gt;\n#include &lt;limits&gt;\n\nint main(){\n    const long double originaldNumber = std::numeric_limits&lt;long double&gt;::max() / 2;\n    float floatNumber;\n    std::string numberString = std::to_string(originaldNumber);\n\n    //From string to long double\n    std::istringstream iss(numberString);\n    iss &gt;&gt; floatNumber;\n\n    if (iss.fail())\n        std::cout&lt;&lt; \"iss failed \\n\";\n\n    std::cout&lt;&lt; std::setprecision(30) &lt;&lt; originaldNumber &lt;&lt; \"\\n\";\n    std::cout&lt;&lt; std::setprecision(30) &lt;&lt; floatNumber &lt;&lt; \"\\n\";\n\n    return 0;\n}\n</code></pre>\n\n<p>The output in linux is:</p>\n\n<pre><code> iss failed \n 5.94865747678615882510631926515e+4931\n 3.40282346638528859811704183485e+38\n</code></pre>\n\n<p>The output in QNX is:</p>\n\n<pre><code>5.94865747678615882510631e+4931\ninf\n</code></pre>\n\n<p>QNX version: <code>7.0.3 2018/09/18-00:28:50EDT x86pc x86_64</code>.<br>\nToolchain: <code>gcc_ntox86_64</code></p>\n"}, {"tags": ["c++", "visual-studio-2015", "cmake"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546428620, "post_id": 54005516, "comment_id": 94847714, "body": "The principle with CMake is that it will regenerate the solution if something changes, so no, you must not manually change the solution. Still don&#39;t understand what the link is with command line arguments for an executable though."}, {"owner": {"reputation": 1168, "user_id": 3745908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cdcf18df0e4ae4a4de189b5d8e318fae?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Benmahdjoub", "link": "https://stackoverflow.com/users/3745908/mohamed-benmahdjoub"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546428771, "post_id": 54005516, "comment_id": 94847790, "body": "Well I have to push arguments to the executable (basically a port number) and I am doing that in Visual studio after cmake has already built the project (from debugging options). I want to have a default port number that would be defined when cmake builds the project. When I get to visual studio, I will just have to run the project. You understand me better ? @MatthieuBrucher"}, {"owner": {"reputation": 1168, "user_id": 3745908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cdcf18df0e4ae4a4de189b5d8e318fae?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Benmahdjoub", "link": "https://stackoverflow.com/users/3745908/mohamed-benmahdjoub"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546428891, "post_id": 54005516, "comment_id": 94847852, "body": "What I mean is that what I want to achieve is like defining a default startup project in the solution (Instead of ALL_BUILD) by putting this in <code>CmakeLists.txt</code> : <code>set_property(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} PROPERTY VS_STARTUP_PROJECT projectname)</code>"}, {"owner": {"reputation": 1948, "user_id": 7042963, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CgsFk.jpg?s=128&g=1", "display_name": "BartekPL", "link": "https://stackoverflow.com/users/7042963/bartekpl"}, "edited": false, "score": 0, "creation_date": 1546428971, "post_id": 54005516, "comment_id": 94847909, "body": "You can add <code>config.h</code> file (like <a href=\"https://github.com/BartekkPL/bvh-parser/blob/master/cmake/config.h.in\" rel=\"nofollow noreferrer\">here</a>) and then add some additional instructions to <code>CMakeLists.txt</code> file (like <a href=\"https://github.com/BartekkPL/bvh-parser/blob/master/CMakeLists.txt#L179-L191\" rel=\"nofollow noreferrer\">here</a>) and then use info from <code>config.h</code> file as default."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1546429127, "post_id": 54005516, "comment_id": 94847978, "body": "Are you talking about arguments for the debugger to pass onto your executable?"}, {"owner": {"reputation": 1168, "user_id": 3745908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cdcf18df0e4ae4a4de189b5d8e318fae?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Benmahdjoub", "link": "https://stackoverflow.com/users/3745908/mohamed-benmahdjoub"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1546429325, "post_id": 54005516, "comment_id": 94848055, "body": "@StoryTeller Check picture"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1546429349, "post_id": 54005516, "comment_id": 94848067, "body": "See my now undeleted answer then."}], "answers": [{"comments": [{"owner": {"reputation": 1168, "user_id": 3745908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cdcf18df0e4ae4a4de189b5d8e318fae?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Benmahdjoub", "link": "https://stackoverflow.com/users/3745908/mohamed-benmahdjoub"}, "edited": false, "score": 1, "creation_date": 1546445983, "post_id": 54005648, "comment_id": 94856082, "body": "This is the line to add to <code>CmakeLists.txt</code> in case someone needs that : set_target_properties(TargetName PROPERTIES VS_DEBUGGER_COMMAND_ARGUMENTS &quot;arg1 arg2 ... argN&quot;)"}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1546429064, "creation_date": 1546429064, "answer_id": 54005648, "question_id": 54005516, "link": "https://stackoverflow.com/questions/54005516/cmake-add-default-command-line-arguments-to-a-cmake-project/54005648#54005648", "title": "CMAKE - Add default command line arguments to a cmake project", "body": "<p>If you are using CMake 3.13 and above you can add the <a href=\"https://cmake.org/cmake/help/v3.13/prop_tgt/VS_DEBUGGER_COMMAND_ARGUMENTS.html#prop_tgt:VS_DEBUGGER_COMMAND_ARGUMENTS\" rel=\"noreferrer\"><code>VS_DEBUGGER_COMMAND_ARGUMENTS</code></a> property to your executable target in order specify those arguments.</p>\n"}], "owner": {"reputation": 1168, "user_id": 3745908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cdcf18df0e4ae4a4de189b5d8e318fae?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Benmahdjoub", "link": "https://stackoverflow.com/users/3745908/mohamed-benmahdjoub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1424, "favorite_count": 0, "accepted_answer_id": 54005648, "answer_count": 1, "score": 3, "last_activity_date": 1546429313, "creation_date": 1546428477, "last_edit_date": 1592644375, "question_id": 54005516, "link": "https://stackoverflow.com/questions/54005516/cmake-add-default-command-line-arguments-to-a-cmake-project", "title": "CMAKE - Add default command line arguments to a cmake project", "body": "<p>I am creating and building a <code>c++</code> project using <code>cmake</code> from scratch.<br/>\nThe executable requires <strong>command line arguments</strong>.<br/>\nI am specifying them in <code>Visual studio</code>.<br/><br/>\n<strong>Is it possible to specify them by default when cmake builds the project (in my <code>CmakeLists.txt</code> for example) ?</strong>\nSo that I (or others) won't need to specify these arguments each time I build the project for the first time (I would want to just run the project without worrying about that but still can change them in visual studio of course if needed) ?</p>\n<p><a href=\"https://i.stack.imgur.com/yYkGV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yYkGV.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["c++", "class-visibility"], "comments": [{"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 0, "creation_date": 1546428713, "post_id": 54005503, "comment_id": 94847755, "body": "Does the example at the end of the page, that you refer to, do the same thing as you? Do they also try to use <code>using</code> and the <code>impl</code> of the <code>widget</code> class in the <code>main()</code> function? No."}, {"owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "reply_to_user": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 0, "creation_date": 1546428912, "post_id": 54005503, "comment_id": 94847869, "body": "@JoeyMallone no because they define the function inside the class declaration. It seems a good idea in the example page but because my implementation is hundred-of-line-long, then it is not adequate to me"}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 0, "creation_date": 1546429020, "post_id": 54005503, "comment_id": 94847926, "body": "try this <code>ClassImpl::ClassImpl() {</code> for the constructor and leave <code>using</code>."}, {"owner": {"reputation": 88, "user_id": 6838396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EV4Eb.jpg?s=128&g=1", "display_name": "Kiruse", "link": "https://stackoverflow.com/users/6838396/kiruse"}, "edited": false, "score": 0, "creation_date": 1546429127, "post_id": 54005503, "comment_id": 94847979, "body": "I have nothing to back up this claim (hence only as a comment), but no, it is not possible. You are trying to create an <a href=\"https://en.cppreference.com/w/cpp/language/type_alias\" rel=\"nofollow noreferrer\">alias</a>. Imagine if you could create an alias to any private symbol. That would break the entire purpose of access modifiers, wouldn&#39;t it? Anyhow, although I hate the precompiler, you can achieve the same code reduction by simply defining a constant: <code>#define C Class::ClassImpl</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "edited": false, "score": 0, "creation_date": 1546441968, "post_id": 54005838, "comment_id": 94854017, "body": "The naked pointer was just for the example, I use smart pointers actually"}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 1, "last_activity_date": 1550917134, "last_edit_date": 1550917134, "creation_date": 1546429824, "answer_id": 54005838, "question_id": 54005503, "link": "https://stackoverflow.com/questions/54005503/use-the-using-directive-on-a-private-nested-class/54005838#54005838", "title": "Use the using directive on a private nested class", "body": "<blockquote>\n  <p>Is there a way to use usingon the private nested class ClassImpl ?</p>\n</blockquote>\n\n<p>Yes. Declare <code>ClassImpl</code> with public access in <code>Class</code>:</p>\n\n<pre><code>class Class {\npublic:\n    Class();\n    class ClassImpl;\n\nprivate:\n    ClassImpl* rep; // should be reference, see note.\n};\n\n// ...\n\nusing C = Class::ClassImpl;\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/4dba79b26148f0da\" rel=\"nofollow noreferrer\">Live demo</a></p>\n\n<p>You can also make <code>ClassImpl</code> not a nested class.</p>\n\n<p>Note: you might prefer having <code>Class::rep</code> to be a reference rather than a (naked) pointer. There is no reason for a valid <code>Class</code> instance not to have an implementation object (a null pointer).</p>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1546432567, "creation_date": 1546432567, "answer_id": 54006513, "question_id": 54005503, "link": "https://stackoverflow.com/questions/54005503/use-the-using-directive-on-a-private-nested-class/54006513#54006513", "title": "Use the using directive on a private nested class", "body": "<blockquote>\n  <p>Is there a way to use <code>using</code> on the private nested class <code>ClassImpl</code>?</p>\n</blockquote>\n\n<p>The short answer is \"no\".</p>\n\n<p>Longer answer follows.</p>\n\n<p>What you're trying to do is a <code>using</code> declaration, not a <code>using</code> directive.</p>\n\n<p>Your using declaration</p>\n\n<blockquote>\n<pre><code>using C = Class::ClassImpl;\n</code></pre>\n</blockquote>\n\n<p>is at file scope, so the name <code>Class::ClassImpl</code> cannot be used directly as a name in that scope.</p>\n\n<p>The first relevant section of the standard (C++17) is Section 10.3.3 \"The <code>using</code> declaration\", for which para 19 states \"A synonym created by a <em>using-declaration</em> has the usual accessibility for a <em>member-declaration</em>\".</p>\n\n<p>To find what is meant by \"usual accessibility\", refer to Section 14 \"Member Access Control\", which states that \"<code>private</code> names can only be used by members and friends of the class in which it is declared\".  The usage of \"names\" here is quite specific - anything with a name that is <code>private</code> to a class (member declarations, type declarations, etc) are treated the same way.</p>\n\n<p>If you want to have a <code>using</code> declaration at file scope, as per your example;</p>\n\n<blockquote>\n<pre><code>using C = Class::ClassImpl;\n</code></pre>\n</blockquote>\n\n<p>then <code>ClassImpl</code> needs to be a <code>public</code> name (of a nested class) of <code>Class</code>.   <code>private</code> and <code>protected</code> names of a class cannot be accessed at file scope.</p>\n"}], "owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1550917134, "creation_date": 1546428434, "last_edit_date": 1546429863, "question_id": 54005503, "link": "https://stackoverflow.com/questions/54005503/use-the-using-directive-on-a-private-nested-class", "title": "Use the using directive on a private nested class", "body": "<p>I have been developing a library for a while and now that I think it's ready, I am trying to follow the <a href=\"https://en.cppreference.com/w/cpp/language/pimpl\" rel=\"nofollow noreferrer\">pimpl principle</a> in order to hide implementation details.</p>\n\n<pre><code>// File Class.h\nclass Class {\npublic:\n  Class();\n\nprivate:\n    class ClassImpl;\n    ClassImpl* rep;\n};\n\n// File Class.cpp\n#include \"Class.h\"\n#include \"ClassImpl.h\"\nClass::Class() {\n    rep = new ClassImpl();\n}\n</code></pre>\n\n<p>The implementation class is defined in another file as follow</p>\n\n<pre><code>// File ClassImpl.h\n#include \"Class.h\"\nclass Class::ClassImpl {\npublic:\n  ClassImpl();\n};\n</code></pre>\n\n<p>And its implementation:</p>\n\n<pre><code>// File ClassImpl.cpp\n#include \"ClassImpl.h\"\n#include &lt;iostream&gt;\n\nusing C = Class::ClassImpl; // error: 'class Class::ClassImpl' is private\nC::ClassImpl() {\n  std::cout &lt;&lt; \"Implementation constructor\";\n}\n</code></pre>\n\n<p>Main function:</p>\n\n<pre><code>// File main.cpp\n#include \"Class.h\"\nint main() {\n    Class c;\n    return 0;\n}\n</code></pre>\n\n<p>Doing this, the compiler says <code>error: 'class Class::ClassImpl' is private</code> on the using line in <code>ClassImpl.cpp</code>. If I remove it and use <code>Class::ClassImpl</code> instead, everything works fine.</p>\n\n<p>Is there a way to use <code>using</code>on the private nested class <code>ClassImpl</code> ?</p>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 651, "user_id": 1165590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/05ae818f8f3faa8ffb4c19d732ac01d3?s=128&d=identicon&r=PG", "display_name": "Baj Mile", "link": "https://stackoverflow.com/users/1165590/baj-mile"}, "edited": false, "score": 0, "creation_date": 1546433146, "post_id": 54005478, "comment_id": 94849740, "body": "You have three options: 1) use scanf, 2) use reg-ex 3) write your own parser. Better, look at how to do 3 because is more flexible. For 3) most simple is to start reading the file line by line and then word by word (search for such std iterators)."}, {"owner": {"reputation": 43, "user_id": 8270442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c990fdf209209c242548e2c0de7d445?s=128&d=identicon&r=PG&f=1", "display_name": "Monkone", "link": "https://stackoverflow.com/users/8270442/monkone"}, "reply_to_user": {"reputation": 651, "user_id": 1165590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/05ae818f8f3faa8ffb4c19d732ac01d3?s=128&d=identicon&r=PG", "display_name": "Baj Mile", "link": "https://stackoverflow.com/users/1165590/baj-mile"}, "edited": false, "score": 0, "creation_date": 1546435725, "post_id": 54005478, "comment_id": 94850967, "body": "Ok, I&#39;ll have a look at that approach, thanks for the pointers."}], "owner": {"reputation": 43, "user_id": 8270442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c990fdf209209c242548e2c0de7d445?s=128&d=identicon&r=PG&f=1", "display_name": "Monkone", "link": "https://stackoverflow.com/users/8270442/monkone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546428304, "creation_date": 1546428304, "question_id": 54005478, "link": "https://stackoverflow.com/questions/54005478/how-to-extract-vertices-given-in-an-stl-file-exported-from-3ds-max-into-multi", "title": "How to extract vertices given in an .stl file (exported from 3ds max) into multiple arrays of floats using c++", "body": "<p>I have an .stl file with the following format (here representing a random 2D rectangle centered on the origin),</p>\n\n<pre><code>solid Object01\n    facet normal 0.000000e+00 -0.000000e+00 1.000000e+00\n        outer loop\n            vertex -1.797776e+01 2.198619e+01 0.000000e+00\n            vertex -1.797776e+01 -2.198619e+01 0.000000e+00\n            vertex 1.797776e+01 2.198619e+01 0.000000e+00\n        endloop\n    endfacet\n    facet normal -0.000000e+00 0.000000e+00 1.000000e+00\n        outer loop\n            vertex 1.797776e+01 -2.198619e+01 0.000000e+00\n            vertex 1.797776e+01 2.198619e+01 0.000000e+00\n            vertex -1.797776e+01 -2.198619e+01 0.000000e+00\n        endloop\n    endfacet\nendsolid Object01\n</code></pre>\n\n<p>and what I am looking to do is extract the numbers following each \"vertex\" into an array of floats such that I have a unique array of floats representing the triangle that is each facet. i.e. here this would produce 2 3x3 arrays (in this instance the 0's are redundant but this won't always be the case for me with this problem).</p>\n\n<p>Anyone got any pointers on how to proceed?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1546428203, "post_id": 54005411, "comment_id": 94847495, "body": "&#39;AB+&#39; is not a string, it&#39;s supposed to be a character. If you want a string, use &quot;AB+2. But you are in C++, use string."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1546428327, "post_id": 54005411, "comment_id": 94847550, "body": "1) &quot;<i>i am confused whether i have to put &quot;A+&quot; or just &#39;A+&#39;.</i>&quot; If it&#39;s a single character - use single quotes, if it&#39;s a sequence of characters - use double quotes. Since <code>A+</code> is not a single character, the solution seems obvious. 2) &quot;<i>if i put &quot;A+&quot;, i get count as 0.</i>&quot; Then, there&#39;s problem in your algorithm, did you step through your code with a debugger?"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1546431843, "creation_date": 1546431843, "answer_id": 54006342, "question_id": 54005411, "link": "https://stackoverflow.com/questions/54005411/character-const-or-string-const/54006342#54006342", "title": "Character const or string const?", "body": "<p><code>'A+'</code> is a <em>multicharacter literal</em> in C++. It has an <code>int</code> type, but the value is <em>implementation-defined</em>, although <code>'A' * 256 + '+'</code> is common.</p>\n\n<p>As such they are rarely used.</p>\n\n<p>You want <code>\"A+\"</code>. That is a <code>const char[3]</code> type that <em>decays</em> to a <code>const char*</code> pointer which <code>strcmp</code> can use.</p>\n\n<p>Finally, you're using C++. Why not use <code>std::string</code> rather than those <code>char[]</code> types? Then you could write <code>b.retgroup() == \"A+\"</code> and so on rather than those <code>strcmp</code> calls. Or if you need to retain the <code>char[]</code> for some reason, you could use, from C++14 onwards, the flashy <em>Yoda-expression</em></p>\n\n<pre><code>\"A+\"s == b.retgroup()\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10857439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3eec60a341caf3711c6eec9c8db6364?s=128&d=identicon&r=PG&f=1", "display_name": "Cookie Policy", "link": "https://stackoverflow.com/users/10857439/cookie-policy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1546431843, "creation_date": 1546428095, "last_edit_date": 1546428624, "question_id": 54005411, "link": "https://stackoverflow.com/questions/54005411/character-const-or-string-const", "title": "Character const or string const?", "body": "<p>Here is a part of the code that seeks to display the names of people that have blood group as <code>a+</code> or <code>ab+</code>.</p>\n\n<pre><code>//class definition\nclass bloodbank\n{\n   int idno;\n   char doname[30];\n   char group[3];\n\n   //the function i am talking about   \n   void blood()\n   {\n       bloodbank b;\n       int count =0;\n       ifstream fin(\"donor.dat\",ios::binary);\n       if( (strcmp(b.retgroup(),'A+')==0) ||(strcmp(b.retgroup(),'AB+')==0 )   )\n       {\n           b.display();\n           count++;\n           fin.read((char*)&amp;b,sizeof(b));\n       }\n       fin.close();\n       cout&lt;&lt;\"No of records\"&lt;&lt;\" \"&lt;&lt;count;\n   }\n}\n</code></pre>\n\n<p>i am confused whether i have to put \"A+\" or just 'A+'.</p>\n\n<p>if i put \"A+\", i get count as 0.</p>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1546427600, "post_id": 54005218, "comment_id": 94847275, "body": "If you are on linux then <code>ulimit -s</code> will show you the maximum stack size you are allowed to use (in kb). On my machine this is 8Mb and so 1Mb limit seems weird. But YMMV."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1546427640, "post_id": 54005218, "comment_id": 94847295, "body": "&quot;<i>which is around 1MB.</i>&quot; Stack size, is, also, around several megabytes in size."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1546427968, "post_id": 54005218, "comment_id": 94847409, "body": "On a 64 bit platform that&#39;s going to be &quot;around&quot; 2MB. Now, what else is declared in auto storage that must&#39;ve pushed the grand total into several hundred megabyte range? Failure to provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> makes it impossible to have a complete analysis."}, {"owner": {"reputation": 478030, "user_id": 279627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2dceea858ad8f1577bec6ddaa0485d15?s=128&d=identicon&r=PG", "display_name": "Sven Marnach", "link": "https://stackoverflow.com/users/279627/sven-marnach"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1546428105, "post_id": 54005218, "comment_id": 94847456, "body": "@SamVarshavchik That&#39;s not true. For the vast majority of C compilers, the type <code>int</code> has 32 bits even on a 64-bit platform."}, {"owner": {"reputation": 205, "user_id": 9075869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PYf5dhD598g/AAAAAAAAAAI/AAAAAAAABG4/J7wDntGZj4A/photo.jpg?sz=128", "display_name": "Scruffy", "link": "https://stackoverflow.com/users/9075869/scruffy"}, "edited": false, "score": 0, "creation_date": 1546428337, "post_id": 54005218, "comment_id": 94847558, "body": "It takes 1MB when length is 5, and then it works. But when I increase it further it stops working. So yeah, I must be exceeding the stack, which I have just learned exists."}], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 9075869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PYf5dhD598g/AAAAAAAAAAI/AAAAAAAABG4/J7wDntGZj4A/photo.jpg?sz=128", "display_name": "Scruffy", "link": "https://stackoverflow.com/users/9075869/scruffy"}, "edited": false, "score": 0, "creation_date": 1546428918, "post_id": 54005237, "comment_id": 94847873, "body": "thanks for the suggestion. unfortunately can&#39;t use dynamic memory allocation either. I think I might be well over the 1MB if I&#39;m actually copying all of them over and over again. I thought this might happen."}, {"owner": {"reputation": 205, "user_id": 9075869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PYf5dhD598g/AAAAAAAAAAI/AAAAAAAABG4/J7wDntGZj4A/photo.jpg?sz=128", "display_name": "Scruffy", "link": "https://stackoverflow.com/users/9075869/scruffy"}, "edited": false, "score": 0, "creation_date": 1546447637, "post_id": 54005237, "comment_id": 94856882, "body": "unfortunately same problem occurs. I think it&#39;s simply because it so quickly spirals into massive size. I have 12 bytes in PLACE, So when I initialize a MAG, it needs space for 12 *  128 * 128 * number of racks.         I tried using pointers instead, but no luck either."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 1, "last_activity_date": 1546429326, "last_edit_date": 1546429326, "creation_date": 1546427381, "answer_id": 54005237, "question_id": 54005218, "link": "https://stackoverflow.com/questions/54005218/struct-consumes-too-much-memory/54005237#54005237", "title": "Struct consumes too much memory", "body": "<p>Yes, you run out of stack.</p>\n\n<p>This is especially the case because you are copying data from <code>place1</code> in <code>shelf1</code> and the same for all oothers, all that just for one element. Use a <code>std::vector</code> instead of static arrays.</p>\n\n<p>If you can't because it's an assignment, you can still use <code>new</code>/<code>delete</code> to use heap instead of stack.</p>\n\n<p>If not, cross your fingers, and try to use:</p>\n\n<pre><code>MAG mag1 = {1, {{3, {{2, {{1, {1,2}}}}}}}};\n</code></pre>\n\n<p>Ugly, and you don't know what objects you are populating, but should work on modern compilers.</p>\n"}, {"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1546427784, "post_id": 54005253, "comment_id": 94847343, "body": "Shame it&#39;s a school assignment and the OP is likely going to counter with the usual &quot;can&#39;t use the standard library&quot; that so many instructors impose for some daft reason. Oh well, +1."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1546427885, "post_id": 54005253, "comment_id": 94847384, "body": "AFAIK neither compiler nor architecture governs the stack size limit. It&#39;s OS dependent (and also customizable)."}, {"owner": {"reputation": 205, "user_id": 9075869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PYf5dhD598g/AAAAAAAAAAI/AAAAAAAABG4/J7wDntGZj4A/photo.jpg?sz=128", "display_name": "Scruffy", "link": "https://stackoverflow.com/users/9075869/scruffy"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1546428164, "post_id": 54005253, "comment_id": 94847484, "body": "As @StoryTeller guessed, I can&#39;t use anything other than arrays and array pointers. And the maximum number of racks is indeed 128 in the assignment. Furthermore, the maximum number of MAGs in the total inventory is also 128. And the testing computer&#39;s memory limit is specified as 1GB - though I don&#39;t know what that means in this case. Because clearly it&#39;s not stack size."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546428517, "post_id": 54005253, "comment_id": 94847657, "body": "Can you use new/delete at least?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1546428698, "post_id": 54005253, "comment_id": 94847746, "body": "@MatthieuBrucher: Yeah but then you have to worry about copying, assignment, and destruction. I don&#39;t know about you but I&#39;m too old for that."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546428931, "post_id": 54005253, "comment_id": 94847882, "body": "I think @MatthieuBrucher is (or should be) suggesting the workaround for &quot;don&#39;t use <code>std</code>&quot; of writing a <code>std::vector</code> approximation, and using that instead."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1546428984, "post_id": 54005253, "comment_id": 94847916, "body": "@Caleth: Then why not go the whole hog and implement the thing in BCPL? Who needs types beyond a machine word anyway?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1546429153, "post_id": 54005253, "comment_id": 94847989, "body": "Because it&#39;s a <i>workaround</i>, for the ridiculous requirement. If that requirement can be removed, you can drop the workaround"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546429393, "post_id": 54005253, "comment_id": 94848089, "body": "@Bathsheba yes, it was a <code>std::vector</code> that I suggested (and I hate <code>using namespace std</code>). The remark for new/delete was for OP, actually."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1546427437, "creation_date": 1546427437, "answer_id": 54005253, "question_id": 54005218, "link": "https://stackoverflow.com/questions/54005218/struct-consumes-too-much-memory/54005253#54005253", "title": "Struct consumes too much memory", "body": "<p>You are using a lot of <em>automatic storage duration</em> here. It's unlikely your compiler and architecture will permit any more than about 1Mb of such stuff.</p>\n\n<p>Fortunately, the solution is trivial.</p>\n\n<p>Use <code>std::vector</code> in place of the arrays: e.g.</p>\n\n<pre><code>struct MAG {\n    // int racksCount; no need for this if you use a std::vector\n    std::vector&lt;RACK&gt; racks;\n};\n</code></pre>\n\n<p>and so on. <code>std::vector</code> puts most of its payload in <em>dynamic memory</em> which is why this approach will work. There are other C++ standard library containers too, but a good rule of thumb is to use a <code>std::vector</code> unless you have a good reason not to.</p>\n"}], "owner": {"reputation": 205, "user_id": 9075869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PYf5dhD598g/AAAAAAAAAAI/AAAAAAAABG4/J7wDntGZj4A/photo.jpg?sz=128", "display_name": "Scruffy", "link": "https://stackoverflow.com/users/9075869/scruffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 54005253, "answer_count": 2, "score": 0, "last_activity_date": 1546591733, "creation_date": 1546427278, "last_edit_date": 1546591733, "question_id": 54005218, "link": "https://stackoverflow.com/questions/54005218/struct-consumes-too-much-memory", "title": "Struct consumes too much memory", "body": "<p>I'm doing a school assignment dealing with Structs in C++. The assignment does not allow the use of STL or <code>new</code>/<code>delete</code>.</p>\n\n<p>I'm representing items in a magazine.</p>\n\n<pre><code>struct PLACE {\n    int itemCount;\n    int etiquette[2];\n};\n\nstruct SHELF {\n    int placesCount;\n    PLACE places[128];\n};\n\nstruct RACK {\n    int shelvesCount;\n    SHELF shelves[128]; \n};\n\nstruct MAG {\n    int racksCount;\n    RACK racks[5];\n};\n</code></pre>\n\n<p>Now, when I run the following code, it works fine, but if I change the length of racks array to something like 20, I get a runtime error (code.exe has stopped working).</p>\n\n<pre><code>PLACE place1 = {1, {1,2}};\nSHELF shelf1 = {2, {place1}};   \nRACK rack1 = {3, {shelf1}};\nMAG mag1 = {1, {rack1}};\n</code></pre>\n\n<p>It seems that I'm exceeding some sort of memory? I would have thought that unlikely since when I calculated it, (when racks length is 5) I'm only using (((12 * 128) + 4) * 128 + 4) * 5 + 4 bytes, which is around 1MB.</p>\n\n<p><code>EDIT:</code></p>\n\n<p>I asked my instructor for some clarification on this. He told me that it's possible than my <em>heap</em> is exceeded, not <em>stack</em>, because: (quote) </p>\n\n<blockquote>\n  <p>Stack deals with function calls and stack exceeded could be caused by\n  for example recursion, while here we're dealing with large data, so\n  it's rather the heap being exceeded.</p>\n</blockquote>\n\n<p>He also told me that it's possible that my computer just has a lower limit (around 4MB), while the server that our code is being checked on has been allocated 1GB to handle this much data. </p>\n\n<p>Don't know if this is true though, because from what I read online, both stack and heap can be allocated variables and stack isn't reserved purely for function calls, but also for variables inside of these functions...</p>\n"}, {"tags": ["c++", "windows", "disk"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546432046, "post_id": 54005205, "comment_id": 94849199, "body": "<i>&quot;I do not want a solution like calling the diskpart commands in program.&quot;</i> Can I ask why not?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546432115, "post_id": 54005205, "comment_id": 94849232, "body": "Related:  <a href=\"https://stackoverflow.com/q/3879294/560648\">stackoverflow.com/q/3879294/560648</a>"}, {"owner": {"reputation": 113, "user_id": 9001283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MyH6tMA6zKo/AAAAAAAAAAI/AAAAAAAAAvM/c1XHO14_2u8/photo.jpg?sz=128", "display_name": "vagdevi pedalenka", "link": "https://stackoverflow.com/users/9001283/vagdevi-pedalenka"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1547038918, "post_id": 54005205, "comment_id": 95053644, "body": "@Lightness Races in Orbit, Thank yor for reply. There is no particular reason to not to use diskpart commands, seeking for suggestion like any other approach better than this is exists or not."}], "owner": {"reputation": 113, "user_id": 9001283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MyH6tMA6zKo/AAAAAAAAAAI/AAAAAAAAAvM/c1XHO14_2u8/photo.jpg?sz=128", "display_name": "vagdevi pedalenka", "link": "https://stackoverflow.com/users/9001283/vagdevi-pedalenka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546428167, "creation_date": 1546427218, "last_edit_date": 1546428167, "question_id": 54005205, "link": "https://stackoverflow.com/questions/54005205/is-there-any-way-to-set-the-disk-signature-programmatically-rather-than-disk-pa", "title": "Is there any way to set the disk signature programmatically, rather than disk part", "body": "<p>Creating an application where multiple disks with duplicate disk signatures will be present in the machine- to solve that one, I am making the duplicate disks as online, so that disk signature will change and will do some work.</p>\n\n<p>At the end I want a way set the disk signature of that duplicated disk to original disk signature after making the disk as offline.</p>\n\n<p>Disk part is working with below commands\nopened command prompt as a administrator, performed the below commands</p>\n\n<pre><code>&gt; diskpart \n\n&gt; select disk \n\n&gt; uniqueid disk id = xxxxxxxx\n</code></pre>\n\n<p>Disk signature changed successfully.</p>\n\n<p>I need a solution to change the disk signature programmatically.\nI do not want a solution like calling the diskpart commands in program.</p>\n"}, {"tags": ["c++", "c", "arm", "bare-metal", "newlib"], "comments": [{"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 0, "creation_date": 1546426814, "post_id": 54005091, "comment_id": 94846914, "body": "Dump the imports with <code>objdump</code>?"}, {"owner": {"reputation": 593, "user_id": 4599151, "user_type": "registered", "accept_rate": 6, "profile_image": "https://graph.facebook.com/1050011471682240/picture?type=large", "display_name": "Karolis Milie\u0161ka", "link": "https://stackoverflow.com/users/4599151/karolis-milie%c5%a1ka"}, "reply_to_user": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 0, "creation_date": 1546443441, "post_id": 54005091, "comment_id": 94854753, "body": "How to do that only for newlib&#39;s imports? I can dump all symbols, but not sure what you meant."}, {"owner": {"reputation": 3543, "user_id": 4017881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8b3f2a230655ae601b95f7e490d507?s=128&d=identicon&r=PG", "display_name": "Frant", "link": "https://stackoverflow.com/users/4017881/frant"}, "edited": false, "score": 0, "creation_date": 1546448380, "post_id": 54005091, "comment_id": 94857265, "body": "Are you using  existing, complete custom linker scripts, which should then already contain definitions for __init_array_start and friends, or working on creating such custom linker scripts from scratch? By the way, the following command should give you the default linker script used by your toolchain linker: arm-none-eabi-ld --verbose."}, {"owner": {"reputation": 593, "user_id": 4599151, "user_type": "registered", "accept_rate": 6, "profile_image": "https://graph.facebook.com/1050011471682240/picture?type=large", "display_name": "Karolis Milie\u0161ka", "link": "https://stackoverflow.com/users/4599151/karolis-milie%c5%a1ka"}, "edited": false, "score": 0, "creation_date": 1546849830, "post_id": 54005091, "comment_id": 94974340, "body": "I am building LD script from scratch. Also, I am interested in learning about newlib by learning what symbols it uses. I am switching form other toolchain so it is valuable information to me."}, {"owner": {"reputation": 3543, "user_id": 4017881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8b3f2a230655ae601b95f7e490d507?s=128&d=identicon&r=PG", "display_name": "Frant", "link": "https://stackoverflow.com/users/4017881/frant"}, "edited": false, "score": 0, "creation_date": 1547041582, "post_id": 54005091, "comment_id": 95055238, "body": "Run arm-none-eabi-ld --verbose then."}, {"owner": {"reputation": 3543, "user_id": 4017881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8b3f2a230655ae601b95f7e490d507?s=128&d=identicon&r=PG", "display_name": "Frant", "link": "https://stackoverflow.com/users/4017881/frant"}, "edited": false, "score": 0, "creation_date": 1550029440, "post_id": 54005091, "comment_id": 96115344, "body": "Did  running arm-none-eabi-ld --verbose help ?"}], "owner": {"reputation": 593, "user_id": 4599151, "user_type": "registered", "accept_rate": 6, "profile_image": "https://graph.facebook.com/1050011471682240/picture?type=large", "display_name": "Karolis Milie\u0161ka", "link": "https://stackoverflow.com/users/4599151/karolis-milie%c5%a1ka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546426632, "creation_date": 1546426632, "question_id": 54005091, "link": "https://stackoverflow.com/questions/54005091/symbols-required-by-newlib", "title": "Symbols required by newlib", "body": "<p>Can I find somewhere where all symbols required by (referenced by) <code>newlib</code> are listed? For example, I know <code>newlib</code> needs <code>end</code> or <code>__init_array_start(end)</code> symbols, but that comes from know-how, not from an official doc.</p>\n\n<p>I am an embedded software for ARM engineer and using custom linker scripts with arm-none-eabi GCC toolchain by ARM.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c++", "arrays", "char", "pass-by-reference", "pass-by-value"], "comments": [{"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 1, "creation_date": 1546424424, "post_id": 54004535, "comment_id": 94845842, "body": "<i>&quot;I believe that the character array is ...&quot;</i>. <i>Believing</i> is a dangerous thing. I would test anything first and be sure about it, then just go on belief."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 2, "creation_date": 1546424559, "post_id": 54004535, "comment_id": 94845896, "body": "You want to use <code>strncpy()</code> instead of <code>ch = sh;</code>."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546424576, "post_id": 54004535, "comment_id": 94845905, "body": "Changing the copy of the pointer in <code>StringReverse</code> doesn&#39;t change the pointer to a stack variable in another function. Even if it worked, you still want to use a local stack variable, which is a big &quot;no&quot;! Just use a string."}], "answers": [{"comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546425035, "post_id": 54004656, "comment_id": 94846099, "body": "OP should use <code>string</code> instead."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546425122, "post_id": 54004656, "comment_id": 94846141, "body": "@MatthieuBrucher, Indeed. The question is tagged <code>c++</code> but then again he is using <code>char arrays</code> and including the <code>cstring</code> header file. It is a bit of both worlds. :P"}, {"owner": {"reputation": 27, "user_id": 9732743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a674877e4fb4be411830402d7d53523f?s=128&d=identicon&r=PG", "display_name": "sparrow", "link": "https://stackoverflow.com/users/9732743/sparrow"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1546426894, "post_id": 54004656, "comment_id": 94846944, "body": "Yes. Using the strings would make it a lot easier I know. I am just clearing out my concepts :P @MatthieuBrucher"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 27, "user_id": 9732743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a674877e4fb4be411830402d7d53523f?s=128&d=identicon&r=PG", "display_name": "sparrow", "link": "https://stackoverflow.com/users/9732743/sparrow"}, "edited": false, "score": 1, "creation_date": 1546427016, "post_id": 54004656, "comment_id": 94847003, "body": "@sparrow <code>ch</code> is actually passed by value, i.e., you are passing a pointer by value (because array decay to pointers), so <code>ch</code> in <code>StringReverse</code> is actually a copy of the pointer <code>ch</code> in the <code>main</code> function. When you do <code>ch = sh</code>, you modify <code>ch</code>, the copy, and not the original <code>ch</code>. <code>strncpy</code> works on the &quot;pointed&quot; array, which is why it works because both the original and the copy points to the same array."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546427131, "post_id": 54004656, "comment_id": 94847049, "body": "@Holt, deleted my comment in deference to your explanation. I could not have explained it as good."}, {"owner": {"reputation": 27, "user_id": 9732743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a674877e4fb4be411830402d7d53523f?s=128&d=identicon&r=PG", "display_name": "sparrow", "link": "https://stackoverflow.com/users/9732743/sparrow"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546427332, "post_id": 54004656, "comment_id": 94847132, "body": "Thank you so much guys Joey and @Holt. The concept is now more clear to me. :)"}], "tags": [], "owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "is_accepted": true, "score": 0, "last_activity_date": 1546424762, "creation_date": 1546424762, "answer_id": 54004656, "question_id": 54004535, "link": "https://stackoverflow.com/questions/54004535/how-modify-character-arrays-inside-functions/54004656#54004656", "title": "How modify character arrays inside functions?", "body": "<p>You want to use <code>strncpy()</code> instead of <code>ch = sh;</code>. As other people have kindly pointed, you are not modifying <code>ch</code>. You are modifying the local variable <code>sh</code> only.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\nvoid StringReverse(char *ch, int size){\n    char sh[100] = {0};\n    for(int i=0 ; i&lt;size ; i++){\n        sh[i] = ch[size-1-i];\n    }\n    sh[size] = '\\0';\n    strncpy(ch, sh, 100);\n    cout&lt;&lt;ch&lt;&lt;endl;\n}\n\nint main(){\n    char ch[100];\n    cin.getline(ch, 100);\n    int size = strlen(ch);\n    StringReverse(ch,size);\n    cout&lt;&lt;ch;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546426875, "post_id": 54004764, "comment_id": 94846940, "body": "You can use <code>std::reverse</code> on a simple array, just use <code>ch</code> and <code>ch + size</code> for the iterator."}, {"owner": {"reputation": 27, "user_id": 9732743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a674877e4fb4be411830402d7d53523f?s=128&d=identicon&r=PG", "display_name": "sparrow", "link": "https://stackoverflow.com/users/9732743/sparrow"}, "edited": false, "score": 0, "creation_date": 1546427020, "post_id": 54004764, "comment_id": 94847004, "body": "That&#39;s a way better solution. Thanks :)"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 27, "user_id": 9732743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a674877e4fb4be411830402d7d53523f?s=128&d=identicon&r=PG", "display_name": "sparrow", "link": "https://stackoverflow.com/users/9732743/sparrow"}, "edited": false, "score": 0, "creation_date": 1546427414, "post_id": 54004764, "comment_id": 94847177, "body": "@sparrow If it&#39;s an exercise then you&#39;re probably expected to implement it rather than use  C++ standard library to do everything (so plain array is OK). But you could still go for a better algorithm."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1546425264, "creation_date": 1546425264, "answer_id": 54004764, "question_id": 54004535, "link": "https://stackoverflow.com/questions/54004535/how-modify-character-arrays-inside-functions/54004764#54004764", "title": "How modify character arrays inside functions?", "body": "<p>The <code>ch</code> in <code>StringReverse</code> function is local to that function. And that's why when assign <code>ch = sh;</code>, it doesn't change the <code>ch</code> in <code>main</code>.\nWhile you can copy <code>sh</code>, a better approach is to use reverse <em>in-place</em> so that you wouldn't need a local copy at all.</p>\n\n<p>For example:</p>\n\n<pre><code>void StringReverse(char *ch, int size){\n    for(int i = 0, j= size - 1 ; i &lt; j ; i++, j--){\n        int t = ch[i];\n        ch[i] = ch[j];\n        ch[j] = t;\n    }\n    cout &lt;&lt; ch &lt;&lt; endl;\n}\n</code></pre>\n\n<p>If you use <code>std::string</code> instead of a plain char array, it would be a lot easier to do this. You could for example use <a href=\"https://en.cppreference.com/w/cpp/algorithm/reverse\" rel=\"nofollow noreferrer\"><code>std::reverse</code></a>.</p>\n"}], "owner": {"reputation": 27, "user_id": 9732743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a674877e4fb4be411830402d7d53523f?s=128&d=identicon&r=PG", "display_name": "sparrow", "link": "https://stackoverflow.com/users/9732743/sparrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 54004656, "answer_count": 2, "score": 0, "last_activity_date": 1546426797, "creation_date": 1546424257, "last_edit_date": 1546426797, "question_id": 54004535, "link": "https://stackoverflow.com/questions/54004535/how-modify-character-arrays-inside-functions", "title": "How modify character arrays inside functions?", "body": "<p>I want to update a character array by reversing it. The character array is correct when output inside function, but not in <code>main</code> after the function is called.</p>\n\n<p>I believe that the character array is passed by reference, but when updating the array, the character array in the main function is not updated. What am I doing wrong here?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\nvoid StringReverse(char *ch, int size){\n    char sh[100] = {0};\n    for(int i=0 ; i&lt;size ; i++){\n        sh[i] = ch[size-1-i];\n    }\n    sh[size] = '\\0';\n    ch = sh;\n    cout&lt;&lt;ch&lt;&lt;endl;\n}\n\nint main(){\n    char ch[100];\n    cin.getline(ch, 100);\n    int size = strlen(ch);\n    StringReverse(ch,size);\n    cout&lt;&lt;ch;\n}\n</code></pre>\n\n<p>I do not want to print the result inside the function, but update the character array 'ch' in the <code>main</code> function by calling the function <code>StringReverse</code>.</p>\n"}, {"tags": ["c++", "intrinsics", "sse2"], "comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 1, "creation_date": 1546424303, "post_id": 54004452, "comment_id": 94845798, "body": "How often do you expect to apply this correction though, and how many two pis do you need to subtract when it does happen? Maybe compare and subtract is still the way to go. (Not that I know SSE2.)"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1546424957, "post_id": 54004452, "comment_id": 94846058, "body": "@Rup: can&#39;t know :) It depends how <code>phase</code> will grown up..."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1546425684, "post_id": 54004452, "comment_id": 94846374, "body": "OK looking more closely I can answer my own question: you&#39;re adding at most one pi per iteration, so you should only need to subtract one lot of two pi at most every other iteration. However as far as I can see, phase is not an input into the calculation step, it&#39;s just something you accumulate, so you may not even need to correct this inside the loop but instead could just do a single mod 2 pi at the end? Assuming I suppose the block size isn&#39;t so large that the total phase is much greater than 2pi and so you&#39;d lose precision by postponing the divide."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1546427476, "post_id": 54004452, "comment_id": 94847203, "body": "@Rup: <code>&#47;&#47; some other code</code> will use phase, that&#39;s why I would need to check it at every phase increment ;)"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 1, "creation_date": 1546427750, "post_id": 54004452, "comment_id": 94847331, "body": "Are you even sure auto-vectorization does not do it for you? Did you check generated code when you enable SSE2 on your original source (eg, with  <code>-msse2</code> on g++)?"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1546427876, "post_id": 54004452, "comment_id": 94847378, "body": "@spectras: I&#39;m using MSCV with all optimization enabled, but autovector there its terrible, and also I&#39;m learning vectorization ;)"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 3, "creation_date": 1546427913, "post_id": 54004452, "comment_id": 94847393, "body": "That <code>while</code> could be changed into an <code>if</code> because <code>phase</code> will never be more than 3pi at that point."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 3, "creation_date": 1546430753, "post_id": 54004452, "comment_id": 94848621, "body": "@markzzz I see. You can still use godbolt to check what gcc does and understand (and perhaps improve) upon it."}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1546440900, "post_id": 54006704, "comment_id": 94853446, "body": "my whole code above I think its totally wrong. <code>phase</code> is comulative for each step, instead I start with both value of <code>__m128d v_phase</code> with <code>_mm_set1_pd(phase);</code> (both equal, which is wrong)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1546441248, "post_id": 54006704, "comment_id": 94853647, "body": "@markzzz: sounds a lot like your previous questions, where you want to run a vector of sequential counters.  start with <code>phase</code> and <code>phase+step</code>, and increment by <code>set1(step*2)</code> each time.  If you don&#39;t have (or can factor out) a serial dependency between two vector elements, you&#39;re all set.  Of course, that makes the max increment 2*pi, I think, so you might need to set a tighter bound or have an alternate loop that repeats the conditional subtract in case it needs to be done multiple times.  (e.g. if you unroll even more so you can add up to <code>4*pi</code>)"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1546441378, "post_id": 54006704, "comment_id": 94853718, "body": "sure! The problem here is that <code>step</code> its not fixed, since it can vary on each iteration :O"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1546442366, "post_id": 54006704, "comment_id": 94854210, "body": "@markzzz:  ah right, I just looked at your code again.  It&#39;s not exactly a serial dependency, but stepping by 2 depends on both intervening elements.  You could calculate redundantly with overlapping unaligned loads, I think, and use  <code>pC[i+0]+pC[i+1]</code>  in one element and <code>pC[i+1] + </code>pC[i+2]` in another.  Same for <code>pB</code>.  (Your  formula,  <code>(mRadiansPerSample * bp0) * pB[i] + mRadiansPerSample * pC[i]</code> is linear, so I think adding the pC and pB inputs before multiplying will give the same result.)"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1546445424, "post_id": 54006704, "comment_id": 94855814, "body": "It will be somethings like this <code>phase[0] = (radbp * pB[0] + rad * pC[0]) phase[1] = (radbp * pB[1] + rad * pC[1]) + (radbp * pB[0] + rad * pC[0]) phase[2] = (radbp * pB[2] + rad * pC[2]) + (radbp * pB[1] + rad * pC[1]) phase[3] = (radbp * pB[3] + rad * pC[3]) + (radbp * pB[2] + rad * pC[2]) ...</code> I believe. But how can you add somethigs which is not aligned? I need to store each block to a single variable, can&#39;t store two different result at once...."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1546474886, "post_id": 54006704, "comment_id": 94866830, "body": "<i>But how can you add somethigs which is not aligned?</i> <code>_mm_load_pd(pC+i)</code> and <code>_mm_loadu_pd(pC + i+1)</code>."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1546514557, "post_id": 54006704, "comment_id": 94878591, "body": "I&#39;m opening a new question, I&#39;m tripping around it :)"}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1546437334, "last_edit_date": 1546437334, "creation_date": 1546433403, "answer_id": 54006704, "question_id": 54004452, "link": "https://stackoverflow.com/questions/54004452/using-with-sse2/54006704#54006704", "title": "Using % with SSE2?", "body": "<p>As comments are saying, it looks like in this you can make it just a masked subtract with a compare + <code>andpd</code>.  This works as long as you can never be more than one subtract away from getting back into the desired range.</p>\n\n<p>Like</p>\n\n<pre><code>const __m128d v2pi = _mm_set1_pd(TWOPI);\n\n\n__m128d needs_range_reduction = _mm_cmpge_pd(vphase, v2pi);\n__m128d offset = _mm_and_pd(needs_range_reduction, v2pi);  // 0.0 or 2*Pi\nvphase = _mm_sub_pd(vphase, offset);\n</code></pre>\n\n<hr>\n\n<p>To implement an actual (slow) <code>fmod</code> without worrying too much about the last few bits of the significand, you'd do <code>integer_quotient = floor(x/y)</code> (or maybe <code>rint(x/y)</code> or <code>ceil</code>), then <code>x - y * integer_quotient</code>.  <code>floor</code> / <code>rint</code> / <code>ceil</code> are cheap with SSE4.1 <code>_mm_round_pd</code> or <code>_mm_floor_pd()</code>.  That will give you the remainder, which can be negative just like with integer division.</p>\n\n<p>I'm sure there are numerical techniques that better avoid rounding error before the catastrophic cancellation from subtracting two nearby numbers.  If you care about precision, go check.  (Using <code>double</code> vectors when you don't care much about precision is kind of silly; might as well use <code>float</code> and get twice as much work done per vector).  If the input is a lot larger than the modulus, there's an unavoidable loss of precision, and minimizing rounding error in the temporary is probably very important.  But otherwise precision will only be a problem unless you care about relative error in results very close to zero when <code>x</code> is almost an exact multiple of <code>y</code>.  (Near-zero result, the only the bottom few bits of the significand are left for precision.)</p>\n\n<p>Without SSE4.1, there are tricks like adding then subtracting a large enough number.  Converting to integer and back is even worse for <code>pd</code>, because the packed-conversion instruction decodes to some shuffle uops as well.  Not to mention that a 32-bit integer doesn't cover the full range of <code>double</code>, but you're screwed for range-reduction precision if your input was that huge.</p>\n\n<p>If you have <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#techs=FMA&amp;expand=2504\" rel=\"nofollow noreferrer\">FMA</a>, you can avoid rounding error in the <code>y * integer_quotient</code> part of the multiply and sub.  <code>_mm_fmsub_pd</code>.</p>\n"}], "owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "accepted_answer_id": 54006704, "answer_count": 1, "score": 3, "last_activity_date": 1546437334, "creation_date": 1546423891, "last_edit_date": 1546427509, "question_id": 54004452, "link": "https://stackoverflow.com/questions/54004452/using-with-sse2", "title": "Using % with SSE2?", "body": "<p>Here's the code I'm trying to convert to SSE2:</p>\n\n<pre><code>double *pA = a;\ndouble *pB = b[voiceIndex];\ndouble *pC = c[voiceIndex];\ndouble *left = audioLeft;\ndouble *right = audioRight;\ndouble phase = 0.0;\ndouble bp0 = mNoteFrequency * mHostPitch;\n\nfor (int sampleIndex = 0; sampleIndex &lt; blockSize; sampleIndex++) {\n    // some other code (that will use phase)\n\n    phase += std::clamp(mRadiansPerSample * (bp0 * pB[sampleIndex] + pC[sampleIndex]), 0.0, PI);\n\n    while (phase &gt;= TWOPI) { phase -= TWOPI; }\n}\n</code></pre>\n\n<p>Here's what I've achieved:</p>\n\n<pre><code>double *pA = a;\ndouble *pB = b[voiceIndex];\ndouble *pC = c[voiceIndex];\ndouble *left = audioLeft;\ndouble *right = audioRight;\ndouble phase = 0.0;\ndouble bp0 = mNoteFrequency * mHostPitch;\n\n__m128d v_boundLower = _mm_set1_pd(0.0);\n__m128d v_boundUpper = _mm_set1_pd(PI);\n__m128d v_bp0 = _mm_set1_pd(bp0);\n__m128d v_radiansPerSample = _mm_set1_pd(mRadiansPerSample);\n\n__m128d v_phase = _mm_set1_pd(phase);\n__m128d v_pB = _mm_load_pd(pB);\n__m128d v_pC = _mm_load_pd(pC);\n__m128d v_result = _mm_mul_pd(v_bp0, v_pB);\nv_result = _mm_add_pd(v_result, v_pC);\nv_result = _mm_mul_pd(v_result, v_radiansPerSample);\nv_result = _mm_max_pd(v_result, v_boundLower);\nv_result = _mm_min_pd(v_result, v_boundUpper);\n\nfor (int sampleIndex = 0; sampleIndex &lt; roundintup8(blockSize); sampleIndex += 8, pB += 8, pC += 8) {\n    // some other code (that will use v_phase)\n\n    v_phase = _mm_add_pd(v_phase, v_result);\n\n    v_pB = _mm_load_pd(pB + 2);\n    v_pC = _mm_load_pd(pC + 2);\n    v_result = _mm_mul_pd(v_bp0, v_pB);\n    v_result = _mm_add_pd(v_result, v_pC);\n    v_result = _mm_mul_pd(v_result, v_radiansPerSample);\n    v_result = _mm_max_pd(v_result, v_boundLower);\n    v_result = _mm_min_pd(v_result, v_boundUpper);\n    v_phase = _mm_add_pd(v_phase, v_result);\n\n    v_pB = _mm_load_pd(pB + 4);\n    v_pC = _mm_load_pd(pC + 4);\n    v_result = _mm_mul_pd(v_bp0, v_pB);\n    v_result = _mm_add_pd(v_result, v_pC);\n    v_result = _mm_mul_pd(v_result, v_radiansPerSample);\n    v_result = _mm_max_pd(v_result, v_boundLower);\n    v_result = _mm_min_pd(v_result, v_boundUpper);\n    v_phase = _mm_add_pd(v_phase, v_result);\n\n    v_pB = _mm_load_pd(pB + 6);\n    v_pC = _mm_load_pd(pC + 6);\n    v_result = _mm_mul_pd(v_bp0, v_pB);\n    v_result = _mm_add_pd(v_result, v_pC);\n    v_result = _mm_mul_pd(v_result, v_radiansPerSample);\n    v_result = _mm_max_pd(v_result, v_boundLower);\n    v_result = _mm_min_pd(v_result, v_boundUpper);\n    v_phase = _mm_add_pd(v_phase, v_result);\n\n    v_pB = _mm_load_pd(pB + 8);\n    v_pC = _mm_load_pd(pC + 8);\n    v_result = _mm_mul_pd(v_bp0, v_pB);\n    v_result = _mm_add_pd(v_result, v_pC);\n    v_result = _mm_mul_pd(v_result, v_radiansPerSample);\n    v_result = _mm_max_pd(v_result, v_boundLower);\n    v_result = _mm_min_pd(v_result, v_boundUpper);\n\n    // ... fmod?\n}\n</code></pre>\n\n<p>But I'm not really sure how to replace <code>while (phase &gt;= TWOPI) { phase -= TWOPI; }</code> (which is basically a classic <code>fmod</code> in C++).</p>\n\n<p>Any fancy intrinsics? Can't find any on this <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#techs=SSE2\" rel=\"nofollow noreferrer\">list</a>.\nDivision + some sort of rocket bit-shifting?</p>\n"}, {"tags": ["c++", "c", "algorithm"], "comments": [{"owner": {"reputation": 463, "user_id": 6337519, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1CiVF.jpg?s=128&g=1", "display_name": "joH1", "link": "https://stackoverflow.com/users/6337519/joh1"}, "edited": false, "score": 0, "creation_date": 1546423913, "post_id": 54004394, "comment_id": 94845618, "body": "If you&#39;re asking for help and tips on improving your code, I suggest you go to (codereview.stackexchange.com)[codereview.stackexchange.com]&zwnj;&#8203;. Otherwise can you maker it clearer what your question is about?"}, {"owner": {"reputation": 147, "user_id": 9780666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d91c926014d5a7c93eb7e07f6a4776?s=128&d=identicon&r=PG&f=1", "display_name": "Giorgi Lagidze", "link": "https://stackoverflow.com/users/9780666/giorgi-lagidze"}, "reply_to_user": {"reputation": 463, "user_id": 6337519, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1CiVF.jpg?s=128&g=1", "display_name": "joH1", "link": "https://stackoverflow.com/users/6337519/joh1"}, "edited": false, "score": 0, "creation_date": 1546424064, "post_id": 54004394, "comment_id": 94845694, "body": "<a href=\"http://cs-fundamentals.com/tech-interview/c/c-program-to-count-number-of-ones-in-unsigned-integer.php\" rel=\"nofollow noreferrer\">cs-fundamentals.com/tech-interview/c/&hellip;</a> look for divide and conquer strategy algorithm. It counds the bits for unsigned integer. I need the same thing for unsigned long long."}, {"owner": {"reputation": 463, "user_id": 6337519, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1CiVF.jpg?s=128&g=1", "display_name": "joH1", "link": "https://stackoverflow.com/users/6337519/joh1"}, "edited": false, "score": 0, "creation_date": 1546424634, "post_id": 54004394, "comment_id": 94845933, "body": "You can always adapt the given solution to your needs. In this case you&#39;ll need to change the constants: for example <code>0x55555555</code>will become <code>0x5555555555555555</code> if your <code>long long</code> is 64 bits."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 9780666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d91c926014d5a7c93eb7e07f6a4776?s=128&d=identicon&r=PG&f=1", "display_name": "Giorgi Lagidze", "link": "https://stackoverflow.com/users/9780666/giorgi-lagidze"}, "edited": false, "score": 0, "creation_date": 1546423901, "post_id": 54004442, "comment_id": 94845615, "body": "but i still need the first while loop right? is it possible not to use any loop?"}, {"owner": {"reputation": 20484, "user_id": 521776, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/60dd3c3417791c535860abc76ec01f28?s=128&d=identicon&r=PG", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/521776/blackbear"}, "reply_to_user": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1546428874, "post_id": 54004442, "comment_id": 94847846, "body": "@ntshetty yes, for example with n=5 you are considering the numbers between 0 and 32=2^5"}], "tags": [], "owner": {"reputation": 20484, "user_id": 521776, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/60dd3c3417791c535860abc76ec01f28?s=128&d=identicon&r=PG", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/521776/blackbear"}, "is_accepted": false, "score": 2, "last_activity_date": 1546425109, "last_edit_date": 1546425109, "creation_date": 1546423851, "answer_id": 54004442, "question_id": 54004394, "link": "https://stackoverflow.com/questions/54004394/how-to-count-only-1bits-in-binary-representation-of-number-without-loop/54004442#54004442", "title": "how to count only 1bits in binary representation of number without loop", "body": "<p>Look at the bit patterns for the numbers between 0 and <code>2^3</code></p>\n\n<pre><code>000\n001\n010\n011\n100\n101\n110\n111\n</code></pre>\n\n<p>What do you see?</p>\n\n<p>Every bit is one 4 times.</p>\n\n<p>If you generalize, you find that the numbers between 0 and <code>2^n</code> have <code>n*2^(n-1)</code> bits set in total.</p>\n\n<p>I am sure you can extend this reasoning for arbitrary bounds.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1546424594, "creation_date": 1546424594, "answer_id": 54004616, "question_id": 54004394, "link": "https://stackoverflow.com/questions/54004394/how-to-count-only-1bits-in-binary-representation-of-number-without-loop/54004616#54004616", "title": "how to count only 1bits in binary representation of number without loop", "body": "<p>Here's how I do it for a 32 bit number.</p>\n\n<pre><code>std::uint16_t bitcount(\n    std::uint32_t n\n)\n{\n    register std::uint16_t reg;\n    reg = n - ((n &gt;&gt; 1) &amp; 033333333333)\n            - ((n &gt;&gt; 2) &amp; 011111111111);\n    return ((reg + (reg &gt;&gt; 3)) &amp; 030707070707) % 63;\n}\n</code></pre>\n\n<p>And the supporting comments from the program:</p>\n\n<p>Consider a 3 bit number as being 4a + 2b + c. If we shift it right 1 bit, we have 2a + b. Subtracting this from the original gives 2a + b + c. If we right-shift the original 3-bit number by two bits, we get a, and so with another subtraction we have a + b + c, which is the number of bits in the original number.</p>\n\n<p>The first assignment statement in the routine computes 'reg'. Each digit in the octal representation is simply the number of 1\u2019s in the corresponding three bit positions in 'n'.</p>\n\n<p>The last return statement sums these octal digits to produce the final answer. The key idea is to add adjacent pairs of octal digits together and then compute the remainder modulus 63.</p>\n\n<p>This is accomplished by right-shifting 'reg' by three bits, adding it to 'reg' itself and ANDing with a suitable mask. This yields a number in which groups of six adjacent bits (starting from the LSB) contain the number of 1\u2019s among those six positions in n. This number modulo 63 yields the final answer. For 64-bit numbers, we would have to add triples of octal digits and use modulus 1023.</p>\n"}], "owner": {"reputation": 147, "user_id": 9780666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d91c926014d5a7c93eb7e07f6a4776?s=128&d=identicon&r=PG&f=1", "display_name": "Giorgi Lagidze", "link": "https://stackoverflow.com/users/9780666/giorgi-lagidze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1546425109, "creation_date": 1546423618, "question_id": 54004394, "link": "https://stackoverflow.com/questions/54004394/how-to-count-only-1bits-in-binary-representation-of-number-without-loop", "title": "how to count only 1bits in binary representation of number without loop", "body": "<p>Suppose I have two numbers(minimum and maximum) . `</p>\n\n<blockquote>\n  <p>for example (0 and 9999999999)</p>\n</blockquote>\n\n<p>maximum could be so huge. now I also have some other number. it could be between those minimum and maximum number. <code>Let's say 15</code>. now What I need to do is get all the multiples of <code>15(15,30,45 and so on, until it reaches the maximum number)</code>. and for each these numbers, I have to count how many 1 bits there are in their binary representations. <code>for example, 15 has 4(because it has only 4 1bits).</code></p>\n\n<p>The problem is, I need a loop in a loop to get the result. first loop is to get all multiples of that specific number(in our example it was 15) and then for each multiple, i need another loop to count only 1bits. My solution takes so much time. Here is how I do it.</p>\n\n<pre><code>unsigned long long int min = 0;\n    unsigned long long int max = 99999999;\n    unsigned long long int other_num = 15; \n    unsigned long long int count = 0;\n\n    unsigned long long int other_num_helper = other_num;\n    while(true){\n        if(other_num_helper &gt; max) break;\n        for(int i=0;i&lt;sizeof(int)*4;i++){\n            int buff = other_num_helper &amp; 1&lt;&lt;i;\n            if(buff != 0) count++; //if bit is not 0 and is anything else, then it's 1bits.\n        }\n\n        other_num_helper+=other_num;\n\n    }\n    cout&lt;&lt;count&lt;&lt;endl;\n</code></pre>\n"}, {"tags": ["c++", "concurrency", "linked-list", "atomic", "lock-free"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1546426426, "post_id": 54004268, "comment_id": 94846724, "body": "<code>but it will never remove a node that is right after the head node</code> - and if it is the only node in the list?"}, {"owner": {"reputation": 1101, "user_id": 4254425, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/232cb0401b3c3e7b28959cf0606742c5?s=128&d=identicon&r=PG", "display_name": "Viacheslav Kroilov", "link": "https://stackoverflow.com/users/4254425/viacheslav-kroilov"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1546428198, "post_id": 54004268, "comment_id": 94847494, "body": "There&#39;s also a dummy tail node, so this is not an issue"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1546441004, "post_id": 54004268, "comment_id": 94853493, "body": "<i>I expect that the check <code>node-&gt;prev == &amp;head</code> prevents this case. Is it true?</i>  Oh, yeah I think so.  The not-yet-modified elements all have their <code>prev</code> pointer pointing at <code>head</code>.  That means <code>remove</code> fails for partially-inserted elements, and we&#39;re definitely limited to only ever inserting at the head.  (Otherwise we lose that way of avoiding pending modifications.)"}], "answers": [{"comments": [{"owner": {"reputation": 1101, "user_id": 4254425, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/232cb0401b3c3e7b28959cf0606742c5?s=128&d=identicon&r=PG", "display_name": "Viacheslav Kroilov", "link": "https://stackoverflow.com/users/4254425/viacheslav-kroilov"}, "edited": false, "score": 0, "creation_date": 1546440847, "post_id": 54006196, "comment_id": 94853423, "body": "First of all, thank you for your valuable time to write such a great answer. I&#39;ve clarified some points regarding the removal. Can you assert that with these rules the removal is harmless?"}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1546431290, "creation_date": 1546431290, "answer_id": 54006196, "question_id": 54004268, "link": "https://stackoverflow.com/questions/54004268/is-this-lock-free-dlist-insertion-is-safe/54006196#54006196", "title": "Is this lock-free dlist insertion is safe?", "body": "<p><strong>TL:DR</strong>: inserts alone are sort of ok depending on what readers do (no long-term corruption), but removals are probably impossible without locking or much more sophistication, and definitely a showstopper for this simple insert algorithm.</p>\n\n<hr>\n\n<p>It's a double-linked list, so <strong>an insert unavoidably requires modifying <em>two</em> memory locations that other threads can already see: <code>head.next</code>, and the <code>.prev</code> pointer in the old first node.</strong>  This can't be done atomically+locklessly unless the hardware has a <a href=\"https://en.wikipedia.org/wiki/Double_compare-and-swap\" rel=\"nofollow noreferrer\">DCAS (double-CAS, two separate non-contiguous locations at once)</a>.  As the wikipedia article says, it makes lockless double-linked lists easy.</p>\n\n<p>m68k had DCAS at one point, but no current mainstream CPU architecture has it.  ISO C++11 doesn't expose a DCAS operation through <code>std::atomic</code> because you can't emulate it on HW that doesn't have it without making all <code>atomic&lt;T&gt;</code> non-lock-free.  Except on hardware with transactional memory, available on some recent x86 CPUs from Intel (e.g. Broadwell and later), but not AMD.  There has been some work on adding syntax for TM to C++, see <a href=\"https://en.cppreference.com/w/cpp/language/transactional_memory\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/transactional_memory</a></p>\n\n<hr>\n\n<p><strong>Of course, it's also impossible for an observe to observe two locations at once, atomically, without transactional memory or something like DCAS.</strong>  So any threads that read the list need to expect it to be changing out from under them, especially if the list is also supposed to support removals.</p>\n\n<p>Setting up the pointers within the new nodes (not yet published to other threads) before publishing is obviously good, and you're doing that.  <code>first-&gt;prev</code> and <code>last-&gt;next</code> are both set correctly before a CAS attempt to publish these new nodes.  The CAS has sequential-consistency memory ordering, so it makes sure those previous stores are visible to other threads before it itself is.  (So those \"private\" stores might as well be std::memory_order_relaxed for efficiency).</p>\n\n<p>Your choice of modifying the old-first's <code>.prev</code> pointer <em>after</em> modifying <code>head</code> makes a lot of sense.  You're essentially publishing first in the forward direction, then in the reverse direction.  <strong>But remember that it's possible for a thread to sleep for a long time at <em>any</em> point, so it's not 100% safe to assume this will always be a momentary inconsistency.</strong>  Imagine stopping one thread in the debugger at any point inside this function, and even single-stepping, while other threads run.  In this case there are only 2 interesting operations, the CAS and the unconditional store to the old first non-dummy node.</p>\n\n<p>If a thread was traversing forward and depending on being able to go back by following a <code>.prev</code> (instead of remembering its own previous in a local variable), this might look to it like the new nodes had been deleted again.  It can find a <code>.prev</code> pointing to <code>head</code>.  This is a contrived example because it would normally be more efficient to simply remember your previous node if you want to be able to find it again, especially in a lockless list.  But perhaps there are non-contrived cases, like maybe one thread traversing forward and another traversing backward, and maybe interacting directly or indirectly, where an inconsistency would be visible.</p>\n\n<hr>\n\n<p><strong>As long as all threads agree on which order to modify things, I think insertion itself is safe</strong>.  Doing it only at the head makes it easier to verify, but I think allowing arbitrary insertion points is still safe.</p>\n\n<p>Your current code looks safe for simultaneous insertions (assuming no removals).  The forward list can be longer than the backward list (with potentially multiple insertions into the backward list outstanding), but once they all complete the list will be consistent.</p>\n\n<p>Without removal, each pending write to a <code>.prev</code> has a valid destination, and that destination is a node that no other thread wants to write to.  <strong>lockless singly-linked list insertion is easy, and the forward list (the <code>.next</code> links) are always up to date.</strong></p>\n\n<p><strong>So each insert operation \"claims\" a node that it use as the insertion point into the reverse list, when its store to <code>current_next-&gt;prev</code> becomes visible.</strong></p>\n\n<hr>\n\n<p>A <code>do{}while(!CAS())</code> loop is a nice idiom, usually simplifying the code.  I weakened the memory-ordering of the other operations, especially the private ones on first and last, because requiring the compiler to use slow barriers after stores to elements other threads can't see yet is inefficient.  On x86, release-stores are \"free\" (no extra barriers), while seq-cst stores are a lost more expensive.  (A seq-cst store on x86 has about the same cost as an atomic read-modify-write, in the uncontended case).</p>\n\n<pre><code>// no change in logic to yours, just minimize memory ordering\n// and simplify the loop structure.\nvoid insertSublist(Node* first, Node* last)\n{\n  first-&gt;prev.store(&amp;head, std::memory_order_relaxed);\n  Node* current_next = head.next.load(std::memory_order_relaxed);\n\n  do {\n    // current_next set ahead of first iter, and updated on CAS failure\n    last-&gt;next.store(current_next, std::memory_order_relaxed);\n  }while (!head.next.compare_exchange_weak(current_next, first));\n   // acq_rel CAS should work, but leave it as seq_cst just to be sure.  No slower on x86\n\n  current_next-&gt;prev.store(last, std::memory_order_release);  // not visible before CAS\n}\n</code></pre>\n\n<p>This compiles for x86 with zero <code>mfence</code> instructions instead of 3 for yours, <a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Catomic%3E%0Astruct+Node+%7B%0A++std::atomic%3CNode*%3E+next%3B%0A++std::atomic%3CNode*%3E+prev%3B%0A%7D%3B%0ANode+head%3B%0A%0A//+concurrently+insert+%60first%60..%60last%60+sublist+after+%60head%60%0Avoid+insertSublist(Node*+first,+Node*+last)+%7B%0A++first-%3Eprev+%3D+%26head%3B%0A++Node*+current_next+%3D+head.next%3B%0A%0A++while+(true)+%7B%0A++++last-%3Enext+%3D+current_next%3B%0A++++if+(head.next.compare_exchange_weak(current_next,+first))+%7B%0A++++++current_next-%3Eprev+%3D+last%3B%0A++++++return%3B%0A++++%7D%0A++%7D%0A%7D%0A%0A//+no+change+in+logic+to+yours,+just+minimize+memory+ordering%0A//+and+simplify+the+loop+structure.%0Avoid+insertSublist_effiicent(Node*+first,+Node*+last)%0A%7B%0A++first-%3Eprev.store(%26head,+std::memory_order_relaxed)%3B%0A++Node*+current_next+%3D+head.next.load(std::memory_order_relaxed)%3B%0A%0A++do+%7B%0A++++//+current_next+set+ahead+of+first+iter,+and+updated+on+CAS+failure%0A++++last-%3Enext.store(current_next,+std::memory_order_relaxed)%3B%0A++%7Dwhile+(!!head.next.compare_exchange_weak(current_next,+first))%3B%0A+++//+acq_rel+CAS+should+work,+but+leave+it+as+seq_cst+just+to+be+sure.++No+slower+on+x86%0A%0A++current_next-%3Eprev.store(last,+std::memory_order_release)%3B++//+not+visible+before+CAS%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:46.85976122070636,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((g:!((h:compiler,i:(compiler:g82,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3+-fverbose-asm+-Wall&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+8.2+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),k:53.140238779293654,l:&#39;4&#39;,m:65.7,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:output,i:(compiler:1,editor:1,wrap:&#39;1&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;%231+with+x86-64+gcc+8.2&#39;,t:&#39;0&#39;)),header:(),l:&#39;4&#39;,m:34.3,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:53.140238779293654,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">on the Godbolt compiler explorer</a>.  (The rest of the asm is literally identical, including the one <code>lock cmpxchg</code>.)  So in the uncontended no-RFO case (e.g. repeated insertions from the same core), it might be something like 4x faster.  Or better because <code>mfence</code> is actually even slower than a <code>lock</code> prefix on Intel CPUs.</p>\n\n<p>Plus, the <code>do{}while(!CAS)</code> with the final store fully outside the loop is arguably easier for humans to read and see the logic right away.</p>\n\n<hr>\n\n<h3>Removals are a massive complication</h3>\n\n<p>I don't see how you could safely remove while you have pending insertions.  If you remove a node that an inserter was going to modify (to add the backward link) but hasn't yet, that range of nodes will be forever missing from the backward list.</p>\n\n<p>(Plus if you recycle the memory for that Node, the store by the inserter then steps on something.)</p>\n\n<p>It will make the forward and backward lists out of sync.  <strong>I don't see a way to solve this without DCAS (or transactional memory, which is a superset of DCAS).  I'm not a lockless dlist expert, though, so maybe there's a trick.</strong></p>\n\n<p>Probably even multiple simultaneous removers is a problem, because you can end up with pending modifications to a node that another thread is going to (or already has) removed.  Or multiple pending modifications to one node, with no way to make sure that the right one finishes last.</p>\n\n<p><strong>If you had an inserters/removers lock (multiple inserters / single remover, exactly like a readers/writer lock), you could make sure there were no pending inserts when doing a removal.</strong>  But still allow lockless inserts.  Maybe put the lock in the same cache line as <code>head</code>, because inserting threads will always need to modify both it and <code>head</code>.  Or maybe not because you might just end up with more contention for that line if cores sometimes lose ownership of the line after taking the lock but before committing their modification to <code>head</code>.</p>\n"}], "owner": {"reputation": 1101, "user_id": 4254425, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/232cb0401b3c3e7b28959cf0606742c5?s=128&d=identicon&r=PG", "display_name": "Viacheslav Kroilov", "link": "https://stackoverflow.com/users/4254425/viacheslav-kroilov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 54006196, "answer_count": 1, "score": 3, "last_activity_date": 1546440694, "creation_date": 1546422988, "last_edit_date": 1546440694, "question_id": 54004268, "link": "https://stackoverflow.com/questions/54004268/is-this-lock-free-dlist-insertion-is-safe", "title": "Is this lock-free dlist insertion is safe?", "body": "<p>I need to implement a lock-free insertion of a sub-list in the head of a doubly-linked list. This list has a dummy head, so each thread tries to insert its part right after the head node. This design seems OK for me, however, I don't have enough expertise to prove it.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct Node {\n  std::atomic&lt;Node*&gt; next;\n  std::atomic&lt;Node*&gt; prev;\n};\nNode head;\n\n// concurrently insert `first`..`last` sublist after `head`\nvoid insertSublist(Node* first, Node* last) {\n  first-&gt;prev = &amp;head;\n  Node* current_next = head.next;\n\n  while (true) {\n    last-&gt;next = current_next;\n    if (head.next.compare_exchange_weak(current_next, first)) {\n      current_next-&gt;prev = last;\n      return;\n    }\n  }\n}\n</code></pre>\n\n<p>I need to validate this design under these circumstances:</p>\n\n<h2>Variant 1</h2>\n\n<p>No list removal is performed, all threads just do insertion in a loop.</p>\n\n<h2>Variant 2</h2>\n\n<p>There is 1 thread, that removes nodes from the list in random order, but it will never remove a node that is right after the head node.</p>\n\n<pre><code>for (auto* node : nodes_to_be_removed) {\n  if (node-&gt;prev == &amp;head)\n    continue;\n  // perform removal \n}\n</code></pre>\n\n<p>When insertion is done, <code>node-&gt;prev</code> is the last link that is changed. So after it is changed, no other thread (except remover) can access the node or its preceding node <code>next</code> link.\nIs this reasoning valid or I am missing something?</p>\n\n<hr>\n\n<h2>Some clarifications after @peter-cordes answer.</h2>\n\n<ul>\n<li>The list is not linearly traversable, so inconsistent list state is not an issue from this point of view.</li>\n<li><blockquote>\n  <p>If you remove a node that an inserter was going to modify (to add the backward link) but hasn't yet</p>\n</blockquote>\n\n<p>I expect that the check <code>node-&gt;prev == &amp;head</code> prevents this case. <em>Is it true?</em></p></li>\n<li>Are removals safe under these conditions?\n\n<ul>\n<li>There is only 1 remover thread</li>\n<li>Remover has a separate worklist of nodes for deletion</li>\n<li>A node can be added to the worklist only after its insertion stage is completely finished</li>\n</ul></li>\n</ul>\n"}, {"tags": ["c++", "queue", "mutex", "deadlock", "qnx"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1546424839, "post_id": 54004239, "comment_id": 94845996, "body": "We need to see any code that touches the queue, mutex, or condvar. Also, if it&#39;s safe to call <code>writeQueue.empty</code> without the mutex, what does the mutex protect exactly?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1546425828, "post_id": 54004239, "comment_id": 94846440, "body": "I have added an other relevant function. Only the empty() function was called without the mutex lock. The thought was that it wasn&#39;t worth it to make the other higher prio threads wait in the &quot;add&quot; function even when the queue was empty. It doesn&#39;t really matter if the queue is deemed empty when an entry is getting written since the log writing operation is of low priority and can wait a few milliseconds."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1546426310, "post_id": 54004239, "comment_id": 94846661, "body": "What type is <code>writeQueue</code>? If it&#39;s a <code>std::queue</code>, you <i>can&#39;t</i> call <code>empty</code> without the mutex. The results of doing so are unpredictable and corruption could result. Also, when <code>run</code> calls <code>condVarTraceWriter.wait()</code>, what exactly is it waiting for and how does it know that what it&#39;s waiting for hasn&#39;t already happened? Can you paste the code for the wrapper? Where exactly did the segfault happen?"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1546426447, "post_id": 54004239, "comment_id": 94846736, "body": "You need to provide the relevant code for the types associated with <code>writeQueueMutex</code> and <code>writeQueue</code>.  Also, you state <code>&quot;The wrapper we have around pthread_mutex_lock tries to acquire the lock for around 10 times before it gives up&quot;</code> -- what do you mean by &quot;gives up&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1546427188, "post_id": 54004239, "comment_id": 94847071, "body": "@DavidSchwartz, yes it is a std::queue i will see if i can enclose the empty() function within the mutex. Thanks for that. If you see there is a call to condVarTraceWriter.post() which specifies when to stop waiting. I have pasted the wrapper function code. Unfortunately, even multiple core dump analysis did not specify any consistent line where the seg fault occured. The common factor was that it happened very soon after the deadlock errors occured."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1546427259, "post_id": 54004239, "comment_id": 94847100, "body": "@G.M. I have added the relevant wrapper code which should answer your question"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1546428135, "post_id": 54004239, "comment_id": 94847470, "body": "@DavidSchwartz and the deadlock error occurs at the beginning of add function. I have added comments there."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 1, "creation_date": 1546428956, "post_id": 54004239, "comment_id": 94847901, "body": "You never check the value returned by <code>wrapperMutex::lock</code> so it&#39;s quite possible you&#39;re accessing a non-threadsafe queue <i>without</i> the lock in place.  Also, what type of mutex is <code>tMutex</code> -- normal, recursive, something else?  If it&#39;s a normal pthread mutex then a deadlock might suggest a thread is trying to relock a mutex that it already owns."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1546429634, "post_id": 54004239, "comment_id": 94848174, "body": "@DavidSchwartz can you please elaborate on that. Right now, I wait when the queue is empty and notify when something populates in it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "edited": false, "score": 0, "creation_date": 1546429919, "post_id": 54004239, "comment_id": 94848273, "body": "@G.M.I will have to check more on your first point but it makes sense. and yes, it is a normal pthread mutex. But in my case, I am not sure why/how a thread is trying to relock a mutex it already owns."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1546431885, "post_id": 54004239, "comment_id": 94849101, "body": "@AbhilashAnand You wait if the queue <i>was</i> empty. Not if the queue <i>is</i> empty. Your <code>run</code> function does not hold the mutex all the way from testing the queue to deciding to wait! (After <code>fetchNext</code> releases the mutex, you call <code>wait</code>, having no idea if the queue is still empty or if the add has already happened.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1546494079, "post_id": 54004239, "comment_id": 94870389, "body": "@DavidSchwartz. Apologies for the delayed response. So, do you recommend acquiring the mutex before the call to &quot;fetchNext&quot; and releasing it after the condvar wait()? Do you think this has any relation with the deadlock errors?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1546495380, "post_id": 54004239, "comment_id": 94870741, "body": "@AbhilashAnand The whole point of a condition variable is to provide an atomic &quot;unlock and wait&quot; function so that you don&#39;t wait for something that has already happened. Misusing a condition variable will definitely lead to deadlock. Maybe you didn&#39;t really want a condition variable though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "edited": false, "score": 0, "creation_date": 1546836683, "post_id": 54004239, "comment_id": 94970366, "body": "The deadlock issue disappeared after I removed the condition if ( wasEmpty ) around the condvar.post(). No segmentation fault. That&#39;s good news. Thanks both. But it still happens to be crashing without a memory fault. Seems like an other issue."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "edited": false, "score": 0, "creation_date": 1546836942, "post_id": 54004239, "comment_id": 94970431, "body": "@G.M.This is the comment against &quot;lock&quot; function in wrapperMutex &quot;<b>This method locks a mutex. If the mutex is already locked the calling thread is blocked.</b>&quot;. So, in this case where the calling thread is blocked if the mutex is not obtained, is there still a possibility where the non thread safe queue is accessed in this scenario."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1546956044, "post_id": 54004239, "comment_id": 95018748, "body": "@G.M. Any comments on the above query? Apologies on the repeated question."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1546957585, "post_id": 54004239, "comment_id": 95019695, "body": "Well, in <code>CTraceFileWriterThread::fetchNext</code> you still have <code>if (!writeQueue.empty())</code> without having first acquired the mutex."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "edited": false, "score": 0, "creation_date": 1546966587, "post_id": 54004239, "comment_id": 95025224, "body": "Yes. Apart from that, just confirming about accessing the queue when the lock is not obtained. You informed that I might be accessing the queue when the lock may not really be obtained. But the calling thread is blocked when the lock is not obtained. Do you think it is still an issue?"}], "owner": {"user_type": "does_not_exist", "display_name": "user8244274"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546931496, "creation_date": 1546422877, "last_edit_date": 1546931496, "question_id": 54004239, "link": "https://stackoverflow.com/questions/54004239/qnx-pthread-mutex-lock-causing-deadlock-error-45-edeadlk", "title": "QNX pthread_mutex_lock causing deadlock error ( 45 = EDEADLK )", "body": "<p>I am implementing an asynchronous log writing mechanism for my project's multithreaded application. Below is the partial code of the part  where the error occurs.</p>\n\n<pre><code>void CTraceFileWriterThread::run() \n{\n    bool fShoudIRun = shouldThreadsRun();  //  Some global function which decided if operations need to stop. Not really relevant here. Assume \"true\" value.\n\n    while(fShoudIRun)\n    {\n      std::string nextMessage = fetchNext();\n      if( !nextMessage.empty() )\n      {\n          process(nextMessage);\n      }\n      else\n      {\n          fShoudIRun = shouldThreadsRun();\n          condVarTraceWriter.wait();\n      }\n    }\n }\n\n//This is the consumer. This is in my thread with lower priority\nstd::string CTraceFileWriterThread::fetchNext() \n{\n    // When there are a lot of logs, I mean A LOT, I believe the \n    // control stays in this function for a long time and an other \n    // thread calling the \"add\" function is not able to acquire the lock\n    // since its held here.\n\n    std::string message;\n\n    if( !writeQueue.empty() )\n    {\n      writeQueueMutex.lock();        // Obj of our wrapper around pthread_mutex_lock \n      message = writeQueue.front();  \n      writeQueue.pop();              // std::queue\n      writeQueueMutex.unLock() ;\n    }\n    return message;\n}\n\n\n\n\n//  This is the producer and is called from multiple threads.\nvoid CTraceFileWriterThread::add( std::string outputString ) {\n\nif ( !outputString.empty() )\n{\n    // crashes here while trying to acquire the lock when there are lots of\n    // logs in prod systems.\n\n    writeQueueMutex.lock();\n    const size_t writeQueueSize = writeQueue.size();\n\n    if ( writeQueueSize == maximumWriteQueueCapacity )\n    {\n        outputString.append (\"\\n queue full, discarding traces, traces are incomplete\" );\n    }\n\n    if ( writeQueueSize &lt;= maximumWriteQueueCapacity )\n    {\n        bool wasEmpty = writeQueue.empty();\n        writeQueue.push(outputString);\n\n\n\n        condVarTraceWriter.post(); // will be waiting in a function which calls \"fetchNext\"\n\n    }\n    writeQueueMutex.unLock();\n\n}\n\n\nint wrapperMutex::lock() {\n//#[ operation lock()\n\n int iRetval;\n int iRetry = 10;\n\n do\n {\n    //\n    iRetry--;\n    tRfcErrno = pthread_mutex_lock (&amp;tMutex);\n    if ( (tRfcErrno == EINTR) || (tRfcErrno == EAGAIN) )\n    {\n        iRetval = RFC_ERROR;    \n        (void)sched_yield();\n    }\n    else if (tRfcErrno != EOK)\n    {\n        iRetval = RFC_ERROR;    \n        iRetry = 0;\n    }\n    else\n    {\n        iRetval = RFC_OK;    \n        iRetry = 0;\n    }\n } while (iRetry &gt; 0);\n\n return iRetval;\n\n\n//#]\n</code></pre>\n\n<p>}</p>\n\n<p>I generated the core dump and analysed it with GDB and here are some findings</p>\n\n<ol>\n<li><p>Program terminated with signal 11, Segmentation fault.</p></li>\n<li><p>\"Errno=45\" at the add function where I am trying to acquire the lock. The wrapper we have around pthread_mutex_lock tries to acquire the lock for around 10 times before it gives up.</p></li>\n</ol>\n\n<p>The code works fine when there are fewer logs. Also, we do not have C++11 or further and hence restricted to mutex of QNX. Any help is appreciated as I am looking at this issue for over a month with little progress. Please ask if anymore info is required.</p>\n"}, {"tags": ["c++", "c++11", "c++14", "c++17"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1546424251, "post_id": 54004207, "comment_id": 94845774, "body": "Do you need it in class <code>A</code> and not <code>B</code>"}, {"owner": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1546432438, "post_id": 54004207, "comment_id": 94849377, "body": "actually every class must be having obj as unique id."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1546463707, "post_id": 54004207, "comment_id": 94863448, "body": "<a href=\"https://rextester.com/DWUOJ71527\" rel=\"nofollow noreferrer\">Compiles as written</a> for me."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1546465352, "post_id": 54004207, "comment_id": 94864077, "body": "\u201cIn last line\u201d\u2026 you actually want <code>A::obj</code> to be <code>constexpr</code> <i>too</i>, right?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1546465382, "post_id": 54004207, "comment_id": 94864089, "body": "Including the code that <i>doesn&#39;t</i> work when you tried it can be illuminating."}, {"owner": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "edited": false, "score": 0, "creation_date": 1546576996, "post_id": 54004207, "comment_id": 94902335, "body": "I tried in gcc trunk versions"}, {"owner": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "edited": false, "score": 0, "creation_date": 1546577186, "post_id": 54004207, "comment_id": 94902379, "body": "I also checked the standards. They say constexpr with static needs to be initialized as soon as they are made that means in class A if I change const to constexpr it will not compile because B is not defined and in example given by P.W. the obj is still const not constexpr. Thus still give error when I do static_assert."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "edited": false, "score": 0, "creation_date": 1546576910, "post_id": 54016645, "comment_id": 94902311, "body": "class B;  class A{ public: constexpr A(int y):x(y){}     int x;     const static B&amp; obj; };  class B:A{ public:     constexpr B(int x):A(x){}     const static B&amp; obj;     constexpr friend bool operator==(const B a,const B b){         return a.x==b.x;     } };  constexpr const B&amp; A::obj=B(10); constexpr const B&amp; B::obj=B(20);  int main() {     constexpr B y=10;     static_assert(A::obj==y); }"}, {"owner": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "edited": false, "score": 0, "creation_date": 1546576964, "post_id": 54016645, "comment_id": 94902330, "body": "this code is in error since A::obj is not constexpr it is still linked in runtime."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "edited": false, "score": 0, "creation_date": 1546595195, "post_id": 54016645, "comment_id": 94908112, "body": "The code you have provided in the comment does not compile and it is not due to the failure of <code>static_assert</code>"}, {"owner": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "edited": false, "score": 0, "creation_date": 1546684345, "post_id": 54016645, "comment_id": 94936618, "body": "the code I provide is  not working will be giving error that A::obj is not constexpr that means the type of obj is const not constexpr."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1546594985, "last_edit_date": 1546594985, "creation_date": 1546492098, "answer_id": 54016645, "question_id": 54004207, "link": "https://stackoverflow.com/questions/54004207/using-constexpr-with-static-in-circular-initialisation/54016645#54016645", "title": "using constexpr with static in circular initialisation?", "body": "<p>As <code>constexpr</code> applies the const-ness to the object defined, you can use <code>constexpr</code> before <code>const</code> in the last line or the last two lines (if that's what you really want) like this.</p>\n\n<pre><code>constexpr const B&amp; A::obj=B(10);\nconstexpr const B&amp; B::obj=B(20);\n</code></pre>\n\n<p>This works. See compiled demo <a href=\"https://rextester.com/FOSUOQ73646\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1546594985, "creation_date": 1546422672, "last_edit_date": 1546492267, "question_id": 54004207, "link": "https://stackoverflow.com/questions/54004207/using-constexpr-with-static-in-circular-initialisation", "title": "using constexpr with static in circular initialisation?", "body": "<p>I tried to understand how to use constexpr from different sources. But I have a problem that I want to convert the program below to use constexpr instead of const. This program is template of my main program.</p>\n\n<pre><code>class B;\n\nclass A{\npublic:\nconstexpr A(int){}\nconst static B&amp; obj;\n};\n\nclass B:A{\npublic:\n    constexpr B(int x):A(x){}\n    const static B&amp; obj;\n};\n\nconst B&amp; A::obj=B(10);\nconst B&amp; B::obj=B(20);\n</code></pre>\n\n<p>In last line I want to use constexpr to ensure that this obj variable is present at compile time and thus reduce my code size and optimize but according to standards constexpr can't be used. And it gives error about multiple declarations. And if I change the const in class A then initialization is must.I want to use obj variable in constexpr function and since obj is not present in compile time error occure. I am asking how can I solve the problem because if this cannot be done then probably the optimization of code is affected by 15% thats really huge.</p>\n"}, {"tags": ["c++", "function-pointers"], "comments": [{"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1546422808, "post_id": 54004190, "comment_id": 94845163, "body": "<code>userOperation</code> is a member function pointer, not a <code>void(*)(void)</code>. Compare <a href=\"https://stackoverflow.com/questions/2402579/function-pointer-to-member-function\" title=\"function pointer to member function\">stackoverflow.com/questions/2402579/&hellip;</a>."}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 0, "creation_date": 1546423547, "post_id": 54004190, "comment_id": 94845473, "body": "Which compiler are you using?"}, {"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "reply_to_user": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 0, "creation_date": 1546423774, "post_id": 54004190, "comment_id": 94845560, "body": "@r3musn0x it&#39;s a GNU GCC compiler C++98"}, {"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "reply_to_user": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1546424242, "post_id": 54004190, "comment_id": 94845768, "body": "@WernerHenze, yes Ok, but in this case my class Operation wont be generic, actually my Idea was that the class Operation just execute the user operation in a certain logic and it is up to the user to choose the operation to be executed, not cool for me :/"}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 0, "creation_date": 1546424328, "post_id": 54004190, "comment_id": 94845809, "body": "Are you limited to c++98?"}, {"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "edited": false, "score": 0, "creation_date": 1546425609, "post_id": 54004190, "comment_id": 94846345, "body": "I also tried with c++11 it will also give the same error"}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1546424423, "creation_date": 1546424423, "answer_id": 54004567, "question_id": 54004190, "link": "https://stackoverflow.com/questions/54004190/passing-a-function-declared-in-class-as-arguments-causes-compilation-error/54004567#54004567", "title": "Passing a function declared in class as arguments causes compilation error", "body": "<p>A non static member function is <strong>not</strong> the same thing as a normal function. Specifically, it can access its object <code>this</code> pointer which would not make sense for a <em>normal</em> function. So the compiler is correct when saying that there is no know conversion from the former to the latter.</p>\n"}, {"comments": [{"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "edited": false, "score": 0, "creation_date": 1546436631, "post_id": 54004911, "comment_id": 94851425, "body": "It seems you missed the <code>User::</code> in the definition of <code>callUserOperationIt</code> apart of this it seems fine I will try it and update the status"}, {"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "edited": false, "score": 0, "creation_date": 1546464472, "post_id": 54004911, "comment_id": 94863758, "body": "One question in the 1st example the <code>reinterpret_cast</code> is not dangerous in this case ?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "edited": false, "score": 0, "creation_date": 1546464963, "post_id": 54004911, "comment_id": 94863945, "body": "No, because <i>you know</i> that <code>callUserOperation</code> is always associated with a <code>User *</code> that has been converted to <code>void *</code>. You&#39;ve just declined to inform the complier directly"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1546465074, "last_edit_date": 1546465074, "creation_date": 1546425864, "answer_id": 54004911, "question_id": 54004190, "link": "https://stackoverflow.com/questions/54004190/passing-a-function-declared-in-class-as-arguments-causes-compilation-error/54004911#54004911", "title": "Passing a function declared in class as arguments causes compilation error", "body": "<p>Unlike free functions, there isn't an implicit conversion from a member function to pointer to member function, so you can never supply <code>userOperation</code>. You have to use <code>&amp;User::userOperation</code>. The error message could be better in that regard.</p>\n\n<p>Having fixed that, <code>&amp;User::userOperation</code> has the type <code>void (User::*)(void)</code>, which is not the same as <code>void (*)(void)</code> (your alias <code>cbk_fct</code>). You always need a <code>User</code> to call <code>userOperation</code>, and there is nowhere for that. You will have to change <code>Operation</code> if you want it to include member functions.</p>\n\n<p>The (C compatible) C++98 way would be to include a <code>void *</code> in both the function type, and the members of <code>Operation</code>, and pass <code>this</code> (or any other object pointer), implicitly converting to <code>void *</code>.</p>\n\n<pre><code>typedef void * context_ptr;\ntypedef void (* action_ptr)(context_ptr);\n\nclass Operation\n{\n private:\n action_ptr m_action;\n context_ptr m_context;\n\npublic:\n Operation(action_ptr action, context_ptr context);\n};\n\nOperation::Operation(action_ptr action, context_ptr context):\nm_action(action), m_context(context)\n{}\n\nclass User\n{\n static void callUserOperation(context_ptr);\n public:\n User();\n void userOperation();\n};\n\nvoid User::callUserOperation(context_ptr context)\n{\n    User * user = reinterpret_cast&lt;User *&gt;(context);\n    user-&gt;userOperation();\n}\n\nvoid User::userOperation()\n{\n cout &lt;&lt; \"User operation\"&lt;&lt;endl;\n}\n\nUser::User()\n{\n Operation op(&amp;User::callUserOperation, this);\n}\n</code></pre>\n\n<p>In C++11, you can use <code>std::function</code> to hold any function object of a particular signature, and construct it from a lambda capturing <code>this</code> and calling <code>userOperation</code></p>\n\n<pre><code>using action_ptr = std::function&lt;void(void)&gt;;\n\nclass Operation\n{\n private:\n action_ptr m_action;\n\npublic:\n Operation(action_ptr action);\n};\n\nOperation::Operation(action_ptr action):\nm_action(action)\n{}\n\nclass User\n{\n public:\n User();\n void userOperation();\n};\n\nvoid User::userOperation()\n{\n cout &lt;&lt; \"User operation\"&lt;&lt;endl;\n}\n\nUser::User()\n{\n Operation op([this]{ userOperation(); });\n}\n</code></pre>\n"}], "owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1546465074, "creation_date": 1546422590, "question_id": 54004190, "link": "https://stackoverflow.com/questions/54004190/passing-a-function-declared-in-class-as-arguments-causes-compilation-error", "title": "Passing a function declared in class as arguments causes compilation error", "body": "<p>I am facing problems with passing function pointer as arguments.</p>\n\n<p>The declaration of pointer to function type :</p>\n\n<pre><code>typedef void(*cbk_fct)(void);\n</code></pre>\n\n<p>The class <code>Operation</code> has a constructor that accept a <code>cbk_fct</code> as argument the declaration is as follows:</p>\n\n<pre><code>class Operation\n{\n private:\n cbk_fct m_fct_ptr;\n\npublic:\n Operation(cbk_fct fct_ptr);\n};\n\nOperation::Operation(cbk_fct fct_ptr):\nm_fct_ptr(fct_ptr)\n{\n\n}\n</code></pre>\n\n<p>Now the class <code>User</code> will call the Constructor of <code>Operation</code></p>\n\n<pre><code>class User\n{\n public:\n User();\n void userOperation();\n};\n\nvoid User::userOperation()\n{\n cout &lt;&lt; \"User operation\"&lt;&lt;endl;\n}\n\nUser::User()\n{\n Operation op(userOperation); // This version doesnt work\n}\n</code></pre>\n\n<p>This call will give following error:</p>\n\n<pre><code>no matching function for call to 'Operation::Operation(&lt;unresolved overloaded function type&gt;)'|\nno known conversion for argument 1 from '&lt;unresolved overloaded function type&gt;' to 'cbk_fct {aka void (*)()}'\n</code></pre>\n\n<p>However if I declared the function to be passed as parameter outside the class it will be accepted</p>\n\n<pre><code>void UserOperationNotInClass()\n{\n cout &lt;&lt; \"User operation\"&lt;&lt;endl;\n}\n\nUser::User()\n{\n Operation op(UserOperationNotInClass); // This version works\n}\n</code></pre>\n\n<p>Clearly the error message mention that it is not able to convert from '' to 'cbk_fct, but from where comes this type 'unresolved overloaded function type'</p>\n"}, {"tags": ["c++", "image", "qt", "exif"], "answers": [{"tags": [], "owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "is_accepted": false, "score": 0, "last_activity_date": 1546506056, "last_edit_date": 1546506056, "creation_date": 1546504545, "answer_id": 54018786, "question_id": 54004120, "link": "https://stackoverflow.com/questions/54004120/qt-qimagereader-setscaledsize-and-setautotransform-interaction/54018786#54018786", "title": "QT QImageReader setScaledSize and setAutoTransform interaction", "body": "<p><strong>AFAIK there is no built-in way to do it</strong> (see below why).</p>\n\n<p>The problem I see with your current approach is that it is over complicate when trying to use the built-in scaling feature. Instead, I'd suggest you to use something easier to read, like:</p>\n\n<pre><code>QImageReader imageReader(filepath);\nimageReader.setAutoTransform(true);\nconst auto qimage = imageReader.read();\nconst auto qscaledImage = qimage.scaledToWidth(100, Qt::SmoothTransformation);\n</code></pre>\n\n<p>(See at the bottom for one counter-case)</p>\n\n<hr>\n\n<h1>Explanation</h1>\n\n<p>Reading the source code of <code>QImageReader::read</code> (<code>&lt;qt_src_dir&gt;/src/gui/image/qimagereader.cpp</code>), the method first reads the image, then scales it, and then applies the transformation:</p>\n\n<pre><code>bool QImageReader::read(QImage *image)\n{\n    // [...]\n\n    // read the image\n    if (!d-&gt;handler-&gt;read(image)) {\n        d-&gt;imageReaderError = InvalidDataError;\n        d-&gt;errorString = QImageReader::tr(\"Unable to read image data\");\n        return false;\n    }\n\n    // provide default implementations for any unsupported image\n    // options\n    if (d-&gt;handler-&gt;supportsOption(QImageIOHandler::ClipRect) &amp;&amp; !d-&gt;clipRect.isNull()) {\n        if (d-&gt;handler-&gt;supportsOption(QImageIOHandler::ScaledSize) &amp;&amp; d-&gt;scaledSize.isValid()) {\n\n        // [... more lines about scaling ...]\n\n        }\n    }\n\n    // [...]\n    if (autoTransform())\n        qt_imageTransform(*image, transformation());\n\n    return true;\n}\n</code></pre>\n\n<p>Also, reading the documentation of <a href=\"http://doc.qt.io/qt-5/qimageiohandler.html#ImageOption-enum\" rel=\"nofollow noreferrer\"><code>QImageIOHandler::ImageOption::ScaledSize</code></a> (<code>QImageIOHandler</code> is used by <code>QImageReader</code> to actually read the image data) you see:</p>\n\n<blockquote>\n  <p>A handler that supports this option is expected to scale the image to the provided size (a QSize), after applying any clip rect transformation (ClipRect). If the handler does not support this option, QImageReader will perform the scaling after the image has been read.</p>\n</blockquote>\n\n<p>Therefore, the scale is always applied either by the handler or reader <em>before</em> the transformation.</p>\n\n<hr>\n\n<h1>Conclusions</h1>\n\n<p>Based on the points mentioned above, you have to either use the EXIF data to provide a correct scaled size, or scale the image after it has been read (which it is easier to read). So, unless you are reading thousand of very large images and the pre-scaling operation speeds up the transformation significatively, I suggest you to keep with a more maintainable code.</p>\n"}], "owner": {"reputation": 222, "user_id": 1014110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc5fdc89c0416ba48d55201e7807da3?s=128&d=identicon&r=PG", "display_name": "Pieter-Jan Busschaert", "link": "https://stackoverflow.com/users/1014110/pieter-jan-busschaert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1546506056, "creation_date": 1546422306, "question_id": 54004120, "link": "https://stackoverflow.com/questions/54004120/qt-qimagereader-setscaledsize-and-setautotransform-interaction", "title": "QT QImageReader setScaledSize and setAutoTransform interaction", "body": "<p>I would like to read and display thumbnail-sized versions of digital camera pictures. I currently use QImageReader which has the 2 features I need, but they seem to interact non-optimally...:</p>\n\n<ul>\n<li><a href=\"http://doc.qt.io/qt-5/qimagereader.html#setScaledSize\" rel=\"nofollow noreferrer\">setScaledSize</a></li>\n<li><a href=\"http://doc.qt.io/qt-5/qimagereader.html#setAutoTransform\" rel=\"nofollow noreferrer\">setAutoTransform</a></li>\n</ul>\n\n<p>I want to load and display the image with a width of 100 pixels <em>after</em> rotation based on EXIF properties. However, what happens is this:</p>\n\n<p>code:</p>\n\n<pre><code>QImageReader imageReader(filepath);\nauto origSize1 = imageReader.size();\nimageReader.setAutoTransform(true);\nauto origSize2 = imageReader.size();\nauto scaledSize1 = origSize1.scaled(QSize(100, 1000), Qt::KeepAspectRatio);\nauto scaledSize2 = origSize2.scaled(QSize(100, 1000), Qt::KeepAspectRatio);\nimageReader.setScaledSize(scaledSize2);\nauto qimage = imageReader.read();\nauto imageSize = qimage.size();\nauto qimageScaled = qimage.scaledToWidth(100, Qt::SmoothTransformation);\nauto scaledSize3 = qimageScaled.size();\n\nstd::cout &lt;&lt; \"  origSize1 = (\" &lt;&lt; origSize1.width() &lt;&lt; \", \" &lt;&lt; origSize1.height() &lt;&lt; \")\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; \"  origSize2 = (\" &lt;&lt; origSize2.width() &lt;&lt; \", \" &lt;&lt; origSize2.height() &lt;&lt; \")\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; \"scaledSize1 = (\" &lt;&lt; scaledSize1.width() &lt;&lt; \", \" &lt;&lt; scaledSize1.height() &lt;&lt; \")\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; \"scaledSize2 = (\" &lt;&lt; scaledSize2.width() &lt;&lt; \", \" &lt;&lt; scaledSize2.height() &lt;&lt; \")\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; \"  imageSize = (\" &lt;&lt; imageSize.width() &lt;&lt; \", \" &lt;&lt; imageSize.height() &lt;&lt; \")\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; \"scaledSize3 = (\" &lt;&lt; scaledSize3.width() &lt;&lt; \", \" &lt;&lt; scaledSize3.height() &lt;&lt; \")\" &lt;&lt; std::endl;\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>  origSize1 = (4896, 3672)\n  origSize2 = (4896, 3672)\nscaledSize1 = (100, 75)\nscaledSize2 = (100, 75)\n  imageSize = (75, 100)\nscaledSize3 = (100, 134)\n</code></pre>\n\n<p>So, the image is read with 100 pixels width in landscape mode, then the auto-rotate is applied, resulting in a portrait-mode image of only 75 pixels wide and 100 pixels high. The additional scaledToWidth() call takes care of making the image the correct size, but the quality is very bad due to the x1.34 zooming. </p>\n\n<p>It seems I could call setScaledSize with double (or triple, or ...) the resolution I need, to get enough quality and then relying on the additional scaledToWidth() call to get the correct final width. </p>\n\n<p>A better approach seems to be to use the QImageReader::transformation() info and use that to swap the width/height in the size object passed to setScaledSize:</p>\n\n<p>revised code:</p>\n\n<pre><code>QImageReader imageReader(filepath);\nauto origSize1 = imageReader.size();\nimageReader.setAutoTransform(true);\nauto transformation = imageReader.transformation();\nauto swapWH = transformation.testFlag(QImageIOHandler::TransformationRotate90);\nauto swappedSize = swapWH ? origSize1.transposed() : origSize1;\nauto scaledSwappedSize = swappedSize.scaled(QSize(100, 1000), Qt::KeepAspectRatio);\nimageReader.setScaledSize(scaledSwappedSize);\nauto qimage = imageReader.read();\nauto imageSize = qimage.size();\nauto qimageScaled = qimage.scaledToWidth(100, Qt::SmoothTransformation);\nauto scaledSize3 = qimageScaled.size();\n</code></pre>\n\n<p>output with this revised code:</p>\n\n<pre><code>  origSize1 = (4896, 3672)\ntransformation = 7\nswap width/height? = 1\nswappedSize = (3672, 4896)\nscaledSwapp = (100, 133)\n  imageSize = (133, 100)\nscaledSize3 = (100, 76)\n</code></pre>\n\n<p>As you can see, I still end up with a landscape-type image. The content is in portrait mode, but stretched out horizontally (making everyone fat). So, the resolution of 100x133 is OK, but I need to supply 133x100 to setScaledSize() to get \"normal\" results:</p>\n\n<pre><code>QImageReader imageReader(filepath);\nauto origSize1 = imageReader.size();\nimageReader.setAutoTransform(true);\nauto transformation = imageReader.transformation();\nauto swapWH = transformation.testFlag(QImageIOHandler::TransformationRotate90);\nauto swappedSize = swapWH ? origSize1.transposed() : origSize1;\nauto scaledSwappedSize = swappedSize.scaled(QSize(100, 1000), Qt::KeepAspectRatio);\nauto swappedScaledSwappedSize = swapWH ? scaledSwappedSize.transposed() : scaledSwappedSize;\nimageReader.setScaledSize(swappedScaledSwappedSize);\nauto qimage = imageReader.read();\nauto imageSize = qimage.size();\nauto qimageScaled = qimage.scaledToWidth(100, Qt::SmoothTransformation);\nauto scaledSize3 = qimageScaled.size();\n</code></pre>\n\n<p>Now I get \"correct\" results (note that imagesize == scaledSize3) :</p>\n\n<pre><code>  origSize1 = (4896, 3672)\ntransformation = 7\nswap width/height? = 1\nswappedSize = (3672, 4896)\nscaledSwapp = (100, 133)\nswpSclSwapp = (133, 100)\n  imageSize = (100, 133)\nscaledSize3 = (100, 133)\n</code></pre>\n\n<p>So, I get this to work, but I feel like I'm doing way too much round-about code. Is this the expected behaviour? Are there simpler ways of getting this result?</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1546422223, "post_id": 54004024, "comment_id": 94844926, "body": "Is this the actual code? It seems like you have this problem: <a href=\"https://stackoverflow.com/questions/42875580/invalid-type-argument-of-unary-have-int-error-in-c\" title=\"invalid type argument of unary have int error in c\">stackoverflow.com/questions/42875580/&hellip;</a>"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1546422785, "post_id": 54004024, "comment_id": 94845154, "body": "There&#39;s no special way to set a value through a pointer, just because the pointer is declared in a header file. The code you posted looks correct, the problem is probably somewhere else (e.g. you are shadowing the declaration in the header file). As usual it would best to post a complete program, instead of just the part of the program that you think is wrong."}, {"owner": {"reputation": 141, "user_id": 8843634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b074e9421fd99b7bcce4df0d2401caf7?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik Krish", "link": "https://stackoverflow.com/users/8843634/karthik-krish"}, "edited": false, "score": 0, "creation_date": 1546425235, "post_id": 54004024, "comment_id": 94846194, "body": "why you need to set an address to a pointer from a return value of a function..."}, {"owner": {"reputation": 88, "user_id": 6838396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EV4Eb.jpg?s=128&g=1", "display_name": "Kiruse", "link": "https://stackoverflow.com/users/6838396/kiruse"}, "edited": false, "score": 0, "creation_date": 1546430096, "post_id": 54004024, "comment_id": 94848347, "body": "Caution: Every .cpp file that you <code>#include &quot;global.h&quot;</code> in will try to redefine <code>ID</code>, most likely preventing proper linkage. Refer to <a href=\"https://stackoverflow.com/questions/10422034/when-to-use-extern-in-c\">When to use extern in C++</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1211, "user_id": 3313819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yKM0Y.png?s=128&g=1", "display_name": "ShadowMitia", "link": "https://stackoverflow.com/users/3313819/shadowmitia"}, "edited": false, "score": 0, "creation_date": 1546426999, "post_id": 54005044, "comment_id": 94846996, "body": "Hi, you should be modifying your question if there are changes, or open a new one if the question is too different. You should only add answers under the question."}, {"owner": {"reputation": 33, "user_id": 10639969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y5jqGL8Y1W4/AAAAAAAAAAI/AAAAAAAAABM/Qarsy9Labqo/photo.jpg?sz=128", "display_name": "reza moslemi", "link": "https://stackoverflow.com/users/10639969/reza-moslemi"}, "reply_to_user": {"reputation": 1211, "user_id": 3313819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yKM0Y.png?s=128&g=1", "display_name": "ShadowMitia", "link": "https://stackoverflow.com/users/3313819/shadowmitia"}, "edited": false, "score": 0, "creation_date": 1546427247, "post_id": 54005044, "comment_id": 94847097, "body": "@ShadowMitia the question title is suitable for both questions"}, {"owner": {"reputation": 88, "user_id": 6838396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EV4Eb.jpg?s=128&g=1", "display_name": "Kiruse", "link": "https://stackoverflow.com/users/6838396/kiruse"}, "edited": false, "score": 0, "creation_date": 1546429672, "post_id": 54005044, "comment_id": 94848188, "body": "@rezamoslemi That is not the issue. You posted an &quot;answer&quot; to your question which is not an answer but an update. Please update your original question accordingly, instead of posting such an invalid answer."}], "tags": [], "owner": {"reputation": 33, "user_id": 10639969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y5jqGL8Y1W4/AAAAAAAAAAI/AAAAAAAAABM/Qarsy9Labqo/photo.jpg?sz=128", "display_name": "reza moslemi", "link": "https://stackoverflow.com/users/10639969/reza-moslemi"}, "is_accepted": false, "score": 0, "last_activity_date": 1546426453, "creation_date": 1546426453, "answer_id": 54005044, "question_id": 54004024, "link": "https://stackoverflow.com/questions/54004024/how-to-set-value-to-a-pointer-declared-in-a-header-file/54005044#54005044", "title": "How to set value to a pointer declared in a header file", "body": "<p>I built a new and very simple project with only one line of user code:</p>\n\n<p>global.h file:</p>\n\n<pre><code>#ifndef GLOBAL_H\n#define GLOBAL_H\nint *ID;\n#endif // GLOBAL_H\n</code></pre>\n\n<p>mainwindow.h:</p>\n\n<pre><code>#ifndef MAINWINDOW_H\n#define MAINWINDOW_H\n\n#include &lt;QMainWindow&gt;\n\nnamespace Ui {\nclass MainWindow;\n}\n\nclass MainWindow : public QMainWindow\n{\nQ_OBJECT\n\npublic:\n    explicit MainWindow(QWidget *parent = 0);\n~MainWindow();\n\nprivate slots:\nvoid on_pushButton_clicked();\n\nprivate:\nUi::MainWindow *ui;\n};\n\n#endif // MAINWINDOW_H\n</code></pre>\n\n<p>main.cpp:</p>\n\n<pre><code>#include \"mainwindow.h\"\n#include &lt;QApplication&gt;\n\nint main(int argc, char *argv[])\n{\nQApplication a(argc, argv);\nMainWindow w;\nw.show();\n\nreturn a.exec();\n}\n</code></pre>\n\n<p>mainwindow.cpp:</p>\n\n<pre><code>#include \"mainwindow.h\"\n#include \"ui_mainwindow.h\"\n#include \"global.h\"\n\nMainWindow::MainWindow(QWidget *parent) :\nQMainWindow(parent),\nui(new Ui::MainWindow)\n{\nui-&gt;setupUi(this);\n}\n\nMainWindow::~MainWindow()\n{\ndelete ui;\n}\n\nvoid MainWindow::on_pushButton_clicked()\n{\n*ID = 6;\n}\n</code></pre>\n\n<p>on this program I get no error but when I click on pushbutton, the program crashes!!</p>\n"}, {"tags": [], "owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "is_accepted": false, "score": 1, "last_activity_date": 1546429036, "last_edit_date": 1546429036, "creation_date": 1546427995, "answer_id": 54005384, "question_id": 54004024, "link": "https://stackoverflow.com/questions/54004024/how-to-set-value-to-a-pointer-declared-in-a-header-file/54005384#54005384", "title": "How to set value to a pointer declared in a header file", "body": "<p>You seem to have problems understanding how a pointer works.</p>\n\n<pre><code>*CorrectID = ui-&gt;lineEdit_CurrentID-&gt;text().toInt();\n</code></pre>\n\n<p>That code dereferences your pointer and assigns the value on the right side to the address it points at. Do to so, it already needs to point at some address. Right now, given the code you posted in your \"answer\", it would not have.</p>\n\n<p>You need to assign an address to your pointer, otherwise, it might contain random nonsense that easily leads to a crash. You can do this like that:</p>\n\n<pre><code>CorrectId = new int;\n</code></pre>\n\n<p>Which creates a new variable on the heap and uses that address, although that is most likely not a valid ID.</p>\n\n<p>Or given your \"answer\" code, you could create a stack variable in the scope of your main and set the pointer towards it, although that wouldn't be a good design.</p>\n\n<p>That said, probably more important: Try to avoid global variables. I don't know your design, therefore I can't tell you how you should do it, but you having that pointer being a global variable is a red flag to me. Having an ID that can be manipulating from all directions is also, even if you'd use injection instead. Most likely, you should create a class which stores CorrectID as a member and thus takes <em>ownership</em> of it. A reference to this class is shared by injection and any manipulation of the member is done over the interface of the class. Now again, I don't know your big design, but in most cases, this will be the way to go.</p>\n\n<p>Given your other code, it could be simply done by making it a member of your main window. Or you have some other class that controls things to which the main window has a pointer to. Best would be if you gave us context. </p>\n\n<p>A possible layout of your project:</p>\n\n<pre><code>class IDController\n{\n    private:\n    int _ID;\n\n    public:\n    void setID(int ID) { _ID = ID; }\n    const int&amp; ID() const { return _ID; }\n};\n\nint main(int argc, char *argv[])\n{\nIDController controller;\nQApplication a(argc, argv);\nMainWindow w(&amp;a, &amp;IDController);\n...\n}\n\nclass MainWindow : public QMainWindow\n{\n...\nprivate:\nIDController* controller;\n...\n\nMainWindow::MainWindow(QWidget* parent, IDController* controller) :\nQMainWindow(parent),\ncontroller(controller)\nui(new Ui::MainWindow)\n{\n...\n\nvoid MainWindow::on_pushButton_clicked()\n{\n    controller-&gt;setID(6);\n}\n</code></pre>\n\n<p>The name IDController should be replaced by some more organical name, some class that the ID belongs to. Note that I do not initialize _ID, which is bad. IDController should have some defined constructor. If the ID is something very volatile, one might decide to remove the getter and setter from the controller and make it public, but most likely, instead you want to extent the setter and getter to do some additional things (like verifying that a given ID is valid).</p>\n"}], "owner": {"reputation": 33, "user_id": 10639969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y5jqGL8Y1W4/AAAAAAAAAAI/AAAAAAAAABM/Qarsy9Labqo/photo.jpg?sz=128", "display_name": "reza moslemi", "link": "https://stackoverflow.com/users/10639969/reza-moslemi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1546429036, "creation_date": 1546421819, "question_id": 54004024, "link": "https://stackoverflow.com/questions/54004024/how-to-set-value-to-a-pointer-declared-in-a-header-file", "title": "How to set value to a pointer declared in a header file", "body": "<p>I have a pointer in a header file named global.h in my project:</p>\n\n<pre><code>int *CorrectID;\n</code></pre>\n\n<p>and somewhere in my mainwindow.cpp file I have this:</p>\n\n<pre><code>*CorrectID = ui-&gt;lineEdit_CurrentID-&gt;text().toInt();\n</code></pre>\n\n<p>but I receive this Error:</p>\n\n<pre><code>invalid type argument of unary '*' (have 'uint {aka unsigned int}')\n    *CorrectID = ui-&gt;lineEdit_CurrentID-&gt;text().toInt();\n     ^\n</code></pre>\n"}, {"tags": ["c++", "c++20"], "comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1546422010, "post_id": 54004000, "comment_id": 94844828, "body": "Not sure why it was ever there, it seems like <code>std::filesystem::path</code> has a constructor that performs the same as that function."}, {"owner": {"reputation": 1721, "user_id": 5034140, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H4LtHEu4ABU/AAAAAAAAAAI/AAAAAAAABfc/vgbjnSLypvo/photo.jpg?sz=128", "display_name": "Guillaume Gris", "link": "https://stackoverflow.com/users/5034140/guillaume-gris"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1546422322, "post_id": 54004000, "comment_id": 94844966, "body": "From path page on cppreference : \u201cFor portable pathname generation from Unicode strings, see u8path\u201d"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1546422751, "post_id": 54004000, "comment_id": 94845142, "body": "Hmmm, true. But it also says: <i>If the source character type is char, the encoding of the source is assumed to be the native narrow encoding</i> (for constructor 6). I am pretty sure this covers unicode where unicode is the native format. It says the same in u8path: <i>If path::value_type is char and native encoding is UTF-8, constructs a path directly</i>. Maybe the note is unnecessary and the path constructor does the right thing?"}, {"owner": {"reputation": 1721, "user_id": 5034140, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H4LtHEu4ABU/AAAAAAAAAAI/AAAAAAAABfc/vgbjnSLypvo/photo.jpg?sz=128", "display_name": "Guillaume Gris", "link": "https://stackoverflow.com/users/5034140/guillaume-gris"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1546423187, "post_id": 54004000, "comment_id": 94845327, "body": "Native narrow encoding is UTF-8 on Unix systems, on Windows, it&#39;s more complicated according to this question: <a href=\"https://stackoverflow.com/questions/4649388/what-is-the-native-narrow-string-encoding-on-windows\" title=\"what is the native narrow string encoding on windows\">stackoverflow.com/questions/4649388/&hellip;</a>"}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 1, "creation_date": 1546426200, "post_id": 54004000, "comment_id": 94846604, "body": "Because in C++20 path constructor supports construction from <code>char8_t</code> (a new fundamental type for representing UTF-8 encoded values). I&#39;ve updated <a href=\"https://en.cppreference.com/w/cpp/filesystem/path/path\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/filesystem/path/path</a> to reflect this."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 2, "creation_date": 1546426455, "post_id": 54004000, "comment_id": 94846741, "body": "@cpplearner that should be an answer, not a comment"}], "answers": [{"comments": [{"owner": {"reputation": 1817, "user_id": 647898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8a82af8108d3c651d08a4ecb4386828c?s=128&d=identicon&r=PG", "display_name": "jhasse", "link": "https://stackoverflow.com/users/647898/jhasse"}, "edited": false, "score": 0, "creation_date": 1587631895, "post_id": 54008151, "comment_id": 108588706, "body": "What should I do if I have a UTF-8 encoded <code>std::string</code>?"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 1817, "user_id": 647898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8a82af8108d3c651d08a4ecb4386828c?s=128&d=identicon&r=PG", "display_name": "jhasse", "link": "https://stackoverflow.com/users/647898/jhasse"}, "edited": false, "score": 0, "creation_date": 1587648318, "post_id": 54008151, "comment_id": 108597996, "body": "@jhasse: As stated in the post, &quot;Deprecation does not mean removed or inaccessible.&quot; Use <code>u8path</code> for now, with the intent that you&#39;re eventually going to transition to having a proper UTF-8 encoded <code>u8string</code>."}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 17, "last_activity_date": 1587648250, "last_edit_date": 1587648250, "creation_date": 1546439524, "answer_id": 54008151, "question_id": 54004000, "link": "https://stackoverflow.com/questions/54004000/why-is-stdfilesystemu8path-deprecated-in-c20/54008151#54008151", "title": "Why is std::filesystem::u8path deprecated in c++20?", "body": "<p>Because, thanks to the existence of the C++20 feature <code>char8_t</code>, this will work:</p>\n\n<pre><code>path p(u8\"A/utf8/path\");\n</code></pre>\n\n<p><code>u8path</code> existed to allow the detection of the difference between a UTF-8 string and a narrow character string. But since C++20 will give us an actual <em>type</em> for that, it is no longer necessary.</p>\n\n<hr>\n\n<blockquote>\n  <p>What should I use in c++17?</p>\n</blockquote>\n\n<p>Use <code>u8path</code>. Deprecation does not mean <em>removed</em> or <em>inaccessible</em>. It merely means subject to <em>eventual</em> removal.</p>\n"}], "owner": {"reputation": 1721, "user_id": 5034140, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H4LtHEu4ABU/AAAAAAAAAAI/AAAAAAAABfc/vgbjnSLypvo/photo.jpg?sz=128", "display_name": "Guillaume Gris", "link": "https://stackoverflow.com/users/5034140/guillaume-gris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2371, "favorite_count": 3, "accepted_answer_id": 54008151, "answer_count": 1, "score": 20, "last_activity_date": 1587648250, "creation_date": 1546421723, "question_id": 54004000, "link": "https://stackoverflow.com/questions/54004000/why-is-stdfilesystemu8path-deprecated-in-c20", "title": "Why is std::filesystem::u8path deprecated in c++20?", "body": "<p>Introduced in c++17, <code>std::filesystem::u8path</code> seems to be deprecated in c++20.</p>\n\n<p>What is the reason for this choice? What should I use in c++17? What should I use in c++20?</p>\n"}, {"tags": ["c++", "function", "bitwise-operators"], "comments": [{"owner": {"reputation": 11326, "user_id": 2328763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849491de0be9b3cdf39c96b4c6b32e2b?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/2328763/alper"}, "edited": false, "score": 2, "creation_date": 1546421019, "post_id": 54003831, "comment_id": 94844388, "body": "For negative a, the value of a &gt;&gt; 1 is implementation-defined."}, {"owner": {"reputation": 168, "user_id": 7137791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-hMkhLnvAM/AAAAAAAAAAI/AAAAAAAAAHQ/hVLJcAYa7Zs/photo.jpg?sz=128", "display_name": "Nitin Pawar", "link": "https://stackoverflow.com/users/7137791/nitin-pawar"}, "edited": false, "score": 1, "creation_date": 1546421108, "post_id": 54003831, "comment_id": 94844429, "body": "You need to google a few things. &quot;Left and right shift&quot;, &quot;Bitwise AND and OR&quot; and &quot;Recursion&quot;."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1546421342, "post_id": 54003831, "comment_id": 94844533, "body": "You need to target what you do not understand in this function: The bitwise operations (<code>&lt;&lt;</code> and <code>&amp;</code>)? The recursion of <code>function</code>? Something else?"}], "answers": [{"tags": [], "owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "is_accepted": false, "score": 3, "last_activity_date": 1546421401, "creation_date": 1546421401, "answer_id": 54003944, "question_id": 54003831, "link": "https://stackoverflow.com/questions/54003831/problem-in-understanding-decimal-to-binary-function-with-bitwise-operators-in-c/54003944#54003944", "title": "problem in understanding decimal to binary function with bitwise operators in c++", "body": "<p>Recursive function</p>\n\n<pre><code>void function(int a){\n    if(a){                 // if a is not 0, continue calling recursively\n        function(a&gt;&gt;1);    // right shift a one step i.e. divide by 2, then call ourselves\n        cout&lt;&lt;(a&amp;1);       // bitwise &amp; with a i.e print if a is odd or even.\n    }\n}\n</code></pre>\n\n<p>Example</p>\n\n<pre><code>function(4);\na = 4, a&gt;&gt;1 == 2\nfunction(2);\na = 2, a&gt;&gt;1 == 0\nfunction(0); will end recursion\ncout &lt;&lt; (2&amp;1) will print 0 since 0x10 &amp; 0x01 == 0x00\ncout &lt;&lt; (4&amp;1) will print 0 since 0x20 &amp; 0x01 == 0x00\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 3, "last_activity_date": 1546422997, "last_edit_date": 1546422997, "creation_date": 1546421440, "answer_id": 54003954, "question_id": 54003831, "link": "https://stackoverflow.com/questions/54003831/problem-in-understanding-decimal-to-binary-function-with-bitwise-operators-in-c/54003954#54003954", "title": "problem in understanding decimal to binary function with bitwise operators in c++", "body": "<pre><code>void function(int a)    // function declaration\n{\n    if(a)               // a != 0?\n    {\n        function(a&gt;&gt;1); // recursive call to function with a shifted right one bit\n        cout&lt;&lt;(a&amp;1);    // print out least significant bit of a\n    }\n}\n</code></pre>\n\n<p>This function prints out a binary representation of a number given, e. g. a initially 13:</p>\n\n<pre><code>f(13)            // 13 == 0b1101\n{\n    f(6)         // 0b1101 &gt;&gt; 1 == 0b0110\n    {\n        f(3)     // 0b0110 &gt;&gt; 1 == 0b0011\n        {\n            f(1) // etc\n            {\n                f(0)\n                { }  // does nothing\n                std::cout &lt;&lt; (1 &amp; 1); // 1, most significant bit of original 13\n            }\n            std::cout &lt;&lt; (3 &amp; 1);     // 1\n        }\n        std::cout &lt;&lt; (6 &amp; 1);         // 0\n    }\n    std::cout &lt;&lt; (13 &amp; 1);            // 1\n}\n\n1101 in total\n</code></pre>\n\n<p>Signature is dangerous, though; wheras it is implementation defined if the shift is logic (always 0 shifted in at the left) or arithmetic (shift in current sign bit again), <a href=\"https://stackoverflow.com/questions/7622/are-the-shift-operators-arithmetic-or-logical-in-c\"><em>usually</em></a> (question is C, but applies for C++ as well) arithmetic shift is implemented for signed values.</p>\n\n<p>So you would end up in an endless recursion if you pass a negative value to the function. Better:</p>\n\n<pre><code>void function(unsigned int a);\n//            ^^^^^^^^\n</code></pre>\n\n<p>For <em>unsigned</em> values, logic and arithmetic shift are the same...</p>\n\n<p>Side note: if you pass 0 initially to the function, you don't get any output at all (either variant).</p>\n"}, {"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1546422497, "post_id": 54004071, "comment_id": 94845047, "body": "<i>&#39;First we right-shift&#39;</i> - that&#39;s perhaps ambivalent; if had to rewrite the function solely based on this explanation, I&#39;d do <code>a &gt;&gt;= 1; f(a); std::cout &lt;&lt; (a&amp;1)</code>."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1546422562, "post_id": 54004071, "comment_id": 94845074, "body": "@OP, To avoid the problems, mentioned for the case of negative numbers, I would change <code>if(a)</code> by <code>if (a&gt;0)</code>."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1546422977, "post_id": 54004071, "comment_id": 94845236, "body": "@Aconcagua, Are you referring to &quot;6.2.2 Evaluation Order [expr.evaluation]&quot;? I always thought that the operation would be performed first, before the function call continues. Is it not so? If not, then apparently, I have learned something new today."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1546423625, "post_id": 54004071, "comment_id": 94845506, "body": "Your understanding is fine, the point is: your wording could be misunderstood. Sure the value first is shifted right, <i>then</i> passed to the function - to be more precise: <i>the result</i> of the shift is passed - wheras the operand <code>a</code> remains unchanged. <i>&#39;First we right-shift&#39;</i> I&#39;d understand, in contrast to, as modifying the operand as well, just as in <code>f(a &gt;&gt;= 1)</code> (note the additional <code>=</code>)."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1546424039, "post_id": 54004071, "comment_id": 94845688, "body": "Apart from: It is totally legal to right-shift 0 (no UB at all)! <code>0 &gt;&gt; 1</code> just remains 0..."}, {"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1546424221, "post_id": 54004071, "comment_id": 94845765, "body": "Thank you. Edited as suggested. Indeed. I was confusing myself with the negative numbers again, which some people had pointed out, but in a different context."}], "tags": [], "owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "is_accepted": true, "score": 4, "last_activity_date": 1546424182, "last_edit_date": 1546424182, "creation_date": 1546422062, "answer_id": 54004071, "question_id": 54003831, "link": "https://stackoverflow.com/questions/54003831/problem-in-understanding-decimal-to-binary-function-with-bitwise-operators-in-c/54004071#54004071", "title": "problem in understanding decimal to binary function with bitwise operators in c++", "body": "<pre><code>// Step 1: You call a function defined as `void function(int a)`\n// which accepts one parameter of type int and returns a void.\nvoid function(int a)\n{\n    // Step 2: This function checks if a is zero or some other value. \n    // If it is zero, nothing happens and the function returns.\n    // If it is non-zero, we proceed inside the if block.\n    if(a){\n        // Step 3: we do two things here.\n        // First we right-shift whatever value is stored in a.\n        // Right-shifting means if we have e.g. a=8, which is 1000 in binary,\n        // then rightshifting 8 would be 0100 or 4. Basically it is division by 2.\n        // This continues until we have 0000.\n\n        // Secondly, this function will call itself then. This is called recursion.\n        // So the \"void function(4)-&gt; void function(2) -&gt; void function(1)\" calls will run.\n        function(a&gt;&gt;1);\n\n        // Here we will bitwise AND with 1.\n        // So, 0001 &amp; 0001 = 1\n        // 0010 &amp; 0001 = 0\n        // 0100 &amp; 0001 = 0\n        // 1000 &amp; 0001 = 0\n        // And this is what you will see on the terminal as output: 1000\n        // The 1 gets printed first, because the inner most call in the recursion\n        // finishes first and the call stack unwraps back up.\n        cout&lt;&lt;(a&amp;1);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 10501630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b46c285c14b94279cfbf0150a879619?s=128&d=identicon&r=PG&f=1", "display_name": "amirhosein arabhaji", "link": "https://stackoverflow.com/users/10501630/amirhosein-arabhaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "closed_date": 1551782404, "accepted_answer_id": 54004071, "answer_count": 3, "score": 0, "last_activity_date": 1602074612, "creation_date": 1546420814, "last_edit_date": 1602074612, "question_id": 54003831, "link": "https://stackoverflow.com/questions/54003831/problem-in-understanding-decimal-to-binary-function-with-bitwise-operators-in-c", "closed_reason": "Needs more focus", "title": "problem in understanding decimal to binary function with bitwise operators in c++", "body": "<p>How this function change decimal to binary?<br />\nI know what bitwise operation do but I can't understand what this function do in work</p>\n<pre><code>    void function(int a){\n        if(a){\n            function(a&gt;&gt;1);\n            cout&lt;&lt;(a&amp;1);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++", "reference", "constants", "pass-by-reference", "const-correctness"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1546419701, "post_id": 54003479, "comment_id": 94843823, "body": "Short answer yes. Your code is fine and works as you expect."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1546420259, "post_id": 54003479, "comment_id": 94844070, "body": "I would expect any sane compiler to produce the correct code here. Out of curiosity, where does your doubt stem from?"}, {"owner": {"reputation": 4123, "user_id": 3378179, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3mmbS.png?s=128&g=1", "display_name": "Caduchon", "link": "https://stackoverflow.com/users/3378179/caduchon"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1546423488, "post_id": 54003479, "comment_id": 94845453, "body": "@StoryTeller: because if I said to the compiler that somthing is constant, it could be logical that the compiler decide to create a copy in a closer memory than RAM (like the cache of the processor) whithout having to check if it was updated."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1546423556, "post_id": 54003479, "comment_id": 94845479, "body": "But you didn&#39;t tell it that. The object is not declared const."}, {"owner": {"reputation": 4123, "user_id": 3378179, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3mmbS.png?s=128&g=1", "display_name": "Caduchon", "link": "https://stackoverflow.com/users/3378179/caduchon"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1546423699, "post_id": 54003479, "comment_id": 94845527, "body": "@StoryTeller: right. But I was not sure. I don&#39;t master all the complexity of <code>const</code> and <code>mutable</code> aspects."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1546423837, "post_id": 54003479, "comment_id": 94845580, "body": "Well, I guess that&#39;s why <a href=\"https://stackoverflow.com/questions/tagged/d\">d</a> has also an <code>immutable</code> keyword to differentiate these cases."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1546423971, "post_id": 54003479, "comment_id": 94845644, "body": "@Caduchon Here, <code>const</code> means logically const, not physically const. The compiler has no way to know what logically const means, so it can&#39;t make any assumptions. For example, a logically-const object might count how many times it is compared. That doesn&#39;t change its logical value. There is no safe assumption the compiler can make about logically-const objects."}], "answers": [{"tags": [], "owner": {"reputation": 462, "user_id": 4068350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oJi3Pk7K-r8/AAAAAAAAAAI/AAAAAAAAAVk/Su6nDLc_WVM/photo.jpg?sz=128", "display_name": "aybassiouny", "link": "https://stackoverflow.com/users/4068350/aybassiouny"}, "is_accepted": true, "score": 1, "last_activity_date": 1546420148, "creation_date": 1546420148, "answer_id": 54003681, "question_id": 54003479, "link": "https://stackoverflow.com/questions/54003479/can-i-be-sure-than-a-const-reference-is-updated-when-modified-by-another-entity/54003681#54003681", "title": "Can I be sure than a const reference is updated when modified by another entity?", "body": "<p>Yes, you can be sure. References are internally implemented in the compiler as pointers, and both <code>bar.update();</code> and <code>Foo::bar</code> are acting on the same memory location. </p>\n\n<p>That's, of course, as long as there are no data race concerns, at which point the usual problems of synchronization arise.</p>\n"}, {"tags": [], "owner": {"reputation": 2120, "user_id": 9167702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7936df8ed092bb16463bde29df803d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Tobi", "link": "https://stackoverflow.com/users/9167702/tobi"}, "is_accepted": false, "score": -1, "last_activity_date": 1546421547, "creation_date": 1546421547, "answer_id": 54003973, "question_id": 54003479, "link": "https://stackoverflow.com/questions/54003479/can-i-be-sure-than-a-const-reference-is-updated-when-modified-by-another-entity/54003973#54003973", "title": "Can I be sure than a const reference is updated when modified by another entity?", "body": "<p>The best pre c++11 standard text I could find quickly was <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1905.pdf\" rel=\"nofollow noreferrer\">this draft</a> from 2005, wich should be close enough to C++03.</p>\n\n<p>It says in  3.10:13  [basic.lval] </p>\n\n<blockquote>\n  <p>The referent of a const-qualified expression shall not be modified (<strong>through that expression</strong>), except that if it is of class type and has a mutable component, that component can be modified.</p>\n</blockquote>\n\n<p>The emphasis is mine and highlights that it is to be expected that the referent <strong>can</strong> be modified though other expressions (if they themselves allow it).</p>\n"}], "owner": {"reputation": 4123, "user_id": 3378179, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3mmbS.png?s=128&g=1", "display_name": "Caduchon", "link": "https://stackoverflow.com/users/3378179/caduchon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 54003681, "answer_count": 2, "score": 1, "last_activity_date": 1547106638, "creation_date": 1546419059, "last_edit_date": 1547106638, "question_id": 54003479, "link": "https://stackoverflow.com/questions/54003479/can-i-be-sure-than-a-const-reference-is-updated-when-modified-by-another-entity", "title": "Can I be sure than a const reference is updated when modified by another entity?", "body": "<p>I have a class <code>Foo</code> having the rights to read an instance of class <code>Bar</code>, but doesn't have the rights to modify it. In the same time, the instance of <code>Bar</code> could be modified by other elements.</p>\n\n<p>For the moment, I implement it by this way:</p>\n\n<pre><code>class Foo\n{\n  private:\n    const Bar&amp; bar; // Foo can't modify it\n  public:\n    Foo(const Bar&amp; bar_) : bar(bar_) {}\n    void doSomthing() { this-&gt;bar.printData(); }\n};\n</code></pre>\n\n<p>And it could be used like this:</p>\n\n<pre><code>Bar bar;\nFoo foo(bar);\nbar.update(); // This modify the instance of Bar\nfoo.doSomthing(); // This use the reference to (modified) bar\n</code></pre>\n\n<p>My question is: <strong>With this implementation, can I be sure than the compiler doesn't use a non updated copy of <code>bar</code> even if the reference is declared as <code>const</code> ?</strong></p>\n\n<p>If no, how can I do that ?</p>\n\n<p><em>Note: I don't use C++11 for compatibility reason</em></p>\n"}, {"tags": ["c++", "c++11", "hashmap"], "answers": [{"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1546419447, "creation_date": 1546419447, "answer_id": 54003545, "question_id": 54003445, "link": "https://stackoverflow.com/questions/54003445/how-to-fix-hashmap-error-error-in-c/54003545#54003545", "title": "How to fix &quot;Hashmap error: &quot; error in C++", "body": "<p><code>std::string::at</code> returns a reference to a <code>char</code>, a single character. Meanwhile <code>std::map::find</code> expected a reference to the key type, a <code>std::string</code>. There is no implicit conversion from a single character to a string. So you don't give <code>find</code> the argument it expected.</p>\n\n<p>A possible workaround is to use <code>std::basic_string::substr</code> instead of <code>at</code>. This member function returns a string, by value, that holds a substring. You give it a position and how many characters to read. So the immediate fix to your code can be:</p>\n\n<pre><code>window.find(s.substr(j,1)) != window.end()\n</code></pre>\n\n<p>Other than that, do note that <code>std::map</code> is an <strong>ordered map</strong>. As such it is usually implement by using a self-balancing binary tree. If you don't need order, and indeed want amortized constant lookup time like a hash would provide, you need <code>std::unordered_map</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10091445"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546419447, "creation_date": 1546418887, "question_id": 54003445, "link": "https://stackoverflow.com/questions/54003445/how-to-fix-hashmap-error-error-in-c", "title": "How to fix &quot;Hashmap error: &quot; error in C++", "body": "<p>I want to use hashmap in C++ in Ubuntu 18.04. Butthis error makes me confusing.</p>\n\n<p>I want to use hashmap in C++ in Ubuntu 18.04. Butthis error makes me confusing.</p>\n\n<blockquote>\n  <p>The complete error code is \"Hashmap error: no matching function for\n  call to \u2018std::map,\n  int>::find(__gnu_cxx::__alloc_traits</p>\n  \n  <blockquote>\n    <p>::value_type&amp;)\"</p>\n  </blockquote>\n</blockquote>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt; using namespace std;\n\nint main() {\n    string s = \"dfsfsdfsf\";\n    int i = 0, j = 0, ans = 0, leng;\n    map&lt;string,int&gt; window;\n    leng = s.length();\n    for(;j &lt; leng; j++){\n        if(window.find(s.at(j)) != window.end()){\n            i = max(i, window[s.at(j)])\n        }\n    }\n    return 0; }\n</code></pre>\n\n<p>I do not know what happened. Please someone helps me. ^~^</p>\n"}, {"tags": ["c++", "c++11", "memory-management"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1546418229, "post_id": 54003327, "comment_id": 94843297, "body": "If the library exposes the class like this and allows for inheritance, are you sure it has no facilities to make your life easier? IOW, if you can&#39;t initialize your objects, you may not be supposed to do inheritance."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 2, "creation_date": 1546418337, "post_id": 54003327, "comment_id": 94843339, "body": "Short answer is no, if the other library is holding a pointer internally, there&#39;s nothing you can do to change that. But your library maybe have some facilities to tell it to allocate <code>Derived</code> in the first place. Or you may simply be trying to solve the wrong problem."}, {"owner": {"reputation": 2602, "user_id": 1247832, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1117c8b9bab86dd779a525b769e7ac04?s=128&d=identicon&r=PG", "display_name": "MasterGberry", "link": "https://stackoverflow.com/users/1247832/mastergberry"}, "edited": false, "score": 0, "creation_date": 1546418673, "post_id": 54003327, "comment_id": 94843466, "body": "Unfortunately the library does not have this type of support. This is why I was trying to find out if there was something I wasn&#39;t aware of on how to do this type of allocation. I believe it is not possible, but just wanted some outside opinions."}, {"owner": {"reputation": 462, "user_id": 4068350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oJi3Pk7K-r8/AAAAAAAAAAI/AAAAAAAAAVk/Su6nDLc_WVM/photo.jpg?sz=128", "display_name": "aybassiouny", "link": "https://stackoverflow.com/users/4068350/aybassiouny"}, "edited": false, "score": 2, "creation_date": 1546420916, "post_id": 54003327, "comment_id": 94844340, "body": "Any specific reason you have to inherit from <code>Base</code>? Having <code>Base*</code> as a member &amp; adding an implicit conversion operator to <code>Base</code> should go a long way replacing inheritance."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1546421031, "post_id": 54003327, "comment_id": 94844395, "body": "Note that it may be the intention of the library that <i>it</i> controls the lifetime of all <code>Base</code> objects. Messing with that could easily be undefined behaviour. Note that its by default a bad idea to derive from a class which does not have a virtual destructor"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1546421413, "post_id": 54003327, "comment_id": 94844561, "body": "You might have your own <code>operator new</code>, but I am not sure it would be a good idea"}], "answers": [{"comments": [{"owner": {"reputation": 2602, "user_id": 1247832, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1117c8b9bab86dd779a525b769e7ac04?s=128&d=identicon&r=PG", "display_name": "MasterGberry", "link": "https://stackoverflow.com/users/1247832/mastergberry"}, "edited": false, "score": 0, "creation_date": 1546418702, "post_id": 54003408, "comment_id": 94843479, "body": "Yeah this is the only solution I came up with at the moment, but if there is no other way to do it I will have to go with this approach."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 4, "creation_date": 1546419135, "post_id": 54003408, "comment_id": 94843646, "body": "This is a <i>very dangerous anti-pattern</i>. Your derived class contains a irrelevant base class copy which might only be default-initialized. When you use the derived class as a base class, the actions are applied to the dummy part, not the real base class in the pointer."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1546419261, "post_id": 54003408, "comment_id": 94843682, "body": "@liliscent: +1 and indeed it is dangerous and I hope I make that clear! I invite the community to downvote if they feel that changes to the library is the only feasible option. In that way future readers can gauge how folk feel about the above technique."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1546419978, "post_id": 54003408, "comment_id": 94843955, "body": "The redundant base class can be replaced in most places by <code>operator Base&amp;() { return *b; }</code> - Should work the same in most cases."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1546420988, "post_id": 54003408, "comment_id": 94844368, "body": "@StoryTeller: Indeed it would. But then you lose the relationship between a <code>Base*</code> and a <code>Derived*</code>. This question might benefit from an answer by you - you know the language better than I do.  I&#39;d upvote..."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 2, "last_activity_date": 1546419345, "last_edit_date": 1546419345, "creation_date": 1546418622, "answer_id": 54003408, "question_id": 54003327, "link": "https://stackoverflow.com/questions/54003327/is-it-possible-to-dynamically-allocate-the-extra-memory-required-for-a-derived-c/54003408#54003408", "title": "Is it possible to dynamically allocate the extra memory required for a derived class from an existing base class?", "body": "<p>No this is not possible: essentially there's no C style <code>realloc</code> available that will somehow turn a <code>Base*</code> into a <code>Derived*</code>.</p>\n\n<p>But a \"pattern\" I've seen in the past involves <em>both</em> inheriting from <code>Base</code> <em>and</em> storing a pointer to a <code>Base</code> in <code>Derived</code>:</p>\n\n<pre><code>class Derived : public Base\n{\n    Base* b;\n};\n</code></pre>\n\n<p>You then write a method in <code>Derived</code> to <em>attach</em> a <code>Base</code> pointer. That is the technique you use to introduce the extra functionality. The fact that your keep <code>Base</code> in the inheritance means that you can pass a <code>Derived*</code> as a <code>Base*</code> where necessary.</p>\n\n<p>Of course this has its dangers. You have to be <em>really</em> careful in all the methods to use the correct pointer <code>b</code> or the base class <code>this</code>. Plus you have to take care when destroying <code>b</code> on destruction. As a bare minimum I'd make <code>Derived</code> non-copyable if that's possible.</p>\n"}], "owner": {"reputation": 2602, "user_id": 1247832, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1117c8b9bab86dd779a525b769e7ac04?s=128&d=identicon&r=PG", "display_name": "MasterGberry", "link": "https://stackoverflow.com/users/1247832/mastergberry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 54003408, "answer_count": 1, "score": 1, "last_activity_date": 1546853169, "creation_date": 1546418084, "question_id": 54003327, "link": "https://stackoverflow.com/questions/54003327/is-it-possible-to-dynamically-allocate-the-extra-memory-required-for-a-derived-c", "title": "Is it possible to dynamically allocate the extra memory required for a derived class from an existing base class?", "body": "<p>Is it possible to have a derived class add the extra memory to a pointer that is returned from somewhere else? </p>\n\n<p>The reasoning is I am using a library that returns <code>Base *</code> to me, and I add some extra functionality to it with <code>Derived *</code>. The problem is I have to create a whole new object when doing this currently and am losing the original pointer which is used internally by the library for updates.</p>\n\n<p>Example of what I am trying to do in simple code:</p>\n\n<pre><code>class Base \n{\npublic:\n  Base() {}\n  ~Base() = default;\n\n  void BaseMethod();\nprivate:\n  int foo;\n};\n\nclass Derived : public Base\n{\npublic:\n  Derived() : Base() {}\n  ~Derived() = default;\n\n  void DerivedMethod();\nprivate:\n  int bar;\n}\n\n// Somewhere else\nBase* baseClass = new Base();\n\n// This is the important part/question. \n// Is there some way to \"allocate\" the missing memory to make \"baseClass\" a Derived?\n// I don't want to allocate an entirely new object, I just want to find out if it \n// is possible to allocate the missing memory to make Base a Derived \n// (and use the same pointer still)\nDerived* derivedClass = SomehowAddExtraMemoryTo(baseClass);\n</code></pre>\n"}, {"tags": ["c++", "polymorphism", "operator-overloading", "virtual-functions", "friend-function"], "answers": [{"tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 4, "last_activity_date": 1546414837, "creation_date": 1546414837, "answer_id": 54002819, "question_id": 54002719, "link": "https://stackoverflow.com/questions/54002719/doing-operator-overloading-and-polymorphism-correctly/54002819#54002819", "title": "doing operator overloading and polymorphism correctly", "body": "<p>In general, having operator overloading an polymorphism in the same class is an indication that you're mixing value-style classes and identity-style classes, and thus a C++-specific code smell.</p>\n\n<p>But I would say that the stream insertion operator is an exception.</p>\n\n<p>The solution is to overload the operator once, and forward to a function that is more amenable to overriding.</p>\n\n<pre><code>class AST {\npublic:\n  virtual void print(std::ostream&amp; s) const = 0;\n  virtual ~AST() {} // you probably want this one too\n};\n\n// no need for friendliness\nstd::ostream&amp; operator &lt;&lt;(std::ostream&amp; s, const AST&amp; node) {\n  node.print(s);\n  return s;\n}\n</code></pre>\n\n<p>And then you put the actual printing logic into the <code>print</code> overrides of each class.</p>\n\n<p>But I also feel the need to remark that your <code>AST</code> class doesn't seem useful. There is really nothing an operator and a binary expression have in common. It's also conceptually wrong to say that an operator or an expression is an abstract syntax tree. An expression is a <em>part</em> of an AST, a single node in the tree. An operator is a part of an expression. The entire tree is something different.</p>\n\n<p>You should have separate hierarchy roots for <code>operator_</code> and <code>expr</code>. And yes, that probably means you have to do the printing stuff twice. It's worth it.</p>\n"}], "owner": {"reputation": 568, "user_id": 6082378, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/068b373612159246ce9c2e723573e1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jayendra Parmar", "link": "https://stackoverflow.com/users/6082378/jayendra-parmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 54002819, "answer_count": 1, "score": -1, "last_activity_date": 1546414837, "creation_date": 1546414210, "question_id": 54002719, "link": "https://stackoverflow.com/questions/54002719/doing-operator-overloading-and-polymorphism-correctly", "title": "doing operator overloading and polymorphism correctly", "body": "<p>I have two wrapper classes for string and int and one to represent Binary Operation and overloading the operator <code>&lt;&lt;</code> to write them in a string format. Unfortunately, I can't overload <code>&lt;&lt;</code> without <code>friend</code> function and I can't get polymorphism without <code>virtual</code> and can't use <code>friend</code> with <code>virtual</code> !!</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nclass AST {};\nclass expr: public AST {};\n\nclass operator_: public AST {};\n\nclass BinOp: public expr {\nprivate:\n  expr *_left;\n  expr *_right;\n  operator_ *_op;\npublic:\n  BinOp(expr *p_left, expr *p_right, operator_ *p_op):_left(p_left),_right(p_right),_op(p_op) {}\n  friend std::ostream &amp;operator&lt;&lt; (std::ostream &amp;out, const BinOp &amp;binop) {\n    out &lt;&lt; (binop._left) &lt;&lt; \" \" &lt;&lt; (binop._op) &lt;&lt; \" \" &lt;&lt; (binop._right);\n  }\n};\n\nclass LShift: public operator_ {\npublic:\n  LShift() {}\n  friend std::ostream &amp;operator&lt;&lt; (std::ostream &amp;out, const LShift &amp;lshift) {\n    out &lt;&lt; \"&lt;&lt;\";\n  }\n};\n\nclass Name: public expr {\nprivate:\n  std::string _id;\npublic:\n  Name(std::string p_id) { _id = p_id; }\n  friend std::ostream &amp;operator&lt;&lt; (std::ostream &amp;out, const Name &amp;name) {\n    out &lt;&lt; name._id;\n  }\n};\n\nclass Num: public expr {\nprivate:\n  int n;\npublic:\n  Num(int p_n) { n = p_n; }\n  friend std::ostream &amp;operator&lt;&lt; (std::ostream &amp;out, const Num &amp;num) {\n    out &lt;&lt; num.n;\n  }\n};\n\nint main() {\n\n  auto name = Name(\"x\");\n  auto num  = Num(5);\n  auto lshift = LShift();\n  auto binop = BinOp(&amp;name, &amp;num, &amp;lshift);\n\n  std::cout &lt;&lt; binop &lt;&lt; '\\n';\n\n  return 0;\n}\n</code></pre>\n\n<p>So the program mentioned above outputs the pointer, </p>\n\n<pre><code>0x7ffd05935db0 0x7ffd05935d8b 0x7ffd05935d8c\n</code></pre>\n\n<p>but instead of a pointer, I need the objects needed to print.</p>\n\n<pre><code>x &lt;&lt; 5\n</code></pre>\n"}, {"tags": ["c++", "rocksdb"], "answers": [{"comments": [{"owner": {"reputation": 8284, "user_id": 3018377, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LlpBb.jpg?s=128&g=1", "display_name": "Loc", "link": "https://stackoverflow.com/users/3018377/loc"}, "edited": false, "score": 0, "creation_date": 1608397255, "post_id": 54003550, "comment_id": 115573915, "body": "RocksDB is a DATABASE but it is neither RDBMS database nor Schemed database."}], "tags": [], "owner": {"reputation": 2154, "user_id": 362792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283347e31dc72eedd581c8b744e681f4?s=128&d=identicon&r=PG", "display_name": "Hitobat", "link": "https://stackoverflow.com/users/362792/hitobat"}, "is_accepted": true, "score": 2, "last_activity_date": 1546419476, "creation_date": 1546419476, "answer_id": 54003550, "question_id": 54002486, "link": "https://stackoverflow.com/questions/54002486/is-rocksdb-a-good-choice-for-storing-homogeneous-objects/54003550#54003550", "title": "Is RocksDB a good choice for storing homogeneous objects?", "body": "<p>As I understand, RocksDB is really a KeyValue store and not a database at all.\nThis means you only get the facility to store binary key and value data. Unlike a normal database (e.g. MySQL, SQLite) you don't get tables where you can define the columns/types etc..</p>\n\n<p>Therefore it is your program which determines how the data would be stored.</p>\n\n<p>One possibility is to store your data as JSON values, in which case as you say you pay the cost of storing the \"schema\" (i.e. the JSON field names) in the values.</p>\n\n<p>Another choice might be, you have a special key (for example) called <strong>SCHEMA</strong> that contains an AVRO schema of all your object types. Your app can read this on startup, initialise the readers/writers, and then it knows how to process each key+value stored in RocksDB.</p>\n\n<p>Yet another choice might be you hard-code the logic in your app. You could use any number of libraries for this, including AVRO (as mentioned above) or MsgPack and its variants. In this case you do need to be careful if you intend to use a RocksDB data from a previous version of the app, if you made any schema changes. So maybe store a version number or something in DB.</p>\n"}, {"tags": [], "owner": {"reputation": 4916, "user_id": 3991400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5049bb61601c16ae408f5a56b5ed2518?s=128&d=identicon&r=PG&f=1", "display_name": "midor", "link": "https://stackoverflow.com/users/3991400/midor"}, "is_accepted": false, "score": 2, "last_activity_date": 1546514164, "creation_date": 1546514164, "answer_id": 54021240, "question_id": 54002486, "link": "https://stackoverflow.com/questions/54002486/is-rocksdb-a-good-choice-for-storing-homogeneous-objects/54021240#54021240", "title": "Is RocksDB a good choice for storing homogeneous objects?", "body": "<p>Unlike, e.g., sqlite, there is no schema metadata in RocksDB, because there is no schema: it maps a binary key to a binary value. RocksDB has no serialization built into it. If you are storing objects, you will have to serialize them yourself and use, e.g., the key, a key-prefix or column families (~ DB tables light) to distinguish the types.</p>\n\n<p>Typically you would use RocksDB to build some kind of custom database. Someone built, e.g., a cache for protobuf objects on top of it (ProfaneDB). Often I would say it is too low-level, but if you need no structured data and queries, it will work fine, is very fast, and is generally pleasant to work with (their code is readable, and sometimes the best documentation, because you will deal with database internals).</p>\n\n<p>I have used a varint key-prefix in a small toy-application before, which comes at just a byte overhead up to 127 types, but column families are probably preferable for a prod application. They also have constant overhead, and can be individually tuned, added, dropped, and managed. I wouldn't forsake the additional features you get from them for a few bytes. That is also roughly representative of the level at which you will deal with problems, if you go with RocksDB.</p>\n"}], "owner": {"reputation": 2921, "user_id": 385094, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/623e2b3f43d5ada906a955fb8817281e?s=128&d=identicon&r=PG", "display_name": "Boinst", "link": "https://stackoverflow.com/users/385094/boinst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "accepted_answer_id": 54003550, "answer_count": 2, "score": 2, "last_activity_date": 1546514164, "creation_date": 1546412712, "question_id": 54002486, "link": "https://stackoverflow.com/questions/54002486/is-rocksdb-a-good-choice-for-storing-homogeneous-objects", "title": "Is RocksDB a good choice for storing homogeneous objects?", "body": "<p>I'm looking for an embeddable data storage engine in C++. RocksDB is a key-value store. </p>\n\n<p>My data is very homogeneous. I have a modest number of types (on the order of 20), and I store many instances (on the order of 1 million) of those types.</p>\n\n<p>I imagine that the homogeneity of my data makes RocksDB a poor choice. If I serialise each object individually, surely I'm duplicating the schema metadata? And surely that will result in poor performance?</p>\n\n<p>So my question: <strong>Is RocksDB a good choice for storing homogeneous objects?</strong> If so, how does one avoid the performance implications of duplicating schema metadata?</p>\n"}, {"tags": ["c++", "class"], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 6, "last_activity_date": 1546411077, "creation_date": 1546411077, "answer_id": 54002233, "question_id": 54002183, "link": "https://stackoverflow.com/questions/54002183/string-undeclared-identifier-in-class/54002233#54002233", "title": "string undeclared identifier in class", "body": "<p>You need to make sure that <code>string</code> is a valid type in the .h file.</p>\n\n<ol>\n<li>Add <code>#include &lt;string&gt;</code>.</li>\n<li>Use <code>std::string</code> instead of just <code>string</code>.</li>\n</ol>\n\n<hr>\n\n<pre><code>#ifndef BOOK_H\n#define BOOK_H\n\n#include &lt;string&gt;\n\nclass book\n{\n   private:\n      std::string name;\n\n   public:\n      book(std::string n = \"default\") : name(n) {};\n      ~book() {};\n      void printname();\n};\n\n#endif\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1546412249, "post_id": 54002389, "comment_id": 94841485, "body": "In this code the default value will never be used, as you don&#39;t have a default constructor (and the provided one replaces it)"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1546412320, "post_id": 54002389, "comment_id": 94841505, "body": "I like the addition, however, you didn&#39;t explain where the actual issue was"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1546417897, "post_id": 54002389, "comment_id": 94843184, "body": "You need to add a default constructor:  <code>book() = default;</code>"}], "tags": [], "owner": {"reputation": 69, "user_id": 8968475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a694d66de2e2bba0f30e8f14453e9bb5?s=128&d=identicon&r=PG&f=1", "display_name": "betelgeuse", "link": "https://stackoverflow.com/users/8968475/betelgeuse"}, "is_accepted": false, "score": 1, "last_activity_date": 1546476848, "last_edit_date": 1546476848, "creation_date": 1546412091, "answer_id": 54002389, "question_id": 54002183, "link": "https://stackoverflow.com/questions/54002183/string-undeclared-identifier-in-class/54002389#54002389", "title": "string undeclared identifier in class", "body": "<p><a href=\"https://stackoverflow.com/a/54002233/8968475\">This answer</a> appears to address your question.\nAs a side note, since C++11, you can also specify default values for class members. So you could just do this instead:</p>\n\n<pre><code>#ifndef BOOK_H\n#define BOOK_H\n\n#include &lt;string&gt;\n\nclass book\n{\n   private:\n      std::string name = \"default\";\n\n   public:\n      book() = default;\n      book(std::string n) : name(n) {};\n      ~book() {};\n      void printname();\n};\n\n#endif\n</code></pre>\n"}], "owner": {"reputation": 136, "user_id": 10454609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/585878932e670242b83f045caa78a47a?s=128&d=identicon&r=PG&f=1", "display_name": "meysamimani", "link": "https://stackoverflow.com/users/10454609/meysamimani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "accepted_answer_id": 54002233, "answer_count": 2, "score": 0, "last_activity_date": 1546476848, "creation_date": 1546410787, "last_edit_date": 1546412991, "question_id": 54002183, "link": "https://stackoverflow.com/questions/54002183/string-undeclared-identifier-in-class", "title": "string undeclared identifier in class", "body": "<p>I am learning c++ inheritance and here I have a problem.\nif I make this simple code all in main.cpp file it will works without any \nproblem.</p>\n\n<p>but when I seperate the files in header file and else\nit won't work and it gives me some errors.</p>\n\n<p>here is the code of header file named book.h</p>\n\n<pre><code> #ifndef BOOK_H\n #define BOOK_H\n\n class book\n{\n private:\n string name;\n\n public:\n book(string n = \"default\") : name(n) {};\n ~book() {};\n void printname();\n};\n\n#endif\n</code></pre>\n\n<p>and here is the code of book.cpp that I defined the function of this class\nin this file.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;Windows.h&gt;\n#include &lt;string&gt;\n#include \"book.h\"\n\nusing namespace std;\n\nvoid book::printname()\n{\n cout &lt;&lt; name &lt;&lt; endl;\n return;\n}\n</code></pre>\n\n<p>and finally the main.cpp file: </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;Windows.h&gt; \n#include &lt;string&gt;\n#include \"book.h\"\n\nusing namespace std;\n\n int main()\n{\n system(\"color 0A\");\n book programing(\"c++\");\n cout &lt;&lt; \"the name of the book is \";\n programing.printname();\n\n system(\"pause\");\n return;\n}\n</code></pre>\n\n<p>and the errors that I get: </p>\n\n<blockquote>\n  <p>Severity  Code    Description Project File    Line    Suppression State</p>\n  \n  <p>Error C2065   'name': undeclared identifier   book    d:\\vs\n  program\\book\\book\\book.cpp    10  </p>\n  \n  <p>Error C3646   'name': unknown override specifier  book    d:\\vs\n  program\\book\\book\\book.h  7   </p>\n  \n  <p>Error C4430   missing type specifier - int assumed. Note: C++ does not\n  support default-int   book    d:\\vs program\\book\\book\\book.h  7   </p>\n  \n  <p>Error C2061   syntax error: identifier 'string'   book    d:\\vs\n  program\\book\\book\\book.h  10  </p>\n  \n  <p>Error C2065   'n': undeclared identifier  book    d:\\vs\n  program\\book\\book\\book.h  10  </p>\n  \n  <p>Error C2614   'book': illegal member initialization: 'name' is not a\n  base or member    book    d:\\vs program\\book\\book\\book.h  10  </p>\n  \n  <p>Error C3646   'name': unknown override specifier  book    d:\\vs\n  program\\book\\book\\book.h  7   </p>\n  \n  <p>Error C4430   missing type specifier - int assumed. Note: C++ does not\n  support default-int   book    d:\\vs program\\book\\book\\book.h  7<br>\n  Error C2061   syntax error: identifier 'string'   book    d:\\vs\n  program\\book\\book\\book.h  10  </p>\n  \n  <p>Error C2065   'n': undeclared identifier  book    d:\\vs\n  program\\book\\book\\book.h  10  </p>\n  \n  <p>Error C2614   'book': illegal member initialization: 'name' is not a\n  base or member    book    d:\\vs program\\book\\book\\book.h  10</p>\n</blockquote>\n\n<p>and other errors...</p>\n"}, {"tags": ["c++", "opencv", "ros"], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 7350738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3aa1e3f328cf0531207393badababe?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Ali", "link": "https://stackoverflow.com/users/7350738/mohammad-ali"}, "is_accepted": true, "score": 0, "last_activity_date": 1546606020, "creation_date": 1546606020, "answer_id": 54039270, "question_id": 54002104, "link": "https://stackoverflow.com/questions/54002104/how-to-incorporate-videowriter-code-into-image-publisher-code-of-ros/54039270#54039270", "title": "How to incorporate VideoWriter code into image_publisher code of ros?", "body": "<p>You cannot send opencv Mat inside ros topic system since <code>Image</code> topic has another coding system.</p>\n\n<p>You need to use <code>cv_bridge</code> to convert images that you got from Opencv to ROS-image Format</p>\n\n<p>there are some details and examples <a href=\"http://wiki.ros.org/cv_bridge/Tutorials/UsingCvBridgeToConvertBetweenROSImagesAndOpenCVImages\" rel=\"nofollow noreferrer\">Here</a></p>\n"}], "owner": {"reputation": 198, "user_id": 9999528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0784da2545c5a947a95202ef28064787?s=128&d=identicon&r=PG&f=1", "display_name": "Ender Ayhan", "link": "https://stackoverflow.com/users/9999528/ender-ayhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 54039270, "answer_count": 1, "score": 0, "last_activity_date": 1546606020, "creation_date": 1546410320, "question_id": 54002104, "link": "https://stackoverflow.com/questions/54002104/how-to-incorporate-videowriter-code-into-image-publisher-code-of-ros", "title": "How to incorporate VideoWriter code into image_publisher code of ros?", "body": "<p>I am setting up a ros system to publish images with ros, c++ and opencv-2 for my drone. The code, below, is publishing raw images. While publishing, I want to write <strong>gray-scale</strong> images frame-by-frame with resolution of <strong>1280 x 720</strong> to record a video. I have found a readily available video writing code with opencv. However, I could not incorporate this code into image_publisher code. Here is the image_publisher code:</p>\n\n<pre><code>#include &lt;ros/ros.h&gt;\n#include &lt;camera_info_manager/camera_info_manager.h&gt;\n#include &lt;sensor_msgs/Image.h&gt;\n#include &lt;sensor_msgs/CameraInfo.h&gt;\n#include &lt;opencv2/opencv.hpp&gt;\n\nint main(int argc, char **argv)\n{\nROS_INFO(\"Starting image_pub ROS node...\\n\");\n\nros::init(argc, argv, \"image_pub\");\nros::NodeHandle nh(\"~\");\n\nstd::string camera_topic;\nstd::string camera_info_topic;\nstd::string camera_info_url;\nstd::string img_path;\nstd::string frame_id;\nfloat       pub_rate;\nint         start_sec;\nbool        repeat;\nnh.param&lt;std::string&gt;(\"camera_topic\",      camera_topic,      \"/camera/image_raw\");\nnh.param&lt;std::string&gt;(\"camera_info_topic\", camera_info_topic, \"/camera/camera_info\");\nnh.param&lt;std::string&gt;(\"camera_info_url\",   camera_info_url,   \"\");\nnh.param&lt;std::string&gt;(\"img_path\", img_path, \"\");\nnh.param&lt;std::string&gt;(\"frame_id\", frame_id, \"\");\nnh.param(\"pub_rate\",  pub_rate, 30.0f);\nnh.param(\"start_sec\", start_sec, 0);\nnh.param(\"repeat\",    repeat, false);\n\nROS_INFO(\"CTopic : %s\", camera_topic.c_str());\nROS_INFO(\"ITopic : %s\", camera_info_topic.c_str());\nROS_INFO(\"CI URL : %s\", camera_info_url.c_str());\nROS_INFO(\"Source : %s\", img_path.c_str());\nROS_INFO(\"Rate   : %.1f\", pub_rate);\nROS_INFO(\"Start  : %d\", start_sec);\nROS_INFO(\"Repeat : %s\", repeat ? \"yes\" : \"no\");\nROS_INFO(\"FrameID: %s\", frame_id.c_str());\n\ncamera_info_manager::CameraInfoManager camera_info_manager(nh);\nif (camera_info_manager.validateURL(camera_info_url))\n    camera_info_manager.loadCameraInfo(camera_info_url);\n\nros::Publisher img_pub  = nh.advertise&lt;sensor_msgs::Image&gt;(camera_topic, 1);\nros::Publisher info_pub = nh.advertise&lt;sensor_msgs::CameraInfo&gt;(camera_info_topic, 1);\n\ncv::VideoCapture vid_cap(img_path.c_str());\nif (start_sec &gt; 0)\n    vid_cap.set(CV_CAP_PROP_POS_MSEC, 1000.0 * start_sec);\n\nros::Rate rate(pub_rate);\nwhile (ros::ok())\n{\n    cv::Mat img;\n    if (!vid_cap.read(img))\n    {\n        if (repeat)\n        {\n            vid_cap.open(img_path.c_str());\n            if (start_sec &gt; 0)\n                vid_cap.set(CV_CAP_PROP_POS_MSEC, 1000.0 * start_sec);\n            continue;\n        }\n        ROS_ERROR(\"Failed to capture frame.\");\n        ros::shutdown();\n    }\n    else\n    {\n        //ROS_DEBUG(\"Image: %dx%dx%d, %zu, %d\", img.rows, img.cols, img.channels(), img.elemSize(), img.type() == CV_8UC3);\n        if (img.type() != CV_8UC3)\n            img.convertTo(img, CV_8UC3);\n        // Convert image from BGR format used by OpenCV to RGB.\n        cv::cvtColor(img, img, CV_BGR2RGB);\n\n        auto img_msg = boost::make_shared&lt;sensor_msgs::Image&gt;();\n        img_msg-&gt;header.stamp    = ros::Time::now();\n        img_msg-&gt;header.frame_id = frame_id;\n        img_msg-&gt;encoding = \"rgb8\";\n        img_msg-&gt;width = img.cols;\n        img_msg-&gt;height = img.rows;\n        img_msg-&gt;step = img_msg-&gt;width * img.channels();\n        auto ptr = img.ptr&lt;unsigned char&gt;(0);\n        img_msg-&gt;data = std::vector&lt;unsigned char&gt;(ptr, ptr + img_msg-&gt;step * img_msg-&gt;height);\n        img_pub.publish(img_msg);\n\n        if (camera_info_manager.isCalibrated())\n        {\n            auto info = boost::make_shared&lt;sensor_msgs::CameraInfo&gt;(camera_info_manager.getCameraInfo());\n            info-&gt;header = img_msg-&gt;header;\n            info_pub.publish(info);\n        }\n    }\n    ros::spinOnce();\n    rate.sleep();\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>The video writing code (<a href=\"https://www.learnopencv.com/read-write-and-display-a-video-using-opencv-cpp-python/\" rel=\"nofollow noreferrer\">referred to this link</a>):</p>\n\n<pre><code>#include \"opencv2/opencv.hpp\"\n#include &lt;iostream&gt;\n\nusing namespace std;\nusing namespace cv;\n\nint main(){\n\n// Create a VideoCapture object and use camera to capture the video\nVideoCapture cap(0); \n\n// Check if camera opened successfully\nif(!cap.isOpened())\n{\n  cout &lt;&lt; \"Error opening video stream\" &lt;&lt; endl; \n  return -1; \n} \n\n// Default resolution of the frame is obtained.The default resolution is system dependent. \nint frame_width = cap.get(CV_CAP_PROP_FRAME_WIDTH); \nint frame_height = cap.get(CV_CAP_PROP_FRAME_HEIGHT); \n\n// Define the codec and create VideoWriter object.The output is stored in 'outcpp.avi' file. \nVideoWriter video(\"outcpp.avi\",CV_FOURCC('M','J','P','G'),10, \nSize(frame_width,frame_height)); \nwhile(1)\n{ \nMat frame; \n\n// Capture frame-by-frame \ncap &gt;&gt; frame;\n\n// If the frame is empty, break immediately\nif (frame.empty())\n  break;\n\n// Write the frame into the file 'outcpp.avi'\nvideo.write(frame);\n\n// Display the resulting frame    \nimshow( \"Frame\", frame );\n\n// Press  ESC on keyboard to  exit\nchar c = (char)waitKey(1);\nif( c == 27 ) \n  break;\n}\n\n// When everything done, release the video capture and write object\ncap.release();\nvideo.release();\n\n// Closes all the windows\ndestroyAllWindows();\nreturn 0;\n  }\n</code></pre>\n\n<p>Firstly, I tried incorporating video writing code (without grayscale) into publisher code. But it failed to run.  All in all, image_publisher code should result a video after completing its task. What is the right way of doing this ?</p>\n"}, {"tags": ["c++", "file", "c++11", "fstream", "reinterpret-cast"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1546410315, "post_id": 54002083, "comment_id": 94840842, "body": "Are you deliberately trying to read from the same file while it has not been closed after the write operations? Or is that an oversight?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1546410396, "post_id": 54002083, "comment_id": 94840867, "body": "Also, you are reading into <code>x</code> twice instead of reading into <code>x</code> and <code>y</code>."}, {"owner": {"reputation": 37, "user_id": 9556578, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NThvz3_OfG4/AAAAAAAAAAI/AAAAAAAAAC0/qlgQf7xthSM/photo.jpg?sz=128", "display_name": "ysgc", "link": "https://stackoverflow.com/users/9556578/ysgc"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1546453695, "post_id": 54002083, "comment_id": 94859438, "body": "Yes, that was a typo.. Let me edit it now."}], "answers": [{"tags": [], "owner": {"reputation": 7838, "user_id": 383045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72da00bd74a5744f9cb89d1a52a6d447?s=128&d=identicon&r=PG", "display_name": "yzt", "link": "https://stackoverflow.com/users/383045/yzt"}, "is_accepted": true, "score": 0, "last_activity_date": 1546413181, "last_edit_date": 1546413181, "creation_date": 1546412315, "answer_id": 54002422, "question_id": 54002083, "link": "https://stackoverflow.com/questions/54002083/failed-to-read-data-using-reinterpret-castchar-in-c/54002422#54002422", "title": "Failed to read data using reinterpret_cast&lt;char*&gt; in C++", "body": "<p>As have been pointed out in comments, you have at least two bugs:</p>\n\n<p>The first problem is in your reads: both your reads use the address of <code>x</code> and the size of <code>y</code>, which I'm sure is just a typo.</p>\n\n<p>Second, you have to <code>close()</code> the file you opened for writing (or at least, <em>flush</em> your writes (<code>sync()</code>) before reading that same data again, but that needs a whole lot of caution and special rules.) Anyways, you need to close the file, either by letting the handle (<code>file</code> in this case) fall out of scope and getting its destructor called, or calling <code>file.close()</code> yourself (after the writes.)</p>\n\n<p>To prevent this problem, you generally have to check for errors <em>every time</em> you do any I/O. To do that, you can use the name of your file handle like a boolean variable, e.g.:</p>\n\n<pre><code>in.read(reinterpret_cast&lt;char*&gt;(&amp;x),sizeof(x));\nif (!in)\n    cerr &lt;&lt; \"First read failed.\" &lt;&lt; endl;\nin.read(reinterpret_cast&lt;char*&gt;(&amp;y),sizeof(y));\nif (!in)\n    cout &lt;&lt; \"Second read failed.\" &lt;&lt; endl;\n</code></pre>\n\n<p>I you want to know what actually is going on, the class <code>std::istream</code> has an explicit conversion to <code>bool</code> that returns whether the last operation succeeded or not (or whether the stream is in a readable/good condition or not.) There is also a host of member functions defined for C++ streams (both input and output) that help you check for errors, the end of a stream, etc., e.g. <code>bad()</code>, <code>good()</code>, <code>fail()</code>, <code>eof()</code>, etc.</p>\n\n<p>Again, just remember that any I/O operation can fail at any time for various reasons, so check its status!</p>\n"}], "owner": {"reputation": 37, "user_id": 9556578, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NThvz3_OfG4/AAAAAAAAAAI/AAAAAAAAAC0/qlgQf7xthSM/photo.jpg?sz=128", "display_name": "ysgc", "link": "https://stackoverflow.com/users/9556578/ysgc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "accepted_answer_id": 54002422, "answer_count": 1, "score": -1, "last_activity_date": 1546453712, "creation_date": 1546410194, "last_edit_date": 1546453712, "question_id": 54002083, "link": "https://stackoverflow.com/questions/54002083/failed-to-read-data-using-reinterpret-castchar-in-c", "title": "Failed to read data using reinterpret_cast&lt;char*&gt; in C++", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;fstream&gt;\nusing namespace std;\n\nint main(){\n\n// write file\n\n    string file_name = \"random_fstream.dat\";\n    ofstream file(file_name, ios_base::out | ios_base::binary);\n\n    if (!file) {return EXIT_FAILURE;}\n\n    int r = 2; \n    int c = 3;\n\n    file.write(reinterpret_cast&lt;char*&gt;(&amp;r),sizeof(r));\n    file.write(reinterpret_cast&lt;char*&gt;(&amp;c),sizeof(c));\n\n//------------------------------------------------\n\n// read file\n\n    ifstream in(file_name, ios_base::in | ios_base::binary);\n    if (!in) {return EXIT_FAILURE;}\n\n    int x = 0;\n    int y = 0;\n\n    in.read(reinterpret_cast&lt;char*&gt;(&amp;x),sizeof(x));\n    in.read(reinterpret_cast&lt;char*&gt;(&amp;y),sizeof(y));\n\n    cout &lt;&lt; x &lt;&lt; y &lt;&lt; endl;\n\n\n    return 0;\n} \n</code></pre>\n\n<p>I was trying to practice write and read file in <strong>C++</strong>. First step was to write int value 2 and 3 into the file with binary form. Second step was to read the two number from that file.</p>\n\n<p>Then I got x and y valued both equal to 0, but I expected to receive <code>x=2</code> and <code>y=3</code>. Where did I do wrong?</p>\n"}, {"tags": ["c++", "arrays"], "answers": [{"tags": [], "owner": {"reputation": 3856, "user_id": 4188894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jj4yA.jpg?s=128&g=1", "display_name": "Gyapti Jain", "link": "https://stackoverflow.com/users/4188894/gyapti-jain"}, "is_accepted": false, "score": 1, "last_activity_date": 1546410002, "last_edit_date": 1546410002, "creation_date": 1546409552, "answer_id": 54001993, "question_id": 54001908, "link": "https://stackoverflow.com/questions/54001908/initializing-elements-of-a-2d-array-using-stdarray-c/54001993#54001993", "title": "Initializing elements of a 2D array using std::array. c++", "body": "<p><strong>Issue 1</strong>: Dimensions are swtitched</p>\n\n<pre><code>array&lt;array&lt;float,3&gt;,4&gt; color = {\n//                 ^  ^\n</code></pre>\n\n<p><strong>Issue 2</strong>: Explicitly mention the type of array in initializer. Compiler can't deduce it.</p>\n\n<pre><code>  array&lt;float,3&gt;{   0.0 , 0.1686 , 0.2117 },\n  // ^^^^^^^^^^^^\n  {   0.0274 , 0.2117 , 0.2588},\n  {   0.3450 , 0.4313 , 0.4588},\n  {   0.3960 , 0.4823, 0.5137}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 10478476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CtcN5_n9BKk/AAAAAAAAAAI/AAAAAAAAAB0/luZmL-Okf38/photo.jpg?sz=128", "display_name": "icebowl", "link": "https://stackoverflow.com/users/10478476/icebowl"}, "edited": false, "score": 0, "creation_date": 1546409787, "post_id": 54001997, "comment_id": 94840702, "body": "Wow!  That was simple.  Thanks for all the posts and help!"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1546409849, "last_edit_date": 1546409849, "creation_date": 1546409581, "answer_id": 54001997, "question_id": 54001908, "link": "https://stackoverflow.com/questions/54001908/initializing-elements-of-a-2d-array-using-stdarray-c/54001997#54001997", "title": "Initializing elements of a 2D array using std::array. c++", "body": "<p>You have the initializer arrays transposed to a <code>4 x 3</code> array. Hence, it does not match the declaration of <code>color</code>.</p>\n\n<p>You can use:</p>\n\n<pre><code>array&lt;array&lt;float, 3&gt;, 4&gt; color = \n   {\n      {  0.0 , 0.1686 , 0.2117 },     // 1st of four of the outer array\n      {  0.0274 , 0.2117 , 0.2588},\n      {  0.3450 , 0.4313 , 0.4588},\n      {  0.3960 , 0.4823, 0.5137}    // 4th of four of the outer array\n   };\n</code></pre>\n\n<p>If you need to have a <code>3 x 4</code> array, you have to change the initializer array.</p>\n\n<p>Ex:</p>\n\n<pre><code>array&lt;array&lt;float, 4&gt;, 3&gt; color = \n   {\n      {  0.0 , 0.1686 , 0.2117, 1 },     // 1st of three of the outer array\n      {  0.0274 , 0.2117 , 0.2588, 2},\n      {  0.3960 , 0.4823, 0.5137, 3}    // 3rd of three of the outer array\n   };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 9272586, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I4maCJTM5Vk/AAAAAAAAAAI/AAAAAAAAADg/h3-71fGTFk4/photo.jpg?sz=128", "display_name": "Richi Dubey", "link": "https://stackoverflow.com/users/9272586/richi-dubey"}, "is_accepted": false, "score": 2, "last_activity_date": 1546410022, "creation_date": 1546410022, "answer_id": 54002062, "question_id": 54001908, "link": "https://stackoverflow.com/questions/54001908/initializing-elements-of-a-2d-array-using-stdarray-c/54002062#54002062", "title": "Initializing elements of a 2D array using std::array. c++", "body": "<p>When you're doing  </p>\n\n<pre><code> array&lt;array&lt;float,4&gt;,3&gt; color \n</code></pre>\n\n<p>you're saying that the inner array has 4 elements and the outer one has 3. So it becomes a 4*3 matrix while you're defining a 3*4 matrix.</p>\n\n<p>Try doing :</p>\n\n<pre><code>array&lt;array&lt;float,3&gt;,4&gt; color = {{\n  {  0.0 , 0.1686 , 0.2117 },\n  {   0.0274 , 0.2117 , 0.2588},\n  {   0.3450 , 0.4313 , 0.4588},\n  {   0.3960 , 0.4823, 0.5137}\n  }};\n</code></pre>\n\n<p>and remember to add {{ - two braces before defining the array of inner arrays and you'll be good to go!</p>\n"}], "owner": {"reputation": 5, "user_id": 10478476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CtcN5_n9BKk/AAAAAAAAAAI/AAAAAAAAAB0/luZmL-Okf38/photo.jpg?sz=128", "display_name": "icebowl", "link": "https://stackoverflow.com/users/10478476/icebowl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1546415795, "creation_date": 1546408968, "last_edit_date": 1546415795, "question_id": 54001908, "link": "https://stackoverflow.com/questions/54001908/initializing-elements-of-a-2d-array-using-stdarray-c", "title": "Initializing elements of a 2D array using std::array. c++", "body": "<p>I'm using <code>std::array&lt;array&lt;float, 4,3&gt; = . . .</code> to in\nI'm having trouble understand how to format the following code so I don't get the following error:</p>\n\n<pre><code>g++ array2d_colors.cpp -o array2dcolors.o\narray2d_colors.cpp: In function \u2018void arrayStart()\u2019:\narray2d_colors.cpp:36:7: error: too many initializers for \n\u2018std::array&lt;std::array&lt;float, 4ul&gt;, 3ul&gt;\u2019        };\n       ^\n\n\nusing namespace;\n  array&lt;array&lt;float,4&gt;,3&gt; color = {\n      {  0.0 , 0.1686 , 0.2117 },\n      {   0.0274 , 0.2117 , 0.2588},\n      {   0.3450 , 0.4313 , 0.4588},\n      {   0.3960 , 0.4823, 0.5137}\n      };\n</code></pre>\n\n<p>This  code worked in another study:</p>\n\n<pre><code>using namespace;\narray&lt;array&lt;float, 2&gt;, 2&gt; a1 = {{{5,6},{7,8}}};\n</code></pre>\n\n<p>That is a lot of \"{'s\" . What if a want to create a 16x3?\nI'd appreciate some help.</p>\n"}, {"tags": ["c++", "compiler-construction", "g++"], "comments": [{"owner": {"reputation": 422, "user_id": 1060378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CFCzq.jpg?s=128&g=1", "display_name": "schroeder", "link": "https://stackoverflow.com/users/1060378/schroeder"}, "edited": false, "score": 0, "creation_date": 1546424544, "post_id": 54004610, "comment_id": 94845895, "body": "You are asking about a language&#39;s internal logging function. This is not a security question even though you are concerned about a potential DoS implication."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 3, "creation_date": 1546425294, "post_id": 54004610, "comment_id": 94846219, "body": "Probably best suited for gcc dev mailing list."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1546427688, "post_id": 54004610, "comment_id": 94847313, "body": "What does the content of the log look like?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1546453678, "post_id": 54004610, "comment_id": 94859430, "body": "Unless the &quot;victim&quot; is some kind of online compilation service, it&#39;s hard to see how this could serve as an attack. Most people don&#39;t frequently compile random source code. In what context do you worry about this?"}, {"owner": {"reputation": 7256, "user_id": 418966, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81cf776adb922e444a0a771a8a4724e5?s=128&d=identicon&r=PG", "display_name": "Cyker", "link": "https://stackoverflow.com/users/418966/cyker"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1546454630, "post_id": 54004610, "comment_id": 94859783, "body": "@rici You just got it. It&#39;s indeed online compilation service."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1546458054, "post_id": 54004610, "comment_id": 94861184, "body": "@cyker: i think expanding error logs are the least of your problems, then. Template expansion can take enormous resources, both time and memory. Even without c++, you can create macros with exponential expansions. You would definitely need to run the compiler inside a resource limited sandbox."}, {"owner": {"reputation": 7256, "user_id": 418966, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81cf776adb922e444a0a771a8a4724e5?s=128&d=identicon&r=PG", "display_name": "Cyker", "link": "https://stackoverflow.com/users/418966/cyker"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1546458909, "post_id": 54004610, "comment_id": 94861551, "body": "@rici Yes it&#39;s true that the compiler should run in a sandbox. But manually crafting a really safe sandbox is non-trivial. Using a VM or LXC looks better. For this question, well, I just found the example very interesting and would like to understand what the g++ compiler is doing with the source."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1546462093, "post_id": 54004610, "comment_id": 94862793, "body": "@Cyker: at a guess, it&#39;s failed error recovery in the parser. Probably it&#39;s doing some kind of backtracking parse after a syntax error is found, in the hopes that it can find some alternative interpretation which makes sense. Clang doesn&#39;t fall into that trap. But my point was that there are <i>valid</i> short programs whose compilation takes time exponential in the input size. If you want to worry about a DoS attack, you&#39;d need to worry about those, and that means resource-limiting the compile environment. That will take care of exponential error logs, too."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1546431809, "post_id": 54006139, "comment_id": 94849068, "body": "To be fair, as a QoI issue, I&#39;d expect a default value for <code>--fmax-error</code> to be something a little more reasonable. I thought that it was. Still, I&#39;m not seeing what sort of &quot;victimhood&quot; could be achieved with this"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 0, "last_activity_date": 1546431076, "creation_date": 1546431076, "answer_id": 54006139, "question_id": 54004610, "link": "https://stackoverflow.com/questions/54004610/why-does-g-generate-huge-error-log/54006139#54006139", "title": "Why does g++ generate huge error log?", "body": "<p>I can't really answer <em>what particular</em> set of things is going on, such that the errors are innumerable, but remember that C++ has possibly <em>the most complex</em> grammar known to man. </p>\n\n<p>Part of the job of a compiler is informing the user <strong>what</strong> is wrong with a particular input, that it isn't valid (or in the case of warnings, good) C++. </p>\n\n<p>You can get exponential growth of error messages when you recursively have an ambiguity, as the compiler will inform you of the set of things that it <em>could</em> mean. Suppose <code>?</code> could mean <code>A</code> or <code>B</code>, <code>???</code> could be any of <code>AAA</code>, <code>AAB</code>, <code>ABA</code>, <code>ABB</code>, <code>BAA</code>, <code>BAB</code>, <code>BBA</code>, or <code>BBB</code>.</p>\n\n<p>The compiler only knows that the 100000000th near-repetition isn't important to <em>you</em> when you tell it so with <code>--fmax-error</code>.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://itsecurity.stackexchange.com"], "launch_date": 1310490000, "open_beta_date": 1290106800, "closed_beta_date": 1289502000, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/security/Img/apple-touch-icon@2.png", "twitter_account": "StackSecurity", "favicon_url": "https://cdn.sstatic.net/Sites/security/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/security/Img/apple-touch-icon.png", "audience": "information security professionals", "site_url": "https://security.stackexchange.com", "api_site_parameter": "security", "logo_url": "https://cdn.sstatic.net/Sites/security/Img/logo.png", "name": "Information Security", "site_type": "main_site"}, "on_date": 1546424559, "question_id": 200663}, "owner": {"reputation": 7256, "user_id": 418966, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81cf776adb922e444a0a771a8a4724e5?s=128&d=identicon&r=PG", "display_name": "Cyker", "link": "https://stackoverflow.com/users/418966/cyker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1546431443, "creation_date": 1546406703, "last_edit_date": 1546431443, "question_id": 54004610, "link": "https://stackoverflow.com/questions/54004610/why-does-g-generate-huge-error-log", "title": "Why does g++ generate huge error log?", "body": "<p>Somewhere I saw this malformed C++ program could make g++ generate a huge error log:</p>\n\n<pre><code>int main()\n{\n    struct x struct z&lt;x(x(x(x(x(x(x(y,x(y&gt;&lt;y*,x(y*w&gt;v&lt;y*,w,x{};\n    return 0;\n}\n</code></pre>\n\n<p>By repeating <code>(x</code> many times, the error log can grow into >1GB. So this program can be used to drain a victim's system resources. While this problem can be remedied by <code>--fmax-error</code>, I'm curious what is happening inside g++ during its compilation that makes it spit such a log.</p>\n"}, {"tags": ["c++", "copy", "file-handling"], "comments": [{"owner": {"reputation": 5867, "user_id": 9125195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fc90d1f6de6ff28c739b85bdb82f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sid S", "link": "https://stackoverflow.com/users/9125195/sid-s"}, "edited": false, "score": 0, "creation_date": 1546405229, "post_id": 54001384, "comment_id": 94839637, "body": "What do you think this line does ?  <code>if (--count == 0)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10444339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vvbt0.jpg?s=128&g=1", "display_name": "Zero001", "link": "https://stackoverflow.com/users/10444339/zero001"}, "edited": false, "score": 0, "creation_date": 1546517149, "post_id": 54001507, "comment_id": 94879821, "body": "sir i tried this method but its not working properly. The code runs ask for the user to choice and copies the highest value number of line the user inputs. For example :cout&lt;&lt;&quot;How many books do you want to buy?\\n&quot;; cin&gt;&gt;4(loop runs 4 times) and in this four times the highest number the user gives let suppose 2,1,5,3 the file copies 5 lines from 1 to 5"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 21, "user_id": 10444339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vvbt0.jpg?s=128&g=1", "display_name": "Zero001", "link": "https://stackoverflow.com/users/10444339/zero001"}, "edited": false, "score": 0, "creation_date": 1546524829, "post_id": 54001507, "comment_id": 94884147, "body": "@zero001, the conditional needs to be <code>count &gt;= 0</code>. Updatd the answer just now."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1546524854, "last_edit_date": 1546524854, "creation_date": 1546405966, "answer_id": 54001507, "question_id": 54001384, "link": "https://stackoverflow.com/questions/54001384/file-only-saves-one-time-data-when-use-in-loop/54001507#54001507", "title": "file only saves one time data when use in loop", "body": "<p>The line</p>\n\n<pre><code>if (--count == 0)\n</code></pre>\n\n<p>is the culprit. Simplify your code and you won't have to worry about such silly errors.</p>\n\n<pre><code>while(count &gt;= 0)\n{ \n   getline(inFile, line);\n   outFile &lt;&lt; line &lt;&lt;endl;\n   --count;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10444339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vvbt0.jpg?s=128&g=1", "display_name": "Zero001", "link": "https://stackoverflow.com/users/10444339/zero001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1546524854, "creation_date": 1546404916, "last_edit_date": 1546414616, "question_id": 54001384, "link": "https://stackoverflow.com/questions/54001384/file-only-saves-one-time-data-when-use-in-loop", "title": "file only saves one time data when use in loop", "body": "<p>I have made a code in which data is taken from one whole file and only part of it is stored in the other file. But when I put it in loop it does not work has it should and I am having trouble locating the error can someone guide me where I am doing mistake.\nHere is the things what my below written code does:\nTakes user name from the user and creates the user name file then asks user if he wants to choice how many books from English book shelf he wants to choice.<br></p>\n\n<p>NOW THE ERROR: <br>\nit does not take multiple inputs if user press 2 it only takes 1 input and copies one book no name to user file but does not do it for the next time <br></p>\n\n<p>I MAY HAVE SOME CLUE MAYBE: <br>\nI think it maybe the get-line in using in the code, which may not be working for the second time the loop executes. </p>\n\n<p>I have tried modifying my code in mostly each possible way I could, but I think may be I'm still new to programming field. So my logical thinking may be not so good. That is why I need little guidance only. </p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;cstring&gt;\nusing namespace std;\nstring user;\nint main()\n{ \n  cout&lt;&lt;\"enter your name to create your Libaray file for book record\\n\";\n  getline(cin,user);\n  ofstream outFile(user.c_str(),ios::app);  //user named file\n  string line;\n  ifstream inFile(\"English_book_shelf.txt\"); //file with books name and \n                                             //number(labels)\n  int count,c;\n  cout&lt;&lt;\"How many books do you want to buy?\\n\";\n  cin&gt;&gt;c;\n  for(int j=0;j&lt;c;j++)\n  {\n    cout&lt;&lt;\"Enter your choices:\\n\";\n    cin&gt;&gt;count;\n    while(count)\n    { \n      getline(inFile, line);\n      if (--count == 0)\n      {\n        outFile &lt;&lt; line &lt;&lt;endl;\n        break;\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>I want my code to take multiple input from the user and store it in the user file.\nLike if he want 3 books, the code should run copy 3 books from the book shelf file and copy it in the user file.\nIf he want 5 books, the code should run copy 5 books from the book shelf file and copy it in the user file and so own.</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 5867, "user_id": 9125195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fc90d1f6de6ff28c739b85bdb82f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sid S", "link": "https://stackoverflow.com/users/9125195/sid-s"}, "edited": false, "score": 1, "creation_date": 1546404643, "post_id": 54001318, "comment_id": 94839505, "body": "<code>for (i = 0; i &lt; sizeof array &#47; sizeof *array; i++)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 5, "creation_date": 1546404653, "post_id": 54001318, "comment_id": 94839508, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4108313/how-do-i-find-the-length-of-an-array\">How do I find the length of an array?</a>"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1546404671, "post_id": 54001318, "comment_id": 94839514, "body": "Arrays <i>never</i> have an unknown length, all arrays will have their size fixed at compilation time. There is a (relatively) easy &quot;trick&quot; to get the size of an array (a <i>proper</i> array, not one that has decayed to a pointer): Dividing the size of the whole array with the size of a single element. Like (in your case) <code>sizeof array &#47; sizeof array[0]</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1546404672, "post_id": 54001318, "comment_id": 94839515, "body": "<code>main</code> must have a return type and it must be <code>int</code>."}], "owner": {"reputation": 11, "user_id": 10758372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gcc-462-4oQ/AAAAAAAAAAI/AAAAAAAAAQY/sZWgXJGGYkQ/photo.jpg?sz=128", "display_name": "Sami Ullah", "link": "https://stackoverflow.com/users/10758372/sami-ullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1546410423, "creation_date": 1546404433, "last_edit_date": 1546410423, "question_id": 54001318, "link": "https://stackoverflow.com/questions/54001318/sequential-search-array-for-loop-condition", "title": "Sequential Search array for loop condition", "body": "<p>If length of array in sequential search is not given and there is a lot of out of order indexing, </p>\n\n<ol>\n<li>how many times we should execute the for loop?</li>\n<li>what should be the condition of for loop?</li>\n</ol>\n\n<p>I counted indexing again and again. </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint main() {\n  int array[] = {10,  20, 30, 40, 50, 60, 70, 80, 90, 100, 200,\n                 300, 400, 5006, 110, 550, 440, 330, 331, 41};\n\n  // length of array is not provided\n\n  int i, n, loc = -1;\n  cout &lt;&lt; \"Enter value to find\" &lt;&lt; endl;\n  cin &gt;&gt; n;\n  for (i = 0; i &lt; 5; i++) {\n    if (array[i] == n) {\n      loc = i;\n    }\n  }\n  if (loc == -1)\n    cout &lt;&lt; \"Number is not found in array\" &lt;&lt; endl;\n  else\n    cout &lt;&lt; \"the number is found at position \" &lt;&lt; loc &lt;&lt; \" and is \" &lt;&lt; n;\n  return 0;\n}\n</code></pre>\n\n<p>For loop Condition for unknown length array in sequential search </p>\n"}, {"tags": ["c++", "winapi", "dll", "hook", "detours"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5766424, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1669262300014008/picture?type=large", "display_name": "\uc784\uadfc\uc601", "link": "https://stackoverflow.com/users/5766424/%ec%9e%84%ea%b7%bc%ec%98%81"}, "edited": false, "score": 0, "creation_date": 1546408926, "post_id": 54001694, "comment_id": 94840482, "body": "OK, I solve this problem simply added calling convention in hookedFunction."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 1, "last_activity_date": 1546407492, "creation_date": 1546407492, "answer_id": 54001694, "question_id": 54001303, "link": "https://stackoverflow.com/questions/54001303/c-hooking-member-function-and-original-function-returns-garbage-value/54001694#54001694", "title": "C++ hooking Member function and original function returns garbage value.", "body": "<p>From <a href=\"https://github.com/Microsoft/Detours/wiki/Using-Detours\" rel=\"nofollow noreferrer\">Using Detours</a>:</p>\n\n<blockquote>\n  <p>For proper interception the target function, detour function, and the target pointer must have exactly the same call signature including number of arguments and calling convention. Using the same calling convention insures that registers will be properly preserved and that the stack will be properly aligned between detour and target functions</p>\n</blockquote>\n\n<p><code>int hookedFunction(void *obj)</code> does not match calling convention of <code>__thiscall</code>.</p>\n\n<p>There may be other errors, but that is an obvious one.</p>\n"}], "owner": {"reputation": 153, "user_id": 5766424, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1669262300014008/picture?type=large", "display_name": "\uc784\uadfc\uc601", "link": "https://stackoverflow.com/users/5766424/%ec%9e%84%ea%b7%bc%ec%98%81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1603, "favorite_count": 0, "accepted_answer_id": 54001694, "answer_count": 1, "score": 0, "last_activity_date": 1546407492, "creation_date": 1546404355, "last_edit_date": 1546406389, "question_id": 54001303, "link": "https://stackoverflow.com/questions/54001303/c-hooking-member-function-and-original-function-returns-garbage-value", "title": "C++ hooking Member function and original function returns garbage value.", "body": "<p>I want hook class member function(using dll injection). for now, hooking is success.\nbut in hooking function, I coded that calling original function with return.\nas result, original function return garbage value. what wrong with my work?</p>\n\n<p>target.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;windows.h&gt;\n\nclass Target\n{\n    private:\n        int _member;\n\n    public:\n        Target()\n        : _member(0)\n        {\n        }\n\n        Target(int i)\n        : _member(i)\n        {\n        }\n\n        virtual ~Target()\n        {\n        }\n\n        int getValue() // I want to hooking this function.\n        {\n            return _member;\n        }\n};\n\nint main(int argc, char **argv)\n{\n    while(1){\n        Sleep(10000);        \n        Target objA, objB(7);\n        std::cout &lt;&lt; objA.getValue() &lt;&lt; \" \" &lt;&lt; objB.getValue() &lt;&lt; std::endl;\n    }\n    return 0; \n}\n</code></pre>\n\n<p>injection.dll</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;detours.h&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n\n#pragma comment(lib, \"detours.lib\")\n\nstatic const int ADDRESS = 0x2180;\nint (__thiscall * original_func)(void *);\n\nint hookedFunction(void *obj)\n{\n    uintptr_t base = (uintptr_t)GetModuleHandle(0);\n    std::cout &lt;&lt; obj &lt;&lt; \" Hooked Obj Address.\\n\";\n    int result = original_func(obj);\n    std::cout &lt;&lt; \"original function returns \" &lt;&lt; result &lt;&lt; '\\n';\n    return result; \n}\n\nDWORD WINAPI Attach(LPVOID param)\n{\n    uintptr_t base = (uintptr_t)GetModuleHandle(0);\n\n    original_func = (decltype(original_func)) (base + ADDRESS);\n\n    OutputDebugString(TEXT(\"Attach approach!\"));\n    DetourTransactionBegin();\n    DetourUpdateThread(GetCurrentThread());\n    DetourAttach(&amp;(PVOID&amp;)original_func, hookedFunction);\n\n    LONG lError = DetourTransactionCommit();\n    if (lError != NO_ERROR) {\n        OutputDebugString(TEXT(\"Attach fail!\"));\n    } else {\n        OutputDebugString(TEXT(\"Attach Sucess!!\"));\n    }\n    return 0;\n}\n\nDWORD WINAPI Detach(LPVOID param)\n{\n    OutputDebugString(TEXT(\"Detach approach!\"));\n    DetourTransactionBegin();\n    DetourUpdateThread(GetCurrentThread());\n    DetourDetach(&amp;(PVOID&amp;)original_func, hookedFunction);\n\n    LONG lError = DetourTransactionCommit();\n    if (lError != NO_ERROR) {\n        OutputDebugString(TEXT(\"Detach fail!\"));\n    } else {\n        OutputDebugString(TEXT(\"Detach Sucess!!\"));\n    }\n    return 0;\n}\n\nBOOL APIENTRY DllMain(HANDLE hModule, DWORD dwReason, LPVOID lpReserved)\n{\n    switch(dwReason)\n    {\n        case DLL_PROCESS_ATTACH:\n        {\n            CreateThread(0, 0, Attach, hModule, 0, 0); \n            break;\n        }\n        case DLL_PROCESS_DETACH:\n        {\n            CreateThread(0, 0, Detach, hModule, 0, 0); \n            break;\n        }\n    }\n    return TRUE;\n}\n</code></pre>\n\n<p>console output of target.cpp program.</p>\n\n<pre><code>0 7\n0 7\n0 7\n0 7\n0 7\n0 7\n0 7 &lt;-- (DLL injection!)\n000D1069 Hooked Obj Address.\noriginal function returns 843966720 &lt;-- why not 0 or 7?\n000D8B30 Hooked Obj Address.\noriginal function returns 890668\n890668 843966720\n000D1069 Hooked Obj Address.\noriginal function returns 843966720\n000D8B30 Hooked Obj Address.\noriginal function returns 890668\n</code></pre>\n\n<p>as you see in console output, original function returns garbage value. \nwhy original function returns garbage value?</p>\n"}, {"tags": ["c++", "memory", "static"], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 4068350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oJi3Pk7K-r8/AAAAAAAAAAI/AAAAAAAAAVk/Su6nDLc_WVM/photo.jpg?sz=128", "display_name": "aybassiouny", "link": "https://stackoverflow.com/users/4068350/aybassiouny"}, "edited": false, "score": 0, "creation_date": 1546400868, "post_id": 54000961, "comment_id": 94838861, "body": "And memory deallocation/variable destructor are not done until after main and all threads exit."}, {"owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 1, "creation_date": 1546401349, "post_id": 54000961, "comment_id": 94838940, "body": "Not so, I believe. The standard makes a distinction between constant and non-constant initialisations, as per <code>c++17 [basic.start.static] &#47;2</code> and <code>&#47;3</code>. Because this is a constant-based initialisation, it happens (or is allowed to happen) long before the code is run. Only for dynamic initialisations must the initialisation be deferred."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1546401868, "post_id": 54000961, "comment_id": 94839029, "body": "@paxdiablo, I believe those are for non-local <code>static</code> variables, not for <code>static</code> variables in functions."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 15, "user_id": 10856082, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k_sRu1hCxSI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY3qbqMPIK8PAqRgaZKkjM_TCqvwA/mo/photo.jpg?sz=128", "display_name": "zakachewa leist", "link": "https://stackoverflow.com/users/10856082/zakachewa-leist"}, "edited": false, "score": 0, "creation_date": 1546402380, "post_id": 54000961, "comment_id": 94839111, "body": "@zakachewaleist, No, I have not."}, {"owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1546402871, "post_id": 54000961, "comment_id": 94839184, "body": "@RSahu, I don&#39;t think it makes a distinction between block and non-block scope, it simply refers to static storage duration, which covers both cases. Scope only appears to come into it for automatic storage duration."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1546403015, "post_id": 54000961, "comment_id": 94839201, "body": "@paxdiablo, I haven&#39;t seen the C++17 standard but the C++14 standard clearly speaks of non-local <code>static</code> variables. <a href=\"https://timsong-cpp.github.io/cppwp/n4140/basic.start.init\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/n4140/basic.start.init</a>."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1546400428, "creation_date": 1546400428, "answer_id": 54000961, "question_id": 54000952, "link": "https://stackoverflow.com/questions/54000952/memory-allocation-of-static-variable-inside-functions/54000961#54000961", "title": "Memory allocation of static variable inside functions", "body": "<p>Memory for the <code>static</code> variable is allocated when the program starts but the variable is not initialized until the function gets called the first time.</p>\n"}, {"tags": [], "owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 5, "last_activity_date": 1546403285, "last_edit_date": 1546403285, "creation_date": 1546402341, "answer_id": 54001107, "question_id": 54000952, "link": "https://stackoverflow.com/questions/54000952/memory-allocation-of-static-variable-inside-functions/54001107#54001107", "title": "Memory allocation of static variable inside functions", "body": "<p>For that particular case, it's up to the implementation. First, the allocation question.</p>\n\n<p>It's true that the standard states that static storage duration variables are initialised as a consequence of program initiation. See, for example <code>C++17 [basic.static.start]</code>:</p>\n\n<blockquote>\n  <p>(1) Variables with static storage duration are initialized as a consequence of program initiation.</p>\n</blockquote>\n\n<p>That would seem to indicate that memory must be allocated before <code>main</code> even starts. However, C++ (like C) also follows the \"as-if\" rule, which states that:</p>\n\n<blockquote>\n  <p>... an implementation is free to disregard <em>any</em> requirement of this International Standard as long as the result is as if the requirement had been obeyed, as far as can be determined from the observable behavior of the program.</p>\n</blockquote>\n\n<p>So, since <code>i</code> is clearly not accessible from <em>outside</em> your function, creation of the variable can be deferred until that point. Actually, since <code>i</code> is never <em>used</em> even within the function (and because it's a basic type with trivial constructor or destructor), it can actually be deferred forever and optimised out of existence :-)</p>\n\n<p>Next, initialisation. The afore-mentioned standards link makes a distinction between initialisation with a constant and non-constant expression. The latter, dynamic initialisation, is required to be done at the point when you first reach the declaration, as it may depend on the current state of other program variables used to initialise it.</p>\n\n<p>However, since you're using the constant <code>9</code> to initialise your integer (and that <code>9</code> will not change at any point during program execution), that clearly falls under the constant initialiser parts of the standard. In that case, the variable just has to be bought into existence and initialised before use, so can be done at <em>any</em> point between program initiation and initial declaration.</p>\n\n<p>This is covered by the text:</p>\n\n<blockquote>\n  <p>(3) An implementation is permitted to perform the initialization of a variable with static or thread storage duration as a static initialization even if such initialization is not required to be done statically, provided that (3.1) the dynamic version of the initialization does not change the value of any other object of static or thread storage duration prior to its initialization; and (3.2) the static version of the initialization produces the same value in the initialized variable as would be produced by the dynamic initialization if all variables not required to be initialized statically were initialized dynamically.</p>\n</blockquote>\n\n<hr>\n\n<p>The bottom line is probably that you should be thinking less about the underlying mechanisms of the implementation and instead concentrate just on what the standard mandates.</p>\n\n<p>In this particular case, it makes no difference whatsoever whether allocation and/or initialisation happens before <code>main</code> or upon first encountering the declaration. That's likely to be different once you start having non-trivial constructors or destructors, but not in this case.</p>\n"}], "owner": {"reputation": 15, "user_id": 10856082, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k_sRu1hCxSI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY3qbqMPIK8PAqRgaZKkjM_TCqvwA/mo/photo.jpg?sz=128", "display_name": "zakachewa leist", "link": "https://stackoverflow.com/users/10856082/zakachewa-leist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1546410449, "creation_date": 1546400317, "last_edit_date": 1546410449, "question_id": 54000952, "link": "https://stackoverflow.com/questions/54000952/memory-allocation-of-static-variable-inside-functions", "title": "Memory allocation of static variable inside functions", "body": "<pre><code>static void func1(){\n    static int i(9);\n};\n</code></pre>\n\n<p>Is memory allocated for the static variable i when the function is called or when the program starts?</p>\n"}, {"tags": ["c++", "points", "closest"], "comments": [{"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 1, "creation_date": 1546401259, "post_id": 54000950, "comment_id": 94838932, "body": "doesn&#39;t compile. Looks like you use VLA&#39;s (variable length arrays are a non-standard extension)"}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1546401782, "post_id": 54000950, "comment_id": 94839012, "body": "Which two points are the closest? I want to verify via math."}, {"owner": {"reputation": 111, "user_id": 5659753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92895b07b9908ace89b3f6587aecbfb2?s=128&d=identicon&r=PG&f=1", "display_name": "MikolajMGT", "link": "https://stackoverflow.com/users/5659753/mikolajmgt"}, "reply_to_user": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1546401853, "post_id": 54000950, "comment_id": 94839026, "body": "It requires C++11 or newer."}, {"owner": {"reputation": 111, "user_id": 5659753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92895b07b9908ace89b3f6587aecbfb2?s=128&d=identicon&r=PG&f=1", "display_name": "MikolajMGT", "link": "https://stackoverflow.com/users/5659753/mikolajmgt"}, "reply_to_user": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1546402082, "post_id": 54000950, "comment_id": 94839062, "body": "According to brute-force results, (93; 8603), (429; 8687) are closest - distance is 346.341"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 5, "creation_date": 1546403035, "post_id": 54000950, "comment_id": 94839204, "body": "It does not require <code>-std=c++11</code>, it requires a compiler that provides a non-standard VLA extension to the C++ language (like gcc), to handle, e.g. <code>Point Pyl[mid+1];</code> and <code>Point Px[n];</code> (Be wary of code you find on the internet, especially from places like geeks... Much of the C++ is simply C rebranded as C++)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1546403908, "post_id": 54000950, "comment_id": 94839354, "body": "@MikolajMGT <code>Point Pyl[mid+1];</code> -- Not valid C++.  I know a lot of code looks like that on that website, but sorry to tell you, it&#39;s not valid C++ code.  Use <code>std::vector</code> instead.  What&#39;s worse, I&#39;ve seen code on that site that uses <code>std::vector</code> in examples, <i>and</i> use non-standard VLA&#39;s in the same example, and sometimes in the same function.  That goes to show you that the author doesn&#39;t know what the purpose of <code>vector</code> actually is, or is just lazy."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1546404416, "post_id": 54000950, "comment_id": 94839451, "body": "Their implementation contains an of off-by-one error or two, and it will not handle input with more than one point with the same x coordinate. It is also written in extremely bad C++. <a href=\"https://www.google.com/amp/s/ericlippert.com/2014/03/05/how-to-debug-small-programs/amp/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1546417219, "post_id": 54000950, "comment_id": 94842950, "body": "@PaulMcKenzie Examples on geeks4geeks and similar sites should be viewed as pseudocode that incidentally can also be compiled with a real compiler and ran if the stars align the right way."}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1546419755, "post_id": 54000950, "comment_id": 94843845, "body": "In the main loop of <code>closestUtil</code>, you should check that <code>li</code> and <code>ri</code> do not go out of bound"}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1546442449, "post_id": 54000950, "comment_id": 94854257, "body": "Just checking in again ... yes, you have a good counterexample. There are some comments on that link which are bug reports which might already have the fix. If those bugs were already fixed and the problem persists, then you should post your counterexample on that site so they can fix it again, but you&#39;ll have to do the debugging. Or they will. But their code, their bug, post it there. :)"}, {"owner": {"reputation": 111, "user_id": 5659753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92895b07b9908ace89b3f6587aecbfb2?s=128&d=identicon&r=PG&f=1", "display_name": "MikolajMGT", "link": "https://stackoverflow.com/users/5659753/mikolajmgt"}, "edited": false, "score": 0, "creation_date": 1546447440, "post_id": 54000950, "comment_id": 94856794, "body": "I found this bug, in line 76 there is <code>if (Py[i].x &lt;= midPoint.x)</code> instead of <code>if (Py[i].x &lt; midPoint.x)</code> so arrays Px and Py are dividing unequal and <code>n</code> which is passing in recursive function is incorrect for some arrays. Thanks for support."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5659753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92895b07b9908ace89b3f6587aecbfb2?s=128&d=identicon&r=PG&f=1", "display_name": "MikolajMGT", "link": "https://stackoverflow.com/users/5659753/mikolajmgt"}, "edited": false, "score": 0, "creation_date": 1546471081, "post_id": 54010161, "comment_id": 94865967, "body": "Thanks for answer :)"}], "tags": [], "owner": {"reputation": 2605, "user_id": 10420039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YiNn.png?s=128&g=1", "display_name": "Hiroki", "link": "https://stackoverflow.com/users/10420039/hiroki"}, "is_accepted": true, "score": 1, "last_activity_date": 1546447830, "creation_date": 1546447830, "answer_id": 54010161, "question_id": 54000950, "link": "https://stackoverflow.com/questions/54000950/closest-pair-of-points-onlogn-algorithm-problem-with-some-data-in-c-implem/54010161#54010161", "title": "Closest pair of points O(nlogn) algorithm - problem with some data in c++ implementation", "body": "<p>Since <code>Pyl</code> and <code>Pyr</code> have the sizes of <code>mid+1</code> and <code>n-mid-1</code> respectively, the following two lines</p>\n\n<pre><code>float dl = closestUtil(Px,     Pyl, mid  );\nfloat dr = closestUtil(Px+mid, Pyr, n-mid);\n</code></pre>\n\n<p>should be rewritten as follows:</p>\n\n<pre><code>float dl = closestUtil(Px,       Pyl, mid+1  );\nfloat dr = closestUtil(Px+mid+1, Pyr, n-mid-1);\n</code></pre>\n\n<p>In addition, as commented in the source code of <a href=\"https://www.geeksforgeeks.org/closest-pair-of-points-onlogn-implementation/\" rel=\"nofollow noreferrer\"><strong>this site</strong></a>, in the above code it is assumed that all x coordinates are distinct. For instance, if all x coordinates are same, <code>li</code> is incremented from <code>0</code> to <code>n</code> and unexpected behavior occurs at <code>Pyl[li++] = Py[i];</code> when <code>li &gt;= mid+1</code>.</p>\n\n<hr>\n\n<p>BTW, VLA (Variable Vength Arrays) does not exist at all in the C++ specification. Since arrays <code>Px</code>, <code>Py</code>, <code>Pyl</code> and <code>Pyr</code> are created on stack with automatic storage duration, their sizes should be determined at compile-time. But some C++ compilers including GNU compiler support VLA as a compiler extension and allows declaring C-style arrays with a dynamic length. (How the memory is allocated for the VLA is implementation specific.) But C++ provides dynamic array functionality by <code>std::vector</code> which might make our code more readable, portable and robust. </p>\n"}], "owner": {"reputation": 111, "user_id": 5659753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92895b07b9908ace89b3f6587aecbfb2?s=128&d=identicon&r=PG&f=1", "display_name": "MikolajMGT", "link": "https://stackoverflow.com/users/5659753/mikolajmgt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2833, "favorite_count": 0, "accepted_answer_id": 54010161, "answer_count": 1, "score": 1, "last_activity_date": 1549963618, "creation_date": 1546400307, "last_edit_date": 1549963618, "question_id": 54000950, "link": "https://stackoverflow.com/questions/54000950/closest-pair-of-points-onlogn-algorithm-problem-with-some-data-in-c-implem", "title": "Closest pair of points O(nlogn) algorithm - problem with some data in c++ implementation", "body": "<p>I have question about divide and conquer algorithm to find closest points. I checked C++ implementation on this page <a href=\"https://www.geeksforgeeks.org/closest-pair-of-points-onlogn-implementation/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/closest-pair-of-points-onlogn-implementation/</a>\nBut there is a problem with this code. It works fine in most cases, but for some data, this implementation returns other result, than brute-force method.\nFor example, lets take ten points (x, y):</p>\n\n<pre><code>(795 981)\n(1905 4574)\n(8891 665)\n(6370 1396)\n(93 8603)\n(302 7099)\n(326 5318)\n(4493 3977)\n(429 8687)\n(9198 1558)\n</code></pre>\n\n<p>For this data, <code>O(n log n)</code> algorithm returns 944.298 instead of 346.341 given by brute force. Why is this happening?</p>\n\n<p>This is exactly geeksforgeeks implementation with my example data:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;float.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\nusing namespace std;\n\nstruct Point\n{\n    int x, y;\n};\n\nint compareX(const void* a, const void* b)\n{\n    Point *p1 = (Point *)a,  *p2 = (Point *)b;\n    return (p1-&gt;x - p2-&gt;x);\n}\n\nint compareY(const void* a, const void* b)\n{\n    Point *p1 = (Point *)a,   *p2 = (Point *)b;\n    return (p1-&gt;y - p2-&gt;y);\n}\n\n\nfloat dist(Point p1, Point p2)\n{\n    return sqrt( (p1.x - p2.x)*(p1.x - p2.x) +\n                 (p1.y - p2.y)*(p1.y - p2.y)\n    );\n}\n\nfloat bruteForce(Point P[], int n)\n{\n    float min = FLT_MAX;\n    for (int i = 0; i &lt; n; ++i)\n        for (int j = i+1; j &lt; n; ++j)\n            if (dist(P[i], P[j]) &lt; min)\n                min = dist(P[i], P[j]);\n    return min;\n}\n\nfloat min(float x, float y)\n{\n    return (x &lt; y)? x : y;\n}\n\n\nfloat stripClosest(Point strip[], int size, float d)\n{\n    float min = d;  // Initialize the minimum distance as d \n\n    for (int i = 0; i &lt; size; ++i)\n        for (int j = i+1; j &lt; size &amp;&amp; (strip[j].y - strip[i].y) &lt; min; ++j)\n            if (dist(strip[i],strip[j]) &lt; min)\n                min = dist(strip[i], strip[j]);\n\n    return min;\n}\n\nfloat closestUtil(Point Px[], Point Py[], int n)\n{\n    // If there are 2 or 3 points, then use brute force \n    if (n &lt;= 3)\n        return bruteForce(Px, n);\n\n    // Find the middle point \n    int mid = n/2;\n    Point midPoint = Px[mid];\n\n\n    Point Pyl[mid+1];   // y sorted points on left of vertical line \n    Point Pyr[n-mid-1];  // y sorted points on right of vertical line \n    int li = 0, ri = 0;  // indexes of left and right subarrays \n    for (int i = 0; i &lt; n; i++)\n    {\n        if (Py[i].x &lt;= midPoint.x)\n            Pyl[li++] = Py[i];\n        else\n            Pyr[ri++] = Py[i];\n    }\n\n    float dl = closestUtil(Px, Pyl, mid);\n    float dr = closestUtil(Px + mid, Pyr, n-mid);\n\n    // Find the smaller of two distances \n    float d = min(dl, dr);\n\n    Point strip[n];\n    int j = 0;\n    for (int i = 0; i &lt; n; i++)\n        if (abs(Py[i].x - midPoint.x) &lt; d)\n            strip[j] = Py[i], j++;\n\n    return min(d, stripClosest(strip, j, d) );\n}\n\nfloat closest(Point P[], int n)\n{\n    Point Px[n];\n    Point Py[n];\n    for (int i = 0; i &lt; n; i++)\n    {\n        Px[i] = P[i];\n        Py[i] = P[i];\n    }\n\n    qsort(Px, n, sizeof(Point), compareX);\n    qsort(Py, n, sizeof(Point), compareY);\n\n    // Use recursive function closestUtil() to find the smallest distance \n    return closestUtil(Px, Py, n);\n}\n\n// Driver program to test above functions \nint main()\n{\n    Point P[] = {{795, 981}, {1905, 4574}, {8891, 665}, {6370, 1396}, {93, 8603}, {302, 7099},\n                 {326, 5318}, {4493, 3977}, {429, 8687}, {9198, 1558}};\n    int n = sizeof(P) / sizeof(P[0]);\n    cout &lt;&lt; closest(P, n) &lt;&lt; std::endl;\n    cout &lt;&lt; bruteForce(P, n) &lt;&lt; std::endl;\n    return 0;\n} \n</code></pre>\n\n<p>Has anyone idea what is wrong here? I have been trying fix it for few hours, but I don't really understand why this problem happens.</p>\n"}, {"tags": ["c++", "openssl", "aes", "c++98", "aes-gcm"], "comments": [{"owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 1, "creation_date": 1546428658, "post_id": 54000689, "comment_id": 94847729, "body": "You use <code>EVP_aes_256_gcm</code> in <code>EVP_EncryptInit_ex</code> but <code>EVP_aes_128_gcm</code> in <code>EVP_DecryptInit_ex</code>"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "reply_to_user": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 0, "creation_date": 1546430568, "post_id": 54000689, "comment_id": 94848540, "body": "Great catch! Thank you. I have updated the code to use <code>EVP_aes_128_gcm</code> for both <code>encrypt</code> and <code>decrypt</code> but <code>decrypt</code> is still failing."}, {"owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 0, "creation_date": 1546434759, "post_id": 54000689, "comment_id": 94850516, "body": "Can you share your secret key? I happened to have a very similar test so I can cross check your test vectors."}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "reply_to_user": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 0, "creation_date": 1546436163, "post_id": 54000689, "comment_id": 94851206, "body": "@MarekKlein Yes, of course. <code>const unsigned char *secret = reinterpret_cast&lt;const unsigned char*&gt;(&quot;Open Sesame&quot;);</code>"}, {"owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 1, "creation_date": 1546436843, "post_id": 54000689, "comment_id": 94851528, "body": "First try to make your secret key to be 16 bytes long. It is 12 bytes but AES 128 uses 16 bytes long keys so I suspect that you use 4 &quot;random&quot; bytes in tour key."}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "reply_to_user": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 0, "creation_date": 1546438008, "post_id": 54000689, "comment_id": 94852075, "body": "@MarekKlein I see. That makes sense.  Updated code now with the new key <code>Open** Sesame**\\0</code> and new test vectors. Still failing in the same place on <code>decrypt</code>"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "reply_to_user": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 0, "creation_date": 1546440331, "post_id": 54000689, "comment_id": 94853213, "body": "Success! I commented out the AAD extraction since there was none included during encryption, and now it works fine. A thousand thanks for your help, @MarekKlein"}, {"owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 1, "creation_date": 1546440420, "post_id": 54000689, "comment_id": 94853250, "body": "Grate to hear that. You may find <a href=\"https://boringssl.googlesource.com/boringssl/+/2214/crypto/cipher/cipher_test.txt\" rel=\"nofollow noreferrer\">this</a> useful in future."}], "owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1879, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1546440267, "creation_date": 1546397376, "last_edit_date": 1546440267, "question_id": 54000689, "link": "https://stackoverflow.com/questions/54000689/encrypt-decrypt-with-aes-gcm-using-openssl", "title": "Encrypt/Decrypt with AES-GCM using OpenSSL", "body": "<p>I am writing an AES-GCM class for my application. The requirements constrain me to C++98 and static keys. I am having trouble unit testing the code I wrote. I am not able encrypt a test string and decrypt it back to its original form. What am I doing wrong here using OpenSSL EVP?</p>\n\n<p>AES class, here are the juicy bits:</p>\n\n<pre><code>/**\n * @brief ctor for aescipher class\n *\n * @params secret      secret cryptographic key\n * @params secret_len  array length of secret\n * @params iv          initialization vector (note, For a given key, the\n *                     IV MUST NOT repeat.)\n * @params iv_len      array length of iv\n */\naescipher::aescipher(const uint8_t* secret, size_t secret_len,\n                     const uint8_t* iv, size_t iv_len)\n:    mSecretSize(secret_len)\n,    mSecret(new uint8_t[secret_len])\n,    mIVSize(iv_len)\n,    mIV(new uint8_t[iv_len])\n{\n    memcpy(mSecret, secret, mSecretSize);\n    memcpy(mIV, iv, mIVSize);\n}\n\naescipher::~aescipher()\n{\n    delete [] mSecret;\n    mSecret = NULL;\n\n    delete [] mIV;\n    mIV = NULL;\n}\n\n/**\n * @brief generates a random 16-octet array suitable to use as an AES-GCM integrity check\n *\n * @param iv   unsigned 8-octet array for iv\n *\n * @returns    boolean - RAND_bytes() success\n */\n/* static */ bool aescipher::generateIV(uint8_t iv[8])\n{\n    return (RAND_bytes(iv, 8) == 1);\n}\n\n/**\n * @brief encrypt data and aad using AES-GCM\n *\n * @param src      data to be encrypted\n * @param src_len  array length of src\n * @param aad      additional authenticated data included but not encrypted (optional/nullable)\n * @param aad_len  array length of aad\n * @param dst      destination data array for encrypted data\n * @param dst_len  array length of dst\n * @param tag      16 octet data array for Authentication Tag (Integrity Check Value per spec)\n *\n * @return         number of bytes written to dst\n */\nsize_t aescipher::encrypt(const uint8_t* src, size_t src_len,\n                          const uint8_t *aad, size_t aad_size,\n                          uint8_t* dst, size_t dst_len,\n                          uint8_t tag[16])\n{\n    if (!src || !src_len || !dst || !dst_len) return 0;\n    if (src_len &gt; dst_len) return 0;\n\n    int cipher_len = 0;\n    int len = 0;\n    EVP_CIPHER_CTX* context = EVP_CIPHER_CTX_new();\n    if (context == NULL) return 0;\n\n    EVP_EncryptInit_ex(context, EVP_aes_128_gcm(), NULL, NULL, NULL);\n    // set secret key and IV lengths\n    EVP_CIPHER_CTX_ctrl(context, EVP_CTRL_GCM_SET_IVLEN, mIVSize, NULL);\n    EVP_CIPHER_CTX_set_key_length(context, (int)mSecretSize);\n    // initialize secret key and IV\n    EVP_EncryptInit_ex(context, NULL, NULL, mSecret, mIV);\n    // Provide AAD if supplied\n    if (aad &amp;&amp; aad_size) {\n        if (!EVP_EncryptUpdate(context, NULL, &amp;len, aad, aad_size))\n            goto AES_ERROR;\n    }\n\n    if (!EVP_EncryptUpdate(context, dst, &amp;len, src, src_len)) {\n        goto AES_ERROR;\n    }\n    cipher_len = len;\n\n    // There may be some final data left to encrypt if the input is\n    // not an exact multiple of the block size.\n    if (!EVP_EncryptFinal_ex(context, dst + len, &amp;len))\n        goto AES_ERROR;\n    //Normally ciphertext bytes may be written during finalization,\n    // but this does not occur in GCM mode, so we make do manually.\n    cipher_len += len;\n    // Get the tag\n    if (!EVP_CIPHER_CTX_ctrl(context, EVP_CTRL_GCM_GET_TAG, 16, tag))\n        goto AES_ERROR;\n\n    EVP_CIPHER_CTX_free(context);\n    return cipher_len;\n\nAES_ERROR:\n    EVP_CIPHER_CTX_free(context);\n    return 0;\n}\n\n/**\n * @brief convenience encrypt() function omitting AAD params\n *\n * @param src      data to be encrypted\n * @param src_len  array length of src\n * @param dst      destination data array for encrypted data\n * @param dst_len  array length of dst\n * @param tag      16 octet data array for Authentication Tag (Integrity Check Value per spec)\n *\n * @return         number of bytes written to dst\n */\nsize_t aescipher::encrypt(const uint8_t* src, size_t src_len,\n                          uint8_t* dst, size_t dst_len,\n                          uint8_t tag[16])\n{\n    return encrypt(src, src_len, NULL, 0, dst, dst_len, tag);\n}\n\n\n/**\n * @brief decrypt AES-GCM encrypted data\n *\n * @param src      encrypted data array\n * @param src_len  array length of src\n * @param dst      destination array of decrypted data\n * @param dst_len  array length of dst\n * @param tag      16 octet data array for Authentication Tag (Integrity Check Value per spec)\n * @param aad      additional authenticated data received\n * @param aad_len  array length of aad\n *\n * @return         bytes written to dst\n */\nsize_t aescipher::decrypt(const uint8_t* src, size_t src_len,\n                          uint8_t* dst, size_t dst_len,\n                          uint8_t* aad, size_t aad_len,\n                          uint8_t tag[16])\n{\n    if (!src || !src_len || !dst || !dst_len) return 0;\n    if (src_len &gt; dst_len) return 0;\n\n    int output_len = 0;\n    int temp_len = 0;\n\n    EVP_CIPHER_CTX* context = EVP_CIPHER_CTX_new();\n    if (context == NULL) return 0;\n\n    EVP_DecryptInit_ex(context, EVP_aes_128_gcm(), NULL, NULL, NULL);\n\n    // set secret key and IV lengths\n    EVP_CIPHER_CTX_ctrl(context, EVP_CTRL_GCM_SET_IVLEN, mIVSize, NULL);\n    EVP_CIPHER_CTX_set_key_length(context, (int)mSecretSize);\n    // initialize secret key and IV\n    EVP_DecryptInit_ex(context, NULL, NULL, mSecret, mIV);\n\n    // Provide AAD if supplied\n    if (!EVP_DecryptUpdate(context, NULL, &amp;temp_len, aad, aad_len)) {\n        goto AES_ERROR;\n    }\n    if (!EVP_DecryptUpdate(context, dst, &amp;temp_len, src, src_len)) {\n        goto AES_ERROR;\n    }\n    output_len = temp_len;\n\n    // Set expected tag value.\n    if(!EVP_CIPHER_CTX_ctrl(context, EVP_CTRL_GCM_SET_TAG, 16, tag)) {\n        goto AES_ERROR;\n    }\n    // Finalise the decryption. A positive return value indicates success,\n    // anything else is a failure - the plaintext is not trustworthy.\n    if (EVP_DecryptFinal_ex(context, dst + temp_len, &amp;temp_len) &lt;= 0){\n        goto AES_ERROR;\n    }\n    output_len += temp_len;\n\n    EVP_CIPHER_CTX_free(context);\n    return output_len;\n\nAES_ERROR:\n    EVP_CIPHER_CTX_free(context);\n    return 0;\n}\n</code></pre>\n\n<p>Now, for the unit test.</p>\n\n<p>FYI, I am not generating an IV for the unit test because I have Base64 encoded the encrypted data to store in the unit test source, therefore, I need to use a static IV with it. I just need to test the class. Don't worry, generating a unique IV will happen at a higher level. There is no AAD at this point in the tests.</p>\n\n<p><code>Base64</code> and all undefined classes are unit tested and functional, so their definitions are irrelevant to the question. </p>\n\n<p>Secret key I'm using is:</p>\n\n<pre><code>const unsigned char *secret = reinterpret_cast&lt;const unsigned char*&gt;(\"Open** Sesame**\");\n</code></pre>\n\n<p>Encrypt test (passes tests, but <code>encrypted_data</code> may actually be invalid data!):</p>\n\n<pre><code>const unsigned char *msg = reinterpret_cast&lt;const unsigned char*&gt;(\n      \"Twas brillig, and the slithy toves Did gyre and gimble in the wabe: All mimsy were the borogoves, And the mome raths outgrabe.\");\nstd::string encrypted_msg(\n\"WFcN70vG6REhBj6ccvXpvoF3UzeMOahuKpBulwyAxMG6Xx9ttt4WQtwvTbi27RvnHd3NxaJ2CvfzOgZAFxMfU/t8hc9smLBryNPTWXSVvG7+HF+hrGP9dwVaDX36MYdsiZV+7BdJnJ6EIGhTBnmWWtReheC5Ju/ledYymChmqQ==\");\nconst size_t msg_len = 127;\nsize_t ciphertext_len = 256;\nunsigned char ciphertext[ciphertext_len];\nmemset(ciphertext, 0, sizeof(ciphertext));\n\nuint8_t iv[8], tag[16];\nmemset(iv, 1, sizeof(iv));\naescipher cipher(secret, secretlen, iv, sizeof(iv));\nsize_t bytes = cipher.encrypt(msg, msg_len, ciphertext, ciphertext_len, tag);\n\nunsigned char encrypted_data[ciphertext_len];\n(void)Base64::decode(encrypted_msg.c_str(), encrypted_msg.length(), encrypted_data, ciphertext_len);\n\nTK_assertTrue(memcmp(ciphertext, encrypted_data, bytes) == 0);\nTK_assertTrue(bytes == msg_len);\n</code></pre>\n\n<p>Decrypt test (does not pass):</p>\n\n<pre><code>std::string decrypted_msg(\n    \"Twas brillig, and the slithy toves Did gyre and gimble in the wabe: All mimsy were the borogoves, And the mome raths outgrabe.\");\nstd::string encoded_msg(\n    \"WFcN70vG6REhBj6ccvXpvoF3UzeMOahuKpBulwyAxMG6Xx9ttt4WQtwvTbi27RvnHd3NxaJ2CvfzOgZAFxMfU/t8hc9smLBryNPTWXSVvG7+HF+hrGP9dwVaDX36MYdsiZV+7BdJnJ6EIGhTBnmWWtReheC5Ju/ledYymChmqQ==\");\nstd::string gcm_tag(\"hDlT5X7CGPwoPmVZSP2ezQ==\");\nconst size_t msg_len = 127;\nuint8_t iv[8], tag[16], enc_msg[msg_len], msg[msg_len], aad[msg_len];\n\n// decode encrypted data\nBase64::decode(encoded_msg.c_str(), encoded_msg.length(), enc_msg, msg_len);\nBase64::decode(gcm_tag.c_str(), gcm_tag.length(), tag, sizeof(tag));\n\nmemset(iv, 1, sizeof(iv));\naescipher cipher(secret, secretlen, iv, sizeof(iv));\nsize_t bytes = cipher.decrypt(enc_msg, msg_len, msg, msg_len, aad, msg_len, tag);\nTK_assertTrue(bytes == msg_len);\nTK_assertTrue(strncmp(reinterpret_cast&lt;const char*&gt;(msg), decrypted_msg.c_str(), bytes) == 0);\n</code></pre>\n\n<p>Note, on the decrypt unit test, <code>aescipher::decrypt</code> fails in <code>EVP_DecryptFinal_ex(context, dst + temp_len, &amp;temp_len)</code>.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 6, "creation_date": 1546396779, "post_id": 54000612, "comment_id": 94838218, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4604136/how-to-search-for-an-element-in-an-stl-list\">How to search for an element in an stl list?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1546396829, "post_id": 54000612, "comment_id": 94838226, "body": "See the other answers in the duplicate above, not only the accepted one, for examples testing existence."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1546412199, "post_id": 54000612, "comment_id": 94841469, "body": "Consider reading some <a href=\"https://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\">documentation</a>."}], "answers": [{"tags": [], "owner": {"reputation": 6346, "user_id": 2587908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LhXQO.jpg?s=128&g=1", "display_name": "sfjac", "link": "https://stackoverflow.com/users/2587908/sfjac"}, "is_accepted": false, "score": 2, "last_activity_date": 1546396780, "creation_date": 1546396780, "answer_id": 54000628, "question_id": 54000612, "link": "https://stackoverflow.com/questions/54000612/how-do-i-know-if-i-found-the-number-that-i-searched-in-a-stl-list/54000628#54000628", "title": "How do i know, if i found the number that i searched in a STL list.", "body": "<p><code>std::find</code> will return its second argument (<code>l1.end()</code> in this case) if the element is not found. </p>\n"}], "owner": {"reputation": 1, "user_id": 9608686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90c2a183823b17b424c34f3bf37dbaa?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Samow Mohamed", "link": "https://stackoverflow.com/users/9608686/ahmed-samow-mohamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546397138, "creation_date": 1546396626, "question_id": 54000612, "link": "https://stackoverflow.com/questions/54000612/how-do-i-know-if-i-found-the-number-that-i-searched-in-a-stl-list", "title": "How do i know, if i found the number that i searched in a STL list.", "body": "<pre><code>int main(){\nlist&lt;int&gt; l1;\nlist&lt;int&gt; :: iterator l1_iter;\nint v1 = 10;\nint v2 = 5;\nl1.push_back(v1);\nl1.push_back(v2);\nl1.push_back(50);\nl1.push_back(100);\nl1_iter = find(l1.begin(), l1.end(), 50);\n</code></pre>\n\n<p>I have written this code, i want to search 50 in my list. \nIs there away to know if i found or not?</p>\n"}, {"tags": ["c++", "operators", "filestream"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1546395297, "post_id": 54000484, "comment_id": 94838010, "body": "<code>reset</code> is a <code>string</code> (multiple characters), while <code>names[0]</code> is a <code>char</code> (single character). The comparison makes no sense. Do you want to compare <code>reset</code> with <code>names</code> instead? Also <code>names</code> sounds plural, but it has type <code>string</code>, only <i>one</i> name therefore. Maybe your function parameter is wrong and is supposed to be an array of <code>string</code> instead?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1546395324, "post_id": 54000484, "comment_id": 94838013, "body": "Since <code>names</code> is a <code>std::string</code>, <code>names[0]</code> is a char. You can&#39;t compare a single, lonely, attention-starved <code>char</code> with an entire, fat, <code>std::string</code>. What exactly were the results you were expecting, from that expierment?"}, {"owner": {"reputation": 193, "user_id": 8396329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DVn8I.jpg?s=128&g=1", "display_name": "Aleon", "link": "https://stackoverflow.com/users/8396329/aleon"}, "edited": false, "score": 0, "creation_date": 1546395460, "post_id": 54000484, "comment_id": 94838039, "body": "Just for clarity, could you make the paste public, please?"}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 0, "creation_date": 1546395540, "post_id": 54000484, "comment_id": 94838048, "body": "No semantically equivalent but it can do the job: <code>if (reset[0]==names[0])</code>"}, {"owner": {"reputation": 9, "user_id": 10471220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mC3p5Hsk9l0/AAAAAAAAAAI/AAAAAAAACek/0QkvIOb50VE/photo.jpg?sz=128", "display_name": "Just The Instinct", "link": "https://stackoverflow.com/users/10471220/just-the-instinct"}, "edited": false, "score": 0, "creation_date": 1546395592, "post_id": 54000484, "comment_id": 94838057, "body": "I was expecting to create string arrays and compare each individual string within the array to a different answer from reset. Paste is public. (Still new to this)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1546395625, "post_id": 54000484, "comment_id": 94838065, "body": "Well then the function parameter is wrong, you are passing a single <code>string</code> not an array of <code>string</code> (or something similar) for <code>names</code>. Did you intend <code>string names[10]</code> in the parameter list?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1546396138, "post_id": 54000484, "comment_id": 94838130, "body": "Multiple people have explained to you the reason for the compilation error. That answers your question."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 10471220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mC3p5Hsk9l0/AAAAAAAAAAI/AAAAAAAACek/0QkvIOb50VE/photo.jpg?sz=128", "display_name": "Just The Instinct", "link": "https://stackoverflow.com/users/10471220/just-the-instinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1546396386, "creation_date": 1546396386, "answer_id": 54000586, "question_id": 54000484, "link": "https://stackoverflow.com/questions/54000484/how-to-fix-no-match-for-operator-when-comparing-strings-in-if-statement/54000586#54000586", "title": "How to fix &#39;no match for &#39;operator==&#39;&#39; when comparing strings in if statement", "body": "<p>The problem was the admin function parameter where the string \"names\" did not declare the array.</p>\n\n<p>Turn:</p>\n\n<pre><code>void admin (string names, ...\n</code></pre>\n\n<p>Into:</p>\n\n<pre><code>void admin (string name[10], ...\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10471220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mC3p5Hsk9l0/AAAAAAAAAAI/AAAAAAAACek/0QkvIOb50VE/photo.jpg?sz=128", "display_name": "Just The Instinct", "link": "https://stackoverflow.com/users/10471220/just-the-instinct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 54000586, "answer_count": 1, "score": -1, "last_activity_date": 1546396844, "creation_date": 1546395051, "last_edit_date": 1546396844, "question_id": 54000484, "link": "https://stackoverflow.com/questions/54000484/how-to-fix-no-match-for-operator-when-comparing-strings-in-if-statement", "title": "How to fix &#39;no match for &#39;operator==&#39;&#39; when comparing strings in if statement", "body": "<p>Trying to compare strings using if statements but getting operator errors. How can I fix this to make the statement compare the strings? Using Code::Blocks as compiler.</p>\n\n<p>Full Raw code Pastebin: <a href=\"https://pastebin.com/DJGqJBwu\" rel=\"nofollow noreferrer\">https://pastebin.com/DJGqJBwu</a> (No longer public due to question solved)</p>\n\n<p>(NOTE: Most of the commenting in raw code is for experimenting and there are tons of errors overall that I can go over later)</p>\n\n<p>This is for a leaderboard I am trying to create for a Tic-Tac-Toe game. I have tried different ways to compare the strings to fix this such as .compare.</p>\n\n<pre><code>void admin (string names, int nameW[10], int wins[10], unsigned int a[10]) //called variables from main\n{\n    char repeat = 'y'; //used for function loop\n    char resetAll; //used elsewhere\n    int winCount; //used elsewhere\n    string reset;\n    string modify; //used elsewhere\n    string admin; //used elsewhere\n\n    cin &gt;&gt; reset;\n\n        //Reset\n        if (reset==names[0])\n        {\n            wins[0] = 0;\n        }\n}\n</code></pre>\n\n<p>Build log:</p>\n\n<pre><code>error: no match for 'operator==' (operand types are 'std::__cxxll::string {aka std::__cxll::basic_string&lt;char&gt;}' and '__gnu_cxx::__alloc_traits&lt;std::allocator&lt;char&gt; &gt;::value_type {aka char}')\n</code></pre>\n\n<p>I am expecting the reset variable to be the same as the names[0] variable so that the code can execute. Results are that code cannot build and run (unable to test program).</p>\n"}, {"tags": ["c++", "raspberry-pi3", "raspbian", "can-bus", "socketcan"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1546394829, "post_id": 54000450, "comment_id": 94837941, "body": "It could any number of many reasons for something like this. Try redirecting standard error to a log file, see if anything comes out. Or, run everything under strace and see exactly what&#39;s going on."}, {"owner": {"reputation": 25, "user_id": 8185645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/585e73d31db52d1f7598c2b97b76844e?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Bernard", "link": "https://stackoverflow.com/users/8185645/jacob-bernard"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1546470746, "post_id": 54000450, "comment_id": 94865874, "body": "Thanks for the good suggestion - I redirected stderr to a logfile based on <a href=\"https://stackoverflow.com/questions/7400418/writing-a-log-file-in-c-c\">this post</a> and it seems that the logfile wasn&#39;t generated when it was ran on startup but is created fine when ran normally - all i did was add the following two lines before the system calls:       std::freopen(&quot;logfileError.txt&quot;, &quot;w&quot;, stderr);     std::cerr &lt;&lt; &quot;Error message&quot; &lt;&lt; std::endl;"}], "owner": {"reputation": 25, "user_id": 8185645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/585e73d31db52d1f7598c2b97b76844e?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Bernard", "link": "https://stackoverflow.com/users/8185645/jacob-bernard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1546482952, "creation_date": 1546394725, "last_edit_date": 1546482952, "question_id": 54000450, "link": "https://stackoverflow.com/questions/54000450/c-system-call-to-other-c-program-not-working-when-called-on-startup", "title": "C++ system call to other C++ program not working when called on startup", "body": "<p>I have a C++ program which is called at startup via a cronjob (in crontab): </p>\n\n<pre><code>@reboot sudo /home/pi/CAN/RCR_datalogging/logfileControl\n</code></pre>\n\n<p>Which does run logfileControl anytime the Pi is booted as it shows up in the list of running programs (ps -e). LogfileControl contains two system calls to C++ programs related to <a href=\"https://www.kernel.org/doc/Documentation/networking/can.txt\" rel=\"nofollow noreferrer\">SocketCAN</a> (SocketCAN is part of the Linux Kernel, it allows for dealing with CAN data as network sockets). I want logfileControl to run on startup so that it can initialize the CAN socket (system call 1) and then start the first logfile (systemcall 2, candumpExternal, this is candump from socketCAN with a minor modification to make the logfile a specific location rather than just where candump is, but using the original version had the same issue). The first systemcall seems to be working properly as if I try and initialize the socket again it is busy, but the second systemcall doesn't appear to be happening as a logfile is not created at all as a logfile is not created. If I manually run logfileControl from the command line it works as expected and creates the logfile  which has left me quite confused... </p>\n\n<p>Does anyone have an insight as to what is going on here? </p>\n\n<pre><code>system(\"sudo /sbin/ip link set can0 up type can bitrate 500000\"); \n                                  // This is ran initially as logging should start as soon as the pi is on\nsystem(\"/home/pi/CAN/RCR_datalogging/candumpExternal can0 -l -s 0\"); // candump with the option to log(-l) as well as \n                                  // continue to output to console (-s 0)\n\nstd::cout &lt;&lt;\"Setup Complete\" &lt;&lt; std:: endl;\n\nwhile(true) { //sleeping indefinitely so that the program can stay open and wait for button presses\n    sleep(60);\n}\n</code></pre>\n\n<p>Edit: I also tried adding a simple 5 second pause at the beginning of the program, but this didn't seem to make any difference.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1546394793, "post_id": 54000448, "comment_id": 94837934, "body": "Most array-wrapping containers (like Java&#39;s ArrayList) pre-allocate more space than immediately needed to avoid constant reallocating in the future. Copying an entire array is expensive, so you want to avoid doing it unnecessarily. I&#39;m assuming <code>vector</code> operates similarly."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1546394919, "post_id": 54000448, "comment_id": 94837953, "body": "&quot;How the vector actually distributed&quot; depends entirely on the C++ implementation. The C++ standard imposes a few requirements, but the actual details vary depending on the implementation, and cannot be relied upon."}], "owner": {"reputation": 1, "user_id": 9635239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u5f35\u7693\u96e8", "link": "https://stackoverflow.com/users/9635239/%e5%bc%b5%e7%9a%93%e9%9b%a8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1546395432, "answer_count": 0, "score": 0, "last_activity_date": 1546394689, "creation_date": 1546394689, "question_id": 54000448, "link": "https://stackoverflow.com/questions/54000448/how-is-the-vector-actually-distributed", "closed_reason": "Duplicate", "title": "How is the vector actually distributed?", "body": "<p>I am learning C++ vector, I found a problem. if the vector has been initialized, try not to use <strong>push_back</strong>, or <strong>emplace_back</strong>, because there will be extra unnecessary space.\nThe following code:</p>\n\n<pre><code>#include &lt;cassert&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n    std::vector&lt;int&gt; data = {1,2,3,4,5};//initialize with std::initializer_list&lt;int&gt;\n    assert(data.size() == data.capacity());//ok\n    data.emplace_back(10);//sample append\n    assert(data.size() == data.capacity());//runtime error\n}\n</code></pre>\n\n<ul>\n<li>How is the vector actually distributed?</li>\n</ul>\n"}, {"tags": ["c#", "c++", "opencv", "opencvsharp", "cinder"], "answers": [{"tags": [], "owner": {"reputation": 1784, "user_id": 5435957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58c0cf959bd35b9c4fb74b0080bf426?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Shrivastava", "link": "https://stackoverflow.com/users/5435957/prateek-shrivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1546397156, "creation_date": 1546397156, "answer_id": 54000662, "question_id": 54000397, "link": "https://stackoverflow.com/questions/54000397/how-to-use-libcinder-with-c/54000662#54000662", "title": "How to use libcinder with c#?", "body": "<p>What libcinder feature are you looking for in \"C# World\". Many of the features listed on that link are already available in C# (.NET) since 2005-2008.</p>\n\n<p>Example things that C#/.NET can do (same as libcinder):</p>\n\n<ul>\n<li>Standalone Apps</li>\n<li>Internet I/O</li>\n<li>Platform Specific API's (PInvoke)</li>\n<li>Xml &amp; JSON Parsers</li>\n<li>Full I/O Stuff</li>\n<li>UI Events</li>\n<li>Multi Touch</li>\n<li>Communication API's</li>\n<li>3D &amp; 2D Graphics</li>\n<li>Multimedia</li>\n</ul>\n"}], "owner": {"reputation": 371, "user_id": 10838321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ue8C.jpg?s=128&g=1", "display_name": "Felix Xu", "link": "https://stackoverflow.com/users/10838321/felix-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546410203, "creation_date": 1546394076, "last_edit_date": 1546410203, "question_id": 54000397, "link": "https://stackoverflow.com/questions/54000397/how-to-use-libcinder-with-c", "title": "How to use libcinder with c#?", "body": "<p>I recently came across <a href=\"https://libcinder.org/\" rel=\"nofollow noreferrer\">libcinder</a> which seems to be promising for <strong>creative coding</strong>. </p>\n\n<p>It's for c++ but I'm more familiar with c#. Is there a way to use <code>libcinder</code> with c#? </p>\n\n<p>Or maybe in c# world, there is some other collection of libraries / framework for the same purpose?</p>\n\n<p>The first thing I'd like to try is to open an image then draw lines/rectangles on it, the second thing in my list is to open a live video and then draw some thing on the video. Is it the best choice to use cinder or should I just use OpenCV with c++/c#?</p>\n"}, {"tags": ["c++", "windows", "tensorflow"], "comments": [{"owner": {"reputation": 2671, "user_id": 1099237, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1efff11270d3da94fe6be7d745c52da6?s=128&d=identicon&r=PG", "display_name": "omatai", "link": "https://stackoverflow.com/users/1099237/omatai"}, "edited": false, "score": 0, "creation_date": 1595294709, "post_id": 54000378, "comment_id": 111418548, "body": "See <a href=\"https://stackoverflow.com/a/41071296\">stackoverflow.com/a/41071296</a>"}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 4058766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255f8f6a2b8375b9f0de9f96578ff4b9?s=128&d=identicon&r=PG&f=1", "display_name": "James Kl", "link": "https://stackoverflow.com/users/4058766/james-kl"}, "is_accepted": false, "score": 1, "last_activity_date": 1546396229, "creation_date": 1546396229, "answer_id": 54000573, "question_id": 54000378, "link": "https://stackoverflow.com/questions/54000378/using-tensorflow-in-c-on-windows/54000573#54000573", "title": "Using tensorflow in C++ on Windows", "body": "<p>I can't comment so I am writing this as an answer. \nIf you don't mind using Keras, you could use the package <a href=\"https://github.com/Dobiasd/frugally-deep\" rel=\"nofollow noreferrer\">frugally deep</a>. I haven't seen a library myself either, but I came across frugally deep and it seemed easy to implement. I am currently trying to use it, so I cannot guarantee it will work.  </p>\n"}, {"tags": [], "owner": {"reputation": 762, "user_id": 5594712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8a287f41b844d7384723ea005988e00?s=128&d=identicon&r=PG&f=1", "display_name": "Code J", "link": "https://stackoverflow.com/users/5594712/code-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1565707205, "creation_date": 1565707205, "answer_id": 57480110, "question_id": 54000378, "link": "https://stackoverflow.com/questions/54000378/using-tensorflow-in-c-on-windows/57480110#57480110", "title": "Using tensorflow in C++ on Windows", "body": "<p>You could check out neural2D from here:</p>\n\n<p><a href=\"https://github.com/davidrmiller/neural2d\" rel=\"nofollow noreferrer\">https://github.com/davidrmiller/neural2d</a></p>\n\n<p>It is a neural network implementation without any dependent libraries (all written from scratch).</p>\n"}, {"tags": [], "owner": {"reputation": 2671, "user_id": 1099237, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1efff11270d3da94fe6be7d745c52da6?s=128&d=identicon&r=PG", "display_name": "omatai", "link": "https://stackoverflow.com/users/1099237/omatai"}, "is_accepted": false, "score": 0, "last_activity_date": 1612324877, "last_edit_date": 1612324877, "creation_date": 1602191637, "answer_id": 64270693, "question_id": 54000378, "link": "https://stackoverflow.com/questions/54000378/using-tensorflow-in-c-on-windows/64270693#64270693", "title": "Using tensorflow in C++ on Windows", "body": "<p>The answer seems to be that it is <a href=\"https://github.com/guikarist/tensorflow-windows-build-script\" rel=\"nofollow noreferrer\">hard</a> :-(</p>\n<p>Try <a href=\"https://github.com/sitting-duck/stuff/tree/master/ai/tensorflow/build_tensorflow_1.14_source_for_Windows\" rel=\"nofollow noreferrer\">this</a> to start. You can follow the latest instructions for <a href=\"https://www.tensorflow.org/install/source_windows\" rel=\"nofollow noreferrer\">building from source on Windows</a> up to the point of building the pip package. But don't do that - do this/these instead:</p>\n<pre><code>bazel -config=opt //tensorflow:tensorflow.dll \nbazel -config=opt //tensorflow:tensorflow.lib\nbazel -config=opt tensorflow:install_headers\n</code></pre>\n<p>That much seems to work fine. The problems really start when you try to use Any of the header files - you will probably get compilation errors, at least with TF version &gt;= 2.0. I have tried:</p>\n<ul>\n<li>Build the label_image example (instructions in the readme.md file)\n<ul>\n<li>It builds and runs fine on Windows, meaning all the headers and source are there somewhere</li>\n<li>Try incorporating that source into Windows console executable: runs into compiler errors due to conflicts with std::min &amp; std::max, probably due to Windows SDK.</li>\n</ul>\n</li>\n<li>Include c_api.h in a Windows console application: won't compile.</li>\n<li>Include TF-Lite header files: won't compile.</li>\n</ul>\n<p>There is little point investing the lengthy compile time in the first two bazel commands if you can't get the headers to compile :-(</p>\n<p>You may have time to invest in resolving these errors; I don't. At this stage Tensorflow lacks sufficient support for Windows C++ to rely on it, particularly in a commercial setting. I suggest exploring these options instead:</p>\n<ul>\n<li>If TF-Lite is an option, <a href=\"https://www.youtube.com/watch?v=dox1ZkFP-f4\" rel=\"nofollow noreferrer\">watch this</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/windows/ai/\" rel=\"nofollow noreferrer\">Windows ML/Direct ML</a> (requires conversion of TF models to ONNX format)</li>\n<li><a href=\"https://github.com/serizba/cppflow\" rel=\"nofollow noreferrer\">CPPFlow</a></li>\n<li><a href=\"https://github.com/Dobiasd/frugally-deep\" rel=\"nofollow noreferrer\">Frugally Deep</a></li>\n<li><a href=\"https://github.com/gosha20777/keras2cpp\" rel=\"nofollow noreferrer\">Keras2CPP</a></li>\n</ul>\n<p>UPDATE: having explored the list above, I eventually found the following worked best in my context (real-time continuous item recognition):</p>\n<ul>\n<li>convert models to ONNX format (use <a href=\"https://github.com/onnx/tensorflow-onnx\" rel=\"nofollow noreferrer\">tf2onnx</a> or <a href=\"https://github.com/onnx/keras-onnx\" rel=\"nofollow noreferrer\">keras2onnx</a></li>\n<li>use Microsoft's <a href=\"https://github.com/microsoft/onnxruntime\" rel=\"nofollow noreferrer\">ONNX runtime</a></li>\n</ul>\n<p>Even though Microsoft recommends using <a href=\"https://github.com/microsoft/DirectML\" rel=\"nofollow noreferrer\">DirectML</a> where milliseconds matter, the performance of ONNX runtime using DirectML as an execution provider means we can run a 224x224 RGB image through our Intel GPU in around 20ms, which is quick enough for us. But it was still hard finding our way to this answer</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 7243054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba0891e8d89a29959dc54f54c635f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Serizba", "link": "https://stackoverflow.com/users/7243054/serizba"}, "is_accepted": false, "score": 0, "last_activity_date": 1614243806, "creation_date": 1614243806, "answer_id": 66365382, "question_id": 54000378, "link": "https://stackoverflow.com/questions/54000378/using-tensorflow-in-c-on-windows/66365382#66365382", "title": "Using tensorflow in C++ on Windows", "body": "<p>I would say that the best option is to use <a href=\"https://github.com/serizba/cppflow\" rel=\"nofollow noreferrer\">cppflow</a>, an easy wrapper that I created to use Tensorflow from C++ easily.</p>\n<p>You won't need to install anything, just download the TF C API, and place it somewhere in your computer. You can take a look to the <a href=\"https://serizba.github.io/cppflow/\" rel=\"nofollow noreferrer\">docs</a> to see how to do it, and how to use the library.</p>\n"}], "owner": {"reputation": 611, "user_id": 4534466, "user_type": "registered", "accept_rate": 31, "profile_image": "https://graph.facebook.com/908092385875713/picture?type=large", "display_name": "Jo&#227;o Areias", "link": "https://stackoverflow.com/users/4534466/jo%c3%a3o-areias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1614243806, "creation_date": 1546393842, "question_id": 54000378, "link": "https://stackoverflow.com/questions/54000378/using-tensorflow-in-c-on-windows", "title": "Using tensorflow in C++ on Windows", "body": "<p>I know there are ways of using Tensorflow in C++ they even have a <a href=\"https://www.tensorflow.org/api_docs/cc/\" rel=\"nofollow noreferrer\">documentation</a> for it but I can seem to be able to get the library for it. I've checked the <a href=\"https://www.tensorflow.org/install/source_windows\" rel=\"nofollow noreferrer\">build from source instructions</a> but it seems to builds a pip package rather than a library I can link to my project. I also found a <a href=\"https://medium.com/@shiweili/building-tensorflow-c-shared-library-on-windows-e79c90e23e6e\" rel=\"nofollow noreferrer\">tutorial</a> but when I tried it out I ran out of memory and my computer crashed. My question is, how can I actually get the C++ library to work on my project? I do have these requirements, I have to work on windows with Visual Studio in C++. What I would love to is if I could get a pre-compiled DLL that I could just link but I haven't found such a thing and I'm open to other alternatives.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1546391285, "post_id": 54000183, "comment_id": 94837358, "body": "The problem is that you defined the <code>&lt;&lt;</code> overload an a <code>MainWind</code>, and the left-hand operand of this <code>&lt;&lt;</code> operator is not a <code>MainWind</code>. It is a <code>MainWind *</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546391614, "post_id": 54000192, "comment_id": 94837415, "body": "And if I want to use the pointer yet? without the &quot;*&quot; at the beginning. Is it possible? How should I change the overload?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546391865, "post_id": 54000192, "comment_id": 94837457, "body": "@Vlad, you can use <code>mainWind-&gt;operator&lt;&lt;(QString(&quot;str&quot;));</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546392744, "post_id": 54000192, "comment_id": 94837578, "body": "@Vlad, that&#39;s why you should use <code>*mainWind &lt;&lt; ...</code>"}, {"owner": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1546393117, "post_id": 54000192, "comment_id": 94837643, "body": "@RSahu Could you look at the added to the question above, where it is indicated that the pointer is expected as first op.There is a function overload, not a method."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 1, "creation_date": 1546393428, "post_id": 54000192, "comment_id": 94837697, "body": "@Vlad, try making the second argument <code>QString const&amp; str</code>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546400051, "post_id": 54000192, "comment_id": 94838727, "body": "@vlad ask another question using &quot;ask question&quot;. Invalidating existing answers to valid questions is frowned upon."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 3, "last_activity_date": 1546398517, "last_edit_date": 1546398517, "creation_date": 1546391280, "answer_id": 54000192, "question_id": 54000183, "link": "https://stackoverflow.com/questions/54000183/cant-overload-the-operator-for-a-my-own-class/54000192#54000192", "title": "Can`t overload the operator &lt;&lt; for a my own class", "body": "<p>You overloaded <code>&lt;&lt;</code> on <code>MainWnd</code> not <code>MainWnd*</code>.</p>\n\n<p><code>*mainWind &lt;&lt; QString(\"str\");</code></p>\n\n<p>Also you want <code>QString const&amp;</code></p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546393861, "post_id": 54000200, "comment_id": 94837768, "body": "This is fine, but I need to work with exactly the pointer, but the function overloading given above gives to me a result similar to the past."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546399820, "post_id": 54000200, "comment_id": 94838688, "body": "@Vlad, using pointers instead of objects is a choice. I am sure it is not a requirement. Morever, using pointers with the <code>&lt;&lt;</code> operators is not idiomatic. Just something to think about."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 5, "last_activity_date": 1546393612, "last_edit_date": 1546393612, "creation_date": 1546391413, "answer_id": 54000200, "question_id": 54000183, "link": "https://stackoverflow.com/questions/54000183/cant-overload-the-operator-for-a-my-own-class/54000200#54000200", "title": "Can`t overload the operator &lt;&lt; for a my own class", "body": "<p>You need to use <code>*mainWind &lt;&lt; QString(\"str\");</code>. The LHS has to be an object, not a pointer.</p>\n\n<p>While at it, I strongly recommend changing the <code>operator&lt;&lt;</code> function to return a reference to the object, not a pointer.</p>\n\n<pre><code>MainWind&amp; operator&lt;&lt;(const QString &amp;str);\n</code></pre>\n\n<p>and the implementation to</p>\n\n<pre><code>MainWind&amp; MainWind::operator&lt;&lt;(const QString &amp;str)\n{\n    ui-&gt;serverConsole-&gt;insertPlainText(str);\n    return *this;\n}\n</code></pre>\n\n<p>That will allow you to chain the operator.</p>\n\n<pre><code>*mainWind &lt;&lt; QString(\"str\") &lt;&lt; QString(\"Second string\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546394347, "post_id": 54000387, "comment_id": 94837845, "body": "A lot of text makes little sense ... How do I overload the function as in addition to my question?"}, {"owner": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546394426, "post_id": 54000387, "comment_id": 94837862, "body": "I would like to using the pointer without the &quot;*&quot;. Therefore, I want to overload the function."}, {"owner": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546394952, "post_id": 54000387, "comment_id": 94837956, "body": "Your example of function overload still result error: MainWind *mW = new MainWind; mW &lt;&lt; &quot;str&quot;; This is for your last insight? Maybe I do not use it correctly?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546395230, "post_id": 54000387, "comment_id": 94838001, "body": "@vlad - yeah, okay.   I forgot that overloading of global <code>operator&lt;&lt;()</code> to accept pointer arguments (as the first argument) is not allowed.   Edited accordingly.   In short:  there is no solution to your requirement."}, {"owner": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546396322, "post_id": 54000387, "comment_id": 94838155, "body": "Compilation of the function code (with the first parameter as the pointer) is  success normal, it means an error of use ... But where? MainWind *mW = new MainWind; mW &lt;&lt; &quot;str&quot;"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "edited": false, "score": 0, "creation_date": 1546397632, "post_id": 54000387, "comment_id": 94838361, "body": "The function may compile, however, there is no way it can be called  when doing <code>mW &lt;&lt; &quot;str&quot;</code>.    If there is a member version of <code>MainWind::operator&lt;&lt;()</code> then <code>*mW &lt;&lt; &quot;str&quot;</code> is implicitly translated to a call of something like<code>(*mW).MainWind::operator&lt;&lt;(&quot;str&quot;)</code>.    However, the standard specifies no equivalence which allows what you want i.e. turn <code>mW &lt;&lt; &quot;str&quot;</code> into a call of any <code>MainWind::operator&lt;&lt;()</code>.  In short, you&#39;re trying to do something that the standard doesn&#39;t support/allow. The closest you can come is the (ugly)  <code>mW-&gt;operator&lt;&lt;(&quot;str&quot;)</code>  (i.e. do what you want the compiler to do)."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1546395173, "last_edit_date": 1546395173, "creation_date": 1546393971, "answer_id": 54000387, "question_id": 54000183, "link": "https://stackoverflow.com/questions/54000183/cant-overload-the-operator-for-a-my-own-class/54000387#54000387", "title": "Can`t overload the operator &lt;&lt; for a my own class", "body": "<blockquote>\n<pre><code>//other.cpp\nMainWind *mainWind  = new MainWind;\nmainWind &lt;&lt;\"str\";\n</code></pre>\n</blockquote>\n\n<p>The reason is that <code>mainWind &lt;&lt; \"str\"</code> looks for an <code>operator&lt;&lt;()</code> that accepts two arguments, the first of which is a <code>MainWind *</code>.</p>\n\n<p>Whereas, you have defined a <code>MainWind::operator&lt;&lt;()</code> which is called with the first argument a <code>MainWind &amp;</code>.     There is no direct conversion from a <code>MainWind *</code> to a <code>MainWind &amp;</code> (or to a <code>MainWind</code>).    Hence the error message.</p>\n\n<p>One way to get the code to compile is to change <code>mainWind &lt;&lt;\"str\"</code> to <code>*mainWind &lt;&lt; \"str\"</code>.    The <code>*</code> dereferences the pointer, and produces a reference, which is what your <code>operator&lt;&lt;()</code> expects.</p>\n\n<p>The catch is then that</p>\n\n<pre><code>*mainWind &lt;&lt; \"str\" &lt;&lt; \"another str\";\n</code></pre>\n\n<p>will not compile, since it is equivalent to</p>\n\n<pre><code>(*mainWind).operator&lt;&lt;(\"str\") &lt;&lt; \"another str\";\n</code></pre>\n\n<p>where <code>(*mainWind).operator&lt;&lt;(\"str\")</code> returns a <code>MainWind *</code>.   This causes the same problem (again) when trying to stream <code>\"another str\"</code>.</p>\n\n<p>The real fix is to change <code>operator&lt;&lt;()</code> so it returns a reference</p>\n\n<pre><code>//  within the class definition of MainWind\n\nMainWind &amp;operator&lt;&lt;(const QString &amp;str);\n\n// definition of the operator&lt;&lt;()\n\nMainWind &amp;MainWind::operator&lt;&lt;(const QString &amp;str)\n{\n    ui-&gt;serverConsole-&gt;insertPlainText(str);\n    return *this;\n}\n</code></pre>\n\n<p>and change the calling code to either</p>\n\n<pre><code>//other.cpp version 2\n\nMainWind *mainWind  = new MainWind;\n*mainWind &lt;&lt;\"str\";\n\n// this will work too\n\n*mainWind &lt;&lt; \"str\" &lt;&lt; \"another str\";  \n\n//   note reliance on cleaning up mainWind to avoid a memory leak\n\ndelete mainWind;   \n</code></pre>\n\n<p>There is no other fix that would allow you to use <code>mainWind &lt;&lt; \"str\"</code> since overloading non-member <code>operator&lt;&lt;()</code> is only permitted on class or enumerated types, not on pointers.</p>\n"}], "owner": {"reputation": 17, "user_id": 10679531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa7307480deb53937116dd7614ce307?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/10679531/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 1, "accepted_answer_id": 54000387, "answer_count": 3, "score": -2, "last_activity_date": 1546398517, "creation_date": 1546391145, "last_edit_date": 1546397166, "question_id": 54000183, "link": "https://stackoverflow.com/questions/54000183/cant-overload-the-operator-for-a-my-own-class", "title": "Can`t overload the operator &lt;&lt; for a my own class", "body": "<p>I am trying to reduce code redundancy using the overload of an output operator to a stream instead of print functions.</p>\n\n<pre><code>//***.h\nclass MainWind : public QWidget\n{\n    Q_OBJECT\n\npublic:\n    explicit MainWind(QWidget *parent = nullptr);\n    ~MainWind();\n    MainWind *operator&lt;&lt;(const QString &amp;str);\nprivate:\n    Ui::MainWind *ui;\n};\n\n//***.cpp\nMainWind *MainWind::operator&lt;&lt;(const QString &amp;str)\n{\n    ui-&gt;serverConsole-&gt;insertPlainText(str);\n    return this;\n}\n</code></pre>\n\n<p>At this moment everything compiles successfully.</p>\n\n<p>But when I try to use:</p>\n\n<pre><code>//other.cpp\nMainWind *mainWind  = new MainWind;\nmainWind &lt;&lt; QString(\"str\");\n</code></pre>\n\n<p>I got this error:</p>\n\n<blockquote>\n  <p>ServerSocket.cpp:39: error: invalid operands to binary expression\n  ('MainWind *' and 'QString')\n  qstring.h:1410: candidate function not viable: no known conversion from >'MainWind *' to 'QDataStream &amp;' for 1st argument</p>\n  \n  <p>...</p>\n  \n  <p>And there are a lot of candidates for this position)</p>\n</blockquote>\n\n<p>Or</p>\n\n<pre><code>//other.cpp\nMainWind *mainWind  = new MainWind;\nmainWind &lt;&lt;\"str\";\n</code></pre>\n\n<p>I got this error:</p>\n\n<blockquote>\n  <p>ServerSocket.cpp:39: error: invalid operands to binary expression\n  ('MainWind *' and 'const char [4]') ServerSocket.cpp:39: error:\n  invalid operands of types 'MainWind*' and 'const char [4]' to binary\n  'operator&lt;&lt;'\n           CurrentSession::inst().mainWind() &lt;&lt; \"str\";</p>\n\n<pre><code>                                                  ^\n</code></pre>\n</blockquote>\n\n<p>What could be the problem?</p>\n\n<p>ADDITION TO THIS QUESTION:</p>\n\n<p>Attempt to use:</p>\n\n<pre><code>//*.h\nfriend MainWind *operator&lt;&lt;(MainWind *out,QString &amp;str);\n\n//***.cpp\nMainWind * operator&lt;&lt;(MainWind *out, QString &amp;str)\n{\n    out-&gt;ui-&gt;serverConsole-&gt;insertPlainText(str);\n    return out;\n}\n</code></pre>\n\n<p>Compilation of previous code is successful.</p>\n\n<p>According to the idea, if the first operand could not be a pointer, this code would not compile...</p>\n\n<p>But when using this:</p>\n\n<pre><code>//other.cpp\nMainWind *mW = new MainWind;\nmW &lt;&lt; \"str\";\n</code></pre>\n\n<p>Compilation go to error:</p>\n\n<blockquote>\n  <p>ServerSocket.cpp:37: error: invalid operands of types 'MainWind*' and 'const char [4]' to binary 'operator&lt;&lt;'\n                  mW &lt;&lt; \"str\";</p>\n\n<pre><code>                ^\n</code></pre>\n</blockquote>\n"}, {"tags": ["c++", "resources", "directx"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546390445, "post_id": 54000030, "comment_id": 94837189, "body": "Show us your code and what does the documentation say?"}, {"owner": {"reputation": 165, "user_id": 9442142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d28072fda7e23b58d93d8332ac3d14?s=128&d=identicon&r=PG&f=1", "display_name": "K. Krull", "link": "https://stackoverflow.com/users/9442142/k-krull"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546392445, "post_id": 54000030, "comment_id": 94837527, "body": "The documentation is pretty unclear, I couldn&#39;t find any information on this specific question. It describes only what resources and resource views are and how they are linked in theory, but I couldn&#39;t find out what that actually means in this situation."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1546412611, "post_id": 54000030, "comment_id": 94841599, "body": "You mention using <a href=\"https://github.com/Microsoft/DirectXTex/wiki\" rel=\"nofollow noreferrer\">DirectXTex</a>. Keep in mind that the library there is intended more for tools, so it&#39;s probably over-kill for your demo. The simpler loaders in <a href=\"https://github.com/Microsoft/DirectXTK/wiki\" rel=\"nofollow noreferrer\">DirectX Tool Kit</a> might be more appropriate although either works. See <a href=\"https://blogs.msdn.microsoft.com/chuckw/2012/05/04/direct3d-11-textures-and-block-compression/\" rel=\"nofollow noreferrer\">this blog post</a> for the reason why there are two different libraries that do the same thing."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1546413251, "post_id": 54000030, "comment_id": 94841815, "body": "Actually, you are using the WICTextureLoader module if you are using <code>CreateWICTextureFromFile</code>. It&#39;s just a standalone version in the DirectXTex package rather than the one that&#39;s included with the <i>DirectX Tool Kit</i>. The DirectXTex library itself has <code>CreateTexture</code> and <code>CreateShaderResourceView</code> which you are not using."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 9442142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d28072fda7e23b58d93d8332ac3d14?s=128&d=identicon&r=PG&f=1", "display_name": "K. Krull", "link": "https://stackoverflow.com/users/9442142/k-krull"}, "edited": false, "score": 0, "creation_date": 1546430821, "post_id": 54002539, "comment_id": 94848652, "body": "Thanks! That was exacltly the information I have been looking for."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "reply_to_user": {"reputation": 165, "user_id": 9442142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d28072fda7e23b58d93d8332ac3d14?s=128&d=identicon&r=PG&f=1", "display_name": "K. Krull", "link": "https://stackoverflow.com/users/9442142/k-krull"}, "edited": false, "score": 0, "creation_date": 1546451873, "post_id": 54002539, "comment_id": 94858704, "body": "I realized last night that the &quot;Introduction to COM for DirectX Programming&quot; documentation topic has disappeared from the web. It was in the DirectX SDK documentation CTM, so it got dropped since we haven&#39;t shipped it in 9+ years. I&#39;ll make sure to get that on a doc backlog..."}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1547679975, "post_id": 54002539, "comment_id": 95279488, "body": "Good answer except ComPtr smart pointers. Old ones, <code>CComPtr</code> from ATL, are better: work on all versions of Windows and all compilers, also they have operator <code>I*</code> so you don&#39;t have to type <code>Get</code> every time you pass them to a method."}, {"owner": {"reputation": 15641, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1547680100, "post_id": 54002539, "comment_id": 95279524, "body": "BTW, the linked page is deprecated: ATL is now available in all editions of VS including the freeware community edition. MFC too."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1547683767, "post_id": 54002539, "comment_id": 95280462, "body": "Yes it is available, but it&#39;s also an optional component you have to explicitly select in VS 2017&#39;s installer."}], "tags": [], "owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "is_accepted": true, "score": 3, "last_activity_date": 1546413433, "last_edit_date": 1546413433, "creation_date": 1546412965, "answer_id": 54002539, "question_id": 54000030, "link": "https://stackoverflow.com/questions/54000030/how-when-to-release-resources-and-resource-views-in-directx/54002539#54002539", "title": "How/When to release resources and resource views in DirectX", "body": "<p>Direct3D uses reference counting (via the <code>AddRef</code> and <code>Release</code>) methods to control object lifetime, with a few specific quirks because it does not follow all the rules of the general Component Object Model (<a href=\"https://docs.microsoft.com/en-us/windows/desktop/com/the-component-object-model\" rel=\"nofollow noreferrer\">COM</a>).</p>\n\n<p>Specifically, if the <em>only</em> reference to an object is if you use set it on the device context (a.k.a. bind it to the rendering pipeline), that's not enough to keep it alive because those methods don't increment/decrement the reference count. See <a href=\"https://docs.microsoft.com/en-us/windows/desktop/direct3d10/d3d10-graphics-programming-guide-api-features-reference-counting\" rel=\"nofollow noreferrer\">Microsoft Docs</a>. Therefore your program needs to keep some other reference to the Direct3D objects it is currently using.</p>\n\n<p>The other difference is if the <code>ID3D11Device</code> is destroyed because it's reference count hits zero, then it doesn't matter what the reference counts are for all it's <code>ID3D11DeviceChild</code> objects and those are all invalid at that point.</p>\n\n<p>You should also keep in mind that Direct3D objects are not actually destroyed until some future point (a.k.a. it uses lazy-destruction) so even if the reference count is zero, it might take a few frames before it's cleaned up fully. This mostly matters if you are dealing with a lot of active resources and have to worry about over-committing--as an aside, you can force pending destructions to complete by using <code>ID3D11DeviceContext::Flush</code>, but it's not a good practice for performance to do it often.</p>\n\n<p><strong>TL;DR:</strong> The <code>ID3D11ShaderResourceView</code> object added a reference count to the referenced <code>ID3D11Resource</code> object, so as long as the SRV is active the resource is kept alive as well. You only need to take one of the return objects of <code>CreateWICTextureFromFile</code>, but you can take both if you want. See the <a href=\"https://github.com/Microsoft/DirectXTK/wiki/WICTextureLoader\" rel=\"nofollow noreferrer\">wiki</a> page for the WICTextureLoader module for more information.</p>\n\n<blockquote>\n  <p>This is a good reason to learn to use the <a href=\"https://github.com/Microsoft/DirectXTK/wiki/ComPtr\" rel=\"nofollow noreferrer\">ComPtr</a> smart-pointer. It takes care of the reference counts if you use it correctly so you can avoid worrying about it in most cases.</p>\n</blockquote>\n"}], "owner": {"reputation": 165, "user_id": 9442142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d28072fda7e23b58d93d8332ac3d14?s=128&d=identicon&r=PG&f=1", "display_name": "K. Krull", "link": "https://stackoverflow.com/users/9442142/k-krull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "accepted_answer_id": 54002539, "answer_count": 1, "score": 1, "last_activity_date": 1546413433, "creation_date": 1546388996, "last_edit_date": 1546392249, "question_id": 54000030, "link": "https://stackoverflow.com/questions/54000030/how-when-to-release-resources-and-resource-views-in-directx", "title": "How/When to release resources and resource views in DirectX", "body": "<p>I'm doing working on a DirectX 11 demo application and stumbled over the following problem:<br>\nWhen I create a shader resource view (let's say for a texture) from a file, I have to release it after usage just as every other D3D11 object. But what about the underlying resource, that is created implicitly?</p>\n\n<p>There are three scenarios I can imagine:<br>\n+ I should leave the resource alone. It is released by the call to <code>someShaderResourceView-&gt;Release()</code><br>\n+ I should release it manually together with the shader resource view object.<br>\n+ I should release it immediately. This seems to work, although it doesn't seem reasonable to me.</p>\n\n<p>What is the correct way to handle this?  </p>\n\n<p>Edit: I'm using the DirectXTex texture loading library, but I would like to keep the question general.</p>\n\n<pre><code>ID3D11Resource *resource;\nID3D11ShaderResourceView *resourceView;\nHRESULT result = CreateWICTextureFromFile(device, path.c_str(), &amp;resource, &amp;texture, 0);\n//resource-&gt;Release(); ???\n</code></pre>\n\n<p>Instead of <code>CreateWICTextureFromFile(...)</code> one could also use the old D3DX11 function <code>D3DX11CreateShaderResourceViewFromFile(...)</code>.</p>\n"}, {"tags": ["c++", "image-processing", "computer-vision", "convolution", "sobel"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1546391717, "post_id": 53999998, "comment_id": 94837430, "body": "I see <code>clamp</code> and <code>abs</code> in your code. Both should be removed, they\u2019re incorrect. Put your output pixels in a signed int16 or larger type (I like to use <code>float</code>). After computing all values you can decide how to scale the output to the display range. This is the reason you get different results depending on the order in which you apply the two 2D filters (smoothing &amp; derivative)."}, {"owner": {"reputation": 11, "user_id": 10855698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c026ba1ce2b14c792ad3d27acae2282?s=128&d=identicon&r=PG&f=1", "display_name": "user name", "link": "https://stackoverflow.com/users/10855698/user-name"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1546395684, "post_id": 53999998, "comment_id": 94838071, "body": "Yes, the language is C++. Thanks for that. Why does it matter type I store my RGB values in? Won&#39;t I always scale my values between 0 and 1 in the end, even if I store the RGB in floats?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1546399557, "post_id": 53999998, "comment_id": 94838652, "body": "If you store your values as int and scale them between 0 and 1 there won\u2019t be much information left...  I don\u2019t know what type <code>Image</code> is here, but more often than not it\u2019ll be a uint8. You can\u2019t store negative values there. Also you need to be careful with scaling values, as that affects the magnitude of the gradient you compute."}], "owner": {"reputation": 11, "user_id": 10855698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c026ba1ce2b14c792ad3d27acae2282?s=128&d=identicon&r=PG&f=1", "display_name": "user name", "link": "https://stackoverflow.com/users/10855698/user-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1546391346, "creation_date": 1546388460, "last_edit_date": 1546391346, "question_id": 53999998, "link": "https://stackoverflow.com/questions/53999998/why-is-my-sobel-filter-output-so-bright-when-using-separable-kernels", "title": "Why is my sobel filter output so bright when using separable kernels?", "body": "<p>I'm trying to implement the Sobel filter from scratch. I'm using the separable filters described at <a href=\"https://en.wikipedia.org/wiki/Sobel_operator#Technical_details\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Sobel_operator#Technical_details</a>.</p>\n\n<p>Here is my original image converted to greyscale: \n<a href=\"https://i.stack.imgur.com/NcEJX.png\" rel=\"nofollow noreferrer\">greyscale image</a></p>\n\n<p>The output for my Sobel X-gradient is fine: <a href=\"https://i.stack.imgur.com/xaE8q.png\" rel=\"nofollow noreferrer\">x-gradient sobel filtered image</a></p>\n\n<p>However, my image for the Sobel y-gradient is not correct: <a href=\"https://i.stack.imgur.com/VLWkT.png\" rel=\"nofollow noreferrer\">y-gradient sobel filtered image</a></p>\n\n<p>It seems to me like the pixel values are too high. This is what the y-gradient image looks like after the horizontal convolution with the kernel <code>[1, 2, 1]</code>, but before the vertical convolution: <a href=\"https://i.stack.imgur.com/ajMt3.png\" rel=\"nofollow noreferrer\">y-gradient horizontal only</a></p>\n\n<p>Here is the code. Note that for the y-gradient I just copy-pasted the x-gradient code and swapped which kernel gets used first (as the Wikipedia page denotes):</p>\n\n<pre><code>int sobel_1[3] = {1, 0, -1};\nint sobel_2[3] = {1, 2, 1};\n\nImage Image::sobel_x(){\n    Image grayscale = this-&gt;grayscale();\n    Image sobel_x = Image(m_width, m_height, m_max);\n\n    int r_delta[3] = {-1, 0, 1};\n    int c_delta[3] = {-1, 0, 1};\n\n    for (int row = 0; row &lt; m_height; row++){\n        for (int col = 0; col &lt; m_width; col++){\n            Color new_color = Color();\n\n            for (int i = 0; i &lt; 3; i++){   \n                int new_c = col + c_delta[i]; \n\n                if (new_c &gt;= 0 &amp;&amp; new_c &lt; m_width){\n                    new_color = new_color + (grayscale.getRGB(row, new_c) * sobel_1[i]);\n                }\n            }\n\n            new_color = Color(abs(new_color.get_r()), abs(new_color.get_g()), abs(new_color.get_b()));\n            new_color.clamp();\n\n            sobel_x.setColor(row, col, new_color);\n        }\n    }\n\n    for (int row = 0; row &lt; m_height; row++){\n        for (int col = 0; col &lt; m_width; col++){\n            Color new_color = Color();\n\n            for (int i = 0; i &lt; 3; i++){\n                int new_r = row + r_delta[i]; \n\n                if (new_r &gt;= 0 &amp;&amp; new_r &lt; m_height){\n                    new_color = new_color + (sobel_x.getRGB(new_r, col) * sobel_2[i]);\n                }\n            }\n\n            new_color = Color(abs(new_color.get_r()), abs(new_color.get_g()), abs(new_color.get_b()));\n            new_color.clamp();\n            new_color = new_color / 8;\n\n            sobel_x.setColor(row, col, new_color);\n        }\n    }\n\n    return sobel_x;\n}\n\nImage Image::sobel_y(){\n    Image grayscale = this-&gt;grayscale();\n    Image sobel_y = Image(m_width, m_height, m_max);\n\n    int r_delta[3] = {-1, 0, 1};\n    int c_delta[3] = {-1, 0, 1};\n\n    for (int row = 0; row &lt; m_height; row++){\n        for (int col = 0; col &lt; m_width; col++){\n            Color new_color = Color();\n\n            for (int i = 0; i &lt; 3; i++){   \n                int new_c = col + c_delta[i]; \n\n                if (new_c &gt;= 0 &amp;&amp; new_c &lt; m_width){\n                    new_color = new_color + (grayscale.getRGB(row, new_c) * sobel_2[i]);\n                }\n            }\n\n            new_color = Color(abs(new_color.get_r()), abs(new_color.get_g()), abs(new_color.get_b()));\n            new_color.clamp();\n\n            sobel_y.setColor(row, col, new_color);\n        }\n    }\n\n    for (int row = 0; row &lt; m_height; row++){\n        for (int col = 0; col &lt; m_width; col++){\n            Color new_color = Color();\n\n            for (int i = 0; i &lt; 3; i++){\n                int new_r = row + r_delta[i]; \n\n                if (new_r &gt;= 0 &amp;&amp; new_r &lt; m_height){\n                    new_color = new_color + (sobel_y.getRGB(new_r, col) * sobel_1[i]);\n                }\n            }\n\n            new_color = Color(abs(new_color.get_r()), abs(new_color.get_g()), abs(new_color.get_b()));\n            new_color.clamp();\n            new_color = new_color / 8;\n\n            sobel_y.setColor(row, col, new_color);\n        }\n    }\n\n    return sobel_y;\n}\n</code></pre>\n"}, {"tags": ["c++", "function", "sorting", "recursion", "singly-linked-list"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1546387590, "post_id": 53999906, "comment_id": 94836768, "body": "Do some Google searching on &quot;proof by induction&quot;. It&#39;s a mathematical concept, but it  applies here perfectly. Once you&#39;ve read and understood how proof by induction works, you should be able to understand this recursive function perfectly: presume that this function returns a sorted list. That&#39;s your starting point. This function returns a sorted list. You accept this fact, for granted. Now, go through this simple function, line by line, using the basic principles of proof by induction that you&#39;ve just learned."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1546409296, "post_id": 53999906, "comment_id": 94840578, "body": "linking <a href=\"https://en.wikipedia.org/wiki/Mathematical_induction\" rel=\"nofollow noreferrer\">Mathematical induction</a> or <a href=\"https://en.wikipedia.org/wiki/Structural_induction\" rel=\"nofollow noreferrer\">Structural induction</a> would&#39;ve been helpful"}], "answers": [{"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 1, "last_activity_date": 1546402689, "last_edit_date": 1546402689, "creation_date": 1546391853, "answer_id": 54000227, "question_id": 53999906, "link": "https://stackoverflow.com/questions/53999906/how-does-this-recursive-function-work-to-merge-sort-two-singly-linked-lists/54000227#54000227", "title": "how does this recursive function work? to merge sort two singly linked lists", "body": "<p>I added comments to the code. I also changed the if from &lt; to &lt;= in case this was being used for a merge sort, where if h1->data == h2->data, you'd want h1 first for stability. Keep in mind that the two lists are already sorted, this function is just merging them.</p>\n\n<p>The function recursively follows the two lists, skipping past smaller nodes, until it reaches the end of one of the lists, at which point it sets the end of that list to the remainder of the other list and then returns back up the chain of recursive calls, working its way backwards along the lists, setting the smaller nodes next pointers to merge the lists from back to front. This is an inefficient way of merging lists, since it consumes O(n) stack space due to recursion on every node, but it's probably meant as a learning exercise, not to be efficient.</p>\n\n<pre><code>// initial input parameters, h1 and h2 each point to already sorted lists\nNode *merge(Node *h1, Node *h2) \n{\n    if (!h1)                                // if h1 empty\n        return h2;                          //  return h2\n    if (!h2)                                // if h2 empty\n        return h1;                          //  return h1\n\n    if (h1-&gt;data &lt;= h2-&gt;data)               // if h1-&gt;data &lt;= h2-&gt;data\n    {\n        h1-&gt;next = merge(h1-&gt;next, h2);     //  h1-&gt;next = smaller of {h1-&gt;next, h2}\n        return h1;                          //  return h1\n    }\n    else                                    // else h1-&gt;data &gt; h2-&gt;data\n    {\n        h2-&gt;next = merge(h1, h2-&gt;next);     //  h2-&gt;next = smaller of {h1, h2-&gt;next}\n        return h2;                          //  return h2\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 462, "user_id": 4068350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oJi3Pk7K-r8/AAAAAAAAAAI/AAAAAAAAAVk/Su6nDLc_WVM/photo.jpg?sz=128", "display_name": "aybassiouny", "link": "https://stackoverflow.com/users/4068350/aybassiouny"}, "is_accepted": false, "score": 0, "last_activity_date": 1546403862, "creation_date": 1546403862, "answer_id": 54001250, "question_id": 53999906, "link": "https://stackoverflow.com/questions/53999906/how-does-this-recursive-function-work-to-merge-sort-two-singly-linked-lists/54001250#54001250", "title": "how does this recursive function work? to merge sort two singly linked lists", "body": "<p>I believe taking an example is the best way to understand how recursive algorithms work. Let's use these two sample linked lists as an example: </p>\n\n<ul>\n<li><code>{13, 24, 74}</code></li>\n<li><code>{34, 72, 95}</code></li>\n</ul>\n\n<p>Notice that both of them are sorted, since that's a requirement by the <a href=\"https://www.geeksforgeeks.org/merge-two-sorted-lists-place/\" rel=\"nofollow noreferrer\">algorithm</a>:</p>\n\n<blockquote>\n  <p>Given two sorted lists, merge them so as to produce a combined sorted list </p>\n</blockquote>\n\n<p>I have compiled a trace of how this turns out: </p>\n\n<ul>\n<li>Arrow are execution order</li>\n<li>Each line is a stack frame. In particular, the line on the left is before recursive call for <code>merge</code>, and the right is its result after. </li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/eSKTC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eSKTC.png\" alt=\"Execution order\"></a></p>\n\n<p>Notice the following as well: </p>\n\n<ul>\n<li>On each arrow on the left, the smaller element from start of the nodes disappears</li>\n<li>on the way back, that smaller element gains sorted order of elements on the other side. On the very end we return the list that just gained the other one in a sorted form, namely: {13, 24, 34, 72, 74, 95}</li>\n</ul>\n"}], "owner": {"reputation": 272, "user_id": 9873440, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GBPc9x7F77s/AAAAAAAAAAI/AAAAAAAANus/rxWRlau0K1c/photo.jpg?sz=128", "display_name": "Annunaki", "link": "https://stackoverflow.com/users/9873440/annunaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1546403862, "creation_date": 1546387389, "question_id": 53999906, "link": "https://stackoverflow.com/questions/53999906/how-does-this-recursive-function-work-to-merge-sort-two-singly-linked-lists", "title": "how does this recursive function work? to merge sort two singly linked lists", "body": "<p>I've found this recursive function in C++ on geeksforgeeks.org, to merge and sort two singly linked lists, I used netbeans to debug this code but still I can't get the clear idea behind the function of this code. also I've seen similar code stackoverflow but with no explanation about the way it works. my question is about the idea behind it and the way it works where the sufficient explanation here also will help others with the same question.  </p>\n\n<p>debugged the code on netbeans to understand the work flow of the code </p>\n\n<pre><code>//Merges two given lists in-place. This function \n// mainly compares head nodes and calls mergeUtil() \n\nNode *merge(Node *h1, Node *h2) \n { \nif (!h1) \n    return h2; \nif (!h2) \n    return h1; \n\n// start with the linked list \n// whose head data is the least \nif (h1-&gt;data &lt; h2-&gt;data) \n{ \n    h1-&gt;next = merge(h1-&gt;next, h2); \n    return h1; \n} \nelse\n{ \n    h2-&gt;next = merge(h1, h2-&gt;next); \n    return h2; \n } \n} \n</code></pre>\n\n<p>this function should return one sorted linked list</p>\n"}, {"tags": ["c++", "multithreading", "static", "c++14", "static-order-fiasco"], "comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1546444767, "post_id": 53999850, "comment_id": 94855472, "body": "Couple of gratuitous opinions here: (1) You are going to a lot of trouble to understand tricky semantics of the language. I would spend the time trying to write code that Joe Average developer could read, understand, and safely modify without consulting the language spec. (2) You are going to a lot of trouble to understand <code>static</code> variables. I would spend the time trying to <i>eliminate</i> <code>static</code> variables from my design."}, {"owner": {"reputation": 13070, "user_id": 1639256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8KYbp.jpg?s=128&g=1", "display_name": "Oktalist", "link": "https://stackoverflow.com/users/1639256/oktalist"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1546450644, "post_id": 53999850, "comment_id": 94858208, "body": "@SolomonSlow I agree on both counts, and that is my long-term goal. However today I just want to fix a bug without refactoring the entire system."}], "answers": [{"comments": [{"owner": {"reputation": 13070, "user_id": 1639256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8KYbp.jpg?s=128&g=1", "display_name": "Oktalist", "link": "https://stackoverflow.com/users/1639256/oktalist"}, "edited": false, "score": 0, "creation_date": 1546397062, "post_id": 54000583, "comment_id": 94838254, "body": "No guarantee means completely unsequenced? Not even indeterminately sequenced?"}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "reply_to_user": {"reputation": 13070, "user_id": 1639256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8KYbp.jpg?s=128&g=1", "display_name": "Oktalist", "link": "https://stackoverflow.com/users/1639256/oktalist"}, "edited": false, "score": 0, "creation_date": 1546398988, "post_id": 54000583, "comment_id": 94838559, "body": "@Oktalist No. All implementation defined. <a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.start.dynamic#6\" rel=\"nofollow noreferrer\">It is implementation-defined in which threads and at which points in the program such deferred dynamic initialization occurs.</a>"}, {"owner": {"reputation": 442, "user_id": 901993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adca8f76dc78b68f61d028115e9ef5ae?s=128&d=identicon&r=PG", "display_name": "amilamad", "link": "https://stackoverflow.com/users/901993/amilamad"}, "edited": false, "score": 0, "creation_date": 1546487738, "post_id": 54000583, "comment_id": 94869045, "body": "Can`t you use a one singleton object that includes both foo and bar objects?. I use this approach to ensure the correct initialization and destruction order."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "reply_to_user": {"reputation": 442, "user_id": 901993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adca8f76dc78b68f61d028115e9ef5ae?s=128&d=identicon&r=PG", "display_name": "amilamad", "link": "https://stackoverflow.com/users/901993/amilamad"}, "edited": false, "score": 1, "creation_date": 1546497843, "post_id": 54000583, "comment_id": 94871391, "body": "@amilamad <code>foo</code> is a <code>thread_local</code>, it can&#39;t be a non-static member of your singleton. If you meant a static member, then what is stated in this answer still applies."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": true, "score": 5, "last_activity_date": 1546396370, "creation_date": 1546396370, "answer_id": 54000583, "question_id": 53999850, "link": "https://stackoverflow.com/questions/53999850/order-of-initialization-and-destruction-of-block-scope-static-vs-namespace-scop/54000583#54000583", "title": "Order of initialization and destruction of block-scope static vs. namespace-scope thread_local in main thread", "body": "<p>The standard guarantees that destruction of <code>Foo</code>(the thread local storage) is before <code>Bar</code>(the static storage):</p>\n\n<p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.start.term#2\" rel=\"noreferrer\">[basic.start.term]/2</a></p>\n\n<blockquote>\n  <p>The completions of the destructors for all initialized objects with thread storage duration within that thread strongly happen before the initiation of the destructors of any object with static storage duration.</p>\n</blockquote>\n\n<p>However, there is no guarantee about the construction order. The standard only says that the thread local should be constructed before its first odr-use:</p>\n\n<p><a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.stc.thread#2\" rel=\"noreferrer\">[basic.stc.thread]/2</a></p>\n\n<blockquote>\n  <p>A variable with thread storage duration shall be initialized before its first odr-use</p>\n</blockquote>\n"}], "owner": {"reputation": 13070, "user_id": 1639256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8KYbp.jpg?s=128&g=1", "display_name": "Oktalist", "link": "https://stackoverflow.com/users/1639256/oktalist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "accepted_answer_id": 54000583, "answer_count": 1, "score": 6, "last_activity_date": 1546487717, "creation_date": 1546386739, "question_id": 53999850, "link": "https://stackoverflow.com/questions/53999850/order-of-initialization-and-destruction-of-block-scope-static-vs-namespace-scop", "title": "Order of initialization and destruction of block-scope static vs. namespace-scope thread_local in main thread", "body": "<p>I'm trying to understand the sequencing rules for initialization and destruction of namespace-scope and block-scope objects with static storage duration and thread-local storage duration in the context of the main thread. Consider these two classes:</p>\n\n<pre><code>struct Foo {\n    Foo() { std::cout &lt;&lt; \"Foo\\n\"; }\n    ~Foo() { std::cout &lt;&lt; \"~Foo\\n\"; }\n    static Foo &amp;instance();\n};\nstruct Bar {\n    Bar() { std::cout &lt;&lt; \"Bar\\n\"; }\n    ~Bar() { std::cout &lt;&lt; \"~Bar\\n\"; }\n    static Bar &amp;instance();\n};\n</code></pre>\n\n<p>They are identical except for the implementations of their static <code>instance</code> member functions:</p>\n\n<pre><code>thread_local Foo t_foo;\nFoo &amp;Foo::instance() { return t_foo; }\n\nBar &amp;Bar::instance() { static Bar s_bar; return s_bar; }\n</code></pre>\n\n<p><code>Bar</code> is a Meyers singleton, a block-scope object with static storage duration.</p>\n\n<p><code>Foo</code>'s instance is a namespace-scope object with thread-local storage duration.</p>\n\n<p>Now the <code>main</code> function:</p>\n\n<pre><code>int main() {\n    Bar::instance();\n    Foo::instance();\n}\n</code></pre>\n\n<p>Here's the output from GCC 8.1.0 and Clang 5.0.0:</p>\n\n<pre><code>Bar\nFoo\n~Foo\n~Bar\n</code></pre>\n\n<p>Try it live: <a href=\"https://coliru.stacked-crooked.com/a/f83a9ec588aed921\" rel=\"noreferrer\">https://coliru.stacked-crooked.com/a/f83a9ec588aed921</a></p>\n\n<p>I had expected that <code>Foo</code> would be constructed first, because it is at namespace scope. I suppose the implementation is permitted to defer the initialization until the first odr-use of the object. I didn't know it could be deferred until after the initialization of a block-scope static, but I can live with that.</p>\n\n<p>Now I reverse the order of the function calls in <code>main</code>:</p>\n\n<pre><code>int main() {\n    Foo::instance();\n    Bar::instance();\n}\n</code></pre>\n\n<p>And here's the output:</p>\n\n<pre><code>Foo\nBar\n~Foo\n~Bar\n</code></pre>\n\n<p>Now I've moved the first odr-use of the <code>Foo</code> instance to before the first call to <code>Bar::instance</code>, and the order of initialization is as I expected.</p>\n\n<p>But I thought the objects should be destroyed in the reverse order of their initialization, which does not appear to be happening. What am I missing?</p>\n\n<p>In relation to the initialization and destruction of objects of static and thread-local storage duration, cppreference and the standard say things like \"when the program starts\", \"when the thread starts\", \"when the program ends\", and \"when the thread ends\", but how do these concepts relate to each other in the context of the main thread? Or to be more precise, the first thread and the last thread?</p>\n\n<p>In my \"real\" problem, <code>Foo</code> (the thread-local) is used by the logger, and the destructor of the base class of <code>Bar</code> uses the logger, so it's a static destruction order fiasco. Other threads are spawned, but <code>Bar</code> (the Meyers singleton) is constructed and destroyed in the main thread. If I could understand the sequencing rules, then I could try to solve the \"real\" problem without resorting to just trying things at random.</p>\n"}, {"tags": ["c++", "oop", "inheritance", "interface", "solid-principles"], "comments": [{"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 0, "creation_date": 1546385134, "post_id": 53999717, "comment_id": 94836418, "body": "How could it call the <code>bar</code> member function on an <code>A</code>? Could you just make <code>function</code> take a <code>B</code>, and then just use <code>dynamic_cast</code>?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1546385220, "post_id": 53999717, "comment_id": 94836439, "body": "This is what private virtual functions are for. <code>A</code> can call its virtual function, that&#39;s implemented in <code>B</code>, and the private function is not accessible from outside the class."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1546385878, "post_id": 53999717, "comment_id": 94836532, "body": "This should do the trick:  <code>int B::foo() { bar(); }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 651, "user_id": 1165590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/05ae818f8f3faa8ffb4c19d732ac01d3?s=128&d=identicon&r=PG", "display_name": "Baj Mile", "link": "https://stackoverflow.com/users/1165590/baj-mile"}, "edited": false, "score": 0, "creation_date": 1546393538, "post_id": 54000185, "comment_id": 94837716, "body": "But if you have class C deriving B, dynamic_cast will pass for C too, but C may or may not implements bar() - how you will protect from someone passing C to function() and getting the default behavior? He will end with bar() again declared as virtual or final - to forbid the derived classes from implementing bar() by mistake and making it for &quot;B only&quot;. The best design is to have such functions defined in base class too with clear default behavior."}, {"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "reply_to_user": {"reputation": 651, "user_id": 1165590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/05ae818f8f3faa8ffb4c19d732ac01d3?s=128&d=identicon&r=PG", "display_name": "Baj Mile", "link": "https://stackoverflow.com/users/1165590/baj-mile"}, "edited": false, "score": 0, "creation_date": 1546432257, "post_id": 54000185, "comment_id": 94849306, "body": "As long as we follow the Liskov Substitution Principle, then passing a <code>C</code> to the function (where <code>C</code> derives from <code>B</code>) will work fine.  <code>C</code> is a <code>B</code>."}, {"owner": {"reputation": 114, "user_id": 6787568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f76cc8e9f31355de4d31c5876295b4?s=128&d=identicon&r=PG&f=1", "display_name": "Bertramp", "link": "https://stackoverflow.com/users/6787568/bertramp"}, "edited": false, "score": 0, "creation_date": 1546467182, "post_id": 54000185, "comment_id": 94864784, "body": "I agree that creating a new interface would be good in this case. I&#39;m looking at a base class with 20 ish functions not counting operators and lifecycle methods though, and I&#39;m seriously considering adding another just to maybe avoid refactoring the whole damned system. Doing as in your code example invites to breaking the open closed principle though imo"}], "tags": [], "owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "is_accepted": false, "score": 1, "last_activity_date": 1546391164, "creation_date": 1546391164, "answer_id": 54000185, "question_id": 53999717, "link": "https://stackoverflow.com/questions/53999717/how-to-use-functions-from-derived-class-without-adding-them-to-the-base-class/54000185#54000185", "title": "How to use functions from derived class without adding them to the base class", "body": "<p>The short answer is yes, use the <code>dynamic_cast</code> operator (but see below).  The magic function would look something like this:</p>\n\n<pre><code>void function(A&amp; a)\n{\n  B* b = dynamic_cast&lt;B*&gt;(&amp;a);\n  if (b)\n  {\n    // Object is a B...\n    b-&gt;bar();\n  }\n  else\n  {\n    // fallback logic using only methods on A\n  }\n}\n</code></pre>\n\n<p>But be aware that many programmers consider this a code smell.  In particular, if there's no way to implement the \"fallback\" branch, then it suggests the function should really accept a <code>B</code> and something in the design may be amiss.  (It's hard to say when talking in such generalities, however.)  Also be aware that <code>dynamic_cast</code> can be expensive, particularly with complex class hierarchies.</p>\n\n<p>If at all reasonable, it's preferable to move the <code>B</code>-specific logic into the <code>B</code> class somehow.  You might also consider making the <code>bar</code> method a member of the <code>A</code> class (<code>A</code> would provide some sensible default implementation).  Another approach might be to create a new interface to hold the <code>bar</code> method and have your function accept an object of that type.  (The <code>B</code> class would implement both <code>A</code> and the new interface.)</p>\n"}], "owner": {"reputation": 114, "user_id": 6787568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f76cc8e9f31355de4d31c5876295b4?s=128&d=identicon&r=PG&f=1", "display_name": "Bertramp", "link": "https://stackoverflow.com/users/6787568/bertramp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546391164, "creation_date": 1546384986, "question_id": 53999717, "link": "https://stackoverflow.com/questions/53999717/how-to-use-functions-from-derived-class-without-adding-them-to-the-base-class", "title": "How to use functions from derived class without adding them to the base class", "body": "<p>This is very likely a silly question, but I can't seem to figure out if this is at all possible and if it should actually be done.</p>\n\n<p>Say some code relies a lot on using a certain virtual base class acting as an interface and then deriving several subclasses that implements the virtual methods the base class. Is it possible to use functionality not exsisting in the base class (interface) below without completely disregarding the solid principles, when the rest of the program must not see anything but the base class \"interface\"? Like in the example below, is it possible to use bar() from the B class inside the function that only knows of A? And should I just add bar() to the \"interface\" instead? </p>\n\n<pre><code>// Base class - \"interface\"\nClass A\n{\n    public:\n        virtual int foo();\n}\n\n// Derived class - implementing the \"interface\" + more\nClass B: public A\n{\n    public:\n        int foo();\n        int bar();\n}\n\nint main()\n{\n\n    function(A); // Some magic function that would utlize the bar() method\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "compilation", "c-preprocessor", "clang++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1546382585, "post_id": 53999485, "comment_id": 94836014, "body": "I&#39;ve been programming in C and C++ for over 35 years, and I&#39;ve never  needed to look at preprocessor output."}, {"owner": {"reputation": 31, "user_id": 10853556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26addd7c785de3ff04303fd7609d6150?s=128&d=identicon&r=PG&f=1", "display_name": "faulnegx", "link": "https://stackoverflow.com/users/10853556/faulnegx"}, "edited": false, "score": 0, "creation_date": 1546447925, "post_id": 53999485, "comment_id": 94857039, "body": "@NeilButterworth Is the debugging messages are generally sufficient? If not, may i ask for a general approach/suggestions for debugging compiler errors?"}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 4, "last_activity_date": 1546383131, "creation_date": 1546383131, "answer_id": 53999561, "question_id": 53999485, "link": "https://stackoverflow.com/questions/53999485/are-line-markers-in-c-preprocessor-output-used-by-compiler/53999561#53999561", "title": "Are line-markers in C preprocessor output used by compiler?", "body": "<p>Line number directives have two primary purposes:</p>\n\n<ol>\n<li><p>If the compiler encounters an error, it uses the most recent line number directive to determine what file and line to reference in the error message.</p>\n\n<p>(The <code>#line</code> directive can even be used in generated code to allow error messages to point directly to the original source file, rather than to an intermediate C source file.)</p></li>\n<li><p>If debugging information (<code>-g</code>) is turned on, line number data is included in debug sections of the generated object file.</p></li>\n</ol>\n\n<p>Neither of these purposes is critical. If you're looking at assembler output and the line number directives are getting in your way, feel free to turn them off.</p>\n"}], "owner": {"reputation": 31, "user_id": 10853556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26addd7c785de3ff04303fd7609d6150?s=128&d=identicon&r=PG&f=1", "display_name": "faulnegx", "link": "https://stackoverflow.com/users/10853556/faulnegx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 53999561, "answer_count": 1, "score": 2, "last_activity_date": 1546383131, "creation_date": 1546382211, "question_id": 53999485, "link": "https://stackoverflow.com/questions/53999485/are-line-markers-in-c-preprocessor-output-used-by-compiler", "title": "Are line-markers in C preprocessor output used by compiler?", "body": "<p>Are linemarkers(<code># 1 \"donothing.cpp\" 2</code>) in the C preprocessor output used by the compiler to generate the assembler (.s) file? </p>\n\n<p>I expect that they are used to produce compiler errors and debugging information. So I can safely turn these off(with <code>-P</code>) while trying to follow the flow of macros?</p>\n\n<p>I am learning C++, and the C preprocessor. I read in many C++ tutorial that macros are generally difficult to write correctly and can have unexpected results. Here is a sample preprocessor output. <a href=\"https://gcc.gnu.org/onlinedocs/gcc-7.2.0/cpp/Preprocessor-Output.html#Preprocessor-Output\" rel=\"nofollow noreferrer\">The C Preprocessor: Preprocessor Output</a></p>\n\n<pre><code>$ g++ -Wall -std=c++11 -E donothing.cpp\n# 1 \"donothing.cpp\"\n# 1 \"&lt;built-in&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 3\n# 391 \"&lt;built-in&gt;\" 3\n# 1 \"&lt;command line&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 2\n# 1 \"donothing.cpp\" 2\n\nint main()\n{\n    return 0;\n}\n$ g++ -Wall -std=c++11 -E donothing.cpp -P\nint main()\n{\n    return 0;\n}\n</code></pre>\n\n<p>Is looking at preprocessor output the way to debug compiler errors? How else do c/c++ developers debug their macros (since I expect people work with multiple .cpp files very frequently and there are always compiler errors)?</p>\n"}, {"tags": ["c++", "solaris", "allocator", "sunstudio", "suncc"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1546385923, "post_id": 53999461, "comment_id": 94836541, "body": "<i>&quot;I had to remove copyright notices to stay within posting limits.&quot;</i> You&#39;re not permitted to do that, as I&#39;m sure you know."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1546424461, "post_id": 53999461, "comment_id": 94845858, "body": "What version of the SunCC compiler?  What command-line options?  What C++ runtime library are you using?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1546446354, "post_id": 53999461, "comment_id": 94856248, "body": "@Andrew - I added a couple of sample compiles. I did not notice the compiler crash using 12.6 until now. Derp... The command line options are Release flags: <code>-g2 -O3 -DNDEBUG</code>. Debug flags produce the same result: <code>-g3 -O0 -DDEBUG</code>. I can probably post <code>&#47;opt&#47;solarisstudio12.3&#47;prod&#47;include&#47;CC&#47;Cstd&#47;memory</code> to Pastebin if needed. It is too large to post on Stack Overflow."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1546528592, "post_id": 53999461, "comment_id": 94886412, "body": "Those assertion failures are compiler bugs.  Given the problem is in processing the same code, I&#39;d suspect a bug even in the earlier versions of the compiler.  See if setting <code>-compat=g</code> or <code>-std=c++03</code>, <code>-std=c++11</code>, or <code>-std=c++14</code>, or maybe even <code>-library=stdcxx4</code> or <code>-library=stlport4</code> is able to compile your code.  If any of those work (especially the <code>-compat=g</code> or any of the <code>-std=XXXXX</code> ones), the problem might very well be the old <code>libCstd</code> C++ runtime."}], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1546446192, "creation_date": 1546382019, "last_edit_date": 1546446192, "question_id": 53999461, "link": "https://stackoverflow.com/questions/53999461/suncc-stdallocator-and-size-type-max-sizesize-type-const-member-function", "title": "SunCC std::allocator and size_type max_size(size_type) const member function?", "body": "<p>We use a <a href=\"https://github.com/weidai11/cryptopp/blob/master/secblock.h#L27\" rel=\"nofollow noreferrer\">custom allocator</a> that zeroizes memory. There's not much to it. It has the types and member functions described at <a href=\"https://en.cppreference.com/w/cpp/memory/allocator/allocator\" rel=\"nofollow noreferrer\">std::allocator</a>.</p>\n\n<p>I recently used the custom allocator for a <code>std::vector&lt;T, A&gt;</code> (with <code>A</code> the allocator), which is a new application of the custom allocator. It tested OK on AIX, BSD, Linux, OSX, and Windows.</p>\n\n<p>Testing on Solaris caused a compile failure. It looks like SunCC expects a <code>size_type max_size(size_type) const</code> member function:</p>\n\n<pre><code>//\n// /opt/developerstudio12.5/lib/compilers/include/CC/Cstd/memory\n//\nsize_type max_size ()  const\n{\n  return alloc_.max_size(sizeof(_Tt));\n}\n</code></pre>\n\n<p>And from the same file, there is a <code>size_type max_size (size_type) const</code>:</p>\n\n<pre><code>//\n// Alternate allocator uses an interface class (allocator_interface)\n// to get type safety.\n//\ntemplate &lt;class _Tt&gt;\nclass allocator\n{\npublic:\n    ...\n    size_type max_size (size_type size) const\n    {\n      return 1 &gt; UINT_MAX/size ? size_type(1) : size_type(UINT_MAX/size);\n    }\n};\n</code></pre>\n\n<p>I'm not finding useful hits when searching for information on the Sun allocator.</p>\n\n<p>My first question is, where did this member function come from? Is it SunCC specific? Is it a vestige of an early Rogue Wave implementation? Or maybe something else?</p>\n\n<p>My second question is, should this member function be added for just SunCC? Or should we be using an option to disable it for portability? Or maybe something else?</p>\n\n<hr>\n\n<p>Here's what the compile looks like with Sun Studio 12.3 and 12.4:</p>\n\n<pre><code>$ CXX=/opt/solarisstudio12.3/bin/CC gmake xed25519.o\n/opt/solarisstudio12.3/bin/CC -DNDEBUG -g -xO3 -DCRYPTOPP_DISABLE_AVX2 -template=no%extdef -c xed25519.cpp\n\"/opt/solarisstudio12.3/prod/include/CC/Cstd/memory\", line 479: Error: Too many arguments in call to \"CryptoPP::AllocatorBase&lt;unsigned char&gt;::max_size() const\".\n\"/opt/solarisstudio12.3/prod/include/CC/Cstd/vector\", line 387:     Where: While instantiating \"std::allocator_interface&lt;CryptoPP::AllocatorWithCleanup&lt;unsigned char, 0&gt;, unsigned char&gt;::max_size() const\".\n\"/opt/solarisstudio12.3/prod/include/CC/Cstd/vector\", line 387:     Where: Instantiated from std::vector&lt;unsigned char, CryptoPP::AllocatorWithCleanup&lt;unsigned char, 0&gt;&gt;::max_size() const.\n\"/opt/solarisstudio12.3/prod/include/CC/Cstd/vector\", line 397:     Where: Instantiated from non-template code.\n1 Error(s) detected.\n</code></pre>\n\n<p>Here's what the compile looks like with Sun Studio 12.5 and 12.6:</p>\n\n<pre><code>$ CXX=/opt/developerstudio12.6/bin/CC gmake xed25519.o\n/opt/developerstudio12.6/bin/CC -DNDEBUG -g -xO3 -template=no%extdef -c xed25519.cpp\n\"/opt/developerstudio12.6/lib/compilers/include/CC/Cstd/memory\", line 479: Error: Too many arguments in call to \"CryptoPP::AllocatorBase&lt;unsigned char&gt;::max_size() const\".\n\"/opt/developerstudio12.6/lib/compilers/include/CC/Cstd/vector\", line 387:     Where: While instantiating \"std::allocator_interface&lt;CryptoPP::AllocatorWithCleanup&lt;unsigned char, 0&gt;, unsigned char&gt;::max_size() const\".\n\"/opt/developerstudio12.6/lib/compilers/include/CC/Cstd/vector\", line 387:     Where: Instantiated from std::vector&lt;unsigned char, CryptoPP::AllocatorWithCleanup&lt;unsigned char, 0&gt;&gt;::reserve(unsigned).\n\"xed25519.h\", line 280:     Where: Instantiated from non-template code.\n &gt;&gt; Assertion:   (../lnk/v2vtable.cc, line 49)\n    while processing xed25519.cpp at line 0.\ngmake: *** [xed25519.o] Error 2\n</code></pre>\n"}, {"tags": ["c++", "time", "ctime"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1546381162, "post_id": 53999363, "comment_id": 94835754, "body": "Which header files are you including? Which compiler are you using? Also, that isn&#39;t a C++ Standard Library function.."}, {"owner": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "edited": false, "score": 0, "creation_date": 1546383118, "post_id": 53999363, "comment_id": 94836090, "body": "You should see the answer <a href=\"https://stackoverflow.com/questions/5404277/porting-clock-gettime-to-windows\">here</a>"}, {"owner": {"reputation": 11, "user_id": 10855523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-unOODD_1WLI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYAt8q0E7j6kjqIT6mFZ9iviCZfFg/mo/photo.jpg?sz=128", "display_name": "Nicholas Lopes", "link": "https://stackoverflow.com/users/10855523/nicholas-lopes"}, "edited": false, "score": 0, "creation_date": 1546383896, "post_id": 53999363, "comment_id": 94836209, "body": "@NeilButterworth, i edited the post with the information you asked."}, {"owner": {"reputation": 11, "user_id": 10855523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-unOODD_1WLI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYAt8q0E7j6kjqIT6mFZ9iviCZfFg/mo/photo.jpg?sz=128", "display_name": "Nicholas Lopes", "link": "https://stackoverflow.com/users/10855523/nicholas-lopes"}, "reply_to_user": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "edited": false, "score": 0, "creation_date": 1546383911, "post_id": 53999363, "comment_id": 94836211, "body": "@tunglt i tried out the clock_gettime from the post you shared, and one from Carl Staelin worked out, but it still doesn&#39;t fix the CLOCK_REALTIME or CLOCK_MONOTONIC issue. Any insights?  Thanks for your help &lt;3"}, {"owner": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "edited": false, "score": 2, "creation_date": 1546384512, "post_id": 53999363, "comment_id": 94836314, "body": "Do you add <code>#define _POSIX_C_SOURCE 199309L</code> before including the header file <code>#include &lt;time.h&gt;</code> ?"}, {"owner": {"reputation": 11, "user_id": 10855523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-unOODD_1WLI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYAt8q0E7j6kjqIT6mFZ9iviCZfFg/mo/photo.jpg?sz=128", "display_name": "Nicholas Lopes", "link": "https://stackoverflow.com/users/10855523/nicholas-lopes"}, "edited": false, "score": 0, "creation_date": 1546385166, "post_id": 53999363, "comment_id": 94836424, "body": "I tried adding  <code>#define _POSIX_C_SOURCE 199309L</code> before the header file <code>#include &lt;ctime&gt;</code>, time.h is not used"}, {"owner": {"reputation": 864, "user_id": 10320907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a781c80933f17fa87d97b70e3fca260?s=128&d=identicon&r=PG", "display_name": "tunglt", "link": "https://stackoverflow.com/users/10320907/tunglt"}, "edited": false, "score": 0, "creation_date": 1546417903, "post_id": 53999363, "comment_id": 94843187, "body": "mingw introduce clock_gettime() in the mingw64 version and this function is not available for 32bit version. If you really want to use it, you should : 1. Move to mingw64, or 2. reimplement it, see the source code <a href=\"https://github.com/mirror/mingw-w64/blob/master/mingw-w64-libraries/winpthreads/src/clock.c#L109\" rel=\"nofollow noreferrer\">here</a>"}], "owner": {"reputation": 11, "user_id": 10855523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-unOODD_1WLI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYAt8q0E7j6kjqIT6mFZ9iviCZfFg/mo/photo.jpg?sz=128", "display_name": "Nicholas Lopes", "link": "https://stackoverflow.com/users/10855523/nicholas-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546383752, "creation_date": 1546380923, "last_edit_date": 1546383752, "question_id": 53999363, "link": "https://stackoverflow.com/questions/53999363/need-to-fix-an-error-when-compiling-ctime-library-clock-gettime-and-clock-realt", "title": "Need to fix an error when compiling ctime library. clock_gettime and CLOCK_REALTIME not declared in this scope", "body": "<p>I'm calling clock_gettime with CLOCK_REALTIME to measure the time elapsed for a  program of mine. The code is like this:</p>\n\n<pre><code>clock_gettime(CLOCK_REALTIME, &amp;start);\nint retCode = system(completeString.c_str());\nclock_gettime(CLOCK_REALTIME, &amp;finish);\n</code></pre>\n\n<p>and it gives me this errors when i try to compile it with \ngcc -lrt -o timeSpent.exe time.cpp:</p>\n\n<p>time.cpp: In function 'int main(int, char**)':</p>\n\n<p>time.cpp:38:18: error: 'CLOCK_REALTIME' was not declared in this scope\n    clock_gettime(CLOCK_REALTIME, &amp;start);</p>\n\n<p>time.cpp:38:40: error: 'clock_gettime' was not declared in this scope\n    clock_gettime(CLOCK_REALTIME, &amp;start);</p>\n\n<p><br><br>\n<strong>Header files:</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;fstream&gt;\n#include &lt;ctime&gt;\n#include &lt;Windows.h&gt;\n</code></pre>\n\n<p><br>\n<strong>Compiler:</strong> MinGW<br></p>\n\n<p>I hope one of you guys is able to help me fix this problem, and i'm grateful for anyone who tries to help.</p>\n\n<p><strong>Ps:</strong> I'm using Windows 10, but i have been successful on compiling this same code before on a Win10 PC. Unfortunately i can't access it, since I'm in another country.</p>\n\n<p><br><strong>Ps\u00b2:</strong> I've already tried to #define _POSIX_C_SOURCE 199309L, the only thing it does is add a warning.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1546422463, "post_id": 53999326, "comment_id": 94845030, "body": "You are right, you have to use <code>beginInsertRows()</code> and <code>endInsertRows()</code> in your case. Have you checked <a href=\"https://doc.qt.io/qt-5/qt.html#ItemDataRole-enum\" rel=\"nofollow noreferrer\">the roles</a> for which <code>data()</code> gets called (e.g. <code>Qt::DisplayRole</code>, <code>Qt::SizeHintRole</code>, ...)?"}, {"owner": {"reputation": 21, "user_id": 10855465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36eb5ac07d49e3982fb6f8d5d69fd389?s=128&d=identicon&r=PG&f=1", "display_name": "EggDol", "link": "https://stackoverflow.com/users/10855465/eggdol"}, "reply_to_user": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1546831632, "post_id": 53999326, "comment_id": 94969415, "body": "Yes, I am filtering out all but display role."}, {"owner": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1546877498, "post_id": 53999326, "comment_id": 94989127, "body": "what do you mean by &quot;filtering out&quot;? I was asking about roles for which your overridden <code>data()</code> method gets called. Maybe try putting a <code>qDebug()</code> statement to print out the role inside <code>data()</code> to identify them..."}, {"owner": {"reputation": 21, "user_id": 10855465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36eb5ac07d49e3982fb6f8d5d69fd389?s=128&d=identicon&r=PG&f=1", "display_name": "EggDol", "link": "https://stackoverflow.com/users/10855465/eggdol"}, "reply_to_user": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "edited": false, "score": 0, "creation_date": 1547437140, "post_id": 53999326, "comment_id": 95179717, "body": "Inside my data method I have a conditional that looks for a role that is Display Role. If and only if the role is Display Role then I return the appropriate cell value. If role is something else I return an empty QVariant(). Hence, I am &quot;filtering out&quot; all roles except the display role. The reason I know which cells are being accessed is because I used qDebug() inside the conditional to print the row and column currently being accessed, so I am certain they are DisplayRole."}], "owner": {"reputation": 21, "user_id": 10855465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36eb5ac07d49e3982fb6f8d5d69fd389?s=128&d=identicon&r=PG&f=1", "display_name": "EggDol", "link": "https://stackoverflow.com/users/10855465/eggdol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1546387178, "creation_date": 1546380529, "last_edit_date": 1546387178, "question_id": 53999326, "link": "https://stackoverflow.com/questions/53999326/qt-updating-only-changed-rows-in-qtableview-when-inserting-removing-rows-in-qab", "title": "Qt: Updating only changed rows in QTableView when Inserting/Removing rows in QAbstractTableModel", "body": "<p>I am trying to perform only a partial update on updated rows in my <code>QTableView</code> when I insert and remove rows of my <code>TableModel</code> (<code>QAbstractTableModel</code> inheriting).</p>\n\n<p>When I perform my insertions I call my overridden <code>insertRows(row, count, QModelIndex())</code> which appends to my data structure within <code>beginInsertRows(parent, row, row + count - 1)</code> and <code>endInsertRows()</code>.</p>\n\n<p>The table stays up to date during adds and removes but it looks like the signals emitted by the <code>beginInsertRows(..)</code> and <code>endInsertRows()</code> telling the view to update the entire table. A print statement inside my <code>TableModel::data()</code> reveals that the all cells of my table are being refreshed.</p>\n\n<pre><code>bool TableModel::insertRows(int row, int count, const QModelIndex &amp;parent)\n{\n    if (row &gt;= 0 &amp;&amp; row &lt;= file_records.size())\n    {\n        beginInsertRows(parent, row, row + count - 1);\n        file_records.append(0);\n        endInsertRows();\n\n        return true;\n    }\n\n    return false;\n}\n\n// when adding record \nint row = file_records.size();\nif (insertRow(row))\n{\n    file_records[row] = file_record;\n}\n\ninline bool QAbstractItemModel::insertRow(int arow, const QModelIndex &amp;aparent)\n{ \n    return insertRows(arow, 1, aparent); \n}\n</code></pre>\n\n<p>Is there a way to tell the view to only update the new rows?</p>\n\n<p>My update function emits <code>dataChanged()</code> on the affected indexes, and it successfully only updates relevant view data. But there doesn't seem to be a way around using the <code>begin*</code> and <code>end*</code> functions when I make structural changes.</p>\n"}, {"tags": ["android", "c++", "c", "compilation", "cross-compiling"], "comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1546378825, "post_id": 53999096, "comment_id": 94835302, "body": "<code>__builtin_ia32_punpcklwd</code> is an <i>intel</i> <code>x86</code> intrinsic call for <code>x86</code> SIMD instructions. Android [in most cases] uses the <code>arm</code> architecture which has no such equivalent."}, {"owner": {"reputation": 820, "user_id": 1935655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/743ead27b3f8a771dc27218e96cf7236?s=128&d=identicon&r=PG", "display_name": "LUser", "link": "https://stackoverflow.com/users/1935655/luser"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1546378984, "post_id": 53999096, "comment_id": 94835338, "body": "I was thinking this, how can I use the correct toolchain?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1546379002, "post_id": 53999096, "comment_id": 94835343, "body": "I just looked it up, and SDL seems to come with Gradle build scripts for targeting android. <code>docs&#47;README-android.md</code> seems to have some detailed instructions. Did you try those?"}, {"owner": {"reputation": 820, "user_id": 1935655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/743ead27b3f8a771dc27218e96cf7236?s=128&d=identicon&r=PG", "display_name": "LUser", "link": "https://stackoverflow.com/users/1935655/luser"}, "edited": false, "score": 0, "creation_date": 1546421214, "post_id": 53999096, "comment_id": 94844483, "body": "I don&#39;t think the problem is with SDL . I compiled a helloworld sdl app for tests and it worked.  When I tried the opensource app and made my own CMAKE file I ran into weirdness ."}, {"owner": {"reputation": 820, "user_id": 1935655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/743ead27b3f8a771dc27218e96cf7236?s=128&d=identicon&r=PG", "display_name": "LUser", "link": "https://stackoverflow.com/users/1935655/luser"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1546462676, "post_id": 53999096, "comment_id": 94863028, "body": "Ok @HolyBlackCat I have to recant. I think you might be on to something SDL is importing the lib which is using this as a header. I will look at them. I think this is weird that it didn&#39;t cause problems with hello world programs but now it is throwing a fit.Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 820, "user_id": 1935655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/743ead27b3f8a771dc27218e96cf7236?s=128&d=identicon&r=PG", "display_name": "LUser", "link": "https://stackoverflow.com/users/1935655/luser"}, "is_accepted": false, "score": 0, "last_activity_date": 1546773330, "creation_date": 1546773330, "answer_id": 54060946, "question_id": 53999096, "link": "https://stackoverflow.com/questions/53999096/cross-compiling-sdl-c-application-to-android/54060946#54060946", "title": "Cross Compiling SDL C++ application to Android", "body": "<p>Ultimately, I switched compilers to g++ 4.4.9 removed the #include  from the repo.</p>\n\n<p>To download the compiler:\n<a href=\"https://developer.android.com/ndk/downloads/older_releases\" rel=\"nofollow noreferrer\">https://developer.android.com/ndk/downloads/older_releases</a></p>\n\n<p><strong>In your local.properties add line</strong></p>\n\n<pre><code>ndk.dir=/path/to/your/ndk-bundle\n</code></pre>\n\n<p>And the thing worked that helped the most was installing the in your app build.gradle </p>\n\n<p>You can specify the GCC compiler (which is no longer supported but my project requires it)</p>\n\n<pre><code>externalNativeBuild {\n            cmake {\n                arguments '-DBUILD_TESTING=OFF', '-DANDROID_TOOLCHAIN=gcc'\n                cppFlags \"-w -std=c++14\"\n            }\n</code></pre>\n\n<p>I hope this helps someone . I only had to make minor changes to compile the app. </p>\n"}], "owner": {"reputation": 820, "user_id": 1935655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/743ead27b3f8a771dc27218e96cf7236?s=128&d=identicon&r=PG", "display_name": "LUser", "link": "https://stackoverflow.com/users/1935655/luser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546773330, "creation_date": 1546378314, "question_id": 53999096, "link": "https://stackoverflow.com/questions/53999096/cross-compiling-sdl-c-application-to-android", "title": "Cross Compiling SDL C++ application to Android", "body": "<p>I want to compile an open source C++ project to Android . The project runs on Linux but needs to be compiled to 32 bit.</p>\n\n<p>Here is the output of the compile process\n<a href=\"https://pastebin.com/9CkVVD9i\" rel=\"nofollow noreferrer\">https://pastebin.com/9CkVVD9i</a></p>\n\n<p>Here is my CMAKE file with which I am working with.\n<a href=\"https://pastebin.com/eMDntghP\" rel=\"nofollow noreferrer\">https://pastebin.com/eMDntghP</a></p>\n\n<p>Problem is that when I compile I see tons of these errors. </p>\n\n<pre><code>  /home/qndel/Android/Sdk/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64/lib64/clang/7.0.2/include/mmintrin.h:324:19: error: use of undeclared identifier '__builtin_ia32_punpcklwd'\n      return (__m64)__builtin_ia32_punpcklwd((__v4hi)__m1, (__v4hi)__m2);\n                    ^\n  /home/qndel/Android/Sdk/ndk-bundle/toolchains/llvm/prebuilt/linux-x86_64/lib64/clang/7.0.2/include/mmintrin.h:345:19: error: use of undeclared identifier '__builtin_ia32_punpckldq'\n      return (__m64)__builtin_ia32_punpckldq((__v2si)__m1, (__v2si)__m2);\n                    ^\n  fatal error: too many errors emitted, stopping now [-ferror-limit=]\n  20 errors generated.\n  ninja: build stopped: subcommand failed.\n</code></pre>\n\n<p>I am not sure what to think apart from maybe I am targeting the wrong architecture and googling seems to return not very good results. </p>\n\n<p>Let me know if you need a link to the project .</p>\n"}, {"tags": ["c++", "c++11", "templates", "c++17", "template-meta-programming"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546377556, "post_id": 53998958, "comment_id": 94835055, "body": "You&#39;re just asking how to replace the <code>if constexpr</code> then, right? <code>enable_if</code>?"}, {"owner": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1546444759, "post_id": 53998958, "comment_id": 94855465, "body": "I tried SFINAE with <code>constexpr typename std::enable_if&lt;is_foo&lt;T&gt;::value,size_t&gt;::type Foo&lt;T,N&gt;::sum()</code> but am getting the error <code>prototype for &#39;constexpr typename std::enable_if&lt;is_foo&lt; &lt;template-parameter-1-1&gt; &gt;::value, long unsigned int&gt;::type Foo&lt;T, N&gt;::sum()&#39; does not match any in class &#39;Foo&lt;T, N&gt;&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "edited": false, "score": 0, "creation_date": 1546480429, "post_id": 53999020, "comment_id": 94867854, "body": "This does work. On Visual Studio 2015, I was getting the infamous <a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/compiler-errors-1/fatal-error-c1001?view=vs-2015\" rel=\"nofollow noreferrer\">C1001</a> fatal error but through shuffling some surrounding code, it compiled. Never encountered a problem with gcc or clang. Thank you!"}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 5, "last_activity_date": 1546377596, "creation_date": 1546377596, "answer_id": 53999020, "question_id": 53998958, "link": "https://stackoverflow.com/questions/53998958/how-to-write-this-c17-static-constexpr-method-in-c11/53999020#53999020", "title": "How to write this C++17 static constexpr method in C++11?", "body": "<p>I'd write it as following:</p>\n\n<pre><code>template &lt;typename&gt;\nstruct foo_sum : std::integral_constant&lt;size_t, 0&gt; {};\n\ntemplate &lt;typename T, size_t N&gt;\nstruct foo_sum&lt;Foo&lt;T, N&gt;&gt; : std::integral_constant&lt;size_t, foo_sum&lt;T&gt;::value + N&gt; {};\n</code></pre>\n\n<p>It can be wrapped into a <code>static constexpr</code> function easily:</p>\n\n<pre><code>template &lt;typename T, size_t N&gt;\nconstexpr size_t Foo&lt;T, N&gt;::sum()\n{\n    return foo_sum&lt;Foo&lt;T, N&gt;&gt;::value;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "edited": false, "score": 0, "creation_date": 1546378495, "post_id": 53999077, "comment_id": 94835232, "body": "I&#39;ve tried this approach, and indeed it does work on g++ and clang. For some reason, Visual Studio 2015 still tries to compile <code>sum_impl(std::true_type)</code> and results in a compiler error when T=double."}, {"owner": {"reputation": 50917, "user_id": 947836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9addee65c2a92be93004ad689a7a415?s=128&d=identicon&r=PG&f=1", "display_name": "jrok", "link": "https://stackoverflow.com/users/947836/jrok"}, "reply_to_user": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "edited": false, "score": 0, "creation_date": 1546379102, "post_id": 53999077, "comment_id": 94835364, "body": "@Matt Shame. <a href=\"https://godbolt.org/z/ZUr5Vq\" rel=\"nofollow noreferrer\">This example</a> seems to work with newer MSVC."}, {"owner": {"reputation": 50917, "user_id": 947836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9addee65c2a92be93004ad689a7a415?s=128&d=identicon&r=PG&f=1", "display_name": "jrok", "link": "https://stackoverflow.com/users/947836/jrok"}, "reply_to_user": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "edited": false, "score": 0, "creation_date": 1546379609, "post_id": 53999077, "comment_id": 94835462, "body": "@Matt Try making the first <code>sum_impl</code> a template itself."}], "tags": [], "owner": {"reputation": 50917, "user_id": 947836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9addee65c2a92be93004ad689a7a415?s=128&d=identicon&r=PG&f=1", "display_name": "jrok", "link": "https://stackoverflow.com/users/947836/jrok"}, "is_accepted": false, "score": 1, "last_activity_date": 1546378146, "creation_date": 1546378146, "answer_id": 53999077, "question_id": 53998958, "link": "https://stackoverflow.com/questions/53998958/how-to-write-this-c17-static-constexpr-method-in-c11/53999077#53999077", "title": "How to write this C++17 static constexpr method in C++11?", "body": "<p>With tag dispatching:</p>\n\n<pre><code>template&lt;typename T,size_t N&gt;\nclass Foo\n{\n    static constexpr size_t sum_impl(std::true_type) { return N + T::sum(); }\n    static constexpr size_t sum_impl(std::false_type) { return N; };\n  public:\n    static constexpr size_t sum();\n};\n</code></pre>\n\n<p>Implementation of <code>sum</code>:</p>\n\n<pre><code>template&lt;typename T,size_t N&gt;\nconstexpr size_t Foo&lt;T,N&gt;::sum()\n{\n    return sum_impl( is_foo&lt;T&gt;{} );\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "edited": false, "score": 0, "creation_date": 1546379619, "post_id": 53999088, "comment_id": 94835464, "body": "In practice, Foo is a large class with many member functions. Would this require redeclaring all of them?"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "edited": false, "score": 0, "creation_date": 1546379976, "post_id": 53999088, "comment_id": 94835521, "body": "@Matt - answer improved; hope this helps."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 0, "last_activity_date": 1546379958, "last_edit_date": 1546379958, "creation_date": 1546378245, "answer_id": 53999088, "question_id": 53998958, "link": "https://stackoverflow.com/questions/53998958/how-to-write-this-c17-static-constexpr-method-in-c11/53999088#53999088", "title": "How to write this C++17 static constexpr method in C++11?", "body": "<p>What about specializing the full <code>Foo</code> class ? </p>\n\n<p>You can also avoid <code>is_foo</code>.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename, std::size_t N&gt;\nstruct Foo\n { static constexpr std::size_t sum () { return N; } };\n\ntemplate &lt;typename T, std::size_t N1, std::size_t N2&gt;\nstruct Foo&lt;Foo&lt;T, N1&gt;, N2&gt;\n { static constexpr std::size_t sum () { return Foo&lt;T, N1&gt;::sum() + N2; } };\n\nint main()\n{\n    constexpr size_t sum = Foo&lt;Foo&lt;Foo&lt;double,3&gt;,4&gt;,5&gt;::sum(); // 12 = 3+4+5\n    std::cout &lt;&lt; \"sum = \" &lt;&lt; sum &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p><strong>-- EDIT --</strong></p>\n\n<p>The OP ask:</p>\n\n<blockquote>\n  <p>In practice, Foo is a large class with many member functions. Would this require redeclaring all of them? </p>\n</blockquote>\n\n<p>Not necessarily: you can do the trick with a base class/struct of <code>Foo</code> (<code>Bar</code>, in the following example)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename T, std::size_t N&gt;\nstruct Foo;\n\ntemplate &lt;typename, std::size_t N&gt;\nstruct Bar\n { static constexpr std::size_t sum () { return N; } };\n\ntemplate &lt;typename T, std::size_t N1, std::size_t N2&gt;\nstruct Bar&lt;Foo&lt;T, N1&gt;, N2&gt;\n { static constexpr std::size_t sum () { return Foo&lt;T, N1&gt;::sum() + N2; } };\n\ntemplate &lt;typename T, std::size_t N&gt;\nstruct Foo : public Bar&lt;T, N&gt;\n { /* many common member and methods */};\n\nint main()\n{\n    constexpr size_t sum = Foo&lt;Foo&lt;Foo&lt;double,3&gt;,4&gt;,5&gt;::sum(); // 12 = 3+4+5\n    std::cout &lt;&lt; \"sum = \" &lt;&lt; sum &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 2, "last_activity_date": 1546385812, "creation_date": 1546385812, "answer_id": 53999781, "question_id": 53998958, "link": "https://stackoverflow.com/questions/53998958/how-to-write-this-c17-static-constexpr-method-in-c11/53999781#53999781", "title": "How to write this C++17 static constexpr method in C++11?", "body": "<p>An alternative approach to <a href=\"https://stackoverflow.com/a/53999020/2069064\">HolyBlackCat's answer</a> is to use function overloading:</p>\n\n<pre><code>template &lt;typename&gt; struct tag {};\n\ntemplate &lt;typename T&gt;\nconstexpr size_t sum(tag&lt;T&gt;) {\n    return 0;\n}\n\ntemplate &lt;typename T, size_t N&gt;\nconstexpr size_t sum(tag&lt;Foo&lt;T,N&gt;&gt;) {\n    return sum(tag&lt;T&gt;{}) + N;\n}\n</code></pre>\n\n<p>Might be a little easier on the eyes. Could also make the functions return <code>integral_constant</code>s instead of <code>size_t</code>, which has some benefits.</p>\n"}], "owner": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 53999020, "answer_count": 4, "score": 0, "last_activity_date": 1546385812, "creation_date": 1546376934, "last_edit_date": 1546380558, "question_id": 53998958, "link": "https://stackoverflow.com/questions/53998958/how-to-write-this-c17-static-constexpr-method-in-c11", "title": "How to write this C++17 static constexpr method in C++11?", "body": "<p>What is the most concise way to write the below <code>static constexpr size_t Foo&lt;&gt;::sum()</code> method in C++11? This works fine with C++17 compilers, but I'm looking for a way that works on g++, clang, and Visual Studio 2015 in C++11 mode.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;typename T,size_t N&gt;\nclass Foo\n{\n  public:\n    static constexpr size_t sum();\n};\n\ntemplate&lt;typename&gt;\nstruct is_foo : std::false_type { };\ntemplate&lt;typename T,size_t N&gt;\nstruct is_foo&lt;Foo&lt;T,N&gt;&gt; : std::true_type { };\n\ntemplate&lt;typename T,size_t N&gt;\nconstexpr size_t Foo&lt;T,N&gt;::sum()\n{\n    if constexpr (is_foo&lt;T&gt;::value)\n        return N + T::sum();\n    else\n        return N;\n}\n\nint main()\n{\n    constexpr size_t sum = Foo&lt;Foo&lt;Foo&lt;double,3&gt;,4&gt;,5&gt;::sum(); // 12 = 3+4+5\n    std::cout &lt;&lt; \"sum = \" &lt;&lt; sum &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>Compile and run:</p>\n\n<pre><code>$ g++ --version\ng++ (GCC) 7.3.1 20180303 (Red Hat 7.3.1-5)\n...\n$ g++ -std=c++17 sum.cpp\n$ ./a.out \nsum = 12\n</code></pre>\n\n<p>I'm able to write an external functor for <code>sum()</code> that accomplishes this, but I would really like for it to be a <code>static constexpr</code> member function as above. Is this even possible in C++11?</p>\n"}]