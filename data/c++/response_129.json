[{"tags": ["c++", "string", "unicode"], "comments": [{"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 1, "creation_date": 1498692639, "post_id": 44814073, "comment_id": 76608735, "body": "That&#39;s not going to be easy without external dependencies. Boost implements this as a lookup table to map each character to a given type, and then checks the type with some heuristics. Basically, you either need decent Unicode support, like Boost or Qt, or don&#39;t bother.  <a href=\"http://www.boost.org/doc/libs/1_62_0/boost/spirit/home/support/char_encoding/unicode.hpp\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_62_0/boost/spirit/home/support/&hellip;</a>"}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498692865, "post_id": 44814073, "comment_id": 76608785, "body": "If you are interested, the relevant task would be to convert your Unicode text to UTF-32 (check if a start byte or a continuation byte, or plain ASCII), check the code point to see if it is whitespace using a lookup table, and then use it as a token.  If that sounds involved, and a lot of work, it is, and there are many libraries that already do this for you. Boost notably is one."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1498692967, "post_id": 44814073, "comment_id": 76608801, "body": "There are quite a few &quot;Space&quot; characters in Unicode - so this becomes a map of characters and lookups.  Error prone to because of the need to test against all the fun that can come through.  I will say, from a high level, that C++ may not be the best language for string manipulations like this."}, {"owner": {"reputation": 289, "user_id": 5299327, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4e00a8f927d808e0e17901f40e3a612b?s=128&d=identicon&r=PG&f=1", "display_name": "John Elaine", "link": "https://stackoverflow.com/users/5299327/john-elaine"}, "reply_to_user": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498694025, "post_id": 44814073, "comment_id": 76609061, "body": "@AlexanderHuszagh: I see. I can use boost for this task. What would be the best way to tokenize a string using boost? Doing that would be easier than using <code>isspace</code> check for each character."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498694617, "post_id": 44814073, "comment_id": 76609175, "body": "@JohnElaine What&#39;s your source encoding, and can you convert to UTF-32? Checking for whitespace is easiest in UTF-32. Basically, I would get line-by-line, convert to UTF-32, iterate code point by code point and check if each is whitespace and process token-by-token. It&#39;s not pretty, but it can be pretty easy to do.  If you do not want to convert to UTF-32, you could look character by character in UTF-8: if it&#39;s an ASCII character (&lt; 128), check against known ASCII space characters, otherwise, fill to a uint32_t."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498696121, "post_id": 44814073, "comment_id": 76609528, "body": "You could try <code>infile.imbue(std::locale(&quot;&quot;));</code> and <code>inputStream.impue(std::locale(&quot;&quot;));</code> which should set your stream reader to the input file encoding (assuming it is the same as the system)."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1498697509, "post_id": 44814073, "comment_id": 76609832, "body": "Or you could try using std::wstring, std::wifstream, std::wstringstream."}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "is_accepted": false, "score": -1, "last_activity_date": 1543261760, "creation_date": 1543261760, "answer_id": 53488028, "question_id": 44814073, "link": "https://stackoverflow.com/questions/44814073/c-interpret-unicode-white-space/53488028#53488028", "title": "C++ : Interpret unicode white space", "body": "<p>You can go by either:</p>\n\n<p><strong>A.</strong> <a href=\"https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Character.html#isWhitespace(int)\" rel=\"nofollow noreferrer\">Java's definition</a> of <strong>Unicode (not non-breaking) whitespace</strong>.</p>\n\n<p><em><strong>or</strong></em></p>\n\n<p><strong>B.</strong> <a href=\"https://en.wikipedia.org/wiki/Whitespace_character#Unicode\" rel=\"nofollow noreferrer\">Wikipedia's list</a> of <strong>all 25 Unicode code points</strong> defined as whitespace.</p>\n"}], "owner": {"reputation": 289, "user_id": 5299327, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4e00a8f927d808e0e17901f40e3a612b?s=128&d=identicon&r=PG&f=1", "display_name": "John Elaine", "link": "https://stackoverflow.com/users/5299327/john-elaine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1369, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543261760, "creation_date": 1498692429, "question_id": 44814073, "link": "https://stackoverflow.com/questions/44814073/c-interpret-unicode-white-space", "title": "C++ : Interpret unicode white space", "body": "<p>I have a file which contains text (ASCII + unicode) and I am trying to count total words in it using a C++ program. It is a requirement that I should read the file line by line (using <code>getline</code>) and then process each line to count the words within it. </p>\n\n<p>So I have written the following simple program:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n\nint main(int argc, char* argv[]) {\n  uint64_t ct = 0;\n  std::string line;\n  std::ifstream infile(argv[1]);\n  while(std::getline(infile, line)) {\n    std::stringstream inputStream(line);\n    std::string token;\n    while (inputStream &gt;&gt; token) {\n      ++ct;\n    }\n  }\n\n  std::cout &lt;&lt; ct &lt;&lt; std::endl;\n\n  return 0;\n}\n</code></pre>\n\n<p>However, the above program outputs a number that is lesser than what <code>wc -w</code> command gives. To narrow down the problem, I modified the program to simply output whatever it reads. So now the program becomes:</p>\n\n<pre><code>int main(int argc, char* argv[]) {\n  uint64_t ct = 0;\n  std::string line;\n  std::ifstream infile(argv[1]);\n  while(std::getline(infile, line)) {\n    std::stringstream inputStream(line);\n    std::string token;\n    while (inputStream &gt;&gt; token) {\n      std::cout &lt;&lt; token &lt;&lt; \" \";\n    }\n    std::cout &lt;&lt; std::endl;\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>I redirected the output of this program to another file. Now, when I run <code>wc -w</code> on this new file, the number is same as running <code>wc -w</code> on the original file. This means, I am reading all the words (i.e., \"words\" defined by <code>wc</code>) in my program. And hence, a reasonable explanation would be that one of the values of <code>token</code> that is read using <code>inputStream &gt;&gt; token</code> consists of some unicode character that is interpreted as a white space by <code>wc</code> program. So how do I change my program to also support such interpretation of unicode white space characters?</p>\n"}, {"tags": ["c++", "cuda", "gpu"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1498688781, "post_id": 44813437, "comment_id": 76607646, "body": "statically allocated shared memory must have a compile-time constant for the size of the static allocation.  In your case, <code>M</code> is not known at compile time, so the solution is to use <i>dynamically</i> allocated shared memory.  There are many examples of this <a href=\"https://stackoverflow.com/a/5531640/1695960\">here on the CUDA tag</a>, as well as in the <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#shared\" rel=\"nofollow noreferrer\">programming guide</a>. dynamically allocated shared memory uses the <code>extern</code> keyword."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1498688875, "post_id": 44813437, "comment_id": 76607682, "body": "@RobertCrovella: You or talonmies always beat me to the first comment/answer..."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8152040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97eddfadc4ac84098f711a6c6f27d90?s=128&d=identicon&r=PG&f=1", "display_name": "Bassa", "link": "https://stackoverflow.com/users/8152040/bassa"}, "edited": false, "score": 0, "creation_date": 1498747325, "post_id": 44813499, "comment_id": 76636858, "body": "Thank you for your help! Using Shared Memory in CUDA link helped a lot!"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 73, "user_id": 8152040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97eddfadc4ac84098f711a6c6f27d90?s=128&d=identicon&r=PG&f=1", "display_name": "Bassa", "link": "https://stackoverflow.com/users/8152040/bassa"}, "edited": false, "score": 0, "creation_date": 1498763880, "post_id": 44813499, "comment_id": 76647150, "body": "@Bassa: You&#39;re welcome. But I&#39;ll give you the same advice I was given so many times: Before asking a question here it&#39;s a good idea to go over the relevant section of the <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html\" rel=\"nofollow noreferrer\">CUDA programming guide</a> first."}], "tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": true, "score": 1, "last_activity_date": 1498763946, "last_edit_date": 1498763946, "creation_date": 1498688765, "answer_id": 44813499, "question_id": 44813437, "link": "https://stackoverflow.com/questions/44813437/passing-a-constant-integer-in-a-cuda-kernel/44813499#44813499", "title": "Passing a Constant Integer in a CUDA Kernel", "body": "<p>The compiler needs <code>M</code> to be a <em>compile-time</em> constant. At compile time it cannot determine what <code>M</code> is actually going to be (it doesn't know you will just pass it 84 eventually). </p>\n\n<p>When you want to use shared memory of size you only know at runtime, you use <em>dynamic</em> shared memory. </p>\n\n<p>See <a href=\"https://stackoverflow.com/a/5531640/1593077\">this example</a> here on the site or <a href=\"https://devblogs.nvidia.com/parallelforall/using-shared-memory-cuda-cc/\" rel=\"nofollow noreferrer\">Using Shared Memory in CUDA</a> on the Parallel4All blog.</p>\n"}], "owner": {"reputation": 73, "user_id": 8152040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97eddfadc4ac84098f711a6c6f27d90?s=128&d=identicon&r=PG&f=1", "display_name": "Bassa", "link": "https://stackoverflow.com/users/8152040/bassa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "closed_date": 1498929650, "accepted_answer_id": 44813499, "answer_count": 1, "score": 0, "last_activity_date": 1498763946, "creation_date": 1498688351, "last_edit_date": 1498688415, "question_id": 44813437, "link": "https://stackoverflow.com/questions/44813437/passing-a-constant-integer-in-a-cuda-kernel", "closed_reason": "Duplicate", "title": "Passing a Constant Integer in a CUDA Kernel", "body": "<p>I am having a problem with the following code. In the global kernel, loop_d, M has an integer value of 84. When I try to create a shared array, temp, and use M as the size of the array, I get the following error:</p>\n\n<p>error: expression must have a constant value</p>\n\n<p>I am not sure why that is. I know that if I declare M as a global variable, then it works, but the problem is that I get the value of M by calling the function d_two in a different Fortran program, so I am not sure how to get around that. I know that if I replace temp[M] with temp[84], then my program runs perfectly, but that is not very practical, since different problems might have different values of M. Thank you for your help!</p>\n\n<p>The program</p>\n\n<pre><code>// Parallelized 2D Three-Point Guassian Quadrature Numerical Integration Method\n// The following program is part of two linked programs, Integral_2D_Cuda.f. \n// This is a CUDA kernel that could be called in the Integral_2D_Cuda.f Fortran code to compute\n// the integral of a given 2D-function\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;cuda.h&gt;\n#include &lt;cuda_runtime.h&gt;\n// The following is a definition for the atomicAddd function that is called in the loop_d kernel\n// This is needed because the \"regular\" atomicAdd function only works for floats and integers\n__device__ double atomicAddd(double* address, double val)\n{\n    unsigned long long int* address_as_ull = (unsigned long long int*)address;\n    unsigned long long int old = *address_as_ull, assumed;\n    do {\n        assumed = old;\n        old = atomicCAS(address_as_ull, assumed,\n            __double_as_longlong(val + __longlong_as_double(assumed)));\n    } while (assumed != old);\n    return __longlong_as_double(old);\n}\n// GPU kernel that computes the function of interest. This is good for a two dimensional problem.\n__global__ void loop_d(double *a_sx, double *b_swx, double *c_sy, double *d_swy, double *e_ans0, int N, int M)\n{\n    // Declaring a shared array that threads of the same block have access to\n    __shared__ double temp[M];\n    int idxX = blockIdx.x * blockDim.x + threadIdx.x; // Thread indices responsible for the swx and sx arrays\n    int idxY = threadIdx.y;     // Thread indices responsible for the swy and sy arrays\n    // Computing the multiplication of elements\n    if (idxX &lt; N &amp;&amp; idxY &lt; M)\n    {\n        temp[idxY] = a_sx[idxX] * b_swx[idxX] * c_sy[idxY] * d_swy[idxY];\n    }\n    // synchronizing all threads before summing all the mupltiplied elements int he temp array\n    __syncthreads();\n    // Allowing the 0th thread of y to do the summation of the multiplied elements in the temp array of one block \n    if (0 == idxY)\n    {\n        double sum = 0.00;\n        for(int k = 0; k &lt; M; k++)\n        {\n            sum = sum + temp[k];\n        }\n        // Adding the result of this instance of calculation to the final answer, ans0\n        atomicAddd(e_ans0, sum);\n    }\n}\nextern \"C\" void d_two_(double *sx, double *swx, int *nptx, double *sy, double *swy, int *npty, double *ans0)\n{\n    // Assigning GPU pointers\n    double *sx_d, *swx_d;\n    int N = *nptx;\n    double *sy_d, *swy_d;\n    int M = *npty;\n    double *ans0_d;\n    dim3 threadsPerBlock(1,M); // Creating a two dimesional block with 1 thread in the x dimesion and M threads in the y dimesion\n    dim3 numBlocks(N); // specifying the number of blocks to use of dimesion 1xM\n    // Allocating GPU Memory\n    cudaMalloc( (void **)&amp;sx_d, sizeof(double) * N);\n    cudaMalloc( (void **)&amp;swx_d, sizeof(double) * N);\n    cudaMalloc( (void **)&amp;sy_d, sizeof(double) * M);\n    cudaMalloc( (void **)&amp;swy_d, sizeof(double) * M);\n    cudaMalloc( (void **)&amp;ans0_d, sizeof(double) );\n    // Copying information fromm CPU to GPU\n    cudaMemcpy( sx_d, sx, sizeof(double) * N, cudaMemcpyHostToDevice );\n    cudaMemcpy( swx_d, swx, sizeof(double) * N, cudaMemcpyHostToDevice );\n    cudaMemcpy( sy_d, sy, sizeof(double) * M, cudaMemcpyHostToDevice );\n    cudaMemcpy( swy_d, swy, sizeof(double) * M, cudaMemcpyHostToDevice );\n    cudaMemcpy( ans0_d, ans0, sizeof(double), cudaMemcpyHostToDevice );\n    // Calling the function on the GPU\n    loop_d&lt;&lt;&lt; numBlocks, threadsPerBlock &gt;&gt;&gt;(sx_d, swx_d, sy_d, swy_d, ans0_d, N, M);\n    // Copying from GPU to CPU\n    cudaMemcpy( ans0, ans0_d, sizeof(double), cudaMemcpyDeviceToHost );\n    // freeing GPU memory\n    cudaFree(sx_d);\n    cudaFree(swx_d);\n    cudaFree(sy_d);\n    cudaFree(swy_d);\n    cudaFree(ans0_d);\n    return;\n}\n</code></pre>\n"}, {"tags": ["c++", "boost"], "answers": [{"comments": [{"owner": {"reputation": 1004, "user_id": 2036673, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cfbc483da1e90fb9fb000ad59962b295?s=128&d=identicon&r=PG", "display_name": "Person93", "link": "https://stackoverflow.com/users/2036673/person93"}, "edited": false, "score": 0, "creation_date": 1498765162, "post_id": 44814771, "comment_id": 76647806, "body": "I tried that. The stream is still empty, I&#39;ve updated the code in the OP."}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 1, "last_activity_date": 1498766982, "last_edit_date": 1498766982, "creation_date": 1498698161, "answer_id": 44814771, "question_id": 44813318, "link": "https://stackoverflow.com/questions/44813318/boost-process-stream-is-empty/44814771#44814771", "title": "Boost process stream is empty", "body": "<p>You need to enter the full path to gcc, or use <code>bp::find_executable_in_path(\"g++\")</code></p>\n\n<p>[edit]  oops. Under windows:</p>\n\n<p><code>bp::find_executable_in_path(\"g++.exe\")</code></p>\n"}], "owner": {"reputation": 1004, "user_id": 2036673, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cfbc483da1e90fb9fb000ad59962b295?s=128&d=identicon&r=PG", "display_name": "Person93", "link": "https://stackoverflow.com/users/2036673/person93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498766982, "creation_date": 1498687681, "last_edit_date": 1498765126, "question_id": 44813318, "link": "https://stackoverflow.com/questions/44813318/boost-process-stream-is-empty", "title": "Boost process stream is empty", "body": "<p>I just installed the Boost library and I am trying to get through the basic tutorial.</p>\n\n<p>I am trying to open a process that runs <code>g++ --version</code> and pipes the output to std_<code>std_out</code>.</p>\n\n<p>The code is copied from the <a href=\"http://www.highscore.de/boost/process/process/tutorials.html\" rel=\"nofollow noreferrer\">tutorial</a> with the following changes:</p>\n\n<ul>\n<li>added <code>cout</code> statements to track progress</li>\n<li>added call to <code>bp::find_executable_in_path()</code></li>\n</ul>\n\n<p>Here's the code:</p>\n\n<pre><code>//\n// Boost.Process\n// ~~~~~~~~~~~~~\n//\n// Copyright (c) 2006, 2007 Julio M. Merino Vidal\n// Copyright (c) 2008 Boris Schaeling\n//\n// Distributed under the Boost Software License, Version 1.0. (See accompanying\n// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)\n//\n\n#include &lt;boost/process.hpp&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nnamespace bp = ::boost::process;\nusing namespace std;\n\nbp::child start_child() {\n    string exec = bp::find_executable_in_path( \"g++\" );\n    cout &lt;&lt; \"full path is \" &lt;&lt; exec &lt;&lt; endl;\n\n    cout &lt;&lt; \"starting child process\" &lt;&lt; endl;\n    vector&lt;std::string&gt; args;\n    args.push_back( \"--version\" );\n\n    bp::context ctx;\n    ctx.stdout_behavior = bp::capture_stream();\n    ctx.stderr_behavior = bp::capture_stream();\n\n    return bp::launch( exec, args, ctx );\n}\n\nint main() {\n    bp::child c = start_child();\n\n    bp::pistream &amp;is = c.get_stdout();\n    cout &lt;&lt; ( is ? \"stream is valid\" : \"stream is NOT valid\" ) &lt;&lt; endl;\n    string line;\n    cout &lt;&lt; \"entering read/write loop\" &lt;&lt; endl;\n    while( getline( is, line ) ) {\n        cout &lt;&lt; \"copying a line\" &lt;&lt; endl;\n        cout &lt;&lt; line &lt;&lt; endl;\n    }\n    cout &lt;&lt; \"exiting read/write loop\" &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Here is what I see when I run <code>g++ --version</code> on the command line:</p>\n\n<pre><code>g++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-11)\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<p>This is the output of the compiled program:</p>\n\n<pre><code>full path is /usr/bin/g++\nstarting child process\nstream is valid\nentering read/write loop\nexiting read/write loop\n</code></pre>\n\n<p>It never enters the read/write loop. What happened to the data from the stream?</p>\n"}, {"tags": ["c++", "eclipse", "gcc"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498690755, "post_id": 44813239, "comment_id": 76608235, "body": "Which variant of mingw? I&#39;ve had trouble getting it to recognize some of the newer ones."}, {"owner": {"reputation": 73, "user_id": 6418125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/11c88c3cdeda66b581e4182eb953721a?s=128&d=identicon&r=PG&f=1", "display_name": "JoelContreras", "link": "https://stackoverflow.com/users/6418125/joelcontreras"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498691585, "post_id": 44813239, "comment_id": 76608433, "body": "the read me says this: [CONTENTS] Essentials:     * binutils 2.28     * GCC 7.1.0     * mingw-w64 5.0.2 its the latest one to my knowledge"}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 6418125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/11c88c3cdeda66b581e4182eb953721a?s=128&d=identicon&r=PG&f=1", "display_name": "JoelContreras", "link": "https://stackoverflow.com/users/6418125/joelcontreras"}, "is_accepted": true, "score": 0, "last_activity_date": 1499250105, "creation_date": 1499250105, "answer_id": 44923516, "question_id": 44813239, "link": "https://stackoverflow.com/questions/44813239/eclipse-for-c-developers-mingw-error/44923516#44923516", "title": "eclipse for c++ developers MinGW error", "body": "<p>Solved it by putting mingw32-gcc.exe in the bin folder..\nin other words.. eclipse needs the 32bit version of minwg..</p>\n"}], "owner": {"reputation": 73, "user_id": 6418125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/11c88c3cdeda66b581e4182eb953721a?s=128&d=identicon&r=PG&f=1", "display_name": "JoelContreras", "link": "https://stackoverflow.com/users/6418125/joelcontreras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 44923516, "answer_count": 1, "score": 0, "last_activity_date": 1499250105, "creation_date": 1498687301, "question_id": 44813239, "link": "https://stackoverflow.com/questions/44813239/eclipse-for-c-developers-mingw-error", "title": "eclipse for c++ developers MinGW error", "body": "<p>I just installed the Eclipse for C++ Developers, but my problem is that it does not recognize MinGW (MinGW is in the System Environment Variables, if i open CMD where ever it runs <code>gcc --version</code> just fine)\nin eclipse settings under C++ i have the environment variables set also..\nbut when i open new c++ project nothing gets recognized (libraries, syntax, etc..) and my only toolchain available is Cross GCC witch i do not have installed.. \nCodeBlocks works fine with C++\nbut i want to try eclipse..</p>\n"}, {"tags": ["c++", "clang", "abstract-syntax-tree"], "answers": [{"comments": [{"owner": {"reputation": 4894, "user_id": 1071273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4A2ko.jpg?s=128&g=1", "display_name": "Michael Haidl", "link": "https://stackoverflow.com/users/1071273/michael-haidl"}, "edited": false, "score": 0, "creation_date": 1504821085, "post_id": 44957977, "comment_id": 79174238, "body": "<code>getAs</code> will return null in cases where <code>type</code> is not a <code>RecordType</code> it behaves like an LLVM <code>dyn_cast</code>"}, {"owner": {"reputation": 300, "user_id": 6558660, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b0e5bff824dbb6d3189660328bfa206?s=128&d=identicon&r=PG&f=1", "display_name": "srujzs", "link": "https://stackoverflow.com/users/6558660/srujzs"}, "reply_to_user": {"reputation": 4894, "user_id": 1071273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4A2ko.jpg?s=128&g=1", "display_name": "Michael Haidl", "link": "https://stackoverflow.com/users/1071273/michael-haidl"}, "edited": false, "score": 0, "creation_date": 1504824976, "post_id": 44957977, "comment_id": 79175482, "body": "You&#39;re absolutely right, and I should have clarified. Let me know if the edit is sufficient."}], "tags": [], "owner": {"reputation": 300, "user_id": 6558660, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b0e5bff824dbb6d3189660328bfa206?s=128&d=identicon&r=PG&f=1", "display_name": "srujzs", "link": "https://stackoverflow.com/users/6558660/srujzs"}, "is_accepted": true, "score": 2, "last_activity_date": 1505118484, "last_edit_date": 1505118484, "creation_date": 1499371637, "answer_id": 44957977, "question_id": 44813207, "link": "https://stackoverflow.com/questions/44813207/how-do-i-find-the-sourcelocation-of-the-type-definition-of-a-vardecl-using-the-c/44957977#44957977", "title": "How do I find the SourceLocation of the type definition of a VarDecl using the Clang AST?", "body": "<p>This can be accomplished by typecasting or using the <code>getAs()</code> method to cast a <code>Type</code> class to something that has references to a type declaration.</p>\n\n<p>For example,</p>\n\n<pre><code>// Get Type of variable declaration\nconst clang::Type* type = var_decl-&gt;getTypeSourceInfo()-&gt;getTypeLoc().getTypePtr();\n\n// Cast it as its appropriate subtype and then obtain its declaration\n// For example, if the type was a record, you can cast it as a \n// RecordType and then obtain its definition.\nconst clang::RecordType* record_type = type-&gt;getAs&lt;clang::RecordType&gt;();\nif (record_type != nullptr) {\n  const clang::RecordDecl* type_decl = record_type-&gt;getDecl();\n\n  clang::SourceLocation end_of_type_decl = type_decl-&gt;getLocEnd();\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 300, "user_id": 6558660, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b0e5bff824dbb6d3189660328bfa206?s=128&d=identicon&r=PG&f=1", "display_name": "srujzs", "link": "https://stackoverflow.com/users/6558660/srujzs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 1, "accepted_answer_id": 44957977, "answer_count": 1, "score": 4, "last_activity_date": 1505118484, "creation_date": 1498687117, "question_id": 44813207, "link": "https://stackoverflow.com/questions/44813207/how-do-i-find-the-sourcelocation-of-the-type-definition-of-a-vardecl-using-the-c", "title": "How do I find the SourceLocation of the type definition of a VarDecl using the Clang AST?", "body": "<p>I'm trying to determine if a type is defined within the file or is included in another file (either system header or otherwise), and I can't seem to find an easy way to find the location of a type of a variable. The closest I can get is using TypeLoc's methods, but those provide only the location of the variable declaration (weirdly enough). ASTContext and SourceManager classes don't seem to provide much help either. Any ideas on how this can be done (I'm sure there <em>has</em> to be a way)?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 4, "creation_date": 1498686892, "post_id": 44813129, "comment_id": 76606958, "body": "definition is different thing than initialization, it is not clear why you linked them together"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498687237, "post_id": 44813129, "comment_id": 76607108, "body": "@Slava well okay then. However, I do not think that ruin the content of my qeustions because I still do not know whether the declarations non-static variables(not really sure about static) are definitions too? Btw. I totally forgot that definitions and initializations aren&#39;t the same thing.. I am still confused though"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498687447, "post_id": 44813129, "comment_id": 76607186, "body": "Declaration of local variables is always definition, for non local variables you can make declaration not definition by using keyword <code>extern</code> explicitly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498687575, "post_id": 44813129, "comment_id": 76607246, "body": "Plus, I do not get how declarations are definitions? As I implied in the post."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498687862, "post_id": 44813129, "comment_id": 76607346, "body": "@Slava thanks. But exactly why is that? Are static variables defined when declared too then?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498687882, "post_id": 44813129, "comment_id": 76607352, "body": "&quot;how declarations are definitions?&quot; if you write <code>int x;</code> that is declaration and definition of variable <code>x</code> of type <code>int</code>. What is not clear?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1498688345, "post_id": 44813129, "comment_id": 76607512, "body": "@Slava yeah okay I got you now. I think my confusion came a lot from when I mixed up definitions and initializations. One thing more though: I still do not get why static data members aren&#39;t defined then when declared in a class definition since static variables are defined by their declaration? I mean, static data members are included in the exception list"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1498688821, "post_id": 44813129, "comment_id": 76607668, "body": "Though initialization sometimes turns a declaration into a definition, they are actually separate constructs. Read 3.1 Declarations and definitions (2) in this c++ standard (early) draft: <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf</a>. Maybe things get clearer then."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1498741719, "post_id": 44813129, "comment_id": 76632261, "body": "@NeiLee &quot;I still do not get why static data members aren&#39;t defined then when declared in a class definition&quot; because it is common to put class declaration in a header file, so that declaration is visible in every translation unit which includes this  header. But static data member must be defined only once."}], "owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1498687944, "answer_count": 0, "score": 0, "last_activity_date": 1498686827, "creation_date": 1498686749, "last_edit_date": 1498686827, "question_id": 44813129, "link": "https://stackoverflow.com/questions/44813129/variable-declarations-are-definitions", "closed_reason": "Duplicate", "title": "Variable declarations are definitions?", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/language/definition\" rel=\"nofollow noreferrer\">cppreference</a> states: </p>\n\n<blockquote>\n  <p>Every declaration is a definition, except for the following:</p>\n</blockquote>\n\n<p>and then I do not see non-static(local) variables on the list of exceptions. However, I get why that static variables are considered as defined when declared since they are initialized to zero. BUT non-static variables are indeterminate, so are those non-static variables considered as being defined when being declared - as with static variables?</p>\n\n<p>Example:</p>\n\n<pre><code>int x; // zero\nint y = 0; // also zero\n\nvoid foo() {\n    static int x; // also zero\n}\n</code></pre>\n\n<p>So here all the <code>x</code> and <code>y</code> are initialized to zero and therefore I think I get it if those declarations are considered as definitions.</p>\n\n<p>But</p>\n\n<pre><code>void foo() {\n    int x;\n    printf(\"%d\", x); // the compiler is free to crash here\n}\n</code></pre>\n\n<p>Is the declaration of <code>x</code> also a definition, I mean this declaration does not really initialized to anything, right?</p>\n\n<p>In fact, I have always thought that there was a pretty obvious difference between declarations and definitions, like <code>int x;</code>, <code>class X;</code> vs. <code>int x = 2</code> and <code>class X {};</code>.</p>\n\n<p>Also, if it is true that the declarations static variables also are definitions, why are static class members included in the exception list and not static variables that are not a member of a class?</p>\n"}, {"tags": ["c++", "memory", "abstract-class", "virtual"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1498686528, "post_id": 44813065, "comment_id": 76606806, "body": "<i>&quot;Are there solutions already in place to do this?&quot;</i> <code>boost::asio</code>"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498686832, "post_id": 44813065, "comment_id": 76606939, "body": "Uh but in your solution you still have to dereference. You still call through a pointer to socket so you still go through the vtable. The only thing you are changing is where the data is stored. Is that your intent?"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498687076, "post_id": 44813065, "comment_id": 76607039, "body": "I mean, the actual simplest, and most performant thing to do is simply to get rid of inheritance altogether, and just template the <code>connection</code> on the exact type of <code>socket</code> it has. Then you pay zero indirection costs whatsoever and it is much simpler than you are trying to do. But <code>connection</code> will now have a type dependent on which socket it has active, so you cannot decide at runtime which connection you will use (unless you erase types at a higher level). Is this an issue?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498687081, "post_id": 44813065, "comment_id": 76607041, "body": "why dont you show code instead of lengthy descriptions? Actually in that case it would be a better fit for <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 6932, "user_id": 774236, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7e46879a230ff1e28cd975e3b0a0873b?s=128&d=identicon&r=PG", "display_name": "Matteo Monti", "link": "https://stackoverflow.com/users/774236/matteo-monti"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498687366, "post_id": 44813065, "comment_id": 76607158, "body": "@NirFriedman true, but since the <code>socket</code> object is contiguous in memory to the <code>connection</code> object, I guess it will have a better chance to avoid cache misses. Am I wrong?"}, {"owner": {"reputation": 6932, "user_id": 774236, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7e46879a230ff1e28cd975e3b0a0873b?s=128&d=identicon&r=PG", "display_name": "Matteo Monti", "link": "https://stackoverflow.com/users/774236/matteo-monti"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498687445, "post_id": 44813065, "comment_id": 76607185, "body": "@NirFriedman yes, that&#39;s exactly the issue :) I have no way to know at compile time whether a connection is going to be on top of a <code>TCP</code>, <code>UDT</code>, etc socket."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1498687467, "post_id": 44813065, "comment_id": 76607193, "body": "Is <code>UDT</code> a typo for <code>UDP</code>?"}, {"owner": {"reputation": 6932, "user_id": 774236, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7e46879a230ff1e28cd975e3b0a0873b?s=128&d=identicon&r=PG", "display_name": "Matteo Monti", "link": "https://stackoverflow.com/users/774236/matteo-monti"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1498687497, "post_id": 44813065, "comment_id": 76607214, "body": "@Barmar <a href=\"http://udt.sourceforge.net/\" rel=\"nofollow noreferrer\">udt.sourceforge.net</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1498687581, "post_id": 44813065, "comment_id": 76607250, "body": "The normal way to do this is with a pointer. The derferencing overhead is negligible. <a href=\"http://c2.com/cgi/wiki?PrematureOptimization\" rel=\"nofollow noreferrer\">Premature optimization is the root of all evil</a>"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1498687986, "post_id": 44813065, "comment_id": 76607393, "body": "@Barmar You are assuming that this is premature. And the cost of a cache miss is quite significant."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 1, "creation_date": 1498688107, "post_id": 44813065, "comment_id": 76607430, "body": "@NirFriedman Compared to the cost of network I/O? I think not."}, {"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1498688804, "post_id": 44813065, "comment_id": 76607659, "body": "I&#39;m with @Barmar here: cache miss, dereferencing, are &quot;slow&quot; compared to what? Here we are talking about network I/O: sending one byte over the wire will require so much more time compared to cache miss or &quot;slow&quot; dereferencing. Go for clean and maintainable code, read about Single Responsability Principle and Separation of Concern. And start worrying about performance only after measuring it. In most (not all) of real word scenarios, your concern about dereferencing performance will be negligible."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498689169, "post_id": 44813065, "comment_id": 76607791, "body": "@NirFriedman I&#39;ve been here long enough to know that 99% of the questions about optimization are premature and/or misguided. I&#39;m willing to pay out on the 1%."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1498689309, "post_id": 44813065, "comment_id": 76607841, "body": "@Barmar It seems wrong to not give people the benefit of the doubt. For anyone working in HFT, which is a significant chunk of C++ development, this is just a routine optimization."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498689485, "post_id": 44813065, "comment_id": 76607898, "body": "@NirFriedman I&#39;ve been answering programming questions on the Internet for over 30 years. At the risk of bragging, I&#39;ve got a very good intuition for this kind of thing. 99% of questions about optimization are premature or misguided. I&#39;m willing to pay off on the 1% I&#39;m wrong about. But I&#39;d expect the OP to provide the benchmarking data that supports it."}, {"owner": {"reputation": 6932, "user_id": 774236, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7e46879a230ff1e28cd975e3b0a0873b?s=128&d=identicon&r=PG", "display_name": "Matteo Monti", "link": "https://stackoverflow.com/users/774236/matteo-monti"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1498721899, "post_id": 44813065, "comment_id": 76618068, "body": "@Barmar I have encountered this problem in multiple situations, from networking to high performance simulations. This time I decided to ask if it was possible to do what I had in mind. @NirFriedman answered my question: yes, not only it is possible, but it is actually a recognized issue, and pointed me to <code>variant</code>s."}, {"owner": {"reputation": 6932, "user_id": 774236, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7e46879a230ff1e28cd975e3b0a0873b?s=128&d=identicon&r=PG", "display_name": "Matteo Monti", "link": "https://stackoverflow.com/users/774236/matteo-monti"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1498722164, "post_id": 44813065, "comment_id": 76618220, "body": "@Barmar From NirFriedman &#39;s answer I have learned something useful that I will use in the future. A reason I am using SO less and less is that nearly all the answers I get are opinions on why I shouldn&#39;t ask the question in the first place, no matter how plain and simple. I shouldn&#39;t optimize too early I shouldn&#39;t use templates too often I shouldn&#39;t work on two-dimensional dynamical systems I shouldn&#39;t have written my first programs with my grandpa when I was seven."}], "answers": [{"comments": [{"owner": {"reputation": 6932, "user_id": 774236, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7e46879a230ff1e28cd975e3b0a0873b?s=128&d=identicon&r=PG", "display_name": "Matteo Monti", "link": "https://stackoverflow.com/users/774236/matteo-monti"}, "edited": false, "score": 1, "creation_date": 1498688023, "post_id": 44813351, "comment_id": 76607402, "body": "Looks like exactly what I was looking for. Thank you!"}], "tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": true, "score": 1, "last_activity_date": 1498688064, "last_edit_date": 1498688064, "creation_date": 1498687862, "answer_id": 44813351, "question_id": 44813065, "link": "https://stackoverflow.com/questions/44813065/member-of-derived-type/44813351#44813351", "title": "Member of derived type", "body": "<p>Based on the question + comments, I think your best bet is to simply drop the inheritance and use a <code>variant</code>. This solution requires either boost, C++17, or a new-ish compiler/standard library with an implementation of the variant TS, and preferably 14. A variant is a type that stores one of several types. It stores everything on the stack, based on the size of the largest type.</p>\n\n<pre><code>struct tcp {\n  void do_stuff() const;\n};\n\nstruct udp {\n  void do_stuff() const;\n};\n\nusing socket_type = std::variant&lt;tcp,udp&gt;;\n\nvoid do_stuff(const socket_type&amp; s) {\n    visit([] (const auto&amp; x) { x.do_stuff(); }, s);\n}\n\nenum class SocketKind { TCP, UDP };\n\ntemplate &lt;class ... Args&gt;\nsocket_type make_socket(SocketKind k, Args &amp;&amp; args) {\n    if (k == SocketKind::TCP) { return tcp(std::forward&lt;Args&gt;(args)...); }\n    if (k == SocketKind::UDP) { return udp(std::forward&lt;Args&gt;(args)...); }  \n}\n</code></pre>\n\n<p>You can create these sockets with a factory like this, and then you can call <code>do_stuff</code> generically on a socket object. Everything is stored in-line in memory, and the dispatch will be handled via switch-case which is likely to be faster than vtable if you have a small number of socket types (but that's just a guess).</p>\n\n<p>(Note that I use a variadic lambda to write <code>do_stuff</code>, this just simplifies things but isn't really required. You can write out that visitor by hand, so you can still use this solution with even C++03 as long as you can use boost).</p>\n"}], "owner": {"reputation": 6932, "user_id": 774236, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7e46879a230ff1e28cd975e3b0a0873b?s=128&d=identicon&r=PG", "display_name": "Matteo Monti", "link": "https://stackoverflow.com/users/774236/matteo-monti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 44813351, "answer_count": 1, "score": 1, "last_activity_date": 1498688064, "creation_date": 1498686376, "question_id": 44813065, "link": "https://stackoverflow.com/questions/44813065/member-of-derived-type", "title": "Member of derived type", "body": "<p>Consider the following example:</p>\n\n<ul>\n<li>I have an abstract class <code>socket</code>, which defines some virtual interface for a nice object-oriented socket (e.g., <code>send</code> and <code>receive</code>).</li>\n<li>That class is then specialized in multiple ways, (e.g., in my case, I can have a <code>TCP</code> socket or an <code>UDT</code> socket, they work in different ways (<code>UDT</code> is based on an underlying <code>UDP</code> socket, for example) but they have the same interface, i.e., one can e.g. <code>send</code> and <code>receive</code>.</li>\n<li>I have a <code>connection</code> class that should somehow wrap a socket, adding a whole lot of features (e.g. template methods to send and receive objects, it serializes them, everything is beautiful).</li>\n</ul>\n\n<p>Now, the most simple thing I could do in <code>connection</code> is to have a <code>socket *</code> pointer. The <code>connection</code> can then accept in its constructor a pointer and all is nice. However, there is a performance issue there: whenever my <code>connection</code> object wants to talk to my <code>socket</code> object, there is a dereferencing that requires time.</p>\n\n<p>What I would like to do is to actually have the <code>socket</code> as a member of <code>connection</code>. Don't take me wrong: I know that, if nothing else, different specializations of <code>socket</code> can have different sizes, so I cannot simply do something like: <code>socket my_pretty_socket;</code></p>\n\n<h2>My idea</h2>\n\n<p>What I would like to know is if the following idea doesn't make any sense, and why.</p>\n\n<p>I have a finte and limited set of possible specializations of <code>socket</code>. What if I built some <code>template any &lt;typename base, typename... specializations&gt;</code> that:</p>\n\n<ul>\n<li>Allocates an array of as many <code>char</code>s as the largest of the specializations.</li>\n<li>Offers a template constructor that forwards its parameters to the constructor of the specified specialization, and uses placement <code>new</code> on the allocated array to create the object.</li>\n<li>Behaves like a reference to <code>socket</code>, e.g. by providing an <code>operator * ()</code> or by forwarding each call to the interface of <code>socket</code> to the specialization it is storing.</li>\n</ul>\n\n<p>In this way, I would have the object in place as a member of <code>connection</code>, and I would preserve all the nice properties of an interface while saving on memory transactions.</p>\n\n<ol>\n<li>Is this idea dumb? Why?</li>\n<li>Are there solutions already in place to do this? I am sure I cannot be the only one to have this kind of problem.</li>\n</ol>\n"}, {"tags": ["c++", "opencv", "vector"], "comments": [{"owner": {"reputation": 14828, "user_id": 1377097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eFG0R.png?s=128&g=1", "display_name": "beaker", "link": "https://stackoverflow.com/users/1377097/beaker"}, "edited": false, "score": 0, "creation_date": 1498685707, "post_id": 44812779, "comment_id": 76606453, "body": "All you do is change the <code>color</code> parameter to a single grayscale value rather than an RGB triplet. Also note that the accepted answer uses the deprecated C-API call <code>cvLine</code> rather than the C++ <code>cv::line</code>."}, {"owner": {"reputation": 35, "user_id": 7674459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAeY_LqC3DY/AAAAAAAAAAI/AAAAAAAABjU/nH4Bx0qG4Kg/photo.jpg?sz=128", "display_name": "Yogang Singh", "link": "https://stackoverflow.com/users/7674459/yogang-singh"}, "reply_to_user": {"reputation": 14828, "user_id": 1377097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eFG0R.png?s=128&g=1", "display_name": "beaker", "link": "https://stackoverflow.com/users/1377097/beaker"}, "edited": false, "score": 0, "creation_date": 1498686064, "post_id": 44812779, "comment_id": 76606609, "body": "@beaker I am more confused with the way the solution is being presented. I don&#39;t think they have shared the complete code. They have just put a part of the code."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7674459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAeY_LqC3DY/AAAAAAAAAAI/AAAAAAAABjU/nH4Bx0qG4Kg/photo.jpg?sz=128", "display_name": "Yogang Singh", "link": "https://stackoverflow.com/users/7674459/yogang-singh"}, "edited": false, "score": 0, "creation_date": 1500385250, "post_id": 44824326, "comment_id": 77304918, "body": "Sorry for responding late. I had fall ill so could not reply. Please let me know how to define velocity vector of certain magnitude in the figure."}, {"owner": {"reputation": 90, "user_id": 6889602, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-TKOb54QulLE/AAAAAAAAAAI/AAAAAAAAACE/B2qnhiTEF9I/photo.jpg?sz=128", "display_name": "Riccardo Giubilato", "link": "https://stackoverflow.com/users/6889602/riccardo-giubilato"}, "reply_to_user": {"reputation": 35, "user_id": 7674459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAeY_LqC3DY/AAAAAAAAAAI/AAAAAAAABjU/nH4Bx0qG4Kg/photo.jpg?sz=128", "display_name": "Yogang Singh", "link": "https://stackoverflow.com/users/7674459/yogang-singh"}, "edited": false, "score": 0, "creation_date": 1500645422, "post_id": 44824326, "comment_id": 77445098, "body": "In the code i wrote, the velocity vector (or a vector in general) is represented as a line between two points, <code>p1</code> and <code>p2</code> of type <code>cv::Point</code>. The magnitude of this vector is just the euclidean distance between <code>p1</code> and <code>p2</code>.  <code>x</code> and <code>y</code> represent the starting point of the line and <code>u</code> and <code>v</code> are the x and y coordinates of <code>p2</code> relative to <code>p1</code>. In order tl modify the direction and magnitude of the vector you just need to rotate p2 and &quot;stretch&quot; it from p1. In other words just change the values of <code>size</code> and <code>Theta</code>"}, {"owner": {"reputation": 35, "user_id": 7674459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAeY_LqC3DY/AAAAAAAAAAI/AAAAAAAABjU/nH4Bx0qG4Kg/photo.jpg?sz=128", "display_name": "Yogang Singh", "link": "https://stackoverflow.com/users/7674459/yogang-singh"}, "edited": false, "score": 0, "creation_date": 1500909594, "post_id": 44824326, "comment_id": 77530976, "body": "Many thanks for the explanation. This code is just for one arrow but if we want to extend the arrows in a circular pattern with multiple arrows, can you suggest something towards this !!"}, {"owner": {"reputation": 90, "user_id": 6889602, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-TKOb54QulLE/AAAAAAAAAAI/AAAAAAAAACE/B2qnhiTEF9I/photo.jpg?sz=128", "display_name": "Riccardo Giubilato", "link": "https://stackoverflow.com/users/6889602/riccardo-giubilato"}, "reply_to_user": {"reputation": 35, "user_id": 7674459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAeY_LqC3DY/AAAAAAAAAAI/AAAAAAAABjU/nH4Bx0qG4Kg/photo.jpg?sz=128", "display_name": "Yogang Singh", "link": "https://stackoverflow.com/users/7674459/yogang-singh"}, "edited": false, "score": 0, "creation_date": 1500970121, "post_id": 44824326, "comment_id": 77556442, "body": "In that case you just need to define a <code>std::vector&lt;cv::Point&gt; p1_vec</code> and <code>std::vector&lt;cv::Point&gt; p2_vec</code> where you store each <code>p1</code> and <code>p2</code> needed to draw a line. Now in a <code>for(int i=0; i&lt;pt1_vec.size(); i++)</code> loop you just call <code>cv::line(dst_rgb,pt1_vec.at(i),pt2_vec.at(i),Color,Thickness&zwnj;&#8203;,8);</code> Remember that <code>cv::line</code> just modify the pixel values of dst_rgb as all the other drawing functions of opencv. What i mean is that there is no &quot;object&quot; or &quot;memory locations&quot; linked to the opencv line, so you can draw any line that you want without any increase in the memory usage"}, {"owner": {"reputation": 35, "user_id": 7674459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAeY_LqC3DY/AAAAAAAAAAI/AAAAAAAABjU/nH4Bx0qG4Kg/photo.jpg?sz=128", "display_name": "Yogang Singh", "link": "https://stackoverflow.com/users/7674459/yogang-singh"}, "edited": false, "score": 0, "creation_date": 1501064987, "post_id": 44824326, "comment_id": 77610283, "body": "Accepted your answer. Many thanks for your answer. It did helped me a lot. Saved me a lot of time !!"}], "tags": [], "owner": {"reputation": 90, "user_id": 6889602, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-TKOb54QulLE/AAAAAAAAAAI/AAAAAAAAACE/B2qnhiTEF9I/photo.jpg?sz=128", "display_name": "Riccardo Giubilato", "link": "https://stackoverflow.com/users/6889602/riccardo-giubilato"}, "is_accepted": true, "score": 0, "last_activity_date": 1498736931, "creation_date": 1498736931, "answer_id": 44824326, "question_id": 44812779, "link": "https://stackoverflow.com/questions/44812779/plotting-velocity-vectors-in-a-binary-image-using-opencv/44824326#44824326", "title": "Plotting Velocity Vectors in a Binary Image Using OpenCV", "body": "<p>This is my solution to your problem: in this example I start with an rgb image coming from the webcam, then i convert it to grayscale and then to binary after applying a threshold.</p>\n\n<p>The next step, when you have a binary image, is to convert it to RGB again (or BGR as the OpenCV convention) and draw whatever you want on it. The code for the arrow is a copypasta of what you have linked.</p>\n\n<p>Hope it helps</p>\n\n<pre><code>cv::VideoCapture cam(n_source);\ncam &gt;&gt; frame;\n\ncv::Mat grey_image;\ncv::Mat binary_image;  // Your binary image\ncv::cvtColor(frame, grey_image, CV_RGB2GRAY);\ncv::threshold(grey_image, binary_image, 100, 255, 0);\n\n// Convert the binary to RGB\ncv::Mat dst_rgb;\ncv::cvtColor(binary_image, dst_rgb, CV_GRAY2BGR);\n\n// Draw the arrow on the RGB image\nint x = 200;\nint y = 200;\nint u = 100;\nint v = 100;\n\ncv::Point pt1,pt2;\ndouble Theta;\ndouble PI = 3.1416;\n\ncv::Scalar Color(255,0,0);\nint size = 5;\nint Thickness = 5;\n\nif(u==0)\n    Theta=PI/2;\nelse\n    Theta=atan2(double(v),(double)(u));\n\npt1.x=x;\npt1.y=y;\n\npt2.x=x+u;\npt2.y=y+v;\n\ncv::line(dst_rgb,pt1,pt2,Color,Thickness,8);  //Draw Line\n\n\nsize=(int)(size*0.707);\n\n\nif(Theta==PI/2 &amp;&amp; pt1.y &gt; pt2.y)\n    {\n    pt1.x=(int)(size*cos(Theta)-size*sin(Theta)+pt2.x);\n    pt1.y=(int)(size*sin(Theta)+size*cos(Theta)+pt2.y);\n    cv::line(dst_rgb,pt1,pt2,Color,Thickness,8);  //Draw Line\n\n    pt1.x=(int)(size*cos(Theta)+size*sin(Theta)+pt2.x);\n    pt1.y=(int)(size*sin(Theta)-size*cos(Theta)+pt2.y);\n    cv::line(dst_rgb,pt1,pt2,Color,Thickness,8);  //Draw Line\n  }\nelse{\n    pt1.x=(int)(-size*cos(Theta)-size*sin(Theta)+pt2.x);\n    pt1.y=(int)(-size*sin(Theta)+size*cos(Theta)+pt2.y);\n    cv::line(dst_rgb,pt1,pt2,Color,Thickness,8);  //Draw Line\n\n    pt1.x=(int)(-size*cos(Theta)+size*sin(Theta)+pt2.x);\n    pt1.y=(int)(-size*sin(Theta)-size*cos(Theta)+pt2.y);\n    cv::line(dst_rgb,pt1,pt2,Color,Thickness,8);  //Draw Line\n}\n\n// Plot\ncv::namedWindow(\"test rgb\");\ncv::imshow(\"test rgb\", dst_rgb);\ncv::waitKey(0);\n</code></pre>\n\n<p>An example: \n<a href=\"https://i.stack.imgur.com/9TyZa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9TyZa.png\" alt=\"blue line over binary image\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 7674459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAeY_LqC3DY/AAAAAAAAAAI/AAAAAAAABjU/nH4Bx0qG4Kg/photo.jpg?sz=128", "display_name": "Yogang Singh", "link": "https://stackoverflow.com/users/7674459/yogang-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1500385417, "creation_date": 1500385417, "answer_id": 45168585, "question_id": 44812779, "link": "https://stackoverflow.com/questions/44812779/plotting-velocity-vectors-in-a-binary-image-using-opencv/45168585#45168585", "title": "Plotting Velocity Vectors in a Binary Image Using OpenCV", "body": "<p>After some discussion I have come across cv::arrowedLine in OpenCV whose one of the usage is as follows:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\n #include &lt;opencv2/opencv.hpp&gt;\n #include &lt;opencv2/highgui.hpp&gt;\n\n  using namespace std;\n  using namespace cv;\n\n int main(int argc, char* argv[])\n {\nauto width = 320;\nauto height = 320;\nauto img = cv::Mat(cv::Size(width, height), CV_8UC3); // create background image\n\nauto center = cv::Point(width / 2, height / 2); // center point\n\nint lineType = 8;\nint thickness = 1;\ndouble tipLength = 0.1;\n\nimg.setTo(255);                          // clear image - set to black (0) or white (255)\n\nfor (int angle = 0; angle &lt; 360; angle += 15)\n{\n    auto angleRad = angle*CV_PI / 180.0;   // convert angle to radians\n\n    auto length = 150;\n    auto direction = cv::Point(length * cos(angleRad), length * sin(angleRad)); // calculate direction\n    tipLength = .01 + 0.4 * (angle % 180) / 360;\n\n    cv::arrowedLine(img, center + direction*0.5, center + direction, CV_RGB(255, angle, 0), thickness, lineType, 0, tipLength); // draw arrow!\n\n    ++thickness;\n    if (0 == angle % 45)\n        thickness = 0;\n\n    if (180 &lt;= angle)\n        lineType = CV_AA;\n}\nimshow(\"Arrowed Image\", img);          // show image\nwaitKey();\n\nreturn EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7674459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAeY_LqC3DY/AAAAAAAAAAI/AAAAAAAABjU/nH4Bx0qG4Kg/photo.jpg?sz=128", "display_name": "Yogang Singh", "link": "https://stackoverflow.com/users/7674459/yogang-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 44824326, "answer_count": 2, "score": 0, "last_activity_date": 1500385417, "creation_date": 1498685068, "last_edit_date": 1498705350, "question_id": 44812779, "link": "https://stackoverflow.com/questions/44812779/plotting-velocity-vectors-in-a-binary-image-using-opencv", "title": "Plotting Velocity Vectors in a Binary Image Using OpenCV", "body": "<p>I have a binary (Black and White) image over which I want to plot velocity vectors of certain velocity. In MATLAB, we can use <code>quiver</code> to plot these vectors. I am looking for a solution to this problem in OpenCV using C++. I would be grateful if someone can share a solution to this. Although one of the solutions is provided in using the static image on SO (<a href=\"https://stackoverflow.com/questions/10161351/opencv-how-to-plot-velocity-vectors-as-arrows-in-using-single-static-image\">OpenCV How to Plot velocity vectors as arrows in using single static image</a>), its not clear of how to implement it on a binary image. I would be grateful if someone can guide me. \nLook forward to some suggestion towards implementation. </p>\n"}, {"tags": ["c++", "list"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 9, "creation_date": 1498684992, "post_id": 44812726, "comment_id": 76606140, "body": "struct, class, same thing."}, {"owner": {"reputation": 2310, "user_id": 1659758, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eb242bf0309ff23a833440458db2af25?s=128&d=identicon&r=PG&f=1", "display_name": "Tracer", "link": "https://stackoverflow.com/users/1659758/tracer"}, "edited": false, "score": 0, "creation_date": 1498685567, "post_id": 44812726, "comment_id": 76606411, "body": "The only mayor difference between class and struct in c++ is that class uses private and struct uses public member access by default."}, {"owner": {"reputation": 313, "user_id": 5534308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246209eb8adf99bcdde38a9c2f380fee?s=128&d=identicon&r=PG&f=1", "display_name": "wuppie367", "link": "https://stackoverflow.com/users/5534308/wuppie367"}, "edited": false, "score": 0, "creation_date": 1498685831, "post_id": 44812726, "comment_id": 76606503, "body": "I&#39;m not sure what you mean with &quot;initialize an object with list&quot;. Do you mean the std::list object? If your question is just how to initialize an object, you can create an object on the stack using <code>TestClass obj(1,2);</code> in your example. If you want to create it on the heap you can use <code>TestClass* obj = new TestClass(1,2);</code>. Don&#39;t forget to <code>delete obj;</code> when you are done using the object."}, {"owner": {"reputation": 389, "user_id": 6586313, "user_type": "registered", "accept_rate": 31, "profile_image": "https://lh3.googleusercontent.com/-xrP8eHXD3FQ/AAAAAAAAAAI/AAAAAAAAAao/TvUMR0_6eoA/photo.jpg?sz=128", "display_name": "Mohammad Roohitavaf", "link": "https://stackoverflow.com/users/6586313/mohammad-roohitavaf"}, "edited": false, "score": 4, "creation_date": 1498685905, "post_id": 44812726, "comment_id": 76606536, "body": "it is aggregate initialization, not list initialization. I found it here : <a href=\"http://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/aggregate_initialization</a>  Thanks"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498686660, "post_id": 44812726, "comment_id": 76606854, "body": "Also keep an eye out for the term &quot;Uniform Initialization&quot;"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 313, "user_id": 5534308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246209eb8adf99bcdde38a9c2f380fee?s=128&d=identicon&r=PG&f=1", "display_name": "wuppie367", "link": "https://stackoverflow.com/users/5534308/wuppie367"}, "edited": false, "score": 0, "creation_date": 1498686736, "post_id": 44812726, "comment_id": 76606894, "body": "@wuppie367 errm... <a href=\"http://ideone.com/BQAcxT\" rel=\"nofollow noreferrer\">no</a>, not unless you provide the appropriate constructor"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1498775797, "post_id": 44812726, "comment_id": 76652583, "body": "@MohammadRoohitavaf it is list initialization; the aggregate initialization is a possible subset of list initialization behaviour"}], "answers": [{"tags": [], "owner": {"reputation": 393, "user_id": 5874652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qv6Ub.png?s=128&g=1", "display_name": "Lenny Linus", "link": "https://stackoverflow.com/users/5874652/lenny-linus"}, "is_accepted": false, "score": 0, "last_activity_date": 1498697527, "creation_date": 1498697527, "answer_id": 44814692, "question_id": 44812726, "link": "https://stackoverflow.com/questions/44812726/how-to-initialize-an-object-with-list-in-c/44814692#44814692", "title": "How to initialize an object with list in C++?", "body": "<p>So what I've found is that you can initialize anything with that style in C++, as long as that thing is an 'aggregate'. Now! What is an aggregate?? Well that kind of depends upon what C++ standard - C++11, C++14, etc... - are we talking about. This is discussed eloquently in the answer to <a href=\"https://stackoverflow.com/questions/27118535/c11-aggregate-initialization-for-classes-with-non-static-member-initializers\">C++11 aggregate initialization for classes with non-static member initializers</a>. I really hope this helps. </p>\n"}, {"comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1498698735, "post_id": 44814751, "comment_id": 76610093, "body": "None of this is necessary. The original post&#39;s code compiles fine without any constructors at all."}, {"owner": {"reputation": 5646, "user_id": 4992422, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e408ee3d89df9b7865442e5387ef856c?s=128&d=identicon&r=PG&f=1", "display_name": "PYA", "link": "https://stackoverflow.com/users/4992422/pya"}, "edited": false, "score": 0, "creation_date": 1498699919, "post_id": 44814751, "comment_id": 76610338, "body": "Thank you for the great answer!"}], "tags": [], "owner": {"reputation": 1726, "user_id": 1429658, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fecbd8a5bea71e1103c82bcc4eb16237?s=128&d=identicon&r=PG", "display_name": "Litty", "link": "https://stackoverflow.com/users/1429658/litty"}, "is_accepted": false, "score": 0, "last_activity_date": 1498697959, "creation_date": 1498697959, "answer_id": 44814751, "question_id": 44812726, "link": "https://stackoverflow.com/questions/44812726/how-to-initialize-an-object-with-list-in-c/44814751#44814751", "title": "How to initialize an object with list in C++?", "body": "<p>First, consider basic construction. It sounds like you just want to create a new <code>TestClass</code> and specify its initial values on-the-fly.</p>\n\n<p>You can do this by using a constructor:</p>\n\n<pre><code>/**\n * TestClass.hpp\n */\nclass TestClass\n{\npublic:\n    int a;\n    int b;\n\n    TestClass(int aInitial, int bInitial);\n};\n\n/**\n * TestClass.cpp\n */\nTestClass::TestClass(int aInitial, int bInitial)\n: a(aInitial),\n  b(bInitial)\n{\n\n}\n\n// ... which is the same as...\nTestClass::TestClass(int aInitial, int bInitial)\n{\n    this-&gt;a = aInitial;\n    this-&gt;b = bInitial;\n}\n\n/**\n * SomewhereElse.cpp\n */\n...\nTestClass foobar(1, 2);\nstd::cout &lt;&lt; foobar.a &lt;&lt; std::endl; // 1\nstd::cout &lt;&lt; foobar.b &lt;&lt; std::endl; // 2\n...\n</code></pre>\n\n<p>But let's assume you already considered that and you actually <em>do</em> need to use list initialization. The answer is actually on that <a href=\"http://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">page you mentioned,</a> let's expand on it.</p>\n\n<p>When you want to write something like this with a custom class...</p>\n\n<p><code>TestClass foobar = { 1, 2 };</code></p>\n\n<p>It requires some manual work first. There's no magic that will automatically assign the 0th index to your first member and the 1st index to your second member.</p>\n\n<p>The compiler requires an assignment operator or constructor that accepts an <a href=\"http://en.cppreference.com/w/cpp/utility/initializer_list\" rel=\"nofollow noreferrer\">std::initializer_list</a>:</p>\n\n<pre><code>/**\n * TestClass.hpp\n */\nclass TestClass\n{\npublic:\n    int a;\n    int b;\n\n    TestClass(std::initializer_list&lt;int&gt; list); \n};\n\n/**\n * TestClass.cpp\n */\nTestClass::TestClass(std::initializer_list&lt;int&gt; list)\n{\n    if (list.size() != 2) {\n        // Throw an error or set some defaults\n    }\n\n    int i = 0;\n    for (int value : list) {\n        if (i == 0) {\n            this-&gt;a = value;\n        } else {\n            this-&gt;b = value;\n        }\n\n        i++;\n    }\n}\n</code></pre>\n\n<p>This will do what you're expecting it to do. But that constructor is pretty funky, isn't it? We have to do that weird <code>for</code> loop because <code>std::initializer_list</code> doesn't offer indexed access to its values (In other words, you can't do <code>list[0]</code> or <code>list[1]</code>).</p>\n\n<p>You can make this easier to read by accepting a <code>std::vector</code> (or another kind of container like <code>std::array</code>, <code>std::list</code>, so on) in the constructor.</p>\n\n<p>This works because an <code>std::initializer_list</code> is accepted as a constructor in <em>those</em> containers, and an implicit conversion can be performed:</p>\n\n<pre><code>/**\n * TestClass.hpp\n */\nclass TestClass\n{\n    int a;\n    int b;\n\n    TestClass(std::vector&lt;int&gt; values);\n};\n\n/**\n * TestClass.cpp\n */\nTestClass::TestClass(std::vector&lt;int&gt; values)\n{\n    if (values.size() != 2) {\n        // Throw an error or set some defaults\n    }\n\n    this-&gt;a = values[0];\n    this-&gt;b = values[1];\n}\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 6586313, "user_type": "registered", "accept_rate": 31, "profile_image": "https://lh3.googleusercontent.com/-xrP8eHXD3FQ/AAAAAAAAAAI/AAAAAAAAAao/TvUMR0_6eoA/photo.jpg?sz=128", "display_name": "Mohammad Roohitavaf", "link": "https://stackoverflow.com/users/6586313/mohammad-roohitavaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1498774464, "creation_date": 1498684858, "last_edit_date": 1498774464, "question_id": 44812726, "link": "https://stackoverflow.com/questions/44812726/how-to-initialize-an-object-with-list-in-c", "title": "How to initialize an object with list in C++?", "body": "<p>Sorry if this is a basic question, but I couldn't find the answer. My question is where can I find some documentation for how we can initialize an object using list. Like the following? </p>\n\n<pre><code>class TestClass {\npublic:\n    int a;\n    int b;\n};\n</code></pre>\n\n<p>Then initialize an object: </p>\n\n<pre><code>TestClass obj = TestClass{ 1, 2};\n    cout &lt;&lt; obj.a &lt;&lt; \" \" &lt;&lt; obj.b &lt;&lt; endl;\n</code></pre>\n\n<p>I only found <a href=\"http://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\">this</a> page.</p>\n\n<p>It seems it is method (2), but nothing is mentioned that what are the rules. For example, a,b,... must be public? I tried if add a private int c after them it does not work. For struct, I understand, my question is about class. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "string", "volatile"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1498685138, "post_id": 44812722, "comment_id": 76606210, "body": "const and volatile? Does it make sense?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498685186, "post_id": 44812722, "comment_id": 76606244, "body": "I didn&#39;t think so however there is a thread here about that: <a href=\"https://stackoverflow.com/questions/16259939/const-volatile-register-volatile-static-volatile-in-c\" title=\"const volatile register volatile static volatile in c\">stackoverflow.com/questions/16259939/&hellip;</a>"}, {"owner": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "edited": false, "score": 0, "creation_date": 1498685829, "post_id": 44812722, "comment_id": 76606502, "body": "I&#39;m just trying some process memory editing software and came accross this problem."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1498685973, "post_id": 44812722, "comment_id": 76606565, "body": "<a href=\"http://coliru.stacked-crooked.com/a/3c72b302c0552fe5\" rel=\"nofollow noreferrer\">Interesting</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498685995, "post_id": 44812722, "comment_id": 76606576, "body": "<code>const</code> and <code>volatile</code> on a string literal I&#39;ve never seen, but I have seen read-only hardware registers declared <code>const volatile</code>."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1498686500, "post_id": 44812722, "comment_id": 76606791, "body": "@user4581301 -- the const and volatile are <b>not</b> on the string literal. They&#39;re on the pointer."}, {"owner": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1498687941, "post_id": 44812722, "comment_id": 76607376, "body": "@PeteBecker No, it&#39;s a const pointer pointing to a const volatile char."}, {"owner": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "edited": false, "score": 1, "creation_date": 1498688082, "post_id": 44812722, "comment_id": 76607422, "body": "@manni66 This replicates a variable which may be altered by other sources, but from the point of view of the program, it has a constant value and address."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1498689038, "post_id": 44812722, "comment_id": 76607743, "body": "@Garmekain - whoops, that was sloppy of me. But my main point was  that the const and volatile are not on the string literal"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498690123, "post_id": 44812722, "comment_id": 76608083, "body": "Yup. That&#39;s me being lazy."}, {"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1498729753, "post_id": 44812722, "comment_id": 76623441, "body": "By the way, the <code>const_cast</code> could be a really bad idea assuming the <code>volatile</code> is there for a reason. A safer way would be to manually copy the <code>const volatile</code> string into a temporary <code>char</code> array (possibly a <code>std::string</code>) before outputting it."}, {"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1498730329, "post_id": 44812722, "comment_id": 76623858, "body": "@manni66: Assume you have a <code>struct DeviceDescr</code> that contains a <code>char vendorName[16]</code> and instances of this struct are in device memory,  read-only outside of the device, so one might access them through a <code>const volatile struct DeviceDescr *d</code>. Now, <code>d-&gt;vendorName</code>&#39;s type decays to <code>const volatile char *</code>. This may be slightly contrived (I&#39;m not an embedded dev), but you get the idea."}], "answers": [{"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1498686066, "post_id": 44812948, "comment_id": 76606610, "body": "The conversion is pointer --&gt; bool; null pointer is false, any other value is true."}], "tags": [], "owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "is_accepted": true, "score": 13, "last_activity_date": 1498688846, "last_edit_date": 1498688846, "creation_date": 1498685811, "answer_id": 44812948, "question_id": 44812722, "link": "https://stackoverflow.com/questions/44812722/const-volatile-char-string-not-printing-properly/44812948#44812948", "title": "const volatile char string not printing properly", "body": "<p>You got nuked by <a href=\"http://eel.is/c++draft/over.best.ics\" rel=\"noreferrer\">Implicit conversion Sequences (ICS)</a>. The C++ <code>std::ostream</code> facilities have no overloads for <code>volatile</code> types. ICS kicks in, and selects the overload for <code>bool</code> type (because pointer types, irrespective of cv qualifications are implicitly convertible to <code>bool</code>). </p>\n\n<p>Hence you see <code>1</code>... Change your output to <code>std::boolalpha</code> and you should see <code>true</code> instead.</p>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\nint main(){\n    const volatile char* const str = \"ABCDEFGHIJKL\";\n    std::cout &lt;&lt; '\\r' &lt;&lt; str;\n    std::cout &lt;&lt; '\\r' &lt;&lt; std::boolalpha &lt;&lt; str;\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>1\ntrue\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/866f8d0d31fb6bc3\" rel=\"noreferrer\"><strong>Demo</strong></a></p>\n"}], "owner": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 2, "accepted_answer_id": 44812948, "answer_count": 1, "score": 7, "last_activity_date": 1498688846, "creation_date": 1498684838, "question_id": 44812722, "link": "https://stackoverflow.com/questions/44812722/const-volatile-char-string-not-printing-properly", "title": "const volatile char string not printing properly", "body": "<p>I have a very simple program which just outputs indefinitely a const pointer pointing to a const volatile char; it goes like this:</p>\n\n<pre><code>const volatile char* const str = \"ABCDEFGHIJKL\";\n\nwhile(true) {\n    cout &lt;&lt; '\\r' &lt;&lt; str;\n}\n</code></pre>\n\n<p>The problem is that when running this program, the output is 1. There is a way to get around this, which is outputting <code>const_cast&lt;char*&gt;(str)</code> instead of <code>str</code>.</p>\n\n<p>But if I do <code>const_cast&lt;volatile char*&gt;(str)</code> the output is 1, just like before the cast, so I'm guessing the 1 output is caused by the <code>volatile</code> keyword, which is strange because I thought that volatile only makes the compiler avoid optimizations in that variable, which shouldn't change the value of it.</p>\n\n<p>My question, therefore, is how in the world did that 1 came as the output.</p>\n\n<p>NOTE:</p>\n\n<p>I've tried compiling it with GCC in Ubuntu 16.04, and with MinGW in Windows 7, so the compiler is not the problem(I guess).</p>\n"}, {"tags": ["c++", "android-ndk", "logcat"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1498687734, "post_id": 44812689, "comment_id": 76607295, "body": "What&#39;s at <code>C:&#47;Users&#47;HelloWorld&#47;Desktop&#47;NewbieGame&#47;app&#47;src&#47;main&#47;jni&#47;src&#47;&zwnj;&#8203;Game.cpp:365</code> ?  Looks like it is doing a <code>==</code> test between a <code>std::string</code> and a <code>char const *</code>."}, {"owner": {"reputation": 15, "user_id": 1383215, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5d6472471bb51f80f01f5d2d77c5b5?s=128&d=identicon&r=PG", "display_name": "LegItJoe", "link": "https://stackoverflow.com/users/1383215/legitjoe"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1498743860, "post_id": 44812689, "comment_id": 76633942, "body": "I recompiled my code and this time included -Werror -Wall which changed all of my warnings to errors. I then cleaned up the errors in the source code. The game seems alot more stable now, and crashes alot less and less randomly so far. I&#39;m now only gettting a SIGBUS error."}], "owner": {"reputation": 15, "user_id": 1383215, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5d6472471bb51f80f01f5d2d77c5b5?s=128&d=identicon&r=PG", "display_name": "LegItJoe", "link": "https://stackoverflow.com/users/1383215/legitjoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498687062, "creation_date": 1498684688, "last_edit_date": 1498687062, "question_id": 44812689, "link": "https://stackoverflow.com/questions/44812689/deciphering-an-adb-logcat", "title": "Deciphering an adb logcat", "body": "<p>My android game keeps crashing intermittently. I am having trouble pinpointing what the cause is. The crash seems to happen at random during active game play. I use the SDLActivity java file to interface with SDL. Here are the results of a ndk-stack trace that I ran.</p>\n\n<pre><code>********** Crash dump: **********\nBuild fingerprint: 'Huawei/SCL-L01/hwSCL-Q:5.1.1/HuaweiSCL-\nL01/C432B160:user/release-keys'\npid: 28222, tid: 28261, name: SDLThread  &gt;&gt;&gt; com.example.proj &lt;&lt;&lt;\nsignal 11 (SIGSEGV), code 0 (SI_USER), fault addr 0x53b\nStack frame I/DEBUG   (  330):\n     #00 pc 0002af24  /data/app/com.example.proj-1/lib/arm/libmain.so\n     (Game::Render()+6387): Routine Game::distribute() at C:/Users/HelloWorld/Desktop/NewbieGame/app/src/main/jni/src/Game.cpp:365\n\nStack frame I/DEBUG   (  330):\n     #01 pc 000413a9  /data/app/com.example.proj-1/lib/arm/libmain.so\n     (Game::Event(SDL_Event*, unsigned int)+328):\n     Routine bool std::__ndk1::operator==&lt;char, std::__ndk1::char_traits&lt;char&gt;,\n                  std::__ndk1::allocator&lt;char&gt; &gt;(std::__ndk1::basic_string&lt;char,\n                  std::__ndk1::char_traits&lt;char&gt;, std::__ndk1::allocator&lt;char&gt; &gt; const&amp;, char const*)\n                  at D:/ndk/build//../sources/cxx-stl/llvm-libc++/include/string:3854\n\nStack frame I/DEBUG   (  330):\n     #02 pc 0001379f \n     /data/app/com.example.proj-1/lib/arm/libmain.so\n     (SDL_main+954): Routine $a at libgcc2.c:?\n\nStack frame I/DEBUG   (  330): \n    #03 pc 0001326f  /data/app/com.example.proj-1/lib/arm/libmain.so \n    (Java_org_libsdl_app_SDLActivity_nativeInit+422): Routine $a at libgcc2.c:?\n\nTerminate batch job (Y/N)? \n</code></pre>\n\n<p>I can hardly make sense of what this logcat means. I've been to the files reported by the logcat and see nothing that causes the crashes. Is anybody able to explain what exactly these log messages might mean?</p>\n"}, {"tags": ["c#", "c++", "winapi"], "comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1498685117, "post_id": 44812676, "comment_id": 76606194, "body": "Look up the <code>PerformanceCounter</code> class"}, {"owner": {"reputation": 904, "user_id": 1607797, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5e98d94c7ff9f3b593fc5e3f074a2ebe?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1607797/aaron"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1498685222, "post_id": 44812676, "comment_id": 76606261, "body": "PerformanceCounter will only give you values from between the last call to  to get the values right? So if other programs are using it also wouldn&#39;t that mess each other&#39;s readings up?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1498685263, "post_id": 44812676, "comment_id": 76606285, "body": "<i>&quot;Is it possible to access from my C# project?&quot;</i> - The link you provided points out, that the application calling this code requires .NET 2.0. So presumably that is possible. Anyway, this is a pretty poor question. It asks whether a tiny set of Windows API calls can be used from .NET, instead of asking the generic question: Can I call a native C API from managed .NET code? And the answer is: Yes. P/Invoke is probably the most straight forward way to do so."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1498685573, "post_id": 44812676, "comment_id": 76606414, "body": "No, each Performance counter object is independent. You could even have 2 in the same program and they would not interfere with each other"}], "owner": {"reputation": 904, "user_id": 1607797, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5e98d94c7ff9f3b593fc5e3f074a2ebe?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1607797/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498684990, "creation_date": 1498684625, "last_edit_date": 1498684990, "question_id": 44812676, "link": "https://stackoverflow.com/questions/44812676/how-to-determine-overall-cpu-usage-in-windows", "title": "How to determine overall CPU Usage in Windows", "body": "<p>I'm working on developing a distributed network program that needs to be able to determine how active a computer is. </p>\n\n<p>I've found the following example at <a href=\"https://weblogs.asp.net/kennykerr/balance-cpu-1-0\" rel=\"nofollow noreferrer\">https://weblogs.asp.net/kennykerr/balance-cpu-1-0</a> that I believe will give me what I want.</p>\n\n<pre><code>SYSTEM_INFO info = { 0 };\n::GetSystemInfo(&amp;info);\n\nCAtlArray&lt;ULONG64&gt; procs;\nVERIFY(procs.SetCount(info.dwNumberOfProcessors));\n\nULONG size = info.dwNumberOfProcessors * sizeof(ULONG64);\n\nVERIFY(::QueryIdleProcessorCycleTime(&amp;size,\n                                     procs.GetData()));\n\nfor (size_t index = 0; index &lt; procs.GetCount(); ++index)\n{\n    ULONG64 idleCycles = procs[index];\n    cout &lt;&lt; \"Processor \" &lt;&lt; index &lt;&lt; \": \" &lt;&lt; idleCycles &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Is it possible to access from my C# project?</p>\n"}, {"tags": ["c++", "qt", "zip", "qbytearray"], "comments": [{"owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "edited": false, "score": 1, "creation_date": 1498685221, "post_id": 44812640, "comment_id": 76606259, "body": "This is about some 3rd party libraries and not Qt but related to Qt. I doubt that is the right question here. Anyway: <a href=\"http://cep.xray.aps.anl.gov/software/qt4-x11-4.8.6-browser/d7/df4/class_q_zip_reader.html#adc03c6db73107d9e7b729e7b64a2236b\" rel=\"nofollow noreferrer\">cep.xray.aps.anl.gov/software/qt4-x11-4.8.6-browser/d7/df4/&hellip;</a>"}, {"owner": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1498686233, "post_id": 44812640, "comment_id": 76606682, "body": "It is not clear to me what you are actually looking for. It may be useful to show what you have already done (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}, {"owner": {"reputation": 1, "user_id": 7343422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xWUS95G8N5E/AAAAAAAAAAI/AAAAAAAAFZg/ZPVdNtbSe8M/photo.jpg?sz=128", "display_name": "TheVicMil", "link": "https://stackoverflow.com/users/7343422/thevicmil"}, "edited": false, "score": 0, "creation_date": 1498686684, "post_id": 44812640, "comment_id": 76606865, "body": "Initially, I have a QbyteArray (not a file!) \u0441ontaining a ZIP archive. I need to expand the data and transfer it again to QByteArray (not to the file!)"}, {"owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "edited": false, "score": 0, "creation_date": 1498696887, "post_id": 44812640, "comment_id": 76609709, "body": "Take that opensource library and add own method?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7343422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xWUS95G8N5E/AAAAAAAAAAI/AAAAAAAAFZg/ZPVdNtbSe8M/photo.jpg?sz=128", "display_name": "TheVicMil", "link": "https://stackoverflow.com/users/7343422/thevicmil"}, "edited": false, "score": 0, "creation_date": 1498727356, "post_id": 44819738, "comment_id": 76621771, "body": "Felix, yes, you are right! I want to unzip all parts of zip file - all files which starts with \\x504b0304 - local file header into qbytearray. Thank you!"}], "tags": [], "owner": {"reputation": 6147, "user_id": 3767076, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/64707b213de57fb785081ba23aaea2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/3767076/felix"}, "is_accepted": false, "score": 0, "last_activity_date": 1498724184, "creation_date": 1498724184, "answer_id": 44819738, "question_id": 44812640, "link": "https://stackoverflow.com/questions/44812640/extract-zip-into-qbytearray/44819738#44819738", "title": "Extract ZIP into QByteArray", "body": "<p>You cannot simply \"unzip\" into a bytearray, because zip (unlike plain gz) contains multiple files and folders, and not just a data stream. How would you seperate those in a single bytearray?</p>\n\n<p>What you can do, is extract each file (or a single file, if your archive only contains one) inside the archive.<a href=\"http://quazip.sourceforge.net/classQuaZipFile.html\" rel=\"nofollow noreferrer\"><code>QuaZipFile</code></a> inherits <a href=\"https://doc.qt.io/qt-5/qiodevice.html\" rel=\"nofollow noreferrer\"><code>QIODevice</code></a>. This means, you could simply interate over the archive and extract every file in it, and use <code>quaZipFile.readAll();</code> to get the data as bytearray. This would give you one bytearray per file inside the zip archive.</p>\n"}], "owner": {"reputation": 1, "user_id": 7343422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xWUS95G8N5E/AAAAAAAAAAI/AAAAAAAAFZg/ZPVdNtbSe8M/photo.jpg?sz=128", "display_name": "TheVicMil", "link": "https://stackoverflow.com/users/7343422/thevicmil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 606, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498724184, "creation_date": 1498684429, "last_edit_date": 1498721337, "question_id": 44812640, "link": "https://stackoverflow.com/questions/44812640/extract-zip-into-qbytearray", "title": "Extract ZIP into QByteArray", "body": "<p>How to unzip ZIP-archive into <code>QByteArray</code> (C++ Qt)?\nI tried to unzip use <code>QuaZip</code> and <code>QZipReader</code> - all of this methods needs to extract ZIP data into some file destination (must be <code>QString</code> - destination path). \nThank`s to all, who read this question.</p>\n"}, {"tags": ["android", "c++", "react-native", "android-ndk", "react-native-android"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4946725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-_cN7iEDdpYY/AAAAAAAAAAI/AAAAAAAAAD8/6MDk29MPGfk/photo.jpg?sz=128", "display_name": "Reddy", "link": "https://stackoverflow.com/users/4946725/reddy"}, "edited": false, "score": 0, "creation_date": 1498687515, "post_id": 44812881, "comment_id": 76607221, "body": "As per my understanding its not possible or its big task if I want to use same lib for both (react-native and myapp). Myapp is huge and was used on different platforms and for android its well maintained using android ndk 13b. But React-native only supports NDK 10e version. Do you see any possibility there to use same lib?"}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "reply_to_user": {"reputation": 37, "user_id": 4946725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-_cN7iEDdpYY/AAAAAAAAAAI/AAAAAAAAAD8/6MDk29MPGfk/photo.jpg?sz=128", "display_name": "Reddy", "link": "https://stackoverflow.com/users/4946725/reddy"}, "edited": false, "score": 0, "creation_date": 1498687949, "post_id": 44812881, "comment_id": 76607380, "body": "@Reddy Why should it be impossible? The only way is to choose final version and rebuild inconsistent module using it. What version will you choose and how to rebuild code is completely up to you."}, {"owner": {"reputation": 37, "user_id": 4946725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-_cN7iEDdpYY/AAAAAAAAAAI/AAAAAAAAAD8/6MDk29MPGfk/photo.jpg?sz=128", "display_name": "Reddy", "link": "https://stackoverflow.com/users/4946725/reddy"}, "edited": false, "score": 0, "creation_date": 1498688437, "post_id": 44812881, "comment_id": 76607542, "body": "React-Native says they only support default android NDK which is 10e to build react-native. If I build react-native source with 13b and if its success also there is no possibility that it will work well (few posts suggest some issues). For my app which was built and developed using 13b NDK (its a c++ app just contain native methods to interact). Compiling it downgrading to 10e might not be right path (tried and got some compilation issues). You are right its not impossible but kind of big task as I am just trying to evaluate using React-Native for my app."}, {"owner": {"reputation": 37, "user_id": 4946725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-_cN7iEDdpYY/AAAAAAAAAAI/AAAAAAAAAD8/6MDk29MPGfk/photo.jpg?sz=128", "display_name": "Reddy", "link": "https://stackoverflow.com/users/4946725/reddy"}, "edited": false, "score": 0, "creation_date": 1498769426, "post_id": 44812881, "comment_id": 76650089, "body": "Using two different versions one static for my app leaving the react-native one as it is resolved the issue. As of now things are smooth -Thanks"}], "tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": true, "score": 1, "last_activity_date": 1498685534, "creation_date": 1498685534, "answer_id": 44812881, "question_id": 44812614, "link": "https://stackoverflow.com/questions/44812614/react-native-android-ndk/44812881#44812881", "title": "React-Native android NDK", "body": "<p>The most correct way would be to refer the same version of library across all of the application. But if it is impossible - you may link one module against static version of library while leaving the second one linked against shared as usual.</p>\n\n<p>But such approach is rather a workaround than a real solution. Because there are at least next downsides:</p>\n\n<ul>\n<li>app size bloates because now you are deploying code for two versions of library instead of one</li>\n<li>objects of the same classes in different library versions may be binary incompatible - so if you try to pass c++ objects between code that relies on different lib version - it ends up with undefined behavior.</li>\n</ul>\n\n<p>At the end: I'd think twice if there is really no way to use the same version everywhere.  </p>\n"}], "owner": {"reputation": 37, "user_id": 4946725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-_cN7iEDdpYY/AAAAAAAAAAI/AAAAAAAAAD8/6MDk29MPGfk/photo.jpg?sz=128", "display_name": "Reddy", "link": "https://stackoverflow.com/users/4946725/reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 0, "accepted_answer_id": 44812881, "answer_count": 1, "score": 1, "last_activity_date": 1498685534, "creation_date": 1498684269, "question_id": 44812614, "link": "https://stackoverflow.com/questions/44812614/react-native-android-ndk", "title": "React-Native android NDK", "body": "<p>App middle native Player(C++) build with NDK 13b version and uses libgnustl-shared.so build with it. React native uses different version of NDK and libgnustl-shared.so comes with it(NDK 10e version) has conflicting with the one I use for my middleware libs. Is there a way I can resolve this? the lib used for app is not accepted by react-native and react-native based lib is not compatible with my middleware libs. I can not downgrade on the NDK used for my native app (to 10e supported for react-native). Any help is appreciated. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498683495, "post_id": 44812405, "comment_id": 76605468, "body": "<b><i>Codeblocks and Clion</i></b> Probably the same compiler used for these 2 different IDEs."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498683656, "post_id": 44812405, "comment_id": 76605543, "body": "<b><i>Would deleting all my ide&#39;s and reinstalling help?</i></b> I don&#39;t think so. Maybe reinstall your compiler instead. Although it is unusual to me that that your toolchain could be broken in this way."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1498683694, "post_id": 44812405, "comment_id": 76605560, "body": "Show the error message."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1498683801, "post_id": 44812405, "comment_id": 76605604, "body": "Also remove any code that isn&#39;t necessary to reproduce the error."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498683835, "post_id": 44812405, "comment_id": 76605624, "body": "BTW, the code works fine on ideone. <a href=\"http://ideone.com/s5XbLs\" rel=\"nofollow noreferrer\">ideone.com/s5XbLs</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1498683957, "post_id": 44812405, "comment_id": 76605681, "body": "Compile and link the code from the command line."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1498684227, "post_id": 44812405, "comment_id": 76605802, "body": "well the error messages says that iostream already included ctime. sounds like ctime doesnt have a guard on it (or time.h)."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1498684647, "post_id": 44812405, "comment_id": 76605964, "body": "Apparently there are two definitions of <code>struct TM</code>: one in time.h (at line 172), an one in wchar.h (at line 87). That&#39;s definitely a compiler problem, but I don&#39;t know enough about your tool chain to tell you what to do. It might be a problem with the installation, or it could be some funky compiler switch."}, {"owner": {"reputation": 353, "user_id": 7078609, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10154665168592258/picture?type=large", "display_name": "Kelvin Davis", "link": "https://stackoverflow.com/users/7078609/kelvin-davis"}, "edited": false, "score": 0, "creation_date": 1498684704, "post_id": 44812405, "comment_id": 76605985, "body": "hmmm okie dokie, ill try reinstalling the compiler etc. Thanks"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498755826, "post_id": 44812405, "comment_id": 76642596, "body": "Did reinstalling the (or upgrading) compiler fix the issue?"}, {"owner": {"reputation": 353, "user_id": 7078609, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10154665168592258/picture?type=large", "display_name": "Kelvin Davis", "link": "https://stackoverflow.com/users/7078609/kelvin-davis"}, "edited": false, "score": 0, "creation_date": 1498779853, "post_id": 44812405, "comment_id": 76653721, "body": "No it didnt, I only reinstalled it. It worked fine on my virtual machine though."}], "owner": {"reputation": 353, "user_id": 7078609, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10154665168592258/picture?type=large", "display_name": "Kelvin Davis", "link": "https://stackoverflow.com/users/7078609/kelvin-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498683971, "creation_date": 1498683344, "last_edit_date": 1498683971, "question_id": 44812405, "link": "https://stackoverflow.com/questions/44812405/unable-to-include-ctime-without-redefinition-of-struct-tm-error", "title": "Unable to include &lt;ctime&gt; without redefinition of struct TM error", "body": "<p>I've tried the code on Codeblocks and Clion and I'm still getting a redefinition of struct tm error. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt; // Needed for the true randomization\n#include &lt;cstdlib&gt;\nusing namespace std;\n\nint main ()\n{\n    int xRan;\n    srand( time(0)); // This will ensure a really randomized number by help of time.\n\n    xRan=rand()%15+1; // Randomizing the number between 1-15.\n    cout &lt;&lt; \"Shows a random number between 1-15: \" &lt;&lt; xRan;\n\n    return 0;\n}\n\nWhen ever I use the library I get the error. Not sure if theres something \n</code></pre>\n\n<p>buggy in the minigw include folder or what. Would deleting all my ide's and reinstalling help? Any ideas maybe why?</p>\n\n<pre><code>In file included from c:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\ctime:42:0,\n</code></pre>\n\n<p>from C:\\Users\\Kelvindavis\\CLionProjects\\untitled\\main.cpp:2:\nc:\\mingw\\include\\time.h:172:8: error: redefinition of 'struct tm'\nstruct tm\n        ^\n    In file included from \n    c:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\cwchar:44:0,\n                 from \n    c:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\bits\\postypes.h:40,\n    from c:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\iosfwd:40,\n    from c:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\ios:38,\n    from c:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\ostream:38from \n    c:\\mingw\\lib\\gcc\\mingw32\\5.3.0\\include\\c++\\iostream:39from \n    C:\\Users\\Kelvindavis\\CLionProjects\\untitled\\main.cpp:1:\n    c:\\mingw\\include\\wchar.h:87:8: error: previous definition of 'struct tm'\n    struct tm {\n        ^\n    mingw32-make.exe[3]: <strong>* [CMakeFiles/untitled.dir/main.cpp.obj] Error 1\n    CMakeFiles\\untitled.dir\\build.make:61: recipe for target \n    'CMakeFiles/untitled.dir/main.cpp.obj' failed\n    CMakeFiles\\Makefile2:66: recipe for target 'CMakeFiles/untitled.dir/all' \n    failed\n    CMakeFiles\\Makefile2:78: recipe for target 'CMakeFiles/untitled.dir/rule' \n    failed\n    mingw32-make.exe[2]: <em></strong> [CMakeFiles/untitled.dir/all] Error 2\n    mingw32-make.exe[1]: <strong></em> [CMakeFiles/untitled.dir/rule] Error 2\n    mingw32-make.exe: *</strong> [untitled] Error 2\n    Makefile:117: recipe for target 'untitled' failed</p>\n"}, {"tags": ["c++", "macos", "qt", "macos-sierra"], "comments": [{"owner": {"reputation": 768, "user_id": 7419656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/232d47a20e2ca36fd17ca7833c513f3d?s=128&d=identicon&r=PG&f=1", "display_name": "Ssswift", "link": "https://stackoverflow.com/users/7419656/ssswift"}, "edited": false, "score": 0, "creation_date": 1498704285, "post_id": 44812328, "comment_id": 76611318, "body": "I&#39;m not familiar with Qt Creator, but you should never assume an application&#39;s working directory is any particular value, especially on the Mac.  If you want a bundle-relative path, use the NSBundle API."}], "answers": [{"tags": [], "owner": {"reputation": 169, "user_id": 6198510, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e78469b096dbbb67b135530434d4d97?s=128&d=identicon&r=PG&f=1", "display_name": "Assoluto", "link": "https://stackoverflow.com/users/6198510/assoluto"}, "is_accepted": true, "score": 0, "last_activity_date": 1499098182, "creation_date": 1499098182, "answer_id": 44890009, "question_id": 44812328, "link": "https://stackoverflow.com/questions/44812328/qt-macos-correct-working-directory/44890009#44890009", "title": "Qt MacOS - Correct Working Directory?", "body": "<p>I found the source of the issue and it wasn't anything to do with the working directory, but was related to other settings I had changed.  It's unlikely anyone else will have this issue, but I'll explain.  By default Qt Creator uses this directory structure for the builds:</p>\n\n<pre><code>[Build-Directory]-debug/debug - debug build goes here\n[Build-Directory]-debug/release - always empty\n[Build-Directory]-release/debug - always empty\n[Build-Directory]-release/release - release build goes here\n</code></pre>\n\n<p>This seemed silly, so I removed the <code>-%{CurrentBuild:Name}</code> from the default build directory, which made the directory structure more sensible:</p>\n\n<pre><code>[Build-Directory]/debug - debug build goes here\n[Build-Directory]/release - release build goes here\n</code></pre>\n\n<p>On Linux the debug and release sub-directories aren't created by default, so to get the same build directory structure working there I had to add the below line to my .pro file:</p>\n\n<pre><code>CONFIG += debug_and_release debug_and_release_target\n</code></pre>\n\n<p>When I came to build on the Mac it seems these settings caused a lot of issues.  Running and debugging the program didn't work and the icon wasn't being set (<code>ICON = myicon.icns</code> wasn't working).  Reverting to the default build directory (with <code>-%{CurrentBuild:Name}</code> at the end) and removing the line from my .pro file resolved the problems on the Mac.</p>\n\n<p>My autism really cost me a lot of time there.  I just couldn't stand the fact that there were -debug/release and -release/debug directories that were entirely redundant and always empty.  Unfortunately changing the settings ended up making things worse.  I'm going out for chocolate...</p>\n"}], "owner": {"reputation": 169, "user_id": 6198510, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e78469b096dbbb67b135530434d4d97?s=128&d=identicon&r=PG&f=1", "display_name": "Assoluto", "link": "https://stackoverflow.com/users/6198510/assoluto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "accepted_answer_id": 44890009, "answer_count": 1, "score": 1, "last_activity_date": 1499098182, "creation_date": 1498683049, "question_id": 44812328, "link": "https://stackoverflow.com/questions/44812328/qt-macos-correct-working-directory", "title": "Qt MacOS - Correct Working Directory?", "body": "<p>I've never used a Mac before, but I'm building some Qt applications on MacOS 10.12.5 with Qt 5.6.2.  When I ran the application from Qt Creator I got the error:</p>\n\n<pre><code>Failed to start program. Path or permissions wrong?\n</code></pre>\n\n<p>And If I tried to debug I got the error:</p>\n\n<pre><code>Unable to start LLDB \"/Applications/Xcode.app/Contents/Developer/usr/bin/lldb\": No such file or directory\n</code></pre>\n\n<p>After some investigation I found the issue appeared to be with the working directory in the Qt Creator project settings.  If you build directory is:</p>\n\n<pre><code>/Users/username/dev/build-MyApp-Desktop_Qt_5_6_2_clang_64bit-Debug\n</code></pre>\n\n<p>Qt Creator will set the working directory to:</p>\n\n<pre><code>/Users/username/dev/build-MyApp-Desktop_Qt_5_6_2_clang_64bit-Debug/MyApp.app/Contents/MacOS\n</code></pre>\n\n<p>I found that if you change the working directory to be the same as the build directory (as it is in Windows) this resolves the problem, so the program will run and debug without issues.  However, since I'm new to the Mac, I'm worried that this is the wrong thing to do and may create an inappropriate environment for testing.</p>\n\n<p>Is changing the working directory to be the same as the build directory the best solution to this problem, or is there a better solution?</p>\n\n<p>Why is Qt Creator appending /MyApp.app/Contents/MacOS to the working directory when it causes the application not to run?</p>\n"}, {"tags": ["c++", "c++11", "for-loop", "iterator", "operator-overloading"], "comments": [{"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1498682828, "post_id": 44812236, "comment_id": 76605113, "body": "As I read the rest of your question let me start out saying, never include <code>bits&#47;</code> files: They&#39;re non-standard and non-portable among other things. Include the required standard headers instead."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 3, "creation_date": 1498682860, "post_id": 44812236, "comment_id": 76605130, "body": "No, it&#39;s not a proper way to implement an iterator since <code>it != it</code> will usually return <code>true</code>."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1498682862, "post_id": 44812236, "comment_id": 76605132, "body": "That is not a valid iterator. You have to have the typedefs, and a handful of other operators.  Also, as you note, <code>operator!=</code> doesn&#39;t check the <code>other</code> iterator. See <a href=\"https://stackoverflow.com/questions/8054273/how-to-implement-an-stl-style-iterator-and-avoid-common-pitfalls/8054856#8054856\">here</a> for how to make a proper iterator. Looks like you want an <code>input_iterator</code>."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1498682926, "post_id": 44812236, "comment_id": 76605156, "body": "Required reading: <a href=\"http://en.cppreference.com/w/cpp/iterator/istream_iterator\" rel=\"nofollow noreferrer\"><code>std::istream_iterator</code></a>. Especially: &quot;The default-constructed <code>std::istream_iterator</code> is known as the end-of-stream iterator. When a valid <code>std::istream_iterator</code> reaches the end of the underlying stream, it becomes equal to the end-of-stream iterator.&quot;"}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498682951, "post_id": 44812236, "comment_id": 76605170, "body": "You should also generally inherit from <code>std::iterator</code>, as it will generally do some of the work for you."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 2, "creation_date": 1498684440, "post_id": 44812236, "comment_id": 76605888, "body": "@AlexanderHuszagh That&#39;s actually deprecated in C++17, I&#39;m afraid. See for example <a href=\"https://stackoverflow.com/questions/37031805/preparation-for-stditerator-being-deprecated\" title=\"preparation for stditerator being deprecated\">stackoverflow.com/questions/37031805/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/43268146/why-is-stditerator-deprecated\" title=\"why is stditerator deprecated\">stackoverflow.com/questions/43268146/&hellip;</a>"}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "reply_to_user": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1498684670, "post_id": 44812236, "comment_id": 76605971, "body": "@Bob__, well, I guess I&#39;ll be getting carpal tunnel sooner than I expected.... But thanks for the info."}, {"owner": {"reputation": 123, "user_id": 8077208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abd947d159b0e4dee99967fde1025a5?s=128&d=identicon&r=PG", "display_name": "Visitor Iterator", "link": "https://stackoverflow.com/users/8077208/visitor-iterator"}, "reply_to_user": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1498719779, "post_id": 44812236, "comment_id": 76616771, "body": "@MarkB Thanks, good to know. Usually I only use stdc++.h when testing C++ stuff in very small one file programs. I will keep this in mind, and include the appropriate headers next time when posting an example like this."}], "answers": [{"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1498685832, "last_edit_date": 1498685832, "creation_date": 1498684229, "answer_id": 44812602, "question_id": 44812236, "link": "https://stackoverflow.com/questions/44812236/is-this-an-acceptable-way-of-making-an-iterator/44812602#44812602", "title": "Is this an acceptable way of making an iterator?", "body": "<p>The standard template class <code>std::istream_iterator&lt;T&gt;</code> acts as an iterator that reads successive T objects from an istream (with <code>operator&gt;&gt;(istream &amp;, T &amp;)</code>), so all you need is a type T that reads lines from an istream:</p>\n\n<pre><code>class line {\n    std::string line;\n    friend std::istream &amp;operator&gt;&gt;(std::istream &amp;in, line &amp;l) {\n        return std::getline(in, l.line);\n    }\npublic:\n    operator std::string() const { return line; }\n};\n</code></pre>\n\n<p>Now have your <code>LineReader</code> just return a <code>std::istream_iterator&lt;line&gt;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 8077208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abd947d159b0e4dee99967fde1025a5?s=128&d=identicon&r=PG", "display_name": "Visitor Iterator", "link": "https://stackoverflow.com/users/8077208/visitor-iterator"}, "edited": false, "score": 0, "creation_date": 1498754304, "post_id": 44812642, "comment_id": 76641731, "body": "It seems that there is missing some closing parentheses in the istream_range initializer list, which I added and then this solution worked and achieved what I wanted. Naturally I have to cast s explicitly to std::string before feeding it into std::cout. <b>Thank you very much for this explanation.</b>"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 123, "user_id": 8077208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abd947d159b0e4dee99967fde1025a5?s=128&d=identicon&r=PG", "display_name": "Visitor Iterator", "link": "https://stackoverflow.com/users/8077208/visitor-iterator"}, "edited": false, "score": 0, "creation_date": 1498757998, "post_id": 44812642, "comment_id": 76643895, "body": "@VisitorIterator: Thanks for the bug report--I believe I&#39;ve corrected the typos. Glad it&#39;s helpful."}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": true, "score": 3, "last_activity_date": 1498757933, "last_edit_date": 1498757933, "creation_date": 1498684442, "answer_id": 44812642, "question_id": 44812236, "link": "https://stackoverflow.com/questions/44812236/is-this-an-acceptable-way-of-making-an-iterator/44812642#44812642", "title": "Is this an acceptable way of making an iterator?", "body": "<p>I would do this in two parts.</p>\n\n<p>One is a <code>range</code> class that just acts as a wrapper for a stream iterators:</p>\n\n<pre><code>template &lt;class T&gt;\nclass istream_range {\n    std::istream_iterator&lt;T&gt; b;\n    std::istream_iterator&lt;T&gt; e;\npublic:\n    istream_range(std::istream &amp;is)\n        : b(std::istream_iterator&lt;T&gt;(is))\n        , e(std::istream_iterator&lt;T&gt;())\n    {}\n\n    std::istream_iterator&lt;T&gt; begin() { return b; }\n    std::istream_iterator&lt;T&gt; end() { return e; }\n};\n</code></pre>\n\n<p>So this lets use use <code>istream_iterator</code>s in a range-based for loop:</p>\n\n<pre><code>for (auto const &amp;s : istream_range&lt;foo&gt;(myfile))\n    // do something with s\n</code></pre>\n\n<p>An <code>istream_iterator</code> uses <code>operator&gt;&gt;</code> to extract items from the specified file, so the second part is just a tiny type that extracts a line:</p>\n\n<pre><code>class line {\n    std::string data;\npublic:\n    friend std::istream &amp;operator&gt;&gt;(std::istream &amp;is, line &amp;l) {\n        std::getline(is, l.data);\n        return is;\n    }\n    operator std::string() const { return data; }    \n};\n</code></pre>\n\n<p>So, with this our <code>for</code> loop becomes something like:</p>\n\n<pre><code>for (auto const &amp;s : istream_range&lt;line&gt;(myfile))\n    // do something with s\n</code></pre>\n\n<p>The obvious advantage of this is decoupling the two: we can use <code>istream_range&lt;T&gt;</code> to process a file of <code>T</code>, for any <code>T</code> that normal stream extraction does \"the right thing\" (including lots of custom extractors of which we can't currently have any awareness).</p>\n\n<p>There are a few more possibilities covered in the answers to a <a href=\"https://stackoverflow.com/q/1567082/179910\">previous question</a> (including a <code>LineInputIterator</code> that seems to be a little closer to what you're asking for).</p>\n"}], "owner": {"reputation": 123, "user_id": 8077208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abd947d159b0e4dee99967fde1025a5?s=128&d=identicon&r=PG", "display_name": "Visitor Iterator", "link": "https://stackoverflow.com/users/8077208/visitor-iterator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 44812642, "answer_count": 2, "score": 3, "last_activity_date": 1498757933, "creation_date": 1498682645, "question_id": 44812236, "link": "https://stackoverflow.com/questions/44812236/is-this-an-acceptable-way-of-making-an-iterator", "title": "Is this an acceptable way of making an iterator?", "body": "<p>I like the range for-loop in C++, and want to use it like this:</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\n\nint main()\n{\n    for (auto s : LineReader(\"my-very-big-textfile.txt\")) {\n        cout &lt;&lt; s &lt;&lt; endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The purpose here is to iterate through some data (without reading all into a container first). In this case text strings which are lines in a text file. But generally it could be anything (including generated data).</p>\n\n<p>Here LineReader returns an iterable \"pseudo\"-container. And in order for that to work, the for loop needs iterators from the LineReader object. In C++ the range is defined in terms of a begin and end iterator. But I want to use the range for-loop to iterate through data where the end might not be known at start (for example reading line for line in a (excessively big) text file without going through it first to find the end.). </p>\n\n<p>So I define that like this:</p>\n\n<p><em>Disclaimer: Example code showing the principle, so therefore I'm not \"pestering\" it with excessive use of std::, error handling, private/public keywords and so on...</em></p>\n\n<pre><code>struct ReadLineIterator {\n    ifstream ifs;\n    string line;\n\n    ReadLineIterator() { }\n    ReadLineIterator(string filename) : ifs(filename) { }\n\n    bool operator!=(ReadLineIterator&amp; other) {\n        return !ifs.eof();\n    }\n\n    ReadLineIterator&amp; operator++() {\n        getline(ifs, line, '\\n');\n        return *this;\n    }\n    string operator*() {\n        return line;\n    }\n};\n\nstruct LineReader\n{\n    string filename;\n    LineReader(const string&amp; filename) : filename(filename) { }\n\n    ReadLineIterator begin()\n    {\n       return ReadLineIterator(filename);\n    }\n\n    ReadLineIterator end() // return a not used dummy iterator since this method must exist\n    {\n        return ReadLineIterator();\n    }\n};\n</code></pre>\n\n<p>When I run this, it works. But I'm skeptical if</p>\n\n<pre><code>bool operator!=(ReadLineIterator&amp; other) {\n    return !ifs.eof();\n}\n</code></pre>\n\n<p>is a proper way to make this operator to detect the end of the sequence. This because I don't have any proper end object (the end() method just returns a dummy iterator) and comparisons aren't done against it either. Instead I check if the stream is empty.</p>\n\n<p>But I don't see how I could do this in any other way? For now I'm happy with this way of doing it since it works for me, but it would be great to know if there is better ways of doing the same. Also it would be nice to know if this works with all (C++) compilers (I'm using GCC) and if so that it works with future C++ standards where iterators might be handled differently. </p>\n"}, {"tags": ["c++", "xml", "boost"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5073515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/004c4932ce4fedbf9e9e0386d876432d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhisheyk Deb", "link": "https://stackoverflow.com/users/5073515/abhisheyk-deb"}, "edited": false, "score": 0, "creation_date": 1498687032, "post_id": 44813028, "comment_id": 76607020, "body": "Thank you so much for the help."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1498686202, "creation_date": 1498686202, "answer_id": 44813028, "question_id": 44812126, "link": "https://stackoverflow.com/questions/44812126/boost-xml-parser-for-c/44813028#44813028", "title": "Boost XML Parser for c++", "body": "<p>Boost has no XML library. It has a property tree library.</p>\n\n<p>That out of the way, just do exactly the same:</p>\n\n<pre><code>BOOST_FOREACH( ptree::value_type const&amp; a, v ) {\n    if(a.first == \"Argument\") {\n      cout &lt;&lt; \"Argument name : \" &lt;&lt; a.second.get_child(\"&lt;xmlattr&gt;.name\").data() &lt;&lt; endl;\n      cout &lt;&lt; \"Argument type : \" &lt;&lt; a.second.get_child(\"&lt;xmlattr&gt;.type\").data() &lt;&lt; endl;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5073515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/004c4932ce4fedbf9e9e0386d876432d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhisheyk Deb", "link": "https://stackoverflow.com/users/5073515/abhisheyk-deb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 44813028, "answer_count": 1, "score": 1, "last_activity_date": 1498686202, "creation_date": 1498682277, "question_id": 44812126, "link": "https://stackoverflow.com/questions/44812126/boost-xml-parser-for-c", "title": "Boost XML Parser for c++", "body": "<p>I an new to using boost c++ libraries, wanted to use it to parse a xml document, but I am having trouble figuring out the logic. </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;GCC_XML version=\"0.9.0\" cvs_revision=\"1.140\"&gt;\n  &lt;Function id=\"_6\" name=\"A\" returns=\"_12\" context=\"_1\" location=\"f1:1\" file=\"f1\" line=\"1\" mangled=\"_Z1Aif\"&gt;\n    &lt;Argument name=\"a\" type=\"_12\" location=\"f1:1\" file=\"f1\" line=\"1\"/&gt;\n    &lt;Argument name=\"c\" type=\"_13\" location=\"f1:1\" file=\"f1\" line=\"1\"/&gt;\n  &lt;/Function&gt;\n  &lt;Function id=\"_7\" name=\"B\" returns=\"_14\" context=\"_1\" location=\"f1:7\" file=\"f1\" line=\"7\" mangled=\"_Z1Bf\"&gt;\n    &lt;Argument name=\"d\" type=\"_13\" location=\"f1:7\" file=\"f1\" line=\"7\"/&gt;\n  &lt;/Function&gt;\n&lt;/GCC_XML&gt;\n</code></pre>\n\n<p>If I want to access the <strong>Argument</strong> tags for each <strong>function</strong> tag, how should I go about it? I was able to access the <strong>function</strong> tags as follows.</p>\n\n<pre><code>    BOOST_FOREACH( ptree::value_type const&amp; v, pt.get_child(\"GCC_XML\") ) {\n        if(v.first == \"Function\") {\n          cout &lt;&lt; \"Function name : \" &lt;&lt; v.second.get_child(\"&lt;xmlattr&gt;.name\").data() &lt;&lt; endl;\n          cout &lt;&lt; \"Function return type : \" &lt;&lt; v.second.get_child(\"&lt;xmlattr&gt;.returns\").data() &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "operator-overloading", "conversion-operator"], "comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 1, "creation_date": 1498682073, "post_id": 44811966, "comment_id": 76604754, "body": "What is it that is unclear to you?"}, {"owner": {"reputation": 435, "user_id": 6872872, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1125510517515815/picture?type=large", "display_name": "Shivam Arora", "link": "https://stackoverflow.com/users/6872872/shivam-arora"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498682311, "post_id": 44811966, "comment_id": 76604875, "body": "@walter : I am unable to understand how the conversion operator is working and how the value is getting assigned to A&#39;: object. Basically I am unable to understand the flow of code."}], "answers": [{"tags": [], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "is_accepted": false, "score": 0, "last_activity_date": 1498683045, "creation_date": 1498683045, "answer_id": 44812327, "question_id": 44811966, "link": "https://stackoverflow.com/questions/44811966/interconversion-of-objects-of-two-different-classes-using-conversion-operator/44812327#44812327", "title": "Interconversion of objects of two different classes using conversion operator", "body": "<p>The compiler must somehow work out what to do with your <code>g(b)</code>. The only available candidate is <code>void g(A)</code>, so it checks whether it can use that. If there exist a way to legally convert the argument (<code>b</code>) to an <code>A</code> then that is a possibility. Since <code>B</code> has a corresponding conversion operator, this  is indeed the case. In fact, it's the only possibility. So, de facto the call <code>g(b)</code> becomes equivalent to</p>\n\n<pre><code>g(static_cast&lt;A&gt;(b));\n</code></pre>\n\n<p>which explicitly calls the conversion operator.</p>\n"}, {"tags": [], "owner": {"reputation": 2041, "user_id": 7316365, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84de9f27708456d85bf1078aa51155b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vivick", "link": "https://stackoverflow.com/users/7316365/vivick"}, "is_accepted": false, "score": 2, "last_activity_date": 1498683226, "creation_date": 1498683226, "answer_id": 44812367, "question_id": 44811966, "link": "https://stackoverflow.com/questions/44811966/interconversion-of-objects-of-two-different-classes-using-conversion-operator/44812367#44812367", "title": "Interconversion of objects of two different classes using conversion operator", "body": "<p>Here's what's going on :</p>\n\n<ol>\n<li>You create <code>b</code> (type: <code>B</code>)</li>\n<li>You call <code>g</code> passing <code>b</code> as its parameter</li>\n<li><code>b</code> is of type <code>B</code>, <code>g</code> expects a variable of type <code>A</code>, <code>g</code> looks for a way to convert from <code>B</code> to <code>A</code></li>\n<li>Both <code>A</code> and <code>B</code> are classes, <code>B</code> overloads the \"conversion operator\" <code>operator A()</code></li>\n<li>The input of <code>g</code> is automatically converted to <code>b.operatorA()</code> which returns an <code>A</code></li>\n<li><code>g</code> is executed with <code>a</code> being <code>b.operatorA()</code></li>\n<li><code>g</code> calls the method <code>show</code> on <code>a</code></li>\n<li>The end of <code>g</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "is_accepted": false, "score": 1, "last_activity_date": 1498683493, "creation_date": 1498683493, "answer_id": 44812438, "question_id": 44811966, "link": "https://stackoverflow.com/questions/44811966/interconversion-of-objects-of-two-different-classes-using-conversion-operator/44812438#44812438", "title": "Interconversion of objects of two different classes using conversion operator", "body": "<p>In C++, there is such a thing known as <a href=\"http://eel.is/c++draft/over.best.ics\" rel=\"nofollow noreferrer\">Implicit Conversion Sequences</a> during overload resolution. This kicks in all the time in other to select the best viable function to call.</p>\n\n<p>For the case of:</p>\n\n<pre><code>void g(A a)\n{\n    a.show();\n}\n\nint main()\n{\n    B b(10);\n    g(b);\n    ...\n}\n</code></pre>\n\n<p>You have  a User defined conversion sequence there. Since there is no function overload of <code>g</code> that takes in any CV type of <code>b</code>, A Conversion Sequence will be up for ranking. It turns out that <code>A</code> can be constructed from <code>B</code> due the <a href=\"http://eel.is/c++draft/class.conv.fct\" rel=\"nofollow noreferrer\">conversion operator</a> in <code>B</code>. This is used.</p>\n\n<p>Hence the conversion function (operator) in <code>B</code> will be invoked to produce <code>A</code> which is used to initialize the argument in <code>g</code></p>\n\n<hr>\n\n<p>For the case of:</p>\n\n<pre><code>void g(A a)\n{\n    a.show();\n}\n\nint main()\n{\n    B b(10);\n    g(23);\n    ...\n}\n</code></pre>\n\n<p>You have a <a href=\"http://eel.is/c++draft/class.conv#ctor-1\" rel=\"nofollow noreferrer\">converting constructor</a> that is able to construct an object of type <code>A</code> from an <code>int</code></p>\n"}], "owner": {"reputation": 435, "user_id": 6872872, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1125510517515815/picture?type=large", "display_name": "Shivam Arora", "link": "https://stackoverflow.com/users/6872872/shivam-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1498683493, "creation_date": 1498681635, "last_edit_date": 1498682550, "question_id": 44811966, "link": "https://stackoverflow.com/questions/44811966/interconversion-of-objects-of-two-different-classes-using-conversion-operator", "title": "Interconversion of objects of two different classes using conversion operator", "body": "<p>How is the conversion operator defined in class B is working in the following code? I read all other articles related to conversion operators on stack overflow but couldn't find any explanation for the interconversion of objects of two different classes. Any help would be much appreciated as I am new to c++</p>\n\n<p>For the following code:</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\nclass A\n{\n    int i;\npublic:\n    A(int ii = 0) : i(ii) {}\n    void show() {  cout &lt;&lt; i &lt;&lt; endl;  }\n};\n\nclass B\n{\n    int x;\npublic:\n    B(int xx) : x(xx) {}\n    operator A() const {  return A(x); }\n};\n\nvoid g(A a)\n{\n    a.show();\n}\n\nint main()\n{\n    B b(10);\n    g(b);\n    g(20);\n    return 0;\n}\n</code></pre>\n\n<p>I am unable to understand how the conversion operator is working and how the value is getting assigned to A's object. Basically I am unable to understand the flow of code and I want to know behind the scenes i.e how the conversion is taking place?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1498681334, "post_id": 44811869, "comment_id": 76604320, "body": "<code>y()</code> isn&#39;t virtual?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1498681342, "post_id": 44811869, "comment_id": 76604331, "body": "Data members contribute to the size of a struct, as each struct instance has its own complement of them; ordinary function members do not, as there is only one per struct type, and it is not contained within the struct."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1498681351, "post_id": 44811869, "comment_id": 76604340, "body": "Member functions can be viewed as almost the same as a free function that takes a reference to the class type as the first parameter."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1498681362, "post_id": 44811869, "comment_id": 76604347, "body": "Ah, so if there members with points, they don&#39;t contribute to the size?"}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1498681381, "post_id": 44811869, "comment_id": 76604361, "body": "@Justin - like self in python?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 2, "creation_date": 1498681419, "post_id": 44811869, "comment_id": 76604384, "body": "Imagine you had an array of 100 <code>struct y</code>&#39;s. Would you need 100 copies of the compiled code for the function?"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498681550, "post_id": 44811869, "comment_id": 76604471, "body": "What did you research before asking here?"}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 1, "creation_date": 1498682117, "post_id": 44811869, "comment_id": 76604776, "body": "@walter: <a href=\"https://stackoverflow.com/questions/3203162/what-does-sizeof-do\">stackoverflow.com/questions/3203162/what-does-sizeof-do</a> <a href=\"http://en.cppreference.com/w/cpp/language/sizeof\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/sizeof</a> <a href=\"http://en.cppreference.com/w/cpp/language/sizeof\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/sizeof</a>..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8197171"}, "edited": false, "score": 0, "creation_date": 1498682349, "post_id": 44811869, "comment_id": 76604893, "body": "A very similar question answered quite nicely is right here: <a href=\"https://stackoverflow.com/questions/24504913/where-are-functions-of-an-object-stored-in-memory\" title=\"where are functions of an object stored in memory\">stackoverflow.com/questions/24504913/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 6, "last_activity_date": 1498681449, "creation_date": 1498681449, "answer_id": 44811931, "question_id": 44811869, "link": "https://stackoverflow.com/questions/44811869/why-doesnt-sizeof-care-about-functions/44811931#44811931", "title": "Why doesn&#39;t sizeof care about functions?", "body": "<blockquote>\n  <p>What things are included in sizeof, and what things are not?</p>\n</blockquote>\n\n<p><code>sizeof()</code> only includes things that have to be stored in memory as part of each instance of the type. (For a class or structure, it returns the amount of memory that needs to be allocated for an instance.)</p>\n\n<p>Since the function is the same for every instance of <code>struct y</code>, it's not stored as part of the structure -- defining it there just allows the function to be called as a method on the structure. If it were a function pointer, though, the pointer would be part of the structure, and would contribute to its size.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1498684118, "last_edit_date": 1592644375, "creation_date": 1498684118, "answer_id": 44812577, "question_id": 44811869, "link": "https://stackoverflow.com/questions/44811869/why-doesnt-sizeof-care-about-functions/44812577#44812577", "title": "Why doesn&#39;t sizeof care about functions?", "body": "<blockquote>\n<strong>5.3.3 <code>Sizeof</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[expr.sizeof]</strong><br><br>\n1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The <strong><code>sizeof</code></strong> operator yields the number of bytes in the object representation of its operand. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The operand is\neither an expression, which is an unevaluated operand (Clause 5), or a<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parenthesized <em>type-id</em>. The <strong><code>sizeof</code></strong>\noperator shall not be applied to an expression that has<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function or incomplete type, to an enumeration\ntype whose underlying type is not fixed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;before all its enumerators have been declared, to the parenthesized\nname of such types, or to<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a glvalue that designates a bit-field. <strong><code>sizeof(char)</code></strong>, <strong><code>sizeof(signed char)</code></strong> and\n<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><code>sizeof(unsigned char)</code></strong> are 1. The result of <strong><code>sizeof</strong></code> applied to any other fundamental type<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(3.9.1) is\nimplementation-defined. [ <em>Note</em>: in particular, <strong><code>sizeof(bool)</code></strong>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><code>sizeof(char16_t)</code></strong>, <strong><code>sizeof(char32_t)</code></strong>, and\n<strong><code>sizeof(wchar_t)</code></strong> are implementation-defined.<sup>75</sup><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&mdash; <em>end note</em> ] [ <em>Note</em>: See 1.7 for the definition of <em>byte</em>\nand 3.9 for the definition of <em>object<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;representation</em>. &mdash; <em>end note</em> ]<br><br>\n2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When applied to a reference or a reference type, the result is the size of the referenced type.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When applied\nto a class, the result is the number of bytes in an object of that class<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;including any padding required for\nplacing objects of that type in an array. The size of a<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;most derived class shall be greater than zero (1.8).\nThe result of applying <strong><code>sizeof</code></strong> to a base<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class subobject is the size of the base class type.<sup>76</sup> When applied\nto an array, the result is<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the total number of bytes in the array. This implies that the size of an array of <em>n</em>\nelements is <em>n</em><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;times the size of an element.<br><br>\n3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The <strong><code>sizeof</code></strong> operator can be applied to a pointer to a function, but shall not be applied directly <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to a function.\n</blockquote>\n<p><sup><em><a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf\" rel=\"nofollow noreferrer\">C++ Online Working Draft</a></em></sup></p>\n<p>In C++, no <em>sane</em> implementation would store a redundant copy the function's machine code within an object instance; not only would it be a massive waste of space, most architectures (that I'm aware of, anyway) don't allow you to mix machine code with data that way, so it doesn't contribute to the size of the object representation.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "closed_date": 1498779739, "accepted_answer_id": 44811931, "answer_count": 2, "score": -3, "last_activity_date": 1498684118, "creation_date": 1498681236, "last_edit_date": 1498681353, "question_id": 44811869, "link": "https://stackoverflow.com/questions/44811869/why-doesnt-sizeof-care-about-functions", "closed_reason": "Duplicate", "title": "Why doesn&#39;t sizeof care about functions?", "body": "<p>Given the following, you'll see that x and y are the same size, but y has an additional function. What things are included in sizeof, and what things are not?</p>\n\n<pre><code>struct x\n{\n    double a;\n    double b;\n    double c;\n    double d;\n};\nstruct y\n{\n    double a;\n    double b;\n    double c;\n    double d;\n    y(double q, double r, double s, double t) : a(q), b(r), c(s), d(t) {};\n};\nstd::cout &lt;&lt; sizeof(x)-sizeof(y) &lt;&lt;std::endl;\n</code></pre>\n"}, {"tags": ["c++", "boost", "boost-date-time", "boost-locale"], "comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 1, "creation_date": 1498681182, "post_id": 44811815, "comment_id": 76604238, "body": "Well, you <i>did</i> add 12 months to a time...."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 0, "creation_date": 1498682836, "post_id": 44811815, "comment_id": 76605118, "body": "Have you considered <a href=\"https://howardhinnant.github.io/date/date.html\" rel=\"nofollow noreferrer\">Howard Hinnant&#39;s date/time library</a>? <code>static_assert(2016_y&#47;12&#47;19 + months{12} == 2017_y&#47;12&#47;19, &quot;&quot;);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 3236291, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01995f95203053b06d2ffb051a72740c?s=128&d=identicon&r=PG&f=1", "display_name": "user3236291", "link": "https://stackoverflow.com/users/3236291/user3236291"}, "edited": false, "score": 0, "creation_date": 1498681433, "post_id": 44811881, "comment_id": 76604399, "body": "Ok, how do I initially set the date_time correctly, assuming I have the data in integer format already (i.e., I know I&#39;m talking about 12-19-2016)?  That is, how do I know that months are 0-based?  And how do I know whether days are 0-based, or any other fragment of the date-time?  Or is there simply a better way to initialize the known date_time?"}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 113, "user_id": 3236291, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01995f95203053b06d2ffb051a72740c?s=128&d=identicon&r=PG&f=1", "display_name": "user3236291", "link": "https://stackoverflow.com/users/3236291/user3236291"}, "edited": false, "score": 0, "creation_date": 1498681522, "post_id": 44811881, "comment_id": 76604453, "body": "@user3236291 Subtract 1 from the month&#39;s value. Treat <code>January</code> as being equivalent to <code>0</code>, and <code>December</code> as being equivalent to <code>11</code>, and adjust when displaying dates."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 113, "user_id": 3236291, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01995f95203053b06d2ffb051a72740c?s=128&d=identicon&r=PG&f=1", "display_name": "user3236291", "link": "https://stackoverflow.com/users/3236291/user3236291"}, "edited": false, "score": 0, "creation_date": 1498681660, "post_id": 44811881, "comment_id": 76604527, "body": "@user3236291 If you look at the documentation for <a href=\"http://www.boost.org/doc/libs/1_64_0/libs/locale/doc/html/dates_times_timezones.html\" rel=\"nofollow noreferrer\">date_time</a>, you&#39;ll see it has examples of being more verbose/explicit with intent in the library itself, like using <code>boost::locale::period::january()</code> to get an exact value for individual months."}, {"owner": {"reputation": 113, "user_id": 3236291, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01995f95203053b06d2ffb051a72740c?s=128&d=identicon&r=PG&f=1", "display_name": "user3236291", "link": "https://stackoverflow.com/users/3236291/user3236291"}, "edited": false, "score": 0, "creation_date": 1498681727, "post_id": 44811881, "comment_id": 76604570, "body": "I see.  The documentation said that the days were 1-based (not 0-based), so I assumed the months were as well.  That is actually incorrect, and the documentation says the months are 0-based.  Thanks for the help!"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "reply_to_user": {"reputation": 113, "user_id": 3236291, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01995f95203053b06d2ffb051a72740c?s=128&d=identicon&r=PG&f=1", "display_name": "user3236291", "link": "https://stackoverflow.com/users/3236291/user3236291"}, "edited": false, "score": 0, "creation_date": 1498681749, "post_id": 44811881, "comment_id": 76604583, "body": "@user3236291 &quot;how do I know&quot; ... you read the <a href=\"http://www.boost.org/doc/libs/1_51_0/libs/locale/doc/html/namespaceboost_1_1locale_1_1period.html\" rel=\"nofollow noreferrer\">docs</a> -- e.g. for <code>period::month</code>: &quot; The month of year, calendar specific, in Gregorian [0..11] &quot;"}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 113, "user_id": 3236291, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01995f95203053b06d2ffb051a72740c?s=128&d=identicon&r=PG&f=1", "display_name": "user3236291", "link": "https://stackoverflow.com/users/3236291/user3236291"}, "edited": false, "score": 0, "creation_date": 1498681789, "post_id": 44811881, "comment_id": 76604605, "body": "@user3236291 It might seem a little inconsistent, but that&#39;s how most other Date/Time Libraries work, so it made sense to adopt the same conventions there."}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 1, "last_activity_date": 1498681268, "creation_date": 1498681268, "answer_id": 44811881, "question_id": 44811815, "link": "https://stackoverflow.com/questions/44811815/boostlocaledate-time-how-to-get-data-from-date-time-object-in-boost-c/44811881#44811881", "title": "boost::locale::date_time: How to get data from date_time object in Boost C++?", "body": "<p><code>2016-04-05</code> + <code>12 months</code> = <code>2017-04-05</code>. This makes sense, since 12 months is a whole year.</p>\n\n<p>Try adding 11 months instead, then increment to adjust from a 0-based month to a 1-based month.</p>\n\n<pre><code>boost::locale::date_time dt = boost::locale::period::year(2016) + boost::locale::period::month(11) + boost::locale::period::day(19);\n\nuint month = dt.get(boost::locale::period::month()) + 1;\nuint day = dt.get(boost::locale::period::day());\nuint year = dt.get(boost::locale::period::year());\n\ncout &lt;&lt; month &lt;&lt; \"/\" &lt;&lt; day &lt;&lt; \"/\" &lt;&lt; year &lt;&lt; endl;\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 3236291, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01995f95203053b06d2ffb051a72740c?s=128&d=identicon&r=PG&f=1", "display_name": "user3236291", "link": "https://stackoverflow.com/users/3236291/user3236291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 44811881, "answer_count": 1, "score": 0, "last_activity_date": 1498681340, "creation_date": 1498681005, "last_edit_date": 1498681340, "question_id": 44811815, "link": "https://stackoverflow.com/questions/44811815/boostlocaledate-time-how-to-get-data-from-date-time-object-in-boost-c", "title": "boost::locale::date_time: How to get data from date_time object in Boost C++?", "body": "<p>I'm trying to handle dates and times in my code, and have been pointed in the direction of the boost library - specifically, boost::locale::date_time (in part because this lets me avoid Daylight Saving Time weirdness that was making my previous implementation difficult).</p>\n\n<p>However, I'm getting inconsistent results.  When I store a date in the date_time object and later try to get data from it, it is incorrect.  Here's an example:</p>\n\n<pre><code>#include &lt;boost\\\\asio\\\\error.hpp&gt;\n#include &lt;boost\\\\locale.hpp&gt;\nusing namespace std;\n\nint main()\n{\n    // Necessary to avoid bad_cast exception - system default should be fine\n    boost::locale::generator gen;\n    std::locale::global(gen(\"\"));\n\n    // Create date_time of 12/19/2016\n    boost::locale::date_time dt = boost::locale::period::year(2016) + boost::locale::period::month(12) + boost::locale::period::day(19);\n\n    unsigned int month = dt.get(boost::locale::period::month());\n    unsigned int day = dt.get(boost::locale::period::day());\n    unsigned int year = dt.get(boost::locale::period::year());\n\n    cout &lt;&lt; month &lt;&lt; \"/\" &lt;&lt; day &lt;&lt; \"/\" &lt;&lt; year &lt;&lt; endl;\n\n    // Expected output:  12/19/2016\n    // Actual output:    0/19/2017\n}\n</code></pre>\n\n<p>What am I doing wrong?  I just want to extract the saved days, months, years, hours, etc.</p>\n\n<p>Thank you.</p>\n\n<p>EDIT:  It's possible I'm initially setting the date_time in an incorrect manner.  Is there a better way to explicitly set a date time (for instance, to 12-19-2016), assuming I have all the relevant data in integer (not string) format?</p>\n"}, {"tags": ["c++", "parsing", "bison", "variant"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 1538920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee660227a70b1010509c410c76b4665?s=128&d=identicon&r=PG", "display_name": "piomar123", "link": "https://stackoverflow.com/users/1538920/piomar123"}, "edited": false, "score": 0, "creation_date": 1498744681, "post_id": 44812150, "comment_id": 76634661, "body": "Thanks for the information. I reported this issue to Bison developers."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1498757050, "post_id": 44812150, "comment_id": 76643312, "body": "The behavior clearly violates the documentation. In a mid-rule action <code>$$</code> denotes the result for just that sub-action, and must be attributed using <code>$&lt;type&gt;$</code> since the type is not declared from anywhere. This object can later be referred to using <code>$&lt;type&gt;n</code>, where <code>n</code> the position of the rule in the production. Clearly <code>$&lt;int&gt;2</code> refers to the correct position, yet the value is not there. <i>Prima facie</i> bug."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 1, "last_activity_date": 1498682352, "creation_date": 1498682352, "answer_id": 44812150, "question_id": 44811550, "link": "https://stackoverflow.com/questions/44811550/bison-c-mid-rule-value-lost-with-variants/44812150#44812150", "title": "Bison C++ mid-rule value lost with variants", "body": "<p>I vote for \"bug\". It does not have to do with the absence of the default action.</p>\n\n<p>I traced execution through to the point where it attempts to push the value of the MRA onto the stack. However, it does not get the correct type for the MRA, with the result that the call to <code>yypush_</code> does nothing, which is clearly not the desired action.</p>\n\n<p>If I were you, I'd report the problem. </p>\n"}, {"tags": [], "owner": {"reputation": 6840, "user_id": 1353549, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/413d2645039577214eb6382b3166e1c4?s=128&d=identicon&r=PG", "display_name": "akim", "link": "https://stackoverflow.com/users/1353549/akim"}, "is_accepted": false, "score": 0, "last_activity_date": 1536556704, "creation_date": 1536556704, "answer_id": 52251495, "question_id": 44811550, "link": "https://stackoverflow.com/questions/44811550/bison-c-mid-rule-value-lost-with-variants/52251495#52251495", "title": "Bison C++ mid-rule value lost with variants", "body": "<p>This was indeed a bug in Bison 3.0.5, but using <code>$&lt;foo&gt;1</code> is also intrinsically wrong (yet there was no alternative!).</p>\n\n<p>Consider:</p>\n\n<pre><code>// 1.y\n%nterm &lt;int&gt; exp\n%%\nexp: { $&lt;int&gt;$ = 42; }    { $$ = $&lt;int&gt;1; }\n</code></pre>\n\n<p>It is translated into something like:</p>\n\n<pre><code>// 2.y\n%nterm &lt;int&gt; exp\n%%\n@1: %empty { $&lt;int&gt;$ = 42; }\nexp: @1    { $$ = $&lt;int&gt;1; }\n</code></pre>\n\n<p>What is wrong here is that we did not tell Bison what the type of the semantic value of <code>@1</code> is, so it will not be able to handle this semantic value correctly (typically, no <code>%printer</code> and no <code>%destructor</code> will be applied).  Worse yet: here, because it does not know what value is actually stored here, it is unable to manipulate it properly: it does not know how to copy it from the local variable $$ to the stack, that's why the value was lost.  (In C, the bits of the semantic value are copied blindly, so it works.  In C++ with Bison variants, we use the exact assignment/copy operators corresponding to the current type, which requires to know what the type is.)</p>\n\n<p>Clearly a better translation would have been:</p>\n\n<pre><code>// 3.y\n%nterm &lt;int&gt; exp @1\n%%\n@1: %empty { $$ = 42; }\nexp: @1    { $$ = $1; }\n</code></pre>\n\n<p>which is actually what anybody would have written.</p>\n\n<p>Thanks to your question, Bison 3.1 now features <a href=\"https://www.gnu.org/software/bison/manual/html_node/Typed-Mid_002dRule-Actions.html#Typed-Mid_002dRule-Actions\" rel=\"nofollow noreferrer\" title=\"Typed Midrule Actions\">typed midrule actions</a>:</p>\n\n<pre><code>// 4.y\n%nterm &lt;int&gt; exp\n%%\nexp: &lt;int&gt;{ $$ = 42; }    { $$ = $1; }\n</code></pre>\n\n<p>Desugared, 4.y generates exactly as in 3.y.</p>\n\n<p>See <a href=\"http://lists.gnu.org/archive/html/bug-bison/2017-06/msg00000.html\" rel=\"nofollow noreferrer\">http://lists.gnu.org/archive/html/bug-bison/2017-06/msg00000.html</a> and <a href=\"http://lists.gnu.org/archive/html/bug-bison/2018-06/msg00001.html\" rel=\"nofollow noreferrer\">http://lists.gnu.org/archive/html/bug-bison/2018-06/msg00001.html</a> for more details.</p>\n"}], "owner": {"reputation": 15, "user_id": 1538920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee660227a70b1010509c410c76b4665?s=128&d=identicon&r=PG", "display_name": "piomar123", "link": "https://stackoverflow.com/users/1538920/piomar123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 44812150, "answer_count": 2, "score": 1, "last_activity_date": 1536556704, "creation_date": 1498680002, "question_id": 44811550, "link": "https://stackoverflow.com/questions/44811550/bison-c-mid-rule-value-lost-with-variants", "title": "Bison C++ mid-rule value lost with variants", "body": "<p>I'm using Bison with <code>lalr1.cc</code> skeleton to generate C++ parser and <code>api.value.type variant</code>. I tried to use mid-rule action to return value that will be used in further semantic actions, but it appears that the value on stack becomes zero. Below is an example.</p>\n\n<p>parser.y:</p>\n\n<pre><code>%require \"3.0\"\n%skeleton \"lalr1.cc\"\n%defines\n%define api.value.type variant\n\n%code {\n#include &lt;iostream&gt;\n#include \"parser.yy.hpp\"\nextern int yylex(yy::parser::semantic_type * yylval);\n}\n\n%token &lt;int&gt; NUM\n\n%%\nexpr: NUM | expr { $&lt;int&gt;$ = 42; } '+' NUM { std::cout &lt;&lt; $&lt;int&gt;2 &lt;&lt; std::endl; };\n\n%%\n\nvoid yy::parser::error(const std::string &amp; message){\n    std::cerr &lt;&lt; message &lt;&lt; std::endl;\n}\n\nint main(){\n    yy::parser p;\n    return p.parse();\n}\n</code></pre>\n\n<p>lexer.flex:</p>\n\n<pre><code>%option noyywrap\n%option nounput\n%option noinput\n\n%{\n#include \"parser.yy.hpp\"\ntypedef yy::parser::token token;\n#define YY_DECL int yylex(yy::parser::semantic_type * yylval)\n%}\n\n%%\n[ \\n\\t]+\n[0-9]+      {\n                yylval-&gt;build(atoi(yytext));\n                return token::NUM;\n            }\n.           {\n                return yytext[0];\n            }\n</code></pre>\n\n<p>compiling:</p>\n\n<pre><code>bison -o parser.yy.cpp parser.y\nflex -o lexer.c lexer.flex\ng++ parser.yy.cpp lexer.c -O2 -Wall -o parser\n</code></pre>\n\n<p>Simple input like <code>2+2</code> should print value <code>42</code> but instead appears <code>0</code>. When variant type is changed to <code>%union</code>, the printed value is as it should be. For a workaround I've been using marker actions with <code>$&lt;type&gt;-n</code> to get deeper values from stack, but that approach can reduce legibility and maintainability.</p>\n\n<p>I've read in the generated source that when using variant type, the default action <code>{ $$ = $1 }</code> is not executed. Is it an example of that behavior or is it a bug?</p>\n"}, {"tags": ["c++", "debugging", "for-loop", "struct"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1498680038, "post_id": 44811517, "comment_id": 76603553, "body": "<code>for (int i = 0; i &lt;= y; i++)</code> the largest index in an array with <code>y</code> elements is <code>y-1</code> not <code>y</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1498680112, "post_id": 44811517, "comment_id": 76603592, "body": "what is the point of this array anyhow? you could simply assign values to the members directly"}, {"owner": {"reputation": 3, "user_id": 8222655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e7e7c1bbf299f4162b1ba8443e973b?s=128&d=identicon&r=PG&f=1", "display_name": "Miranda Thomson", "link": "https://stackoverflow.com/users/8222655/miranda-thomson"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498681877, "post_id": 44811517, "comment_id": 76604656, "body": "tobi303 Thanks. I guess I should have seen that :P. I want to be able to assign any address to the block struct and have the addresses of its members increment up from it automatically, because there are going to be a lot more regtype members when I&#39;m done the code. I have it set up right now so that the number of regtype members is counted using macros, and the array expands accordingly. Basically, I&#39;m setting up everything so that vals of any struct can be accessed and edited easily in int main(). It&#39;s complicated."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498680589, "post_id": 44811614, "comment_id": 76603883, "body": "why not simply a less obfuscated <code>regA.addr=adress; regB.addr=adress+1;</code>?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498681150, "post_id": 44811614, "comment_id": 76604215, "body": "@tobi303: right, for sure. But it seems as if OP deals with &quot;generated&quot; code or macro-expanded code, so I left the structure as close as possible to the OP&#39;s one."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498682659, "post_id": 44811614, "comment_id": 76605036, "body": "in that case I would replace &quot;you should actually write...&quot; with something less imperative, e.g. &quot;The following is correct&quot;"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498684826, "post_id": 44811614, "comment_id": 76606055, "body": "@tobi303: imperative was not intended. Non-native english speakers probably express things imprecise..."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1498686310, "post_id": 44811614, "comment_id": 76606714, "body": "also non-native speaker here, and may sometimes a bit too critical. Anyhow, imho much better now"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 3, "last_activity_date": 1498684202, "last_edit_date": 1498684202, "creation_date": 1498680249, "answer_id": 44811614, "question_id": 44811517, "link": "https://stackoverflow.com/questions/44811517/array-variable-not-being-assigned-properly-in-for-loop/44811614#44811614", "title": "Array Variable not being Assigned Properly in For Loop", "body": "<p>Its about your array <code>int A[y]</code>, which you define with a value of <code>y==2</code>, such that it actually may contain two entries, i.e. <code>A[0]</code> and <code>A[1]</code>. Note, however, that an access to <code>A[2]</code> is out of bounds, since with 0-based indices in C++  <code>A[2]</code> actually stands for a 3rd element.</p>\n\n<p>While keeping the code close to yours, you could correct the issues as follows:</p>\n\n<pre><code>    int A[y];\n    for (int i = 0; i &lt; y; i++) {  // Note &lt; instead of &lt;=\n        A[i] = address;\n        address++;\n    }\n    regA.addr=A[0]; regB.addr=A[1];  // note 0,1 instead of 1,2\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8222655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e7e7c1bbf299f4162b1ba8443e973b?s=128&d=identicon&r=PG&f=1", "display_name": "Miranda Thomson", "link": "https://stackoverflow.com/users/8222655/miranda-thomson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 44811614, "answer_count": 1, "score": -1, "last_activity_date": 1498684202, "creation_date": 1498679875, "question_id": 44811517, "link": "https://stackoverflow.com/questions/44811517/array-variable-not-being-assigned-properly-in-for-loop", "title": "Array Variable not being Assigned Properly in For Loop", "body": "<p>I am trying to make it so that I assign a separate address value to each of the RegType members within the struct BlockA when I create the object blockA1. They should be incremented from the address assigned to blockA1 when it is created (in this case, 3). </p>\n\n<p>It works for regA (regA.addr is printed out as 4), but when I run this code, the value printed for regB.addr is some weird number, as though it had not been assigned a value at all.</p>\n\n<p>This code is constructed using macros, but I tried running it on its own, as you see it here, and it says that the stack around variable A is corrupted.</p>\n\n<p>Does anyone know what the problem is?</p>\n\n<pre><code> struct RegTypeA {\n      int addr ; int val ;\n};\n\n struct RegTypeB {\n    int addr ; int val ;\n};\n\n struct BlockA {\n    RegTypeA regA ; RegTypeB regB ;\n    int addr;\n    BlockA(int address);\n};\n\nBlockA::BlockA(int address) {\n    addr = address;\n    const int y = +1 +1;\n    int A[y];\n    for (int i = 0; i &lt;= y; i++) {\n        A[i] = address;\n        address++;\n    }\n    regA.addr=A[1]; regB.addr=A[2];\n\n}\n\nint main()\n{\n    BlockA blockA1(3);\n\n    std::cout &lt;&lt; blockA1.regA.addr &lt;&lt; std::endl;\n    std::cout &lt;&lt; blockA1.regB.addr;\n\n    std::cin.get();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "cmake", "code-coverage", "gcov", "lcov"], "comments": [{"owner": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 2, "creation_date": 1498679570, "post_id": 44811329, "comment_id": 76603260, "body": "Can you please give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? From what you are showing, it&#39;s not clear to me what you are trying to do. Can you give the code of &quot;the setup-function&quot; or at least the <code>target_link_libraries()</code> call in question?"}, {"owner": {"reputation": 470, "user_id": 2349761, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bjyQS.jpg?s=128&g=1", "display_name": "helmesjo", "link": "https://stackoverflow.com/users/2349761/helmesjo"}, "reply_to_user": {"reputation": 31426, "user_id": 4763489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89773f016f1f4cc2c4e790a6c3f7b004?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/4763489/florian"}, "edited": false, "score": 0, "creation_date": 1498708449, "post_id": 44811329, "comment_id": 76612293, "body": "@Florian Definitely! I wrote this with tired eyes last night, and realize it&#39;s rather vague... I&#39;ll edit it asap."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1498722564, "post_id": 44811329, "comment_id": 76618444, "body": "Weird. In CMake terminology &quot;current directory&quot; is introduced with <code>add_subdirectory()</code> only, it doesn&#39;t distinguish case when function is defined in included file. And such use case (calling <code>target_link_libraries</code> from the function, defined not in the current directory) works for me with CMake 3.4."}, {"owner": {"reputation": 470, "user_id": 2349761, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bjyQS.jpg?s=128&g=1", "display_name": "helmesjo", "link": "https://stackoverflow.com/users/2349761/helmesjo"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1498726384, "post_id": 44811329, "comment_id": 76620980, "body": "@Tsyvarev Oh, my bad! My example lies a little in that <code>setup_target_for_coverage</code> is actually run within the <code>tests</code> subdirectory..! Reason for this is that I don&#39;t know the target-name for the test-target until here (mylib is agnostic to what the test does). I&#39;ll fix the example."}, {"owner": {"reputation": 470, "user_id": 2349761, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bjyQS.jpg?s=128&g=1", "display_name": "helmesjo", "link": "https://stackoverflow.com/users/2349761/helmesjo"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1498726484, "post_id": 44811329, "comment_id": 76621066, "body": "@Tsyvarev Though. solving the &quot;test-target name&quot;, if it works by having <code>setup_target_for_coverage</code> in <code>mylib&#47;CMakeLists.txt</code>, that is a much easier hurdle to overcome..."}, {"owner": {"reputation": 7193, "user_id": 1938798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196507edbb408bad2f2a08e33222bac7?s=128&d=identicon&r=PG", "display_name": "Craig Scott", "link": "https://stackoverflow.com/users/1938798/craig-scott"}, "edited": false, "score": 1, "creation_date": 1498735391, "post_id": 44811329, "comment_id": 76627219, "body": "Could your requirements be relaxed a little to allow using <code>include()</code> instead of <code>add_subdirectory()</code>? If so, then this would allow <code>target_link_libraries()</code> to be used. The main disadvantage is that inside your <code>tests</code> directory, you would have to remember that CMake would be treating the current source directory as <code>mylib</code>, not <code>mylib&#47;tests</code> (and similar for the corresponding binary directory)."}, {"owner": {"reputation": 470, "user_id": 2349761, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bjyQS.jpg?s=128&g=1", "display_name": "helmesjo", "link": "https://stackoverflow.com/users/2349761/helmesjo"}, "reply_to_user": {"reputation": 7193, "user_id": 1938798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196507edbb408bad2f2a08e33222bac7?s=128&d=identicon&r=PG", "display_name": "Craig Scott", "link": "https://stackoverflow.com/users/1938798/craig-scott"}, "edited": false, "score": 0, "creation_date": 1498737336, "post_id": 44811329, "comment_id": 76628678, "body": "@CraigScott That would be a viable sacrifice, thanks for the tip! I&#39;ll give it a try!"}], "answers": [{"comments": [{"owner": {"reputation": 470, "user_id": 2349761, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bjyQS.jpg?s=128&g=1", "display_name": "helmesjo", "link": "https://stackoverflow.com/users/2349761/helmesjo"}, "edited": false, "score": 0, "creation_date": 1498737483, "post_id": 44819031, "comment_id": 76628800, "body": "Sorry, missed some critical info in my example. See updated question!"}], "tags": [], "owner": {"reputation": 3967, "user_id": 4184884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fVkAe.png?s=128&g=1", "display_name": "oLen", "link": "https://stackoverflow.com/users/4184884/olen"}, "is_accepted": false, "score": 0, "last_activity_date": 1498721910, "creation_date": 1498721910, "answer_id": 44819031, "question_id": 44811329, "link": "https://stackoverflow.com/questions/44811329/alternative-to-calling-target-link-libraries-in-subdirectory/44819031#44819031", "title": "Alternative to calling target_link_libraries in subdirectory", "body": "<p>Replace <code>function</code> by <code>macro</code>:</p>\n\n<pre><code>macro(setup_target_for_coverage)\n  [...]\nendmacro()\n</code></pre>\n\n<p>CMake macros are similar to C macros: you can think of it as a text replacement, so that it behaves as if the code was located in the original file.</p>\n"}, {"comments": [{"owner": {"reputation": 470, "user_id": 2349761, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bjyQS.jpg?s=128&g=1", "display_name": "helmesjo", "link": "https://stackoverflow.com/users/2349761/helmesjo"}, "edited": false, "score": 0, "creation_date": 1498762340, "post_id": 44824873, "comment_id": 76646329, "body": "Thanks! This is indeed a valid alternative, with only minor modifications. One thing that bothers me a little with this approach though is that it pushes the changes upwards, all the way to <code>mylib</code>. Personally, I&#39;d rather solve it by a &quot;hack&quot; in <code>code-coverage.cmake</code> (something like <code>set_property</code>, if it would just work as advertised). This way, the added complexity would be hidden from higher-level entities. If I can&#39;t find a solution like that any time soon, I&#39;ll mark this as the answer!"}, {"owner": {"reputation": 470, "user_id": 2349761, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bjyQS.jpg?s=128&g=1", "display_name": "helmesjo", "link": "https://stackoverflow.com/users/2349761/helmesjo"}, "edited": false, "score": 0, "creation_date": 1499346036, "post_id": 44824873, "comment_id": 76874300, "body": "I went with this solution! It was the (IMO) most clean &quot;work-around&quot; which didn&#39;t complicate things too much. See implementation <a href=\"https://github.com/helmesjo/hello-ci/blob/7bde2cd03dcc5b935f3ea01e8ed226aa21e6ad7c/src/mylib/CMakeLists.txt#L74\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 7193, "user_id": 1938798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196507edbb408bad2f2a08e33222bac7?s=128&d=identicon&r=PG", "display_name": "Craig Scott", "link": "https://stackoverflow.com/users/1938798/craig-scott"}, "is_accepted": true, "score": 3, "last_activity_date": 1498738526, "creation_date": 1498738526, "answer_id": 44824873, "question_id": 44811329, "link": "https://stackoverflow.com/questions/44811329/alternative-to-calling-target-link-libraries-in-subdirectory/44824873#44824873", "title": "Alternative to calling target_link_libraries in subdirectory", "body": "<p>Turning comment into an answer. As you've highlighted, you can only call <code>target_link_libraries()</code> on a target defined in the same directory scope. When you call <code>add_subdirectory()</code>, you enter a new directory scope and therefore hit the problem you've asked about.</p>\n\n<p>The <code>include()</code> command, on the other hand, does not create a new directory scope. This has two immediately relevant effects:</p>\n\n<ul>\n<li>In the <em>included</em> directory's file, you can still call <code>target_link_libraries()</code> for a target in the <em>including</em> directory's scope.</li>\n<li>The value of <code>CMAKE_CURRENT_SOURCE_DIR</code> doesn't change, so you will likely be wanting to use <code>CMAKE_CURRENT_LIST_DIR</code> instead within the included file. Note that there is no equivalent for <code>CMAKE_CURRENT_BINARY_DIR</code> which also doesn't change.</li>\n</ul>\n\n<p>A typical pattern might be something like this:</p>\n\n<p><em>mylib/CMakeLists.txt</em>:</p>\n\n<pre><code>add_library( mylib main.cpp )\ninclude( tests/CMakeLists.txt )\n</code></pre>\n\n<p><em>mylib/tests/CMakeLists.txt</em>:</p>\n\n<pre><code>add_executable( someTest \"${CMAKE_CURRENT_LIST_DIR}/someTest.cpp\" )\n# ...\n</code></pre>\n\n<p>Perhaps at least tangentially related, you might also find the ideas in <a href=\"https://crascit.com/2016/01/31/enhanced-source-file-handling-with-target_sources/\" rel=\"nofollow noreferrer\">this article</a> to be of interest. It shows how to manage sources and targets across directories, touching on the <code>add_subdirectory()</code> versus <code>include()</code> discussion along the way.</p>\n"}], "owner": {"reputation": 470, "user_id": 2349761, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bjyQS.jpg?s=128&g=1", "display_name": "helmesjo", "link": "https://stackoverflow.com/users/2349761/helmesjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1525, "favorite_count": 1, "accepted_answer_id": 44824873, "answer_count": 2, "score": 1, "last_activity_date": 1498738526, "creation_date": 1498679180, "last_edit_date": 1498728892, "question_id": 44811329, "link": "https://stackoverflow.com/questions/44811329/alternative-to-calling-target-link-libraries-in-subdirectory", "title": "Alternative to calling target_link_libraries in subdirectory", "body": "<h2>Case:</h2>\n\n<p>I've declared a function <code>setup_target_for_coverage</code> in a separate .cmake-script, added to <code>CMAKE_MODULE_PATH</code>, which prepares a target (<code>mylib</code>) for code coverage analysis. <code>setup_target_for_coverage</code> is called from a subdirectory to <code>mylib</code> (<code>mylib_tests</code>). </p>\n\n<p><strong>The requirement is that everything that has to do with testing and code coverage, <em>for this target only</em>, happens in <code>mylib/tests</code> and <code>setup_target_for_coverage</code></strong>, and from <code>mylib/CMakeLists.txt</code> we only add the test-subdirectory and <em>nothing more</em>. In the end, neither test-specifics or the existence of code coverage is known to <code>mylib</code>, it just \"blindly\" calls <code>add_subdirectory( tests )</code>.</p>\n\n<h2>Example:</h2>\n\n<p>It looks like this:</p>\n\n<p>mylib:</p>\n\n<pre><code># ./mylib/CMakeLists.txt:\n\nproject( mylib )\nadd_library( mylib main.cpp )\n# This is all mylib should be aware of, everything else is hidden\nadd_subdirectory( tests )\n</code></pre>\n\n<p>mylib_tests:</p>\n\n<pre><code># ./mylib/tests/CMakeLists.txt:\n\nproject( mylib_tests )\n\n# ...\n\ninclude(code-coverage)\nsetup_target_for_coverage(\n    TARGET mylib\n    TEST_RUNNER mylib_tests\n)\n</code></pre>\n\n<p>code-coverage:</p>\n\n<pre><code># ./cmake/code-coverage.txt:\n\nfunction(setup_target_for_coverage)\n    # Parse arguments...\n\n    # Setting compile flags: Works as expected\n    target_compile_options( ${args_TARGET}\n        PRIVATE\n            -g -O0 --coverage\n    )\n\n    # Setting linker flags: THIS FAILS &lt;---------------\n    target_link_libraries( ${args_TARGET}\n        PRIVATE\n            --coverage\n    )\n\n    add_custom_target( ${args_TARGET}_coverage}\n        # Setup lcov, run \"TEST_RUNNER\", generate html...\n        COMMAND ...\n    )\n\nendfunction()\n</code></pre>\n\n<p>In short, it sets up compiler &amp; linker-flags (<code>--coverage</code>) and adds a custom target which runs gcov/lcov and genhtml. </p>\n\n<h2>Issue:</h2>\n\n<p>The issue is with <code>target_link_libraries</code>, which (as documented) is required to occur within the same \"directory\" where the target was created:</p>\n\n<blockquote>\n  <p>The named <code>&lt;target&gt;</code> must have been created in the current directory by\n  a command such as <code>add_executable()</code> or <code>add_library()</code> [...]</p>\n</blockquote>\n\n<p>I thus get the following error:</p>\n\n<pre><code>Attempt to add link library \"--coverage\" to target \"mylib\" which is not built in this directory.\n</code></pre>\n\n<hr>\n\n<p>I've tried to get around this by using <code>set_property</code> directly</p>\n\n<pre><code>set_property(\n    TARGET ${TARGET} \n    APPEND_STRING PROPERTY LINK_FLAGS \"--coverage\"\n)\n</code></pre>\n\n<p>to no avail. It fails with the following error, even if in same CMakeLists.txt:</p>\n\n<pre><code>\"undefined reference to `__gcov_merge_add'\"\n</code></pre>\n\n<hr>\n\n<p>It works if <code>target_link_libraries</code> is moved to <code>./mylib/CMakeLists.txt</code>, but this is as mentioned not fulfilling my requirements. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c++", "qt", "audio", "video", "qt5"], "comments": [{"owner": {"reputation": 2393, "user_id": 5414907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5ecb558f7d1b64dae9bb2feae8e6dc?s=128&d=identicon&r=PG", "display_name": "Mark Ch", "link": "https://stackoverflow.com/users/5414907/mark-ch"}, "edited": false, "score": 0, "creation_date": 1498691129, "post_id": 44811233, "comment_id": 76608319, "body": "For what it&#39;s worth, this all sounds a bit advanced for qt multimedia capabilities. The cross-platform nature of the Qt framework means these sort of features will be lagging behind the state of the art because they need to be implemented and tested on every platform."}, {"owner": {"reputation": 55, "user_id": 7776258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0589a9b750cdd9972e838bcd86ae8e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pravilov", "link": "https://stackoverflow.com/users/7776258/michael-pravilov"}, "reply_to_user": {"reputation": 2393, "user_id": 5414907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5ecb558f7d1b64dae9bb2feae8e6dc?s=128&d=identicon&r=PG", "display_name": "Mark Ch", "link": "https://stackoverflow.com/users/5414907/mark-ch"}, "edited": false, "score": 0, "creation_date": 1498722273, "post_id": 44811233, "comment_id": 76618278, "body": "Thank you, @MarkCh . Did I understand correctly that this answer means no and there is no way to realize it only with Qt?"}, {"owner": {"reputation": 2393, "user_id": 5414907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5ecb558f7d1b64dae9bb2feae8e6dc?s=128&d=identicon&r=PG", "display_name": "Mark Ch", "link": "https://stackoverflow.com/users/5414907/mark-ch"}, "edited": false, "score": 0, "creation_date": 1498723313, "post_id": 44811233, "comment_id": 76618934, "body": "I don&#39;t <i>think</i> it&#39;s possible."}], "owner": {"reputation": 55, "user_id": 7776258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0589a9b750cdd9972e838bcd86ae8e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pravilov", "link": "https://stackoverflow.com/users/7776258/michael-pravilov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498678823, "creation_date": 1498678823, "question_id": 44811233, "link": "https://stackoverflow.com/questions/44811233/qt5-extracting-audio-from-video", "title": "Qt5 extracting audio from video", "body": "<p>I have a task: user chooses a video file, I need to get an audio track from it and give an opportunity to play it with equalizer and then save this audio in mp3.</p>\n\n<p>I found an <a href=\"http://doc.qt.io/archives/qt-5.5/qtmultimediawidgets-player-example.html\" rel=\"nofollow noreferrer\">example of media player</a> in Qt. Playing video with Qt is very easy as the example has shown so I'd like to realize this task only with Qt API. The only way I know to get audio track from video is to use libAV or similar libraries. Is there an opportunity to get audio from video with Qt API? Also I haven't found the way to save an audio in a specific format with Qt. Is it possible?</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["c++", "arm", "microcontroller", "cout", "stm32"], "comments": [{"owner": {"reputation": 4082, "user_id": 7893951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5eWm1.jpg?s=128&g=1", "display_name": "Akira", "link": "https://stackoverflow.com/users/7893951/akira"}, "edited": false, "score": 0, "creation_date": 1498680164, "post_id": 44811212, "comment_id": 76603625, "body": "I&#39;m not familiar with C++ for STM32 (used C with NXP in the past) but <code>std::cout</code> is basically an <a href=\"http://www.cplusplus.com/reference/ostream/ostream/\" rel=\"nofollow noreferrer\"><code>std::ostream</code></a> which writes to <a href=\"http://www.cplusplus.com/reference/cstdio/stdout/\" rel=\"nofollow noreferrer\"><code>stdout</code></a> so as a hint I would derive a class from <a href=\"http://www.cplusplus.com/reference/streambuf/streambuf/\" rel=\"nofollow noreferrer\"><code>std::streambuf</code></a> and define its <code>virtual</code> methods to write and read as it&#39;s expected then I would use it with <code>std::ostream</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1498681094, "post_id": 44811212, "comment_id": 76604173, "body": "Check your compiler documentation.  There may be hooks that you need to satisfy, since the STM32 can be put on any kind of platform.  Also, the implementations of <code>std::cout</code> and <code>printf</code> are implementation dependent."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1498681262, "post_id": 44811212, "comment_id": 76604282, "body": "Please edit your post with the compiler that you are using.  There are many compilers that can be used with a STM32 microcontroller, such as IAR, Greenhills and GNU."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1498685136, "post_id": 44811212, "comment_id": 76606208, "body": "the compiler really isnt the issue, what if any operating system are you running on the stm32 (generally none but sometimes an rtos) and then what C library that is modified/created for that target (can make baremetal ones but you still have to port/target them or find a ready to use one).   you are significantly better off using neither of these library calls/features.  they are some of the most massive in backend requirements for such a resource limited environment."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1498685174, "post_id": 44811212, "comment_id": 76606237, "body": "make your own library routines and recover a significant percentage of your flash for other more useful things."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1498685239, "post_id": 44811212, "comment_id": 76606271, "body": "to your question the problem you are facing is a backend there are going to be many many layers of library functions required and they boil down into system calls.  Plus before you hit that problem you have to point the generic compiler at the specific library and header files you want to use"}], "owner": {"reputation": 608, "user_id": 3144058, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c414c912876ebb8054a493a1660d0fd1?s=128&d=identicon&r=PG&f=1", "display_name": "zupazt3", "link": "https://stackoverflow.com/users/3144058/zupazt3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1296, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498681532, "creation_date": 1498678768, "last_edit_date": 1498681532, "question_id": 44811212, "link": "https://stackoverflow.com/questions/44811212/using-stdcout-on-stm32-microcontroller", "title": "Using std::cout on STM32 microcontroller", "body": "<p>I managed to use <code>printf()</code> on my STM32 (CortexM7) compiling under C++, by defining functions like <code>_write</code> and <code>_read</code> and so on.</p>\n\n<p>But I wanted to use std::cout instead of <code>printf</code>. However including <code>&lt;iostream&gt;</code> yields like 300 errors.</p>\n\n<p>Do you know what has to be done to use <code>cout</code> with custom char printing functions?</p>\n\n<p>Compiler used G++ 6.2.</p>\n\n<hr>\n\n<p>I have found partial solution. You can make class (even name it cout) and overload operator &lt;&lt; for different types and inside execute printf() with proper format string. Maybe not most efficient but for UART is ok.</p>\n\n<p>So I don't need answer anymore, but if someone knows, then for curiosity you can post it.</p>\n"}, {"tags": ["c++", "multithreading"], "comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1498679115, "post_id": 44811141, "comment_id": 76602984, "body": "Neither of <code>getStudentDetails()</code> or <code>runScriptAndUpdateCacheFile()</code> directly calls each other, and the implementation of <code>runSmbtree()</code> isn&#39;t posted so there&#39;s no information about how the threads might interact.  That said, how <code>unlock</code> is used looks fishy to me.  Also, nothing ever joins the thread which is also suspect.."}, {"owner": {"reputation": 83, "user_id": 8228077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc0e814550bb151b9c935ae9218b881?s=128&d=identicon&r=PG&f=1", "display_name": "ricky", "link": "https://stackoverflow.com/users/8228077/ricky"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1498679255, "post_id": 44811141, "comment_id": 76603074, "body": "please check updated"}, {"owner": {"reputation": 83, "user_id": 8228077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc0e814550bb151b9c935ae9218b881?s=128&d=identicon&r=PG&f=1", "display_name": "ricky", "link": "https://stackoverflow.com/users/8228077/ricky"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1498679398, "post_id": 44811141, "comment_id": 76603165, "body": "My mistake i made the changes please refer the updated question"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1498680008, "post_id": 44811141, "comment_id": 76603543, "body": "The handling of <code>unlock</code> is definitely a race condition (undefined behavior) and whatever you&#39;re trying to do with <code>count_mutex</code> isn&#39;t doing anything since it&#39;s only being locked/unlocked on one thread (assuming that <code>getStudentDetails()</code> isn&#39;t called from different threads)."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1498680071, "post_id": 44811141, "comment_id": 76603576, "body": "I&#39;m not sure exactly what you&#39;re trying to do, but I don&#39;t think threads will help since I no requests can be worked on until the cached file has been created. Putting that creation on a separate thread won&#39;t speed things up since everything else would need to wait for it anyway.  But maybe I&#39;m misunderstanding something.  I feel like I&#39;m not getting the whole picture."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498680323, "post_id": 44811141, "comment_id": 76603724, "body": "<i>&quot;it working fine&quot;</i> - but then you are posting pages of error output? It&#39;s entirely not clear, what you are looking for. If everything is working fine, then why post the error output? If it isn&#39;t working fine, then instead of asking for a more efficient way to break stuff, you should ask about those issues, and address them. Anyway, do take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 83, "user_id": 8228077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc0e814550bb151b9c935ae9218b881?s=128&d=identicon&r=PG&f=1", "display_name": "ricky", "link": "https://stackoverflow.com/users/8228077/ricky"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1498680551, "post_id": 44811141, "comment_id": 76603864, "body": "@MichaelBurr thanks for suggestion .i too feel i am not able to put it correctly . Well let me explain in short . i have script which takes 2 min time to complete and dump in a file every time when thread called .So what here i planed is to create a another file(cachefile) which will serve client(with old data) and when script complete it update the cachefile.."}], "owner": {"reputation": 83, "user_id": 8228077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc0e814550bb151b9c935ae9218b881?s=128&d=identicon&r=PG&f=1", "display_name": "ricky", "link": "https://stackoverflow.com/users/8228077/ricky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498679998, "creation_date": 1498678516, "last_edit_date": 1498679998, "question_id": 44811141, "link": "https://stackoverflow.com/questions/44811141/copy-a-file-in-safe-and-efficient-way-in-thread", "title": "copy a file in safe and efficient way in thread", "body": "<p>I'm trying to copy the contents of tempFile to CacheFile in a thread in safe and \nefficient way.</p>\n\n<p>what is myscript takes 1-2 min times to write to a file (ie. tempFile) and after sucessfull .I need to copy to cacheFile so who ever call the function (getStudentDetails) will get serve from cachefile rather than tempFile to avoid the delay(though first call always will be delay for 1-2 min since cacheFIle will empty).</p>\n\n<p><strong>Note: I NEED TO USE FILE  NOT PRIMARY STORAGE</strong></p>\n\n<p>Below is my approach it working fine but can it be more efficient and safe?</p>\n\n<pre><code>bool unlock=true;\n\npthread_mutex_t count_mutex     = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t  condition_var   = PTHREAD_COND_INITIALIZER;\n\n\n    void * runScriptAndUpdateCacheFile (  void * arg  )\n{\n\n    std::cout&lt;&lt;\"Inside thread lock\"&lt;&lt;endl;\n\n    unlock=false;  // to avoid multiple call to this thread  till it get complete \n    char tempFile[32]={0};\n    strncpy(tempFile,\"/tmp/smbXXXXXX\",14); // tempFile is the main file where my script will dump the output\n\n\n    if( mkstemp(tempFile) &lt; 1)\n    {\n        cout&lt;&lt;\"fail to create temp file\"&lt;&lt;endl;\n        return (NULL);\n\n    }\n\n    if (tempFile != NULL)\n    {\n        char command[256] = {0};\n        sprintf(command, \" myscript &gt; %s\", tempFile); \n        int status=system(command);  // write ouput of script to tempFile\n        if (status &lt; 0)\n        {\n\n            std::cout &lt;&lt; \"Error: \" &lt;&lt; strerror(errno) &lt;&lt; '\\n';\n            return(NULL);\n        }\n        else\n        {\n            if (WIFEXITED(status))  // fetch exit code\n               {\n                std::cout &lt;&lt; \"Program returned normally, exit code \" &lt;&lt; WEXITSTATUS(status) &lt;&lt; '\\n';\n                std::ifstream  src(tempFile, std::ios::binary);\n                    std::ofstream  CacheFile((char*)arg, std::ios::binary); \n                                 Cache &lt;&lt; src.rdbuf();  // Copy to cacheFile\n               }\n            else\n            {\n                std::cout &lt;&lt; \"Program exited abnormaly\\n\";\n                return(NULL);\n            }\n        }\n    }\ncout&lt;&lt;\" thread is unlock\"&lt;&lt;endl;\nunlock=true;\n\n}\n</code></pre>\n\n<p><strong>getStudentDetails can be called multiple times</strong></p>\n\n<pre><code>void getStudentDetails()\n{\n    pthread_t threads;\n\n        char CacheFile[32]={0};\n\n        strncpy(CacheFile,\"/tmp/CacheFile\",19);\n       //Serve from CacheFile rather than orignal file coz this file\n       //will take 1-2 min to dump in it\n    std::ifstream fin(CacheFile);\n\n     if(unlock)  // to avoid multiple call to thread when multile call made to getStudentDetails\n                  // this unlock is made false when it enter to thread and made true when exit\n      {\n    pthread_mutex_lock( &amp;count_mutex );\n        int rc = pthread_create(&amp;threads, NULL, runSmbtree, CacheFile); // pass cache file to thread  this file will get updated with \n                                    // orignal file create by script.\n       pthread_mutex_unlock( &amp;count_mutex );\n      }\n        std::string line;\n\n        while (getline(fin, line))\n        {\n\n            // reading Cachefile and serveing when getStudentDetails called by client\n        }\n}\n</code></pre>\n\n<p><strong>Valgrind complains with below error</strong></p>\n\n<ol>\n<li><p>=3535== HEAP SUMMARY:</p>\n\n<p>==3535==     in use at exit: 864 bytes in 3 blocks</p>\n\n<p><strong>==3535==   total heap usage: 169 allocs, 166 frees, 78,323 bytes allocated</strong></p>\n\n<p>==3535== </p>\n\n<p>==3535== Searching for pointers to 3 not-freed blocks</p>\n\n<p>==3535== Checked 25,373,616 byte</p>\n\n<p>==3535== </p>\n\n<p>==3535== Thread 1:</p>\n\n<p>==3535== 864 bytes in 3 blocks are possibly lost in loss record 1 of 1</p>\n\n<p>==3535==    at 0x4C2CC70: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)</p>\n\n<p>==3535==    by 0x4012E54: allocate_dtv (dl-tls.c:296)</p>\n\n<p>==3535==    by 0x4012E54: _dl_allocate_tls (dl-tls.c:460)</p>\n\n<p>==3535==    by 0x5359DA0: allocate_stack (allocatestack.c:589)</p>\n\n<p>==3535==    by 0x5359DA0: pthread_create@@GLIBC_2.2.5 (pthread_create.c:500)</p>\n\n<p>==3535== </p>\n\n<p>==3535== LEAK SUMMARY:</p>\n\n<p>==3535==    definitely lost: 0 bytes in 0 blocks</p>\n\n<p>==3535==    indirectly lost: 0 bytes in 0 blocks</p>\n\n<p>==3535==      possibly lost: 864 bytes in 3 blocks</p>\n\n<p>==3535==    still reachable: 0 bytes in 0 blocks</p>\n\n<p>==3535==         suppressed: 0 bytes in 0 blocks</p>\n\n<p>==3535== </p>\n\n<p><strong>==3535== ERROR SUMMARY: 3 errors from 2 contexts (suppressed: 0 from 0)</strong></p>\n\n<p>==3535== </p>\n\n<p>==3535== 2 errors in context 1 of 2:</p>\n\n<p>==3535== Thread 2:</p>\n\n<p>==3535== Syscall param open(filename) points to unaddressable byte(s)</p>\n\n<p>==3535==    at 0x565B4CD: ??? (syscall-template.S:81)</p>\n\n<p>==3535==    by 0x55E9E07: _IO_file_open (fileops.c:228)</p>\n\n<p>==3535==    by 0x55E9E07: _IO_file_fopen@@GLIBC_2.2.5 (fileops.c:333)</p>\n\n<p>==3535==    by 0x55DE2E3: __fopen_internal (iofopen.c:90)</p>\n\n<p>==3535==    by 0x4EB29BF: std::__basic_file::open(char const*, std::_Ios_Openmode, int) (in</p>\n\n<p>/usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.19)</p>\n\n<p>==3535==    by 0x4EEAEA9: std::basic_filebuf >::open(char const*, std::_Ios_Openmode) (in</p>\n\n<p>/usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.19)</p>\n\n<p>==3535==    by 0x4EEC747: std::basic_ofstream >::basic_ofstream(char const*,</p>\n\n<p>std::_Ios_Openmode) (in</p>\n\n<p>/usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.19)</p>\n\n<p>==3535==    by 0x40200B: runScriptAndUpdateCacheFile(void*) (in ***)</p>\n\n<p>==3535==    by 0x5359181: start_thread (pthread_create.c:312)</p>\n\n<p>==3535==    by 0x566A30C: clone (clone.S:111)</p>\n\n<p>==3535==  Address 0xffefffba0 is on thread 1's stack</p>\n\n<p>==3535==  384 bytes below stack pointer</p>\n\n<p>==3535== </p>\n\n<p>==3535== ERROR SUMMARY: 3 errors from 2 contexts (suppressed: 0 from 0)</p></li>\n</ol>\n"}, {"tags": ["c++", "codeblocks"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498677864, "post_id": 44810823, "comment_id": 76602328, "body": "<b><i>Is this an issue with link libraries</i></b> From your output I don&#39;t see you linking to the gsl library like in this example: <a href=\"https://www.gnu.org/software/gsl/manual/html_node/Linking-programs-with-the-library.html#Linking-programs-with-the-library\" rel=\"nofollow noreferrer\">gnu.org/software/gsl/manual/html_node/&hellip;</a>"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1498678123, "post_id": 44810823, "comment_id": 76602466, "body": "Your failing link command shows that you have neglected to link <code>libgsl</code> and on the other hand are attempting to link header files, which isn&#39;t possible. See <a href=\"https://stackoverflow.com/a/12574400/1362568\">this answer</a> to <a href=\"https://stackoverflow.com/q/12573816/1362568\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 535, "user_id": 3083324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pVPjP.jpg?s=128&g=1", "display_name": "user3083324", "link": "https://stackoverflow.com/users/3083324/user3083324"}, "edited": false, "score": 0, "creation_date": 1498696075, "post_id": 44810823, "comment_id": 76609519, "body": "Linking libgsl.a solved the problem. 1. Why I didn&#39;t get an undefined reference for gsl_rng? 2.Why the compiler doesn&#39;t automatically link the necessary libraries? Is this an issue with g++ or with Code::Blocks?"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1498729126, "post_id": 44810823, "comment_id": 76623017, "body": "The linker does not know what &quot;the necessary&quot; libraries are unless you tell it. The compiler includes the header files you tell it to. The linker links the libraries you tell it to. There is no inference from the name of any header file to the existence or name of any library. You did not get an undefined reference for <code>gsl_rng</code> because it is the name of a type, for which the compiler found a definition in <code>gsl&#47;gsl_rng.h</code>; it is not the name of any linkable object (function or variable), defined in <code>libgsl.a</code>."}, {"owner": {"reputation": 535, "user_id": 3083324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pVPjP.jpg?s=128&g=1", "display_name": "user3083324", "link": "https://stackoverflow.com/users/3083324/user3083324"}, "reply_to_user": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1498745292, "post_id": 44810823, "comment_id": 76635170, "body": "@MikeKinghan In Windows cygwin64 there&#39;s a libgsl.dll.a, is this the Windows equivalent of libgsl.a?"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1498755516, "post_id": 44810823, "comment_id": 76642403, "body": "No it&#39;s not. To link <code>libgsl</code> put <code>-lgsl</code> in <b>Other linker options</b> (and nothing in <b>Link libraries</b>) and the linker will locate the right file,  if the library is installed on the system, whatever your system may be. Similarly <code>-lblas</code> to link <code>libblas</code>. <code>-I..&#47;..&#47;..&#47;..&#47;usr&#47;include&#47;gsl</code> is an incorrect include-path for the compiler, but unnecessary so you can delete it from your settings. Your program is written in C, not C++, so best compile it with <code>gcc</code>, not <code>g++</code>."}], "owner": {"reputation": 535, "user_id": 3083324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pVPjP.jpg?s=128&g=1", "display_name": "user3083324", "link": "https://stackoverflow.com/users/3083324/user3083324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1498678360, "answer_count": 0, "score": 0, "last_activity_date": 1498694778, "creation_date": 1498677416, "last_edit_date": 1498694778, "question_id": 44810823, "link": "https://stackoverflow.com/questions/44810823/undefined-reference-to-in-codeblocks-build-log", "closed_reason": "Duplicate", "title": "Undefined reference to in Code::Blocks Build log", "body": "<p>This a test with the GNU Scientific Library release 2.4. This is example 9.9 from documentation (Jun 14, 2017):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;gsl/gsl_rng.h&gt;\n#include &lt;gsl/gsl_randist.h&gt;\n#include &lt;gsl/gsl_permutation.h&gt;\n\nint\nmain (void)\n{\nconst size_t N = 10;\nconst gsl_rng_type * T;\ngsl_rng * r;\n\ngsl_permutation * p = gsl_permutation_alloc (N);\ngsl_permutation * q = gsl_permutation_alloc (N);\n\ngsl_rng_env_setup();\nT = gsl_rng_default;\nr = gsl_rng_alloc (T);\n\nprintf (\"initial permutation:\");\ngsl_permutation_init (p);\ngsl_permutation_fprintf (stdout, p, \" %u\");\nprintf (\"\\n\");\n\nprintf (\" random permutation:\");\ngsl_ran_shuffle (r, p-&gt;data, N, sizeof(size_t));\ngsl_permutation_fprintf (stdout, p, \" %u\");\nprintf (\"\\n\");\n\nprintf (\"inverse permutation:\");\ngsl_permutation_inverse (q, p);\ngsl_permutation_fprintf (stdout, q, \" %u\");\nprintf (\"\\n\");\n\ngsl_permutation_free (p);\ngsl_permutation_free (q);\ngsl_rng_free (r);\n\nreturn 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6E16e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6E16e.png\" alt=\"Linker settings\"></a></p>\n\n<p>Build log:</p>\n\n<pre><code>-------------- Build: Debug in example (compiler: GNU GCC Compiler)---------------\n\ng++ -Wall -fexceptions -g -I../../../../usr/include/gsl -c /home/lucas/Desktop/example/main.cpp -o obj/Debug/home/lucas/Desktop/example/main.o\ng++  -o bin/Debug/example obj/Debug/home/lucas/Desktop/example/main.o   ../../../../usr/include/gsl/gsl_permutation.h ../../../../usr/include/gsl/gsl_randist.h ../../../../usr/include/gsl/gsl_rng.h\nobj/Debug/home/lucas/Desktop/example/main.o: In function `main':\n/home/lucas/Desktop/example/main.cpp:13: undefined reference to `gsl_permutation_alloc'\n/home/lucas/Desktop/example/main.cpp:14: undefined reference to `gsl_permutation_alloc'\n/home/lucas/Desktop/example/main.cpp:16: undefined reference to `gsl_rng_env_setup'\n/home/lucas/Desktop/example/main.cpp:17: undefined reference to `gsl_rng_default'\n/home/lucas/Desktop/example/main.cpp:18: undefined reference to `gsl_rng_alloc'\n/home/lucas/Desktop/example/main.cpp:21: undefined reference to `gsl_permutation_init'\n/home/lucas/Desktop/example/main.cpp:22: undefined reference to `gsl_permutation_fprintf'\n/home/lucas/Desktop/example/main.cpp:26: undefined reference to `gsl_ran_shuffle'\n/home/lucas/Desktop/example/main.cpp:27: undefined reference to `gsl_permutation_fprintf'\n/home/lucas/Desktop/example/main.cpp:31: undefined reference to `gsl_permutation_inverse'\n/home/lucas/Desktop/example/main.cpp:32: undefined reference to `gsl_permutation_fprintf'\n/home/lucas/Desktop/example/main.cpp:35: undefined reference to `gsl_permutation_free'\n/home/lucas/Desktop/example/main.cpp:36: undefined reference to `gsl_permutation_free'\n/home/lucas/Desktop/example/main.cpp:37: undefined reference to `gsl_rng_free'\ncollect2: error: ld returned 1 exit status\nProcess terminated with status 1 (0 minute(s), 0 second(s))\n15 error(s), 0 warning(s) (0 minute(s), 0 second(s))\n</code></pre>\n\n<p>Is there a way to trace this error? Is this an issue with link libraries, search directories, compiler configurations, project headers? I'm using Code::Blocks 16.01</p>\n"}, {"tags": ["c++", "arrays", "unions", "8-bit", "7-bit"], "comments": [{"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 4, "creation_date": 1498675972, "post_id": 44810381, "comment_id": 76601244, "body": "Have you considered <a href=\"http://en.cppreference.com/w/cpp/utility/bitset\" rel=\"nofollow noreferrer\"><code>std::bitset</code></a>?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 5, "creation_date": 1498676017, "post_id": 44810381, "comment_id": 76601276, "body": "<a href=\"http://en.cppreference.com/w/cpp/container/vector_bool\" rel=\"nofollow noreferrer\"><code>std::vector&lt;bool&gt;</code></a> is famously specialized for this."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1498676041, "post_id": 44810381, "comment_id": 76601291, "body": "There was <a href=\"https://stackoverflow.com/questions/44757262/get-10-bits-from-an-array-of-bytes/44757394#44757394\">a very similar question</a> yesterday - it was for packed 10 bit quantities but you should be able to easily adapt the solution to 7 bits."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 1, "creation_date": 1498676725, "post_id": 44810381, "comment_id": 76601724, "body": "Unfortunately, you have to go the manually-shifting way, there is no clearer way"}], "answers": [{"tags": [], "owner": {"reputation": 1226, "user_id": 6324080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUqTh.jpg?s=128&g=1", "display_name": "K. Kirsz", "link": "https://stackoverflow.com/users/6324080/k-kirsz"}, "is_accepted": false, "score": 0, "last_activity_date": 1498678192, "last_edit_date": 1498678192, "creation_date": 1498677527, "answer_id": 44810861, "question_id": 44810381, "link": "https://stackoverflow.com/questions/44810381/accessing-8-bit-data-as-7-bit/44810861#44810861", "title": "Accessing 8-bit data as 7-bit", "body": "<p>Here is one approach without the manual shifting. This is just a crude POC, but hopefully you will be able to get something out of it. I don't know if you are able to easily transform your input into bitset, but i think it should be possible.</p>\n\n<pre><code>int bytes = 0x01234567;\nbitset&lt;32&gt; bs(bytes);\ncout &lt;&lt; \"Input: \" &lt;&lt; bs &lt;&lt; endl;\nfor(int i = 0; i &lt; 5; i++)\n{\n    bitset&lt;7&gt; slice(bs.to_string().substr(i*7, 7));\n    cout &lt;&lt; slice &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Also this is probably much less performant then the bitshifting version, so i wouldn't recommend it for heavy lifting.</p>\n"}, {"tags": [], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "is_accepted": false, "score": 0, "last_activity_date": 1498687193, "last_edit_date": 1498687193, "creation_date": 1498677813, "answer_id": 44810946, "question_id": 44810381, "link": "https://stackoverflow.com/questions/44810381/accessing-8-bit-data-as-7-bit/44810946#44810946", "title": "Accessing 8-bit data as 7-bit", "body": "<p>You can use this to get the index'th 7-bit element from <code>in</code> (note that it doesn't have proper end of array handling). Simple, fast.</p>\n\n<pre><code>int get7(const uint8_t *in, int index) {\n    int fidx = index*7;\n    int idx = fidx&gt;&gt;3;\n    int sidx = fidx&amp;7;\n\n    return (in[idx]&gt;&gt;sidx|in[idx+1]&lt;&lt;(8-sidx))&amp;0x7f;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1498684486, "post_id": 44811041, "comment_id": 76605908, "body": "And depending on how you want to use the results, you could encapsulate the state variables into an input iterator class, which would then make it possible to use range-based for (possibly with the help of <code>boost::iterator_range</code>), <code>&lt;algorithm&gt;</code>, construct a vector from a pair of these iterators, etc."}], "tags": [], "owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "is_accepted": false, "score": 2, "last_activity_date": 1498678224, "creation_date": 1498678224, "answer_id": 44811041, "question_id": 44810381, "link": "https://stackoverflow.com/questions/44810381/accessing-8-bit-data-as-7-bit/44811041#44811041", "title": "Accessing 8-bit data as 7-bit", "body": "<p>Not sure what you mean by \"cleaner\". Generally people who work on this sort of problem regularly consider shifting and masking to be the right primitive tool to use. One can do something like defining a bitstream abstraction with a method to read an arbitrary number of bits off the stream. This abstraction sometimes shows up in compression applications. The internals of the method of course do use shifting and masking.</p>\n\n<p>One fairly clean approach is to write a function which extracts a 7-bit number at any bit index in an array of unsigned char's. Use a division to convert the bit index to a byte index, and modulus to get the bit index within the byte. Then shift and mask. The input bits can span two bytes, so you either have to glue together a 16-bit value before extraction, or do two smaller extractions and or them together to construct the result.</p>\n\n<p>If I were aiming for something moderately performant, I'd likely take one of two approaches:</p>\n\n<p>The first has two state variables saying how many bits to take from the current and next byte. It would use shifting, masking, and bitwise or, to produce the current output (a number between 0 and 127 as an int for example), then the loop would update both state variables via adding and modulus, and would increment the current byte pointers if all bits in the first byte were consumed.</p>\n\n<p>The second approach is to load 56-bits (8 outputs worth of input) into a 64-bit integer and use a fully unrolled structure to extract each of the 8 outputs. Doing this without using unaligned memory reads requires constructing the 64-bit integer piecemeal. (56-bits is special because the starting bit position is byte aligned.)</p>\n\n<p>To go real fast, I might try writing SIMD code in Halide. That's beyond scope here I believe. (And not clear it is going to win much actually.)</p>\n\n<p>Designs which read more than one byte into a integer at a time will likely have to consider processor byte ordering.</p>\n"}, {"tags": [], "owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "is_accepted": false, "score": 1, "last_activity_date": 1498687398, "last_edit_date": 1498687398, "creation_date": 1498684069, "answer_id": 44812565, "question_id": 44810381, "link": "https://stackoverflow.com/questions/44810381/accessing-8-bit-data-as-7-bit/44812565#44812565", "title": "Accessing 8-bit data as 7-bit", "body": "<p>Here is a solution that uses the vector bool specialization. It also uses a similar mechanism to allow access to the seven-bit elements via reference objects.</p>\n\n<p>The member functions allow for the following operations:</p>\n\n<pre><code>uint7_t x{5};               // simple value\nArr&lt;uint7_t&gt; arr(10);       // array of size 10\narr[0] = x;                 // set element\nuint7_t y = arr[0];         // get element\narr.push_back(uint7_t{9});  // add element\narr.push_back(x);           //\nstd::cout &lt;&lt; \"Array size is \" \n    &lt;&lt; arr.size() &lt;&lt; '\\n';  // get size\nfor(auto&amp;&amp; i : arr) \n    std::cout &lt;&lt; i &lt;&lt; '\\n'; // range-for to read values\nint z{50};\nfor(auto&amp;&amp; i : arr)\n    i = z++;                // range-for to change values\nauto&amp;&amp; v = arr[1];          // get reference to second element\nv = 99;                     // change second element via reference\n</code></pre>\n\n<p>Full program:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iterator&gt;\n#include &lt;iostream&gt;\n\nstruct uint7_t {\n    unsigned int i : 7;\n};\n\nstruct seven_bit_ref {\n    size_t begin;\n    size_t end;\n    std::vector&lt;bool&gt;&amp; bits;\n\n    seven_bit_ref&amp; operator=(const uint7_t&amp; right)\n    {\n        auto it{bits.begin()+begin};\n        for(int mask{1}; mask != 1 &lt;&lt; 7; mask &lt;&lt;= 1)\n            *it++ = right.i &amp; mask;\n        return *this;\n    }\n\n    operator uint7_t() const\n    {\n        uint7_t r{};\n        auto it{bits.begin() + begin};\n        for(int i{}; i &lt; 7; ++i)\n            r.i += *it++ &lt;&lt; i;\n        return r;\n    }\n\n    seven_bit_ref operator*()\n    {\n        return *this;\n    }\n\n    void operator++()\n    {\n        begin += 7;\n        end += 7;\n    }\n\n    bool operator!=(const seven_bit_ref&amp; right)\n    {\n        return !(begin == right.begin &amp;&amp; end == right.end);\n    }\n\n    seven_bit_ref operator=(int val)\n    {\n        uint7_t temp{};\n        temp.i = val;\n        operator=(temp);\n        return *this;\n    }\n\n};\n\ntemplate&lt;typename T&gt;\nclass Arr;\n\ntemplate&lt;&gt;\nclass Arr&lt;uint7_t&gt; {\npublic:\n    Arr(size_t size) : bits(size * 7, false) {}\n\n    seven_bit_ref operator[](size_t index)\n    {\n        return {index * 7, index * 7 + 7, bits};\n    }\n    size_t size()\n    {\n        return bits.size() / 7;\n    }\n    void push_back(uint7_t val)\n    {\n        for(int mask{1}; mask != 1 &lt;&lt; 7; mask &lt;&lt;= 1){\n            bits.push_back(val.i &amp; mask);\n        }\n    }\n\n    seven_bit_ref begin()\n    {\n        return {0, 7, bits};\n    }\n\n    seven_bit_ref end()\n    {\n        return {size() * 7, size() * 7 + 7, bits};\n    }\n\n    std::vector&lt;bool&gt; bits;\n};\n\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, uint7_t val)\n{\n    os &lt;&lt; val.i;\n    return os;\n}\n\nint main()\n{\n    uint7_t x{5};               // simple value\n    Arr&lt;uint7_t&gt; arr(10);       // array of size 10\n    arr[0] = x;                 // set element\n    uint7_t y = arr[0];         // get element\n    arr.push_back(uint7_t{9});  // add element\n    arr.push_back(x);           //\n    std::cout &lt;&lt; \"Array size is \" \n        &lt;&lt; arr.size() &lt;&lt; '\\n';  // get size\n    for(auto&amp;&amp; i : arr) \n        std::cout &lt;&lt; i &lt;&lt; '\\n'; // range-for to read values\n    int z{50};\n    for(auto&amp;&amp; i : arr)\n        i = z++;                // range-for to change values\n    auto&amp;&amp; v = arr[1];          // get reference\n    v = 99;                     // change via reference\n    std::cout &lt;&lt; \"\\nAfter changes:\\n\";\n    for(auto&amp;&amp; i : arr)\n        std::cout &lt;&lt; i &lt;&lt; '\\n';\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": false, "score": 1, "last_activity_date": 1498705609, "creation_date": 1498705609, "answer_id": 44815729, "question_id": 44810381, "link": "https://stackoverflow.com/questions/44810381/accessing-8-bit-data-as-7-bit/44815729#44815729", "title": "Accessing 8-bit data as 7-bit", "body": "<p>Process them in groups of 8 (since 8x7 nicely rounds to something 8bit aligned). Bitwise operators are the order of the day here. Faffing around with the last (upto) 7 numbers is a little faffy, but not impossible. (This code assumes these are unsigned 7 bit integers! Signed conversion would require you to do consider flipping the top bit if bit[6] is 1)</p>\n\n<pre><code>// convert 8 x 7bit ints in one go\nvoid extract8(const uint8_t input[7], uint8_t output[8])\n{\n  output[0] =   input[0] &amp; 0x7F;\n  output[1] =  (input[0] &gt;&gt; 7)  | ((input[1] &lt;&lt; 1) &amp; 0x7F);\n  output[2] =  (input[1] &gt;&gt; 6)  | ((input[2] &lt;&lt; 2) &amp; 0x7F);\n  output[3] =  (input[2] &gt;&gt; 5)  | ((input[3] &lt;&lt; 3) &amp; 0x7F);\n  output[4] =  (input[3] &gt;&gt; 4)  | ((input[4] &lt;&lt; 4) &amp; 0x7F);\n  output[5] =  (input[4] &gt;&gt; 3)  | ((input[5] &lt;&lt; 5) &amp; 0x7F);\n  output[6] =  (input[5] &gt;&gt; 2)  | ((input[6] &lt;&lt; 6) &amp; 0x7F);\n  output[7] =   input[6] &gt;&gt; 1;\n}\n\n// convert array of 7bit ints to 8bit\nvoid seven_bit_to_8bit(const uint8_t* const input, uint8_t* const output, const size_t count)\n{\n  size_t count8 = count &gt;&gt; 3;\n  for(size_t i = 0; i &lt; count8; ++i)\n  {\n    extract8(input + 7 * i, output + 8 * i);\n  }\n\n  // handle remaining (upto) 7 bytes \n  const size_t countr = (count % 8);\n  if(countr)\n  {\n    // how many bytes do we need to copy from the input?\n    size_t remaining_bits = 7 * countr;\n    if(remaining_bits % 8)\n    {\n      // round to next nearest multiple of 8\n      remaining_bits += (8 - remaining_bits % 8);\n    }\n    remaining_bits /= 8;\n    {\n      uint8_t in[7] = {0}, out[8] = {0};\n      for(size_t i = 0; i &lt; remaining_bits; ++i)\n      {\n        in[i] = input[count8 * 7 + i];\n      }\n      extract8(in, out);\n      for(size_t i = 0; i &lt; countr; ++i)\n      {\n        output[count8 * 8 + i] = in[i];\n      }\n    }\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "is_accepted": false, "score": 1, "last_activity_date": 1498761913, "last_edit_date": 1498761913, "creation_date": 1498760109, "answer_id": 44832297, "question_id": 44810381, "link": "https://stackoverflow.com/questions/44810381/accessing-8-bit-data-as-7-bit/44832297#44832297", "title": "Accessing 8-bit data as 7-bit", "body": "<p>The following code works as you have asked for it, but first the output and <a href=\"https://ideone.com/oYGC5E\" rel=\"nofollow noreferrer\">live example on ideone</a>.</p>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Before changing values...:\n7 bit representation: 1111111 0000000 0000000 0000000 0000000 0000000 0000000 0000000 \n8 bit representation: 11111110 00000000 00000000 00000000 00000000 00000000 00000000 \n\nAfter changing values...:\n7 bit representation: 1000000 1001100 1110010 1011010 1010100 0000111 1111110 0000000 \n8 bit representation: 10000001 00110011 10010101 10101010 10000001 11111111 00000000 \n\n8 Bits: 11111111 to ulong: 255\n7 Bits: 1111110 to ulong: 126\n\nAfter changing values...:\n7 bit representation: 0010000 0101010 0100000 0000000 0000000 0000000 0000000 0000000 \n8 bit representation: 00100000 10101001 00000000 00000000 00000000 00000000 00000000 \n</code></pre>\n\n<p>It is very straight forward using a <a href=\"http://en.cppreference.com/w/cpp/utility/bitset\" rel=\"nofollow noreferrer\">std::bitset</a> in a class called <code>BitVector</code>. I implement one getter and setter. The getter returns also a std::bitset at the given index <code>selIdx</code> with a given template argument size <code>M</code>. The given idx will be multiplied by the given size <code>M</code> to get the right position. The returned bitset can also be converted to numerical or string values.<br>\nThe setter uses an uint8_t value as input and again the index <code>selIdx</code>. The bits will be shifted to the right position into the bitset.</p>\n\n<p>Further you can use the getter and setter with different sizes because of the template argument <code>M</code>, which means you can work with either 7 or 8 bit representation but also 3 or what ever you like.</p>\n\n<p>I'm sure this code is not the best concerning speed, but I think it is a very clear and clean solution. Also it is not complete at all as there are just one getter, one setter and two constructors. Remember to implement error checking concerning indexes and sizes.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;bitset&gt;\n\ntemplate &lt;size_t N&gt; class BitVector\n{\nprivate:\n\n   std::bitset&lt;N&gt; _data;\n\npublic:\n\n   BitVector (unsigned long num) : _data (num) { };\n   BitVector (const std::string&amp; str) : _data (str) { };\n\n   template &lt;size_t M&gt;\n   std::bitset&lt;M&gt; getBits (size_t selIdx)\n   {\n      std::bitset&lt;M&gt; retBitset;\n      for (size_t idx = 0; idx &lt; M; ++idx)\n      {\n         retBitset |= (_data[M * selIdx + idx] &lt;&lt; (M - 1 - idx));\n      }\n      return retBitset;\n   }\n\n   template &lt;size_t M&gt;\n   void setBits (size_t selIdx, uint8_t num)\n   {\n      const unsigned char* curByte = reinterpret_cast&lt;const unsigned char*&gt; (&amp;num);\n      for (size_t bitIdx = 0; bitIdx &lt; 8; ++bitIdx)\n      {\n         bool bitSet = (1 == ((*curByte &amp; (1 &lt;&lt; (8 - 1 - bitIdx))) &gt;&gt; (8 - 1 - bitIdx)));\n         _data.set(M * selIdx + bitIdx, bitSet);\n      }\n   }\n\n   void print_7_8()\n   {\n      std:: cout &lt;&lt; \"\\n7 bit representation: \";\n      for (size_t idx = 0; idx &lt; (N / 7); ++idx)\n      {\n         std::cout &lt;&lt; getBits&lt;7&gt;(idx) &lt;&lt; \" \";\n      }\n      std:: cout &lt;&lt; \"\\n8 bit representation: \";\n      for (size_t idx = 0; idx &lt; N / 8; ++idx)\n      {\n         std::cout &lt;&lt; getBits&lt;8&gt;(idx) &lt;&lt; \" \";\n      }\n   }\n};\n\nint main ()\n{\n   BitVector&lt;56&gt; num = 127;\n\n   std::cout &lt;&lt; \"Before changing values...:\";\n   num.print_7_8();\n\n   num.setBits&lt;8&gt;(0, 0x81);\n   num.setBits&lt;8&gt;(1, 0b00110011);\n   num.setBits&lt;8&gt;(2, 0b10010101);\n   num.setBits&lt;8&gt;(3, 0xAA);\n   num.setBits&lt;8&gt;(4, 0x81);\n   num.setBits&lt;8&gt;(5, 0xFF);\n   num.setBits&lt;8&gt;(6, 0x00);\n\n   std::cout &lt;&lt; \"\\n\\nAfter changing values...:\";\n   num.print_7_8();\n\n   std::cout &lt;&lt; \"\\n\\n8 Bits: \" &lt;&lt; num.getBits&lt;8&gt;(5) &lt;&lt; \" to ulong: \" &lt;&lt; num.getBits&lt;8&gt;(5).to_ulong();\n   std::cout &lt;&lt; \"\\n7 Bits: \" &lt;&lt; num.getBits&lt;7&gt;(6) &lt;&lt; \" to ulong: \" &lt;&lt; num.getBits&lt;7&gt;(6).to_ulong();\n\n   num = BitVector&lt;56&gt;(std::string(\"1001010100000100\"));\n   std::cout &lt;&lt; \"\\n\\nAfter changing values...:\";\n   num.print_7_8();\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 6264478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aZxrCWP6hD4/AAAAAAAAAAI/AAAAAAAAAB8/M4sG_ekFO48/photo.jpg?sz=128", "display_name": "powturbo", "link": "https://stackoverflow.com/users/6264478/powturbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1498824371, "creation_date": 1498824371, "answer_id": 44846131, "question_id": 44810381, "link": "https://stackoverflow.com/questions/44810381/accessing-8-bit-data-as-7-bit/44846131#44846131", "title": "Accessing 8-bit data as 7-bit", "body": "<p>You can use direct access or bulk bit packing/unpacking as in <a href=\"https://github.com/powturbo/TurboPFor\" rel=\"nofollow noreferrer\">TurboPFor:Integer Compression</a> </p>\n\n<pre><code>// Direct read access \n// b : bit width 0-16 (7 in your case)\n\n#define bzhi32(u,b) ((u) &amp; ((1u  &lt;&lt;(b))-1))\n\nstatic inline unsigned  bitgetx16(unsigned char *in, \n                                  unsigned  idx, \n                                  unsigned b) { \n  unsigned bidx = b*idx; \n  return bzhi32( *(unsigned *)((uint16_t *)in+(bidx&gt;&gt;4)) &gt;&gt; (bidx&amp; 0xf), b );\n}\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 5802400, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/X3zBP.jpg?s=128&g=1", "display_name": "Howard_Schmidtt", "link": "https://stackoverflow.com/users/5802400/howard-schmidtt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1971, "favorite_count": 1, "answer_count": 7, "score": 4, "last_activity_date": 1514996147, "creation_date": 1498675799, "last_edit_date": 1514996147, "question_id": 44810381, "link": "https://stackoverflow.com/questions/44810381/accessing-8-bit-data-as-7-bit", "title": "Accessing 8-bit data as 7-bit", "body": "<p>I have an array of 100 <code>uint8_t</code>'s, which is to be treated as a stream of 800 bits, and dealt with 7 bits at a time. So in other words, if the first element of the 8-bit array holds <code>0b11001100</code> and the second holds <code>ob11110000</code> then when I come to read it in 7-bit format, the first element of the 7-bit array would be <code>0b1100110</code> and the second would be <code>0b0111100</code> with the remaining 2 bits being held in the 3rd.\nThe first thing I tried was a union...</p>\n\n<pre><code>struct uint7_t {\n    uint8_t i1:7;\n};\n\nunion uint7_8_t {\n    uint8_t u8[100];\n    uint7_t u7[115];\n};\n</code></pre>\n\n<p>but of course everything's byte aligned and I essentially end up simply loosing the 8th bit of each element.</p>\n\n<p>Does anyone have any idea's on how I can go about doing this?</p>\n\n<p>Just to be clear, this is something of a visual representation of the result of the union:</p>\n\n<p><code>xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx</code> 32 bits of 8 bit data<br>\n<code>0xxxxxxx 0xxxxxxx 0xxxxxxx 0xxxxxxx</code> 32 bits of 7-bit data.</p>\n\n<p>And this represents what it is that I want to do instead:</p>\n\n<p><code>xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx</code> 32 bits of 8 bit data<br>\n<code>xxxxxxx xxxxxxx xxxxxxx xxxxxxx xxxx</code> 32 bits of 7-bit data.</p>\n\n<p>I'm aware the last bits may be padded but that's fine, I just want someway of accessing each byte 7 bits at a time without losing any of the 800 bits. So far the only way I can think of is lots of bit shifting, which of course would work but I'm sure there's a cleaner way of going about it(?)</p>\n\n<p>Thanks in advance for any answers.</p>\n"}, {"tags": ["c++", "halide"], "comments": [{"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1498682065, "post_id": 44810284, "comment_id": 76604751, "body": "How are you compiling this and how are you calling the result? Also how is &quot;images&quot; declared? The atan2 expression and definition of result looks fine. My guess is you are not setting up the dimensions on the input and output buffers correctly. If you always know you want four input images and you don not want to require them to to be in the same memory block, you can uses for separate arguments for them."}, {"owner": {"reputation": 21, "user_id": 7778901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6486c60dca6de04ba8f48a06c3503d36?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;ystein", "link": "https://stackoverflow.com/users/7778901/%c3%98ystein"}, "reply_to_user": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1499713545, "post_id": 44810284, "comment_id": 77013629, "body": "I have added a complete example that does not work as expected now. I have a number of functions that work on stacks of images, and they take in a variable amount of images. I also want the images to reside in contiguous memory, something which helps me speed up the memory transfers between the CPU and the GPU."}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1499814330, "post_id": 44810284, "comment_id": 77065843, "body": "I think if you call &quot;images.set_host_dirty()&quot; right after the loop that called generatePhaseImage, it will work. This strikes me as a bug but I&#39;m still tracking it down. (My guess is the &quot;sliced&quot; call produces another Buffer and that Buffer is getting marked dirty, but the images one is not. This makes perfect sense, but certainly isn&#39;t what is wanted...)"}, {"owner": {"reputation": 21, "user_id": 7778901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6486c60dca6de04ba8f48a06c3503d36?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;ystein", "link": "https://stackoverflow.com/users/7778901/%c3%98ystein"}, "reply_to_user": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1499976840, "post_id": 44810284, "comment_id": 77152710, "body": "It seems to work now after adding images.set_host_dirty(). Thanks a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "is_accepted": false, "score": 0, "last_activity_date": 1499815855, "creation_date": 1499815855, "answer_id": 45046035, "question_id": 44810284, "link": "https://stackoverflow.com/questions/44810284/halide-computing-a-result-image-2d-buffer-from-a-stack-of-input-images-3d-bu/45046035#45046035", "title": "Halide: Computing a result image (2D buffer) from a stack of input images (3D buffer)", "body": "<p>Per the comment under the updated question, I am fairly sure the issue is the input Buffer is not being marked host dirty, so it does not get copied to the GPU. This is somewhat a bug in the buffer logic, but I'm not sure we'll be able to fix it. Calling \"set_host_dirty\" on the Buffer explicitly should fix the issue.</p>\n"}], "owner": {"reputation": 21, "user_id": 7778901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6486c60dca6de04ba8f48a06c3503d36?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;ystein", "link": "https://stackoverflow.com/users/7778901/%c3%98ystein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 608, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499815855, "creation_date": 1498675441, "last_edit_date": 1499713293, "question_id": 44810284, "link": "https://stackoverflow.com/questions/44810284/halide-computing-a-result-image-2d-buffer-from-a-stack-of-input-images-3d-bu", "title": "Halide: Computing a result image (2D buffer) from a stack of input images (3D buffer)", "body": "<p>I am a beginner with Halide. I would like to compute a result image from a stack of input images, and I want to accelerate it using the GPU (currently I am using CUDA as the target). For example, I want to calculate the atan2 of 4 images such as below:</p>\n\n<pre><code>Func result;\nresult(x,y) = Halide::atan2(images(x,y,3) - images(x,y,1), images(x,y,0) - images(x,y,2));\n</code></pre>\n\n<p>I am having problems with this. It produces either an empty result array or a result array with bogus values. </p>\n\n<p>Note that it produces correct results if I modify the function to process only a single image and pass in a two-dimensional input buffer, but as soon as I make the input array three-dimensional and send in a stack of N images, something goes wrong. </p>\n\n<p>Is there an error in my code? Is there something special I need to do when I pass in a 3D buffer (with N images) but only loop over x and y in the Halide function?</p>\n\n<p>See full code below:</p>\n\n<pre><code>#include \"Halide.h\"\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n\nusing namespace Halide;\n\nvoid generatePhaseImage(Halide::Buffer&lt;float&gt; image, float phi)\n{\n    for (int y=0; y&lt;image.height(); y++)\n    {\n        for (int x=0; x&lt;image.width(); x++)\n        {\n            image(x,y) = 128.0f + 128.0f * sin((2.0f*M_PI * static_cast&lt;float&gt;(x) / 64.0f) + phi);\n        }\n    }\n}    \n\nvoid writeBinaryFile(const std::string&amp; filename, const Buffer&lt;float&gt;&amp; image)\n{\n    std::ofstream f(filename.c_str(), std::ios::binary);\n\n    std::cout &lt;&lt; \"Writing image of height \" &lt;&lt; image.height() &lt;&lt; \" \";\n    std::cout &lt;&lt; \"and width \" &lt;&lt; image.width() &lt;&lt; std::endl;\n\n    for (int i=0; i&lt;image.height(); i++)\n    {\n        for (int j=0; j&lt;image.width(); j++)\n        {\n            f.write(reinterpret_cast&lt;const char*&gt;(&amp;image(i,j)), sizeof(float));\n        }\n    }\n}\n\nint main(int argc, char **argv) \n{\n    Var x, y, c, i, ii, xo, yo, xi, yi;\n\n    int h = 100;\n    int w = 100;\n\n    Buffer&lt;float&gt; images(w, h, 4);\n\n    for (int i=0; i&lt;4; i++)\n    {\n        float phi = i * (2*M_PI / 4.);        \n        generatePhaseImage(images.sliced(2, i), phi);\n    }\n\n    Func phaseStepping;\n    phaseStepping(x,y) = Halide::atan2( images(x,y,3) - images(x,y,1), images(x,y,0) - images(x,y,2));\n\n    for (int i=0; i&lt;4; i++)\n    {\n        std::stringstream ss;\n        ss &lt;&lt; \"image\" &lt;&lt; i &lt;&lt;\".bin\";\n        writeBinaryFile(ss.str(), images.sliced(2, i));\n    }\n\n    Target target = get_host_target();\n    target.set_feature(Target::CUDA);\n    target.set_feature(Target::Debug);\n\n    phaseStepping.gpu_tile(x, y, xo, yo, xi, yi, 8, 8);\n    phaseStepping.compile_jit(target);\n\n    Buffer&lt;float&gt; result(w,h);\n    phaseStepping.realize(result);\n\n    result.copy_to_host();  \n    writeBinaryFile(\"result.bin\", result);\n}\n</code></pre>\n\n<p>The output of the code is shown below:</p>\n\n<pre><code>Writing image of height 100 and width 100\nWriting image of height 100 and width 100\nWriting image of height 100 and width 100\nWriting image of height 100 and width 100\nEntering Pipeline phaseStepping\n Input Buffer images: buffer(0, 0x0, 0x564812eefd80, 0, float32, {0, 100, 1}, {0, 100, 100}, {0, 4, 10000})\n Input (void *) __user_context: 0x7ffff380ac68\n Output Buffer phaseStepping: buffer(0, 0x0, 0x56481325b200, 0, float32, {0, 100, 1}, {0, 100, 100})\nCUDA: halide_cuda_initialize_kernels (user_context: 0x0, state_ptr: 0x7f76cbb2b000, ptx_src: 0x7f76cbb28340, size: 6919\n    load_libcuda (user_context: 0x0)\n    Loaded CUDA runtime library: libcuda.so\n    Got device 0\n      GeForce GTX 560\n      total memory: 959 MB\n      max threads per block: 1024\n      warp size: 32\n      max block size: 1024 1024 64\n      max grid size: 65535 65535 65535\n      max shared memory per block: 49152\n      max constant memory per block: 65536\n      compute capability 2.1\n      cuda cores: 7 x 48 = 48\n    cuCtxCreate 0 -&gt; 0x5648134ab8d0(3020)\n    cuModuleLoadData 0x7f76cbb28340, 6919 -&gt; 0x56481386f850\n    Time: 1.857735e+00 ms\nhalide_copy_to_device 0x564812e02a68, host: 0x56481325b200, dev: 0, host_dirty: 0, dev_dirty: 0\nhalide_device_malloc: 0x564812e02a68 interface 0x7f76cbb340f0 host: 0x56481325b200, dev: 0, host_dirty: 0, dev_dirty:0 buf current interface: 0x0\nCUDA: halide_cuda_device_malloc (user_context: 0x7ffff380ac68, buf: 0x564812e02a68)\n    allocating buffer(0, 0x0, 0x56481325b200, 0, float32, {0, 100, 1}, {0, 100, 100})\n    cuMemAlloc 40000 -&gt; 0x501700000\n    Time: 1.549260e-01 ms\nhalide_copy_to_device 0x564812dc6418, host: 0x564812eefd80, dev: 0, host_dirty: 0, dev_dirty: 0\nhalide_device_malloc: 0x564812dc6418 interface 0x7f76cbb340f0 host: 0x564812eefd80, dev: 0, host_dirty: 0, dev_dirty:0 buf current interface: 0x0\nCUDA: halide_cuda_device_malloc (user_context: 0x7ffff380ac68, buf: 0x564812dc6418)\n    allocating buffer(0, 0x0, 0x564812eefd80, 0, float32, {0, 100, 1}, {0, 100, 100}, {0, 4, 10000})\n    cuMemAlloc 160000 -&gt; 0x501800000\n    Time: 1.099330e-01 ms\nCUDA: halide_cuda_run (user_context: 0x7ffff380ac68, entry: kernel_phaseStepping_s0_y_yo___block_id_y, blocks: 13x13x1, threads: 8x8x1, shmem: 0\nGot context.\nGot module 0x56481386f850\nGot function 0x56481387b2b0\n    halide_cuda_run 0 4 [0x6400000064 ...] 0\n    halide_cuda_run 1 4 [0x64 ...] 0\n    halide_cuda_run 2 4 [0x0 ...] 0\n    halide_cuda_run 3 4 [0x6400000000 ...] 0\n    halide_cuda_run 4 4 [0x4000000064 ...] 0\n    halide_cuda_run 5 8 [0x501800000 ...] 1\n    halide_cuda_run 6 8 [0x501700000 ...] 1\n    halide_cuda_run translated arg5 [0x501800000 ...]\n    halide_cuda_run translated arg6 [0x501700000 ...]\n    Time: 4.394600e-02 ms\nExiting Pipeline phaseStepping\nhalide_copy_to_host 0x564812e02a68\ncopy_to_host_already_locked 0x564812e02a68 dev_dirty is true\nCUDA: halide_cuda_copy_to_host (user_context: 0x0, buf: 0x564812e02a68)\nc.extent[0] = 100\nc.extent[1] = 100\n    cuMemcpyDtoH 0x501700000 -&gt; 0x56481325b200, 40000 bytes\n    Time: 2.062520e-01 ms\nWriting image of height 100 and width 100\nhalide_device_free: 0x564812e02a68 buf dev 21498953728 interface 0x7f76cbb340f0\nCUDA: halide_cuda_device_free (user_context: 0x0, buf: 0x564812e02a68)\n    cuMemFree 0x501700000\n    Time: 7.846700e-02 ms\nhalide_device_free: 0x564812dc6418 buf dev 21500002304 interface 0x7f76cbb340f0\nCUDA: halide_cuda_device_free (user_context: 0x0, buf: 0x564812dc6418)\n    cuMemFree 0x501800000\n    Time: 8.416100e-02 ms\n</code></pre>\n"}, {"tags": ["c++", "c++11", "metaprogramming", "constexpr", "stdarray"], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 6, "last_activity_date": 1498687348, "last_edit_date": 1498687348, "creation_date": 1498684461, "answer_id": 44812649, "question_id": 44810239, "link": "https://stackoverflow.com/questions/44810239/compile-error-use-constexpr-to-declare-stdarray-size/44812649#44812649", "title": "Compile Error: Use constexpr to declare std::array size", "body": "<blockquote>\n  <p>for my understanding constexpr tells the compiler to calculate functions during compile time instead of running time.</p>\n</blockquote>\n\n<p>Not exactly: with <code>constexpr</code> the compiler can (not must) calculate function compile time. And the compiler do it when it's necessary and possible.</p>\n\n<p>In case of </p>\n\n<pre><code>std::array&lt;int, foo(5)&gt; arr; // OK\n</code></pre>\n\n<p>it's necessary (because the second template argument of <code>std::array</code> must be known at compile time) and possible (because 5 is known at compile time).</p>\n\n<p>But with </p>\n\n<pre><code>int i = 10;\nstd::array&lt;int, foo(i)&gt; arr1; // Error\n</code></pre>\n\n<p>it's necessary (<code>std::array</code>) but not possible (because <code>i</code> is a not-constant variable and the compiler can't use the <code>i</code> value compile time but only run time).</p>\n\n<p>It's necessary but not possible, so the error.</p>\n\n<p>But you can write</p>\n\n<pre><code>int i { 10 };\nint j { foo(i) };\n</code></pre>\n\n<p>because it's not possible call <code>foo(i)</code> compile time but it isn't necessary (because <code>j</code> can be initialized run time). So <code>foo(i)</code> is called (supposedly) run time.</p>\n\n<p>To compile the <code>std::array</code> using <code>foo(i)</code>, you should define <code>i</code> as <code>constexpr</code> (or <code>const</code>)</p>\n\n<pre><code>constexpr int i { 10 };\n</code></pre>\n\n<p>so the compiler can use the value of <code>i</code> compile time.</p>\n\n<blockquote>\n  <p>Why? i is declared beforehand why does it have to be a const?</p>\n</blockquote>\n\n<p>Short answer: because the C++11 standard say so.</p>\n\n<p>Long answer: because, in this way, it's simpler to construct a compiler. If you want to use a value compile time, you can declare it as <code>constexpr</code> and the compiler check that it is never modified. It's (relatively) simple to do.</p>\n\n<p>Otherwise, if you could use compile time the value of a not-constant variable, the compiler should follow the story of a variable to determine it's value when used in a <code>constexpr</code> function. In your toy example is simple, in real life would be a nightmare.</p>\n"}], "owner": {"reputation": 31, "user_id": 8196678, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bf96d06c900fed1335b747f4a47d5a76?s=128&d=identicon&r=PG&f=1", "display_name": "orsonl", "link": "https://stackoverflow.com/users/8196678/orsonl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498687348, "creation_date": 1498675283, "last_edit_date": 1498685185, "question_id": 44810239, "link": "https://stackoverflow.com/questions/44810239/compile-error-use-constexpr-to-declare-stdarray-size", "title": "Compile Error: Use constexpr to declare std::array size", "body": "<p>I am learning <code>constexpr</code> and, for my understanding, <code>constexpr</code> tells the compiler to calculate functions during compile time instead of running time. I used the following code for testing but bumped into an error I really don't understand. Can you please explain why?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;array&gt;\nusing namespace std;\n\nconstexpr int foo(int i)\n{\n    return i + 5;\n}\n\nint main()\n{\n    int i = 10;\n    std::array&lt;int, foo(5)&gt; arr; // OK\n    // But...\n    std::array&lt;int, foo(i)&gt; arr1; // Error\n}\n</code></pre>\n\n<p>The error is:  the value of '<code>i</code>' is not usable in a constant expression. Why? <code>i</code> is declared beforehand why does it have to be a <code>const</code>?</p>\n"}, {"tags": ["c++", "windows", "visual-studio-2017", "lapack"], "comments": [{"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498674486, "post_id": 44809966, "comment_id": 76600380, "body": "How did you install the BLAS and LAPACK libraries? Are they compiled from MinGW? Because that might be an issue."}, {"owner": {"reputation": 1289, "user_id": 1798097, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hb4ho.png?s=128&g=1", "display_name": "Anthony Lethuillier", "link": "https://stackoverflow.com/users/1798097/anthony-lethuillier"}, "reply_to_user": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498674536, "post_id": 44809966, "comment_id": 76600408, "body": "I used the prebuilt libraries found here: <a href=\"http://icl.cs.utk.edu/lapack-for-windows/lapack/index.html#libraries\" rel=\"nofollow noreferrer\">icl.cs.utk.edu/lapack-for-windows/lapack/index.html#librarie&zwnj;&#8203;s</a> I then linked the folder where the .lib files were to Visual Studio following the instructions on the page."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 1, "creation_date": 1498674768, "post_id": 44809966, "comment_id": 76600538, "body": "Can you give us any more information? What&#39;s the msbuild command, or if you&#39;re using an IDE, what does your project file look like? How are you linking to them?   Are you using the prebuild MinGW or Visual Studio libraries (they are not the same)."}], "answers": [{"tags": [], "owner": {"reputation": 1289, "user_id": 1798097, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hb4ho.png?s=128&g=1", "display_name": "Anthony Lethuillier", "link": "https://stackoverflow.com/users/1798097/anthony-lethuillier"}, "is_accepted": true, "score": 1, "last_activity_date": 1498683856, "creation_date": 1498683856, "answer_id": 44812516, "question_id": 44809966, "link": "https://stackoverflow.com/questions/44809966/lapack-function-dgtsv-giving-unresolved-external-symbol-with-c-visual-studio/44812516#44812516", "title": "LAPACK function dgtsv giving unresolved external symbol with c++/Visual Studio", "body": "<p>The solution was to add an underscore after the function name, i.e. :</p>\n\n<pre><code>extern \"C\" {\n    void dgtsv_(int*, int*, double*, double*, double*, double*, int*, int*);\n}\n</code></pre>\n"}], "owner": {"reputation": 1289, "user_id": 1798097, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hb4ho.png?s=128&g=1", "display_name": "Anthony Lethuillier", "link": "https://stackoverflow.com/users/1798097/anthony-lethuillier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 44812516, "answer_count": 1, "score": 1, "last_activity_date": 1498683856, "creation_date": 1498674299, "question_id": 44809966, "link": "https://stackoverflow.com/questions/44809966/lapack-function-dgtsv-giving-unresolved-external-symbol-with-c-visual-studio", "title": "LAPACK function dgtsv giving unresolved external symbol with c++/Visual Studio", "body": "<p>I am trying to compile a code under Windows10/Visual Studio 2017, for this code I have to use the <code>dgtsv</code> function of the LAPACK library.</p>\n\n<p>I've linked Visual Studio with my <em>BLAS</em> and <em>LAPACK</em> libraries and copied the dll's to system32.</p>\n\n<p>I've also installed <em>MinGW</em> with the g++ and fortran compiler.</p>\n\n<pre><code>extern \"C\" {\n    void dgtsv(int*, int*, double*, double*, double*, double*, int*, int*);\n}\n</code></pre>\n\n<p>But the compiler gives me the following error:</p>\n\n<pre><code>LNK2019 unresolved external symbol dgtsv referenced in function \"private: void __cdecl\"\n</code></pre>\n\n<p>Thank you for any advice you could give me.</p>\n"}, {"tags": ["c++", "windows", "iocp"], "comments": [{"owner": {"reputation": 7529, "user_id": 47733, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8d29a2ec53709fb1a607e6203a6210fa?s=128&d=identicon&r=PG", "display_name": "lsalamon", "link": "https://stackoverflow.com/users/47733/lsalamon"}, "edited": false, "score": 0, "creation_date": 1498675528, "post_id": 44809948, "comment_id": 76600975, "body": "You should first debug your code. Locate leak by instrumentating your code or use [UMDH] (<a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/using-umdh-to-find-a-user-mode-memory-leak\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows-hardware/drivers/debugger/&zwnj;&#8203;&hellip;</a> )."}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "reply_to_user": {"reputation": 7529, "user_id": 47733, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8d29a2ec53709fb1a607e6203a6210fa?s=128&d=identicon&r=PG", "display_name": "lsalamon", "link": "https://stackoverflow.com/users/47733/lsalamon"}, "edited": false, "score": 0, "creation_date": 1498675756, "post_id": 44809948, "comment_id": 76601119, "body": "Isalamon: I know what&#39;s going on roughly, every time that I am about to do an async send or receive I check whether the deque that contains my OverlappedEx objects has anything. If not I create a new object on the heap. When the completion routine comes back / or error occurs I reuse the object by sticking it back in that deque."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498676516, "post_id": 44809948, "comment_id": 76601598, "body": "Huge amount of code and still not a complete <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Off topic: <code>using namespace std;</code> is a bad, bad thing to do to people by putting it in a header."}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498676769, "post_id": 44809948, "comment_id": 76601746, "body": "@user4581301: It&#39;s still at the prototyping stage."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1498691116, "post_id": 44809948, "comment_id": 76608315, "body": "also i can advice to you use rio (if you use win8+ only) - this give great advantage for udp"}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1498692160, "post_id": 44809948, "comment_id": 76608601, "body": "@RbMm: Thanks, but our machines are Win7. We might be migrating to Win10 later this year."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1498696141, "post_id": 44809948, "comment_id": 76609532, "body": "The code as posted silently leaks the <code>OverlappedEx</code> object whenever the dequeued packet reports that the I/O failed or processed zero bytes.  Are you sure that isn&#39;t happening?  I notice that when a receive operation completes successfully, a new one is <i>always</i> started - there doesn&#39;t seem to be any provision for a connection to ever be closed?"}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1498748035, "post_id": 44809948, "comment_id": 76637426, "body": "@HarryJohnston: Yes, I should handle the 0 bytes case as well. Regarding the connection being closed, I am still at the prototyping stage. On top of leaking memory in Release mode I get random crashes at address 0x00000000. I am tempted to try boost::asio :)"}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1498748200, "post_id": 44809948, "comment_id": 76637570, "body": "@HarryJohnston We have mixed UDP and TCP comms, I am mainly interested in UDP at this point"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1498771878, "post_id": 44809948, "comment_id": 76651093, "body": "But are you sure that <code>NetworkThread</code> silently discarding completion packets isn&#39;t the cause of the memory leak?  It is very unlikely that the IOCP packets are just disappearing."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1498772136, "post_id": 44809948, "comment_id": 76651201, "body": "I do see one pretty serious bug, resulting in undefined behavior: when you call WSARecvFrom, <code>&amp;senderAddr</code> and <code>&amp;senderAddrSize</code> point to local variables.  When the I/O completes, the part of the stack where they used to live will get clobbered.  At that point, anything could happen."}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1498833328, "post_id": 44809948, "comment_id": 76678530, "body": "@HarryJohnston Good catch! I wouldn&#39;t even suspect that. (&amp;senderAddr and &amp;senderAddrSize)"}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "edited": false, "score": 0, "creation_date": 1498859495, "post_id": 44809948, "comment_id": 76691324, "body": "I decided to go with a circular buffer + reference counting. But I do need from time to time to reset the reference so that I can use the OverlappedEx object because by far not all objects are released (ref count decremented). And I think that I covered all the cases where I need to decrement the ref count."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "edited": false, "score": 0, "creation_date": 1498675899, "post_id": 44810366, "comment_id": 76601204, "body": "RbMm: Thanks a lot.Every time I get the object back when a completion routine is called I put it back in the deque. That&#39;s how I reuse them."}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "edited": false, "score": 0, "creation_date": 1498676036, "post_id": 44810366, "comment_id": 76601288, "body": "RbMm: Why static cast? OverlappedEx derives from OVERLAPPED."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "edited": false, "score": 1, "creation_date": 1498676148, "post_id": 44810366, "comment_id": 76601367, "body": "@MUXCAH - exactly because this - and must be <code>static_cast</code>"}, {"owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "edited": false, "score": 0, "creation_date": 1498676434, "post_id": 44810366, "comment_id": 76601542, "body": "Isn&#39;t dynamic_cast  used when downcasting?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "edited": false, "score": 1, "creation_date": 1498676679, "post_id": 44810366, "comment_id": 76601697, "body": "@MUXCAH - but for what <code>dynamic_cast</code> here ?! exactly <code>static_cast</code> is need and correct. in your current implementation address of <code>OVERLAPPED</code> and <code>OverlappedEx</code> is the same - so <code>reinterpret_cast</code> and <code>static_cast</code> give the same result. however if you change definition of <code>OverlappedEx</code> (say add another base class before <code>OVERLAPPED</code> or virtual methods) this will be breaked (<code>reinterpret_cast</code>) while <code>static_cast</code> will be correct worked"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "edited": false, "score": 1, "creation_date": 1498676800, "post_id": 44810366, "comment_id": 76601754, "body": "@MUXCAH - so for clear say - in current binary implementation <code>OverlappedEx* data = reinterpret_cast&lt;OverlappedEx*&gt;(pOverlapped);</code> is wok correct. but from c++ rules - here need exactly <code>static_cast</code> (not reinterpret or dynamic)"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 1, "last_activity_date": 1498676107, "last_edit_date": 1498676107, "creation_date": 1498675748, "answer_id": 44810366, "question_id": 44809948, "link": "https://stackoverflow.com/questions/44809948/memory-usage-with-iocp/44810366#44810366", "title": "Memory usage with IOCP", "body": "<p>your implementation of <code>void Release()</code> have no sense - you decrement <code>m_refCount</code> and so what ? must be</p>\n\n<pre><code>void Release()\n{\n    if (!InterlockedDecrement(&amp;m_refCount)) delete this;\n}\n</code></pre>\n\n<p>as result you never free <code>OverlappedEx* data</code> - this what i just view and this give memory leak.</p>\n\n<p>also can advice - use <code>WaitForSingleObject(CCommunicationManager::s_hShutdownEvent, 0);</code> this is bad idea for detect shutdown. call only <code>GetQueuedCompletionStatus</code> and for shutdown call <code>PostQueuedCompletionStatus(s_IOCompletionPort, 0, 0, 0)</code> several times(number or threads listen on <code>s_IOCompletionPort</code>) and if thread view <code>pOverlapped==0</code> - just exit.</p>\n\n<p>use </p>\n\n<pre><code>OverlappedEx* data = static_cast&lt;OverlappedEx*&gt;(pOverlapped);\n</code></pre>\n\n<p>instead of <code>reinterpret_cast</code></p>\n\n<p>make <code>~OverlappedEx()</code> <code>private</code> - it must not be direct called, only via <code>Release</code></p>\n\n<pre><code>            olp-&gt;Release();\n            m_olps.push_back(olp);\n</code></pre>\n\n<p>after you call <code>Release()</code> on object you must not it more access here, so or <code>olp-&gt;Release()</code> or <code>m_olps.push_back(olp);</code> but not both. this kill all logic of <code>Release</code> may be you need overwrite <code>operator delete</code> of <code>OverlappedEx</code> and inside it call <code>m_olps.push_back(olp);</code> and of course overwrite <code>operator new</code> too</p>\n\n<p>again <code>(OVERLAPPED*)olp</code> - for what <code>reinterpret_cast</code> here ? because you inherit own struct from <code>OVERLAPPED</code> compiler auto do type cast here</p>\n"}], "owner": {"reputation": 195, "user_id": 3245431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737bdb1849524362b12830777953530?s=128&d=identicon&r=PG&f=1", "display_name": "MUXCAH", "link": "https://stackoverflow.com/users/3245431/muxcah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "closed_date": 1498779752, "answer_count": 1, "score": 0, "last_activity_date": 1498676404, "creation_date": 1498674227, "last_edit_date": 1498676404, "question_id": 44809948, "link": "https://stackoverflow.com/questions/44809948/memory-usage-with-iocp", "closed_reason": "Not suitable for this site", "title": "Memory usage with IOCP", "body": "<p>I am converting our code to use IOCP and I got the communication relatively stable, but the memory usage of the application is increasing. Looks like I am getting back (on completion function calls) much fewer objects of OverlappedEx than I create. My code is below. What am I doing wrong?</p>\n\n<pre><code>#ifndef NETWORK_DATA\n#define NETWORK_DATA\n\n#include &lt;afxwin.h&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include \"CriticalSectionLocker.h\"\n\nusing namespace std;\n\nDWORD NetworkManager::NetworkThread(void* param)\n{\n    bool bRun = true;\n\n\n    while (bRun)\n    {\n        DWORD wait = ::WaitForSingleObject(CCommunicationManager::s_hShutdownEvent, 0);\n        if (WAIT_OBJECT_0 == wait)\n        {\n            bRun = false;\n            DEBUG_LOG0(\"Shutdown event was signalled thread\");\n        }\n        else\n        {\n            DWORD dwBytesTransfered = 0;\n            void* lpContext = nullptr;\n            OVERLAPPED* pOverlapped = nullptr;\n\n            BOOL bReturn = GetQueuedCompletionStatus(s_IOCompletionPort,\n                                                    &amp;dwBytesTransfered,\n                                                    (LPDWORD)&amp;lpContext,\n                                                    &amp;pOverlapped,\n                                                    INFINITE);\n            if (nullptr == lpContext)\n            {\n                DEBUG_LOG0(\"invalid context\");\n                /*continue;*/\n            }\n            else\n            {\n                if (bReturn &amp;&amp; dwBytesTransfered &gt; 0)\n                {\n                    OverlappedEx* data = reinterpret_cast&lt;OverlappedEx*&gt;(pOverlapped);\n                    ServerData* networkData = reinterpret_cast&lt;ServerData*&gt;(lpContext);\n\n                    if (networkData &amp;&amp; data)\n                    {                       \n                        switch(data-&gt;m_opType)\n                        {\n                        case OverlappedEx::OP_READ:\n                                /*DEBUG_LOG4(\"device name: %s bytes received: %d socket: %d handle: %d\", \n                                    networkData-&gt;Name().c_str(), dwBytesTransfered, networkData-&gt;Socket(), networkData-&gt;Handle());*/\n                                networkData-&gt;CompleteReceive(dwBytesTransfered, data);                              \n                                break;\n                            case OverlappedEx::OP_WRITE:\n                                /*DEBUG_LOG4(\"device name: %s bytes sent: %d socket: %d handle: %d\",\n                                    networkData-&gt;Name().c_str(), dwBytesTransfered, networkData-&gt;Socket(), networkData-&gt;Handle());*/\n                                networkData-&gt;CompleteSend(dwBytesTransfered, data);\n                                break;\n                        }\n                    }\n                }\n                else\n                {\n                    /*DEBUG_LOG2(\"GetQueuedCompletionStatus failed: bReturn: %d dwBytesTransferred: %u\", bReturn, dwBytesTransfered);*/\n                }\n            }\n        }\n    }\n    return 0;\n}\n\n\nenum NetworkType\n{\n    UDP,\n    TCP\n};\n\nstruct OverlappedEx : public OVERLAPPED\n{\n    enum OperationType\n    {\n        OP_READ,\n        OP_WRITE\n    };  \n\n    const static int MAX_PACKET_SIZE = 2048;\n    WSABUF m_wBuf;\n    char m_buffer[MAX_PACKET_SIZE];\n    OperationType m_opType; \n\n    OverlappedEx()\n    {       \n        Clear();\n        m_refCount = 1;\n    }\n\n    void AddRef()\n    {\n        ::InterlockedIncrement(&amp;m_refCount);\n    }\n\n    void Release()\n    {\n        ::InterlockedDecrement(&amp;m_refCount);\n    }\n\n    int Refcount() const\n    {       \n        return InterlockedExchangeAdd((unsigned long*)&amp;m_refCount, 0UL);\n    }\n\n    ~OverlappedEx()\n    {       \n        Clear();        \n    }\n\n    void Clear()\n    {\n        memset(m_buffer, 0, MAX_PACKET_SIZE);\n        m_wBuf.buf = m_buffer;\n        m_wBuf.len = MAX_PACKET_SIZE;\n        Internal = 0;\n        InternalHigh = 0;\n        Offset = 0;\n        OffsetHigh = 0;\n        hEvent = nullptr;\n        m_opType = OP_READ;\n    }\n\nprivate:\n    volatile LONG m_refCount;\n};\n\n\nclass ServerData\n{       \npublic:\n    const static int MAX_REVEIVE_QUEUE_SIZE = 100;\n    const static int MAX_PACKET_SIZE = 2048;\n    const static int MAX_SEND_QUEUE_SIZE = 10;\n    const static int MAX_RECEIVE_QUEUE_SIZE = 100;  \n    const static int MAX_OVERLAPPED_STRUCTS = 20;   \n\n\n    ServerData(NetworkType netType, const string&amp; sName, CCommunicationManager::CommHandle handle,\n                            SOCKET sock, HANDLE IOPort) :   \n        m_sName(sName)\n    {\n        InitializeCriticalSection(&amp;m_receiveQueLock);\n        InitializeCriticalSection(&amp;m_objectLock);\n        m_Handle = handle;\n        m_Socket = sock;\n        m_nIPAddress = 0;           \n        m_netType = netType;\n        m_bEnabled = true;\n        m_ovlpIndex = 0;\n\n        for (int i = 0; i &lt; MAX_OVERLAPPED_STRUCTS; ++i)\n        {\n            m_olps.push_back(new OverlappedEx);\n        }\n\n        /* Associate socket with completion handle */\n        if (m_Socket != 0)\n        {\n            CreateIoCompletionPort( reinterpret_cast&lt;HANDLE&gt;(m_Socket), IOPort, reinterpret_cast&lt;ULONG_PTR&gt;(this), 0 );\n        }\n    }       \n\n    ~ServerData()\n    {           \n        CriticalSectionLocker lock(&amp;m_receiveQueLock);\n        DeleteCriticalSection(&amp;m_receiveQueLock);\n\n        DeleteCriticalSection(&amp;m_objectLock);\n        closesocket(m_Socket);  \n    }\n\n    const string&amp; Name() const { return m_sName; }\n    bool Enabled() const { return m_bEnabled; }\n    void SetEnabled(bool bEnabled)\n    {\n        m_bEnabled = bEnabled;\n    }\n\n    int Handle() const { return m_Handle; }\n    void SetHandle(int handle)\n    {\n        m_Handle = handle;\n    }\n\n    unsigned long IPAddress() const { return m_nIPAddress; }\n\n    SOCKET Socket() const\n    {\n        return m_Socket;\n    }\n\n    void SetSocket(SOCKET sock)\n    {\n        m_Socket = sock;\n    }\n\n    void SetIPAddress(unsigned long nIP)\n    {\n        m_nIPAddress = nIP;\n    }       \n\n    bool ValidTelegram(const vector&lt;char&gt;&amp; telegram) const\n    {\n        return false;\n    }\n\n    OverlappedEx* GetBuffer()\n    {\n        OverlappedEx* ret = nullptr;\n\n        if (!m_olps.empty())\n        {\n            ret = m_olps.front();\n            m_olps.pop_front();\n        }\n\n        return ret;\n    }\n\n\n    void CompleteReceive(size_t numBytes, OverlappedEx* data)\n    {       \n        //DEBUG_LOG1(\"%d buffers are available\", AvailableBufferCount());\n\n        if (numBytes &gt; 0)\n        {   \n            vector&lt;char&gt; v(data-&gt;m_buffer, data-&gt;m_buffer + numBytes);          \n            ReceivedData rd;\n            rd.SetData(v);\n            EnqueReceiveMessage(rd);    \n        }   \n\n        data-&gt;Release();\n        {\n            CriticalSectionLocker lock(&amp;m_objectLock);\n            m_olps.push_back(data);\n//          DEBUG_LOG1(\"Queue size: %d\", m_olps.size());\n        }\n\n        StartReceiving();\n\n    }\n\n    void CompleteSend(size_t numBytes, OverlappedEx* data)\n    {\n\n        data-&gt;Release();    \n        {\n            CriticalSectionLocker lock(&amp;m_objectLock);\n            m_olps.push_back(data);\n            //DEBUG_LOG1(\"Queue size: %d\", m_olps.size());\n        }\n\n        //DEBUG_LOG2(\"Object: %s num sent: %d\", Name().c_str(), numBytes);\n    }\n\n    void StartReceiving()\n    {\n        DWORD bytesRecv = 0;\n        sockaddr_in senderAddr;\n        DWORD flags = 0;\n        int senderAddrSize = sizeof(senderAddr);\n        int rc = 0;\n\n        CriticalSectionLocker lock(&amp;m_objectLock);\n        auto olp = GetBuffer();\n        if (!olp)\n        {       \n            if (...)\n            {\n                m_olps.push_back(new OverlappedEx);\n                olp = GetBuffer();\n            }\n            else\n            {\n                if (...)\n                {\n                    DEBUG_LOG1(\"Name: %s ************* NO AVAILABLE BUFFERS - bailing ***************\", Name().c_str());\n                }\n                return;\n            }\n        }\n\n        olp-&gt;Clear();\n        olp-&gt;m_opType = OverlappedEx::OP_READ;\n        olp-&gt;AddRef();\n\n        switch(GetNetworkType())\n        {\n        case UDP:\n            {\n                rc = WSARecvFrom(Socket(),\n                                &amp;olp-&gt;m_wBuf,\n                                1,\n                                &amp;bytesRecv,\n                                &amp;flags,\n                                (SOCKADDR *)&amp;senderAddr,\n                                &amp;senderAddrSize, (OVERLAPPED*)olp, NULL);\n            }\n            break;\n        case TCP:\n            {\n                rc = WSARecv(Socket(), \n                            &amp;olp-&gt;m_wBuf,\n                            1, \n                            &amp;bytesRecv, \n                            &amp;flags, \n                            (OVERLAPPED*)olp, NULL);\n            }\n            break;\n        }\n\n        if (SOCKET_ERROR == rc)\n        {\n            DWORD err = WSAGetLastError();\n            if (err != WSA_IO_PENDING)\n            {\n                olp-&gt;Release();\n                m_olps.push_back(olp);\n            }\n        }\n    }\n\n\n    void SetWriteBuf(const SendData&amp; msg, OverlappedEx* data)\n    {\n        int len = min(msg.Data().size(), MAX_PACKET_SIZE);\n        memcpy(data-&gt;m_buffer, &amp;msg.Data()[0], len);\n        data-&gt;m_wBuf.buf = data-&gt;m_buffer;\n        data-&gt;m_wBuf.len = len;\n    }\n\n    void StartSending(const SendData&amp; msg)\n    {\n\n        DEBUG_LOG1(\"device name: %s\", Name().c_str());\n\n        int rc = 0;\n        DWORD bytesSent = 0;\n        DWORD flags = 0;    \n        SOCKET sock = Socket();\n\n        int addrSize = sizeof(sockaddr_in);     \n\n        CriticalSectionLocker lock(&amp;m_objectLock);\n        //UpdateOverlapped(OverlappedEx::OP_WRITE);\n\n        auto olp = GetBuffer();\n        if (!olp)\n        {\n            if (...)\n            {\n                m_olps.push_back(new OverlappedEx);\n                olp = GetBuffer();\n                DEBUG_LOG2(\"name: %s ************* NO AVAILABLE BUFFERS new size: %d ***************\", Name().c_str(), m_olps.size());\n            }\n            else\n            {\n                if (...)\n                {\n                    DEBUG_LOG1(\"Name: %s ************* NO AVAILABLE BUFFERS - bailing ***************\", Name().c_str());\n                }\n                return;\n            }\n        }\n\n        olp-&gt;Clear();\n        olp-&gt;m_opType = OverlappedEx::OP_WRITE;\n        olp-&gt;AddRef();\n        SetWriteBuf(msg, olp);\n\n        switch(GetNetworkType())\n        {\n        case UDP:\n\n            rc = WSASendTo(Socket(), &amp;olp-&gt;m_wBuf, 1,\n                            &amp;bytesSent, flags, (sockaddr*)&amp;msg.SendAddress(),\n                            addrSize, (OVERLAPPED*)olp, NULL);\n            break;\n        case TCP:\n\n            rc = WSASend(Socket(), &amp;olp-&gt;m_wBuf, 1,\n                        &amp;bytesSent, flags, (OVERLAPPED*)olp, NULL);\n            break;\n        }\n\n        if (SOCKET_ERROR == rc)\n        {\n            DWORD err = WSAGetLastError();\n            if (err != WSA_IO_PENDING)\n            {\n                olp-&gt;Release();\n                m_olps.push_back(olp);\n            }\n        }\n    }\n\n    size_t ReceiveQueueSize()\n    {\n        CriticalSectionLocker lock(&amp;m_receiveQueLock);\n        return m_receiveDataQueue.size();\n    }\n\n    void GetAllData(vector &lt;ReceivedData&gt; &amp; data)\n    {\n        CriticalSectionLocker lock(&amp;m_receiveQueLock);\n        while (m_receiveDataQueue.size() &gt; 0)\n        {\n            data.push_back(m_receiveDataQueue.front());\n            m_receiveDataQueue.pop_front();\n        }\n    }\n\n    void DequeReceiveMessage(ReceivedData&amp; msg)\n    {\n        CriticalSectionLocker lock(&amp;m_receiveQueLock);\n        if (m_receiveDataQueue.size() &gt; 0)\n        {\n            msg = m_receiveDataQueue.front();\n            m_receiveDataQueue.pop_front();\n        }\n    }\n\n    template &lt;class T&gt;\n    void EnqueReceiveMessage(T&amp;&amp; data)\n    {\n        CriticalSectionLocker lock(&amp;m_receiveQueLock);\n        if (m_receiveDataQueue.size() &lt;= MAX_RECEIVE_QUEUE_SIZE)\n        {\n            m_receiveDataQueue.push_back(data);\n        }\n        else\n        {\n            static int s_nLogCount = 0;\n            if (s_nLogCount % 100 == 0)\n            {\n                DEBUG_LOG2(\"Max queue size was reached handle id: %d in %s\", Handle(), Name().c_str());\n            }\n            s_nLogCount++;\n        }\n    }           \n\n    NetworkType GetNetworkType() const\n    {\n        return m_netType;\n    }   \n\nprivate:        \n    ServerData(const ServerData&amp;);\n    ServerData&amp; operator=(const ServerData&amp;);\nprivate:\n    bool m_bEnabled;                                                            //!&lt; This member flags if this reciever is enabled for receiving incoming connections.\n    int m_Handle;                                                   //!&lt; This member holds the handle for this receiver.\n    SOCKET m_Socket;                                                        //!&lt; This member holds the socket information for this receiver.        \n    unsigned long m_nIPAddress;                                             //!&lt; This member holds an IP address the socket is bound to.\n    deque &lt; ReceivedData &gt; m_receiveDataQueue;\n    CRITICAL_SECTION m_receiveQueLock;  \n    CRITICAL_SECTION m_objectLock;\n    string m_sName; \n    NetworkType m_netType;\n    deque&lt;OverlappedEx*&gt; m_olps;\n    size_t m_ovlpIndex;\n};\n\n\n#endif\n</code></pre>\n"}, {"tags": ["c++", "class"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1498673956, "post_id": 44809850, "comment_id": 76600064, "body": "The <code>Task</code> type has no <code>help</code> member."}, {"owner": {"reputation": 2241, "user_id": 1149181, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee9209770415ecaae61938362da180a3?s=128&d=identicon&r=PG", "display_name": "wecsam", "link": "https://stackoverflow.com/users/1149181/wecsam"}, "edited": false, "score": 0, "creation_date": 1498673965, "post_id": 44809850, "comment_id": 76600068, "body": "It looks like <code>tablica</code> is an array of <code>Task</code>s, but <code>help</code> is defined in <code>Task4Answ</code>."}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 1, "creation_date": 1498673986, "post_id": 44809850, "comment_id": 76600079, "body": "1) <code>help</code> does not exist in <code>Task</code>, it exists in <code>Task4Answ</code>.  2) Even if it did, <code>help</code> is private so you would not be able to access it anyway.  You probably want to make <code>help</code> a function: <code>&#47;* In Task *&#47; virtual int getHelp() = 0;</code>, <code>&#47;* In Task4Answ *&#47; int getHelp override { return help; }</code>"}, {"owner": {"reputation": 9, "user_id": 8011665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3260e1dad28ee30ecc7bfa2d37547cb?s=128&d=identicon&r=PG&f=1", "display_name": "Darek D", "link": "https://stackoverflow.com/users/8011665/darek-d"}, "edited": false, "score": 0, "creation_date": 1498674166, "post_id": 44809850, "comment_id": 76600193, "body": "Is there any possibility to make tablica as an array of Tasks and get access to a field from class, which is inheriting from Task ?"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1498674279, "post_id": 44809850, "comment_id": 76600279, "body": "@DarekD Your options are either: Make <code>tablica</code> an array of concrete <code>Task4Answ</code>s, or hoist <code>help</code> out to be part of the interface for <code>Task</code>."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8011665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3260e1dad28ee30ecc7bfa2d37547cb?s=128&d=identicon&r=PG&f=1", "display_name": "Darek D", "link": "https://stackoverflow.com/users/8011665/darek-d"}, "edited": false, "score": 0, "creation_date": 1498674505, "post_id": 44809946, "comment_id": 76600390, "body": "The thing is i didnt write the whole code in topic, cause there are 4 classes which are inheriting from Task, they have the same contents. And i have to make an array of objects of those 4 classes."}, {"owner": {"reputation": 2241, "user_id": 1149181, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee9209770415ecaae61938362da180a3?s=128&d=identicon&r=PG", "display_name": "wecsam", "link": "https://stackoverflow.com/users/1149181/wecsam"}, "reply_to_user": {"reputation": 9, "user_id": 8011665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3260e1dad28ee30ecc7bfa2d37547cb?s=128&d=identicon&r=PG&f=1", "display_name": "Darek D", "link": "https://stackoverflow.com/users/8011665/darek-d"}, "edited": false, "score": 0, "creation_date": 1498675514, "post_id": 44809946, "comment_id": 76600967, "body": "@DarekD Ah, that changes things. I have edited my answer to cover that territory. If it is possible to redo your data structures to not require casting, however, that is usually way easier to read and follow."}, {"owner": {"reputation": 9, "user_id": 8011665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3260e1dad28ee30ecc7bfa2d37547cb?s=128&d=identicon&r=PG&f=1", "display_name": "Darek D", "link": "https://stackoverflow.com/users/8011665/darek-d"}, "edited": false, "score": 0, "creation_date": 1498675862, "post_id": 44809946, "comment_id": 76601183, "body": "Thank you very much bro, now i see my mistakes. Will change some data structure to not do that castings. One more time much thanks !"}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1498676037, "post_id": 44809946, "comment_id": 76601289, "body": "In order to be able to properly deep-copy heterogeneous arrays of pointers to a base class, you&#39;ll need to add something like <code>std::unique_ptr&lt;Task&gt; clone() const</code> to the base <code>Task</code> class (and also make the destructor <code>Task::~Task()</code> virtual).  Then, override it in each subclass.  Even if you know now that all the derived classes have the same contents, it&#39;s not a good idea to rely on that continuing to hold in the future as you extend the class hierarchy.  ...And also, incidentally, you should usually prefer using <code>std::vector</code> or <code>std::array</code> over raw C-style arrays."}], "tags": [], "owner": {"reputation": 2241, "user_id": 1149181, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee9209770415ecaae61938362da180a3?s=128&d=identicon&r=PG", "display_name": "wecsam", "link": "https://stackoverflow.com/users/1149181/wecsam"}, "is_accepted": false, "score": 2, "last_activity_date": 1498675843, "last_edit_date": 1498675843, "creation_date": 1498674213, "answer_id": 44809946, "question_id": 44809850, "link": "https://stackoverflow.com/questions/44809850/c-cant-access-field-from-inherited-class/44809946#44809946", "title": "C++ can&#39;t access field from inherited class", "body": "<p>The problem is in this line:</p>\n\n<pre><code>tablica[i]=new Task4Answ(\"0\",0,0);\n</code></pre>\n\n<p>Although you have called the <code>Task4Answ</code> constructor, you are also assigning the memory address returned by <code>new</code> to a <code>Task</code> pointer. Effectively, you have casted the <code>Task4Answ</code> pointer to a <code>Task</code> pointer. On the lines that follow, C++ only sees <code>tablica[i]</code> as a reference to a <code>Task</code> pointer. You need to change:</p>\n\n<pre><code>protected:\n    Task *tablica[10];\n    TaskCollection T1;\n</code></pre>\n\n<p>...to this:</p>\n\n<pre><code>protected:\n    Task4Answ *tablica[10]; // Task was changed to Task4Answ\n    TaskCollection T1;\n</code></pre>\n\n<p>That should allow C++ to see <code>tablica</code> as an array of <code>Task4Answ</code> pointers instead of <code>Task</code> pointers.</p>\n\n<p>Edit: it looks like <code>help</code> is also private. You will have to change <code>help</code> to public or add <code>TaskCollection::TaskCollection()</code> as a friend. Otherwise, C++ will not let you get or set <code>help</code>.</p>\n\n<p>Edit: the OP added that <code>tablica[i]</code> might contain instances of other classes that inherit from <code>Task</code>. In that case, you could do something like this:</p>\n\n<pre><code>void Generuj()\n{\n        if(T1.collection[x]-&gt;id_pyt==1)\n        {\n            Task4Answ* newTask = new Task4Answ(\"0\",0,0);\n            newTask-&gt;contents=T1.collection[x]-&gt;contents;\n            newTask-&gt;id_pyt=T1.collection[x]-&gt;id_pyt;\n            newTask-&gt;nr_pyt=T1.collection[x]-&gt;nr_pyt;\n            newTask-&gt;help=T1.collection[x]-&gt;help; // You will still have to change this from being private.\n            tablica[i] = newTask;\n        }\n    }\n}\n</code></pre>\n\n<p>Later on, in order to access <code>help</code>, you will need to implement some sort of way of checking whether <code>tablica[i]</code> is a <code>Task4Answ</code> and not an instance of some other class that inherits from <code>Task</code>, perhaps by implementing a method in <code>Task</code> named <code>IsTask4Answ</code> that returns <code>false</code> in <code>Task</code> but is overridden to return <code>True</code> in <code>Task4Answ</code>. You can then cast the pointer back to <code>Task4Answ</code> with something like the <code>static_cast</code> operator. In other words:</p>\n\n<pre><code>// Add these functions to the class definitions:\nvirtual bool Task::IsTask4Answ() const {\n    return false;\n}\nbool Task4Answ::IsTask4Answ() const override {\n    return true;\n}\n// Later, you can do this:\nif(tablica[i].IsTask4Answ()){\n    Task4Answ* t = static_cast&lt;Task4Answ*&gt;(tablica[i]);\n    t-&gt;help; // Again, you'll have to change this from being private.\n}\n</code></pre>\n\n<p>Although I suggest figuring out a different data structure where you do not need to do any casting, this will allow you to access <code>help</code>.</p>\n\n<p>Do note the <code>virtual</code> keyword in the first function above; it allows the function to be dynamically bound, which means that the code will check whether to call <code>Task::IsTask4Answ()</code> or <code>Task4Answ::IsTask4Answ()</code> at runtime instead of at compile time.</p>\n"}], "owner": {"reputation": 9, "user_id": 8011665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3260e1dad28ee30ecc7bfa2d37547cb?s=128&d=identicon&r=PG&f=1", "display_name": "Darek D", "link": "https://stackoverflow.com/users/8011665/darek-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1498675843, "creation_date": 1498673840, "question_id": 44809850, "link": "https://stackoverflow.com/questions/44809850/c-cant-access-field-from-inherited-class", "title": "C++ can&#39;t access field from inherited class", "body": "<p>Hello guys a have a problem, that i can't access field tablica[i]->help, in generuj function, its saying that this field is not existing in class Task.\nHow can i achieve it ?</p>\n\n<pre><code>class Task\n{\n  protected:\n     string contents;\n     int id_pyt;\n     int nr_pyt;\n};\n\nclass Task4Answ : public Task\n{\nprivate:\n    int help;\npublic:\n    Task4Answ(string contents1, int id,int nr,int help1)\n    {\n        contents=contents1;\n        id_pyt=id;\n        nr_pyt=nr;\n        help=help1;\n    }\n};\n\nclass TaskCollection\n{\n    protected:\n        Task *collection[60];\n    public:\n        friend class Generator;\n        TaskCollection()\n        {\n          collection[0] = new Task4Answ(\"Ile jest por roku w Polsce? \\na) 1 \\nb) 2 \\nc) 3 \\nd) 4\",1,0);\n          collection[1] = new Task4Answ(\"Kto wygral tegoroczny Roland Garros? \\na) Federer \\nb) Djokovic \\nc) Nadal \\nd) Thiem\",1,1);\nclass Generator\n{\nprotected:\n    Task *tablica[10];\n    TaskCollection T1;\npublic:\n    Generator(){}\n    void Generuj()\n    {\n            if(T1.collection[x]-&gt;id_pyt==1)\n            {\n                tablica[i]=new Task4Answ(\"0\",0,0);\n                tablica[i]-&gt;contents=T1.collection[x]-&gt;contents;\n                tablica[i]-&gt;id_pyt=T1.collection[x]-&gt;id_pyt;\n                tablica[i]-&gt;nr_pyt=T1.collection[x]-&gt;nr_pyt;\n                tablica[i]-&gt;help=T1.collection[x]-&gt;help; //here is the problem\n            }\n        }\n    }\n</code></pre>\n\n<p>Or maybe there is some other solution of the project im doing now.\nThanks for any help.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 7, "creation_date": 1498673789, "post_id": 44809802, "comment_id": 76599961, "body": "You have undefined behavior."}, {"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 0, "creation_date": 1498674296, "post_id": 44809802, "comment_id": 76600290, "body": "I tried searching for an answer before posing the question."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1498674457, "post_id": 44809802, "comment_id": 76600372, "body": "@nzc Yes. Your question is well asked. However, when someone is more familiar with the exact problem, they may be able to come up with a better search and find your answer. That doesn&#39;t mean that your question is bad. Duplicates on StackOverflow are just fine."}, {"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 0, "creation_date": 1498674578, "post_id": 44809802, "comment_id": 76600440, "body": "Thanks for explaining that."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1498690576, "post_id": 44809802, "comment_id": 76608194, "body": "&quot;Why is an expression such as (&lt;makes-a-string&gt;).c_str() ever useful then?&quot;  Possibly the most important use of std::string::c_str() is to invoke Linux or POSIX API&#39;s or predecessor functions of a larger app that require a c-style null terminated string for input."}], "answers": [{"comments": [{"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 0, "creation_date": 1498674500, "post_id": 44809915, "comment_id": 76600386, "body": "Aha. That&#39;s it.  But...  Why is an expression such as (&lt;makes-a-string&gt;).c_str() ever useful then?  This seems like a bad affordance in the language."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 5, "creation_date": 1498674612, "post_id": 44809915, "comment_id": 76600453, "body": "It is useful <i>within the full expression</i>, but not <i>after</i> it. For example, <code>std::cout &lt;&lt; (&lt;makes-a-string&gt;).c_str() &lt;&lt; std::endl</code> is perfectly valid, since the temporary continues to live till the end of the full expression."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 1, "creation_date": 1498674646, "post_id": 44809915, "comment_id": 76600467, "body": "@nzc That&#39;s a good point. It wouldn&#39;t seem to be a bad idea to change <code>std::string</code> so that <code>c_str()</code> couldn&#39;t be called on an object that was about to go out of scope. However, it would break code (if I understand correctly). <code>someFunctionThatPrintsACString((simpleString + &quot;, two&quot;).c_str())</code> wouldn&#39;t be undefined behavior because the temporary lives until after the function call, but if you changed <code>c_str()</code> to not work in that case, code like that would fail to compile"}, {"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 0, "creation_date": 1498674911, "post_id": 44809915, "comment_id": 76600606, "body": "Yeah, I don&#39;t think it can be done away with -- I discovered that if one uses the expression immediately one gets the expected result.  But it seems very sketchy -- how would anyone know this is a bad idea aside from being aware of the intricacies of the language.  If we have to be aware of details like this, what good is abstraction?"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 3, "creation_date": 1498675102, "post_id": 44809915, "comment_id": 76600716, "body": "@nzc The good news is that once you learn these patterns, they apply all over the place in C++. Having to think about things like this is part of what makes C++ harder than languages like Java or Python. But being able to do things like this is part of what makes C++ powerful. Abstraction at least helps you by making it so that there are fewer things to think about, even if you have to pay attention to details such as this. Some people have been trying to develop languages or libraries to solve these issues, but it&#39;s not an easy task"}, {"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 0, "creation_date": 1498675802, "post_id": 44809915, "comment_id": 76601144, "body": "Sorry for whinging on there."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1498676083, "post_id": 44809915, "comment_id": 76601325, "body": "&quot;Why is an expression such as (&lt;makes-a-string&gt;).c_str() ever useful then?&quot;  non-sequitor.  You did not &quot;&lt;makes-a-string&gt;&quot;, you did &quot;&lt;makes-a-char*&gt;&quot;."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 2, "creation_date": 1498676153, "post_id": 44809915, "comment_id": 76601371, "body": "@DOUGLASO.MOEN <code>(someString + &quot;some literal&quot;)</code> creates a <code>std::string</code>, as <code>std::string</code> has an <code>operator+</code> taking a <code>const char *</code>"}, {"owner": {"reputation": 762, "user_id": 1987633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7cc5084e895540051a920e541ab9b8c?s=128&d=identicon&r=PG", "display_name": "Andre Kostur", "link": "https://stackoverflow.com/users/1987633/andre-kostur"}, "reply_to_user": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 3, "creation_date": 1498685722, "post_id": 44809915, "comment_id": 76606460, "body": "@nzc Arguably you already broke the abstraction by using c_str().  After all, that entire code block could be written with no <code>char *</code> in sight.  If all of those <code>char *</code> were replaced by <code>std::string</code>, the problem wouldn&#39;t occur."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1498690427, "post_id": 44809915, "comment_id": 76608148, "body": "Possibly the most important use of std::string::c_str() is to invoke Linux or POSIX API&#39;s or older functions that require a c-style null terminated string."}, {"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "reply_to_user": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1498690688, "post_id": 44809915, "comment_id": 76608219, "body": "@DOUGLASO.MOEN which, in fact, is what the original code was doing."}], "tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": true, "score": 9, "last_activity_date": 1498674104, "creation_date": 1498674104, "answer_id": 44809915, "question_id": 44809802, "link": "https://stackoverflow.com/questions/44809802/why-is-this-being-optimized-away-by-g-at-least-i-think-thats-whats-going-o/44809915#44809915", "title": "Why is this being optimized away by g++? At least, I think that&#39;s what&#39;s going on", "body": "<blockquote>\n<pre><code>const char * twoCharStar = (simpleString + \", two\").c_str();\n</code></pre>\n</blockquote>\n\n<p>After this line, the temporary string <code>(simpleString + \", two\")</code> is destroyed.</p>\n\n<p><code>std::string</code> allocates memory, and <code>c_str()</code> returns a pointer to that memory. In <code>std::string</code>'s destructor, the memory is deallocated. Thus, after this line, <code>twoCharStar</code> points to deleted memory.</p>\n\n<p>Using memory after it is freed is undefined behavior.</p>\n"}], "owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 44809915, "answer_count": 1, "score": 4, "last_activity_date": 1498674104, "creation_date": 1498673696, "last_edit_date": 1592644375, "question_id": 44809802, "link": "https://stackoverflow.com/questions/44809802/why-is-this-being-optimized-away-by-g-at-least-i-think-thats-whats-going-o", "title": "Why is this being optimized away by g++? At least, I think that&#39;s what&#39;s going on", "body": "<p>When I run the following code</p>\n<pre><code>#include &lt;iostream&gt;\nint main(int argc, char *argv []) {\n  \n  std::string simpleString(&quot;this is just a simple string&quot;);\n  \n  std::cout &lt;&lt; &quot;simpleString = &quot; &lt;&lt; simpleString &lt;&lt; std::endl &lt;&lt; std::endl;\n \n  std::string one = (simpleString + &quot;, one&quot;);\n\n  const char * oneCharStar = one.c_str();\n  std::cout &lt;&lt; &quot;simpleString + one: '&quot; &lt;&lt; oneCharStar &lt;&lt; &quot;'&quot; &lt;&lt; std::endl;\n\n  const char * twoCharStar = (simpleString + &quot;, two&quot;).c_str();\n  std::cout &lt;&lt; &quot;simpleString + two: '&quot; &lt;&lt; twoCharStar &lt;&lt; &quot;'&quot; &lt;&lt; std::endl;\n\n  return 0;\n}\n</code></pre>\n<p>on my Fedora Core 23 machine, on which uname -a reports:</p>\n<blockquote>\n<p>&quot;Linux glorp 4.5.7-202.fc23.x86_64 #1 SMP\nTue Jun 28 18:22:51 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux&quot;</p>\n</blockquote>\n<p>and g++ --version says</p>\n<blockquote>\n<p>&quot;g++ (GCC) 5.3.1 20160406 (Red Hat 5.3.1-6)&quot;</p>\n</blockquote>\n<p>the first output reads &quot;this is just a simple string, one&quot;, while the second output shows the empty string.</p>\n<p>I guess there's some kind of optimization going on here, but, on my previous Ubuntu machine (16.mumble, rest in peace), this code ran as I would have expected.  I just found that when I recompiled my application (using the same make files, etc) on the new machine, this code failed as above.</p>\n<p>In addition, it works as I'd expect on the following platform as well:</p>\n<blockquote>\n<p>$ uname -a Linux t4240rdb</p>\n<p>3.12.37-rt51+g43cecda #2 SMP Fri Mar 4 18:18:03 EST 2016 ppc64 GNU/Linux</p>\n<p>$ g++ --version</p>\n<p>g++ (GCC) 4.9.2</p>\n<p>Copyright (C) 2014 Free Software Foundation, Inc.</p>\n</blockquote>\n<p>What's going on here?  Thanks!</p>\n"}, {"tags": ["c++", "overloading", "destructor", "free"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1498673449, "post_id": 44809676, "comment_id": 76599755, "body": "Follow the Rule of 3/5/0."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7985205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8WfXl.jpg?s=128&g=1", "display_name": "SarahHime", "link": "https://stackoverflow.com/users/7985205/sarahhime"}, "edited": false, "score": 0, "creation_date": 1499075094, "post_id": 44809742, "comment_id": 76742944, "body": "Thank you, I didn&#39;t heard of this rule before."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 6, "last_activity_date": 1498673783, "last_edit_date": 1498673783, "creation_date": 1498673460, "answer_id": 44809742, "question_id": 44809676, "link": "https://stackoverflow.com/questions/44809676/c-operator-overload-calling-destructor/44809742#44809742", "title": "C++ Operator overload calling destructor", "body": "<p>See <a href=\"http://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"noreferrer\">the rule of three/five/zero</a>.</p>\n\n<p>The rule of three states </p>\n\n<blockquote>\n  <p>If a class requires a user-defined destructor, a user-defined copy constructor, or a user-defined copy assignment operator, it almost certainly requires all three.</p>\n</blockquote>\n\n<p>In this case, you provided the destructor and copy assignment operator but forgot the copy constructor.</p>\n\n<p>In <code>operator+</code> you create a local object <code>MyVector res</code> which is later copied out and then destroyed. Since you haven't implemented a copy constructor, the default copy constructor will simply copy the original <code>data</code> pointer from <code>res</code> to another <code>MyVector</code>. When <code>res</code> is destroyed, the array pointed to by it's <code>data</code> member will be deleted, leaving the copied vector's <code>data</code> pointing to a deleted object.</p>\n"}], "owner": {"reputation": 33, "user_id": 7985205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8WfXl.jpg?s=128&g=1", "display_name": "SarahHime", "link": "https://stackoverflow.com/users/7985205/sarahhime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 1, "accepted_answer_id": 44809742, "answer_count": 1, "score": 2, "last_activity_date": 1498673783, "creation_date": 1498673232, "question_id": 44809676, "link": "https://stackoverflow.com/questions/44809676/c-operator-overload-calling-destructor", "title": "C++ Operator overload calling destructor", "body": "<p>For my first try with operator overloading I created a vector class and tried to sum up two vectors. My class contains an array and a vector of int that both contain the same elements.</p>\n\n<p>Addition works fine with the <code>std::vector</code> but I encounter two issues with the array. It seems that the destructor is called at the end of the summing operation which produces a \"double free or corruption\" error (core dump). Plus, the first two elements of the array are always equal to zero.</p>\n\n<p>Should I also overload the <code>delete</code> or am I missing a thing ?</p>\n\n<p>The header file:</p>\n\n<pre><code>#ifndef MYVECTOR_INCLUDE\n#define MYVECTOR_INCLUDE\n#include &lt;iostream&gt;\n#include &lt;stdexcept&gt;\n#include &lt;cstring&gt;\n#include &lt;vector&gt;\n\nclass MyVector {\npublic:\n    MyVector(int n);\n    ~MyVector();\n    void set(int idx, int value);\n    int get(int idx);\n    void print();    \n    MyVector &amp;operator=(const MyVector &amp;v);\n    MyVector operator+(const MyVector &amp;v);\nprivate:\n    int *data;\n    std::vector&lt;int&gt; data_vector;\n    int size1;\n    int size2;\n};\n#endif\n</code></pre>\n\n<p>The cpp file:</p>\n\n<pre><code>#include \"../include/myvector.hpp\"\n\nMyVector::MyVector(int n) {\n    data = new int [n];\n    data_vector.resize(n);\n    size1 = n;\n    size2 = 1;\n}\nMyVector::~MyVector() {\n    if (data != NULL) {\n        delete [] data;\n    }\n}\nvoid MyVector::set(int idx, int value) {\n    data_vector[idx] = value;\n    data[idx] = value;\n}\nint MyVector::get(int idx) {\n    return data_vector[idx];\n}\nvoid MyVector::print() {\n    std::cout &lt;&lt; \"Vector data\" &lt;&lt; std::endl;\n    for (int i = 0; i &lt; size1; ++i) {\n        std::cout &lt;&lt; data_vector[i] &lt;&lt; \" \";\n    }\n    std::cout &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Data\" &lt;&lt; std::endl;\n    for (int i = 0; i &lt; size1; ++i) {\n        std::cout &lt;&lt; data[i] &lt;&lt; \" \";\n    }\n    std::cout &lt;&lt; std::endl;\n}\nMyVector &amp;MyVector::operator=(const MyVector &amp;v) {\n    if (this == &amp;v)\n        return *this;\n    size1 = v.size1;\n    size2 = v.size2;\n    std::copy(v.data_vector.begin(), v.data_vector.end(), data_vector.begin());\n    memcpy(&amp;data, v.data, sizeof(int)*size1);\n    return *this;\n}\nMyVector MyVector::operator+(const MyVector &amp;v) {\n    if ((size1 == v.size1) &amp;&amp; (size2 == v.size2)) {\n        MyVector res = MyVector(size1);\n        for (int i = 0; i &lt; size1; ++i) {\n            res.data_vector[i] = data_vector[i] + v.data_vector[i];\n            res.data[i] = data[i] + v.data[i];\n        }\n        return res;\n    }\n    else\n        throw std::length_error(\"Vector dimensions must agree.\");\n}\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "android-ndk", "cross-compiling"], "comments": [{"owner": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "edited": false, "score": 0, "creation_date": 1498676365, "post_id": 44809671, "comment_id": 76601508, "body": "You expect that your code and build system will be magically portable to a new platform? You can compile C++ on Android with the NDK, and you can compile it using Makefiles. Without specifics, there&#39;s not much to answer here."}, {"owner": {"reputation": 79, "user_id": 6450961, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c5095b9cd593464a4f283c4e4ac8abc2?s=128&d=identicon&r=PG&f=1", "display_name": "janonymous", "link": "https://stackoverflow.com/users/6450961/janonymous"}, "reply_to_user": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "edited": false, "score": 0, "creation_date": 1498681525, "post_id": 44809671, "comment_id": 76604456, "body": "Well not magically, just as simple as possible. I added some simplified information about the approaches I had in mind and the problems they caused."}], "owner": {"reputation": 79, "user_id": 6450961, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c5095b9cd593464a4f283c4e4ac8abc2?s=128&d=identicon&r=PG&f=1", "display_name": "janonymous", "link": "https://stackoverflow.com/users/6450961/janonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498682216, "creation_date": 1498673205, "last_edit_date": 1498682216, "question_id": 44809671, "link": "https://stackoverflow.com/questions/44809671/android-ndk-c-do-i-have-to-change-my-whole-code-or-can-i-use-precompiled-execu", "title": "Android ndk c++ do i have to change my whole code or can i use precompiled executables/make", "body": "<p>As the topic says, I'm interested in using some existing c++ code. It is quite much so I don't want to change everything. That's why I'm asking if I have to change the whole code or if it is possible to include it somehow.</p>\n\n<p>As I noticed Android Studio/Gradle wants a CMake file in order to include those external libraries, but my code only includes ordinary makefiles. </p>\n\n<p>Is there any way to make use of the given structure without many changes?</p>\n\n<p>I can't give too much information about the code because it will be too much but here is something about it:</p>\n\n<ul>\n<li>C++ Code</li>\n<li>Using Makefiles</li>\n</ul>\n\n<p>(will add more if needed)</p>\n\n<p>Methods I tried:</p>\n\n<ol>\n<li>Ship code inside assets, copy it in the local directory and use then use \"make\" to compile it on the smartphone - result: permission denied</li>\n<li>Use precompiled Unix executable - I couldn't find a right compiler yet (already tested Android standalone toolchain)</li>\n<li>Use Android NDK - I didn't manage to include the existing code because the changes were too deep</li>\n</ol>\n\n<p>In my opinion, the best way would be one of the first two options. But I haven't found a way to handle these problems, which are listed above.</p>\n\n<p>What I would like to know is now:</p>\n\n<ol>\n<li>Which option would be the best? Of course, if they're all possible that will depend on the problem, but some opinions would be nice.</li>\n<li>How do I know what compiler I have to use?</li>\n</ol>\n"}, {"tags": ["c++", "css", "qt"], "answers": [{"comments": [{"owner": {"reputation": 2748, "user_id": 6165833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1b6bbdd7a7472d52c14da82af5eb6d20?s=128&d=identicon&r=PG&f=1", "display_name": "ymoreau", "link": "https://stackoverflow.com/users/6165833/ymoreau"}, "edited": false, "score": 0, "creation_date": 1498814628, "post_id": 44810395, "comment_id": 76666163, "body": "The local stylesheet solution is more simple to read&amp;write than your example in my opinion :)"}], "tags": [], "owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "is_accepted": true, "score": 0, "last_activity_date": 1498675862, "creation_date": 1498675862, "answer_id": 44810395, "question_id": 44809587, "link": "https://stackoverflow.com/questions/44809587/qt-set-style-for-all-objects-but-one/44810395#44810395", "title": "Qt set style for all objects but one", "body": "<p>You have 2 choices: apply a stylesheet to just that button and invalidate/reapply it every time you change the selected colour or just subclass that button and reimplement the paintevent:</p>\n\n<pre><code>class ColorButton : public QPushButton{\nQ_OBJECT\nQ_DISABLE_COPY(ColorButton)\npublic:\n    ColorButton(QWidget* parent = Q_NULLPTR)\n        :QPushButton(parent)\n        ,m_color(Qt::red)\n    {}\n    const QColor&amp; color() const {return m_color;}\n    void setColor(const QColor&amp; val){if(m_color==val) return; m_color=val; update();}\nprotected:\n    void paintEvent(QPaintEvent *)\n    {\n        QStylePainter p(this);\n        QStyleOptionButton option;\n        initStyleOption(&amp;option);\n        option.palette.setColor(m_color,QPalette::Background);\n        p.drawControl(QStyle::CE_PushButton, option);\n    }\nprivate:\n    QColor m_color;\n};\n</code></pre>\n\n<p>P.S.\nThe KDE API already has that widget: <a href=\"https://api.kde.org/frameworks-api/frameworks-apidocs/frameworks/kwidgetsaddons/html/classKColorButton.html\" rel=\"nofollow noreferrer\">https://api.kde.org/frameworks-api/frameworks-apidocs/frameworks/kwidgetsaddons/html/classKColorButton.html</a></p>\n"}], "owner": {"reputation": 41, "user_id": 8016689, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/77f4e005a212896397a1583cdd67f235?s=128&d=identicon&r=PG&f=1", "display_name": "sej", "link": "https://stackoverflow.com/users/8016689/sej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 1, "accepted_answer_id": 44810395, "answer_count": 1, "score": 1, "last_activity_date": 1498675862, "creation_date": 1498672878, "question_id": 44809587, "link": "https://stackoverflow.com/questions/44809587/qt-set-style-for-all-objects-but-one", "title": "Qt set style for all objects but one", "body": "<p>I've currently got this style for all push buttons:</p>\n\n<pre><code>this-&gt;setStyleSheet(\".QPushButton { background-color: #416eb6; color: #ddd; }\");\n</code></pre>\n\n<p>This is great because it allows me to keep a constant styling for all the <code>QPushButton</code>'s without having to style them individually.</p>\n\n<p>An issue arises when I need to style a <code>QPushButton</code> representing a color chooser. The button should represent the color that was chosen from the color chooser, but instead it just keeps the initial style that I set.</p>\n\n<p><strong>Things I have tried:</strong></p>\n\n<p>Giving an empty style sheet for the item:</p>\n\n<pre><code>this-&gt;setStyleSheet(#m_colorChooserButton { });\n</code></pre>\n\n<p>Setting the style to initial:</p>\n\n<pre><code>this-&gt;setStyleSheet(#m_colorChooserButton { background-color: initial});\n</code></pre>\n\n<p>Using a similar <code>css</code> selector <code>:not</code>:</p>\n\n<pre><code>this-&gt;setStyleSheet(\".QPushButton:not(#m_colorChooserButton) { background-color: #416eb6; color: #ddd; }\");\n</code></pre>\n\n<p><strong>Is there any way to achieve this result?</strong></p>\n\n<p>I'd like to mimic the <code>:not</code> selector if possible since that's the most straightforward, but at this point, I'd do anything that works.</p>\n\n<p>I'd like to <strong>avoid</strong> having to manually specify the style for each button I want it to show on, as there are well over 100 buttons and finding the object names of these buttons is very time consuming (large legacy code base).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "vector", "stl"], "comments": [{"owner": {"reputation": 4531, "user_id": 4756309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/XMiQX.png?s=128&g=1", "display_name": "Weak to Enuma Elish", "link": "https://stackoverflow.com/users/4756309/weak-to-enuma-elish"}, "edited": false, "score": 3, "creation_date": 1498672835, "post_id": 44809553, "comment_id": 76599392, "body": "Is the member function marked <code>const</code>?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1498672862, "post_id": 44809553, "comment_id": 76599410, "body": "Please provide code samples (not descriptions of code), and copy-paste the error message (it should explain the issue with your code)."}, {"owner": {"reputation": 479, "user_id": 4817002, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/0bf04ee52f2f90d0fcdc86ebe0399010?s=128&d=identicon&r=PG&f=1", "display_name": "Potatosaurus", "link": "https://stackoverflow.com/users/4817002/potatosaurus"}, "edited": false, "score": 0, "creation_date": 1498674043, "post_id": 44809553, "comment_id": 76600123, "body": "As others have said, we cannot help you unless you provide us with your code. Please edit your post to include your code, and we&#39;ll go from there."}, {"owner": {"reputation": 1, "user_id": 6950369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d1a02a710c31695e31e88d111a285f?s=128&d=identicon&r=PG&f=1", "display_name": "shubham ivane", "link": "https://stackoverflow.com/users/6950369/shubham-ivane"}, "edited": false, "score": 0, "creation_date": 1498674104, "post_id": 44809553, "comment_id": 76600163, "body": "vector&lt;AccountHolder&gt;::iterator searchAccount(const vector&lt;AccountHolder&gt;&amp; v,long int accno) {     vector&lt;AccountHolder&gt;::const_iterator itr;     for(itr = v.begin();itr!=v.end();itr++)     {         if(itr-&gt;getAccNo() == accno)return itr;     }     return v.end(); }"}, {"owner": {"reputation": 479, "user_id": 4817002, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/0bf04ee52f2f90d0fcdc86ebe0399010?s=128&d=identicon&r=PG&f=1", "display_name": "Potatosaurus", "link": "https://stackoverflow.com/users/4817002/potatosaurus"}, "edited": false, "score": 2, "creation_date": 1498674218, "post_id": 44809553, "comment_id": 76600237, "body": "Place it in the original post please. Paste it, select it all then press Ctrl + K to format it."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498674649, "post_id": 44809553, "comment_id": 76600468, "body": "five bucks says <code>getAccNo</code> needs to be changed to <code>long int getAccNo() const</code>. You will also have a problem because you are trying to return a <code>vector&lt;AccountHolder&gt;::const_iterator</code> as a <code>vector&lt;AccountHolder&gt;::iterator</code>. They are different types."}, {"owner": {"reputation": 1, "user_id": 6950369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d1a02a710c31695e31e88d111a285f?s=128&d=identicon&r=PG&f=1", "display_name": "shubham ivane", "link": "https://stackoverflow.com/users/6950369/shubham-ivane"}, "edited": false, "score": 0, "creation_date": 1498674678, "post_id": 44809553, "comment_id": 76600488, "body": "Sorry, for inconvenience first time I am posting anything here."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498674955, "post_id": 44809553, "comment_id": 76600632, "body": "Most of the time, and this is one of those times, you need to provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to be taken seriously when asking a &quot;What&#39;s wrong with my code?&quot; question. Example: <a href=\"http://ideone.com/9yoUnX\" rel=\"nofollow noreferrer\">ideone.com/9yoUnX</a>"}, {"owner": {"reputation": 1, "user_id": 6950369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d1a02a710c31695e31e88d111a285f?s=128&d=identicon&r=PG&f=1", "display_name": "shubham ivane", "link": "https://stackoverflow.com/users/6950369/shubham-ivane"}, "edited": false, "score": 0, "creation_date": 1498675234, "post_id": 44809553, "comment_id": 76600789, "body": "please could you explain me what this error is saying &quot;prog.cpp:18:27: error: passing \u2018const AccountHolder\u2019 as \u2018this\u2019 argument discards qualifiers [-fpermissive]&quot;."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498676272, "post_id": 44809553, "comment_id": 76601451, "body": "Every method has a hidden <code>this</code> parameter that is a pointer to the class&#39;s type.  In this case you are trying to call a method that requires a <code>AccountHolder * this</code> and provide a <code>const AccountHolder * this</code>. The error message is complaining about the pointer being de-<code>const</code>ified, and this is illegal. The solution is down in the answer below."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6950369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d1a02a710c31695e31e88d111a285f?s=128&d=identicon&r=PG&f=1", "display_name": "shubham ivane", "link": "https://stackoverflow.com/users/6950369/shubham-ivane"}, "edited": false, "score": 0, "creation_date": 1498757509, "post_id": 44810266, "comment_id": 76643564, "body": "can I use &quot;long int getAccNo() const&quot;(as you explain in method 1) with non-constant object.And one more doubt can I declare &quot;long int getAccNo() const&quot; as &quot;const long int getAccNo()&quot;."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 0, "last_activity_date": 1498675375, "last_edit_date": 1592644375, "creation_date": 1498675375, "answer_id": 44810266, "question_id": 44809553, "link": "https://stackoverflow.com/questions/44809553/how-do-i-access-member-function-using-constant-vector/44810266#44810266", "title": "How do I access member function using constant vector?", "body": "<h1>Problem 1:</h1>\n<p>In order to invoke a method on a constant object, the method must be declared <code>const</code> (to declare that the hidden <code>this</code> parameter is <code>const</code>) and must not attempt to modify the object (because <code>this</code> is <code>const</code>). Simply not modifying the object inside the method isn't good enough. So</p>\n<pre><code>long int getAccNo()\n{\n    return AccNo;\n}\n</code></pre>\n<p>must be</p>\n<pre><code>long int getAccNo() const\n{\n    return AccNo;\n}\n</code></pre>\n<p>In fact, any time you have a function that does not or should not modify the object, you should declare it <code>const</code> out of general principles. This makes it easier for the compiler to trap mistakes for you and can save you a lot of debugging time.</p>\n<h1>Problem 2:</h1>\n<pre><code>vector&lt;AccountHolder&gt;::iterator searchAccount(const vector&lt;AccountHolder&gt;&amp; v,long int accno)\n</code></pre>\n<p>returns a <code>vector&lt;AccountHolder&gt;::iterator</code>, but inside the method you are using and trying to return <code>vector&lt;AccountHolder&gt;::const_iterator</code>. These are different, and incompatible, types, so one of them has to be changed. I recommend</p>\n<pre><code>vector&lt;AccountHolder&gt;::const_iterator searchAccount(const vector&lt;AccountHolder&gt;&amp; v,long int accno)\n</code></pre>\n<p>Because the <code>const_iterator</code> is unavoidable with a <code>const vector</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6950369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d1a02a710c31695e31e88d111a285f?s=128&d=identicon&r=PG&f=1", "display_name": "shubham ivane", "link": "https://stackoverflow.com/users/6950369/shubham-ivane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1498675375, "creation_date": 1498672744, "last_edit_date": 1498674944, "question_id": 44809553, "link": "https://stackoverflow.com/questions/44809553/how-do-i-access-member-function-using-constant-vector", "title": "How do I access member function using constant vector?", "body": "<p>I am making a program in which I am storing class object in a vector and passing this vector to a friend function as const vector as reference variable and iterating it using const_vector, and I am trying to call member function of the class object using const_iterator so, I am getting error.But when I am doing this without const vector and iterating it without const_iterator then my program is running successfully.Is we can not iterate const_vector or we can not access member variable or function using const_vector.</p>\n\n<pre><code> vector&lt;AccountHolder&gt;::iterator searchAccount(const vector&lt;AccountHolder&gt;&amp; v,long int accno)\n{\n    vector&lt;AccountHolder&gt;::const_iterator itr;\n    for(itr = v.begin();itr!=v.end();itr++)\n    {\n        if(itr-&gt;getAccNo() == accno)return itr;\n    }\n    return v.end();\n}\n</code></pre>\n\n<p>and this is the whole code.</p>\n\n<pre><code> #include&lt;iostream&gt;\n#include&lt;vector&gt;\nusing namespace std;\n\nclass Account{\nprivate:\n    long int AccNo;\n    char AccType;\npublic:\n    long int getAccNo()\n    {\n        return AccNo;\n    }\n    char getAccType()\n    {\n        return AccType;\n    }\n    void setAccNo(long int accno)\n    {\n        AccNo = accno;\n    }\n    void setAccType(char acctype)\n    {\n        AccType = acctype;\n    }\n};\n\nclass AccountHolder:public Account{\nprivate:\n    string Name;\npublic:\n    string getAccHolderName()\n    {\n        return Name;\n    }\n    void setAccHolderInfo(long int accno,char acctype,string name)\n    {\n        setAccNo(accno);\n        setAccType(acctype);\n        Name = name;\n    }\n    void displayAccountHolderInfo()\n    {\n       cout &lt;&lt; \"Name              : \" &lt;&lt; getAccHolderName() &lt;&lt; endl;\n       cout &lt;&lt; \"Account Number    : \" &lt;&lt; getAccNo() &lt;&lt; endl;\n       cout &lt;&lt; \"Account Type      : \" &lt;&lt; getAccType() &lt;&lt; endl;\n    }\n    friend void displayAllAccountHolder(vector&lt;AccountHolder&gt; &amp;v);\n    friend vector&lt;AccountHolder&gt;::iterator searchAccount(vector&lt;AccountHolder&gt; &amp;v,long int accno);\n    //friend bool searchAccount(const vector&lt;AccountHolder&gt; &amp;v,long int accno,char acctype);\n    //friend vector&lt;AccountHolder&gt;::iterator searchAccount(const vector&lt;AccountHolder&gt; &amp;v,long int accno=0,string name);\n};\n\nvoid displayAllAccountHolder(vector&lt;AccountHolder&gt; &amp;v)\n{\n    for(vector&lt;AccountHolder&gt;::iterator itr = v.begin();itr != v.end() ; itr++)\n        itr-&gt;displayAccountHolderInfo();\n}\n\nvector&lt;AccountHolder&gt;::iterator searchAccount(const vector&lt;AccountHolder&gt;&amp; v,long int accno)\n{\n    vector&lt;AccountHolder&gt;::const_iterator itr;\n    for(itr = v.begin();itr!=v.end();itr++)\n    {\n        if(itr-&gt;getAccNo() == accno)return itr;\n    }\n    return v.end();\n}\n\nint main()\n{\n    vector&lt;AccountHolder&gt; Acc;\n    vector&lt;AccountHolder&gt; SavingAcc;\n    vector&lt;AccountHolder&gt; CurrentAcc;\n    vector&lt;AccountHolder&gt;::iterator temp;\n    AccountHolder AccH;\n    long int accno;\n    char acctype;\n    string name;\n    do{\n        cout &lt;&lt; \"Select Your Choice : \" &lt;&lt; endl;\n        cout &lt;&lt; \"1. Insert Data \" &lt;&lt; endl;\n        cout &lt;&lt; \"2. Display Data \" &lt;&lt; endl;\n        cout &lt;&lt; \"3. Display All User Data \" &lt;&lt; endl;\n        cout &lt;&lt; \"4. Exit \" &lt;&lt; endl;\n        cout &lt;&lt; \"   Enter Your Choice : \";\n        int choice;\n        cin &gt;&gt; choice;\n        switch(choice)\n        {\n            case 1: cout &lt;&lt; \"\\nEnter Name : \";\n                    cin.get();\n                    getline(cin &gt;&gt; ws,name);\n                    accNo:\n                    cout &lt;&lt; \"\\nEnter Account Number : \";\n                    cin &gt;&gt; accno;\n                    if(searchAccount(Acc,accno)!=Acc.end())\n                    {\n                        cout &lt;&lt; \"\\nAccount Number already exist.\" &lt;&lt; endl;\n                        goto accNo;\n                    }\n                    accType:\n                    cout &lt;&lt; \"\\nEnter Account Type   : \";\n                    cin &gt;&gt; acctype;\n                    if(acctype == 's' || acctype =='S')\n                    {\n                        AccH.setAccHolderInfo(accno,'S',name);\n                        SavingAcc.push_back(AccH);\n                        Acc.push_back(AccH);\n                    }\n                    else if(acctype == 'c' || acctype == 'C')\n                    {\n                        AccH.setAccHolderInfo(accno,'C',name);\n                        CurrentAcc.push_back(AccH);\n                        Acc.push_back(AccH);\n                    }\n                    else\n                    {\n                       cout &lt;&lt; \"\\n Invalid Account Type\" &lt;&lt; endl;\n                       goto accType;\n                    }\n            break;\n            case 2: cout &lt;&lt; \"\\nEnter Account Number : \";\n                    cin &gt;&gt; accno;\n                    cout &lt;&lt; \"\\nEnter Account Type(or just type 'n')  : \";\n                    cin.get();\n                    cin &gt;&gt; acctype;\n                    if(acctype == 's' || acctype == 'S')\n                        temp = searchAccount(SavingAcc,accno);\n                    else if(acctype == 'c' || acctype == 'C')\n                        temp = searchAccount(CurrentAcc,accno);\n                    else\n                        temp = searchAccount(Acc,accno);\n                    if(temp!=SavingAcc.end() &amp;&amp; temp!=CurrentAcc.end() &amp;&amp; temp!=Acc.end()  )\n                        temp-&gt;displayAccountHolderInfo();\n                    else\n                        cout &lt;&lt; \"\\n Account does not exist. \" &lt;&lt; endl;\n            break;\n            case 3:displayAllAccountHolder(Acc);\n            break;\n            case 4: return 0;\n            break;\n            default:\n            break;\n        }\n    }while(true);\n    return 0;\n}\n</code></pre>\n\n<p>but when you remove const vector to vector it will work.</p>\n\n<p>vector::iterator searchAccount(const vector&amp; v,long int accno)</p>\n"}, {"tags": ["c#", "c++", "winforms"], "answers": [{"tags": [], "owner": {"reputation": 253, "user_id": 3473653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b3fec1a002544e3802f0fa0185b388?s=128&d=identicon&r=PG&f=1", "display_name": "PeskyToaster", "link": "https://stackoverflow.com/users/3473653/peskytoaster"}, "is_accepted": false, "score": 1, "last_activity_date": 1498673487, "creation_date": 1498673487, "answer_id": 44809751, "question_id": 44809428, "link": "https://stackoverflow.com/questions/44809428/pass-a-value-from-c-application-to-c-application/44809751#44809751", "title": "Pass a value from C++ application to C# application", "body": "<p>Your main method contains an args string array. You can access these arguments as you would in any other array. For example if you run Test.exe from the command prompt as \"text.exe a b c d e\" you could run this code in the main method to access each element.</p>\n\n<pre><code>for (int i = 0; i &lt; args.Length; i++)\n    {\n        System.Console.WriteLine(args[i]);\n    }\n</code></pre>\n\n<p>String args[] is common but depending on what you're using the actual passed arguments may start at args[1].</p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 1037816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa241869d393e20e465f9ec1e62b0824?s=128&d=identicon&r=PG", "display_name": "Amitav", "link": "https://stackoverflow.com/users/1037816/amitav"}, "edited": false, "score": 0, "creation_date": 1498717401, "post_id": 44810139, "comment_id": 76615345, "body": "Thanks! this helps."}], "tags": [], "owner": {"reputation": 151, "user_id": 5972372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4ceea0feff662f3365665133801ce0?s=128&d=identicon&r=PG&f=1", "display_name": "qaqz111", "link": "https://stackoverflow.com/users/5972372/qaqz111"}, "is_accepted": false, "score": 0, "last_activity_date": 1498674962, "creation_date": 1498674962, "answer_id": 44810139, "question_id": 44809428, "link": "https://stackoverflow.com/questions/44809428/pass-a-value-from-c-application-to-c-application/44810139#44810139", "title": "Pass a value from C++ application to C# application", "body": "<p>You can read args of C# app's entry method which is usually <code>Main(string[] args)</code>, or use <code>System.Environment.GetCommandLineArgs()</code>.</p>\n\n<p>If your <code>Main</code> method do not have <code>string[] args</code>, add it manually.</p>\n\n<p>While <code>Main(string[] args)</code> can be used only in entrance method, the <code>System.Environment.GetCommandLineArgs()</code> can be used everywhere in your code to get parameters passed to your C# app. This is useful if you are writing a C# wpf app, the wpf app's <code>Main</code> method is compiler generated by default.</p>\n"}], "owner": {"reputation": 131, "user_id": 1037816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa241869d393e20e465f9ec1e62b0824?s=128&d=identicon&r=PG", "display_name": "Amitav", "link": "https://stackoverflow.com/users/1037816/amitav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "closed_date": 1498717376, "answer_count": 2, "score": 0, "last_activity_date": 1498674962, "creation_date": 1498672190, "question_id": 44809428, "link": "https://stackoverflow.com/questions/44809428/pass-a-value-from-c-application-to-c-application", "closed_reason": "Duplicate", "title": "Pass a value from C++ application to C# application", "body": "<p>I am launching a C# windows application \u201cTest.exe\u201d from a button click event of C++ as below.</p>\n\n<pre><code>CreateProcess(\"D:\\\\Test\\\\Test.exe\",\n        \u201cPassing Data to C#\u201d,\n        NULL,\n        NULL,\n        FALSE,\n       CREATE_DEFAULT_ERROR_MODE,\n       NULL,\n       NULL,\n       &amp;siStartupInfo,\n       &amp;piProcessInfo);\n</code></pre>\n\n<p>Please let me know how to receive the parameter \u201cPassing Data to C#\u201d from C# windows application i.e. Test.exe</p>\n"}, {"tags": ["c++", "lambda", "static", "singleton", "c++17"], "comments": [{"owner": {"reputation": 2500, "user_id": 6499716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L11cU.jpg?s=128&g=1", "display_name": "Shiro", "link": "https://stackoverflow.com/users/6499716/shiro"}, "edited": false, "score": 0, "creation_date": 1498672251, "post_id": 44809356, "comment_id": 76599065, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8391058/how-do-static-variables-in-lambda-function-objects-work\">How do static variables in lambda function objects work?</a>"}, {"owner": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "reply_to_user": {"reputation": 2500, "user_id": 6499716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L11cU.jpg?s=128&g=1", "display_name": "Shiro", "link": "https://stackoverflow.com/users/6499716/shiro"}, "edited": false, "score": 0, "creation_date": 1498672499, "post_id": 44809356, "comment_id": 76599203, "body": "@Shiro The question is more like, are anonymous lambdas temporary or not?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1498672857, "post_id": 44809356, "comment_id": 76599405, "body": "Why do you want to keep it out of scope? What&#39;s the problem?"}, {"owner": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1498673012, "post_id": 44809356, "comment_id": 76599505, "body": "@Barry I could very well keep my temporary loader it in scope, its just my obsession not to keep anything in scope that I don&#39;t actually want to access anymore."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "edited": false, "score": 0, "creation_date": 1498672264, "post_id": 44809420, "comment_id": 76599070, "body": "@AdamHunyadi Not sure if they a preferred or not but why create an object when all you need is a new scope?"}, {"owner": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "edited": false, "score": 0, "creation_date": 1498672289, "post_id": 44809420, "comment_id": 76599085, "body": "Okay, wait, these braces are pointless, this does not move <code>loader</code> out of scope..."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "edited": false, "score": 0, "creation_date": 1498672367, "post_id": 44809420, "comment_id": 76599130, "body": "@AdamHunyadi Yes it does.  When you enter the <code>{</code> you enter a new scope.  Once you get to <code>&#47;&#47;more code</code> that previous scope is now gone and you can&#39;t return to it.  If you had declared local variables in there they would be destroyed."}, {"owner": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "edited": false, "score": 0, "creation_date": 1498672667, "post_id": 44809420, "comment_id": 76599295, "body": "Ah, you are right, it indeed cannot be accessed. But the thing is, I want to return something from the lambda too, to assign a reference, thats why I want an anonymous lambda."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "edited": false, "score": 0, "creation_date": 1498672723, "post_id": 44809420, "comment_id": 76599329, "body": "@AdamHunyadi Then you probably need the lambda."}, {"owner": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "edited": false, "score": 0, "creation_date": 1498673184, "post_id": 44809420, "comment_id": 76599591, "body": "So the static variable would be stored on a free-d location, therefore the pointers would be dangling. This is the answer I wanted, thanks! I&#39;ll look for a workaround then :)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "edited": false, "score": 0, "creation_date": 1498673280, "post_id": 44809420, "comment_id": 76599644, "body": "@AdamHunyadi No, the variable will still exist and the pointer will not dangle.  <code>static</code> variables live for the life of the program and are initialized they first the the initialization is reached."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 6, "last_activity_date": 1498672838, "last_edit_date": 1498672838, "creation_date": 1498672172, "answer_id": 44809420, "question_id": 44809356, "link": "https://stackoverflow.com/questions/44809356/can-i-use-anonymous-lambdas-to-hold-on-to-static-values/44809420#44809420", "title": "Can I use anonymous lambdas to hold on to static values?", "body": "<p>You don't need a lambda to do this.  <code>static</code> variables can be declared at block scope so you could refactor to</p>\n\n<pre><code>A* a;\nB* b;\n{\n   static Loader loader(\"some\", \"argument\", \"the constructor\", \"takes\");\n   a = loader.getA();\n   b = loader.getB();\n}\n// more code\n</code></pre>\n\n<p>and now <code>loader</code> can never be directly accessed again (it is out of scope) but you can store pointers/references to it or it's members (it's lifetime last until the end of he program).</p>\n\n<hr>\n\n<p>Also, to answer you question about the lifetime of temporary lambdas, they are destroyed if you do not capture them.</p>\n\n<pre><code>[](){ /* some code */ }();\n</code></pre>\n\n<p>Will create an object, call its <code>operator()</code> and then destroy that temporary object.</p>\n"}], "owner": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 44809420, "answer_count": 1, "score": 2, "last_activity_date": 1498672900, "creation_date": 1498671899, "last_edit_date": 1498672900, "question_id": 44809356, "link": "https://stackoverflow.com/questions/44809356/can-i-use-anonymous-lambdas-to-hold-on-to-static-values", "title": "Can I use anonymous lambdas to hold on to static values?", "body": "<p>I have want to create an object that I want to keep out of scope, but set references to its fields. Is this approach any good?</p>\n\n<pre><code>A* a;\nB* b;\n[a, b]\n{\n   static Loader loader(\"some\", \"argument\", \"the constructor\", \"takes\");\n   a = loader.getA();\n   b = loader.getB();\n}();\n</code></pre>\n\n<p>Is the anonymous lambda destroyed with its owned values? Is there a better design pattern to achieve the same thing?</p>\n\n<p>Okay it seems like this is a good approach. My question is still if the anonymous lambda is destroyed upon parsing or not (and with it the owned static variable).</p>\n"}, {"tags": ["c++", "c++11", "dictionary", "void-pointers", "unordered-map"], "comments": [{"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 3, "creation_date": 1498671955, "post_id": 44809329, "comment_id": 76598881, "body": "how will you know whether the <code>void*</code> points to a string or dictionary? or is that the root of the question?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1498672038, "post_id": 44809329, "comment_id": 76598933, "body": "turn that <code>void*</code> into a custom type that holds a string or another dictionary and you can query which it has."}, {"owner": {"reputation": 1260, "user_id": 4763182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6929ba6d3abe683e0054f7dc8a8cb?s=128&d=identicon&r=PG", "display_name": "BishalG", "link": "https://stackoverflow.com/users/4763182/bishalg"}, "edited": false, "score": 0, "creation_date": 1498672074, "post_id": 44809329, "comment_id": 76598953, "body": "This information is given to us  in the question."}, {"owner": {"reputation": 1365, "user_id": 7610883, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d5b2f292c46f7ef87ab8a0adb47154fa?s=128&d=identicon&r=PG&f=1", "display_name": "cmdLP", "link": "https://stackoverflow.com/users/7610883/cmdlp"}, "edited": false, "score": 0, "creation_date": 1498672172, "post_id": 44809329, "comment_id": 76599016, "body": "Look at <a href=\"http://en.cppreference.com/w/cpp/container/unordered_map/\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/unordered_map</a> or <a href=\"http://www.cplusplus.com/reference/unordered_map/unordered_map/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/unordered_map/unordered_map</a>. But why dont you use <code>map</code>, which should be readable faster by binary search (writing to <code>map</code> is slower than writing to <code>unordered_map</code> because <code>map</code> seeks for a good place to insert the new value and <code>unordered_dict</code> just appends it but needs more time to read)."}], "answers": [{"comments": [{"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498672120, "post_id": 44809397, "comment_id": 76598981, "body": "<code>any</code> is also a good idea (for type-safe access).  <a href=\"http://en.cppreference.com/w/cpp/utility/any\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/utility/any</a>"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1498672135, "post_id": 44809397, "comment_id": 76598994, "body": "Should probably add that <code>std::variant</code> is part of C++17 (and OP&#39;s question is about C++11)"}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1498672166, "post_id": 44809397, "comment_id": 76599013, "body": "@UnholySheep There&#39;s also boost::variant and boost::any, or independent versions for it."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1498672323, "post_id": 44809397, "comment_id": 76599101, "body": "If you know that it is one of two types, <code>any</code> seems pretty heavy-handed."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 1, "creation_date": 1498672331, "post_id": 44809397, "comment_id": 76599108, "body": "@AlexanderHuszagh I don&#39;t think <code>any</code> is a good idea for this situation.  If the list of types is known at compile time, then <code>std::variant</code> is a lot more efficient"}, {"owner": {"reputation": 1260, "user_id": 4763182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6929ba6d3abe683e0054f7dc8a8cb?s=128&d=identicon&r=PG", "display_name": "BishalG", "link": "https://stackoverflow.com/users/4763182/bishalg"}, "edited": false, "score": 0, "creation_date": 1498672704, "post_id": 44809397, "comment_id": 76599317, "body": "@Curious, Thank you very much. But, I have already given to use &quot; void* &quot; ."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 1260, "user_id": 4763182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6929ba6d3abe683e0054f7dc8a8cb?s=128&d=identicon&r=PG", "display_name": "BishalG", "link": "https://stackoverflow.com/users/4763182/bishalg"}, "edited": false, "score": 1, "creation_date": 1498673801, "post_id": 44809397, "comment_id": 76599971, "body": "@BishalGautam If you are stuck with <code>void*</code>, well so be it, but know that in real world C++ the only time you should be using a <code>void*</code> is if you are interfacing with another library that demands you provide a <code>void*</code>. Using a <code>void*</code> within a C++ program is a sign of a bad design. Avoid it like the plague."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498673852, "post_id": 44809397, "comment_id": 76600009, "body": "@user4581301 is very right, avoid <code>void*</code> as much as possible"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 1260, "user_id": 4763182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6929ba6d3abe683e0054f7dc8a8cb?s=128&d=identicon&r=PG", "display_name": "BishalG", "link": "https://stackoverflow.com/users/4763182/bishalg"}, "edited": false, "score": 0, "creation_date": 1498705024, "post_id": 44809397, "comment_id": 76611491, "body": "@BishalGautam if the answer was acceptable to you don&#39;t forget to mark it as accepted!  There should be a tick mark right near where you upvote the question that you should be able to click"}], "tags": [], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "is_accepted": true, "score": 3, "last_activity_date": 1498673882, "last_edit_date": 1498673882, "creation_date": 1498672078, "answer_id": 44809397, "question_id": 44809329, "link": "https://stackoverflow.com/questions/44809329/accessing-a-nested-dictionary-unordered-mapstring-void-in-c/44809397#44809397", "title": "Accessing a nested dictionary unordered_map&lt;string, void*&gt; in c++?", "body": "<p>You probably want to use a <a href=\"http://en.cppreference.com/w/cpp/utility/variant\" rel=\"nofollow noreferrer\">variant</a> type instead of a <code>void*</code> pointer.</p>\n\n<p>So declare the unordered map like this </p>\n\n<pre><code>struct Map {\n    std::unordered_map&lt;\n        std::string, \n        std::variant&lt;std::unique_ptr&lt;Map&gt;, std::string&gt;\n    &gt; mp;\n};  \n</code></pre>\n\n<p>And then use it like this </p>\n\n<pre><code>auto map = Map{};\n// insert another map for the key \"something\"\nmap.mp[\"something\"] = std::make_unique&lt;Map&gt;();\n// insert a string for the key \"else\"\nmap.mp[\"else\"] = \"whatever\";\n</code></pre>\n\n<p>And then use the map like this (with C++17) where <code>operator&lt;&lt;</code> is overloaded for the <code>Map</code> type</p>\n\n<pre><code>// gotta love structured bindings &lt;3\nfor (const auto&amp; [key, value] : map) {\n    std::visit(value, [&amp;key](auto&amp; value) { \n        cout &lt;&lt; key &lt;&lt; \" : \" &lt;&lt; value &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>Or with C++14</p>\n\n<pre><code>for (const auto&amp; key_value : map) {\n    std::visit(value, [&amp;key_value](auto&amp; value) {\n        cout &lt;&lt; key_value.first &lt;&lt; \" : \" &lt;&lt; value &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>If you do not have access to C++17 then you can still use independent implementations of variant such as <code>boost::variant</code>, etc.  The logic and code will look surprisingly similar </p>\n\n<hr>\n\n<p>If you are given a pointer to <code>void*</code> for some reason, and you <strong>absolutely cannot change the API</strong>, you can use the following minimally viable solution</p>\n\n<pre><code>struct StringOrAnother {\n    enum class Type { STRING, MAP };\n    Type type;\n    std::unordered_map&lt;std::string, void*&gt; mp;\n    std::string str;\n};\n\nauto mp = std::unordered_map&lt;std::string, void*&gt; mp;\n\n// insert a string\nauto val_one = new StringOrAnother{STRING};\nval_one.str = \"some value\";\nmp[\"key one\"] = &amp;val_one;\nauto val_two = new StringOrAnother{MAP};\nmp[\"key two\"] = &amp;val_two;\n\nvoid print(const std::unordered_map&lt;std::string, void*&gt;&amp; mp) {\n\n    for (const auto&amp; key_value : mp) {\n        cout &lt;&lt; key_value.first &lt;&lt; \" : \";\n        auto&amp; value = *static_cast&lt;StringOrAnother*&gt;(&amp;key_value.second);\n        if (value.second.type == StringOrAnother::STRING) {\n            cout &lt;&lt; value.second.str &lt;&lt; endl;\n        } else {\n            print(value.second.mp);\n        }\n    }\n\n}\n</code></pre>\n\n<p>Note that I have not used <code>unique_ptr</code> for the pointers and have allocated them manually.  It is up to you to <code>delete</code> them later on and not leak memory!</p>\n"}], "owner": {"reputation": 1260, "user_id": 4763182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6929ba6d3abe683e0054f7dc8a8cb?s=128&d=identicon&r=PG", "display_name": "BishalG", "link": "https://stackoverflow.com/users/4763182/bishalg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 44809397, "answer_count": 1, "score": 0, "last_activity_date": 1543344005, "creation_date": 1498671838, "last_edit_date": 1543344005, "question_id": 44809329, "link": "https://stackoverflow.com/questions/44809329/accessing-a-nested-dictionary-unordered-mapstring-void-in-c", "title": "Accessing a nested dictionary unordered_map&lt;string, void*&gt; in c++?", "body": "<p>Suppose we are provided a nested dictionary in which that values are either a string or another dictionary, which is declared as:</p>\n\n<p><code>unordered_map&lt;string, void*&gt; dictionary</code></p>\n\n<p>How can we access and perform operations using this dictionary?</p>\n"}, {"tags": ["c++", "opencv", "image-processing"], "answers": [{"comments": [{"owner": {"reputation": 677, "user_id": 4569319, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/reg0i.jpg?s=128&g=1", "display_name": "ecatalano", "link": "https://stackoverflow.com/users/4569319/ecatalano"}, "edited": false, "score": 0, "creation_date": 1498673006, "post_id": 44809476, "comment_id": 76599500, "body": "Perfect! Using abs(sum) when setting my pixel value fixed it. I&#39;m just curious as to what you mean by clamping the value. Are you saying if the value is &gt; 255, then set it to 255?"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 677, "user_id": 4569319, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/reg0i.jpg?s=128&g=1", "display_name": "ecatalano", "link": "https://stackoverflow.com/users/4569319/ecatalano"}, "edited": false, "score": 0, "creation_date": 1498673878, "post_id": 44809476, "comment_id": 76600021, "body": "@ecatalano: yes, as <code>sum</code> can be larger than 255"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 1, "creation_date": 1498679485, "post_id": 44809476, "comment_id": 76603215, "body": "you can use opencv&#39;s saturate_cast function to prevent over- and underflows."}], "tags": [], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "is_accepted": true, "score": 1, "last_activity_date": 1498672403, "creation_date": 1498672403, "answer_id": 44809476, "question_id": 44809271, "link": "https://stackoverflow.com/questions/44809271/manual-implementation-of-sobel-operator-in-opencv/44809476#44809476", "title": "Manual Implementation of Sobel Operator in OpenCV", "body": "<p>You seem to have problems where the sum is negative. Take the absolute value of <code>sum</code>, and clamp it to 255 (or instead of absolute value, clamp it to 0 - depending of what you want to achieve. A \"full\" sobel operator usually uses 2d distance formula, so a horizonal/vertical only variant should use the absolute value)</p>\n"}], "owner": {"reputation": 677, "user_id": 4569319, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/reg0i.jpg?s=128&g=1", "display_name": "ecatalano", "link": "https://stackoverflow.com/users/4569319/ecatalano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 44809476, "answer_count": 1, "score": 1, "last_activity_date": 1503310439, "creation_date": 1498671654, "question_id": 44809271, "link": "https://stackoverflow.com/questions/44809271/manual-implementation-of-sobel-operator-in-opencv", "title": "Manual Implementation of Sobel Operator in OpenCV", "body": "<p>I am trying to apply a sobel operator by iterating through an image and applying a mask to surrounding pixels.</p>\n\n<p>For now, I am trying to apply the vertical portion of the mask, which is:</p>\n\n<pre><code>-1 0 1\n-2 0 2\n-1 0 1\n</code></pre>\n\n<p>In my implementaiton, I am iterating through the rows and columns as follows:</p>\n\n<pre><code>for (int i = 1; i &lt; image.rows-1; i++){\n            for (int j = 1; j &lt; image.cols-1; j++){\n            int pixel1 = image.at&lt;Vec3b&gt;(i-1,j-1)[0] * -1;\n            int pixel2 = image.at&lt;Vec3b&gt;(i,j-1)[0] * 0;\n            int pixel3 = image.at&lt;Vec3b&gt;(i+1,j-1)[0] * 1;\n\n            int pixel4 = image.at&lt;Vec3b&gt;(i-1,j)[0] * -2;\n            int pixel5 = image.at&lt;Vec3b&gt;(i,j)[0] * 0;\n            int pixel6 = image.at&lt;Vec3b&gt;(i+1,j)[0] * 2;\n\n            int pixel7 = image.at&lt;Vec3b&gt;(i-1,j+1)[0] * -1;\n            int pixel8 = image.at&lt;Vec3b&gt;(i,j+1)[0] * 0;\n            int pixel9 = image.at&lt;Vec3b&gt;(i+1,j+1)[0] * 1;\n\n            int sum = pixel1 + pixel2 + pixel3 + pixel4 + pixel5 + pixel6 + pixel7 + pixel8 + pixel9;\n            verticalSobel.at&lt;Vec3b&gt;(i,j)[0] = sum;\n            verticalSobel.at&lt;Vec3b&gt;(i,j)[1] = sum;\n            verticalSobel.at&lt;Vec3b&gt;(i,j)[2] = sum;\n        }\n    }\n</code></pre>\n\n<p>Where the pixels are labeled as:</p>\n\n<pre><code>1 2 3\n4 5 6\n7 8 9\n</code></pre>\n\n<p>However, the resulting image is far off of what it should look like.</p>\n\n<p>For reference, the resulting image is <a href=\"https://i.stack.imgur.com/MtLT2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MtLT2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where it should look similar to: \n<a href=\"https://i.stack.imgur.com/8jjug.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8jjug.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The guide I am using is: <a href=\"https://www.tutorialspoint.com/dip/sobel_operator.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/dip/sobel_operator.htm</a></p>\n\n<p>I am not sure if I am simply implementing the operator incorrectly, or just iterating through the image incorrectly. </p>\n\n<p>Any help would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["c++", "templates", "namespaces", "template-specialization"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1498670649, "post_id": 44808955, "comment_id": 76598117, "body": "&quot; for all instances&quot; - for all instances of what? Templates are specialised on types, not instances."}, {"owner": {"reputation": 531, "user_id": 5410757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sE4bZ.png?s=128&g=1", "display_name": "PaulProgrammerNoob", "link": "https://stackoverflow.com/users/5410757/paulprogrammernoob"}, "edited": false, "score": 0, "creation_date": 1498670745, "post_id": 44808955, "comment_id": 76598168, "body": "That&#39;s right. After a day of programming such mistakes may happen."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1498670873, "post_id": 44808955, "comment_id": 76598232, "body": "Why do you think you want to do this?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1498670944, "post_id": 44808955, "comment_id": 76598274, "body": "AFAIK the namespace has no effect on the type which would make this impossible.  Kind of sounds like an XY problem though.  What is it that you need to achieve?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498671121, "post_id": 44808955, "comment_id": 76598384, "body": "Part of the glory of templates is they will specialize as you need them. Are you wanting to make a file containing a pool of pre-specialized templates to reduce your executable or library size?"}, {"owner": {"reputation": 531, "user_id": 5410757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sE4bZ.png?s=128&g=1", "display_name": "PaulProgrammerNoob", "link": "https://stackoverflow.com/users/5410757/paulprogrammernoob"}, "edited": false, "score": 0, "creation_date": 1498671264, "post_id": 44808955, "comment_id": 76598494, "body": "I want to hide two different implementations (each in its own namespace) in one interface. Both implementations use different methods to create their implementation instances, but these methods are similar accross all types in each namespace, for exaple: A::create() and B::buildObject()."}], "answers": [{"tags": [], "owner": {"reputation": 4531, "user_id": 4756309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/XMiQX.png?s=128&g=1", "display_name": "Weak to Enuma Elish", "link": "https://stackoverflow.com/users/4756309/weak-to-enuma-elish"}, "is_accepted": true, "score": 2, "last_activity_date": 1498673160, "last_edit_date": 1498673160, "creation_date": 1498671843, "answer_id": 44809330, "question_id": 44808955, "link": "https://stackoverflow.com/questions/44808955/namespace-constraint-in-template-definition/44809330#44809330", "title": "Namespace constraint in template definition", "body": "<p>If you put a function template inside the namespace you want to specialize for, you can use argument dependent lookup.</p>\n\n<pre><code>struct Out{};\n\nnamespace ns\n{\n    struct In{};\n\n    template &lt;typename T&gt;\n    void ADL(const T&amp;){} //Found via argument dependent lookup\n}\n\ntemplate &lt;class T, class U = decltype(ADL(std::declval&lt;T&gt;()))&gt;\nvoid func_impl(int) //Better match, only works if function ADL is found\n{\n    std::cout &lt;&lt; \"Specialized.\\n\";\n}\n\ntemplate &lt;class T&gt;\nvoid func_impl(...)\n{\n    std::cout &lt;&lt; \"Unspecialized.\\n\";\n}\n\ntemplate &lt;class T&gt;\nvoid func()\n{\n    func_impl&lt;T&gt;(0);\n}\n</code></pre>\n\n<p>When you call <code>func</code> it will call the correct overload of the <code>func_impl</code>.</p>\n\n<pre><code>func&lt;Out&gt;(); //prints Unspecialized.\nfunc&lt;ns::In&gt;(); //prints Specialized.\n</code></pre>\n"}], "owner": {"reputation": 531, "user_id": 5410757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sE4bZ.png?s=128&g=1", "display_name": "PaulProgrammerNoob", "link": "https://stackoverflow.com/users/5410757/paulprogrammernoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 44809330, "answer_count": 1, "score": 0, "last_activity_date": 1498673160, "creation_date": 1498670476, "last_edit_date": 1498671281, "question_id": 44808955, "link": "https://stackoverflow.com/questions/44808955/namespace-constraint-in-template-definition", "title": "Namespace constraint in template definition", "body": "<p>I have to specialize a template function for all types in a given namespace <code>rofl</code>. Is a namespace constraint for a template type possible? I have the following in mind:</p>\n\n<pre><code>template&lt;typename rofl::T&gt;\nMyClass::MyFunc() {\n    impl = T::create();\n}\n</code></pre>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 1897, "user_id": 7852370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cce33d6db1eedb9046807aadd574f?s=128&d=identicon&r=PG&f=1", "display_name": "Karl Reid", "link": "https://stackoverflow.com/users/7852370/karl-reid"}, "edited": false, "score": 2, "creation_date": 1498668682, "post_id": 44808392, "comment_id": 76596923, "body": "It&#39;s undefined behaviour, that just means it could work, or it could not work, or your machine could blow up, anything could happen. As you have seen, the variables <i>happen</i> to be memory adjacent in this case, but you can&#39;t make any assumptions about that."}, {"owner": {"reputation": 1897, "user_id": 7852370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cce33d6db1eedb9046807aadd574f?s=128&d=identicon&r=PG&f=1", "display_name": "Karl Reid", "link": "https://stackoverflow.com/users/7852370/karl-reid"}, "edited": false, "score": 0, "creation_date": 1498668761, "post_id": 44808392, "comment_id": 76596971, "body": "By the way when I run the code, I get <code>y</code> twice, I don&#39;t get <code>n</code> at all."}, {"owner": {"reputation": 479, "user_id": 4817002, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/0bf04ee52f2f90d0fcdc86ebe0399010?s=128&d=identicon&r=PG&f=1", "display_name": "Potatosaurus", "link": "https://stackoverflow.com/users/4817002/potatosaurus"}, "reply_to_user": {"reputation": 1897, "user_id": 7852370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cce33d6db1eedb9046807aadd574f?s=128&d=identicon&r=PG&f=1", "display_name": "Karl Reid", "link": "https://stackoverflow.com/users/7852370/karl-reid"}, "edited": false, "score": 0, "creation_date": 1498669119, "post_id": 44808392, "comment_id": 76597203, "body": "@KarlReid whoops I forgot to include the &quot;bad&quot; dereferencing, will update OP in a sec."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1498670282, "post_id": 44808392, "comment_id": 76597896, "body": "@Potatosaurus  Whay is &#39;y&#39; outputted in this statement when point1 points to &quot;var&quot; ?:)"}], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 0, "creation_date": 1498668994, "post_id": 44808449, "comment_id": 76597120, "body": "I&#39;d have to argue that behavior is, in fact, defined."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 3, "creation_date": 1498669041, "post_id": 44808449, "comment_id": 76597153, "body": "@veganaiZe The program goes out of bounds of the single character variable. Going out of bounds is always UB."}, {"owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 0, "creation_date": 1498669246, "post_id": 44808449, "comment_id": 76597270, "body": "The display of the consecutive characters would happen in every implementation; Undefined behavior would likely produce varying results under various implementations. I think we&#39;ve landed on the fence with this one, as part of the output is defined and the invisible part is not."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1498669457, "post_id": 44808449, "comment_id": 76597405, "body": "But it is not REQUIRED to be consecutive. The some of the storage could be on Pluto over a quantum entanglement link, some accessed from Mordor via palantir and the remainder stashed at the bottom of the Mariana Trench and communicated via Aquaman through telepathic fish. So long as it meets the requirements for Automatic and Dynamic storage, C++ will allow the most batsmurf of fantasy."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 0, "creation_date": 1498669472, "post_id": 44808449, "comment_id": 76597412, "body": "@veganaiZe -- unless <code>var</code> has the value <code>&#39;\\0&#39;</code>, <code>point2</code> does not point to a nul-terminated array of <code>char</code>; treating it as one produces undefined behavior."}, {"owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 0, "creation_date": 1498669531, "post_id": 44808449, "comment_id": 76597443, "body": "What am I thinking...  I am probably wrong.  Does anyone know where to find how standard C++ assigns pointer values to chars?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 2, "creation_date": 1498669659, "post_id": 44808449, "comment_id": 76597513, "body": "@veganaiZe <a href=\"https://isocpp.org/\" rel=\"nofollow noreferrer\">isocpp.org</a> Top left corner under the logo you&#39;ll find a link to an up-to-date draft of the next C++ standard."}, {"owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 0, "creation_date": 1498669684, "post_id": 44808449, "comment_id": 76597525, "body": "Sorry, it&#39;s too early today...  I finally got the ability to comment after not being able to drop any well-thought knowledge for so long...  Maybe it is still too early.  Back to that little hole for me."}, {"owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1498670275, "post_id": 44808449, "comment_id": 76597892, "body": "@user4581301 Thanks.  If I can&#39;t find it in there I will submit a proposal and attempt to get sequential value pointer assignment (so that I will look like a genius in the future). Truth be told, I am actually an out-of-work C and wanna-be Python programmer (can you tell ;) -- BTW You took my 1st choice for a username!"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 1, "creation_date": 1498671382, "post_id": 44808449, "comment_id": 76598574, "body": "@veganaiZe It&#39;s undefined behavior because that&#39;s what the standard says about out of bounds access. Even if the following variables were guaranteed to be consecutive so as to imply that the out of bounds access would always end up dereferencing those variables, it would <i>still</i> be undefined behavior. If the compiler can detect this situation, it is free to do anything. It might assume that your function is unreachable in the name of optimization. Here is <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20140627-00/?p=633\" rel=\"nofollow noreferrer\">an example</a> of undefined behavior fundamentally changing the program."}, {"owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498671643, "post_id": 44808449, "comment_id": 76598707, "body": "@Fran&#231;oisAndrieux Can you please site the source of your answer (in the standard itself)?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 0, "creation_date": 1498672611, "post_id": 44808449, "comment_id": 76599266, "body": "@veganaiZe I&#39;m not sure for which part of my answer you want a source. In any case, it&#39;s purpose was to explain that undefined behavior can&#39;t be circumvented by tightening the underlying representation and layout of objects in memory. Even if you can be certain of how objects would be layed out, you can&#39;t rely on safely accessing that representation if it&#39;s done through undefined behavior because the compiler may detect the attempt and can rightfully disregard your intentions."}, {"owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498674166, "post_id": 44808449, "comment_id": 76600191, "body": "@Fran&#231;oisAndrieux I just think we should follow due process and confirm that, regardless of any implementation and hearsay, the standard truly does not define that variables should be handed sequential vector-table values for pointers (internally). Even if an optimizing compiler is allowed to go crazy as soon as it hits a bound, in theory, that optimization could be disabled and there is (until it is shown otherwise in the standard) the possibility that this behavior is defined.  I have yet to be proven wrong and I feel (as much as the next person) that I should be."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 0, "creation_date": 1498674681, "post_id": 44808449, "comment_id": 76600490, "body": "@veganaiZe My comments intended to discuss the nature of undefined behavior and the futility of trying to circumvent it <i>in general</i>, not specifically for your case. I used this question&#39;s subject as an example, assuming that it is in fact undefined behavior. If it happens that it <i>isn&#39;t</i> undefined behavior, I&#39;ve chosen a poor example but the arguments message unchanged. That said, I&#39;ve looked into finding a citation in the standard regarding local variable layout but I couldn&#39;t come up with one. Keep in mind that behavior is implicitly undefined unless otherwise defined by the standard."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "edited": false, "score": 0, "creation_date": 1498674689, "post_id": 44808449, "comment_id": 76600495, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/147862/discussion-between-francois-andrieux-and-veganaize\">continue this discussion in chat</a>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498675125, "post_id": 44808449, "comment_id": 76600728, "body": "You may want to consider posting a question on the subject, with the language lawyer tag. Answers with that tag are expected to be pedantic and to cite reliable sources."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 9, "last_activity_date": 1498668698, "creation_date": 1498668698, "answer_id": 44808449, "question_id": 44808392, "link": "https://stackoverflow.com/questions/44808392/how-am-i-receiving-the-following-output-when-incorrectly-dereferencing-a-point/44808449#44808449", "title": "How am I receiving the following output when (incorrectly) dereferencing a pointer to a pointer?", "body": "<p>The expression <code>*point2</code> is of type <code>char *</code> which is treated as a string. If it's not really a string then you have <em>undefined behavior</em> and that's really the end of the story.</p>\n\n<p>In reality what happens is that the output operator <code>&lt;&lt;</code> reads consecutive bytes from memory until it hits a zero (the \"string terminator\"). In your case the compiler have put the storage for the variables next to each other, that's why you see both being output in the \"string\".</p>\n"}, {"tags": [], "owner": {"reputation": 471, "user_id": 5039027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9h9I.png?s=128&g=1", "display_name": "veganaiZe", "link": "https://stackoverflow.com/users/5039027/veganaize"}, "is_accepted": false, "score": 3, "last_activity_date": 1498668801, "creation_date": 1498668801, "answer_id": 44808481, "question_id": 44808392, "link": "https://stackoverflow.com/questions/44808392/how-am-i-receiving-the-following-output-when-incorrectly-dereferencing-a-point/44808481#44808481", "title": "How am I receiving the following output when (incorrectly) dereferencing a pointer to a pointer?", "body": "<p>C++ thinks that the <em>pointer to char</em> is the beginning of a <strong>string</strong>.  So it tries to continue printing until it finds a <code>NULL</code> value.</p>\n"}], "owner": {"reputation": 479, "user_id": 4817002, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/0bf04ee52f2f90d0fcdc86ebe0399010?s=128&d=identicon&r=PG&f=1", "display_name": "Potatosaurus", "link": "https://stackoverflow.com/users/4817002/potatosaurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 44808449, "answer_count": 2, "score": 1, "last_activity_date": 1498669172, "creation_date": 1498668486, "last_edit_date": 1498669172, "question_id": 44808392, "link": "https://stackoverflow.com/questions/44808392/how-am-i-receiving-the-following-output-when-incorrectly-dereferencing-a-point", "title": "How am I receiving the following output when (incorrectly) dereferencing a pointer to a pointer?", "body": "<p>This is not so much a question that I need solving, it's more a case of I made a mistake which resulted in weird output, and I'm curious what's going on.</p>\n\n<p>So if point1 is a pointer to the char \"var\", and point2 is a pointer to the pointer point1, to correctly dereference point2 as follows:  </p>\n\n<pre><code>cout &lt;&lt; **point2 &lt;&lt; endl;\n</code></pre>\n\n<p>Which would ouput \"y\" as expected.</p>\n\n<p>However, if I incorrectly dereference the pointer, as follows:  </p>\n\n<pre><code>cout &lt;&lt; *point2 &lt;&lt; endl;\n</code></pre>\n\n<p>Then the output would include any subsequent variables declared after the initial variable var.<br>\nFor example, in the code below, var2 would also be included, for an ouput of \"yn\", and further variables such as   </p>\n\n<pre><code>char var3 = 'a';\nchar var4 = 'b';\n</code></pre>\n\n<p>Also seem to be included for an ouput of \"ynab\".<br>\nI think I understand <em>how</em> it's happening, and outputting the memory addresses of each of the variables through a method such as:  </p>\n\n<pre><code>cout &lt;&lt; (void *) &amp;var &lt;&lt;endl;\n</code></pre>\n\n<p>Which confirms that each variable is adjacent in memory, however I'm unsure <em>why</em> it is happening.</p>\n\n<p><strong>Why does improperly dereferencing a pointer to a pointer seem to return successive variables?</strong></p>\n\n<p>Code:  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nchar var = 'y';\nchar var2 = 'n';\n\n//Declare point1 as a pointer to a char\nchar* point1 = &amp;var;\n\n//Declare point2 as pointer to pointer to char\nchar** point2 = &amp;point1;\n\nint main(int argc, char **argv)\n{\n    cout &lt;&lt; \"Dereference point1: \" &lt;&lt; *point1 &lt;&lt; endl;\n\n    cout &lt;&lt; \"Dereference point2: \" &lt;&lt; **point2 &lt;&lt; endl;\n    cout &lt;&lt; \"Bad dereference of point2: \" &lt;&lt; *point2 &lt;&lt; endl;\n\n    cout &lt;&lt; \"Var: \" &lt;&lt; var &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "cython"], "comments": [{"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498669192, "post_id": 44808298, "comment_id": 76597249, "body": "You can easily have both classes present in the same class, however, a quick glance at SFML&#39;s Vector2 implementation shows there is no access to a <code>data()</code> member, meaning any data would likely have to be copied over (it&#39;s not <code>numpy.ctypeslib.as_array</code> friendly).   You could easily have a wrapper for both, just with a bit of syntactic sugar, but you would have consider copying data over for each to use methods from each individual library."}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498669309, "post_id": 44808298, "comment_id": 76597306, "body": "Another (very simply option) is you could export both classes separately, and then have a wrapper that enacts a shared subset of methods (like multiplication, division, etc.) storing one of the two exported classes as a data member. If you would like, I can give an example as an answer."}, {"owner": {"reputation": 2805, "user_id": 2639576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tUGIt.jpg?s=128&g=1", "display_name": "HankMoody", "link": "https://stackoverflow.com/users/2639576/hankmoody"}, "reply_to_user": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "edited": false, "score": 0, "creation_date": 1498669442, "post_id": 44808298, "comment_id": 76597396, "body": "@AlexanderHuszagh Would be great to see an example."}, {"owner": {"reputation": 16534, "user_id": 128028, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bcaa77933aaf36e13d533c713860e6ab?s=128&d=identicon&r=PG", "display_name": "Viet", "link": "https://stackoverflow.com/users/128028/viet"}, "edited": false, "score": 1, "creation_date": 1498669668, "post_id": 44808298, "comment_id": 76597519, "body": "From design and maintenance point of view, it&#39;s best to have 1 Python class per 1 C++ class. You can have 3rd Python class to just to wrap those 2."}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1498759232, "post_id": 44808298, "comment_id": 76644571, "body": "The usual approach in Python is that it&#39;s the interface that is important, rather than the class, and so provided the two classes have the same interface then they should work interchangably"}], "answers": [{"comments": [{"owner": {"reputation": 2805, "user_id": 2639576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tUGIt.jpg?s=128&g=1", "display_name": "HankMoody", "link": "https://stackoverflow.com/users/2639576/hankmoody"}, "edited": false, "score": 0, "creation_date": 1498675745, "post_id": 44809056, "comment_id": 76601112, "body": "Great answer. I have one question: what does this <code>ALLOCATOR=*</code> do?"}, {"owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "reply_to_user": {"reputation": 2805, "user_id": 2639576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tUGIt.jpg?s=128&g=1", "display_name": "HankMoody", "link": "https://stackoverflow.com/users/2639576/hankmoody"}, "edited": false, "score": 0, "creation_date": 1498676055, "post_id": 44809056, "comment_id": 76601304, "body": "@PythonFanboy  The STL vector is defined as <code>std::vector&lt;T, std::allocator&lt;T&gt;</code>, meaning it takes two types, not 1. Cython needs to know this, but it cannot use the second type. This notifies Cython that <code>vector</code> takes two types for a template, but the second one is default initialized. In this case, I was wrong and Sfml does not allow you to define an allocator. I&#39;ll edit my answer."}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1498757609, "post_id": 44809056, "comment_id": 76643618, "body": "You don&#39;t have to tell Cython about the second type. Provided that the text <code>std::vector&lt;T&gt;</code> generates valid C++ code with appropriate substitutions of T (which it does) then Cython really doesn&#39;t need to know about the second argument."}], "tags": [], "owner": {"reputation": 10345, "user_id": 4131059, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uDaBr.jpg?s=128&g=1", "display_name": "Alexander Huszagh", "link": "https://stackoverflow.com/users/4131059/alexander-huszagh"}, "is_accepted": true, "score": 1, "last_activity_date": 1498676111, "last_edit_date": 1498676111, "creation_date": 1498670823, "answer_id": 44809056, "question_id": 44808298, "link": "https://stackoverflow.com/questions/44808298/wrapping-multiple-c-classes-into-one-python-class/44809056#44809056", "title": "Wrapping multiple C++ classes into one Python class", "body": "<p><strong>Overview</strong></p>\n\n<p>The general idea is three steps:</p>\n\n<ol>\n<li>Write declarations for your types</li>\n<li>Wrap each class individually with an identical interface</li>\n<li>Write a generalized vector wrapper</li>\n</ol>\n\n<p><strong>Declarations</strong></p>\n\n<p>First you need a Cython declaration for the wrapped types. An example (very minimal) is as follows.</p>\n\n<pre><code># This is the Cython interface for Vector2\n\ncdef float float32 \n\ncdef extern from \"Vector2.hpp\" nogil:\n    # if this was an stl vector, use vector[T, ALLOCATOR=*]\n    # you must list every template type, even one with default values\n    cdef cppclass Vector2[T]:   \n        ctypedef T value_type\n\n        # Add all the overloads, for example, multiplication\n        Vector2[T, ALLOCATOR] operator*(const T&amp;) const;\n\n\ncdef extern from \"b2Math.h\" nogil:\n    cdef cppclass b2Vec2:\n\n        # Add all overloads, for example, multiplication\n        void operator*=(float)\n</code></pre>\n\n<p><strong>Interface</strong></p>\n\n<p>Next, you need to wrap these into Python wrappers. You need to make sure they have identical interfaces, so one can be used like another. The <a href=\"https://docs.python.org/3/reference/datamodel.html\" rel=\"nofollow noreferrer\">Python data model</a> is your friend. A very simple example is:</p>\n\n<pre><code>cdef class SfmlVector2_32:\n    # This is a definition for a float32 vector from Sfml\n    Vector2[float32] c\n\n    def __mul__(self, float32 x):\n        # multiple and assign\n        B2Vector2_32 copy;\n        copy.c = c * x\n        return copy;\n\ncdef class B2Vector2_32:\n    # This is a definition for a float32 vector from box2\n    b2Vec2 c\n\n    def __mul__(self, float32 x):\n        # multiple and assign\n        B2Vector2_32 copy;\n        copy.c = c;\n        copy.c *= x\n        return copy\n</code></pre>\n\n<p><strong>Generalized Vector</strong></p>\n\n<p>Finally, you need a simple wrapper class, which binds one of the many vector types and performs the right operation on the class. Since Python is not statically typed, and since the interfaces for each vector you wrapped are identical, this is easy: just initial the correct vector in <code>__init__</code>.</p>\n\n<pre><code>class Vector2_32:\n\n    def __init__(self, framework = 'SFML'):\n        # ideally, perform a dictionary lookup if you have many classes\n        # O(1) for dict, if/then is O(n)\n        if framework == 'SFML':\n            self.vector = SfmlVector2_32()\n        elif framework == 'BOX2':\n            self.vector = B2Vector2_32()\n        else:\n            raise TypeError(\"Unrecognized framework.\")\n\n    def __mul__(self, float32 x):\n        Vector2_32 copy\n        copy.vector = vector * x\n        return copy\n</code></pre>\n\n<p><strong>Thoughts</strong></p>\n\n<p>This is a pretty bad example, since typically you implement <code>__mul__</code> (multiplication) in terms of <code>__imul__</code> (in-place multiplication), but it gets the general idea across. There are likely typos in this code, I don't have access to a machine to compile it right now.</p>\n"}], "owner": {"reputation": 2805, "user_id": 2639576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tUGIt.jpg?s=128&g=1", "display_name": "HankMoody", "link": "https://stackoverflow.com/users/2639576/hankmoody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 44809056, "answer_count": 1, "score": 0, "last_activity_date": 1498676111, "creation_date": 1498668213, "last_edit_date": 1498669364, "question_id": 44808298, "link": "https://stackoverflow.com/questions/44808298/wrapping-multiple-c-classes-into-one-python-class", "title": "Wrapping multiple C++ classes into one Python class", "body": "<p>Cython allows to use C and C++ libraries by wrapping their functions and classes. Two of the libraries I would like to use are SFML and Box2D. They define separate Vector2 classes. Would it be possible to write one Vector2 Python wrapper for both of these libraries (and potentially more)? My goal is to have single Python type of Vector2 when interacting with different libraries.</p>\n\n<p>Do someone already did something similar? This would simplify things and unify my Python API. I've already wrapped parts of SFML but other than that I'm new to Cython.</p>\n\n<p>For the reference <a href=\"https://github.com/SFML/SFML/blob/master/include/SFML/System/Vector2.hpp\" rel=\"nofollow noreferrer\">SFML's Vector2</a> looks like this:</p>\n\n<pre><code>template &lt;typename T&gt; class Vector2 {\n    public:\n        T x;\n        T y;\n        Vector2();\n        Vector2(T X, T Y);\n        template &lt;typename U&gt; explicit Vector2(const Vector2&lt;U&gt;&amp; vector);\n        ...\n};\n</code></pre>\n\n<p>And <a href=\"https://github.com/erincatto/Box2D/blob/master/Box2D/Box2D/Common/b2Math.h\" rel=\"nofollow noreferrer\">Box2D vector</a>:</p>\n\n<pre><code>struct b2Vec2 {\n    float32 x, y;\n    b2Vec2() {}\n    b2Vec2(float32 xIn, float32 yIn);\n    ...\n};\n</code></pre>\n"}, {"tags": ["java", "android", "c++", "android-ndk", "cocos2d-x"], "comments": [{"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1498672330, "post_id": 44808206, "comment_id": 76599106, "body": "As far as I see native-to-java call should be issued on some non-main thread? And then you want to post call to main thread and wait until the result becomes ready?"}, {"owner": {"reputation": 1645, "user_id": 4869914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/94e94ff39b0e876b5edd59dd8ee58c48?s=128&d=identicon&r=PG&f=1", "display_name": "keyboard", "link": "https://stackoverflow.com/users/4869914/keyboard"}, "reply_to_user": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 1, "creation_date": 1498674551, "post_id": 44808206, "comment_id": 76600417, "body": "Thanks for the questions, I thought about it some more and edited the question with how I&#39;d imagine it to work ideally. Does it make sense?"}], "answers": [{"comments": [{"owner": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1498681010, "post_id": 44811333, "comment_id": 76604118, "body": "why do you want to make your life harder? just call a java callback method (with any your data passed as params) from your c++ background thread and from your java callback post it to he UI thread by calling <code>Handler#post</code> / <code>Handler#sendMessage</code> / whatever"}, {"owner": {"reputation": 1114, "user_id": 1645444, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/deb932782d59eed3c2d4c7db4c3e066c?s=128&d=identicon&r=PG", "display_name": "Elviss Strazdins", "link": "https://stackoverflow.com/users/1645444/elviss-strazdins"}, "reply_to_user": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1498681712, "post_id": 44811333, "comment_id": 76604560, "body": "My engine is C++, so I want as little Java as I can get because Java resides in the &quot;user&#39;s part&quot; of the app, not my engine."}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 2, "creation_date": 1498682218, "post_id": 44811333, "comment_id": 76604814, "body": "There is absolutely no need to utilize JNI for interacting with main looper. There is NDK header <code>&lt;android&#47;looper.h&gt;</code> that exposes interface to the native looper. See my answer."}, {"owner": {"reputation": 1114, "user_id": 1645444, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/deb932782d59eed3c2d4c7db4c3e066c?s=128&d=identicon&r=PG", "display_name": "Elviss Strazdins", "link": "https://stackoverflow.com/users/1645444/elviss-strazdins"}, "edited": false, "score": 0, "creation_date": 1498686802, "post_id": 44811333, "comment_id": 76606920, "body": "Thanks! I think you approach is a lot better. I already implemented it into the Ouzel engine. Thank you!"}, {"owner": {"reputation": 4859, "user_id": 1000626, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15e1f36f8333463810b19b7e397ccd76?s=128&d=identicon&r=PG", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/1000626/chris-watts"}, "edited": false, "score": 0, "creation_date": 1545225598, "post_id": 44811333, "comment_id": 94551506, "body": "I used to use JNI for this job, but I soon found out that cleaning up local JNI references is a nightmare from a C++-owned thread. The answer that doesn&#39;t use JNI is a better idea."}], "tags": [], "owner": {"reputation": 1114, "user_id": 1645444, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/deb932782d59eed3c2d4c7db4c3e066c?s=128&d=identicon&r=PG", "display_name": "Elviss Strazdins", "link": "https://stackoverflow.com/users/1645444/elviss-strazdins"}, "is_accepted": false, "score": 3, "last_activity_date": 1498679183, "creation_date": 1498679183, "answer_id": 44811333, "question_id": 44808206, "link": "https://stackoverflow.com/questions/44808206/android-jni-call-function-on-android-ui-thread-from-c/44811333#44811333", "title": "Android JNI - Call function on Android UI thread from C++", "body": "<p>To run C++ code on Android UI (main) thread, you will have to use Android the looper (activity.getMainLooper() or Looper.getMainLooper() in Java):</p>\n\n<pre><code>jmethodID getMainLooperMethod = jniEnv-&gt;GetMethodID(mainActivityClass, \"getMainLooper\", \"()Landroid/os/Looper;\");\njobject mainLooper = jniEnv-&gt;CallObjectMethod(mainActivity, getMainLooperMethod);\n</code></pre>\n\n<p>\"mainActivity\" is an instance of android.app.Activity, that is passed to the JNI from Java, but you can also simply use the static getMainLooper method of the Looper class. Next you have to create an instance of Handler class (new Handler(mainLooper in Java):</p>\n\n<pre><code>jclass handlerClass = jniEnv-&gt;FindClass(\"android/os/Handler\");\njmethodID handlerConstructor = jniEnv-&gt;GetMethodID(handlerClass, \"&lt;init&gt;\", \"(Landroid/os/Looper;)V\");\npostMethod = jniEnv-&gt;GetMethodID(handlerClass, \"post\", \"(Ljava/lang/Runnable;)Z\");\nhandler = jniEnv-&gt;NewObject(handlerClass, handlerConstructor, mainLooper);\nhandler = jniEnv-&gt;NewGlobalRef(handler);\n</code></pre>\n\n<p>Be aware that you have to store the handler (jobject) to use it later.\nYou will have to write a bit of Java to implement the Runnable interface, so this code goes in Java:</p>\n\n<pre><code>package my.package;\n\nimport java.lang.Runnable;\n\npublic class Runner implements Runnable\n{\n    native public void run();\n}\n</code></pre>\n\n<p>As you can see the run() method is native, so we can implement it in C++ as follows:</p>\n\n<pre><code>extern \"C\" JNIEXPORT void JNICALL \nJava_my_package_Runner_run(JNIEnv*, jclass)\n{\n    // here goes your native code\n}\n</code></pre>\n\n<p>Now you have to get the Runner class and its constructor in C++:</p>\n\n<pre><code>runnerClass = jniEnv-&gt;FindClass(\"org/ouzelengine/Runner\");\nrunnerClass = static_cast&lt;jclass&gt;(jniEnv-&gt;NewGlobalRef(runnerClass));\nrunnerConstructor = jniEnv-&gt;GetMethodID(runnerClass, \"&lt;init&gt;\", \"()V\");\n</code></pre>\n\n<p>Store the runnerClass (jclass) and runnerConstructor (jmethodID) somewhere for later use. The final thing you have to do is actually create the instance of the Runner class and post it to the handler:</p>\n\n<pre><code>jobject runner = jniEnv-&gt;NewObject(runnerClass, runnerConstructor);\n\nif (!jniEnv-&gt;CallBooleanMethod(handler, postMethod, runner))\n{\n    // something wrong happened\n}\n</code></pre>\n\n<p>What I do in the <a href=\"https://github.com/elnormous/ouzel/blob/master/ouzel/core/android/ApplicationAndroid.cpp\" rel=\"nofollow noreferrer\">Ouzel engines</a> code is I create a queue of std::function's and guard it with a mutex. Whenever I need to execute a std::function on Android UI thread, I add the std::function instance to the queue and pop it from the queue and execute it in the native method (Java_my_package_Runner_run).</p>\n\n<p>This is the closest you can get to writing no Java code (you will have to write 6 lines of it to implement the Runnable interface).</p>\n"}, {"comments": [{"owner": {"reputation": 1645, "user_id": 4869914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/94e94ff39b0e876b5edd59dd8ee58c48?s=128&d=identicon&r=PG&f=1", "display_name": "keyboard", "link": "https://stackoverflow.com/users/4869914/keyboard"}, "edited": false, "score": 0, "creation_date": 1498682684, "post_id": 44812074, "comment_id": 76605048, "body": "That looks very cool, thank you! With main thread you mean the Java-Main-Thread, right? You are now exchanging strings only? Do I miss something? In the text you said one could execute arbitrary code."}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "reply_to_user": {"reputation": 1645, "user_id": 4869914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/94e94ff39b0e876b5edd59dd8ee58c48?s=128&d=identicon&r=PG&f=1", "display_name": "keyboard", "link": "https://stackoverflow.com/users/4869914/keyboard"}, "edited": false, "score": 0, "creation_date": 1498683301, "post_id": 44812074, "comment_id": 76605360, "body": "@keyboard Yes I meant java main thread (actually main thread is the same for both java and native code). You may call registration function from <code>Activity.onCreate()</code> e.g. This example doesn&#39;t exchanges anything :-). It just sends numbers <code>100...109</code> from worker thread to main (UI) one. They may be threated as message IDs. If you need - you can send some serialized objects. The only thing is to design serialization-write-read-deserialization flow."}, {"owner": {"reputation": 12134, "user_id": 100724, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/28c55fab931fa7153f0625a09b441674?s=128&d=identicon&r=PG", "display_name": "Viktor Sehr", "link": "https://stackoverflow.com/users/100724/viktor-sehr"}, "edited": false, "score": 0, "creation_date": 1545740684, "post_id": 44812074, "comment_id": 94686515, "body": "If I understand this correctly, I call someJniFuncThatYouShouldCallOnceOnMainThread() as the first thing I do in android_main(). Then, whenever I send a message via write, the looperCallback get&#39;s executed on the same thread as the java ui thread. In other words, JNI code which is supposed to be executed on the java ui thread, can be executed in the looperCallback ?"}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "reply_to_user": {"reputation": 12134, "user_id": 100724, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/28c55fab931fa7153f0625a09b441674?s=128&d=identicon&r=PG", "display_name": "Viktor Sehr", "link": "https://stackoverflow.com/users/100724/viktor-sehr"}, "edited": false, "score": 0, "creation_date": 1545766379, "post_id": 44812074, "comment_id": 94691768, "body": "@Viktor Sehr yes, it is essentially what this snippet allows you to do. Strictly saying UI or main thread is the same thing for both native code and Java. At some point it is executing native machine code, at some other - Java bytecode. But nevertheless it is the same thread from kernel&#39;s perspective."}, {"owner": {"reputation": 12134, "user_id": 100724, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/28c55fab931fa7153f0625a09b441674?s=128&d=identicon&r=PG", "display_name": "Viktor Sehr", "link": "https://stackoverflow.com/users/100724/viktor-sehr"}, "edited": false, "score": 0, "creation_date": 1545867174, "post_id": 44812074, "comment_id": 94716442, "body": "@Sergio Hmm so if I understand this correctly, I could as well execute main-thread related stuff in my while(true){...} loop located inside android_main()? Meanwhile, the android_app-&gt;onAppCmd etc callbacks are executed on other threads? (I do have some jni-exception which seem to be related to not running jni commands on the java main thread)"}, {"owner": {"reputation": 6490, "user_id": 1777471, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/WhuDg.jpg?s=128&g=1", "display_name": "JRowan", "link": "https://stackoverflow.com/users/1777471/jrowan"}, "edited": false, "score": 0, "creation_date": 1577387882, "post_id": 44812074, "comment_id": 105159350, "body": "I am trying to do this in C and I am getting undefined reference to &#39;ALooper_forThread&#39; I don&#39;t know if it is getting android/looper.h"}], "tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": true, "score": 14, "last_activity_date": 1498682361, "last_edit_date": 1498682361, "creation_date": 1498682051, "answer_id": 44812074, "question_id": 44808206, "link": "https://stackoverflow.com/questions/44808206/android-jni-call-function-on-android-ui-thread-from-c/44812074#44812074", "title": "Android JNI - Call function on Android UI thread from C++", "body": "<p>As @Elviss has mentioned - to post your code to main thread you should use <code>Looper</code>. Actually this may be done without extra coping with JNI and creating of custom <code>java.lang.Runnable</code> and posting it via complicated JNI stuff.</p>\n\n<p>Android NDK offers extremely lightweight and efficient way to post your native code to the arbitrary looper. The key point is that you should provide arbitrary file descriptor to the looper and specify what file events you are interested in (input, output, so on). Under the hood looper will poll that file descriptor and once event becomes available - it runs your callback on proper thread. </p>\n\n<p>There is the minimal example (no error checks and teardowns):</p>\n\n<pre><code>#include &lt;android/looper.h&gt;\n#include &lt;unistd.h&gt;\n\n#define LOGI(...) __android_log_print(ANDROID_LOG_INFO, \"sergik\", __VA_ARGS__)\n\nstatic ALooper* mainThreadLooper;\nstatic int messagePipe[2];\n\nstatic int looperCallback(int fd, int events, void* data);\n\nvoid someJniFuncThatYouShouldCallOnceOnMainThread() {\n    mainThreadLooper = ALooper_forThread(); // get looper for this thread\n    ALooper_acquire(mainThreadLooper); // add reference to keep object alive\n    pipe(messagePipe); //create send-receive pipe\n    // listen for pipe read end, if there is something to read\n    // - notify via provided callback on main thread\n    ALooper_addFd(mainThreadLooper, messagePipe[0],\n                  0, ALOOPER_EVENT_INPUT, looperCallback, nullptr);\n    LOGI(\"fd is registered\");    \n\n    // send few messages from arbitrary thread\n    std::thread worker([]() {\n        for(char msg = 100; msg &lt; 110; msg++) {\n            LOGI(\"send message #%d\", msg);\n            write(messagePipe[1], &amp;msg, 1);\n            sleep(1);\n        }\n    });\n    worker.detach();\n}\n\n// this will be called on main thread\nstatic int looperCallback(int fd, int events, void* data) {\n    char msg;\n    read(fd, &amp;msg, 1); // read message from pipe\n    LOGI(\"got message #%d\", msg);\n    return 1; // continue listening for events\n}\n</code></pre>\n\n<p>This code produces next output:</p>\n\n<pre><code>06-28 23:28:27.076 30930-30930/? I/sergik: fd is registered\n06-28 23:28:27.076 30930-30945/? I/sergik: send message #100\n06-28 23:28:27.089 30930-30930/? I/sergik: got message #100\n06-28 23:28:28.077 30930-30945/? I/sergik: send message #101\n06-28 23:28:28.077 30930-30930/? I/sergik: got message #101\n06-28 23:28:29.077 30930-30945/? I/sergik: send message #102\n06-28 23:28:29.078 30930-30930/? I/sergik: got message #102\n06-28 23:28:30.078 30930-30945/? I/sergik: send message #103\n06-28 23:28:30.078 30930-30930/? I/sergik: got message #103\n06-28 23:28:31.079 30930-30945/? I/sergik: send message #104\n06-28 23:28:31.079 30930-30930/? I/sergik: got message #104\n06-28 23:28:32.079 30930-30945/? I/sergik: send message #105\n06-28 23:28:32.080 30930-30930/? I/sergik: got message #105\n06-28 23:28:33.080 30930-30945/? I/sergik: send message #106\n06-28 23:28:33.080 30930-30930/? I/sergik: got message #106\n06-28 23:28:34.081 30930-30945/? I/sergik: send message #107\n06-28 23:28:34.081 30930-30930/? I/sergik: got message #107\n06-28 23:28:35.081 30930-30945/? I/sergik: send message #108\n06-28 23:28:35.082 30930-30930/? I/sergik: got message #108\n06-28 23:28:36.082 30930-30945/? I/sergik: send message #109\n06-28 23:28:36.083 30930-30930/? I/sergik: got message #109\n</code></pre>\n\n<p>As you see from pid-tid pairs - messages are received on main thread. And of course you may send something more complicated than one-byte messages.</p>\n"}, {"comments": [{"owner": {"reputation": 1599, "user_id": 5548098, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b269d67e99a61f7bc9fa580b924ea2a?s=128&d=identicon&r=PG&f=1", "display_name": "ackh", "link": "https://stackoverflow.com/users/5548098/ackh"}, "edited": false, "score": 0, "creation_date": 1581687083, "post_id": 56815497, "comment_id": 106529850, "body": "Very nice, thanks for posting that code! I have made some adjustments in the <code>_looperCallback</code>. First, I determine the buffer size only once: <code>std::size_t size = sizeof(Callable*);</code>. Instead of allocating a buffer on the heap I just use stack memory: <code>char buffer[size];</code> <code>read(fd, static_cast&lt;void*&gt;(buffer), size);</code>. There&#39;s only an address that is exchanged so stack memory should be fine. Then I replaced the C-style cast: <code>Callable* callable = *(reinterpret_cast&lt;Callable**&gt;(buffer));</code>."}, {"owner": {"reputation": 1599, "user_id": 5548098, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b269d67e99a61f7bc9fa580b924ea2a?s=128&d=identicon&r=PG&f=1", "display_name": "ackh", "link": "https://stackoverflow.com/users/5548098/ackh"}, "edited": false, "score": 0, "creation_date": 1581689561, "post_id": 56815497, "comment_id": 106531267, "body": "Note also that there is a memory leak: Every call to <code>post</code> allocates memory on the heap that is never freed again. To fix this, add <code>delete callable;</code> at the end of <code>_looperCallback</code>."}], "tags": [], "owner": {"reputation": 9874, "user_id": 4326936, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/71a107e53f14a27c4e83fb0adae2552c?s=128&d=identicon&r=PG&f=1", "display_name": "alijandro", "link": "https://stackoverflow.com/users/4326936/alijandro"}, "is_accepted": false, "score": 1, "last_activity_date": 1572239689, "last_edit_date": 1572239689, "creation_date": 1561789130, "answer_id": 56815497, "question_id": 44808206, "link": "https://stackoverflow.com/questions/44808206/android-jni-call-function-on-android-ui-thread-from-c/56815497#56815497", "title": "Android JNI - Call function on Android UI thread from C++", "body": "<p>Based on @Sergio's answer, here is a simple wrapper <code>NativeHandler</code> which can take function, function object and lambda as argument, try to mimic the behavior of <code>android.os.Handler</code></p>\n\n<pre><code>class NativeHandler {\npublic:\n    static constexpr auto TAG = \"NativeHandler\";\n    static NativeHandler* forCurrentThread() {\n        return new NativeHandler;\n    }\n\n    template&lt;typename FUNC, typename... ARGS&gt;\n    bool post(FUNC&amp;&amp; func, ARGS&amp;&amp;... args) {\n        auto callable = new Callable(func, std::forward&lt;ARGS&gt;(args)...);\n        write(_pipeFDS[1], &amp;callable, sizeof(decltype(callable)));\n        return true;\n    }\n\n    NativeHandler(const NativeHandler&amp;) = delete;\n    NativeHandler(NativeHandler&amp;&amp;) = delete;\n    NativeHandler&amp; operator=(const NativeHandler&amp;) = delete;\n    NativeHandler&amp; operator=(NativeHandler&amp;&amp;) = delete;\n    virtual ~NativeHandler() {\n        ALooper_removeFd(_looper, _pipeFDS[0]);\n        ALooper_release(_looper);\n        close(_pipeFDS[0]);\n        close(_pipeFDS[1]);\n    }\n\nprivate:\n    class Callable {\n    public:\n        void call() {\n            if (_function) _function();\n        }\n\n        template&lt;typename FUNC, typename... ARGS&gt;\n        Callable(FUNC func, ARGS... args) : _function(std::bind(func, args...)) {}\n\n        Callable() = delete;\n        Callable(const Callable&amp;) = delete;\n        Callable(Callable&amp;&amp;) = delete;\n        Callable operator=(const Callable&amp;) = delete;\n        Callable operator=(Callable&amp;&amp;) = delete;\n        virtual ~Callable() {}\n    private:\n        std::function&lt;void()&gt; _function;\n    };\n\n    NativeHandler() {\n        if (pipe(_pipeFDS) != 0) {\n            throw std::bad_alloc();\n        }\n        _looper = ALooper_forThread();\n        ALooper_acquire(_looper);\n        if (ALooper_addFd(_looper, _pipeFDS[0], ALOOPER_POLL_CALLBACK,\n                          ALOOPER_EVENT_INPUT, _looperCallback, nullptr) == -1) {\n            throw std::bad_alloc();\n        }\n    };\n\n    ALooper* _looper;\n    int _pipeFDS[2];\n    static int _looperCallback(int fd, int events, void* data) {\n        void* buf = new char[sizeof(Callable*)];\n        ssize_t nr = read(fd, buf, sizeof(Callable*));\n        Callable* callable = *((Callable**)buf);\n        __android_log_print(ANDROID_LOG_INFO, \"Callable\", \"read size is %d %p\", nr, callable);\n        callable-&gt;call();\n        delete[] buf;\n        return 1;\n    }\n};\n</code></pre>\n\n<p>And then the use example, hope it might be helpful for anyone who want similar behavior with android java api handler in JNI.</p>\n\n<pre><code>void f(char c, short s) {\n    __android_log_print(ANDROID_LOG_DEBUG, NativeHandler::TAG, \"%s c = %c, s = %d\", __FUNCTION__, c, s);\n}\n\nstruct Task {\n    void operator()(int i, double d) {\n        __android_log_print(ANDROID_LOG_DEBUG, NativeHandler::TAG, \"Task i = %d, d = %f\", i, d);\n    }\n};\n\n// ...\nauto handler = NativeHandler::forCurrentThread();\nstd::thread worker([handler]() {\n    handler-&gt;post([](int i, double d, void* p) {\n        __android_log_print(ANDROID_LOG_DEBUG, \"NativeHandler\", \"i = %d, d = %f, p = %p\", i, d, p);\n    }, 100, -123.4, nullptr);\n\n    handler-&gt;post(f, 'c', 128);\n    handler-&gt;post(Task(), 123, 3.1415926);\n});\nworker.detach();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 7318670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5763bc93c7eaba52368506a303566387?s=128&d=identicon&r=PG", "display_name": "Ryan Tremblay", "link": "https://stackoverflow.com/users/7318670/ryan-tremblay"}, "is_accepted": false, "score": 1, "last_activity_date": 1586217520, "last_edit_date": 1586217520, "creation_date": 1586208891, "answer_id": 61069332, "question_id": 44808206, "link": "https://stackoverflow.com/questions/44808206/android-jni-call-function-on-android-ui-thread-from-c/61069332#61069332", "title": "Android JNI - Call function on Android UI thread from C++", "body": "<p>Another option is to use the <a href=\"https://github.com/microsoft/arcana.cpp\" rel=\"nofollow noreferrer\">Arcana.cpp</a> C++ library, which includes an Android Looper based \"scheduler.\" In its simplest form, you can use it like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;arcana/threading/task_schedulers.h&gt;\n\nvoid SomeFunctionCalledFromUIThread()\n{\n  // Note: The '64' below is the max size of the callables passed to the scheduler.\n  // This is done to reduce allocations and make schedulers more efficient.\n  auto looper_scheduler = arcana::looper_scheduler&lt;64&gt;::get_for_current_thread();\n\n  // Get on a background thread to test getting back on the UI thread.\n  std::thread worker([looper_scheduler = std::move(looper_scheduler)]() {\n    looper_scheduler([]() {\n      // Do something on the UI (looper) thread\n    });\n  });\n}\n</code></pre>\n\n<p>Schedulers are a general construct in Arcana.cpp, and are also used in the low overhead cross platform async task system, so if you opt to use that then you can do typical async task programming with this scheduler:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;arcana/threading/task_schedulers.h&gt;\n#include &lt;arcana/threading/task.h&gt;\n#include &lt;arcana/threading/dispatcher.h&gt;\n\n// Schedulers need to outlive task chains, so imagine m_looper_scheduler and m_background_dispatcher are created and stored from some constructor.\n// \"Dispatchers\" in Arcana.cpp are a class of schedulers that own their own work queue.\n\narcana::task&lt;void, std::exception_ptr&gt; SomeFunctionCalledFromUIThread() {\n  return arcana::make_task(m_background_dispatcher, arcana::cancellation::none(), []() {\n    // Do something on a background thread (via background_dispatcher).\n  }).then(m_looper_scheduler, arcana::cancellation::none(), []() {\n    // Do something on the UI thread (via looper_scheduler).\n  });\n}\n</code></pre>\n\n<p>If you want to get more adventurous, C++ coroutines can be used with tasks, or directly with schedulers:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;arcana/threading/task_schedulers.h&gt;\n#include &lt;arcana/threading/task.h&gt;\n#include &lt;arcana/threading/dispatcher.h&gt;\n#include &lt;arcana/threading/coroutine.h&gt;\n\narcana::task&lt;void, std::exception_ptr&gt; SomeFunctionCalledFromUIThread() { \n  auto looper_scheduler = arcana::looper_scheduler&lt;64&gt;::get_for_current_thread();\n  arcana::background_dispatcher&lt;64&gt; background_dispatcher;\n\n  // Code executing here is on the UI thread (since the function is called from the UI thread).\n\n  co_await arcana::switch_to(background_dispatcher);\n\n  // Code executing here is on a background thread.\n\n  co_await arcana::switch_to(looper_scheduler);\n\n  // Code executing here is back on the UI thread.\n}\n</code></pre>\n\n<p>You can read more about Arcana.cpp schedulers, tasks, and coroutines here: <a href=\"https://github.com/microsoft/arcana.cpp/blob/master/Source/Arcana.Tasks.md\" rel=\"nofollow noreferrer\">https://github.com/microsoft/arcana.cpp/blob/master/Source/Arcana.Tasks.md</a> </p>\n"}], "owner": {"reputation": 1645, "user_id": 4869914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/94e94ff39b0e876b5edd59dd8ee58c48?s=128&d=identicon&r=PG&f=1", "display_name": "keyboard", "link": "https://stackoverflow.com/users/4869914/keyboard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5733, "favorite_count": 8, "accepted_answer_id": 44812074, "answer_count": 4, "score": 10, "last_activity_date": 1586217520, "creation_date": 1498667925, "last_edit_date": 1559198565, "question_id": 44808206, "link": "https://stackoverflow.com/questions/44808206/android-jni-call-function-on-android-ui-thread-from-c", "title": "Android JNI - Call function on Android UI thread from C++", "body": "<p>Our game engine <code>Cocos2d-x</code> runs natively on android on its own <code>non-Java-UI-thread</code>. We need to call certain Java functions from <code>C++</code> via <code>JNI</code> on the <code>Android UI thread</code>.</p>\n\n<p>For calling <code>JNI-Functions</code>, we're using the JNIHelper.h/cpp from here (GitHub):\n<a href=\"https://github.com/cocos2d/cocos2d-x/blob/v3/cocos/platform/android/jni/JniHelper.h\" rel=\"nofollow noreferrer\">JniHelper.h</a>, <a href=\"https://github.com/cocos2d/cocos2d-x/blob/v3/cocos/platform/android/jni/JniHelper.cpp\" rel=\"nofollow noreferrer\">JniHelper.cpp</a></p>\n\n<p>For example this C++ code:</p>\n\n<pre><code>auto retVal = JniHelper::callStaticStringMethod(\"org/utils/Facebook\",\n                         \"getFacebookTokenString\");\n</code></pre>\n\n<p>Ideally, we'd like to have all these calls happen on the <code>Android UI thread</code> and pass an <code>std::function</code> as a parameter which is called with the return value on the <code>Cocos2d-x-thread</code> again once the function call is done.</p>\n\n<p>Ideal way to call the function:</p>\n\n<pre><code>auto retVal = JniHelper::callStaticStringMethod(\"org/utils/Facebook\",\n  \"getFacebookTokenString\", [=](std::string retVal) {\n printf(\"This is the retval on the C++ caller thread again: %s\", retVal.c_str());\n});\n</code></pre>\n\n<p>But there are also many calls without any return value, so for those it should be easier to just call them on the java thread.</p>\n"}, {"tags": ["c++", "visual-c++-2013", "unnamed-namespace", "unnamed-class"], "comments": [{"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1498667208, "post_id": 44807721, "comment_id": 76596023, "body": "Note that one important difference of your new approach is that you have only one global instance of the functor, while the first approach creates temporaries. (Sorry if you already knew this. It is important when the functor has a state.)"}, {"owner": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 1, "creation_date": 1498668014, "post_id": 44807721, "comment_id": 76596525, "body": "An unnamed namespace should not be used in an header file as symbol are defined per compilation unit."}, {"owner": {"reputation": 649, "user_id": 2509060, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef5a744b50a1349b51f025870fcaec46?s=128&d=identicon&r=PG", "display_name": "Christophe Fuzier", "link": "https://stackoverflow.com/users/2509060/christophe-fuzier"}, "reply_to_user": {"reputation": 2178, "user_id": 2208372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0f8d54e87a4835f7cf67694cad247f?s=128&d=identicon&r=PG", "display_name": "Phil1970", "link": "https://stackoverflow.com/users/2208372/phil1970"}, "edited": false, "score": 0, "creation_date": 1498668342, "post_id": 44807721, "comment_id": 76596742, "body": "@Phil1970 There are exceptions to this rule, c.f. Boost or STL placeholders like <code>_1</code>, <code>_2</code>, etc. Sometimes, having one symbol per compilation unit is what you want."}], "owner": {"reputation": 649, "user_id": 2509060, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef5a744b50a1349b51f025870fcaec46?s=128&d=identicon&r=PG", "display_name": "Christophe Fuzier", "link": "https://stackoverflow.com/users/2509060/christophe-fuzier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1498748170, "creation_date": 1498666360, "last_edit_date": 1498748170, "question_id": 44807721, "link": "https://stackoverflow.com/questions/44807721/instance-of-unnamed-class-in-unnamed-namespace", "title": "Instance of unnamed class in unnamed namespace", "body": "<p>Using functors with parameters generally looks like that:</p>\n\n<pre><code>// Definition:\nstruct some_functor_with_params\n{\n    int ref;\n    explicit some_functor_with_params(int ref) : ref(ref) {}\n    bool operator ()(int i) const {return i == ref;}\n};\n\n// Usage:\nstd::vector&lt;int&gt; v;\nstd::find_if(v.begin(), v.end(), some_functor_with_params(42));\n</code></pre>\n\n<p>For a functor without parameters, the code may become</p>\n\n<pre><code>// Definition:\nstruct some_functor_without_params\n{\n    bool operator ()(int i) const {return i == 42;}\n};\n\n// Usage:\nstd::vector&lt;int&gt; v;\nstd::find_if(v.begin(), v.end(), some_functor_without_params());\n</code></pre>\n\n<p>but I would prefer the following usage:</p>\n\n<pre><code>std::vector&lt;int&gt; v;\nstd::find_if(v.begin(), v.end(), some_functor_without_params); // no parens\n</code></pre>\n\n<p>which has the following advantages:</p>\n\n<ul>\n<li>more concise </li>\n<li>more readable when invoking the functor directly: <code>some_functor_without_params(i)</code> rather than <code>some_functor_without_params()(i)</code></li>\n<li>interchangeable with a function: <code>bool some_functor_with_params(int i) {return i == 42;}</code></li>\n</ul>\n\n<p>I implemented it the following way in a header file:</p>\n\n<pre><code>namespace {\n    struct\n    {\n        bool operator ()(int i) const {return i == 42;}\n    } some_functor_without_params;\n}\n</code></pre>\n\n<p>I think the struct does not need a name since it has no user-declared constructor (nor destructor, nor anything requiring the struct name). I put the object in an unnamed namespace so that each compilation unit has its own <code>some_functor_without_params</code> and there is no 'double definition' link error.</p>\n\n<p><strong>Is there any performance penalty or any other drawback I cannot see?</strong></p>\n\n<p>This approach worked as expected until I encountered a very strange compilation error with Visual C++ 2013 which disappeared when naming the functor type, i.e. replacing</p>\n\n<pre><code>struct\n{\n    bool operator ()(int i) const {return i == 42;}\n} some_functor_without_params;\n</code></pre>\n\n<p>with</p>\n\n<pre><code>struct some_functor_without_params_t\n{\n    bool operator ()(int i) const {return i == 42;}\n} some_functor_without_params;\n</code></pre>\n\n<p>The error occurs only in Debug, not in Release, and states</p>\n\n<pre><code>error C2039: '&lt;unnamed-type-some_functor_without_param&gt;': is not a member of 'my_namespace:: ?? A0xbf2cc73f'\n</code></pre>\n\n<p>in file <code>xstring</code>, here:</p>\n\n<pre><code>_Myt&amp; operator+=(const _Elem *_Ptr)\n    {   // append [_Ptr, &lt;null&gt;) // &lt;-- on this line(!)\n    return (append(_Ptr));\n    }\n</code></pre>\n\n<p><strong>It looks like a compiler bug, what do you think?</strong></p>\n"}, {"tags": ["c++", "c++11", "multidimensional-array", "c++14", "stl-algorithm"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 2, "creation_date": 1498666673, "post_id": 44807347, "comment_id": 76595700, "body": "What&#39;s your desired outcome? <code>21</code> or <code>{9, 12}</code>?"}, {"owner": {"reputation": 313, "user_id": 1487009, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/75e72edf3416f69d5da5569c8803adac?s=128&d=identicon&r=PG", "display_name": "Bart Vandewoestyne", "link": "https://stackoverflow.com/users/1487009/bart-vandewoestyne"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1498668375, "post_id": 44807347, "comment_id": 76596767, "body": "My desired outcome is 21."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1498669919, "post_id": 44807347, "comment_id": 76597686, "body": "I don&#39;t have the energy to work out the details, but you can write an iterator that knows how to walk through a 2-dimensional array. Basically, it would walk through one row of the array and when it hits the end of the row, move to the next row. That&#39;s a little trickier to write than Rakete111&#39;s nested calls to <code>std::accumulate</code>, but it is more general: you can use that iterator for <b>any</b> algorithm. (If someone wants to work out the details, feel free to post your code as an answer)"}], "answers": [{"tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": false, "score": 20, "last_activity_date": 1498848999, "last_edit_date": 1498848999, "creation_date": 1498665452, "answer_id": 44807446, "question_id": 44807347, "link": "https://stackoverflow.com/questions/44807347/using-stdaccumulate-on-a-two-dimensional-stdarray/44807446#44807446", "title": "Using std::accumulate on a two-dimensional std::array", "body": "<p>It's just a bit more complex. You have to nest 2 <code>std::accumulate</code> calls. The nested <code>std::accumulate</code> call sums the elements in the nested arrays, and then the first <code>std::accumulate</code> sums those up.</p>\n\n<pre><code>auto sum = std::accumulate(m.cbegin(), m.cend(), 0, [](auto lhs, const auto&amp; rhs) {\n    return std::accumulate(rhs.cbegin(), rhs.cend(), lhs);\n});\n</code></pre>\n\n<p>That's a C++14 solution because of the generic lambda, but for C++11, you just need to specify the types explicitly.</p>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 1487009, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/75e72edf3416f69d5da5569c8803adac?s=128&d=identicon&r=PG", "display_name": "Bart Vandewoestyne", "link": "https://stackoverflow.com/users/1487009/bart-vandewoestyne"}, "edited": false, "score": 0, "creation_date": 1498905595, "post_id": 44826103, "comment_id": 76699687, "body": "Nice, I&#39;m starting to like Ranges :-)  Unfortunately, we&#39;re currently still stuck with VS2012, so only a few C++11 features available :-("}], "tags": [], "owner": {"reputation": 924, "user_id": 4899740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96c5e1381891a68f8b805b5e29f860e?s=128&d=identicon&r=PG&f=1", "display_name": "Serikov", "link": "https://stackoverflow.com/users/4899740/serikov"}, "is_accepted": false, "score": 8, "last_activity_date": 1498743355, "last_edit_date": 1498743355, "creation_date": 1498741833, "answer_id": 44826103, "question_id": 44807347, "link": "https://stackoverflow.com/questions/44807347/using-stdaccumulate-on-a-two-dimensional-stdarray/44826103#44826103", "title": "Using std::accumulate on a two-dimensional std::array", "body": "<p>Conceptually you want to <em>flatten</em> array <code>m</code> and then apply accumulate to it.<br>\nUsing Range-v3 library (or Ranges TS in the future) you can do just that <a href=\"https://wandbox.org/permlink/p3zJxUNZgSeGBNPb\" rel=\"noreferrer\">(link to wandbox)</a>.</p>\n\n<pre><code>std::array&lt;std::array&lt;int, 2&gt;, 3&gt; m = {{ {1, 2}, {3, 4}, {5, 6} }};\n\nauto result = ranges::accumulate(ranges::join(m), 0); // flatten range then apply accumulate\n</code></pre>\n\n<p>That works like what Pete Becker mentioned in comment: \"walk through one row of the array and when it hits the end of the row, move to the next row\". No copy of subranges made.</p>\n"}], "owner": {"reputation": 313, "user_id": 1487009, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/75e72edf3416f69d5da5569c8803adac?s=128&d=identicon&r=PG", "display_name": "Bart Vandewoestyne", "link": "https://stackoverflow.com/users/1487009/bart-vandewoestyne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2296, "favorite_count": 2, "answer_count": 2, "score": 11, "last_activity_date": 1610805129, "creation_date": 1498665151, "last_edit_date": 1498668478, "question_id": 44807347, "link": "https://stackoverflow.com/questions/44807347/using-stdaccumulate-on-a-two-dimensional-stdarray", "title": "Using std::accumulate on a two-dimensional std::array", "body": "<p>Given the two-dimensional array</p>\n\n<pre><code>std::array&lt;std::array&lt;int, 2&gt;, 3&gt; m = {{ {1, 2}, {3, 4}, {5, 6} }};\n</code></pre>\n\n<p>I am looking for the sum of all its elements - in this case, 21. Had the array been one-dimensional, I could've written</p>\n\n<pre><code>auto sum = std::accumulate(m.begin(), m.end(), 0);\n</code></pre>\n\n<p>but for my two-dimensional array, this fails with the rather understandable error</p>\n\n<pre><code>no match for 'operator+' (operand types are 'int' and 'std::array&lt;int, 2ul&gt;')\n</code></pre>\n\n<p>How can I elegantly compute this sum for my 2D array (avoiding for-loops, preferring STL-algorithms)?</p>\n\n<p>Can it be done with a one-liner like for the one-dimensional case, or does it become more complex?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 1, "creation_date": 1498665203, "post_id": 44807313, "comment_id": 76594681, "body": "these C-styled variadic functions are highly error prone. Have a look at C++11&#39;s variadic templates. Still, you should use iterators."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1498665212, "post_id": 44807313, "comment_id": 76594690, "body": "You have to runtime dispatch until a given size..."}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 2, "creation_date": 1498665239, "post_id": 44807313, "comment_id": 76594712, "body": "Why not <code>template &lt;typename InputIt&gt; foo(InputIt first, InputIt last)</code>?"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498665314, "post_id": 44807313, "comment_id": 76594774, "body": "What&#39;s not really clear is whether the number of arguments being passed is known at compile time(array) or runtime (vector). Maybe if you could be specific about whether the parameters will be given via a <code>std::array</code> or a <code>std::vector</code> we could help?"}, {"owner": {"reputation": 143, "user_id": 8049204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a627f3100ccf1b30caa48365de0ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Covvar", "link": "https://stackoverflow.com/users/8049204/covvar"}, "reply_to_user": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "edited": false, "score": 0, "creation_date": 1498665366, "post_id": 44807313, "comment_id": 76594816, "body": "@iehrlich, I actually came across this, but the same question is applied here. How would you call the <code>foo()</code> you have defined?"}, {"owner": {"reputation": 143, "user_id": 8049204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a627f3100ccf1b30caa48365de0ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Covvar", "link": "https://stackoverflow.com/users/8049204/covvar"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 1, "creation_date": 1498665427, "post_id": 44807313, "comment_id": 76594856, "body": "Actually, it could be pretty much straight forward using an <code>std::array</code> or an <code>std::vector</code> instead (as @NirFriedman stated)"}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498665935, "post_id": 44807313, "comment_id": 76595240, "body": "@Covvar Did you define <code>foo</code>, or is it not under your control? And to be clear, you are talking C style variadic, right?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498665975, "post_id": 44807313, "comment_id": 76595265, "body": "can you please clarify the question? If you dont really need the function to be variadic, but you simply need to pass a variable number of parameters, then the given answer is a perfect fit, but whats the point of the variadic function in the first place?"}], "answers": [{"comments": [{"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498665857, "post_id": 44807510, "comment_id": 76595197, "body": "You don&#39;t really need to make a copy of begin at all, the more idiomatic approach is to simply increment <code>begin</code> directly (note that it was passed by value so you already have your own copy)."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498665879, "post_id": 44807510, "comment_id": 76595211, "body": "imho this is a solution, but strictly speaking it doesnt answer the question, but instead silently assumes that passing the parameters to a variadic function isnt an option at all"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1498665923, "post_id": 44807510, "comment_id": 76595233, "body": "<code>foo(std::begin(myVector), std::end(myVector));</code> would allow <code>myVector</code> to be, for instance, a <code>int[]</code>."}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498666077, "post_id": 44807510, "comment_id": 76595324, "body": "@NirFriedman true. However, I somehow dislike <code>while (++begin != end)</code> constructs. My personal approach is to start with more straightforward (but maybe less effective) code, and optimize it as needed."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 1, "creation_date": 1498666158, "post_id": 44807510, "comment_id": 76595369, "body": "@iehrlich I didn&#39;t say anything about a while loop, you just leave the first clause blank. <code>for (; begin != end; ++begin)</code>. This is perfectly idiomatic when loop variable is already initialized. See &quot;Possible Implementation&quot; <a href=\"http://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/algorithm/find</a>."}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 1, "creation_date": 1498666207, "post_id": 44807510, "comment_id": 76595396, "body": "@NirFriedman I see, thanks :)"}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1498666407, "post_id": 44807510, "comment_id": 76595526, "body": "@YSC thanks for the note, added it to the answer!"}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498666541, "post_id": 44807510, "comment_id": 76595609, "body": "@tobi303 I was particularly answering the <i>&quot;I want to be able to call it dynamically. That is, the parameters will be given to me through some simple data structure like an array/vector&quot;</i> part of the question. Honestly, that&#39;s how variadic functions are internally implemented in languages like Lua or python :)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498667312, "post_id": 44807510, "comment_id": 76596089, "body": "yeah I think you answered the real question, while the question about variadic fucntions was a xy-problem. I was just thinking that someone might need to call a variadic function (because the function itself cannot be changed) then they wont find the answer here. Dont get me wrong, imho your answer is fine but the question should be made more clear. As it stands now it isnt obvious whether the variadic function is really the problem or part of a mislead solution"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1498721400, "post_id": 44807510, "comment_id": 76617763, "body": "@NirFriedman You&#39;re making the compiler&#39;s job by doing this kind of optimization, and you trade a few keystrokes against a slightly unusual for-loop which may bring amazement. And you don&#39;t want to draw the reader&#39;s attention on an unimportant bit of code."}], "tags": [], "owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "is_accepted": true, "score": 4, "last_activity_date": 1498666384, "last_edit_date": 1498666384, "creation_date": 1498665647, "answer_id": 44807510, "question_id": 44807313, "link": "https://stackoverflow.com/questions/44807313/how-to-pass-parameters-to-a-variadic-function-dynamically/44807510#44807510", "title": "How to pass parameters to a variadic function, dynamically?", "body": "<p><em>NOTE: Based on the OP's comment, I think that using iterators over source collections is a viable option here.</em></p>\n\n<p>Consider using the same trick as is commonly used in standard library, for example <a href=\"http://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>template&lt;typename InputIt&gt;\nvoid foo(InputIt begin, InputIt end)\n{\n    for (InputIt it = begin; it != end; ++it)\n    {\n        // do whatever you need with (*it);\n    }\n}\n</code></pre>\n\n<p>and then call it like this:</p>\n\n<pre><code>std::vector&lt;int&gt; myVector(1, 2, 3);\nfoo(myVector.begin(), myVector.end());\n</code></pre>\n\n<p>or, as per <a href=\"https://stackoverflow.com/users/5470596/ysc\">@YSC</a>,</p>\n\n<pre><code>std::vector&lt;int&gt; myVector(1, 2, 3);\nfoo(std::begin(vector), std::end(vector));\n</code></pre>\n\n<p>There are a couple of things to keep in mind. If you want to use this approach, your code needs to meet the following requirement: any logic you place in <code>foo</code> should be applicable to the value_type of the source collection. For example, if you explicitly convert <code>(*it)</code> to integer inside <code>foo</code>, while there's no such conversion for the <code>value_type</code> of the source vector, the compilation will fail.</p>\n\n<p>However, this approach comes with some benefits. You can use this implementation with either <code>std::vector&lt;T&gt;</code> or <code>std::array&lt;T&gt;</code> right away. If you want to also use it with associative structures like std::unordered_map, it'll be a little more tricky, but the idea is the same.</p>\n"}], "owner": {"reputation": 143, "user_id": 8049204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a627f3100ccf1b30caa48365de0ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Covvar", "link": "https://stackoverflow.com/users/8049204/covvar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "closed_date": 1498779766, "accepted_answer_id": 44807510, "answer_count": 1, "score": -1, "last_activity_date": 1498667676, "creation_date": 1498665064, "last_edit_date": 1498667676, "question_id": 44807313, "link": "https://stackoverflow.com/questions/44807313/how-to-pass-parameters-to-a-variadic-function-dynamically", "closed_reason": "Needs details or clarity", "title": "How to pass parameters to a variadic function, dynamically?", "body": "<p>Consider some variadic function <code>foo(int...args)</code>.</p>\n\n<p>I want to be able to call it dynamically. That is, the parameters will be given to me through some simple data structure like an array/vector etc (doesn't really matter).</p>\n\n<p>How can I pass them to call <code>foo()</code>? </p>\n"}, {"tags": ["c++", "zbar"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1498665734, "post_id": 44807262, "comment_id": 76595105, "body": "what happens when you step through with a debugger"}, {"owner": {"reputation": 31, "user_id": 8227100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b948147cfe5039f78d7d35795bbf1c97?s=128&d=identicon&r=PG&f=1", "display_name": "A23Random", "link": "https://stackoverflow.com/users/8227100/a23random"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1498665985, "post_id": 44807262, "comment_id": 76595270, "body": "Mmmh... ok, it looks like the problem was not executed at all. Using a debugger, I get the dialog &quot;Executable Failed&quot; with message &quot;During startup program exited with code 0xc0000135. What does it mean?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1498666289, "post_id": 44807262, "comment_id": 76595452, "body": "0xC0000135 STATUS_DLL_NOT_FOUND"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1498666823, "post_id": 44807262, "comment_id": 76595775, "body": "if you are genuinely stuck (seems like you should ensure that the dll is in yr path) run yr app with procmon (sysinternals) runnin. You will be able to see where its looking. Also try depends <a href=\"http://www.dependencywalker.com/\" rel=\"nofollow noreferrer\">dependencywalker.com</a>"}], "owner": {"reputation": 31, "user_id": 8227100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b948147cfe5039f78d7d35795bbf1c97?s=128&d=identicon&r=PG&f=1", "display_name": "A23Random", "link": "https://stackoverflow.com/users/8227100/a23random"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498665158, "creation_date": 1498664922, "last_edit_date": 1498665158, "question_id": 44807262, "link": "https://stackoverflow.com/questions/44807262/program-not-executing-after-instanciating-a-class-from-imported-library", "title": "Program not executing after instanciating a class from imported library", "body": "<p>I'm trying to use the library ZBar to read QRCode with c++. I am not an expert about this language. I have the following problem:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;zbar.h&gt;\n\nusing namespace std;\nusing namespace zbar;\n\nint main()\n{\n    cout &lt;&lt; \"Hello World!\" &lt;&lt; endl;\n    //Image image;\n    return 0;\n}\n</code></pre>\n\n<p>This code does actually print the \"Hello World\" as expected. But if I remove the comment, obtaining the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;zbar.h&gt;\n\nusing namespace std;\nusing namespace zbar;\n\nint main()\n{\n    cout &lt;&lt; \"Hello World!\" &lt;&lt; endl;\n    Image image;\n    return 0;\n}\n</code></pre>\n\n<p>Everything is still compiled correctly, with no errors or warnings, but I don't obtain any output!! The program reaches the end without executing any instruction!\nI just used this code to semplify, but the problem actually is that, as soon as I add an instruction using classes from zbar, it seems like I am \"clearing\" the main! How is it possible? What should I do? Thank you!</p>\n"}, {"tags": ["c++", "winapi", "asynchronous", "readfile"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498664775, "post_id": 44807075, "comment_id": 76594325, "body": "It would help if you explicitly explained the error mode in the question text."}, {"owner": {"reputation": 27592, "user_id": 1031591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s3MiH.jpg?s=128&g=1", "display_name": "atlaste", "link": "https://stackoverflow.com/users/1031591/atlaste"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498664846, "post_id": 44807075, "comment_id": 76594387, "body": "You&#39;re right, I should have (and will make the change). In the code it sais: <code>The call always ends up here with error 87: Invalid parameter</code>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 3, "creation_date": 1498665276, "post_id": 44807075, "comment_id": 76594741, "body": "<i>The file handle must be created with the GENERIC_READ right, and the FILE_FLAG_OVERLAPPED and FILE_FLAG_NO_BUFFERING flags.</i> - where is <code>FILE_FLAG_OVERLAPPED</code> in your code ?"}, {"owner": {"reputation": 27592, "user_id": 1031591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s3MiH.jpg?s=128&g=1", "display_name": "atlaste", "link": "https://stackoverflow.com/users/1031591/atlaste"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1498665369, "post_id": 44807075, "comment_id": 76594819, "body": "@RbMm Pfff... I cannot believe I&#39;ve been staring over that all day. Damn... Thanks, that&#39;s actually the solution!"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1498665581, "post_id": 44807075, "comment_id": 76594982, "body": "and why not simply <code>FILE_SEGMENT_ELEMENT element[3];</code> and <code>ReadFileScatter(fileHandle, RTL_NUMBER_OF(elements)</code> ? for what std::vector here ? and are <code>elements.data() == element1</code> ?"}, {"owner": {"reputation": 27592, "user_id": 1031591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s3MiH.jpg?s=128&g=1", "display_name": "atlaste", "link": "https://stackoverflow.com/users/1031591/atlaste"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1498665934, "post_id": 44807075, "comment_id": 76595238, "body": "@RbMm I intend to use this in an IO scheduler, which is way more complex than this toy piece of code. There, I could use a ` FILE_SEGMENT_ELEMENT *<code>, but that would mean cleanup is still nasty (if an exception throws...). Using a </code>vector` takes care of that problem, because the destructor will free the memory. <code>elements.data()</code> simply returns the address of the first element - which isn&#39;t <code>&amp;element1</code>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1498668302, "post_id": 44807075, "comment_id": 76596711, "body": "and for what you allocate <code>pageSize * 3</code> when you try read only <code>pageSize * 2</code> ? you need allocate exactly <code>nNumberOfBytesToRead</code> - so <code>pageSize * 2</code>. and <code>element2.Buffer = buffer + pageSize * 1</code>; may be ?"}, {"owner": {"reputation": 27592, "user_id": 1031591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s3MiH.jpg?s=128&g=1", "display_name": "atlaste", "link": "https://stackoverflow.com/users/1031591/atlaste"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1498669699, "post_id": 44807075, "comment_id": 76597536, "body": "@RbMm Again, I do that to mimick the behavior of the application. In reality, I allocate big chunks of memory, and have a memory manager that distributes and reuses pages. In this case, it&#39;s a simple test to see if scatter works as intended in a situation that mimicks the real behavior. Simply having a (unused) block in the middle does just that."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1498670071, "post_id": 44807075, "comment_id": 76597776, "body": "ok, understand. however i be allocate <code>FILE_SEGMENT_ELEMENT</code> in heap (not in stack) and store pointer to it in structure which encapsulated  <code>OVERLAPPED</code>, call <code>BindIoCompletionCallback</code> on <code>fileHandle</code> and not just wait after read, but do all work (and free <code>FILE_SEGMENT_ELEMENT</code> in <code>FileIOCompletionRoutine</code>"}], "owner": {"reputation": 27592, "user_id": 1031591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s3MiH.jpg?s=128&g=1", "display_name": "atlaste", "link": "https://stackoverflow.com/users/1031591/atlaste"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1498664892, "creation_date": 1498664416, "last_edit_date": 1498664892, "question_id": 44807075, "link": "https://stackoverflow.com/questions/44807075/how-to-use-readfilescatter", "title": "How to use ReadFileScatter", "body": "<p>I've been attempting to use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365469(v=vs.85).aspx\" rel=\"nofollow noreferrer\">ReadFileScatter</a> today in my code (which sounds like exactly what I need), so far without a lot of luck. Google'ing the internet for what goes wrong doesn't give me much insight.</p>\n\n<p>The documentation states:</p>\n\n<blockquote>\n  <p>The array must contain enough elements to store nNumberOfBytesToRead bytes of data, plus one element for the terminating NULL. For example, if there are 40 KB to be read and the page size is 4 KB, the array must have 11 elements that includes 10 for the data and one for the NULL.</p>\n  \n  <p>Each buffer must be at least the size of a system memory page and must be aligned on a system memory page size boundary. The system reads one system memory page of data into each buffer.</p>\n  \n  <p>The function stores the data in the buffers in sequential order. For example, it stores data into the first buffer, then into the second buffer, and so on until each buffer is filled and all the data is stored, or there are no more buffers.</p>\n</blockquote>\n\n<p>So far I've been attempting to do just that. I allocated a bunch of bytes using <code>VirtualAlloc</code> (which ensures the page boundary constraint), add a terminator NULL to the list, ensure the data on disk is on the system boundary (and implicitly a disk sector size boundary) as well and issue the call.</p>\n\n<p>Without further due, here's the minimum test case in C++:</p>\n\n<pre><code>// Setup: c:\\tmp\\test.dat is a file with at least 12K of stuff. \n// I attempt to read page 2/3, e.g. offset [4096-4096+8192&gt;\n\n// TEST:\nSYSTEM_INFO systemInfo;\nGetSystemInfo(&amp;systemInfo);\nauto pageSize = systemInfo.dwPageSize;\nstd::cout &lt;&lt; \"Page size: \"&lt;&lt; pageSize &lt;&lt; std::endl;\n\n// Allocate 2 pages that are aligned with one in the middle:\nauto buffer = reinterpret_cast&lt;char*&gt;(VirtualAlloc(NULL, pageSize * 3, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE));\n\n// Create read buffer:\nstd::vector&lt;FILE_SEGMENT_ELEMENT&gt; elements;\n{\n    FILE_SEGMENT_ELEMENT element1;\n    element1.Buffer = buffer;\n    elements.push_back(element1);\n}\n{\n    FILE_SEGMENT_ELEMENT element2;\n    element2.Buffer = buffer + pageSize * 2;\n    elements.push_back(element2);\n}\n{\n    FILE_SEGMENT_ELEMENT terminator;\n    terminator.Buffer = NULL;\n    elements.push_back(terminator);\n}\n\n// [..] Physical sector size is normally checked as well. In my case it's 512 bytes, \n// so I guess that's irrelevant here.\n//\n// Open file:\nauto fileHandle = CreateFile(\n    \"c:\\\\tmp\\\\test.dat\", \n    GENERIC_READ | GENERIC_WRITE, \n    FILE_SHARE_READ, \n    NULL, \n    OPEN_ALWAYS, \n    FILE_FLAG_NO_BUFFERING | FILE_FLAG_WRITE_THROUGH, \n    NULL);\n\nauto err = GetLastError();\nif (err != ERROR_ALREADY_EXISTS &amp;&amp; err != ERROR_SUCCESS)\n{\n    throw std::exception(); // FIXME.\n}\n\nOVERLAPPED overlapped;\nmemset(&amp;overlapped, 0, sizeof(OVERLAPPED));\n\nLARGE_INTEGER tmp;\ntmp.QuadPart = 4096; // Read from disk page 1\n\noverlapped.Offset = tmp.LowPart;\noverlapped.OffsetHigh = tmp.HighPart;\noverlapped.hEvent = CreateEvent(NULL, TRUE, FALSE, NULL);\n\nauto succes = ReadFileScatter(fileHandle, elements.data(), pageSize * 2, NULL, &amp;overlapped);\nerr = GetLastError();\n\nif (!succes &amp;&amp; err != ERROR_IO_PENDING &amp;&amp; err != ERROR_SUCCESS)\n{\n    throw std::exception(); // The call always ends up here with error 87: Invalid parameter\n}\n\nWaitForSingleObject(overlapped.hEvent, INFINITE);\n\nstd::cout &lt;&lt; \"Call succeeded!\" &lt;&lt; std::endl;\n\n// FIXME: Proper exception handling.\n\n// Clean up:\nVirtualFree(buffer, pageSize * 3, MEM_DECOMMIT | MEM_RELEASE);\nCloseHandle(overlapped.hEvent);\nCloseHandle(fileHandle);\n</code></pre>\n\n<p>In the code, the error is noted with the comment <code>// The call always ends up here with error 87: Invalid parameter</code>. However, as far as I can see, I check all the boxes that they describe on MSDN... so...</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c++", "pgm"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1498664473, "post_id": 44807040, "comment_id": 76594080, "body": "any solution to what, exactly? &quot;i have problem to read a pgm image&quot; is not a problem statement. Can you please be more precise as to what is not working?"}, {"owner": {"reputation": 23, "user_id": 7883973, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cM5w-TdhfR8/AAAAAAAAAAI/AAAAAAAAACI/TP62OuxdPUY/photo.jpg?sz=128", "display_name": "Danix Danilovic", "link": "https://stackoverflow.com/users/7883973/danix-danilovic"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1498664739, "post_id": 44807040, "comment_id": 76594302, "body": "i can&#39;t read and memorize in imgTemp.data_ pixels with size of 16 bit"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1498664949, "post_id": 44807040, "comment_id": 76594479, "body": "Do you have an exception? A compiler error? Variables with values you don&#39;t expect? This is the kind of information that helps us help you. Can you please gather them and edit your question as to include them?"}, {"owner": {"reputation": 23, "user_id": 7883973, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cM5w-TdhfR8/AAAAAAAAAAI/AAAAAAAAACI/TP62OuxdPUY/photo.jpg?sz=128", "display_name": "Danix Danilovic", "link": "https://stackoverflow.com/users/7883973/danix-danilovic"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1498666593, "post_id": 44807040, "comment_id": 76595640, "body": "create a error when it tries to execute the istruction img(r, c) = imgTemp ( r, c) (error: vector subscript out of range)"}, {"owner": {"reputation": 2870, "user_id": 3427580, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/73909f88442d1b4be6cebec37c9d1aaf?s=128&d=identicon&r=PG&f=1", "display_name": "marcman", "link": "https://stackoverflow.com/users/3427580/marcman"}, "edited": false, "score": 0, "creation_date": 1498671670, "post_id": 44807040, "comment_id": 76598722, "body": "Why reinvent the wheel? Try using OpenCV. The <code>imread</code> function will read a PGM and I believe you can specify the bitdepth. Otherwise try freeimage."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 7883973, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cM5w-TdhfR8/AAAAAAAAAAI/AAAAAAAAACI/TP62OuxdPUY/photo.jpg?sz=128", "display_name": "Danix Danilovic", "link": "https://stackoverflow.com/users/7883973/danix-danilovic"}, "is_accepted": true, "score": 0, "last_activity_date": 1498742996, "creation_date": 1498742996, "answer_id": 44826551, "question_id": 44807040, "link": "https://stackoverflow.com/questions/44807040/open-a-pgm-image-16-bpp/44826551#44826551", "title": "Open a pgm image 16 bpp", "body": "<p>i've found solution to my problem. here is the right code if it can be useful for someone:</p>\n\n<pre><code>#include \"pgm.h\"\n\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n\nusing namespace std;\n\nbool convert16to8bit(const std::string&amp; inFilename, mat&lt;uint8_t&gt;&amp; img, const std::string&amp; outFilename){\n    mat&lt;uint16_t&gt; imgTemp;\n\n    ifstream is(inFilename, ios::binary);\n    if (!is)\n        return false;\n\n    string magic;\n    is &gt;&gt; magic;\n    if (magic != \"P2\" &amp;&amp; magic != \"P5\")\n        return false;\n\n    size_t rows, cols, nlevels;\n    is &gt;&gt; cols &gt;&gt; rows &gt;&gt; nlevels;\n\n    if (nlevels &lt; 255)\n        return false;\n\n    is.get();\n\n    img = mat&lt;uint8_t&gt;(rows, cols);\n    if (nlevels == 255){\n        if (magic == \"P5\"){\n            is.unsetf(ios::skipws);\n            img.data_.assign(istream_iterator&lt;uint8_t&gt;(is), istream_iterator&lt;uint8_t&gt;());\n        }else\n            img.data_.assign(istream_iterator&lt;int&gt;(is), istream_iterator&lt;int&gt;());\n    }\n    else{\n        imgTemp = mat&lt;uint16_t&gt;(rows, cols);\n        if (magic == \"P5\"){\n\n            //here is the line changed\n            is.read(reinterpret_cast&lt;char *&gt;(&amp;imgTemp.data_[0]), imgTemp.rows()*imgTemp.cols() * 2);          \n        }\n        else\n            imgTemp.data_.assign(istream_iterator&lt;int&gt;(is), istream_iterator&lt;int&gt;());\n\n        for (size_t r = 0; r &lt; rows; r++)\n            for (size_t c = 0; c &lt; cols; c++)\n                img(r, c) = imgTemp(r, c);\n    }\n\n    stringstream ss; \n    ss &lt;&lt; outFilename &lt;&lt; \".pgm\";\n    ofstream os(ss.str(), ios::binary);\n    if (!os)\n        return false;\n    os &lt;&lt; magic &lt;&lt;\"\\n\" &lt;&lt; cols &lt;&lt; \" \" &lt;&lt; rows &lt;&lt; \"\\n255\\n\";\n    if (magic == \"P2\") \n        copy(begin(img), end(img), ostream_iterator&lt;int&gt;(os, \" \")); \n    else \n        copy(begin(img), end(img), ostream_iterator&lt;uint8_t&gt;(os));\n\n    return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7883973, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cM5w-TdhfR8/AAAAAAAAAAI/AAAAAAAAACI/TP62OuxdPUY/photo.jpg?sz=128", "display_name": "Danix Danilovic", "link": "https://stackoverflow.com/users/7883973/danix-danilovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "closed_date": 1498779776, "accepted_answer_id": 44826551, "answer_count": 1, "score": -4, "last_activity_date": 1498742996, "creation_date": 1498664325, "last_edit_date": 1498666556, "question_id": 44807040, "link": "https://stackoverflow.com/questions/44807040/open-a-pgm-image-16-bpp", "closed_reason": "Not suitable for this site", "title": "Open a pgm image 16 bpp", "body": "<p>i need to convert a pgm image 16 bit per pixel to a pgm image 8 bit per pixel but i have problem to read a pgm image 16 bpp and i don't understand what i'm doing wrong. here the code:</p>\n\n<pre><code>#include \"pgm.h\"\n\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n\nusing namespace std;\n\nbool convert16to8bit(const std::string&amp; inFilename, mat&lt;uint8_t&gt;&amp; img, const std::string&amp; outFilename){\n    mat&lt;uint16_t&gt; imgTemp;\n\n    ifstream is(inFilename, ios::binary);\n    if (!is)\n        return false;\n\n    string magic;\n    is &gt;&gt; magic;\n    if (magic != \"P2\" &amp;&amp; magic != \"P5\")\n        return false;\n\n    size_t rows, cols, nlevels;\n    is &gt;&gt; cols &gt;&gt; rows &gt;&gt; nlevels;\n\n    if (nlevels &lt; 255)\n        return false;\n\n    is.get();\n\n    img = mat&lt;uint8_t&gt;(rows, cols);\n    if (nlevels == 255){\n        if (magic == \"P5\"){\n            is.unsetf(ios::skipws);\n            img.data_.assign(istream_iterator&lt;uint8_t&gt;(is), istream_iterator&lt;uint8_t&gt;());\n        }else\n            img.data_.assign(istream_iterator&lt;int&gt;(is), istream_iterator&lt;int&gt;());\n    }\n    else{\n        imgTemp = mat&lt;uint16_t&gt;(rows, cols);\n        if (magic == \"P5\"){\n            is.unsetf(ios::skipws);\n            imgTemp.data_.assign(istream_iterator&lt;uint16_t&gt;(is), istream_iterator&lt;uint16_t&gt;());\n        }\n        else\n            imgTemp.data_.assign(istream_iterator&lt;int&gt;(is), istream_iterator&lt;int&gt;());\n\n        for (size_t r = 0; r &lt; rows; r++)\n            for (size_t c = 0; c &lt; cols; c++)\n                img(r, c) = imgTemp(r, c);\n    }\n\n    stringstream ss; \n    ss &lt;&lt; outFilename &lt;&lt; \".pgm\";\n    ofstream os(ss.str(), ios::binary);\n    if (!os)\n        return false;\n    os &lt;&lt; magic &lt;&lt;\"\\n\" &lt;&lt; cols &lt;&lt; \" \" &lt;&lt; rows &lt;&lt; \"\\n255\\n\";\n    if (magic == \"P2\") \n        copy(begin(img), end(img), ostream_iterator&lt;int&gt;(os, \" \")); \n    else \n        copy(begin(img), end(img), ostream_iterator&lt;uint8_t&gt;(os));\n\n    return true;\n}\n\n\n//mat.h\n\n#if !defined MAT_H \n#define MAT_H\n\n#include &lt;vector&gt;\n\ntemplate &lt;typename T&gt; \nstruct mat {\n    size_t rows_, cols_; \n    std::vector&lt;T&gt; data_;\n\n    mat(size_t rows = 0, size_t cols = 0) : rows_(rows), cols_(cols), data_(rows*cols) {}\n\n    const size_t rows() const { return rows_; } \n    const size_t cols() const { return cols_; }\n\n    const T&amp; operator()(size_t r, size_t c) const { return data_[r*cols_ + c]; } \n    T&amp; operator()(size_t r, size_t c) { return data_[r*cols_ + c]; }\n\n    auto begin() -&gt; decltype(data_.begin()) { return data_.begin(); } \n    auto end() -&gt; decltype(data_.end()) { return data_.end(); } \n    auto begin() const -&gt; decltype(data_.begin()) { return data_.begin(); } \n    auto end() const -&gt; decltype(data_.end()) { return data_.end(); }\n};\n#endif // MAT_H\n</code></pre>\n\n<p>this code create a error when it tries to execute the istruction img(r, c) = imgTemp ( r, c) (error: vector subscript out of range) with a pgm 16bpp but with a pgm 8bpp i can open it without problems and recreate it as the original without error. i think that the problem is with istream_iterator &lt; uint16_t > because istream_iterator &lt; uint8_t > works (with pgm 8bit). any solution?</p>\n\n<p>thanks for any help</p>\n"}, {"tags": ["c++", "c++11", "smart-pointers"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 4, "creation_date": 1498664340, "post_id": 44806925, "comment_id": 76593994, "body": "(don&#39;t have time for a full answer) <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr/unique_ptr\" rel=\"nofollow noreferrer\"><code>std::unique_ptr</code></a> provides a constructor that makes the conversion possible : <code>template&lt; class U, class E &gt; unique_ptr( unique_ptr&lt;U, E&gt;&amp;&amp; u ) noexcept;</code> You need to replicate that functionality"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1498664455, "post_id": 44806925, "comment_id": 76594065, "body": "This is odd: <code>obj = std::move(ptr.obj);</code>, <code>obj</code> being a pointer."}, {"owner": {"reputation": 503, "user_id": 7458932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/226f3917c60bd248fcd77f4448b19068?s=128&d=identicon&r=PG&f=1", "display_name": "devalone", "link": "https://stackoverflow.com/users/7458932/devalone"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1498664767, "post_id": 44806925, "comment_id": 76594322, "body": "@YSC, yes, you&#39;re right, it&#39;s not necessary :)"}], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 7458932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/226f3917c60bd248fcd77f4448b19068?s=128&d=identicon&r=PG&f=1", "display_name": "devalone", "link": "https://stackoverflow.com/users/7458932/devalone"}, "edited": false, "score": 0, "creation_date": 1498665875, "post_id": 44807120, "comment_id": 76595209, "body": "Thanks, It works. But, I make constructor like this:  ` template &lt;typename U&gt; UniquePtr(UniquePtr&lt;U&gt;&amp;&amp; ptr)  {  obj = ptr.get();  ptr.reset();  } ` Because <code>Unique_Ptr&lt;U&gt;</code> has other type and obj becomes inaccessible"}, {"owner": {"reputation": 503, "user_id": 7458932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/226f3917c60bd248fcd77f4448b19068?s=128&d=identicon&r=PG&f=1", "display_name": "devalone", "link": "https://stackoverflow.com/users/7458932/devalone"}, "edited": false, "score": 0, "creation_date": 1498678595, "post_id": 44807120, "comment_id": 76602729, "body": "however, I found better solution, I added <code>template &lt;typename U&gt; friend class UniquePtr;</code>. It gives me access to private members"}], "tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 2, "last_activity_date": 1498664537, "creation_date": 1498664537, "answer_id": 44807120, "question_id": 44806925, "link": "https://stackoverflow.com/questions/44806925/how-to-pass-my-own-smart-pointer-to-function/44807120#44807120", "title": "How to pass my own smart pointer to function?", "body": "<p>Much like how <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr/unique_ptr\" rel=\"nofollow noreferrer\"><code>std::unique_ptr</code> handles it</a>, you need to provide a templated constructor for your class that takes a <code>UniquePtr</code> of a different type (allowing SFINAE to deal with inheritance checking), which will then be used to initialize your <code>UniquePtr</code>'s state.</p>\n\n<pre><code>template&lt;typename U&gt;\nUniquePtr(UniquePtr&lt;U&gt; &amp;&amp; other) {\n    obj = other.obj;//Won't compile if U is not a subclass of T.\n    other.obj = nullptr;\n}\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 7458932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/226f3917c60bd248fcd77f4448b19068?s=128&d=identicon&r=PG&f=1", "display_name": "devalone", "link": "https://stackoverflow.com/users/7458932/devalone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 44807120, "answer_count": 1, "score": 2, "last_activity_date": 1498664537, "creation_date": 1498664001, "last_edit_date": 1498664434, "question_id": 44806925, "link": "https://stackoverflow.com/questions/44806925/how-to-pass-my-own-smart-pointer-to-function", "title": "How to pass my own smart pointer to function?", "body": "<p>There is smart pointer class:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass UniquePtr {\npublic:\n    UniquePtr(T* obj)\n        : obj(obj)\n    {\n    }\n    UniquePtr(const UniquePtr&amp; ptr) = delete;\n    UniquePtr(UniquePtr&amp;&amp; ptr)\n    {\n        std::cout &lt;&lt; \"!! use of move !!\" &lt;&lt; std::endl;\n        obj = std::move(ptr.obj);\n        ptr.obj = nullptr;\n    }\n\n    UniquePtr&amp; operator=(const UniquePtr&amp; ptr) = delete;\n    UniquePtr&amp; operator=(const UniquePtr&amp;&amp; ptr) = delete;\n\n    ~UniquePtr()\n    {\n        delete obj;\n    }\n\nprivate:\n    T* obj;\n};\n</code></pre>\n\n<p>class for test:</p>\n\n<pre><code>class Test {\npublic:\n    Test()\n    {\n        std::cout &lt;&lt; \"Test is created\" &lt;&lt; std::endl;\n    }\n    Test(const Test&amp; obj) = delete;\n    Test(const Test&amp;&amp; obj) = delete;\n    Test&amp; operator=(const Test&amp; obj) = delete;\n    Test&amp; operator=(const Test&amp;&amp; obj) = delete;\n    virtual ~Test()\n    {\n        std::cout &lt;&lt; \"Test is destructed\" &lt;&lt; std::endl;\n    }\n};\n</code></pre>\n\n<p>and function:</p>\n\n<pre><code>void function(UniquePtr&lt;Test&gt;&amp;&amp; ptr)\n{\n    std::vector&lt;UniquePtr&lt;Test&gt;&gt; v;\n    v.push_back(std::move(ptr));\n}\n</code></pre>\n\n<p>If I pass Test class, everything is OK:</p>\n\n<pre><code>UniquePtr&lt;Test&gt; ptr(new Test);\nfunction(std::move(ptr));\n</code></pre>\n\n<p>But if I pass derived from Test class, code isn't compiled:</p>\n\n<pre><code>class TestChild : public Test {\npublic:\n    TestChild()\n    {\n        std::cout &lt;&lt; \"Test child is created\" &lt;&lt; std::endl;\n    }\n    TestChild(const TestChild&amp; obj) = delete;\n    TestChild(const TestChild&amp;&amp; obj) = delete;\n    TestChild&amp; operator=(const TestChild&amp; obj) = delete;\n    TestChild&amp; operator=(const TestChild&amp;&amp; obj) = delete;\n    virtual ~TestChild()\n    {\n        std::cout &lt;&lt; \"Test child is destructed\" &lt;&lt; std::endl;\n    }\n};\nUniquePtr&lt;TestChild&gt; ptr(new TestChild);\nfunction(std::move(ptr));\n</code></pre>\n\n<blockquote>\n<pre><code>error: invalid initialization of reference of type \u2018UniquePtr&amp;&amp;\u2019 from\nexpression of type \u2018std::remove_reference&amp;&gt;::type {aka UniquePtr}\u2019\nfunction(std::move(ptr)); ~~~~~~~~~^~~~~\n</code></pre>\n</blockquote>\n\n<p>How can I make <code>UniquePtr&lt;TestChild&gt;</code> convertible to <code>UniquePtr&lt;Test&gt;&amp;&amp;</code>\nWith <code>std::unique_ptr</code> this code works.</p>\n"}, {"tags": ["c++", "c++11", "shared-ptr", "weak-ptr", "make-shared"], "answers": [{"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1498663929, "post_id": 44806794, "comment_id": 76593710, "body": "Much clearer than my explanation, and +1 for the first sentence of the last paragraph."}], "tags": [], "owner": {"reputation": 9119, "user_id": 2729109, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1254b21c13af8f443246cbcf1404ed4f?s=128&d=identicon&r=PG&f=1", "display_name": "ikh", "link": "https://stackoverflow.com/users/2729109/ikh"}, "is_accepted": true, "score": 11, "last_activity_date": 1498663615, "creation_date": 1498663615, "answer_id": 44806794, "question_id": 44806682, "link": "https://stackoverflow.com/questions/44806682/stdmake-shared-stdweak-ptr-and-cyclic-references/44806794#44806794", "title": "std::make_shared(), std::weak_ptr and cyclic references", "body": "<p>It is destroyed. That's one of the reason why <code>weak_ptr</code> exists.</p>\n\n<p>When <code>a</code> is destroyed, the reference counter becomes 0, so the object is <em>destroyed</em>. That means the destructor of the object is called, which destroys <code>a-&gt;parent</code> too.</p>\n\n<p>Don't confuse <em>destruction</em> with <em>deallocation</em>. When reference counter becomes 0, or no <code>shared_ptr</code> owns the object, the object is <em>destroyed</em>. If there is any <code>weak_ptr</code> which points the control block, the memory won't be <em>deallocated</em> - because the object was allocated with <code>std::make_shared</code> - but the object is definitely <em>destroyed</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 3, "last_activity_date": 1498663886, "creation_date": 1498663886, "answer_id": 44806885, "question_id": 44806682, "link": "https://stackoverflow.com/questions/44806682/stdmake-shared-stdweak-ptr-and-cyclic-references/44806885#44806885", "title": "std::make_shared(), std::weak_ptr and cyclic references", "body": "<p>Problem involve with:</p>\n\n<blockquote>\n  <p>If any std::weak_ptr references the control block created by std::make_shared after the lifetime of all shared owners ended, the memory occupied by T persists until all weak owners get destroyed as well, which may be undesirable if sizeof(T) is large</p>\n</blockquote>\n\n<p>is something like</p>\n\n<pre><code>std::weak_ptr&lt;A&gt; global;\n\nvoid foo()\n{\n    auto a = std::make_shared&lt;A&gt;();\n    global = a;\n}\n</code></pre>\n\n<p>So <code>global</code> point to control block of <code>a</code>.\nHere even if <code>a</code> is destroyed, the memory used by <code>a</code> is still present to allow the control block to exist.</p>\n"}, {"tags": [], "owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1528868721, "creation_date": 1528868721, "answer_id": 50829809, "question_id": 44806682, "link": "https://stackoverflow.com/questions/44806682/stdmake-shared-stdweak-ptr-and-cyclic-references/50829809#50829809", "title": "std::make_shared(), std::weak_ptr and cyclic references", "body": "<p>There is a <strong>cycle of object reachability via implementation pointers</strong>, that is, you can follow pointers used inside of the private implementations of these objects and go back to where you started: <code>a-&gt;parent</code> contains a pointer to the meta information (control block) created either by <code>std::shared_ptr</code> or by <code>std::make_shared</code>.</p>\n\n<p>Of course <code>std::make_shared</code> is expected to minimize the number of dynamic memory allocations by putting together the meta information and the managed object, but that has no bearing on when the managed object is destroyed (which is the only observable aspect since no class specific <code>operator new</code>/<code>operator delete</code> was used). So whether the control block is collocated with the managed object, or has a pointer to that object allocated separately, is irrelevant.</p>\n\n<p>In all but a handful of degenerate cases (where the smart pointer is constructed with a fake deleter that doesn't deallocate anything), the end of the lifetime of the last shared owning smart pointer causes a deleter to run, usually:</p>\n\n<ul>\n<li>of the form <code>delete p;</code> to run, where <code>p</code> is the argument of type <code>T*</code> of the constructor of <code>std::shared_ptr&lt;U&gt;</code>, </li>\n<li>or of the form <code>p-&gt;~T()</code>, where <code>p</code> is the result of <code>new (buff) T</code> in <code>std::make_shared&lt;T&gt;()</code>.</li>\n</ul>\n\n<p>In either case, the value of <code>p</code> can be obtained from the meta information.</p>\n\n<p>[Note that the value <code>p</code> to be deleted is never obtained from the <code>U*</code> pointer value stored in any particular <code>std::shared_ptr&lt;U&gt;</code> instance, as such pointer value may not be \"deletable\", as the destructor may not be virtual (as long as the pointer argument <code>std::shared_ptr&lt;U&gt;</code> has the right static type: it's sufficient that <code>delete p;</code> where <code>p</code> is the value of the type passed to the templated constructor), as the pointer may be to a member subobject or a complete different complete object, if an aliasing constructor was used to construct another <code>std::shared_ptr</code> with shared ownership.]</p>\n\n<p>So having a pointer to the control block usually allows one to recover a pointer to the controlled object, although that pointer to the complete object cannot be obtained through the public interface (except that the pointer is passed to the deleter, so the only way to recover the pointer in C++, if it was lost, would be to have passed a custom deleter and wait for it to be called). The pointer can certainly be recovered by navigating inside the memory representation (although that navigation might need to use <code>dynamic_cast</code> to a type unknown at compile time, something the debugger will be able to do as long as it knows about all derived classes).</p>\n\n<p>So we have the cycle:</p>\n\n<pre><code>a\na-&gt;parent\n   parent-&gt;control_block\n           control_block.deleter (virtual call or stored function)\n                         deleter.a\n</code></pre>\n\n<p>if the pointer is stored in a dynamically created deleter, as is necessary to create <code>std::shared_ptr&lt;U&gt;(T*)</code>, or</p>\n\n<pre><code>a\na-&gt;parent\n   parent-&gt;control_block\n           control_block.buffer\n</code></pre>\n\n<p>for objects created with a single allocation <code>make_shared</code>: the object was constructed inside that buffer so <code>&amp;control_block.buffer == a</code>.</p>\n\n<p>But cycles of pointers are not an issue, only cycle of ownership as it implies \"self ownership controlled by lifetime\", that is \"I will destruct myself only when my lifetime will be over\" (aka \"I will enter destructor when I will have entered destructor\"), an absurdity.</p>\n\n<p>Here there is no ownership as <strong>a weak reference only owns the meta information, not the information</strong>.</p>\n"}], "owner": {"reputation": 239, "user_id": 2464169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6263742c33ce18d5c232d88820547b9c?s=128&d=identicon&r=PG", "display_name": "Vizor", "link": "https://stackoverflow.com/users/2464169/vizor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 1, "accepted_answer_id": 44806794, "answer_count": 3, "score": 3, "last_activity_date": 1528868793, "creation_date": 1498663329, "last_edit_date": 1528868793, "question_id": 44806682, "link": "https://stackoverflow.com/questions/44806682/stdmake-shared-stdweak-ptr-and-cyclic-references", "title": "std::make_shared(), std::weak_ptr and cyclic references", "body": "<p>My question is about this claim:</p>\n\n<blockquote>\n  <p>If any std::weak_ptr references the control block created by std::make_shared after the lifetime of all shared owners ended, the memory occupied by T persists until all weak owners get destroyed as well, which may be undesirable if sizeof(T) is large. <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/make_shared\" rel=\"nofollow noreferrer\">Source</a></p>\n</blockquote>\n\n<p>I read <a href=\"https://stackoverflow.com/questions/32113594/weak-ptr-make-shared-and-memory-deallocation\">here</a>, that this object live until last weak_ptr is present.\nDoes it free object made with make_shared, with cyclic reference to self or it will live in memory forever?</p>\n\n<p>For example:</p>\n\n<pre><code>struct A\n{\n    std::weak_ptr&lt;A&gt; parent;\n}\n\nvoid fn()\n{\n    auto a=std::make_shared&lt;A&gt;();\n    a-&gt;parent = a;\n} // Will it destroy here or not?\n</code></pre>\n"}, {"tags": ["c++", "camera", "wsdl", "onvif"], "answers": [{"comments": [{"owner": {"reputation": 795, "user_id": 2243969, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f6ea356126ce6d810cd8bda046a61ce5?s=128&d=identicon&r=PG", "display_name": "Julien Greard", "link": "https://stackoverflow.com/users/2243969/julien-greard"}, "edited": false, "score": 0, "creation_date": 1498835105, "post_id": 44844631, "comment_id": 76679711, "body": "Yes, that&#39;s more or less what I&#39;ve done. I&#39;ve asked the user to set max value of the magnification which is always available in the specs. Then I compute the current magnification with the formula : current_mag = 1 + current_zoom * (max_mag - 1)"}], "tags": [], "owner": {"reputation": 26, "user_id": 8236859, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1884715215c7c08951c71ca6a517ed84?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/8236859/chris"}, "is_accepted": true, "score": 1, "last_activity_date": 1498819553, "creation_date": 1498819553, "answer_id": 44844631, "question_id": 44806619, "link": "https://stackoverflow.com/questions/44806619/onvif-get-magnification-factor/44844631#44844631", "title": "Onvif - get magnification factor", "body": "<p>The Zoom factor is a value between a min and max specified by each device in ZoomLimits data in the PTZ service. Unfortunately this does not have to represent any real world value and is often between 0.0 and 1.0.</p>\n\n<p>What you could do is in the device WSDL, request GetDeviceInformation and if you know the actual zoom capabilities in real values you could store them and compare against the model/manufacturer in your application.</p>\n"}], "owner": {"reputation": 795, "user_id": 2243969, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f6ea356126ce6d810cd8bda046a61ce5?s=128&d=identicon&r=PG", "display_name": "Julien Greard", "link": "https://stackoverflow.com/users/2243969/julien-greard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 44844631, "answer_count": 1, "score": 0, "last_activity_date": 1505274835, "creation_date": 1498663182, "last_edit_date": 1498835146, "question_id": 44806619, "link": "https://stackoverflow.com/questions/44806619/onvif-get-magnification-factor", "title": "Onvif - get magnification factor", "body": "<p>I'm implementing in C++ an ONVIF client in order to drive Onvif cameras.</p>\n\n<p>I need to get the magnification factor (x1 in zoom min, x200 in zoom max for example), but so far I only manage to get PTZ values (pan, tilt &amp; zoom in percentage). It's easy to transform pan and tilt from % to degrees but I don't know how to compute the magnification factor.</p>\n\n<p>I've looked at the WSDL files but I don't see what I need.</p>\n\n<p>I would be fine with:</p>\n\n<ul>\n<li><p>either a service telling me directly the magnification factor (for instance x64)</p></li>\n<li><p>the currently field of view of the lens (for instance 12\u00b0). I can easily get the max field of view and compute the magnification factor then:</p>\n\n<p>magnification_factor = current_field_of_view / field_of_view_max</p></li>\n<li><p>the min &amp; max fields of view of the camera:</p>\n\n<p>current_field_of_view = min_field_of_view + (max_field_of_view - min_field_of_view)*(1-zoom)\nmagnification_factor = current_field_of_view / field_of_view_max</p></li>\n</ul>\n\n<p>But I don't see any of it in the interface.</p>\n\n<p>Can someone help?</p>\n\n<p>[edit : solution found]</p>\n\n<p>I've asked the user to set max value of the magnification which is always available in the specs. Then I compute the current magnification with the formula : </p>\n\n<pre><code>current_mag = 1 + current_zoom * (max_mag - 1) \n</code></pre>\n"}, {"tags": ["c++", "class", "friend"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1498663363, "post_id": 44806507, "comment_id": 76593274, "body": "In fact there is no need to declare the member functions of the class B as friend functions because the class A has public interface."}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "reply_to_user": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1498663564, "post_id": 44806507, "comment_id": 76593440, "body": "@VladfromMoscow it is indeed a contrived example. I just want to understand why it does not work and how I can get around that."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498663632, "post_id": 44806507, "comment_id": 76593477, "body": "&quot;I can&#39;t define class B before defining class A&quot; why?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1498663681, "post_id": 44806507, "comment_id": 76593511, "body": "@Luca It does not work because the compiler does not know whether the class B indeed has these member functions."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498663758, "post_id": 44806507, "comment_id": 76593572, "body": "@n.m. The definition of the class B contains a data member of the type class A that shall be a complete type."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498663875, "post_id": 44806507, "comment_id": 76593668, "body": "Ah yes I see now"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498664045, "post_id": 44806507, "comment_id": 76593808, "body": "It doesn&#39;t actually make much sense to have friend member functions. Just make the entire class a friend."}, {"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498664785, "post_id": 44806507, "comment_id": 76594334, "body": "@n.m. actually it does make sense"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498664980, "post_id": 44806507, "comment_id": 76594506, "body": "Class is a small enough unit of privilege granting. Sure you could use more fine-grained access and sometimes it&#39;s nice but this doesn&#39;t make or break your design. Bad things won&#39;t happen if you just make the entire class a friend."}], "answers": [{"tags": [], "owner": {"reputation": 1116, "user_id": 5813151, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6ab74bcd2266233421ac0c4ba8e19465?s=128&d=identicon&r=PG", "display_name": "moonboy", "link": "https://stackoverflow.com/users/5813151/moonboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1498664448, "creation_date": 1498664448, "answer_id": 44807086, "question_id": 44806507, "link": "https://stackoverflow.com/questions/44806507/c-friend-classes-and-friend-member-functions/44807086#44807086", "title": "C++ friend classes and friend member functions", "body": "<p>Here is an example of a friend class and how to use it. This was taken <a href=\"http://cplusplus\" rel=\"nofollow noreferrer\">cplusplus.com</a> The reason I am posting this is because your example does not really illustrate the proper use of friendship in c++. I hope this will shed some light as to how/why you should use friendship, and that can lead to you solving your forward declaration problems. </p>\n\n<pre><code>// friend class\n#include &lt;iostream&gt;\nusing namespace std;\n\nclass Square;\n\nclass Rectangle {\n    int width, height;\n  public:\n    int area ()\n      {return (width * height);}\n    void convert (Square a);\n};\n\nclass Square {\n  friend class Rectangle;\n  private:\n    int side;\n  public:\n    Square (int a) : side(a) {}\n};\n\nvoid Rectangle::convert (Square a) {\n  width = a.side;\n  height = a.side;\n}\n\nint main () {\n  Rectangle rect;\n  Square sqr (4);\n  rect.convert(sqr);\n  cout &lt;&lt; rect.area();\n  return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>In this example, class Rectangle is a friend of class Square allowing\n  Rectangle's member functions to access private and protected members\n  of Square. More concretely, Rectangle accesses the member variable\n  Square::side, which describes the side of the square.</p>\n  \n  <p>There is something else new in this example: at the beginning of the\n  program, there is an empty declaration of class Square. This is\n  necessary because class Rectangle uses Square (as a parameter in\n  member convert), and Square uses Rectangle (declaring it a friend). </p>\n  \n  <p>Friendships are never corresponded unless specified: In our example,\n  Rectangle is considered a friend class by Square, but Square is not\n  considered a friend by Rectangle. Therefore, the member functions of\n  Rectangle can access the protected and private members of Square but\n  not the other way around. Of course, Square could also be declared\n  friend of Rectangle, if needed, granting such an access.</p>\n  \n  <p>Another property of friendships is that they are not transitive: The\n  friend of a friend is not considered a friend unless explicitly\n  specified.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "edited": false, "score": 0, "creation_date": 1498665949, "post_id": 44807563, "comment_id": 76595252, "body": "in this case I don&#39;t even need the Proxy class forward declaration"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1498665852, "creation_date": 1498665852, "answer_id": 44807563, "question_id": 44806507, "link": "https://stackoverflow.com/questions/44806507/c-friend-classes-and-friend-member-functions/44807563#44807563", "title": "C++ friend classes and friend member functions", "body": "<p>Just make <code>class B</code> a friend of <code>class A</code>. There are no adverse effects in doing this.</p>\n\n<p>If you absolutely positively want to exercise more fine-grained control, you can do it with a proxy class like this (using your example stripped to bare bones):</p>\n\n<pre><code>class Proxy;\n\nclass A\n{\npublic:\n    friend class Proxy;\n    A(int i);\nprivate:\n    int i;\n};\n\nclass B\n{\npublic:\n    B(A a);\n    void set(int i);\n    int get();\nprivate:\n    A a;\n};\n\nclass Proxy\n{\n  friend void B::set(int);\n  friend int B::get();\n  static int&amp; get_i(A&amp; a) { return a.i; }\n  static const int&amp; get_i(const A&amp; a) { return a.i; }\n};\n</code></pre>\n\n<p>You now can use <code>Proxy::get_i(a)</code> instead of <code>a.i</code> in <code>B::set</code> and <code>B::get</code> (only).</p>\n"}], "owner": {"reputation": 1369, "user_id": 4729407, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/ugk8q.jpg?s=128&g=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4729407/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1699, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1498665852, "creation_date": 1498662898, "question_id": 44806507, "link": "https://stackoverflow.com/questions/44806507/c-friend-classes-and-friend-member-functions", "title": "C++ friend classes and friend member functions", "body": "<p>I'm learning about friend functions, friend classes and friend member functions in C++ classes;\nNow, the following code compiles fine:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass A \n{\npublic:\n    friend class B;\n    //friend void B::set(int i);\n    //friend int B::get();\n    friend int function(A a);\n    A(int i);\n    void set(int i);\n    int get();\nprivate:\n    int i;\n};\n\nA::A(int i) : i(i)\n{\n}\n\nvoid A::set(int i)\n{\n    this-&gt;i = i;\n}\n\nint A::get()\n{\n    return i;\n}\n\nclass B\n{\npublic:\n    B(A a);\n    void set(int i);\n    int get();\nprivate:\n    A a;\n};\n\nB::B(A a) : a(a)\n{\n}\n\nvoid B::set(int i)\n{\n    a.i = i;\n}\n\nint B::get()\n{\n    return a.i;\n}\n\nint function(A a);\n\nint main(int argc, char *argv[])\n{\n    A a(0);\n    std::cout &lt;&lt; \"in A i=\" &lt;&lt; a.get() &lt;&lt; std::endl;\n    a.set(10);\n    std::cout &lt;&lt; \"in A i=\" &lt;&lt; a.get() &lt;&lt; std::endl;\n    B b(a);\n    std::cout &lt;&lt; \"in B i=\" &lt;&lt; b.get() &lt;&lt; std::endl;\n    b.set(21);\n    std::cout &lt;&lt; \"in B i=\" &lt;&lt; b.get() &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"function returns \" &lt;&lt; function(a) &lt;&lt; std::endl;\n}\n\nint function(A a)\n{\n    return a.i;\n}\n</code></pre>\n\n<p>I am able to grant friendship to class B and to function \"function\" in class A without forward declaring class B, or function \"function\". \nNow, if I want to grant friendship to the two member functions in class B it doesn't work if I don't define class B before defining class A:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass B;   // doesn't work, incomplete type (complete type needed)\n\nclass A \n{\npublic:\n    //friend class B;\n    friend void B::set(int i);\n    friend int B::get();\n    friend int function(A a);\n    A(int i);\n    void set(int i);\n    int get();\nprivate:\n    int i;\n};\n\nA::A(int i) : i(i)\n{\n}\n\nvoid A::set(int i)\n{\n    this-&gt;i = i;\n}\n\nint A::get()\n{\n    return i;\n}\n\nB::B(A a) : a(a)\n{\n}\n\nvoid B::set(int i)\n{\n    a.i = i;\n}\n\nint B::get()\n{\n    return a.i;\n}\n\nint function(A a);\n\nint main(int argc, char *argv[])\n{\n    A a(0);\n    std::cout &lt;&lt; \"in A i=\" &lt;&lt; a.get() &lt;&lt; std::endl;\n    a.set(10);\n    std::cout &lt;&lt; \"in A i=\" &lt;&lt; a.get() &lt;&lt; std::endl;\n    B b(a);\n    std::cout &lt;&lt; \"in B i=\" &lt;&lt; b.get() &lt;&lt; std::endl;\n    b.set(21);\n    std::cout &lt;&lt; \"in B i=\" &lt;&lt; b.get() &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"function returns \" &lt;&lt; function(a) &lt;&lt; std::endl;\n}\n\nint function(A a)\n{\n    return a.i;\n}\n</code></pre>\n\n<p>but I can't define class B before defining class A so I'm stuck. Forward declaring (not defining) class B doesn't work either.</p>\n\n<p>So my questions are:</p>\n\n<p>1) why I dont need to forward declare a function or an entire class in a friendship declaration but I do need to define a class if I need to specify member functions of that class?\nI know that friendship declarations are not declarations in the common sense (they just grant access, they don't forward declare anything).</p>\n\n<p>2) how can I make my code compile (besides declaring the A member object in B as A *a)?</p>\n"}, {"tags": ["c++", "serialization", "go", "protocol-buffers"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498662717, "post_id": 44806362, "comment_id": 76592751, "body": "You said in Go you get the same length, but what are you using when you get different lengths?"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1498663033, "post_id": 44806362, "comment_id": 76593116, "body": "Yeah, the first version is just wrong IMO. It should be 27 bytes. You can put the hex in here <a href=\"https://protogen.marcgravell.com/decode\" rel=\"nofollow noreferrer\">protogen.marcgravell.com/decode</a> to verify and see the same numbers come out for the 27 byte version"}, {"owner": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498663072, "post_id": 44806362, "comment_id": 76593037, "body": "When I do the same operations in go like I do in cpp, both serialized messages got the same length, in contrast to the cpp serialization which length differ"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1498666674, "post_id": 44806362, "comment_id": 76595701, "body": "What does <code>size</code> come out as, BTW?"}, {"owner": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "edited": false, "score": 0, "creation_date": 1498666794, "post_id": 44806362, "comment_id": 76595761, "body": "The <code>size</code> is 27, which should be correct if I&#39;m not mistaken"}], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "edited": false, "score": 0, "creation_date": 1498667640, "post_id": 44807928, "comment_id": 76596277, "body": "So the issue is the <code>file_b &lt;&lt; buffer</code> because I pass a char array and the ostream ends the writing after the first nil byte, since it&#39;s expecting a null terminated string?"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "edited": false, "score": 1, "creation_date": 1498668278, "post_id": 44807928, "comment_id": 76596696, "body": "@jonadev95 yes, exactly that"}], "tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": true, "score": 2, "last_activity_date": 1498667051, "creation_date": 1498667051, "answer_id": 44807928, "question_id": 44806362, "link": "https://stackoverflow.com/questions/44806362/protobuf-serialization-length-differs-when-using-different-values-for-field/44807928#44807928", "title": "Protobuf serialization length differs when using different values for field", "body": "<p>I think the error you're making is treating binary as character data and using character data APIs. Many of those APIs <strong>stop</strong> at the first nil byte (0), but that is a totally valid value in protobuf binary.</p>\n\n<p>You need to make sure you don't use any such APIs basically - stick purely to binary safe APIs.</p>\n\n<p>Since you indicate that <code>size</code> is 27, this all fits.</p>\n\n<p>Basically, the binary representation of 5.0 includes 0 bytes, but you could easily have seen the same problem for other values in time.</p>\n"}], "owner": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 44807928, "answer_count": 1, "score": 1, "last_activity_date": 1498667051, "creation_date": 1498662511, "last_edit_date": 1498666201, "question_id": 44806362, "link": "https://stackoverflow.com/questions/44806362/protobuf-serialization-length-differs-when-using-different-values-for-field", "title": "Protobuf serialization length differs when using different values for field", "body": "<p>My Protobuf message consists of 3 doubles</p>\n\n<pre><code>syntax = \"proto3\";\n\nmessage TestMessage{\n  double input = 1;\n  double output = 2;\n  double info = 3;\n}\n</code></pre>\n\n<p>When I set these values to</p>\n\n<pre><code>test.set_input(2.3456);\ntest.set_output(5.4321);\ntest.set_info(5.0);\n</code></pre>\n\n<p>the serialized message looks like</p>\n\n<pre><code>00000000  09 16 fb cb ee c9 c3 02  40 11 0a 68 22 6c 78 ba  |........@..h\"lx.|\n00000010  15 40 19                                          |.@.|\n00000013\n</code></pre>\n\n<p>when using <code>test.serializeToArray</code> and could not be deserialized successfully by a go program using the same protobuf message. When trying to read it from a c++ program I got a 0 as info, so the message seems to be corrupted.</p>\n\n<p>When using <code>test.serializeToOstream</code> I got this message, which could be deserialized successfully by both go and c++ programs.</p>\n\n<pre><code>00000000  09 16 fb cb ee c9 c3 02  40 11 0a 68 22 6c 78 ba  |........@..h\"lx.|\n00000010  15 40 19 00 00 00 00 00  00 14 40               |.@........@|\n0000001b\n</code></pre>\n\n<p>When setting the values to</p>\n\n<pre><code>test.set_input(2.3456);\ntest.set_output(5.4321);\ntest.set_info(5.5678);\n</code></pre>\n\n<p>the serialized messages, both produced by <code>test.serializeToArray</code> and <code>test.serializeToOstream</code> look like</p>\n\n<pre><code>00000000  09 16 fb cb ee c9 c3 02  40 11 0a 68 22 6c 78 ba  |........@..h\"lx.|\n00000010  15 40 19 da ac fa 5c 6d  45 16 40                 |.@....\\mE.@|\n0000001b\n</code></pre>\n\n<p>and could be successfully read by my go and cpp program.</p>\n\n<p>What am I missing here? Why is <code>serializeToArray</code> not working in the first case?</p>\n\n<p>EDIT:\nAs it turns out, serializeToString works fine, too.</p>\n\n<p>Here the code I used for the comparison:</p>\n\n<pre><code>file_a.open(FILEPATH_A);\nfile_b.open(FILEPATH_B);\n\ntest.set_input(2.3456);\ntest.set_output(5.4321);\ntest.set_info(5.0);\n\n//serializeToArray\nint size = test.ByteSize();\nchar *buffer = (char*) malloc(size);\ntest.SerializeToArray(buffer, size);\nfile_a &lt;&lt; buffer;\n\n//serializeToString\nstd::string buf;\ntest.SerializeToString(&amp;buf);\nfile_b &lt;&lt; buf;\n\nfile_a.close();\nfile_b.close();\n</code></pre>\n\n<p>Why does serializeToArray not work as expected?</p>\n\n<p>EDIT2:</p>\n\n<p>When using <code>file_b &lt;&lt; buf.data()</code> instead of <code>file_b &lt;&lt; buf.data()</code>, the data gets corrupted as well, but why?</p>\n"}, {"tags": ["c++", "arrays", "algorithm", "random"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1498662611, "post_id": 44806285, "comment_id": 76592668, "body": "If the sequence is less than about 1,000,000,000 values: fill an array with the values in sequence and use pairs of random numbers to shuffle the array by swapping values.  Do at least as many swaps as the size of the array.  To get working code reviewed please post on <b>Code Review</b>: <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 3, "creation_date": 1498662972, "post_id": 44806285, "comment_id": 76592953, "body": "@RichardCritten Better approach would be <a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"nofollow noreferrer\">Fisher\u2013Yates shuffle</a> or <code>std::shuffle</code>, which guarantee uniform distribution, but OP is stuck with a technique he was told to use anyway."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1498663013, "post_id": 44806285, "comment_id": 76592989, "body": "<code>shuffle</code> a vector fed by <code>iota</code>."}, {"owner": {"reputation": 14257, "user_id": 820127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f8fffeec4f2ba3e75aebe941e4e5dd?s=128&d=identicon&r=PG", "display_name": "rossum", "link": "https://stackoverflow.com/users/820127/rossum"}, "edited": false, "score": 1, "creation_date": 1498663459, "post_id": 44806285, "comment_id": 76593348, "body": "Generate random numbers and add then to a <code>std::set</code>, which will automatically eliminate duplicates.  Stop adding when the size of the <code>set</code> reaches the desired value.  For the complexity you need to look at the probability of picking an already picked number as the size of the <code>set</code> increases."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7484445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6b79b29f7d18920acda5d7016d58b1?s=128&d=identicon&r=PG&f=1", "display_name": "Olsion Hysa", "link": "https://stackoverflow.com/users/7484445/olsion-hysa"}, "edited": false, "score": 0, "creation_date": 1498669276, "post_id": 44806893, "comment_id": 76597286, "body": "But don&#39;t we have 1+2+3+...+n-1+n searches in the second for loop in the best case? Isn&#39;t it O(n^2)?"}, {"owner": {"reputation": 25508, "user_id": 847269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/564ffe2e3f1ffe82696cd1ac01ac035e?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick87", "link": "https://stackoverflow.com/users/847269/patrick87"}, "reply_to_user": {"reputation": 11, "user_id": 7484445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6b79b29f7d18920acda5d7016d58b1?s=128&d=identicon&r=PG&f=1", "display_name": "Olsion Hysa", "link": "https://stackoverflow.com/users/7484445/olsion-hysa"}, "edited": false, "score": 0, "creation_date": 1498670556, "post_id": 44806893, "comment_id": 76598063, "body": "@OlsionHysa You know what, you&#39;re right. I missed that. That will add a term <code>n</code> to each of the complexities given: best and average case. So these are actually O(n^2) for the best case and O(n^2 log n) for the average case. My apologies."}], "tags": [], "owner": {"reputation": 25508, "user_id": 847269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/564ffe2e3f1ffe82696cd1ac01ac035e?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick87", "link": "https://stackoverflow.com/users/847269/patrick87"}, "is_accepted": true, "score": 1, "last_activity_date": 1498670614, "last_edit_date": 1498670614, "creation_date": 1498663913, "answer_id": 44806893, "question_id": 44806285, "link": "https://stackoverflow.com/questions/44806285/random-generation-algorithm-in-c/44806893#44806893", "title": "Random generation algorithm in C++", "body": "<p>This algorithm will produce correct results, selecting a permutation uniformly at random from all possible permutations.</p>\n\n<p>The running time is not bounded above by any deterministic function since, as you point out, it could run literally forever. In the best case, this algorithm runs in O(n^2) and selects a random permutation without having to repeat any selection. On average, you'd expect to have to try n/n=1 time to get the first unique random, n/(n-1) times to get the second, and so on down to an expected value of n/1=n times to get the last one. Adding those together gives you n*H(n), where H(n) is the nth harmonic number. It turns out H(N) is Theta(log n) so this algorithm is O(n^2 log n) in the average case.</p>\n\n<p>There is a better way to do what you're trying to do: you can start with any permutation and shuffle it into another one using an algorithm that is O(n) in the worst case. The algorithm is the Fisher-Yates algorithm and works as follows:</p>\n\n<pre><code>FisherYates(array[1...n])\n1. if n == 1 then return\n2. r = random(2, n)\n3. temp = array[1]\n4. array[1] = array[r]\n5. array[r] = temp\n6. FisherYates(array[2...n])\n</code></pre>\n\n<p>This is a recursive formulation but an iterative one is straightforward. It calls <code>random</code> exactly <code>n</code> times, where <code>n</code> is the size of the array at the topmost invocation.</p>\n"}], "owner": {"reputation": 11, "user_id": 7484445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6b79b29f7d18920acda5d7016d58b1?s=128&d=identicon&r=PG&f=1", "display_name": "Olsion Hysa", "link": "https://stackoverflow.com/users/7484445/olsion-hysa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 44806893, "answer_count": 1, "score": -2, "last_activity_date": 1498670614, "creation_date": 1498662319, "last_edit_date": 1498667120, "question_id": 44806285, "link": "https://stackoverflow.com/questions/44806285/random-generation-algorithm-in-c", "title": "Random generation algorithm in C++", "body": "<p>Suppose you need to generate a random permutation of the first N integers. For example, {4, 3, 1, 5, 2} and {3, 1, 4, 2, 5} are legal permutations, but {5, 4, 1, 2, 1} is not, because one number (1) is duplicated and another (3) is missing. This routine is often used in simulation of algorithms. We assume the existence of a random number generator, RandInt(i,j), that generates between i and j with equal probability. Here is the algorithm:</p>\n\n<p>Fill the array A from A[0] to A[N-1] as follows: To fill A[i], generate random numbers until you get one that is not already in A[0], A[1],\u2026, A[i-1].</p>\n\n<p>Implement this algorithm in C++ and find the complexity. This is my code:</p>\n\n<pre><code>int a;\nbool b = false;\nA[0] = RandInt(1,n);\nfor (int i=1;i&lt;n;i++) {\ndo {\n  b = false;\n  a = RandInt(1,n);\n  for (int j=0;j&lt;i;j++)\n     if(A[j] == a)\n        b = true;\n} while(b);\nA[i] = a;\n}\n</code></pre>\n\n<p>Is this code correct? And how can I find the complexity of the algorithm? Since, RandInt(i,j) generates random numbers, I don't know how many times the do while loop will be repeated. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1498662660, "post_id": 44806275, "comment_id": 76592705, "body": "Why not a simple <code>main()</code> function with a simple struct and a call to <code>to_string()</code> to duplicate the issue?  What, if anything, does <code>LogEntry</code> or anything else such as <code>GetTickCount()</code> have to do with the issue you&#39;re getting?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1498663276, "post_id": 44806275, "comment_id": 76593198, "body": "What is this strange initialization code? Why are you using assignment expressions as initializers for the same fields of <code>lentry</code>? It might be formally valid after all, but still..."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1498663507, "post_id": 44806275, "comment_id": 76593383, "body": "The code crashes because you attempt to <i>assign</i> values to class members inside the <code>{}</code> initializer. At that moment the fields are not initialized (constructed) at all and any attempt to <i>assign</i> to them will result in undefined behavior. Proper operation of non-trivial assignment operator requires fully-constructed operands. Apparently what you wanted to do is this <code>LogEntry lentry = { get_time_stamp(), &quot;txt: &quot; + std::to_string(GetTickCount() - iBegin) };</code> Get rid of the assignments."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1498663552, "post_id": 44806275, "comment_id": 76593426, "body": "@AnT My guess is that it\u2019s an attempt to use C-like designators in initialization (see <a href=\"http://en.cppreference.com/w/c/language/struct_initialization\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/struct_initialization</a>), which unfortunately C++ has no equivalent for."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 1, "creation_date": 1498664467, "post_id": 44806275, "comment_id": 76594077, "body": "Why was this question put on hold after I have answered it?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498664637, "post_id": 44806275, "comment_id": 76594219, "body": "@Curious Because it didn\u2019t include a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>, even though in this particular case it included more than enough information to answer."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1498664718, "post_id": 44806275, "comment_id": 76594288, "body": "@DanielH But what purpose does putting it on hold serve after an answer was given well after it was answered?"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1498664805, "post_id": 44806275, "comment_id": 76594344, "body": "@DanielH Also, whoa, I had no idea C had named initializers"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 1, "creation_date": 1498664809, "post_id": 44806275, "comment_id": 76594349, "body": "@Curious I have no clue; I think the site community goes overboard on requiring MCV examples (they are almost always useful, but not always necessary to answer the question) and this is particularly egregious example where the extra ten lines (and four fewer characters) wouldn\u2019t even help in finding the problem."}, {"owner": {"reputation": 2026, "user_id": 1909456, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1f254bd884cc7ea6217bfd1eaccb9f75?s=128&d=identicon&r=PG", "display_name": "dgrat", "link": "https://stackoverflow.com/users/1909456/dgrat"}, "edited": false, "score": 0, "creation_date": 1498664812, "post_id": 44806275, "comment_id": 76594352, "body": "I don&#39;t think that this put on hold is okay."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1498664846, "post_id": 44806275, "comment_id": 76594386, "body": "@DanielH you are probably right, doesn&#39;t matter much"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498664938, "post_id": 44806275, "comment_id": 76594466, "body": "@dgrat I think the SO C++ community just has strong guidelines that people want askers to adhere to when asking questions that involve debugging, because a lot of times people try and spend a lot of time going down the wrong paths due to incomplete information.  I feel like that is understandable &#175;\\_(\u30c4)_/&#175;"}], "answers": [{"comments": [{"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498662996, "post_id": 44806454, "comment_id": 76592982, "body": "@IInspectable they have not, the constructor for the <code>std::string</code> objects runs when the constructor for the struct is ran, which happens after the evaluation of the arguments to the constructor"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1498663021, "post_id": 44806454, "comment_id": 76592996, "body": "@IInspectable In the line <code>lentry.m_LogMsg = &quot;txt: &quot; + std::to_string(GetTickCount() - iBegin)</code>, the variable <code>lentry.m_LogMsg</code> is uninitialized when its <code>operator=</code> is called."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498663057, "post_id": 44806454, "comment_id": 76593027, "body": "@IInspectable try compiling and running my pasted code and see what happens"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1498663183, "post_id": 44806454, "comment_id": 76593123, "body": "I see my mistake, I completely misinterpreted the expression <code>LogEntry lentry = { ... }</code>. Sorry for the noise."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1498663263, "post_id": 44806454, "comment_id": 76593185, "body": "@Curious Can you add the output, and maybe a link like <a href=\"http://coliru.stacked-crooked.com/a/73091fe9978ef9da\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/73091fe9978ef9da</a>, to the answer? Then it\u2019s clearer that the issue is that <code>operator=</code> is called before any <code>Test</code> objects are constructed."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1498663290, "post_id": 44806454, "comment_id": 76593219, "body": "@DanielH good suggestion, ill do both"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1498663379, "post_id": 44806454, "comment_id": 76593284, "body": "(A better link would be <a href=\"http://coliru.stacked-crooked.com/a/cc7fe50840d57ac8\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/cc7fe50840d57ac8</a>; I switched to Clang because G++ didn\u2019t show the warning message)"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1498663421, "post_id": 44806454, "comment_id": 76593322, "body": "@DanielH added!  Thanks for the help :)"}, {"owner": {"reputation": 2026, "user_id": 1909456, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1f254bd884cc7ea6217bfd1eaccb9f75?s=128&d=identicon&r=PG", "display_name": "dgrat", "link": "https://stackoverflow.com/users/1909456/dgrat"}, "edited": false, "score": 0, "creation_date": 1498664534, "post_id": 44806454, "comment_id": 76594121, "body": "OMG, I also misread my own code. It is indeed bullshit :/"}], "tags": [], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "is_accepted": true, "score": 1, "last_activity_date": 1498663397, "last_edit_date": 1498663397, "creation_date": 1498662756, "answer_id": 44806454, "question_id": 44806275, "link": "https://stackoverflow.com/questions/44806275/segfault-when-creating-a-stdstring-with-stdto-string/44806454#44806454", "title": "Segfault when creating a std::string with std::to_string()", "body": "<p>Your variables are uninitialized when using them as arguments to the surrounding constructor.  If you compile with the appropriate warning flags, you should get an error message.   So my guess is that some <code>std::string</code> invariants are broken in the assignment and that is what is causing the segmentation fault. </p>\n\n<p>For example </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing std::cout;\nusing std::endl;\n\nclass Test {\npublic:\n    Test() {\n        cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; endl;\n    }\n    Test(const Test&amp;) {\n        cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; endl;\n    }\n    Test(Test&amp;&amp;) {\n        cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; endl;\n    }\n    Test&amp; operator=(int) {\n        cout &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; endl;\n        return *this;\n    }\n};\n\nclass Something {\npublic:\n    Something(Test test_in) : test{test_in} {}\n    Test test;\n};\n\nint main() {\n    Something something = Something{\n        something.test = 2\n    };\n}\n</code></pre>\n\n<p>The output for this code is </p>\n\n<pre><code>Test&amp; Test::operator=(int)\nTest::Test(const Test&amp;)\nTest::Test(const Test&amp;)\n</code></pre>\n\n<p>As you can see the assignment operator is invoked first, which goes against the fact that class objects should be initialized before they are assigned to.   You can see this in action here <a href=\"https://wandbox.org/permlink/hnyF9YAf3JtP13vf\" rel=\"nofollow noreferrer\">https://wandbox.org/permlink/hnyF9YAf3JtP13vf</a> or <a href=\"http://coliru.stacked-crooked.com/a/cc7fe50840d57ac8\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/cc7fe50840d57ac8</a></p>\n\n<p>Further when compiler with all the warning flags, my compiler gives me the following error</p>\n\n<pre><code>variable 'something' is uninitialized when used within its own initialization [-Werror,-Wuninitialized]\n</code></pre>\n\n<hr>\n\n<p>Try changing your code to this</p>\n\n<pre><code>LogEntry lentry = {\n    get_time_stamp(), \n    \"txt: \" + std::to_string(GetTickCount() - iBegin)\n};\n</code></pre>\n"}], "owner": {"reputation": 2026, "user_id": 1909456, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1f254bd884cc7ea6217bfd1eaccb9f75?s=128&d=identicon&r=PG", "display_name": "dgrat", "link": "https://stackoverflow.com/users/1909456/dgrat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1358, "favorite_count": 0, "closed_date": 1498663289, "accepted_answer_id": 44806454, "answer_count": 1, "score": 1, "last_activity_date": 1498663397, "creation_date": 1498662306, "question_id": 44806275, "link": "https://stackoverflow.com/questions/44806275/segfault-when-creating-a-stdstring-with-stdto-string", "closed_reason": "Not suitable for this site", "title": "Segfault when creating a std::string with std::to_string()", "body": "<p>In Linux, but not Windows I get a SEGFAULT at the following location. I currently do not know what is wrong with this section. What I want to to is to push a std::string into a std::vector which is later used for generating a log. The entry at the following position just inherits a timestamp and a perf counter.</p>\n\n<pre><code>LogEntry lentry = {\n  lentry.m_LogTime = get_time_stamp(),\n  lentry.m_LogMsg = \"txt: \" + std::to_string(GetTickCount() - iBegin) // debugger complains here\n};\nm_Log.push_back(lentry);\n\n/*\ninline unsigned long long GetTickCount() {\n  using namespace std::chrono;\n  return duration_cast&lt;milliseconds&gt;(steady_clock::now().time_since_epoch()).count();\n}\n\nstruct LogEntry {\n  std::string m_LogTime;\n  std::string m_LogMsg;\n};\n*/\n</code></pre>\n\n<p>GDB</p>\n\n<pre><code>(gdb) bt 25\n#0  0x00007ffff2f39133 in std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::swap(std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;&amp;) () from /usr/lib64/libstdc++.so.6\n#1  0x00007ffff7f631a9 in std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::operator=(std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;&amp;&amp;) ()\n#2  0x00007ffff7cad5eb in xxx::zzz (this=0x7ffffffe44d0, data=..., iSelModel=2) at file.cpp:1110\n\n(gdb) bt full\n#0  0x00007ffff2f39133 in std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::swap(std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;&amp;) () from /usr/lib64/libstdc++.so.6\nNo symbol table info available.\n#1  0x00007ffff7f631a9 in std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::operator=(std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;&amp;&amp;) ()\nNo symbol table info available.\n#2  0x00007ffff7cad5eb in AbstractPoserEngine::ExportModel (this=0x7ffffffe44d0, data=..., iSelModel=2) at /home/cst/Desktop/PoserGUI/src/engine/AbstractPoserEngine.cpp:1110\n        nDim = {259, 439, 667}\n        aSkinMat = std::vector of length 1, capacity 1 = {34}\n        iBegin = 13520825\n        lentry = {m_LogTime = Traceback (most recent call last):\n  File \"/usr/lib64/../share/gdb/python/libstdcxx/v6/printers.py\", line 558, in to_string\n    return self.val['_M_dataplus']['_M_p'].lazy_string (length = len)\nRuntimeError: Cannot access memory at address 0x3dc775\n, m_LogMsg = Traceback (most recent call last):\n  File \"/usr/lib64/../share/gdb/python/libstdcxx/v6/printers.py\", line 558, in to_string\n    return self.val['_M_dataplus']['_M_p'].lazy_string (length = len)\nRuntimeError: Cannot access memory at address 0x4247ae140000000f\n}\n</code></pre>\n"}, {"tags": ["c++", "debugging", "struct", "macros"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1498662138, "post_id": 44806114, "comment_id": 76592304, "body": "Why would you <i>want</i> to use macros in the first place?"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1498663592, "post_id": 44806114, "comment_id": 76593457, "body": "What do you expect <code>#define MEMBER_COUNT(structname, type, member, size) +1</code> to be expanded? Can you provide a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8222655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e7e7c1bbf299f4162b1ba8443e973b?s=128&d=identicon&r=PG&f=1", "display_name": "Miranda Thomson", "link": "https://stackoverflow.com/users/8222655/miranda-thomson"}, "edited": false, "score": 0, "creation_date": 1498664590, "post_id": 44807027, "comment_id": 76594180, "body": "Thanks! I figured it was something small :P. I don&#39;t even know why I had the comma there in the first place."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8221052"}, "is_accepted": true, "score": 1, "last_activity_date": 1498664279, "creation_date": 1498664279, "answer_id": 44807027, "question_id": 44806114, "link": "https://stackoverflow.com/questions/44806114/why-cant-i-print-out-all-of-the-member-names-of-my-macro-created-struct/44807027#44807027", "title": "Why can&#39;t I print out all of the member names of my macro-created struct?", "body": "<p>I think it's the comma after \"#member\" in your \"MEMBER_NAME\" macro.\nIf I delete it it works fine for me.</p>\n"}], "owner": {"reputation": 3, "user_id": 8222655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e7e7c1bbf299f4162b1ba8443e973b?s=128&d=identicon&r=PG&f=1", "display_name": "Miranda Thomson", "link": "https://stackoverflow.com/users/8222655/miranda-thomson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 44807027, "answer_count": 1, "score": 0, "last_activity_date": 1498664279, "creation_date": 1498661925, "question_id": 44806114, "link": "https://stackoverflow.com/questions/44806114/why-cant-i-print-out-all-of-the-member-names-of-my-macro-created-struct", "title": "Why can&#39;t I print out all of the member names of my macro-created struct?", "body": "<p>I'm a bit of a noob when it comes to using macros, but I am running into a problem that I can't explain.</p>\n\n<p>I have used macros to generate the BlockA struct like this:</p>\n\n<pre><code>#define TO_STRUCT(structname, type, member, size) type member size;\n#define MEMBER_COUNT(structname, type, member, size) +1\n#define MEMBER_NAME(structname, type, member, size)  #member,\n\n#define BLOCK_STRUCT_MEMBERS(p)\\\n    p(BlockA, RegTypeA, regA, [5])\\\n    p(BlockA, RegTypeB, regB, )\\\n\n struct BlockA {\n    BLOCK_STRUCT_MEMBERS(TO_STRUCT)\n    int addr;\n    BlockA(int address);\n};\n</code></pre>\n\n<p>And then, I have printed out the count of how many members were put into the struct using the macros:</p>\n\n<pre><code>std::cout &lt;&lt; BLOCK_STRUCT_MEMBERS(MEMBER_COUNT);\n</code></pre>\n\n<p>This prints out the correct response: 2, and if I did the same with the second member commented out when I define it in BLOCK_STRUCT_MEMBERS, it prints 1, which makes sense. So that seems to be working. But if I try to print the names of the members using almost exactly the same method, like this, it only prints the name of the first member:</p>\n\n<pre><code>std::cout &lt;&lt; BLOCK_STRUCT_MEMBERS(MEMBER_NAME)\n</code></pre>\n\n<p>It also complains that it expected an expression when I try to put a semicolon after it, like I did when I printed the count. Why is this happening?</p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 3, "creation_date": 1498661717, "post_id": 44805943, "comment_id": 76591980, "body": "Learn to use a debugger. And provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You&#39;d know all of this already, had you taken the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1498685408, "post_id": 44805943, "comment_id": 76606346, "body": "<code>CCrypter::readFile()</code> does not close the file if <code>fread()</code> returns 0. It needs to always close the file if <code>fopen()</code> succeeds, regardless of whether <code>fread()</code> succeeds or fails. Testing the return value of <code>fread()</code> for 0 is not the correct to detect a reading error. It should be using <code>if (fread(buffer, 1, lenght, input) != lenght)</code>, or using <code>ferror()</code>. But since the code is clearly using C++, why use <code>fopen()</code> at all? It should use <code>std::ifstream</code> instead."}, {"owner": {"reputation": 47, "user_id": 6678203, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4f78c48cd246dce52e85136730f51890?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/6678203/miguel"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1498687364, "post_id": 44805943, "comment_id": 76607157, "body": "@RemyLebeau I used fopen() because i was having some problems with <code>std::ifstream</code>, but the problem is in fopen() and when i print the file path before, it seems fine. I really have no ideia waht is the problem"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1498688450, "post_id": 44805943, "comment_id": 76607548, "body": "@Miguel: did you <i>verify</i> that <code>fclose()</code> is actually being called before your failing <code>fopen()</code> is then called? I don&#39;t know what problem you had with <code>std::ifstream</code>, but it is very easy to use in this situation, eg: <a href=\"https://stackoverflow.com/questions/18816126/\">C++ read the whole file in buffer</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1498735662, "post_id": 44805943, "comment_id": 76627401, "body": "If <code>fopen</code> returns 0 (or rather <code>NULL</code>) then the file could not be opened for some reason. Inspect <a href=\"http://www.cplusplus.com/reference/cerrno/errno/\" rel=\"nofollow noreferrer\"><code>errno</code></a>  to get more information about the reason of the failure. What does <code>OutputDebugString(path)</code> display? This should also give you a hint."}, {"owner": {"reputation": 47, "user_id": 6678203, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4f78c48cd246dce52e85136730f51890?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/6678203/miguel"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1498759719, "post_id": 44805943, "comment_id": 76644834, "body": "@MichaelWalz I inspect the errno, as you said, and the error was &quot;Permission denied&quot;. I tryed to compile the program and run as administrator, but that didn&#39;t work. I also finded out that i only can open files in ProgramFiles Folder."}, {"owner": {"reputation": 47, "user_id": 6678203, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4f78c48cd246dce52e85136730f51890?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/6678203/miguel"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1498759987, "post_id": 44805943, "comment_id": 76644993, "body": "@RemyLebeau I didn&#39;t understand what you said about <code>fclose()</code> being called before <code>fopen()</code>, because the error is in <code>fopen()</code> returning 0, so i think calling <code>fclose()</code> would only result in an error. But i am gonna try your sugestion, using <code>std::ifstream</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1498765238, "post_id": 44805943, "comment_id": 76647847, "body": "@Miguel my point was, there is a hole in your code logic that <i>can</i> lead to <code>fclose</code> being skipped after a successful <code>fopen</code>, which <i>may</i> cause a <i>subsequent</i> <code>fopen</code> to fail. Using <code>std::ifstream</code> would avoid the skipped close."}, {"owner": {"reputation": 47, "user_id": 6678203, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4f78c48cd246dce52e85136730f51890?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/6678203/miguel"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1498774426, "post_id": 44805943, "comment_id": 76652146, "body": "@RemyLebeau That was the problem, Thanke you mate"}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 6678203, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4f78c48cd246dce52e85136730f51890?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/6678203/miguel"}, "is_accepted": false, "score": 1, "last_activity_date": 1498776213, "last_edit_date": 1498776213, "creation_date": 1498773489, "answer_id": 44835628, "question_id": 44805943, "link": "https://stackoverflow.com/questions/44805943/cant-load-file-using-fopen/44835628#44835628", "title": "Can&#39;t load file using fopen()", "body": "<p>I solved the issue. The problem was that I had opened the file before and did not close it, that was why I was receiving permission denied.</p>\n"}], "owner": {"reputation": 47, "user_id": 6678203, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4f78c48cd246dce52e85136730f51890?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/6678203/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1498776213, "creation_date": 1498661522, "question_id": 44805943, "link": "https://stackoverflow.com/questions/44805943/cant-load-file-using-fopen", "title": "Can&#39;t load file using fopen()", "body": "<p>I creating a program that takes a file and ecrypts it, but now i'am with a problem opening the file to read, the fopen() always return 0.</p>\n\n<pre><code>void run(){\n    char buffer[260] = { '\\0' };\n    GetWindowTextA(Path,buffer,260);\n    encryptFile(buffer, \"C:\\\\Users\\\\DownD\\\\Desktop\\\\Some.dat\");\n}\n</code></pre>\n\n<p>I think the problem is somewhere on this function run(), because when replace the buffer array with some string for example, \"C:\\\\Somefile.exe\" replacing the function encryptFile() for:\n <code>encryptFile(\"C:\\\\Somefile.exe\", \"C:\\\\Users\\\\DownD\\\\Desktop\\\\Some.dat\");</code>.It reads the file nice and clean.</p>\n\n<p>Here it is parts of the rest of the project.</p>\n\n<pre><code>int CCrypter::encryptFile(char* filePath, LPCSTR outFile)\n{\n    unsigned char* data = NULL;\nint cypherSize;\n\nint fSize = readFile(data, filePath);\nif (!fSize)\n    return 2;\n\nunsigned char *ciphertext = new unsigned char[fSize];\n\ncypherSize = encrypt(data, fSize, ciphertext);\nif (!cypherSize)\n    return 3;\n\nif (!Create_File(ciphertext, cypherSize, outFile))\n    return 4;\nreturn 1;\n}\n\n\nint CCrypter::readFile(unsigned char *&amp;buffer, const char* path)\n{\n    int lenght = 0;\n    OutputDebugString(path);\n    FILE* input = fopen(path, \"rb\");\n    if (!input)          // Input is always 0\n        return 0;\n    fseek(input, 0, SEEK_END);\n    lenght = ftell(input);\n    buffer = new unsigned char[lenght];\n    printf(\"%d\", buffer);\n    ZeroMemory(buffer, lenght);\n    rewind(input);\n    if (!fread(buffer, 1, lenght, input))\n        return 0;\n    fclose(input);\n    return lenght;\n}\n</code></pre>\n\n<p>Just to clarify, i'm using Multi-Byte Character Set</p>\n"}, {"tags": ["c++", "doxygen"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1498661909, "post_id": 44805836, "comment_id": 76592125, "body": "<a href=\"https://www.stack.nl/~dimitri/doxygen/manual/faq.html#faq_code\" rel=\"nofollow noreferrer\">stack.nl/~dimitri/doxygen/manual/faq.html#faq_code</a> - see &quot;How can I make doxygen ignore some code fragment?&quot;"}, {"owner": {"reputation": 91, "user_id": 4473840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7lVl.jpg?s=128&g=1", "display_name": "ralph", "link": "https://stackoverflow.com/users/4473840/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1498744626, "post_id": 44805836, "comment_id": 76634621, "body": "I do not want to chagne the source code."}], "owner": {"reputation": 91, "user_id": 4473840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7lVl.jpg?s=128&g=1", "display_name": "ralph", "link": "https://stackoverflow.com/users/4473840/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498661271, "creation_date": 1498661271, "question_id": 44805836, "link": "https://stackoverflow.com/questions/44805836/how-to-make-doxygen-ignore-source-code-that-is-commented-out-with-double-slashes", "title": "How to make Doxygen ignore source code that is commented out with double slashes", "body": "<p>With this C++ source code:</p>\n\n<pre><code>/**\n * @class A\n */\nclass A {\n  ..\n}\n\n// /**\n//  * @class B\n//  */\n// class B {\n//   ..\n// }\n</code></pre>\n\n<p>Doxygen creates documentation for both class A and class B.</p>\n\n<p>I would like Doxygen to not create documentation for class B. How can I achieve this?</p>\n"}, {"tags": ["c++", "amazon-web-services", "websocket", "mqtt", "iot"], "comments": [{"owner": {"reputation": 921, "user_id": 3172183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dscm0.png?s=128&g=1", "display_name": "amrdruid", "link": "https://stackoverflow.com/users/3172183/amrdruid"}, "edited": false, "score": 2, "creation_date": 1498665901, "post_id": 44805743, "comment_id": 76595221, "body": "Can you show some code you&#39;ve written or some links that you have searched for ? It&#39;ll help others to help"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7536875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fKKAKub_3mQ/AAAAAAAAAAI/AAAAAAAAAAs/IVLm5U2H66o/photo.jpg?sz=128", "display_name": "scouture", "link": "https://stackoverflow.com/users/7536875/scouture"}, "is_accepted": false, "score": 0, "last_activity_date": 1498678185, "creation_date": 1498678185, "answer_id": 44811027, "question_id": 44805743, "link": "https://stackoverflow.com/questions/44805743/aws-cpp-sdk-how-to-iot-publish-using-mqtt-over-web-socket-in-c/44811027#44811027", "title": "aws-cpp-sdk : How to IoT publish using MQTT over Web Socket (in c++)", "body": "<p>What I want to do is not yet possible, as answered by a software engineer of Aws on Git Hub.</p>\n\n<p><a href=\"https://github.com/aws/aws-sdk-cpp/issues/594\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-cpp/issues/594</a></p>\n\n<blockquote>\n  <p>the c++ sdk does not support mqtt at the moment. We have plans to add this to an upcoming c99 sdk. We'll keep you posted. In the meantime, if you need to use mqtt you can use the iot sdk.</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 7536875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fKKAKub_3mQ/AAAAAAAAAAI/AAAAAAAAAAs/IVLm5U2H66o/photo.jpg?sz=128", "display_name": "scouture", "link": "https://stackoverflow.com/users/7536875/scouture"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498678439, "creation_date": 1498661049, "last_edit_date": 1498678439, "question_id": 44805743, "link": "https://stackoverflow.com/questions/44805743/aws-cpp-sdk-how-to-iot-publish-using-mqtt-over-web-socket-in-c", "title": "aws-cpp-sdk : How to IoT publish using MQTT over Web Socket (in c++)", "body": "<p>I did a lot of research (here and on github) to find out how Iot Data Plane class works.</p>\n\n<p>I wonder how I could publish data on a topic with the c++ sdk and use of port 443. I would like to establish my connection, and have the connection alive until I close it. </p>\n\n<p>In brief, I need help to use the cpp sdk to send MQTT over Web Socket, on Linux.</p>\n\n<p>Does anyone can help?</p>\n\n<pre><code> Aws::SDKOptions options;\n options.loggingOptions.logLevel = Aws::Utils::Logging::LogLevel::Info;\n Aws::InitAPI(options);\n\n Aws::Auth::AWSCredentials credentials;\n credentials.SetAWSAccessKeyId(\"a valid key id generated in Aws IAM\");\n credentials.SetAWSSecretKey(\"a valid secret key generated in Aws IAM\");\n\n Aws::IoTDataPlane::IoTDataPlaneClient client(credentials);\n Aws::IoTDataPlane::Model::PublishRequest request;\n std::shared_ptr&lt;Aws::StringStream&gt; stream = std::make_shared&lt;Aws::StringStream&gt;(\"Something to publish.\");\n\n request.SetBody(stream);\n request.SetTopic(\"MyTopic\");\n\n Aws::IoTDataPlane::Model::PublishOutcome outcome(client.Publish(request));\n if(outcome.IsSuccess())\n {\n    printf(\"Success\");\n }\n else\n {\n    printf(\"%s\", outcome.GetError().GetMessage().c_str());\n }\n Aws::ShutdownAPI(options);\n</code></pre>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1498661155, "post_id": 44805733, "comment_id": 76591511, "body": "So your code works, you just want to find a better way of implementing it? Might want to try: <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 31, "user_id": 6007219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156572088840585/picture?type=large", "display_name": "scope", "link": "https://stackoverflow.com/users/6007219/scope"}, "reply_to_user": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1498661333, "post_id": 44805733, "comment_id": 76591655, "body": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 this is no where near a replica of that not even close please re-read what i have put because the link you shared doesnt have buttons or comboBoxes just text"}, {"owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1498661454, "post_id": 44805733, "comment_id": 76591751, "body": "I think the point of it is that you&#39;re saying you repeat it 20 times... but if nothing is changing, you can use a loop. And if something is changing, you didnt specify it in your question."}, {"owner": {"reputation": 31, "user_id": 6007219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156572088840585/picture?type=large", "display_name": "scope", "link": "https://stackoverflow.com/users/6007219/scope"}, "reply_to_user": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1498661582, "post_id": 44805733, "comment_id": 76591849, "body": "because i dont fully understand it myself it isnt a loop. yes the same thing is repeated over and over but im using buttons comboboxes and line edits. From what i have read on his example its no where near to even close as to explaining how to use QObject::children  I even stated I&#39;m slightly dim and slow at learning and he links something miles away.   Basically its like a register name age then a drop down combo box.  Once the person leaves you clear it but only that row. There are 20 rows each with its own clear/reset button"}, {"owner": {"reputation": 31, "user_id": 6007219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156572088840585/picture?type=large", "display_name": "scope", "link": "https://stackoverflow.com/users/6007219/scope"}, "reply_to_user": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1498661945, "post_id": 44805733, "comment_id": 76592154, "body": "I want to put their values inside an array. That is the quote from the link. I dont need to put there values in an array. My code works fine and does exactly what i want it to do. But its not dry"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1498664971, "post_id": 44805733, "comment_id": 76594498, "body": "@scope The linked dupe shows a number of techniques you can use for repeated UI elements to handle these in a loop. It doesn&#39;t matter much if these are comboboxes or lineedit controls. If you aren&#39;t able to extrapolate these examples for your particular needs that&#39;s your fault, not ours."}], "owner": {"reputation": 31, "user_id": 6007219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156572088840585/picture?type=large", "display_name": "scope", "link": "https://stackoverflow.com/users/6007219/scope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1498661190, "answer_count": 0, "score": 0, "last_activity_date": 1498667413, "creation_date": 1498661013, "last_edit_date": 1498667413, "question_id": 44805733, "link": "https://stackoverflow.com/questions/44805733/im-using-qt-to-design-a-program-and-need-help-because-my-code-is-not-dry", "closed_reason": "Duplicate", "title": "I&#39;m using qt to design a program and need help because my code is not DRY", "body": "<p>I know that I need to use `QObject::children, but I'm struggling to word it right to find a video online that explains it in a way I can understand, obviously because I don't fully understand what it is I'm looking for.</p>\n\n<p>Basically I have 4 lineEdits and 2 comboBoxes and at the end I have a pushButton. This is repeated exactly 20 times. </p>\n\n<p>Now my program works fine, but I know there is a better way, as I explained in the title my code IS NOT DRY at all and currently looks like this example below:</p>\n\n<p>mainWindow.cpp file</p>\n\n<pre><code>void MainWindow::on_pushButton1_clicked()\n{\n    ui-&gt;lineEdit1-&gt;clear();\n    ui-&gt;lineEdit2-&gt;clear();\n    ui-&gt;comboBox1-&gt;setCurrentIndex(0);\n    ui-&gt;lineEdit3-&gt;clear();\n    ui-&gt;lineEdit4-&gt;clear();\n    ui-&gt;comboBox2-&gt;setCurrentIndex(0);\n}\n</code></pre>\n\n<p>mainWindow.h file</p>\n\n<pre><code>void on_button1_clicked();\n</code></pre>\n\n<p>The above is then repeated 20 times.</p>\n\n<p>The project is basically a register. With 6 columns Name, Type (comboBox), Age, Time in, Time out, Paid(comboBox) and a button.</p>\n\n<p>At the top I have two counters. one is for Total space and the other is for Available. </p>\n\n<p>If name is occupied then Available displays Total space minus 1.\nWhen the reset button is clicked Available obviously adds 1.</p>\n\n<p>I have read <a href=\"http://doc.qt.io/qt-5/qobject.html#\" rel=\"nofollow noreferrer\">QObject Class</a> but I'm a slow, slightly dim learner and really need some help in demonstrating, showing or given a tutorial on how I can use this to DRY up my code. </p>\n\n<p>I apologize if this has been covered before but as I said I don't fully understand what it is I'm trying to look for and I have no idea how to take the information from the link above and put it into my project.</p>\n\n<p>I'm using QT-Creator 4 on a Linux host.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "edited": false, "score": 1, "creation_date": 1498660982, "post_id": 44805411, "comment_id": 76591382, "body": "Why not <code>QString</code>?"}, {"owner": {"reputation": 105, "user_id": 7617879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b34071d94569bac5a5724b03653978f1?s=128&d=identicon&r=PG&f=1", "display_name": "J.A.Norton", "link": "https://stackoverflow.com/users/7617879/j-a-norton"}, "reply_to_user": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "edited": false, "score": 0, "creation_date": 1498720142, "post_id": 44805411, "comment_id": 76616998, "body": "I cant change the char array data in networkMessageBody_t. Other than that I am not opposed to QString, but if I knew how to use it in this case I wouldnt be here ;)"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7617879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b34071d94569bac5a5724b03653978f1?s=128&d=identicon&r=PG&f=1", "display_name": "J.A.Norton", "link": "https://stackoverflow.com/users/7617879/j-a-norton"}, "edited": false, "score": 0, "creation_date": 1498719850, "post_id": 44806120, "comment_id": 76616817, "body": "That works, thank you! But even after looking at the manpage I don&#39;t really understand how that part is returning the size of the data array: <code>std::extent&lt;decltyple(data[i].message.data)&gt;::value</code> Could you elaborate what <code>extent</code> and value is <code>doing</code> here?"}, {"owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "reply_to_user": {"reputation": 105, "user_id": 7617879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b34071d94569bac5a5724b03653978f1?s=128&d=identicon&r=PG&f=1", "display_name": "J.A.Norton", "link": "https://stackoverflow.com/users/7617879/j-a-norton"}, "edited": false, "score": 1, "creation_date": 1498725965, "post_id": 44806120, "comment_id": 76620697, "body": "From <a href=\"http://en.cppreference.com/w/cpp/types/extent\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/types/extent</a>:  template&lt; class T, unsigned N = 0&gt; struct extent; \t\t  If T is an array type, provides the member constant value equal to the number of elements along the Nth dimension of the array  You can replace it with <code>20</code> but this way if you change the size of data the size in extent is adjusted automatically"}], "tags": [], "owner": {"reputation": 971, "user_id": 4124855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zkqyU.jpg?s=128&g=1", "display_name": "IlBeldus", "link": "https://stackoverflow.com/users/4124855/ilbeldus"}, "is_accepted": true, "score": 2, "last_activity_date": 1498661935, "creation_date": 1498661935, "answer_id": 44806120, "question_id": 44805411, "link": "https://stackoverflow.com/questions/44805411/how-to-read-array-from-qdatastream/44806120#44806120", "title": "How to read array from QDataStream", "body": "<p>replace:</p>\n\n<ul>\n<li><code>out &lt;&lt; data[i].message.data;</code> with <code>out &lt;&lt; QByteArray::fromRawData(data[i].message.data,std::extent&lt;decltyple(data[i].message.data)&gt;::value);</code></li>\n<li><code>char tmpChar[20];</code> with <code>QByteArray tmpChar;</code></li>\n<li><code>data[i].message.data = tmpChar;</code> with <code>std::copy(tmpChar.constBegin(),tempChar.constEnd(),data[i].message.data);</code></li>\n</ul>\n"}], "owner": {"reputation": 105, "user_id": 7617879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b34071d94569bac5a5724b03653978f1?s=128&d=identicon&r=PG&f=1", "display_name": "J.A.Norton", "link": "https://stackoverflow.com/users/7617879/j-a-norton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 44806120, "answer_count": 1, "score": 1, "last_activity_date": 1498661935, "creation_date": 1498660115, "question_id": 44805411, "link": "https://stackoverflow.com/questions/44805411/how-to-read-array-from-qdatastream", "title": "How to read array from QDataStream", "body": "<p>I want to write data stored in a vector (holding structs) to a file and also read data from that file. I try to do this with QDataStream and overloading the \">>\" and \"&lt;&lt;\" operators. Everything worked until I added a char array to the struct. \nSomething must be wrong in the way I try to read the string from the QDataStream. I tried different ways to read the string but I always get an error.</p>\n\n<p>Here are the structs:</p>\n\n<pre><code>typedef struct\n{\n   char data[cNetworkMessageLengthMax + 1];   //cNetworkMessageLengthMax=19\n} __attribute__((packed)) networkMessageBody_t;\n\n\ntypedef struct \n{\n    baseStation_daytime_t   timestamp;\n    uint32_t                blueId;\n    networkMessageBody_t    message;\n} __attribute__((packed)) baseStation_mailbox_t;\n</code></pre>\n\n<p>and the operators:</p>\n\n<pre><code>QDataStream &amp;operator&lt;&lt;(QDataStream &amp;out, const std::vector&lt;baseStation_mailbox_t&gt; &amp;data)\n{\n    for(uint8_t i=0; i &lt; data.size(); i++)\n    {\n        out &lt;&lt; data[i].timestamp.time.hour;\n        out &lt;&lt; data[i].timestamp.time.minute;\n        out &lt;&lt; data[i].timestamp.time.second;\n        out &lt;&lt; data[i].timestamp.time.thousandth;\n        out &lt;&lt; data[i].timestamp.date.day;\n        out &lt;&lt; data[i].timestamp.date.month;\n        out &lt;&lt; data[i].timestamp.date.year;\n\n        out &lt;&lt; data[i].blueId;\n\n        out &lt;&lt; data[i].message.data;\n    }\n    return out;\n}\n\nQDataStream &amp;operator&gt;&gt;(QDataStream &amp;in, std::vector&lt;baseStation_mailbox_t&gt; &amp;data)\n{\n    uint16_t tmp16;\n    uint32_t tmp32;\n    char tmpChar[20];\n\n    uint8_t i = 0;\n    while(in.atEnd() == false)\n    {\n        data.emplace_back();\n\n        in &gt;&gt; data[i].timestamp.time.hour;\n        in &gt;&gt; data[i].timestamp.time.minute;\n        in &gt;&gt; data[i].timestamp.time.second;\n        in &gt;&gt; tmp16;\n        data[i].timestamp.time.thousandth = tmp16;\n        in &gt;&gt; data[i].timestamp.date.day;\n        in &gt;&gt; data[i].timestamp.date.month;\n        in &gt;&gt; tmp16;\n        data[i].timestamp.date.year = tmp16;\n\n        in &gt;&gt; tmp32;\n        data[i].blueId = tmp32;\n\n        in &gt;&gt; tmpChar;                 //HERE I get errors\n        data[i].message.data = tmpChar;\n\n        i++;\n    }\n\n    return in;\n    }\n</code></pre>\n"}, {"tags": ["c++", "oop", "design-patterns"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1498659695, "post_id": 44805124, "comment_id": 76590375, "body": "Why is <code>generate</code> not simply the constructor of the derived class?"}, {"owner": {"reputation": 2039, "user_id": 737971, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc56d3a9285353e2a29f9289597005a3?s=128&d=identicon&r=PG", "display_name": "senseiwa", "link": "https://stackoverflow.com/users/737971/senseiwa"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1498659854, "post_id": 44805124, "comment_id": 76590511, "body": "How can I be sure the user implemented a generation that will yield a non null pointer?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1498660032, "post_id": 44805124, "comment_id": 76590663, "body": "Just receive it as a parameter and assert that it is non-null. The derived class can use a function to create it if it wishes so."}, {"owner": {"reputation": 2039, "user_id": 737971, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc56d3a9285353e2a29f9289597005a3?s=128&d=identicon&r=PG", "display_name": "senseiwa", "link": "https://stackoverflow.com/users/737971/senseiwa"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1498660204, "post_id": 44805124, "comment_id": 76590800, "body": "This is possible but changes entirely the semantics, there is no constraint this way on the user&#39;s class, and <code>generate</code> is superfluous: the user can even just write a function, and I would not have a class <code>triangle</code> derived from <code>domain</code>."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1498660361, "post_id": 44805124, "comment_id": 76590908, "body": "Well, your constraint is just &quot;give me a mesh&quot;. That&#39;s covered by a constructor parameter: you can&#39;t even begin constructing a <code>shape</code> without a valid mesh. What&#39;s that about <code>domain</code>?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498660478, "post_id": 44805124, "comment_id": 76591004, "body": "Every shape must have a mesh provided so it makes sense to me that the mesh would be a base class constructor parameter. Then each different shape provides a different mesh and is free to create it as it pleases."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1498660511, "post_id": 44805124, "comment_id": 76591027, "body": "Can&#39;t you <a href=\"https://wandbox.org/permlink/a6lrXFjgUKtpHAGW\" rel=\"nofollow noreferrer\">delegate to another class</a>?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1498662005, "post_id": 44805124, "comment_id": 76592199, "body": "Possibly of interest:  <a href=\"https://stackoverflow.com/questions/1151787/is-there-any-automated-way-to-implement-post-constructor-and-pre-destructor-virt\" title=\"is there any automated way to implement post constructor and pre destructor virt\">stackoverflow.com/questions/1151787/&hellip;</a>"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498662857, "post_id": 44805124, "comment_id": 76592864, "body": "There is a FAQ entry on the isocpp site that addresses just this problem <a href=\"https://isocpp.org/wiki/faq/strange-inheritance#calling-virtuals-from-ctor-idiom\" rel=\"nofollow noreferrer\">isocpp.org/wiki/faq/&hellip;</a>"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 1, "creation_date": 1498662864, "post_id": 44805124, "comment_id": 76592870, "body": "@skypjack you were probably right"}], "answers": [{"comments": [{"owner": {"reputation": 2039, "user_id": 737971, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc56d3a9285353e2a29f9289597005a3?s=128&d=identicon&r=PG", "display_name": "senseiwa", "link": "https://stackoverflow.com/users/737971/senseiwa"}, "edited": false, "score": 0, "creation_date": 1498659969, "post_id": 44805285, "comment_id": 76590603, "body": "I would like to be able to have various subclasses as triangle, square, and yet retain some properties in the base class, for instance, the mesh size."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 2039, "user_id": 737971, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc56d3a9285353e2a29f9289597005a3?s=128&d=identicon&r=PG", "display_name": "senseiwa", "link": "https://stackoverflow.com/users/737971/senseiwa"}, "edited": false, "score": 0, "creation_date": 1498701085, "post_id": 44805285, "comment_id": 76610629, "body": "That&#39;s fine.  Just do what I said and use the mesh you get in the base constructor to assign the base member variables."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 2, "last_activity_date": 1498659822, "creation_date": 1498659822, "answer_id": 44805285, "question_id": 44805124, "link": "https://stackoverflow.com/questions/44805124/oop-design-force-calling-virtual-members-from-constructor/44805285#44805285", "title": "OOP design: force calling virtual members from constructor", "body": "<p>Just change the constructor to take a mesh as an argument.  The derived class will then have to create it.  The construct may as well be protected too.</p>\n"}, {"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": true, "score": 2, "last_activity_date": 1498661356, "creation_date": 1498661356, "answer_id": 44805866, "question_id": 44805124, "link": "https://stackoverflow.com/questions/44805124/oop-design-force-calling-virtual-members-from-constructor/44805866#44805866", "title": "OOP design: force calling virtual members from constructor", "body": "<p>Well, you could fake it with on-demand/lazy construction:</p>\n\n<pre><code>class shape\n{\npublic:\n    shape(std::shared_ptr&lt;configuration&gt; conf) {}\n\n    std::shared_ptr&lt;generated&gt; get_mesh()\n    {\n       if (mesh == nullptr) mesh = create_mesh();\n       return mesh;\n    }\n\nprotected:\n    // Should be implemented to create and return the appropriate mesh object\n    virtual std::shared_ptr&lt;generated&gt; create_mesh()() = 0;\n\nprivate:  \n    // don't access this directly, always call get_mesh() instead!\n    std::shared_ptr&lt;generated&gt; mesh;  \n};\n</code></pre>\n\n<p>The mesh won't be created until the first time someone calls get_mesh(), but as far as the outside world is concerned, the mesh will always be available when it is needed.  (Note that this presumes that your shape class's own constructor doesn't need access to the mesh object; if it does, then John Zwinck's suggestion is probably your only option)</p>\n"}], "owner": {"reputation": 2039, "user_id": 737971, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc56d3a9285353e2a29f9289597005a3?s=128&d=identicon&r=PG", "display_name": "senseiwa", "link": "https://stackoverflow.com/users/737971/senseiwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 44805866, "answer_count": 2, "score": 1, "last_activity_date": 1498662076, "creation_date": 1498659457, "last_edit_date": 1498661174, "question_id": 44805124, "link": "https://stackoverflow.com/questions/44805124/oop-design-force-calling-virtual-members-from-constructor", "title": "OOP design: force calling virtual members from constructor", "body": "<p>I have a problem in a library I am developing. The problem is that, for what I designed, I need to call a pure virtual function from the constructor. But I need to avoid undefined behavior.</p>\n\n<p>This is the design I have a class <code>shape</code> that needs to be used as a sort of interface:</p>\n\n<pre><code>class shape\n{\npublic:\n\n    shape(std::shared_ptr&lt;configuration&gt; conf)\n    { generate(); }\n\n    std::shared_ptr&lt;generated&gt; mesh;\n\nprotected:\n\n    virtual void generate() = 0;\n};\n</code></pre>\n\n<p>The user, as far as I have designed, will write a class that will actually create the mesh. My idea, right now not working, is to force calling the <code>generate</code> method <strong>without the user's intervention</strong>. </p>\n\n<p>In other words, the construction of the derived class <strong>must</strong> create the mesh. If I leave it to the user, the explicit call to <code>generate</code> could be forgotten and will result in some weird and destructive behavior that won't be noticed until really later (this should <strong>never happen</strong> for this library). I was thinking also of using CRTP or something from TMP but I cannot devise anything that is similar in simplicity to the above code.</p>\n\n<p>Note that this <strong>is not a runtime requirement</strong>, but a compile-time one.</p>\n\n<p>How can I design the base class and eliminate the possibility of forgetting one call?</p>\n\n<p>Any suggestions are more than welcome!</p>\n"}, {"tags": ["c++", "arrays", "vector", "equality"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1498659316, "post_id": 44805020, "comment_id": 76590052, "body": "Both of these approaches will work with <code>std::vector</code> and <code>std::array</code>. Your examples don&#39;t seem to support your question."}, {"owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1498659679, "post_id": 44805020, "comment_id": 76590363, "body": "@Fran&#231;oisAndrieux Yes, sorry. I edited the <code>std::vector</code> example to make it a <code>for</code> loop."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1498659786, "post_id": 44805020, "comment_id": 76590455, "body": "So what is the difference between those two code samples now? It&#39;s unclear what you are asking"}, {"owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1498659879, "post_id": 44805020, "comment_id": 76590533, "body": "@UnholySheep My question is is it better to use an <code>std::array</code> or <code>std::vector</code> for comparison if i already know the number of elements beforehand. There is no difference other than one is an <code>std::array</code> and one is a <code>std::vector</code>."}, {"owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 3, "creation_date": 1498659945, "post_id": 44805020, "comment_id": 76590584, "body": "What does better mean?"}], "answers": [{"comments": [{"owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1498660320, "post_id": 44805353, "comment_id": 76590875, "body": "I never used <code>std::adjacent_find</code> before but saw it in a question about element comparison for <code>std::vector</code> and assumed it was a function only available to <code>std::vector</code>, but Ill read up on it and switch from loops to <code>std::adjacent_find</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1498660639, "post_id": 44805353, "comment_id": 76591132, "body": "@Javia1492 Standard algorithms generally operate on iterators and do not care about the actual container type. Each algorithm has requirements on the iterators it accepts and as long as your container&#39;s iterators meets these requirements, the algorithm will work with your container. This is also true for user implemented containers, provided your container&#39;s iterators are properly implemented. See <a href=\"http://en.cppreference.com/w/cpp/concept/Iterator\" rel=\"nofollow noreferrer\">Iterator concept</a>."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1498660692, "post_id": 44805353, "comment_id": 76591168, "body": "<i>No dynamic allocation</i> ... this can also be a <b>disadvantage</b> of <code>std::array</code>: it can cause a stack overflow if your data doesn&#39;t fit into stack space. Stack usually is limited to a fixed size configured at compile time (for instance, default size used by MSVC is just 1 MiB)."}, {"owner": {"reputation": 255, "user_id": 6877265, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xlbe5.png?s=128&g=1", "display_name": "cppxor2arr", "link": "https://stackoverflow.com/users/6877265/cppxor2arr"}, "reply_to_user": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1498661195, "post_id": 44805353, "comment_id": 76591544, "body": "@Javia1492 <code>std::vector is a sequence container that encapsulates dynamic size arrays</code> You don&#39;t need a &quot;dynamic size array&quot; here."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498661766, "post_id": 44805353, "comment_id": 76592009, "body": "<i>but idiomatic C++ suggests minimal use of explicit loops</i> not really the case IMO, it all depends on the user&#39;s comfort.  Range based for loops work better than most <code>for_each</code> methods and the like.  For simple things explicit loops can often be good enough and idiomatic.  Even more the case for things like <code>istream</code> input and the like"}, {"owner": {"reputation": 20670, "user_id": 26039, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15aacb48f4c894a6341e1013e9b5a42f?s=128&d=identicon&r=PG", "display_name": "eran", "link": "https://stackoverflow.com/users/26039/eran"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498663264, "post_id": 44805353, "comment_id": 76593186, "body": "@Curious I&#39;m not a purist, and I don&#39;t think using a tight for loop like this is a big issue. I mentioned it since the initial question contained both patterns, and simple cases like this are a good place to get used to avoiding explicit loops."}], "tags": [], "owner": {"reputation": 20670, "user_id": 26039, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15aacb48f4c894a6341e1013e9b5a42f?s=128&d=identicon&r=PG", "display_name": "eran", "link": "https://stackoverflow.com/users/26039/eran"}, "is_accepted": true, "score": 4, "last_activity_date": 1498660204, "last_edit_date": 1498660204, "creation_date": 1498659951, "answer_id": 44805353, "question_id": 44805020, "link": "https://stackoverflow.com/questions/44805020/is-it-better-to-check-if-all-elements-are-equal-in-an-array-or-a-vector-if-the-n/44805353#44805353", "title": "Is it better to check if all elements are equal in an array or a vector if the number of elements is already known?", "body": "<p>If you know the size at compile time, use <code>std::array</code>. It has two advantages:</p>\n\n<ol>\n<li>No dynamic allocation (and accordingly, also no pointer dereference accessing the internal array).</li>\n<li>The value of <code>size()</code> is known at compile time, making it easier for the compiler to optimize. For instance, a short loop with only 5 iterations will probably be unrolled, eliminating conditional branches.</li>\n</ol>\n\n<p>Btw, your edit that made the two checks similar makes your question more focused and that's good, but idiomatic C++ suggests minimal use of explicit loops. So the <code>std::adjacent_find</code> was even better, and could be used on both containers.</p>\n"}, {"comments": [{"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 1, "creation_date": 1498661714, "post_id": 44805811, "comment_id": 76591979, "body": "Also provides more control over when objects are constructed and destroyed.  <code>std::array</code> has to create all its instances on initialization"}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 1, "creation_date": 1498662099, "post_id": 44805811, "comment_id": 76592274, "body": "@Curious: Good call. Added."}, {"owner": {"reputation": 20670, "user_id": 26039, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15aacb48f4c894a6341e1013e9b5a42f?s=128&d=identicon&r=PG", "display_name": "eran", "link": "https://stackoverflow.com/users/26039/eran"}, "edited": false, "score": 0, "creation_date": 1498663469, "post_id": 44805811, "comment_id": 76593353, "body": "While at it, you can also mention that if the array is beyond a certain size (probably way smaller than the size that will overflow the stack), the compiler will generate a loop anyway, since unrolling will generate too much code."}], "tags": [], "owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "is_accepted": false, "score": 4, "last_activity_date": 1498662072, "last_edit_date": 1498662072, "creation_date": 1498661219, "answer_id": 44805811, "question_id": 44805020, "link": "https://stackoverflow.com/questions/44805020/is-it-better-to-check-if-all-elements-are-equal-in-an-array-or-a-vector-if-the-n/44805811#44805811", "title": "Is it better to check if all elements are equal in an array or a vector if the number of elements is already known?", "body": "<p>Since eran listed the advantages of <code>std::array</code> I will list the advantages of <code>std::vector</code>.</p>\n\n<ol>\n<li>It is faster to move. The move constructor/assignment operator of a <code>std::vector</code> is little more than the copy of a few pointers (an O(1) operation). Moving a <code>std::array</code> requires moving each individual element (an O(n) operation).</li>\n<li>It is less likely to cause a stack overflow. No matter how many elements a <code>std::vector</code> has, it will only keep a small footprint on the stack. The elements of a <code>std::array</code> are part of the object itself, so if it is on the stack, then all of its elements are on the stack. This is probably not a problem if you only have 5 elements, like you said.</li>\n<li>It provides more control over when objects are constructed and destroyed. <code>std::array</code> has to create all its instances on initialization. This can be particularly inconvenient when your type doesn't have a default constructor, as you will be required to type out all of the initializations individually. With a <code>std::vector</code>, you can do the constructions in a loop, or at your leisure.</li>\n</ol>\n"}], "owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 44805353, "answer_count": 2, "score": 2, "last_activity_date": 1498662072, "creation_date": 1498659222, "last_edit_date": 1498659972, "question_id": 44805020, "link": "https://stackoverflow.com/questions/44805020/is-it-better-to-check-if-all-elements-are-equal-in-an-array-or-a-vector-if-the-n", "title": "Is it better to check if all elements are equal in an array or a vector if the number of elements is already known?", "body": "<p>If you already know the number of elements you want to do comparisons on (in my case, 5), is it better to use <code>std::array</code> or <code>std::vector</code>?</p>\n\n<pre><code>for(int i=1; i&lt;a.size(); i++)\n   if(a[0] != a[i]){\n      std::cout &lt;&lt; \"One or more elements are not equal\" &lt;&lt; std::endl;\n      break;\n   }\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>for(int i=1; i&lt;myvector.size(); i++)\n   if(myvector[0] != myvector[i]){\n      std::cout &lt;&lt; \"One or more elements are not equal\" &lt;&lt; std::endl;\n      break;\n   }\n}\n</code></pre>\n\n<p>The only difference is one uses <code>std::array</code> and the other uses <code>std::vector</code>, but is there a reason to use one over the other in this case given you know the specific number of elements?</p>\n"}, {"tags": ["c++", "templates", "boost", "template-meta-programming"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1498659457, "post_id": 44804975, "comment_id": 76590190, "body": "A <code>std::vector</code> is homogeneous by definition (even if its value type is a variant which type-erases the actual content). So you can&#39;t pry the type back out. The only heterogeneous container (or &quot;container&quot;, as it does not meet the <code>Container</code> requirements) is <code>std::tuple</code>."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 1, "creation_date": 1498659573, "post_id": 44804975, "comment_id": 76590269, "body": "Also see <a href=\"https://gieseanw.wordpress.com/2017/05/03/a-true-heterogeneous-container-in-c/\" rel=\"nofollow noreferrer\">gieseanw.wordpress.com/2017/05/03/&hellip;</a>, this was one of the most interesting C++ articles I have read, seems to be a little relevant, although it does not solve your problem"}], "answers": [{"comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1501961229, "post_id": 44805412, "comment_id": 78011365, "body": "I&#39;m flattered :-). One thing I&#39;d like to add (and should perhaps edit the post to be more explicit about) is that the performance of visiting &quot;heterogeneous container&quot; absolutely smashes performance of std::any (due to all the any_cast&#39;s that go on)."}], "tags": [], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "is_accepted": true, "score": 2, "last_activity_date": 1498660116, "creation_date": 1498660116, "answer_id": 44805412, "question_id": 44804975, "link": "https://stackoverflow.com/questions/44804975/return-templated-type-from-container-of-heterogeneous-templated-values/44805412#44805412", "title": "Return templated type from container of heterogeneous templated values", "body": "<p>This brilliant article talks about how the visitor pattern can be used with type erased base objects like <code>std::any</code> <a href=\"https://gieseanw.wordpress.com/2017/05/03/a-true-heterogeneous-container-in-c/\" rel=\"nofollow noreferrer\">https://gieseanw.wordpress.com/2017/05/03/a-true-heterogeneous-container-in-c/</a>, so if you use the concepts talked in there, you can in theory get to use the visitor pattern with a homogenous container.  </p>\n\n<hr>\n\n<p>Your goal of getting code like this </p>\n\n<pre><code>// typeid(val_one).name() is \nauto val_one = homogenous_container[runtime_value_one]; \n// typeid(val_two).name() is `double`\nauto val_two = homogenous_container[runtime_value_two]; \n</code></pre>\n\n<p>cannot be achieved, <code>auto</code> type deduction happens at compile time, there is no way to have it bind to a runtime condition and change the type based on that.  </p>\n\n<p>The closest you can come to this is to use <code>std::variant</code> and use the visitor pattern.  You cannot bind a compile time deduced type to an arbitrary runtime type.  They are just different concepts and exist at different times in the C++ compile/runtime.</p>\n\n<p>Type erasure will allow you to achieve some functionality like this, but it requires that your container is composed of types that share some common interface.  For example in the case of <code>std::function</code> the types for which the type can be erased are required to be callable based on the signature of the template argument for <code>std::function</code></p>\n"}], "owner": {"reputation": 3, "user_id": 4155140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ebtEygN524Y/AAAAAAAAAAI/AAAAAAAAAGg/WA1uO7YgQ5M/photo.jpg?sz=128", "display_name": "Scott Nykl", "link": "https://stackoverflow.com/users/4155140/scott-nykl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 44805412, "answer_count": 1, "score": 0, "last_activity_date": 1498660116, "creation_date": 1498659139, "question_id": 44804975, "link": "https://stackoverflow.com/questions/44804975/return-templated-type-from-container-of-heterogeneous-templated-values", "title": "Return templated type from container of heterogeneous templated values", "body": "<p>I am placing instances of a templated class containing heterogeneous template values into a container, such as a std::vector. When accessing a particular element from said vector, I require that the precise templated type is returned, not just the base pointer <code>WrapperBase*</code> . I've dabbled with boost::any, boost::variant, and the base class / templated child class as shown below. A compile time solution would be ideal (perhaps some meta templating magic); otherwise, a runtime RTTI-based solution would suffice.</p>\n\n<p>In a perfect world, I could do something like this:</p>\n\n<pre><code>vector&lt; WrapperBase &gt; v;\nv.push_back( Wrapper&lt;int&gt;{1} );\nv.push_back( Wrapper&lt;float&gt;{3.14f} );\nauto v = vector[0].get(); //typeid( decltype( v) ).name() would be \"int\"\nauto v = vector[1].get(); //typeid( decltype( v) ).name() would be \"float\"\n</code></pre>\n\n<p>Boost variant almost provided a solution; however, I can only access the specific type within the <code>operator()()</code> method and cannot return it. The type will be consumed by further functions, so I am not able to have the visitor method perform the desired work.</p>\n\n<p>This code is available <a href=\"http://coliru.stacked-crooked.com/a/5a44681322cdbd77\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/5a44681322cdbd77</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n#include &lt;vector&gt;\n#include &lt;boost/variant.hpp&gt;\n#include &lt;boost/any.hpp&gt;\n\nstruct WrapperBase\n{\n   template&lt; typename T &gt;\n   T* get();\n};\n\ntemplate&lt; typename T &gt;\nstruct Wrapper : WrapperBase\n{\n   Wrapper( T* t ) : WrapperBase(), _val( t ) {}\n   T* get() { return _val; }\n   T* _val;\n};\n\ntemplate&lt; typename T &gt;\nT* WrapperBase::get()\n{\n   return static_cast&lt;Wrapper&lt;T&gt;&gt;( this )-&gt;get();\n}\n\nstruct Visitor : boost::static_visitor&lt;int&gt; //sadly, we can only return ints :(.\n{\n   int operator()( Wrapper&lt;int&gt;&amp; b ) const\n   {\n      auto bType = *b.get();\n      std::cout &lt;&lt; \"b type is \" &lt;&lt; typeid( decltype( bType ) ).name() &lt;&lt; \"... Val is \" &lt;&lt; bType &lt;&lt; \"...\\n\";\n      return 2;\n   }\n\n   int operator()( Wrapper&lt;float&gt;&amp; b ) const\n   {\n      auto bType = *b.get();\n      std::cout &lt;&lt; \"b type is \" &lt;&lt; typeid( decltype( bType ) ).name() &lt;&lt; \"... Val is \" &lt;&lt; bType &lt;&lt; \"...\\n\";\n      return 6;\n   }\n\n   int operator()( Wrapper&lt;std::string&gt;&amp; b ) const\n   {\n      auto bType = *b.get();\n      std::cout &lt;&lt; \"b type is \" &lt;&lt; typeid( decltype( bType ) ).name() &lt;&lt; \"... Val is \" &lt;&lt; bType &lt;&lt; \"...\\n\";\n      return 12345;\n   }\n\n};\n\nint main( int argc, char* args[] )\n{\n   std::cout &lt;&lt; \"Hello World...\\n\";\n\n   int ia = 5;\n   Wrapper&lt;int&gt; a{ &amp;ia };\n\n   float fb = 3.1415f;\n   Wrapper&lt;float&gt; b{ &amp;fb };\n\n   std::string s = \"testing this...\\n\";\n   Wrapper&lt;std::string&gt; c{ &amp;s };\n\n   auto aType = *a.get(); //aType is \"int\"\n   std::cout &lt;&lt; \"a type is \" &lt;&lt; typeid( decltype( aType ) ).name() &lt;&lt; \"... Val is \" &lt;&lt; aType &lt;&lt; \"...\\n\";\n\n   auto bType = *b.get(); //aType is \"float\"\n   std::cout &lt;&lt; \"b type is \" &lt;&lt; typeid( decltype( bType ) ).name() &lt;&lt; \"... Val is \" &lt;&lt; bType &lt;&lt; \"...\\n\";\n\n   auto cType = *c.get(); //aType is \"std::string\"\n   std::cout &lt;&lt; \"c type is \" &lt;&lt; typeid( decltype( cType ) ).name() &lt;&lt; \"... Val is \" &lt;&lt; cType &lt;&lt; \"...\\n\";\n\n   std::vector&lt; boost::any &gt; vec;\n\n   vec.push_back( &amp;a );\n   vec.push_back( &amp;b );\n   vec.push_back( &amp;c );\n\n   //for( int i = 0; i &lt; vec.size() ; i++ )\n   //{\n   //In my actual code, I have no way of knowing I need to cast to &lt;int&gt; and therefore cannot cast.\n   //   auto t = boost::any_cast&lt;Wrapper&lt;int&gt;*&gt;( vec[i] );\n   //   std::cout &lt;&lt; \"[\" &lt;&lt; i &lt;&lt; \"] type is \" &lt;&lt; typeid( decltype( t ) ).name() &lt;&lt; \"... Val is \" &lt;&lt; t &lt;&lt; \"...\\n\";    \n   //}    \n   std::cout &lt;&lt; \"...\\n...\\n...\\n\";\n\n   using VAR = boost::variant&lt; Wrapper&lt;int&gt;, Wrapper&lt;float&gt;, Wrapper&lt;std::string&gt; &gt;;\n\n   std::vector&lt; VAR &gt; myVar;\n   myVar.push_back( a );\n   myVar.push_back( b );\n   myVar.push_back( c );\n   for (int i = 0; i &lt; myVar.size() ; i++)\n   {\n      auto v = myVar[i];\n      //apply_visitor is VERY close to what I want - I have precise type, but only within operator()()\n      std::cout &lt;&lt; boost::apply_visitor( Visitor(), v ) &lt;&lt; \"\\n\";\n   }\n\n   std::cout &lt;&lt; \"...\\n...\\n...\\n\";\n\n   std::vector&lt; WrapperBase &gt; v;\n   v.push_back( a );\n   v.push_back( b );\n   v.push_back( c );\n\n   //for (int i = 0; i &lt; v.size() ; i++)\n   //{\n   //   auto t = v[i].get&lt;int&gt;(); //same problem as boost::any, but instead I have pointer to base class\n   //   std::cout &lt;&lt; \"[\"&lt;&lt;i&lt;&lt;\"] type is \" &lt;&lt; typeid( decltype( t )).name() &lt;&lt; \"... Val is \" &lt;&lt; t &lt;&lt; \"...\\n\";\n   //   \n   //}\n\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "opencv", "vector"], "comments": [{"owner": {"reputation": 2837, "user_id": 6730448, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68eebbe4b190040ef1201b845374a7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Rick M.", "link": "https://stackoverflow.com/users/6730448/rick-m"}, "edited": false, "score": 0, "creation_date": 1498661547, "post_id": 44804820, "comment_id": 76591823, "body": "So you want to multiply <code>std::vector&lt;cv::Point3f&gt;</code> with an inverse of <code>cv::Mat</code> and do you want result to be a Mat or it doesn&#39;t matter?"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "reply_to_user": {"reputation": 2837, "user_id": 6730448, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68eebbe4b190040ef1201b845374a7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Rick M.", "link": "https://stackoverflow.com/users/6730448/rick-m"}, "edited": false, "score": 0, "creation_date": 1498661824, "post_id": 44804820, "comment_id": 76592055, "body": "Ideally, the result would be a new std::vector&lt;point3f&gt;. Thank you for your reply."}, {"owner": {"reputation": 2837, "user_id": 6730448, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68eebbe4b190040ef1201b845374a7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Rick M.", "link": "https://stackoverflow.com/users/6730448/rick-m"}, "edited": false, "score": 0, "creation_date": 1498662022, "post_id": 44804820, "comment_id": 76592211, "body": "Ideally, <code>cv::Mat V = T.inv() * cv::Mat(objectPoints, false)  V.copyTo(cv::Mat(objectPoints, false));</code> should work. Can you add the type of Mat?"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "reply_to_user": {"reputation": 2837, "user_id": 6730448, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68eebbe4b190040ef1201b845374a7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Rick M.", "link": "https://stackoverflow.com/users/6730448/rick-m"}, "edited": false, "score": 0, "creation_date": 1498662165, "post_id": 44804820, "comment_id": 76592323, "body": "It uses the same type as <code>rvec</code>, which i initialize as: <code>cv::Mat rvec(3, 1, cv::DataType&lt;float&gt;::type);</code>"}, {"owner": {"reputation": 2837, "user_id": 6730448, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68eebbe4b190040ef1201b845374a7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Rick M.", "link": "https://stackoverflow.com/users/6730448/rick-m"}, "edited": false, "score": 1, "creation_date": 1498663355, "post_id": 44804820, "comment_id": 76593267, "body": "I think the problem is you are trying to multiply a 4*4 matrix with a n*3 (<code>cv::Point3f</code> converted to <code>Mat</code>) which will not work"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "reply_to_user": {"reputation": 2837, "user_id": 6730448, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68eebbe4b190040ef1201b845374a7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Rick M.", "link": "https://stackoverflow.com/users/6730448/rick-m"}, "edited": false, "score": 0, "creation_date": 1498663882, "post_id": 44804820, "comment_id": 76593675, "body": "hmmm ok. How can i get around this? can I just use <code>rvec</code> and <code>tvec</code> for this? Or should I add another <code>0</code> column to the Mat?"}, {"owner": {"reputation": 2837, "user_id": 6730448, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68eebbe4b190040ef1201b845374a7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Rick M.", "link": "https://stackoverflow.com/users/6730448/rick-m"}, "edited": false, "score": 0, "creation_date": 1498666791, "post_id": 44804820, "comment_id": 76595759, "body": "I see that you are making the matrix homogeneous by adding 1&#39;s at the bottom. If the <code>std::vector</code> isn&#39;t too big, why don&#39;t you multiply element-wise <b>without</b> homogeneous coordinates?"}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "reply_to_user": {"reputation": 2837, "user_id": 6730448, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68eebbe4b190040ef1201b845374a7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Rick M.", "link": "https://stackoverflow.com/users/6730448/rick-m"}, "edited": false, "score": 0, "creation_date": 1498667002, "post_id": 44804820, "comment_id": 76595884, "body": "So i would make it <code>cv::Mat T(3, 4, R.type());</code>? can you explain &#39;element wise&#39; please? t"}], "answers": [{"comments": [{"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1498667662, "post_id": 44808079, "comment_id": 76596293, "body": "Thank you! This gives me a crash at <code>cv::Mat_&lt;float&gt; dstMat(T.inv() * ptMat);</code>, with:     <code>OpenCV Error: Assertion failed (type == _src2.type() &amp;&amp; (type == CV_32F || type == CV_64F)) in cv::solve, file D:\\thirdParty\\opencv_320\\opencv-master\\modules\\co re\\src\\lapack.cpp, line 1094</code>"}, {"owner": {"reputation": 319, "user_id": 8226830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMxPt.jpg?s=128&g=1", "display_name": "DCSmith", "link": "https://stackoverflow.com/users/8226830/dcsmith"}, "reply_to_user": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1498667948, "post_id": 44808079, "comment_id": 76596484, "body": "Darn. Had a feeling that casting wouldn&#39;t work. What happens when you just do <code>cv::Mat dstMat = T.inv() * ptMat;</code> ? Does this line fail?"}, {"owner": {"reputation": 319, "user_id": 8226830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMxPt.jpg?s=128&g=1", "display_name": "DCSmith", "link": "https://stackoverflow.com/users/8226830/dcsmith"}, "reply_to_user": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1498669190, "post_id": 44808079, "comment_id": 76597246, "body": "Looking more closely at the error, it seems to be an issue with types in the matrix multiplication. So I&#39;d check the types of T and ptMat to ensure that they are the same and are either 32-bit or 64-bit floats."}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1498669747, "post_id": 44808079, "comment_id": 76597573, "body": "ok! changing the <code>T</code> initialization to : <code>cv::Mat T(4, 4, cv::DataType&lt;float&gt;::type);</code> has it compiling, but the resulting values are:  <code>-nan(ind) -nan(ind) -nan(ind)</code>"}, {"owner": {"reputation": 319, "user_id": 8226830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMxPt.jpg?s=128&g=1", "display_name": "DCSmith", "link": "https://stackoverflow.com/users/8226830/dcsmith"}, "reply_to_user": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1498670127, "post_id": 44808079, "comment_id": 76597813, "body": "Yikes... Would you print out the matrix <code>T.inv()</code>? I have a feeling that the <code>T</code> is an ill-conditioned matrix... If <code>T.inv()</code> is defined, I&#39;d print out the values you get for <code>scale</code> to ensure that they aren&#39;t zero."}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1498670269, "post_id": 44808079, "comment_id": 76597888, "body": "hmmm, strange. <code>rvec</code> and <code>tvec</code> print what i would expect. <code>R</code> prints as expected, but <code>T</code> prints a zero Matrix."}, {"owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "edited": false, "score": 0, "creation_date": 1498670325, "post_id": 44808079, "comment_id": 76597933, "body": "If i undo the float initialization, I get T:   ` 0.001330603394833468, 0.9999951264159792, 0.00282429440665495, -3.5873389976501 85e-05;  0.04408990169842637, -0.002880216454657183, 0.9990234156021557, -0.002968000196 168561;  0, 0.0078125, 1.076858045122215e-65, 5.616881825382601e-85]  ` ... but the Assertion error."}], "tags": [], "owner": {"reputation": 319, "user_id": 8226830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMxPt.jpg?s=128&g=1", "display_name": "DCSmith", "link": "https://stackoverflow.com/users/8226830/dcsmith"}, "is_accepted": true, "score": 3, "last_activity_date": 1498671415, "last_edit_date": 1498671415, "creation_date": 1498667466, "answer_id": 44808079, "question_id": 44804820, "link": "https://stackoverflow.com/questions/44804820/multiply-stdvectorcvpoint3f-by-a-cvmat/44808079#44808079", "title": "Multiply std::vector&lt;cv::Point3f&gt; by a cv::Mat?", "body": "<p>As Rick M. pointed out, you're trying to multiply a 4x4 matrix with a length-3 point. To perform a transformation with just one matrix multiplication (i.e. with the 4x4 combined R-T matrix), you first have to represent the point in homogeneous coordinates, which essentially just involves tacking on a 1 as the 4th element of your point; after the transformation, you divide the new point by the 4th element to maintain its value as a 1. <a href=\"http://inside.mines.edu/~whoff/courses/EENG512/lectures/04-3Dto3DTransforms.pdf\" rel=\"nofollow noreferrer\">Here's</a> a nice source on 3D-3D transformations, with homogeneous coordinates discussed on slide 14.</p>\n\n<p>Since OpenCV doesn't have a Point4f class, you'll have to add this 1 when you're creating the Mat form of the point. This is untested but might work:</p>\n\n<pre><code>std::vector&lt;cv::Point3f&gt; dstPoint;\nfor (int i = 0; i &lt; objectPoints.size(); i++) {\n    // Convert Point3f to 4x1 Mat (in homogeneous coordinates, with 1 as 4th element)\n    cv::Point3f pt = objectPoints[i];\n    cv::Mat ptMat = (cv::Mat_&lt;float&gt;(4,1) &lt;&lt; pt.x, pt.y, pt.z, 1);\n\n    // Perform matrix multiplication and store as Mat_ for easy element access\n    cv::Mat_&lt;float&gt; dstMat(T.inv() * ptMat); \n\n    // Divide first three resulting elements by the 4th (homogenizing \n    // the point) and store as Point3f\n    float scale = dstMat(0,3);\n    cv::Point3f dst(dstMat(0,0)/scale, dstMat(0,1)/scale, dstMat(0,2)/scale);\n    dstPoints.push_back(dst)\n}\n</code></pre>\n\n<p>Would test, but I'm at work and don't have OpenCV on this computer. </p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>When copying to T, try this instead:</p>\n\n<pre><code>cv::Mat T(4, 4, cv::DataType&lt;float&gt;::type);\ncv::Mat rot   = T(cv::Range(0, 3), cv::Range(0, 3));\ncv::Mat trans = T(cv::Range(0, 3), cv::Range(3, 4));\nR.copyTo(rot);\ntvec.copyTo(trans);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "is_accepted": false, "score": 1, "last_activity_date": 1498726364, "creation_date": 1498726364, "answer_id": 44820472, "question_id": 44804820, "link": "https://stackoverflow.com/questions/44804820/multiply-stdvectorcvpoint3f-by-a-cvmat/44820472#44820472", "title": "Multiply std::vector&lt;cv::Point3f&gt; by a cv::Mat?", "body": "<p>Based on the answer by DCSmith, I have it working. I had to make this small change:</p>\n\n<pre><code>cv::Mat T(4, 4, cv::DataType&lt;float&gt;::type);\nR.copyTo(T(cv::Rect(0, 0, 3, 3)));\ntvec.copyTo(T(cv::Rect(3, 0, 1, 3)));\n</code></pre>\n\n<p>To make the entire function look like:</p>\n\n<pre><code>std::vector&lt;cv::Point3f&gt; p3d;\n\ncv::Mat R(3,3, cv::DataType&lt;float&gt;::type);\ncv::Rodrigues(rvec, R); // R is 3x3\ncv::Mat T(4, 4, cv::DataType&lt;float&gt;::type);\n\nR.copyTo(T(cv::Rect(0, 0, 3, 3)));\ntvec.copyTo(T(cv::Rect(3, 0, 1, 3)));\n\nfloat *p = T.ptr&lt;float&gt;(3);\np[0] = p[1] = p[2] = 0; p[3] = 1;\n\n\nstd::vector&lt;cv::Point3f&gt; dstPoint;\nfor (int i = 0; i &lt; objectPoints.size(); i++) {\n    cv::Point3f pt = objectPoints[i];\n    cv::Mat ptMat = (cv::Mat_&lt;float&gt;(4, 1) &lt;&lt; pt.x, pt.y, pt.z, 1);\n\n    // Perform matrix multiplication and store as Mat_ for easy element access\n    cv::Mat_&lt;float&gt; dstMat = T.inv() * ptMat;\n\n    // Divide first three resulting elements by the 4th (homogenizing \n    // the point) and store as Point3f\n    float scale = dstMat(0, 3);\n    cv::Point3f dst(dstMat(0, 0) / scale, dstMat(0, 1) / scale, dstMat(0, 2) / scale);\n    p3d.push_back(dst);\n}\n</code></pre>\n\n<p>Thank you for your help!</p>\n"}], "owner": {"reputation": 2515, "user_id": 4402282, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da4a7e4605c83a82650272b0ea4d3401?s=128&d=identicon&r=PG&f=1", "display_name": "anti", "link": "https://stackoverflow.com/users/4402282/anti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2509, "favorite_count": 0, "accepted_answer_id": 44808079, "answer_count": 2, "score": 1, "last_activity_date": 1498726364, "creation_date": 1498658751, "question_id": 44804820, "link": "https://stackoverflow.com/questions/44804820/multiply-stdvectorcvpoint3f-by-a-cvmat", "title": "Multiply std::vector&lt;cv::Point3f&gt; by a cv::Mat?", "body": "<p>as above, I have a std::vector of cv::Point3f. I have a transformation matrix. I need to multiply the vector by the inverse of the Mat.</p>\n\n<p>My Mat: (<code>T</code> is the resulting transformation)</p>\n\n<pre><code>cv::Mat R(3,3,rvec.type());\ncv::Rodrigues(rvec, R); // R is 3x3\ncv::Mat T(4, 4, R.type()); // T is 4x4\nT(cv::Range(0, 3), cv::Range(0, 3)) = R * 1; // copies R into T\nT(cv::Range(0, 3), cv::Range(3, 4)) = tvec * 1; // copies tvec into T\nfloat *p = T.ptr&lt;float&gt;(3);\np[0] = p[1] = p[2] = 0; p[3] = 1;\n</code></pre>\n\n<p>my vector:</p>\n\n<p><code>std::vector&lt;cv::Point3f&gt; objectPoints;</code></p>\n\n<p>I have tried:</p>\n\n<pre><code>cv::Mat V = T.inv() * cv::Mat(objectPoints, false) \nV.copyTo(cv::Mat(objectPoints, false));\n</code></pre>\n\n<p>(Assertion failed, type error)</p>\n\n<pre><code>for (int i = 0; i &lt; objectPoints.size(); i++)\n{\n    cv::Mat dst = cv::Mat(objectPoints[i], false);  \n    dst = -T*dst; //USE MATRIX ALGEBRA \n//  cv::Point3f tmp3 = cv::Point3f(dst(0, 0), dst(1, 0), dst(2, 0));\n\n}\n</code></pre>\n\n<p>(Assertion failed)</p>\n\n<pre><code>    std::vector&lt;cv::Point3f&gt; p3d;\nperspectiveTransform(objectPoints, p3d, -T);\n</code></pre>\n\n<p>(runs, but the values are very incorrect)</p>\n\n<p><code>cv::transform(objectPoints, p3d, -T);</code></p>\n\n<p>(Assertion error)</p>\n\n<p>What is the correct way (if there is a way!) to do this?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "c++11", "vector", "stl"], "comments": [{"owner": {"reputation": 17031, "user_id": 185915, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/207045374ab195353388d9fcc77af9c5?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/185915/chad"}, "edited": false, "score": 3, "creation_date": 1498658813, "post_id": 44804798, "comment_id": 76589653, "body": "<code>std::vector::resize()</code> should <i>not</i> reduce the capacity.  See:  <a href=\"http://en.cppreference.com/w/cpp/container/vector/resize\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/vector/resize</a>"}, {"owner": {"reputation": 1541, "user_id": 3503769, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/L3Yh2.jpg?s=128&g=1", "display_name": "Anoroah", "link": "https://stackoverflow.com/users/3503769/anoroah"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1498659228, "post_id": 44804798, "comment_id": 76589973, "body": "@StoryTeller It seems that this is true. But it it possible to configure when this is going to happen?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1498659654, "post_id": 44804798, "comment_id": 76590342, "body": "@imoutidi - Not really. It must happen when the capacity is reached, of course. But vectors aren&#39;t supposed to <i>lose</i> capacity very easily."}, {"owner": {"reputation": 1541, "user_id": 3503769, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/L3Yh2.jpg?s=128&g=1", "display_name": "Anoroah", "link": "https://stackoverflow.com/users/3503769/anoroah"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1498659978, "post_id": 44804798, "comment_id": 76590611, "body": "@StoryTeller Yes you are right. As Chad commented the reference says &quot;Vector capacity is never reduced when resizing to smaller size because that would invalidate all iterators, rather than only the ones that would be invalidated by the equivalent sequence of pop_back() calls. &quot; As Peter answered the problem is that the iterator is a copy. Applying Peters solution solved my problem."}], "answers": [{"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1498661785, "post_id": 44805075, "comment_id": 76592029, "body": "or <code>auto&amp;&amp;</code>, which just works everywhere and never makes needless copies."}, {"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1498676807, "post_id": 44805075, "comment_id": 76601760, "body": "@Yakk  Just to clarify, <code>auto&amp;&amp;</code> can&#39;t be used when you need to mutate the container elements can it?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1498678400, "post_id": 44805075, "comment_id": 76602622, "body": "@MarkB Define &quot;can&#39;t be used&quot;.  It doesn&#39;t guarantee the container elements are mutable through it.  But if they are mutable, it would work.  In addition, if you have a vector of bool, only <code>auto&amp;&amp;</code> is going to work (and it will permit mutation)."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1498733054, "post_id": 44805075, "comment_id": 76625638, "body": "Yes, <code>auto &amp;&amp;</code> is an alternative.   I prefer code to be explicit that the loop is working with a <code>const</code> reference though - although I admit that is a stylistic preference.   I also tend to prefer avoiding using <code>std::vector&lt;bool&gt;</code> (which means I don&#39;t have that motivation to use <code>auto &amp;&amp;</code>) since it doesn&#39;t provide all capabilities of <code>std::vector</code> - I don&#39;t generally need to optimisations it provides."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1498829938, "post_id": 44805075, "comment_id": 76676196, "body": "@peter <code>for(auto&amp;&amp; e:range( input_iterator(file) ))</code> -- any <code>input_iterator</code> can return a proxy reference or a value as well!  And an <code>input_iterator</code> that permits writing back to elements is useful for filter ranges."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": true, "score": 6, "last_activity_date": 1498659344, "creation_date": 1498659344, "answer_id": 44805075, "question_id": 44804798, "link": "https://stackoverflow.com/questions/44804798/is-it-possible-that-resizing-an-stdvector-reduces-its-capacity/44805075#44805075", "title": "Is it possible that resizing an std::vector reduces its capacity?", "body": "<p>When creating a copy of a vector, the copy will have the same size but not necessarily the same capacity as the original.</p>\n\n<p>In your loops of the form</p>\n\n<pre><code>for(auto itr : rvec1)\n</code></pre>\n\n<p><code>itr</code> will be a copy of elements of <code>rvec1</code>.   To obtain references to the actual elements use</p>\n\n<pre><code>for(auto &amp;itr : rvec1)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>for(const auto &amp;itr : rvec1)\n</code></pre>\n"}], "owner": {"reputation": 1541, "user_id": 3503769, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/L3Yh2.jpg?s=128&g=1", "display_name": "Anoroah", "link": "https://stackoverflow.com/users/3503769/anoroah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 44805075, "answer_count": 1, "score": 2, "last_activity_date": 1498659344, "creation_date": 1498658680, "last_edit_date": 1498659165, "question_id": 44804798, "link": "https://stackoverflow.com/questions/44804798/is-it-possible-that-resizing-an-stdvector-reduces-its-capacity", "title": "Is it possible that resizing an std::vector reduces its capacity?", "body": "<p>I have this container: std::vector&lt; std::tuple,std::vector > > rvec1 \nwhere each inner vector contains a number of elements.\nAfter some computations I resize the inner vectors.\nThe problem is that when I measure the capacity of each vector it seems that it decreases. \nIs this normal to happen?</p>\n\n<p>Here is the function where I resize the vectors:</p>\n\n<pre><code>int merge_vector_elements(std::vector&lt; std::tuple&lt;std::vector&lt;int&gt;,std::vector&lt;float&gt; &gt; &gt;&amp; rvec1){\n\n        long totalCapacity = 0;\n        for(auto itr : rvec1){\n          totalCapacity += std::get&lt;0&gt;(itr).capacity();\n          totalCapacity += std::get&lt;1&gt;(itr).capacity();\n        }\n        std::cout&lt;&lt;\"Total Capacity before merge / shrink: \"&lt;&lt;totalCapacity&lt;&lt;std::endl;\n\n        int nnz = 0;\n        for (msize_t i=0; i&lt;rvec1.size(); i++){\n          int count = 0;\n           for(msize_t j = 0; j &lt; std::get&lt;0&gt;(rvec1[i]).size(); ++j, ++count){\n             std::get&lt;0&gt;(rvec1[i])[count] = std::get&lt;0&gt;(rvec1[i])[j];\n             std::get&lt;1&gt;(rvec1[i])[count] = std::get&lt;1&gt;(rvec1[i])[j];\n             while((j+1 != std::get&lt;0&gt;(rvec1[i]).size()) &amp;&amp; std::get&lt;0&gt;(rvec1[i])[count] == std::get&lt;0&gt;(rvec1[i])[j+1]){  \n               std::get&lt;1&gt;(rvec1[i])[count] += std::get&lt;1&gt;(rvec1[i])[j+1];\n               j++;\n             } \n           }\n           std::get&lt;0&gt;(rvec1[i]).resize(count);\n           //std::get&lt;0&gt;(rvec1[i]).shrink_to_fit();\n           std::get&lt;1&gt;(rvec1[i]).resize(count);\n           //std::get&lt;1&gt;(rvec1[i]).shrink_to_fit();\n           nnz += count;\n        }\n        totalCapacity = 0;\n        for(auto itr : rvec1){\n          totalCapacity += std::get&lt;0&gt;(itr).capacity();\n          totalCapacity += std::get&lt;1&gt;(itr).capacity();\n        }\n        std::cout&lt;&lt;\"Total Capacity after merge / shrink: \"&lt;&lt;totalCapacity&lt;&lt;std::endl;\n\n        return nnz;\n      }\n</code></pre>\n\n<p>The results are: </p>\n\n<p>Total Capacity before merge / shrink: 254396100</p>\n\n<p>Total Capacity after merge / shrink: 107010297</p>\n\n<p>So the capacity seems to be affected.</p>\n\n<p>Also some sample code where the resize doesn't affect the capacity of the vector.</p>\n\n<pre><code>int main(){\n\n  long bufferSize = 1000000000;\n\n  std::vector&lt;double&gt; newVec(bufferSize);\n\n  for(int i=0; i&lt;bufferSize; i++){\n      newVec[i] = i * 8.99;\n  }\n\n  std::cout&lt;&lt;\"Capacity before resize: \"&lt;&lt;newVec.capacity()&lt;&lt;std::endl;\n  newVec.resize(bufferSize / 2);\n\n  // newVec.shrink_to_fit();\n  std::cout&lt;&lt;\"Capacity after resize: \"&lt;&lt;newVec.capacity()&lt;&lt;std::endl;\n\n  return 0;\n}\n</code></pre>\n\n<p>Compiling with gcc (Ubuntu 6.2.0-5ubuntu12) 6.2.0 </p>\n"}, {"tags": ["c++", "clang", "libc++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498658761, "post_id": 44804775, "comment_id": 76589611, "body": "Unrelated to your problem, but please avoid making type-aliases for basic types, or type-aliases that are pointers. Those makes the code harder to read, understand and maintain."}, {"owner": {"reputation": 21, "user_id": 8226379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8b9d04af67190b699ec78f6a5e93dd?s=128&d=identicon&r=PG&f=1", "display_name": "angargo", "link": "https://stackoverflow.com/users/8226379/angargo"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498658953, "post_id": 44804775, "comment_id": 76589763, "body": "Sure. That&#39;s not the real code, it&#39;s sort of a minimum working sample. I replaced the name of a class with an int and a shared_ptr with a raw pointer without paying much attention to these things. But thanks for the suggestion anyway."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498661255, "post_id": 44804775, "comment_id": 76591588, "body": "Seems to work for me here <a href=\"https://wandbox.org/permlink/068g4dzWE17A21cR\" rel=\"nofollow noreferrer\">wandbox.org/permlink/068g4dzWE17A21cR</a>,  can you reproduce the error on that website?  It allows you to customize the compiler options"}, {"owner": {"reputation": 21, "user_id": 8226379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8b9d04af67190b699ec78f6a5e93dd?s=128&d=identicon&r=PG&f=1", "display_name": "angargo", "link": "https://stackoverflow.com/users/8226379/angargo"}, "edited": false, "score": 0, "creation_date": 1498661924, "post_id": 44804775, "comment_id": 76592138, "body": "It works for me too (and it also works in Ideone), but it doesn&#39;t allow choosing the libstdc++ version."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498662795, "post_id": 44804775, "comment_id": 76592820, "body": "@Curious wandbox doesn&#39;t seem to implement clang correctly. If you specify It <code>#include</code>s /opt/wandbox/clang-3.9.1/include/c++/v1/queue instead of whatever g++/libstdc++ provides, regardless of -slibstdc++ or --gcc-toolchain option."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498662867, "post_id": 44804775, "comment_id": 76592873, "body": "This surely looks like a clang++ bug to me. Note the program compiles fine in c++11 mode. It also compiles if you add <code>-D_GLIBCXX14_CONSTEXPR=</code> compilation flag. This doesn&#39;t look reasonable to me at all."}, {"owner": {"reputation": 21, "user_id": 8226379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8b9d04af67190b699ec78f6a5e93dd?s=128&d=identicon&r=PG&f=1", "display_name": "angargo", "link": "https://stackoverflow.com/users/8226379/angargo"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498663031, "post_id": 44804775, "comment_id": 76593005, "body": "@n.m. Yes, you are right, <code>clang++ -S -std=c++11 aaa.cpp</code> works fine. I take it you can reproduce the issue?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498663457, "post_id": 44804775, "comment_id": 76593346, "body": "Yes I can reproduce it."}, {"owner": {"reputation": 143, "user_id": 939086, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e3bdc97478637e4b5a7848ccef9627a?s=128&d=identicon&r=PG", "display_name": "Paul  Yakovenko", "link": "https://stackoverflow.com/users/939086/paul-yakovenko"}, "edited": false, "score": 0, "creation_date": 1501924757, "post_id": 44804775, "comment_id": 78001097, "body": "I&#39;ve got <b>exactly</b> the same issue, heave you already fixed you compilation error?"}, {"owner": {"reputation": 21, "user_id": 8226379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8b9d04af67190b699ec78f6a5e93dd?s=128&d=identicon&r=PG&f=1", "display_name": "angargo", "link": "https://stackoverflow.com/users/8226379/angargo"}, "reply_to_user": {"reputation": 143, "user_id": 939086, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e3bdc97478637e4b5a7848ccef9627a?s=128&d=identicon&r=PG", "display_name": "Paul  Yakovenko", "link": "https://stackoverflow.com/users/939086/paul-yakovenko"}, "edited": false, "score": 0, "creation_date": 1503902343, "post_id": 44804775, "comment_id": 78784606, "body": "@PaulYakovenko Sorry for the late answer. Adding the flag <code>D_GLIBCXX14_CONSTEXPR=</code> did the trick."}], "owner": {"reputation": 21, "user_id": 8226379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8b9d04af67190b699ec78f6a5e93dd?s=128&d=identicon&r=PG&f=1", "display_name": "angargo", "link": "https://stackoverflow.com/users/8226379/angargo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 742, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1498658630, "creation_date": 1498658630, "question_id": 44804775, "link": "https://stackoverflow.com/questions/44804775/compile-error-with-clang-and-libstdc", "title": "Compile error with clang and libstdc++", "body": "<p>I'm trying to compile with clang a large codebase that we used to compile with gcc.</p>\n\n<p>The following code</p>\n\n<pre><code>#include &lt;queue&gt;\n#include &lt;functional&gt;\n\nusing T = int*;\n\nusing Func = std::function&lt;bool(T const, T const)&gt;;\nusing PQ = std::priority_queue&lt;T, std::vector&lt;T&gt;, Func&gt;;\n\nPQ GetPQ()\n{\n    Func comp = [](T l, T r) -&gt; bool { return *l &lt; *r; };\n    return PQ(comp);\n}\n</code></pre>\n\n<p>compiles just fine with</p>\n\n<pre><code>clang++ -S -std=c++14 aaa.cpp -stdlib=libc++\n</code></pre>\n\n<p>but fails to compile with</p>\n\n<pre><code>clang++ -S -std=c++14 aaa.cpp\n</code></pre>\n\n<p>This is the error that I get:</p>\n\n<pre><code>In file included from aaa.cpp:1:\nIn file included from /usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/queue:60:\nIn file included from /usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/deque:60:\nIn file included from /usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/stl_algobase.h:71:\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/predefined_ops.h:123:23: error: no matching function for call to object of type 'std::function&lt;bool (int *, int *)&gt;'\n        { return bool(_M_comp(*__it1, *__it2)); }\n                      ^~~~~~~\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/type_traits:2346:7: note: in instantiation of function template specialization '__gnu_cxx::__ops::_Iter_comp_iter&lt;std::function&lt;bool (int *, int *)&gt; &gt;::operator()&lt;int *, int *&gt;' requested here\n      std::declval&lt;_Fn&gt;()(std::declval&lt;_Args&gt;()...)\n      ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/type_traits:2357:24: note: while substituting deduced template arguments into function template '_S_test' [with _Fn = __gnu_cxx::__ops::_Iter_comp_iter&lt;std::function&lt;bool (int *, int *)&gt; &gt;, _Args =\n      (no value)]\n      typedef decltype(_S_test&lt;_Functor, _ArgTypes...&gt;(0)) type;\n                       ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/type_traits:2362:14: note: in instantiation of template class 'std::__result_of_impl&lt;false, false, __gnu_cxx::__ops::_Iter_comp_iter&lt;std::function&lt;bool (int *, int *)&gt; &gt;, int *, int *&gt;' requested here\n    : public __result_of_impl&lt;\n             ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/functional:1981:35: note: in instantiation of template class 'std::result_of&lt;__gnu_cxx::__ops::_Iter_comp_iter&lt;std::function&lt;bool (int *, int *)&gt; &gt; (int *, int *)&gt;' requested here\n               typename _Res2 = typename result_of&lt;_Func(_ArgTypes...)&gt;::type&gt;\n                                         ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/functional:2053:30: note: in instantiation of default argument for '_Callable&lt;__gnu_cxx::__ops::_Iter_comp_iter&lt;std::function&lt;bool (int *, int *)&gt; &gt; &gt;' required here\n               typename = _Requires&lt;_Callable&lt;_Functor&gt;, void&gt;&gt;\n                                    ^~~~~~~~~~~~~~~~~~~\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/functional:2054:2: note: in instantiation of default argument for 'function&lt;__gnu_cxx::__ops::_Iter_comp_iter&lt;std::function&lt;bool (int *, int *)&gt; &gt;, void&gt;' required here\n        function(_Functor);\n        ^~~~~~~~\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/predefined_ops.h:130:14: note: while substituting deduced template arguments into function template 'function' [with _Functor = __gnu_cxx::__ops::_Iter_comp_iter&lt;std::function&lt;bool (int *, int *)&gt;\n      &gt;, $1 = (no value), $2 = (no value)]\n    { return _Iter_comp_iter&lt;_Compare&gt;(__comp); }\n             ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/stl_heap.h:385:28: note: in instantiation of function template specialization '__gnu_cxx::__ops::__iter_comp_iter&lt;std::function&lt;bool (int *, int *)&gt; &gt;' requested here\n                       __gnu_cxx::__ops::__iter_comp_iter(__comp));\n                                         ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/bits/stl_queue.h:414:14: note: in instantiation of function template specialization 'std::make_heap&lt;__gnu_cxx::__normal_iterator&lt;int **, std::vector&lt;int *, std::allocator&lt;int *&gt; &gt; &gt;, std::function&lt;bool\n      (int *, int *)&gt; &gt;' requested here\n      { std::make_heap(c.begin(), c.end(), comp); }\n             ^\naaa.cpp:12:12: note: in instantiation of member function 'std::priority_queue&lt;int *, std::vector&lt;int *, std::allocator&lt;int *&gt; &gt;, std::function&lt;bool (int *, int *)&gt; &gt;::priority_queue' requested here\n    return PQ(comp);\n           ^\n/usr/bin/../lib/gcc/x86_64-linux-gnu/5.4.0/../../../../include/c++/5.4.0/functional:2195:12: note: candidate function not viable: no known conversion from 'int' to 'int *' for 1st argument; remove *\n      _Res operator()(_ArgTypes... __args) const;\n           ^\n1 error generated.\n</code></pre>\n\n<p>Clang and libstdc++ versions:</p>\n\n<pre><code>$ clang++ --version\n    clang version 3.8.0-2ubuntu4 (tags/RELEASE_380/final)\n$ /sbin/ldconfig -p | grep stdc++\n    libstdc++.so.6 (libc6,x86-64) =&gt; /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n    libstdc++.so.6 (libc6) =&gt; /usr/lib/i386-linux-gnu/libstdc++.so.6\n</code></pre>\n\n<p>I'd rather not switch to libc++, and I think that (correct me if I'm wrong) this should work. Probably it's just a compatibility issue with the versions that I'm using but I haven't managed to find anything on the Internet so far. Any ideas as to what might be the problem?</p>\n"}, {"tags": ["java", "c++", "java-native-interface"], "comments": [{"owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "edited": false, "score": 0, "creation_date": 1498659430, "post_id": 44804660, "comment_id": 76590162, "body": "I don&#39;t see the point of using a <code>BigInteger</code> here if you&#39;re converting it to a <code>unsigned long long</code> any ways. Why not just pass a Java <code>long</code>?"}, {"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "reply_to_user": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "edited": false, "score": 0, "creation_date": 1498660686, "post_id": 44804660, "comment_id": 76591165, "body": "Well I tried converting to long long but it did not work. Why a BigInteger? Well the number is really big, to give you an example this is one of the numbers in hex: ffffffffff601000"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "edited": false, "score": 0, "creation_date": 1498668360, "post_id": 44806143, "comment_id": 76596752, "body": "Thank you for your help, but I did previously try something similar with a byte array as well and it worked but I thought I needed big integers and then it got messy. The problem is now when I try to read the ByteBuffer with bb.hasRemaining() and bb.get() I get BufferUnderflowException I ve read in the documentation what it is but cannot seam to get around it. Further more I need to interpret the elements of this bytebuffer as chars and store them into a string. This is what I did with the byte[] array"}, {"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "edited": false, "score": 0, "creation_date": 1498668379, "post_id": 44806143, "comment_id": 76596768, "body": "byte[] x = this.readRam(readSize, addr, PID); \t\tString s = &quot;&quot;; \t\tfor(int i=0; i&lt;x.length; i++) \t\t{\t \t\t\tif(((int)x[i] &gt;= 32 &amp;&amp; (int)x[i] &lt; 127) || (int)x[i]==10) \t\t\t{ \t\t\t\ts = s+(char)x[i]; \t\t\t} \t\t} \t\treturn s;"}, {"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "edited": false, "score": 0, "creation_date": 1498669818, "post_id": 44806143, "comment_id": 76597619, "body": "Thank you so much it works like a charm I just wish I had more rep so I could at the very least up vote your answer."}], "tags": [], "owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "is_accepted": true, "score": 4, "last_activity_date": 1498668857, "last_edit_date": 1498668857, "creation_date": 1498661984, "answer_id": 44806143, "question_id": 44804660, "link": "https://stackoverflow.com/questions/44804660/how-to-access-values-of-a-jobject-in-jni/44806143#44806143", "title": "How to access values of a jobject in JNI", "body": "<p>The problem with your approach is that you're trying to access a field of <code>BigInteger</code> call <code>len</code>:</p>\n\n<pre><code>GetFieldID(c, \"len\", \"Ljava/math/BigInteger;\");\n</code></pre>\n\n<p>But <code>BigInteger</code> doesn't have such a field.</p>\n\n<p>There is no way to access the \"value\" of a <code>BigInteger</code> directly. The best you can do from JNI is convert the <code>BigInteger</code> to a <code>jlong</code> (by calling the Java method <code>longValue</code>, on the <code>BigInteger</code>) and use that.</p>\n\n<p>But, there is no point in using a <code>BigInteger</code> if you're converting it to an <code>jlong</code> any ways. You would lose any precision you'd gain from using a <code>BigInteger</code>. So might as well use a <code>long</code> in Java instead (which will still fit the value <code>0xffffffffff601000</code> that you mentioned).</p>\n\n<p>Furthermore, a <code>byte[]</code> can only be indexed with an <code>int</code>, so even if you make <code>buf</code> bigger than that, it won't be accessible from Java.</p>\n\n<p>I would recommand using a direct <code>ByteBuffer</code> instead of a <code>byte[]</code>, since you won't have to copy data across buffers.</p>\n\n<p>You'd get something like this:</p>\n\n<pre><code>private static native void readRam(ByteBuffer buff, long address, int pid);\n</code></pre>\n\n<p>And then in C++:</p>\n\n<pre><code>JNIEXPORT void JNICALL Java_Main_readRam\n    (JNIEnv *env, jclass, jobject byteBuffer, jlong addr jint pid) {\n\n    struct iovec local[1];\n    struct iovec remote[1];\n\n    void* buf = env-&gt;GetDirectBufferAddress(byteBuffer);\n    jlong len = env-&gt;GetDirectBufferCapacity(byteBuffer);\n\n    local[0].iov_base = buf;\n    local[0].iov_len = len;\n\n    remote[0].iov_base = (void *) addr;\n    remote[0].iov_len = len;\n\n    process_vm_readv(pid, local, 1, remote, 1, 0);\n}\n</code></pre>\n\n<p>And then calling:</p>\n\n<pre><code>int bufferLength = ...;\nlong address = 0xffffffffff601000L;\nint pid = ...;\n\nByteBuffer bb = ByteBuffer.allocateDirect(bufferLength);\n\nreadRam(bb, address, pid);\n\n// use bb...\n</code></pre>\n\n<hr>\n\n<p>In regards to your comment, you could do this:</p>\n\n<pre><code>StringBuilder sb = new StringBuilder();\nwhile(bb.hasRemaining()) {\n    byte b = bb.get();\n    if((b &gt;= 32 &amp;&amp; b &lt; 127) || b == 10) {\n        sb.append((char) b);\n    }\n}\nString result = sb.toString();\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "accepted_answer_id": 44806143, "answer_count": 1, "score": 3, "last_activity_date": 1498668857, "creation_date": 1498658352, "last_edit_date": 1498660786, "question_id": 44804660, "link": "https://stackoverflow.com/questions/44804660/how-to-access-values-of-a-jobject-in-jni", "title": "How to access values of a jobject in JNI", "body": "<pre><code>JNIEXPORT jbyteArray JNICALL Java_ramRead_MainClass_readRam\n        (JNIEnv *env, jobject, jobject len, jobject addr, jint pid)\n{\n        jclass c = (*env).GetObjectClass(len);\n        jfieldID fid = (*env).GetFieldID(c, \"len\", \"Ljava/math/BigInteger;\");\n        std::cout &lt;&lt; \"Object Field: \" &lt;&lt; (*env).GetObjectField(len, fid);\n\n        struct iovec local[1];\n        struct iovec remote[1];\n        unsigned long long len1 = (*env).GetObjectField(len, fid) //This did not work out. the conversion to unsigned long long\n        jbyte buf[len];\n        jbyteArray buf1 = (*env).NewByteArray(len);\n\n        local[0].iov_base = buf;\n        local[0].iov_len = len;\n\n        remote[0].iov_base = (void *) addr;\n        remote[0].iov_len = len;\n\n        nread = process_vm_readv(pid, local, 1, remote, 1, 0);\n\n        (*env).SetByteArrayRegion(buf1, 0, len, buf);\n        return buf1;\n}\n</code></pre>\n\n<p>This is my native method and as you can see, it receives 3 parameters as arguments two <code>jobject</code> and one <code>int</code>. The two jobjects are big integers,\nOriginally it revived as parameters two <code>int</code> and one <code>long</code> but as I need to pass big integers now I have a problem or should I say several of them. </p>\n\n<p>Goal:</p>\n\n<p>I need to get the <code>BigInteger</code> value from <code>jobject len</code> and then I need to use it to initialize the size of <code>jbyte buf[len]</code> , <code>jbyteArray buf1 = (*env).NewByteArray(len)</code> and <code>local[0].iov_len = len;</code> I cannot of course just initialize them with <code>len</code> I need to get the big integer value from <code>len</code> and then initialize the size with that. \nAnd then I need to do the same, with jobject addr that is extract the big integer value from it.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c++", "arrays", "bit", "memcpy"], "comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1498658284, "post_id": 44804407, "comment_id": 76589194, "body": "<i>is not working</i> means nothing. Please say exactly what happens..."}, {"owner": {"reputation": 29011, "user_id": 442284, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b5c1e7936dd4e0e08a75b7b16aebb6f1?s=128&d=identicon&r=PG", "display_name": "CashCow", "link": "https://stackoverflow.com/users/442284/cashcow"}, "edited": false, "score": 0, "creation_date": 1498658307, "post_id": 44804407, "comment_id": 76589218, "body": "Is it &quot;working&quot; now you fixed your code?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498658450, "post_id": 44804407, "comment_id": 76589356, "body": "If you updated your code in the question to include fixes from answers, then don&#39;t do that! It makes the answers useless and the question even more so."}, {"owner": {"reputation": 1507, "user_id": 4296244, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e8c0940effc84e18a8541145ef2dfbfe?s=128&d=identicon&r=PG&f=1", "display_name": "Natjo", "link": "https://stackoverflow.com/users/4296244/natjo"}, "edited": false, "score": 0, "creation_date": 1498663238, "post_id": 44804407, "comment_id": 76593166, "body": "It is working now, it were some simple errors, but thank you for helping me find them. I updated the question because I thought they would not be the reason of the problem, but only levity."}, {"owner": {"reputation": 29011, "user_id": 442284, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b5c1e7936dd4e0e08a75b7b16aebb6f1?s=128&d=identicon&r=PG", "display_name": "CashCow", "link": "https://stackoverflow.com/users/442284/cashcow"}, "edited": false, "score": 0, "creation_date": 1498669837, "post_id": 44804407, "comment_id": 76597634, "body": "This is now not really a very useful question for anyone who wants to solve their problem."}], "answers": [{"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1498658909, "last_edit_date": 1498658909, "creation_date": 1498658138, "answer_id": 44804557, "question_id": 44804407, "link": "https://stackoverflow.com/questions/44804407/how-to-copy-data-into-certain-parts-of-a-byte-array/44804557#44804557", "title": "How to copy data into certain parts of a byte array", "body": "<p>One possible problem and one definitive problem:</p>\n\n<ol>\n<li><p>The possible problem is that array indexing starts at zero. So you should copy to <code>bit_data + 1</code> to skip over the first byte, and then of course use <code>bit_data[0]</code> to set the type id.</p></li>\n<li><p>The definitive problem is that <code>&amp;data + 1</code> is equal to <code>(&amp;data)[1]</code>, and that will be out of bounds and lead to <em>undefined behavior</em>. You should just copy from <code>&amp;data</code>.</p></li>\n</ol>\n\n<p>Putting it all together the last to lines should be</p>\n\n<pre><code>memcpy(bit_data + 1, &amp;data, *msglen-1);\nbit_data[0] = typeID;\n</code></pre>\n\n<hr>\n\n<p>There is another possible problem, which depends on what you're doing with the data in <code>bit_data</code> and what <code>T</code> is. If <code>T</code> is not a <a href=\"http://en.cppreference.com/w/cpp/concept/PODType\" rel=\"nofollow noreferrer\">POD type</a> then you simply can not expect a bitwise copy (what <code>memcpy</code> does) to work very well.</p>\n\n<p>Also if <code>T</code> is a class or structure with members that are pointers then you can't save those to disk or transfer to another computer or even to another process on the same computer.</p>\n"}, {"comments": [{"owner": {"reputation": 1507, "user_id": 4296244, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e8c0940effc84e18a8541145ef2dfbfe?s=128&d=identicon&r=PG&f=1", "display_name": "Natjo", "link": "https://stackoverflow.com/users/4296244/natjo"}, "edited": false, "score": 0, "creation_date": 1498662764, "post_id": 44804564, "comment_id": 76592784, "body": "I&#39;m sorry for that"}], "tags": [], "owner": {"reputation": 29011, "user_id": 442284, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b5c1e7936dd4e0e08a75b7b16aebb6f1?s=128&d=identicon&r=PG", "display_name": "CashCow", "link": "https://stackoverflow.com/users/442284/cashcow"}, "is_accepted": false, "score": 1, "last_activity_date": 1498658158, "creation_date": 1498658158, "answer_id": 44804564, "question_id": 44804407, "link": "https://stackoverflow.com/questions/44804407/how-to-copy-data-into-certain-parts-of-a-byte-array/44804564#44804564", "title": "How to copy data into certain parts of a byte array", "body": "<p>There are a few bugs in there, in addition to the fact you are messing around with new.</p>\n\n<p>The <code>memcpy</code> line itself you use <code>&amp;data + 1</code> as the source which here will be undefined behaviour. It will add sizeof(data) bytes to the address which is copied so in the stack somewhere and whilst \"one past the end\" is a valid pointer so this address is valid in pointer arithmetic, nothing you read from it will be, nor anything after it.</p>\n\n<p><code>bit_data[1]</code> is the 2nd character in your buffer.</p>\n"}], "owner": {"reputation": 1507, "user_id": 4296244, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e8c0940effc84e18a8541145ef2dfbfe?s=128&d=identicon&r=PG&f=1", "display_name": "Natjo", "link": "https://stackoverflow.com/users/4296244/natjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "accepted_answer_id": 44804557, "answer_count": 2, "score": -3, "last_activity_date": 1498663181, "creation_date": 1498657788, "last_edit_date": 1498663181, "question_id": 44804407, "link": "https://stackoverflow.com/questions/44804407/how-to-copy-data-into-certain-parts-of-a-byte-array", "title": "How to copy data into certain parts of a byte array", "body": "<p>I want to create a byte array out of an unknown struct and add a number additionally in the front of this byte array. How do I do this?</p>\n\n<p>I currently have this code:</p>\n\n<pre><code>template &lt;class T&gt;\nvoid CopterConnection::infoToByteArray(char *&amp;bit_data, size_t *msglen,\n                                       T data) {\n    // Determine which kind of element is in the array, will change in the final code\n    char typeID = -1;\n\n    *msglen = sizeof(data);\n    *msglen += 1;  // take in account of typeID\n\n    // Create the pointer to the byte representation of the struct\n    bit_data = new char[*msglen];\n\n    // copy the information from the struct into the byte array\n    memcpy(bit_data, &amp;data+1, *msglen-1);\n    bit_data[1] = typeID;\n}\n</code></pre>\n\n<p>But this is not working. I guess I use the memcpy wrong. I want to copy the unkown struct T into the positions <code>bit_data[1]</code> to <code>bit_data[*end*]</code>. What is the best way to achieve this?</p>\n"}, {"tags": ["c++", "qt", "media-player"], "comments": [{"owner": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1499117676, "post_id": 44804312, "comment_id": 76766271, "body": "Can you include the error message printed in the console?"}, {"owner": {"reputation": 1, "user_id": 8226443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8728257138ae13613fd974105382ba9c?s=128&d=identicon&r=PG&f=1", "display_name": "Eltchar", "link": "https://stackoverflow.com/users/8226443/eltchar"}, "reply_to_user": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "edited": false, "score": 0, "creation_date": 1499150049, "post_id": 44804312, "comment_id": 76774551, "body": "i have exception code: 0xc0000005; read access violation at : 0x0 flags=0x0, while i don&#39;t know why its read access violation cause i can do other actions like move position or read the current value  other than that i don&#39;t get any erro in console if i run it in not debug mode app just crashes without an error message"}], "owner": {"reputation": 1, "user_id": 8226443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8728257138ae13613fd974105382ba9c?s=128&d=identicon&r=PG&f=1", "display_name": "Eltchar", "link": "https://stackoverflow.com/users/8226443/eltchar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499117647, "creation_date": 1498657528, "last_edit_date": 1499117647, "question_id": 44804312, "link": "https://stackoverflow.com/questions/44804312/qmediaplayer-cant-pause-at-chosen-timeframe", "title": "QMediaPlayer can&#39;t pause at chosen timeframe", "body": "<p>I am having issue of not being able to call out for pause or stop while doing it from script that checks position</p>\n\n<p>This slot is connected to the slot from QMediaPlayer</p>\n\n<pre><code>void VideoPlayer::positionChanged(qint64 position)\n{\n    if(position&gt;=3000)\n    {\n        mediaPlayer.pause();\n    }\n}\n</code></pre>\n\n<p>in this slot the position is compared and after 3 seconds should pause the video\nbut instead it crashes application, i can pasue using buttons that have separate slot that issue same command <code>mediaPlayer.pause();</code></p>\n\n<p>when I turn on the debugger it points me to :</p>\n\n<blockquote>\n  <p>0x6665b67b  &lt;+0x00bb>         int     3 in Qt5Cored!qt_message_fatal\n  [c:\\users\\qt\\work\\qt\\qtbase\\src\\corelib\\global\\qlogging.cpp @ 1667]:</p>\n</blockquote>\n\n<p>Anyone have a solution?</p>\n\n<p>Could be any way just to pause the movie at chosen time </p>\n"}, {"tags": ["c++", "opencv", "visual-studio-2012", "dll", "visual-studio-2015"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498658030, "post_id": 44804205, "comment_id": 76588945, "body": "That&#39;s unrelated to Visual Studio. You haven&#39;t copied dependencies to the appropriate locations. See <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586.aspx\" rel=\"nofollow noreferrer\">Dynamic-Link Library Search Order</a> to understand your issue."}, {"owner": {"reputation": 1, "user_id": 8226331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWuhx.jpg?s=128&g=1", "display_name": "Rahma Cheikhrouhou", "link": "https://stackoverflow.com/users/8226331/rahma-cheikhrouhou"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498660493, "post_id": 44804205, "comment_id": 76591013, "body": "I already copied dependencies to the appropriate locations."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1498660644, "post_id": 44804205, "comment_id": 76591137, "body": "Why have you tagged this for 2 different versions of Visual Studio? Remember that it is essential to use the correct dlls for the version of Visual Studio that you are using. Using dlls compiled with any other compiler (or a different version of Visual Studio or mixing debug / release) will create UB."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498660777, "post_id": 44804205, "comment_id": 76591238, "body": "Hardly convincing, a computer doesn&#39;t lie. If the error message indicates, that a program is unable to find a DLL, it does so because it cannot find that DLL (or a dependency of that DLL). Also while you claim, that you have copied the libraries to the appropriate locations, you have made no attempt to explain, where you really put them. <a href=\"https://stackoverflow.com/a/5818123/1889329\">Enable loader snaps</a> to debug these types of errors."}, {"owner": {"reputation": 1, "user_id": 8226331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWuhx.jpg?s=128&g=1", "display_name": "Rahma Cheikhrouhou", "link": "https://stackoverflow.com/users/8226331/rahma-cheikhrouhou"}, "edited": false, "score": 0, "creation_date": 1498661857, "post_id": 44804205, "comment_id": 76592080, "body": "At configuration Properties C/C++ -Additional Include Directories-, I already added openCv include folders ( ..\\build\\include, ..\\build\\include\\opencv and ..\\build\\include\\opencv2). Also at Configuration Properties Linker-Additional Library Directories- I put ..\\build\\x64\\vc14\\lib and *.lib at -Additional dependencies-"}, {"owner": {"reputation": 1, "user_id": 8226331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWuhx.jpg?s=128&g=1", "display_name": "Rahma Cheikhrouhou", "link": "https://stackoverflow.com/users/8226331/rahma-cheikhrouhou"}, "edited": false, "score": 0, "creation_date": 1498662029, "post_id": 44804205, "comment_id": 76592215, "body": "I have the same problem with VS 2015 and VS 2012 that&#39;s why I have tagged 2 different versions of Visual Studio."}], "owner": {"reputation": 1, "user_id": 8226331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWuhx.jpg?s=128&g=1", "display_name": "Rahma Cheikhrouhou", "link": "https://stackoverflow.com/users/8226331/rahma-cheikhrouhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "closed_date": 1498657932, "answer_count": 0, "score": 0, "last_activity_date": 1498657467, "creation_date": 1498657257, "last_edit_date": 1498657467, "question_id": 44804205, "link": "https://stackoverflow.com/questions/44804205/visual-studio-doesnt-recognize-opencv-unable-to-locate-dll", "closed_reason": "Duplicate", "title": "Visual Studio doesn&#39;t recognize opencv: unable to locate DLL", "body": "<p><a href=\"https://i.stack.imgur.com/QxSLK.jpg\" rel=\"nofollow noreferrer\">Error Unable to locate DLL</a></p>\n\n<p>I'm integrating different programs based on C++ using <code>OpenCV</code> on Windows Form. \nI always get the following error when debugging after including <code>OpenCV</code> and importing its libraries :</p>\n\n<blockquote>\n  <p>\"Unhandled exception to 0x00007FFC87DFCE60 (ntdll.dll) in OpenCV_faceRecognition.exe : 0xC0000135: Unable to Locate DLL\".</p>\n</blockquote>\n\n<p>I also added <code>OpenCv</code> configurations in project Settings (Linker/C/C++).  </p>\n"}, {"tags": ["php", "c++", "encryption"], "answers": [{"comments": [{"owner": {"reputation": 6465, "user_id": 1181435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2f2059bf003de1adcf05b16aeecd5f4?s=128&d=identicon&r=PG", "display_name": "Alex Tartan", "link": "https://stackoverflow.com/users/1181435/alex-tartan"}, "edited": false, "score": 2, "creation_date": 1498659056, "post_id": 44804506, "comment_id": 76589849, "body": "Great visual representation! have my +1 ;)"}], "tags": [], "owner": {"reputation": 6510, "user_id": 2196561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac22ef3edb7836c3af11f5511f7942f8?s=128&d=identicon&r=PG", "display_name": "Ebbe M. Pedersen", "link": "https://stackoverflow.com/users/2196561/ebbe-m-pedersen"}, "is_accepted": false, "score": 5, "last_activity_date": 1498658308, "last_edit_date": 1498658308, "creation_date": 1498658000, "answer_id": 44804506, "question_id": 44804192, "link": "https://stackoverflow.com/questions/44804192/generate-key-for-encryption-in-php-which-can-be-placed-directly-in-c-code-for/44804506#44804506", "title": "Generate key for encryption in PHP which can be placed directly in C++ code for decryption", "body": "<p>That is simply the ascii value of the text in hex &amp; <a href=\"https://en.wikipedia.org/wiki/Endianness#Little-endian\" rel=\"noreferrer\">little endian</a> format:</p>\n\n<pre><code>     a  n  n  o    y  i  n  g       m  o  n    k  e  y  \nHex: 61 6e 6e 6f   79 69 6e 67   20 6d 6f 6e   6b 65 79 00 \n       \\     /       \\     /       \\     /       \\     / \n       reverse       reverse       reverse       reverse    \n       /     \\       /     \\       /     \\       /     \\\n     {0x6f6e6e61,   0x676e6979,   0x6e6f6d20,   0x0079656b };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6465, "user_id": 1181435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2f2059bf003de1adcf05b16aeecd5f4?s=128&d=identicon&r=PG", "display_name": "Alex Tartan", "link": "https://stackoverflow.com/users/1181435/alex-tartan"}, "is_accepted": false, "score": 0, "last_activity_date": 1498663460, "last_edit_date": 1498663460, "creation_date": 1498658240, "answer_id": 44804604, "question_id": 44804192, "link": "https://stackoverflow.com/questions/44804192/generate-key-for-encryption-in-php-which-can-be-placed-directly-in-c-code-for/44804604#44804604", "title": "Generate key for encryption in PHP which can be placed directly in C++ code for decryption", "body": "<p>Use this to convert the string:</p>\n\n<pre><code>&lt;?php\n$var = \"annoying monkey\";\n$hex = '';\nfor ($i=0; $i&lt;strlen($var); $i++){\n    $ord     = ord($var[$i]);\n    $hexCode = dechex($ord);\n    $hex .= substr('0'.$hexCode, -2);\n}\necho $hex; // 616e6e6f79696e67206d6f6e6b6579\n</code></pre>\n\n<p>After this, you only need to split the string into chunks of 8 and reverse the groups of 2 digits (each of the 4 letters)</p>\n\n<pre><code>$parts = str_split($hex,8);\nforeach($parts as $key=&gt;$value){\n    // pad right to make last group 8 chars long, even if it's shorter\n    $parts[$key] = str_pad($value, 8, \"0\", STR_PAD_RIGHT); \n    // split it into groups of 2 digits - each letter\n    $innerParts  = str_split($parts[$key],2);\n    // reverse the order\n    $innerParts  = array_reverse($innerParts);\n    // join and start with '0x'\n    $parts[$key] = \"0x\".implode('',$innerParts);\n}\nprint_r($parts); \n//Array\n//(\n//    [0] =&gt; 0x6f6e6e61\n//    [1] =&gt; 0x676e6979\n//    [2] =&gt; 0x6e6f6d20\n//    [3] =&gt; 0x0079656b\n//)\n</code></pre>\n\n<p>You can see it here:</p>\n\n<p><a href=\"https://3v4l.org/AVObB\" rel=\"nofollow noreferrer\">https://3v4l.org/AVObB</a></p>\n\n<p>To get your final string,</p>\n\n<pre><code>$string = 'uint32_t key['.count($parts).'] = {'. implode(',', $parts). '};';\necho $string;\n// uint32_t key[4] = {0x6f6e6e61,0x676e6979,0x6e6f6d20,0x0079656b};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15161, "user_id": 1067003, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e3af2bd4b5604b0b661b5e6646544eba?s=128&d=identicon&r=PG", "display_name": "hanshenrik", "link": "https://stackoverflow.com/users/1067003/hanshenrik"}, "is_accepted": false, "score": 0, "last_activity_date": 1602718530, "creation_date": 1602718530, "answer_id": 64362879, "question_id": 44804192, "link": "https://stackoverflow.com/questions/44804192/generate-key-for-encryption-in-php-which-can-be-placed-directly-in-c-code-for/64362879#64362879", "title": "Generate key for encryption in PHP which can be placed directly in C++ code for decryption", "body": "<p>kindof tricky, given that in your raw php string, they're both &quot;big endian bit order AND big endian byte order&quot;, here's one way to convert them (this approach use more cpu than required though, there's definitely a faster way than this)</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n// the raw key binary, big endian bit order, big endian byte order:\n$key_bit_order_big_byte_order_big = &quot;annoying_monkey&quot;;\n//&lt;pad&gt;\n// pad it to 32bits/4 bytes (uint32_t)\n$pad_bytes = strlen($key_bit_order_big_byte_order_big) % 4;\nif($pad_bytes &gt; 0){\n    $pad_bytes = 4 - $pad_bytes;\n    assert($pad_bytes &gt; 0);\n    $key_bit_order_big_byte_order_big .= str_repeat(&quot;\\x00&quot;, $pad_bytes);\n}\n//&lt;/pad&gt;\n\n// convert from &quot;big endian bit order, big endian byte order&quot; to \n// &quot;little endian bit order, big endian byte order&quot;:\n$key_bit_order_little_byte_order_big = strrev($key_bit_order_big_byte_order_big);\n// convert from &quot;little endian bit order, big endian byte order&quot; to \n// &quot;little endian bit order, little endian byte order&quot;: \n$key_bit_order_little_byte_order_little = implode(&quot;&quot;, array_reverse(str_split($key_bit_order_little_byte_order_big, 4), false));\n\n// now to c++-ify it: \n$key_chunks_little_endian = str_split($key_bit_order_little_byte_order_little, 4);\nforeach($key_chunks_little_endian as &amp;$chunk){\n    $chunk = &quot;0x&quot;.bin2hex($chunk);\n}\nunset($chunk);\necho &quot;uint32_t key[&quot;.count($key_chunks_little_endian).&quot;] = {&quot;.implode(&quot;, &quot;, $key_chunks_little_endian).&quot;};&quot;;\n</code></pre>\n<p>outputs:</p>\n<pre><code>uint32_t key[4] = {0x6f6e6e61, 0x676e6979, 0x6e6f6d5f, 0x0079656b};\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8226420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800529bdcbc19bf2b2f350462a3bfe07?s=128&d=identicon&r=PG&f=1", "display_name": "zerobits0", "link": "https://stackoverflow.com/users/8226420/zerobits0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1602718530, "creation_date": 1498657221, "last_edit_date": 1498662331, "question_id": 44804192, "link": "https://stackoverflow.com/questions/44804192/generate-key-for-encryption-in-php-which-can-be-placed-directly-in-c-code-for", "title": "Generate key for encryption in PHP which can be placed directly in C++ code for decryption", "body": "<p>I am trying to build an application which generates an encryption key which is then placed directly in the code of a C++ application to decrypt it.</p>\n\n<p>I am confused as to how a string in PHP is converted to the format used in C++.</p>\n\n<p>As an example, have a look at this question here:\n<a href=\"https://stackoverflow.com/questions/10132153/xtea-encryption-in-php-and-decryption-in-c/10136328\">XTEA encryption in PHP and decryption in C</a></p>\n\n<p>How did the answer by <em>dschulz</em> get the string </p>\n\n<pre><code>annoying monkey\n</code></pre>\n\n<p>to </p>\n\n<pre><code>uint32_t key[4] = {0x6f6e6e61, 0x676e6979, 0x6e6f6d20, 0x0079656b };\n</code></pre>\n\n<p>And how can this be done in PHP, so it prints that line in that format?</p>\n\n<p>I've tried converting strings to hex and affixing 0x but it just doesn't work, any help would be appreciated.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498657312, "post_id": 44804153, "comment_id": 76588312, "body": "Have you tried stepping through the loop in a debugger? To see what data you read and that <code>line.isNull()</code> actually is true at the end of the file? Have you tried <a href=\"http://doc.qt.io/qt-5/qstring.html#isEmpty\" rel=\"nofollow noreferrer\"><code>isEmpty</code></a> instead? Or checking the streams <a href=\"http://doc.qt.io/qt-5/qtextstream.html#atEnd\" rel=\"nofollow noreferrer\"><code>atEnd</code></a>? (And checking should really be done <i>before</i> you try to add the (possibly null or empty) text to the text box)"}, {"owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498657549, "post_id": 44804153, "comment_id": 76588512, "body": "I tried changing the loop to do.....while(line.isNull()) , and that gave me only just the first line successfully as output and in the debugger. The debugger is what is in the infinite loop. The actual output, as written above, isn&#39;t even making it to the interface. Just tried while(!line.isEmpty()) and I also got stuck in an an endless loop."}, {"owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "edited": false, "score": 0, "creation_date": 1498658142, "post_id": 44804153, "comment_id": 76589070, "body": "Works for me... is the file constantly updated? If so, then an infinite loop would be expected"}], "answers": [{"comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1498658566, "post_id": 44804580, "comment_id": 76589439, "body": "That&#39;s basically the same as <code>while (!file.eof())</code> using a standard C++ stream, <a href=\"https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong\">and that is wrong</a>."}], "tags": [], "owner": {"reputation": 4113, "user_id": 2126582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tVrzW.png?s=128&g=1", "display_name": "AnatolyS", "link": "https://stackoverflow.com/users/2126582/anatolys"}, "is_accepted": false, "score": 0, "last_activity_date": 1498658185, "creation_date": 1498658185, "answer_id": 44804580, "question_id": 44804153, "link": "https://stackoverflow.com/questions/44804153/do-while-infinite-loop-in-qt/44804580#44804580", "title": "Do-while infinite loop in Qt", "body": "<p>Use atEnd to detect the end of a stream:</p>\n\n<blockquote>\n  <p>bool QTextStream::atEnd() const</p>\n  \n  <p>Returns true if there is no more data to be read from the QTextStream;\n  otherwise returns false. This is similar to, but not the same as\n  calling QIODevice::atEnd(), as QTextStream also takes into account its\n  internal Unicode buffer.</p>\n</blockquote>\n\n<pre><code>   while (!stream.atEnd()) {\n        line = stream.readLine();\n        textEdit-&gt;setText(textEdit-&gt;toPlainText()+\"0x\"+line+\"\\n\");\n        qDebug() &lt;&lt; \"line: \"&lt;&lt;line;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1498661476, "last_edit_date": 1498661476, "creation_date": 1498658484, "answer_id": 44804713, "question_id": 44804153, "link": "https://stackoverflow.com/questions/44804153/do-while-infinite-loop-in-qt/44804713#44804713", "title": "Do-while infinite loop in Qt", "body": "<p>To add items use the append function of QTextEdit:</p>\n\n<blockquote>\n  <p>void QTextEdit::append(const QString &amp; text)</p>\n  \n  <p>Appends a new paragraph with text to the end of the text edit.</p>\n  \n  <p>Note: The new paragraph appended will have the same character format\n  and block format as the current paragraph, determined by the position\n  of the cursor.</p>\n</blockquote>\n\n<p>To iterate through the QTextStream atEnd()</p>\n\n<blockquote>\n  <p>bool QTextStream::atEnd() const</p>\n  \n  <p>Returns true if there is no more data to be read from the QTextStream;\n  otherwise returns false. This is similar to, but not the same as\n  calling QIODevice::atEnd(), as QTextStream also takes into account its\n  internal Unicode buffer.</p>\n</blockquote>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>void MainWindow::readFile(){\n    infoLabel-&gt;setText(tr(\"Invoked &lt;b&gt;File|Open&lt;/b&gt;\"));\n    QString filename = \"trace.txt\";\n    QString path = QDir::currentPath();\n    QFile file(\"//Users//nathan1324//Desktop//trace.txt\");\n    if(!file.exists()){\n        qDebug() &lt;&lt; \"File cannot be found \"&lt;&lt;filename;\n        qDebug() &lt;&lt; \" \" &lt;&lt; path;\n        return;\n    }\n\n    QString line;\n    textEdit-&gt;clear();\n    if (!file.open(QIODevice::ReadOnly | QIODevice::Text)){\n        qDebug() &lt;&lt; \"Could not open file\" &lt;&lt; filename;\n        return;\n    }\n\n    qDebug() &lt;&lt; filename&lt;&lt;\" Opening...\";\n\n    QTextStream stream(&amp;file);\n\n    while (!stream.atEnd()) {\n        line = stream.readLine();\n        if(!line.isNull()){\n            textEdit-&gt;append(\"0x\"+line);\n            qDebug() &lt;&lt; \"line: \"&lt;&lt;line;\n        }\n    }\n    file.close();\n}\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 44804713, "answer_count": 2, "score": 0, "last_activity_date": 1498661476, "creation_date": 1498657106, "question_id": 44804153, "link": "https://stackoverflow.com/questions/44804153/do-while-infinite-loop-in-qt", "title": "Do-while infinite loop in Qt", "body": "<p>I'm trying to read in a file of trace addresses (each on their own line) and append to the front of each. This input file is intended to be the engine of a cache emulator i'm trying to build. I am having issues reading the file in without getting into an infinite loop. When I change the do-while to run on a false condition, I get the proper output for just the do segment. Therefore, I know I'm running into an infinite loop issue with how I worded my while segment. Maybe i'm fatigued and can't see the issue with this function: </p>\n\n<pre><code>void MainWindow::readFile(){\n    infoLabel-&gt;setText(tr(\"Invoked &lt;b&gt;File|Open&lt;/b&gt;\"));\n    QString filename=\"trace.txt\";\n    QString path = QDir::currentPath();\n    QFile file(\"//Users//nathan1324//Desktop//trace.txt\");\n    //file.open(QIODevice::ReadOnly);\n    if(!file.exists()){\n        qDebug() &lt;&lt; \"File cannot be found \"&lt;&lt;filename;\n        qDebug() &lt;&lt; \" \" &lt;&lt; path;\n    }else{\n        qDebug() &lt;&lt; filename&lt;&lt;\" Opening...\";\n    }\n    QString line;\n    textEdit-&gt;clear();\n    if (file.open(QIODevice::ReadOnly | QIODevice::Text)){\n        QTextStream stream(&amp;file);\n        do {\n            line = stream.readLine();\n            textEdit-&gt;setText(textEdit-&gt;toPlainText()+\"0x\"+line+\"\\n\");\n            qDebug() &lt;&lt; \"line: \"&lt;&lt;line;\n        } while (!line.isNull());\n    }\n    file.close();\n}\n</code></pre>\n\n<p>Any suggestions of an alternative way to write this function? </p>\n"}, {"tags": ["c++", "constructor", "c++17", "virtual-inheritance", "ctor-initializer"], "comments": [{"owner": {"reputation": 1518, "user_id": 2434628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f694c7757c0085ac1f0ed88d960ff657?s=128&d=identicon&r=PG", "display_name": "AresCaelum", "link": "https://stackoverflow.com/users/2434628/arescaelum"}, "edited": false, "score": 0, "creation_date": 1498657180, "post_id": 44804036, "comment_id": 76588192, "body": "Can you format your code a bit better?  the way it is currently written is just a mess."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 3, "creation_date": 1498657372, "post_id": 44804036, "comment_id": 76588365, "body": "&quot;virtual base non-default constructors &quot; constructors cannot be virtual though."}, {"owner": {"reputation": 3514, "user_id": 2612002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b5a04.png?s=128&g=1", "display_name": "iehrlich", "link": "https://stackoverflow.com/users/2612002/iehrlich"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 4, "creation_date": 1498657536, "post_id": 44804036, "comment_id": 76588498, "body": "@Rakete1111 I believe it should be read as <b>virtual base</b> non-default constructors :)"}, {"owner": {"reputation": 611, "user_id": 690051, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d39729069b0cf04b150b3b6e697925bd?s=128&d=identicon&r=PG", "display_name": "JVD", "link": "https://stackoverflow.com/users/690051/jvd"}, "edited": false, "score": 0, "creation_date": 1498657888, "post_id": 44804036, "comment_id": 76588809, "body": "Sorry for formatting issues - I don&#39;t like using web tools to format code, because I cannot see the format tool icons and display light text on a dark background (any other setting hurts my eyes - I am slightly visually impaired) .  So emacs &#39;&lt;^U&gt;-4-&lt;ESC&gt;-m-indent-region&#39; will have to do.   And yes, it is &#39;the non-default constructor of a virtual base class&#39; , not any &#39;virtual constructor&#39; ."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1498658087, "post_id": 44804036, "comment_id": 76589018, "body": "This isn&#39;t the problem, but names that begin with an underscore followed by a capital letter (<code>_WITH_BUG_</code>) and names that contain two consecutive underscores are reserved for use by the implementation. Don&#39;t use them in your code."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 2, "creation_date": 1498658179, "post_id": 44804036, "comment_id": 76589100, "body": "The issue here isn&#39;t non-default constructors; the rule is that virtual bases are initialized by the constructor for the most-derived type. That applies to default constructors as well as non-default constructors."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1498659568, "post_id": 44804036, "comment_id": 76590267, "body": "@PeteBecker OPs problem is exacerbated by <code>A::A()</code> being implicitly available for the compiler to insert it at the start of <code>C::C(int, int, int)</code>. It would be nicer if the omission was a compile time error"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1498662739, "post_id": 44804036, "comment_id": 76592765, "body": "@Caleth -- &#39;A::A()` is <b>always</b> &quot;implicitly available for the compiler to insert&quot;, with or without multiple inheritance and virtual bases. You&#39;re suggesting that the default constructor <b>never</b> be considered as a default when there are other constructors defined in a class. That&#39;s pretty drastic."}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 690051, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d39729069b0cf04b150b3b6e697925bd?s=128&d=identicon&r=PG", "display_name": "JVD", "link": "https://stackoverflow.com/users/690051/jvd"}, "edited": false, "score": 0, "creation_date": 1498659279, "post_id": 44804511, "comment_id": 76590017, "body": "correction, that does not really explain the rationale, only that the C++ standard mandates it to be the case.  IMHO, once a programmer has declared that B &#39;is an A&#39;, virtually or not, then B should be responsible for constructing its &#39;A&#39; ."}, {"owner": {"reputation": 611, "user_id": 690051, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d39729069b0cf04b150b3b6e697925bd?s=128&d=identicon&r=PG", "display_name": "JVD", "link": "https://stackoverflow.com/users/690051/jvd"}, "edited": false, "score": 0, "creation_date": 1498659392, "post_id": 44804511, "comment_id": 76590124, "body": "I still see no reason why B cannot always construct its A, regardless of whether or not it is a virtual base of some class C .  But I must accept this is the way it is ..."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1498659400, "post_id": 44804511, "comment_id": 76590133, "body": "&quot;its &#39;A&#39;&quot; -&gt; shared with all the other classes virtually inheriting A in a deriving class"}, {"owner": {"reputation": 3128, "user_id": 2899520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d046c85ed155fb3e964d9dd4c43842a?s=128&d=identicon&r=PG&f=1", "display_name": "LearningC", "link": "https://stackoverflow.com/users/2899520/learningc"}, "reply_to_user": {"reputation": 611, "user_id": 690051, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d39729069b0cf04b150b3b6e697925bd?s=128&d=identicon&r=PG", "display_name": "JVD", "link": "https://stackoverflow.com/users/690051/jvd"}, "edited": false, "score": 0, "creation_date": 1498725649, "post_id": 44804511, "comment_id": 76620489, "body": "@JVD Here B cannot construct &#39;A&#39; since A is a virtual base the most derived class C has to construct it. This is how the diamond problem is solved. you can check the post link <a href=\"https://stackoverflow.com/questions/2659116/how-does-virtual-inheritance-solve-the-diamond-multiple-inheritance-ambiguit\" title=\"how does virtual inheritance solve the diamond multiple inheritance ambiguit\">stackoverflow.com/questions/2659116/&hellip;</a> . If you see there if the intermediate classes constructs the virtual base then all intermediate classes will need to construct the single virtual base class object."}], "tags": [], "owner": {"reputation": 3128, "user_id": 2899520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d046c85ed155fb3e964d9dd4c43842a?s=128&d=identicon&r=PG&f=1", "display_name": "LearningC", "link": "https://stackoverflow.com/users/2899520/learningc"}, "is_accepted": false, "score": 1, "last_activity_date": 1498880979, "last_edit_date": 1498880979, "creation_date": 1498658011, "answer_id": 44804511, "question_id": 44804036, "link": "https://stackoverflow.com/questions/44804036/why-are-virtual-base-non-default-constructors-not-called-unless-most-derived-bas/44804511#44804511", "title": "why are virtual base non-default constructors not called unless most-derived base explicitly invokes them?", "body": "<p>This behavior is because of <code>virtual base class</code>. Since A is the virtual base class it is constructed by the most derived class.<br>\nyou can check about <a href=\"https://stackoverflow.com/questions/2659116/how-does-virtual-inheritance-solve-the-diamond-multiple-inheritance-ambiguit\">diamond shape inheritance problem</a> and <a href=\"https://stackoverflow.com/questions/6461784/understanding-virtual-base-classes-and-constructor-calls\">this discussion on similar question</a> to understand why it has to be in this way.<br>\nFirst understand how diamod shape problem is solved by virtual base class.<br>\n<code>class A {   ...}</code><br>\n<code>class B: virtual public A {...}</code><br>\n<code>class C: virtual public A {...}</code><br>\n<code>class D: public B, public C {...}</code><br>\nWhen you make the base class as virtual there will be one base class object. The intermediate derived class objects will all refer to the same single base class object. I.e. here if an object of <code>D</code> is created then B::A and C::A both will refer the same object. This single object is of base class of both B and C. So there are two derived classes to construct this single object if it  allowed the construction of base class object by intermediate classes. This ambiguity is solved by giving the most derived class the responsibility to construct the virtual base class. </p>\n"}, {"comments": [{"owner": {"reputation": 611, "user_id": 690051, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d39729069b0cf04b150b3b6e697925bd?s=128&d=identicon&r=PG", "display_name": "JVD", "link": "https://stackoverflow.com/users/690051/jvd"}, "edited": false, "score": 0, "creation_date": 1498659031, "post_id": 44804570, "comment_id": 76589828, "body": "to me that is kludgey, that the programmer must remember that their explicit invocation of B(a,b) is ignored."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 611, "user_id": 690051, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d39729069b0cf04b150b3b6e697925bd?s=128&d=identicon&r=PG", "display_name": "JVD", "link": "https://stackoverflow.com/users/690051/jvd"}, "edited": false, "score": 0, "creation_date": 1498659246, "post_id": 44804570, "comment_id": 76589988, "body": "The other option is to <i>not virtually inherit</i>"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 1, "last_activity_date": 1498658172, "creation_date": 1498658172, "answer_id": 44804570, "question_id": 44804036, "link": "https://stackoverflow.com/questions/44804036/why-are-virtual-base-non-default-constructors-not-called-unless-most-derived-bas/44804570#44804570", "title": "why are virtual base non-default constructors not called unless most-derived base explicitly invokes them?", "body": "<p>It's unlikely that you'll get any support to change the language. Virtual inheritance is <em>only</em> useful in multiple inheritance scenarios.</p>\n\n<blockquote>\n  <p>Why must B(int a, int b)'s invocation of A(a) be ignored here?</p>\n</blockquote>\n\n<p>Because the unique A sub-object has already been constructed. A constructor isn't an ordinary function, you can't just call it anywhere.</p>\n\n<p>You can write </p>\n\n<pre><code>C(int a, int b, int c)\n    : A(a), B(a, b), _c(c)\n    { ... }\n</code></pre>\n\n<p>which will give the body of <code>B::B(int, int)</code> the parameter that passed to <code>A::A(int)</code></p>\n"}, {"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 3, "last_activity_date": 1498671663, "creation_date": 1498671663, "answer_id": 44809274, "question_id": 44804036, "link": "https://stackoverflow.com/questions/44804036/why-are-virtual-base-non-default-constructors-not-called-unless-most-derived-bas/44809274#44809274", "title": "why are virtual base non-default constructors not called unless most-derived base explicitly invokes them?", "body": "<p>The entire purpose of having virtual inheritance is to solve the <a href=\"https://stackoverflow.com/q/21558/2069064\">diamond problem</a>. Once you have a virtual base class, and your hierarchy looks like this:</p>\n\n<pre><code>  A\n / \\\nB   C\n \\ /\n  D\n</code></pre>\n\n<p>You need to know <em>when</em> to construct the <code>A</code>. You can't have <code>B</code> construct it and then <code>C</code> then immediately overwrite it - you need it to be constructed exactly once. Okay, so when can we do that? The simplest choice is just: make the most derived class do it! So when we're initializing the <code>B</code> subobject of <code>D</code>, it <em>will not</em> initialize its <code>A</code> subobject because <code>B</code> is not the most derived type.</p>\n\n<p>In your case, your hierarchy is still linear:</p>\n\n<pre><code>A\n|\nB\n|\nC\n</code></pre>\n\n<p>but the most derived type, <code>C</code>, has to initialize all the virtual bases - <code>A</code> and <code>B</code>. <code>B</code> won't initialize its <code>A</code> subobject for the same reason as it didn't in the complicated example.</p>\n"}], "owner": {"reputation": 611, "user_id": 690051, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d39729069b0cf04b150b3b6e697925bd?s=128&d=identicon&r=PG", "display_name": "JVD", "link": "https://stackoverflow.com/users/690051/jvd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1531754800, "creation_date": 1498656837, "last_edit_date": 1531754800, "question_id": 44804036, "link": "https://stackoverflow.com/questions/44804036/why-are-virtual-base-non-default-constructors-not-called-unless-most-derived-bas", "title": "why are virtual base non-default constructors not called unless most-derived base explicitly invokes them?", "body": "<p>I would like to understand WHY C++ standard mandates that virtual base non-default constructors cannot be invoked by an intermediate NOT most-derived\nclass, as in this code, when compiled with '-D_WITH_BUG_'  :</p>\n\n<pre><code>/*  A virtual base's non-default constructor is NOT called UNLESS \n *  the MOST DERIVED class explicitly invokes it\n */\n\n#include &lt;type_traits&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nclass A\n{\npublic:\n    int _a;\n    A():  _a(1)\n    {\n        std::cerr &lt;&lt; \"A() - me: \" &lt;&lt; ((void*)this) &lt;&lt; std::endl;\n    }\n    A(int a): _a(a)\n    {\n        std::cerr &lt;&lt; \"A(a) - me:\" &lt;&lt; ((void*)this) &lt;&lt; std::endl;\n    }\n    virtual ~A()\n    {\n        std::cerr &lt;&lt; \"~A\" &lt;&lt; ((void*)this) &lt;&lt; std::endl;\n    }\n};\n\nclass B: public virtual A\n{\npublic:\n    int _b;\n    B(): A(), _b(2)\n    {\n        std::cerr &lt;&lt; \"B() - me: \" &lt;&lt; ((void*)this) &lt;&lt; std::endl;\n    }\n    B(int b) : A(), _b(b)\n    {\n        std::cerr &lt;&lt; \"B(b) - me: \" &lt;&lt; ((void*)this) &lt;&lt; std::endl;\n    }\n    B(int a, int b): A(a), _b(b)\n    {\n        std::cerr &lt;&lt; \"B(a,b) - me: \" &lt;&lt; ((void*)this) &lt;&lt; std::endl;\n    }\n    virtual ~B()\n    {\n        std::cerr &lt;&lt; \"~B\" &lt;&lt; ((void*)this) &lt;&lt; std::endl;\n    }\n};\n\nclass C: public virtual B\n{\npublic:\n    int _c;\n    C(): B(), _c(3)\n    {\n        std::cerr  &lt;&lt; \"C()\" &lt;&lt; std::endl;\n    }\n    C(int a, int b, int c)\n    :\n#ifdef _WITH_BUG_    \n    B(a,b)\n#else\n    A(a), B(b)\n#endif    \n    , _c(c)\n    {\n        std::cerr  &lt;&lt; \"C(a,b) - me: \" &lt;&lt; ((void*)this) &lt;&lt; std::endl;    \n    }\n    virtual ~C()\n    {\n        std::cerr &lt;&lt; \"~C\" &lt;&lt; ((void*)this) &lt;&lt; std::endl;\n    }  \n};\nextern \"C\"\nint main(int argc, const char *const* argv, const char *const* envp)\n{\n    C c(4,5,6);\n    std::cerr &lt;&lt; \" a: \" &lt;&lt; c._a  &lt;&lt; \" b: \" &lt;&lt; c._b &lt;&lt; \" c: \" &lt;&lt; c._c \n              &lt;&lt;  std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>So, when compiled WITHOUT -D_WITH_BUG_, the code prints:</p>\n\n<pre><code>$ g++ -I. -std=gnu++17 -mtune=native -g3 -fPIC -pipe -Wall -Wextra \\\n  -Wno-unused -fno-pretty-templates -Wno-register  \\\n  tCXX_VB.C -o tCXX_VB \n$ ./tCXX_VB\nA(a) - me:0x7ffc410b8c10\nB(b) - me: 0x7ffc410b8c00\nC(a,b) - me: 0x7ffc410b8bf0\na: 4 b: 5 c: 6\n~C0x7ffc410b8bf0\n~B0x7ffc410b8c00\n~A0x7ffc410b8c10\n</code></pre>\n\n<p>But when compiled with -D_WITH_BUG_ :</p>\n\n<pre><code>$ g++ -I. -std=gnu++17 -mtune=native -g3 -fPIC -pipe -Wall -Wextra \\ \n  -Wno-unused -fno-pretty-templates -Wno-register \\\n  -D_WITH_BUG_ tCXX_VB.C -o tCXX_VB\n$ ./tCXX_VB\nA() - me: 0x7ffd7153cb60\nB(a,b) - me: 0x7ffd7153cb50\nC(a,b) - me: 0x7ffd7153cb40\na: 1 b: 5 c: 6\n~C0x7ffd7153cb40\n~B0x7ffd7153cb50\n~A0x7ffd7153cb60\n</code></pre>\n\n<p>Why must B(int a, int b)'s invocation of A(a) be ignored here ?\nI understand the C++ standard mandates it, but why ? What is the rational ?</p>\n\n<p>If I instantiate just a B object :\n   B b(4,5) ;\nthis DOES get a correct b._a value of 4; but if B is a subclass of C:\n   C c(4,5,6)\nC::a ends up being 1, IFF c does not DIRECTLY INVOKE A(a) .\nSo the value of a B(a,b) is different if it is a subclass object\nthan if it is a most-derived object .\nThis to me is very confusing and wrong. Is there any hope of getting\nenough people to agree to change the C++ standard on this ?</p>\n"}, {"tags": ["c++", "stream"], "comments": [{"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1498656079, "post_id": 44803572, "comment_id": 76587319, "body": "Will <code>struct A</code> own the stream in all cases?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498656118, "post_id": 44803572, "comment_id": 76587354, "body": "As for your problem, <a href=\"http://en.cppreference.com/w/cpp/io/basic_ios/rdbuf\" rel=\"nofollow noreferrer\">this <code>rdbuf</code> reference</a> basically says that it&#39;s okay to not have an associated stream buffer. So it should certainly be okay to set it to a null pointer. It&#39;s not authoritative though."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1498656170, "post_id": 44803572, "comment_id": 76587393, "body": "@rex No - In the first case, the stream must remain alive as long next to the <code>A</code> instance (this could typically be used with <code>std::cin</code>)."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1498656220, "post_id": 44803572, "comment_id": 76587441, "body": "If the stream was created as a shared pointer then you could store a shared pointer to the base in <code>struct A</code> i.e. <code>std::istream</code> without losing the complete object such as <code>std::stringstream</code> or <code>std::ifstream</code>. It seems to me like slicing is a risk otherwise."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1498657516, "post_id": 44803572, "comment_id": 76588481, "body": "So if you pass an lvalue to the constructor you want to store a reference, but if you pass an rvalue then you want to move it into <code>A</code>?"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1498657771, "post_id": 44803572, "comment_id": 76588699, "body": "@rex kind of - I am not an expert regarding stream but as far as I know, the whole logic of stream is embedded in their buffer (eg stringstream only provide extra constructor and accessor compared to istream), but I don&#39;t know how the buffer is managed or if this is even defined..."}], "answers": [{"comments": [{"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1498839757, "post_id": 44804726, "comment_id": 76682741, "body": "Unfortunately this does not work - <code>A(std::istream &amp;)</code> is a better match than the template for object of type <code>std::istream</code>, but the template constructor is a better match for object of type derived from <code>std::istream</code>, e.g. <code>std::ifstream if; A a{if};</code> does not compile."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1498841695, "post_id": 44804726, "comment_id": 76683729, "body": "@Holt Good point. I&#39;ve updated so that both constructors are templates."}], "tags": [], "owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "is_accepted": false, "score": 1, "last_activity_date": 1498841643, "last_edit_date": 1498841643, "creation_date": 1498658509, "answer_id": 44804726, "question_id": 44803572, "link": "https://stackoverflow.com/questions/44803572/swapping-buffer-of-stream-with-nullptr-to-simulate-move/44804726#44804726", "title": "Swapping buffer of stream with nullptr to simulate move?", "body": "<p>It is probably best to avoid dealing with the buffers and to let the objects do the work for us internally.</p>\n\n<p>I propose the following. With a template we can be sure to construct a shared pointer of the full type when we move a stream into the struct.</p>\n\n<pre><code>#include &lt;sstream&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;memory&gt;\n#include &lt;typeinfo&gt;\n\nstruct A {\n    template&lt;typename T&gt;\n    A(T&amp; is) : is{is}\n    {\n        std::cout &lt;&lt; \"Only taking a reference. Not taking ownership of std::istream.\\n\";\n    }\n\n    template&lt;typename T&gt;\n    A(T&amp;&amp; is) : own_is{std::make_unique&lt;T&gt;(std::move(is))}, is{*own_is}\n    {\n        std::cout &lt;&lt; \"using move. Not sliced.\\n\";\n    }\n\n    void print_stream_type()\n    {\n        std::cout &lt;&lt; typeid(is).name() &lt;&lt; '\\n';\n    }\nprotected:\n    std::unique_ptr&lt;std::istream&gt; own_is;\n    std::istream&amp; is;\n};\n\nint main()\n{\n    A a1{std::stringstream{\"hello world!\"}};\n\n    A a2{std::cin};\n\n    std::ifstream ifs{\"input.txt\"}; \n    A a3{ifs};\n\n    A a4{std::ifstream{\"input.txt\"}};\n\n    a1.print_stream_type();\n    a2.print_stream_type();\n    a3.print_stream_type();\n    a4.print_stream_type();\n\n}\n</code></pre>\n\n<p>Output on MSVC2017:</p>\n\n<pre><code>using move. Not sliced.\nOnly taking a reference. Not taking ownership of std::istream.\nOnly taking a reference. Not taking ownership of std::istream.\nusing move. Not sliced.\nclass std::basic_stringstream&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;\nclass std::basic_istream&lt;char,struct std::char_traits&lt;char&gt; &gt;\nclass std::basic_ifstream&lt;char,struct std::char_traits&lt;char&gt; &gt;\nclass std::basic_ifstream&lt;char,struct std::char_traits&lt;char&gt; &gt;\n</code></pre>\n\n<p>Also note the sequence of the members in the struct is important. The <code>own_is</code> variable will be null if <code>A</code> is constructed via a reference. But if we pass an rvalue then it will create the shared pointer first and then dereference it to pass a valid reference. In both cases the same reference points to the stream.</p>\n"}], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498841643, "creation_date": 1498655679, "last_edit_date": 1498655970, "question_id": 44803572, "link": "https://stackoverflow.com/questions/44803572/swapping-buffer-of-stream-with-nullptr-to-simulate-move", "title": "Swapping buffer of stream with nullptr to simulate move?", "body": "<p>I want to store a <code>std::istream</code> in a structure and be able to construct it from another stream. Currently, I have the following:</p>\n\n<pre><code>struct A {\n    A(std::istream &amp;in) : in_(in.rdbuf()) { }\nprotected:\n    std::istream in_;\n};\n</code></pre>\n\n<p>This only allow to create an object of type <code>A</code> from already created object, but I would like to be able to the following:</p>\n\n<pre><code>A(std::stringstream(\"hello world!\"));\n</code></pre>\n\n<p>I added the following overload of <code>A</code> for rvalue-reference to <code>std::istream</code>:</p>\n\n<pre><code>A(std::istream &amp;&amp;in) : in_(in.rdbuf()) {\n    in.rdbuf(nullptr); // (1)\n}\n</code></pre>\n\n<p>I have added <code>(1)</code> to avoid having the buffer being destroyed after the sequence point, but I don't know if this behavior is defined or if this actually makes any sense?</p>\n\n<p>Can I \"move\" a stream buffer like so according to the standard? If not, would this work with standard implementation and stream (<code>std::stringstream</code>, <code>std::fstream</code>, ...)?</p>\n"}, {"tags": ["c++", "windows", "cmd", "logout"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1498655271, "post_id": 44803401, "comment_id": 76586651, "body": "Are you using a special terminal to start a <i>session</i>?"}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1498655565, "post_id": 44803401, "comment_id": 76586917, "body": "1. maybe nos-standard terminal (like @\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 say), 2. different permisssions for service"}, {"owner": {"reputation": 159, "user_id": 7549910, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0f220484f1d7f39f11a766052012b9f?s=128&d=identicon&r=PG&f=1", "display_name": "Neumann", "link": "https://stackoverflow.com/users/7549910/neumann"}, "edited": false, "score": 0, "creation_date": 1498658832, "post_id": 44803401, "comment_id": 76589665, "body": "I am running on a Windows 10 Enterprise machine. I&#39;m not testing as a service yet. Only by running, as administrator, a c ++ application that tries to execute the command. So the access rights of the services is not important yet. Yes, it may have to do with access rights of the applications, but the message should not be another?"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1498662342, "post_id": 44803401, "comment_id": 76592463, "body": "Probably you built a 32-bit application, for which <code>system</code> executes 32-bit cmd.exe, for which System32 gets redirected to SysWOW64, which has the 32-bit system binaries. reset.exe is only distributed as a 64-bit executable in the real System32 folder. A 32-bit application can access this via the virtual path <code>%SystemRoot%\\SysNative\\reset.exe</code>."}, {"owner": {"reputation": 159, "user_id": 7549910, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0f220484f1d7f39f11a766052012b9f?s=128&d=identicon&r=PG&f=1", "display_name": "Neumann", "link": "https://stackoverflow.com/users/7549910/neumann"}, "edited": false, "score": 0, "creation_date": 1498665075, "post_id": 44803401, "comment_id": 76594583, "body": "Thanks eryksun, I think you are right. Do you know what can i do to built in Visual Studio a 64-bit application?"}, {"owner": {"reputation": 159, "user_id": 7549910, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0f220484f1d7f39f11a766052012b9f?s=128&d=identicon&r=PG&f=1", "display_name": "Neumann", "link": "https://stackoverflow.com/users/7549910/neumann"}, "edited": false, "score": 0, "creation_date": 1498667092, "post_id": 44803401, "comment_id": 76595945, "body": "system(&quot;%SystemRoot%\\\\SysNative\\\\RESET SESSION console&quot;);works well.Thank you eryksun."}], "owner": {"reputation": 159, "user_id": 7549910, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0f220484f1d7f39f11a766052012b9f?s=128&d=identicon&r=PG&f=1", "display_name": "Neumann", "link": "https://stackoverflow.com/users/7549910/neumann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498661721, "creation_date": 1498655201, "last_edit_date": 1498661721, "question_id": 44803401, "link": "https://stackoverflow.com/questions/44803401/c-how-to-execute-a-reset-session-command", "title": "C++ How to execute a &quot;RESET SESSION&quot; command", "body": "<p>I need to create in C ++ a service that terminates the session of all logged users  in after a certain time.</p>\n\n<p>On the console I can simply type:</p>\n\n<pre><code>RESET SESSION console\n</code></pre>\n\n<p>or</p>\n\n<pre><code>RESET SESSION &lt;int id&gt;\n</code></pre>\n\n<p>But when I try to execute this command in the service code, run exe as administrator:</p>\n\n<pre><code>system(\"RESET SESSION console\");\n</code></pre>\n\n<p>I get message that RESET is not a valid internal command.</p>\n\n<p>Any suggestion?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1498655116, "post_id": 44803297, "comment_id": 76586510, "body": "Check <code>boost::filesystem</code> or the new functions in the standard library for the upcoming c++17 standard."}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1498655270, "post_id": 44803297, "comment_id": 76586649, "body": "<a href=\"http://man7.org/linux/man-pages/man2/chdir.2.html\" rel=\"nofollow noreferrer\">chdir</a> &quot;The current working directory is the starting point for interpreting relative pathnames (those not starting with &#39;/&#39;).&quot; So <code>&#47;</code> at the beginning for absolute path, <code>..&#47;</code> to go up one, <code>..&#47;..&#47;</code> to go up two, etc."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 4, "creation_date": 1498655324, "post_id": 44803297, "comment_id": 76586694, "body": "How do you know what directory to change to? Where does that information come from? You have either a relative path to it or an absolute path to it, otherwise you have a disembodied name that could relate to any one of thousands of directories in different places with the same name."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1498655595, "post_id": 44803297, "comment_id": 76586948, "body": "Can you provide some code that illustrates what you have and what you are trying to do? Right now I find it rather unclear."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1498656267, "post_id": 44803297, "comment_id": 76587489, "body": "It isn&#39;t quite clear what <code>getFilePath</code> you have in mind. It doesn&#39;t look like there&#39;s such function in the Java platform. It is also unclear why you hope to be able to locate a directory or file by name without using any kind of path. If we could do that we would not need hierarchical file names."}, {"owner": {"reputation": 37, "user_id": 8220505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sezWV.jpg?s=128&g=1", "display_name": "kilpikonna", "link": "https://stackoverflow.com/users/8220505/kilpikonna"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498656942, "post_id": 44803297, "comment_id": 76587989, "body": "@n.m : I&#39;m sorry, you&#39;re right. getFilePath doesn&#39;t exist in Java platform, it&#39;s my function I&#39;ve writen and I use it so often that I just believed it&#39;s a standard one. Sorry for this confusion, I&#39;ve edited my question."}, {"owner": {"reputation": 37, "user_id": 8220505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sezWV.jpg?s=128&g=1", "display_name": "kilpikonna", "link": "https://stackoverflow.com/users/8220505/kilpikonna"}, "edited": false, "score": 0, "creation_date": 1498657315, "post_id": 44803297, "comment_id": 76588314, "body": "And then, I know that&#39;s unclear what I&#39;m looking for. To be more precise, I have a Java code in directoryA that calls the C++ executable placed in directoryB which uses some files from that directoryB. But as the C++ executable is called from the Java file, the current directory is directoryA. Of course, I know the path to the both directories. For instant, I stock it in a constant and I use chdir with this constant. But i just don&#39;t find this solution nice, so I asked myself if I could know the directoryB path &quot;automatically&quot;, without the constant."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1498657599, "post_id": 44803297, "comment_id": 76588550, "body": "@kilpikonna: Don&#39;t comment your own question, but do <b>edit your question</b> to improve it"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8220505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sezWV.jpg?s=128&g=1", "display_name": "kilpikonna", "link": "https://stackoverflow.com/users/8220505/kilpikonna"}, "edited": false, "score": 0, "creation_date": 1498656638, "post_id": 44803393, "comment_id": 76587779, "body": "Thank you for a very clear and straightforward response. I knew getcwd and realpath, but I didn&#39;t know nftw(3) and it seems it is what I was looking for. This helped me!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 37, "user_id": 8220505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sezWV.jpg?s=128&g=1", "display_name": "kilpikonna", "link": "https://stackoverflow.com/users/8220505/kilpikonna"}, "edited": false, "score": 0, "creation_date": 1498657436, "post_id": 44803393, "comment_id": 76588419, "body": "@kilpikonna &quot;it seems it is what I was looking for&quot; Either you are mistaken or your design is totally broken."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 0, "last_activity_date": 1498656816, "last_edit_date": 1498656816, "creation_date": 1498655183, "answer_id": 44803393, "question_id": 44803297, "link": "https://stackoverflow.com/questions/44803297/c-path-to-the-directory-given-its-name/44803393#44803393", "title": "C++ Path to the directory given its name", "body": "<p>First, you might have <em>several</em> sub-directories (in various directories) sharing the same name (so you could have both <code>a/xx/</code> and <code>b/c/xx/</code>)</p>\n\n<p>You could use <a href=\"http://man7.org/linux/man-pages/man3/nftw.3.html\" rel=\"nofollow noreferrer\">nftw(3)</a> to find something in a file tree and <a href=\"http://man7.org/linux/man-pages/man2/getcwd.2.html\" rel=\"nofollow noreferrer\">getcwd(2)</a> to get the current directory. You could also consider using <a href=\"http://man7.org/linux/man-pages/man3/opendir.3.html\" rel=\"nofollow noreferrer\">opendir(3)</a>, <a href=\"http://man7.org/linux/man-pages/man3/readdir.3.html\" rel=\"nofollow noreferrer\">readdir(3)</a>, <a href=\"http://man7.org/linux/man-pages/man3/closedir.3.html\" rel=\"nofollow noreferrer\">closedir(3)</a> to scan one directory (and build complete paths to be passed to <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat(2)</a>)</p>\n\n<p>Then, to get some \"canonical\" path, consider using <a href=\"http://man7.org/linux/man-pages/man3/realpath.3.html\" rel=\"nofollow noreferrer\">realpath(3)</a></p>\n\n<p>Notice that <a href=\"http://man7.org/linux/man-pages/man3/glob.3.html\" rel=\"nofollow noreferrer\">glob(3)</a> (see also <a href=\"http://man7.org/linux/man-pages/man7/glob.7.html\" rel=\"nofollow noreferrer\">glob(7)</a>), <a href=\"http://man7.org/linux/man-pages/man3/fnmatch.3.html\" rel=\"nofollow noreferrer\">fnmatch(3)</a>, <a href=\"http://man7.org/linux/man-pages/man3/wordexp.3.html\" rel=\"nofollow noreferrer\">wordexp(3)</a> could be useful too.</p>\n"}, {"tags": [], "owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "is_accepted": false, "score": 2, "last_activity_date": 1498655446, "creation_date": 1498655446, "answer_id": 44803474, "question_id": 44803297, "link": "https://stackoverflow.com/questions/44803297/c-path-to-the-directory-given-its-name/44803474#44803474", "title": "C++ Path to the directory given its name", "body": "<p>You could use getcwd to get the absolute path name of the current directory.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n\nchar * getcwd(char *buf, size_t bufsize);\n</code></pre>\n\n<p>To change to another directory, you need know either the absolute path to the other direrctory, or its relative path to it such as ../someotherdirectory </p>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1498656025, "post_id": 44803483, "comment_id": 76587262, "body": "I don&#39;t think that forking a process is sensible in this case. <a href=\"http://man7.org/linux/man-pages/man3/nftw.3.html\" rel=\"nofollow noreferrer\">nftw(3)</a> could be more relevant"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1498659595, "post_id": 44803483, "comment_id": 76590288, "body": "@BasileStarynkevitch: Well you can read the DB directly--it&#39;s just a file.  However, I don&#39;t love the <code>nftw()</code> solution if it means traversing a lot of directories.  The DB solution is just an indexed lookup which if you have a large filesystem could be hugely more efficient."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 0, "last_activity_date": 1498655463, "creation_date": 1498655463, "answer_id": 44803483, "question_id": 44803297, "link": "https://stackoverflow.com/questions/44803297/c-path-to-the-directory-given-its-name/44803483#44803483", "title": "C++ Path to the directory given its name", "body": "<p>It seems like you want to \"search\" for a directory by name.  I suggest using the <code>locate</code> database for this.  You can try it on the command line:</p>\n\n<pre><code>locate AnotherDirectory\n</code></pre>\n\n<p>This will print all the files and directories on your local disks which are indexed.</p>\n\n<p>Using this database could improve performance a lot if you don't know where to look for this directory.  You can read about where to find the underlying file here: <a href=\"https://serverfault.com/questions/454127/where-is-the-updatedb-database-located\">https://serverfault.com/questions/454127/where-is-the-updatedb-database-located</a> - but you could also just use <code>popen()</code> to run the <code>locate</code> program for a more portable solution than directly reading the database files.</p>\n\n<p>Of course you will still need to write application logic to deal with multiple directories having the same name and so on.</p>\n"}], "owner": {"reputation": 37, "user_id": 8220505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sezWV.jpg?s=128&g=1", "display_name": "kilpikonna", "link": "https://stackoverflow.com/users/8220505/kilpikonna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 44803393, "answer_count": 3, "score": 1, "last_activity_date": 1498656817, "creation_date": 1498654932, "last_edit_date": 1498656817, "question_id": 44803297, "link": "https://stackoverflow.com/questions/44803297/c-path-to-the-directory-given-its-name", "title": "C++ Path to the directory given its name", "body": "<p>I'm writing a C++ program in Linux and I would need to change the current directory. I have a name of the directory I want to change it on, and I    want to use the chdir(). But it's argument is a path (i.e. the char* containing the directory location). And I don't have the full path, but just the name of directory. </p>\n\n<p>I've seen this question: <a href=\"https://stackoverflow.com/questions/3747014/changing-the-current-directory-in-linux-using-c\">Changing the current directory in Linux using C++</a></p>\n\n<p>However, I think that the proposed solution works only if the new directory is the sub directory of the current directory - otherwise, it doesn't make a sense for me if there can be more different directories of the same name in my computer (please, tell me if I'm wrong). </p>\n\n<p>I'm not sure if I'm clear, to be sure, here is the example: </p>\n\n<pre><code>-CurrentDirectory\n    |\n    - Subdirectory\n    |\n    - ... etc.\n- AnotherDirectory \n</code></pre>\n\n<p>In my opitnion, if I want change the current directory to Subsirectory, <code>chdir(Subdirectory.c_str())</code> would work. But not <code>chdir(AnotherDirectory.str())</code> (which has nothing in common with CurrentDirectory in general). \n I know this question has to be already answered somewhere, but I'm not able to find it. </p>\n\n<p>Thank you for your time!   </p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498655031, "post_id": 44803215, "comment_id": 76586451, "body": "Unrelated to your problem, but your structures input operator will not be able to read what your output operator writes. Also, they should be marked as either <code>static</code> or <code>inline</code> or else you will have problems when you try to use the class from multiple source files (<a href=\"https://en.wikipedia.org/wiki/Translation_unit_(programming)\" rel=\"nofollow noreferrer\"><i>translation units</i></a>). You should also have some <a href=\"https://en.wikipedia.org/wiki/Include_guard\" rel=\"nofollow noreferrer\">header include guards</a>."}, {"owner": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "edited": false, "score": 2, "creation_date": 1498655244, "post_id": 44803215, "comment_id": 76586622, "body": "Could you please comment on line <code>copy(vec.begin(), vec.end(), istr);</code>? In this line you&#39;re trying to copy data from a <code>vector</code> (which is empty) to <code>istream</code> (which is read-only). It looks very-very strange. Perhaps the mistake is in this line."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "edited": false, "score": 0, "creation_date": 1498655318, "post_id": 44803215, "comment_id": 76586690, "body": "@alexeykuzmin0 Oh the vector isn&#39;t empty, it should have been populated above from <code>std::cin</code>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1498655378, "post_id": 44803215, "comment_id": 76586747, "body": "@X21 -- Another side note -- don&#39;t write empty destructors (<code>~WRstruct()</code>).  The compiler may not optimize the code as well if it encounters that you&#39;ve written a destructor (instead of relying on the compiler&#39;s default destructor).  Write a user-defined destructor when you actually need one."}, {"owner": {"reputation": 158, "user_id": 8226050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66da411fe004c8fc634a1a336c491bca?s=128&d=identicon&r=PG&f=1", "display_name": "X21", "link": "https://stackoverflow.com/users/8226050/x21"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498655461, "post_id": 44803215, "comment_id": 76586820, "body": "@Someprogrammerdude     Could you please show , how I should to do this ? Because I had never met using <code>static</code> or <code>inline</code> marked"}, {"owner": {"reputation": 692, "user_id": 2920698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WA5I3.jpg?s=128&g=1", "display_name": "voltento", "link": "https://stackoverflow.com/users/2920698/voltento"}, "edited": false, "score": 0, "creation_date": 1498655467, "post_id": 44803215, "comment_id": 76586828, "body": "<code>friend std::istream&amp; operator&gt;&gt;( std::istream&amp; is, WRstruct&amp;);</code> mb? instead <code>friend std::istream&amp; operator&gt;&gt;   ( std::istream&amp; is, WRstruct&amp;);</code>"}, {"owner": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1498655487, "post_id": 44803215, "comment_id": 76586851, "body": "@Someprogrammerdude Looks like we&#39;re talking about different things. I mean line 4 of <code>WRstruct::read</code>. The vector <code>vec</code> used in it is empty."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "edited": false, "score": 0, "creation_date": 1498655552, "post_id": 44803215, "comment_id": 76586907, "body": "@alexeykuzmin0 Ah, I looked at a very similar line in the <code>write</code> function (which have now been edited). You found the problem though and should write it as an answer."}, {"owner": {"reputation": 692, "user_id": 2920698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WA5I3.jpg?s=128&g=1", "display_name": "voltento", "link": "https://stackoverflow.com/users/2920698/voltento"}, "edited": false, "score": 0, "creation_date": 1498655641, "post_id": 44803215, "comment_id": 76586985, "body": "U use spaces between the &#39;operator&#39; and the &#39;&gt;&gt;&#39; try to remove its."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1498655645, "post_id": 44803215, "comment_id": 76586987, "body": "Use <code>&#39;\\n&#39;</code>, not <code>std::endl</code>.  The latter flushes the output buffer, which can be expensive."}, {"owner": {"reputation": 158, "user_id": 8226050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66da411fe004c8fc634a1a336c491bca?s=128&d=identicon&r=PG&f=1", "display_name": "X21", "link": "https://stackoverflow.com/users/8226050/x21"}, "reply_to_user": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "edited": false, "score": 0, "creation_date": 1498655715, "post_id": 44803215, "comment_id": 76587036, "body": "@alexeykuzmin0   I have edited this , because <code>write</code> had the same part of code of <code>read</code> function (sorry)."}], "answers": [{"comments": [{"owner": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "edited": false, "score": 0, "creation_date": 1498655978, "post_id": 44803645, "comment_id": 76587228, "body": "Please comment if meaning of <code>WRstruct::read</code> function should be different."}, {"owner": {"reputation": 158, "user_id": 8226050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66da411fe004c8fc634a1a336c491bca?s=128&d=identicon&r=PG&f=1", "display_name": "X21", "link": "https://stackoverflow.com/users/8226050/x21"}, "edited": false, "score": 0, "creation_date": 1498656367, "post_id": 44803645, "comment_id": 76587575, "body": "can I edit the code in order to show that after all changes I have another erros? One of them is : <code>error LNK2005: &quot;class std::basic_ostream&lt;char,struct std::char_traits&lt;char&gt; &gt; &amp; __cdecl operator&lt;&lt;(class std::basic_ostream&lt;char,struct std::char_traits&lt;char&gt; &gt; &amp;,class WRstruct const &amp;)&quot; (??6@YAAAV?$basic_ostream@DU?$char_traits@D@std@@@std@@AAV01&zwnj;&#8203;@ABVWRstruct@@@Z) already defined in Source.obj 1&gt;C:\\Users\\Nikita Gusev\\Desktop\\ttttt\\Debug\\ttttt.exe : fatal error LNK1169: one or more multiply defined symbols found</code> . Or sjould I ask another question?"}, {"owner": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "reply_to_user": {"reputation": 158, "user_id": 8226050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66da411fe004c8fc634a1a336c491bca?s=128&d=identicon&r=PG&f=1", "display_name": "X21", "link": "https://stackoverflow.com/users/8226050/x21"}, "edited": false, "score": 1, "creation_date": 1498657818, "post_id": 44803645, "comment_id": 76588740, "body": "@X21, I think it&#39;s better to create another question. Using the code from this question, I cannot reproduce this second error message"}], "tags": [], "owner": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "is_accepted": true, "score": 2, "last_activity_date": 1498655870, "creation_date": 1498655870, "answer_id": 44803645, "question_id": 44803215, "link": "https://stackoverflow.com/questions/44803215/binary-overloaded-operator/44803645#44803645", "title": "Binary overloaded operator=", "body": "<p>As far as I understand, the meaning of your function <code>WRstruct::read</code> is \"reading all the data from 'temp.txt' and writing it to console\". <em>BTW, it's strange that function <code>read</code> prints something, so consider naming your function accordingly.</em></p>\n\n<p>To read something from file using <code>istream_iterator</code>, you should create a pair of iterators (one pointing to the beginning of the file, and another empty) and use <code>std::copy</code>. So, the reading part of your function should look like</p>\n\n<pre><code>std::vector&lt;WRstruct&gt; vec;\n\nstd::ifstream readFile(\"temp.txt\");\nstd::istream_iterator&lt;WRstruct&gt; istr(readFile);\nstd::istream_iterator&lt;WRstruct&gt; end_istr;\ncopy(istr, end_istr, back_inserter(vec));\n</code></pre>\n\n<p>So, you can just comment or delete one line from <code>WRstruct::read</code> to get rid of compilation error.</p>\n"}], "owner": {"reputation": 158, "user_id": 8226050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66da411fe004c8fc634a1a336c491bca?s=128&d=identicon&r=PG&f=1", "display_name": "X21", "link": "https://stackoverflow.com/users/8226050/x21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 44803645, "answer_count": 1, "score": 4, "last_activity_date": 1498655870, "creation_date": 1498654753, "last_edit_date": 1498655324, "question_id": 44803215, "link": "https://stackoverflow.com/questions/44803215/binary-overloaded-operator", "title": "Binary overloaded operator=", "body": "<p>So I'm trying to write and read from a file, using <code>std::ostream_iterator</code> and <code>std::iostream_iterator</code>. The process of writng works well without any mistakes. But as for reading I'm lost. The error, I have is:</p>\n\n<blockquote>\n  <p>1>c:\\program files (x86)\\microsoft visual studio 14.0\\vc\\include\\xutility(2316): error C2678: binary '=': no operator found which takes a left-hand operand of type 'const WRstruct' (or there is no acceptable conversion)</p>\n</blockquote>\n\n<p>and it says that:</p>\n\n<blockquote>\n  <p>c:\\users\\xxxxxxx\\desktop\\ttttt\\ttttt\\wrstruct.h(21): note: could be 'WRstruct &amp;WRstruct::operator =(const WRstruct &amp;)'\n  1>  c:\\program files (x86)\\microsoft visual studio 14.0\\vc\\include\\xutility(2316): note: while trying to match the argument list '(const WRstruct, WRstruct)'</p>\n</blockquote>\n\n<p>What is the correct way of overloading <code>operator=</code>? </p>\n\n<p><strong>class:</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include &lt;vector&gt;\n#include &lt;iterator&gt;\n#include &lt;istream&gt;\n\nclass WRstruct\n{\nprivate:\n    std::string name;\n    std::string number;\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp;, const WRstruct&amp;);\n    friend std::istream&amp; operator &gt;&gt; ( std::istream&amp; is, WRstruct&amp;);\n\npublic:\n    WRstruct(){};\n    void write();\n    void read();\n    ~WRstruct(){};\n};\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const WRstruct&amp; p)\n{\n    os &lt;&lt; \"User Name: \" &lt;&lt; p.name &lt;&lt; std::endl\n        &lt;&lt; \"Name: \" &lt;&lt; p.number &lt;&lt; std::endl\n        &lt;&lt; std::endl;\n    return os;\n}\n\nstd::istream&amp; operator &gt;&gt; (std::istream&amp; is, WRstruct&amp; p)\n{\n\n    is &gt;&gt; p.name&gt;&gt;p.number;\n    return is;\n}\n</code></pre>\n\n<p>Methods:</p>\n\n<pre><code>void WRstruct::write()\n{\n    std::vector&lt;WRstruct&gt; vecP;\n    std::copy(std::istream_iterator&lt;WRstruct&gt;(std::cin),\n    std::istream_iterator&lt;WRstruct&gt;(), std::back_inserter(vecP));\n    std::ofstream temp(\"temp.txt\", std::ios::out);\n    std::ostream_iterator&lt;WRstruct&gt;temp_itr(temp, \"\\n\");\n    std::copy(vecP.begin(), vecP.end(), temp_itr);\n\n}\n\nvoid WRstruct::read()\n{\n    std::vector&lt;WRstruct&gt; vec;\n\n    std::ifstream readFile(\"temp.txt\");\n    std::istream_iterator&lt;WRstruct&gt; istr(readFile);\n    copy(vec.begin(), vec.end(), istr);\n\n    std::istream_iterator&lt;WRstruct&gt; end_istr;\n    copy(istr, end_istr, back_inserter(vec));\n\n    std::ostream_iterator&lt;WRstruct&gt; osIter(std::cout,\" \");\n    copy(vec.begin(),vec.end(),osIter);\n\n}\n</code></pre>\n\n<p>and main():</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"WRstruct.h\"\n\nint main()\n{\n    WRstruct r;\n    r.write();\n    //r.read();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "qt-signals", "qsslsocket", "general-network-error"], "answers": [{"comments": [{"owner": {"reputation": 62009, "user_id": 514235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/73c478b60c371abe43bb7ac15ff3666d?s=128&d=identicon&r=PG", "display_name": "iammilind", "link": "https://stackoverflow.com/users/514235/iammilind"}, "edited": false, "score": 0, "creation_date": 1498654999, "post_id": 44803233, "comment_id": 76586435, "body": "<b>Q1</b>: My earlier implementation (before porting to Qt) was implemented using the technique described in <a href=\"https://stackoverflow.com/a/10447560/514235\">this answer</a>. That worked perfectly fine, where I could set a timeout option for when to notify on internet disconnection. Is there any such built-in facility within Qt? <b>Q2</b>: (title Qn) Why the <code>error(...)</code> is not signalled with <code>QAbstractSocket::NetworkError</code> on its own as described in the Qt page?"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1498654793, "creation_date": 1498654793, "answer_id": 44803233, "question_id": 44803126, "link": "https://stackoverflow.com/questions/44803126/qt-why-is-qabstractsocketerrorqabstractsocketsocketerror-signal-not-gen/44803233#44803233", "title": "Qt: Why is `QAbstractSocket::error(QAbstractSocket::SocketError)` signal not generated when internet is disconnected?", "body": "<p>Unless the protocols you use have some sort of keep-alive, if you don't send anything nothing will be sent and no attempt of error checking will be done.</p>\n\n<p>If you want to see if there's problem with a connection you actually have to <em>send</em> something. If a cable is unplugged or there is any other problem between you and the remote host, then (after a suitable timeout and retries) you will get an error.</p>\n\n<p>To see if the remote host has closed the connection in a nice way, you have to attempt to read something, in which case the receive call will return that it has read zero bytes.</p>\n"}], "owner": {"reputation": 62009, "user_id": 514235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/73c478b60c371abe43bb7ac15ff3666d?s=128&d=identicon&r=PG", "display_name": "iammilind", "link": "https://stackoverflow.com/users/514235/iammilind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2321, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498654793, "creation_date": 1498654525, "question_id": 44803126, "link": "https://stackoverflow.com/questions/44803126/qt-why-is-qabstractsocketerrorqabstractsocketsocketerror-signal-not-gen", "title": "Qt: Why is `QAbstractSocket::error(QAbstractSocket::SocketError)` signal not generated when internet is disconnected?", "body": "<p>I am trying to achieve a signal when the internet is disconnected for an already connected SSL socket. Here is the way I have derived the <code>QSslSocket</code>:</p>\n\n<pre><code>struct CloudSSL::Socket : public QSslSocket\n{\n  Q_OBJECT public:\n\n  void ConnectSlots ()\n  {\n    connect(this, SIGNAL(readyRead()), this, SLOT(ReceiveData()));\n    connect(this, SIGNAL(disconnected()), this, SLOT(Disconnected()));\n    // *** None of the above or below is invoking when internet disconnects ***\n    connect(this, SIGNAL(error(QAbstractSocket::SocketError)),\n            this, SLOT(Error(QAbstractSocket::SocketError)));\n  }\n\n  virtual ~Socket ()\n  {\n    QObject::disconnect();\n    QSslSocket::abort();\n  }\n\n  public slots:\n  void ReceiveData ()\n  {\n    LOG(\"Socket received data...\");\n  }\n\n  void Disconnected ()\n  {\n    LOG(\"Socket got disconnected...\");\n  }\n\n  void Error (QAbstractSocket::SocketError error)\n  {\n    LOG(\"Socket error \", error);\n  }\n}\n</code></pre>\n\n<p>Here is how it's initialized:</p>\n\n<pre><code>m_pSSLSocket = new Socket;\nm_pSSLSocket-&gt;setProtocol(QSsl::TlsV1_2);\nm_pSSLSocket-&gt;setLocalCertificateChain(QSslCertificate::fromPath(\":/Certificate.pem\", QSsl::Pem));\nm_pSSLSocket-&gt;setPrivateKey(QSslKey(privateKeyFile.readAll(), QSsl::Rsa));\nm_pSSLSocket-&gt;setSocketOption(QAbstractSocket::LowDelayOption, true);  // &lt;---\nm_pSSLSocket-&gt;setSocketOption(QAbstractSocket::KeepAliveOption, true);  // &lt;---\nm_pSSLSocket-&gt;connectToHostEncrypted(SAARATHY_URL, SAARATHY_PORT);\nm_pSSLSocket-&gt;ignoreSslErrors();\n</code></pre>\n\n<p>Things work fine in general. However, if I disable wifi in my Ubuntu PC, then I don't get any network error as expected from the <a href=\"http://doc.qt.io/qt-5/qabstractsocket.html#SocketError-enum\" rel=\"nofollow noreferrer\"><code>QAbstractSocket::SocketError</code></a>:</p>\n\n<blockquote>\n  <p><code>QAbstractSocket::NetworkError</code>  -- 7 -- An error occurred with the network\n  (e.g., the network cable was accidentally plugged out).</p>\n</blockquote>\n\n<p>Referred following posts before this Qn:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/10445122/514235\">QTcpSocket state always connected, even unplugging ethernet wire</a></li>\n<li><a href=\"https://stackoverflow.com/q/22216640/514235\">Qt TCP/IP socket connection check</a></li>\n</ul>\n\n<p><strong>Question</strong>: What is the Qt exclusive way of receiving a signal when the internet is disconnected?</p>\n"}, {"tags": ["c++", "visual-studio", "visual-studio-2017"], "comments": [{"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1498658339, "post_id": 44802946, "comment_id": 76589255, "body": "0x80071069 = ERROR_WMI_INSTANCE_NOT_FOUND, so the tracing session was not found. maybe it uses ETW providers that are not available in Windows 7 and only win8 or newer."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1498658387, "post_id": 44802946, "comment_id": 76589300, "body": "That is ERROR_WMI_INSTANCE_NOT_FOUND, &quot;The instance name passed was not recognized as valid by a WMI data provider&quot;.  Hmm, that&#39;s not good.  Somebody claimed that running low on disk space is an underlying cause.  Seems a bit remote, but profiling certainly eats a lot of it.  Leaks temp files like a sieve too. So run the cleanup wizard first.  If you&#39;ve been considering &quot;time to update this old dog&quot;, now would be a good time :)"}], "answers": [{"tags": [], "owner": {"reputation": 477, "user_id": 3524797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ef4352b803b2311e0d1196b5dea026?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Daniels", "link": "https://stackoverflow.com/users/3524797/nathan-daniels"}, "is_accepted": false, "score": 3, "last_activity_date": 1573232456, "creation_date": 1573232456, "answer_id": 58770895, "question_id": 44802946, "link": "https://stackoverflow.com/questions/44802946/merging-of-etl-files-has-failed-0x80071069-flags-0x0000001f/58770895#58770895", "title": "Merging of ETL files has failed (0x80071069) (Flags: 0x0000001f)", "body": "<p>I had this issue with that exact same error code 0x80071069.  I noticed my <code>WMI Performance Adapter Service</code> (wmiApSrv) was stopped.  Starting it back up resolved my issue and I was able to successfully profile my application.</p>\n\n<p>In the past I had seen a similar error caused by my C: drive running low on space due to the size of the temp trace files.  Make sure you have plenty of free space in your C drive as well.</p>\n"}], "owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1573232456, "creation_date": 1498654129, "question_id": 44802946, "link": "https://stackoverflow.com/questions/44802946/merging-of-etl-files-has-failed-0x80071069-flags-0x0000001f", "title": "Merging of ETL files has failed (0x80071069) (Flags: 0x0000001f)", "body": "<p>I am trying to profile my application using the built-in profiler in Visual Studio 2017:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z3wFj.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Z3wFj.png\" alt=\"enter image description here\"></a></p>\n\n<p>However when I close the application, this is what appears:\n<a href=\"https://i.stack.imgur.com/1dwYt.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/1dwYt.png\" alt=\"Microsoft Visual Studio was unable to create a diagnostics report. Check Output window for errors.\"></a></p>\n\n<p>This is what I see in output window:</p>\n\n<pre><code>Profiling of 'MyProjectName' started.\nMyProjectName has exited.\nProfiling of 'MyProjectName' stopped.\nDiagnostics session stopped with errors.\n\nMerging of ETL files has failed (0x80071069) (Flags: 0x0000001f).\n</code></pre>\n\n<p>What's wrong? I am running MS Visual Studio Community 2017 on Windows 7 x64. I am profiling C++ Qt application.</p>\n"}, {"tags": ["c++", "opencv", "matrix"], "comments": [{"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1498655362, "post_id": 44802866, "comment_id": 76586735, "body": "Unfortunately you managed to use the one part of that question which is wrong, contradicting what is said in the first sentence."}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 1, "creation_date": 1498655507, "post_id": 44802866, "comment_id": 76586866, "body": "Indeed, the accepted answer on that link is partially wrong. Maybe we should resolve that one and then mark this one as a duplicate?"}, {"owner": {"reputation": 31, "user_id": 8226004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399b4ea3b4b74f22102bd1d5a66afeb3?s=128&d=identicon&r=PG&f=1", "display_name": "hfs", "link": "https://stackoverflow.com/users/8226004/hfs"}, "edited": false, "score": 0, "creation_date": 1498660692, "post_id": 44802866, "comment_id": 76591167, "body": "I did not specify in my original post, but my problem stems from trying to import someone else&#39;s code (from github) where this implementation is used in several functions. This, combined with the thread I cited, led me to believe there was probably an element to make it work that I&#39;m somehow missing. Perhaps I place too much faith in people, but why would they upload the source code consisting of more than 4000 lines and not even bother to check if it works first?"}], "answers": [{"comments": [{"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 2, "creation_date": 1498656407, "post_id": 44803664, "comment_id": 76587609, "body": "Yep, that&#39;s the way to do it. Consider providing the implementation as well. Should be something like this: <code>{ cv::Mat dummy; foo(..., dummy); }</code>. Also format your code with 4-space indentation."}], "tags": [], "owner": {"reputation": 90, "user_id": 6889602, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-TKOb54QulLE/AAAAAAAAAAI/AAAAAAAAACE/B2qnhiTEF9I/photo.jpg?sz=128", "display_name": "Riccardo Giubilato", "link": "https://stackoverflow.com/users/6889602/riccardo-giubilato"}, "is_accepted": false, "score": 6, "last_activity_date": 1498655902, "creation_date": 1498655902, "answer_id": 44803664, "question_id": 44802866, "link": "https://stackoverflow.com/questions/44802866/opencv-3-how-to-pass-cvmat-as-an-optional-argument/44803664#44803664", "title": "OpenCV 3: How to pass cv::Mat as an optional argument", "body": "<p>I might be wrong because I'm a beginner in those matters but here's what I think. \nYou want to pass by ref an optional argument. The issue is that a reference with the symbol &amp; is a reference to an l-value, which is an object that <em>exists</em>. C++ does not allow what you have written because <code>matrix</code> is an r-value, that is a temporary object that has not an actual memory address associated to it. \nThe only way you can pass <code>cv::Mat &amp;matrix = cv::Mat()</code> is by const-ing it,<code>const cv::Mat &amp;matrix = cv::Mat()</code> which of course is not what you need.</p>\n\n<p>The simplest solution IMHO is to just overload your function definition so that you have</p>\n\n<p><code>void foo(...args);\n void foo(...args, cv::Mat &amp;matrix);</code></p>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 8225707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82286172498a75ed3a98ee5de89d548e?s=128&d=identicon&r=PG&f=1", "display_name": "Madre Chigado", "link": "https://stackoverflow.com/users/8225707/madre-chigado"}, "is_accepted": false, "score": 3, "last_activity_date": 1498656469, "creation_date": 1498656469, "answer_id": 44803894, "question_id": 44802866, "link": "https://stackoverflow.com/questions/44802866/opencv-3-how-to-pass-cvmat-as-an-optional-argument/44803894#44803894", "title": "OpenCV 3: How to pass cv::Mat as an optional argument", "body": "<p>This is because C++ does not allow you to initialize a non-const reference with an rvalue.</p>\n\n<p>So you can either:</p>\n\n<p>1) make the reference const -- wouldn't suit you since you want to change the content of matrix in the function</p>\n\n<p>or</p>\n\n<p>2) have a <code>cv::Mat</code> init variable stored globally in your module:</p>\n\n<pre><code>static const cv::Mat g_mat = cv::Mat();\n\nvoid foo(..., cv::Mat &amp;matrix = g_mat) {\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8226004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399b4ea3b4b74f22102bd1d5a66afeb3?s=128&d=identicon&r=PG&f=1", "display_name": "hfs", "link": "https://stackoverflow.com/users/8226004/hfs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1476, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1498656469, "creation_date": 1498653920, "question_id": 44802866, "link": "https://stackoverflow.com/questions/44802866/opencv-3-how-to-pass-cvmat-as-an-optional-argument", "title": "OpenCV 3: How to pass cv::Mat as an optional argument", "body": "<p>I would like to write a function in C++ that takes a matrix as an optional argument. If the user ends up passing the matrix when calling the function, it will be modified by the function, so I'm implementing a pass by reference.</p>\n\n<p>According to the accepted answer for this <a href=\"https://stackoverflow.com/questions/25785038/opencv-passing-a-matrix-as-an-optional-argument\" title=\"previous question\">previous question</a>, this can be done by making the default value an empty Mat, such as:</p>\n\n<pre><code>void foo(..., cv::Mat &amp;matrix = cv::Mat()) {\n    // code\n\n    return;\n}\n</code></pre>\n\n<p>However, when I try to compile this in OpenCV 3.2, I get the \u00abinvalid initialization of non-const reference of type \u2018cv::Mat&amp;\u2019 from an rvalue of type \u2018cv::Mat\u2019\u00bb error.</p>\n\n<p>Has this feature changed since OpenCV 2.4, or could the issue be somewhere else?</p>\n"}, {"tags": ["c++", "webrtc"], "answers": [{"tags": [], "owner": {"reputation": 985, "user_id": 2501687, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/wZGlA.jpg?s=128&g=1", "display_name": "dynamic_cast", "link": "https://stackoverflow.com/users/2501687/dynamic-cast"}, "is_accepted": true, "score": 2, "last_activity_date": 1498815452, "creation_date": 1498815452, "answer_id": 44843327, "question_id": 44802775, "link": "https://stackoverflow.com/questions/44802775/in-webrtc-no-frame-transmitted-to-browser-from-c-code-after-calling-onframe-in/44843327#44843327", "title": "In webRTC no frame transmitted to browser from C++ code after calling onFrame in the capturer", "body": "<p>I got to the bottom of this. The local description was simply not set after creating the answer.</p>\n\n<p>Calling <code>createAnswer</code> will hopefully trigger the <code>OnSuccess</code> callback in the <code>CreateSessionDescriptionObserver</code> (in my case <code>Conductor</code>).</p>\n\n<p>There I failed to save the answer as the local description. Here is how the <code>OnSuccess</code> method should be implemented:</p>\n\n<pre><code>void Conductor::OnSuccess(webrtc::SessionDescriptionInterface *desc)\n{    \n  this-&gt;_peerConnection-&gt;SetLocalDescription(DummySetSessionDescriptionObserver::Create(), desc);\n}\n</code></pre>\n\n<p>Doing this will ultimately trigger <code>OnIceGatheringChange</code> with <code>kIceGatheringComplete</code> as parameter, meaning both sides are ready.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 1658843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b571a2e69c9180cd770efe6b823aa8?s=128&d=identicon&r=PG", "display_name": "user1658843", "link": "https://stackoverflow.com/users/1658843/user1658843"}, "is_accepted": false, "score": 1, "last_activity_date": 1557058695, "last_edit_date": 1557058695, "creation_date": 1520440563, "answer_id": 49156970, "question_id": 44802775, "link": "https://stackoverflow.com/questions/44802775/in-webrtc-no-frame-transmitted-to-browser-from-c-code-after-calling-onframe-in/49156970#49156970", "title": "In webRTC no frame transmitted to browser from C++ code after calling onFrame in the capturer", "body": "<p>According with google group discuss-webrtc <a href=\"https://groups.google.com/forum/#!topic/discuss-webrtc/37TSGD6JXuM\" rel=\"nofollow noreferrer\">thread</a>  </p>\n\n<p>you should implement VideoTrackSourceInterface. In my case, I used the base class AdaptedVideoTrackSource and I created a method FrameCaptured it's is called from my thread. In the method FrameCaptured I call the base method OnFrame. It's work fine !!!</p>\n\n<pre><code> class StreamSource : public rtc::AdaptedVideoTrackSource\n {\n   void OnFrameCaptured(const webrtc::VideoFrame&amp; frame);\n }\n\n void StreamSource::OnFrameCaptured(const webrtc::VideoFrame&amp; frame) \n {\n   OnFrame(frame);\n }\n</code></pre>\n"}], "owner": {"reputation": 985, "user_id": 2501687, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/wZGlA.jpg?s=128&g=1", "display_name": "dynamic_cast", "link": "https://stackoverflow.com/users/2501687/dynamic-cast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 1, "accepted_answer_id": 44843327, "answer_count": 2, "score": 2, "last_activity_date": 1557058695, "creation_date": 1498653696, "question_id": 44802775, "link": "https://stackoverflow.com/questions/44802775/in-webrtc-no-frame-transmitted-to-browser-from-c-code-after-calling-onframe-in", "title": "In webRTC no frame transmitted to browser from C++ code after calling onFrame in the capturer", "body": "<p>I am trying to make my app up to date with webrtc. This is basically a desktop streaming application with a C++ application video streaming to a browser using webRTC.\nMy implementation used to use a bunch of deprecated stuff like <code>SignalFrameCaptured</code> and <code>cricket::CapturedFrame</code>.\nLooking at webRTC right now it seems those classes/signals are not available.</p>\n\n<p>Here is my capturer:</p>\n\n<pre><code>class Capturer\n: public cricket::VideoCapturer,\n  public webrtc::DesktopCapturer::Callback\n{\n\n public:\n\n   sigslot::signal1&lt;Capturer*&gt; SignalDestroyed;\n\n   Capturer();\n   ~Capturer();\n\n   void ResetSupportedFormats(const std::vector&lt;cricket::VideoFormat&gt;&amp; formats);\n   bool CaptureFrame();\n   cricket::CaptureState Start(const cricket::VideoFormat&amp; format) override;\n   void Stop() override;\n   bool IsRunning() override;\n   bool IsScreencast() const override;\n   bool GetPreferredFourccs(std::vector&lt;uint32_t&gt;* fourccs) override;\n\n\n   virtual void OnCaptureResult(webrtc::DesktopCapturer::Result result,\n\n                         std::unique_ptr&lt;webrtc::DesktopFrame&gt; desktop_frame) override;\n\n\n private:\n   bool running_;\n   int64_t initial_timestamp_;\n   int64_t next_timestamp_;\n   std::unique_ptr&lt;webrtc::DesktopCapturer&gt; _capturer;\n\n};\n</code></pre>\n\n<p><code>Capturer::CaptureFrame()</code> is called periodically from another thread and <code>Capturer::OnCaptureResult</code> is called as expected with a <code>DesktopFrame</code> as parameter.\nNow looking at the implementation of <code>OnCaptureResult</code>:</p>\n\n<pre><code>void Capturer::OnCaptureResult(webrtc::DesktopCapturer::Result result,\n\n                          std::unique_ptr&lt;webrtc::DesktopFrame&gt; desktopFrame)\n{\n\n  if (result != webrtc::DesktopCapturer::Result::SUCCESS)\n  {\n   return; // Never called. Which leads me to conclude thedesktop capturer works\n  }\n\n\n  int width = desktopFrame-&gt;size().width();\n  int height = desktopFrame-&gt;size().height();\n  rtc::scoped_refptr&lt;webrtc::I420Buffer&gt; res_i420_frame = webrtc::I420Buffer::Create(width, height);\n\n\n  webrtc::ConvertToI420(webrtc::VideoType::kABGR,\n                        desktopFrame-&gt;data(),\n                        0, 0,\n                        width, height,\n                        0,\n                        webrtc::kVideoRotation_0,\n                        res_i420_frame);\n\n  webrtc::VideoFrame frame = webrtc::VideoFrame(res_i420_frame, webrtc::kVideoRotation_0, next_timestamp_ / rtc::kNumNanosecsPerMicrosec);\n\n\n  this-&gt;OnFrame(frame, width, height);\n}\n</code></pre>\n\n<p>No frame are ever transmitted to the connected browser, as seen from chrome::webrtc-internals.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dq8Qo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dq8Qo.png\" alt=\"No incoming video stream\"></a></p>\n\n<p>Back to the code, here is how I create the peerConnection:</p>\n\n<pre><code>void Conductor::connectToPeer() {\n\n  this-&gt;_peerConnectionFactory = webrtc::CreatePeerConnectionFactory();\n\n  if (!this-&gt;_peerConnectionFactory.get())\n  {\n     std::cerr &lt;&lt; \"Failed to initialize PeerConnectionFactory\" &lt;&lt; std::endl;\n     throw new std::runtime_error(\"Cannot initialize PeerConnectionFactory\");\n  }   \n\n  webrtc::PeerConnectionInterface::RTCConfiguration config;\n  webrtc::PeerConnectionInterface::IceServer server;\n  server.uri = \"stun:stun.l.google.com:19302\";\n  config.servers.push_back(server);\n\n  webrtc::FakeConstraints       constraints;constraints.AddOptional(webrtc::MediaConstraintsInterface::kEnableDtlsSrtp, \"true\");\n\n  this-&gt;_peerConnection = this-&gt;_peerConnectionFactory-&gt;CreatePeerConnection(config, &amp;constraints, NULL, NULL, this);\n\n  if (!this-&gt;_peerConnection.get())\n  {\n      std::cerr &lt;&lt; \"Failed to initialize PeerConnection\" &lt;&lt; std::endl;\n      throw new std::runtime_error(\"Cannot initialize PeerConnection\");\n  }\n\n\n auto capturer = new Capturer();\n\n CapturerThread *capturerThread = new CapturerThread(capturer); // This thread sole functionis to call CaptureFrameperiodically\n\n\n rtc::scoped_refptr&lt;webrtc::VideoTrackSourceInterface&gt; videoSource = this-&gt;_peerConnectionFactory-&gt;CreateVideoSource(capturer, NULL);\n rtc::scoped_refptr&lt;webrtc::VideoTrackInterface&gt; videoTrack(this-&gt;_peerConnectionFactory-&gt;CreateVideoTrack(\"video_label\", videoSource));\n rtc::scoped_refptr&lt;webrtc::MediaStreamInterface&gt; stream = this-&gt;_peerConnectionFactory-&gt;CreateLocalMediaStream(\"stream_label\");  \n\n stream-&gt;AddTrack(videoTrack);\n if (!this-&gt;_peerConnection-&gt;AddStream(stream))\n {\n    std::cerr &lt;&lt; \"Adding stream to PeerConnection failed\" &lt;&lt; std::endl;\n    throw new std::runtime_error(\"Cannot add stream\");\n }\n\n typedef std::pair&lt;std::string,rtc::scoped_refptr&lt;webrtc::MediaStreamInterface&gt;&gt; MediaStreamPair;\n\n this-&gt;_activeStreams.insert(MediaStreamPair(stream-&gt;label(), stream));\n webrtc::SdpParseError error;\n\n webrtc::SessionDescriptionInterface* sessionDescription(webrtc::CreateSessionDescription(\"offer\", this-&gt;_offer, &amp;error));\n\n if (!sessionDescription)\n {\n    std::cerr &lt;&lt; \"Cannot initialize session description.\" &lt;&lt; std::endl;\n    throw new std::runtime_error(\"Cannot set session description\");\n }\n\n\n this-&gt;_peerConnection-&gt;SetRemoteDescription(DummySetSessionDescriptionObserver::Create(), sessionDescription);\n\n this-&gt;_peerConnection-&gt;CreateAnswer(this, NULL);\n}\n</code></pre>\n\n<p>My problem is no video frames are even transmitted to the browser client even though both the capturer and the peer connection are in place as expected. Is there something I'm missing ? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1498653605, "post_id": 44802700, "comment_id": 76585276, "body": "integer overflow is my guess. (<code>main.cpp:5:20: warning: left shift count &gt;= width of type [-Wshift-count-overflow]</code> compiler warnings are your friends, listen to them)"}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 1, "creation_date": 1498653605, "post_id": 44802700, "comment_id": 76585277, "body": "How many bits are in <code>1</code>?"}, {"owner": {"reputation": 326, "user_id": 4838299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QBCJl.jpg?s=128&g=1", "display_name": "Neil Gatenby", "link": "https://stackoverflow.com/users/4838299/neil-gatenby"}, "edited": false, "score": 0, "creation_date": 1498653654, "post_id": 44802700, "comment_id": 76585329, "body": "does &lt;&lt;16 work?  Guessing you&#39;ve gone off the left hand edge"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 5, "creation_date": 1498653677, "post_id": 44802700, "comment_id": 76585350, "body": "by the way, do <b>not</b> use <code>#include&lt;bits&#47;stdc++.h&gt;</code> - it&#39;s not standard compliant"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1498653686, "post_id": 44802700, "comment_id": 76585356, "body": "consider <code>pow</code> returns a <code>double</code>, which may actually be able to represent 2^50, while <code>1&lt;&lt;50</code> is an <code>int</code>, which can&#39;t"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1498653862, "post_id": 44802700, "comment_id": 76585485, "body": "try <code>1ULL &lt;&lt; 50</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1498654109, "post_id": 44802700, "comment_id": 76585669, "body": "@StoryTeller sometimes I am not sure about something and just post it even if there are high chances that it is wrong. Once again I learned something. Thx, I better remove the comment, not because of my shame, but not to confuse others that are as ignorant as me ;)"}, {"owner": {"reputation": 15, "user_id": 5520673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111f5bd4b6efb3f5afad1fcbb67f131e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Saproo", "link": "https://stackoverflow.com/users/5520673/varun-saproo"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1498654132, "post_id": 44802700, "comment_id": 76585691, "body": "@M.M I tried it worked. Is it 64 bit unsigned?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1498654261, "post_id": 44802700, "comment_id": 76585791, "body": "@VarunSaproo - It&#39;s the largest fundamental integral data type. On modern systems it&#39;s most likely 64 bit. Don&#39;t assume it <i>has</i> to be 64 bit."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5520673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111f5bd4b6efb3f5afad1fcbb67f131e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Saproo", "link": "https://stackoverflow.com/users/5520673/varun-saproo"}, "edited": false, "score": 0, "creation_date": 1498653946, "post_id": 44802786, "comment_id": 76585546, "body": "So is there any way I could shift to 50?"}, {"owner": {"reputation": 420, "user_id": 7221943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SmgXq.png?s=128&g=1", "display_name": "sharyex", "link": "https://stackoverflow.com/users/7221943/sharyex"}, "edited": false, "score": 0, "creation_date": 1498654206, "post_id": 44802786, "comment_id": 76585749, "body": "Try <code>1ULL &lt;&lt; 50</code>."}, {"owner": {"reputation": 60876, "user_id": 2060725, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WUKmO.png?s=128&g=1", "display_name": "nvoigt", "link": "https://stackoverflow.com/users/2060725/nvoigt"}, "reply_to_user": {"reputation": 15, "user_id": 5520673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111f5bd4b6efb3f5afad1fcbb67f131e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Saproo", "link": "https://stackoverflow.com/users/5520673/varun-saproo"}, "edited": false, "score": 0, "creation_date": 1498654229, "post_id": 44802786, "comment_id": 76585760, "body": "@VarunSaproo Sure, just put your constant into a 64bit variable. For example <code>int64_t</code> from <code>#include &lt;stdint.h&gt;</code>."}], "tags": [], "owner": {"reputation": 60876, "user_id": 2060725, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WUKmO.png?s=128&g=1", "display_name": "nvoigt", "link": "https://stackoverflow.com/users/2060725/nvoigt"}, "is_accepted": false, "score": 3, "last_activity_date": 1498653729, "creation_date": 1498653729, "answer_id": 44802786, "question_id": 44802700, "link": "https://stackoverflow.com/questions/44802700/unexpected-output-with-left-shift-operator-c/44802786#44802786", "title": "Unexpected output with left shift operator C++", "body": "<p>Assuming your compiler treats the constant <code>1</code> as a 32bit integer, you shifted it so far to the left, that only zeroes remain in the 32bit you have. 50 is larger than 32.</p>\n"}, {"comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1498653807, "post_id": 44802808, "comment_id": 76585438, "body": "What 32bit field?"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 3, "creation_date": 1498653835, "post_id": 44802808, "comment_id": 76585463, "body": "Note that <code>int</code> may or may not be 32bit large."}, {"owner": {"reputation": 384, "user_id": 8224092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0196acfb3e92c2d01ae14fda0cd7eaa?s=128&d=identicon&r=PG&f=1", "display_name": "Loamsiada", "link": "https://stackoverflow.com/users/8224092/loamsiada"}, "edited": false, "score": 0, "creation_date": 1498653882, "post_id": 44802808, "comment_id": 76585503, "body": "1 is handled as a signed integer number which has 32 bit on a common PC."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498653913, "post_id": 44802808, "comment_id": 76585526, "body": "@ThomasJahn What if I don&#39;t use a common PC? You should definitely mention that."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1498654010, "post_id": 44802808, "comment_id": 76585584, "body": "The size of a signed integer number is chosen by the compiler (which will most likely choose one that is well suited for the target architecture, but that&#39;s not required), the standard only states that <code>int</code> has to be at least 16 bits wide."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1498696349, "post_id": 44802808, "comment_id": 76609584, "body": "&quot;cout &lt;&lt; (static_cast&lt;int64_t&gt;(1) &lt;&lt; 50) &lt;&lt; endl;&quot;  also works, and fully documents the size of integer you intended.  (static_cast&lt;uint64_t&gt;(1) &lt;&lt; 50) too"}], "tags": [], "owner": {"reputation": 384, "user_id": 8224092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0196acfb3e92c2d01ae14fda0cd7eaa?s=128&d=identicon&r=PG&f=1", "display_name": "Loamsiada", "link": "https://stackoverflow.com/users/8224092/loamsiada"}, "is_accepted": true, "score": 1, "last_activity_date": 1498654109, "last_edit_date": 1498654109, "creation_date": 1498653780, "answer_id": 44802808, "question_id": 44802700, "link": "https://stackoverflow.com/questions/44802700/unexpected-output-with-left-shift-operator-c/44802808#44802808", "title": "Unexpected output with left shift operator C++", "body": "<p>You shift the \"1\" out of the 32 bit field, so zero is the result. Pow uses float representation where 2^50 can be handled.</p>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p>Without any modifications like \"1LL\" or \"1ULL\" (which generate long 64bit numbers), an integer number is usually handled as 32 bit on a x64 or x86 architectures. You can use</p>\n\n<pre><code> cout &lt;&lt; (1ULL &lt;&lt; 50);\n</code></pre>\n\n<p>or</p>\n\n<pre><code> cout &lt;&lt; ((long long)1 &lt;&lt; 50);\n</code></pre>\n\n<p>which should to it.</p>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1498654338, "last_edit_date": 1498654338, "creation_date": 1498653870, "answer_id": 44802843, "question_id": 44802700, "link": "https://stackoverflow.com/questions/44802700/unexpected-output-with-left-shift-operator-c/44802843#44802843", "title": "Unexpected output with left shift operator C++", "body": "<p>From the C++ Standard (5.8 Shift operators)</p>\n\n<blockquote>\n  <p>1 The shift operators &lt;&lt; and >> group left-to-right.</p>\n</blockquote>\n\n<pre><code>shift-expression:\n    additive-expression\n    shift-expression &lt;&lt; additive-expression\n    shift-expression &gt;&gt; additive-expression\n</code></pre>\n\n<blockquote>\n  <p>The operands shall be of integral or unscoped enumeration type and\n  integral promotions are performed. The type of the result is that of\n  the promoted left operand. <strong>The behavior is undefined if the right\n  operand is</strong> negative, or <strong>greater than or equal to the length in\n  bits of the promoted left operand</strong>.</p>\n</blockquote>\n\n<p>Take into account that the behavior also will be undefined if the right operand is not greater or equal to the length in bits of the left operand but can touch the sign bit because the integer literal <code>1</code> has the type <code>signed int</code>.</p>\n\n<p>As for this function call <code>pow(2, 50)</code> then there is used some algorithm that calculates the power.</p>\n"}, {"tags": [], "owner": {"reputation": 9219, "user_id": 979325, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b513c9edd4da1688c05ba041820011c7?s=128&d=identicon&r=PG", "display_name": "Jepessen", "link": "https://stackoverflow.com/users/979325/jepessen"}, "is_accepted": false, "score": 1, "last_activity_date": 1498653878, "creation_date": 1498653878, "answer_id": 44802845, "question_id": 44802700, "link": "https://stackoverflow.com/questions/44802700/unexpected-output-with-left-shift-operator-c/44802845#44802845", "title": "Unexpected output with left shift operator C++", "body": "<p>It's exactly what you're doing. You're shifting a single bit by 50 position in a portion of memory that's 32 bit... What's happening according to you? The bit goes somewhere else but it's not inside the memory portion of the integer anymore. <code>pow(2, 50)</code> performs a <code>double</code> casting, so you're not shifting bits anymore.</p>\n\n<p>Also, never use <code>#include&lt;bits/stdc++.h&gt;</code>. <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h\">It's not standard</a>, and it's slow. You should use it only in precompiled headers but I'd avoid this also in that cases.</p>\n"}, {"tags": [], "owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "is_accepted": false, "score": 2, "last_activity_date": 1498654335, "last_edit_date": 1498654335, "creation_date": 1498654015, "answer_id": 44802905, "question_id": 44802700, "link": "https://stackoverflow.com/questions/44802700/unexpected-output-with-left-shift-operator-c/44802905#44802905", "title": "Unexpected output with left shift operator C++", "body": "<p>Try this (<a href=\"http://ideone.com/r09gL0\" rel=\"nofollow noreferrer\">run it</a>):</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n  std::int64_t i { 1 }; // wide enough to allow 50 bits shift\n  std::cout &lt;&lt; std::hex &lt;&lt; ( i &lt;&lt; 50 );  // should display 4000000000000\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3797, "user_id": 4022608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27c9e8430426724a1f39c98b268f0a98?s=128&d=identicon&r=PG&f=1", "display_name": "Baldrickk", "link": "https://stackoverflow.com/users/4022608/baldrickk"}, "is_accepted": false, "score": 0, "last_activity_date": 1498654173, "creation_date": 1498654173, "answer_id": 44802967, "question_id": 44802700, "link": "https://stackoverflow.com/questions/44802700/unexpected-output-with-left-shift-operator-c/44802967#44802967", "title": "Unexpected output with left shift operator C++", "body": "<pre><code>cout&lt;&lt;(1&lt;&lt;50);\n</code></pre>\n\n<p>Your code treats <code>1</code> as an <code>int</code>, so overflows. Instead, try:</p>\n\n<pre><code>cout &lt;&lt; (1ULL &lt;&lt; 50);\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5520673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111f5bd4b6efb3f5afad1fcbb67f131e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Saproo", "link": "https://stackoverflow.com/users/5520673/varun-saproo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 44802808, "answer_count": 6, "score": 0, "last_activity_date": 1498654338, "creation_date": 1498653544, "question_id": 44802700, "link": "https://stackoverflow.com/questions/44802700/unexpected-output-with-left-shift-operator-c", "title": "Unexpected output with left shift operator C++", "body": "<p>Here is the code which is giving me the unexpected answer</p>\n\n<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\nint main()\n{\n    cout&lt;&lt;(1&lt;&lt;50);\n}\n</code></pre>\n\n<p>The answer I get is 0.\nBut if I change the line to</p>\n\n<pre><code>cout&lt;&lt;pow(2, 50);\n</code></pre>\n\n<p>I get the right answer.</p>\n\n<p>Could someone explain me the reason.</p>\n"}, {"tags": ["c++", "c++11", "unique-ptr"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1498653865, "post_id": 44802658, "comment_id": 76585487, "body": "Does the library require you to use <code>free()</code> to deallocate?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1498654035, "post_id": 44802658, "comment_id": 76585602, "body": "Any reason it doesn&#39;t just return a pointer?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1498654106, "post_id": 44802658, "comment_id": 76585668, "body": "Ah, too bad. The external library forces you to write silly code."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 2, "creation_date": 1498654818, "post_id": 44802658, "comment_id": 76586264, "body": "You can shorten the realPtr line to <code>unique_ptr&lt;MyThing&gt; realPtr(tempPtr);</code>"}, {"owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 1, "creation_date": 1498654881, "post_id": 44802658, "comment_id": 76586332, "body": "Yes, or!:  <code>auto realPtr = unique_ptr&lt;MyThing&gt;(tempPtr)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1498653944, "post_id": 44802754, "comment_id": 76585545, "body": "<code>CreateTheThing()</code> is the function called from the external library. I doubt that the OP can simply change it."}, {"owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 0, "creation_date": 1498654063, "post_id": 44802754, "comment_id": 76585634, "body": "That&#39;s correct.  I&#39;ve edited the question for clarity.  I&#39;d like to avoid changing the legacy API in the external library."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498656662, "post_id": 44802754, "comment_id": 76587797, "body": "IMO This is the best answer because you can use it to force the rest of the application to use the new method by hiding the old <code>API</code> behind the new, wrapper, function API. Then you know that no one will be wandering off with stray owning raw pointers."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1498658367, "post_id": 44802754, "comment_id": 76589278, "body": "This solution does not hide the original api.  It provides an override.  There is no way to hide a global function."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498671132, "post_id": 44802754, "comment_id": 76598395, "body": "It&#39;s not virtual, so it doesn&#39;t &quot;override&quot; anything. But yes, it is an <b>overload</b> that does not hide or otherwise interfere with the original <code>CreateTheThing()</code>. I&#39;m not sure what @Galik meant; maybe they can clarify."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1498671463, "post_id": 44802754, "comment_id": 76598607, "body": "@Micha&#235;lRoy It doesn&#39;t have to hide the original API, but you can use it to if you want to which would be my preferred way."}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 5, "last_activity_date": 1605699010, "last_edit_date": 1605699010, "creation_date": 1498653644, "answer_id": 44802754, "question_id": 44802658, "link": "https://stackoverflow.com/questions/44802658/how-to-pass-unique-ptrt-in-place-of-a-raw-output-pointer-parameter/44802754#44802754", "title": "How to pass unique_ptr&lt;T&gt; in place of a raw *output* pointer parameter?", "body": "<p>If you use the function often you could put the conversion in a function.</p>\n<p>Best would be to change the API, but this can also work.</p>\n<pre><code>inline std::unique_ptr&lt;MyThing&gt; CreateTheThing()\n{\n  MyThing* p;\n  if (CreateTheThing(p))\n  {\n    return std::unique_ptr&lt;MyThing&gt;(p);\n  }\n  return std::unique_ptr&lt;MyThing&gt;();\n}\n</code></pre>\n<p>You could also make this overload to make refactoring even easier:</p>\n<pre><code>inline bool CreateTheThing(std::unique_ptr&lt;MyThing&gt;&amp; ptr)\n{\n    try \n    {\n        MyThing* p;\n        if (CreateTheThing(p))\n            ptr = std::unique_ptr&lt;MyThing&gt;(p);\n        else\n            return false;\n    }\n    catch (std::bad_alloc&amp;)\n    {\n        return false;\n    }\n    return true;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 0, "creation_date": 1498654615, "post_id": 44803097, "comment_id": 76586086, "body": "Clear, concise and definitive answer.  Thank you very much!"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 2, "creation_date": 1498654634, "post_id": 44803097, "comment_id": 76586102, "body": "nitpick: <code>unique_ptr::get()</code> returning the pointer <i>by-value</i> is why you can&#39;t change what is stored through it."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1498654709, "post_id": 44803097, "comment_id": 76586159, "body": "@Caleth Better?"}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 12, "last_activity_date": 1498654695, "last_edit_date": 1498654695, "creation_date": 1498654424, "answer_id": 44803097, "question_id": 44802658, "link": "https://stackoverflow.com/questions/44802658/how-to-pass-unique-ptrt-in-place-of-a-raw-output-pointer-parameter/44803097#44803097", "title": "How to pass unique_ptr&lt;T&gt; in place of a raw *output* pointer parameter?", "body": "<blockquote>\n  <p>Is there a more direct method than this? One which doesn't require a temporary raw pointer? </p>\n</blockquote>\n\n<p>No, there isn't.</p>\n\n<blockquote>\n  <p>Ideally, there would be a method of unique_ptr which exposes its internal pointer in a way that could work directly with the CreateTheThing method?  <code>unique_ptr::get()</code> does not allow this, to my knowledge.</p>\n</blockquote>\n\n<p>Your knowledge is correct. That would defeat the whole purpose of the <code>std::unique_ptr</code>, therefore <code>unique_ptr::get()</code> is a <code>const</code> function and the pointer is returned by value.</p>\n\n<p>However similar as your constructor example, you can always use <code>std::unique_ptr::reset()</code> to pass an externally allocated pointer.</p>\n\n<p>Also note: If the 3rd party API requires you to release the memory using <code>free()</code> you may need to provide a special deleter function for the <code>std::unique_ptr</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 1, "creation_date": 1498655407, "post_id": 44803373, "comment_id": 76586772, "body": "Neat!  <code>template&lt;typename T&gt; class out_ptr_adapter;</code>"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "edited": false, "score": 2, "creation_date": 1498655541, "post_id": 44803373, "comment_id": 76586897, "body": "@BTownTKD Plus a <code>template &lt;class T&gt; make_out_ptr_adapter()</code> for type deduction, of course."}, {"owner": {"reputation": 510, "user_id": 5306491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3c575640d48735c736d8661f1f49bf?s=128&d=identicon&r=PG", "display_name": "CAF", "link": "https://stackoverflow.com/users/5306491/caf"}, "edited": false, "score": 0, "creation_date": 1498750977, "post_id": 44803373, "comment_id": 76639660, "body": "<b>p</b> should be initialized with <b>nullptr</b> for exception safety."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 510, "user_id": 5306491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3c575640d48735c736d8661f1f49bf?s=128&d=identicon&r=PG", "display_name": "CAF", "link": "https://stackoverflow.com/users/5306491/caf"}, "edited": false, "score": 1, "creation_date": 1498758664, "post_id": 44803373, "comment_id": 76644275, "body": "@CAF <code>p</code> is value-initialised (note <code>p()</code> in the ctor mem-initialiser list), which means it will be a null pointer."}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 12, "last_activity_date": 1498655122, "creation_date": 1498655122, "answer_id": 44803373, "question_id": 44802658, "link": "https://stackoverflow.com/questions/44802658/how-to-pass-unique-ptrt-in-place-of-a-raw-output-pointer-parameter/44803373#44803373", "title": "How to pass unique_ptr&lt;T&gt; in place of a raw *output* pointer parameter?", "body": "<p>You can save one line of code (potentially many times) by writing many lines of code once:</p>\n\n<pre><code>class Wrapper\n{\n  std::unique_ptr&lt;MyThing&gt; &amp;u;\n  MyThing *p;\n\npublic:\n  Wrapper(std::unique_ptr&lt;MyThing&gt; &amp;u) : u(u), p() {}\n\n  operator MyThing* &amp; ()\n  { return p; }\n\n  ~Wrapper()\n  { u.reset(p); }\n};\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>std::unique_ptr&lt;MyThing&gt; u;\nCreateTheThing(Wrapper(u));\n</code></pre>\n"}], "owner": {"reputation": 7339, "user_id": 741988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8724aa47446c1ed0516acd4c1f642bd5?s=128&d=identicon&r=PG", "display_name": "BTownTKD", "link": "https://stackoverflow.com/users/741988/btowntkd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1896, "favorite_count": 1, "accepted_answer_id": 44803373, "answer_count": 3, "score": 11, "last_activity_date": 1605699010, "creation_date": 1498653444, "last_edit_date": 1501769921, "question_id": 44802658, "link": "https://stackoverflow.com/questions/44802658/how-to-pass-unique-ptrt-in-place-of-a-raw-output-pointer-parameter", "title": "How to pass unique_ptr&lt;T&gt; in place of a raw *output* pointer parameter?", "body": "<p>I have a <em>pre-existing</em> function in an <em>external</em> library, which looks like this;</p>\n\n<pre><code>bool CreateTheThing(MyThing *&amp; pOut);\n</code></pre>\n\n<p>In short; I give it a raw pointer (by reference), and the function allocates memory and assigns my pointer to the newly-allocated object.  When the function returns, it is <em>my</em> responsibility to free the memory, when I'm done.</p>\n\n<p>Obviously, I'd like to store this result into a <code>unique_ptr&lt;MyThing&gt;</code>, and avoid the manual <code>delete</code>.</p>\n\n<p>I <em>could</em> create a temporary raw pointer to use with the API call, and pass it into the constructor for the <code>unique_ptr</code>;</p>\n\n<pre><code>MyThing* tempPtr;\nCreateTheThing(tempPtr);\nunique_ptr&lt;MyThing&gt; realPtr = unique_ptr&lt;MyThing&gt;(tempPtr);\n</code></pre>\n\n<p>Is there a more direct method than this?  One which doesn't require a temporary raw pointer?  Ideally, there would be a method of <code>unique_ptr</code> which exposes its internal pointer in a way that could work directly with the <code>CreateTheThing</code> method?  </p>\n\n<p><code>unique_ptr&lt;T&gt;::get()</code> does not allow this, to my knowledge.  The pointer it returns is not a reference to the internally-used pointer.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 7, "creation_date": 1498652951, "post_id": 44802345, "comment_id": 76584768, "body": "You receive an arbitrary instance of that class as a function parameter. How are you going to know what the reference refers to if you didn&#39;t store it in the instance?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498652978, "post_id": 44802345, "comment_id": 76584791, "body": "As far as I know, a reference is defined to be an alias, it is not guaranteed to take memory (this also explains why you can&#39;t have a pointer to a reference). If the compiler can get away with not using memory for that reference while maintaining the correct behavior it is free to do so. In the case of the class member it obviously has to use some memory."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498653175, "post_id": 44802345, "comment_id": 76584939, "body": "@Borgleader - it is also not guaranteed to take no memory."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1498653408, "post_id": 44802345, "comment_id": 76585118, "body": "@Peter Did I imply otherwise?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498653828, "post_id": 44802345, "comment_id": 76585456, "body": "@Borgleader - you didn&#39;t, but you skirted around that a little, which makes it easier for casual or inexperiencedreaders to misinterpret.   So I simply said it more directly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498655172, "post_id": 44802345, "comment_id": 76586559, "body": "@Borgleader why does it <b>obviously</b> has to use memory(i.e. make the reference into a pointer)?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1498655571, "post_id": 44802345, "comment_id": 76586923, "body": "If you can&#39;t <i>deduce</i> from the code what your reference refers to, you have to <i>store</i> it somewhere. There&#39;s really no other way to compile a program."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498655661, "post_id": 44802345, "comment_id": 76587000, "body": "@Thu A reference taking memory is the default case if you will. How do you expect each instance of A to be able to remember which int <code>a_ref</code> is an alias of without taking any memory?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498656730, "post_id": 44802345, "comment_id": 76587847, "body": "@n.m. so cna you say that by making the reference to a pointer, you sort of allow them to left uninitialized, like a_ref are, I guess?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498656904, "post_id": 44802345, "comment_id": 76587970, "body": "@Borgleader but why isn&#39;t it taking memory in the second code example then? I cannot expect it to remember anything there either, can I?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498656990, "post_id": 44802345, "comment_id": 76588032, "body": "@Thu Of course you can, in the second example <code>a_ref</code> is completely useless because it is exactly the same thing as <code>a</code> so using <code>a_ref</code> is like using <code>a</code> they both alias to the same object."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498657218, "post_id": 44802345, "comment_id": 76588221, "body": "@Borgleader so is it because of that the reference is being initialized by the constructor/using a parameter or? That it is treated as a const pointer."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498657328, "post_id": 44802345, "comment_id": 76588322, "body": "&quot;you sort of allow them to left uninitialized&quot; I have no idea what you mean by that."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498657451, "post_id": 44802345, "comment_id": 76588431, "body": "Not really, it has to do with the kinds of assumptions the compiler can make. In the second example <code>a_ref</code> is redundant, but in the first it can be initialized in one scope and used in another scope, at which point the compiler may not be able to reason about where the reference came from. If the compiler can <i>without a doubt</i> reason about what a reference points to it may get away without using memory, generally speaking for a member variable you cannot do that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498657830, "post_id": 44802345, "comment_id": 76588754, "body": "@n.m. what I mean is that... References cannot be left uninitialized but pointers can and since a_ref is left uninitialized, it would make sense to transform that reference to a pointer, at least to me, in order to allow the reference to wait for the assignment to happen after it is declared.."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498658220, "post_id": 44802345, "comment_id": 76589135, "body": "<a href=\"http://coliru.stacked-crooked.com/a/2899849756ac620c\" rel=\"nofollow noreferrer\">Consider this example</a> this may help explain why the member needs to use memory, if not, I dont know what to tell you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498658276, "post_id": 44802345, "comment_id": 76589187, "body": "@Borgleader nice explanation. So it is basically because that when used as a data member it is difficult for the compiler to keep tracking of what the reference is bound to? or am I still misunderstanding something? I get the last part of your comment though :) Thanks for letting me steal some of your time :))"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498658297, "post_id": 44802345, "comment_id": 76589206, "body": "I stil have no idea what you are talking about. A reference is not a pointer and a compiler does not transform one to another. A compiler can implement references and pointers using similar techniques. This doesn&#39;t change the nature of references, which are still not pointers regardless of implementation methods.. That&#39;s all there is to it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498658878, "post_id": 44802345, "comment_id": 76589707, "body": "@Borgleader I just saw that you posted an example. So you said this &quot;// while this may seem redundant, consider the print call, how could it refer to the right int without using some memory?&quot;, couldn&#39;t it just replace the reference with the address of the int? :/"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498659102, "post_id": 44802345, "comment_id": 76589880, "body": "I dont know what you mean."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498659283, "post_id": 44802345, "comment_id": 76590024, "body": "@Borgleader when you said &quot; while this may seem redundant, consider the print call, how could it refer to the right int without using some memory?&quot;, couldn&#39;t the compiler simply replace the reference with the address of the integer instead of making the reference into a pointer and then make that pointer point to the address of the integer? I know that I am maybe a little too confused."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498671563, "post_id": 44802345, "comment_id": 76598661, "body": "@Borgleader or would that simply not be possible?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1498673029, "post_id": 44802345, "comment_id": 76599511, "body": "As I&#39;ve said before, I don&#39;t know how else to explain it."}], "answers": [{"tags": [], "owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1498652921, "creation_date": 1498652921, "answer_id": 44802441, "question_id": 44802345, "link": "https://stackoverflow.com/questions/44802345/why-do-references-occupy-memory-when-member-of-a-class/44802441#44802441", "title": "Why do references occupy memory when member of a class?", "body": "<p>The reference (or pointer) has to be stored in memory somewhere, so why not store it along with the rest of the class?</p>\n\n<p>Even with your example, the parameter a (<code>int &amp;a</code>) is stored in memory (probably on the stack), then <code>a_ref</code> doesn't use any more memory, it's just an alias, but there <em>is</em> memory used by <code>a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "is_accepted": false, "score": 0, "last_activity_date": 1498652961, "creation_date": 1498652961, "answer_id": 44802460, "question_id": 44802345, "link": "https://stackoverflow.com/questions/44802345/why-do-references-occupy-memory-when-member-of-a-class/44802460#44802460", "title": "Why do references occupy memory when member of a class?", "body": "<p>Imagine that a class is just a user defined data type. You need to have something which can lead you to the actual thing that you are referencing.\nUsing the actual value in the second case is more about the compiler and his work to optimize your code.\nA reference should be an alias to some variable and why should this alias use memory when it could be optimized to be taken directly from the stack.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "edited": false, "score": 0, "creation_date": 1498835387, "post_id": 44802568, "comment_id": 76679862, "body": "Thank you. But why exactly does the reference have to take memory in your example?"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1498840242, "post_id": 44802568, "comment_id": 76683026, "body": "When the program reaches the last line <code>std::cout &lt;&lt; r</code>, it needs to remember if r refers to a or to b. It can&#39;t remember it without some kind of &quot;memory&quot; (&quot;memory&quot; in a very broad sense, it could also be a register for example)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "edited": false, "score": 0, "creation_date": 1498840449, "post_id": 44802568, "comment_id": 76683121, "body": "Well okay but take a look at this <a href=\"https://stackoverflow.com/a/1179994/8221510\">stackoverflow.com/a/1179994/8221510</a> where he says &quot;make a note in the symbol table that j is now an alias for i&quot;. Couldn&#39;t the compiler just do this in your code example?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "edited": false, "score": 0, "creation_date": 1498841186, "post_id": 44802568, "comment_id": 76683501, "body": "and thereby remember it, or am I misunderstanding something? Thanks for letting me take some of your time :)"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 1, "creation_date": 1498860602, "post_id": 44802568, "comment_id": 76691705, "body": "No, the compiler can&#39;t do that with my specially crafted &quot;evil&quot; example, because how would it know in advance what the user enters? (Look at <code>func()</code>, the return value depends on what the user enters)"}], "tags": [], "owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "is_accepted": true, "score": 4, "last_activity_date": 1498725544, "last_edit_date": 1498725544, "creation_date": 1498653218, "answer_id": 44802568, "question_id": 44802345, "link": "https://stackoverflow.com/questions/44802345/why-do-references-occupy-memory-when-member-of-a-class/44802568#44802568", "title": "Why do references occupy memory when member of a class?", "body": "<p>The C++ standard only defines the semantics of a reference, not how they are actually implemented. So all answers to this question are compiler-specific. A (silly, but compliant) compiler might choose to store all references on the hard-disk. It's just that it proved to be the most convenient/efficient to store a reference as a constant pointer for class members, and replace the occurence of the reference with the actual thing where possible.</p>\n\n<hr>\n\n<p>As an example for a situation where it is impossible for the compiler to decide at compile time to which object a reference is bound, consider this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nbool func() {\n    int i;\n    std::cin &gt;&gt; i;\n    return i &gt; 5;\n}\n\nint main() {\n    int a = 3, b = 4;\n    int&amp; r = func() ? a : b;\n    std::cout &lt;&lt; r;\n}\n</code></pre>\n\n<p>So <em>in general</em> a program has to store some information about references at runtime, and sometimes, for <em>special cases</em>, it can prove at compile time what a reference is bound to.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8221510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 44802568, "answer_count": 3, "score": 2, "last_activity_date": 1498725544, "creation_date": 1498652652, "question_id": 44802345, "link": "https://stackoverflow.com/questions/44802345/why-do-references-occupy-memory-when-member-of-a-class", "title": "Why do references occupy memory when member of a class?", "body": "<p>I have been told that references, when they are data members of classes, they occupy memory since they will be transformed into constant pointers by the compiler. Why is that? Like why does the compiler(I know that it is implementation-specific in general) make a reference a pointer when they are part of a class, as opposed to when they are a temporary variable?\nSo in this code:</p>\n\n<pre><code>class A{\npublic:\n  A(int &amp;refval):m_ref(refval){};\nprivate:\n  int &amp;m_ref;\n}\n</code></pre>\n\n<p>m_ref will be treated as a constant pointer(i.e. they do occupy memory).</p>\n\n<p>However, in this code:</p>\n\n<pre><code>void func(int &amp;a){\n  int &amp;a_ref = a;\n}\n</code></pre>\n\n<p>the compiler just replaces the reference with the actual variable(i.e. they do not occupy memory).</p>\n\n<p>So to simplify a little, my question basically is: What makes it more meaningful to make references into constant pointers when they are data members than when they are temporary variables?</p>\n"}, {"tags": ["c++", "stream", "bytebuffer"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498652930, "post_id": 44802267, "comment_id": 76584748, "body": "I think <a href=\"http://www.boost.org/doc/libs/1_64_0/doc/html/boost_asio/reference/streambuf.html\" rel=\"nofollow noreferrer\"><code>boost::asio::streambuf</code></a> should be ok, but I&#39;m not sure if the internal buffer it uses is ok for your use case."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498653216, "post_id": 44802267, "comment_id": 76584973, "body": "@Rakete1111 I think I already took a look at it, but after reading in too many different places about streams I got a bit confused. I will give it a try, thx for the tip"}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498653016, "post_id": 44802454, "comment_id": 76584811, "body": "no I dont want to send lists across the network. I want to send a byte array, so I dont understand how a std::list would help"}], "tags": [], "owner": {"reputation": 353, "user_id": 7878426, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh6.googleusercontent.com/-wcYntf8DWyQ/AAAAAAAAAAI/AAAAAAAACUM/Ba_DBRdfXPU/photo.jpg?sz=128", "display_name": "Michael Thomas", "link": "https://stackoverflow.com/users/7878426/michael-thomas"}, "is_accepted": false, "score": -1, "last_activity_date": 1498652952, "creation_date": 1498652952, "answer_id": 44802454, "question_id": 44802267, "link": "https://stackoverflow.com/questions/44802267/stream-data-into-a-byte-array/44802454#44802454", "title": "stream data into a byte array", "body": "<p>Have you tried <a href=\"http://en.cppreference.com/w/cpp/container/list/\" rel=\"nofollow noreferrer\">std::list</a>? You could group the elements into types and put them into lists with the appropriate type. Then you could create an std::list of std::lists.</p>\n"}, {"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498655789, "post_id": 44803068, "comment_id": 76587087, "body": "this looks fine. I am pretty sure that there are boost classes for all I need, but I didnt manage to adopt the <a href=\"http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/tutorial/tutdaytime4.html\" rel=\"nofollow noreferrer\">example</a> I found to what I need. As long as the receiver knows in advance what to receive its easy, but if the types in the message are encoded in the message itself I am quite lost. Btw that kind of cast I dont consider as ugly, because it is confined to only few lines and the caller wont notice its presence"}, {"owner": {"reputation": 136, "user_id": 6262015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5a29e798daae9fc5b9a9a8a268b395?s=128&d=identicon&r=PG&f=1", "display_name": "Kessel", "link": "https://stackoverflow.com/users/6262015/kessel"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498657170, "post_id": 44803068, "comment_id": 76588187, "body": "Re &quot;As long as the receiver knows in advance what to receive its easy, but if the types in the message are encoded in the message itself I am quite lost&quot;. This is different from the endianness thing. The receiver must know something about what it is expecting -- at the very least, it must tell the <code>idontknowwhat_t</code> what datatype it wants the return value to have. Could you be more specific about what you&#39;re trying to achieve?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498657339, "post_id": 44803068, "comment_id": 76588337, "body": "sure that comment was not concerning the endianness. What i mean is that the messages are not a fixed structure, but just follow a fixed protocol, eg. (staying with the example in the question) a certain value of the <code>id</code> might indicate that the next value is a <code>uint32_t</code> while another value might indicate that the next value is a <code>uint16_t</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498657461, "post_id": 44803068, "comment_id": 76588438, "body": "... actually in the real code the first two bytes is a <code>uint16_t</code> that indicates what will follow."}, {"owner": {"reputation": 136, "user_id": 6262015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5a29e798daae9fc5b9a9a8a268b395?s=128&d=identicon&r=PG&f=1", "display_name": "Kessel", "link": "https://stackoverflow.com/users/6262015/kessel"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498657871, "post_id": 44803068, "comment_id": 76588790, "body": "That sounds like it&#39;s the responsibility of your second piece of code. You would read the first <code>id</code> flag as a <code>uint16_t</code>, and put it into a switch statement. The different cases of this switch statement can read the buffer in whatever way they like."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498657874, "post_id": 44803068, "comment_id": 76588793, "body": "btw not sure if there is a misunderstanding, my first comment was not trying to say that I have problems to adopt your answer, but rather about the problems using something not &quot;selfmade&quot;"}, {"owner": {"reputation": 136, "user_id": 6262015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5a29e798daae9fc5b9a9a8a268b395?s=128&d=identicon&r=PG&f=1", "display_name": "Kessel", "link": "https://stackoverflow.com/users/6262015/kessel"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498658678, "post_id": 44803068, "comment_id": 76589543, "body": "You mean that you don&#39;t want to depend on boost unless you have to? I often think the same way. Taking care of endianness though, is one of those things that&#39;s difficult to do in a way that&#39;s both portable and efficient. Hence my recommending a library for that. If you know in advance that all your users are on the same platform, you don&#39;t have to worry about this."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1498659823, "post_id": 44803068, "comment_id": 76590489, "body": "No, I mean I would like to use boost (cant use C++11), but after several days of reading stuff I still find it more difficult than using raw sockets and my homebrewn raw byte array"}], "tags": [], "owner": {"reputation": 136, "user_id": 6262015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5a29e798daae9fc5b9a9a8a268b395?s=128&d=identicon&r=PG&f=1", "display_name": "Kessel", "link": "https://stackoverflow.com/users/6262015/kessel"}, "is_accepted": true, "score": 1, "last_activity_date": 1498654356, "creation_date": 1498654356, "answer_id": 44803068, "question_id": 44802267, "link": "https://stackoverflow.com/questions/44802267/stream-data-into-a-byte-array/44803068#44803068", "title": "stream data into a byte array", "body": "<p>You cannot really avoid doing ugly casts, but at least you can hide them into the <code>idontknowwhat_t</code> class's <code>operator&gt;&gt;</code> and <code>operator&lt;&lt;</code> functions. And using templates, you could limit the number of casts in your code to the bare minimum.</p>\n\n<pre><code>class idontknowwhat_t\n{\n    uint8_t* _data;\n\npublic:\n    idontknowwhat_t(uint8_t* buffer)\n        : _data(buffer)\n    {}\n\n    template&lt;typename insert_type&gt;\n    idontknowwhat_t&amp; operator&lt;&lt;(insert_type value)\n    {\n        *reinterpret_cast&lt;insert_type*&gt;(_data) = value;\n        _data += sizeof(insert_type);\n        return *this;\n    }\n    template&lt;typename extract_type&gt;\n    idontknowwhat_t&amp; operator&gt;&gt;(extract_type&amp; value)\n    {\n        value = *reinterpret_cast&lt;extract_type*&gt;(_data);\n        _data += sizeof(extract_type);\n        return *this;\n    }\n};\n</code></pre>\n\n<p>I think this will actually work directly with your code. In this example, the <code>idontknowwhat_t</code> class does not own the buffer and simply keeps a raw pointer to the next bit of data it expects to read or write. For real-life purposes I would recommend letting the <code>idontknowwhat_t</code> class manage the buffer memory.</p>\n\n<p>In addition, none of the code on this page actually takes care of the data's endianness, which would definitely be the <code>idontknowwhat_t</code> class's responsibility. There is a <a href=\"http://www.boost.org/doc/libs/1_63_0/libs/endian/doc/index.html\" rel=\"nofollow noreferrer\">boost library</a> for that. I'm not documenting that library's use here, since I think it distracts from the questions real point.</p>\n"}], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2235, "favorite_count": 0, "accepted_answer_id": 44803068, "answer_count": 2, "score": 0, "last_activity_date": 1498654356, "creation_date": 1498652465, "last_edit_date": 1498653278, "question_id": 44802267, "link": "https://stackoverflow.com/questions/44802267/stream-data-into-a-byte-array", "title": "stream data into a byte array", "body": "<p>I have to admit that I am a bit confused at the moment, so sorry if the question isnt quite clear or trivial (actually I hope it is the latter)....</p>\n\n<p>I am sending an array of bytes across the network and would like to do something like this on the sender side:</p>\n\n<pre><code>size_t max_size = 100;\nuint8_t buffer[size];\nidontknowwhat_t x{buffer};    \nuint16_t size = 11;                 // total number of bytes in the buffer\nuint16_t id_a,id_b,id_c;            // some ids\nuint8_t  a,b,c;                     // some data\nx &lt;&lt; size &lt;&lt; id_a &lt;&lt; a &lt;&lt; id_b &lt;&lt; b &lt;&lt; id_c &lt;&lt; c;\nsomeMethodToSend(buffer,size);\n</code></pre>\n\n<p>and on the receiver side something like this:</p>\n\n<pre><code>size_t max_size = 100;\nuint8_t buffer[size];\nsomeMethodToReceive(buffer);\nidontknowwhat_t x{buffer};\nuint16_t size;\nx &gt;&gt; size;\nfor (uint16_t i=0; i&lt;size-2; i++) {\n    uint16_t id;\n    uint8_t data;\n    x &gt;&gt; id &gt;&gt; data;\n    std::cout &lt;&lt; id &lt;&lt; \" \" &lt;&lt; data;\n}\n</code></pre>\n\n<p>So my aim is basically to avoid ugly casts and manually incrementing a pointer while being able to have <code>uint8_t</code> and <code>uint16_t</code> (and possibly also <code>uint32_t</code>) in the buffer. The data I put in the buffer here is just an example, and I am aware that I need to take care of the byte order when sending over the network (and it would be fine if I had to do this \"manually\"). </p>\n\n<p>Is there something that I can use in place of my hypothetical <code>idontknowwhat_t</code> ?</p>\n"}, {"tags": ["c++", "string", "char"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 6, "creation_date": 1498652486, "post_id": 44802251, "comment_id": 76584427, "body": "Why don&#39;t you just use <code>std::string</code>?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1498652621, "post_id": 44802251, "comment_id": 76584527, "body": "You could create a linked list. But that&#39;s way less efficient over time than what std::string does, which is hold some buffer that begins at an initial size, and then reallocates a larger buffer when it gets too big."}, {"owner": {"reputation": 29, "user_id": 7362031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9abee04162adb3b7bb709529ce25e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Zahra", "link": "https://stackoverflow.com/users/7362031/zahra"}, "edited": false, "score": 0, "creation_date": 1498652942, "post_id": 44802251, "comment_id": 76584759, "body": "Actually I Want another solution , not getting string, I wanna solve my problem in getting unlimited char,is there anyway except linkedlist?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1498653070, "post_id": 44802251, "comment_id": 76584861, "body": "@Zahra Alternatively you could use a <code>std::unique_ptr&lt;char[]&gt; s(new char[arbitrary_length]);</code>. But you would need to manage the NUL termination yourself, and still know a maximum length before taking input. The better way is to simply use <code>std::string</code>."}, {"owner": {"reputation": 14930, "user_id": 395718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1323cdc2a70698b5275082bf6e61184?s=128&d=identicon&r=PG", "display_name": "Dialecticus", "link": "https://stackoverflow.com/users/395718/dialecticus"}, "edited": false, "score": 0, "creation_date": 1498653843, "post_id": 44802251, "comment_id": 76585467, "body": "If you don&#39;t want to use <code>std::string</code> then you have to implement the functionality of <code>std::getline</code> yourself. Maybe you could copy the source to your project and tinker with it."}], "answers": [{"tags": [], "owner": {"reputation": 2213, "user_id": 7757891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472798cf3c4d45c418314f837590985c?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Velev", "link": "https://stackoverflow.com/users/7757891/petar-velev"}, "is_accepted": false, "score": 5, "last_activity_date": 1498653321, "last_edit_date": 1498653321, "creation_date": 1498652495, "answer_id": 44802279, "question_id": 44802251, "link": "https://stackoverflow.com/questions/44802251/get-unlimited-char-in-cpp/44802279#44802279", "title": "Get unlimited char in Cpp", "body": "<p>Since it is C++. Just use <code>std::string</code></p>\n\n<p>If you really need to use <code>char*</code> look at <a href=\"https://stackoverflow.com/questions/30271631/dynamically-allocate-user-inputted-string\">this topic</a> </p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 7362031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9abee04162adb3b7bb709529ce25e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Zahra", "link": "https://stackoverflow.com/users/7362031/zahra"}, "edited": false, "score": 0, "creation_date": 1498653208, "post_id": 44802387, "comment_id": 76584971, "body": "Thank you a lot @Peter , but actually I&#39;m searching for the way which I can get char. thank you for your reply!"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 29, "user_id": 7362031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9abee04162adb3b7bb709529ce25e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Zahra", "link": "https://stackoverflow.com/users/7362031/zahra"}, "edited": false, "score": 1, "creation_date": 1498653480, "post_id": 44802387, "comment_id": 76585178, "body": "@Zahra - Read the documentation for <code>std::string</code>.   It has member functions that provide access to the underlying data ..... as a pointer to (the first element of) a dynamically allocated array of <code>char</code> i.e. a <code>const char *</code>.   If you try to work with a raw pointer (instead of <code>std::string</code>), you&#39;ll need to manually manage the memory allocation and (just as importantly) deallocation when you no longer need it."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 2, "last_activity_date": 1498652776, "creation_date": 1498652776, "answer_id": 44802387, "question_id": 44802251, "link": "https://stackoverflow.com/questions/44802251/get-unlimited-char-in-cpp/44802387#44802387", "title": "Get unlimited char in Cpp", "body": "<p>Instead of using a <code>char *</code>, use the standard library.</p>\n\n<pre><code>  #include &lt;string&gt;\n  #include &lt;iostream&gt;\n\n  int main()\n  {\n       std::string data;\n\n       std::getline(std::cin, data);\n\n       std::cout &lt;&lt; data &lt;&lt; '\\n';\n  }\n</code></pre>\n\n<p>This will read a string of any length (at least, until a newline is entered, which will not be included in <code>data</code>) and then print it out.</p>\n\n<p>You might wish to also check the state of <code>std::cin</code> to test if any errors occurred. </p>\n"}], "owner": {"reputation": 29, "user_id": 7362031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9abee04162adb3b7bb709529ce25e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Zahra", "link": "https://stackoverflow.com/users/7362031/zahra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 0, "closed_date": 1498653518, "answer_count": 2, "score": -3, "last_activity_date": 1498653321, "creation_date": 1498652413, "question_id": 44802251, "link": "https://stackoverflow.com/questions/44802251/get-unlimited-char-in-cpp", "closed_reason": "Duplicate", "title": "Get unlimited char in Cpp", "body": "<p>I want to get unlimited chars, actually I created char*, I use cin for it, and I want to change it to string.\nI don't know the length of the input which user enters, so I made this solution for myself.\nCan someone tell me plz, how to get a char* without knowing the size of input and converting to string.\nthanks. </p>\n"}, {"tags": ["c++", "unix", "webkit", "gtk", "gtk3"], "comments": [{"owner": {"reputation": 569, "user_id": 3975351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/708d1446d7599ef84b7f0f16b866024f?s=128&d=identicon&r=PG", "display_name": "Zander Brown", "link": "https://stackoverflow.com/users/3975351/zander-brown"}, "edited": false, "score": 0, "creation_date": 1498663454, "post_id": 44802237, "comment_id": 76593345, "body": "Not sure why GtkPlug is being used here"}, {"owner": {"reputation": 11, "user_id": 8225927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7261e09ca1f703c6ca384d5429030614?s=128&d=identicon&r=PG&f=1", "display_name": "Spragad", "link": "https://stackoverflow.com/users/8225927/spragad"}, "reply_to_user": {"reputation": 569, "user_id": 3975351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/708d1446d7599ef84b7f0f16b866024f?s=128&d=identicon&r=PG", "display_name": "Zander Brown", "link": "https://stackoverflow.com/users/3975351/zander-brown"}, "edited": false, "score": 0, "creation_date": 1498718267, "post_id": 44802237, "comment_id": 76615842, "body": "i am using GtkPlug as my main window because to use window , which is getting created by other module/layer."}, {"owner": {"reputation": 569, "user_id": 3975351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/708d1446d7599ef84b7f0f16b866024f?s=128&d=identicon&r=PG", "display_name": "Zander Brown", "link": "https://stackoverflow.com/users/3975351/zander-brown"}, "edited": false, "score": 0, "creation_date": 1498775442, "post_id": 44802237, "comment_id": 76652462, "body": "That does complete things, so from which process are you trying to resize it? I would suggesting resizing the GtkSocket you connect it do would be best."}, {"owner": {"reputation": 569, "user_id": 3975351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/708d1446d7599ef84b7f0f16b866024f?s=128&d=identicon&r=PG", "display_name": "Zander Brown", "link": "https://stackoverflow.com/users/3975351/zander-brown"}, "edited": false, "score": 0, "creation_date": 1498775528, "post_id": 44802237, "comment_id": 76652483, "body": "And I expect you already know this but GtkPlug/GtkSocket are X only so as the world moves towards Wayland you may have a problem"}], "owner": {"reputation": 11, "user_id": 8225927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7261e09ca1f703c6ca384d5429030614?s=128&d=identicon&r=PG&f=1", "display_name": "Spragad", "link": "https://stackoverflow.com/users/8225927/spragad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498652359, "creation_date": 1498652359, "question_id": 44802237, "link": "https://stackoverflow.com/questions/44802237/how-to-resize-webview-in-webkit-gtk", "title": "How to resize webview in webkit GTK", "body": "<p>I have recently started to work on webkitgtk .\nCurrently i am facing issue while trying to resize the webview in webkitgtk.</p>\n\n<p><strong>Current implementation:</strong></p>\n\n<p>I have one main window <strong>GtkWidget *main_window = gtk_plug_new(MYwinId);</strong> \nand then I am creating a webview using </p>\n\n<p><strong>WebKitWebView *webView = WEBKIT_WEB_VIEW(webkit_web_view_new());</strong></p>\n\n<p>Then i am adding the newly created webview to main window using \n<strong>gtk_container_add(GTK_CONTAINER(main_window ), GTK_WIDGET(webView));</strong></p>\n\n<p><strong>Current Issues i am facing: Resizing webview</strong></p>\n\n<p>I am trying to resize this webview which was created.\nI tried searching for any API call to resize from my application ,but i am unlucky to find one .</p>\n\n<p>Anyone kindly help me out to find any API call to resize my webview from my application layer.</p>\n\n<p><strong>BackGround:</strong></p>\n\n<p>I am trying to resize webview because when I click on the text field in the webview a virtual keyboard will pop up which is hiding the text field . So my idea is to resize the webview so i can move the text field above the keyboard area.</p>\n"}, {"tags": ["c++", "vector", "iterator", "language-lawyer"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1498652438, "post_id": 44802007, "comment_id": 76584402, "body": "I don&#39;t understand the down-vote on this question. It clearly explains the problem, provides a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, and is delightfully generic and abstract, when contrasted with the majority of questions that wind up with a <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> tag."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498652456, "post_id": 44802007, "comment_id": 76584412, "body": "@IInspectable: I completely agree. And the current crop of answers (including mine) could be more comprehensive."}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1498652474, "post_id": 44802007, "comment_id": 76584422, "body": "I didn&#39;t vote on this one, because while I love the clarity, there is no demonstration of research effort. But I do feel the downvote is unfair."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 2, "creation_date": 1498652644, "post_id": 44802007, "comment_id": 76584548, "body": "@rex: Then again, reaching the point where you construct a container from iterators, implement a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (that <i>is</i> minimal <i>and</i> complete), and use the terms <i>&quot;undefined&quot;</i>, <i>&quot;implementation defined&quot;</i>, and <i>&quot;(well) defined&quot;</i> requires (and demonstrates) more research effort, than loads of other questions around here."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1498652727, "post_id": 44802007, "comment_id": 76584617, "body": "I guess we could reach the point that every question that can be answered by referring to the C++ standard could be closed as not showing research effort."}], "answers": [{"comments": [{"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1498652336, "post_id": 44802056, "comment_id": 76584330, "body": "So the fact that the copy is buried in a vector init/constructor makes no difference? I assume that is obvious, but that is the only thing distinguishing this question from a generic int&lt;--&gt;char conversion question."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1498652374, "post_id": 44802056, "comment_id": 76584357, "body": "None whatsoever. I&#39;ll tag &quot;language lawyer&quot; hoping that someone posts an answer littered with standard references."}, {"owner": {"reputation": 420, "user_id": 7221943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SmgXq.png?s=128&g=1", "display_name": "sharyex", "link": "https://stackoverflow.com/users/7221943/sharyex"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1498652578, "post_id": 44802056, "comment_id": 76584503, "body": "@rex That was the reason of the question, one of those cases where you&#39;re 99% sure about it, but better to be 100%."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 0, "creation_date": 1498654707, "post_id": 44802056, "comment_id": 76586156, "body": "You can initialize a vector with a list this way as well,"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1498651894, "creation_date": 1498651894, "answer_id": 44802056, "question_id": 44802007, "link": "https://stackoverflow.com/questions/44802007/initializing-a-vector-from-iterators-of-a-container-of-a-different-type/44802056#44802056", "title": "Initializing a vector from iterators of a container of a different type", "body": "<p>They are all fine, subject to the same rules applying when converting a <code>char</code> to an <code>int</code> (so no concerns there) and <code>int</code> to <code>char</code>, which will again be subject to the normal rules: the <code>int</code> must be small enough to fit into a <code>char</code> if <code>char</code> is <code>signed</code> (otherwise the behaviour is <em>undefined</em>), and well-defined wrap-around behaviour if <code>char</code> is <code>unsigned</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1498652969, "post_id": 44802086, "comment_id": 76584781, "body": "First sentence is not entirely correct. The signedness of <code>char</code> is implementation-defined. Consider a <code>char</code> that is unsigned, and an <code>int</code> with the same range as <code>char</code>, that is signed. That conversion isn&#39;t valid (to my knowledge). Also (to my knowledge), an <code>int</code> is at least 16 bits wide, incorporated from the C Standard, so the issue is essentially moot."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 1, "creation_date": 1498652972, "post_id": 44802086, "comment_id": 76584787, "body": "Integer truncation is not undefined behavior.  The result of the truncation is very well defined indeed,  The UB term is getting a bit overused, these days."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 1, "creation_date": 1498653827, "post_id": 44802086, "comment_id": 76585455, "body": "@Micha&#235;lRoy: Well, true. Still, though, I was referring to the phrase <i>&quot;can convert [...] without issue&quot;</i>. (Potential) truncation, however, <i>is</i> an issue, you need to be aware of (if <code>int</code> were allowed to be the same size as <code>char</code>)."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1498665073, "post_id": 44802086, "comment_id": 76594580, "body": "@IInspectable Your correct. I missed that edge case. I&#39;ve updated the answer and hopefully now it covers it all."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 4, "last_activity_date": 1498664528, "last_edit_date": 1498664528, "creation_date": 1498651981, "answer_id": 44802086, "question_id": 44802007, "link": "https://stackoverflow.com/questions/44802007/initializing-a-vector-from-iterators-of-a-container-of-a-different-type/44802086#44802086", "title": "Initializing a vector from iterators of a container of a different type", "body": "<p>This is well defined code in all but one case.  <code>int</code> is required to have at least the same size as <code>char</code> and be able to store at least what a 16 bit twos compliment integer can store.  So when <code>sizeof(char) &lt; sizeof(int)</code> the behavior is well defined as you <code>int</code> can store every value <code>char</code> can .  If <code>sizeof(char) ==</code>sizeof(int)<code>and</code>char<code>is an alias to</code>unsigned char<code>then you could overflow the</code>int` which is undefined behavior.</p>\n\n<p>The reverse case also has undefined behavior.  If <code>char</code> is an alias to <code>signed char</code> and <code>sizeof(int) &gt; sizeof(char)</code> then you could overflow converting the <code>int</code> to a <code>char</code> which is signed integer overflow and is undefined behavior.  If <code>char</code> is an alias to <code>unsigned char</code> though it will never be undefined behavior.</p>\n"}], "owner": {"reputation": 420, "user_id": 7221943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SmgXq.png?s=128&g=1", "display_name": "sharyex", "link": "https://stackoverflow.com/users/7221943/sharyex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "accepted_answer_id": 44802056, "answer_count": 2, "score": 3, "last_activity_date": 1498664528, "creation_date": 1498651758, "last_edit_date": 1498652434, "question_id": 44802007, "link": "https://stackoverflow.com/questions/44802007/initializing-a-vector-from-iterators-of-a-container-of-a-different-type", "title": "Initializing a vector from iterators of a container of a different type", "body": "<p>Giving the following code:</p>\n\n<pre><code>#include &lt;iterator&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n    char arr[3] = { 1,2,3 };\n    std::vector&lt;char&gt; vec = { 1,2,3 };\n\n    std::vector&lt;int&gt; vec_one(std::begin(arr), std::end(arr));\n    std::vector&lt;int&gt; vec_two(vec.begin(), vec.end());\n}\n</code></pre>\n\n<p>Are the initializations for <code>vec_one</code> and <code>vec_two</code> undefined, implementation defined or defined according to normal type conversion rules?<br>\nWhat if the <code>char</code> and <code>int</code> types are swapped?  </p>\n"}, {"tags": ["c++", "c++11", "boost"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498650945, "post_id": 44801659, "comment_id": 76583246, "body": "When you say exit do you mean exit the application or exit the compilation(surface a compiler error)?"}, {"owner": {"reputation": 5953, "user_id": 1062484, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/S7r1l.jpg?s=128&g=1", "display_name": "Subhamoy S.", "link": "https://stackoverflow.com/users/1062484/subhamoy-s"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1498651093, "post_id": 44801659, "comment_id": 76583352, "body": "@NathanOliver: I am sorry for misleading question. I have fixed the phrasing now :)"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 2, "creation_date": 1498651130, "post_id": 44801659, "comment_id": 76583379, "body": "This is possible for class members using SFINAE, but I doubt there&#39;s a way to do it for namespace members."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1498651252, "post_id": 44801659, "comment_id": 76583478, "body": "Is this an XY problem? Just use Boost 1.39, and use the function that it provides, no need to try to port your code to work with a lot of different Boost versions."}, {"owner": {"reputation": 5953, "user_id": 1062484, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/S7r1l.jpg?s=128&g=1", "display_name": "Subhamoy S.", "link": "https://stackoverflow.com/users/1062484/subhamoy-s"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498653066, "post_id": 44801659, "comment_id": 76584857, "body": "@Rakete1111: I do not want to maintain a prehistoric version of boost on my development host, but at the same time have to cross compile for a very old device, if you must know the reason."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498653408, "post_id": 44801659, "comment_id": 76585119, "body": "@SubhamoySengupta You want to compile the code with Boost 1.39, so you have no other choice than to either update Boost if you can, or just stick with Boost 1.39. I do not understand why you think that is a problem. You can&#39;t even use the features of Boost &gt;1.39 because of that very old device, so there is absolutely no reason to use some newer version just because you like it better."}, {"owner": {"reputation": 5953, "user_id": 1062484, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/S7r1l.jpg?s=128&g=1", "display_name": "Subhamoy S.", "link": "https://stackoverflow.com/users/1062484/subhamoy-s"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1498654295, "post_id": 44801659, "comment_id": 76585823, "body": "@Rakete1111: You are assuming that this is the only thing I compile. For this specific project, I managed to avoid using features added after 1.39. This is only a problem because of namespace switching. Eventually, the maintainer of that device might choose to upgrade. I do not want the code to break then. Does that answer your question?"}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1498683099, "post_id": 44801659, "comment_id": 76605245, "body": "@aschepler In some cases you can do that by polluting the namespace. Not the best solution ever, but an acceptable compromise (maybe)."}], "answers": [{"tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 2, "last_activity_date": 1498683682, "last_edit_date": 1498683682, "creation_date": 1498682552, "answer_id": 44812207, "question_id": 44801659, "link": "https://stackoverflow.com/questions/44801659/call-fallback-method-if-method-does-not-exist/44812207#44812207", "title": "Call fallback method if method does not exist", "body": "<p>Here is a possible solution with which you can do that.<br>\nThe only way I found to do that is by polluting the namespaces <code>boost::filesystem</code> and <code>boost::filesystem3</code>, then test if the original function exists. I know that's not the best thing ever, but it's a compromise to have it up and running at the end of the days.</p>\n\n<p>There exist two versions of <code>copy</code> in both the namespaces. They are declared as:</p>\n\n<pre><code>void copy(const path&amp; from, const path&amp; to);\nvoid copy(const path&amp; from, const path&amp; to, system::error_code&amp; ec);\n</code></pre>\n\n<p>Note that I redeclared them with slightly different forms in the example below to simplify things up and to avoid using boost in the example code.</p>\n\n<p>Here is a minimal, working example:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;type_traits&gt;\n\n// original namespaces\n\nnamespace boost { namespace filesystem {\n    void copy(int, char) { std::cout &lt;&lt; \"b::f::copy\" &lt;&lt; std::endl; }\n    void copy(int, char, double) {}\n\n    // ... everything else ...\n}}\n\nnamespace boost { namespace filesystem3 {\n    void copy(int, char) { std::cout &lt;&lt; \"b::f3::copy\" &lt;&lt; std::endl; }\n    void copy(int, char, double) {}\n\n    // ... everything else ...\n}}\n\n// pollution\n\nnamespace boost { namespace filesystem {\n    struct tag {};\n    void copy(tag, tag) {}\n}}\n\nnamespace boost { namespace filesystem3 {\n    struct tag {};\n    void copy(tag, tag) {}\n}}\n\nstd::true_type test(int, void(*)(int, char));\nstd::false_type test(...);\n\nconstexpr bool has_filesystem_copy = decltype(test(0, &amp;boost::filesystem::copy))::value;\nconstexpr bool has_filesystem3_copy = decltype(test(0, &amp;boost::filesystem3::copy))::value;\n\ntemplate&lt;bool = true&gt;\nstruct fallback_fn {};\n\ntemplate&lt;&gt;\nstruct fallback_fn&lt;has_filesystem3_copy&gt; {\n    template&lt;typename... Args&gt;\n    static void invoke(Args... args) {\n        boost::filesystem3::copy(args...);\n    }\n};\n\ntemplate&lt;bool = true&gt;\nstruct copy_fn: fallback_fn&lt;&gt; {};\n\ntemplate&lt;&gt;\nstruct copy_fn&lt;has_filesystem_copy&gt; {\n    template&lt;typename... Args&gt;\n    static void invoke(Args... args) {\n        boost::filesystem::copy(args...);\n    }\n};\n\nint main() {\n    copy_fn&lt;&gt;::invoke(0, 'c');\n}\n</code></pre>\n\n<p>Feel free to play with the functions that are part of those namespaces marked as <em>original namespaces</em>.<br>\nTo sum up:</p>\n\n<ul>\n<li><p>If <code>copy</code> is available both in <code>boost::filesystem</code> and <code>boost::filesystem3</code>, the former is picked up. See it on <a href=\"https://wandbox.org/permlink/CReLQ1QVg2LqumhY\" rel=\"nofollow noreferrer\">wandbox</a>.</p></li>\n<li><p>If <code>copy</code> is available only in <code>boost::filesystem</code>, it's picked up. See it on <a href=\"https://wandbox.org/permlink/meK4UqRinC1Wx3x1\" rel=\"nofollow noreferrer\">wandbox</a>.</p></li>\n<li><p>If <code>copy</code> is available only in <code>boost::filesystem3</code>, it's picked up. See it on <a href=\"https://wandbox.org/permlink/9rkxNfwuW4yk9nDe\" rel=\"nofollow noreferrer\">wandbox</a>.</p></li>\n<li><p>If <code>copy</code> isn't available at all, you get a compile-time error like this:</p>\n\n<blockquote>\n  <p>'invoke' is not a member of 'copy_fn&lt;>'</p>\n</blockquote>\n\n<p>See it on <a href=\"https://wandbox.org/permlink/Cn0qKIJc3nNIA09R\" rel=\"nofollow noreferrer\">wandbox</a>.</p></li>\n</ul>\n\n<p>To do that I used the rules of template specialization and a couple of <code>constexpr</code> variables.<br>\nNote that you can avoid to include <code>&lt;type_traits&gt;</code> by doing this, if you prefer:</p>\n\n<pre><code>constexpr bool test(int, void(*)(int, char)) { return true; }\nconstexpr bool test(...) { return false; }\n\nconstexpr bool has_filesystem_copy = test(0, &amp;boost::filesystem::copy);\nconstexpr bool has_filesystem3_copy = test(0, &amp;boost::filesystem3::copy);\n</code></pre>\n\n<p>Again, polluting a namespace isn't the best idea with which you can come up. Anyway it's a viable approach that probably works in this case, as long as you invoke <code>copy</code> through an utility class like <code>copy_fn</code>.<br>\nAs a side note, keep in mind that it's quite annoying and error-prone if you have to <em>wrap</em> more than one function. It's not the case if I look at the text of your question only, but I don't know what's the real case.</p>\n"}, {"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": false, "score": 1, "last_activity_date": 1498688227, "creation_date": 1498688227, "answer_id": 44813418, "question_id": 44801659, "link": "https://stackoverflow.com/questions/44801659/call-fallback-method-if-method-does-not-exist/44813418#44813418", "title": "Call fallback method if method does not exist", "body": "<p>Here's another idea that (mostly) does the trick:</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;utility&gt;\n#include &lt;iostream&gt;\n\nnamespace fake_boost {\n    namespace filesystem {\n        // class path { public:\n        //     template&lt;typename Source&gt; path(Source const&amp;) {}\n        // };\n        // void copy( const path&amp;, const path&amp; )\n        // { std::cout &lt;&lt; \"fake_boost::filesystem::copy\\n\"; }\n    }\n    namespace filesystem3 {\n        class path { public:\n            template&lt;typename Source&gt; path(Source const&amp;) {}\n        };\n        void copy( const path&amp;, const path&amp; )\n        { std::cout &lt;&lt; \"fake_boost::filesystem3::copy\\n\"; }\n    }\n}\n\nnamespace test_copy {\n    template &lt;typename...&gt; using void_t = void; // or use C++17 std::void_t\n    namespace test_filesystem3 {\n        using namespace fake_boost::filesystem3;\n        template &lt;typename... Args&gt;\n        void do_copy(Args&amp;&amp; ... args)\n        { copy(std::forward&lt;Args&gt;(args)...); }\n    }\n    namespace test_filesystem {\n        template &lt;typename Tuple, typename Enable=void&gt;\n        struct copy_switcher {\n            template &lt;typename... Args&gt;\n            static void do_copy(Args&amp;&amp; ... args)\n            { test_filesystem3::do_copy(std::forward&lt;Args&gt;(args)...); }\n        };\n        using namespace fake_boost::filesystem;\n        template &lt;typename... Args&gt;\n        struct copy_switcher&lt;std::tuple&lt;Args...&gt;,\n            void_t&lt;decltype(copy(std::declval&lt;Args&amp;&amp;&gt;()...))&gt;&gt; {\n            static void do_copy(Args&amp;&amp; ... args)\n            { copy(std::forward&lt;Args&gt;(args)...); }\n        };\n    }\n}\n\ntemplate &lt;typename... Args&gt;\nvoid do_copy(Args&amp;&amp; ... args) {\n    test_copy::test_filesystem::copy_switcher&lt;std::tuple&lt;Args...&gt;&gt;\n        ::do_copy(std::forward&lt;Args&gt;(args)...);\n}\n\nint main() {\n    do_copy( \"from.txt\", \"to.txt\" );\n}\n</code></pre>\n\n<p>A couple of caveats: The namespaces must actually exist, but you can always define them as empty.  The function tested for must not exist at global scope with compatible arguments.  In particular, you couldn't rename my last <code>do_copy</code> to just <code>copy</code>.</p>\n"}], "owner": {"reputation": 5953, "user_id": 1062484, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/S7r1l.jpg?s=128&g=1", "display_name": "Subhamoy S.", "link": "https://stackoverflow.com/users/1062484/subhamoy-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1498688227, "creation_date": 1498650856, "last_edit_date": 1498650953, "question_id": 44801659, "link": "https://stackoverflow.com/questions/44801659/call-fallback-method-if-method-does-not-exist", "title": "Call fallback method if method does not exist", "body": "<p>I want to be able to do the following in C++</p>\n\n<ol>\n<li>Try to call a function from a namespace, e.g., boost::filesystem::copy</li>\n<li>If copy is not a member of boost::filesystem, call a fallback function, e.g., boost::filesystem3::copy</li>\n<li>If fallback function does not exist (this could be either because boost does not have member filesystem3, or because boost::filesystem3 does not have member copy), the code should not compile.</li>\n</ol>\n\n<p>After reading loads and loads of extremely long and complicated pieces of code, it is unclear to me what the simple way of doing this would be. A C++11 solution is fine. But the code sometimes requires to compile with an old boost version (1.39.0), which is precisely why this workaround is required.</p>\n\n<p>Currently I do it by creating method alias after checking the <code>BOOST_VERSION</code> macro. But it would be good to know of a more sophisticated alternative that could be applicable for more general cases.</p>\n"}, {"tags": ["c++", "sockets", "udp", "wireshark"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1498650564, "post_id": 44801502, "comment_id": 76582939, "body": "Can you use symbols for the flags please <code>217</code> is what flags?"}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1498650735, "post_id": 44801502, "comment_id": 76583083, "body": "You&#39;re not checking the value of <code>recvfrom</code>."}, {"owner": {"reputation": 175, "user_id": 4184167, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7c52de2cab17b034e27766239a9b551?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/4184167/joe"}, "edited": false, "score": 0, "creation_date": 1498653253, "post_id": 44801502, "comment_id": 76584992, "body": "Hi Richard, sorry I did post the wrong function actually I&#39;ve got:recvfrom(Connection, MOTD, sizeof(MOTD), 0, (SOCKADDR *)&amp;addr, &amp;sizeofaddr); the flag is 0"}], "answers": [{"tags": [], "owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "is_accepted": false, "score": 0, "last_activity_date": 1498651651, "last_edit_date": 1498651651, "creation_date": 1498651311, "answer_id": 44801842, "question_id": 44801502, "link": "https://stackoverflow.com/questions/44801502/issue-receiving-udp-packets/44801842#44801842", "title": "Issue receiving UDP packets", "body": "<p>According to MSDN <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740120(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms740120(v=vs.85).aspx</a>,  the receive function can use an ored combination of only 2 values: MSG_PEEK, MSG_OOB.</p>\n\n<p>217 is more than just those two flags orded together.</p>\n\n<p>You also should really be checking the return of function and on error could use WSAGetLastError to see what the issue is caused by.</p>\n\n<p>You should also be using SOCK_DGRAM socket type when calling socket() to create a USB socket and UDP is connectionless - currently you are using TCP, and connecting to another TCP socket (the listen socket in your test program)</p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 4184167, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7c52de2cab17b034e27766239a9b551?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/4184167/joe"}, "edited": false, "score": 0, "creation_date": 1498657923, "post_id": 44802436, "comment_id": 76588837, "body": "Thanks for your answer I&#39;ll try what you are suggesting."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 175, "user_id": 4184167, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7c52de2cab17b034e27766239a9b551?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/4184167/joe"}, "edited": false, "score": 1, "creation_date": 1498694824, "post_id": 44802436, "comment_id": 76609224, "body": "You should first have a look at a UDP tutorial. The code you&#39;ve written is completely meaningless."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 1, "last_activity_date": 1498654548, "last_edit_date": 1592644375, "creation_date": 1498652914, "answer_id": 44802436, "question_id": 44801502, "link": "https://stackoverflow.com/questions/44801502/issue-receiving-udp-packets/44802436#44802436", "title": "Issue receiving UDP packets", "body": "<blockquote>\n<p>Issue receiving UDP packets</p>\n</blockquote>\n<p>There is no code that receives UDP packets here.</p>\n<blockquote>\n<p>I'm trying to read the content of UDP packets sent by a hardware device connected locally to the laptop.</p>\n<p>In visual studio I wrote a quick w32 console application just to read an UDP packet of data:</p>\n</blockquote>\n<p>No you didn't.</p>\n<pre><code>SOCKET sListen = socket(AF_INET, SOCK_STREAM, NULL); //Create socket to listen for new connections\n</code></pre>\n<p>This line of code creates a TCP socket. It needs an error check.</p>\n<pre><code>bind(sListen, (SOCKADDR*)&amp;addr, sizeof(addr)); //Bind the address to the socket\n</code></pre>\n<p>This line of code needs an error check.</p>\n<pre><code>listen(sListen, SOMAXCONN); //Places sListen socket in a state in which it is listening for an incoming connection. Note:SOMAXCONN = Socket Oustanding Max Connections\n</code></pre>\n<p>This line of code puts your TCP socket into LISTENING state. It needs an error check.</p>\n<pre><code>SOCKET Connection = socket(AF_INET, SOCK_STREAM, NULL); //Set Connection socket\n</code></pre>\n<p>This line of code creates another TCP socket. It needs an error check.</p>\n<pre><code>if (connect(Connection, (SOCKADDR*)&amp;addr, sizeofaddr) != 0) //If we are unable to connect...\n</code></pre>\n<p>This line of code connects your second TCP socket to your first TCP socket's IP address and port.</p>\n<p>Nothing so far has anything to do with UDP whatsoever.</p>\n<pre><code>recvfrom(Connection, MOTD, sizeof(MOTD), 217, (SOCKADDR *)&amp;addr, &amp;sizeofaddr);\n</code></pre>\n<p>This line of code receives from your second, connected, TCP socket. It needs an error check: it also needs its return value checked for zero, and otherwise this value should be used as the length of the data received. However as you have never accepted this connection, let alone sent anything to the accepted socket, this line of code should block forever and never return.</p>\n<pre><code>while (true)\n{\n    Sleep(10);\n}\n</code></pre>\n<p>Sleeps in networking code are literally a waste of time.</p>\n<blockquote>\n<p>The output is:</p>\n</blockquote>\n<p>The output is mere garbage, because you ignored the error code from <code>recvfrom()</code>, probably due to the <code>flags</code> value of 217 which you appear to have just made up. If you're using real <code>MSG_*</code> values you should certainly use their names. There are five bits set in 217, and even a TCP <code>recv()</code> only has three valid flags in Winsock.</p>\n<blockquote>\n<p>I can see the UDP packets with the data in wireshark and all seems alright from that side.</p>\n</blockquote>\n<p>There is nothing here that has anything to do with UDP packets. Any UDP packets you may have observed are coming from somewhere else and cannot possibly be received or sent by any of this code.</p>\n<blockquote>\n<p>Any ideas what I'm doing wrong?</p>\n</blockquote>\n<p>Everything after <code>WSAStartup()</code>.</p>\n<blockquote>\n<p>is it any other way to just receive UDP packets coming from the network?</p>\n</blockquote>\n<p>Yes. Use <code>SOCK_DGRAM</code> instead of <code>SOCK_STREAM</code>; don't call <code>listen()</code>, don't create two sockets, don't call <code>connect()</code>.</p>\n"}], "owner": {"reputation": 175, "user_id": 4184167, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7c52de2cab17b034e27766239a9b551?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/4184167/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498741593, "creation_date": 1498650340, "last_edit_date": 1498651869, "question_id": 44801502, "link": "https://stackoverflow.com/questions/44801502/issue-receiving-udp-packets", "title": "Issue receiving UDP packets", "body": "<p>I'm trying to read the content of UDP packets sent by a hardware device connected locally to the laptop.</p>\n\n<p>In visual studio I wrote a quick w32 console application just to read an UDP packet of data:</p>\n\n<pre><code>WSAData wsaData;\nWORD DllVersion = MAKEWORD(2, 1);\nif (WSAStartup(DllVersion, &amp;wsaData) != 0) \n{\n    MessageBoxA(NULL, \"Winsock startup failed\", \"Error\", MB_OK | MB_ICONERROR);\n    exit(1);\n}\nSOCKADDR_IN addr; \nint sizeofaddr = sizeof(addr); \naddr.sin_addr.s_addr = inet_addr(\"192.168.1.1\");\naddr.sin_port = htons(1234); \naddr.sin_family = AF_INET; \n\nSOCKET sListen = socket(AF_INET, SOCK_STREAM, NULL); //Create socket to listen for new connections\nbind(sListen, (SOCKADDR*)&amp;addr, sizeof(addr)); //Bind the address to the socket\nlisten(sListen, SOMAXCONN); //Places sListen socket in a state in which it is listening for an incoming connection. Note:SOMAXCONN = Socket Oustanding Max Connections\n\nSOCKET Connection = socket(AF_INET, SOCK_STREAM, NULL); //Set Connection socket\nif (connect(Connection, (SOCKADDR*)&amp;addr, sizeofaddr) != 0) //If we are unable to connect...\n{\n    MessageBoxA(NULL, \"Failed to Connect\", \"Error\", MB_OK | MB_ICONERROR);\n    return 0; //Failed to Connect\n}\nstd::cout &lt;&lt; \"Connected!\" &lt;&lt; std::endl;\n\nchar MOTD[1280];\nrecvfrom(Connection, MOTD, sizeof(MOTD), 217, (SOCKADDR *)&amp;addr, &amp;sizeofaddr);\nstd::cout &lt;&lt; \"Done:\" &lt;&lt; MOTD &lt;&lt; std::endl;\n\nwhile (true)\n{\n    Sleep(10);\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ETaYe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ETaYe.jpg\" alt=\"enter image description here\"></a>\nIf I'm unplugging the device from the laptop I'm still having same result.</p>\n\n<p>I can see the UDP packets with the data in wireshark and all seems alright from that side.</p>\n\n<p>Any ideas what I'm doing wrong? is it any other way to just receive UDP packets coming from the network? </p>\n"}, {"tags": ["c++", "c", "ldap", "openldap"], "answers": [{"tags": [], "owner": {"reputation": 455, "user_id": 4899025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGgvb.jpg?s=128&g=1", "display_name": "Ajith C Narayanan", "link": "https://stackoverflow.com/users/4899025/ajith-c-narayanan"}, "is_accepted": false, "score": 0, "last_activity_date": 1529583240, "creation_date": 1529583240, "answer_id": 50968337, "question_id": 44800771, "link": "https://stackoverflow.com/questions/44800771/authehticate-to-ldap-server-from-c-c/50968337#50968337", "title": "Authehticate to LDAP server from C/C++", "body": "<p>I can give you an example,</p>\n\n<p>suppose you want to search for a person whose uid is bob then you should create a search filter </p>\n\n<pre><code>char *search_filter = \"uid=bob\";\n</code></pre>\n\n<p>and, assumes that your search base is dc=mycompany,dc=ru .</p>\n\n<pre><code>LDAPMessage *res;\n\nldap_search_ext_s(ld, \"dc=mycompany,dc=ru\", LDAP_SCOPE_CHILDREN, search_filter, NULL, 0,NULL, NULL, NULL, 0, &amp;res);\n</code></pre>\n\n<p>Above API call will retrieve the search result in <code>res</code>. later you can use the <code>res</code> to obtain attributes and values of search result.</p>\n"}], "owner": {"reputation": 591, "user_id": 2028846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/eb51bc648174df1be6be06c793738518?s=128&d=identicon&r=PG&f=1", "display_name": "sdd", "link": "https://stackoverflow.com/users/2028846/sdd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 576, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529583240, "creation_date": 1498648106, "last_edit_date": 1498650601, "question_id": 44800771, "link": "https://stackoverflow.com/questions/44800771/authehticate-to-ldap-server-from-c-c", "title": "Authehticate to LDAP server from C/C++", "body": "<p>I try <code>./ldapsearch -h 192.168.1.1 -p 389 -D uid=myname,ou=People,dc=mycompany,dc=ru -w mypassword -b dc=mycompany,dc=ru -xL myname</code></p>\n\n<p>And I write this c++ code:</p>\n\n<pre><code>#define LDAP_DEPRECATED 1\n#include \"ldap.h\"\n\n\nSERVER_API void TestSherst()\n{\n    LDAP *ld;\n\n    if ((ld = ldap_init(\"192.168.1.1\", LDAP_PORT)) == NULL)\n    {\n        perror(\"ldap_init failed\");\n        exit(EXIT_FAILURE);\n    }\n\n    int desired_v = LDAP_VERSION3;\n    if (ldap_set_option(ld, LDAP_OPT_PROTOCOL_VERSION, &amp;desired_v) != LDAP_OPT_SUCCESS)\n    {\n        ldap_perror(ld, \"ldap_set_option failed!\");\n        exit(EXIT_FAILURE);\n    }\n\n    if (ldap_bind_s(ld, \"uid=myname,ou=People,dc=mycompany,dc=ru\", \"mypassword\", LDAP_AUTH_SIMPLE) != LDAP_SUCCESS)\n    {\n        ldap_perror(ld, \"ldap_bind\");\n        exit(EXIT_FAILURE);\n    }\n\n    std::cout &lt;&lt; \"Connected\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>I need a good advice, or, even better, a good guide.</p>\n\n<p>How can I make a search request from code after that?\nCan somebody give me ref to good documentation?</p>\n"}, {"tags": ["c++", "qt", "variables"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 8, "creation_date": 1498648095, "post_id": 44800726, "comment_id": 76581333, "body": "<i>&quot;Converting unsigned int variable into double caused memory leaking&quot;</i> How did you get notice about that? That&#39;s usually not the case."}, {"owner": {"reputation": 8064, "user_id": 5910563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snpEp.jpg?s=128&g=1", "display_name": "Horia Coman", "link": "https://stackoverflow.com/users/5910563/horia-coman"}, "edited": false, "score": 1, "creation_date": 1498648118, "post_id": 44800726, "comment_id": 76581348, "body": "You <i>need</i> to provide more details about what&#39;s happening. A simple conversion, by itself, <i>does not</i> cause memory leaking. It is a wholly separate concern."}], "answers": [{"comments": [{"owner": {"reputation": 78, "user_id": 7648568, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qdTxO.jpg?s=128&g=1", "display_name": "Wei", "link": "https://stackoverflow.com/users/7648568/wei"}, "edited": false, "score": 0, "creation_date": 1498650312, "post_id": 44800754, "comment_id": 76582754, "body": "Thanks for clarification that the conversion doesn&#39;t cause memory leak, maybe I misunderstood the error message?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 78, "user_id": 7648568, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qdTxO.jpg?s=128&g=1", "display_name": "Wei", "link": "https://stackoverflow.com/users/7648568/wei"}, "edited": false, "score": 1, "creation_date": 1498650358, "post_id": 44800754, "comment_id": 76582788, "body": "The cause of the memory problem alluded to by the diagnostic is elsewhere."}, {"owner": {"reputation": 1760, "user_id": 3255071, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0tVHD.png?s=128&g=1", "display_name": "Adam Hunyadi", "link": "https://stackoverflow.com/users/3255071/adam-hunyadi"}, "edited": false, "score": 0, "creation_date": 1498677708, "post_id": 44800754, "comment_id": 76602247, "body": "Make sure you don&#39;t use template functions either, because that can cause some bugs too :) For example if you add up double values between 0 and 1 using <code>std::accumulate</code>, but you set the initial value to an unsigned int, the operation performed on the elements will be integer addition. That is some nasty error."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 8, "last_activity_date": 1498648080, "creation_date": 1498648080, "answer_id": 44800754, "question_id": 44800726, "link": "https://stackoverflow.com/questions/44800726/c-unsigned-int-to-double-conversion/44800754#44800754", "title": "C++ unsigned int to double conversion", "body": "<p>Rest assured that converting an <code>unsigned int</code> to a <code>double</code> does <strong>not</strong> cause a memory leak.</p>\n\n<p>Writing <code>double b = a;</code> is more than sufficient, or just pass <code>a</code> into the function that requires a <code>double</code> as a parameter.</p>\n\n<p>Note that the conversion is <em>exact</em> for an <code>unsigned int</code> up to the 53rd power of 2, for an IEEE754 double precision floating point type.</p>\n"}, {"comments": [{"owner": {"reputation": 78, "user_id": 7648568, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qdTxO.jpg?s=128&g=1", "display_name": "Wei", "link": "https://stackoverflow.com/users/7648568/wei"}, "edited": false, "score": 0, "creation_date": 1498652398, "post_id": 44801561, "comment_id": 76584369, "body": "<code>time</code> holds value of <code>62.3167</code> minutes. As <code>double totalmin = totalsec&#47;60</code> and <code>double totalsec = endSecond - startSecond</code>. <code>endSecond</code> and <code>startSecond</code> are <code>unsigned int</code> which hold values like <code>1313743347</code>"}, {"owner": {"reputation": 512, "user_id": 377331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9307633f01f74a6a1f4882b3617840?s=128&d=identicon&r=PG", "display_name": "Jean", "link": "https://stackoverflow.com/users/377331/jean"}, "reply_to_user": {"reputation": 78, "user_id": 7648568, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qdTxO.jpg?s=128&g=1", "display_name": "Wei", "link": "https://stackoverflow.com/users/7648568/wei"}, "edited": false, "score": 1, "creation_date": 1498654571, "post_id": 44801561, "comment_id": 76586052, "body": "<a href=\"http://doc.qt.io/qt-5/qvector.html#QVector-1\" rel=\"nofollow noreferrer\">QVector constructor</a> takes an int, so if <code>time</code> has value <code>62.3167</code> it will be initialized with a size of 62. Assigning directly a value to any index from 62 will likely fail at some point, but not necessarily at exactly <code>62</code>. I think you should consider resize() or using a like <code>i</code> in your case."}], "tags": [], "owner": {"reputation": 512, "user_id": 377331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9307633f01f74a6a1f4882b3617840?s=128&d=identicon&r=PG", "display_name": "Jean", "link": "https://stackoverflow.com/users/377331/jean"}, "is_accepted": false, "score": 2, "last_activity_date": 1498650535, "creation_date": 1498650535, "answer_id": 44801561, "question_id": 44800726, "link": "https://stackoverflow.com/questions/44800726/c-unsigned-int-to-double-conversion/44801561#44801561", "title": "C++ unsigned int to double conversion", "body": "<p>What's the value of <code>time</code>? It looks like you do:</p>\n\n<pre><code>QVector&lt;double&gt; x(time);\n// [...]\nx[o] = dMin;\n</code></pre>\n\n<p>If time == 166, no doubt <code>x[166]</code> is going to fail, since the vector is initialized with a size of <code>time</code>!</p>\n\n<p>And by the way, nothing related to casting to <code>double</code>.</p>\n"}], "owner": {"reputation": 78, "user_id": 7648568, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qdTxO.jpg?s=128&g=1", "display_name": "Wei", "link": "https://stackoverflow.com/users/7648568/wei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5838, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498658078, "creation_date": 1498647991, "last_edit_date": 1498658078, "question_id": 44800726, "link": "https://stackoverflow.com/questions/44800726/c-unsigned-int-to-double-conversion", "title": "C++ unsigned int to double conversion", "body": "<p>What is the right way of converting <code>unsigned int</code> to <code>double</code>? I need this is for <code>QCPCustomPlot</code> for data setting, as it takes in <code>QVector&lt;double&gt;</code> <strong>precisely</strong> as parameter for creating a graph.</p>\n\n<p>EDIT: Silly me. The 'memory leak' error issue was caused because I initialised <code>QVector&lt;double&gt; x(time), y(ipv4int)</code> wrongly. Changed the <code>time</code> value to the same as <code>ipv4int</code> (the data occurence frequency) and the <code>x</code> and <code>y</code> matched correctly. </p>\n\n<p>Done with the <code>time</code> variable, now the actual issue regarding the conversion. How can I convert it to <code>double</code> format that holds value such as <code>1855919686</code> instead of in the format of <code>1.85592e+09</code>?</p>\n\n<p>QCustomPlot requires <code>double</code> but it seems that the <code>QVector&lt;double&gt;</code> couldn't take in value like 1.85592e+09</p>\n\n<p>Updated code:</p>\n\n<pre><code>QVector&lt;double&gt; x(i), y(totalIP); //i=236052\nfor(int o = 0; o &lt;= i; o++){\n    double dSec = arrayIPxTime[o][0] - startSecond; //arrayIPTime[o][0] holds time in second\n    double dMin = dSec/60;\n    double ipv4addr = arrayIPxTime[o][1]; //arrayIPTime[o][0] holds ipaddr in integer format\n    x[o] = dMin;\n    //y[o] = ipv4addr; this is the line that causes crash. \n    qDebug()&lt;&lt;\"Count \"&lt;&lt;o&lt;&lt;\" time \"&lt;&lt; x[o] &lt;&lt;\" ipv4 \"&lt;&lt;ipv4addr&lt;&lt;\" arrayIPxTime[o][1] \"&lt;&lt;arrayIPxTime[o][1];\n}\n</code></pre>\n\n<p>Current output:</p>\n\n<pre><code>Count  236048  time  62.3167  ipv4  1.85592e+09  arrayIPxTime[o][1]  1855919686\nCount  236049  time  62.3167  ipv4  1.85592e+09  arrayIPxTime[o][1]  1855919686\nCount  236050  time  62.3167  ipv4  1.85592e+09  arrayIPxTime[o][1]  1855919686\nCount  236051  time  62.3167  ipv4  1.85592e+09  arrayIPxTime[o][1]  1855919686\n</code></pre>\n"}, {"tags": ["c++", "floating-point", "codec", "fixed-point", "adc"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1498647506, "post_id": 44800511, "comment_id": 76580967, "body": "What is <code>rx_block_pointer</code>?"}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1498647654, "post_id": 44800511, "comment_id": 76581065, "body": "&quot;24 bits fixed-point data&quot; is not some known standard.  Everyone is free to implement it as they wish.  So you need to tell us exactly what the documentation of your CODEC says about precisely what &quot;24 bits fixed-point data&quot; means to <b><i>them</i></b>."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1498648517, "post_id": 44800511, "comment_id": 76581574, "body": "What do you mean &quot;best way&quot;? Fastest? The most exact? As I see, your input is 24-bit 2-complement number. What output do you need? [-1:1]? The only problem I see is that for 0x7fffff, you output a slightly less number than 1."}, {"owner": {"reputation": 5, "user_id": 7036169, "user_type": "registered", "profile_image": "https://graph.facebook.com/1182507945146138/picture?type=large", "display_name": "Jerca Costi", "link": "https://stackoverflow.com/users/7036169/jerca-costi"}, "edited": false, "score": 0, "creation_date": 1498650158, "post_id": 44800511, "comment_id": 76582635, "body": "rx_block_pointer is a pointer to receive buffer (it`s a ping-pong buffer)."}, {"owner": {"reputation": 5, "user_id": 7036169, "user_type": "registered", "profile_image": "https://graph.facebook.com/1182507945146138/picture?type=large", "display_name": "Jerca Costi", "link": "https://stackoverflow.com/users/7036169/jerca-costi"}, "edited": false, "score": 0, "creation_date": 1498650308, "post_id": 44800511, "comment_id": 76582749, "body": "The codec&#39;s ADC produces and DAC consumes 24 bit fixed point data that is why I use &lt;&lt; 8."}], "answers": [{"comments": [{"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1498648778, "post_id": 44800938, "comment_id": 76581747, "body": "I think the 32-bit conversion is there because it is a signed number"}, {"owner": {"reputation": 384, "user_id": 8224092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0196acfb3e92c2d01ae14fda0cd7eaa?s=128&d=identicon&r=PG&f=1", "display_name": "Loamsiada", "link": "https://stackoverflow.com/users/8224092/loamsiada"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1498649105, "post_id": 44800938, "comment_id": 76581943, "body": "You can also have 24-bit signed numbers. It always depends on the number format which must be known. The documentation of the ADC chip describes the format. Usually the highest bit is used as sign bit, where the number is &quot;wrapped&quot; to the negative values. So a 24-Bit &quot;zero&quot; with the highest bit set (0x800000) means the lowest possible number which is -16777216 in this 24 bit example."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 1, "creation_date": 1498649465, "post_id": 44800938, "comment_id": 76582175, "body": "exactly. That&#39;s why the <code>&lt;&lt;8</code> is there. To shift the sign bit from the 23 bit into the 31, so it will be handled a negative number if the 24-bit number has the highest bit set."}], "tags": [], "owner": {"reputation": 384, "user_id": 8224092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0196acfb3e92c2d01ae14fda0cd7eaa?s=128&d=identicon&r=PG&f=1", "display_name": "Loamsiada", "link": "https://stackoverflow.com/users/8224092/loamsiada"}, "is_accepted": true, "score": 1, "last_activity_date": 1498649745, "last_edit_date": 1498649745, "creation_date": 1498648631, "answer_id": 44800938, "question_id": 44800511, "link": "https://stackoverflow.com/questions/44800511/fixed-point-to-floating-point-data/44800938#44800938", "title": "Fixed point to floating point data", "body": "<p>It depends on the scaling of your fixed point data and also, if the data is signed or unsigned. When you use float to represent 32 bit fixed point data, then you will loose some digits, since some bits are used to store the exponent. I do not really understand, why you do this 32 bit conversion since you could skip this step and write</p>\n\n<pre><code>g_analog_input_chL_mean = (float)(*rx_block_pointer[buffer_cntr])/(float)(0x7FFFFF);\n</code></pre>\n\n<p>If you insist on this 32 bit conversion, then use</p>\n\n<pre><code>g_analog_input_chL_mean = (float)(*rx_block_pointer[buffer_cntr] &lt;&lt; 8)/(float)(0x7FFFFFFF);\n</code></pre>\n\n<p>Note, that I would always use the hex-scaling which is more typo safe than writing the decimal number. Yours is indeed wrong, since the maximum signed integer number is 2147483647, not 2147483648.</p>\n\n<p>If the ADC value has an unsigned format, than you can use the same expressions, but with the sign-bit included:</p>\n\n<pre><code>g_analog_input_chL_mean = (float)(*rx_block_pointer[buffer_cntr])/(float)(0xFFFFFF);\n</code></pre>\n\n<p>or </p>\n\n<pre><code>g_analog_input_chL_mean = (float)(*rx_block_pointer[buffer_cntr] &lt;&lt; 8)/(float)(0xFFFFFFFF);\n</code></pre>\n\n<p>Last point: The ADC value might not be scaled to one. So it might be necessary to muliply the whole Expression by your maximum floating point value.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I now see the necessity of shifting it to 32 bit. The compiler will then be able to perform the correct sign interpretation when converting to float. Thanks, for the correction.</p>\n"}], "owner": {"reputation": 5, "user_id": 7036169, "user_type": "registered", "profile_image": "https://graph.facebook.com/1182507945146138/picture?type=large", "display_name": "Jerca Costi", "link": "https://stackoverflow.com/users/7036169/jerca-costi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 0, "accepted_answer_id": 44800938, "answer_count": 1, "score": -4, "last_activity_date": 1498649745, "creation_date": 1498647316, "question_id": 44800511, "link": "https://stackoverflow.com/questions/44800511/fixed-point-to-floating-point-data", "title": "Fixed point to floating point data", "body": "<p>I recive 24 bits fixed-point data from a CODEC (ADC) by TDM transmission. Then data is stored into a int buffer (32 bits). I want to convert this to float data.</p>\n\n<p>I tried: </p>\n\n<pre><code>g_analog_input_chL_mean = (((float)(*rx_block_pointer[buffer_cntr] &lt;&lt; 8)) * (1.0/2147483648.0)); \n</code></pre>\n\n<p>What is the best way to do this conversion?</p>\n\n<p>Thanks,\nCosti</p>\n"}, {"tags": ["c++", "multithreading", "max", "atomic"], "comments": [{"owner": {"reputation": 1399, "user_id": 7359606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9eca7f3b7853fa067205299f3ebc89?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Artsimovich", "link": "https://stackoverflow.com/users/7359606/joseph-artsimovich"}, "edited": false, "score": 0, "creation_date": 1498654215, "post_id": 44800510, "comment_id": 76585752, "body": "It seems correct, though the initial atomic load in <code>float atom_val=atom;</code> is going to use <code>std::memory_order_seq_cst</code>, while <code>std::memory_order_relaxed</code> should be sufficient."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 1399, "user_id": 7359606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9eca7f3b7853fa067205299f3ebc89?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Artsimovich", "link": "https://stackoverflow.com/users/7359606/joseph-artsimovich"}, "edited": false, "score": 0, "creation_date": 1498654285, "post_id": 44800510, "comment_id": 76585812, "body": "@Tulon Can you explain that, please? (why?)."}, {"owner": {"reputation": 1399, "user_id": 7359606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9eca7f3b7853fa067205299f3ebc89?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Artsimovich", "link": "https://stackoverflow.com/users/7359606/joseph-artsimovich"}, "edited": false, "score": 0, "creation_date": 1498654459, "post_id": 44800510, "comment_id": 76585961, "body": "According to <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic/operator_T\" rel=\"nofollow noreferrer\">cppreference.com</a>, <code>operator T</code> of <code>std::atomic&lt;T&gt;</code> is equivalent to <code>load()</code> which has a default argument of <code>std::memory_order_seq_cst</code>."}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 1399, "user_id": 7359606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9eca7f3b7853fa067205299f3ebc89?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Artsimovich", "link": "https://stackoverflow.com/users/7359606/joseph-artsimovich"}, "edited": false, "score": 0, "creation_date": 1498655014, "post_id": 44800510, "comment_id": 76586444, "body": "@Tulon But why is <code>std::memory_order_relaxed</code> okay?"}, {"owner": {"reputation": 1399, "user_id": 7359606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9eca7f3b7853fa067205299f3ebc89?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Artsimovich", "link": "https://stackoverflow.com/users/7359606/joseph-artsimovich"}, "edited": false, "score": 0, "creation_date": 1498655545, "post_id": 44800510, "comment_id": 76586899, "body": "Normally, you need a stronger memory order than relaxed when you are trying to synchronise atomic memory operations with non-atomic ones. As far as I understand, atomic vs atomic operations are always synchronised, even with <code>std::memory_order_relaxed</code>. That&#39;s my understanding, rather than an authoritative opinion though."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1498666278, "post_id": 44800510, "comment_id": 76595444, "body": "Whether you use <code>seq_cst</code> or <code>relaxed</code>, on <code>X86</code> the compiler will produce the exact same instructions"}, {"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1498677661, "post_id": 44800510, "comment_id": 76602222, "body": "@LWimsey that sounds like you should write a brief answer..."}], "answers": [{"comments": [{"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "reply_to_user": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 0, "creation_date": 1498753818, "post_id": 44813032, "comment_id": 76641487, "body": "indeed, he is the character that inspired my nickname"}], "tags": [], "owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "is_accepted": true, "score": 2, "last_activity_date": 1498686833, "last_edit_date": 1498686833, "creation_date": 1498686218, "answer_id": 44813032, "question_id": 44800510, "link": "https://stackoverflow.com/questions/44800510/updating-maximum-value-atomically/44813032#44813032", "title": "updating maximum value atomically", "body": "<p>The strategy used to atomically update max value in a thread safe manner is correct.  </p>\n\n<p>Whether or not memory ordering is correct is impossible to tell because of code you are not showing.\nIf the atomic max value isn't used in any context other than reporting a value (i.e. no dependencies on other memory operations), you'll probably get away with <code>std::memory_order_relaxed</code>.</p>\n\n<p>As I mentioned in my comment, on <code>X86</code> the compiler is likely to produce the same assembly instructions regardless the use of memory ordering parameters.\n<code>X86</code> is a strongly ordered CPU which means that (by default) <code>#LoadLoad</code> and <code>#LoadStore</code> reordering is not allowed. therefore you won't find a (sane) compiler that will issue a memory fence around a <code>seq_cst</code> <code>load</code>.\n(<code>#StoreLoad</code> reordering is still allowed by default, but to prevent that for <code>seq_cst</code> ordering is typically handled at the <code>store</code> side).  </p>\n\n<p>As for <code>compare_exchange_weak</code> (a read-modify-write operation), this requires the cache line to be locked in order to be atomic; you will see these assembly instructions on <code>X86</code>: <code>lock cmpxchg</code><br>\nSince this also serves as a full memory barrier, it eliminates the need for additional fences.</p>\n\n<p>Note that if you use <code>std::memory_order_relaxed</code> on any atomic operation, the compiler still has the freedom to apply compile time reordering</p>\n"}], "owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "accepted_answer_id": 44813032, "answer_count": 1, "score": 2, "last_activity_date": 1498686833, "creation_date": 1498647314, "last_edit_date": 1498654888, "question_id": 44800510, "link": "https://stackoverflow.com/questions/44800510/updating-maximum-value-atomically", "title": "updating maximum value atomically", "body": "<p>Is the following code a correct implementation to update the maximum value for an atomic variable? Is the usage of <code>std::memory_order_relaxed</code> for both success and failure correct and optimal?</p>\n\n<pre><code>template&lt;typename T&gt;\ninline void update_max(std::atomic&lt;T&gt; &amp; atom, const T val)\n{\n  for(T atom_val=atom;\n      atom_val &lt; val &amp;&amp;\n      !atom.compare_exchange_weak(atom_val, val, std::memory_order_relaxed);\n     );\n}\n</code></pre>\n\n<p>Note that <a href=\"https://stackoverflow.com/questions/14934958/updating-a-maximum-value-from-multiple-threads\">this question</a> addressed essentially the same problem (though in a particular context), but the (accepted) answer is not conclusive, in particular regarding the memory order, (and potentially out of date).</p>\n"}]